<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>小程序AES加密ECB模式 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="小程序AES加密ECB模式" />
<meta property="og:description" content="在线测试工具：https://the-x.cn/cryptography/Aes.aspx
加解密方法 /** * aes 加密方法 * data 字符串 */ AesEncrypt(data) { var key = &#34;1234123412341234&#34;; var keyHex = CryptoJS.enc.Utf8.parse(key); var encrypted = CryptoJS.AES.encrypt(data, keyHex, { iv: [], mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.Pkcs7 }); var encryptData = encrypted.ciphertext.toString().toUpperCase(); // 转为hex格式，转为Base64的字符串，如果转为base64格式，解密的方式就配置不同 var oldHexStr = CryptoJS.enc.Hex.parse(encryptData); // 将密文转为Base64的字符串 var base64Str = CryptoJS.enc.Base64.stringify(oldHexStr); return base64Str }, /** * aes 解密方法 */ AesDecrypt(decodedData) { var key = &#34;1234123412341234&#34;; var keyHex = CryptoJS.enc.Utf8.parse(key); var decrypted = CryptoJS." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/2c03a0478fc665c874b040dbc6145354/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-29T17:24:47+08:00" />
<meta property="article:modified_time" content="2021-10-29T17:24:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">小程序AES加密ECB模式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>在线测试工具：<a href="https://the-x.cn/cryptography/Aes.aspx" rel="nofollow">https://the-x.cn/cryptography/Aes.aspx</a></p> 
<h3><a id="_2"></a>加解密方法</h3> 
<pre><code class="prism language-javascript">  <span class="token comment">/**
   * aes 加密方法
   * data 字符串
   */</span>
  <span class="token function">AesEncrypt</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token string">"1234123412341234"</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> keyHex <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> encrypted <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span><span class="token constant">AES</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> keyHex<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
      iv<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      mode<span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">ECB</span><span class="token punctuation">,</span>
      padding<span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Pkcs7
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> encryptData <span class="token operator">=</span> encrypted<span class="token punctuation">.</span>ciphertext<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 转为hex格式，转为Base64的字符串，如果转为base64格式，解密的方式就配置不同</span>
    <span class="token keyword">var</span> oldHexStr <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Hex<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>encryptData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将密文转为Base64的字符串</span>
    <span class="token keyword">var</span> base64Str <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Base64<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>oldHexStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> base64Str
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * aes 解密方法
   */</span>
  <span class="token function">AesDecrypt</span><span class="token punctuation">(</span><span class="token parameter">decodedData</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token string">"1234123412341234"</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> keyHex <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> decrypted <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span><span class="token constant">AES</span><span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token comment">// ciphertext: CryptoJS.enc.Hex.parse(decodedData) //非base64的数据</span>
      ciphertext<span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Base64<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>decodedData<span class="token punctuation">)</span> <span class="token comment">// base64格式的数据</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> keyHex<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
      iv<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      mode<span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">ECB</span><span class="token punctuation">,</span>
      padding<span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Pkcs7
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> decryptedData <span class="token operator">=</span> decrypted<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"解密之后的结果:"</span> <span class="token operator">+</span> decryptedData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> decryptedData
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<h3><a id="aesjs__47"></a>aes.js 文件</h3> 
<pre><code class="prism language-javascript"><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> factory</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">"object"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// CommonJS</span>
        module<span class="token punctuation">.</span>exports <span class="token operator">=</span> exports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">"function"</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// AMD</span>
        <span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Global (browser)</span>
        root<span class="token punctuation">.</span>CryptoJS <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">/*globals window, global, require*/</span>

    <span class="token comment">/**
     * CryptoJS core components.
     */</span>
    <span class="token keyword">var</span> CryptoJS <span class="token operator">=</span> CryptoJS <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">Math<span class="token punctuation">,</span> <span class="token keyword">undefined</span></span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

        <span class="token keyword">var</span> crypto<span class="token punctuation">;</span>

        <span class="token comment">// Native crypto from window (Browser)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>crypto<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            crypto <span class="token operator">=</span> window<span class="token punctuation">.</span>crypto<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Native crypto in web worker (Browser)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> self <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> self<span class="token punctuation">.</span>crypto<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            crypto <span class="token operator">=</span> self<span class="token punctuation">.</span>crypto<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Native crypto from worker</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> globalThis <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> globalThis<span class="token punctuation">.</span>crypto<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            crypto <span class="token operator">=</span> globalThis<span class="token punctuation">.</span>crypto<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Native (experimental IE 11) crypto from window (Browser)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>crypto <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>msCrypto<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            crypto <span class="token operator">=</span> window<span class="token punctuation">.</span>msCrypto<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Native crypto from global (NodeJS)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>crypto <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> global <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> global<span class="token punctuation">.</span>crypto<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            crypto <span class="token operator">=</span> global<span class="token punctuation">.</span>crypto<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Native crypto import via require (NodeJS)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>crypto <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> require <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/*
         * Cryptographically secure pseudorandom number generator
         *
         * As Math.random() is cryptographically not safe to use
         */</span>
        <span class="token keyword">var</span> <span class="token function-variable function">cryptoSecureRandomInt</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>crypto<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Use getRandomValues method (Browser)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> crypto<span class="token punctuation">.</span>getRandomValues <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span> crypto<span class="token punctuation">.</span><span class="token function">getRandomValues</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Uint32Array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Use randomBytes method (NodeJS)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> crypto<span class="token punctuation">.</span>randomBytes <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readInt32LE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Native crypto module could not be used to get secure random number.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/*
         * Local polyfill of Object.create

         */</span>
        <span class="token keyword">var</span> create <span class="token operator">=</span> Object<span class="token punctuation">.</span>create <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

            <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> subtype<span class="token punctuation">;</span>

                <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> obj<span class="token punctuation">;</span>

                subtype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> subtype<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * CryptoJS namespace.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Library namespace.
         */</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Base object for prototypal inheritance.
         */</span>
        <span class="token keyword">var</span> Base <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>Base <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>


            <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">/**
                 * Creates a new object that inherits from this object.
                 *
                 * @param {Object} overrides Properties to copy into the new object.
                 *
                 * @return {Object} The new object.
                 *
                 * @static
                 *
                 * @example
                 *
                 *     var MyType = CryptoJS.lib.Base.extend({
                 *         field: 'value',
                 *
                 *         method: function () {
                 *         }
                 *     });
                 */</span>
                <span class="token function-variable function">extend</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">overrides</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Spawn</span>
                    <span class="token keyword">var</span> subtype <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Augment</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>overrides<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        subtype<span class="token punctuation">.</span><span class="token function">mixIn</span><span class="token punctuation">(</span>overrides<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// Create default initializer</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>subtype<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'init'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>init <span class="token operator">===</span> subtype<span class="token punctuation">.</span>init<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        subtype<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            subtype<span class="token punctuation">.</span>$<span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// Initializer's prototype is the subtype object</span>
                    subtype<span class="token punctuation">.</span>init<span class="token punctuation">.</span>prototype <span class="token operator">=</span> subtype<span class="token punctuation">;</span>

                    <span class="token comment">// Reference supertype</span>
                    subtype<span class="token punctuation">.</span>$<span class="token keyword">super</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

                    <span class="token keyword">return</span> subtype<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>

                <span class="token comment">/**
                 * Extends this object and runs the init method.
                 * Arguments to create() will be passed to init().
                 *
                 * @return {Object} The new object.
                 *
                 * @static
                 *
                 * @example
                 *
                 *     var instance = MyType.create();
                 */</span>
                <span class="token function-variable function">create</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    instance<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>

                <span class="token comment">/**
                 * Initializes a newly created object.
                 * Override this method to add some logic when your objects are created.
                 *
                 * @example
                 *
                 *     var MyType = CryptoJS.lib.Base.extend({
                 *         init: function () {
                 *             // ...
                 *         }
                 *     });
                 */</span>
                <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>

                <span class="token comment">/**
                 * Copies properties into this object.
                 *
                 * @param {Object} properties The properties to mix in.
                 *
                 * @example
                 *
                 *     MyType.mixIn({
                 *         field: 'value'
                 *     });
                 */</span>
                <span class="token function-variable function">mixIn</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">properties</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> propertyName <span class="token keyword">in</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token keyword">this</span><span class="token punctuation">[</span>propertyName<span class="token punctuation">]</span> <span class="token operator">=</span> properties<span class="token punctuation">[</span>propertyName<span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// IE won't copy toString using the loop above</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'toString'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">this</span><span class="token punctuation">.</span>toString <span class="token operator">=</span> properties<span class="token punctuation">.</span>toString<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>

                <span class="token comment">/**
                 * Creates a copy of this object.
                 *
                 * @return {Object} The clone.
                 *
                 * @example
                 *
                 *     var clone = instance.clone();
                 */</span>
                <span class="token function-variable function">clone</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>init<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * An array of 32-bit words.
         *
         * @property {Array} words The array of 32-bit words.
         * @property {number} sigBytes The number of significant bytes in this word array.
         */</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray <span class="token operator">=</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Initializes a newly created word array.
             *
             * @param {Array} words (Optional) An array of 32-bit words.
             * @param {number} sigBytes (Optional) The number of significant bytes in the words.
             *
             * @example
             *
             *     var wordArray = CryptoJS.lib.WordArray.create();
             *     var wordArray = CryptoJS.lib.WordArray.create([0x00010203, 0x04050607]);
             *     var wordArray = CryptoJS.lib.WordArray.create([0x00010203, 0x04050607], 6);
             */</span>
            <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">words<span class="token punctuation">,</span> sigBytes</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                words <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>words <span class="token operator">=</span> words <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>sigBytes <span class="token operator">!=</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> sigBytes<span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> words<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Converts this word array to a string.
             *
             * @param {Encoder} encoder (Optional) The encoding strategy to use. Default: CryptoJS.enc.Hex
             *
             * @return {string} The stringified word array.
             *
             * @example
             *
             *     var string = wordArray + '';
             *     var string = wordArray.toString();
             *     var string = wordArray.toString(CryptoJS.enc.Utf8);
             */</span>
            <span class="token function-variable function">toString</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">encoder</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token punctuation">(</span>encoder <span class="token operator">||</span> Hex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Concatenates a word array to this word array.
             *
             * @param {WordArray} wordArray The word array to append.
             *
             * @return {WordArray} This word array.
             *
             * @example
             *
             *     wordArray1.concat(wordArray2);
             */</span>
            <span class="token function-variable function">concat</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">wordArray</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> thisWords <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> thatWords <span class="token operator">=</span> wordArray<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> thisSigBytes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sigBytes<span class="token punctuation">;</span>
                <span class="token keyword">var</span> thatSigBytes <span class="token operator">=</span> wordArray<span class="token punctuation">.</span>sigBytes<span class="token punctuation">;</span>

                <span class="token comment">// Clamp excess bits</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">clamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Concat</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>thisSigBytes <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Copy one byte at a time</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> thatSigBytes<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">var</span> thatByte <span class="token operator">=</span> <span class="token punctuation">(</span>thatWords<span class="token punctuation">[</span>i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>
                        thisWords<span class="token punctuation">[</span><span class="token punctuation">(</span>thisSigBytes <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">|=</span> thatByte <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>thisSigBytes <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Copy one word at a time</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> thatSigBytes<span class="token punctuation">;</span> j <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        thisWords<span class="token punctuation">[</span><span class="token punctuation">(</span>thisSigBytes <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> thatWords<span class="token punctuation">[</span>j <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>sigBytes <span class="token operator">+=</span> thatSigBytes<span class="token punctuation">;</span>

                <span class="token comment">// Chainable</span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Removes insignificant bits.
             *
             * @example
             *
             *     wordArray.clamp();
             */</span>
            <span class="token function-variable function">clamp</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> words <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> sigBytes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sigBytes<span class="token punctuation">;</span>

                <span class="token comment">// Clamp</span>
                words<span class="token punctuation">[</span>sigBytes <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;=</span> <span class="token number">0xffffffff</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> <span class="token punctuation">(</span>sigBytes <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                words<span class="token punctuation">.</span>length <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>sigBytes <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Creates a copy of this word array.
             *
             * @return {WordArray} The clone.
             *
             * @example
             *
             *     var clone = wordArray.clone();
             */</span>
            <span class="token function-variable function">clone</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> clone <span class="token operator">=</span> Base<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                clone<span class="token punctuation">.</span>words <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>words<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> clone<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Creates a word array filled with random bytes.
             *
             * @param {number} nBytes The number of random bytes to generate.
             *
             * @return {WordArray} The random word array.
             *
             * @static
             *
             * @example
             *
             *     var wordArray = CryptoJS.lib.WordArray.random(16);
             */</span>
            <span class="token function-variable function">random</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">nBytes</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nBytes<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    words<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">cryptoSecureRandomInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WordArray<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> nBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Encoder namespace.
         */</span>
        <span class="token keyword">var</span> C_enc <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>enc <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Hex encoding strategy.
         */</span>
        <span class="token keyword">var</span> Hex <span class="token operator">=</span> C_enc<span class="token punctuation">.</span>Hex <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Converts a word array to a hex string.
             *
             * @param {WordArray} wordArray The word array.
             *
             * @return {string} The hex string.
             *
             * @static
             *
             * @example
             *
             *     var hexString = CryptoJS.enc.Hex.stringify(wordArray);
             */</span>
            <span class="token function-variable function">stringify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">wordArray</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> words <span class="token operator">=</span> wordArray<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> sigBytes <span class="token operator">=</span> wordArray<span class="token punctuation">.</span>sigBytes<span class="token punctuation">;</span>

                <span class="token comment">// Convert</span>
                <span class="token keyword">var</span> hexChars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sigBytes<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> bite <span class="token operator">=</span> <span class="token punctuation">(</span>words<span class="token punctuation">[</span>i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>
                    hexChars<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bite <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    hexChars<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bite <span class="token operator">&amp;</span> <span class="token number">0x0f</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> hexChars<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Converts a hex string to a word array.
             *
             * @param {string} hexStr The hex string.
             *
             * @return {WordArray} The word array.
             *
             * @static
             *
             * @example
             *
             *     var wordArray = CryptoJS.enc.Hex.parse(hexString);
             */</span>
            <span class="token function-variable function">parse</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">hexStr</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> hexStrLength <span class="token operator">=</span> hexStr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

                <span class="token comment">// Convert</span>
                <span class="token keyword">var</span> words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> hexStrLength<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    words<span class="token punctuation">[</span>i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>hexStr<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WordArray<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> hexStrLength <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Latin1 encoding strategy.
         */</span>
        <span class="token keyword">var</span> Latin1 <span class="token operator">=</span> C_enc<span class="token punctuation">.</span>Latin1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Converts a word array to a Latin1 string.
             *
             * @param {WordArray} wordArray The word array.
             *
             * @return {string} The Latin1 string.
             *
             * @static
             *
             * @example
             *
             *     var latin1String = CryptoJS.enc.Latin1.stringify(wordArray);
             */</span>
            <span class="token function-variable function">stringify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">wordArray</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> words <span class="token operator">=</span> wordArray<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> sigBytes <span class="token operator">=</span> wordArray<span class="token punctuation">.</span>sigBytes<span class="token punctuation">;</span>

                <span class="token comment">// Convert</span>
                <span class="token keyword">var</span> latin1Chars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sigBytes<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> bite <span class="token operator">=</span> <span class="token punctuation">(</span>words<span class="token punctuation">[</span>i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>
                    latin1Chars<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>bite<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> latin1Chars<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Converts a Latin1 string to a word array.
             *
             * @param {string} latin1Str The Latin1 string.
             *
             * @return {WordArray} The word array.
             *
             * @static
             *
             * @example
             *
             *     var wordArray = CryptoJS.enc.Latin1.parse(latin1String);
             */</span>
            <span class="token function-variable function">parse</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">latin1Str</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> latin1StrLength <span class="token operator">=</span> latin1Str<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

                <span class="token comment">// Convert</span>
                <span class="token keyword">var</span> words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> latin1StrLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    words<span class="token punctuation">[</span>i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token punctuation">(</span>latin1Str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WordArray<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> latin1StrLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * UTF-8 encoding strategy.
         */</span>
        <span class="token keyword">var</span> Utf8 <span class="token operator">=</span> C_enc<span class="token punctuation">.</span>Utf8 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Converts a word array to a UTF-8 string.
             *
             * @param {WordArray} wordArray The word array.
             *
             * @return {string} The UTF-8 string.
             *
             * @static
             *
             * @example
             *
             *     var utf8String = CryptoJS.enc.Utf8.stringify(wordArray);
             */</span>
            <span class="token function-variable function">stringify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">wordArray</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span><span class="token function">escape</span><span class="token punctuation">(</span>Latin1<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>wordArray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Malformed UTF-8 data'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Converts a UTF-8 string to a word array.
             *
             * @param {string} utf8Str The UTF-8 string.
             *
             * @return {WordArray} The word array.
             *
             * @static
             *
             * @example
             *
             *     var wordArray = CryptoJS.enc.Utf8.parse(utf8String);
             */</span>
            <span class="token function-variable function">parse</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">utf8Str</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> Latin1<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token function">unescape</span><span class="token punctuation">(</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>utf8Str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Abstract buffered block algorithm template.
         *
         * The property blockSize must be implemented in a concrete subtype.
         *
         * @property {number} _minBufferSize The number of blocks that should be kept unprocessed in the buffer. Default: 0
         */</span>
        <span class="token keyword">var</span> BufferedBlockAlgorithm <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>BufferedBlockAlgorithm <span class="token operator">=</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Resets this block algorithm's data buffer to its initial state.
             *
             * @example
             *
             *     bufferedBlockAlgorithm.reset();
             */</span>
            <span class="token function-variable function">reset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Initial values</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WordArray<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_nDataBytes <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Adds new data to this block algorithm's buffer.
             *
             * @param {WordArray|string} data The data to append. Strings are converted to a WordArray using UTF-8.
             *
             * @example
             *
             *     bufferedBlockAlgorithm._append('data');
             *     bufferedBlockAlgorithm._append(wordArray);
             */</span>
            <span class="token function-variable function">_append</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Convert string to WordArray, else assume WordArray already</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> data <span class="token operator">==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    data <span class="token operator">=</span> Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Append</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_data<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_nDataBytes <span class="token operator">+=</span> data<span class="token punctuation">.</span>sigBytes<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Processes available data blocks.
             *
             * This method invokes _doProcessBlock(offset), which must be implemented by a concrete subtype.
             *
             * @param {boolean} doFlush Whether all blocks and partial blocks should be processed.
             *
             * @return {WordArray} The processed data.
             *
             * @example
             *
             *     var processedData = bufferedBlockAlgorithm._process();
             *     var processedData = bufferedBlockAlgorithm._process(!!'flush');
             */</span>
            <span class="token function-variable function">_process</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">doFlush</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> processedWords<span class="token punctuation">;</span>

                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_data<span class="token punctuation">;</span>
                <span class="token keyword">var</span> dataWords <span class="token operator">=</span> data<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> dataSigBytes <span class="token operator">=</span> data<span class="token punctuation">.</span>sigBytes<span class="token punctuation">;</span>
                <span class="token keyword">var</span> blockSize <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>blockSize<span class="token punctuation">;</span>
                <span class="token keyword">var</span> blockSizeBytes <span class="token operator">=</span> blockSize <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token comment">// Count blocks ready</span>
                <span class="token keyword">var</span> nBlocksReady <span class="token operator">=</span> dataSigBytes <span class="token operator">/</span> blockSizeBytes<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>doFlush<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Round up to include partial blocks</span>
                    nBlocksReady <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>nBlocksReady<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Round down to include only full blocks,</span>
                    <span class="token comment">// less the number of blocks that must remain in the buffer</span>
                    nBlocksReady <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBlocksReady <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_minBufferSize<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Count words ready</span>
                <span class="token keyword">var</span> nWordsReady <span class="token operator">=</span> nBlocksReady <span class="token operator">*</span> blockSize<span class="token punctuation">;</span>

                <span class="token comment">// Count bytes ready</span>
                <span class="token keyword">var</span> nBytesReady <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>nWordsReady <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">,</span> dataSigBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Process blocks</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>nWordsReady<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> offset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> offset <span class="token operator">&lt;</span> nWordsReady<span class="token punctuation">;</span> offset <span class="token operator">+=</span> blockSize<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">// Perform concrete-algorithm logic</span>
                        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_doProcessBlock</span><span class="token punctuation">(</span>dataWords<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// Remove processed words</span>
                    processedWords <span class="token operator">=</span> dataWords<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> nWordsReady<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    data<span class="token punctuation">.</span>sigBytes <span class="token operator">-=</span> nBytesReady<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Return processed words</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WordArray<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span>processedWords<span class="token punctuation">,</span> nBytesReady<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Creates a copy of this object.
             *
             * @return {Object} The clone.
             *
             * @example
             *
             *     var clone = bufferedBlockAlgorithm.clone();
             */</span>
            <span class="token function-variable function">clone</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> clone <span class="token operator">=</span> Base<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                clone<span class="token punctuation">.</span>_data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_data<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> clone<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            _minBufferSize<span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Abstract hasher template.
         *
         * @property {number} blockSize The number of 32-bit words this hasher operates on. Default: 16 (512 bits)
         */</span>
        <span class="token keyword">var</span> Hasher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>Hasher <span class="token operator">=</span> BufferedBlockAlgorithm<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Configuration options.
             */</span>
            cfg<span class="token operator">:</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Initializes a newly created hasher.
             *
             * @param {Object} cfg (Optional) The configuration options to use for this hash computation.
             *
             * @example
             *
             *     var hasher = CryptoJS.algo.SHA256.create();
             */</span>
            <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Apply config defaults</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>cfg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Set initial values</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Resets this hasher to its initial state.
             *
             * @example
             *
             *     hasher.reset();
             */</span>
            <span class="token function-variable function">reset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Reset data buffer</span>
                BufferedBlockAlgorithm<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Perform concrete-hasher logic</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_doReset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Updates this hasher with a message.
             *
             * @param {WordArray|string} messageUpdate The message to append.
             *
             * @return {Hasher} This hasher.
             *
             * @example
             *
             *     hasher.update('message');
             *     hasher.update(wordArray);
             */</span>
            <span class="token function-variable function">update</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">messageUpdate</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Append</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_append</span><span class="token punctuation">(</span>messageUpdate<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Update the hash</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Chainable</span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Finalizes the hash computation.
             * Note that the finalize operation is effectively a destructive, read-once operation.
             *
             * @param {WordArray|string} messageUpdate (Optional) A final message update.
             *
             * @return {WordArray} The hash.
             *
             * @example
             *
             *     var hash = hasher.finalize();
             *     var hash = hasher.finalize('message');
             *     var hash = hasher.finalize(wordArray);
             */</span>
            <span class="token function-variable function">finalize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">messageUpdate</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Final message update</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>messageUpdate<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_append</span><span class="token punctuation">(</span>messageUpdate<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Perform concrete-hasher logic</span>
                <span class="token keyword">var</span> hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_doFinalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            blockSize<span class="token operator">:</span> <span class="token number">512</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Creates a shortcut function to a hasher's object interface.
             *
             * @param {Hasher} hasher The hasher to create a helper for.
             *
             * @return {Function} The shortcut function.
             *
             * @static
             *
             * @example
             *
             *     var SHA256 = CryptoJS.lib.Hasher._createHelper(CryptoJS.algo.SHA256);
             */</span>
            <span class="token function-variable function">_createHelper</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">hasher</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">hasher<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Creates a shortcut function to the HMAC's object interface.
             *
             * @param {Hasher} hasher The hasher to use in this HMAC helper.
             *
             * @return {Function} The shortcut function.
             *
             * @static
             *
             * @example
             *
             *     var HmacSHA256 = CryptoJS.lib.Hasher._createHmacHelper(CryptoJS.algo.SHA256);
             */</span>
            <span class="token function-variable function">_createHmacHelper</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">hasher</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">C_algo<span class="token punctuation">.</span>HMAC<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span>hasher<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Algorithm namespace.
         */</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token constant">C</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span>Math<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">undefined</span></span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Base <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>Base<span class="token punctuation">;</span>
        <span class="token keyword">var</span> X32WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>

        <span class="token comment">/**
         * x64 namespace.
         */</span>
        <span class="token keyword">var</span> C_x64 <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>x64 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * A 64-bit word.
         */</span>
        <span class="token keyword">var</span> X64Word <span class="token operator">=</span> C_x64<span class="token punctuation">.</span>Word <span class="token operator">=</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Initializes a newly created 64-bit word.
             *
             * @param {number} high The high 32 bits.
             * @param {number} low The low 32 bits.
             *
             * @example
             *
             *     var x64Word = CryptoJS.x64.Word.create(0x00010203, 0x04050607);
             */</span>
            <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">high<span class="token punctuation">,</span> low</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>high <span class="token operator">=</span> high<span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>low <span class="token operator">=</span> low<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">/**
             * Bitwise NOTs this word.
             *
             * @return {X64Word} A new x64-Word object after negating.
             *
             * @example
             *
             *     var negated = x64Word.not();
             */</span>
            <span class="token comment">// not: function () {<!-- --></span>
            <span class="token comment">// var high = ~this.high;</span>
            <span class="token comment">// var low = ~this.low;</span>

            <span class="token comment">// return X64Word.create(high, low);</span>
            <span class="token comment">// },</span>

            <span class="token comment">/**
             * Bitwise ANDs this word with the passed word.
             *
             * @param {X64Word} word The x64-Word to AND with this word.
             *
             * @return {X64Word} A new x64-Word object after ANDing.
             *
             * @example
             *
             *     var anded = x64Word.and(anotherX64Word);
             */</span>
            <span class="token comment">// and: function (word) {<!-- --></span>
            <span class="token comment">// var high = this.high &amp; word.high;</span>
            <span class="token comment">// var low = this.low &amp; word.low;</span>

            <span class="token comment">// return X64Word.create(high, low);</span>
            <span class="token comment">// },</span>

            <span class="token comment">/**
             * Bitwise ORs this word with the passed word.
             *
             * @param {X64Word} word The x64-Word to OR with this word.
             *
             * @return {X64Word} A new x64-Word object after ORing.
             *
             * @example
             *
             *     var ored = x64Word.or(anotherX64Word);
             */</span>
            <span class="token comment">// or: function (word) {<!-- --></span>
            <span class="token comment">// var high = this.high | word.high;</span>
            <span class="token comment">// var low = this.low | word.low;</span>

            <span class="token comment">// return X64Word.create(high, low);</span>
            <span class="token comment">// },</span>

            <span class="token comment">/**
             * Bitwise XORs this word with the passed word.
             *
             * @param {X64Word} word The x64-Word to XOR with this word.
             *
             * @return {X64Word} A new x64-Word object after XORing.
             *
             * @example
             *
             *     var xored = x64Word.xor(anotherX64Word);
             */</span>
            <span class="token comment">// xor: function (word) {<!-- --></span>
            <span class="token comment">// var high = this.high ^ word.high;</span>
            <span class="token comment">// var low = this.low ^ word.low;</span>

            <span class="token comment">// return X64Word.create(high, low);</span>
            <span class="token comment">// },</span>

            <span class="token comment">/**
             * Shifts this word n bits to the left.
             *
             * @param {number} n The number of bits to shift.
             *
             * @return {X64Word} A new x64-Word object after shifting.
             *
             * @example
             *
             *     var shifted = x64Word.shiftL(25);
             */</span>
            <span class="token comment">// shiftL: function (n) {<!-- --></span>
            <span class="token comment">// if (n &lt; 32) {<!-- --></span>
            <span class="token comment">// var high = (this.high &lt;&lt; n) | (this.low &gt;&gt;&gt; (32 - n));</span>
            <span class="token comment">// var low = this.low &lt;&lt; n;</span>
            <span class="token comment">// } else {<!-- --></span>
            <span class="token comment">// var high = this.low &lt;&lt; (n - 32);</span>
            <span class="token comment">// var low = 0;</span>
            <span class="token comment">// }</span>

            <span class="token comment">// return X64Word.create(high, low);</span>
            <span class="token comment">// },</span>

            <span class="token comment">/**
             * Shifts this word n bits to the right.
             *
             * @param {number} n The number of bits to shift.
             *
             * @return {X64Word} A new x64-Word object after shifting.
             *
             * @example
             *
             *     var shifted = x64Word.shiftR(7);
             */</span>
            <span class="token comment">// shiftR: function (n) {<!-- --></span>
            <span class="token comment">// if (n &lt; 32) {<!-- --></span>
            <span class="token comment">// var low = (this.low &gt;&gt;&gt; n) | (this.high &lt;&lt; (32 - n));</span>
            <span class="token comment">// var high = this.high &gt;&gt;&gt; n;</span>
            <span class="token comment">// } else {<!-- --></span>
            <span class="token comment">// var low = this.high &gt;&gt;&gt; (n - 32);</span>
            <span class="token comment">// var high = 0;</span>
            <span class="token comment">// }</span>

            <span class="token comment">// return X64Word.create(high, low);</span>
            <span class="token comment">// },</span>

            <span class="token comment">/**
             * Rotates this word n bits to the left.
             *
             * @param {number} n The number of bits to rotate.
             *
             * @return {X64Word} A new x64-Word object after rotating.
             *
             * @example
             *
             *     var rotated = x64Word.rotL(25);
             */</span>
            <span class="token comment">// rotL: function (n) {<!-- --></span>
            <span class="token comment">// return this.shiftL(n).or(this.shiftR(64 - n));</span>
            <span class="token comment">// },</span>

            <span class="token comment">/**
             * Rotates this word n bits to the right.
             *
             * @param {number} n The number of bits to rotate.
             *
             * @return {X64Word} A new x64-Word object after rotating.
             *
             * @example
             *
             *     var rotated = x64Word.rotR(7);
             */</span>
            <span class="token comment">// rotR: function (n) {<!-- --></span>
            <span class="token comment">// return this.shiftR(n).or(this.shiftL(64 - n));</span>
            <span class="token comment">// },</span>

            <span class="token comment">/**
             * Adds this word with the passed word.
             *
             * @param {X64Word} word The x64-Word to add with this word.
             *
             * @return {X64Word} A new x64-Word object after adding.
             *
             * @example
             *
             *     var added = x64Word.add(anotherX64Word);
             */</span>
            <span class="token comment">// add: function (word) {<!-- --></span>
            <span class="token comment">// var low = (this.low + word.low) | 0;</span>
            <span class="token comment">// var carry = (low &gt;&gt;&gt; 0) &lt; (this.low &gt;&gt;&gt; 0) ? 1 : 0;</span>
            <span class="token comment">// var high = (this.high + word.high + carry) | 0;</span>

            <span class="token comment">// return X64Word.create(high, low);</span>
            <span class="token comment">// }</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * An array of 64-bit words.
         *
         * @property {Array} words The array of CryptoJS.x64.Word objects.
         * @property {number} sigBytes The number of significant bytes in this word array.
         */</span>
        <span class="token keyword">var</span> X64WordArray <span class="token operator">=</span> C_x64<span class="token punctuation">.</span>WordArray <span class="token operator">=</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Initializes a newly created word array.
             *
             * @param {Array} words (Optional) An array of CryptoJS.x64.Word objects.
             * @param {number} sigBytes (Optional) The number of significant bytes in the words.
             *
             * @example
             *
             *     var wordArray = CryptoJS.x64.WordArray.create();
             *
             *     var wordArray = CryptoJS.x64.WordArray.create([
             *         CryptoJS.x64.Word.create(0x00010203, 0x04050607),
             *         CryptoJS.x64.Word.create(0x18191a1b, 0x1c1d1e1f)
             *     ]);
             *
             *     var wordArray = CryptoJS.x64.WordArray.create([
             *         CryptoJS.x64.Word.create(0x00010203, 0x04050607),
             *         CryptoJS.x64.Word.create(0x18191a1b, 0x1c1d1e1f)
             *     ], 10);
             */</span>
            <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">words<span class="token punctuation">,</span> sigBytes</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                words <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>words <span class="token operator">=</span> words <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>sigBytes <span class="token operator">!=</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> sigBytes<span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> words<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Converts this 64-bit word array to a 32-bit word array.
             *
             * @return {CryptoJS.lib.WordArray} This word array's data as a 32-bit word array.
             *
             * @example
             *
             *     var x32WordArray = x64WordArray.toX32();
             */</span>
            <span class="token function-variable function">toX32</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> x64Words <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> x64WordsLength <span class="token operator">=</span> x64Words<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

                <span class="token comment">// Convert</span>
                <span class="token keyword">var</span> x32Words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> x64WordsLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> x64Word <span class="token operator">=</span> x64Words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    x32Words<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>x64Word<span class="token punctuation">.</span>high<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    x32Words<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>x64Word<span class="token punctuation">.</span>low<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> X32WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>x32Words<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sigBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Creates a copy of this word array.
             *
             * @return {X64WordArray} The clone.
             *
             * @example
             *
             *     var clone = x64WordArray.clone();
             */</span>
            <span class="token function-variable function">clone</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> clone <span class="token operator">=</span> Base<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Clone "words" array</span>
                <span class="token keyword">var</span> words <span class="token operator">=</span> clone<span class="token punctuation">.</span>words <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>words<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Clone each X64Word object</span>
                <span class="token keyword">var</span> wordsLength <span class="token operator">=</span> words<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> wordsLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    words<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> clone<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Check if typed arrays are supported</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> ArrayBuffer <span class="token operator">!=</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>

        <span class="token comment">// Reference original init</span>
        <span class="token keyword">var</span> superInit <span class="token operator">=</span> WordArray<span class="token punctuation">.</span>init<span class="token punctuation">;</span>

        <span class="token comment">// Augment WordArray.init to handle typed arrays</span>
        <span class="token keyword">var</span> subInit <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">typedArray</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Convert buffers to uint8</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>typedArray <span class="token keyword">instanceof</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                typedArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>typedArray<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Convert other array views to uint8</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>
                typedArray <span class="token keyword">instanceof</span> <span class="token class-name">Int8Array</span> <span class="token operator">||</span>
                <span class="token punctuation">(</span><span class="token keyword">typeof</span> Uint8ClampedArray <span class="token operator">!==</span> <span class="token string">"undefined"</span> <span class="token operator">&amp;&amp;</span> typedArray <span class="token keyword">instanceof</span> <span class="token class-name">Uint8ClampedArray</span><span class="token punctuation">)</span> <span class="token operator">||</span>
                typedArray <span class="token keyword">instanceof</span> <span class="token class-name">Int16Array</span> <span class="token operator">||</span>
                typedArray <span class="token keyword">instanceof</span> <span class="token class-name">Uint16Array</span> <span class="token operator">||</span>
                typedArray <span class="token keyword">instanceof</span> <span class="token class-name">Int32Array</span> <span class="token operator">||</span>
                typedArray <span class="token keyword">instanceof</span> <span class="token class-name">Uint32Array</span> <span class="token operator">||</span>
                typedArray <span class="token keyword">instanceof</span> <span class="token class-name">Float32Array</span> <span class="token operator">||</span>
                typedArray <span class="token keyword">instanceof</span> <span class="token class-name">Float64Array</span>
            <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                typedArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>typedArray<span class="token punctuation">.</span>buffer<span class="token punctuation">,</span> typedArray<span class="token punctuation">.</span>byteOffset<span class="token punctuation">,</span> typedArray<span class="token punctuation">.</span>byteLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Handle Uint8Array</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>typedArray <span class="token keyword">instanceof</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> typedArrayByteLength <span class="token operator">=</span> typedArray<span class="token punctuation">.</span>byteLength<span class="token punctuation">;</span>

                <span class="token comment">// Extract bytes</span>
                <span class="token keyword">var</span> words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> typedArrayByteLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    words<span class="token punctuation">[</span>i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">|=</span> typedArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Initialize this word array</span>
                <span class="token function">superInit</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> words<span class="token punctuation">,</span> typedArrayByteLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Else call normal init</span>
                <span class="token function">superInit</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        subInit<span class="token punctuation">.</span>prototype <span class="token operator">=</span> WordArray<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_enc <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>enc<span class="token punctuation">;</span>

        <span class="token comment">/**
         * UTF-16 BE encoding strategy.
         */</span>
        <span class="token keyword">var</span> Utf16BE <span class="token operator">=</span> C_enc<span class="token punctuation">.</span>Utf16 <span class="token operator">=</span> C_enc<span class="token punctuation">.</span>Utf16BE <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Converts a word array to a UTF-16 BE string.
             *
             * @param {WordArray} wordArray The word array.
             *
             * @return {string} The UTF-16 BE string.
             *
             * @static
             *
             * @example
             *
             *     var utf16String = CryptoJS.enc.Utf16.stringify(wordArray);
             */</span>
            <span class="token function-variable function">stringify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">wordArray</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> words <span class="token operator">=</span> wordArray<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> sigBytes <span class="token operator">=</span> wordArray<span class="token punctuation">.</span>sigBytes<span class="token punctuation">;</span>

                <span class="token comment">// Convert</span>
                <span class="token keyword">var</span> utf16Chars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sigBytes<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> codePoint <span class="token operator">=</span> <span class="token punctuation">(</span>words<span class="token punctuation">[</span>i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">;</span>
                    utf16Chars<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>codePoint<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> utf16Chars<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Converts a UTF-16 BE string to a word array.
             *
             * @param {string} utf16Str The UTF-16 BE string.
             *
             * @return {WordArray} The word array.
             *
             * @static
             *
             * @example
             *
             *     var wordArray = CryptoJS.enc.Utf16.parse(utf16String);
             */</span>
            <span class="token function-variable function">parse</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">utf16Str</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> utf16StrLength <span class="token operator">=</span> utf16Str<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

                <span class="token comment">// Convert</span>
                <span class="token keyword">var</span> words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> utf16StrLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    words<span class="token punctuation">[</span>i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">|=</span> utf16Str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> utf16StrLength <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * UTF-16 LE encoding strategy.
         */</span>
        C_enc<span class="token punctuation">.</span>Utf16LE <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Converts a word array to a UTF-16 LE string.
             *
             * @param {WordArray} wordArray The word array.
             *
             * @return {string} The UTF-16 LE string.
             *
             * @static
             *
             * @example
             *
             *     var utf16Str = CryptoJS.enc.Utf16LE.stringify(wordArray);
             */</span>
            <span class="token function-variable function">stringify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">wordArray</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> words <span class="token operator">=</span> wordArray<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> sigBytes <span class="token operator">=</span> wordArray<span class="token punctuation">.</span>sigBytes<span class="token punctuation">;</span>

                <span class="token comment">// Convert</span>
                <span class="token keyword">var</span> utf16Chars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sigBytes<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> codePoint <span class="token operator">=</span> <span class="token function">swapEndian</span><span class="token punctuation">(</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    utf16Chars<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>codePoint<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> utf16Chars<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Converts a UTF-16 LE string to a word array.
             *
             * @param {string} utf16Str The UTF-16 LE string.
             *
             * @return {WordArray} The word array.
             *
             * @static
             *
             * @example
             *
             *     var wordArray = CryptoJS.enc.Utf16LE.parse(utf16Str);
             */</span>
            <span class="token function-variable function">parse</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">utf16Str</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> utf16StrLength <span class="token operator">=</span> utf16Str<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

                <span class="token comment">// Convert</span>
                <span class="token keyword">var</span> words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> utf16StrLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    words<span class="token punctuation">[</span>i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token function">swapEndian</span><span class="token punctuation">(</span>utf16Str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> utf16StrLength <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">swapEndian</span><span class="token punctuation">(</span><span class="token parameter">word</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_enc <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>enc<span class="token punctuation">;</span>

        <span class="token comment">/**
         * Base64 encoding strategy.
         */</span>
        <span class="token keyword">var</span> Base64 <span class="token operator">=</span> C_enc<span class="token punctuation">.</span>Base64 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Converts a word array to a Base64 string.
             *
             * @param {WordArray} wordArray The word array.
             *
             * @return {string} The Base64 string.
             *
             * @static
             *
             * @example
             *
             *     var base64String = CryptoJS.enc.Base64.stringify(wordArray);
             */</span>
            <span class="token function-variable function">stringify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">wordArray</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> words <span class="token operator">=</span> wordArray<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> sigBytes <span class="token operator">=</span> wordArray<span class="token punctuation">.</span>sigBytes<span class="token punctuation">;</span>
                <span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_map<span class="token punctuation">;</span>

                <span class="token comment">// Clamp excess bits</span>
                wordArray<span class="token punctuation">.</span><span class="token function">clamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Convert</span>
                <span class="token keyword">var</span> base64Chars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sigBytes<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> byte1 <span class="token operator">=</span> <span class="token punctuation">(</span>words<span class="token punctuation">[</span>i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> byte2 <span class="token operator">=</span> <span class="token punctuation">(</span>words<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> byte3 <span class="token operator">=</span> <span class="token punctuation">(</span>words<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>

                    <span class="token keyword">var</span> triplet <span class="token operator">=</span> <span class="token punctuation">(</span>byte1 <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>byte2 <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> byte3<span class="token punctuation">;</span>

                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                        <span class="token punctuation">(</span>j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> j <span class="token operator">*</span> <span class="token number">0.75</span> <span class="token operator">&lt;</span> sigBytes<span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        base64Chars<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>triplet <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">6</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">-</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Add padding</span>
                <span class="token keyword">var</span> paddingChar <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>paddingChar<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span>base64Chars<span class="token punctuation">.</span>length <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        base64Chars<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>paddingChar<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> base64Chars<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Converts a Base64 string to a word array.
             *
             * @param {string} base64Str The Base64 string.
             *
             * @return {WordArray} The word array.
             *
             * @static
             *
             * @example
             *
             *     var wordArray = CryptoJS.enc.Base64.parse(base64String);
             */</span>
            <span class="token function-variable function">parse</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">base64Str</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> base64StrLength <span class="token operator">=</span> base64Str<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                <span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_map<span class="token punctuation">;</span>
                <span class="token keyword">var</span> reverseMap <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_reverseMap<span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>reverseMap<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    reverseMap <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_reverseMap <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> map<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        reverseMap<span class="token punctuation">[</span>map<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Ignore padding</span>
                <span class="token keyword">var</span> paddingChar <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>paddingChar<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> paddingIndex <span class="token operator">=</span> base64Str<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>paddingChar<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>paddingIndex <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        base64StrLength <span class="token operator">=</span> paddingIndex<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Convert</span>
                <span class="token keyword">return</span> <span class="token function">parseLoop</span><span class="token punctuation">(</span>base64Str<span class="token punctuation">,</span> base64StrLength<span class="token punctuation">,</span> reverseMap<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            _map<span class="token operator">:</span> <span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">parseLoop</span><span class="token punctuation">(</span><span class="token parameter">base64Str<span class="token punctuation">,</span> base64StrLength<span class="token punctuation">,</span> reverseMap</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> nBytes <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> base64StrLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> bits1 <span class="token operator">=</span> reverseMap<span class="token punctuation">[</span>base64Str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> bits2 <span class="token operator">=</span> reverseMap<span class="token punctuation">[</span>base64Str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">6</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> bitsCombined <span class="token operator">=</span> bits1 <span class="token operator">|</span> bits2<span class="token punctuation">;</span>
                    words<span class="token punctuation">[</span>nBytes <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">|=</span> bitsCombined <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span>nBytes <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    nBytes<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> nBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_enc <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>enc<span class="token punctuation">;</span>

        <span class="token comment">/**
         * Base64url encoding strategy.
         */</span>
        <span class="token keyword">var</span> Base64url <span class="token operator">=</span> C_enc<span class="token punctuation">.</span>Base64url <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Converts a word array to a Base64url string.
             *
             * @param {WordArray} wordArray The word array.
             *
             * @param {boolean} urlSafe Whether to use url safe
             *
             * @return {string} The Base64url string.
             *
             * @static
             *
             * @example
             *
             *     var base64String = CryptoJS.enc.Base64url.stringify(wordArray);
             */</span>
            <span class="token function-variable function">stringify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">wordArray<span class="token punctuation">,</span> urlSafe <span class="token operator">=</span> <span class="token boolean">true</span></span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> words <span class="token operator">=</span> wordArray<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> sigBytes <span class="token operator">=</span> wordArray<span class="token punctuation">.</span>sigBytes<span class="token punctuation">;</span>
                <span class="token keyword">var</span> map <span class="token operator">=</span> urlSafe <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_safe_map <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_map<span class="token punctuation">;</span>

                <span class="token comment">// Clamp excess bits</span>
                wordArray<span class="token punctuation">.</span><span class="token function">clamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Convert</span>
                <span class="token keyword">var</span> base64Chars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sigBytes<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> byte1 <span class="token operator">=</span> <span class="token punctuation">(</span>words<span class="token punctuation">[</span>i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> byte2 <span class="token operator">=</span> <span class="token punctuation">(</span>words<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> byte3 <span class="token operator">=</span> <span class="token punctuation">(</span>words<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>

                    <span class="token keyword">var</span> triplet <span class="token operator">=</span> <span class="token punctuation">(</span>byte1 <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>byte2 <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> byte3<span class="token punctuation">;</span>

                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                        <span class="token punctuation">(</span>j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> j <span class="token operator">*</span> <span class="token number">0.75</span> <span class="token operator">&lt;</span> sigBytes<span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        base64Chars<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>triplet <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">6</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">-</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Add padding</span>
                <span class="token keyword">var</span> paddingChar <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>paddingChar<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span>base64Chars<span class="token punctuation">.</span>length <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        base64Chars<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>paddingChar<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> base64Chars<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Converts a Base64url string to a word array.
             *
             * @param {string} base64Str The Base64url string.
             *
             * @param {boolean} urlSafe Whether to use url safe
             *
             * @return {WordArray} The word array.
             *
             * @static
             *
             * @example
             *
             *     var wordArray = CryptoJS.enc.Base64url.parse(base64String);
             */</span>
            <span class="token function-variable function">parse</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">base64Str<span class="token punctuation">,</span> urlSafe <span class="token operator">=</span> <span class="token boolean">true</span></span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> base64StrLength <span class="token operator">=</span> base64Str<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                <span class="token keyword">var</span> map <span class="token operator">=</span> urlSafe <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_safe_map <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_map<span class="token punctuation">;</span>
                <span class="token keyword">var</span> reverseMap <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_reverseMap<span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>reverseMap<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    reverseMap <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_reverseMap <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> map<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        reverseMap<span class="token punctuation">[</span>map<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Ignore padding</span>
                <span class="token keyword">var</span> paddingChar <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>paddingChar<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> paddingIndex <span class="token operator">=</span> base64Str<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>paddingChar<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>paddingIndex <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        base64StrLength <span class="token operator">=</span> paddingIndex<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Convert</span>
                <span class="token keyword">return</span> <span class="token function">parseLoop</span><span class="token punctuation">(</span>base64Str<span class="token punctuation">,</span> base64StrLength<span class="token punctuation">,</span> reverseMap<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            _map<span class="token operator">:</span> <span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='</span><span class="token punctuation">,</span>
            _safe_map<span class="token operator">:</span> <span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">parseLoop</span><span class="token punctuation">(</span><span class="token parameter">base64Str<span class="token punctuation">,</span> base64StrLength<span class="token punctuation">,</span> reverseMap</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> nBytes <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> base64StrLength<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> bits1 <span class="token operator">=</span> reverseMap<span class="token punctuation">[</span>base64Str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> bits2 <span class="token operator">=</span> reverseMap<span class="token punctuation">[</span>base64Str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">6</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> bitsCombined <span class="token operator">=</span> bits1 <span class="token operator">|</span> bits2<span class="token punctuation">;</span>
                    words<span class="token punctuation">[</span>nBytes <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">|=</span> bitsCombined <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span>nBytes <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    nBytes<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> nBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">Math</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Hasher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>Hasher<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>

        <span class="token comment">// Constants table</span>
        <span class="token keyword">var</span> <span class="token constant">T</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// Compute constants</span>
        <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token constant">T</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0x100000000</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * MD5 hash algorithm.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">MD5</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">MD5</span> <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_hash <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WordArray<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
                    <span class="token number">0x67452301</span><span class="token punctuation">,</span> <span class="token number">0xefcdab89</span><span class="token punctuation">,</span>
                    <span class="token number">0x98badcfe</span><span class="token punctuation">,</span> <span class="token number">0x10325476</span>
                <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doProcessBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Swap endian</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Shortcuts</span>
                    <span class="token keyword">var</span> offset_i <span class="token operator">=</span> offset <span class="token operator">+</span> i<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> M_offset_i <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset_i<span class="token punctuation">]</span><span class="token punctuation">;</span>

                    <span class="token constant">M</span><span class="token punctuation">[</span>offset_i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>M_offset_i <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>M_offset_i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>M_offset_i <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>M_offset_i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> <span class="token constant">H</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token keyword">var</span> M_offset_0 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_1 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_2 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_3 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_4 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_5 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_6 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_7 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_8 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_9 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_10 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_11 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_12 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_13 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_14 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> M_offset_15 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// Working varialbes</span>
                <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// Computation</span>
                a <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_0<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_1<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_2<span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_3<span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                a <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_4<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_5<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_6<span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_7<span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                a <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_8<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_9<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_10<span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_11<span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                a <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_12<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_13<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_14<span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">FF</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_15<span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                a <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_1<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_6<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_11<span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_0<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                a <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_5<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_10<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_15<span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_4<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                a <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_9<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_14<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_3<span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_8<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                a <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_13<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_2<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_7<span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">GG</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_12<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                a <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_5<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_8<span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_11<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_14<span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                a <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_1<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_4<span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_7<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_10<span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                a <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_13<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_0<span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_3<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_6<span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                a <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_9<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_12<span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_15<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">HH</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_2<span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                a <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_0<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_7<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_14<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_5<span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                a <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_12<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_3<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_10<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">54</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_1<span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                a <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_8<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_15<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">57</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_6<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">58</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_13<span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                a <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> M_offset_4<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                d <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> M_offset_11<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">61</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> M_offset_2<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                b <span class="token operator">=</span> <span class="token constant">II</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> M_offset_9<span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Intermediate hash value</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> c<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> d<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doFinalize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_data<span class="token punctuation">;</span>
                <span class="token keyword">var</span> dataWords <span class="token operator">=</span> data<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token keyword">var</span> nBitsTotal <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_nDataBytes <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> nBitsLeft <span class="token operator">=</span> data<span class="token punctuation">.</span>sigBytes <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>

                <span class="token comment">// Add padding</span>
                dataWords<span class="token punctuation">[</span>nBitsLeft <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token number">0x80</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> nBitsLeft <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">var</span> nBitsTotalH <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>nBitsTotal <span class="token operator">/</span> <span class="token number">0x100000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> nBitsTotalL <span class="token operator">=</span> nBitsTotal<span class="token punctuation">;</span>
                dataWords<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsLeft <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsTotalH <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>nBitsTotalH <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsTotalH <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>nBitsTotalH <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
                dataWords<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsLeft <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsTotalL <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>nBitsTotalL <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsTotalL <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>nBitsTotalL <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>

                data<span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> <span class="token punctuation">(</span>dataWords<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token comment">// Hash final blocks</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">;</span>
                <span class="token keyword">var</span> <span class="token constant">H</span> <span class="token operator">=</span> hash<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token comment">// Swap endian</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Shortcut</span>
                    <span class="token keyword">var</span> H_i <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

                    <span class="token constant">H</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>H_i <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>H_i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>H_i <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>H_i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Return final computed hash</span>
                <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">clone</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> clone <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                clone<span class="token punctuation">.</span>_hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> clone<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token constant">FF</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">,</span> s<span class="token punctuation">,</span> t</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> n <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> c<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token operator">~</span>b <span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> x <span class="token operator">+</span> t<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">function</span> <span class="token constant">GG</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">,</span> s<span class="token punctuation">,</span> t</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> n <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>c <span class="token operator">&amp;</span> <span class="token operator">~</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> x <span class="token operator">+</span> t<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">function</span> <span class="token constant">HH</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">,</span> s<span class="token punctuation">,</span> t</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> n <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token punctuation">(</span>b <span class="token operator">^</span> c <span class="token operator">^</span> d<span class="token punctuation">)</span> <span class="token operator">+</span> x <span class="token operator">+</span> t<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">function</span> <span class="token constant">II</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">,</span> s<span class="token punctuation">,</span> t</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> n <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token punctuation">(</span>c <span class="token operator">^</span> <span class="token punctuation">(</span>b <span class="token operator">|</span> <span class="token operator">~</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> x <span class="token operator">+</span> t<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/**
         * Shortcut function to the hasher's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         *
         * @return {WordArray} The hash.
         *
         * @static
         *
         * @example
         *
         *     var hash = CryptoJS.MD5('message');
         *     var hash = CryptoJS.MD5(wordArray);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span><span class="token constant">MD5</span> <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span><span class="token constant">MD5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut function to the HMAC's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         * @param {WordArray|string} key The secret key.
         *
         * @return {WordArray} The HMAC.
         *
         * @static
         *
         * @example
         *
         *     var hmac = CryptoJS.HmacMD5(message, key);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span>HmacMD5 <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">_createHmacHelper</span><span class="token punctuation">(</span><span class="token constant">MD5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span>Math<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Hasher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>Hasher<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>

        <span class="token comment">// Reusable object</span>
        <span class="token keyword">var</span> <span class="token constant">W</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * SHA-1 hash algorithm.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">SHA1</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">SHA1</span> <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_hash <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WordArray<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
                    <span class="token number">0x67452301</span><span class="token punctuation">,</span> <span class="token number">0xefcdab89</span><span class="token punctuation">,</span>
                    <span class="token number">0x98badcfe</span><span class="token punctuation">,</span> <span class="token number">0x10325476</span><span class="token punctuation">,</span>
                    <span class="token number">0xc3d2e1f0</span>
                <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doProcessBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> <span class="token constant">H</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token comment">// Working variables</span>
                <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// Computation</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">80</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token constant">W</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token constant">W</span><span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">W</span><span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">W</span><span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">W</span><span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token constant">W</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">&lt;&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> e <span class="token operator">+</span> <span class="token constant">W</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        t <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> c<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token operator">~</span>b <span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0x5a827999</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">40</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        t <span class="token operator">+=</span> <span class="token punctuation">(</span>b <span class="token operator">^</span> c <span class="token operator">^</span> d<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0x6ed9eba1</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        t <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> c<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>b <span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>c <span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x70e44324</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token comment">/* if (i &lt; 80) */</span> <span class="token punctuation">{<!-- --></span>
                        t <span class="token operator">+=</span> <span class="token punctuation">(</span>b <span class="token operator">^</span> c <span class="token operator">^</span> d<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x359d3e2a</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    e <span class="token operator">=</span> d<span class="token punctuation">;</span>
                    d <span class="token operator">=</span> c<span class="token punctuation">;</span>
                    c <span class="token operator">=</span> <span class="token punctuation">(</span>b <span class="token operator">&lt;&lt;</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>b <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    b <span class="token operator">=</span> a<span class="token punctuation">;</span>
                    a <span class="token operator">=</span> t<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Intermediate hash value</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> c<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> d<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> e<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doFinalize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_data<span class="token punctuation">;</span>
                <span class="token keyword">var</span> dataWords <span class="token operator">=</span> data<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token keyword">var</span> nBitsTotal <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_nDataBytes <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> nBitsLeft <span class="token operator">=</span> data<span class="token punctuation">.</span>sigBytes <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>

                <span class="token comment">// Add padding</span>
                dataWords<span class="token punctuation">[</span>nBitsLeft <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token number">0x80</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> nBitsLeft <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                dataWords<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsLeft <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>nBitsTotal <span class="token operator">/</span> <span class="token number">0x100000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                dataWords<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsLeft <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> nBitsTotal<span class="token punctuation">;</span>
                data<span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> dataWords<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token comment">// Hash final blocks</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Return final computed hash</span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">clone</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> clone <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                clone<span class="token punctuation">.</span>_hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> clone<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut function to the hasher's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         *
         * @return {WordArray} The hash.
         *
         * @static
         *
         * @example
         *
         *     var hash = CryptoJS.SHA1('message');
         *     var hash = CryptoJS.SHA1(wordArray);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span><span class="token constant">SHA1</span> <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span><span class="token constant">SHA1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut function to the HMAC's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         * @param {WordArray|string} key The secret key.
         *
         * @return {WordArray} The HMAC.
         *
         * @static
         *
         * @example
         *
         *     var hmac = CryptoJS.HmacSHA1(message, key);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span>HmacSHA1 <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">_createHmacHelper</span><span class="token punctuation">(</span><span class="token constant">SHA1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">Math</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Hasher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>Hasher<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>

        <span class="token comment">// Initialization and round constants tables</span>
        <span class="token keyword">var</span> <span class="token constant">H</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">K</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// Compute constants</span>
        <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">function</span> <span class="token function">isPrime</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> sqrtN <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> factor <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> factor <span class="token operator">&lt;=</span> sqrtN<span class="token punctuation">;</span> factor<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>n <span class="token operator">%</span> factor<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">function</span> <span class="token function">getFractionalBits</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token punctuation">(</span>n <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0x100000000</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> nPrime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>nPrime <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isPrime</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>nPrime <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token constant">H</span><span class="token punctuation">[</span>nPrime<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getFractionalBits</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token constant">K</span><span class="token punctuation">[</span>nPrime<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getFractionalBits</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    nPrime<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                n<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Reusable object</span>
        <span class="token keyword">var</span> <span class="token constant">W</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * SHA-256 hash algorithm.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">SHA256</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">SHA256</span> <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_hash <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WordArray<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doProcessBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> <span class="token constant">H</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token comment">// Working variables</span>
                <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> g <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> h <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// Computation</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token constant">W</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">var</span> gamma0x <span class="token operator">=</span> <span class="token constant">W</span><span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> gamma0 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>gamma0x <span class="token operator">&lt;&lt;</span> <span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>gamma0x <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span>
                            <span class="token punctuation">(</span><span class="token punctuation">(</span>gamma0x <span class="token operator">&lt;&lt;</span> <span class="token number">14</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>gamma0x <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span>
                            <span class="token punctuation">(</span>gamma0x <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                        <span class="token keyword">var</span> gamma1x <span class="token operator">=</span> <span class="token constant">W</span><span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> gamma1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>gamma1x <span class="token operator">&lt;&lt;</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>gamma1x <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span>
                            <span class="token punctuation">(</span><span class="token punctuation">(</span>gamma1x <span class="token operator">&lt;&lt;</span> <span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>gamma1x <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span>
                            <span class="token punctuation">(</span>gamma1x <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                        <span class="token constant">W</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> gamma0 <span class="token operator">+</span> <span class="token constant">W</span><span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> gamma1 <span class="token operator">+</span> <span class="token constant">W</span><span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token keyword">var</span> ch <span class="token operator">=</span> <span class="token punctuation">(</span>e <span class="token operator">&amp;</span> f<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token operator">~</span>e <span class="token operator">&amp;</span> g<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> maj <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>a <span class="token operator">&amp;</span> c<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>b <span class="token operator">&amp;</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token keyword">var</span> sigma0 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">&lt;&lt;</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">&lt;&lt;</span> <span class="token number">19</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">&lt;&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> sigma1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">&lt;&lt;</span> <span class="token number">26</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>e <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">&lt;&lt;</span> <span class="token number">21</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>e <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">&lt;&lt;</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>e <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token keyword">var</span> t1 <span class="token operator">=</span> h <span class="token operator">+</span> sigma1 <span class="token operator">+</span> ch <span class="token operator">+</span> <span class="token constant">K</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token constant">W</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> t2 <span class="token operator">=</span> sigma0 <span class="token operator">+</span> maj<span class="token punctuation">;</span>

                    h <span class="token operator">=</span> g<span class="token punctuation">;</span>
                    g <span class="token operator">=</span> f<span class="token punctuation">;</span>
                    f <span class="token operator">=</span> e<span class="token punctuation">;</span>
                    e <span class="token operator">=</span> <span class="token punctuation">(</span>d <span class="token operator">+</span> t1<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    d <span class="token operator">=</span> c<span class="token punctuation">;</span>
                    c <span class="token operator">=</span> b<span class="token punctuation">;</span>
                    b <span class="token operator">=</span> a<span class="token punctuation">;</span>
                    a <span class="token operator">=</span> <span class="token punctuation">(</span>t1 <span class="token operator">+</span> t2<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Intermediate hash value</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> c<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> d<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> e<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> f<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> g<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> h<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doFinalize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_data<span class="token punctuation">;</span>
                <span class="token keyword">var</span> dataWords <span class="token operator">=</span> data<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token keyword">var</span> nBitsTotal <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_nDataBytes <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> nBitsLeft <span class="token operator">=</span> data<span class="token punctuation">.</span>sigBytes <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>

                <span class="token comment">// Add padding</span>
                dataWords<span class="token punctuation">[</span>nBitsLeft <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token number">0x80</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> nBitsLeft <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                dataWords<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsLeft <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>nBitsTotal <span class="token operator">/</span> <span class="token number">0x100000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                dataWords<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsLeft <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> nBitsTotal<span class="token punctuation">;</span>
                data<span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> dataWords<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token comment">// Hash final blocks</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Return final computed hash</span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">clone</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> clone <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                clone<span class="token punctuation">.</span>_hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> clone<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut function to the hasher's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         *
         * @return {WordArray} The hash.
         *
         * @static
         *
         * @example
         *
         *     var hash = CryptoJS.SHA256('message');
         *     var hash = CryptoJS.SHA256(wordArray);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span><span class="token constant">SHA256</span> <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span><span class="token constant">SHA256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut function to the HMAC's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         * @param {WordArray|string} key The secret key.
         *
         * @return {WordArray} The HMAC.
         *
         * @static
         *
         * @example
         *
         *     var hmac = CryptoJS.HmacSHA256(message, key);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span>HmacSHA256 <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">_createHmacHelper</span><span class="token punctuation">(</span><span class="token constant">SHA256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span>Math<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">SHA256</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">SHA256</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * SHA-224 hash algorithm.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">SHA224</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">SHA224</span> <span class="token operator">=</span> <span class="token constant">SHA256</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_hash <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WordArray<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
                    <span class="token number">0xc1059ed8</span><span class="token punctuation">,</span> <span class="token number">0x367cd507</span><span class="token punctuation">,</span> <span class="token number">0x3070dd17</span><span class="token punctuation">,</span> <span class="token number">0xf70e5939</span><span class="token punctuation">,</span>
                    <span class="token number">0xffc00b31</span><span class="token punctuation">,</span> <span class="token number">0x68581511</span><span class="token punctuation">,</span> <span class="token number">0x64f98fa7</span><span class="token punctuation">,</span> <span class="token number">0xbefa4fa4</span>
                <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doFinalize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> hash <span class="token operator">=</span> <span class="token constant">SHA256</span><span class="token punctuation">.</span><span class="token function">_doFinalize</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                hash<span class="token punctuation">.</span>sigBytes <span class="token operator">-=</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut function to the hasher's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         *
         * @return {WordArray} The hash.
         *
         * @static
         *
         * @example
         *
         *     var hash = CryptoJS.SHA224('message');
         *     var hash = CryptoJS.SHA224(wordArray);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span><span class="token constant">SHA224</span> <span class="token operator">=</span> <span class="token constant">SHA256</span><span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span><span class="token constant">SHA224</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut function to the HMAC's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         * @param {WordArray|string} key The secret key.
         *
         * @return {WordArray} The HMAC.
         *
         * @static
         *
         * @example
         *
         *     var hmac = CryptoJS.HmacSHA224(message, key);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span>HmacSHA224 <span class="token operator">=</span> <span class="token constant">SHA256</span><span class="token punctuation">.</span><span class="token function">_createHmacHelper</span><span class="token punctuation">(</span><span class="token constant">SHA224</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Hasher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>Hasher<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_x64 <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>x64<span class="token punctuation">;</span>
        <span class="token keyword">var</span> X64Word <span class="token operator">=</span> C_x64<span class="token punctuation">.</span>Word<span class="token punctuation">;</span>
        <span class="token keyword">var</span> X64WordArray <span class="token operator">=</span> C_x64<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> X64Word<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>X64Word<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Constants</span>
        <span class="token keyword">var</span> <span class="token constant">K</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x428a2f98</span><span class="token punctuation">,</span> <span class="token number">0xd728ae22</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x71374491</span><span class="token punctuation">,</span> <span class="token number">0x23ef65cd</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xb5c0fbcf</span><span class="token punctuation">,</span> <span class="token number">0xec4d3b2f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xe9b5dba5</span><span class="token punctuation">,</span> <span class="token number">0x8189dbbc</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x3956c25b</span><span class="token punctuation">,</span> <span class="token number">0xf348b538</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x59f111f1</span><span class="token punctuation">,</span> <span class="token number">0xb605d019</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x923f82a4</span><span class="token punctuation">,</span> <span class="token number">0xaf194f9b</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xab1c5ed5</span><span class="token punctuation">,</span> <span class="token number">0xda6d8118</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xd807aa98</span><span class="token punctuation">,</span> <span class="token number">0xa3030242</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x12835b01</span><span class="token punctuation">,</span> <span class="token number">0x45706fbe</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x243185be</span><span class="token punctuation">,</span> <span class="token number">0x4ee4b28c</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x550c7dc3</span><span class="token punctuation">,</span> <span class="token number">0xd5ffb4e2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x72be5d74</span><span class="token punctuation">,</span> <span class="token number">0xf27b896f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x80deb1fe</span><span class="token punctuation">,</span> <span class="token number">0x3b1696b1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x9bdc06a7</span><span class="token punctuation">,</span> <span class="token number">0x25c71235</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xc19bf174</span><span class="token punctuation">,</span> <span class="token number">0xcf692694</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xe49b69c1</span><span class="token punctuation">,</span> <span class="token number">0x9ef14ad2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xefbe4786</span><span class="token punctuation">,</span> <span class="token number">0x384f25e3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x0fc19dc6</span><span class="token punctuation">,</span> <span class="token number">0x8b8cd5b5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x240ca1cc</span><span class="token punctuation">,</span> <span class="token number">0x77ac9c65</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x2de92c6f</span><span class="token punctuation">,</span> <span class="token number">0x592b0275</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x4a7484aa</span><span class="token punctuation">,</span> <span class="token number">0x6ea6e483</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x5cb0a9dc</span><span class="token punctuation">,</span> <span class="token number">0xbd41fbd4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x76f988da</span><span class="token punctuation">,</span> <span class="token number">0x831153b5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x983e5152</span><span class="token punctuation">,</span> <span class="token number">0xee66dfab</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xa831c66d</span><span class="token punctuation">,</span> <span class="token number">0x2db43210</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xb00327c8</span><span class="token punctuation">,</span> <span class="token number">0x98fb213f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xbf597fc7</span><span class="token punctuation">,</span> <span class="token number">0xbeef0ee4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xc6e00bf3</span><span class="token punctuation">,</span> <span class="token number">0x3da88fc2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xd5a79147</span><span class="token punctuation">,</span> <span class="token number">0x930aa725</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x06ca6351</span><span class="token punctuation">,</span> <span class="token number">0xe003826f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x14292967</span><span class="token punctuation">,</span> <span class="token number">0x0a0e6e70</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x27b70a85</span><span class="token punctuation">,</span> <span class="token number">0x46d22ffc</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x2e1b2138</span><span class="token punctuation">,</span> <span class="token number">0x5c26c926</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x4d2c6dfc</span><span class="token punctuation">,</span> <span class="token number">0x5ac42aed</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x53380d13</span><span class="token punctuation">,</span> <span class="token number">0x9d95b3df</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x650a7354</span><span class="token punctuation">,</span> <span class="token number">0x8baf63de</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x766a0abb</span><span class="token punctuation">,</span> <span class="token number">0x3c77b2a8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x81c2c92e</span><span class="token punctuation">,</span> <span class="token number">0x47edaee6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x92722c85</span><span class="token punctuation">,</span> <span class="token number">0x1482353b</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xa2bfe8a1</span><span class="token punctuation">,</span> <span class="token number">0x4cf10364</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xa81a664b</span><span class="token punctuation">,</span> <span class="token number">0xbc423001</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xc24b8b70</span><span class="token punctuation">,</span> <span class="token number">0xd0f89791</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xc76c51a3</span><span class="token punctuation">,</span> <span class="token number">0x0654be30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xd192e819</span><span class="token punctuation">,</span> <span class="token number">0xd6ef5218</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xd6990624</span><span class="token punctuation">,</span> <span class="token number">0x5565a910</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xf40e3585</span><span class="token punctuation">,</span> <span class="token number">0x5771202a</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x106aa070</span><span class="token punctuation">,</span> <span class="token number">0x32bbd1b8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x19a4c116</span><span class="token punctuation">,</span> <span class="token number">0xb8d2d0c8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x1e376c08</span><span class="token punctuation">,</span> <span class="token number">0x5141ab53</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x2748774c</span><span class="token punctuation">,</span> <span class="token number">0xdf8eeb99</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x34b0bcb5</span><span class="token punctuation">,</span> <span class="token number">0xe19b48a8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x391c0cb3</span><span class="token punctuation">,</span> <span class="token number">0xc5c95a63</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x4ed8aa4a</span><span class="token punctuation">,</span> <span class="token number">0xe3418acb</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x5b9cca4f</span><span class="token punctuation">,</span> <span class="token number">0x7763e373</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x682e6ff3</span><span class="token punctuation">,</span> <span class="token number">0xd6b2b8a3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x748f82ee</span><span class="token punctuation">,</span> <span class="token number">0x5defb2fc</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x78a5636f</span><span class="token punctuation">,</span> <span class="token number">0x43172f60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x84c87814</span><span class="token punctuation">,</span> <span class="token number">0xa1f0ab72</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x8cc70208</span><span class="token punctuation">,</span> <span class="token number">0x1a6439ec</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x90befffa</span><span class="token punctuation">,</span> <span class="token number">0x23631e28</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xa4506ceb</span><span class="token punctuation">,</span> <span class="token number">0xde82bde9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xbef9a3f7</span><span class="token punctuation">,</span> <span class="token number">0xb2c67915</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xc67178f2</span><span class="token punctuation">,</span> <span class="token number">0xe372532b</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xca273ece</span><span class="token punctuation">,</span> <span class="token number">0xea26619c</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xd186b8c7</span><span class="token punctuation">,</span> <span class="token number">0x21c0c207</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xeada7dd6</span><span class="token punctuation">,</span> <span class="token number">0xcde0eb1e</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0xf57d4f7f</span><span class="token punctuation">,</span> <span class="token number">0xee6ed178</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x06f067aa</span><span class="token punctuation">,</span> <span class="token number">0x72176fba</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x0a637dc5</span><span class="token punctuation">,</span> <span class="token number">0xa2c898a6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x113f9804</span><span class="token punctuation">,</span> <span class="token number">0xbef90dae</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x1b710b35</span><span class="token punctuation">,</span> <span class="token number">0x131c471b</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x28db77f5</span><span class="token punctuation">,</span> <span class="token number">0x23047d84</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x32caab7b</span><span class="token punctuation">,</span> <span class="token number">0x40c72493</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x3c9ebe0a</span><span class="token punctuation">,</span> <span class="token number">0x15c9bebc</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x431d67c4</span><span class="token punctuation">,</span> <span class="token number">0x9c100d4c</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x4cc5d4be</span><span class="token punctuation">,</span> <span class="token number">0xcb3e42b6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x597f299c</span><span class="token punctuation">,</span> <span class="token number">0xfc657e2a</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x5fcb6fab</span><span class="token punctuation">,</span> <span class="token number">0x3ad6faec</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token number">0x6c44198c</span><span class="token punctuation">,</span> <span class="token number">0x4a475817</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// Reusable objects</span>
        <span class="token keyword">var</span> <span class="token constant">W</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">80</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token constant">W</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">X64Word_create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * SHA-512 hash algorithm.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">SHA512</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">SHA512</span> <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_hash <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X64WordArray<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
                    <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0x6a09e667</span><span class="token punctuation">,</span> <span class="token number">0xf3bcc908</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0xbb67ae85</span><span class="token punctuation">,</span> <span class="token number">0x84caa73b</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0x3c6ef372</span><span class="token punctuation">,</span> <span class="token number">0xfe94f82b</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0xa54ff53a</span><span class="token punctuation">,</span> <span class="token number">0x5f1d36f1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0x510e527f</span><span class="token punctuation">,</span> <span class="token number">0xade682d1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0x9b05688c</span><span class="token punctuation">,</span> <span class="token number">0x2b3e6c1f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0x1f83d9ab</span><span class="token punctuation">,</span> <span class="token number">0xfb41bd6b</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0x5be0cd19</span><span class="token punctuation">,</span> <span class="token number">0x137e2179</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doProcessBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> <span class="token constant">H</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token keyword">var</span> <span class="token constant">H0</span> <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> <span class="token constant">H1</span> <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> <span class="token constant">H2</span> <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> <span class="token constant">H3</span> <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> <span class="token constant">H4</span> <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> <span class="token constant">H5</span> <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> <span class="token constant">H6</span> <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> <span class="token constant">H7</span> <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token keyword">var</span> H0h <span class="token operator">=</span> <span class="token constant">H0</span><span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H0l <span class="token operator">=</span> <span class="token constant">H0</span><span class="token punctuation">.</span>low<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H1h <span class="token operator">=</span> <span class="token constant">H1</span><span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H1l <span class="token operator">=</span> <span class="token constant">H1</span><span class="token punctuation">.</span>low<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H2h <span class="token operator">=</span> <span class="token constant">H2</span><span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H2l <span class="token operator">=</span> <span class="token constant">H2</span><span class="token punctuation">.</span>low<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H3h <span class="token operator">=</span> <span class="token constant">H3</span><span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H3l <span class="token operator">=</span> <span class="token constant">H3</span><span class="token punctuation">.</span>low<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H4h <span class="token operator">=</span> <span class="token constant">H4</span><span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H4l <span class="token operator">=</span> <span class="token constant">H4</span><span class="token punctuation">.</span>low<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H5h <span class="token operator">=</span> <span class="token constant">H5</span><span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H5l <span class="token operator">=</span> <span class="token constant">H5</span><span class="token punctuation">.</span>low<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H6h <span class="token operator">=</span> <span class="token constant">H6</span><span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H6l <span class="token operator">=</span> <span class="token constant">H6</span><span class="token punctuation">.</span>low<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H7h <span class="token operator">=</span> <span class="token constant">H7</span><span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                <span class="token keyword">var</span> H7l <span class="token operator">=</span> <span class="token constant">H7</span><span class="token punctuation">.</span>low<span class="token punctuation">;</span>

                <span class="token comment">// Working variables</span>
                <span class="token keyword">var</span> ah <span class="token operator">=</span> H0h<span class="token punctuation">;</span>
                <span class="token keyword">var</span> al <span class="token operator">=</span> H0l<span class="token punctuation">;</span>
                <span class="token keyword">var</span> bh <span class="token operator">=</span> H1h<span class="token punctuation">;</span>
                <span class="token keyword">var</span> bl <span class="token operator">=</span> H1l<span class="token punctuation">;</span>
                <span class="token keyword">var</span> ch <span class="token operator">=</span> H2h<span class="token punctuation">;</span>
                <span class="token keyword">var</span> cl <span class="token operator">=</span> H2l<span class="token punctuation">;</span>
                <span class="token keyword">var</span> dh <span class="token operator">=</span> H3h<span class="token punctuation">;</span>
                <span class="token keyword">var</span> dl <span class="token operator">=</span> H3l<span class="token punctuation">;</span>
                <span class="token keyword">var</span> eh <span class="token operator">=</span> H4h<span class="token punctuation">;</span>
                <span class="token keyword">var</span> el <span class="token operator">=</span> H4l<span class="token punctuation">;</span>
                <span class="token keyword">var</span> fh <span class="token operator">=</span> H5h<span class="token punctuation">;</span>
                <span class="token keyword">var</span> fl <span class="token operator">=</span> H5l<span class="token punctuation">;</span>
                <span class="token keyword">var</span> gh <span class="token operator">=</span> H6h<span class="token punctuation">;</span>
                <span class="token keyword">var</span> gl <span class="token operator">=</span> H6l<span class="token punctuation">;</span>
                <span class="token keyword">var</span> hh <span class="token operator">=</span> H7h<span class="token punctuation">;</span>
                <span class="token keyword">var</span> hl <span class="token operator">=</span> H7l<span class="token punctuation">;</span>

                <span class="token comment">// Rounds</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">80</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> Wil<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> Wih<span class="token punctuation">;</span>

                    <span class="token comment">// Shortcut</span>
                    <span class="token keyword">var</span> Wi <span class="token operator">=</span> <span class="token constant">W</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

                    <span class="token comment">// Extend message</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        Wih <span class="token operator">=</span> Wi<span class="token punctuation">.</span>high <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                        Wil <span class="token operator">=</span> Wi<span class="token punctuation">.</span>low <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> i <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">// Gamma0</span>
                        <span class="token keyword">var</span> gamma0x <span class="token operator">=</span> <span class="token constant">W</span><span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> gamma0xh <span class="token operator">=</span> gamma0x<span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                        <span class="token keyword">var</span> gamma0xl <span class="token operator">=</span> gamma0x<span class="token punctuation">.</span>low<span class="token punctuation">;</span>
                        <span class="token keyword">var</span> gamma0h <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>gamma0xh <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>gamma0xl <span class="token operator">&lt;&lt;</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>gamma0xh <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>gamma0xl <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>gamma0xh <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> gamma0l <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>gamma0xl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>gamma0xh <span class="token operator">&lt;&lt;</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>gamma0xl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>gamma0xh <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>gamma0xl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>gamma0xh <span class="token operator">&lt;&lt;</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                        <span class="token comment">// Gamma1</span>
                        <span class="token keyword">var</span> gamma1x <span class="token operator">=</span> <span class="token constant">W</span><span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> gamma1xh <span class="token operator">=</span> gamma1x<span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                        <span class="token keyword">var</span> gamma1xl <span class="token operator">=</span> gamma1x<span class="token punctuation">.</span>low<span class="token punctuation">;</span>
                        <span class="token keyword">var</span> gamma1h <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>gamma1xh <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">19</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>gamma1xl <span class="token operator">&lt;&lt;</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>gamma1xh <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>gamma1xl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>gamma1xh <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> gamma1l <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>gamma1xl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">19</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>gamma1xh <span class="token operator">&lt;&lt;</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>gamma1xl <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>gamma1xh <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>gamma1xl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>gamma1xh <span class="token operator">&lt;&lt;</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                        <span class="token comment">// W[i] = gamma0 + W[i - 7] + gamma1 + W[i - 16]</span>
                        <span class="token keyword">var</span> Wi7 <span class="token operator">=</span> <span class="token constant">W</span><span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> Wi7h <span class="token operator">=</span> Wi7<span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                        <span class="token keyword">var</span> Wi7l <span class="token operator">=</span> Wi7<span class="token punctuation">.</span>low<span class="token punctuation">;</span>

                        <span class="token keyword">var</span> Wi16 <span class="token operator">=</span> <span class="token constant">W</span><span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> Wi16h <span class="token operator">=</span> Wi16<span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                        <span class="token keyword">var</span> Wi16l <span class="token operator">=</span> Wi16<span class="token punctuation">.</span>low<span class="token punctuation">;</span>

                        Wil <span class="token operator">=</span> gamma0l <span class="token operator">+</span> Wi7l<span class="token punctuation">;</span>
                        Wih <span class="token operator">=</span> gamma0h <span class="token operator">+</span> Wi7h <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Wil <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>gamma0l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        Wil <span class="token operator">=</span> Wil <span class="token operator">+</span> gamma1l<span class="token punctuation">;</span>
                        Wih <span class="token operator">=</span> Wih <span class="token operator">+</span> gamma1h <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Wil <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>gamma1l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        Wil <span class="token operator">=</span> Wil <span class="token operator">+</span> Wi16l<span class="token punctuation">;</span>
                        Wih <span class="token operator">=</span> Wih <span class="token operator">+</span> Wi16h <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Wil <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>Wi16l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                        Wi<span class="token punctuation">.</span>high <span class="token operator">=</span> Wih<span class="token punctuation">;</span>
                        Wi<span class="token punctuation">.</span>low <span class="token operator">=</span> Wil<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token keyword">var</span> chh <span class="token operator">=</span> <span class="token punctuation">(</span>eh <span class="token operator">&amp;</span> fh<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token operator">~</span>eh <span class="token operator">&amp;</span> gh<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> chl <span class="token operator">=</span> <span class="token punctuation">(</span>el <span class="token operator">&amp;</span> fl<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token operator">~</span>el <span class="token operator">&amp;</span> gl<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> majh <span class="token operator">=</span> <span class="token punctuation">(</span>ah <span class="token operator">&amp;</span> bh<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>ah <span class="token operator">&amp;</span> ch<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>bh <span class="token operator">&amp;</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> majl <span class="token operator">=</span> <span class="token punctuation">(</span>al <span class="token operator">&amp;</span> bl<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>al <span class="token operator">&amp;</span> cl<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>bl <span class="token operator">&amp;</span> cl<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token keyword">var</span> sigma0h <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ah <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">28</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>al <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ah <span class="token operator">&lt;&lt;</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>al <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ah <span class="token operator">&lt;&lt;</span> <span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>al <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> sigma0l <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>al <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">28</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>ah <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>al <span class="token operator">&lt;&lt;</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>ah <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>al <span class="token operator">&lt;&lt;</span> <span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>ah <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> sigma1h <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>eh <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">14</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>el <span class="token operator">&lt;&lt;</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>eh <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">18</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>el <span class="token operator">&lt;&lt;</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>eh <span class="token operator">&lt;&lt;</span> <span class="token number">23</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>el <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> sigma1l <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>el <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">14</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>eh <span class="token operator">&lt;&lt;</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>el <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">18</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>eh <span class="token operator">&lt;&lt;</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>el <span class="token operator">&lt;&lt;</span> <span class="token number">23</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>eh <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// t1 = h + sigma1 + ch + K[i] + W[i]</span>
                    <span class="token keyword">var</span> Ki <span class="token operator">=</span> <span class="token constant">K</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> Kih <span class="token operator">=</span> Ki<span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> Kil <span class="token operator">=</span> Ki<span class="token punctuation">.</span>low<span class="token punctuation">;</span>

                    <span class="token keyword">var</span> t1l <span class="token operator">=</span> hl <span class="token operator">+</span> sigma1l<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> t1h <span class="token operator">=</span> hh <span class="token operator">+</span> sigma1h <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>t1l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>hl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> t1l <span class="token operator">=</span> t1l <span class="token operator">+</span> chl<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> t1h <span class="token operator">=</span> t1h <span class="token operator">+</span> chh <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>t1l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>chl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> t1l <span class="token operator">=</span> t1l <span class="token operator">+</span> Kil<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> t1h <span class="token operator">=</span> t1h <span class="token operator">+</span> Kih <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>t1l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>Kil <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> t1l <span class="token operator">=</span> t1l <span class="token operator">+</span> Wil<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> t1h <span class="token operator">=</span> t1h <span class="token operator">+</span> Wih <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>t1l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>Wil <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// t2 = sigma0 + maj</span>
                    <span class="token keyword">var</span> t2l <span class="token operator">=</span> sigma0l <span class="token operator">+</span> majl<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> t2h <span class="token operator">=</span> sigma0h <span class="token operator">+</span> majh <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>t2l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>sigma0l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Update working variables</span>
                    hh <span class="token operator">=</span> gh<span class="token punctuation">;</span>
                    hl <span class="token operator">=</span> gl<span class="token punctuation">;</span>
                    gh <span class="token operator">=</span> fh<span class="token punctuation">;</span>
                    gl <span class="token operator">=</span> fl<span class="token punctuation">;</span>
                    fh <span class="token operator">=</span> eh<span class="token punctuation">;</span>
                    fl <span class="token operator">=</span> el<span class="token punctuation">;</span>
                    el <span class="token operator">=</span> <span class="token punctuation">(</span>dl <span class="token operator">+</span> t1l<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    eh <span class="token operator">=</span> <span class="token punctuation">(</span>dh <span class="token operator">+</span> t1h <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>el <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>dl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    dh <span class="token operator">=</span> ch<span class="token punctuation">;</span>
                    dl <span class="token operator">=</span> cl<span class="token punctuation">;</span>
                    ch <span class="token operator">=</span> bh<span class="token punctuation">;</span>
                    cl <span class="token operator">=</span> bl<span class="token punctuation">;</span>
                    bh <span class="token operator">=</span> ah<span class="token punctuation">;</span>
                    bl <span class="token operator">=</span> al<span class="token punctuation">;</span>
                    al <span class="token operator">=</span> <span class="token punctuation">(</span>t1l <span class="token operator">+</span> t2l<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    ah <span class="token operator">=</span> <span class="token punctuation">(</span>t1h <span class="token operator">+</span> t2h <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>al <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>t1l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Intermediate hash value</span>
                H0l <span class="token operator">=</span> <span class="token constant">H0</span><span class="token punctuation">.</span>low <span class="token operator">=</span> <span class="token punctuation">(</span>H0l <span class="token operator">+</span> al<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">H0</span><span class="token punctuation">.</span>high <span class="token operator">=</span> <span class="token punctuation">(</span>H0h <span class="token operator">+</span> ah <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>H0l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>al <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                H1l <span class="token operator">=</span> <span class="token constant">H1</span><span class="token punctuation">.</span>low <span class="token operator">=</span> <span class="token punctuation">(</span>H1l <span class="token operator">+</span> bl<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">H1</span><span class="token punctuation">.</span>high <span class="token operator">=</span> <span class="token punctuation">(</span>H1h <span class="token operator">+</span> bh <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>H1l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>bl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                H2l <span class="token operator">=</span> <span class="token constant">H2</span><span class="token punctuation">.</span>low <span class="token operator">=</span> <span class="token punctuation">(</span>H2l <span class="token operator">+</span> cl<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">H2</span><span class="token punctuation">.</span>high <span class="token operator">=</span> <span class="token punctuation">(</span>H2h <span class="token operator">+</span> ch <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>H2l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>cl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                H3l <span class="token operator">=</span> <span class="token constant">H3</span><span class="token punctuation">.</span>low <span class="token operator">=</span> <span class="token punctuation">(</span>H3l <span class="token operator">+</span> dl<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">H3</span><span class="token punctuation">.</span>high <span class="token operator">=</span> <span class="token punctuation">(</span>H3h <span class="token operator">+</span> dh <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>H3l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>dl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                H4l <span class="token operator">=</span> <span class="token constant">H4</span><span class="token punctuation">.</span>low <span class="token operator">=</span> <span class="token punctuation">(</span>H4l <span class="token operator">+</span> el<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">H4</span><span class="token punctuation">.</span>high <span class="token operator">=</span> <span class="token punctuation">(</span>H4h <span class="token operator">+</span> eh <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>H4l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>el <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                H5l <span class="token operator">=</span> <span class="token constant">H5</span><span class="token punctuation">.</span>low <span class="token operator">=</span> <span class="token punctuation">(</span>H5l <span class="token operator">+</span> fl<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">H5</span><span class="token punctuation">.</span>high <span class="token operator">=</span> <span class="token punctuation">(</span>H5h <span class="token operator">+</span> fh <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>H5l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>fl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                H6l <span class="token operator">=</span> <span class="token constant">H6</span><span class="token punctuation">.</span>low <span class="token operator">=</span> <span class="token punctuation">(</span>H6l <span class="token operator">+</span> gl<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">H6</span><span class="token punctuation">.</span>high <span class="token operator">=</span> <span class="token punctuation">(</span>H6h <span class="token operator">+</span> gh <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>H6l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>gl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                H7l <span class="token operator">=</span> <span class="token constant">H7</span><span class="token punctuation">.</span>low <span class="token operator">=</span> <span class="token punctuation">(</span>H7l <span class="token operator">+</span> hl<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">H7</span><span class="token punctuation">.</span>high <span class="token operator">=</span> <span class="token punctuation">(</span>H7h <span class="token operator">+</span> hh <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>H7l <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>hl <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doFinalize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_data<span class="token punctuation">;</span>
                <span class="token keyword">var</span> dataWords <span class="token operator">=</span> data<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token keyword">var</span> nBitsTotal <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_nDataBytes <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> nBitsLeft <span class="token operator">=</span> data<span class="token punctuation">.</span>sigBytes <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>

                <span class="token comment">// Add padding</span>
                dataWords<span class="token punctuation">[</span>nBitsLeft <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token number">0x80</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> nBitsLeft <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                dataWords<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsLeft <span class="token operator">+</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>nBitsTotal <span class="token operator">/</span> <span class="token number">0x100000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                dataWords<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsLeft <span class="token operator">+</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">=</span> nBitsTotal<span class="token punctuation">;</span>
                data<span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> dataWords<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token comment">// Hash final blocks</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Convert hash to 32-bit word array before returning</span>
                <span class="token keyword">var</span> hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">.</span><span class="token function">toX32</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Return final computed hash</span>
                <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">clone</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> clone <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                clone<span class="token punctuation">.</span>_hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> clone<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            blockSize<span class="token operator">:</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">32</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut function to the hasher's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         *
         * @return {WordArray} The hash.
         *
         * @static
         *
         * @example
         *
         *     var hash = CryptoJS.SHA512('message');
         *     var hash = CryptoJS.SHA512(wordArray);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span><span class="token constant">SHA512</span> <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span><span class="token constant">SHA512</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut function to the HMAC's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         * @param {WordArray|string} key The secret key.
         *
         * @return {WordArray} The HMAC.
         *
         * @static
         *
         * @example
         *
         *     var hmac = CryptoJS.HmacSHA512(message, key);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span>HmacSHA512 <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">_createHmacHelper</span><span class="token punctuation">(</span><span class="token constant">SHA512</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_x64 <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>x64<span class="token punctuation">;</span>
        <span class="token keyword">var</span> X64Word <span class="token operator">=</span> C_x64<span class="token punctuation">.</span>Word<span class="token punctuation">;</span>
        <span class="token keyword">var</span> X64WordArray <span class="token operator">=</span> C_x64<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">SHA512</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">SHA512</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * SHA-384 hash algorithm.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">SHA384</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">SHA384</span> <span class="token operator">=</span> <span class="token constant">SHA512</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_hash <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X64WordArray<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
                    <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0xcbbb9d5d</span><span class="token punctuation">,</span> <span class="token number">0xc1059ed8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0x629a292a</span><span class="token punctuation">,</span> <span class="token number">0x367cd507</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0x9159015a</span><span class="token punctuation">,</span> <span class="token number">0x3070dd17</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0x152fecd8</span><span class="token punctuation">,</span> <span class="token number">0xf70e5939</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0x67332667</span><span class="token punctuation">,</span> <span class="token number">0xffc00b31</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0x8eb44a87</span><span class="token punctuation">,</span> <span class="token number">0x68581511</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0xdb0c2e0d</span><span class="token punctuation">,</span> <span class="token number">0x64f98fa7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token number">0x47b5481d</span><span class="token punctuation">,</span> <span class="token number">0xbefa4fa4</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doFinalize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> hash <span class="token operator">=</span> <span class="token constant">SHA512</span><span class="token punctuation">.</span><span class="token function">_doFinalize</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                hash<span class="token punctuation">.</span>sigBytes <span class="token operator">-=</span> <span class="token number">16</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut function to the hasher's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         *
         * @return {WordArray} The hash.
         *
         * @static
         *
         * @example
         *
         *     var hash = CryptoJS.SHA384('message');
         *     var hash = CryptoJS.SHA384(wordArray);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span><span class="token constant">SHA384</span> <span class="token operator">=</span> <span class="token constant">SHA512</span><span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span><span class="token constant">SHA384</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut function to the HMAC's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         * @param {WordArray|string} key The secret key.
         *
         * @return {WordArray} The HMAC.
         *
         * @static
         *
         * @example
         *
         *     var hmac = CryptoJS.HmacSHA384(message, key);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span>HmacSHA384 <span class="token operator">=</span> <span class="token constant">SHA512</span><span class="token punctuation">.</span><span class="token function">_createHmacHelper</span><span class="token punctuation">(</span><span class="token constant">SHA384</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">Math</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Hasher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>Hasher<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_x64 <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>x64<span class="token punctuation">;</span>
        <span class="token keyword">var</span> X64Word <span class="token operator">=</span> C_x64<span class="token punctuation">.</span>Word<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>

        <span class="token comment">// Constants tables</span>
        <span class="token keyword">var</span> <span class="token constant">RHO_OFFSETS</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">PI_INDEXES</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">ROUND_CONSTANTS</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// Compute Constants</span>
        <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Compute rho offset constants</span>
            <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
                y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> t <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> t<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token constant">RHO_OFFSETS</span><span class="token punctuation">[</span>x <span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">*</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>t <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>t <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">64</span><span class="token punctuation">;</span>

                <span class="token keyword">var</span> newX <span class="token operator">=</span> y <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> newY <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> x <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> y<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">;</span>
                x <span class="token operator">=</span> newX<span class="token punctuation">;</span>
                y <span class="token operator">=</span> newY<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Compute pi index constants</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> y <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> y<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token constant">PI_INDEXES</span><span class="token punctuation">[</span>x <span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">*</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> y <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> x <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> y<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Compute round constants</span>
            <span class="token keyword">var</span> <span class="token constant">LFSR</span> <span class="token operator">=</span> <span class="token number">0x01</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> roundConstantMsw <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> roundConstantLsw <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">7</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">LFSR</span> <span class="token operator">&amp;</span> <span class="token number">0x01</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">var</span> bitPosition <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> j<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>bitPosition <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            roundConstantLsw <span class="token operator">^=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> bitPosition<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token comment">/* if (bitPosition &gt;= 32) */</span> <span class="token punctuation">{<!-- --></span>
                            roundConstantMsw <span class="token operator">^=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>bitPosition <span class="token operator">-</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// Compute next LFSR</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">LFSR</span> <span class="token operator">&amp;</span> <span class="token number">0x80</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">// Primitive polynomial over GF(2): x^8 + x^6 + x^5 + x^4 + 1</span>
                        <span class="token constant">LFSR</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">LFSR</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x71</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token constant">LFSR</span> <span class="token operator">&lt;&lt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

                <span class="token constant">ROUND_CONSTANTS</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> X64Word<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>roundConstantMsw<span class="token punctuation">,</span> roundConstantLsw<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Reusable objects for temporary values</span>
        <span class="token keyword">var</span> <span class="token constant">T</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">25</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token constant">T</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> X64Word<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * SHA-3 hash algorithm.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">SHA3</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">SHA3</span> <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Configuration options.
             *
             * @property {number} outputLength
             *   The desired number of bits in the output hash.
             *   Only values permitted are: 224, 256, 384, 512.
             *   Default: 512
             */</span>
            cfg<span class="token operator">:</span> Hasher<span class="token punctuation">.</span>cfg<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                outputLength<span class="token operator">:</span> <span class="token number">512</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> state <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">25</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    state<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X64Word<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">this</span><span class="token punctuation">.</span>blockSize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1600</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span>outputLength<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doProcessBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> state <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_state<span class="token punctuation">;</span>
                <span class="token keyword">var</span> nBlockSizeLanes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>blockSize <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>

                <span class="token comment">// Absorb</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nBlockSizeLanes<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Shortcuts</span>
                    <span class="token keyword">var</span> M2i <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> M2i1 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                    <span class="token comment">// Swap endian</span>
                    M2i <span class="token operator">=</span> <span class="token punctuation">(</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>M2i <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>M2i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>M2i <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>M2i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">;</span>
                    M2i1 <span class="token operator">=</span> <span class="token punctuation">(</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>M2i1 <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>M2i1 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>M2i1 <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>M2i1 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Absorb message into state</span>
                    <span class="token keyword">var</span> lane <span class="token operator">=</span> state<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    lane<span class="token punctuation">.</span>high <span class="token operator">^=</span> M2i1<span class="token punctuation">;</span>
                    lane<span class="token punctuation">.</span>low <span class="token operator">^=</span> M2i<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Rounds</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> round <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> round <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> round<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Theta</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">// Mix column lanes</span>
                        <span class="token keyword">var</span> tMsw <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
                            tLsw <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> y <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> y<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token keyword">var</span> lane <span class="token operator">=</span> state<span class="token punctuation">[</span>x <span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">*</span> y<span class="token punctuation">]</span><span class="token punctuation">;</span>
                            tMsw <span class="token operator">^=</span> lane<span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                            tLsw <span class="token operator">^=</span> lane<span class="token punctuation">.</span>low<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>

                        <span class="token comment">// Temporary values</span>
                        <span class="token keyword">var</span> Tx <span class="token operator">=</span> <span class="token constant">T</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
                        Tx<span class="token punctuation">.</span>high <span class="token operator">=</span> tMsw<span class="token punctuation">;</span>
                        Tx<span class="token punctuation">.</span>low <span class="token operator">=</span> tLsw<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">// Shortcuts</span>
                        <span class="token keyword">var</span> Tx4 <span class="token operator">=</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> Tx1 <span class="token operator">=</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> Tx1Msw <span class="token operator">=</span> Tx1<span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                        <span class="token keyword">var</span> Tx1Lsw <span class="token operator">=</span> Tx1<span class="token punctuation">.</span>low<span class="token punctuation">;</span>

                        <span class="token comment">// Mix surrounding columns</span>
                        <span class="token keyword">var</span> tMsw <span class="token operator">=</span> Tx4<span class="token punctuation">.</span>high <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Tx1Msw <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>Tx1Lsw <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> tLsw <span class="token operator">=</span> Tx4<span class="token punctuation">.</span>low <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Tx1Lsw <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>Tx1Msw <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> y <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> y<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token keyword">var</span> lane <span class="token operator">=</span> state<span class="token punctuation">[</span>x <span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">*</span> y<span class="token punctuation">]</span><span class="token punctuation">;</span>
                            lane<span class="token punctuation">.</span>high <span class="token operator">^=</span> tMsw<span class="token punctuation">;</span>
                            lane<span class="token punctuation">.</span>low <span class="token operator">^=</span> tLsw<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// Rho Pi</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> laneIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> laneIndex <span class="token operator">&lt;</span> <span class="token number">25</span><span class="token punctuation">;</span> laneIndex<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">var</span> tMsw<span class="token punctuation">;</span>
                        <span class="token keyword">var</span> tLsw<span class="token punctuation">;</span>

                        <span class="token comment">// Shortcuts</span>
                        <span class="token keyword">var</span> lane <span class="token operator">=</span> state<span class="token punctuation">[</span>laneIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token keyword">var</span> laneMsw <span class="token operator">=</span> lane<span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                        <span class="token keyword">var</span> laneLsw <span class="token operator">=</span> lane<span class="token punctuation">.</span>low<span class="token punctuation">;</span>
                        <span class="token keyword">var</span> rhoOffset <span class="token operator">=</span> <span class="token constant">RHO_OFFSETS</span><span class="token punctuation">[</span>laneIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>

                        <span class="token comment">// Rotate lanes</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>rhoOffset <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tMsw <span class="token operator">=</span> <span class="token punctuation">(</span>laneMsw <span class="token operator">&lt;&lt;</span> rhoOffset<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>laneLsw <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> rhoOffset<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            tLsw <span class="token operator">=</span> <span class="token punctuation">(</span>laneLsw <span class="token operator">&lt;&lt;</span> rhoOffset<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>laneMsw <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> rhoOffset<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token comment">/* if (rhoOffset &gt;= 32) */</span> <span class="token punctuation">{<!-- --></span>
                            tMsw <span class="token operator">=</span> <span class="token punctuation">(</span>laneLsw <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>rhoOffset <span class="token operator">-</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>laneMsw <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">64</span> <span class="token operator">-</span> rhoOffset<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            tLsw <span class="token operator">=</span> <span class="token punctuation">(</span>laneMsw <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>rhoOffset <span class="token operator">-</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>laneLsw <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">64</span> <span class="token operator">-</span> rhoOffset<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>

                        <span class="token comment">// Transpose lanes</span>
                        <span class="token keyword">var</span> TPiLane <span class="token operator">=</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">PI_INDEXES</span><span class="token punctuation">[</span>laneIndex<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        TPiLane<span class="token punctuation">.</span>high <span class="token operator">=</span> tMsw<span class="token punctuation">;</span>
                        TPiLane<span class="token punctuation">.</span>low <span class="token operator">=</span> tLsw<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// Rho pi at x = y = 0</span>
                    <span class="token keyword">var</span> <span class="token constant">T0</span> <span class="token operator">=</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> state0 <span class="token operator">=</span> state<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token constant">T0</span><span class="token punctuation">.</span>high <span class="token operator">=</span> state0<span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                    <span class="token constant">T0</span><span class="token punctuation">.</span>low <span class="token operator">=</span> state0<span class="token punctuation">.</span>low<span class="token punctuation">;</span>

                    <span class="token comment">// Chi</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> y <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> y<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token comment">// Shortcuts</span>
                            <span class="token keyword">var</span> laneIndex <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">*</span> y<span class="token punctuation">;</span>
                            <span class="token keyword">var</span> lane <span class="token operator">=</span> state<span class="token punctuation">[</span>laneIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                            <span class="token keyword">var</span> TLane <span class="token operator">=</span> <span class="token constant">T</span><span class="token punctuation">[</span>laneIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
                            <span class="token keyword">var</span> Tx1Lane <span class="token operator">=</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">*</span> y<span class="token punctuation">]</span><span class="token punctuation">;</span>
                            <span class="token keyword">var</span> Tx2Lane <span class="token operator">=</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">5</span> <span class="token operator">*</span> y<span class="token punctuation">]</span><span class="token punctuation">;</span>

                            <span class="token comment">// Mix rows</span>
                            lane<span class="token punctuation">.</span>high <span class="token operator">=</span> TLane<span class="token punctuation">.</span>high <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token operator">~</span>Tx1Lane<span class="token punctuation">.</span>high <span class="token operator">&amp;</span> Tx2Lane<span class="token punctuation">.</span>high<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            lane<span class="token punctuation">.</span>low <span class="token operator">=</span> TLane<span class="token punctuation">.</span>low <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token operator">~</span>Tx1Lane<span class="token punctuation">.</span>low <span class="token operator">&amp;</span> Tx2Lane<span class="token punctuation">.</span>low<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// Iota</span>
                    <span class="token keyword">var</span> lane <span class="token operator">=</span> state<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> roundConstant <span class="token operator">=</span> <span class="token constant">ROUND_CONSTANTS</span><span class="token punctuation">[</span>round<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    lane<span class="token punctuation">.</span>high <span class="token operator">^=</span> roundConstant<span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                    lane<span class="token punctuation">.</span>low <span class="token operator">^=</span> roundConstant<span class="token punctuation">.</span>low<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doFinalize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_data<span class="token punctuation">;</span>
                <span class="token keyword">var</span> dataWords <span class="token operator">=</span> data<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> nBitsTotal <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_nDataBytes <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> nBitsLeft <span class="token operator">=</span> data<span class="token punctuation">.</span>sigBytes <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> blockSizeBits <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>blockSize <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">;</span>

                <span class="token comment">// Add padding</span>
                dataWords<span class="token punctuation">[</span>nBitsLeft <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token number">0x1</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> nBitsLeft <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                dataWords<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsLeft <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> blockSizeBits<span class="token punctuation">)</span> <span class="token operator">*</span> blockSizeBits<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token number">0x80</span><span class="token punctuation">;</span>
                data<span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> dataWords<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token comment">// Hash final blocks</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> state <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_state<span class="token punctuation">;</span>
                <span class="token keyword">var</span> outputLengthBytes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span>outputLength <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> outputLengthLanes <span class="token operator">=</span> outputLengthBytes <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">;</span>

                <span class="token comment">// Squeeze</span>
                <span class="token keyword">var</span> hashWords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> outputLengthLanes<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Shortcuts</span>
                    <span class="token keyword">var</span> lane <span class="token operator">=</span> state<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> laneMsw <span class="token operator">=</span> lane<span class="token punctuation">.</span>high<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> laneLsw <span class="token operator">=</span> lane<span class="token punctuation">.</span>low<span class="token punctuation">;</span>

                    <span class="token comment">// Swap endian</span>
                    laneMsw <span class="token operator">=</span> <span class="token punctuation">(</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>laneMsw <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>laneMsw <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>laneMsw <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>laneMsw <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">;</span>
                    laneLsw <span class="token operator">=</span> <span class="token punctuation">(</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>laneLsw <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>laneLsw <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>laneLsw <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>laneLsw <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Squeeze state to retrieve hash</span>
                    hashWords<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>laneLsw<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    hashWords<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>laneMsw<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Return final computed hash</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WordArray<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span>hashWords<span class="token punctuation">,</span> outputLengthBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">clone</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> clone <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">var</span> state <span class="token operator">=</span> clone<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_state<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">25</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    state<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> state<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> clone<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut function to the hasher's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         *
         * @return {WordArray} The hash.
         *
         * @static
         *
         * @example
         *
         *     var hash = CryptoJS.SHA3('message');
         *     var hash = CryptoJS.SHA3(wordArray);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span><span class="token constant">SHA3</span> <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span><span class="token constant">SHA3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut function to the HMAC's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         * @param {WordArray|string} key The secret key.
         *
         * @return {WordArray} The HMAC.
         *
         * @static
         *
         * @example
         *
         *     var hmac = CryptoJS.HmacSHA3(message, key);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span>HmacSHA3 <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">_createHmacHelper</span><span class="token punctuation">(</span><span class="token constant">SHA3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span>Math<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token comment">/** @preserve
    (c) 2012 by Cédric Mesnil. All rights reserved.

    Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

        - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
        - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    */</span>

    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">Math</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Hasher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>Hasher<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>

        <span class="token comment">// Constants table</span>
        <span class="token keyword">var</span> _zl <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>
            <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
            <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>
            <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">13</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> _zr <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>
            <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>
            <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>
            <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> _sl <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
            <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>
            <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>
            <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> _sr <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span>
            <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>
            <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
            <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">11</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">var</span> _hl <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0x00000000</span><span class="token punctuation">,</span> <span class="token number">0x5A827999</span><span class="token punctuation">,</span> <span class="token number">0x6ED9EBA1</span><span class="token punctuation">,</span> <span class="token number">0x8F1BBCDC</span><span class="token punctuation">,</span> <span class="token number">0xA953FD4E</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> _hr <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0x50A28BE6</span><span class="token punctuation">,</span> <span class="token number">0x5C4DD124</span><span class="token punctuation">,</span> <span class="token number">0x6D703EF3</span><span class="token punctuation">,</span> <span class="token number">0x7A6D76E9</span><span class="token punctuation">,</span> <span class="token number">0x00000000</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * RIPEMD160 hash algorithm.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">RIPEMD160</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">RIPEMD160</span> <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_hash <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0x67452301</span><span class="token punctuation">,</span> <span class="token number">0xEFCDAB89</span><span class="token punctuation">,</span> <span class="token number">0x98BADCFE</span><span class="token punctuation">,</span> <span class="token number">0x10325476</span><span class="token punctuation">,</span> <span class="token number">0xC3D2E1F0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doProcessBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

                <span class="token comment">// Swap endian</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Shortcuts</span>
                    <span class="token keyword">var</span> offset_i <span class="token operator">=</span> offset <span class="token operator">+</span> i<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> M_offset_i <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset_i<span class="token punctuation">]</span><span class="token punctuation">;</span>

                    <span class="token comment">// Swap</span>
                    <span class="token constant">M</span><span class="token punctuation">[</span>offset_i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>M_offset_i <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>M_offset_i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>M_offset_i <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>M_offset_i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> <span class="token constant">H</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> hl <span class="token operator">=</span> _hl<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> hr <span class="token operator">=</span> _hr<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> zl <span class="token operator">=</span> _zl<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> zr <span class="token operator">=</span> _zr<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> sl <span class="token operator">=</span> _sl<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> sr <span class="token operator">=</span> _sr<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token comment">// Working variables</span>
                <span class="token keyword">var</span> al<span class="token punctuation">,</span> bl<span class="token punctuation">,</span> cl<span class="token punctuation">,</span> dl<span class="token punctuation">,</span> el<span class="token punctuation">;</span>
                <span class="token keyword">var</span> ar<span class="token punctuation">,</span> br<span class="token punctuation">,</span> cr<span class="token punctuation">,</span> dr<span class="token punctuation">,</span> er<span class="token punctuation">;</span>

                ar <span class="token operator">=</span> al <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                br <span class="token operator">=</span> bl <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                cr <span class="token operator">=</span> cl <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                dr <span class="token operator">=</span> dl <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                er <span class="token operator">=</span> el <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token comment">// Computation</span>
                <span class="token keyword">var</span> t<span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">80</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    t <span class="token operator">=</span> <span class="token punctuation">(</span>al <span class="token operator">+</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> zl<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        t <span class="token operator">+=</span> <span class="token function">f1</span><span class="token punctuation">(</span>bl<span class="token punctuation">,</span> cl<span class="token punctuation">,</span> dl<span class="token punctuation">)</span> <span class="token operator">+</span> hl<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        t <span class="token operator">+=</span> <span class="token function">f2</span><span class="token punctuation">(</span>bl<span class="token punctuation">,</span> cl<span class="token punctuation">,</span> dl<span class="token punctuation">)</span> <span class="token operator">+</span> hl<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        t <span class="token operator">+=</span> <span class="token function">f3</span><span class="token punctuation">(</span>bl<span class="token punctuation">,</span> cl<span class="token punctuation">,</span> dl<span class="token punctuation">)</span> <span class="token operator">+</span> hl<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        t <span class="token operator">+=</span> <span class="token function">f4</span><span class="token punctuation">(</span>bl<span class="token punctuation">,</span> cl<span class="token punctuation">,</span> dl<span class="token punctuation">)</span> <span class="token operator">+</span> hl<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// if (i&lt;80) {<!-- --></span>
                        t <span class="token operator">+=</span> <span class="token function">f5</span><span class="token punctuation">(</span>bl<span class="token punctuation">,</span> cl<span class="token punctuation">,</span> dl<span class="token punctuation">)</span> <span class="token operator">+</span> hl<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    t <span class="token operator">=</span> t <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    t <span class="token operator">=</span> <span class="token function">rotl</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> sl<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    t <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">+</span> el<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    al <span class="token operator">=</span> el<span class="token punctuation">;</span>
                    el <span class="token operator">=</span> dl<span class="token punctuation">;</span>
                    dl <span class="token operator">=</span> <span class="token function">rotl</span><span class="token punctuation">(</span>cl<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    cl <span class="token operator">=</span> bl<span class="token punctuation">;</span>
                    bl <span class="token operator">=</span> t<span class="token punctuation">;</span>

                    t <span class="token operator">=</span> <span class="token punctuation">(</span>ar <span class="token operator">+</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> zr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        t <span class="token operator">+=</span> <span class="token function">f5</span><span class="token punctuation">(</span>br<span class="token punctuation">,</span> cr<span class="token punctuation">,</span> dr<span class="token punctuation">)</span> <span class="token operator">+</span> hr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        t <span class="token operator">+=</span> <span class="token function">f4</span><span class="token punctuation">(</span>br<span class="token punctuation">,</span> cr<span class="token punctuation">,</span> dr<span class="token punctuation">)</span> <span class="token operator">+</span> hr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        t <span class="token operator">+=</span> <span class="token function">f3</span><span class="token punctuation">(</span>br<span class="token punctuation">,</span> cr<span class="token punctuation">,</span> dr<span class="token punctuation">)</span> <span class="token operator">+</span> hr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        t <span class="token operator">+=</span> <span class="token function">f2</span><span class="token punctuation">(</span>br<span class="token punctuation">,</span> cr<span class="token punctuation">,</span> dr<span class="token punctuation">)</span> <span class="token operator">+</span> hr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// if (i&lt;80) {<!-- --></span>
                        t <span class="token operator">+=</span> <span class="token function">f1</span><span class="token punctuation">(</span>br<span class="token punctuation">,</span> cr<span class="token punctuation">,</span> dr<span class="token punctuation">)</span> <span class="token operator">+</span> hr<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    t <span class="token operator">=</span> t <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    t <span class="token operator">=</span> <span class="token function">rotl</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> sr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    t <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">+</span> er<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    ar <span class="token operator">=</span> er<span class="token punctuation">;</span>
                    er <span class="token operator">=</span> dr<span class="token punctuation">;</span>
                    dr <span class="token operator">=</span> <span class="token function">rotl</span><span class="token punctuation">(</span>cr<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    cr <span class="token operator">=</span> br<span class="token punctuation">;</span>
                    br <span class="token operator">=</span> t<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// Intermediate hash value</span>
                t <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> cl <span class="token operator">+</span> dr<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> dl <span class="token operator">+</span> er<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> el <span class="token operator">+</span> ar<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> al <span class="token operator">+</span> br<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> bl <span class="token operator">+</span> cr<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token constant">H</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doFinalize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_data<span class="token punctuation">;</span>
                <span class="token keyword">var</span> dataWords <span class="token operator">=</span> data<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token keyword">var</span> nBitsTotal <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_nDataBytes <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> nBitsLeft <span class="token operator">=</span> data<span class="token punctuation">.</span>sigBytes <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>

                <span class="token comment">// Add padding</span>
                dataWords<span class="token punctuation">[</span>nBitsLeft <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token number">0x80</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> nBitsLeft <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                dataWords<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsLeft <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsTotal <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>nBitsTotal <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nBitsTotal <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>nBitsTotal <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
                data<span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> <span class="token punctuation">(</span>dataWords<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token comment">// Hash final blocks</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">;</span>
                <span class="token keyword">var</span> <span class="token constant">H</span> <span class="token operator">=</span> hash<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token comment">// Swap endian</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Shortcut</span>
                    <span class="token keyword">var</span> H_i <span class="token operator">=</span> <span class="token constant">H</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

                    <span class="token comment">// Swap</span>
                    <span class="token constant">H</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>H_i <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>H_i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>H_i <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>H_i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Return final computed hash</span>
                <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">clone</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> clone <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                clone<span class="token punctuation">.</span>_hash <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hash<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> clone<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>

        <span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">function</span> <span class="token function">f3</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token operator">~</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">function</span> <span class="token function">f4</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token operator">~</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">function</span> <span class="token function">f5</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token operator">~</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>

        <span class="token keyword">function</span> <span class="token function">rotl</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;&lt;</span> n<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token comment">/**
         * Shortcut function to the hasher's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         *
         * @return {WordArray} The hash.
         *
         * @static
         *
         * @example
         *
         *     var hash = CryptoJS.RIPEMD160('message');
         *     var hash = CryptoJS.RIPEMD160(wordArray);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span><span class="token constant">RIPEMD160</span> <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span><span class="token constant">RIPEMD160</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut function to the HMAC's object interface.
         *
         * @param {WordArray|string} message The message to hash.
         * @param {WordArray|string} key The secret key.
         *
         * @return {WordArray} The HMAC.
         *
         * @static
         *
         * @example
         *
         *     var hmac = CryptoJS.HmacRIPEMD160(message, key);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span>HmacRIPEMD160 <span class="token operator">=</span> Hasher<span class="token punctuation">.</span><span class="token function">_createHmacHelper</span><span class="token punctuation">(</span><span class="token constant">RIPEMD160</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span>Math<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Base <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>Base<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_enc <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>enc<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Utf8 <span class="token operator">=</span> C_enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>

        <span class="token comment">/**
         * HMAC algorithm.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">HMAC</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">HMAC</span> <span class="token operator">=</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Initializes a newly created HMAC.
             *
             * @param {Hasher} hasher The hash algorithm to use.
             * @param {WordArray|string} key The secret key.
             *
             * @example
             *
             *     var hmacHasher = CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256, key);
             */</span>
            <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">hasher<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Init hasher</span>
                hasher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hasher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">hasher<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Convert string to WordArray, else assume WordArray already</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> key <span class="token operator">==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    key <span class="token operator">=</span> Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> hasherBlockSize <span class="token operator">=</span> hasher<span class="token punctuation">.</span>blockSize<span class="token punctuation">;</span>
                <span class="token keyword">var</span> hasherBlockSizeBytes <span class="token operator">=</span> hasherBlockSize <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token comment">// Allow arbitrary length keys</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token punctuation">.</span>sigBytes <span class="token operator">&gt;</span> hasherBlockSizeBytes<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    key <span class="token operator">=</span> hasher<span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Clamp excess bits</span>
                key<span class="token punctuation">.</span><span class="token function">clamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Clone key for inner and outer pads</span>
                <span class="token keyword">var</span> oKey <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_oKey <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> iKey <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_iKey <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> oKeyWords <span class="token operator">=</span> oKey<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> iKeyWords <span class="token operator">=</span> iKey<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token comment">// XOR keys with pad constants</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> hasherBlockSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    oKeyWords<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">0x5c5c5c5c</span><span class="token punctuation">;</span>
                    iKeyWords<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">0x36363636</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                oKey<span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> iKey<span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> hasherBlockSizeBytes<span class="token punctuation">;</span>

                <span class="token comment">// Set initial values</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Resets this HMAC to its initial state.
             *
             * @example
             *
             *     hmacHasher.reset();
             */</span>
            <span class="token function-variable function">reset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> hasher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hasher<span class="token punctuation">;</span>

                <span class="token comment">// Reset</span>
                hasher<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                hasher<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_iKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Updates this HMAC with a message.
             *
             * @param {WordArray|string} messageUpdate The message to append.
             *
             * @return {HMAC} This HMAC instance.
             *
             * @example
             *
             *     hmacHasher.update('message');
             *     hmacHasher.update(wordArray);
             */</span>
            <span class="token function-variable function">update</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">messageUpdate</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_hasher<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>messageUpdate<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Chainable</span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Finalizes the HMAC computation.
             * Note that the finalize operation is effectively a destructive, read-once operation.
             *
             * @param {WordArray|string} messageUpdate (Optional) A final message update.
             *
             * @return {WordArray} The HMAC.
             *
             * @example
             *
             *     var hmac = hmacHasher.finalize();
             *     var hmac = hmacHasher.finalize('message');
             *     var hmac = hmacHasher.finalize(wordArray);
             */</span>
            <span class="token function-variable function">finalize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">messageUpdate</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> hasher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_hasher<span class="token punctuation">;</span>

                <span class="token comment">// Compute HMAC</span>
                <span class="token keyword">var</span> innerHash <span class="token operator">=</span> hasher<span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span>messageUpdate<span class="token punctuation">)</span><span class="token punctuation">;</span>
                hasher<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> hmac <span class="token operator">=</span> hasher<span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_oKey<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>innerHash<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> hmac<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Base <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>Base<span class="token punctuation">;</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">SHA1</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">SHA1</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">HMAC</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">HMAC</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Password-Based Key Derivation Function 2 algorithm.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">PBKDF2</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">PBKDF2</span> <span class="token operator">=</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Configuration options.
             *
             * @property {number} keySize The key size in words to generate. Default: 4 (128 bits)
             * @property {Hasher} hasher The hasher to use. Default: SHA1
             * @property {number} iterations The number of iterations to perform. Default: 1
             */</span>
            cfg<span class="token operator">:</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                keySize<span class="token operator">:</span> <span class="token number">128</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">,</span>
                hasher<span class="token operator">:</span> <span class="token constant">SHA1</span><span class="token punctuation">,</span>
                iterations<span class="token operator">:</span> <span class="token number">1</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Initializes a newly created key derivation function.
             *
             * @param {Object} cfg (Optional) The configuration options to use for the derivation.
             *
             * @example
             *
             *     var kdf = CryptoJS.algo.PBKDF2.create();
             *     var kdf = CryptoJS.algo.PBKDF2.create({ keySize: 8 });
             *     var kdf = CryptoJS.algo.PBKDF2.create({ keySize: 8, iterations: 1000 });
             */</span>
            <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>cfg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Computes the Password-Based Key Derivation Function 2.
             *
             * @param {WordArray|string} password The password.
             * @param {WordArray|string} salt A salt.
             *
             * @return {WordArray} The derived key.
             *
             * @example
             *
             *     var key = kdf.compute(password, salt);
             */</span>
            <span class="token function-variable function">compute</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">password<span class="token punctuation">,</span> salt</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> cfg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">;</span>

                <span class="token comment">// Init HMAC</span>
                <span class="token keyword">var</span> hmac <span class="token operator">=</span> <span class="token constant">HMAC</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>cfg<span class="token punctuation">.</span>hasher<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Initial values</span>
                <span class="token keyword">var</span> derivedKey <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> blockIndex <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0x00000001</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> derivedKeyWords <span class="token operator">=</span> derivedKey<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> blockIndexWords <span class="token operator">=</span> blockIndex<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> keySize <span class="token operator">=</span> cfg<span class="token punctuation">.</span>keySize<span class="token punctuation">;</span>
                <span class="token keyword">var</span> iterations <span class="token operator">=</span> cfg<span class="token punctuation">.</span>iterations<span class="token punctuation">;</span>

                <span class="token comment">// Generate key</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>derivedKeyWords<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> keySize<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> block <span class="token operator">=</span> hmac<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>salt<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span>blockIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    hmac<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Shortcuts</span>
                    <span class="token keyword">var</span> blockWords <span class="token operator">=</span> block<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> blockWordsLength <span class="token operator">=</span> blockWords<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

                    <span class="token comment">// Iterations</span>
                    <span class="token keyword">var</span> intermediate <span class="token operator">=</span> block<span class="token punctuation">;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> iterations<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        intermediate <span class="token operator">=</span> hmac<span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span>intermediate<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        hmac<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                        <span class="token comment">// Shortcut</span>
                        <span class="token keyword">var</span> intermediateWords <span class="token operator">=</span> intermediate<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                        <span class="token comment">// XOR intermediate with block</span>
                        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> blockWordsLength<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            blockWords<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">^=</span> intermediateWords<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>

                    derivedKey<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>block<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    blockIndexWords<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                derivedKey<span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> keySize <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> derivedKey<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Computes the Password-Based Key Derivation Function 2.
         *
         * @param {WordArray|string} password The password.
         * @param {WordArray|string} salt A salt.
         * @param {Object} cfg (Optional) The configuration options to use for this computation.
         *
         * @return {WordArray} The derived key.
         *
         * @static
         *
         * @example
         *
         *     var key = CryptoJS.PBKDF2(password, salt);
         *     var key = CryptoJS.PBKDF2(password, salt, { keySize: 8 });
         *     var key = CryptoJS.PBKDF2(password, salt, { keySize: 8, iterations: 1000 });
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span><span class="token function-variable function">PBKDF2</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">password<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token constant">PBKDF2</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compute</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> salt<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Base <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>Base<span class="token punctuation">;</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">MD5</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">MD5</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * This key derivation function is meant to conform with EVP_BytesToKey.
         * www.openssl.org/docs/crypto/EVP_BytesToKey.html
         */</span>
        <span class="token keyword">var</span> EvpKDF <span class="token operator">=</span> C_algo<span class="token punctuation">.</span>EvpKDF <span class="token operator">=</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Configuration options.
             *
             * @property {number} keySize The key size in words to generate. Default: 4 (128 bits)
             * @property {Hasher} hasher The hash algorithm to use. Default: MD5
             * @property {number} iterations The number of iterations to perform. Default: 1
             */</span>
            cfg<span class="token operator">:</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                keySize<span class="token operator">:</span> <span class="token number">128</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">,</span>
                hasher<span class="token operator">:</span> <span class="token constant">MD5</span><span class="token punctuation">,</span>
                iterations<span class="token operator">:</span> <span class="token number">1</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Initializes a newly created key derivation function.
             *
             * @param {Object} cfg (Optional) The configuration options to use for the derivation.
             *
             * @example
             *
             *     var kdf = CryptoJS.algo.EvpKDF.create();
             *     var kdf = CryptoJS.algo.EvpKDF.create({ keySize: 8 });
             *     var kdf = CryptoJS.algo.EvpKDF.create({ keySize: 8, iterations: 1000 });
             */</span>
            <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>cfg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Derives a key from a password.
             *
             * @param {WordArray|string} password The password.
             * @param {WordArray|string} salt A salt.
             *
             * @return {WordArray} The derived key.
             *
             * @example
             *
             *     var key = kdf.compute(password, salt);
             */</span>
            <span class="token function-variable function">compute</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">password<span class="token punctuation">,</span> salt</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> block<span class="token punctuation">;</span>

                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> cfg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">;</span>

                <span class="token comment">// Init hasher</span>
                <span class="token keyword">var</span> hasher <span class="token operator">=</span> cfg<span class="token punctuation">.</span>hasher<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Initial values</span>
                <span class="token keyword">var</span> derivedKey <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> derivedKeyWords <span class="token operator">=</span> derivedKey<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> keySize <span class="token operator">=</span> cfg<span class="token punctuation">.</span>keySize<span class="token punctuation">;</span>
                <span class="token keyword">var</span> iterations <span class="token operator">=</span> cfg<span class="token punctuation">.</span>iterations<span class="token punctuation">;</span>

                <span class="token comment">// Generate key</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>derivedKeyWords<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> keySize<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>block<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        hasher<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>block<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    block <span class="token operator">=</span> hasher<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span>salt<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    hasher<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Iterations</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> iterations<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        block <span class="token operator">=</span> hasher<span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span>block<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        hasher<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    derivedKey<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>block<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                derivedKey<span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> keySize <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> derivedKey<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Derives a key from a password.
         *
         * @param {WordArray|string} password The password.
         * @param {WordArray|string} salt A salt.
         * @param {Object} cfg (Optional) The configuration options to use for this computation.
         *
         * @return {WordArray} The derived key.
         *
         * @static
         *
         * @example
         *
         *     var key = CryptoJS.EvpKDF(password, salt);
         *     var key = CryptoJS.EvpKDF(password, salt, { keySize: 8 });
         *     var key = CryptoJS.EvpKDF(password, salt, { keySize: 8, iterations: 1000 });
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span><span class="token function-variable function">EvpKDF</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">password<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> EvpKDF<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compute</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> salt<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token comment">/**
     * Cipher core components.
     */</span>
    CryptoJS<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>Cipher <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">undefined</span></span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Base <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>Base<span class="token punctuation">;</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> BufferedBlockAlgorithm <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>BufferedBlockAlgorithm<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_enc <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>enc<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Utf8 <span class="token operator">=</span> C_enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Base64 <span class="token operator">=</span> C_enc<span class="token punctuation">.</span>Base64<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>
        <span class="token keyword">var</span> EvpKDF <span class="token operator">=</span> C_algo<span class="token punctuation">.</span>EvpKDF<span class="token punctuation">;</span>

        <span class="token comment">/**
         * Abstract base cipher template.
         *
         * @property {number} keySize This cipher's key size. Default: 4 (128 bits)
         * @property {number} ivSize This cipher's IV size. Default: 4 (128 bits)
         * @property {number} _ENC_XFORM_MODE A constant representing encryption mode.
         * @property {number} _DEC_XFORM_MODE A constant representing decryption mode.
         */</span>
        <span class="token keyword">var</span> Cipher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>Cipher <span class="token operator">=</span> BufferedBlockAlgorithm<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Configuration options.
             *
             * @property {WordArray} iv The IV to use for this operation.
             */</span>
            cfg<span class="token operator">:</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Creates this cipher in encryption mode.
             *
             * @param {WordArray} key The key.
             * @param {Object} cfg (Optional) The configuration options to use for this operation.
             *
             * @return {Cipher} A cipher instance.
             *
             * @static
             *
             * @example
             *
             *     var cipher = CryptoJS.algo.AES.createEncryptor(keyWordArray, { iv: ivWordArray });
             */</span>
            <span class="token function-variable function">createEncryptor</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_ENC_XFORM_MODE<span class="token punctuation">,</span> key<span class="token punctuation">,</span> cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Creates this cipher in decryption mode.
             *
             * @param {WordArray} key The key.
             * @param {Object} cfg (Optional) The configuration options to use for this operation.
             *
             * @return {Cipher} A cipher instance.
             *
             * @static
             *
             * @example
             *
             *     var cipher = CryptoJS.algo.AES.createDecryptor(keyWordArray, { iv: ivWordArray });
             */</span>
            <span class="token function-variable function">createDecryptor</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_DEC_XFORM_MODE<span class="token punctuation">,</span> key<span class="token punctuation">,</span> cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Initializes a newly created cipher.
             *
             * @param {number} xformMode Either the encryption or decryption transormation mode constant.
             * @param {WordArray} key The key.
             * @param {Object} cfg (Optional) The configuration options to use for this operation.
             *
             * @example
             *
             *     var cipher = CryptoJS.algo.AES.create(CryptoJS.algo.AES._ENC_XFORM_MODE, keyWordArray, { iv: ivWordArray });
             */</span>
            <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">xformMode<span class="token punctuation">,</span> key<span class="token punctuation">,</span> cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Apply config defaults</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>cfg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Store transform mode and key</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_xformMode <span class="token operator">=</span> xformMode<span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_key <span class="token operator">=</span> key<span class="token punctuation">;</span>

                <span class="token comment">// Set initial values</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Resets this cipher to its initial state.
             *
             * @example
             *
             *     cipher.reset();
             */</span>
            <span class="token function-variable function">reset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Reset data buffer</span>
                BufferedBlockAlgorithm<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Perform concrete-cipher logic</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_doReset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Adds data to be encrypted or decrypted.
             *
             * @param {WordArray|string} dataUpdate The data to encrypt or decrypt.
             *
             * @return {WordArray} The data after processing.
             *
             * @example
             *
             *     var encrypted = cipher.process('data');
             *     var encrypted = cipher.process(wordArray);
             */</span>
            <span class="token function-variable function">process</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dataUpdate</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Append</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_append</span><span class="token punctuation">(</span>dataUpdate<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Process available blocks</span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Finalizes the encryption or decryption process.
             * Note that the finalize operation is effectively a destructive, read-once operation.
             *
             * @param {WordArray|string} dataUpdate The final data to encrypt or decrypt.
             *
             * @return {WordArray} The data after final processing.
             *
             * @example
             *
             *     var encrypted = cipher.finalize();
             *     var encrypted = cipher.finalize('data');
             *     var encrypted = cipher.finalize(wordArray);
             */</span>
            <span class="token function-variable function">finalize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dataUpdate</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Final data update</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>dataUpdate<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_append</span><span class="token punctuation">(</span>dataUpdate<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Perform concrete-cipher logic</span>
                <span class="token keyword">var</span> finalProcessedData <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_doFinalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> finalProcessedData<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            keySize<span class="token operator">:</span> <span class="token number">128</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">,</span>

            ivSize<span class="token operator">:</span> <span class="token number">128</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">,</span>

            _ENC_XFORM_MODE<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>

            _DEC_XFORM_MODE<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Creates shortcut functions to a cipher's object interface.
             *
             * @param {Cipher} cipher The cipher to create a helper for.
             *
             * @return {Object} An object with encrypt and decrypt shortcut functions.
             *
             * @static
             *
             * @example
             *
             *     var AES = CryptoJS.lib.Cipher._createHelper(CryptoJS.algo.AES);
             */</span>
            _createHelper<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">function</span> <span class="token function">selectCipherStrategy</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> key <span class="token operator">==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span> PasswordBasedCipher<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span> SerializableCipher<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cipher</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function-variable function">encrypt</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> key<span class="token punctuation">,</span> cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token keyword">return</span> <span class="token function">selectCipherStrategy</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> message<span class="token punctuation">,</span> key<span class="token punctuation">,</span> cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>

                        <span class="token function-variable function">decrypt</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">ciphertext<span class="token punctuation">,</span> key<span class="token punctuation">,</span> cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token keyword">return</span> <span class="token function">selectCipherStrategy</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> ciphertext<span class="token punctuation">,</span> key<span class="token punctuation">,</span> cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Abstract base stream cipher template.
         *
         * @property {number} blockSize The number of 32-bit words this cipher operates on. Default: 1 (32 bits)
         */</span>
        <span class="token keyword">var</span> StreamCipher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>StreamCipher <span class="token operator">=</span> Cipher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">_doFinalize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Process partial blocks</span>
                <span class="token keyword">var</span> finalProcessedBlocks <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_process</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token operator">!</span><span class="token string">'flush'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> finalProcessedBlocks<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            blockSize<span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Mode namespace.
         */</span>
        <span class="token keyword">var</span> C_mode <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Abstract base block cipher mode template.
         */</span>
        <span class="token keyword">var</span> BlockCipherMode <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>BlockCipherMode <span class="token operator">=</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Creates this mode for encryption.
             *
             * @param {Cipher} cipher A block cipher instance.
             * @param {Array} iv The IV words.
             *
             * @static
             *
             * @example
             *
             *     var mode = CryptoJS.mode.CBC.createEncryptor(cipher, iv.words);
             */</span>
            <span class="token function-variable function">createEncryptor</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cipher<span class="token punctuation">,</span> iv</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Encryptor<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Creates this mode for decryption.
             *
             * @param {Cipher} cipher A block cipher instance.
             * @param {Array} iv The IV words.
             *
             * @static
             *
             * @example
             *
             *     var mode = CryptoJS.mode.CBC.createDecryptor(cipher, iv.words);
             */</span>
            <span class="token function-variable function">createDecryptor</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cipher<span class="token punctuation">,</span> iv</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Decryptor<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Initializes a newly created mode.
             *
             * @param {Cipher} cipher A block cipher instance.
             * @param {Array} iv The IV words.
             *
             * @example
             *
             *     var mode = CryptoJS.mode.CBC.Encryptor.create(cipher, iv.words);
             */</span>
            <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cipher<span class="token punctuation">,</span> iv</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_cipher <span class="token operator">=</span> cipher<span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_iv <span class="token operator">=</span> iv<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Cipher Block Chaining mode.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">CBC</span> <span class="token operator">=</span> C_mode<span class="token punctuation">.</span><span class="token constant">CBC</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Abstract base CBC mode.
             */</span>
            <span class="token keyword">var</span> <span class="token constant">CBC</span> <span class="token operator">=</span> BlockCipherMode<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">/**
             * CBC encryptor.
             */</span>
            <span class="token constant">CBC</span><span class="token punctuation">.</span>Encryptor <span class="token operator">=</span> <span class="token constant">CBC</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token comment">/**
                 * Processes the data block at offset.
                 *
                 * @param {Array} words The data words to operate on.
                 * @param {number} offset The offset where the block starts.
                 *
                 * @example
                 *
                 *     mode.processBlock(data.words, offset);
                 */</span>
                <span class="token function-variable function">processBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">words<span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Shortcuts</span>
                    <span class="token keyword">var</span> cipher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_cipher<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> blockSize <span class="token operator">=</span> cipher<span class="token punctuation">.</span>blockSize<span class="token punctuation">;</span>

                    <span class="token comment">// XOR and encrypt</span>
                    <span class="token function">xorBlock</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> words<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> blockSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    cipher<span class="token punctuation">.</span><span class="token function">encryptBlock</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Remember this block to use with next block</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>_prevBlock <span class="token operator">=</span> words<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> offset <span class="token operator">+</span> blockSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">/**
             * CBC decryptor.
             */</span>
            <span class="token constant">CBC</span><span class="token punctuation">.</span>Decryptor <span class="token operator">=</span> <span class="token constant">CBC</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token comment">/**
                 * Processes the data block at offset.
                 *
                 * @param {Array} words The data words to operate on.
                 * @param {number} offset The offset where the block starts.
                 *
                 * @example
                 *
                 *     mode.processBlock(data.words, offset);
                 */</span>
                <span class="token function-variable function">processBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">words<span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Shortcuts</span>
                    <span class="token keyword">var</span> cipher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_cipher<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> blockSize <span class="token operator">=</span> cipher<span class="token punctuation">.</span>blockSize<span class="token punctuation">;</span>

                    <span class="token comment">// Remember this block to use with next block</span>
                    <span class="token keyword">var</span> thisBlock <span class="token operator">=</span> words<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> offset <span class="token operator">+</span> blockSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Decrypt and XOR</span>
                    cipher<span class="token punctuation">.</span><span class="token function">decryptBlock</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">xorBlock</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> words<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> blockSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// This block becomes the previous block</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>_prevBlock <span class="token operator">=</span> thisBlock<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">function</span> <span class="token function">xorBlock</span><span class="token punctuation">(</span><span class="token parameter">words<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> blockSize</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> block<span class="token punctuation">;</span>

                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> iv <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_iv<span class="token punctuation">;</span>

                <span class="token comment">// Choose mixing block</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>iv<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    block <span class="token operator">=</span> iv<span class="token punctuation">;</span>

                    <span class="token comment">// Remove IV for subsequent blocks</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>_iv <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    block <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_prevBlock<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// XOR blocks</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> blockSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    words<span class="token punctuation">[</span>offset <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">^=</span> block<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">return</span> <span class="token constant">CBC</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Padding namespace.
         */</span>
        <span class="token keyword">var</span> C_pad <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>pad <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * PKCS #5/7 padding strategy.
         */</span>
        <span class="token keyword">var</span> Pkcs7 <span class="token operator">=</span> C_pad<span class="token punctuation">.</span>Pkcs7 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Pads data using the algorithm defined in PKCS #5/7.
             *
             * @param {WordArray} data The data to pad.
             * @param {number} blockSize The multiple that the data should be padded to.
             *
             * @static
             *
             * @example
             *
             *     CryptoJS.pad.Pkcs7.pad(wordArray, 4);
             */</span>
            <span class="token function-variable function">pad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> blockSize</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> blockSizeBytes <span class="token operator">=</span> blockSize <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token comment">// Count padding bytes</span>
                <span class="token keyword">var</span> nPaddingBytes <span class="token operator">=</span> blockSizeBytes <span class="token operator">-</span> data<span class="token punctuation">.</span>sigBytes <span class="token operator">%</span> blockSizeBytes<span class="token punctuation">;</span>

                <span class="token comment">// Create padding word</span>
                <span class="token keyword">var</span> paddingWord <span class="token operator">=</span> <span class="token punctuation">(</span>nPaddingBytes <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>nPaddingBytes <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>nPaddingBytes <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> nPaddingBytes<span class="token punctuation">;</span>

                <span class="token comment">// Create padding</span>
                <span class="token keyword">var</span> paddingWords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nPaddingBytes<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    paddingWords<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>paddingWord<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">var</span> padding <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>paddingWords<span class="token punctuation">,</span> nPaddingBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Add padding</span>
                data<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>padding<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Unpads data that had been padded using the algorithm defined in PKCS #5/7.
             *
             * @param {WordArray} data The data to unpad.
             *
             * @static
             *
             * @example
             *
             *     CryptoJS.pad.Pkcs7.unpad(wordArray);
             */</span>
            <span class="token function-variable function">unpad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Get number of padding bytes from last byte</span>
                <span class="token keyword">var</span> nPaddingBytes <span class="token operator">=</span> data<span class="token punctuation">.</span>words<span class="token punctuation">[</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>sigBytes <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>

                <span class="token comment">// Remove padding</span>
                data<span class="token punctuation">.</span>sigBytes <span class="token operator">-=</span> nPaddingBytes<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Abstract base block cipher template.
         *
         * @property {number} blockSize The number of 32-bit words this cipher operates on. Default: 4 (128 bits)
         */</span>
        <span class="token keyword">var</span> BlockCipher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>BlockCipher <span class="token operator">=</span> Cipher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Configuration options.
             *
             * @property {Mode} mode The block mode to use. Default: CBC
             * @property {Padding} padding The padding strategy to use. Default: Pkcs7
             */</span>
            cfg<span class="token operator">:</span> Cipher<span class="token punctuation">.</span>cfg<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                mode<span class="token operator">:</span> <span class="token constant">CBC</span><span class="token punctuation">,</span>
                padding<span class="token operator">:</span> Pkcs7
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

            <span class="token function-variable function">reset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> modeCreator<span class="token punctuation">;</span>

                <span class="token comment">// Reset cipher</span>
                Cipher<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> cfg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">;</span>
                <span class="token keyword">var</span> iv <span class="token operator">=</span> cfg<span class="token punctuation">.</span>iv<span class="token punctuation">;</span>
                <span class="token keyword">var</span> mode <span class="token operator">=</span> cfg<span class="token punctuation">.</span>mode<span class="token punctuation">;</span>

                <span class="token comment">// Reset block mode</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_xformMode <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_ENC_XFORM_MODE<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    modeCreator <span class="token operator">=</span> mode<span class="token punctuation">.</span>createEncryptor<span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token comment">/* if (this._xformMode == this._DEC_XFORM_MODE) */</span> <span class="token punctuation">{<!-- --></span>
                    modeCreator <span class="token operator">=</span> mode<span class="token punctuation">.</span>createDecryptor<span class="token punctuation">;</span>
                    <span class="token comment">// Keep at least one block in the buffer for unpadding</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>_minBufferSize <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_mode <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_mode<span class="token punctuation">.</span>__creator <span class="token operator">==</span> modeCreator<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>_mode<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> iv <span class="token operator">&amp;&amp;</span> iv<span class="token punctuation">.</span>words<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>_mode <span class="token operator">=</span> <span class="token function">modeCreator</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> iv <span class="token operator">&amp;&amp;</span> iv<span class="token punctuation">.</span>words<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>_mode<span class="token punctuation">.</span>__creator <span class="token operator">=</span> modeCreator<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doProcessBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">words<span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_mode<span class="token punctuation">.</span><span class="token function">processBlock</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doFinalize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> finalProcessedBlocks<span class="token punctuation">;</span>

                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> padding <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span>padding<span class="token punctuation">;</span>

                <span class="token comment">// Finalize</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_xformMode <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_ENC_XFORM_MODE<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Pad data</span>
                    padding<span class="token punctuation">.</span><span class="token function">pad</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_data<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>blockSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Process final blocks</span>
                    finalProcessedBlocks <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_process</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token operator">!</span><span class="token string">'flush'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token comment">/* if (this._xformMode == this._DEC_XFORM_MODE) */</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Process final blocks</span>
                    finalProcessedBlocks <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_process</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token operator">!</span><span class="token string">'flush'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Unpad data</span>
                    padding<span class="token punctuation">.</span><span class="token function">unpad</span><span class="token punctuation">(</span>finalProcessedBlocks<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> finalProcessedBlocks<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            blockSize<span class="token operator">:</span> <span class="token number">128</span> <span class="token operator">/</span> <span class="token number">32</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * A collection of cipher parameters.
         *
         * @property {WordArray} ciphertext The raw ciphertext.
         * @property {WordArray} key The key to this ciphertext.
         * @property {WordArray} iv The IV used in the ciphering operation.
         * @property {WordArray} salt The salt used with a key derivation function.
         * @property {Cipher} algorithm The cipher algorithm.
         * @property {Mode} mode The block mode used in the ciphering operation.
         * @property {Padding} padding The padding scheme used in the ciphering operation.
         * @property {number} blockSize The block size of the cipher.
         * @property {Format} formatter The default formatting strategy to convert this cipher params object to a string.
         */</span>
        <span class="token keyword">var</span> CipherParams <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>CipherParams <span class="token operator">=</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Initializes a newly created cipher params object.
             *
             * @param {Object} cipherParams An object with any of the possible cipher parameters.
             *
             * @example
             *
             *     var cipherParams = CryptoJS.lib.CipherParams.create({
             *         ciphertext: ciphertextWordArray,
             *         key: keyWordArray,
             *         iv: ivWordArray,
             *         salt: saltWordArray,
             *         algorithm: CryptoJS.algo.AES,
             *         mode: CryptoJS.mode.CBC,
             *         padding: CryptoJS.pad.PKCS7,
             *         blockSize: 4,
             *         formatter: CryptoJS.format.OpenSSL
             *     });
             */</span>
            <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cipherParams</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">mixIn</span><span class="token punctuation">(</span>cipherParams<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Converts this cipher params object to a string.
             *
             * @param {Format} formatter (Optional) The formatting strategy to use.
             *
             * @return {string} The stringified cipher params.
             *
             * @throws Error If neither the formatter nor the default formatter is set.
             *
             * @example
             *
             *     var string = cipherParams + '';
             *     var string = cipherParams.toString();
             *     var string = cipherParams.toString(CryptoJS.format.OpenSSL);
             */</span>
            <span class="token function-variable function">toString</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">formatter</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token punctuation">(</span>formatter <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>formatter<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Format namespace.
         */</span>
        <span class="token keyword">var</span> C_format <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>format <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * OpenSSL formatting strategy.
         */</span>
        <span class="token keyword">var</span> OpenSSLFormatter <span class="token operator">=</span> C_format<span class="token punctuation">.</span>OpenSSL <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Converts a cipher params object to an OpenSSL-compatible string.
             *
             * @param {CipherParams} cipherParams The cipher params object.
             *
             * @return {string} The OpenSSL-compatible string.
             *
             * @static
             *
             * @example
             *
             *     var openSSLString = CryptoJS.format.OpenSSL.stringify(cipherParams);
             */</span>
            <span class="token function-variable function">stringify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cipherParams</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> wordArray<span class="token punctuation">;</span>

                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> ciphertext <span class="token operator">=</span> cipherParams<span class="token punctuation">.</span>ciphertext<span class="token punctuation">;</span>
                <span class="token keyword">var</span> salt <span class="token operator">=</span> cipherParams<span class="token punctuation">.</span>salt<span class="token punctuation">;</span>

                <span class="token comment">// Format</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>salt<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    wordArray <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0x53616c74</span><span class="token punctuation">,</span> <span class="token number">0x65645f5f</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>salt<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    wordArray <span class="token operator">=</span> ciphertext<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> wordArray<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>Base64<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Converts an OpenSSL-compatible string to a cipher params object.
             *
             * @param {string} openSSLStr The OpenSSL-compatible string.
             *
             * @return {CipherParams} The cipher params object.
             *
             * @static
             *
             * @example
             *
             *     var cipherParams = CryptoJS.format.OpenSSL.parse(openSSLString);
             */</span>
            <span class="token function-variable function">parse</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">openSSLStr</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> salt<span class="token punctuation">;</span>

                <span class="token comment">// Parse base64</span>
                <span class="token keyword">var</span> ciphertext <span class="token operator">=</span> Base64<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>openSSLStr<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> ciphertextWords <span class="token operator">=</span> ciphertext<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token comment">// Test for salt</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>ciphertextWords<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x53616c74</span> <span class="token operator">&amp;&amp;</span> ciphertextWords<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x65645f5f</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Extract salt</span>
                    salt <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>ciphertextWords<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Remove salt from ciphertext</span>
                    ciphertextWords<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    ciphertext<span class="token punctuation">.</span>sigBytes <span class="token operator">-=</span> <span class="token number">16</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">return</span> CipherParams<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    ciphertext<span class="token operator">:</span> ciphertext<span class="token punctuation">,</span>
                    salt<span class="token operator">:</span> salt
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * A cipher wrapper that returns ciphertext as a serializable cipher params object.
         */</span>
        <span class="token keyword">var</span> SerializableCipher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>SerializableCipher <span class="token operator">=</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Configuration options.
             *
             * @property {Formatter} format The formatting strategy to convert cipher param objects to and from a string. Default: OpenSSL
             */</span>
            cfg<span class="token operator">:</span> Base<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                format<span class="token operator">:</span> OpenSSLFormatter
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Encrypts a message.
             *
             * @param {Cipher} cipher The cipher algorithm to use.
             * @param {WordArray|string} message The message to encrypt.
             * @param {WordArray} key The key.
             * @param {Object} cfg (Optional) The configuration options to use for this operation.
             *
             * @return {CipherParams} A cipher params object.
             *
             * @static
             *
             * @example
             *
             *     var ciphertextParams = CryptoJS.lib.SerializableCipher.encrypt(CryptoJS.algo.AES, message, key);
             *     var ciphertextParams = CryptoJS.lib.SerializableCipher.encrypt(CryptoJS.algo.AES, message, key, { iv: iv });
             *     var ciphertextParams = CryptoJS.lib.SerializableCipher.encrypt(CryptoJS.algo.AES, message, key, { iv: iv, format: CryptoJS.format.OpenSSL });
             */</span>
            <span class="token function-variable function">encrypt</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cipher<span class="token punctuation">,</span> message<span class="token punctuation">,</span> key<span class="token punctuation">,</span> cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Apply config defaults</span>
                cfg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Encrypt</span>
                <span class="token keyword">var</span> encryptor <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">createEncryptor</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> ciphertext <span class="token operator">=</span> encryptor<span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> cipherCfg <span class="token operator">=</span> encryptor<span class="token punctuation">.</span>cfg<span class="token punctuation">;</span>

                <span class="token comment">// Create and return serializable cipher params</span>
                <span class="token keyword">return</span> CipherParams<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    ciphertext<span class="token operator">:</span> ciphertext<span class="token punctuation">,</span>
                    key<span class="token operator">:</span> key<span class="token punctuation">,</span>
                    iv<span class="token operator">:</span> cipherCfg<span class="token punctuation">.</span>iv<span class="token punctuation">,</span>
                    algorithm<span class="token operator">:</span> cipher<span class="token punctuation">,</span>
                    mode<span class="token operator">:</span> cipherCfg<span class="token punctuation">.</span>mode<span class="token punctuation">,</span>
                    padding<span class="token operator">:</span> cipherCfg<span class="token punctuation">.</span>padding<span class="token punctuation">,</span>
                    blockSize<span class="token operator">:</span> cipher<span class="token punctuation">.</span>blockSize<span class="token punctuation">,</span>
                    formatter<span class="token operator">:</span> cfg<span class="token punctuation">.</span>format
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Decrypts serialized ciphertext.
             *
             * @param {Cipher} cipher The cipher algorithm to use.
             * @param {CipherParams|string} ciphertext The ciphertext to decrypt.
             * @param {WordArray} key The key.
             * @param {Object} cfg (Optional) The configuration options to use for this operation.
             *
             * @return {WordArray} The plaintext.
             *
             * @static
             *
             * @example
             *
             *     var plaintext = CryptoJS.lib.SerializableCipher.decrypt(CryptoJS.algo.AES, formattedCiphertext, key, { iv: iv, format: CryptoJS.format.OpenSSL });
             *     var plaintext = CryptoJS.lib.SerializableCipher.decrypt(CryptoJS.algo.AES, ciphertextParams, key, { iv: iv, format: CryptoJS.format.OpenSSL });
             */</span>
            <span class="token function-variable function">decrypt</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cipher<span class="token punctuation">,</span> ciphertext<span class="token punctuation">,</span> key<span class="token punctuation">,</span> cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Apply config defaults</span>
                cfg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Convert string to CipherParams</span>
                ciphertext <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_parse</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> cfg<span class="token punctuation">.</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Decrypt</span>
                <span class="token keyword">var</span> plaintext <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">createDecryptor</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> cfg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">.</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> plaintext<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Converts serialized ciphertext to CipherParams,
             * else assumed CipherParams already and returns ciphertext unchanged.
             *
             * @param {CipherParams|string} ciphertext The ciphertext.
             * @param {Formatter} format The formatting strategy to use to parse serialized ciphertext.
             *
             * @return {CipherParams} The unserialized ciphertext.
             *
             * @static
             *
             * @example
             *
             *     var ciphertextParams = CryptoJS.lib.SerializableCipher._parse(ciphertextStringOrParams, format);
             */</span>
            <span class="token function-variable function">_parse</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">ciphertext<span class="token punctuation">,</span> format</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> ciphertext <span class="token operator">==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> format<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> ciphertext<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Key derivation function namespace.
         */</span>
        <span class="token keyword">var</span> C_kdf <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>kdf <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * OpenSSL key derivation function.
         */</span>
        <span class="token keyword">var</span> OpenSSLKdf <span class="token operator">=</span> C_kdf<span class="token punctuation">.</span>OpenSSL <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Derives a key and IV from a password.
             *
             * @param {string} password The password to derive from.
             * @param {number} keySize The size in words of the key to generate.
             * @param {number} ivSize The size in words of the IV to generate.
             * @param {WordArray|string} salt (Optional) A 64-bit salt to use. If omitted, a salt will be generated randomly.
             *
             * @return {CipherParams} A cipher params object with the key, IV, and salt.
             *
             * @static
             *
             * @example
             *
             *     var derivedParams = CryptoJS.kdf.OpenSSL.execute('Password', 256/32, 128/32);
             *     var derivedParams = CryptoJS.kdf.OpenSSL.execute('Password', 256/32, 128/32, 'saltsalt');
             */</span>
            <span class="token function-variable function">execute</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">password<span class="token punctuation">,</span> keySize<span class="token punctuation">,</span> ivSize<span class="token punctuation">,</span> salt</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Generate random salt</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>salt<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    salt <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">64</span> <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Derive key and IV</span>
                <span class="token keyword">var</span> key <span class="token operator">=</span> EvpKDF<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    keySize<span class="token operator">:</span> keySize <span class="token operator">+</span> ivSize
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compute</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> salt<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Separate key and IV</span>
                <span class="token keyword">var</span> iv <span class="token operator">=</span> WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>key<span class="token punctuation">.</span>words<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>keySize<span class="token punctuation">)</span><span class="token punctuation">,</span> ivSize <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                key<span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> keySize <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token comment">// Return params</span>
                <span class="token keyword">return</span> CipherParams<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    key<span class="token operator">:</span> key<span class="token punctuation">,</span>
                    iv<span class="token operator">:</span> iv<span class="token punctuation">,</span>
                    salt<span class="token operator">:</span> salt
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * A serializable cipher wrapper that derives the key from a password,
         * and returns ciphertext as a serializable cipher params object.
         */</span>
        <span class="token keyword">var</span> PasswordBasedCipher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>PasswordBasedCipher <span class="token operator">=</span> SerializableCipher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Configuration options.
             *
             * @property {KDF} kdf The key derivation function to use to generate a key and IV from a password. Default: OpenSSL
             */</span>
            cfg<span class="token operator">:</span> SerializableCipher<span class="token punctuation">.</span>cfg<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                kdf<span class="token operator">:</span> OpenSSLKdf
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Encrypts a message using a password.
             *
             * @param {Cipher} cipher The cipher algorithm to use.
             * @param {WordArray|string} message The message to encrypt.
             * @param {string} password The password.
             * @param {Object} cfg (Optional) The configuration options to use for this operation.
             *
             * @return {CipherParams} A cipher params object.
             *
             * @static
             *
             * @example
             *
             *     var ciphertextParams = CryptoJS.lib.PasswordBasedCipher.encrypt(CryptoJS.algo.AES, message, 'password');
             *     var ciphertextParams = CryptoJS.lib.PasswordBasedCipher.encrypt(CryptoJS.algo.AES, message, 'password', { format: CryptoJS.format.OpenSSL });
             */</span>
            <span class="token function-variable function">encrypt</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cipher<span class="token punctuation">,</span> message<span class="token punctuation">,</span> password<span class="token punctuation">,</span> cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Apply config defaults</span>
                cfg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Derive key and other params</span>
                <span class="token keyword">var</span> derivedParams <span class="token operator">=</span> cfg<span class="token punctuation">.</span>kdf<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> cipher<span class="token punctuation">.</span>keySize<span class="token punctuation">,</span> cipher<span class="token punctuation">.</span>ivSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Add IV to config</span>
                cfg<span class="token punctuation">.</span>iv <span class="token operator">=</span> derivedParams<span class="token punctuation">.</span>iv<span class="token punctuation">;</span>

                <span class="token comment">// Encrypt</span>
                <span class="token keyword">var</span> ciphertext <span class="token operator">=</span> SerializableCipher<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> cipher<span class="token punctuation">,</span> message<span class="token punctuation">,</span> derivedParams<span class="token punctuation">.</span>key<span class="token punctuation">,</span> cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Mix in derived params</span>
                ciphertext<span class="token punctuation">.</span><span class="token function">mixIn</span><span class="token punctuation">(</span>derivedParams<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> ciphertext<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Decrypts serialized ciphertext using a password.
             *
             * @param {Cipher} cipher The cipher algorithm to use.
             * @param {CipherParams|string} ciphertext The ciphertext to decrypt.
             * @param {string} password The password.
             * @param {Object} cfg (Optional) The configuration options to use for this operation.
             *
             * @return {WordArray} The plaintext.
             *
             * @static
             *
             * @example
             *
             *     var plaintext = CryptoJS.lib.PasswordBasedCipher.decrypt(CryptoJS.algo.AES, formattedCiphertext, 'password', { format: CryptoJS.format.OpenSSL });
             *     var plaintext = CryptoJS.lib.PasswordBasedCipher.decrypt(CryptoJS.algo.AES, ciphertextParams, 'password', { format: CryptoJS.format.OpenSSL });
             */</span>
            <span class="token function-variable function">decrypt</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cipher<span class="token punctuation">,</span> ciphertext<span class="token punctuation">,</span> password<span class="token punctuation">,</span> cfg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Apply config defaults</span>
                cfg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Convert string to CipherParams</span>
                ciphertext <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_parse</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> cfg<span class="token punctuation">.</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Derive key and other params</span>
                <span class="token keyword">var</span> derivedParams <span class="token operator">=</span> cfg<span class="token punctuation">.</span>kdf<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> cipher<span class="token punctuation">.</span>keySize<span class="token punctuation">,</span> cipher<span class="token punctuation">.</span>ivSize<span class="token punctuation">,</span> ciphertext<span class="token punctuation">.</span>salt<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Add IV to config</span>
                cfg<span class="token punctuation">.</span>iv <span class="token operator">=</span> derivedParams<span class="token punctuation">.</span>iv<span class="token punctuation">;</span>

                <span class="token comment">// Decrypt</span>
                <span class="token keyword">var</span> plaintext <span class="token operator">=</span> SerializableCipher<span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> cipher<span class="token punctuation">,</span> ciphertext<span class="token punctuation">,</span> derivedParams<span class="token punctuation">.</span>key<span class="token punctuation">,</span> cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> plaintext<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token comment">/**
     * Cipher Feedback block mode.
     */</span>
    CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">CFB</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> <span class="token constant">CFB</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>BlockCipherMode<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token constant">CFB</span><span class="token punctuation">.</span>Encryptor <span class="token operator">=</span> <span class="token constant">CFB</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">processBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">words<span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> cipher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_cipher<span class="token punctuation">;</span>
                <span class="token keyword">var</span> blockSize <span class="token operator">=</span> cipher<span class="token punctuation">.</span>blockSize<span class="token punctuation">;</span>

                <span class="token function">generateKeystreamAndEncrypt</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> words<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> blockSize<span class="token punctuation">,</span> cipher<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Remember this block to use with next block</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_prevBlock <span class="token operator">=</span> words<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> offset <span class="token operator">+</span> blockSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token constant">CFB</span><span class="token punctuation">.</span>Decryptor <span class="token operator">=</span> <span class="token constant">CFB</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">processBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">words<span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> cipher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_cipher<span class="token punctuation">;</span>
                <span class="token keyword">var</span> blockSize <span class="token operator">=</span> cipher<span class="token punctuation">.</span>blockSize<span class="token punctuation">;</span>

                <span class="token comment">// Remember this block to use with next block</span>
                <span class="token keyword">var</span> thisBlock <span class="token operator">=</span> words<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> offset <span class="token operator">+</span> blockSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token function">generateKeystreamAndEncrypt</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> words<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> blockSize<span class="token punctuation">,</span> cipher<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// This block becomes the previous block</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_prevBlock <span class="token operator">=</span> thisBlock<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">generateKeystreamAndEncrypt</span><span class="token punctuation">(</span><span class="token parameter">words<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> blockSize<span class="token punctuation">,</span> cipher</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> keystream<span class="token punctuation">;</span>

            <span class="token comment">// Shortcut</span>
            <span class="token keyword">var</span> iv <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_iv<span class="token punctuation">;</span>

            <span class="token comment">// Generate keystream</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>iv<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                keystream <span class="token operator">=</span> iv<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Remove IV for subsequent blocks</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_iv <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                keystream <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_prevBlock<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            cipher<span class="token punctuation">.</span><span class="token function">encryptBlock</span><span class="token punctuation">(</span>keystream<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Encrypt</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> blockSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                words<span class="token punctuation">[</span>offset <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">^=</span> keystream<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token constant">CFB</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token comment">/**
     * Counter block mode.
     */</span>
    CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">CTR</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> <span class="token constant">CTR</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>BlockCipherMode<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">var</span> Encryptor <span class="token operator">=</span> <span class="token constant">CTR</span><span class="token punctuation">.</span>Encryptor <span class="token operator">=</span> <span class="token constant">CTR</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">processBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">words<span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> cipher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_cipher
                <span class="token keyword">var</span> blockSize <span class="token operator">=</span> cipher<span class="token punctuation">.</span>blockSize<span class="token punctuation">;</span>
                <span class="token keyword">var</span> iv <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_iv<span class="token punctuation">;</span>
                <span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_counter<span class="token punctuation">;</span>

                <span class="token comment">// Generate keystream</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>iv<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    counter <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_counter <span class="token operator">=</span> iv<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Remove IV for subsequent blocks</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>_iv <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">var</span> keystream <span class="token operator">=</span> counter<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                cipher<span class="token punctuation">.</span><span class="token function">encryptBlock</span><span class="token punctuation">(</span>keystream<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Increment counter</span>
                counter<span class="token punctuation">[</span>blockSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>counter<span class="token punctuation">[</span>blockSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span>

                <span class="token comment">// Encrypt</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> blockSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    words<span class="token punctuation">[</span>offset <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">^=</span> keystream<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token constant">CTR</span><span class="token punctuation">.</span>Decryptor <span class="token operator">=</span> Encryptor<span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token constant">CTR</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token comment">/** @preserve
     * Counter block mode compatible with  Dr Brian Gladman fileenc.c
     * derived from CryptoJS.mode.CTR
     * Jan Hruby jhruby.web@gmail.com
     */</span>
    CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span>CTRGladman <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> CTRGladman <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>BlockCipherMode<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">incWord</span><span class="token punctuation">(</span><span class="token parameter">word</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>word <span class="token operator">&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//overflow</span>
                <span class="token keyword">var</span> b1 <span class="token operator">=</span> <span class="token punctuation">(</span>word <span class="token operator">&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> b2 <span class="token operator">=</span> <span class="token punctuation">(</span>word <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> b3 <span class="token operator">=</span> word <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>b1 <span class="token operator">===</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token comment">// overflow b1</span>
                <span class="token punctuation">{<!-- --></span>
                    b1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>b2 <span class="token operator">===</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        b2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>b3 <span class="token operator">===</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            b3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token operator">++</span>b3<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token operator">++</span>b2<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token operator">++</span>b1<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                word <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                word <span class="token operator">+=</span> <span class="token punctuation">(</span>b1 <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                word <span class="token operator">+=</span> <span class="token punctuation">(</span>b2 <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                word <span class="token operator">+=</span> b3<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                word <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">0x01</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> word<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">function</span> <span class="token function">incCounter</span><span class="token punctuation">(</span><span class="token parameter">counter</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>counter<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">incWord</span><span class="token punctuation">(</span>counter<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// encr_data in fileenc.c from  Dr Brian Gladman's counts only with DWORD j &lt; 8</span>
                counter<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">incWord</span><span class="token punctuation">(</span>counter<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> counter<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">var</span> Encryptor <span class="token operator">=</span> CTRGladman<span class="token punctuation">.</span>Encryptor <span class="token operator">=</span> CTRGladman<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">processBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">words<span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> cipher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_cipher
                <span class="token keyword">var</span> blockSize <span class="token operator">=</span> cipher<span class="token punctuation">.</span>blockSize<span class="token punctuation">;</span>
                <span class="token keyword">var</span> iv <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_iv<span class="token punctuation">;</span>
                <span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_counter<span class="token punctuation">;</span>

                <span class="token comment">// Generate keystream</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>iv<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    counter <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_counter <span class="token operator">=</span> iv<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Remove IV for subsequent blocks</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>_iv <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token function">incCounter</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">var</span> keystream <span class="token operator">=</span> counter<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                cipher<span class="token punctuation">.</span><span class="token function">encryptBlock</span><span class="token punctuation">(</span>keystream<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Encrypt</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> blockSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    words<span class="token punctuation">[</span>offset <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">^=</span> keystream<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        CTRGladman<span class="token punctuation">.</span>Decryptor <span class="token operator">=</span> Encryptor<span class="token punctuation">;</span>

        <span class="token keyword">return</span> CTRGladman<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>




    <span class="token comment">/**
     * Output Feedback block mode.
     */</span>
    CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">OFB</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> <span class="token constant">OFB</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>BlockCipherMode<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">var</span> Encryptor <span class="token operator">=</span> <span class="token constant">OFB</span><span class="token punctuation">.</span>Encryptor <span class="token operator">=</span> <span class="token constant">OFB</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">processBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">words<span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> cipher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_cipher
                <span class="token keyword">var</span> blockSize <span class="token operator">=</span> cipher<span class="token punctuation">.</span>blockSize<span class="token punctuation">;</span>
                <span class="token keyword">var</span> iv <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_iv<span class="token punctuation">;</span>
                <span class="token keyword">var</span> keystream <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_keystream<span class="token punctuation">;</span>

                <span class="token comment">// Generate keystream</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>iv<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    keystream <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_keystream <span class="token operator">=</span> iv<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Remove IV for subsequent blocks</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>_iv <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                cipher<span class="token punctuation">.</span><span class="token function">encryptBlock</span><span class="token punctuation">(</span>keystream<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Encrypt</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> blockSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    words<span class="token punctuation">[</span>offset <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">^=</span> keystream<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token constant">OFB</span><span class="token punctuation">.</span>Decryptor <span class="token operator">=</span> Encryptor<span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token constant">OFB</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token comment">/**
     * Electronic Codebook block mode.
     */</span>
    CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">ECB</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> <span class="token constant">ECB</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>BlockCipherMode<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token constant">ECB</span><span class="token punctuation">.</span>Encryptor <span class="token operator">=</span> <span class="token constant">ECB</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">processBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">words<span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_cipher<span class="token punctuation">.</span><span class="token function">encryptBlock</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token constant">ECB</span><span class="token punctuation">.</span>Decryptor <span class="token operator">=</span> <span class="token constant">ECB</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">processBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">words<span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_cipher<span class="token punctuation">.</span><span class="token function">decryptBlock</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token constant">ECB</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token comment">/**
     * ANSI X.923 padding strategy.
     */</span>
    CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>AnsiX923 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function-variable function">pad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> blockSize</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Shortcuts</span>
            <span class="token keyword">var</span> dataSigBytes <span class="token operator">=</span> data<span class="token punctuation">.</span>sigBytes<span class="token punctuation">;</span>
            <span class="token keyword">var</span> blockSizeBytes <span class="token operator">=</span> blockSize <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

            <span class="token comment">// Count padding bytes</span>
            <span class="token keyword">var</span> nPaddingBytes <span class="token operator">=</span> blockSizeBytes <span class="token operator">-</span> dataSigBytes <span class="token operator">%</span> blockSizeBytes<span class="token punctuation">;</span>

            <span class="token comment">// Compute last byte position</span>
            <span class="token keyword">var</span> lastBytePos <span class="token operator">=</span> dataSigBytes <span class="token operator">+</span> nPaddingBytes <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>

            <span class="token comment">// Pad</span>
            data<span class="token punctuation">.</span><span class="token function">clamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span>words<span class="token punctuation">[</span>lastBytePos <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">|=</span> nPaddingBytes <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span>lastBytePos <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span>sigBytes <span class="token operator">+=</span> nPaddingBytes<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token function-variable function">unpad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Get number of padding bytes from last byte</span>
            <span class="token keyword">var</span> nPaddingBytes <span class="token operator">=</span> data<span class="token punctuation">.</span>words<span class="token punctuation">[</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>sigBytes <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>

            <span class="token comment">// Remove padding</span>
            data<span class="token punctuation">.</span>sigBytes <span class="token operator">-=</span> nPaddingBytes<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>


    <span class="token comment">/**
     * ISO 10126 padding strategy.
     */</span>
    CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Iso10126 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function-variable function">pad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> blockSize</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Shortcut</span>
            <span class="token keyword">var</span> blockSizeBytes <span class="token operator">=</span> blockSize <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

            <span class="token comment">// Count padding bytes</span>
            <span class="token keyword">var</span> nPaddingBytes <span class="token operator">=</span> blockSizeBytes <span class="token operator">-</span> data<span class="token punctuation">.</span>sigBytes <span class="token operator">%</span> blockSizeBytes<span class="token punctuation">;</span>

            <span class="token comment">// Pad</span>
            data<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>CryptoJS<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span>nPaddingBytes <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
            <span class="token function">concat</span><span class="token punctuation">(</span>CryptoJS<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span>nPaddingBytes <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token function-variable function">unpad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Get number of padding bytes from last byte</span>
            <span class="token keyword">var</span> nPaddingBytes <span class="token operator">=</span> data<span class="token punctuation">.</span>words<span class="token punctuation">[</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>sigBytes <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>

            <span class="token comment">// Remove padding</span>
            data<span class="token punctuation">.</span>sigBytes <span class="token operator">-=</span> nPaddingBytes<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>


    <span class="token comment">/**
     * ISO/IEC 9797-1 Padding Method 2.
     */</span>
    CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Iso97971 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function-variable function">pad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> blockSize</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Add 0x80 byte</span>
            data<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>CryptoJS<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0x80000000</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Zero pad the rest</span>
            CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>ZeroPadding<span class="token punctuation">.</span><span class="token function">pad</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> blockSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token function-variable function">unpad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Remove zero padding</span>
            CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>ZeroPadding<span class="token punctuation">.</span><span class="token function">unpad</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Remove one more byte -- the 0x80 byte</span>
            data<span class="token punctuation">.</span>sigBytes<span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>


    <span class="token comment">/**
     * Zero padding strategy.
     */</span>
    CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>ZeroPadding <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function-variable function">pad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> blockSize</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Shortcut</span>
            <span class="token keyword">var</span> blockSizeBytes <span class="token operator">=</span> blockSize <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

            <span class="token comment">// Pad</span>
            data<span class="token punctuation">.</span><span class="token function">clamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span>sigBytes <span class="token operator">+=</span> blockSizeBytes <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>sigBytes <span class="token operator">%</span> blockSizeBytes<span class="token punctuation">)</span> <span class="token operator">||</span> blockSizeBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token function-variable function">unpad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Shortcut</span>
            <span class="token keyword">var</span> dataWords <span class="token operator">=</span> data<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

            <span class="token comment">// Unpad</span>
            <span class="token keyword">var</span> i <span class="token operator">=</span> data<span class="token punctuation">.</span>sigBytes <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> data<span class="token punctuation">.</span>sigBytes <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dataWords<span class="token punctuation">[</span>i <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    data<span class="token punctuation">.</span>sigBytes <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>


    <span class="token comment">/**
     * A noop padding strategy.
     */</span>
    CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>NoPadding <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function-variable function">pad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token function-variable function">unpad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">undefined</span></span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> CipherParams <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>CipherParams<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_enc <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>enc<span class="token punctuation">;</span>
        <span class="token keyword">var</span> Hex <span class="token operator">=</span> C_enc<span class="token punctuation">.</span>Hex<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_format <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>format<span class="token punctuation">;</span>

        <span class="token keyword">var</span> HexFormatter <span class="token operator">=</span> C_format<span class="token punctuation">.</span>Hex <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Converts the ciphertext of a cipher params object to a hexadecimally encoded string.
             *
             * @param {CipherParams} cipherParams The cipher params object.
             *
             * @return {string} The hexadecimally encoded string.
             *
             * @static
             *
             * @example
             *
             *     var hexString = CryptoJS.format.Hex.stringify(cipherParams);
             */</span>
            <span class="token function-variable function">stringify</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">cipherParams</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> cipherParams<span class="token punctuation">.</span>ciphertext<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>Hex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token comment">/**
             * Converts a hexadecimally encoded ciphertext string to a cipher params object.
             *
             * @param {string} input The hexadecimally encoded string.
             *
             * @return {CipherParams} The cipher params object.
             *
             * @static
             *
             * @example
             *
             *     var cipherParams = CryptoJS.format.Hex.parse(hexString);
             */</span>
            <span class="token function-variable function">parse</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">input</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> ciphertext <span class="token operator">=</span> Hex<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> CipherParams<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    ciphertext<span class="token operator">:</span> ciphertext
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> BlockCipher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>BlockCipher<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>

        <span class="token comment">// Lookup tables</span>
        <span class="token keyword">var</span> <span class="token constant">SBOX</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">INV_SBOX</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">SUB_MIX_0</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">SUB_MIX_1</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">SUB_MIX_2</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">SUB_MIX_3</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">INV_SUB_MIX_0</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">INV_SUB_MIX_1</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">INV_SUB_MIX_2</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">INV_SUB_MIX_3</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// Compute lookup tables</span>
        <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Compute double table</span>
            <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x11b</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Walk GF(2^8)</span>
            <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> xi <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Compute sbox</span>
                <span class="token keyword">var</span> sx <span class="token operator">=</span> xi <span class="token operator">^</span> <span class="token punctuation">(</span>xi <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>xi <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>xi <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>xi <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                sx <span class="token operator">=</span> <span class="token punctuation">(</span>sx <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sx <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x63</span><span class="token punctuation">;</span>
                <span class="token constant">SBOX</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> sx<span class="token punctuation">;</span>
                <span class="token constant">INV_SBOX</span><span class="token punctuation">[</span>sx<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>

                <span class="token comment">// Compute multiplication</span>
                <span class="token keyword">var</span> x2 <span class="token operator">=</span> d<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> x4 <span class="token operator">=</span> d<span class="token punctuation">[</span>x2<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> x8 <span class="token operator">=</span> d<span class="token punctuation">[</span>x4<span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// Compute sub bytes, mix columns tables</span>
                <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token punctuation">(</span>d<span class="token punctuation">[</span>sx<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x101</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>sx <span class="token operator">*</span> <span class="token number">0x1010100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">SUB_MIX_0</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">SUB_MIX_1</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">SUB_MIX_2</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">SUB_MIX_3</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>

                <span class="token comment">// Compute inv sub bytes, inv mix columns tables</span>
                <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token punctuation">(</span>x8 <span class="token operator">*</span> <span class="token number">0x1010101</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>x4 <span class="token operator">*</span> <span class="token number">0x10001</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>x2 <span class="token operator">*</span> <span class="token number">0x101</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>x <span class="token operator">*</span> <span class="token number">0x1010100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">INV_SUB_MIX_0</span><span class="token punctuation">[</span>sx<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">INV_SUB_MIX_1</span><span class="token punctuation">[</span>sx<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">INV_SUB_MIX_2</span><span class="token punctuation">[</span>sx<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">INV_SUB_MIX_3</span><span class="token punctuation">[</span>sx<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>

                <span class="token comment">// Compute next counter</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    x <span class="token operator">=</span> xi <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    x <span class="token operator">=</span> x2 <span class="token operator">^</span> d<span class="token punctuation">[</span>d<span class="token punctuation">[</span>d<span class="token punctuation">[</span>x8 <span class="token operator">^</span> x2<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    xi <span class="token operator">^=</span> d<span class="token punctuation">[</span>d<span class="token punctuation">[</span>xi<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Precomputed Rcon lookup</span>
        <span class="token keyword">var</span> <span class="token constant">RCON</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * AES block cipher algorithm.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">AES</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">AES</span> <span class="token operator">=</span> BlockCipher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> t<span class="token punctuation">;</span>

                <span class="token comment">// Skip reset of nRounds has been set before and key did not change</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_nRounds <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_keyPriorReset <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_keyPriorReset <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_key<span class="token punctuation">;</span>
                <span class="token keyword">var</span> keyWords <span class="token operator">=</span> key<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> keySize <span class="token operator">=</span> key<span class="token punctuation">.</span>sigBytes <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token comment">// Compute number of rounds</span>
                <span class="token keyword">var</span> nRounds <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_nRounds <span class="token operator">=</span> keySize <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">;</span>

                <span class="token comment">// Compute number of key schedule rows</span>
                <span class="token keyword">var</span> ksRows <span class="token operator">=</span> <span class="token punctuation">(</span>nRounds <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token comment">// Compute key schedule</span>
                <span class="token keyword">var</span> keySchedule <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_keySchedule <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> ksRow <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ksRow <span class="token operator">&lt;</span> ksRows<span class="token punctuation">;</span> ksRow<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>ksRow <span class="token operator">&lt;</span> keySize<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        keySchedule<span class="token punctuation">[</span>ksRow<span class="token punctuation">]</span> <span class="token operator">=</span> keyWords<span class="token punctuation">[</span>ksRow<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        t <span class="token operator">=</span> keySchedule<span class="token punctuation">[</span>ksRow <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>ksRow <span class="token operator">%</span> keySize<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token comment">// Rot word</span>
                            t <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                            <span class="token comment">// Sub word</span>
                            t <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span><span class="token punctuation">(</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span><span class="token punctuation">(</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token constant">SBOX</span><span class="token punctuation">[</span>t <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                            <span class="token comment">// Mix Rcon</span>
                            t <span class="token operator">^=</span> <span class="token constant">RCON</span><span class="token punctuation">[</span><span class="token punctuation">(</span>ksRow <span class="token operator">/</span> keySize<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>keySize <span class="token operator">&gt;</span> <span class="token number">6</span> <span class="token operator">&amp;&amp;</span> ksRow <span class="token operator">%</span> keySize <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token comment">// Sub word</span>
                            t <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span><span class="token punctuation">(</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span><span class="token punctuation">(</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token constant">SBOX</span><span class="token punctuation">[</span>t <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>

                        keySchedule<span class="token punctuation">[</span>ksRow<span class="token punctuation">]</span> <span class="token operator">=</span> keySchedule<span class="token punctuation">[</span>ksRow <span class="token operator">-</span> keySize<span class="token punctuation">]</span> <span class="token operator">^</span> t<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Compute inv key schedule</span>
                <span class="token keyword">var</span> invKeySchedule <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_invKeySchedule <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> invKsRow <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> invKsRow <span class="token operator">&lt;</span> ksRows<span class="token punctuation">;</span> invKsRow<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> ksRow <span class="token operator">=</span> ksRows <span class="token operator">-</span> invKsRow<span class="token punctuation">;</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span>invKsRow <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">var</span> t <span class="token operator">=</span> keySchedule<span class="token punctuation">[</span>ksRow<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">var</span> t <span class="token operator">=</span> keySchedule<span class="token punctuation">[</span>ksRow <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span>invKsRow <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">||</span> ksRow <span class="token operator">&lt;=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        invKeySchedule<span class="token punctuation">[</span>invKsRow<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        invKeySchedule<span class="token punctuation">[</span>invKsRow<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">INV_SUB_MIX_0</span><span class="token punctuation">[</span><span class="token constant">SBOX</span><span class="token punctuation">[</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">INV_SUB_MIX_1</span><span class="token punctuation">[</span><span class="token constant">SBOX</span><span class="token punctuation">[</span><span class="token punctuation">(</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">^</span>
                            <span class="token constant">INV_SUB_MIX_2</span><span class="token punctuation">[</span><span class="token constant">SBOX</span><span class="token punctuation">[</span><span class="token punctuation">(</span>t <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">INV_SUB_MIX_3</span><span class="token punctuation">[</span><span class="token constant">SBOX</span><span class="token punctuation">[</span>t <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">encryptBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_doCryptBlock</span><span class="token punctuation">(</span><span class="token constant">M</span><span class="token punctuation">,</span> offset<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_keySchedule<span class="token punctuation">,</span> <span class="token constant">SUB_MIX_0</span><span class="token punctuation">,</span> <span class="token constant">SUB_MIX_1</span><span class="token punctuation">,</span> <span class="token constant">SUB_MIX_2</span><span class="token punctuation">,</span> <span class="token constant">SUB_MIX_3</span><span class="token punctuation">,</span> <span class="token constant">SBOX</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">decryptBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Swap 2nd and 4th rows</span>
                <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>

                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_doCryptBlock</span><span class="token punctuation">(</span><span class="token constant">M</span><span class="token punctuation">,</span> offset<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_invKeySchedule<span class="token punctuation">,</span> <span class="token constant">INV_SUB_MIX_0</span><span class="token punctuation">,</span> <span class="token constant">INV_SUB_MIX_1</span><span class="token punctuation">,</span> <span class="token constant">INV_SUB_MIX_2</span><span class="token punctuation">,</span> <span class="token constant">INV_SUB_MIX_3</span><span class="token punctuation">,</span> <span class="token constant">INV_SBOX</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Inv swap 2nd and 4th rows</span>
                <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doCryptBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset<span class="token punctuation">,</span> keySchedule<span class="token punctuation">,</span> <span class="token constant">SUB_MIX_0</span><span class="token punctuation">,</span> <span class="token constant">SUB_MIX_1</span><span class="token punctuation">,</span> <span class="token constant">SUB_MIX_2</span><span class="token punctuation">,</span> <span class="token constant">SUB_MIX_3</span><span class="token punctuation">,</span> <span class="token constant">SBOX</span></span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> nRounds <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_nRounds<span class="token punctuation">;</span>

                <span class="token comment">// Get input, add round key</span>
                <span class="token keyword">var</span> s0 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset<span class="token punctuation">]</span> <span class="token operator">^</span> keySchedule<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> s1 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> keySchedule<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> s2 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> keySchedule<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> s3 <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> keySchedule<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// Key schedule row counter</span>
                <span class="token keyword">var</span> ksRow <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>

                <span class="token comment">// Rounds</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> round <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> round <span class="token operator">&lt;</span> nRounds<span class="token punctuation">;</span> round<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Shift rows, sub bytes, mix columns, add round key</span>
                    <span class="token keyword">var</span> t0 <span class="token operator">=</span> <span class="token constant">SUB_MIX_0</span><span class="token punctuation">[</span>s0 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">SUB_MIX_1</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s1 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">SUB_MIX_2</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s2 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">SUB_MIX_3</span><span class="token punctuation">[</span>s3 <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">^</span> keySchedule<span class="token punctuation">[</span>ksRow<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> t1 <span class="token operator">=</span> <span class="token constant">SUB_MIX_0</span><span class="token punctuation">[</span>s1 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">SUB_MIX_1</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s2 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">SUB_MIX_2</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s3 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">SUB_MIX_3</span><span class="token punctuation">[</span>s0 <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">^</span> keySchedule<span class="token punctuation">[</span>ksRow<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> t2 <span class="token operator">=</span> <span class="token constant">SUB_MIX_0</span><span class="token punctuation">[</span>s2 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">SUB_MIX_1</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s3 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">SUB_MIX_2</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s0 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">SUB_MIX_3</span><span class="token punctuation">[</span>s1 <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">^</span> keySchedule<span class="token punctuation">[</span>ksRow<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> t3 <span class="token operator">=</span> <span class="token constant">SUB_MIX_0</span><span class="token punctuation">[</span>s3 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">SUB_MIX_1</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s0 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">SUB_MIX_2</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s1 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token constant">SUB_MIX_3</span><span class="token punctuation">[</span>s2 <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">^</span> keySchedule<span class="token punctuation">[</span>ksRow<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                    <span class="token comment">// Update state</span>
                    s0 <span class="token operator">=</span> t0<span class="token punctuation">;</span>
                    s1 <span class="token operator">=</span> t1<span class="token punctuation">;</span>
                    s2 <span class="token operator">=</span> t2<span class="token punctuation">;</span>
                    s3 <span class="token operator">=</span> t3<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Shift rows, sub bytes, add round key</span>
                <span class="token keyword">var</span> t0 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span>s0 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s1 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s2 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token constant">SBOX</span><span class="token punctuation">[</span>s3 <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> keySchedule<span class="token punctuation">[</span>ksRow<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> t1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span>s1 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s2 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s3 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token constant">SBOX</span><span class="token punctuation">[</span>s0 <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> keySchedule<span class="token punctuation">[</span>ksRow<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> t2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span>s2 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s3 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s0 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token constant">SBOX</span><span class="token punctuation">[</span>s1 <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> keySchedule<span class="token punctuation">[</span>ksRow<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> t3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span>s3 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s0 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">SBOX</span><span class="token punctuation">[</span><span class="token punctuation">(</span>s1 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token constant">SBOX</span><span class="token punctuation">[</span>s2 <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> keySchedule<span class="token punctuation">[</span>ksRow<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// Set output</span>
                <span class="token constant">M</span><span class="token punctuation">[</span>offset<span class="token punctuation">]</span> <span class="token operator">=</span> t0<span class="token punctuation">;</span>
                <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> t1<span class="token punctuation">;</span>
                <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> t2<span class="token punctuation">;</span>
                <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> t3<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            keySize<span class="token operator">:</span> <span class="token number">256</span> <span class="token operator">/</span> <span class="token number">32</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut functions to the cipher's object interface.
         *
         * @example
         *
         *     var ciphertext = CryptoJS.AES.encrypt(message, key, cfg);
         *     var plaintext  = CryptoJS.AES.decrypt(ciphertext, key, cfg);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span><span class="token constant">AES</span> <span class="token operator">=</span> BlockCipher<span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span><span class="token constant">AES</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> WordArray <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>WordArray<span class="token punctuation">;</span>
        <span class="token keyword">var</span> BlockCipher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>BlockCipher<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>

        <span class="token comment">// Permuted Choice 1 constants</span>
        <span class="token keyword">var</span> <span class="token constant">PC1</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span>
            <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span>
            <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span>
            <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// Permuted Choice 2 constants</span>
        <span class="token keyword">var</span> <span class="token constant">PC2</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
            <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
            <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span>
            <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span>
            <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span>
            <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">32</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// Cumulative bit shift constants</span>
        <span class="token keyword">var</span> <span class="token constant">BIT_SHIFTS</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// SBOXes and round permutation constants</span>
        <span class="token keyword">var</span> <span class="token constant">SBOX_P</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>
                <span class="token number">0x0</span><span class="token operator">:</span> <span class="token number">0x808200</span><span class="token punctuation">,</span>
                <span class="token number">0x10000000</span><span class="token operator">:</span> <span class="token number">0x8000</span><span class="token punctuation">,</span>
                <span class="token number">0x20000000</span><span class="token operator">:</span> <span class="token number">0x808002</span><span class="token punctuation">,</span>
                <span class="token number">0x30000000</span><span class="token operator">:</span> <span class="token number">0x2</span><span class="token punctuation">,</span>
                <span class="token number">0x40000000</span><span class="token operator">:</span> <span class="token number">0x200</span><span class="token punctuation">,</span>
                <span class="token number">0x50000000</span><span class="token operator">:</span> <span class="token number">0x808202</span><span class="token punctuation">,</span>
                <span class="token number">0x60000000</span><span class="token operator">:</span> <span class="token number">0x800202</span><span class="token punctuation">,</span>
                <span class="token number">0x70000000</span><span class="token operator">:</span> <span class="token number">0x800000</span><span class="token punctuation">,</span>
                <span class="token number">0x80000000</span><span class="token operator">:</span> <span class="token number">0x202</span><span class="token punctuation">,</span>
                <span class="token number">0x90000000</span><span class="token operator">:</span> <span class="token number">0x800200</span><span class="token punctuation">,</span>
                <span class="token number">0xa0000000</span><span class="token operator">:</span> <span class="token number">0x8200</span><span class="token punctuation">,</span>
                <span class="token number">0xb0000000</span><span class="token operator">:</span> <span class="token number">0x808000</span><span class="token punctuation">,</span>
                <span class="token number">0xc0000000</span><span class="token operator">:</span> <span class="token number">0x8002</span><span class="token punctuation">,</span>
                <span class="token number">0xd0000000</span><span class="token operator">:</span> <span class="token number">0x800002</span><span class="token punctuation">,</span>
                <span class="token number">0xe0000000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0xf0000000</span><span class="token operator">:</span> <span class="token number">0x8202</span><span class="token punctuation">,</span>
                <span class="token number">0x8000000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x18000000</span><span class="token operator">:</span> <span class="token number">0x808202</span><span class="token punctuation">,</span>
                <span class="token number">0x28000000</span><span class="token operator">:</span> <span class="token number">0x8202</span><span class="token punctuation">,</span>
                <span class="token number">0x38000000</span><span class="token operator">:</span> <span class="token number">0x8000</span><span class="token punctuation">,</span>
                <span class="token number">0x48000000</span><span class="token operator">:</span> <span class="token number">0x808200</span><span class="token punctuation">,</span>
                <span class="token number">0x58000000</span><span class="token operator">:</span> <span class="token number">0x200</span><span class="token punctuation">,</span>
                <span class="token number">0x68000000</span><span class="token operator">:</span> <span class="token number">0x808002</span><span class="token punctuation">,</span>
                <span class="token number">0x78000000</span><span class="token operator">:</span> <span class="token number">0x2</span><span class="token punctuation">,</span>
                <span class="token number">0x88000000</span><span class="token operator">:</span> <span class="token number">0x800200</span><span class="token punctuation">,</span>
                <span class="token number">0x98000000</span><span class="token operator">:</span> <span class="token number">0x8200</span><span class="token punctuation">,</span>
                <span class="token number">0xa8000000</span><span class="token operator">:</span> <span class="token number">0x808000</span><span class="token punctuation">,</span>
                <span class="token number">0xb8000000</span><span class="token operator">:</span> <span class="token number">0x800202</span><span class="token punctuation">,</span>
                <span class="token number">0xc8000000</span><span class="token operator">:</span> <span class="token number">0x800002</span><span class="token punctuation">,</span>
                <span class="token number">0xd8000000</span><span class="token operator">:</span> <span class="token number">0x8002</span><span class="token punctuation">,</span>
                <span class="token number">0xe8000000</span><span class="token operator">:</span> <span class="token number">0x202</span><span class="token punctuation">,</span>
                <span class="token number">0xf8000000</span><span class="token operator">:</span> <span class="token number">0x800000</span><span class="token punctuation">,</span>
                <span class="token number">0x1</span><span class="token operator">:</span> <span class="token number">0x8000</span><span class="token punctuation">,</span>
                <span class="token number">0x10000001</span><span class="token operator">:</span> <span class="token number">0x2</span><span class="token punctuation">,</span>
                <span class="token number">0x20000001</span><span class="token operator">:</span> <span class="token number">0x808200</span><span class="token punctuation">,</span>
                <span class="token number">0x30000001</span><span class="token operator">:</span> <span class="token number">0x800000</span><span class="token punctuation">,</span>
                <span class="token number">0x40000001</span><span class="token operator">:</span> <span class="token number">0x808002</span><span class="token punctuation">,</span>
                <span class="token number">0x50000001</span><span class="token operator">:</span> <span class="token number">0x8200</span><span class="token punctuation">,</span>
                <span class="token number">0x60000001</span><span class="token operator">:</span> <span class="token number">0x200</span><span class="token punctuation">,</span>
                <span class="token number">0x70000001</span><span class="token operator">:</span> <span class="token number">0x800202</span><span class="token punctuation">,</span>
                <span class="token number">0x80000001</span><span class="token operator">:</span> <span class="token number">0x808202</span><span class="token punctuation">,</span>
                <span class="token number">0x90000001</span><span class="token operator">:</span> <span class="token number">0x808000</span><span class="token punctuation">,</span>
                <span class="token number">0xa0000001</span><span class="token operator">:</span> <span class="token number">0x800002</span><span class="token punctuation">,</span>
                <span class="token number">0xb0000001</span><span class="token operator">:</span> <span class="token number">0x8202</span><span class="token punctuation">,</span>
                <span class="token number">0xc0000001</span><span class="token operator">:</span> <span class="token number">0x202</span><span class="token punctuation">,</span>
                <span class="token number">0xd0000001</span><span class="token operator">:</span> <span class="token number">0x800200</span><span class="token punctuation">,</span>
                <span class="token number">0xe0000001</span><span class="token operator">:</span> <span class="token number">0x8002</span><span class="token punctuation">,</span>
                <span class="token number">0xf0000001</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x8000001</span><span class="token operator">:</span> <span class="token number">0x808202</span><span class="token punctuation">,</span>
                <span class="token number">0x18000001</span><span class="token operator">:</span> <span class="token number">0x808000</span><span class="token punctuation">,</span>
                <span class="token number">0x28000001</span><span class="token operator">:</span> <span class="token number">0x800000</span><span class="token punctuation">,</span>
                <span class="token number">0x38000001</span><span class="token operator">:</span> <span class="token number">0x200</span><span class="token punctuation">,</span>
                <span class="token number">0x48000001</span><span class="token operator">:</span> <span class="token number">0x8000</span><span class="token punctuation">,</span>
                <span class="token number">0x58000001</span><span class="token operator">:</span> <span class="token number">0x800002</span><span class="token punctuation">,</span>
                <span class="token number">0x68000001</span><span class="token operator">:</span> <span class="token number">0x2</span><span class="token punctuation">,</span>
                <span class="token number">0x78000001</span><span class="token operator">:</span> <span class="token number">0x8202</span><span class="token punctuation">,</span>
                <span class="token number">0x88000001</span><span class="token operator">:</span> <span class="token number">0x8002</span><span class="token punctuation">,</span>
                <span class="token number">0x98000001</span><span class="token operator">:</span> <span class="token number">0x800202</span><span class="token punctuation">,</span>
                <span class="token number">0xa8000001</span><span class="token operator">:</span> <span class="token number">0x202</span><span class="token punctuation">,</span>
                <span class="token number">0xb8000001</span><span class="token operator">:</span> <span class="token number">0x808200</span><span class="token punctuation">,</span>
                <span class="token number">0xc8000001</span><span class="token operator">:</span> <span class="token number">0x800200</span><span class="token punctuation">,</span>
                <span class="token number">0xd8000001</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0xe8000001</span><span class="token operator">:</span> <span class="token number">0x8200</span><span class="token punctuation">,</span>
                <span class="token number">0xf8000001</span><span class="token operator">:</span> <span class="token number">0x808002</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token number">0x0</span><span class="token operator">:</span> <span class="token number">0x40084010</span><span class="token punctuation">,</span>
                <span class="token number">0x1000000</span><span class="token operator">:</span> <span class="token number">0x4000</span><span class="token punctuation">,</span>
                <span class="token number">0x2000000</span><span class="token operator">:</span> <span class="token number">0x80000</span><span class="token punctuation">,</span>
                <span class="token number">0x3000000</span><span class="token operator">:</span> <span class="token number">0x40080010</span><span class="token punctuation">,</span>
                <span class="token number">0x4000000</span><span class="token operator">:</span> <span class="token number">0x40000010</span><span class="token punctuation">,</span>
                <span class="token number">0x5000000</span><span class="token operator">:</span> <span class="token number">0x40084000</span><span class="token punctuation">,</span>
                <span class="token number">0x6000000</span><span class="token operator">:</span> <span class="token number">0x40004000</span><span class="token punctuation">,</span>
                <span class="token number">0x7000000</span><span class="token operator">:</span> <span class="token number">0x10</span><span class="token punctuation">,</span>
                <span class="token number">0x8000000</span><span class="token operator">:</span> <span class="token number">0x84000</span><span class="token punctuation">,</span>
                <span class="token number">0x9000000</span><span class="token operator">:</span> <span class="token number">0x40004010</span><span class="token punctuation">,</span>
                <span class="token number">0xa000000</span><span class="token operator">:</span> <span class="token number">0x40000000</span><span class="token punctuation">,</span>
                <span class="token number">0xb000000</span><span class="token operator">:</span> <span class="token number">0x84010</span><span class="token punctuation">,</span>
                <span class="token number">0xc000000</span><span class="token operator">:</span> <span class="token number">0x80010</span><span class="token punctuation">,</span>
                <span class="token number">0xd000000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0xe000000</span><span class="token operator">:</span> <span class="token number">0x4010</span><span class="token punctuation">,</span>
                <span class="token number">0xf000000</span><span class="token operator">:</span> <span class="token number">0x40080000</span><span class="token punctuation">,</span>
                <span class="token number">0x800000</span><span class="token operator">:</span> <span class="token number">0x40004000</span><span class="token punctuation">,</span>
                <span class="token number">0x1800000</span><span class="token operator">:</span> <span class="token number">0x84010</span><span class="token punctuation">,</span>
                <span class="token number">0x2800000</span><span class="token operator">:</span> <span class="token number">0x10</span><span class="token punctuation">,</span>
                <span class="token number">0x3800000</span><span class="token operator">:</span> <span class="token number">0x40004010</span><span class="token punctuation">,</span>
                <span class="token number">0x4800000</span><span class="token operator">:</span> <span class="token number">0x40084010</span><span class="token punctuation">,</span>
                <span class="token number">0x5800000</span><span class="token operator">:</span> <span class="token number">0x40000000</span><span class="token punctuation">,</span>
                <span class="token number">0x6800000</span><span class="token operator">:</span> <span class="token number">0x80000</span><span class="token punctuation">,</span>
                <span class="token number">0x7800000</span><span class="token operator">:</span> <span class="token number">0x40080010</span><span class="token punctuation">,</span>
                <span class="token number">0x8800000</span><span class="token operator">:</span> <span class="token number">0x80010</span><span class="token punctuation">,</span>
                <span class="token number">0x9800000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0xa800000</span><span class="token operator">:</span> <span class="token number">0x4000</span><span class="token punctuation">,</span>
                <span class="token number">0xb800000</span><span class="token operator">:</span> <span class="token number">0x40080000</span><span class="token punctuation">,</span>
                <span class="token number">0xc800000</span><span class="token operator">:</span> <span class="token number">0x40000010</span><span class="token punctuation">,</span>
                <span class="token number">0xd800000</span><span class="token operator">:</span> <span class="token number">0x84000</span><span class="token punctuation">,</span>
                <span class="token number">0xe800000</span><span class="token operator">:</span> <span class="token number">0x40084000</span><span class="token punctuation">,</span>
                <span class="token number">0xf800000</span><span class="token operator">:</span> <span class="token number">0x4010</span><span class="token punctuation">,</span>
                <span class="token number">0x10000000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x11000000</span><span class="token operator">:</span> <span class="token number">0x40080010</span><span class="token punctuation">,</span>
                <span class="token number">0x12000000</span><span class="token operator">:</span> <span class="token number">0x40004010</span><span class="token punctuation">,</span>
                <span class="token number">0x13000000</span><span class="token operator">:</span> <span class="token number">0x40084000</span><span class="token punctuation">,</span>
                <span class="token number">0x14000000</span><span class="token operator">:</span> <span class="token number">0x40080000</span><span class="token punctuation">,</span>
                <span class="token number">0x15000000</span><span class="token operator">:</span> <span class="token number">0x10</span><span class="token punctuation">,</span>
                <span class="token number">0x16000000</span><span class="token operator">:</span> <span class="token number">0x84010</span><span class="token punctuation">,</span>
                <span class="token number">0x17000000</span><span class="token operator">:</span> <span class="token number">0x4000</span><span class="token punctuation">,</span>
                <span class="token number">0x18000000</span><span class="token operator">:</span> <span class="token number">0x4010</span><span class="token punctuation">,</span>
                <span class="token number">0x19000000</span><span class="token operator">:</span> <span class="token number">0x80000</span><span class="token punctuation">,</span>
                <span class="token number">0x1a000000</span><span class="token operator">:</span> <span class="token number">0x80010</span><span class="token punctuation">,</span>
                <span class="token number">0x1b000000</span><span class="token operator">:</span> <span class="token number">0x40000010</span><span class="token punctuation">,</span>
                <span class="token number">0x1c000000</span><span class="token operator">:</span> <span class="token number">0x84000</span><span class="token punctuation">,</span>
                <span class="token number">0x1d000000</span><span class="token operator">:</span> <span class="token number">0x40004000</span><span class="token punctuation">,</span>
                <span class="token number">0x1e000000</span><span class="token operator">:</span> <span class="token number">0x40000000</span><span class="token punctuation">,</span>
                <span class="token number">0x1f000000</span><span class="token operator">:</span> <span class="token number">0x40084010</span><span class="token punctuation">,</span>
                <span class="token number">0x10800000</span><span class="token operator">:</span> <span class="token number">0x84010</span><span class="token punctuation">,</span>
                <span class="token number">0x11800000</span><span class="token operator">:</span> <span class="token number">0x80000</span><span class="token punctuation">,</span>
                <span class="token number">0x12800000</span><span class="token operator">:</span> <span class="token number">0x40080000</span><span class="token punctuation">,</span>
                <span class="token number">0x13800000</span><span class="token operator">:</span> <span class="token number">0x4000</span><span class="token punctuation">,</span>
                <span class="token number">0x14800000</span><span class="token operator">:</span> <span class="token number">0x40004000</span><span class="token punctuation">,</span>
                <span class="token number">0x15800000</span><span class="token operator">:</span> <span class="token number">0x40084010</span><span class="token punctuation">,</span>
                <span class="token number">0x16800000</span><span class="token operator">:</span> <span class="token number">0x10</span><span class="token punctuation">,</span>
                <span class="token number">0x17800000</span><span class="token operator">:</span> <span class="token number">0x40000000</span><span class="token punctuation">,</span>
                <span class="token number">0x18800000</span><span class="token operator">:</span> <span class="token number">0x40084000</span><span class="token punctuation">,</span>
                <span class="token number">0x19800000</span><span class="token operator">:</span> <span class="token number">0x40000010</span><span class="token punctuation">,</span>
                <span class="token number">0x1a800000</span><span class="token operator">:</span> <span class="token number">0x40004010</span><span class="token punctuation">,</span>
                <span class="token number">0x1b800000</span><span class="token operator">:</span> <span class="token number">0x80010</span><span class="token punctuation">,</span>
                <span class="token number">0x1c800000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x1d800000</span><span class="token operator">:</span> <span class="token number">0x4010</span><span class="token punctuation">,</span>
                <span class="token number">0x1e800000</span><span class="token operator">:</span> <span class="token number">0x40080010</span><span class="token punctuation">,</span>
                <span class="token number">0x1f800000</span><span class="token operator">:</span> <span class="token number">0x84000</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token number">0x0</span><span class="token operator">:</span> <span class="token number">0x104</span><span class="token punctuation">,</span>
                <span class="token number">0x100000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x200000</span><span class="token operator">:</span> <span class="token number">0x4000100</span><span class="token punctuation">,</span>
                <span class="token number">0x300000</span><span class="token operator">:</span> <span class="token number">0x10104</span><span class="token punctuation">,</span>
                <span class="token number">0x400000</span><span class="token operator">:</span> <span class="token number">0x10004</span><span class="token punctuation">,</span>
                <span class="token number">0x500000</span><span class="token operator">:</span> <span class="token number">0x4000004</span><span class="token punctuation">,</span>
                <span class="token number">0x600000</span><span class="token operator">:</span> <span class="token number">0x4010104</span><span class="token punctuation">,</span>
                <span class="token number">0x700000</span><span class="token operator">:</span> <span class="token number">0x4010000</span><span class="token punctuation">,</span>
                <span class="token number">0x800000</span><span class="token operator">:</span> <span class="token number">0x4000000</span><span class="token punctuation">,</span>
                <span class="token number">0x900000</span><span class="token operator">:</span> <span class="token number">0x4010100</span><span class="token punctuation">,</span>
                <span class="token number">0xa00000</span><span class="token operator">:</span> <span class="token number">0x10100</span><span class="token punctuation">,</span>
                <span class="token number">0xb00000</span><span class="token operator">:</span> <span class="token number">0x4010004</span><span class="token punctuation">,</span>
                <span class="token number">0xc00000</span><span class="token operator">:</span> <span class="token number">0x4000104</span><span class="token punctuation">,</span>
                <span class="token number">0xd00000</span><span class="token operator">:</span> <span class="token number">0x10000</span><span class="token punctuation">,</span>
                <span class="token number">0xe00000</span><span class="token operator">:</span> <span class="token number">0x4</span><span class="token punctuation">,</span>
                <span class="token number">0xf00000</span><span class="token operator">:</span> <span class="token number">0x100</span><span class="token punctuation">,</span>
                <span class="token number">0x80000</span><span class="token operator">:</span> <span class="token number">0x4010100</span><span class="token punctuation">,</span>
                <span class="token number">0x180000</span><span class="token operator">:</span> <span class="token number">0x4010004</span><span class="token punctuation">,</span>
                <span class="token number">0x280000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x380000</span><span class="token operator">:</span> <span class="token number">0x4000100</span><span class="token punctuation">,</span>
                <span class="token number">0x480000</span><span class="token operator">:</span> <span class="token number">0x4000004</span><span class="token punctuation">,</span>
                <span class="token number">0x580000</span><span class="token operator">:</span> <span class="token number">0x10000</span><span class="token punctuation">,</span>
                <span class="token number">0x680000</span><span class="token operator">:</span> <span class="token number">0x10004</span><span class="token punctuation">,</span>
                <span class="token number">0x780000</span><span class="token operator">:</span> <span class="token number">0x104</span><span class="token punctuation">,</span>
                <span class="token number">0x880000</span><span class="token operator">:</span> <span class="token number">0x4</span><span class="token punctuation">,</span>
                <span class="token number">0x980000</span><span class="token operator">:</span> <span class="token number">0x100</span><span class="token punctuation">,</span>
                <span class="token number">0xa80000</span><span class="token operator">:</span> <span class="token number">0x4010000</span><span class="token punctuation">,</span>
                <span class="token number">0xb80000</span><span class="token operator">:</span> <span class="token number">0x10104</span><span class="token punctuation">,</span>
                <span class="token number">0xc80000</span><span class="token operator">:</span> <span class="token number">0x10100</span><span class="token punctuation">,</span>
                <span class="token number">0xd80000</span><span class="token operator">:</span> <span class="token number">0x4000104</span><span class="token punctuation">,</span>
                <span class="token number">0xe80000</span><span class="token operator">:</span> <span class="token number">0x4010104</span><span class="token punctuation">,</span>
                <span class="token number">0xf80000</span><span class="token operator">:</span> <span class="token number">0x4000000</span><span class="token punctuation">,</span>
                <span class="token number">0x1000000</span><span class="token operator">:</span> <span class="token number">0x4010100</span><span class="token punctuation">,</span>
                <span class="token number">0x1100000</span><span class="token operator">:</span> <span class="token number">0x10004</span><span class="token punctuation">,</span>
                <span class="token number">0x1200000</span><span class="token operator">:</span> <span class="token number">0x10000</span><span class="token punctuation">,</span>
                <span class="token number">0x1300000</span><span class="token operator">:</span> <span class="token number">0x4000100</span><span class="token punctuation">,</span>
                <span class="token number">0x1400000</span><span class="token operator">:</span> <span class="token number">0x100</span><span class="token punctuation">,</span>
                <span class="token number">0x1500000</span><span class="token operator">:</span> <span class="token number">0x4010104</span><span class="token punctuation">,</span>
                <span class="token number">0x1600000</span><span class="token operator">:</span> <span class="token number">0x4000004</span><span class="token punctuation">,</span>
                <span class="token number">0x1700000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x1800000</span><span class="token operator">:</span> <span class="token number">0x4000104</span><span class="token punctuation">,</span>
                <span class="token number">0x1900000</span><span class="token operator">:</span> <span class="token number">0x4000000</span><span class="token punctuation">,</span>
                <span class="token number">0x1a00000</span><span class="token operator">:</span> <span class="token number">0x4</span><span class="token punctuation">,</span>
                <span class="token number">0x1b00000</span><span class="token operator">:</span> <span class="token number">0x10100</span><span class="token punctuation">,</span>
                <span class="token number">0x1c00000</span><span class="token operator">:</span> <span class="token number">0x4010000</span><span class="token punctuation">,</span>
                <span class="token number">0x1d00000</span><span class="token operator">:</span> <span class="token number">0x104</span><span class="token punctuation">,</span>
                <span class="token number">0x1e00000</span><span class="token operator">:</span> <span class="token number">0x10104</span><span class="token punctuation">,</span>
                <span class="token number">0x1f00000</span><span class="token operator">:</span> <span class="token number">0x4010004</span><span class="token punctuation">,</span>
                <span class="token number">0x1080000</span><span class="token operator">:</span> <span class="token number">0x4000000</span><span class="token punctuation">,</span>
                <span class="token number">0x1180000</span><span class="token operator">:</span> <span class="token number">0x104</span><span class="token punctuation">,</span>
                <span class="token number">0x1280000</span><span class="token operator">:</span> <span class="token number">0x4010100</span><span class="token punctuation">,</span>
                <span class="token number">0x1380000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x1480000</span><span class="token operator">:</span> <span class="token number">0x10004</span><span class="token punctuation">,</span>
                <span class="token number">0x1580000</span><span class="token operator">:</span> <span class="token number">0x4000100</span><span class="token punctuation">,</span>
                <span class="token number">0x1680000</span><span class="token operator">:</span> <span class="token number">0x100</span><span class="token punctuation">,</span>
                <span class="token number">0x1780000</span><span class="token operator">:</span> <span class="token number">0x4010004</span><span class="token punctuation">,</span>
                <span class="token number">0x1880000</span><span class="token operator">:</span> <span class="token number">0x10000</span><span class="token punctuation">,</span>
                <span class="token number">0x1980000</span><span class="token operator">:</span> <span class="token number">0x4010104</span><span class="token punctuation">,</span>
                <span class="token number">0x1a80000</span><span class="token operator">:</span> <span class="token number">0x10104</span><span class="token punctuation">,</span>
                <span class="token number">0x1b80000</span><span class="token operator">:</span> <span class="token number">0x4000004</span><span class="token punctuation">,</span>
                <span class="token number">0x1c80000</span><span class="token operator">:</span> <span class="token number">0x4000104</span><span class="token punctuation">,</span>
                <span class="token number">0x1d80000</span><span class="token operator">:</span> <span class="token number">0x4010000</span><span class="token punctuation">,</span>
                <span class="token number">0x1e80000</span><span class="token operator">:</span> <span class="token number">0x4</span><span class="token punctuation">,</span>
                <span class="token number">0x1f80000</span><span class="token operator">:</span> <span class="token number">0x10100</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token number">0x0</span><span class="token operator">:</span> <span class="token number">0x80401000</span><span class="token punctuation">,</span>
                <span class="token number">0x10000</span><span class="token operator">:</span> <span class="token number">0x80001040</span><span class="token punctuation">,</span>
                <span class="token number">0x20000</span><span class="token operator">:</span> <span class="token number">0x401040</span><span class="token punctuation">,</span>
                <span class="token number">0x30000</span><span class="token operator">:</span> <span class="token number">0x80400000</span><span class="token punctuation">,</span>
                <span class="token number">0x40000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x50000</span><span class="token operator">:</span> <span class="token number">0x401000</span><span class="token punctuation">,</span>
                <span class="token number">0x60000</span><span class="token operator">:</span> <span class="token number">0x80000040</span><span class="token punctuation">,</span>
                <span class="token number">0x70000</span><span class="token operator">:</span> <span class="token number">0x400040</span><span class="token punctuation">,</span>
                <span class="token number">0x80000</span><span class="token operator">:</span> <span class="token number">0x80000000</span><span class="token punctuation">,</span>
                <span class="token number">0x90000</span><span class="token operator">:</span> <span class="token number">0x400000</span><span class="token punctuation">,</span>
                <span class="token number">0xa0000</span><span class="token operator">:</span> <span class="token number">0x40</span><span class="token punctuation">,</span>
                <span class="token number">0xb0000</span><span class="token operator">:</span> <span class="token number">0x80001000</span><span class="token punctuation">,</span>
                <span class="token number">0xc0000</span><span class="token operator">:</span> <span class="token number">0x80400040</span><span class="token punctuation">,</span>
                <span class="token number">0xd0000</span><span class="token operator">:</span> <span class="token number">0x1040</span><span class="token punctuation">,</span>
                <span class="token number">0xe0000</span><span class="token operator">:</span> <span class="token number">0x1000</span><span class="token punctuation">,</span>
                <span class="token number">0xf0000</span><span class="token operator">:</span> <span class="token number">0x80401040</span><span class="token punctuation">,</span>
                <span class="token number">0x8000</span><span class="token operator">:</span> <span class="token number">0x80001040</span><span class="token punctuation">,</span>
                <span class="token number">0x18000</span><span class="token operator">:</span> <span class="token number">0x40</span><span class="token punctuation">,</span>
                <span class="token number">0x28000</span><span class="token operator">:</span> <span class="token number">0x80400040</span><span class="token punctuation">,</span>
                <span class="token number">0x38000</span><span class="token operator">:</span> <span class="token number">0x80001000</span><span class="token punctuation">,</span>
                <span class="token number">0x48000</span><span class="token operator">:</span> <span class="token number">0x401000</span><span class="token punctuation">,</span>
                <span class="token number">0x58000</span><span class="token operator">:</span> <span class="token number">0x80401040</span><span class="token punctuation">,</span>
                <span class="token number">0x68000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x78000</span><span class="token operator">:</span> <span class="token number">0x80400000</span><span class="token punctuation">,</span>
                <span class="token number">0x88000</span><span class="token operator">:</span> <span class="token number">0x1000</span><span class="token punctuation">,</span>
                <span class="token number">0x98000</span><span class="token operator">:</span> <span class="token number">0x80401000</span><span class="token punctuation">,</span>
                <span class="token number">0xa8000</span><span class="token operator">:</span> <span class="token number">0x400000</span><span class="token punctuation">,</span>
                <span class="token number">0xb8000</span><span class="token operator">:</span> <span class="token number">0x1040</span><span class="token punctuation">,</span>
                <span class="token number">0xc8000</span><span class="token operator">:</span> <span class="token number">0x80000000</span><span class="token punctuation">,</span>
                <span class="token number">0xd8000</span><span class="token operator">:</span> <span class="token number">0x400040</span><span class="token punctuation">,</span>
                <span class="token number">0xe8000</span><span class="token operator">:</span> <span class="token number">0x401040</span><span class="token punctuation">,</span>
                <span class="token number">0xf8000</span><span class="token operator">:</span> <span class="token number">0x80000040</span><span class="token punctuation">,</span>
                <span class="token number">0x100000</span><span class="token operator">:</span> <span class="token number">0x400040</span><span class="token punctuation">,</span>
                <span class="token number">0x110000</span><span class="token operator">:</span> <span class="token number">0x401000</span><span class="token punctuation">,</span>
                <span class="token number">0x120000</span><span class="token operator">:</span> <span class="token number">0x80000040</span><span class="token punctuation">,</span>
                <span class="token number">0x130000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x140000</span><span class="token operator">:</span> <span class="token number">0x1040</span><span class="token punctuation">,</span>
                <span class="token number">0x150000</span><span class="token operator">:</span> <span class="token number">0x80400040</span><span class="token punctuation">,</span>
                <span class="token number">0x160000</span><span class="token operator">:</span> <span class="token number">0x80401000</span><span class="token punctuation">,</span>
                <span class="token number">0x170000</span><span class="token operator">:</span> <span class="token number">0x80001040</span><span class="token punctuation">,</span>
                <span class="token number">0x180000</span><span class="token operator">:</span> <span class="token number">0x80401040</span><span class="token punctuation">,</span>
                <span class="token number">0x190000</span><span class="token operator">:</span> <span class="token number">0x80000000</span><span class="token punctuation">,</span>
                <span class="token number">0x1a0000</span><span class="token operator">:</span> <span class="token number">0x80400000</span><span class="token punctuation">,</span>
                <span class="token number">0x1b0000</span><span class="token operator">:</span> <span class="token number">0x401040</span><span class="token punctuation">,</span>
                <span class="token number">0x1c0000</span><span class="token operator">:</span> <span class="token number">0x80001000</span><span class="token punctuation">,</span>
                <span class="token number">0x1d0000</span><span class="token operator">:</span> <span class="token number">0x400000</span><span class="token punctuation">,</span>
                <span class="token number">0x1e0000</span><span class="token operator">:</span> <span class="token number">0x40</span><span class="token punctuation">,</span>
                <span class="token number">0x1f0000</span><span class="token operator">:</span> <span class="token number">0x1000</span><span class="token punctuation">,</span>
                <span class="token number">0x108000</span><span class="token operator">:</span> <span class="token number">0x80400000</span><span class="token punctuation">,</span>
                <span class="token number">0x118000</span><span class="token operator">:</span> <span class="token number">0x80401040</span><span class="token punctuation">,</span>
                <span class="token number">0x128000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x138000</span><span class="token operator">:</span> <span class="token number">0x401000</span><span class="token punctuation">,</span>
                <span class="token number">0x148000</span><span class="token operator">:</span> <span class="token number">0x400040</span><span class="token punctuation">,</span>
                <span class="token number">0x158000</span><span class="token operator">:</span> <span class="token number">0x80000000</span><span class="token punctuation">,</span>
                <span class="token number">0x168000</span><span class="token operator">:</span> <span class="token number">0x80001040</span><span class="token punctuation">,</span>
                <span class="token number">0x178000</span><span class="token operator">:</span> <span class="token number">0x40</span><span class="token punctuation">,</span>
                <span class="token number">0x188000</span><span class="token operator">:</span> <span class="token number">0x80000040</span><span class="token punctuation">,</span>
                <span class="token number">0x198000</span><span class="token operator">:</span> <span class="token number">0x1000</span><span class="token punctuation">,</span>
                <span class="token number">0x1a8000</span><span class="token operator">:</span> <span class="token number">0x80001000</span><span class="token punctuation">,</span>
                <span class="token number">0x1b8000</span><span class="token operator">:</span> <span class="token number">0x80400040</span><span class="token punctuation">,</span>
                <span class="token number">0x1c8000</span><span class="token operator">:</span> <span class="token number">0x1040</span><span class="token punctuation">,</span>
                <span class="token number">0x1d8000</span><span class="token operator">:</span> <span class="token number">0x80401000</span><span class="token punctuation">,</span>
                <span class="token number">0x1e8000</span><span class="token operator">:</span> <span class="token number">0x400000</span><span class="token punctuation">,</span>
                <span class="token number">0x1f8000</span><span class="token operator">:</span> <span class="token number">0x401040</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token number">0x0</span><span class="token operator">:</span> <span class="token number">0x80</span><span class="token punctuation">,</span>
                <span class="token number">0x1000</span><span class="token operator">:</span> <span class="token number">0x1040000</span><span class="token punctuation">,</span>
                <span class="token number">0x2000</span><span class="token operator">:</span> <span class="token number">0x40000</span><span class="token punctuation">,</span>
                <span class="token number">0x3000</span><span class="token operator">:</span> <span class="token number">0x20000000</span><span class="token punctuation">,</span>
                <span class="token number">0x4000</span><span class="token operator">:</span> <span class="token number">0x20040080</span><span class="token punctuation">,</span>
                <span class="token number">0x5000</span><span class="token operator">:</span> <span class="token number">0x1000080</span><span class="token punctuation">,</span>
                <span class="token number">0x6000</span><span class="token operator">:</span> <span class="token number">0x21000080</span><span class="token punctuation">,</span>
                <span class="token number">0x7000</span><span class="token operator">:</span> <span class="token number">0x40080</span><span class="token punctuation">,</span>
                <span class="token number">0x8000</span><span class="token operator">:</span> <span class="token number">0x1000000</span><span class="token punctuation">,</span>
                <span class="token number">0x9000</span><span class="token operator">:</span> <span class="token number">0x20040000</span><span class="token punctuation">,</span>
                <span class="token number">0xa000</span><span class="token operator">:</span> <span class="token number">0x20000080</span><span class="token punctuation">,</span>
                <span class="token number">0xb000</span><span class="token operator">:</span> <span class="token number">0x21040080</span><span class="token punctuation">,</span>
                <span class="token number">0xc000</span><span class="token operator">:</span> <span class="token number">0x21040000</span><span class="token punctuation">,</span>
                <span class="token number">0xd000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0xe000</span><span class="token operator">:</span> <span class="token number">0x1040080</span><span class="token punctuation">,</span>
                <span class="token number">0xf000</span><span class="token operator">:</span> <span class="token number">0x21000000</span><span class="token punctuation">,</span>
                <span class="token number">0x800</span><span class="token operator">:</span> <span class="token number">0x1040080</span><span class="token punctuation">,</span>
                <span class="token number">0x1800</span><span class="token operator">:</span> <span class="token number">0x21000080</span><span class="token punctuation">,</span>
                <span class="token number">0x2800</span><span class="token operator">:</span> <span class="token number">0x80</span><span class="token punctuation">,</span>
                <span class="token number">0x3800</span><span class="token operator">:</span> <span class="token number">0x1040000</span><span class="token punctuation">,</span>
                <span class="token number">0x4800</span><span class="token operator">:</span> <span class="token number">0x40000</span><span class="token punctuation">,</span>
                <span class="token number">0x5800</span><span class="token operator">:</span> <span class="token number">0x20040080</span><span class="token punctuation">,</span>
                <span class="token number">0x6800</span><span class="token operator">:</span> <span class="token number">0x21040000</span><span class="token punctuation">,</span>
                <span class="token number">0x7800</span><span class="token operator">:</span> <span class="token number">0x20000000</span><span class="token punctuation">,</span>
                <span class="token number">0x8800</span><span class="token operator">:</span> <span class="token number">0x20040000</span><span class="token punctuation">,</span>
                <span class="token number">0x9800</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0xa800</span><span class="token operator">:</span> <span class="token number">0x21040080</span><span class="token punctuation">,</span>
                <span class="token number">0xb800</span><span class="token operator">:</span> <span class="token number">0x1000080</span><span class="token punctuation">,</span>
                <span class="token number">0xc800</span><span class="token operator">:</span> <span class="token number">0x20000080</span><span class="token punctuation">,</span>
                <span class="token number">0xd800</span><span class="token operator">:</span> <span class="token number">0x21000000</span><span class="token punctuation">,</span>
                <span class="token number">0xe800</span><span class="token operator">:</span> <span class="token number">0x1000000</span><span class="token punctuation">,</span>
                <span class="token number">0xf800</span><span class="token operator">:</span> <span class="token number">0x40080</span><span class="token punctuation">,</span>
                <span class="token number">0x10000</span><span class="token operator">:</span> <span class="token number">0x40000</span><span class="token punctuation">,</span>
                <span class="token number">0x11000</span><span class="token operator">:</span> <span class="token number">0x80</span><span class="token punctuation">,</span>
                <span class="token number">0x12000</span><span class="token operator">:</span> <span class="token number">0x20000000</span><span class="token punctuation">,</span>
                <span class="token number">0x13000</span><span class="token operator">:</span> <span class="token number">0x21000080</span><span class="token punctuation">,</span>
                <span class="token number">0x14000</span><span class="token operator">:</span> <span class="token number">0x1000080</span><span class="token punctuation">,</span>
                <span class="token number">0x15000</span><span class="token operator">:</span> <span class="token number">0x21040000</span><span class="token punctuation">,</span>
                <span class="token number">0x16000</span><span class="token operator">:</span> <span class="token number">0x20040080</span><span class="token punctuation">,</span>
                <span class="token number">0x17000</span><span class="token operator">:</span> <span class="token number">0x1000000</span><span class="token punctuation">,</span>
                <span class="token number">0x18000</span><span class="token operator">:</span> <span class="token number">0x21040080</span><span class="token punctuation">,</span>
                <span class="token number">0x19000</span><span class="token operator">:</span> <span class="token number">0x21000000</span><span class="token punctuation">,</span>
                <span class="token number">0x1a000</span><span class="token operator">:</span> <span class="token number">0x1040000</span><span class="token punctuation">,</span>
                <span class="token number">0x1b000</span><span class="token operator">:</span> <span class="token number">0x20040000</span><span class="token punctuation">,</span>
                <span class="token number">0x1c000</span><span class="token operator">:</span> <span class="token number">0x40080</span><span class="token punctuation">,</span>
                <span class="token number">0x1d000</span><span class="token operator">:</span> <span class="token number">0x20000080</span><span class="token punctuation">,</span>
                <span class="token number">0x1e000</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x1f000</span><span class="token operator">:</span> <span class="token number">0x1040080</span><span class="token punctuation">,</span>
                <span class="token number">0x10800</span><span class="token operator">:</span> <span class="token number">0x21000080</span><span class="token punctuation">,</span>
                <span class="token number">0x11800</span><span class="token operator">:</span> <span class="token number">0x1000000</span><span class="token punctuation">,</span>
                <span class="token number">0x12800</span><span class="token operator">:</span> <span class="token number">0x1040000</span><span class="token punctuation">,</span>
                <span class="token number">0x13800</span><span class="token operator">:</span> <span class="token number">0x20040080</span><span class="token punctuation">,</span>
                <span class="token number">0x14800</span><span class="token operator">:</span> <span class="token number">0x20000000</span><span class="token punctuation">,</span>
                <span class="token number">0x15800</span><span class="token operator">:</span> <span class="token number">0x1040080</span><span class="token punctuation">,</span>
                <span class="token number">0x16800</span><span class="token operator">:</span> <span class="token number">0x80</span><span class="token punctuation">,</span>
                <span class="token number">0x17800</span><span class="token operator">:</span> <span class="token number">0x21040000</span><span class="token punctuation">,</span>
                <span class="token number">0x18800</span><span class="token operator">:</span> <span class="token number">0x40080</span><span class="token punctuation">,</span>
                <span class="token number">0x19800</span><span class="token operator">:</span> <span class="token number">0x21040080</span><span class="token punctuation">,</span>
                <span class="token number">0x1a800</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x1b800</span><span class="token operator">:</span> <span class="token number">0x21000000</span><span class="token punctuation">,</span>
                <span class="token number">0x1c800</span><span class="token operator">:</span> <span class="token number">0x1000080</span><span class="token punctuation">,</span>
                <span class="token number">0x1d800</span><span class="token operator">:</span> <span class="token number">0x40000</span><span class="token punctuation">,</span>
                <span class="token number">0x1e800</span><span class="token operator">:</span> <span class="token number">0x20040000</span><span class="token punctuation">,</span>
                <span class="token number">0x1f800</span><span class="token operator">:</span> <span class="token number">0x20000080</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token number">0x0</span><span class="token operator">:</span> <span class="token number">0x10000008</span><span class="token punctuation">,</span>
                <span class="token number">0x100</span><span class="token operator">:</span> <span class="token number">0x2000</span><span class="token punctuation">,</span>
                <span class="token number">0x200</span><span class="token operator">:</span> <span class="token number">0x10200000</span><span class="token punctuation">,</span>
                <span class="token number">0x300</span><span class="token operator">:</span> <span class="token number">0x10202008</span><span class="token punctuation">,</span>
                <span class="token number">0x400</span><span class="token operator">:</span> <span class="token number">0x10002000</span><span class="token punctuation">,</span>
                <span class="token number">0x500</span><span class="token operator">:</span> <span class="token number">0x200000</span><span class="token punctuation">,</span>
                <span class="token number">0x600</span><span class="token operator">:</span> <span class="token number">0x200008</span><span class="token punctuation">,</span>
                <span class="token number">0x700</span><span class="token operator">:</span> <span class="token number">0x10000000</span><span class="token punctuation">,</span>
                <span class="token number">0x800</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x900</span><span class="token operator">:</span> <span class="token number">0x10002008</span><span class="token punctuation">,</span>
                <span class="token number">0xa00</span><span class="token operator">:</span> <span class="token number">0x202000</span><span class="token punctuation">,</span>
                <span class="token number">0xb00</span><span class="token operator">:</span> <span class="token number">0x8</span><span class="token punctuation">,</span>
                <span class="token number">0xc00</span><span class="token operator">:</span> <span class="token number">0x10200008</span><span class="token punctuation">,</span>
                <span class="token number">0xd00</span><span class="token operator">:</span> <span class="token number">0x202008</span><span class="token punctuation">,</span>
                <span class="token number">0xe00</span><span class="token operator">:</span> <span class="token number">0x2008</span><span class="token punctuation">,</span>
                <span class="token number">0xf00</span><span class="token operator">:</span> <span class="token number">0x10202000</span><span class="token punctuation">,</span>
                <span class="token number">0x80</span><span class="token operator">:</span> <span class="token number">0x10200000</span><span class="token punctuation">,</span>
                <span class="token number">0x180</span><span class="token operator">:</span> <span class="token number">0x10202008</span><span class="token punctuation">,</span>
                <span class="token number">0x280</span><span class="token operator">:</span> <span class="token number">0x8</span><span class="token punctuation">,</span>
                <span class="token number">0x380</span><span class="token operator">:</span> <span class="token number">0x200000</span><span class="token punctuation">,</span>
                <span class="token number">0x480</span><span class="token operator">:</span> <span class="token number">0x202008</span><span class="token punctuation">,</span>
                <span class="token number">0x580</span><span class="token operator">:</span> <span class="token number">0x10000008</span><span class="token punctuation">,</span>
                <span class="token number">0x680</span><span class="token operator">:</span> <span class="token number">0x10002000</span><span class="token punctuation">,</span>
                <span class="token number">0x780</span><span class="token operator">:</span> <span class="token number">0x2008</span><span class="token punctuation">,</span>
                <span class="token number">0x880</span><span class="token operator">:</span> <span class="token number">0x200008</span><span class="token punctuation">,</span>
                <span class="token number">0x980</span><span class="token operator">:</span> <span class="token number">0x2000</span><span class="token punctuation">,</span>
                <span class="token number">0xa80</span><span class="token operator">:</span> <span class="token number">0x10002008</span><span class="token punctuation">,</span>
                <span class="token number">0xb80</span><span class="token operator">:</span> <span class="token number">0x10200008</span><span class="token punctuation">,</span>
                <span class="token number">0xc80</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0xd80</span><span class="token operator">:</span> <span class="token number">0x10202000</span><span class="token punctuation">,</span>
                <span class="token number">0xe80</span><span class="token operator">:</span> <span class="token number">0x202000</span><span class="token punctuation">,</span>
                <span class="token number">0xf80</span><span class="token operator">:</span> <span class="token number">0x10000000</span><span class="token punctuation">,</span>
                <span class="token number">0x1000</span><span class="token operator">:</span> <span class="token number">0x10002000</span><span class="token punctuation">,</span>
                <span class="token number">0x1100</span><span class="token operator">:</span> <span class="token number">0x10200008</span><span class="token punctuation">,</span>
                <span class="token number">0x1200</span><span class="token operator">:</span> <span class="token number">0x10202008</span><span class="token punctuation">,</span>
                <span class="token number">0x1300</span><span class="token operator">:</span> <span class="token number">0x2008</span><span class="token punctuation">,</span>
                <span class="token number">0x1400</span><span class="token operator">:</span> <span class="token number">0x200000</span><span class="token punctuation">,</span>
                <span class="token number">0x1500</span><span class="token operator">:</span> <span class="token number">0x10000000</span><span class="token punctuation">,</span>
                <span class="token number">0x1600</span><span class="token operator">:</span> <span class="token number">0x10000008</span><span class="token punctuation">,</span>
                <span class="token number">0x1700</span><span class="token operator">:</span> <span class="token number">0x202000</span><span class="token punctuation">,</span>
                <span class="token number">0x1800</span><span class="token operator">:</span> <span class="token number">0x202008</span><span class="token punctuation">,</span>
                <span class="token number">0x1900</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x1a00</span><span class="token operator">:</span> <span class="token number">0x8</span><span class="token punctuation">,</span>
                <span class="token number">0x1b00</span><span class="token operator">:</span> <span class="token number">0x10200000</span><span class="token punctuation">,</span>
                <span class="token number">0x1c00</span><span class="token operator">:</span> <span class="token number">0x2000</span><span class="token punctuation">,</span>
                <span class="token number">0x1d00</span><span class="token operator">:</span> <span class="token number">0x10002008</span><span class="token punctuation">,</span>
                <span class="token number">0x1e00</span><span class="token operator">:</span> <span class="token number">0x10202000</span><span class="token punctuation">,</span>
                <span class="token number">0x1f00</span><span class="token operator">:</span> <span class="token number">0x200008</span><span class="token punctuation">,</span>
                <span class="token number">0x1080</span><span class="token operator">:</span> <span class="token number">0x8</span><span class="token punctuation">,</span>
                <span class="token number">0x1180</span><span class="token operator">:</span> <span class="token number">0x202000</span><span class="token punctuation">,</span>
                <span class="token number">0x1280</span><span class="token operator">:</span> <span class="token number">0x200000</span><span class="token punctuation">,</span>
                <span class="token number">0x1380</span><span class="token operator">:</span> <span class="token number">0x10000008</span><span class="token punctuation">,</span>
                <span class="token number">0x1480</span><span class="token operator">:</span> <span class="token number">0x10002000</span><span class="token punctuation">,</span>
                <span class="token number">0x1580</span><span class="token operator">:</span> <span class="token number">0x2008</span><span class="token punctuation">,</span>
                <span class="token number">0x1680</span><span class="token operator">:</span> <span class="token number">0x10202008</span><span class="token punctuation">,</span>
                <span class="token number">0x1780</span><span class="token operator">:</span> <span class="token number">0x10200000</span><span class="token punctuation">,</span>
                <span class="token number">0x1880</span><span class="token operator">:</span> <span class="token number">0x10202000</span><span class="token punctuation">,</span>
                <span class="token number">0x1980</span><span class="token operator">:</span> <span class="token number">0x10200008</span><span class="token punctuation">,</span>
                <span class="token number">0x1a80</span><span class="token operator">:</span> <span class="token number">0x2000</span><span class="token punctuation">,</span>
                <span class="token number">0x1b80</span><span class="token operator">:</span> <span class="token number">0x202008</span><span class="token punctuation">,</span>
                <span class="token number">0x1c80</span><span class="token operator">:</span> <span class="token number">0x200008</span><span class="token punctuation">,</span>
                <span class="token number">0x1d80</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x1e80</span><span class="token operator">:</span> <span class="token number">0x10000000</span><span class="token punctuation">,</span>
                <span class="token number">0x1f80</span><span class="token operator">:</span> <span class="token number">0x10002008</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token number">0x0</span><span class="token operator">:</span> <span class="token number">0x100000</span><span class="token punctuation">,</span>
                <span class="token number">0x10</span><span class="token operator">:</span> <span class="token number">0x2000401</span><span class="token punctuation">,</span>
                <span class="token number">0x20</span><span class="token operator">:</span> <span class="token number">0x400</span><span class="token punctuation">,</span>
                <span class="token number">0x30</span><span class="token operator">:</span> <span class="token number">0x100401</span><span class="token punctuation">,</span>
                <span class="token number">0x40</span><span class="token operator">:</span> <span class="token number">0x2100401</span><span class="token punctuation">,</span>
                <span class="token number">0x50</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x60</span><span class="token operator">:</span> <span class="token number">0x1</span><span class="token punctuation">,</span>
                <span class="token number">0x70</span><span class="token operator">:</span> <span class="token number">0x2100001</span><span class="token punctuation">,</span>
                <span class="token number">0x80</span><span class="token operator">:</span> <span class="token number">0x2000400</span><span class="token punctuation">,</span>
                <span class="token number">0x90</span><span class="token operator">:</span> <span class="token number">0x100001</span><span class="token punctuation">,</span>
                <span class="token number">0xa0</span><span class="token operator">:</span> <span class="token number">0x2000001</span><span class="token punctuation">,</span>
                <span class="token number">0xb0</span><span class="token operator">:</span> <span class="token number">0x2100400</span><span class="token punctuation">,</span>
                <span class="token number">0xc0</span><span class="token operator">:</span> <span class="token number">0x2100000</span><span class="token punctuation">,</span>
                <span class="token number">0xd0</span><span class="token operator">:</span> <span class="token number">0x401</span><span class="token punctuation">,</span>
                <span class="token number">0xe0</span><span class="token operator">:</span> <span class="token number">0x100400</span><span class="token punctuation">,</span>
                <span class="token number">0xf0</span><span class="token operator">:</span> <span class="token number">0x2000000</span><span class="token punctuation">,</span>
                <span class="token number">0x8</span><span class="token operator">:</span> <span class="token number">0x2100001</span><span class="token punctuation">,</span>
                <span class="token number">0x18</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x28</span><span class="token operator">:</span> <span class="token number">0x2000401</span><span class="token punctuation">,</span>
                <span class="token number">0x38</span><span class="token operator">:</span> <span class="token number">0x2100400</span><span class="token punctuation">,</span>
                <span class="token number">0x48</span><span class="token operator">:</span> <span class="token number">0x100000</span><span class="token punctuation">,</span>
                <span class="token number">0x58</span><span class="token operator">:</span> <span class="token number">0x2000001</span><span class="token punctuation">,</span>
                <span class="token number">0x68</span><span class="token operator">:</span> <span class="token number">0x2000000</span><span class="token punctuation">,</span>
                <span class="token number">0x78</span><span class="token operator">:</span> <span class="token number">0x401</span><span class="token punctuation">,</span>
                <span class="token number">0x88</span><span class="token operator">:</span> <span class="token number">0x100401</span><span class="token punctuation">,</span>
                <span class="token number">0x98</span><span class="token operator">:</span> <span class="token number">0x2000400</span><span class="token punctuation">,</span>
                <span class="token number">0xa8</span><span class="token operator">:</span> <span class="token number">0x2100000</span><span class="token punctuation">,</span>
                <span class="token number">0xb8</span><span class="token operator">:</span> <span class="token number">0x100001</span><span class="token punctuation">,</span>
                <span class="token number">0xc8</span><span class="token operator">:</span> <span class="token number">0x400</span><span class="token punctuation">,</span>
                <span class="token number">0xd8</span><span class="token operator">:</span> <span class="token number">0x2100401</span><span class="token punctuation">,</span>
                <span class="token number">0xe8</span><span class="token operator">:</span> <span class="token number">0x1</span><span class="token punctuation">,</span>
                <span class="token number">0xf8</span><span class="token operator">:</span> <span class="token number">0x100400</span><span class="token punctuation">,</span>
                <span class="token number">0x100</span><span class="token operator">:</span> <span class="token number">0x2000000</span><span class="token punctuation">,</span>
                <span class="token number">0x110</span><span class="token operator">:</span> <span class="token number">0x100000</span><span class="token punctuation">,</span>
                <span class="token number">0x120</span><span class="token operator">:</span> <span class="token number">0x2000401</span><span class="token punctuation">,</span>
                <span class="token number">0x130</span><span class="token operator">:</span> <span class="token number">0x2100001</span><span class="token punctuation">,</span>
                <span class="token number">0x140</span><span class="token operator">:</span> <span class="token number">0x100001</span><span class="token punctuation">,</span>
                <span class="token number">0x150</span><span class="token operator">:</span> <span class="token number">0x2000400</span><span class="token punctuation">,</span>
                <span class="token number">0x160</span><span class="token operator">:</span> <span class="token number">0x2100400</span><span class="token punctuation">,</span>
                <span class="token number">0x170</span><span class="token operator">:</span> <span class="token number">0x100401</span><span class="token punctuation">,</span>
                <span class="token number">0x180</span><span class="token operator">:</span> <span class="token number">0x401</span><span class="token punctuation">,</span>
                <span class="token number">0x190</span><span class="token operator">:</span> <span class="token number">0x2100401</span><span class="token punctuation">,</span>
                <span class="token number">0x1a0</span><span class="token operator">:</span> <span class="token number">0x100400</span><span class="token punctuation">,</span>
                <span class="token number">0x1b0</span><span class="token operator">:</span> <span class="token number">0x1</span><span class="token punctuation">,</span>
                <span class="token number">0x1c0</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x1d0</span><span class="token operator">:</span> <span class="token number">0x2100000</span><span class="token punctuation">,</span>
                <span class="token number">0x1e0</span><span class="token operator">:</span> <span class="token number">0x2000001</span><span class="token punctuation">,</span>
                <span class="token number">0x1f0</span><span class="token operator">:</span> <span class="token number">0x400</span><span class="token punctuation">,</span>
                <span class="token number">0x108</span><span class="token operator">:</span> <span class="token number">0x100400</span><span class="token punctuation">,</span>
                <span class="token number">0x118</span><span class="token operator">:</span> <span class="token number">0x2000401</span><span class="token punctuation">,</span>
                <span class="token number">0x128</span><span class="token operator">:</span> <span class="token number">0x2100001</span><span class="token punctuation">,</span>
                <span class="token number">0x138</span><span class="token operator">:</span> <span class="token number">0x1</span><span class="token punctuation">,</span>
                <span class="token number">0x148</span><span class="token operator">:</span> <span class="token number">0x2000000</span><span class="token punctuation">,</span>
                <span class="token number">0x158</span><span class="token operator">:</span> <span class="token number">0x100000</span><span class="token punctuation">,</span>
                <span class="token number">0x168</span><span class="token operator">:</span> <span class="token number">0x401</span><span class="token punctuation">,</span>
                <span class="token number">0x178</span><span class="token operator">:</span> <span class="token number">0x2100400</span><span class="token punctuation">,</span>
                <span class="token number">0x188</span><span class="token operator">:</span> <span class="token number">0x2000001</span><span class="token punctuation">,</span>
                <span class="token number">0x198</span><span class="token operator">:</span> <span class="token number">0x2100000</span><span class="token punctuation">,</span>
                <span class="token number">0x1a8</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x1b8</span><span class="token operator">:</span> <span class="token number">0x2100401</span><span class="token punctuation">,</span>
                <span class="token number">0x1c8</span><span class="token operator">:</span> <span class="token number">0x100401</span><span class="token punctuation">,</span>
                <span class="token number">0x1d8</span><span class="token operator">:</span> <span class="token number">0x400</span><span class="token punctuation">,</span>
                <span class="token number">0x1e8</span><span class="token operator">:</span> <span class="token number">0x2000400</span><span class="token punctuation">,</span>
                <span class="token number">0x1f8</span><span class="token operator">:</span> <span class="token number">0x100001</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token number">0x0</span><span class="token operator">:</span> <span class="token number">0x8000820</span><span class="token punctuation">,</span>
                <span class="token number">0x1</span><span class="token operator">:</span> <span class="token number">0x20000</span><span class="token punctuation">,</span>
                <span class="token number">0x2</span><span class="token operator">:</span> <span class="token number">0x8000000</span><span class="token punctuation">,</span>
                <span class="token number">0x3</span><span class="token operator">:</span> <span class="token number">0x20</span><span class="token punctuation">,</span>
                <span class="token number">0x4</span><span class="token operator">:</span> <span class="token number">0x20020</span><span class="token punctuation">,</span>
                <span class="token number">0x5</span><span class="token operator">:</span> <span class="token number">0x8020820</span><span class="token punctuation">,</span>
                <span class="token number">0x6</span><span class="token operator">:</span> <span class="token number">0x8020800</span><span class="token punctuation">,</span>
                <span class="token number">0x7</span><span class="token operator">:</span> <span class="token number">0x800</span><span class="token punctuation">,</span>
                <span class="token number">0x8</span><span class="token operator">:</span> <span class="token number">0x8020000</span><span class="token punctuation">,</span>
                <span class="token number">0x9</span><span class="token operator">:</span> <span class="token number">0x8000800</span><span class="token punctuation">,</span>
                <span class="token number">0xa</span><span class="token operator">:</span> <span class="token number">0x20800</span><span class="token punctuation">,</span>
                <span class="token number">0xb</span><span class="token operator">:</span> <span class="token number">0x8020020</span><span class="token punctuation">,</span>
                <span class="token number">0xc</span><span class="token operator">:</span> <span class="token number">0x820</span><span class="token punctuation">,</span>
                <span class="token number">0xd</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0xe</span><span class="token operator">:</span> <span class="token number">0x8000020</span><span class="token punctuation">,</span>
                <span class="token number">0xf</span><span class="token operator">:</span> <span class="token number">0x20820</span><span class="token punctuation">,</span>
                <span class="token number">0x80000000</span><span class="token operator">:</span> <span class="token number">0x800</span><span class="token punctuation">,</span>
                <span class="token number">0x80000001</span><span class="token operator">:</span> <span class="token number">0x8020820</span><span class="token punctuation">,</span>
                <span class="token number">0x80000002</span><span class="token operator">:</span> <span class="token number">0x8000820</span><span class="token punctuation">,</span>
                <span class="token number">0x80000003</span><span class="token operator">:</span> <span class="token number">0x8000000</span><span class="token punctuation">,</span>
                <span class="token number">0x80000004</span><span class="token operator">:</span> <span class="token number">0x8020000</span><span class="token punctuation">,</span>
                <span class="token number">0x80000005</span><span class="token operator">:</span> <span class="token number">0x20800</span><span class="token punctuation">,</span>
                <span class="token number">0x80000006</span><span class="token operator">:</span> <span class="token number">0x20820</span><span class="token punctuation">,</span>
                <span class="token number">0x80000007</span><span class="token operator">:</span> <span class="token number">0x20</span><span class="token punctuation">,</span>
                <span class="token number">0x80000008</span><span class="token operator">:</span> <span class="token number">0x8000020</span><span class="token punctuation">,</span>
                <span class="token number">0x80000009</span><span class="token operator">:</span> <span class="token number">0x820</span><span class="token punctuation">,</span>
                <span class="token number">0x8000000a</span><span class="token operator">:</span> <span class="token number">0x20020</span><span class="token punctuation">,</span>
                <span class="token number">0x8000000b</span><span class="token operator">:</span> <span class="token number">0x8020800</span><span class="token punctuation">,</span>
                <span class="token number">0x8000000c</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x8000000d</span><span class="token operator">:</span> <span class="token number">0x8020020</span><span class="token punctuation">,</span>
                <span class="token number">0x8000000e</span><span class="token operator">:</span> <span class="token number">0x8000800</span><span class="token punctuation">,</span>
                <span class="token number">0x8000000f</span><span class="token operator">:</span> <span class="token number">0x20000</span><span class="token punctuation">,</span>
                <span class="token number">0x10</span><span class="token operator">:</span> <span class="token number">0x20820</span><span class="token punctuation">,</span>
                <span class="token number">0x11</span><span class="token operator">:</span> <span class="token number">0x8020800</span><span class="token punctuation">,</span>
                <span class="token number">0x12</span><span class="token operator">:</span> <span class="token number">0x20</span><span class="token punctuation">,</span>
                <span class="token number">0x13</span><span class="token operator">:</span> <span class="token number">0x800</span><span class="token punctuation">,</span>
                <span class="token number">0x14</span><span class="token operator">:</span> <span class="token number">0x8000800</span><span class="token punctuation">,</span>
                <span class="token number">0x15</span><span class="token operator">:</span> <span class="token number">0x8000020</span><span class="token punctuation">,</span>
                <span class="token number">0x16</span><span class="token operator">:</span> <span class="token number">0x8020020</span><span class="token punctuation">,</span>
                <span class="token number">0x17</span><span class="token operator">:</span> <span class="token number">0x20000</span><span class="token punctuation">,</span>
                <span class="token number">0x18</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x19</span><span class="token operator">:</span> <span class="token number">0x20020</span><span class="token punctuation">,</span>
                <span class="token number">0x1a</span><span class="token operator">:</span> <span class="token number">0x8020000</span><span class="token punctuation">,</span>
                <span class="token number">0x1b</span><span class="token operator">:</span> <span class="token number">0x8000820</span><span class="token punctuation">,</span>
                <span class="token number">0x1c</span><span class="token operator">:</span> <span class="token number">0x8020820</span><span class="token punctuation">,</span>
                <span class="token number">0x1d</span><span class="token operator">:</span> <span class="token number">0x20800</span><span class="token punctuation">,</span>
                <span class="token number">0x1e</span><span class="token operator">:</span> <span class="token number">0x820</span><span class="token punctuation">,</span>
                <span class="token number">0x1f</span><span class="token operator">:</span> <span class="token number">0x8000000</span><span class="token punctuation">,</span>
                <span class="token number">0x80000010</span><span class="token operator">:</span> <span class="token number">0x20000</span><span class="token punctuation">,</span>
                <span class="token number">0x80000011</span><span class="token operator">:</span> <span class="token number">0x800</span><span class="token punctuation">,</span>
                <span class="token number">0x80000012</span><span class="token operator">:</span> <span class="token number">0x8020020</span><span class="token punctuation">,</span>
                <span class="token number">0x80000013</span><span class="token operator">:</span> <span class="token number">0x20820</span><span class="token punctuation">,</span>
                <span class="token number">0x80000014</span><span class="token operator">:</span> <span class="token number">0x20</span><span class="token punctuation">,</span>
                <span class="token number">0x80000015</span><span class="token operator">:</span> <span class="token number">0x8020000</span><span class="token punctuation">,</span>
                <span class="token number">0x80000016</span><span class="token operator">:</span> <span class="token number">0x8000000</span><span class="token punctuation">,</span>
                <span class="token number">0x80000017</span><span class="token operator">:</span> <span class="token number">0x8000820</span><span class="token punctuation">,</span>
                <span class="token number">0x80000018</span><span class="token operator">:</span> <span class="token number">0x8020820</span><span class="token punctuation">,</span>
                <span class="token number">0x80000019</span><span class="token operator">:</span> <span class="token number">0x8000020</span><span class="token punctuation">,</span>
                <span class="token number">0x8000001a</span><span class="token operator">:</span> <span class="token number">0x8000800</span><span class="token punctuation">,</span>
                <span class="token number">0x8000001b</span><span class="token operator">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span>
                <span class="token number">0x8000001c</span><span class="token operator">:</span> <span class="token number">0x20800</span><span class="token punctuation">,</span>
                <span class="token number">0x8000001d</span><span class="token operator">:</span> <span class="token number">0x820</span><span class="token punctuation">,</span>
                <span class="token number">0x8000001e</span><span class="token operator">:</span> <span class="token number">0x20020</span><span class="token punctuation">,</span>
                <span class="token number">0x8000001f</span><span class="token operator">:</span> <span class="token number">0x8020800</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// Masks that select the SBOX input</span>
        <span class="token keyword">var</span> <span class="token constant">SBOX_MASK</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token number">0xf8000001</span><span class="token punctuation">,</span> <span class="token number">0x1f800000</span><span class="token punctuation">,</span> <span class="token number">0x01f80000</span><span class="token punctuation">,</span> <span class="token number">0x001f8000</span><span class="token punctuation">,</span>
            <span class="token number">0x0001f800</span><span class="token punctuation">,</span> <span class="token number">0x00001f80</span><span class="token punctuation">,</span> <span class="token number">0x000001f8</span><span class="token punctuation">,</span> <span class="token number">0x8000001f</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * DES block cipher algorithm.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">DES</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">DES</span> <span class="token operator">=</span> BlockCipher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_key<span class="token punctuation">;</span>
                <span class="token keyword">var</span> keyWords <span class="token operator">=</span> key<span class="token punctuation">.</span>words<span class="token punctuation">;</span>

                <span class="token comment">// Select 56 bits according to PC1</span>
                <span class="token keyword">var</span> keyBits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">56</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> keyBitPos <span class="token operator">=</span> <span class="token constant">PC1</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    keyBits<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>keyWords<span class="token punctuation">[</span>keyBitPos <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">31</span> <span class="token operator">-</span> keyBitPos <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Assemble 16 subkeys</span>
                <span class="token keyword">var</span> subKeys <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_subKeys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> nSubKey <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> nSubKey <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> nSubKey<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Create subkey</span>
                    <span class="token keyword">var</span> subKey <span class="token operator">=</span> subKeys<span class="token punctuation">[</span>nSubKey<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                    <span class="token comment">// Shortcut</span>
                    <span class="token keyword">var</span> bitShift <span class="token operator">=</span> <span class="token constant">BIT_SHIFTS</span><span class="token punctuation">[</span>nSubKey<span class="token punctuation">]</span><span class="token punctuation">;</span>

                    <span class="token comment">// Select 48 bits according to PC2</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">// Select from the left 28 key bits</span>
                        subKey<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">/</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">|=</span> keyBits<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">PC2</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> bitShift<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">31</span> <span class="token operator">-</span> i <span class="token operator">%</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                        <span class="token comment">// Select from the right 28 key bits</span>
                        subKey<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">/</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">|=</span> keyBits<span class="token punctuation">[</span><span class="token number">28</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">PC2</span><span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> bitShift<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">31</span> <span class="token operator">-</span> i <span class="token operator">%</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token comment">// Since each subkey is applied to an expanded 32-bit input,</span>
                    <span class="token comment">// the subkey can be broken into 8 values scaled to 32-bits,</span>
                    <span class="token comment">// which allows the key to be used without expansion</span>
                    subKey<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>subKey<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>subKey<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">7</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        subKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> subKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    subKey<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>subKey<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>subKey<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Compute inverse subkeys</span>
                <span class="token keyword">var</span> invSubKeys <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_invSubKeys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    invSubKeys<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> subKeys<span class="token punctuation">[</span><span class="token number">15</span> <span class="token operator">-</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">encryptBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_doCryptBlock</span><span class="token punctuation">(</span><span class="token constant">M</span><span class="token punctuation">,</span> offset<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_subKeys<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">decryptBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_doCryptBlock</span><span class="token punctuation">(</span><span class="token constant">M</span><span class="token punctuation">,</span> offset<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_invSubKeys<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doCryptBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset<span class="token punctuation">,</span> subKeys</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Get input</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_lBlock <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_rBlock <span class="token operator">=</span> <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// Initial permutation</span>
                <span class="token function">exchangeLR</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0x0f0f0f0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">exchangeLR</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">exchangeRL</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0x33333333</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">exchangeRL</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">exchangeLR</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0x55555555</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Rounds</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> round <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> round <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> round<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Shortcuts</span>
                    <span class="token keyword">var</span> subKey <span class="token operator">=</span> subKeys<span class="token punctuation">[</span>round<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> lBlock <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_lBlock<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> rBlock <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_rBlock<span class="token punctuation">;</span>

                    <span class="token comment">// Feistel function</span>
                    <span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        f <span class="token operator">|=</span> <span class="token constant">SBOX_P</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>rBlock <span class="token operator">^</span> subKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token constant">SBOX_MASK</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>_lBlock <span class="token operator">=</span> rBlock<span class="token punctuation">;</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>_rBlock <span class="token operator">=</span> lBlock <span class="token operator">^</span> f<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Undo swap from last round</span>
                <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_lBlock<span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_lBlock <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_rBlock<span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_rBlock <span class="token operator">=</span> t<span class="token punctuation">;</span>

                <span class="token comment">// Final permutation</span>
                <span class="token function">exchangeLR</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0x55555555</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">exchangeRL</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">exchangeRL</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0x33333333</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">exchangeLR</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">exchangeLR</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0x0f0f0f0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Set output</span>
                <span class="token constant">M</span><span class="token punctuation">[</span>offset<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_lBlock<span class="token punctuation">;</span>
                <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_rBlock<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            keySize<span class="token operator">:</span> <span class="token number">64</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">,</span>

            ivSize<span class="token operator">:</span> <span class="token number">64</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">,</span>

            blockSize<span class="token operator">:</span> <span class="token number">64</span> <span class="token operator">/</span> <span class="token number">32</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Swap bits across the left and right words</span>
        <span class="token keyword">function</span> <span class="token function">exchangeLR</span><span class="token punctuation">(</span><span class="token parameter">offset<span class="token punctuation">,</span> mask</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_lBlock <span class="token operator">&gt;&gt;&gt;</span> offset<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_rBlock<span class="token punctuation">)</span> <span class="token operator">&amp;</span> mask<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_rBlock <span class="token operator">^=</span> t<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_lBlock <span class="token operator">^=</span> t <span class="token operator">&lt;&lt;</span> offset<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">function</span> <span class="token function">exchangeRL</span><span class="token punctuation">(</span><span class="token parameter">offset<span class="token punctuation">,</span> mask</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_rBlock <span class="token operator">&gt;&gt;&gt;</span> offset<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_lBlock<span class="token punctuation">)</span> <span class="token operator">&amp;</span> mask<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_lBlock <span class="token operator">^=</span> t<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_rBlock <span class="token operator">^=</span> t <span class="token operator">&lt;&lt;</span> offset<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/**
         * Shortcut functions to the cipher's object interface.
         *
         * @example
         *
         *     var ciphertext = CryptoJS.DES.encrypt(message, key, cfg);
         *     var plaintext  = CryptoJS.DES.decrypt(ciphertext, key, cfg);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span><span class="token constant">DES</span> <span class="token operator">=</span> BlockCipher<span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span><span class="token constant">DES</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Triple-DES block cipher algorithm.
         */</span>
        <span class="token keyword">var</span> TripleDES <span class="token operator">=</span> C_algo<span class="token punctuation">.</span>TripleDES <span class="token operator">=</span> BlockCipher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_key<span class="token punctuation">;</span>
                <span class="token keyword">var</span> keyWords <span class="token operator">=</span> key<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token comment">// Make sure the key length is valid (64, 128 or &gt;= 192 bit)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>keyWords<span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> keyWords<span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> keyWords<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Invalid key length - 3DES requires the key length to be 64, 128, 192 or &gt;192.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Extend the key according to the keying options defined in 3DES standard</span>
                <span class="token keyword">var</span> key1 <span class="token operator">=</span> keyWords<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> key2 <span class="token operator">=</span> keyWords<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token operator">?</span> keyWords<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">:</span> keyWords<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> key3 <span class="token operator">=</span> keyWords<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">6</span> <span class="token operator">?</span> keyWords<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">:</span> keyWords<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Create DES instances</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_des1 <span class="token operator">=</span> <span class="token constant">DES</span><span class="token punctuation">.</span><span class="token function">createEncryptor</span><span class="token punctuation">(</span>WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>key1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_des2 <span class="token operator">=</span> <span class="token constant">DES</span><span class="token punctuation">.</span><span class="token function">createEncryptor</span><span class="token punctuation">(</span>WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>key2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_des3 <span class="token operator">=</span> <span class="token constant">DES</span><span class="token punctuation">.</span><span class="token function">createEncryptor</span><span class="token punctuation">(</span>WordArray<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>key3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">encryptBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_des1<span class="token punctuation">.</span><span class="token function">encryptBlock</span><span class="token punctuation">(</span><span class="token constant">M</span><span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_des2<span class="token punctuation">.</span><span class="token function">decryptBlock</span><span class="token punctuation">(</span><span class="token constant">M</span><span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_des3<span class="token punctuation">.</span><span class="token function">encryptBlock</span><span class="token punctuation">(</span><span class="token constant">M</span><span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">decryptBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_des3<span class="token punctuation">.</span><span class="token function">decryptBlock</span><span class="token punctuation">(</span><span class="token constant">M</span><span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_des2<span class="token punctuation">.</span><span class="token function">encryptBlock</span><span class="token punctuation">(</span><span class="token constant">M</span><span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_des1<span class="token punctuation">.</span><span class="token function">decryptBlock</span><span class="token punctuation">(</span><span class="token constant">M</span><span class="token punctuation">,</span> offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            keySize<span class="token operator">:</span> <span class="token number">192</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">,</span>

            ivSize<span class="token operator">:</span> <span class="token number">64</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">,</span>

            blockSize<span class="token operator">:</span> <span class="token number">64</span> <span class="token operator">/</span> <span class="token number">32</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut functions to the cipher's object interface.
         *
         * @example
         *
         *     var ciphertext = CryptoJS.TripleDES.encrypt(message, key, cfg);
         *     var plaintext  = CryptoJS.TripleDES.decrypt(ciphertext, key, cfg);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span>TripleDES <span class="token operator">=</span> BlockCipher<span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span>TripleDES<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> StreamCipher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>StreamCipher<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>

        <span class="token comment">/**
         * RC4 stream cipher algorithm.
         */</span>
        <span class="token keyword">var</span> <span class="token constant">RC4</span> <span class="token operator">=</span> C_algo<span class="token punctuation">.</span><span class="token constant">RC4</span> <span class="token operator">=</span> StreamCipher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_key<span class="token punctuation">;</span>
                <span class="token keyword">var</span> keyWords <span class="token operator">=</span> key<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> keySigBytes <span class="token operator">=</span> key<span class="token punctuation">.</span>sigBytes<span class="token punctuation">;</span>

                <span class="token comment">// Init sbox</span>
                <span class="token keyword">var</span> <span class="token constant">S</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_S <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Key setup</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">var</span> keyByteIndex <span class="token operator">=</span> i <span class="token operator">%</span> keySigBytes<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> keyByte <span class="token operator">=</span> <span class="token punctuation">(</span>keyWords<span class="token punctuation">[</span>keyByteIndex <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> <span class="token punctuation">(</span>keyByteIndex <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>

                    j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> keyByte<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>

                    <span class="token comment">// Swap</span>
                    <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">S</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token constant">S</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Counters</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_i <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doProcessBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token constant">M</span><span class="token punctuation">[</span>offset<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token function">generateKeystreamWord</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            keySize<span class="token operator">:</span> <span class="token number">256</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">,</span>

            ivSize<span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">generateKeystreamWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Shortcuts</span>
            <span class="token keyword">var</span> <span class="token constant">S</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_S<span class="token punctuation">;</span>
            <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_i<span class="token punctuation">;</span>
            <span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_j<span class="token punctuation">;</span>

            <span class="token comment">// Generate keystream word</span>
            <span class="token keyword">var</span> keystreamWord <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> n <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
                j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>

                <span class="token comment">// Swap</span>
                <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">S</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token constant">S</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>

                keystreamWord <span class="token operator">|=</span> <span class="token constant">S</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token constant">S</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">-</span> n <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Update counters</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_i <span class="token operator">=</span> i<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_j <span class="token operator">=</span> j<span class="token punctuation">;</span>

            <span class="token keyword">return</span> keystreamWord<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/**
         * Shortcut functions to the cipher's object interface.
         *
         * @example
         *
         *     var ciphertext = CryptoJS.RC4.encrypt(message, key, cfg);
         *     var plaintext  = CryptoJS.RC4.decrypt(ciphertext, key, cfg);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span><span class="token constant">RC4</span> <span class="token operator">=</span> StreamCipher<span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span><span class="token constant">RC4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Modified RC4 stream cipher algorithm.
         */</span>
        <span class="token keyword">var</span> RC4Drop <span class="token operator">=</span> C_algo<span class="token punctuation">.</span>RC4Drop <span class="token operator">=</span> <span class="token constant">RC4</span><span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/**
             * Configuration options.
             *
             * @property {number} drop The number of keystream words to drop. Default 192
             */</span>
            cfg<span class="token operator">:</span> <span class="token constant">RC4</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                drop<span class="token operator">:</span> <span class="token number">192</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token constant">RC4</span><span class="token punctuation">.</span><span class="token function">_doReset</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Drop</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span>drop<span class="token punctuation">;</span> i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token function">generateKeystreamWord</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Shortcut functions to the cipher's object interface.
         *
         * @example
         *
         *     var ciphertext = CryptoJS.RC4Drop.encrypt(message, key, cfg);
         *     var plaintext  = CryptoJS.RC4Drop.decrypt(ciphertext, key, cfg);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span>RC4Drop <span class="token operator">=</span> StreamCipher<span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span>RC4Drop<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> StreamCipher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>StreamCipher<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>

        <span class="token comment">// Reusable objects</span>
        <span class="token keyword">var</span> <span class="token constant">S</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">C_</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">G</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Rabbit stream cipher algorithm
         */</span>
        <span class="token keyword">var</span> Rabbit <span class="token operator">=</span> C_algo<span class="token punctuation">.</span>Rabbit <span class="token operator">=</span> StreamCipher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> <span class="token constant">K</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_key<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> iv <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span>iv<span class="token punctuation">;</span>

                <span class="token comment">// Swap endian</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token constant">K</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Generate initial state values</span>
                <span class="token keyword">var</span> <span class="token constant">X</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_X <span class="token operator">=</span> <span class="token punctuation">[</span>
                    <span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// Generate initial counter values</span>
                <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_C <span class="token operator">=</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff0000</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff0000</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff0000</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff0000</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// Carry bit</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

                <span class="token comment">// Iterate the system four times</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token function">nextState</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Modify the counters</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token constant">C</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token constant">X</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// IV setup</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>iv<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Shortcuts</span>
                    <span class="token keyword">var</span> <span class="token constant">IV</span> <span class="token operator">=</span> iv<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> <span class="token constant">IV_0</span> <span class="token operator">=</span> <span class="token constant">IV</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> <span class="token constant">IV_1</span> <span class="token operator">=</span> <span class="token constant">IV</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                    <span class="token comment">// Generate four subvectors</span>
                    <span class="token keyword">var</span> i0 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">IV_0</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">IV_0</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">IV_0</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">IV_0</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> i2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">IV_1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">IV_1</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">IV_1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">IV_1</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> i1 <span class="token operator">=</span> <span class="token punctuation">(</span>i0 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>i2 <span class="token operator">&amp;</span> <span class="token number">0xffff0000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> i3 <span class="token operator">=</span> <span class="token punctuation">(</span>i2 <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>i0 <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Modify counter values</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i0<span class="token punctuation">;</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i1<span class="token punctuation">;</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i2<span class="token punctuation">;</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i3<span class="token punctuation">;</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i0<span class="token punctuation">;</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i1<span class="token punctuation">;</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i2<span class="token punctuation">;</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i3<span class="token punctuation">;</span>

                    <span class="token comment">// Iterate the system four times</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">nextState</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doProcessBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> <span class="token constant">X</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_X<span class="token punctuation">;</span>

                <span class="token comment">// Iterate the system</span>
                <span class="token function">nextState</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Generate four keystream words</span>
                <span class="token constant">S</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">S</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">S</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">S</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Swap endian</span>
                    <span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Encrypt</span>
                    <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            blockSize<span class="token operator">:</span> <span class="token number">128</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">,</span>

            ivSize<span class="token operator">:</span> <span class="token number">64</span> <span class="token operator">/</span> <span class="token number">32</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">nextState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Shortcuts</span>
            <span class="token keyword">var</span> <span class="token constant">X</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_X<span class="token punctuation">;</span>
            <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_C<span class="token punctuation">;</span>

            <span class="token comment">// Save old counter values</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token constant">C_</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Calculate new counter values</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0x4d34d34d</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_b<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0xd34d34d3</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0x34d34d34</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0x4d34d34d</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0xd34d34d3</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0x34d34d34</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0x4d34d34d</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0xd34d34d3</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token comment">// Calculate the g-values</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> gx <span class="token operator">=</span> <span class="token constant">X</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token constant">C</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// Construct high and low argument for squaring</span>
                <span class="token keyword">var</span> ga <span class="token operator">=</span> gx <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> gb <span class="token operator">=</span> gx <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">;</span>

                <span class="token comment">// Calculate high and low result of squaring</span>
                <span class="token keyword">var</span> gh <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ga <span class="token operator">*</span> ga<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">17</span><span class="token punctuation">)</span> <span class="token operator">+</span> ga <span class="token operator">*</span> gb<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">+</span> gb <span class="token operator">*</span> gb<span class="token punctuation">;</span>
                <span class="token keyword">var</span> gl <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>gx <span class="token operator">&amp;</span> <span class="token number">0xffff0000</span><span class="token punctuation">)</span> <span class="token operator">*</span> gx<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>gx <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span> <span class="token operator">*</span> gx<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// High XOR low</span>
                <span class="token constant">G</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> gh <span class="token operator">^</span> gl<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Calculate new state values</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/**
         * Shortcut functions to the cipher's object interface.
         *
         * @example
         *
         *     var ciphertext = CryptoJS.Rabbit.encrypt(message, key, cfg);
         *     var plaintext  = CryptoJS.Rabbit.decrypt(ciphertext, key, cfg);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span>Rabbit <span class="token operator">=</span> StreamCipher<span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span>Rabbit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Shortcuts</span>
        <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_lib <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>lib<span class="token punctuation">;</span>
        <span class="token keyword">var</span> StreamCipher <span class="token operator">=</span> C_lib<span class="token punctuation">.</span>StreamCipher<span class="token punctuation">;</span>
        <span class="token keyword">var</span> C_algo <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">.</span>algo<span class="token punctuation">;</span>

        <span class="token comment">// Reusable objects</span>
        <span class="token keyword">var</span> <span class="token constant">S</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">C_</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">G</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * Rabbit stream cipher algorithm.
         *
         * This is a legacy version that neglected to convert the key to little-endian.
         * This error doesn't affect the cipher's security,
         * but it does affect its compatibility with other implementations.
         */</span>
        <span class="token keyword">var</span> RabbitLegacy <span class="token operator">=</span> C_algo<span class="token punctuation">.</span>RabbitLegacy <span class="token operator">=</span> StreamCipher<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">_doReset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcuts</span>
                <span class="token keyword">var</span> <span class="token constant">K</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_key<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                <span class="token keyword">var</span> iv <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cfg<span class="token punctuation">.</span>iv<span class="token punctuation">;</span>

                <span class="token comment">// Generate initial state values</span>
                <span class="token keyword">var</span> <span class="token constant">X</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_X <span class="token operator">=</span> <span class="token punctuation">[</span>
                    <span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// Generate initial counter values</span>
                <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_C <span class="token operator">=</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff0000</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff0000</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff0000</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xffff0000</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">K</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// Carry bit</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

                <span class="token comment">// Iterate the system four times</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token function">nextState</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// Modify the counters</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token constant">C</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token constant">X</span><span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// IV setup</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>iv<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Shortcuts</span>
                    <span class="token keyword">var</span> <span class="token constant">IV</span> <span class="token operator">=</span> iv<span class="token punctuation">.</span>words<span class="token punctuation">;</span>
                    <span class="token keyword">var</span> <span class="token constant">IV_0</span> <span class="token operator">=</span> <span class="token constant">IV</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> <span class="token constant">IV_1</span> <span class="token operator">=</span> <span class="token constant">IV</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                    <span class="token comment">// Generate four subvectors</span>
                    <span class="token keyword">var</span> i0 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">IV_0</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">IV_0</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">IV_0</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">IV_0</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> i2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">IV_1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">IV_1</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">IV_1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">IV_1</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> i1 <span class="token operator">=</span> <span class="token punctuation">(</span>i0 <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>i2 <span class="token operator">&amp;</span> <span class="token number">0xffff0000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">var</span> i3 <span class="token operator">=</span> <span class="token punctuation">(</span>i2 <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>i0 <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Modify counter values</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i0<span class="token punctuation">;</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i1<span class="token punctuation">;</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i2<span class="token punctuation">;</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i3<span class="token punctuation">;</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i0<span class="token punctuation">;</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i1<span class="token punctuation">;</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i2<span class="token punctuation">;</span>
                    <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">^=</span> i3<span class="token punctuation">;</span>

                    <span class="token comment">// Iterate the system four times</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token function">nextState</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token function-variable function">_doProcessBlock</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">M</span><span class="token punctuation">,</span> offset</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// Shortcut</span>
                <span class="token keyword">var</span> <span class="token constant">X</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_X<span class="token punctuation">;</span>

                <span class="token comment">// Iterate the system</span>
                <span class="token function">nextState</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// Generate four keystream words</span>
                <span class="token constant">S</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">S</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">S</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token constant">S</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// Swap endian</span>
                    <span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ff</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff00ff00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// Encrypt</span>
                    <span class="token constant">M</span><span class="token punctuation">[</span>offset <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token constant">S</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            blockSize<span class="token operator">:</span> <span class="token number">128</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">,</span>

            ivSize<span class="token operator">:</span> <span class="token number">64</span> <span class="token operator">/</span> <span class="token number">32</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">nextState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Shortcuts</span>
            <span class="token keyword">var</span> <span class="token constant">X</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_X<span class="token punctuation">;</span>
            <span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_C<span class="token punctuation">;</span>

            <span class="token comment">// Save old counter values</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token constant">C_</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Calculate new counter values</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0x4d34d34d</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_b<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0xd34d34d3</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0x34d34d34</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0x4d34d34d</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0xd34d34d3</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0x34d34d34</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0x4d34d34d</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0xd34d34d3</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token constant">C_</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token comment">// Calculate the g-values</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">var</span> gx <span class="token operator">=</span> <span class="token constant">X</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token constant">C</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

                <span class="token comment">// Construct high and low argument for squaring</span>
                <span class="token keyword">var</span> ga <span class="token operator">=</span> gx <span class="token operator">&amp;</span> <span class="token number">0xffff</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> gb <span class="token operator">=</span> gx <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">;</span>

                <span class="token comment">// Calculate high and low result of squaring</span>
                <span class="token keyword">var</span> gh <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ga <span class="token operator">*</span> ga<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">17</span><span class="token punctuation">)</span> <span class="token operator">+</span> ga <span class="token operator">*</span> gb<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">+</span> gb <span class="token operator">*</span> gb<span class="token punctuation">;</span>
                <span class="token keyword">var</span> gl <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>gx <span class="token operator">&amp;</span> <span class="token number">0xffff0000</span><span class="token punctuation">)</span> <span class="token operator">*</span> gx<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>gx <span class="token operator">&amp;</span> <span class="token number">0x0000ffff</span><span class="token punctuation">)</span> <span class="token operator">*</span> gx<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// High XOR low</span>
                <span class="token constant">G</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> gh <span class="token operator">^</span> gl<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Calculate new state values</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token constant">X</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">G</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/**
         * Shortcut functions to the cipher's object interface.
         *
         * @example
         *
         *     var ciphertext = CryptoJS.RabbitLegacy.encrypt(message, key, cfg);
         *     var plaintext  = CryptoJS.RabbitLegacy.decrypt(ciphertext, key, cfg);
         */</span>
        <span class="token constant">C</span><span class="token punctuation">.</span>RabbitLegacy <span class="token operator">=</span> StreamCipher<span class="token punctuation">.</span><span class="token function">_createHelper</span><span class="token punctuation">(</span>RabbitLegacy<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token keyword">return</span> CryptoJS<span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5f2cd65a200de64003653ee768e694c9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">在Windows server 2012R2系统安装使用docker</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/86a9e84bcd32418a337fc58c235ff574/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[Unity] UGUI学习笔记</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>