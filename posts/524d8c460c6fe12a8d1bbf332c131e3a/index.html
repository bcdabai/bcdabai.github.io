<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>10.Linux学习--网络配置 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="10.Linux学习--网络配置" />
<meta property="og:description" content="10.1 什么是IP 10.1.1 IP简介
Internet Protocol Address，网络协议地址，也就是在因特网上给主机编码的方式
协议名称：tcp/ip 协议版本：ipv4ip地址：2^32， 即ip是由32位0或1组成，例，111111111.111111111.11111111.11111111（二进制）==255.255.255.255 （十进制） 10.1.2 子网掩码 子网掩码是用来划分网络区域的，指明了一个ip地址的哪些位标识的是网段，哪些是主机 子网掩码非0的位对应的ip上的数字表示这个ip的网络位，0位对应IP的数字是的主机位网络位表示网络区域（即位置区域）主机位表示网络区域里某台主机（即区域内具体某台主机） 10.1.3 IP通信
网络位相同，主机位不同的两个ip可以直接通信，例如：
IP1：192.168.43.10/24等价于192.168.43.10/255.255.255.0
IP2：192.168.43.11/24
IP1和IP2掩码都是24位，它们的网段都为192.168.43，所以可以直接通信
实验1：IP相关命令
ip addr show | ifconfig ##查看ip地址 ping ##检测网络通畅 -c 1 ##只ping1次-w 1 ##等待1秒 ifconfig device ip netmask ##为网卡配置IP以及子网掩码ip addr show ##查看ipip addr del dev ens160 192.168.43.11/24 ##删除ip ip addr add 192.168.43.11/24 dev ens160 ##添加ip 实验2：永久方式更改IP
1. 图形方式
nm-connection-editornmtui nm-connection-editor nmtui 2. 命令方式
nmcli device status ##查看设备状态 nmcli device disconnect ens160 ##关闭设备 nmcli device connect ens160 ##开启设备 nmcli connection show ##查看连接信息 nmcli connection down &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/524d8c460c6fe12a8d1bbf332c131e3a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-02-15T17:48:24+08:00" />
<meta property="article:modified_time" content="2020-02-15T17:48:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">10.Linux学习--网络配置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>10.1 什么是IP</h3> 
<p><strong>10.1.1 IP简介</strong></p> 
<p>Internet Protocol Address，网络协议地址，也就是在因特网上给主机编码的方式</p> 
<ul><li>协议名称：tcp/ip </li><li>协议版本：ipv4</li><li>ip地址：2^32， 即ip是由32位0或1组成，例，111111111.111111111.11111111.11111111（二进制）==255.255.255.255 （十进制）</li></ul> 
<p><strong> 10.1.2 子网掩码</strong>        </p> 
<ul><li>子网掩码是用来划分网络区域的，指明了一个ip地址的哪些位标识的是网段，哪些是主机     </li><li>子网掩码非0的位对应的ip上的数字表示这个ip的网络位，0位对应IP的数字是的主机位</li><li>网络位表示网络区域（即位置区域）</li><li>主机位表示网络区域里某台主机（即区域内具体某台主机）</li></ul> 
<p><strong>10.1.3 IP通信</strong></p> 
<p>网络位相同，主机位不同的两个ip可以直接通信，例如：</p> 
<p>IP1：192.168.43.10/24等价于192.168.43.10/255.255.255.0</p> 
<p>IP2：192.168.43.11/24</p> 
<p>IP1和IP2掩码都是24位，它们的网段都为192.168.43，所以可以直接通信</p> 
<hr> 
<p><strong>实验1：</strong>IP相关命令</p> 
<ul><li>ip addr show  | ifconfig              ##查看ip地址</li></ul> 
<p><img alt="" height="497" src="https://images2.imgbox.com/82/b8/ZZQFb4K4_o.png" width="794"></p> 
<ul><li>ping                                           ##检测网络通畅</li></ul> 
<ol><li>-c  1   ##只ping1次</li><li>-w 1   ##等待1秒 </li></ol> 
<p><img alt="" height="147" src="https://images2.imgbox.com/28/50/04PCZMgN_o.png" width="589"></p> 
<ul><li>ifconfig   device ip netmask       ##为网卡配置IP以及子网掩码</li><li>ip addr show ##查看ip</li><li>ip addr del dev ens160 192.168.43.11/24           ##删除ip</li></ul> 
<p><img alt="" height="280" src="https://images2.imgbox.com/52/c7/lK8ydMcb_o.png" width="808"></p> 
<ul><li>ip addr add 192.168.43.11/24 dev ens160          ##添加ip</li></ul> 
<p><img alt="" height="524" src="https://images2.imgbox.com/46/2c/kc4Sy9bs_o.png" width="871"></p> 
<p> </p> 
<hr> 
<p><strong>实验2：</strong>永久方式更改IP</p> 
<p>1. 图形方式</p> 
<ul><li>nm-connection-editor</li><li>nmtui</li></ul> 
<pre><code class="language-bash">nm-connection-editor</code></pre> 
<p><img alt="" height="500" src="https://images2.imgbox.com/f4/a7/GklgljTI_o.png" width="1200"></p> 
<pre><code class="language-bash">nmtui</code></pre> 
<p><img alt="" height="519" src="https://images2.imgbox.com/27/ad/JeS78ZDt_o.png" width="751"></p> 
<p>2. 命令方式</p> 
<ul><li>nmcli device status                            ##查看设备状态</li></ul> 
<p><img alt="" height="307" src="https://images2.imgbox.com/d4/de/dQl8oN7i_o.png" width="770"></p> 
<ul><li>nmcli device disconnect ens160         ##关闭设备</li></ul> 
<p><img alt="" height="190" src="https://images2.imgbox.com/35/73/4vesv4ty_o.png" width="804"></p> 
<ul><li>nmcli device connect ens160              ##开启设备 </li></ul> 
<p><img alt="" height="293" src="https://images2.imgbox.com/98/44/MO1Luy09_o.png" width="787"></p> 
<ul><li>nmcli connection show                      ##查看连接信息</li></ul> 
<p><img alt="" height="102" src="https://images2.imgbox.com/ec/42/C5HxfFsk_o.png" width="763"></p> 
<ul><li>nmcli connection down "Ethernet connection 1"          ##关闭连接</li></ul> 
<p><img alt="" height="159" src="https://images2.imgbox.com/71/25/1JkQnpkN_o.png" width="760"></p> 
<ul><li>nmcli connection up  "Ethernet connection 1"              ##打开连接</li></ul> 
<p><img alt="" height="170" src="https://images2.imgbox.com/d7/91/DWoDij14_o.png" width="761"></p> 
<ul><li>nmcli connection modify "Ethernet connection 1" ip4 192.168.43.21/24 ##添加ip，添加完成后必须要重启连接才能生效</li></ul> 
<p><img alt="" height="438" src="https://images2.imgbox.com/6b/7a/MqEeFpys_o.png" width="763"></p> 
<ul><li>nmcli connection delete "Ethernet connection 1" ##删除连接</li></ul> 
<p><img alt="" height="162" src="https://images2.imgbox.com/30/c2/ARGJyno0_o.png" width="757"></p> 
<ul><li>nmcli connection add con-name eth0 ifname ens160 type ethernet ip4 192.168.43.11/24 ##添加连接</li></ul> 
<p><img alt="" height="250" src="https://images2.imgbox.com/43/3e/d4DAGfpI_o.png" width="819"></p> 
<ul><li>connection add con-name eth0 ifname ens160 type ethernet ipv4.method auto ##添加dhcp网络</li></ul> 
<p> </p> 
<p>3. 文件方式</p> 
<ul><li>配置目录：/etc/sysconfig/network-scripts/</li><li>配置文件：ifcfg-任意名称</li></ul> 
<p>dhcp:</p> 
<pre><code class="language-bash">vim /etc/sysconfig/network-scripts/ifcfg-eth0 </code></pre> 
<p><img alt="" height="191" src="https://images2.imgbox.com/1b/1b/jTC2Z4RG_o.png" width="787"></p> 
<pre><code class="language-bash">systemctl restart NetworkManager
nmcli connection down ens160 
nmcli connection up eth0 </code></pre> 
<p><img alt="" height="509" src="https://images2.imgbox.com/9e/64/ybmnG605_o.png" width="812"></p> 
<p>静态网络：</p> 
<pre><code class="language-bash">vim /etc/sysconfig/network-scripts/ifcfg-eth1 </code></pre> 
<p><img alt="" height="402" src="https://images2.imgbox.com/e2/7a/Zl4gxa00_o.png" width="769"><br>  </p> 
<pre><code class="language-bash">systemctl restart NetworkManager
nmcli connection down eth0
nmcli connection up eth1</code></pre> 
<p><br>  <img alt="" height="315" src="https://images2.imgbox.com/e3/72/I3DzcIFk_o.png" width="811"></p> 
<p> </p> 
<h3>10.2 DHCP服务</h3> 
<p>在server1中</p> 
<p>1.配置静态网络</p> 
<p><img alt="" height="275" src="https://images2.imgbox.com/c8/30/Fo9QddCU_o.png" width="763"></p> 
<p>2.把镜像接入光驱</p> 
<p><img alt="" height="315" src="https://images2.imgbox.com/f1/80/Kh5Q4WNT_o.png" width="879"></p> 
<p>3.查看光驱挂载位置</p> 
<pre><code class="language-bash">df</code></pre> 
<p><img alt="" height="478" src="https://images2.imgbox.com/3e/b7/V8Z5egZo_o.png" width="752"> <br> 4. 查找dhcp安装包</p> 
<pre><code class="language-bash">cd /run/media/root/RHEL-8-1-0-BaseOS-x86_64/BaseOS/Packages/
ls dhcp*</code></pre> 
<p><img alt="" height="197" src="https://images2.imgbox.com/b0/f7/F8R6QJ3t_o.png" width="761"><br> 5. 安装dhcp</p> 
<pre><code class="language-bash">rpm -ivh dhcp-server-4.3.6-30.el8.x86_64.rpm</code></pre> 
<p><img alt="" height="494" src="https://images2.imgbox.com/2a/62/3KdoqcVM_o.png" width="778"></p> 
<p>ps:开始使用的是rhel8.1的镜像安装dhcp服务，一直有问题，最后换成可8.0镜像挂载重新安装dhcp服务</p> 
<p><br> 6. 配置dhcp文件</p> 
<pre><code class="language-bash">cd /etc/dhcp/
ls
cp /usr/share/doc/dhcp-server/dhcpd.conf.example /etc/dhcp/dhcpd.conf
vim dhcpd.conf </code></pre> 
<p><img alt="" height="103" src="https://images2.imgbox.com/ec/a8/VpWTTLZh_o.png" width="722"></p> 
<p><img alt="" height="125" src="https://images2.imgbox.com/de/f1/H4Aw7RqB_o.png" width="731"></p> 
<p>7. 重启服务</p> 
<pre><code class="language-bash">systemctl restart dhcpd.service </code></pre> 
<p>8. 测试</p> 
<p>在client1中设定网络为dhcp</p> 
<p><img alt="" height="195" src="https://images2.imgbox.com/6c/db/qFFtmQ59_o.png" width="783"></p> 
<p>重启网络服务，因为我真实主机使用的手机热点，所以自动分配的不是我设定的dhcp连接，断开热点后，重启服务获取到的IP为192.168.43.100时我在server1端dhcp设定的IP池</p> 
<p><img alt="" height="174" src="https://images2.imgbox.com/6d/dc/kqzJmU4y_o.png" width="792"></p> 
<p>在server1端查看分配出去的地址，以及IP地址绑定的物理地址</p> 
<p><img alt="" height="374" src="https://images2.imgbox.com/a4/18/3vcrDa3s_o.png" width="788"></p> 
<p> </p> 
<h3>10.3 网关</h3> 
<p>路由器上和客户主机处在同一个网段的ip叫做客户主机的网关</p> 
<p><strong>10.3.1 网关设定方式</strong></p> 
<p>命令方式：&lt;临时&gt;</p> 
<ul><li>ip route add default via 192.168.43.100 ##添加默认网关</li><li>ip route del default via 192.168.43.100 ##删除默认网关</li></ul> 
<p> <br> 文件方式：&lt;永久&gt;</p> 
<p>1. 修改系统全局网关<br>  </p> 
<pre><code class="language-bash">vim /etc/sysconfig/network </code></pre> 
<p><img alt="" height="111" src="https://images2.imgbox.com/2a/58/QSGXBg8K_o.png" width="778"></p> 
<pre><code class="language-bash">systemctl restart NetworkManager 
nmcli connection down 链接名称 
nmcli connection up 链接名称</code></pre> 
<p><br> 2. 修改网卡设定网关</p> 
<pre><code class="language-bash">vim /etc/sysconfig/network-scripts/ifcfg-westos</code></pre> 
<p><img alt="" height="210" src="https://images2.imgbox.com/c9/23/AtxCvItD_o.png" width="820"><br>  </p> 
<pre><code class="language-bash">systemctl restart NetworkManager 
nmcli connection down 链接名称
nmcli connection up 链接名称</code></pre> 
<hr> 
<p><strong>实验：</strong></p> 
<p>1. 在client1中添加一块网卡使client1主机为双网卡主机</p> 
<p><img alt="" height="428" src="https://images2.imgbox.com/13/ec/Jrs774hk_o.png" width="828"></p> 
<p>2. 设定client1主机网卡地址为：</p> 
<p>网卡1：192.168.43.100/24（和windows主机处在统一个网段）</p> 
<p>网卡2：172.25.254.100/24（server1主机处在统一个网段）</p> 
<p><img alt="" height="414" src="https://images2.imgbox.com/e0/fe/40vj75kP_o.png" width="774"><br>  <br> 3.在client1中打开内核路由功能</p> 
<pre><code class="language-bash">sysctl -a  |grep ip_forward </code></pre> 
<p><img alt="" height="77" src="https://images2.imgbox.com/3c/3f/3kwf3bpl_o.png" width="757"></p> 
<p> </p> 
<p>net.ipv4.ip_forward = 0表示内核路由功能未开启，在这里我的显示是开启内核路由的，如果是未开启的按下面操作：</p> 
<pre><code class="language-bash">vim /etc/sysctl.conf</code></pre> 
<p><img alt="" height="315" src="https://images2.imgbox.com/2f/2f/nnErD42T_o.png" width="773"></p> 
<pre><code class="language-bash">sysctl -p     ##设定更改立即生效
</code></pre> 
<p> <img alt="" height="68" src="https://images2.imgbox.com/3a/6f/YrT6M3w7_o.png" width="555"></p> 
<p><br> 4.在client1中打开地址伪装功能</p> 
<pre><code class="language-bash">systemctl start firewalld </code></pre> 
<pre><code class="language-bash">firewall-cmd --list-all </code></pre> 
<p><img alt="" height="270" src="https://images2.imgbox.com/06/bb/hWopX5Ri_o.png" width="751"></p> 
<p>masquerade: no表示地址伪装功能未开启  </p> 
<pre><code class="language-bash">firewall-cmd --permanent --addmasquerade </code></pre> 
<p><img alt="" height="40" src="https://images2.imgbox.com/09/4a/xKOXfvlD_o.png" width="689"></p> 
<pre><code class="language-bash">firewall-cmd --reload</code></pre> 
<p><br>  <img alt="" height="310" src="https://images2.imgbox.com/97/ff/XUwHZ433_o.png" width="710"><br>  </p> 
<p><strong>测试： </strong></p> 
<p>1. 在server1中设定本机ip：172.25.254.10</p> 
<p><img alt="" height="210" src="https://images2.imgbox.com/0c/50/1s1Blkuw_o.png" width="753"></p> 
<p><img alt="" height="178" src="https://images2.imgbox.com/1b/7d/rd2ui7Kh_o.png" width="749"></p> 
<p>ping 192.168.43.51 ##测试能否和windows主机通信</p> 
<p><img alt="" height="61" src="https://images2.imgbox.com/22/07/7DFhw49y_o.png" width="733"></p> 
<p>显然无法通信</p> 
<p>2. 添加本机网关为 172.25.254.100</p> 
<pre><code class="language-bash"> ip route add default via 172.25.254.100</code></pre> 
<p><img alt="" height="223" src="https://images2.imgbox.com/bf/c4/Vsoq96MQ_o.png" width="784"></p> 
<p>3. 再次测试</p> 
<pre><code class="language-bash">ping 192.168.43.51</code></pre> 
<p><img alt="" height="278" src="https://images2.imgbox.com/c7/16/cvPM12jI_o.png" width="767"></p> 
<p>可以通信</p> 
<h3>10.4 DNS</h3> 
<p>dns: 负责作域名转换成ip这个工作的主机叫做dns服务器（地址解析）</p> 
<pre><code class="language-bash">vim /etc/resolv.conf ##dns服务器指向文件临时 </code></pre> 
<p><img alt="" height="159" src="https://images2.imgbox.com/89/4b/J9CbLjDU_o.png" width="795"></p> 
<pre><code class="language-bash">vim /etc/hosts ##叫做本地解析文件</code></pre> 
<pre><code class="language-bash">vim /etc/sysconfig/network-scripts/ifcfg-eth160 ##dns的永久设定 DNS1=114.114.114.114 </code></pre> 
<p>重启网络服务<br>  <br>  </p> 
<hr> 
<p> <br><strong>实验:</strong></p> 
<p>1. 设定主机ip和windows在一个网段</p> 
<p>2. 设定主机网关和windows相同</p> 
<p><img alt="" height="214" src="https://images2.imgbox.com/45/b0/8AcuZ7rC_o.png" width="766"></p> 
<p>3. 在windows中ping www.baiud.com 查看百度ip</p> 
<p><img alt="" height="202" src="https://images2.imgbox.com/7c/a0/zPUa5kPA_o.png" width="578"></p> 
<p>4. 在linux中ping百度ip</p> 
<p><img alt="" height="158" src="https://images2.imgbox.com/fb/7d/E5BsjnT9_o.png" width="730"></p> 
<p>5. 在linux中ping www.baidu.com</p> 
<p><img alt="" height="53" src="https://images2.imgbox.com/36/5a/nYwJ4AlM_o.png" width="714"></p> 
<p>6. 编写本地解析文件</p> 
<pre><code class="language-bash">vim /etc/hosts </code></pre> 
<p><img alt="" height="176" src="https://images2.imgbox.com/21/37/g0MNLy36_o.png" width="731"></p> 
<pre><code class="language-bash">ping www.baidu.com</code></pre> 
<p><img alt="" height="171" src="https://images2.imgbox.com/ee/ad/Gv5d4zvd_o.png" width="746"></p> 
<pre><code class="language-bash">ping baidu.com</code></pre> 
<p><img alt="" height="257" src="https://images2.imgbox.com/c5/3b/Ux6mx8Fn_o.png" width="794"><br> 7. 编写DNS配置文件</p> 
<pre><code class="language-bash">vim /etc/resolv.conf </code></pre> 
<p><img alt="" height="165" src="https://images2.imgbox.com/31/71/TgA4qSaq_o.png" width="789"></p> 
<pre><code>ping baidu.com</code></pre> 
<p><img alt="" height="143" src="https://images2.imgbox.com/f2/0a/CO8aSrHp_o.png" width="738"></p> 
<p> </p> 
<h3>10.5 网桥</h3> 
<p>1. 删除原连接</p> 
<pre><code class="language-bash">nmcli connection delete System\ ens160 </code></pre> 
<p><img alt="" height="203" src="https://images2.imgbox.com/8f/6d/wdzx6Kt5_o.png" width="754"></p> 
<p>2. 新建连接</p> 
<pre><code class="language-bash">vim /etc/sysconfig/network-scripts/ifcfg-ens160</code></pre> 
<p><img alt="" height="274" src="https://images2.imgbox.com/be/54/ebNyBCw3_o.png" width="874"><br> 3. 新建网桥</p> 
<pre><code class="language-bash">vim /etc/sysconfig/network-scripts/ifcfg-br0</code></pre> 
<p><br>  <img alt="" height="293" src="https://images2.imgbox.com/ca/ad/di5D9nf7_o.png" width="788"><br>  <br> 4. 重启网络</p> 
<p><img alt="" height="259" src="https://images2.imgbox.com/2d/a7/bbv6l3Tk_o.png" width="772"></p> 
<pre><code class="language-bash">bridge link show</code></pre> 
<p><img alt="" height="106" src="https://images2.imgbox.com/2c/9e/4AnBVD8V_o.png" width="757"></p> 
<p>创建虚拟机时网络可以选择桥接</p> 
<p><img alt="" height="580" src="https://images2.imgbox.com/37/c9/n470httk_o.png" width="599"></p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7255409942d69d30c5cdda76938acd8b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">消息队列与分布式事务</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/710fc1ecad76679044e984a83dede965/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据结构与算法-字符串（Python）（五）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>