<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>umeditor粘贴图片自动上传到服务器(Java版) - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="umeditor粘贴图片自动上传到服务器(Java版)" />
<meta property="og:description" content="当前功能基于PHP，其它语言流程大致相同
1.新增上传word json配置
在ueditor\php\config.json中新增如下配置：
/* 上传word配置 */
&#34;wordActionName&#34;: &#34;wordupload&#34;, /* 执行上传视频的action名称 */
&#34;wordFieldName&#34;: &#34;upfile&#34;, /* 提交的视频表单名称 */
&#34;wordPathFormat&#34;: &#34;/public/uploads/word/{yyyy}{mm}{dd}/{time}{rand:6}&#34;, /* 上传保存路径,可以自定义保存路径和文件名格式 */
&#34;wordMaxSize&#34;: 102400000, /* 上传大小限制，单位B，默认100MB */
&#34;wordAllowFiles&#34;: [&#34;.docx&#34;] /* 仅支持docx格式的word */
2.修改编辑器配置文件，在工具栏上新增按钮
在ueditor\ueditor.config.js文件中，新增按钮名称&#34;wordupload&#34;，并添加鼠标悬浮提示，如下所示：
//工具栏上的所有的功能按钮和下拉框，可以在new编辑器的实例时选择自己需要的重新定义
, toolbars: [[
&#39;fullscreen&#39;, &#39;source&#39;, &#39;|&#39;, &#39;undo&#39;, &#39;redo&#39;, &#39;|&#39;,
&#39;bold&#39;, &#39;italic&#39;, &#39;underline&#39;, &#39;fontborder&#39;, &#39;strikethrough&#39;, &#39;superscript&#39;, &#39;subscript&#39;, &#39;removeformat&#39;, &#39;formatmatch&#39;, &#39;autotypeset&#39;, &#39;blockquote&#39;, &#39;pasteplain&#39;, &#39;|&#39;, &#39;forecolor&#39;, &#39;backcolor&#39;, &#39;insertorderedlist&#39;, &#39;insertunorderedlist&#39;, &#39;selectall&#39;, &#39;cleardoc&#39;, &#39;|&#39;,
&#39;rowspacingtop&#39;, &#39;rowspacingbottom&#39;, &#39;lineheight&#39;, &#39;|&#39;,
&#39;customstyle&#39;, &#39;paragraph&#39;, &#39;fontfamily&#39;, &#39;fontsize&#39;, &#39;|&#39;," />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/93bdbfff40fbfbdc20abcadebd20f334/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-11T18:00:41+08:00" />
<meta property="article:modified_time" content="2023-04-11T18:00:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">umeditor粘贴图片自动上传到服务器(Java版)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>当前功能基于PHP，其它语言流程大致相同</p> 
<p></p> 
<p>1.新增上传word json配置</p> 
<p>在ueditor\php\config.json中新增如下配置：</p> 
<p></p> 
<p>    /* 上传word配置 */</p> 
<p>    "wordActionName": "wordupload", /* 执行上传视频的action名称 */</p> 
<p>    "wordFieldName": "upfile", /* 提交的视频表单名称 */</p> 
<p>    "wordPathFormat": "/public/uploads/word/{yyyy}{mm}{dd}/{time}{rand:6}", /* 上传保存路径,可以自定义保存路径和文件名格式 */</p> 
<p>    "wordMaxSize": 102400000, /* 上传大小限制，单位B，默认100MB */</p> 
<p>    "wordAllowFiles": [".docx"] /* 仅支持docx格式的word */</p> 
<p>2.修改编辑器配置文件，在工具栏上新增按钮</p> 
<p>在ueditor\ueditor.config.js文件中，新增按钮名称"wordupload"，并添加鼠标悬浮提示，如下所示：</p> 
<p></p> 
<p>        //工具栏上的所有的功能按钮和下拉框，可以在new编辑器的实例时选择自己需要的重新定义</p> 
<p>        , toolbars: [[</p> 
<p>            'fullscreen', 'source', '|', 'undo', 'redo', '|',</p> 
<p>            'bold', 'italic', 'underline', 'fontborder', 'strikethrough', 'superscript', 'subscript', 'removeformat', 'formatmatch', 'autotypeset', 'blockquote', 'pasteplain', '|', 'forecolor', 'backcolor', 'insertorderedlist', 'insertunorderedlist', 'selectall', 'cleardoc', '|',</p> 
<p>            'rowspacingtop', 'rowspacingbottom', 'lineheight', '|',</p> 
<p>            'customstyle', 'paragraph', 'fontfamily', 'fontsize', '|',</p> 
<p>            'directionalityltr', 'directionalityrtl', 'indent', '|',</p> 
<p>            'justifyleft', 'justifycenter', 'justifyright', 'justifyjustify', '|', 'touppercase', 'tolowercase', '|',</p> 
<p>            'link', 'unlink', 'anchor', '|', 'imagenone', 'imageleft', 'imageright', 'imagecenter', '|',</p> 
<p>            'simpleupload', 'insertimage', 'emotion', 'scrawl', 'insertvideo', 'music', 'attachment', 'map', 'gmap', 'insertframe', 'insertcode', 'webapp', 'pagebreak', 'template', 'background', '|',</p> 
<p>            'horizontal', 'date', 'time', 'spechars', 'snapscreen', 'wordimage', '|',</p> 
<p>            'inserttable', 'deletetable', 'insertparagraphbeforetable', 'insertrow', 'deleterow', 'insertcol', 'deletecol', 'mergecells', 'mergeright', 'mergedown', 'splittocells', 'splittorows', 'splittocols', 'charts', '|',</p> 
<p>            'print', 'preview', 'searchreplace', 'drafts', 'help', 'wordupload'</p> 
<p>        ]]</p> 
<p>        //当鼠标放在工具栏上时显示的tooltip提示,留空支持自动多语言配置，否则以配置值为准</p> 
<p>        ,labelMap:{<!-- --></p> 
<p>           'wordupload': '上传word文件',</p> 
<p>        }</p> 
<p>在ueditor\themes\default\images\目录下新增按钮图标"word_upload.png"：</p> 
<p></p> 
<p> 在ueditor\themes\default\css\ueditor.css文件中新增按钮样式：</p> 
<p></p> 
<p>.edui-for-wordupload .edui-icon {<!-- --></p> 
<p>    width: 16px;</p> 
<p>    height: 16px;</p> 
<p>    background: url(../images/word_upload.png) no-repeat 2px 2px !important;</p> 
<p>}</p> 
<p>最后在ueditor\ueditor.all.js文件中editorui["simpleupload"] = function (editor){}后面添加如下代码：</p> 
<p></p> 
<p>/* word上传 */</p> 
<p>    editorui["wordupload"] = function (editor) {<!-- --></p> 
<p>        var name = 'wordupload',</p> 
<p>            ui = new editorui.Button({<!-- --></p> 
<p>                className:'edui-for-' + name,</p> 
<p>                title:editor.options.labelMap[name] || editor.getLang("labelMap." + name) || '',</p> 
<p>                onclick:function () {},</p> 
<p>                theme:editor.options.theme,</p> 
<p>                showText:false</p> 
<p>            });</p> 
<p>        editorui.buttons[name] = ui;</p> 
<p>        editor.addListener('ready', function() {<!-- --></p> 
<p>            var b = ui.getDom('body'),</p> 
<p>                iconSpan = b.children[0];</p> 
<p>            editor.fireEvent('worduploadbtnready', iconSpan);</p> 
<p>        });</p> 
<p>        editor.addListener('selectionchange', function (type, causeByUi, uiReady) {<!-- --></p> 
<p>            var state = editor.queryCommandState(name);</p> 
<p>            if (state == -1) {<!-- --></p> 
<p>                ui.setDisabled(true);</p> 
<p>                ui.setChecked(false);</p> 
<p>            } else {<!-- --></p> 
<p>                if (!uiReady) {<!-- --></p> 
<p>                    ui.setDisabled(false);</p> 
<p>                    ui.setChecked(state);</p> 
<p>                }</p> 
<p>            }</p> 
<p>        });</p> 
<p>        return ui;</p> 
<p>};</p> 
<p></p> 
<p>最终样式如下：</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/e8/14/S9oIHQZs_o.jpg"></p> 
<p> 3. 新增语言配置</p> 
<p>在ueditor\lang\zh-cn\zh-cn.js文件中在"simpleupload"配置下方新增以下配置：</p> 
<p></p> 
<p>'simpleupload':{<!-- --></p> 
<p>        'exceedSizeError': '文件大小超出限制',</p> 
<p>        'exceedTypeError': '文件格式不允许',</p> 
<p>        'jsonEncodeError': '服务器返回格式错误',</p> 
<p>        'loading':"正在上传...",</p> 
<p>        'loadError':"上传错误",</p> 
<p>        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！'</p> 
<p>    },</p> 
<p>    'wordupload':{<!-- --></p> 
<p>        'exceedSizeError': '文件大小超出限制',</p> 
<p>        'exceedTypeError': '文件格式不允许',</p> 
<p>        'jsonEncodeError': '服务器返回格式错误',</p> 
<p>        'loading':"正在上传...",</p> 
<p>        'loadError':"上传错误",</p> 
<p>        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！'</p> 
<p>    },</p> 
<p>在ueditor\lang\zh-cn\en.js文件中在"simpleupload"配置下方新增以下配置：</p> 
<p></p> 
<p>'simpleupload':{<!-- --></p> 
<p>        'exceedSizeError': 'File Size Exceed',</p> 
<p>        'exceedTypeError': 'File Type Not Allow',</p> 
<p>        'jsonEncodeError': 'Server Return Format Error',</p> 
<p>        'loading':"loading...",</p> 
<p>        'loadError':"load error",</p> 
<p>        'errorLoadConfig': 'Server config not loaded, upload can not work.',</p> 
<p>    },</p> 
<p>    'wordupload':{<!-- --></p> 
<p>        'exceedSizeError': 'File Size Exceed',</p> 
<p>        'exceedTypeError': 'File Type Not Allow',</p> 
<p>        'jsonEncodeError': 'Server Return Format Error',</p> 
<p>        'loading':"loading...",</p> 
<p>        'loadError':"load error",</p> 
<p>        'errorLoadConfig': 'Server config not loaded, upload can not work.',</p> 
<p>    },</p> 
<p>4.修改过滤配置</p> 
<p>由于导入word时，编辑器会自动过滤掉图片等样式，所以需取消过滤</p> 
<p>在ueditor\ueditor.config.js文件中修改如下配置：</p> 
<p></p> 
<p>// xss 过滤是否开启,inserthtml等操作</p> 
<p>,xssFilterRules: false</p> 
<p>//input xss过滤</p> 
<p>,inputXssFilter: false</p> 
<p>//output xss过滤</p> 
<p>,outputXssFilter: false</p> 
<p>在ueditor\ueditor.all.js文件中，修改UE.plugins[‘defaultfilter’]，新增return ;如下所示：</p> 
<p></p> 
<p>// plugins/defaultfilter.js</p> 
<p>///import core</p> 
<p>///plugin 编辑器默认的过滤转换机制</p> 
<p></p> 
<p>UE.plugins['defaultfilter'] = function () {<!-- --></p> 
<p>    return;</p> 
<p>    var me = this;</p> 
<p>    me.setOpt({<!-- --></p> 
<p>        'allowDivTransToP':true,</p> 
<p>        'disabledTableInTable':true</p> 
<p>    });</p> 
<p>    ……</p> 
<p>5.安装PHPword</p> 
<p>composer require phpoffice/phpword</p> 
<p>6.自定义文件转换类</p> 
<p>实现上传文件，并将文件转换为HTML</p> 
<p>直接将ueditor自带的上传文件"ueditor\php\Uploader.class.php"类内容直接复制到自定义WordToHtmlController.class.php文件中</p> 
<p></p> 
<p>&lt;?php</p> 
<p></p> 
<p>class WordToHtmlController</p> 
<p>{<!-- --></p> 
<p>    public function index()</p> 
<p>    {<!-- --></p> 
<p>        require 'vendor/autoload.php';</p> 
<p></p> 
<p>        $base64 = "upload";</p> 
<p></p> 
<p>        $config = array(</p> 
<p>            "pathFormat" =&gt; '/public/uploads/word/{yyyy}{mm}{dd}/{time}{rand:6}',</p> 
<p>            "maxSize" =&gt; 102400000,</p> 
<p>            "allowFiles" =&gt; [".docx"]</p> 
<p>        );</p> 
<p>        $fieldName = 'upfile';</p> 
<p></p> 
<p>        include 'Uploader.class.php';</p> 
<p>        $up = new Uploader($fieldName, $config, $base64);</p> 
<p>        $path = ltrim($up-&gt;getFileInfo()['url'], '/');</p> 
<p></p> 
<p>//        $phpWord = \PhpOffice\PhpWord\IOFactory::load('public/uploads/word/20211029/test.docx');</p> 
<p>        $phpWord = \PhpOffice\PhpWord\IOFactory::load($path);</p> 
<p></p> 
<p>        // 直接输出到页面显示</p> 
<p>//        $phpWord-&gt;save('php://output', 'HTML');</p> 
<p></p> 
<p>        $xmlWriter = \PhpOffice\PhpWord\IOFactory::createWriter($phpWord, 'HTML');</p> 
<p></p> 
<p>        header("Content-Type:text/html; charset=utf-8");</p> 
<p>        exit($this-&gt;replaceImageSrc($xmlWriter-&gt;getContent()));</p> 
<p>//        exit($xmlWriter-&gt;getContent());</p> 
<p>    }</p> 
<p></p> 
<p>    /**</p> 
<p>     * 将HTML代码中的所有图片地址替换</p> 
<p>     * @param $content string 要查找的内容</p> 
<p>     * @return string</p> 
<p>     */</p> 
<p>    private function replaceImageSrc($content)</p> 
<p>    {<!-- --></p> 
<p>        $preg = '/(\s+src\s?\=)\s?[\'|"]([^\'|"]*)/is'; // 匹配img标签的正则表达式</p> 
<p>        preg_match_all($preg, $content, $allImg); // 匹配所有的img</p> 
<p></p> 
<p>        if (!$allImg)</p> 
<p>            return $content;</p> 
<p></p> 
<p>        foreach ($allImg[0] as $k =&gt; $v) {<!-- --></p> 
<p>            $old = ltrim($v, '" src=');</p> 
<p></p> 
<p>            preg_match('/^(data:\s*image\/(\w+);base64,)/', $old, $temp);</p> 
<p>            $tempType = $temp[2];   // 获取类型</p> 
<p></p> 
<p>            // 判断目录是否存在，不存在时创建</p> 
<p>            $tempFilePath = 'public/uploads/word_images/' . date('Y-m-d', time());</p> 
<p>            if (!file_exists($tempFilePath))</p> 
<p>                mkdir($tempFilePath);</p> 
<p></p> 
<p>            // 拼接完整路径</p> 
<p>            $tempFileName = $tempFilePath . '/word_image_' . time() . $k . '.' . $tempType;</p> 
<p>            $base64 = str_replace($temp[1], '', $old);</p> 
<p></p> 
<p>            file_put_contents($tempFileName, base64_decode($base64));</p> 
<p></p> 
<p>            // 替换路径字符串</p> 
<p>            $content = str_replace($old, $tempFileName, $content);</p> 
<p>        }</p> 
<p>        return $content;</p> 
<p>    }</p> 
<p>}</p> 
<p></p> 
<p></p> 
<p>7.编辑器实现导入操作</p> 
<p>在ueditor\ueditor.all.js文件中UE.plugin.register('simpleupload', function (){})下方新增如下方法</p> 
<p></p> 
<p></p> 
<p>/**</p> 
<p> * @description</p> 
<p> * word上传:点击按钮,直接选择文件上传</p> 
<p> */</p> 
<p>UE.plugin.register('wordupload', function (){<!-- --></p> 
<p>    var me = this,</p> 
<p>        isLoaded = false,</p> 
<p>        containerBtn;</p> 
<p></p> 
<p>    function initUploadBtn(){<!-- --></p> 
<p>        var w = containerBtn.offsetWidth || 20,</p> 
<p>            h = containerBtn.offsetHeight || 20,</p> 
<p>            btnIframe = document.createElement('iframe'),</p> 
<p>            btnStyle = 'display:block;width:' + w + 'px;height:' + h + 'px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;';</p> 
<p></p> 
<p>        domUtils.on(btnIframe, 'load', function(){<!-- --></p> 
<p></p> 
<p>            var timestrap = (+new Date()).toString(36),</p> 
<p>                wrapper,</p> 
<p>                btnIframeDoc,</p> 
<p>                btnIframeBody;</p> 
<p></p> 
<p>            btnIframeDoc = (btnIframe.contentDocument || btnIframe.contentWindow.document);</p> 
<p>            btnIframeBody = btnIframeDoc.body;</p> 
<p>            wrapper = btnIframeDoc.createElement('div');</p> 
<p></p> 
<p>            wrapper.innerHTML = '&lt;form id="edui_form_' + timestrap + '" target="edui_iframe_' + timestrap + '" method="POST" enctype="multipart/form-data" action="' + me.getOpt('serverUrl') + '" ' +</p> 
<p>                'style="' + btnStyle + '"&gt;' +</p> 
<p>                '&lt;input id="edui_input_' + timestrap + '" type="file" accept="application/msword" name="' + me.options.wordFieldName + '" ' +</p> 
<p>                'style="' + btnStyle + '"&gt;' +</p> 
<p>                '&lt;/form&gt;' +</p> 
<p>                '&lt;iframe id="edui_iframe_' + timestrap + '" name="edui_iframe_' + timestrap + '" style="display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;"&gt;&lt;/iframe&gt;';</p> 
<p></p> 
<p>            wrapper.className = 'edui-' + me.options.theme;</p> 
<p>            wrapper.id = me.ui.id + '_iframeupload';</p> 
<p>            btnIframeBody.style.cssText = btnStyle;</p> 
<p>            btnIframeBody.style.width = w + 'px';</p> 
<p>            btnIframeBody.style.height = h + 'px';</p> 
<p>            btnIframeBody.appendChild(wrapper);</p> 
<p></p> 
<p>            if (btnIframeBody.parentNode) {<!-- --></p> 
<p>                btnIframeBody.parentNode.style.width = w + 'px';</p> 
<p>                btnIframeBody.parentNode.style.height = w + 'px';</p> 
<p>            }</p> 
<p></p> 
<p>            var form = btnIframeDoc.getElementById('edui_form_' + timestrap);</p> 
<p>            var input = btnIframeDoc.getElementById('edui_input_' + timestrap);</p> 
<p>            var iframe = btnIframeDoc.getElementById('edui_iframe_' + timestrap);</p> 
<p></p> 
<p>            domUtils.on(input, 'change', function(){<!-- --></p> 
<p>                if(!input.value) return;</p> 
<p>                var loadingId = 'loading_' + (+new Date()).toString(36);</p> 
<p>                var allowFiles = me.getOpt('wordAllowFiles');</p> 
<p></p> 
<p>                me.focus();</p> 
<p>                me.execCommand('inserthtml', '&lt;img class="loadingclass" id="' + loadingId + '" src="' + me.options.themePath + me.options.theme +'/images/spacer.gif" title="' + (me.getLang('wordupload.loading') || '') + '" &gt;');</p> 
<p></p> 
<p>                function callback(){<!-- --></p> 
<p>                    try{<!-- --></p> 
<p>                        // 获取到内容</p> 
<p>                        var body = (iframe.contentDocument || iframe.contentWindow.document).body;</p> 
<p></p> 
<p>                        // 获取加载中图片并关闭</p> 
<p>                        var loader = me.document.getElementById(loadingId);</p> 
<p>                        loader.removeAttribute('id');</p> 
<p>                        domUtils.removeClasses(loader, 'loadingclass');</p> 
<p></p> 
<p>                        // 向编辑器赋值</p> 
<p>                        me.setContent(body.innerHTML, false);</p> 
<p>                        // me.execCommand('insertHtml', body.innerHTML);</p> 
<p>                    }catch(er){<!-- --></p> 
<p>                        showErrorLoader &amp;&amp; showErrorLoader(me.getLang('wordupload.loadError'));</p> 
<p>                    }</p> 
<p>                    form.reset();</p> 
<p>                    domUtils.un(iframe, 'load', callback);</p> 
<p>                }</p> 
<p>                function showErrorLoader(title){<!-- --></p> 
<p>                    if(loadingId) {<!-- --></p> 
<p>                        var loader = me.document.getElementById(loadingId);</p> 
<p>                        loader &amp;&amp; domUtils.remove(loader);</p> 
<p>                        me.fireEvent('showmessage', {<!-- --></p> 
<p>                            'id': loadingId,</p> 
<p>                            'content': title,</p> 
<p>                            'type': 'error',</p> 
<p>                            'timeout': 4000</p> 
<p>                        });</p> 
<p>                    }</p> 
<p>                }</p> 
<p></p> 
<p>                /* 判断后端配置是否没有加载成功 */</p> 
<p>                if (!me.getOpt('wordActionName')) {<!-- --></p> 
<p>                    errorHandler(me.getLang('autoupload.errorLoadConfig'));</p> 
<p>                    return;</p> 
<p>                }</p> 
<p>                // 判断文件格式是否错误</p> 
<p>                var filename = input.value,</p> 
<p>                    fileext = filename ? filename.substr(filename.lastIndexOf('.')):'';</p> 
<p>                if (!fileext || (allowFiles &amp;&amp; (allowFiles.join('') + '.').indexOf(fileext.toLowerCase() + '.') == -1)) {<!-- --></p> 
<p>                    showErrorLoader(me.getLang('wordupload.exceedTypeError'));</p> 
<p>                    return;</p> 
<p>                }</p> 
<p></p> 
<p>                domUtils.on(iframe, 'load', callback);</p> 
<p></p> 
<p>                // 上传操作</p> 
<p>                // form.action = utils.formatUrl(imageActionUrl + (imageActionUrl.indexOf('?') == -1 ? '?':'&amp;') + params);</p> 
<p>                // 替换请求地址为框架后台地址</p> 
<p>                form.action = "/admin.php?m=fwordToHtml&amp;a=index"//这个地址依据自己系统而定</p> 
<p>                form.method = "post"</p> 
<p>                form.submit();</p> 
<p>            });</p> 
<p></p> 
<p>            var stateTimer;</p> 
<p>            me.addListener('selectionchange', function () {<!-- --></p> 
<p>                clearTimeout(stateTimer);</p> 
<p>                stateTimer = setTimeout(function() {<!-- --></p> 
<p>                    var state = me.queryCommandState('wordupload');</p> 
<p>                    if (state == -1) {<!-- --></p> 
<p>                        input.disabled = 'disabled';</p> 
<p>                    } else {<!-- --></p> 
<p>                        input.disabled = false;</p> 
<p>                    }</p> 
<p>                }, 400);</p> 
<p>            });</p> 
<p>            isLoaded = true;</p> 
<p>        });</p> 
<p></p> 
<p>        btnIframe.style.cssText = btnStyle;</p> 
<p>        containerBtn.appendChild(btnIframe);</p> 
<p>    }</p> 
<p></p> 
<p>    return {<!-- --></p> 
<p>        bindEvents:{<!-- --></p> 
<p>            'ready': function() {<!-- --></p> 
<p>                //设置loading的样式</p> 
<p>                utils.cssRule('loading',</p> 
<p>                    '.loadingclass{display:inline-block;cursor:default;background: url(\''</p> 
<p>                    + this.options.themePath</p> 
<p>                    + this.options.theme +'/images/loading.gif\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n' +</p> 
<p>                    '.loaderrorclass{display:inline-block;cursor:default;background: url(\''</p> 
<p>                    + this.options.themePath</p> 
<p>                    + this.options.theme +'/images/loaderror.png\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;' +</p> 
<p>                    '}',</p> 
<p>                    this.document);</p> 
<p>            },</p> 
<p>            /* 初始化word上传按钮 */</p> 
<p>            'worduploadbtnready': function(type, container) {<!-- --></p> 
<p>                containerBtn = container;</p> 
<p>                me.afterConfigReady(initUploadBtn);</p> 
<p>            }</p> 
<p>        },</p> 
<p>        outputRule: function(root){<!-- --></p> 
<p>            utils.each(root.getNodesByTagName('img'),function(n){<!-- --></p> 
<p>                if (/\b(loaderrorclass)|(bloaderrorclass)\b/.test(n.getAttr('class'))) {<!-- --></p> 
<p>                    n.parentNode.removeChild(n);</p> 
<p>                }</p> 
<p>            });</p> 
<p>        },</p> 
<p>        commands: {<!-- --></p> 
<p>            'wordupload': {<!-- --></p> 
<p>                queryCommandState: function () {<!-- --></p> 
<p>                    return isLoaded ? 0:-1;</p> 
<p>                }</p> 
<p>            }</p> 
<p>        }</p> 
<p>    }</p> 
<p>});</p> 
<p></p> 
<p>然后在同文件下的btnCmds变量中添加上自定义的按钮：</p> 
<p></p> 
<p>    //为工具栏添加按钮，以下都是统一的按钮触发命令，所以写在一起</p> 
<p>    var btnCmds = ['undo', 'redo', 'formatmatch',</p> 
<p>        'bold', 'italic', 'underline', 'fontborder', 'touppercase', 'tolowercase',</p> 
<p>        'strikethrough', 'subscript', 'superscript', 'source', 'indent', 'outdent',</p> 
<p>        'blockquote', 'pasteplain', 'pagebreak',</p> 
<p>        'selectall', 'print','horizontal', 'removeformat', 'time', 'date', 'unlink',</p> 
<p>        'insertparagraphbeforetable', 'insertrow', 'insertcol', 'mergeright', 'mergedown', 'deleterow',</p> 
<p>        'deletecol', 'splittorows', 'splittocols', 'splittocells', 'mergecells', 'deletetable', 'drafts', 'wordupload'];</p> 
<p>至此，配置完成，结果示意图：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/29/61/iYteWXsu_o.gif"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/08/b3/JVMxvFma_o.gif"> </p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/06/db/AJEdDCqA_o.gif"> </p> 
<p>视频演示：</p> 
<div class="csdn-video-box"> 
 <iframe id="jOuq0PfQ-1681207074680" frameborder="0" src="https://player.bilibili.com/player.html?aid=652331903" allowfullscreen="true" data-mediaembed="bilibili"></iframe> 
 <p>Word一键粘贴(导入)插件-WordPress-整合教程</p> 
</div> 
<p> </p> 
<p>更多详细资料可以参考这篇文章：</p> 
<p><a href="http://blog.ncmem.com/wordpress/2019/08/12/ueditor-word%E5%9B%BE%E7%89%87%E8%BD%AC%E5%AD%98%E4%BA%A4%E4%BA%92/" rel="nofollow" title="详细思路及源码">详细思路及源码</a></p> 
<p>示例下载：</p> 
<p><a href="https://gitee.com/xproer/wordpaster-vue3-cli-ueditor1.5" rel="nofollow" title="wordpaster-vue3-cli-ueditor1.5">wordpaster-vue3-cli-ueditor1.5</a>，<a href="https://gitee.com/xproer/wordpaster-vue-ueditor1.5" rel="nofollow" title="wordpaster-vue-ueditor1.5">wordpaster-vue-ueditor1.5</a>，<a href="https://gitee.com/xproer/wordpaster-asp.net-ueditor1.5x" rel="nofollow" title="wordpaster-asp.net-ueditor1.5x">wordpaster-asp.net-ueditor1.5x</a>，<a href="https://gitee.com/xproer/wordpaster-php-ueditor1x" rel="nofollow" title="wordpaster-php-ueditor1x">wordpaster-php-ueditor1x</a>，<a href="https://gitee.com/xproer/wordpaster-jsp-ueditor1x%E2%80%8B" rel="nofollow" title="wordpaster-jsp-ueditor1x​">wordpaster-jsp-ueditor1x​</a></p> 
<p><br>  </p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/807ecf554baccc12b50076c2d0923f3a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何在Ubuntu上开机运行java程序</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/18ec685ed403882e1ffc11a8276c2652/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringBoot项目中idea提示未配置 Spring Boot 配置注解处理器解决方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>