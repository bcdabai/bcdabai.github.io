<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mysql-8.0.11.,MySQL 8.0.11安装配置 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mysql-8.0.11.,MySQL 8.0.11安装配置" />
<meta property="og:description" content="一、mysql-8.0.11-1.el6.x86_64.rpm-bundle.tar解压后有如下7个文件：
-rw-r--r-- 1 root root 28987588 Apr 9 01:06 mysql-community-client-8.0.11-1.el6.x86_64.rpm
-rw-r--r-- 1 root root 672184 Apr 9 01:06 mysql-community-common-8.0.11-1.el6.x86_64.rpm
-rw-r--r-- 1 root root 4443296 Apr 9 01:06 mysql-community-devel-8.0.11-1.el6.x86_64.rpm
-rw-r--r-- 1 root root 2579460 Apr 9 01:06 mysql-community-libs-8.0.11-1.el6.x86_64.rpm
-rw-r--r-- 1 root root 1902676 Apr 9 01:06 mysql-community-libs-compat-8.0.11-1.el6.x86_64.rpm
-rw-r--r-- 1 root root 395918848 Apr 9 01:07 mysql-community-server-8.0.11-1.el6.x86_64.rpm
-rw-r--r-- 1 root root 49092596 Apr 9 01:07 mysql-community-test-8.0.11-1.el6.x86_64.rpm
然后创建mysql用户：
useradd mysql
passwd mysql" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a74055a5dc8bef0729eade936d386b93/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-23T11:43:20+08:00" />
<meta property="article:modified_time" content="2021-03-23T11:43:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mysql-8.0.11.,MySQL 8.0.11安装配置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>一、mysql-8.0.11-1.el6.x86_64.rpm-bundle.tar解压后有如下7个文件：</p> 
 <p>-rw-r--r-- 1 root root 28987588 Apr 9 01:06 mysql-community-client-8.0.11-1.el6.x86_64.rpm</p> 
 <p>-rw-r--r-- 1 root root 672184 Apr 9 01:06 mysql-community-common-8.0.11-1.el6.x86_64.rpm</p> 
 <p>-rw-r--r-- 1 root root 4443296 Apr 9 01:06 mysql-community-devel-8.0.11-1.el6.x86_64.rpm</p> 
 <p>-rw-r--r-- 1 root root 2579460 Apr 9 01:06 mysql-community-libs-8.0.11-1.el6.x86_64.rpm</p> 
 <p>-rw-r--r-- 1 root root 1902676 Apr 9 01:06 mysql-community-libs-compat-8.0.11-1.el6.x86_64.rpm</p> 
 <p>-rw-r--r-- 1 root root 395918848 Apr 9 01:07 mysql-community-server-8.0.11-1.el6.x86_64.rpm</p> 
 <p>-rw-r--r-- 1 root root 49092596 Apr 9 01:07 mysql-community-test-8.0.11-1.el6.x86_64.rpm</p> 
 <p>然后创建mysql用户：</p> 
 <p>useradd mysql</p> 
 <p>passwd mysql</p> 
 <p>二、安装顺序为：(建议装之前先把之前的mysql相关包全部卸载，rpm -e --nodeps 即可)</p> 
 <p>[root@python ~]# rpm -ivh mysql-community-common-8.0.11-1.el6.x86_64.rpm</p> 
 <p>warning: mysql-community-common-8.0.11-1.el6.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY</p> 
 <p>Preparing... ########################################### [100%]</p> 
 <p>1:mysql-community-common ########################################### [100%]</p> 
 <p>[root@python ~]# rpm -ivh mysql-community-libs-8.0.11-1.el6.x86_64.rpm</p> 
 <p>warning: mysql-community-libs-8.0.11-1.el6.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY</p> 
 <p>Preparing... ########################################### [100%]</p> 
 <p>1:mysql-community-libs ########################################### [100%]</p> 
 <p>[root@python ~]# rpm -ivh mysql-community-libs-compat-8.0.11-1.el6.x86_64.rpm</p> 
 <p>warning: mysql-community-libs-compat-8.0.11-1.el6.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY</p> 
 <p>Preparing... ########################################### [100%]</p> 
 <p>file /usr/lib64/mysql/libmysqlclient.so.16.0.0 from install of mysql-community-libs-compat-8.0.11-1.el6.x86_64 conflicts with file from package mysql-libs-5.1.73-8.0.1.el6_8.x86_64</p> 
 <p>file /usr/lib64/mysql/libmysqlclient_r.so.16.0.0 from install of mysql-community-libs-compat-8.0.11-1.el6.x86_64 conflicts with file from package mysql-libs-5.1.73-8.0.1.el6_8.x86_64</p> 
 <p>[root@python ~]# rpm -e --nodeps mysql-libs-5.1.73-8.0.1.el6_8.x86_64</p> 
 <p>[root@python ~]# rpm -ivh mysql-community-libs-compat-8.0.11-1.el6.x86_64.rpm</p> 
 <p>warning: mysql-community-libs-compat-8.0.11-1.el6.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY</p> 
 <p>Preparing... ########################################### [100%]</p> 
 <p>1:mysql-community-libs-co########################################### [100%]</p> 
 <p>[root@python ~]# rpm -ivh mysql-community-server-8.0.11-1.el6.x86_64.rpm</p> 
 <p>warning: mysql-community-server-8.0.11-1.el6.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY</p> 
 <p>error: Failed dependencies:</p> 
 <p>mysql-community-client(x86-64) &gt;= 8.0.0 is needed by mysql-community-server-8.0.11-1.el6.x86_64</p> 
 <p>[root@python ~]# rpm -ivh mysql-community-client-8.0.11-1.el6.x86_64.rpm</p> 
 <p>warning: mysql-community-client-8.0.11-1.el6.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY</p> 
 <p>Preparing... ########################################### [100%]</p> 
 <p>1:mysql-community-client ########################################### [100%]</p> 
 <p>[root@python ~]# rpm -ivh mysql-community-server-8.0.11-1.el6.x86_64.rpm</p> 
 <p>warning: mysql-community-server-8.0.11-1.el6.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY</p> 
 <p>Preparing... ########################################### [100%]</p> 
 <p>1:mysql-community-server ########################################### [100%]</p> 
 <p>[root@python ~]# rpm -ivh mysql-community-devel-8.0.11-1.el6.x86_64.rpm</p> 
 <p>warning: mysql-community-devel-8.0.11-1.el6.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY</p> 
 <p>Preparing... ########################################### [100%]</p> 
 <p>1:mysql-community-devel ########################################### [100%]</p> 
 <p>^[[A[root@python ~]# rpm -ivh mysql-community-test-8.0.11-1.el6.x86_64.rpm</p> 
 <p>warning: mysql-community-test-8.0.11-1.el6.x86_64.rpm: Header V3 DSA/SHA1 Signature, key ID 5072e1f5: NOKEY</p> 
 <p>error: Failed dependencies:</p> 
 <p>perl(JSON) is needed by mysql-community-test-8.0.11-1.el6.x86_64</p> 
 <p>--懒的去装perl了，因此测试套件就不装了。</p> 
 <p>三、安装完毕后相关信息如下：</p> 
 <p>[root@python ~]# mysql -V</p> 
 <p>mysql Ver 8.0.11 for Linux on x86_64 (MySQL Community Server - GPL)</p> 
 <p>[root@python ~]# ll /etc/init.d/mysqld</p> 
 <p>-rwxr-xr-x 1 root root 7166 Apr 8 16:21 /etc/init.d/mysqld</p> 
 <p>[root@python ~]# ll /etc/my.cnf --配置文件位置</p> 
 <p>-rw-r--r-- 1 root root 1188 Apr 8 16:21 /etc/my.cnf</p> 
 <p>默认的datadir是在/var/lib/mysql/，可以通过修改my.cnf修改，启动命令如下：</p> 
 <p>[root@python ~]# service mysqld start</p> 
 <p>Initializing MySQL database: [ OK ]</p> 
 <p>Starting mysqld: [ OK ]</p> 
 <p>四、发现没密码不能登录，于是添加skip-grant-tables到my.cnf，重启进去重置密码：</p> 
 <p>Ps:20180517新添加：在安装完后，/var/log/mysqld.log里应该含有临时的root密码，可以直接登录，但是依然建议按本文方法修改掉密码认证的策略。 而在Windows平台使用msi安装时，则有自主选择密码认证方式的步骤，可以比较方便的进行设置。</p> 
 <p>mysql&gt; alter user root@'localhost' identified by 'mysql';</p> 
 <p>ERROR 1290 (HY000): The MySQL server is running with the --skip-grant-tables option so it cannot execute this statement</p> 
 <p>mysql&gt; exit</p> 
 <p>Bye</p> 
 <p>居然不能改。。。于是：</p> 
 <p>mysql&gt; delete from mysql.user where user='root';</p> 
 <p>Query OK, 1 row affected (0.10 sec)</p> 
 <p>mysql&gt; flush privileges;</p> 
 <p>Query OK, 0 rows affected (0.00 sec)</p> 
 <p>mysql&gt; create user root@'localhost' identified by 'mysql';</p> 
 <p>ERROR 1819 (HY000): Your password does not satisfy the current policy requirements</p> 
 <p>还是不能改，查看密码复杂度要求：</p> 
 <p>mysql&gt; show variables like '%pass%';</p> 
 <p>+----------------------------------------------+-----------------+</p> 
 <p>| Variable_name | Value |</p> 
 <p>+----------------------------------------------+-----------------+</p> 
 <p>| caching_sha2_password_auto_generate_rsa_keys | ON |</p> 
 <p>| caching_sha2_password_private_key_path | private_key.pem |</p> 
 <p>| caching_sha2_password_public_key_path | public_key.pem |</p> 
 <p>| default_password_lifetime | 0 |</p> 
 <p>| disconnect_on_expired_password | ON |</p> 
 <p>| mysql_native_password_proxy_users | OFF |</p> 
 <p>| password_history | 0 |</p> 
 <p>| password_reuse_interval | 0 |</p> 
 <p>| report_password | |</p> 
 <p>| sha256_password_auto_generate_rsa_keys | ON |</p> 
 <p>| sha256_password_private_key_path | private_key.pem |</p> 
 <p>| sha256_password_proxy_users | OFF |</p> 
 <p>| sha256_password_public_key_path | public_key.pem |</p> 
 <p>| validate_password.check_user_name | ON |</p> 
 <p>| validate_password.dictionary_file | |</p> 
 <p>| validate_password.length | 8 |</p> 
 <p>| validate_password.mixed_case_count | 1 |</p> 
 <p>| validate_password.number_count | 1 |</p> 
 <p>| validate_password.policy | MEDIUM |</p> 
 <p>| validate_password.special_char_count | 1 |</p> 
 <p>+----------------------------------------------+-----------------+</p> 
 <p>查看官网https://dev.mysql.com/doc/refman/8.0/en/validate-password-options-variables.html#sysvar_validate_password.policy</p> 
 <p>发现此值有3个，如下所示：</p> 
 <p align="center"><img src="https://images2.imgbox.com/45/3e/MiOC34Z2_o.png" alt="aa3121be77654861fc706c5563122307.png"></p> 
 <p>于是设置为0，然后将validate_password.length设置为4，表示最少需要4字符。之所以设置为4是因为这个参数的值不能小于如下公式的计算结果：</p> 
 <p>validate_password.number_count</p> 
 <p>+ validate_password.special_char_count</p> 
 <p>+ (2 * validate_password.mixed_case_count)</p> 
 <p>于是继续创建用户，MySQL8.0取消了直接grant创建用户的语法，只能先create user再grant，因此创建root如下：</p> 
 <p>mysql&gt; create user root@'localhost' identified by 'mysql';</p> 
 <p>ERROR 1396 (HY000): Operation CREATE USER failed for 'root'@'localhost'</p> 
 <p>mysql&gt; FLUSH PRIVILEGES;</p> 
 <p>Query OK, 0 rows affected (0.00 sec)</p> 
 <p>mysql&gt; create user root@'localhost' identified by 'mysql';</p> 
 <p>ERROR 1396 (HY000): Operation CREATE USER failed for 'root'@'localhost'</p> 
 <p>尼玛...什么玩意儿？</p> 
 <p>于是去逛了一圈stackoverflow,都说这是一个BUG，于是操作如下：</p> 
 <p>mysql&gt; drop user root@'localhost'; --是的没错，虽然没有root@'localhost'用户，但你还是要删一遍。</p> 
 <p>Query OK, 0 rows affected (0.05 sec)</p> 
 <p>mysql&gt; FLUSH PRIVILEGES;</p> 
 <p>Query OK, 0 rows affected (0.01 sec)</p> 
 <p>mysql&gt; create user root@'localhost' identified by 'mysql';</p> 
 <p>Query OK, 0 rows affected (0.03 sec)</p> 
 <p>mysql&gt; grant all on *.* to root@'localhost' with grant option;</p> 
 <p>Query OK, 0 rows affected (0.03 sec)</p> 
 <p>终于改完密码了...去掉参数文件的skip-grant-tables参数，service mysqld restart重启服务。</p> 
 <p>五、终于设置好密码了，建一个测试用户leo，然后尝试远程连接下吧：</p> 
 <p>$ mysql -uleo -pmysql -h192.168.1.193</p> 
 <p>mysql: [Warning] Using a password on the command line interface can be insecure.</p> 
 <p>ERROR 2059 (HY000): Authentication plugin 'caching_sha2_password' cannot be loaded: /usr/lib/mysql/plugin/caching_sha2_password.so: cannot open shared object file: No such file or directory</p> 
 <p>我这5.7的mysql工具都连不上，这就尴尬了，查看认证相关参数：</p> 
 <p>mysql&gt; show variables like '%auth%';</p> 
 <p>+-------------------------------+-----------------------+</p> 
 <p>| Variable_name | Value |</p> 
 <p>+-------------------------------+-----------------------+</p> 
 <p>| default_authentication_plugin | caching_sha2_password |</p> 
 <p>+-------------------------------+-----------------------+</p> 
 <p>1 row in set (0.02 sec)</p> 
 <p>查看官网发现此值的取值如下：</p> 
 <p align="center"><img src="https://images2.imgbox.com/87/ab/aTdx4Fg1_o.png" alt="c8fac25e901c9a4ea783012916c66823.png"></p> 
 <p>官网还说此值影响create user不显式指定auth plugin时密码的默认加密算法，卧槽...那岂不是说我之前创建的leo用户使用的是默认的caching_sha2_password认证，查看一下：</p> 
 <p>mysql&gt; select user,host,plugin from mysql.user;</p> 
 <p>+------------------+-----------+-----------------------+</p> 
 <p>| user | host | plugin |</p> 
 <p>+------------------+-----------+-----------------------+</p> 
 <p>| leo | % | caching_sha2_password |</p> 
 <p>| mysql.infoschema | localhost | mysql_native_password |</p> 
 <p>| mysql.session | localhost | mysql_native_password |</p> 
 <p>| mysql.sys | localhost | mysql_native_password |</p> 
 <p>| root | localhost | caching_sha2_password |</p> 
 <p>+------------------+-----------+-----------------------+</p> 
 <p>完了，全TM完了......</p> 
 <p>显然不能直接update plugin，因为这可能导致加密的密码无法被正确解密，你所有的密码都会变异，因此全部删掉重建,又得苦逼的来一遍skip-grant-tables，而且你还需要在my.cnf里添加：default_authentication_plugin=mysql_native_password，然后service mysqld restart重启服务，以下只演示leo用户的创建：</p> 
 <p>mysql&gt; drop user leo;</p> 
 <p>Query OK, 0 rows affected (0.10 sec)</p> 
 <p>mysql&gt; flush privileges;</p> 
 <p>Query OK, 0 rows affected (0.00 sec)</p> 
 <p>mysql&gt; create user leo identified by 'mysql';</p> 
 <p>Query OK, 0 rows affected (0.02 sec)</p> 
 <p>mysql&gt; grant all on *.* to leo;</p> 
 <p>Query OK, 0 rows affected (0.08 sec)</p> 
 <p>$mysql -V</p> 
 <p>mysql Ver 14.14 Distrib 5.7.20, for Linux (x86_64) using EditLine wrapper</p> 
 <p>$ mysql -uleo -pmysql -h192.168.1.193</p> 
 <p>mysql: [Warning] Using a password on the command line interface can be insecure.</p> 
 <p>Welcome to the MySQL monitor. Commands end with ; or \g.</p> 
 <p>Your MySQL connection id is 16</p> 
 <p>Server version: 8.0.11 MySQL Community Server - GPL</p> 
 <p>Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</p> 
 <p>Oracle is a registered trademark of Oracle Corporation and/or its</p> 
 <p>affiliates. Other names may be trademarks of their respective</p> 
 <p>owners.</p> 
 <p>Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</p> 
 <p>mysql&gt;</p> 
 <p>至此远程连接正常。</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6e8ff354eb657d6d91702d67705059a0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">无限循环动画实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e7d3b7cff8c589c29c732f96aa18d2f1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vant Cascader 级联选择 异步加载</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>