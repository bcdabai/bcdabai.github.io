<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>微信小程序中实现——【音乐播放器】 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="微信小程序中实现——【音乐播放器】" />
<meta property="og:description" content="文章目录 一、学习目标1、掌握swiper组件、scroll-view组件的使用2、掌握image组件的使用3、掌握音频API的使用4、掌握slider组件的使用 二、开发前的准备1、页面结构图2、项目初始化3、 任务分析4、 前导知识 三、标签页切换1、页面和样式：2、音乐小程序基础页面和样式：3、页面和样式tab导航的样式：4、测试页面info.wxml、page.wxml、play.wxml文件：5、通过滚动时间切换页面效果（一）滚动事件（二）通过滚动事件切换页面效果： 四、音乐推荐1、scroll-view组件的属性及说明： 2、image组件缩放模式和裁剪模式测试：（一）scroll-view组件： 3、swiper组件实现轮播图：4、flex布局实现功能按钮：（一）flex布局实现功能按钮：（二）flex布局实现页面布局：5、index页面底部播放 五、播放器1、audioctx对象声明的方式：（一）innerAudioContext案例使用：（二）slider组件的使用：（三）音乐播放列表和音乐状态数据：（四）实现音乐播放功能（五）底部播放器的结构代码：（六）底部播放器暂停/播放按钮控制歌曲：(七）实现播放器切换下一曲歌曲：（八）播放器页面结构代码： 六、播放器1、播放器样式12、通过CSS3动画实现海报的旋转功能：3、播放器页面下方的滑块结构：3、显示音乐的播放进度：4、控制进度条的长度控制歌曲播放进度： 七、播放列表1、控制进度条的长度控制歌曲播放进度：2、实现换曲功能： 一、学习目标 1、掌握swiper组件、scroll-view组件的使用 2、掌握image组件的使用 3、掌握音频API的使用 4、掌握slider组件的使用 二、开发前的准备 音乐小程序项目效果展示：
1、页面结构图 tab导航栏
content内容区
player音乐播放控件
2、项目初始化 开发者工具创建空白项目：
{&#34;pages:[&#34;pages/index/index&#34; ] } “navigationBarBackgroudColor”:&#34;#fff,
“navigationBartitletext”:“音乐,”
“navigationBarBackgroudColor”:“black”,
3、 任务分析 标签页和页面info.wxml、play.wxml、palylist.wxml
4、 前导知识 swiper组件编写滑动页面结构
&lt;swiper&gt; &lt;swiper-item style=&#34;background:#ccc&#34;&gt;0&lt;/swiper-item&gt; &lt;swiper-item style=&#34;background:#ddd&#34;&gt;1&lt;/swiper-item&gt; &lt;swiper-item style=&#34;background:#eee&#34;&gt;2&lt;/swiper-item&gt; &lt;/swiper-item&gt; swiper组件编写滑动页面结构index.wxml:
&lt;swiper current-item-id=&#34;c&#34;&gt; &lt; swiper-item item-id=&#34;a&#34;&gt; &lt;image src= &#34;https://assets.lexus.com.cn/images/index/kv/2880x1480. newes. 1.jpg?x-Oss- process=image/resize,w. 1898/quality.q. 80&#34; mode= &#34;widthFix&#34; &gt; &lt;/image&gt; &lt;/swiper-item&gt; &lt;swiper-item item-id=&#34;b&#34;&gt; &lt;image src= https://assets.exus.com.cn/images/models/s/s -kv-1 2880." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f22d675bf24465109bec2e98541a2b4a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-13T11:39:44+08:00" />
<meta property="article:modified_time" content="2022-12-13T11:39:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">微信小程序中实现——【音乐播放器】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">一、学习目标</a></li><li><ul><li><ul><li><a href="#1swiperscrollview_3" rel="nofollow">1、掌握swiper组件、scroll-view组件的使用</a></li><li><a href="#2image_4" rel="nofollow">2、掌握image组件的使用</a></li><li><a href="#3API_5" rel="nofollow">3、掌握音频API的使用</a></li><li><a href="#4slider_6" rel="nofollow">4、掌握slider组件的使用</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_7" rel="nofollow">二、开发前的准备</a></li><li><ul><li><ul><li><a href="#1_10" rel="nofollow">1、页面结构图</a></li><li><a href="#2_15" rel="nofollow">2、项目初始化</a></li><li><a href="#3__29" rel="nofollow">3、 任务分析</a></li><li><a href="#4__32" rel="nofollow">4、 前导知识</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_74" rel="nofollow">三、标签页切换</a></li><li><ul><li><ul><li><a href="#1_75" rel="nofollow">1、页面和样式：</a></li><li><a href="#2_87" rel="nofollow">2、音乐小程序基础页面和样式：</a></li><li><a href="#3tab_104" rel="nofollow">3、页面和样式tab导航的样式：</a></li><li><a href="#4infowxmlpagewxmlplaywxml_109" rel="nofollow">4、测试页面info.wxml、page.wxml、play.wxml文件：</a></li><li><a href="#5_139" rel="nofollow">5、通过滚动时间切换页面效果</a></li><li><ul><li><a href="#_154" rel="nofollow">（一）滚动事件</a></li><li><a href="#_165" rel="nofollow">（二）通过滚动事件切换页面效果：</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#_167" rel="nofollow">四、音乐推荐</a></li><li><ul><li><ul><li><ul><li><a href="#1scrollview_168" rel="nofollow">1、scroll-view组件的属性及说明：</a></li></ul> 
    </li><li><a href="#2image_182" rel="nofollow">2、image组件缩放模式和裁剪模式测试：</a></li><li><ul><li><a href="#scrollview_184" rel="nofollow">（一）scroll-view组件：</a></li></ul> 
    </li><li><a href="#3swiper_194" rel="nofollow">3、swiper组件实现轮播图：</a></li><li><a href="#4flex_210" rel="nofollow">4、flex布局实现功能按钮：</a></li><li><ul><li><a href="#flex_222" rel="nofollow">（一）flex布局实现功能按钮：</a></li><li><a href="#flex_244" rel="nofollow">（二）flex布局实现页面布局：</a></li><li><a href="#5index_277" rel="nofollow">5、index页面底部播放</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#_349" rel="nofollow">五、播放器</a></li><li><ul><li><ul><li><a href="#1audioctx_350" rel="nofollow">1、audioctx对象声明的方式：</a></li><li><ul><li><a href="#innerAudioContext_354" rel="nofollow">（一）innerAudioContext案例使用：</a></li><li><a href="#slider_367" rel="nofollow">（二）slider组件的使用：</a></li><li><a href="#_375" rel="nofollow">（三）音乐播放列表和音乐状态数据：</a></li><li><a href="#_388" rel="nofollow">（四）实现音乐播放功能</a></li><li><a href="#_438" rel="nofollow">（五）底部播放器的结构代码：</a></li><li><a href="#_467" rel="nofollow">（六）底部播放器暂停/播放按钮控制歌曲：</a></li><li><a href="#_473" rel="nofollow">(七）实现播放器切换下一曲歌曲：</a></li><li><a href="#_492" rel="nofollow">（八）播放器页面结构代码：</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#_505" rel="nofollow">六、播放器</a></li><li><ul><li><a href="#11_533" rel="nofollow">1、播放器样式1</a></li><li><a href="#2CSS3_551" rel="nofollow">2、通过CSS3动画实现海报的旋转功能：</a></li><li><a href="#3_561" rel="nofollow">3、播放器页面下方的滑块结构：</a></li><li><a href="#3_567" rel="nofollow">3、显示音乐的播放进度：</a></li><li><a href="#4_583" rel="nofollow">4、控制进度条的长度控制歌曲播放进度：</a></li></ul> 
  </li><li><a href="#_619" rel="nofollow">七、播放列表</a></li><li><ul><li><a href="#1_620" rel="nofollow">1、控制进度条的长度控制歌曲播放进度：</a></li><li><a href="#2_632" rel="nofollow">2、实现换曲功能：</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>一、学习目标</h2> 
<h4><a id="1swiperscrollview_3"></a>1、掌握swiper组件、scroll-view组件的使用</h4> 
<h4><a id="2image_4"></a>2、掌握image组件的使用</h4> 
<h4><a id="3API_5"></a>3、掌握音频API的使用</h4> 
<h4><a id="4slider_6"></a>4、掌握slider组件的使用</h4> 
<h2><a id="_7"></a>二、开发前的准备</h2> 
<p>音乐小程序项目效果展示：<br> <img src="https://images2.imgbox.com/2d/12/aXV7EhLY_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="1_10"></a>1、页面结构图</h4> 
<p>tab导航栏<br> content内容区<br> player音乐播放控件<br> <img src="https://images2.imgbox.com/70/3b/6dsiM5Gg_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_15"></a>2、项目初始化</h4> 
<p>开发者工具创建空白项目：</p> 
<pre><code>{"pages:["pages/index/index"
]
}
</code></pre> 
<p>“navigationBarBackgroudColor”:"#fff,<br> “navigationBartitletext”:“音乐,”<br> “navigationBarBackgroudColor”:“black”,<br> <img src="https://images2.imgbox.com/12/b2/NVaLFRE0_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3__29"></a>3、 任务分析</h4> 
<p>标签页和页面info.wxml、play.wxml、palylist.wxml</p> 
<h4><a id="4__32"></a>4、 前导知识</h4> 
<p>swiper组件编写滑动页面结构</p> 
<pre><code>&lt;swiper&gt;
&lt;swiper-item style="background:#ccc"&gt;0&lt;/swiper-item&gt;
&lt;swiper-item style="background:#ddd"&gt;1&lt;/swiper-item&gt;
&lt;swiper-item style="background:#eee"&gt;2&lt;/swiper-item&gt;
&lt;/swiper-item&gt;
</code></pre> 
<p>swiper组件编写滑动页面结构index.wxml:</p> 
<pre><code>&lt;swiper current-item-id="c"&gt;
&lt; swiper-item item-id="a"&gt; &lt;image
src= "https://assets.lexus.com.cn/images/index/kv/2880x1480. newes. 1.jpg?x-Oss-
process=image/resize,w. 1898/quality.q. 80" mode= "widthFix" &gt; &lt;/image&gt; &lt;/swiper-item&gt;
&lt;swiper-item item-id="b"&gt; &lt;image src= https://assets.exus.com.cn/images/models/s/s -kv-1 2880.jpg?x-oss-
process=image/resize,w. 1898/quality.q. 80" mode= "widthFix" &gt; &lt;/image&gt; &lt;/swiper-item&gt;
&lt;swiper-item item-id="c"&gt; &lt;image src="https://assets.lexus.com.cn/images/index/kv/ux. 300e-kv-1-2880.jpg?x-
oss-process= image/resize,w 1898/quality,q 80" mode="widthFix"&gt; &lt;/image&gt; &lt;/swiper-item&gt;
&lt;/swiper&gt;

</code></pre> 
<p>swiper组件编写滑动页面结构index.wxss：</p> 
<pre><code>image{
width：100%;
}
</code></pre> 
<p>include主要用途：<br> 1、将代码拆分到多个文件中，可以更方便地查找代码。<br> 2、将代码公共部分抽取出来。通过外部文件引入。</p> 
<pre><code>&lt;include src="header.wxml /&gt;
&lt;view&gt;body&lt;/view&gt;
&lt;include src="footer.wxml " /&gt;

</code></pre> 
<p><img src="https://images2.imgbox.com/97/57/hYBcSYrO_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_74"></a>三、标签页切换</h2> 
<h4><a id="1_75"></a>1、页面和样式：</h4> 
<pre><code>&lt;view class="tab&gt;
&lt;view class="tab-item"&gt;音乐推荐&lt;/view&gt;
&lt;/view&gt;
&lt;!---内容区域---&gt;
&lt;view class="content"&gt;&lt;/view&gt;
&lt;!---底部播放器---&gt;
&lt;view class="player"&gt;&lt;/view&gt;

</code></pre> 
<h4><a id="2_87"></a>2、音乐小程序基础页面和样式：</h4> 
<pre><code>&lt;!--标签页标题--&gt;
&lt;view class=" tab"&gt;
&lt;view class= "tab-item {<!-- -->{tab==0? active':' }}" bindtap=”changeItem"
data-item= "0" &gt;音乐推荐&lt; /view&gt;
&lt;view class=”tab item {<!-- -->{tab== 1? actie':"}}" bindtap=”changeItem”
data-item="1" &gt;播放器&lt; /view&gt;
&lt;view class=”tab item {<!-- -->{tab== 2? actie':"}}" bindtap=”changeItem”
data-item= "2" &gt;播放列表&lt; /view&gt;
&lt; /view&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/91/16/jEryfETX_o.png" alt="请添加图片描述"></p> 
<p>页面和样式：<br> <img src="https://images2.imgbox.com/60/12/rJwjrwB4_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3tab_104"></a>3、页面和样式tab导航的样式：</h4> 
<p><img src="https://images2.imgbox.com/b2/70/QZoNznsR_o.png" alt="请添加图片描述"><br> tab导航效果：</p> 
<p><img src="https://images2.imgbox.com/5f/4a/LK52Gp5D_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="4infowxmlpagewxmlplaywxml_109"></a>4、测试页面info.wxml、page.wxml、play.wxml文件：</h4> 
<pre><code>&lt;view style= "background:#ddd; color:#000; h
eight:100%"&gt; play &lt;/view&gt;
&lt;view style= "background:#ccc; color:#000; he
ight:100%" &gt; info&lt; /view&gt;
&lt;view style= "background:#eee; color:#00O; he
ight:100%" &gt; playlist&lt;/view&gt;
</code></pre> 
<p>实现标签页切换<br> 单击导航栏选项卡实现标签页切换：</p> 
<pre><code>&lt;view class="tab-item {<!-- -->{tab==0?'a
ctive':'}}"
bindtap=" changeltem" data-item
="0"&gt;
音乐推荐&lt; /view&gt;
changeltem: function(e) {
this.setData({
item: e.target.dataset.item,
tab:e.target.dataset.item
}},
</code></pre> 
<p>标签页切换样式</p> 
<pre><code>.tab -item.active {
color: #c25b5b;
border- bottom-color: #c25b5b;
</code></pre> 
<h4><a id="5_139"></a>5、通过滚动时间切换页面效果</h4> 
<pre><code>&lt; swiper current= "{item}" bindchange="c
hangeTab"&gt; 
&lt; swiper- item&gt;
&lt;include src = ../index/info" &gt; &lt;/include&gt;
&lt;/swiper-item&gt;
&lt; swiper- item&gt;
&lt;include src= ../index/play" &gt; &lt;/include&gt;
&lt;/swiper-item&gt;
&lt; swiper- item&gt;
&lt;include src=”./index/playlist" &gt; &lt;/include&gt;
&lt;/swiper-item&gt;
&lt;/swiper&gt;
</code></pre> 
<h5><a id="_154"></a>（一）滚动事件</h5> 
<pre><code>change Tab: function(e) {
this.setData({
tab: e.detail.current
.tab-item.active {
color: #c25b5b;
border- bottom-color: #c25b5b;}
</code></pre> 
<h5><a id="_165"></a>（二）通过滚动事件切换页面效果：</h5> 
<p><img src="https://images2.imgbox.com/0d/6c/JsY8oK0S_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_167"></a>四、音乐推荐</h2> 
<h5><a id="1scrollview_168"></a>1、scroll-view组件的属性及说明：</h5> 
<pre><code>&lt; scroll-view scroll-x scroll-y style="hei
ght:200px" bindscroll- "scroll"&gt;
&lt;view style ="width:200%;height:400p
x;background:#ccc" &gt; &lt;/view&gt;
&lt;/scroll-view&gt;
scroll: function(e) {
console.log(e.detail)
},
</code></pre> 
<p><img src="https://images2.imgbox.com/dc/70/CWewSeQJ_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2image_182"></a>2、image组件缩放模式和裁剪模式测试：</h4> 
<p>内容区域滚动</p> 
<h5><a id="scrollview_184"></a>（一）scroll-view组件：</h5> 
<pre><code>&lt; scroll-view class= "content-info" scroll-y&gt;
&lt;view style= "background:#eee;height:10
00px" &gt; &lt;/view&gt;
&lt;view&gt;已到达底部&lt; /view&gt;
&lt; /scroll-view&gt;

</code></pre> 
<p><img src="https://images2.imgbox.com/ef/db/Nr9B6f4V_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3swiper_194"></a>3、swiper组件实现轮播图：</h4> 
<pre><code>&lt;swiper class="content-info-slide" indicator-color="rgba(255,255,255,.5)" indicator-active-color="#fff" indicator-dots circular autoplay&gt;
    &lt;swiper-item&gt;
      &lt;image src="/images/banner.jpg" /&gt;
    &lt;/swiper-item&gt;
    &lt;swiper-item&gt;
      &lt;image src="/images/banner.jpg" /&gt;
    &lt;/swiper-item&gt;
    &lt;swiper-item&gt;
      &lt;image src="/images/banner.jpg" /&gt;
    &lt;/swiper-item&gt;
  &lt;/swiper&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/a1/20/6IwCVJM0_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/87/96/mN1EL1Q0_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="4flex_210"></a>4、flex布局实现功能按钮：</h4> 
<pre><code>&lt;view class="content-info-portal"&gt;
    &lt;view&gt;
      &lt;image src="/images/04.png" /&gt;
      &lt;text&gt;私人FM&lt;/text&gt;
    &lt;/view&gt;

</code></pre> 
<p><img src="https://images2.imgbox.com/6b/5e/5lia1W7S_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="flex_222"></a>（一）flex布局实现功能按钮：</h5> 
<pre><code>.content-info-portal {
  display: flex;
  margin-bottom: 15px;
}
.content-info-portal &gt; view {
  flex: 1;
  font-size: 11pt;
  text-align: center;
}
.content-info-portal image {
  width: 120rpx;
  height: 120rpx;
  display: block;
  margin: 20rpx auto;
}

</code></pre> 
<p><img src="https://images2.imgbox.com/4f/ca/7pfED0MS_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="flex_244"></a>（二）flex布局实现页面布局：</h5> 
<pre><code>  &lt;view class="content-info-list"&gt;
    &lt;view class="list-title"&gt;推荐歌曲&lt;/view&gt;
    &lt;view class="list-inner"&gt;
      &lt;view class="list-item"&gt;
        &lt;image src="/images/cover.jpg" /&gt;
        &lt;view&gt;紫罗兰&lt;/view&gt;
      &lt;/view&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/bb/ce/vzXwB9UO_o.png" alt="在这里插入图片描述"><br> 热门音乐</p> 
<pre><code>.content-info-list &gt; .list-inner &gt; .list-item {
  flex: 1;
}
.content-info-list &gt; .list-inner &gt; .list-item &gt; image {
  display: block;
  width: 200rpx;
  height: 200rpx;
  margin: 0 auto;
  border-radius: 10rpx;
  border: 1rpx solid #555;
}
.content-info-list &gt; .list-inner &gt; .list-item &gt; view {
  width: 200rpx;
  margin: 10rpx auto;
  font-size: 10pt;
}

</code></pre> 
<p><img src="https://images2.imgbox.com/2d/35/ggRZOanc_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="5index_277"></a>5、index页面底部播放</h5> 
<pre><code>&lt;!-- 底部播放器 --&gt;
&lt;view class="player"&gt;
  &lt;image class="player-cover" src="{<!-- -->{play.coverImgUrl}}" /&gt;
  &lt;view class="player-info"&gt;
    &lt;view class="player-info-title"&gt;{<!-- -->{play.title}}&lt;/view&gt;
    &lt;view class="player-info-singer"&gt;{<!-- -->{play.singer}}&lt;/view&gt;
  &lt;/view&gt;
  &lt;view class="player-controls"&gt;
    &lt;!-- 切换到播放列表 --&gt;
    &lt;image src="/images/01.png" bindtap="changePage" data-page="2" /&gt;
    &lt;!-- 播放或暂停 --&gt;
    &lt;image wx:if="{<!-- -->{state=='paused'}}" src="/images/02.png" bindtap="play" /&gt;
    &lt;image wx:else src="/images/02stop.png" bindtap="pause" /&gt;
    &lt;!-- 下一曲 --&gt;
    &lt;image src="/images/03.png" bindtap="next" /&gt;
  &lt;/view&gt;
&lt;/view&gt;

</code></pre> 
<p><img src="https://images2.imgbox.com/de/cb/6ySSEmHY_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/b5/b4/utzz3SVA_o.png" alt="在这里插入图片描述"></p> 
<pre><code>.player {
  display: flex;
  align-items: center;
  background: #222;
  border-top: 1px solid #252525;
  height: 112rpx;
}

.player-cover {
  width: 80rpx;
  height: 80rpx;
  margin-left: 15rpx;
  border-radius: 8rpx;
  border: 1px solid #333;
}



</code></pre> 
<p><img src="https://images2.imgbox.com/c7/bc/iBMhmpf1_o.png" alt="在这里插入图片描述"></p> 
<pre><code>.player-info {
  flex: 1;
  font-size: 10pt;
  line-height: 38rpx;
  margin-left: 20rpx;
  padding-bottom: 8rpx;
}

.player-info-singer {
  color: #888;
}

.player-controls image {
  width: 80rpx;
  height: 80rpx;
  margin-right: 15rpx;
}


</code></pre> 
<p><img src="https://images2.imgbox.com/1c/d7/A7ZzYkEx_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_349"></a>五、播放器</h2> 
<h4><a id="1audioctx_350"></a>1、audioctx对象声明的方式：</h4> 
<pre><code>var  audioctx = wx.createInnerAudioContext();
</code></pre> 
<h5><a id="innerAudioContext_354"></a>（一）innerAudioContext案例使用：</h5> 
<pre><code>onReady: function() {
var audioCtx = wx.createInnerAudioContext(
audioCtx.src = htt.:/....x.o.
audioCtx.onPlay(function() {
console.log('开始播放')
})
...
},

</code></pre> 
<h5><a id="slider_367"></a>（二）slider组件的使用：</h5> 
<pre><code>&lt;slider bindchanging = "sliderChangeing" show-value /&gt;
sliderChanging:function(e){
console.log(e.detail.value)
},
</code></pre> 
<p><img src="https://images2.imgbox.com/76/b9/INPJxiIO_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_375"></a>（三）音乐播放列表和音乐状态数据：</h5> 
<pre><code>   playlist: [{
      id: 1,
      title: '钢琴协奏曲',
      singer: '肖邦',
      src: 'http://localhost:3000/1.mp3',
      coverImgUrl: '/images/cover.jpg'
    },

</code></pre> 
<p><img src="https://images2.imgbox.com/6b/dc/nZOBb5n9_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_388"></a>（四）实现音乐播放功能</h5> 
<p>音乐播放逻辑代码：</p> 
<pre><code> audioCtx: null,
  onReady: function() {
    this.audioCtx = wx.createInnerAudioContext()
    // 默认选择第1曲
    this.setMusic(0)
    var that = this
    // 播放进度检测
    this.audioCtx.onError(function() {
      console.log('播放失败：' + that.audioCtx.src)
    })
    // 播放完成自动换下一曲
    this.audioCtx.onEnded(function() {
      that.next()
    })
    // 自动更新播放进度
    this.audioCtx.onPlay(function() {})
    this.audioCtx.onTimeUpdate(function() {
      that.setData({
        'play.duration': formatTime(that.audioCtx.duration),
        'play.currentTime': formatTime(that.audioCtx.currentTime),
        'play.percent': that.audioCtx.currentTime / that.audioCtx.duration * 100
      })
    })
    // 格式化时间
    function formatTime(time) {
      var minute = Math.floor(time / 60) % 60;
      var second = Math.floor(time) % 60
      return (minute &lt; 10 ? '0' + minute : minute) + ':' + (second &lt; 10 ? '0' + second : second)
    }
  },
  // 音乐播放
  setMusic: function(index) {
    var music = this.data.playlist[index]
    this.audioCtx.src = music.src
    this.setData({
      playIndex: index,
      'play.title': music.title,
      'play.singer': music.singer,
      'play.coverImgUrl': music.coverImgUrl,
      'play.currentTime': '00:00',
      'play.duration': '00:00',
      'play.percent': 0
    })
  },

</code></pre> 
<h5><a id="_438"></a>（五）底部播放器的结构代码：</h5> 
<pre><code>&lt;!-- 底部播放器 --&gt;
&lt;view class="player"&gt;
  &lt;image class="player-cover" src="{<!-- -->{play.coverImgUrl}}" /&gt;
  &lt;view class="player-info"&gt;
    &lt;view class="player-info-title"&gt;{<!-- -->{play.title}}&lt;/view&gt;
    &lt;view class="player-info-singer"&gt;{<!-- -->{play.singer}}&lt;/view&gt;
  &lt;/view&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/f0/7d/bW6ZGb1J_o.png" alt="在这里插入图片描述"></p> 
<p>底部播放器的样式代码：</p> 
<pre><code>.player {
  display: flex;
  align-items: center;
  background: #222;
  border-top: 1px solid #252525;
  height: 112rpx;
}
</code></pre> 
<p><img src="https://images2.imgbox.com/dc/c7/vWp7lSBb_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_467"></a>（六）底部播放器暂停/播放按钮控制歌曲：</h5> 
<pre><code>   &lt;image wx:if="{<!-- -->{state=='paused'}}" src="/images/02.png" bindtap="play" /&gt;
    &lt;image wx:else src="/images/02stop.png" bindtap="pause" /&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/7c/f6/6L9Ovew7_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_473"></a>(七）实现播放器切换下一曲歌曲：</h5> 
<pre><code>
    &lt;image src="/images/03.png" bindtap="next" /&gt;
</code></pre> 
<pre><code> next: function() {
    var index = this.data.playIndex &gt;= this.data.playlist.length - 1 ? 0 : this.data.playIndex + 1
    this.setMusic(index)
    if (this.data.state === 'running') {
      this.play()
    }
  },
</code></pre> 
<p><img src="https://images2.imgbox.com/48/86/bqSww40X_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_492"></a>（八）播放器页面结构代码：</h5> 
<pre><code>&lt;view class="content-play"&gt;
  &lt;!-- 显示音乐信息 --&gt;
  &lt;view class="content-play-info"&gt;
    &lt;text&gt;{<!-- -->{play.title}}&lt;/text&gt;
    &lt;view&gt;—— {<!-- -->{play.singer}} ——&lt;/view&gt;
  &lt;/view&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/95/c6/BG0HEa2w_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_505"></a>六、播放器</h2> 
<pre><code>&lt;!-- 播放器 --&gt;
&lt;view class="content-play"&gt;
  &lt;!-- 显示音乐信息 --&gt;
  &lt;view class="content-play-info"&gt;
    &lt;text&gt;{<!-- -->{play.title}}&lt;/text&gt;
    &lt;view&gt;—— {<!-- -->{play.singer}} ——&lt;/view&gt;
  &lt;/view&gt;
  &lt;!-- 显示专辑封面 --&gt;
  &lt;view class="content-play-cover"&gt;
    &lt;image src="{<!-- -->{play.coverImgUrl}}" style="animation-play-state:{<!-- -->{state}}" /&gt;
  &lt;/view&gt;
  &lt;!-- 显示播放进度和时间 --&gt;
  &lt;view class="content-play-progress"&gt;
    &lt;text&gt;{<!-- -->{play.currentTime}}&lt;/text&gt;
    &lt;view&gt;
      &lt;slider bindchange="sliderChange" activeColor="#d33a31" block-size="12" backgroundColor="#dadada" value="{<!-- -->{play.percent}}" /&gt;
    &lt;/view&gt;
    &lt;text&gt;{<!-- -->{play.duration}}&lt;/text&gt;
  &lt;/view&gt;
&lt;/view&gt;

</code></pre> 
<p><img src="https://images2.imgbox.com/9a/b2/aTTMZvQW_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/70/21/QIxWjclz_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="11_533"></a>1、播放器样式1</h3> 
<pre><code>.content-play {
  display: flex;
  justify-content: space-around;
  flex-direction: column;
  height: 100%;
  text-align: center;
}

.content-play-info &gt; view {
  color: #888;
  font-size: 11pt;
}
</code></pre> 
<p><img src="https://images2.imgbox.com/5f/28/khN9r62U_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2CSS3_551"></a>2、通过CSS3动画实现海报的旋转功能：</h3> 
<pre><code>  &lt;!-- 显示专辑封面 --&gt;
  &lt;view class="content-play-cover"&gt;
    &lt;image src="{<!-- -->{play.coverImgUrl}}" style="animation-play-state:{<!-- -->{state}}" /&gt;
  &lt;/view&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/ce/f0/ezF8OfsN_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3_561"></a>3、播放器页面下方的滑块结构：</h3> 
<pre><code>   &lt;slider bindchange="sliderChange" activeColor="#d33a31" block-size="12" backgroundColor="#dadada" value="{<!-- -->{play.percent}}" /&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/61/4c/uYKDx8Jn_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3_567"></a>3、显示音乐的播放进度：</h3> 
<pre><code>  onReady: function() {
    this.audioCtx = wx.createInnerAudioContext()
    // 默认选择第1曲
    this.setMusic(0)
    var that = this
    // 播放进度检测
    this.audioCtx.onError(function() {
      console.log('播放失败：' + that.audioCtx.src)
    })
    // 播放完成自动换下一曲
    this.audioCtx.onEnded(function() {
      that.next()
    })
</code></pre> 
<h3><a id="4_583"></a>4、控制进度条的长度控制歌曲播放进度：</h3> 
<pre><code>&lt; slider
bindchange= "sliderChange"
activeColor= " #d33a31 
block- size=”12"
backgroundColor= " #dadada"
value= "{<!-- -->{play.percent}}" /&gt;
</code></pre> 
<pre><code>sliderChange: function(e) {
var second = e.detail.value
*
this.audioCtx.duration / 100
this.audioCtx.seek(second)
},
</code></pre> 
<p>控制进度条的长度控制歌曲播放进度：</p> 
<pre><code>&lt;scroll-view class="content-playlist" scroll-y&gt;
  &lt;view class="playlist-item" wx:for="{<!-- -->{playlist}}" wx:key="id" bindtap="change" data-index="{<!-- -->{index}}"&gt;
    &lt;image class="playlist-cover" src="{<!-- -->{item.coverImgUrl}}" /&gt;
    &lt;view class="playlist-info"&gt;
      &lt;view class="playlist-info-title"&gt;{<!-- -->{item.title}}&lt;/view&gt;
      &lt;view class="playlist-info-singer"&gt;{<!-- -->{item.singer}}&lt;/view&gt;
    &lt;/view&gt;
    &lt;view class="playlist-controls"&gt;
      &lt;text wx:if="{<!-- -->{index==playIndex}}"&gt;正在播放&lt;/text&gt;
    &lt;/view&gt;
  &lt;/view&gt;
&lt;/scroll-view&gt;
</code></pre> 
<p><img src="https://images2.imgbox.com/9c/33/hZ8JFxT0_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_619"></a>七、播放列表</h2> 
<h3><a id="1_620"></a>1、控制进度条的长度控制歌曲播放进度：</h3> 
<pre><code>.playlist-item {
display: flex;
align-items:
center;
border- bottom: 1rpx solid #333;
height: 112rpx;
}
...
</code></pre> 
<p><img src="https://images2.imgbox.com/7c/f5/sCQw8fSZ_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_632"></a>2、实现换曲功能：</h3> 
<pre><code>change:function(e){
this.setMusic(e.currentTarget.dateset.index)
this.play()
},
</code></pre> 
<p><img src="https://images2.imgbox.com/63/43/O5wBGzeK_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/08/5d/Dqaaagq8_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2457c49a6476930b163e7396fee12704/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">hive伪分布式详细部署步骤及报错解决办法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a77de4dd0fa8df9c394223a46b379bfa/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Error cannot find module ‘custom-electron-titlebarmain‘</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>