<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python数据可视化的例子——条形图（bar） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python数据可视化的例子——条形图（bar）" />
<meta property="og:description" content="1．matplotlib模块 应用matplotlib模块绘制条形图，需要调用bar函数，关于该函数的语法和参数含义如下：
bar(x, height, width=0.8, bottom=None, color=None, edgecolor=None, linewidth=None, tick_label=None, xerr=None, yerr=None, label = None, ecolor=None, align, log=False, **kwargs) x：传递数值序列，指定条形图中x轴上的刻度值。height：传递数值序列，指定条形图y轴上的高度。width：指定条形图的宽度，默认为0.8。 bottom：用于绘制堆叠条形图。color：指定条形图的填充色。edgecolor：指定条形图的边框色。linewidth：指定条形图边框的宽度，如果指定为0，表示不绘制边框。tick_label：指定条形图的刻度标签。xerr：如果参数不为None，表示在条形图的基础上添加误差棒。yerr：参数含义同xerr。label：指定条形图的标签，一般用以添加图例。ecolor：指定条形图误差棒的颜色。align：指定x轴刻度标签的对齐方式，默认为center，表示刻度标签居中对齐，如果设置为edge，则表示在每个条形的左下角呈现刻度标签。log：bool类型参数，是否对坐标轴进行log变换，默认为False。**kwargs：关键字参数，用于对条形图进行其他设置，如透明度等。 bar函数的参数同样很多，希望读者能够认真地掌握每个参数的含义，以便使用时得心应手。下面将基于该函数绘制三类条形图，分别是单变量的垂直或水平条形图、堆叠条形图和水平交错条形图。
（1）垂直或水平条形图
首先来绘制单个离散变量的垂直或水平条形图，数据来源于互联网，反映的是2017年中国六大省份的GDP:
垂直条形图
# 绘图 x= 起始位置， bottom= 水平条的底部(左侧), y轴， height 水平条的宽度， width 水平条的长度 p1 = plt.bar(x=0, bottom=y, height=0.5, width=x, orientation=&#34;horizontal&#34;) 绘图代码如下：
import matplotlib.pyplot as plt import pandas as pd GDP_data = pd.read_excel(r&#39;GDP.xlsx&#39;) #设置绘图风格 plt.style.use(&#39;ggplot&#39;) #处理中文乱码 plt.rcParams[&#39;font.sans-serif&#39;] = [&#39;Microsoft YaHei&#39;] #绘制条形图 plt.bar(x = range(GDP_data.shape[0]), #指定条形图x轴的刻度值(有的是用left，有的要用x) height = GDP_data." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a270d9bd92a2c4d2bec88d10d1ca2f53/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-17T13:36:29+08:00" />
<meta property="article:modified_time" content="2020-08-17T13:36:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python数据可视化的例子——条形图（bar）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1matplotlib_0"></a>1．matplotlib模块</h3> 
<p>应用matplotlib模块绘制条形图，需要调用bar函数，关于该函数的语法和参数含义如下：</p> 
<pre><code class="prism language-python">bar<span class="token punctuation">(</span>x<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span> bottom<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
   linewidth<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> tick_label<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> xerr<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> yerr<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
   label <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> ecolor<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> align<span class="token punctuation">,</span> log<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
</code></pre> 
<ul><li>x：传递数值序列，指定条形图中x轴上的刻度值。</li><li>height：传递数值序列，指定条形图y轴上的高度。</li><li>width：指定条形图的宽度，默认为0.8。 bottom：用于绘制堆叠条形图。</li><li>color：指定条形图的填充色。</li><li>edgecolor：指定条形图的边框色。</li><li>linewidth：指定条形图边框的宽度，如果指定为0，表示不绘制边框。</li><li>tick_label：指定条形图的刻度标签。</li><li>xerr：如果参数不为None，表示在条形图的基础上添加误差棒。</li><li>yerr：参数含义同xerr。</li><li>label：指定条形图的标签，一般用以添加图例。</li><li>ecolor：指定条形图误差棒的颜色。</li><li>align：指定x轴刻度标签的对齐方式，默认为center，表示刻度标签居中对齐，如果设置为edge，则表示在每个条形的左下角呈现刻度标签。</li><li>log：bool类型参数，是否对坐标轴进行log变换，默认为False。</li><li>**kwargs：关键字参数，用于对条形图进行其他设置，如透明度等。</li></ul> 
<p>bar函数的参数同样很多，希望读者能够认真地掌握每个参数的含义，以便使用时得心应手。下面将基于该函数绘制三类条形图，分别是<strong>单变量的垂直或水平条形图</strong>、<strong>堆叠条形图</strong>和<strong>水平交错条形图</strong>。<br> <strong>（1）垂直或水平条形图</strong><br> 首先来绘制单个离散变量的垂直或水平条形图，数据来源于互联网，反映的是2017年中国六大省份的GDP:<br> <img src="https://images2.imgbox.com/63/bd/Mj09goRy_o.jpg" alt="在这里插入图片描述"><br> <strong>垂直条形图</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 绘图 x= 起始位置， bottom= 水平条的底部(左侧), y轴， height 水平条的宽度， width 水平条的长度</span>
p1 <span class="token operator">=</span> plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> bottom<span class="token operator">=</span>y<span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> width<span class="token operator">=</span>x<span class="token punctuation">,</span> orientation<span class="token operator">=</span><span class="token string">"horizontal"</span><span class="token punctuation">)</span>
</code></pre> 
<p>绘图代码如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
GDP_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>r<span class="token string">'GDP.xlsx'</span><span class="token punctuation">)</span> 
<span class="token comment">#设置绘图风格</span>
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'ggplot'</span><span class="token punctuation">)</span>
<span class="token comment">#处理中文乱码</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Microsoft YaHei'</span><span class="token punctuation">]</span>
<span class="token comment">#绘制条形图</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span>GDP_data<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图x轴的刻度值(有的是用left，有的要用x)</span>
        height <span class="token operator">=</span> GDP_data<span class="token punctuation">.</span>GDP<span class="token punctuation">,</span>  <span class="token comment">#指定条形图y轴的数值（python3.7不能用y，而应该用height）</span>
        tick_label <span class="token operator">=</span> GDP_data<span class="token punctuation">.</span>Province<span class="token punctuation">,</span>  <span class="token comment">#指定条形图x轴的刻度标签</span>
        color <span class="token operator">=</span> <span class="token string">'steelblue'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图的填充色</span>
        <span class="token punctuation">)</span>
<span class="token comment">#添加y轴的标签</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'GDP(万亿)'</span><span class="token punctuation">)</span>
<span class="token comment">#添加条形图的标题</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'2017年度6个省份GDP分布'</span><span class="token punctuation">)</span>
<span class="token comment">#为每个条形图添加数值标签</span>
<span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>GDP_data<span class="token punctuation">.</span>GDP<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token string">"%s"</span><span class="token operator">%</span><span class="token builtin">round</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>  <span class="token comment">#round(y,1)是将y值四舍五入到一个小数位</span>
<span class="token comment">#显示图形</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d6/2a/KhhfuapE_o.png" alt="在这里插入图片描述"><br> 如图6-5所示，该条形图比较清晰地反映了6个省份GDP的差异。针对如上代码需要做几点解释：</p> 
<ul><li>条形图中灰色网格的背景是通过代码plt.style.use(‘ggplot’)实现的，如果不添加该行代码，则条形图为白底背景。</li><li>如果添加图形的x轴或y轴标签，需要调用pyplot子模块中的xlab和ylab函数。</li><li>由于bar函数没有添加数值标签的参数，因此使用for循环对每一个柱体添加数值标签，使用的核心函数是pyplot子模块中的text。该函数的参数很简单，前两个参数用于定位字符在图形中的位置，第三个参数表示呈现的具体字符值，第四个参数为ha，表示字符的水平对齐方式为居中对齐。</li></ul> 
<p><strong>水平条形图</strong><br> 水平条形图不再是bar函数，而是barh函数。</p> 
<pre><code class="prism language-python"><span class="token comment"># 绘图 y= y轴， left= 水平条的底部， height 水平条的宽度， width 水平条的长度</span>
p1 <span class="token operator">=</span> plt<span class="token punctuation">.</span>barh<span class="token punctuation">(</span>y<span class="token punctuation">,</span> left<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> width<span class="token operator">=</span>x<span class="token punctuation">)</span>
</code></pre> 
<p>绘图代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
GDP_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>r<span class="token string">'GDP.xlsx'</span><span class="token punctuation">)</span>
<span class="token comment">#设置绘图风格</span>
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'ggplot'</span><span class="token punctuation">)</span>
<span class="token comment">#处理中文乱码</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Microsoft YaHei'</span><span class="token punctuation">]</span>
<span class="token comment">#对读入的数据做升序排序</span>
GDP_data<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'GDP'</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment">#绘制条形图</span>
plt<span class="token punctuation">.</span>barh<span class="token punctuation">(</span>y <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span>GDP_data<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图y轴的刻度值</span>
         width <span class="token operator">=</span> GDP_data<span class="token punctuation">.</span>GDP<span class="token punctuation">,</span>  <span class="token comment">#指定条形图x轴的数值</span>
         tick_label <span class="token operator">=</span> GDP_data<span class="token punctuation">.</span>Province<span class="token punctuation">,</span>  <span class="token comment">#指定条形图y轴的刻度标签</span>
         color <span class="token operator">=</span> <span class="token string">'lightblue'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图的填充色</span>
         <span class="token punctuation">)</span>
<span class="token comment">#添加x轴的标签</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'GDP(万亿)'</span><span class="token punctuation">)</span>
<span class="token comment">#添加条形图的标题</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'2017年度6个省份GDP分布'</span><span class="token punctuation">)</span>
<span class="token comment">#为每个条形图添加数值标签</span>
<span class="token keyword">for</span> y<span class="token punctuation">,</span>x <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>GDP_data<span class="token punctuation">.</span>GDP<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">"%s"</span><span class="token operator">%</span><span class="token builtin">round</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>va<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>  <span class="token comment">#round(y,1)是将y值四舍五入到一个小数位</span>
<span class="token comment">#显示图形</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6b/61/nuKT8eVJ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/07/f7/hAJUhfrB_o.jpg" alt="在这里插入图片描述"></p> 
<p><strong>（2）堆叠条形图</strong><br> 正如前文所介绍的，不管是垂直条形图还是水平条形图，都只是反映单个离散变量的统计图形，如果想通过条形图传递两个离散变量的信息该如何做到？相信读者一定见过堆叠条形图，该类型条形图的横坐标代表一个维度的离散变量，堆叠起来的“块”代表了另一个维度的离散变量。这样的条形图，最大的优点是可以方便比较累积和，那这种条形图该如何通过Python绘制呢？这里以2017年四个季度的产业值为例（数据来源于中国统计局）：<br> <img src="https://images2.imgbox.com/bf/90/FsKNGobB_o.jpg" alt="在这里插入图片描述"><br> 绘制堆叠条形图，详细代码如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
Industry_GDP <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>r<span class="token string">'2017年各季度三产业总值.xlsx'</span><span class="token punctuation">,</span>skiprows<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">#skiprows=1 :读取数据时，指定跳过的开始行数（这里我用它来跳过表头）</span>
<span class="token comment">#设置绘图风格</span>
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'ggplot'</span><span class="token punctuation">)</span>
<span class="token comment">#处理中文乱码</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Microsoft YaHei'</span><span class="token punctuation">]</span>
<span class="token comment">#取出四个不同的季度标签，用作堆叠条形图x轴的刻度标签</span>
Quarters <span class="token operator">=</span> Industry_GDP<span class="token punctuation">.</span>Quarter<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#unique()起去重的作用</span>
<span class="token comment">#取出第一产业的四季度值</span>
Industry1 <span class="token operator">=</span> Industry_GDP<span class="token punctuation">.</span>GDP<span class="token punctuation">[</span>Industry_GDP<span class="token punctuation">.</span>Industry_Type <span class="token operator">==</span> <span class="token string">'第一产业'</span><span class="token punctuation">]</span>
<span class="token comment">#重新设置行索引</span>
Industry1<span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Quarters<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#取出第二产业的四季度值</span>
Industry2 <span class="token operator">=</span> Industry_GDP<span class="token punctuation">.</span>GDP<span class="token punctuation">[</span>Industry_GDP<span class="token punctuation">.</span>Industry_Type <span class="token operator">==</span> <span class="token string">'第二产业'</span><span class="token punctuation">]</span>
<span class="token comment">#重新设置行索引</span>
Industry2<span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Quarters<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#取出第三产业的四季度值</span>
Industry3 <span class="token operator">=</span> Industry_GDP<span class="token punctuation">.</span>GDP<span class="token punctuation">[</span>Industry_GDP<span class="token punctuation">.</span>Industry_Type <span class="token operator">==</span> <span class="token string">'第三产业'</span><span class="token punctuation">]</span>
<span class="token comment">#重新设置行索引</span>
Industry3<span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Quarters<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#绘制堆叠条形图</span>
<span class="token comment">#各季度下第一产业的条形图</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Quarters<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图x轴的刻度值</span>
        height <span class="token operator">=</span> Industry1<span class="token punctuation">,</span>  <span class="token comment">#指定条形图y轴的数值</span>
        bottom <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token comment">#用于绘制堆叠条形图,图形起始高度</span>
        tick_label <span class="token operator">=</span> Quarters<span class="token punctuation">,</span>  <span class="token comment">#指定条形图y轴的刻度标签</span>
        color <span class="token operator">=</span> <span class="token string">'steelblue'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图的填充色</span>
        label <span class="token operator">=</span> <span class="token string">'第一产业'</span><span class="token punctuation">,</span>  <span class="token comment">#图形的标签</span>
        <span class="token punctuation">)</span>
<span class="token comment">#各季度下第二产业的条形图</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Quarters<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图x轴的刻度值</span>
        height <span class="token operator">=</span> Industry2<span class="token punctuation">,</span>  <span class="token comment">#指定条形图y轴的数值</span>
        bottom <span class="token operator">=</span> Industry1<span class="token punctuation">,</span>
        tick_label <span class="token operator">=</span> Quarters<span class="token punctuation">,</span>  <span class="token comment">#指定条形图y轴的刻度标签</span>
        color <span class="token operator">=</span> <span class="token string">'green'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图的填充色</span>
        label <span class="token operator">=</span> <span class="token string">'第二产业'</span><span class="token punctuation">,</span>  <span class="token comment">#图形的标签</span>
        <span class="token punctuation">)</span>
<span class="token comment">#各季度下第三产业的条形图</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Quarters<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图x轴的刻度值</span>
        height <span class="token operator">=</span> Industry3<span class="token punctuation">,</span>  <span class="token comment">#指定条形图y轴的数值</span>
        bottom <span class="token operator">=</span> Industry1<span class="token operator">+</span>Industry2<span class="token punctuation">,</span>
        tick_label <span class="token operator">=</span> Quarters<span class="token punctuation">,</span>  <span class="token comment">#指定条形图y轴的刻度标签</span>
        color <span class="token operator">=</span> <span class="token string">'red'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图的填充色</span>
        label <span class="token operator">=</span> <span class="token string">'第三产业'</span><span class="token punctuation">,</span>  <span class="token comment">#图形的标签</span>
        <span class="token punctuation">)</span>
<span class="token comment">#添加y轴的标签</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'GDP(亿)'</span><span class="token punctuation">)</span>
<span class="token comment">#添加图形标题</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'2017年各季度三产业总值'</span><span class="token punctuation">)</span>
<span class="token comment">#显示各产业的图例</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#显示图形</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/1f/2d/jHX78fVI_o.png" alt="在这里插入图片描述"><br> 如上就是一个典型的堆叠条形图，虽然绘图的代码有些偏长，但是其思想还是比较简单的，就是分别针对三种产业的产值绘制三次条形图。需要注意的是，第二产业的条形图是在第一产业的基础上做了叠加，故需要将bottom参数设置为Industry1；而第三产业的条形图又是叠加在第一和第二产业之上，所以需要将bottom参数设置为Industry1+ Industry2。<br> 读者可能疑惑，通过条件判断将三种产业的值（Industry1、Industry2、Industry3）分别取出来后，为什么还要重新设置行索引？那是因为各季度下每一种产业值前的行索引都不相同，这就导致无法进行Industry1+ Industry2的和计算（读者不妨试试不改变序列Industry1和Industry2的行索引的后果）。</p> 
<p><strong>（3）水平交错条形图</strong><br> 堆叠条形图可以包含两个离散变量的信息，而且可以比较各季度整体产值的高低水平，但是其缺点是不易区分“块”之间的差异，例如二、三季度的第三产业值差异就不是很明显，区分高低就相对困难。而交错条形图恰好就可以解决这个问题，该类型的条形图就是将堆叠的“块”水平排开，如想绘制这样的条形图，可以参考下方代码（数据来源于胡润财富榜，反映的是5个城市亿万资产超高净值家庭数）：<br> <img src="https://images2.imgbox.com/b3/f6/VWBvTi5S_o.jpg" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token comment"># 读入数据</span>
HuRun <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>r<span class="token string">'亿万资产家庭数.xlsx'</span><span class="token punctuation">)</span>
<span class="token comment">#设置绘图风格</span>
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'ggplot'</span><span class="token punctuation">)</span>
<span class="token comment">#处理中文乱码</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Microsoft YaHei'</span><span class="token punctuation">]</span>
<span class="token comment"># 取出城市名称</span>
Cities <span class="token operator">=</span> HuRun<span class="token punctuation">.</span>City<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 取出2016年各城市亿万资产家庭数</span>
Counts2016 <span class="token operator">=</span> HuRun<span class="token punctuation">.</span>Counts<span class="token punctuation">[</span>HuRun<span class="token punctuation">.</span>Year <span class="token operator">==</span> <span class="token number">2016</span><span class="token punctuation">]</span>
<span class="token comment"># 取出2017年各城市亿万资产家庭数</span>
Counts2017 <span class="token operator">=</span> HuRun<span class="token punctuation">.</span>Counts<span class="token punctuation">[</span>HuRun<span class="token punctuation">.</span>Year <span class="token operator">==</span> <span class="token number">2017</span><span class="token punctuation">]</span>
<span class="token comment"># 绘制水平交错条形图</span>
bar_width <span class="token operator">=</span> <span class="token number">0.4</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Cities<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> height <span class="token operator">=</span> Counts2016<span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'2016'</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">'steelblue'</span><span class="token punctuation">,</span> width <span class="token operator">=</span> bar_width<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Cities<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>bar_width<span class="token punctuation">,</span> height <span class="token operator">=</span> Counts2017<span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'2017'</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">'indianred'</span><span class="token punctuation">,</span> width <span class="token operator">=</span> bar_width<span class="token punctuation">)</span>
<span class="token comment"># 添加x轴刻度标签（向右偏移0.225）</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.2</span><span class="token punctuation">,</span> Cities<span class="token punctuation">)</span>
<span class="token comment"># 添加y轴标签</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'亿万资产家庭数'</span><span class="token punctuation">)</span>
<span class="token comment"># 添加图形标题</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'近两年5个城市亿万资产家庭数比较'</span><span class="token punctuation">)</span>
<span class="token comment"># 添加图例</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 显示图形</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c1/91/KYQjfhtv_o.png" alt="在这里插入图片描述"><br> 我们发现，这些图上面缺少数值标签，所以进行改进：</p> 
<pre><code class="prism language-python"><span class="token comment"># 条形图的绘制--水平交错条形图</span>
<span class="token comment"># 导入第三方模块</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token comment"># 读入数据</span>
HuRun <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>r<span class="token string">'亿万资产家庭数.xlsx'</span><span class="token punctuation">)</span>
<span class="token comment">#设置绘图风格</span>
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'ggplot'</span><span class="token punctuation">)</span>
<span class="token comment">#处理中文乱码</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Microsoft YaHei'</span><span class="token punctuation">]</span>
<span class="token comment"># 取出城市名称</span>
Cities <span class="token operator">=</span> HuRun<span class="token punctuation">.</span>City<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 取出2016年各城市亿万资产家庭数</span>
Counts2016 <span class="token operator">=</span> HuRun<span class="token punctuation">.</span>Counts<span class="token punctuation">[</span>HuRun<span class="token punctuation">.</span>Year <span class="token operator">==</span> <span class="token number">2016</span><span class="token punctuation">]</span>
<span class="token comment"># 取出2017年各城市亿万资产家庭数</span>
Counts2017 <span class="token operator">=</span> HuRun<span class="token punctuation">.</span>Counts<span class="token punctuation">[</span>HuRun<span class="token punctuation">.</span>Year <span class="token operator">==</span> <span class="token number">2017</span><span class="token punctuation">]</span>
<span class="token comment"># 绘制水平交错条形图</span>
bar_width <span class="token operator">=</span> <span class="token number">0.4</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Cities<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> height <span class="token operator">=</span> Counts2016<span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'2016'</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">'steelblue'</span><span class="token punctuation">,</span> width <span class="token operator">=</span> bar_width<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Cities<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>bar_width<span class="token punctuation">,</span> height <span class="token operator">=</span> Counts2017<span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">'2017'</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">'indianred'</span><span class="token punctuation">,</span> width <span class="token operator">=</span> bar_width<span class="token punctuation">)</span>
<span class="token comment"># 添加x轴刻度标签（向右偏移0.225）</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.2</span><span class="token punctuation">,</span> Cities<span class="token punctuation">)</span>
<span class="token comment"># 添加y轴标签</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'亿万资产家庭数'</span><span class="token punctuation">)</span>
<span class="token comment"># 添加图形标题</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'近两年5个城市亿万资产家庭数比较'</span><span class="token punctuation">)</span>
<span class="token comment">#为每个条形图添加数值标签</span>
<span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>Counts2016<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token operator">+</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">"%s"</span><span class="token operator">%</span><span class="token builtin">round</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>  <span class="token comment">#round(y,1)是将y值四舍五入到一个小数位</span>
<span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>Counts2017<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token operator">+</span>bar_width<span class="token punctuation">,</span>y<span class="token operator">+</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">"%s"</span><span class="token operator">%</span><span class="token builtin">round</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
<span class="token comment"># 添加图例</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 显示图形</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e9/46/Imb5Jxvb_o.png" alt="在这里插入图片描述"><br> 另外，再对如上的代码做三点解释，希望能够帮助读者解去疑惑：</p> 
<ul><li>如上的水平交错条形图，其实质就是使用两次bar函数，所不同的是，第二次bar函数使得条形图往右偏了0.4个单位（left=np.arange(len(Cities))+bar_width），进而形成水平交错条形图的效果。</li><li>每一个bar函数，都必须控制条形图的宽度（width=bar_width），否则会导致条形图的重叠。</li><li>如果利用bar函数的tick_label参数添加条形图x轴上的刻度标签，会发现标签并不是居中对齐在两个条形图之间，为了克服这个问题，使用了pyplot子模块中的xticks函数，并且使刻度标签的位置向右移0.2个单位。</li></ul> 
<h3><a id="2pandas_244"></a>2．pandas模块</h3> 
<p>通过pandas模块绘制条形图仍然使用plot方法，该“方法”的语法和参数含义在之前已经详细介绍过，但是plot方法存在一点瑕疵，那就是无法绘制堆叠条形图。下面通过该模块的plot方法绘制单个离散变量的垂直条形图或水平条形图以及两个离散变量的水平交错条形图。<br> <strong>（1）垂直或水平条形图</strong><br> 代码如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
GDP_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>r<span class="token string">'GDP.xlsx'</span><span class="token punctuation">)</span> 
<span class="token comment">#设置绘图风格</span>
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'ggplot'</span><span class="token punctuation">)</span>
<span class="token comment">#处理中文乱码</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Microsoft YaHei'</span><span class="token punctuation">]</span>
<span class="token comment"># 绘图</span>
GDP_data<span class="token punctuation">.</span>GDP<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind <span class="token operator">=</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> width <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">,</span> rot <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">'steelblue'</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">'2017年度6个省份GDP分布'</span><span class="token punctuation">)</span>
<span class="token comment"># 添加y轴标签</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'GDP（万亿）'</span><span class="token punctuation">)</span>
<span class="token comment"># 添加x轴刻度标签</span>
plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>GDP_data<span class="token punctuation">.</span>Province<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">#指定刻度标签的位置</span>
           GDP_data<span class="token punctuation">.</span>Province <span class="token comment"># 指出具体的刻度标签值</span>
          <span class="token punctuation">)</span>
<span class="token comment"># 为每个条形图添加数值标签</span>
<span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>GDP_data<span class="token punctuation">.</span>GDP<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token string">'%s'</span> <span class="token operator">%</span><span class="token builtin">round</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
<span class="token comment"># 显示图形</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2c/2d/t9m57w7C_o.png" alt="在这里插入图片描述"><br> 只要掌握matplotlib模块绘制单个离散变量的条形图方法，就可以套用到pandas模块中的plot方法，两者是相通的。</p> 
<p><strong>（2）水平交错条形图</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token comment"># 读入数据</span>
HuRun <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>r<span class="token string">'亿万资产家庭数.xlsx'</span><span class="token punctuation">)</span>
<span class="token comment">#设置绘图风格</span>
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'ggplot'</span><span class="token punctuation">)</span>
<span class="token comment">#处理中文乱码</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Microsoft YaHei'</span><span class="token punctuation">]</span>
<span class="token comment"># Pandas模块之水平交错条形图</span>
HuRun_reshape <span class="token operator">=</span> HuRun<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token string">'City'</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token string">'Year'</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token string">'Counts'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 对数据集降序排序</span>
HuRun_reshape<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by <span class="token operator">=</span> <span class="token number">2016</span><span class="token punctuation">,</span> ascending <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> inplace <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
HuRun_reshape<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">'City'</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2016</span><span class="token punctuation">,</span><span class="token number">2017</span><span class="token punctuation">]</span><span class="token punctuation">,</span> kind <span class="token operator">=</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'steelblue'</span><span class="token punctuation">,</span> <span class="token string">'indianred'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   rot <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment"># 用于旋转x轴刻度标签的角度，0表示水平显示刻度标签</span>
                   width <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">'近两年5个城市亿万资产家庭数比较'</span><span class="token punctuation">)</span>
<span class="token comment"># 取出2016年各城市亿万资产家庭数</span>
Counts2016 <span class="token operator">=</span> HuRun<span class="token punctuation">.</span>Counts<span class="token punctuation">[</span>HuRun<span class="token punctuation">.</span>Year <span class="token operator">==</span> <span class="token number">2016</span><span class="token punctuation">]</span>
<span class="token comment"># 取出2017年各城市亿万资产家庭数</span>
Counts2017 <span class="token operator">=</span> HuRun<span class="token punctuation">.</span>Counts<span class="token punctuation">[</span>HuRun<span class="token punctuation">.</span>Year <span class="token operator">==</span> <span class="token number">2017</span><span class="token punctuation">]</span>
<span class="token comment">#为每个条形图添加数值标签</span>
<span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>Counts2016<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">,</span>y<span class="token operator">+</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">"%s"</span><span class="token operator">%</span><span class="token builtin">round</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>  
<span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>Counts2017<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">0.2</span><span class="token punctuation">,</span>y<span class="token operator">+</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">"%s"</span><span class="token operator">%</span><span class="token builtin">round</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
<span class="token comment"># 添加y轴标签</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'亿万资产家庭数'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token comment">#plt.axis([-0.8,4.8,0,20000])  #用这个可以控制横纵坐标的值域</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>如上代码所示，应用plot方法绘制水平交错条形图，必须更改原始数据集的形状，即将两个离散型变量的水平值分别布置到行与列中（代码中采用透视表的方法实现），最终形成的表格变换下图所示：<br> <img src="https://images2.imgbox.com/07/34/WykUWqO8_o.jpg" alt="在这里插入图片描述"><br> 针对变换后的数据，可以使用plot方法实现水平交错条形图的绘制，从代码量来看，要比使用matplotlib模块简短一些，得到的条形图如下图所示：<br> <img src="https://images2.imgbox.com/78/11/Hjw4JiT1_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3seaborn_310"></a>3．seaborn模块绘制条形图</h3> 
<p>seaborn模块是一款专门用于绘制统计图形的利器，通过该模块写出来的代码也是非常通俗易懂的。下面就简单介绍一下如何通过该模块完成条形图的绘制（同样无法绘制堆叠条形图）。<br> <strong>（1）垂直或水平条形图</strong><br> <strong>垂直条形图：</strong><br> 代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment"># 读入数据</span>
GDP_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>r<span class="token string">'GDP.xlsx'</span><span class="token punctuation">)</span>
<span class="token comment">#设置绘图风格</span>
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'ggplot'</span><span class="token punctuation">)</span>
<span class="token comment">#处理中文乱码</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Microsoft YaHei'</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>  <span class="token comment">#坐标轴负号的处理</span>
<span class="token comment">#seaborn模块之水平条形图</span>
sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">'Province'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图x轴的数据</span>
            y <span class="token operator">=</span> <span class="token string">'GDP'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图y轴的数据</span>
            data <span class="token operator">=</span> GDP_data<span class="token punctuation">,</span>  <span class="token comment">#指定需要绘图的数据集</span>
            color <span class="token operator">=</span> <span class="token string">'steelblue'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图的填充色</span>
            orient <span class="token operator">=</span> <span class="token string">'v'</span><span class="token punctuation">,</span>  <span class="token comment">#将条形图竖直显示</span>
            <span class="token punctuation">)</span>
<span class="token comment">#为每个条形图添加数值标签</span>
<span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>GDP_data<span class="token punctuation">.</span>GDP<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token string">"%s"</span><span class="token operator">%</span><span class="token builtin">round</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
<span class="token comment"># 添加y轴标签</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'GDP(万亿)'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token comment">#添加条形图的标题</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'2017年度6个省份GDP分布'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">5.5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">#用这个可以控制横纵坐标的值域</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行结果：<br> <img src="https://images2.imgbox.com/d4/b7/lVIulPYW_o.png" alt="在这里插入图片描述"><br> <strong>水平条形图：</strong><br> 代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment"># 读入数据</span>
GDP_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>r<span class="token string">'GDP.xlsx'</span><span class="token punctuation">)</span>
<span class="token comment">#设置绘图风格</span>
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'ggplot'</span><span class="token punctuation">)</span>
<span class="token comment">#处理中文乱码</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Microsoft YaHei'</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>  <span class="token comment">#坐标轴负号的处理</span>
<span class="token comment">#seaborn模块之水平条形图</span>
sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">'GDP'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图x轴的数据</span>
            y <span class="token operator">=</span> <span class="token string">'Province'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图y轴的数据</span>
            data <span class="token operator">=</span> GDP_data<span class="token punctuation">,</span>  <span class="token comment">#指定需要绘图的数据集</span>
            color <span class="token operator">=</span> <span class="token string">'steelblue'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图的填充色</span>
            orient <span class="token operator">=</span> <span class="token string">'h'</span><span class="token punctuation">,</span>  <span class="token comment">#将条形图水平显示</span>
            <span class="token punctuation">)</span>
<span class="token comment">#为每个条形图添加数值标签</span>
<span class="token keyword">for</span> y<span class="token punctuation">,</span>x <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>GDP_data<span class="token punctuation">.</span>GDP<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">"%s"</span><span class="token operator">%</span><span class="token builtin">round</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>va<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
<span class="token comment"># 添加y轴标签</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'GDP(万亿)'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token comment">#添加条形图的标题</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'2017年度6个省份GDP分布'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">5.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">#用这个可以控制横纵坐标的值域</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行结果：<br> <img src="https://images2.imgbox.com/ae/49/J0pYwpkn_o.png" alt="在这里插入图片描述"><br> 如上代码就是通过seaborn模块中的barplot函数实现单个离散变量的条形图。<br> 除此之外，seaborn模块中的barplot函数还可以绘制<strong>两个离散变量</strong>的<strong>水平交错条形图</strong>，所以有必要介绍一下该函数**[barplot]**的用法及重要参数含义：</p> 
<pre><code class="prism language-python">sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> hue<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> hue_order<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
            ci<span class="token operator">=</span><span class="token number">95</span><span class="token punctuation">,</span> n_boot<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> orient<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> palette<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
            saturation<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">,</span> errcolor<span class="token operator">=</span><span class="token string">'.26'</span><span class="token punctuation">,</span> errwidth<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> dodge<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> ax<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
</code></pre> 
<ul><li>x：指定条形图的x轴数据。</li><li>y：指定条形图的y轴数据。</li><li>hue：指定用于分组的另一个离散变量。</li><li>data：指定用于绘图的数据集。</li><li>order：传递一个字符串列表，用于分类变量的排序。</li><li>hur_order：传递一个字符串列表，用于分类变量hue值的排序。</li><li>ci：用于绘制条形图的误差棒（置信区间）。</li><li>n_boot：当指定ci参数时，可以通过n_boot参数控制自助抽样的迭代次数。</li><li>orient：指定水平或垂直条形图。</li><li>color：指定所有条形图所属的一种填充色。</li><li>palette：指定hue变量中各水平的颜色。</li><li>saturation：指定颜色的透明度。</li><li>errcolor：指定误差棒的颜色。</li><li>errwidth：指定误差棒的线宽。</li><li>capsize：指定误差棒两端线条的长度。</li><li>dodge：bool类型参数，当使用hue参数时，是否绘制水平交错条形图，默认为True。</li><li>ax：用于控制子图的位置。</li><li>**kwagrs：关键字参数，可以调用plt.bar函数中的其他参数。</li></ul> 
<p><strong>先拿表格《近两年5个城市亿万资产家庭数比较》试试手</strong><br> 代码如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment"># 读入数据</span>
HuRun <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>r<span class="token string">'亿万资产家庭数.xlsx'</span><span class="token punctuation">)</span>
<span class="token comment">#设置绘图风格</span>
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'ggplot'</span><span class="token punctuation">)</span>
<span class="token comment">#处理中文乱码</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Microsoft YaHei'</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>  <span class="token comment">#坐标轴负号的处理</span>
<span class="token comment">#seaborn模块之水平条形图</span>
sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">'City'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图x轴的数据</span>
            y <span class="token operator">=</span> <span class="token string">'Counts'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图y轴的数据</span>
            hue <span class="token operator">=</span> <span class="token string">'Year'</span><span class="token punctuation">,</span>  <span class="token comment">#指定分组数据</span>
            data <span class="token operator">=</span> HuRun<span class="token punctuation">,</span>  <span class="token comment">#指定需要绘图的数据集</span>
            palette <span class="token operator">=</span> <span class="token string">'RdBu'</span><span class="token punctuation">,</span>  <span class="token comment">#指定分组数据即时间的不同颜色</span>
            saturation <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment">#指定颜色的透明度，这里设置为无透明度</span>
            orient <span class="token operator">=</span> <span class="token string">'v'</span><span class="token punctuation">,</span>  <span class="token comment">#将条形图竖直显示</span>
            <span class="token punctuation">)</span>
<span class="token comment"># 取出2016年各城市亿万资产家庭数</span>
Counts2016 <span class="token operator">=</span> HuRun<span class="token punctuation">.</span>Counts<span class="token punctuation">[</span>HuRun<span class="token punctuation">.</span>Year <span class="token operator">==</span> <span class="token number">2016</span><span class="token punctuation">]</span>
<span class="token comment"># 取出2017年各城市亿万资产家庭数</span>
Counts2017 <span class="token operator">=</span> HuRun<span class="token punctuation">.</span>Counts<span class="token punctuation">[</span>HuRun<span class="token punctuation">.</span>Year <span class="token operator">==</span> <span class="token number">2017</span><span class="token punctuation">]</span>
<span class="token comment">#为每个条形图添加数值标签</span>
<span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>Counts2016<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">0.2</span><span class="token punctuation">,</span>y<span class="token operator">+</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">"%s"</span><span class="token operator">%</span><span class="token builtin">round</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">#round(y,1)是将y值四舍五入到一个小数位</span>
<span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>Counts2017<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">0.2</span><span class="token punctuation">,</span>y<span class="token operator">+</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">"%s"</span><span class="token operator">%</span><span class="token builtin">round</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">#fontsize是调节字体大小的函数，默认数值是12</span>
<span class="token comment"># 添加y轴标签</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'亿万资产家庭数'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'城市'</span><span class="token punctuation">)</span>
<span class="token comment">#添加条形图的标题</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'近两年5个城市亿万资产家庭数比较'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">4.5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">19000</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">#用这个可以控制横纵坐标的值域</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>关于条形图颜色，<strong>palette</strong>函数，中文意思调色板，颜料。具体的讲解可见下面的链接：<br> <a href="https://blog.csdn.net/wuwan5296/article/details/78636347">Seaborn库 手册翻译（二）——颜色控制</a><br> <a href="https://blog.csdn.net/Artoria_QZH/article/details/102768817">超详细Seaborn绘图 ——（一）barplot</a><br> 运行上面的程序的结果：<br> <img src="https://images2.imgbox.com/47/36/5KPITPAS_o.png" alt="在这里插入图片描述"><br> palette的默认颜色为浅色，Rd是红色的缩写，Bu是蓝色的缩写<br> 当我<strong>注释</strong>掉palette后，运行结果如下：<br> <img src="https://images2.imgbox.com/8b/a4/7rfBdPLu_o.png" alt="在这里插入图片描述"></p> 
<p>拿一个新的数据表格做实验：<br> 下面的表格数据是泰坦尼克号的乘客数据，截屏了一部分。<br> <img src="https://images2.imgbox.com/c3/3a/JggTYHEq_o.jpg" alt="在这里插入图片描述"><br> 其中各字段含义为：</p> 
<ul><li>PassengerId ，乘客的id号，这个我觉得对生存率没影响。因为一个人的id号不会影响我是否生存下来吧。</li><li>Survived ,生存的标号，上面图的数值1表示这个人很幸运，生存了下来。数值0，则表示遗憾。</li><li>Pclass ,船舱等级，就是我们坐船有等级之分，像高铁，飞机都有。这个属性会对生产率有影响。因为一般有钱人，权贵才会住头等舱的。</li><li>Name ,名字。</li><li>Sex , 性别。</li><li>Age , 年龄。</li><li>SibSp ,兄弟姐妹，就是有些人和兄弟姐妹一起上船的。这个会有影响，因为有可能因为救他们而导致自己没有上救生船船。保留这列</li><li>Parch , 父母和小孩。就是有些人会带着父母小孩上船的。这个也可能因为要救父母小孩耽误上救生船。</li><li>Ticket , 票的编号。</li><li>Fare , 费用。这个和Pclass有相同的道理，有钱人和权贵比较有势力和影响力。</li><li>Cabin ,舱号。</li><li>Embarked ，上船的地方<br> 这里以泰坦尼克号数据集为例，绘制水平交错条形图，代码如下：</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment"># 读入数据</span>
Titanic <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>r<span class="token string">'泰坦尼克号乘客年龄分布.xlsx'</span><span class="token punctuation">)</span>
<span class="token comment">#由于年龄那一列有的人的数据存在缺失，这些缺失值是怎么处理的呢？一般是三种处理方法：不处理／丢弃／填充。</span>
<span class="token comment">#像Age这样的重要变量，有20%左右的缺失值，我们可以考虑用中位值来填补。-- 填补缺失值</span>
<span class="token comment">#这里就有两个索引，分别是舱位和性别，我们可以看到，随着舱位的下降，它的年龄也是在下降的。用我们的话理解就是，年轻人普遍比年长的穷啊，年龄大一点的人积累的财富也多一点。</span>
<span class="token comment">#分组计算不同舱位男女年龄的中位数，得到一个Series数据，索引为Pclass,Sex</span>
age_median <span class="token operator">=</span> Titanic<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Pclass'</span><span class="token punctuation">,</span><span class="token string">'Sex'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Age<span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#设置Pclass，Sex为索引，inplace=True表示在原数据Titanic上直接进行修改</span>
Titanic<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Pclass'</span><span class="token punctuation">,</span><span class="token string">'Sex'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment">#使用fillna填充缺失值，根据索引值填充</span>
Titanic<span class="token punctuation">.</span>Age<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>age_median<span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment">#横向最多显示多少个字符， 一般80不适合横向的屏幕，平时多用200</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.width'</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>
<span class="token comment">#显示所有列</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_columns'</span><span class="token punctuation">,</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token comment">#显示所有行</span>
pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">'display.max_rows'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token comment">#数据输出，查看Age列的统计值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Titanic<span class="token punctuation">.</span>head<span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">420</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">#不写n=多少的时候，head()函数默认是n=5</span>
<span class="token comment"># 读入数据</span>
Titanic <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>r<span class="token string">'泰坦尼克号乘客年龄分布.xlsx'</span><span class="token punctuation">)</span>
<span class="token comment">#设置绘图风格</span>
plt<span class="token punctuation">.</span>style<span class="token punctuation">.</span>use<span class="token punctuation">(</span><span class="token string">'ggplot'</span><span class="token punctuation">)</span>
<span class="token comment">#处理中文乱码</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Microsoft YaHei'</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>  <span class="token comment">#坐标轴负号的处理</span>
<span class="token comment">#seaborn模块之水平条形图</span>
sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token string">'Pclass'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图x轴的数据</span>
            y <span class="token operator">=</span> <span class="token string">'Age'</span><span class="token punctuation">,</span>  <span class="token comment">#指定条形图y轴的数据</span>
            hue <span class="token operator">=</span> <span class="token string">'Sex'</span><span class="token punctuation">,</span>  <span class="token comment">#指定分组数据</span>
            data <span class="token operator">=</span> Titanic<span class="token punctuation">,</span>  <span class="token comment">#指定需要绘图的数据集</span>
            palette <span class="token operator">=</span> <span class="token string">'RdBu'</span><span class="token punctuation">,</span>  <span class="token comment">#指定分组数据即性别的不同颜色</span>
            errcolor <span class="token operator">=</span> <span class="token string">'blue'</span><span class="token punctuation">,</span>  <span class="token comment">#指定误差棒的颜色</span>
            errwidth <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token comment">#指定误差棒的线宽</span>
            saturation <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment">#指定颜色的透明度，这里设置为无透明度</span>
            capsize <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">,</span>  <span class="token comment">#指定误差棒两端线条的宽度</span>
            orient <span class="token operator">=</span> <span class="token string">'v'</span><span class="token punctuation">,</span>  <span class="token comment">#将条形图竖直显示</span>
            <span class="token punctuation">)</span>
<span class="token comment"># seaborn.barplot()不用额外添加横纵坐标的标签</span>
<span class="token comment"># plt.ylabel('Age')</span>
<span class="token comment"># plt.xlabel('Pclass')</span>
<span class="token comment">#添加条形图的标题</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'各船舱等级中男女乘客的年龄差异'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>运行结果：</strong></p> 
<pre><code class="prism language-python">               PassengerID                                               Name    Age
Pclass Sex                                                                          
<span class="token number">3</span>      male              <span class="token number">1</span>                                   Kelly<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> James  <span class="token number">34.50</span>
       female            <span class="token number">2</span>                   Wilkes<span class="token punctuation">,</span> Mrs<span class="token punctuation">.</span> James <span class="token punctuation">(</span>Ellen Needs<span class="token punctuation">)</span>  <span class="token number">47.00</span>
<span class="token number">2</span>      male              <span class="token number">3</span>                          Myles<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Thomas Francis  <span class="token number">62.00</span>
<span class="token number">3</span>      male              <span class="token number">4</span>                                   Wirz<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Albert  <span class="token number">27.00</span>
       female            <span class="token number">5</span>       Hirvonen<span class="token punctuation">,</span> Mrs<span class="token punctuation">.</span> Alexander <span class="token punctuation">(</span>Helga E Lindqvist<span class="token punctuation">)</span>  <span class="token number">22.00</span>
       male              <span class="token number">6</span>                         Svensson<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Johan Cervin  <span class="token number">14.00</span>
       female            <span class="token number">7</span>                               Connolly<span class="token punctuation">,</span> Miss<span class="token punctuation">.</span> Kate  <span class="token number">30.00</span>
<span class="token number">2</span>      male              <span class="token number">8</span>                       Caldwell<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Albert Francis  <span class="token number">26.00</span>
<span class="token number">3</span>      female            <span class="token number">9</span>          Abrahim<span class="token punctuation">,</span> Mrs<span class="token punctuation">.</span> Joseph <span class="token punctuation">(</span>Sophie Halaut Easu<span class="token punctuation">)</span>  <span class="token number">18.00</span>
       male             <span class="token number">10</span>                            Davies<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> John Samuel  <span class="token number">21.00</span>
       male             <span class="token number">11</span>                                   Ilieff<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Ylio  <span class="token number">24.00</span>
<span class="token number">1</span>      male             <span class="token number">12</span>                         Jones<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Charles Cresson  <span class="token number">46.00</span>
       female           <span class="token number">13</span>      Snyder<span class="token punctuation">,</span> Mrs<span class="token punctuation">.</span> John Pillsbury <span class="token punctuation">(</span>Nelle Stevenson<span class="token punctuation">)</span>  <span class="token number">23.00</span>
<span class="token number">2</span>      male             <span class="token number">14</span>                               Howard<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Benjamin  <span class="token number">63.00</span>
<span class="token number">1</span>      female           <span class="token number">15</span>  Chaffee<span class="token punctuation">,</span> Mrs<span class="token punctuation">.</span> Herbert Fuller <span class="token punctuation">(</span>Carrie Constance<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  <span class="token number">47.00</span>
<span class="token number">2</span>      female           <span class="token number">16</span>      <span class="token keyword">del</span> Carlo<span class="token punctuation">,</span> Mrs<span class="token punctuation">.</span> Sebastiano <span class="token punctuation">(</span>Argenia Genovesi<span class="token punctuation">)</span>  <span class="token number">24.00</span>
       male             <span class="token number">17</span>                                  Keane<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Daniel  <span class="token number">35.00</span>
<span class="token number">3</span>      male             <span class="token number">18</span>                                  Assaf<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Gerios  <span class="token number">21.00</span>
       female           <span class="token number">19</span>                       Ilmakangas<span class="token punctuation">,</span> Miss<span class="token punctuation">.</span> Ida Livija  <span class="token number">27.00</span>
       female           <span class="token number">20</span>              Assaf Khalil<span class="token punctuation">,</span> Mrs<span class="token punctuation">.</span> Mariana <span class="token punctuation">(</span>Miriam<span class="token string">")"</span>  <span class="token number">45.00</span>
<span class="token comment">#....................................................................................(省略大部分数据)</span>
       male            <span class="token number">400</span>                           Conlon<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Thomas Henry  <span class="token number">31.00</span>
<span class="token number">1</span>      female          <span class="token number">401</span>                            Bonnell<span class="token punctuation">,</span> Miss<span class="token punctuation">.</span> Caroline  <span class="token number">30.00</span>
<span class="token number">2</span>      male            <span class="token number">402</span>                                    Gale<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Harry  <span class="token number">38.00</span>
<span class="token number">1</span>      female          <span class="token number">403</span>                     Gibson<span class="token punctuation">,</span> Miss<span class="token punctuation">.</span> Dorothy Winifred  <span class="token number">22.00</span>
       male            <span class="token number">404</span>                             Carrau<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Jose Pedro  <span class="token number">17.00</span>
       male            <span class="token number">405</span>                       Frauenthal<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Isaac Gerald  <span class="token number">43.00</span>
<span class="token number">2</span>      male            <span class="token number">406</span>       Nourney<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Alfred <span class="token punctuation">(</span>Baron von Drachstedt<span class="token string">")"</span>  <span class="token number">20.00</span>
       male            <span class="token number">407</span>                          Ware<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> William Jeffery  <span class="token number">23.00</span>
<span class="token number">1</span>      male            <span class="token number">408</span>                         Widener<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> George Dunton  <span class="token number">50.00</span>
<span class="token number">3</span>      female          <span class="token number">409</span>                    Riordan<span class="token punctuation">,</span> Miss<span class="token punctuation">.</span> Johanna Hannah<span class="token string">""</span>  <span class="token number">22.00</span>
       female          <span class="token number">410</span>                          Peacock<span class="token punctuation">,</span> Miss<span class="token punctuation">.</span> Treasteall   <span class="token number">3.00</span>
       female          <span class="token number">411</span>                             Naughton<span class="token punctuation">,</span> Miss<span class="token punctuation">.</span> Hannah  <span class="token number">22.00</span>
<span class="token number">1</span>      female          <span class="token number">412</span>    Minahan<span class="token punctuation">,</span> Mrs<span class="token punctuation">.</span> William Edward <span class="token punctuation">(</span>Lillian E Thorpe<span class="token punctuation">)</span>  <span class="token number">37.00</span>
<span class="token number">3</span>      female          <span class="token number">413</span>                     Henriksson<span class="token punctuation">,</span> Miss<span class="token punctuation">.</span> Jenny Lovisa  <span class="token number">28.00</span>
       male            <span class="token number">414</span>                                 Spector<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Woolf  <span class="token number">24.00</span>
<span class="token number">1</span>      female          <span class="token number">415</span>                       Oliva y Ocana<span class="token punctuation">,</span> Dona<span class="token punctuation">.</span> Fermina  <span class="token number">39.00</span>
<span class="token number">3</span>      male            <span class="token number">416</span>                       Saether<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Simon Sivertsen  <span class="token number">38.50</span>
       male            <span class="token number">417</span>                                Ware<span class="token punctuation">,</span> Mr<span class="token punctuation">.</span> Frederick  <span class="token number">24.00</span>
       male            <span class="token number">418</span>                           Peter<span class="token punctuation">,</span> Master<span class="token punctuation">.</span> Michael J  <span class="token number">24.00</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/db/92/wTPhYY6q_o.png" alt="在这里插入图片描述"><br> 如图上图所示，绘制的每一个条形图中都含有一条竖线，该竖线就是条形图的误差棒，即各组别下年龄的标准差大小。从上图可知，三等舱的男性乘客年龄是最为接近的，因为标准差最小。<br> 需要注意的是，数据集Titanic并非汇总好的数据，是不可以直接应用到matplotlib模块中的bar函数与pandas模块中的plot方法。如需使用，必须先对数据集进行分组聚合。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/706cf14767986b483f0234eb935d7498/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">DedeCMS最新文章、相关文章、推荐文章、热点文章、头条</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d513561f5b910f416e8b3beff6a89bf0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[Python人工智能] 二十三.基于机器学习和TFIDF的情感分类（含详细的NLP数据清洗）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>