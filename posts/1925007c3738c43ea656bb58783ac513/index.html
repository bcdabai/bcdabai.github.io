<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【可视化工具操作数据库，MySQL基础】 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【可视化工具操作数据库，MySQL基础】" />
<meta property="og:description" content="一、如何使用终端操作数据库 点击查看
二、如何使用可视化工具操作数据库 1、可视化数据库操作工具： NavicatSQLyog 新建数据库时：
表名：自拟
引擎选：InnoDB
字符集选：utf8
排序规则选：utf8_general_ci
2、数据库的字段属性（重点） unsigned：
无符号的整数声明了该列不能声明为负数 zerofill：
0填充不足的位数，使用0来填充，int(3): 5—005 自增：
通常理解为自增，自动在上一条记录的基础上&#43;1（默认）通常用来设计唯一的主键 index，必须时整数类型可以自定义设计主键自增的起始值和步长 ==非空：==not null
假设设置为not null，如果不给他赋值，就会报错！NULL，如果不填写，默认就是null 默认：
设置默认的值gender，默认值为 男，如果不指定该列的值，则会有默认值！ 拓展：
/*每个表，都必须存在以下五个字段！表示一个记录存在意义！ id	主键 &#39;version&#39;	乐观锁 is_delete	伪删除 gmt_creat	创建时间 gmt_update	修改时间 */ 可视化工具中使用命令行建表：
-- 创建表格注意点：使用英文()，表的名称 和 字段 尽量使用&#39;&#39; 括起来 -- 字符串使用单引号括起来！ -- 所有的语句后面加 ,(英文符号) 最后一个字段不用加 -- PRIMARY KEY 主键，一般一个表只有一个唯一的主键 CREATE TABLE IF NOT EXISTS &#39;student&#39;( &#39;id&#39; INT(4) NOT NULL AUTO_INCREMENT COMMENT &#39;学号&#39;, &#39;name&#39; VARCHAR(25) NOT NULL DEFAULT &#39;匿名&#39; COMMENT &#39;姓名&#39; )ENGINE=InnoDB DEFAULT CHARSET=utf8; 格式：[ ]内表示可选" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1925007c3738c43ea656bb58783ac513/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-29T20:46:37+08:00" />
<meta property="article:modified_time" content="2022-08-29T20:46:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【可视化工具操作数据库，MySQL基础】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>一、如何使用终端操作数据库</h3> 
<p><a href="https://blog.csdn.net/weixin_45483322/article/details/125602004?spm=1001.2014.3001.5501">点击查看</a></p> 
<h3><a id="_2"></a>二、如何使用可视化工具操作数据库</h3> 
<h4><a id="1_4"></a>1、<strong>可视化数据库操作工具：</strong></h4> 
<ul><li>Navicat</li><li>SQLyog</li></ul> 
<p>新建数据库时：</p> 
<ul><li> <p>表名：自拟</p> </li><li> <p>引擎选：InnoDB</p> </li><li> <p>字符集选：utf8</p> </li><li> <p>排序规则选：utf8_general_ci</p> </li></ul> 
<h4><a id="2_18"></a>2、数据库的字段属性（重点）</h4> 
<p><mark>unsigned：</mark></p> 
<ul><li>无符号的整数</li><li>声明了该列不能声明为负数</li></ul> 
<p><mark>zerofill：</mark></p> 
<ul><li>0填充</li><li>不足的位数，使用0来填充，int(3): 5—005</li></ul> 
<p><mark>自增：</mark></p> 
<ul><li>通常理解为自增，自动在上一条记录的基础上+1（默认）</li><li>通常用来设计唯一的主键 index，必须时整数类型</li><li>可以自定义设计主键自增的起始值和步长</li></ul> 
<p>==非空：==not null</p> 
<ul><li>假设设置为not null，如果不给他赋值，就会报错！</li><li>NULL，如果不填写，默认就是null</li></ul> 
<p><mark>默认：</mark></p> 
<ul><li>设置默认的值</li><li>gender，默认值为 男，如果不指定该列的值，则会有默认值！</li></ul> 
<p>拓展：</p> 
<pre><code class="prism language-sql"><span class="token comment">/*每个表，都必须存在以下五个字段！表示一个记录存在意义！
id			主键
'version'	乐观锁
is_delete	伪删除
gmt_creat	创建时间
gmt_update	修改时间
*/</span>

</code></pre> 
<p><strong>可视化工具中使用命令行建表：</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 创建表格注意点：使用英文()，表的名称 和 字段 尽量使用'' 括起来</span>
<span class="token comment">-- 字符串使用单引号括起来！</span>
<span class="token comment">-- 所有的语句后面加 ,(英文符号) 最后一个字段不用加</span>
<span class="token comment">-- PRIMARY KEY 主键，一般一个表只有一个唯一的主键</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token string">'student'</span><span class="token punctuation">(</span>
	<span class="token string">'id'</span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'学号'</span><span class="token punctuation">,</span>
    <span class="token string">'name'</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'匿名'</span> <span class="token keyword">COMMENT</span> <span class="token string">'姓名'</span>
    
<span class="token punctuation">)</span><span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
</code></pre> 
<p><strong>格式：[ ]内表示可选</strong></p> 
<pre><code class="prism language-sql">CREAT <span class="token keyword">TABLE</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> <span class="token string">'表明'</span><span class="token punctuation">(</span>
	<span class="token string">'字段名'</span> 列类型 <span class="token punctuation">[</span>属性<span class="token punctuation">]</span> <span class="token punctuation">[</span>索引<span class="token punctuation">]</span> <span class="token punctuation">[</span>注释<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'字段名'</span> 列类型 <span class="token punctuation">[</span>属性<span class="token punctuation">]</span> <span class="token punctuation">[</span>索引<span class="token punctuation">]</span> <span class="token punctuation">[</span>注释<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'字段名'</span> 列类型 <span class="token punctuation">[</span>属性<span class="token punctuation">]</span> <span class="token punctuation">[</span>索引<span class="token punctuation">]</span> <span class="token punctuation">[</span>注释<span class="token punctuation">]</span><span class="token punctuation">,</span>
    ······
    <span class="token string">'字段名'</span> 列类型 <span class="token punctuation">[</span>属性<span class="token punctuation">]</span> <span class="token punctuation">[</span>索引<span class="token punctuation">]</span> <span class="token punctuation">[</span>注释<span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">[</span>表类型<span class="token punctuation">]</span> <span class="token punctuation">[</span>字符集设置<span class="token punctuation">]</span> <span class="token punctuation">[</span>注释<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>可视化工具中查看SQL语句：</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> school <span class="token comment">-- 查看创建数据库的语句</span>
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> student <span class="token comment">-- 查看student数据表的定义语句</span>
<span class="token keyword">DESC</span> student <span class="token comment">-- 显示表的结构</span>
</code></pre> 
<p><strong>关于数据库引擎（数据表的类型）：</strong></p> 
<ul><li>INNODB：默认使用</li><li>MYISAM：早些年使用的</li></ul> 
<table><thead><tr><th></th><th>MYISAM</th><th>INNODB</th></tr></thead><tbody><tr><td>事务支持</td><td>不支持</td><td>支持</td></tr><tr><td>数据行锁定</td><td>不支持</td><td>支持</td></tr><tr><td>外键约束</td><td>不支持</td><td>支持</td></tr><tr><td>全文索引</td><td>支持</td><td>不支持</td></tr><tr><td>表空间的大小</td><td>较小</td><td>较大，约为M的2倍</td></tr></tbody></table> 
<p>常规使用操作：</p> 
<ul><li>MYISAM 节约空间，速度较快</li><li>INNODB 安全性高，事务的处理，多表多用户操作</li></ul> 
<blockquote> 
 <p>在物理空间存在的位置：</p> 
</blockquote> 
<ul><li>所有的数据库文件都存在data目录下，本质还是文件的存储！</li></ul> 
<p>MySQL引擎在物理文件上的区别：</p> 
<ul><li>INNODB 在数据库表中只有一个*.frm文件，以及上级目录下的ibdata1文件</li><li>MYISAM对应文件 
  <ul><li>*.frm 表结构的定义文件</li><li>*.MYD 数据文件(data)</li><li>*.MYI 索引文件(index)</li></ul> </li></ul> 
<blockquote> 
 <p>设置数据表的字符集编码</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8
</code></pre> 
<p>不设置的话，会是mysql默认的字符集编码~（不支持中文！）</p> 
<p>MySQL的默认编码是Latin1，不支持中文</p> 
<p>在my.ini中配置默认的编码</p> 
<pre><code class="prism language-ini">character-set-server=utf8
</code></pre> 
<h4><a id="3DML_141"></a>3、DML语言</h4> 
<ul><li>添加</li></ul> 
<blockquote> 
 <p>语法：<code>insert into 表名([字段名1,字段名2,...])values('值1','值2',...)[,('值1','值2',...)...];</code></p> 
 <p>注意事项：</p> 
 <ol><li>字段和字段之间使用英文逗号隔开</li><li>字段是可以省略的，但是后面的值必须要一一对应</li><li>同时可以插入多条数据，values后面的值需要使用逗号隔开即可：<code>values(),()...</code></li></ol> 
</blockquote> 
<ul><li>修改</li></ul> 
<blockquote> 
 <p>语法：<code>update 表名 set 'colnum_name' ='value' [,'colnum_name1' ='value1'...] where[条件]</code></p> 
 <p><strong>条件：where子句 运算符</strong></p> 
 <p>注意事项：</p> 
 <ol><li>colnum_name 是数据库的列，尽量带上’ ’</li><li>条件，筛选的条件，如果没有指定，则会修改所有的列</li><li>value，是一个具体的值，也可以是一个变量</li><li>多个设置的属性之间，使用英文逗号隔开</li></ol> 
</blockquote> 
<table><thead><tr><th>操作符</th><th>含义</th><th>范围</th><th>结果</th></tr></thead><tbody><tr><td>=</td><td>等于</td><td>1=2</td><td>false</td></tr><tr><td>&lt;&gt; 或 !=</td><td>不等于</td><td>1&lt;&gt;2</td><td>true</td></tr><tr><td>&gt; &gt;=</td><td>大于 大于等于</td><td></td><td></td></tr><tr><td>&lt; &lt;=</td><td>小于 小于等于</td><td></td><td></td></tr><tr><td>between …and…</td><td>在某个范围内</td><td>[1,2]</td><td></td></tr><tr><td>and &amp;&amp;</td><td>我和你</td><td>5&gt;1 and 1&gt;2</td><td>false</td></tr><tr><td>or ||</td><td>我或你</td><td>5&gt;1 or 1&gt;2</td><td>true</td></tr><tr><td>not ！</td><td>非</td><td>not a</td><td>取反</td></tr></tbody></table> 
<ul><li>删除</li></ul> 
<blockquote> 
 <p>语法：<code>delete from 表名[where 条件] </code></p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token comment">-- 删除数据 （避免这样写，会全部删除）</span>
<span class="token keyword">delete</span> <span class="token keyword">from</span> <span class="token string">'student'</span>

<span class="token comment">-- 删除指定数据</span>
<span class="token keyword">delete</span> <span class="token keyword">from</span> <span class="token string">'student'</span> <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

</code></pre> 
<blockquote> 
 <p>truncate命令</p> 
 <p>用法：<code>truncate 'student' -- 清空student表</code></p> 
 <p>作用：完全清空一个数据库表，表的结构和索引约束不会变！</p> 
 <p>delete与truncate 区别：</p> 
 <ul><li>相同点：都能删除数据，都不会删除表结构</li><li>不同点： 
   <ul><li>truncate：重新设置，自增列 计数器会归零</li><li>truncate：不会影响事务</li></ul> </li></ul> 
</blockquote> 
<p>了解：delete删除的问题，重启数据库</p> 
<ul><li>InnoDB：自增列会从1开始（存在内存当中的，断电即失）</li><li>MyISAM：继续从上一个自增量开始（存在文件中的，不会丢失）</li></ul> 
<h4><a id="4DQL_208"></a>4、DQL查询数据（重点）</h4> 
<p>data query language</p> 
<ul><li>所有的查询操作都用它 select</li><li>简单、复杂的查询都能做</li><li>数据库中最核心的语言，最重要的语句</li><li>使用频率最高的语句</li></ul> 
<blockquote> 
 <p>SELECT 语法</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/9e/8b/CBbZyJQP_o.png" alt="在这里插入图片描述"></p> 
<p>注意：[ ]括号代表可选的，{ } 括号代表必选的</p> 
<h5><a id="_224"></a>指定查询字段</h5> 
<blockquote> 
 <p><strong>语法：<code>select 字段 ... from 表</code></strong></p> 
 <pre><code class="prism language-sql"><span class="token comment">-- 查询全部的学生</span>
<span class="token keyword">select</span> <span class="token operator">*</span><span class="token keyword">from</span> student 
<span class="token comment">-- 查询指定字段</span>
<span class="token keyword">select</span> <span class="token string">'StudentNo'</span><span class="token punctuation">,</span><span class="token string">'StudentName'</span> <span class="token keyword">from</span> student
<span class="token comment">--别名</span>
<span class="token keyword">select</span> <span class="token string">'StudentNo'</span> <span class="token keyword">as</span> 学号<span class="token punctuation">,</span><span class="token string">'StudentName'</span> <span class="token keyword">as</span> 学生姓名 <span class="token keyword">from</span> student <span class="token keyword">as</span> s
</code></pre> 
 <p><strong>别名</strong>，给结果起一个名字<strong>as</strong> ,可以给字段起别名，也可以给表起别名</p> 
 <p><strong>函数concat(a,b) 连接a和b</strong></p> 
 <p><code>select concat('姓名：', StudentName) as 新名字 from student</code></p> 
</blockquote> 
<ul><li><strong>去重 distinct</strong></li></ul> 
<p><code>select distinct 'StudentNo' from result </code></p> 
<p>作用：去除select语句查询出来的结果中重复的数据，重复的只显示一条。</p> 
<ul><li>查询系统版本（函数）</li></ul> 
<p><code>select version()</code></p> 
<ul><li>计算结果（表达式）</li></ul> 
<p><code>select 100*2-1 as 计算结果</code></p> 
<p>eg: <code>select 'StudentNo','StudentResult' +1 as '提分后' from result</code></p> 
<ul><li>查询自增的步长（变量）</li></ul> 
<p><code>select @@auto_increment_increment</code></p> 
<blockquote> 
 <p><strong>数据库中的表达式：文本值，列，Null，函数，计算表达式，系统变量···</strong></p> 
 <p>用法：<code>select 表达式 from 表</code></p> 
</blockquote> 
<h5><a id="_275"></a>模糊查询：比较运算符</h5> 
<table><thead><tr><th>运算符</th><th>语法</th><th>描述</th></tr></thead><tbody><tr><td>is null</td><td>a is null</td><td>如果操作符为NULL，结果为真</td></tr><tr><td>is not null</td><td>a is not null</td><td>如果操作符不为null，结果为真</td></tr><tr><td>between</td><td>a between b and c</td><td>若a在b和c之间，则结果为真</td></tr><tr><td><strong>like</strong></td><td>a like b</td><td>SQL匹配，若a匹配b，则结果为真</td></tr><tr><td><strong>in</strong></td><td>a in(a1,a2,a3…)</td><td>假设a在a1,a2…其中的某一个之中，结果为真</td></tr><tr><td></td><td></td><td></td></tr></tbody></table> 
<pre><code class="prism language-sql"><span class="token comment">-- 模糊查询</span>
<span class="token comment">-- *********like**************</span>
<span class="token comment">-- like结合 %（代表0到任意个字符）	_（代表一个字符）</span>
<span class="token comment">-- 查询姓刘的同学</span>
<span class="token keyword">select</span> <span class="token string">'StudentNo'</span><span class="token punctuation">,</span><span class="token string">'StudentName'</span> <span class="token keyword">from</span> <span class="token string">'student'</span> <span class="token keyword">where</span> StudentName <span class="token operator">like</span> <span class="token string">'刘%'</span>

<span class="token comment">-- 查询姓刘的同学,名字后面只有一个字的</span>
<span class="token keyword">select</span> <span class="token string">'StudentNo'</span><span class="token punctuation">,</span><span class="token string">'StudentName'</span> <span class="token keyword">from</span> <span class="token string">'student'</span> <span class="token keyword">where</span> StudentName <span class="token operator">like</span> <span class="token string">'刘_'</span>

<span class="token comment">-- 查询姓刘的同学,名字后面只有两个字的</span>
<span class="token keyword">select</span> <span class="token string">'StudentNo'</span><span class="token punctuation">,</span><span class="token string">'StudentName'</span> <span class="token keyword">from</span> <span class="token string">'student'</span> <span class="token keyword">where</span> StudentName <span class="token operator">like</span> <span class="token string">'刘__'</span>

<span class="token comment">-- 查询名字中间有嘉的同学</span>
<span class="token keyword">select</span> <span class="token string">'StudentNo'</span><span class="token punctuation">,</span><span class="token string">'StudentName'</span> <span class="token keyword">from</span> <span class="token string">'student'</span> <span class="token keyword">where</span> StudentName <span class="token operator">like</span> <span class="token string">'%嘉%'</span>

<span class="token comment">-- *********in(具体的一个或多个值)**************</span>
<span class="token comment">-- 查询1001，1002，1003号学员</span>
<span class="token keyword">select</span> <span class="token string">'StudentNo'</span><span class="token punctuation">,</span><span class="token string">'StudentName'</span> <span class="token keyword">from</span> <span class="token string">'student'</span> <span class="token keyword">where</span> StudentNo <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token number">1002</span><span class="token punctuation">,</span><span class="token number">1003</span><span class="token punctuation">)</span>

<span class="token comment">-- *********null  not null**************</span>
<span class="token comment">-- 查询地址为空的学生</span>
<span class="token keyword">select</span> <span class="token string">'StudentNo'</span><span class="token punctuation">,</span><span class="token string">'StudentName'</span> <span class="token keyword">from</span> <span class="token string">'student'</span> <span class="token keyword">where</span> address<span class="token operator">=</span><span class="token string">''</span> <span class="token operator">or</span> address <span class="token operator">is</span> <span class="token boolean">null</span>
<span class="token comment">-- 查询地址不为空的学生</span>
<span class="token keyword">select</span> <span class="token string">'StudentNo'</span><span class="token punctuation">,</span><span class="token string">'StudentName'</span> <span class="token keyword">from</span> <span class="token string">'student'</span> <span class="token keyword">where</span> address<span class="token operator">=</span><span class="token string">''</span> <span class="token operator">or</span> address <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
</code></pre> 
<h5><a id="JOIN_315"></a>联表查询（JOIN）</h5> 
<p>left join right join inner join</p> 
<blockquote> 
 <p>JOIN对比</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/7d/82/FGsYrK1e_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 联表查询</span>
<span class="token comment">-- 查询参加了考试的学生（学号，姓名，科目编号，分数）</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student
selsct <span class="token operator">*</span> <span class="token keyword">from</span> result
<span class="token comment">/* 思路
1. 分析需求，分析查询的字段来自那些表，（连接查询）
2. 确定使用哪种连接查询？ 7种
确定交叉点（两个表中哪个数据是相同的）
判断的条件：学生表中的 studentNo = 成绩表中的studentNo
*/</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>studentNo<span class="token punctuation">,</span>studentName<span class="token punctuation">,</span>subjectNo<span class="token punctuation">,</span>studentResult 
<span class="token keyword">from</span> student <span class="token keyword">as</span> s
<span class="token keyword">inner</span> <span class="token keyword">join</span> result <span class="token keyword">as</span> r
<span class="token keyword">where</span> s<span class="token punctuation">.</span>studentNo <span class="token operator">=</span> r<span class="token punctuation">.</span>studentNo

<span class="token comment">--right join</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>studentNo<span class="token punctuation">,</span>studentName<span class="token punctuation">,</span>subjectNo<span class="token punctuation">,</span>studentResult 
<span class="token keyword">from</span> student s
<span class="token keyword">right</span> <span class="token keyword">join</span> result r
<span class="token keyword">on</span> s<span class="token punctuation">.</span>studentNo <span class="token operator">=</span> r<span class="token punctuation">.</span>studentNo

<span class="token comment">--left join</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>studentNo<span class="token punctuation">,</span>studentName<span class="token punctuation">,</span>subjectNo<span class="token punctuation">,</span>studentResult 
<span class="token keyword">from</span> student s
<span class="token keyword">left</span> <span class="token keyword">join</span> result r
<span class="token keyword">on</span> s<span class="token punctuation">.</span>studentNo <span class="token operator">=</span> r<span class="token punctuation">.</span>studentNo

<span class="token comment">-- 查询缺考的同学</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>studentNo<span class="token punctuation">,</span>studentName<span class="token punctuation">,</span>subjectNo<span class="token punctuation">,</span>studentResult 
<span class="token keyword">from</span> student s
<span class="token keyword">left</span> <span class="token keyword">join</span> result r
<span class="token keyword">on</span> s<span class="token punctuation">.</span>studentNo <span class="token operator">=</span> r<span class="token punctuation">.</span>studentNo
<span class="token keyword">where</span> studentResult <span class="token operator">is</span> <span class="token boolean">NULL</span>
</code></pre> 
<p><strong>right join与left join的区别：</strong></p> 
<table><thead><tr><th>操作</th><th>描述</th></tr></thead><tbody><tr><td>inner join</td><td>如果表中至少有一个匹配，就返回行</td></tr><tr><td>right join</td><td>会从右表中返回所有的值，即使左表中没有匹配</td></tr><tr><td>left join</td><td>会从左表中返回所有的值，即使右表中没有匹配</td></tr></tbody></table> 
<p><mark>join（连接的表） on （判断条件）连接查询</mark></p> 
<p><mark>where 等值查询</mark></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 三表联查 student，result，subject</span>
<span class="token comment">-- 学号，姓名，科目名，分数</span>
<span class="token keyword">select</span> studentNo<span class="token punctuation">,</span>studentName<span class="token punctuation">,</span>SubjectName<span class="token punctuation">,</span>StudentResult
<span class="token keyword">from</span> student s
<span class="token keyword">right</span> <span class="token keyword">join</span> result r 
<span class="token keyword">on</span> r<span class="token punctuation">.</span>studentNo <span class="token operator">=</span> s<span class="token punctuation">.</span>studentNo
<span class="token keyword">inner</span> <span class="token keyword">join</span> subject sub
<span class="token keyword">on</span> r<span class="token punctuation">.</span>SubjectNo <span class="token operator">=</span> sub<span class="token punctuation">.</span>SubjectNo

<span class="token comment">-- 要查询哪些数据 select ···</span>
<span class="token comment">-- 从哪几个表中查 from 表 XXX join 连接的表 on 交叉条件</span>
<span class="token comment">-- 假设存在一种多张表查询，先查询两张表然后再增加</span>

</code></pre> 
<h5><a id="_390"></a>自连接（了解）</h5> 
<blockquote> 
 <p>自己的表和自己的表连接，核心：<mark>一张表拆成两张一样的表即可</mark></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/37/60/SxxzLlmn_o.png" alt="在这里插入图片描述"></p> 
<p>父类</p> 
<table><thead><tr><th>categoryid</th><th>categoryName</th></tr></thead><tbody><tr><td>2</td><td>信息技术</td></tr><tr><td>3</td><td>软件开发</td></tr><tr><td>5</td><td>美术设计</td></tr></tbody></table> 
<p>子类</p> 
<table><thead><tr><th>pid</th><th>categoryid</th><th>categoryName</th></tr></thead><tbody><tr><td>3</td><td>4</td><td>数据库</td></tr><tr><td>2</td><td>8</td><td>办公信息</td></tr><tr><td>3</td><td>6</td><td>web开发</td></tr><tr><td>5</td><td>7</td><td>ps技术</td></tr></tbody></table> 
<p>操作：查询父类对应的子类关系</p> 
<table><thead><tr><th>父类</th><th>子类</th></tr></thead><tbody><tr><td>信息技术</td><td>办公信息</td></tr><tr><td>软件开发</td><td>数据库</td></tr><tr><td>软件开发</td><td>web开发</td></tr><tr><td>美术设计</td><td>ps技术</td></tr></tbody></table> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询父子信息</span>
<span class="token keyword">select</span> a<span class="token punctuation">.</span>categoryName <span class="token keyword">as</span> <span class="token string">'父栏目'</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span>categoryName <span class="token keyword">as</span> <span class="token string">'子栏目'</span>
<span class="token keyword">from</span> category <span class="token keyword">as</span> a<span class="token punctuation">,</span>category <span class="token keyword">as</span> b
<span class="token keyword">where</span> a<span class="token punctuation">.</span>categoryid <span class="token operator">=</span> b<span class="token punctuation">.</span>pid
</code></pre> 
<p><img src="https://images2.imgbox.com/e1/ea/ajwp4p0s_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_432"></a>子查询</h5> 
<p>where(这个值是计算出来的)</p> 
<p><mark>本质：再where语句中嵌套一个子查询语句</mark></p> 
<p>where(select * from)</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 1、查询 数据库结构-1 的所有考试结果，降序排序</span>
<span class="token comment">-- 方式一：使用联表查询</span>
<span class="token keyword">select</span> studentName<span class="token punctuation">,</span>r<span class="token punctuation">.</span>subjectNo<span class="token punctuation">,</span>studentResult 
<span class="token keyword">from</span> result r
<span class="token keyword">inner</span> <span class="token keyword">join</span> subject sub
<span class="token keyword">on</span> r<span class="token punctuation">.</span>subjectNo <span class="token operator">=</span> sub<span class="token punctuation">.</span>subjectNo
<span class="token keyword">where</span> SubjectName <span class="token operator">=</span> <span class="token string">'数据库结构-1'</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> studentResult <span class="token keyword">DESC</span>
<span class="token comment">-- 方式二：使用子查询</span>
<span class="token keyword">select</span> studentName<span class="token punctuation">,</span>subjectNo<span class="token punctuation">,</span>studentResult 
<span class="token keyword">from</span> result
<span class="token keyword">where</span> subjectNo <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span> subjectNo <span class="token keyword">from</span> subject
    <span class="token keyword">where</span> SubjectName <span class="token operator">=</span> <span class="token string">'数据库结构-1'</span>
<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_458"></a><strong>查询小结：</strong></h4> 
<p><strong>顺序很重要</strong></p> 
<p><strong>select 去重 要查询的字段 from 表（注意：表和字段可以取别名）<br> xxx join 要连接的表 on 等值判断<br> where（具体的值，子查询语句）<br> Group By（通过哪个字段来分组）<br> Having（过分组后的信息，条件和where是一样的，位置不同）<br> Order By…（通过哪个字段排序）[升序/降序]<br> Limit startindex，pagesize</strong></p> 
<p>业务层面：</p> 
<p>查询：跨表，跨数据库······</p> 
<h4><a id="5MySQL_474"></a>5、MySQL函数</h4> 
<h5><a id="_478"></a>常用函数</h5> 
<pre><code class="prism language-sql"><span class="token comment">-- 数学运算</span>
<span class="token keyword">select</span> ABS<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token comment">-- 绝对值</span>
<span class="token keyword">select</span> CEILING<span class="token punctuation">(</span><span class="token number">3.4</span><span class="token punctuation">)</span> <span class="token comment">-- 向上取整</span>
<span class="token keyword">select</span> FLOOR<span class="token punctuation">(</span><span class="token number">3.4</span><span class="token punctuation">)</span> <span class="token comment">-- 向下取整</span>
<span class="token keyword">select</span> RAND<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">--  返回一个0-1之间的随机数</span>

<span class="token comment">-- 字符串函数</span>
<span class="token keyword">select</span> CHAR_LENGTH<span class="token punctuation">(</span><span class="token string">'长风破浪会有时'</span><span class="token punctuation">)</span> <span class="token comment">-- 字符串长度</span>
<span class="token keyword">select</span> CONCAT<span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">)</span> <span class="token comment">-- 拼接字符串</span>
<span class="token keyword">select</span> <span class="token keyword">INSERT</span><span class="token punctuation">(</span><span class="token string">'12345'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'abc'</span><span class="token punctuation">)</span> <span class="token comment">-- 查询，替换</span>
<span class="token keyword">SELECT</span> LOWER<span class="token punctuation">(</span><span class="token string">'XiaoEr'</span><span class="token punctuation">)</span><span class="token comment">-- 小写字母</span>
<span class="token keyword">SELECT</span> UPPER<span class="token punctuation">(</span><span class="token string">'XiaoEr'</span><span class="token punctuation">)</span> <span class="token comment">-- 小写字母</span>

<span class="token comment">-- 时间和日期</span>
<span class="token keyword">select</span> <span class="token keyword">CURRENT_DATE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">-- 获取当前日期</span>
<span class="token keyword">select</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">-- 获取当前的时间</span>
<span class="token keyword">select</span> LOCALTIME<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">-- 获取本地时间</span>
<span class="token keyword">select</span> SYSDATE<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">-- 获取系统时间</span>
<span class="token keyword">select</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 获取当前年份</span>
<span class="token keyword">select</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 获取当前月份</span>
<span class="token keyword">select</span> <span class="token keyword">DAY</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 获取当前日期</span>
<span class="token keyword">select</span> <span class="token keyword">HOUR</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token keyword">select</span> <span class="token keyword">MINUTE</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> <span class="token keyword">SECOND</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 

<span class="token comment">-- 系统</span>
<span class="token keyword">select</span> <span class="token keyword">SYSTEM_USER</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> <span class="token keyword">USER</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">select</span> VERSION<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_512"></a>聚合函数（常用）</h5> 
<table><thead><tr><th>函数名</th><th>描述</th></tr></thead><tbody><tr><td>COUNT()</td><td>计数</td></tr><tr><td>SUM()</td><td>求和</td></tr><tr><td>AVG()</td><td>平均值</td></tr><tr><td>MAX()</td><td>最大值</td></tr><tr><td>MIN()</td><td>最小值</td></tr><tr><td>······</td><td>······</td></tr></tbody></table> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>studentName<span class="token punctuation">)</span> <span class="token keyword">from</span> student<span class="token punctuation">;</span> <span class="token comment">--count(字段)，会忽略所有的null值</span>
<span class="token keyword">select</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> student<span class="token punctuation">;</span> <span class="token comment">--count(*)，不会忽略所有的null值，本质 计算行数</span>
<span class="token keyword">select</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">from</span> student<span class="token punctuation">;</span> <span class="token comment">--count(1)，不会忽略所有的null值</span>

<span class="token keyword">select</span> <span class="token function">SUM</span><span class="token punctuation">(</span>sutdentResult<span class="token punctuation">)</span> <span class="token keyword">as</span> 总和 <span class="token keyword">from</span> result
<span class="token keyword">select</span> <span class="token function">AVG</span><span class="token punctuation">(</span>sutdentResult<span class="token punctuation">)</span> <span class="token keyword">as</span> 平均分 <span class="token keyword">from</span> result

<span class="token comment">-- 练习：查询不同课程的平均分，最高分，最低分，平均分大于80分</span>
<span class="token comment">-- 核心：根据不同的课程分组</span>
<span class="token keyword">select</span> SubjectName<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>studentResult<span class="token punctuation">)</span> <span class="token keyword">as</span> 平均分<span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>studentResult<span class="token punctuation">)</span> <span class="token keyword">as</span> 最高分<span class="token punctuation">,</span>MIX<span class="token punctuation">(</span>studentResult<span class="token punctuation">)</span> <span class="token keyword">as</span> 最低分
<span class="token keyword">from</span> result r
<span class="token keyword">inner</span> <span class="token keyword">join</span> subject sub
<span class="token keyword">on</span> r<span class="token punctuation">.</span>subjectNo <span class="token operator">=</span> sub<span class="token punctuation">.</span>subJectNo
<span class="token keyword">group</span> <span class="token keyword">by</span> r<span class="token punctuation">.</span>subjectNo <span class="token comment">-- 通过什么字段来分组</span>
<span class="token keyword">having</span> 平均分<span class="token operator">&gt;</span><span class="token number">80</span> <span class="token comment">-- 过滤分组的记录必须满足的次要条件</span>
</code></pre> 
<h4><a id="limit_order_by_543"></a>分页limit 和排序order by</h4> 
<h5><a id="ASCDESC_545"></a>排序：升序ASC，降序DESC</h5> 
<p><mark>order by 通过哪个字段排序，怎么排</mark></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 查询的结果根据成绩升序 排序</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>studentNo<span class="token punctuation">,</span>studentName<span class="token punctuation">,</span>subjectNo<span class="token punctuation">,</span>studentResult 
<span class="token keyword">from</span> student s
<span class="token keyword">right</span> <span class="token keyword">join</span> result r
<span class="token keyword">on</span> s<span class="token punctuation">.</span>studentNo <span class="token operator">=</span> r<span class="token punctuation">.</span>studentNo
<span class="token keyword">order</span> <span class="token keyword">by</span> studentResult <span class="token keyword">ASC</span>
</code></pre> 
<h5><a id="_558"></a>分页</h5> 
<p>可以缓解数据库压力，给人好的体验</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 分页，每页只显示5条数据</span>
<span class="token comment">-- 语法：limit 起始值，页面的大小</span>
<span class="token comment">-- limit 0,5	1~5	第一页</span>
<span class="token comment">-- limit 1,5	2~6</span>
<span class="token comment">-- limit 5,5	6~10第二页</span>
<span class="token comment">-- 第N页 limit (n-1)*pageSize,pageSize</span>
<span class="token comment">-- 【pageSize：页面大小，(n-1)*pageSize：页面起始值，n：当前页】</span>
<span class="token comment">-- 【总页数 = 数据总数/页面大小】</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>studentNo<span class="token punctuation">,</span>studentName<span class="token punctuation">,</span>subjectNo<span class="token punctuation">,</span>studentResult 
<span class="token keyword">from</span> student s
<span class="token keyword">right</span> <span class="token keyword">join</span> result r
<span class="token keyword">on</span> s<span class="token punctuation">.</span>studentNo <span class="token operator">=</span> r<span class="token punctuation">.</span>studentNo
<span class="token keyword">order</span> <span class="token keyword">by</span> studentResult <span class="token keyword">ASC</span>
<span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span>
</code></pre> 
<h4><a id="_581"></a>分组和过滤</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 练习：查询不同课程的平均分，最高分，最低分，平均分大于80分</span>
<span class="token comment">-- 核心：根据不同的课程分组</span>
<span class="token keyword">select</span> SubjectName<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>studentResult<span class="token punctuation">)</span> <span class="token keyword">as</span> 平均分<span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>studentResult<span class="token punctuation">)</span> <span class="token keyword">as</span> 最高分<span class="token punctuation">,</span>MIX<span class="token punctuation">(</span>studentResult<span class="token punctuation">)</span> <span class="token keyword">as</span> 最低分
<span class="token keyword">from</span> result r
<span class="token keyword">inner</span> <span class="token keyword">join</span> subject sub
<span class="token keyword">on</span> r<span class="token punctuation">.</span>subjectNo <span class="token operator">=</span> sub<span class="token punctuation">.</span>subJectNo
<span class="token keyword">group</span> <span class="token keyword">by</span> r<span class="token punctuation">.</span>subjectNo <span class="token comment">-- 通过什么字段来分组</span>
<span class="token keyword">having</span> 平均分<span class="token operator">&gt;</span><span class="token number">80</span> <span class="token comment">-- 过滤分组的记录必须满足的次要条件</span>
</code></pre> 
<h4><a id="MD5_594"></a>数据库级别的MD5加密（扩展）</h4> 
<p>MD5码以512位分组来处理输入的信息，且每一分组又被划分为16个32位子分组，经过了一系列的处理后，算法的输出由四个32位分组组成，将这四个32位分组级联后将生成一个128位散列值。</p> 
<p>主要增强算法复杂度和不可逆性。</p> 
<p>MD5不可逆，但具体的值的MD5是一样的。</p> 
<p>MD5破解网站的原理，背后有一个字典，只能破解一些简单的数字。</p> 
<pre><code class="prism language-sql"><span class="token comment">-- MD5加密</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span><span class="token string">'testmd5(
    '</span>id<span class="token string">' INT(4) NOT NULL,
    name VARCHAR(20) NOT NULL,
    '</span>pwd<span class="token string">'VARCHAR(50) NOT NULL,
    PRIMARY KEY('</span>id<span class="token string">')
)ENGINE=INNODB DEFAULT CHARSET=utf8
--明文密码
INSERT INTO testmd5 VALUES(1,'</span>zhangsan<span class="token string">','</span><span class="token number">123456</span><span class="token string">'),(2,'</span>lisi<span class="token string">','</span><span class="token number">123456</span><span class="token string">'),(3,'</span>wangwu<span class="token string">','</span><span class="token number">123456</span><span class="token string">')
-- 加密
UPDATE testmd5 SET pwd=MD5(pwd) WHERE id = 1
UPDATE testmd5 SET pwd=MD5(pwd) -- 加密全部的密码
-- 插入的时候加密
INSERT INTO testmd5 VALUES(4,'</span>xiaoming<span class="token string">',MD5('</span><span class="token number">123456</span><span class="token string">'))
--如何校验:将用户传递进来的密码,进行md5加密,然后比对加密后的值
SELECT*FROM testmd5 WHERE name ='</span>xiaoming<span class="token string">'AND pwd=MD5('</span><span class="token number">123456</span>'<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="6_625"></a>6、事务</h4> 
<p><a href="https://blog.csdn.net/dengjili/article/details/82468576">点击参考博客链接</a></p> 
<p>在 MySQL 中，事务其实是一个最小的不可分割的工作单元。事务能够<strong>保证一个业务的完整性</strong>。</p> 
<p>比如我们的银行转账：</p> 
<pre><code class="prism language-mysql">-- a -&gt; -100
UPDATE user set money = money - 100 WHERE name = 'a';

-- b -&gt; +100
UPDATE user set money = money + 100 WHERE name = 'b';
</code></pre> 
<p>在实际项目中，假设只有一条 SQL 语句执行成功，而另外一条执行失败了，就会出现数据前后不一致。</p> 
<p>因此，在执行多条有关联 SQL 语句时，<strong>事务</strong>可能会要求这些 SQL 语句<strong>要么同时执行成功，要么就都执行失败</strong>。</p> 
<h5><a id="__COMMIT__ROLLBACK_645"></a>如何控制事务 - COMMIT / ROLLBACK</h5> 
<p>在 MySQL 中，事务的<strong>自动提交</strong>状态<strong>默认是开启的</strong>。</p> 
<pre><code class="prism language-mysql">-- 查询事务的自动提交状态
SELECT @@AUTOCOMMIT;
+--------------+
| @@AUTOCOMMIT |
+--------------+
|            1 |
+--------------+
</code></pre> 
<p><strong>自动提交的作用</strong>：当我们执行一条 SQL 语句的时候，其产生的效果就会立即体现出来，且不能<strong>回滚</strong>。</p> 
<p>什么是回滚？举个例子：</p> 
<pre><code class="prism language-mysql">CREATE DATABASE bank;

USE bank;

CREATE TABLE user (
    id INT PRIMARY KEY,
    name VARCHAR(20),
    money INT
);

INSERT INTO user VALUES (1, 'a', 1000);

SELECT * FROM user;
+----+------+-------+
| id | name | money |
+----+------+-------+
|  1 | a    |  1000 |
+----+------+-------+
</code></pre> 
<p>可以看到，在执行插入语句后数据立刻生效，原因是 MySQL 中的事务自动将它<strong>提交</strong>到了数据库中。那么所谓<strong>回滚</strong>的意思就是，撤销执行过的所有 SQL 语句，使其回滚到<strong>最后一次提交</strong>数据时的状态。</p> 
<p>在 MySQL 中使用 <code>ROLLBACK</code> 执行回滚：</p> 
<pre><code class="prism language-mysql">-- 回滚到最后一次提交
ROLLBACK;

SELECT * FROM user;
+----+------+-------+
| id | name | money |
+----+------+-------+
|  1 | a    |  1000 |
+----+------+-------+
</code></pre> 
<p>由于所有执行过的 SQL 语句都已经被提交过了，所以数据并没有发生回滚。那如何让数据可以发生回滚？</p> 
<pre><code class="prism language-mysql">-- 关闭自动提交
SET AUTOCOMMIT = 0;

-- 查询自动提交状态
SELECT @@AUTOCOMMIT;
+--------------+
| @@AUTOCOMMIT |
+--------------+
|            0 |
+--------------+
</code></pre> 
<p>将自动提交关闭后，测试数据回滚：</p> 
<pre><code class="prism language-mysql">INSERT INTO user VALUES (2, 'b', 1000);

-- 关闭 AUTOCOMMIT 后，数据的变化是在一张虚拟的临时数据表中展示，
-- 发生变化的数据并没有真正插入到数据表中。
SELECT * FROM user;
+----+------+-------+
| id | name | money |
+----+------+-------+
|  1 | a    |  1000 |
|  2 | b    |  1000 |
+----+------+-------+

-- 数据表中的真实数据其实还是：
+----+------+-------+
| id | name | money |
+----+------+-------+
|  1 | a    |  1000 |
+----+------+-------+

-- 由于数据还没有真正提交，可以使用回滚
ROLLBACK;

-- 再次查询
SELECT * FROM user;
+----+------+-------+
| id | name | money |
+----+------+-------+
|  1 | a    |  1000 |
+----+------+-------+
</code></pre> 
<p>那如何将虚拟的数据真正提交到数据库中？使用 <code>COMMIT</code> :</p> 
<pre><code class="prism language-mysql">INSERT INTO user VALUES (2, 'b', 1000);
-- 手动提交数据（持久性），
-- 将数据真正提交到数据库中，执行后不能再回滚提交过的数据。
COMMIT;

-- 提交后测试回滚
ROLLBACK;

-- 再次查询（回滚无效了）
SELECT * FROM user;
+----+------+-------+
| id | name | money |
+----+------+-------+
|  1 | a    |  1000 |
|  2 | b    |  1000 |
+----+------+-------+
</code></pre> 
<blockquote> 
 <p><strong>总结</strong></p> 
 <ol><li> <p><strong>自动提交</strong></p> 
   <ul><li> <p>查看自动提交状态：<code>SELECT @@AUTOCOMMIT</code> ；</p> </li><li> <p>设置自动提交状态：<code>SET AUTOCOMMIT = 1</code> 。</p> </li></ul> </li><li> <p><strong>手动提交</strong></p> 
   <ul><li><code>@@AUTOCOMMIT = 0</code> 时，使用 <code>COMMIT</code> 命令提交事务，结束事务。</li></ul> </li><li> <p><strong>事务回滚</strong></p> <p><code>@@AUTOCOMMIT = 0</code> 时，使用 <code>ROLLBACK</code> 命令回滚事务。</p> </li></ol> 
</blockquote> 
<p><strong>事务的实际应用</strong>，让我们再回到银行转账项目：</p> 
<pre><code class="prism language-mysql">-- 转账
UPDATE user set money = money - 100 WHERE name = 'a';

-- 到账
UPDATE user set money = money + 100 WHERE name = 'b';

SELECT * FROM user;
+----+------+-------+
| id | name | money |
+----+------+-------+
|  1 | a    |   900 |
|  2 | b    |  1100 |
+----+------+-------+
</code></pre> 
<p>这时假设在转账时发生了意外，就可以使用 <code>ROLLBACK</code> 回滚到最后一次提交的状态：</p> 
<pre><code class="prism language-mysql">-- 假设转账发生了意外，需要回滚。
ROLLBACK;

SELECT * FROM user;
+----+------+-------+
| id | name | money |
+----+------+-------+
|  1 | a    |  1000 |
|  2 | b    |  1000 |
+----+------+-------+
</code></pre> 
<p>这时我们又回到了发生意外之前的状态，也就是说，事务给我们提供了一个可以反悔的机会。假设数据没有发生意外，这时可以手动将数据真正提交到数据表中：<code>COMMIT</code> 。</p> 
<h5><a id="__BEGIN__START_TRANSACTION_821"></a>手动开启事务 - BEGIN / START TRANSACTION</h5> 
<p>事务的默认提交被开启 ( <code>@@AUTOCOMMIT = 1</code> ) 后，此时就不能使用事务回滚了。但是我们还可以手动开启一个事务处理事件，使其可以发生回滚：</p> 
<pre><code class="prism language-mysql">-- 使用 BEGIN 或者 START TRANSACTION 手动开启一个事务
-- START TRANSACTION;
BEGIN;
UPDATE user set money = money - 100 WHERE name = 'a';
UPDATE user set money = money + 100 WHERE name = 'b';

-- 由于手动开启的事务没有开启自动提交，
-- 此时发生变化的数据仍然是被保存在一张临时表中。
SELECT * FROM user;
+----+------+-------+
| id | name | money |
+----+------+-------+
|  1 | a    |   900 |
|  2 | b    |  1100 |
+----+------+-------+

-- 测试回滚
ROLLBACK;

SELECT * FROM user;
+----+------+-------+
| id | name | money |
+----+------+-------+
|  1 | a    |  1000 |
|  2 | b    |  1000 |
+----+------+-------+
</code></pre> 
<p>仍然使用 <code>COMMIT</code> 提交数据，提交后无法再发生本次事务的回滚。</p> 
<pre><code class="prism language-mysql">BEGIN;
UPDATE user set money = money - 100 WHERE name = 'a';
UPDATE user set money = money + 100 WHERE name = 'b';

SELECT * FROM user;
+----+------+-------+
| id | name | money |
+----+------+-------+
|  1 | a    |   900 |
|  2 | b    |  1100 |
+----+------+-------+

-- 提交数据
COMMIT;

-- 测试回滚（无效，因为表的数据已经被提交）
ROLLBACK;
</code></pre> 
<blockquote> 
 <p>事务开启：</p> 
 <ol><li>修改默认提交 set autocommit=0;</li><li>begin;</li><li>start transaction;</li></ol> 
 <p>事务手动提交：</p> 
 <ul><li>commit;</li></ul> 
 <p>事务手动回滚：</p> 
 <ul><li>rollback;</li></ul> 
</blockquote> 
<h5><a id="_ACID__890"></a>事务的 ACID 特征与使用</h5> 
<p>（atomicity、consistency、isolation、durability）</p> 
<p><strong>事务的四大特征：</strong></p> 
<ul><li><strong>A 原子性</strong>：事务是最小的单位，不可以再分割，表示两个步骤一起成功，或者一起失败，不能只发生其中一个动作；</li><li><strong>C 一致性</strong>：事务要求同一事务中的 SQL 语句，必须保证同时成功或者失败，表示事务完成后，符合逻辑运算；</li><li><strong>I 隔离性</strong>：事务1 和 事务2 之间是具有隔离性的；</li><li><strong>D 持久性</strong>：事务一旦结束 ( <code>COMMIT</code> ) ，就不可以再返回了 ( <code>ROLLBACK</code> )，表示事务结束后的数据不随外界原因导致数据丢失 。</li></ul> 
<h5><a id="_901"></a>事务的隔离性</h5> 
<p><strong>事务的隔离性可分为四种 ( 性能从低到高 )</strong> ：</p> 
<ol><li> <p><strong>READ UNCOMMITTED ( 读取未提交 )</strong></p> <p>如果有多个事务，那么任意事务都可以看见其他事务的<strong>未提交数据</strong>。</p> </li><li> <p><strong>READ COMMITTED ( 读取已提交 )</strong></p> <p>只能读取到其他事务<strong>已经提交的数据</strong>。</p> </li><li> <p><strong>REPEATABLE READ ( 可被重复读 )</strong></p> <p>如果有多个连接都开启了事务，那么事务之间不能共享数据记录，否则只能共享已提交的记录。</p> </li><li> <p><strong>SERIALIZABLE ( 串行化 )</strong></p> <p>所有的事务都会按照<strong>固定顺序执行</strong>，执行完一个事务后再继续执行下一个事务的<strong>写入操作</strong>。</p> </li></ol> 
<p>查看当前数据库的默认隔离级别：</p> 
<pre><code class="prism language-mysql">-- MySQL 8.x, 
-- GLOBAL表示系统级别，不加表示会话级别。
SELECT @@GLOBAL.TRANSACTION_ISOLATION;
SELECT @@TRANSACTION_ISOLATION;
+--------------------------------+
| @@GLOBAL.TRANSACTION_ISOLATION |
+--------------------------------+
| REPEATABLE-READ                | -- MySQL的默认隔离级别，可以重复读。
+--------------------------------+

-- MySQL 5.x
SELECT @@GLOBAL.TX_ISOLATION;
SELECT @@TX_ISOLATION;
</code></pre> 
<p>修改隔离级别：使用set</p> 
<pre><code class="prism language-mysql">-- 设置系统隔离级别，LEVEL 后面表示要设置的隔离级别 (READ UNCOMMITTED)。
SET GLOBAL TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;

-- 查询系统隔离级别，发现已经被修改。
SELECT @@GLOBAL.TRANSACTION_ISOLATION;
+--------------------------------+
| @@GLOBAL.TRANSACTION_ISOLATION |
+--------------------------------+
| READ-UNCOMMITTED               |
+--------------------------------+
</code></pre> 
<h6><a id="_956"></a>脏读</h6> 
<p>测试 <strong>READ UNCOMMITTED ( 读取未提交 )</strong> 的隔离性：</p> 
<pre><code class="prism language-mysql">INSERT INTO user VALUES (3, '小明', 1000);
INSERT INTO user VALUES (4, '淘宝店', 1000);

SELECT * FROM user;
+----+-----------+-------+
| id | name      | money |
+----+-----------+-------+
|  1 | a         |   900 |
|  2 | b         |  1100 |
|  3 | 小明      |  1000 |
|  4 | 淘宝店    |  1000 |
+----+-----------+-------+

-- 开启一个事务操作数据
-- 假设小明在淘宝店买了一双800块钱的鞋子：
START TRANSACTION;
UPDATE user SET money = money - 800 WHERE name = '小明';
UPDATE user SET money = money + 800 WHERE name = '淘宝店';

-- 然后淘宝店在另一方查询结果，发现钱已到账。
SELECT * FROM user;
+----+-----------+-------+
| id | name      | money |
+----+-----------+-------+
|  1 | a         |   900 |
|  2 | b         |  1100 |
|  3 | 小明      |   200 |
|  4 | 淘宝店    |  1800 |
+----+-----------+-------+
</code></pre> 
<p>由于小明的转账是在新开启的事务上进行操作的，而该操作的结果是可以被其他事务（另一方的淘宝店）看见的，因此淘宝店的查询结果是正确的，淘宝店确认到账。但就在这时，如果小明在它所处的事务上又执行了 <code>ROLLBACK</code> 命令，会发生什么？</p> 
<pre><code class="prism language-mysql">-- 小明所处的事务
ROLLBACK;

-- 此时无论对方是谁，如果再去查询结果就会发现：
SELECT * FROM user;
+----+-----------+-------+
| id | name      | money |
+----+-----------+-------+
|  1 | a         |   900 |
|  2 | b         |  1100 |
|  3 | 小明      |  1000 |
|  4 | 淘宝店    |  1000 |
+----+-----------+-------+
</code></pre> 
<p>这就是所谓的<strong>脏读</strong>，一个事务读取到另外一个事务还未提交的数据。这在实际开发中是不允许出现的。</p> 
<h6><a id="_1012"></a>读取已提交</h6> 
<p>把隔离级别设置为 <strong>READ COMMITTED</strong> ：</p> 
<pre><code class="prism language-mysql">SET GLOBAL TRANSACTION ISOLATION LEVEL READ COMMITTED;
SELECT @@GLOBAL.TRANSACTION_ISOLATION;
+--------------------------------+
| @@GLOBAL.TRANSACTION_ISOLATION |
+--------------------------------+
| READ-COMMITTED                 |
+--------------------------------+
</code></pre> 
<p>这样，再有新的事务连接进来时，它们就只能查询到已经提交过的事务数据了。但是对于当前事务来说，它们看到的还是未提交的数据，例如：</p> 
<pre><code class="prism language-mysql">-- 正在操作数据事务（当前事务）
START TRANSACTION;
UPDATE user SET money = money - 800 WHERE name = '小明';
UPDATE user SET money = money + 800 WHERE name = '淘宝店';

-- 虽然隔离级别被设置为了 READ COMMITTED，但在当前事务中，
-- 它看到的仍然是数据表中临时改变数据，而不是真正提交过的数据。
SELECT * FROM user;
+----+-----------+-------+
| id | name      | money |
+----+-----------+-------+
|  1 | a         |   900 |
|  2 | b         |  1100 |
|  3 | 小明      |   200 |
|  4 | 淘宝店    |  1800 |
+----+-----------+-------+


-- 假设此时在远程开启了一个新事务，连接到数据库。
$ mysql -u root -p12345612

-- 此时远程连接查询到的数据只能是已经提交过的
SELECT * FROM user;
+----+-----------+-------+
| id | name      | money |
+----+-----------+-------+
|  1 | a         |   900 |
|  2 | b         |  1100 |
|  3 | 小明      |  1000 |
|  4 | 淘宝店    |  1000 |
+----+-----------+-------+
</code></pre> 
<p>但是这样还有问题，那就是假设一个事务在操作数据时，其他事务干扰了这个事务的数据。例如：</p> 
<pre><code class="prism language-mysql">-- 小张在查询数据的时候发现：
SELECT * FROM user;
+----+-----------+-------+
| id | name      | money |
+----+-----------+-------+
|  1 | a         |   900 |
|  2 | b         |  1100 |
|  3 | 小明      |   200 |
|  4 | 淘宝店    |  1800 |
+----+-----------+-------+

-- 在小张求表的 money 平均值之前，小王做了一个操作：
START TRANSACTION;
INSERT INTO user VALUES (5, 'c', 100);
COMMIT;

-- 此时表的真实数据是：
SELECT * FROM user;
+----+-----------+-------+
| id | name      | money |
+----+-----------+-------+
|  1 | a         |   900 |
|  2 | b         |  1100 |
|  3 | 小明      |  1000 |
|  4 | 淘宝店    |  1000 |
|  5 | c         |   100 |
+----+-----------+-------+

-- 这时小张再求平均值的时候，就会出现计算不相符合的情况：
SELECT AVG(money) FROM user;
+------------+
| AVG(money) |
+------------+
|  820.0000  |
+------------+
</code></pre> 
<p>虽然 <strong>READ COMMITTED</strong> 让我们只能读取到其他事务已经提交的数据，但还是会出现问题，就是<strong>在读取同一个表的数据时，可能会发生前后不一致的情况。<strong>这被称为</strong>不可重复读现象 ( READ COMMITTED )</strong> 。</p> 
<p>(可以想一个极端情况来理解：你刚SELECT完，立马计算AVG，在你输入代码的时候有人提交新数据改变了表，这就是不可重复性。)</p> 
<h6><a id="_1106"></a>幻读</h6> 
<p>将隔离级别设置为 <strong>REPEATABLE READ ( 可被重复读取 )</strong> :</p> 
<pre><code class="prism language-mysql">SET GLOBAL TRANSACTION ISOLATION LEVEL REPEATABLE READ;
SELECT @@GLOBAL.TRANSACTION_ISOLATION;
+--------------------------------+
| @@GLOBAL.TRANSACTION_ISOLATION |
+--------------------------------+
| REPEATABLE-READ                |
+--------------------------------+
</code></pre> 
<p>测试 <strong>REPEATABLE READ</strong> ，假设在两个不同的连接上分别执行 <code>START TRANSACTION</code> :</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 小张 - 成都</span>
<span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token keyword">user</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 小王 - 北京</span>
<span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>

<span class="token comment">-- 小张 - 成都</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre> 
<p>当前事务开启后，没提交之前，查询不到，提交后可以被查询到。但是，在提交之前其他事务被开启了，那么在这条事务线上，就不会查询到当前有操作事务的连接。相当于开辟出一条单独的线程。</p> 
<p>无论小张是否执行过 <code>COMMIT</code> ，在小王这边，都不会查询到小张的事务记录，而是只会查询到自己所处事务的记录：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+-----------+-------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> name      <span class="token operator">|</span> money <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+-----------+-------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> a         <span class="token operator">|</span>   <span class="token number">900</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> b         <span class="token operator">|</span>  <span class="token number">1100</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">3</span> <span class="token operator">|</span> 小明      <span class="token operator">|</span>  <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">4</span> <span class="token operator">|</span> 淘宝店    <span class="token operator">|</span>  <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">5</span> <span class="token operator">|</span> c         <span class="token operator">|</span>   <span class="token number">100</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+-----------+-------+</span>
</code></pre> 
<p>这是<strong>因为小王在此之前开启了一个新的事务 ( <code>START TRANSACTION</code> ) <strong>，那么</strong>在他的这条新事务的线上，跟其他事务是没有联系的</strong>，也就是说，此时如果其他事务正在操作数据，它是不知道的。</p> 
<p>然而事实是，在真实的数据表中，小张已经插入了一条数据。但是小王此时并不知道，也插入了同一条数据，会发生什么呢？</p> 
<pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token keyword">user</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- ERROR 1062 (23000): Duplicate entry '6' for key 'PRIMARY'</span>
</code></pre> 
<p>报错了，操作被告知已存在主键为 <code>6</code> 的字段。这种现象也被称为<strong>幻读，一个事务提交的数据，不能被其他事务读取到</strong>。</p> 
<p>事务a和事务b同时操作一张表，事务a提交的数据，也不能被事务b读到，就可以造成幻读。</p> 
<h5><a id="_1164"></a>串行化</h5> 
<p>顾名思义，就是所有事务的<strong>写入操作</strong>全都是串行化的。什么意思？把隔离级别修改成 <strong>SERIALIZABLE</strong> :</p> 
<pre><code class="prism language-mysql">SET GLOBAL TRANSACTION ISOLATION LEVEL SERIALIZABLE;
SELECT @@GLOBAL.TRANSACTION_ISOLATION;
+--------------------------------+
| @@GLOBAL.TRANSACTION_ISOLATION |
+--------------------------------+
| SERIALIZABLE                   |
+--------------------------------+
</code></pre> 
<p>还是拿小张和小王来举例：</p> 
<pre><code class="prism language-mysql">-- 小张 - 成都
START TRANSACTION;

-- 小王 - 北京
START TRANSACTION;

-- 开启事务之前先查询表，准备操作数据。
SELECT * FROM user;
+----+-----------+-------+
| id | name      | money |
+----+-----------+-------+
|  1 | a         |   900 |
|  2 | b         |  1100 |
|  3 | 小明      |  1000 |
|  4 | 淘宝店    |  1000 |
|  5 | c         |   100 |
|  6 | d         |  1000 |
+----+-----------+-------+

-- 发现没有 7 号王小花，于是插入一条数据：
INSERT INTO user VALUES (7, '王小花', 1000);
</code></pre> 
<p>此时会发生什么呢？由于现在的隔离级别是 <strong>SERIALIZABLE ( 串行化 )</strong> ，串行化的意思就是：假设把所有的事务都放在一个串行的队列中，那么所有的事务都会按照<strong>固定顺序执行</strong>，执行完一个事务后再继续执行下一个事务的<strong>写入操作</strong> ( <strong>这意味着队列中同时只能执行一个事务的写入操作</strong> ) 。</p> 
<p>根据这个解释，小王在插入数据时，会出现等待状态，直到小张执行 <code>COMMIT</code> 结束它所处的事务，或者出现等待超时。</p> 
<p>问题：串行化性能特差！</p> 
<p>性能比较：(隔离级别越高，性能越差)</p> 
<p>read uncommitted &gt; read committed &gt; repeatable read （默认级别）&gt;serializable</p> 
<blockquote> 
 <p>资料来源：<a href="https://www.bilibili.com/video/BV1Vt411z7wy?p=4&amp;vd_source=817119647dd4820bfbb8128007f410e6" rel="nofollow">一天学会 MySQL 数据库_哔哩哔哩_bilibili</a></p> 
</blockquote> 
<h5><a id="_1216"></a>事务总结</h5> 
<pre><code class="prism language-sql"><span class="token comment">-- mysql 是默认开启事务自动提交的</span>
<span class="token keyword">set</span> autocommit <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">-- 关闭</span>
<span class="token keyword">set</span> autocommit <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">-- 开启（默认）</span>

<span class="token comment">-- 手动处理事务</span>
<span class="token keyword">set</span> autocommit <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">-- 关闭自动提交</span>

<span class="token comment">--事务开启</span>
<span class="token keyword">start</span> <span class="token keyword">transaction</span> <span class="token comment">-- 标记一个事务的开始，从这个之后的sql都在同一个事务内</span>

<span class="token keyword">insert</span> xx
<span class="token keyword">insert</span> xx

<span class="token comment">-- 提交：持久化（成功）</span>
<span class="token keyword">commit</span>
<span class="token comment">-- 回滚：回到原来的样子（失败）</span>
<span class="token keyword">rollback</span>

<span class="token comment">-- 事务结束</span>
<span class="token keyword">set</span> autocommit <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">-- 开启自动提交</span>

<span class="token comment">-- 了解</span>
<span class="token keyword">savepoint</span> 保存点名 <span class="token comment">-- 设置一个事务的保存点</span>
<span class="token keyword">rollback</span> <span class="token keyword">to</span> <span class="token keyword">savepoint</span> 保存点名  <span class="token comment">--回滚到保存点</span>
<span class="token keyword">release</span> <span class="token keyword">savepoint</span> 保存点名  <span class="token comment">-- 撤销保存点</span>

</code></pre> 
<h4><a id="7_1249"></a>7、索引</h4> 
<blockquote> 
 <p>MySQL官方对索引的定义为：<strong>索引（Index）是帮助MySQL高效获取数据的数据结构</strong>。<br> 提取句子主干，就可以得到索引的本质：索引是数据结构。</p> 
</blockquote> 
<h5><a id="_1254"></a>索引的分类</h5> 
<ul><li>主键索引（primary key) 
  <ul><li>唯一的标识，主键不可重复，只能有一个列作为主键</li></ul> </li><li>唯一索引（unique key) 
  <ul><li>避免重复的列出现，唯一索引可以重复，多个列都可以标识 唯一索引</li></ul> </li><li>常规索引（key/index） 
  <ul><li>默认的，inedx/key关键字来设置</li></ul> </li><li>全文索引（fulltext） 
  <ul><li>在特定的数据库引擎下才有，MyISAM</li><li>快速定位数据</li></ul> </li></ul> 
<h5><a id="_1266"></a>基础语法</h5> 
<pre><code class="prism language-sql"><span class="token comment">-- 索引的使用</span>
<span class="token comment">-- 1、在创建表的时候给字段增加索引</span>
<span class="token comment">-- 2、创建完毕后,增加索引</span>

<span class="token comment">-- 显示所有的索引信息</span>
<span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> student

<span class="token comment">-- 增加一个全文索引(索引名)列名</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> school<span class="token punctuation">.</span>student <span class="token keyword">ADD</span> FULLTEXT <span class="token keyword">INDEX</span> <span class="token string">'studentName'</span><span class="token punctuation">(</span><span class="token string">'studentName'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- EXPLAIN 分析sq1执行的状况</span>
<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student<span class="token punctuation">;</span><span class="token comment">--非全文索引</span>
<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> <span class="token keyword">MATCH</span><span class="token punctuation">(</span>studentName<span class="token punctuation">)</span> AGAINST<span class="token punctuation">(</span><span class="token string">'刘'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>索引在小数据量的时候，用处不大，但是在大数据的时候，区别十分明显。</p> 
<p><a href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html" rel="nofollow">CodingLabs - MySQL索引背后的数据结构及算法原理</a></p> 
<h5><a id="_1288"></a>索引原则</h5> 
<ul><li>索引不是越多越好</li><li>不要对进程变动数据加索引</li><li>小数据量的表不需要加索引</li><li>索引一般加在常用来查询的字段上</li></ul> 
<blockquote> 
 <p>索引的数据结构</p> 
</blockquote> 
<p>Hash类型的索引</p> 
<p>Btree：InnoB</p> 
<h4><a id="8_1301"></a>8、权限管理和备份</h4> 
<p>了解</p> 
<h4><a id="9_1305"></a>9、规范数据库设计</h4> 
<p>当数据库比较复杂时，我们需要规范设计</p> 
<p><strong>糟糕的数据库设计：</strong></p> 
<ul><li>数据冗余，浪费空间</li><li>数据库插入和删除都会很麻烦、异常【屏蔽使用物理外键】</li><li>程序的性能差</li></ul> 
<p><strong>良好的数据库设计</strong></p> 
<ul><li>节省内存空间</li><li>保证数据库的完整性</li><li>方便系统开发、</li></ul> 
<p><strong>软件开发中，关于数据库的设计</strong></p> 
<ul><li>分析需求：分析业务和需要处理六的数据库的需求</li><li>概要设计：设计关系图E-R图（流程图）</li></ul> 
<p><strong>设计数据库的步骤：（个人博客）</strong></p> 
<ul><li>收集信息，分析需求 
  <ul><li>用户表（登录注销，个人信息，写博客，创建分类）</li><li>分类表（文章分类，谁创建）</li><li>评论表</li><li>友链表（友链信息）</li><li>自定义表（系统信息，某个关键的字，或一些主字段）key：value</li></ul> </li><li>标识实体（把需求落地到每个字段）</li><li>标识实体之间的关系 
  <ul><li>写博客：user—&gt;blog</li><li>创建分类：user—&gt;category</li><li>关注：user—&gt;user</li><li>友链：link</li><li>评论：user—&gt;user-blog</li></ul> </li></ul> 
<blockquote> 
 <p>资料来源：<a href="https://www.bilibili.com/video/BV1NJ411J79W?p=37&amp;spm_id_from=pageDriver&amp;vd_source=817119647dd4820bfbb8128007f410e6" rel="nofollow">【狂神说Java】MySQL最新教程通俗易懂】</a></p> 
</blockquote> 
<h5><a id="_1344"></a>数据库的三大设计范式</h5> 
<h6><a id="11NF_1346"></a>（1）1NF</h6> 
<p>只要字段值还可以继续拆分，就不满足第一范式。</p> 
<p>范式设计得越详细，对某些实际操作可能会更好，但并非都有好处，需要对项目的实际情况进行设定。</p> 
<h6><a id="22NF_1352"></a>（2）2NF</h6> 
<p>在满足第一范式的前提下，其他列都必须完全依赖于主键列。如果出现不完全依赖，只可能发生在联合主键的情况下：</p> 
<pre><code class="prism language-mysql">-- 订单表
CREATE TABLE myorder (
    product_id INT,
    customer_id INT,
    product_name VARCHAR(20),
    customer_name VARCHAR(20),
    PRIMARY KEY (product_id, customer_id)
);
</code></pre> 
<p>实际上，在这张订单表中，<code>product_name</code> 只依赖于 <code>product_id</code> ，<code>customer_name</code> 只依赖于 <code>customer_id</code> 。也就是说，<code>product_name</code> 和 <code>customer_id</code> 是没用关系的，<code>customer_name</code> 和 <code>product_id</code> 也是没有关系的。</p> 
<p>这就不满足第二范式：其他列都必须完全依赖于主键列！</p> 
<pre><code class="prism language-mysql">CREATE TABLE myorder (
    order_id INT PRIMARY KEY,
    product_id INT,
    customer_id INT
);

CREATE TABLE product (
    id INT PRIMARY KEY,
    name VARCHAR(20)
);

CREATE TABLE customer (
    id INT PRIMARY KEY,
    name VARCHAR(20)
);
</code></pre> 
<p>拆分之后，<code>myorder</code> 表中的 <code>product_id</code> 和 <code>customer_id</code> 完全依赖于 <code>order_id</code> 主键，而 <code>product</code> 和 <code>customer</code> 表中的其他字段又完全依赖于主键。满足了第二范式的设计！</p> 
<h6><a id="33NF_1391"></a>（3）3NF</h6> 
<p>在满足第二范式的前提下，除了主键列之外，其他列之间不能有传递依赖关系。</p> 
<pre><code class="prism language-mysql">CREATE TABLE myorder (
    order_id INT PRIMARY KEY,
    product_id INT,
    customer_id INT,
    customer_phone VARCHAR(15)
);
</code></pre> 
<p>表中的 <code>customer_phone</code> 有可能依赖于 <code>order_id</code> 、 <code>customer_id</code> 两列，也就不满足了第三范式的设计：其他列之间不能有传递依赖关系。</p> 
<pre><code class="prism language-mysql">CREATE TABLE myorder (
    order_id INT PRIMARY KEY,
    product_id INT,
    customer_id INT
);

CREATE TABLE customer (
    id INT PRIMARY KEY,
    name VARCHAR(20),
    phone VARCHAR(15)
);
</code></pre> 
<p>修改后就不存在其他列之间的传递依赖关系，其他列都只依赖于主键列，满足了第三范式的设计！</p> 
<h3><a id="_1422"></a>三、如何在编程语言中操作数据库</h3> 
<ul><li>JDBC : sun发布的 一个 java程序和数据库之间通信的 规范（接口）</li><li>各大数据库厂商去实现JDBC规范（实现类），这些实现类打成压缩包，就是所谓的jar包</li></ul> 
<h4><a id="1_JDBC_1428"></a>1 JDBC常规操作：</h4> 
<h5><a id="1JDBCMySQL_1430"></a>1)JDBC连接MySQL数据库</h5> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>jdbc</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DriverManager</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLException</span><span class="token punctuation">;</span>

<span class="token comment">//目标：和数据库建立连接</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo01</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//1.添加jar</span>
        <span class="token comment">//2.加载驱动</span>
        <span class="token comment">//org.gjt.mm.mysql.Driver</span>
        <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.cj.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3.通过驱动管理器获取连接对象</span>
        <span class="token comment">//3-1.准备URL</span>
        <span class="token class-name">String</span> url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://localhost:3306/fruitdb"</span><span class="token punctuation">;</span>
        <span class="token comment">//3-2.准备用户名</span>
        <span class="token class-name">String</span> user <span class="token operator">=</span> <span class="token string">"root"</span><span class="token punctuation">;</span>
        <span class="token comment">//3-3.准备密码</span>
        <span class="token class-name">String</span> pwd <span class="token operator">=</span> <span class="token string">"123456"</span><span class="token punctuation">;</span>
        <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>user<span class="token punctuation">,</span>pwd<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"conn = "</span> <span class="token operator">+</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="2JDBC_1460"></a>2)JDBC对数据库进行增、删、改</h5> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>jdbc</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DriverManager</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">PreparedStatement</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLException</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo02</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//1.加载驱动</span>
        <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.cj.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.通过驱动管理器获取连接对象</span>
        <span class="token comment">//url 表示 和 数据库通信的地址</span>
        <span class="token comment">//如果url中需要带参数，则需要使用?进行连接</span>
        <span class="token comment">//如果需要带多个参数，则从第二个参数开始使用&amp;连接</span>
        <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://localhost:3306/fruitdb?useSSL=false&amp;useUnicode=true&amp;characterEncoding=utf-8"</span><span class="token punctuation">,</span><span class="token string">"root"</span><span class="token punctuation">,</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3.编写SQL语句</span>
        <span class="token comment">//id , fname , price , fcount , remark</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"insert into t_fruit values(0,?,?,?,?)"</span><span class="token punctuation">;</span>
        <span class="token comment">//4.创建预处理命令对象</span>
        <span class="token class-name">PreparedStatement</span> psmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//5.填充参数</span>
        psmt<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"草莓"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        psmt<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        psmt<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        psmt<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">"草莓很好吃"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//6.执行更新(增删改），返回影响行数</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> psmt<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">"添加成功！"</span> <span class="token operator">:</span> <span class="token string">"添加失败！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//7.释放资源（关闭连接 , 先关闭psmt，后关闭conn）</span>
        psmt<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>修改和删除：</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>jdbc</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DriverManager</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">PreparedStatement</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLException</span><span class="token punctuation">;</span>

<span class="token comment">//JDBC - 修改和删除</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo03</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Fruit</span> fruit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fruit</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token string">"猕猴桃"</span><span class="token punctuation">,</span><span class="token string">"猕猴桃是水果之王"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"org.gjt.mm.mysql.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://localhost:3306/fruitdb?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false"</span><span class="token punctuation">,</span><span class="token string">"root"</span><span class="token punctuation">,</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"update t_fruit set fname = ? , remark = ? where fid = ? "</span> <span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> psmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        psmt<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>fruit<span class="token punctuation">.</span><span class="token function">getFname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        psmt<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>fruit<span class="token punctuation">.</span><span class="token function">getRemark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        psmt<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>fruit<span class="token punctuation">.</span><span class="token function">getFid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> count <span class="token operator">=</span> psmt<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">"修改成功！"</span> <span class="token operator">:</span> <span class="token string">"修改失败！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        psmt<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//JDBC - 修改和删除</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo04</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"org.gjt.mm.mysql.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://localhost:3306/fruitdb?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false"</span><span class="token punctuation">,</span><span class="token string">"root"</span><span class="token punctuation">,</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"delete from t_fruit where fid = ? "</span> <span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> psmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        psmt<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> psmt<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">"删除成功！"</span> <span class="token operator">:</span> <span class="token string">"删除失败！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        psmt<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h5><a id="3JDBC_1552"></a>3)JDBC对数据库进行查询操作</h5> 
<p>查询所有的库存：</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>jdbc</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">//JDBC - 查询所有的库存</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo05</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"org.gjt.mm.mysql.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://localhost:3306/fruitdb?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false"</span><span class="token punctuation">,</span><span class="token string">"root"</span><span class="token punctuation">,</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3.编写SQL语句</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"select * from t_fruit"</span> <span class="token punctuation">;</span>
        <span class="token comment">//4.创建预处理命令对象</span>
        <span class="token class-name">PreparedStatement</span> psmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//5.执行查询，返回结果集</span>
        <span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> psmt<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//6.解析结果集</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Fruit</span><span class="token punctuation">&gt;</span></span> fruitList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//1表示读取当前行的第一列的数据</span>
            <span class="token comment">//getInt ， 因为这一列是int类型，所以使用getInt</span>
            <span class="token comment">//getInt(结果集的列名)</span>
            <span class="token comment">//int fid = rs.getInt("fid");</span>
            <span class="token keyword">int</span> fid <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> fname <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"fname"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> price <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> fcount <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> remark <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">Fruit</span> fruit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fruit</span><span class="token punctuation">(</span>fid <span class="token punctuation">,</span> fname <span class="token punctuation">,</span> price <span class="token punctuation">,</span> fcount <span class="token punctuation">,</span> remark <span class="token punctuation">)</span><span class="token punctuation">;</span>
            fruitList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//7.释放资源</span>
        rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        psmt<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        fruitList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>查询指定fid的库存记录：</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>jdbc</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">//JDBC - 查询指定fid的库存记录</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo06</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"org.gjt.mm.mysql.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//url -&gt;    jdbc:mysql://ip:port/dbname?参数列表</span>
        <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://localhost:3306/fruitdb?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false"</span><span class="token punctuation">,</span><span class="token string">"root"</span><span class="token punctuation">,</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3.编写SQL语句</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"select * from t_fruit where fid = ? "</span> <span class="token punctuation">;</span>
        <span class="token comment">//4.创建预处理命令对象</span>
        <span class="token class-name">PreparedStatement</span> psmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//5.填充参数</span>
        psmt<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//6.执行查询，返回结果集</span>
        <span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> psmt<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//6.解析结果集</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> fid <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> fname <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"fname"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> price <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> fcount <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> remark <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Fruit</span> fruit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fruit</span><span class="token punctuation">(</span>fid <span class="token punctuation">,</span> fname <span class="token punctuation">,</span> price <span class="token punctuation">,</span> fcount <span class="token punctuation">,</span> remark <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//7.释放资源</span>
        rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        psmt<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="4__1642"></a>4) 添加操作时获取自增列主键值</h5> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>jdbc</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token comment">//JDBC - 查询指定fid的库存记录</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo07</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"org.gjt.mm.mysql.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//url -&gt;    jdbc:mysql://ip:port/dbname?参数列表</span>
        <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://localhost:3306/fruitdb?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false"</span><span class="token punctuation">,</span><span class="token string">"root"</span><span class="token punctuation">,</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3.编写SQL语句</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"select count(*) from t_fruit"</span> <span class="token punctuation">;</span>
        <span class="token comment">//4.创建预处理命令对象</span>
        <span class="token class-name">PreparedStatement</span> psmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//5.执行查询，返回结果集</span>
        <span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> psmt<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//6.解析结果集</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> count <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"总记录条数："</span><span class="token operator">+</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//7.释放资源</span>
        rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        psmt<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="5_1676"></a>5)批处理</h5>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7d39d9171b3585efea132712102f9c16/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【S9-分支限界】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/97b2a19b556fbbad193e8fb32b463a85/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">一键清理系统垃圾文件.BAT</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>