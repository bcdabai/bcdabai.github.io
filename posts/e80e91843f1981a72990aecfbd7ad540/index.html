<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>RTMP推流，WebRTC拉流步骤及问题解决 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="RTMP推流，WebRTC拉流步骤及问题解决" />
<meta property="og:description" content="1.下载VirtualBox虚拟机，Centos7镜像文件以及配置详情请点击链接
VirtualBox虚拟机下载安装及配置CentOS7_随风散-&gt;拉萨的博客-CSDN博客
虚拟机中RTMP推流，WebRTC拉流相关命令
2.启动进去后输入账号，账号默认为root,然后输入密码
若出现【root@bogon~】，可以输入命令：
hostname localhost
su
正常输入账号密码为
3.下载源码
git clone -b 4.0release https://gitee.com/ossrs/srs.git
Note:若出现bash: git: command not found,要先在虚拟机中安装git插件
安装git命令：yum install -y git
4.编译，注意需要切换到srs/trunk目录：
cd srs/trunk
./configure
make
5.启动服务器
启动服务器之前先关闭虚拟机防火墙
暂时关闭防火墙命令：systemctl stop firewalld
然后使用vim命令编辑srs.conf文件
安装vim相关的软件包命令：yum install -y vim*
cd conf #进入conf目录
vim srs.conf #编辑srs.conf文件
i #进入编辑模式
修改rtmp_to_rtc off为rtmp_to_rtc on
esc #退出编辑模式
：wq #保持并退出vim
./objs/srs -c conf/srs.conf
检查SRS是否成功启动，可以打开 http://localhost:8080/ ，或者执行命令：
# 查看SRS的状态
./etc/init.d/srs status
# 或者看SRS的日志
tail -n 30 -f ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e80e91843f1981a72990aecfbd7ad540/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-17T15:58:46+08:00" />
<meta property="article:modified_time" content="2023-01-17T15:58:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">RTMP推流，WebRTC拉流步骤及问题解决</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>1.下载VirtualBox虚拟机，Centos7镜像文件以及配置详情请点击链接</p> 
<p><a href="https://blog.csdn.net/Jiang5106/article/details/128713221?spm=1001.2014.3001.5502" title="VirtualBox虚拟机下载安装及配置CentOS7_随风散-&gt;拉萨的博客-CSDN博客">VirtualBox虚拟机下载安装及配置CentOS7_随风散-&gt;拉萨的博客-CSDN博客</a></p> 
<p><a class="link-info" href="https://blog.csdn.net/Jiang5106/article/details/128715837?spm=1001.2014.3001.5501" title="虚拟机中RTMP推流，WebRTC拉流相关命令">虚拟机中RTMP推流，WebRTC拉流相关命令</a></p> 
<p>2.启动进去后输入账号，账号默认为root,然后输入密码</p> 
<p>若出现【root@bogon~】，可以输入命令：</p> 
<blockquote> 
 <p>hostname localhost<br> su</p> 
</blockquote> 
<p> 正常输入账号密码为</p> 
<p><img alt="" height="221" src="https://images2.imgbox.com/21/36/BxmB9XSH_o.png" width="552"></p> 
<p>3.下载源码</p> 
<blockquote> 
 <p>git clone -b 4.0release https://gitee.com/ossrs/srs.git</p> 
</blockquote> 
<p> Note:若出现bash: git: command not found,要先在虚拟机中安装git插件</p> 
<blockquote> 
 <p>安装git命令：yum install -y git</p> 
</blockquote> 
<p> 4.编译，注意需要切换到srs/trunk目录：</p> 
<blockquote> 
 <p>cd srs/trunk<br> ./configure<br> make</p> 
</blockquote> 
<p> 5.启动服务器</p> 
<p>启动服务器之前先关闭虚拟机防火墙</p> 
<blockquote> 
 <p>暂时关闭防火墙命令：systemctl stop firewalld</p> 
 <p></p> 
 <p>然后使用vim命令编辑srs.conf文件</p> 
 <p>安装vim相关的软件包命令：yum install -y vim*<br> cd    conf                                                     #进入conf目录<br> vim srs.conf                                                #编辑srs.conf文件<br> i                                                                   #进入编辑模式<br> 修改rtmp_to_rtc off为rtmp_to_rtc on<br> esc                                                               #退出编辑模式<br> ：wq                                                            #保持并退出vim</p> 
</blockquote> 
<blockquote> 
 <p>./objs/srs -c conf/srs.conf</p> 
</blockquote> 
<p> 检查SRS是否成功启动，可以打开 http://localhost:8080/ ，或者执行命令：</p> 
<blockquote> 
 <p># 查看SRS的状态<br> ./etc/init.d/srs status</p> 
 <p><br> # 或者看SRS的日志<br> tail -n 30 -f ./objs/srs.log</p> 
 <p><br> 例如，下面的命令显示SRS正在运行：<br> MB0:trunk $ ./etc/init.d/srs status<br> SRS(pid 90408) is running.                                 [  OK  ]</p> 
 <p></p> 
 <p>MB0:trunk $ tail -n 30 -f ./objs/srs.log<br> [2021-08-13 10:30:36.634][Trace][90408][12c97232] Hybrid cpu=0.00%,0MB, cid=1,1, timer=61,0,0, clock=0,22,25,0,0,0,0,1,0</p> 
</blockquote> 
<p>6.使用 FFmpeg推流</p> 
<blockquote> 
 <p>ffmpeg -re -i ./doc/source.flv -c copy -f flv rtmp://localhost/live/livestream<br> Note: 实例文件./doc/source.flv在SRS的源代码目录中有。</p> 
</blockquote> 
<p> Note:若出现bash: ffmpeg: command not found,要先在虚拟机中安装ffmpeg插件</p> 
<blockquote> 
 <p>分别执行这几条命令就可以了<br> sudo yum install -y epel-release rpm<br> sudo rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7<br> yum repolist<br> sudo rpm --import http://li.nux.ro/download/nux/RPM-GPG-KEY-nux.ro<br> sudo rpm -Uvh http://li.nux.ro/download/nux/dextop/el7/x86_64/nux-dextop-release-0-1.el7.nux.noarch.rpm<br> sudo yum repolist<br> sudo yum install -y ffmpeg<br> 这样就安装完成了<br> 查看FFmpeg的版本<br> ffmpeg -version</p> 
</blockquote> 
<p>7.先选择VLC拉流播放进行测试（若SRS不在本机，请将localhost更换成服务器IP）:</p> 
<blockquote> 
 <p>RTMP (by VLC): rtmp://localhost/live/livestrea<br> 在网站下载VLC，下载完成后，点击媒体——打开网络窜流——URL填入rtmp://localhost/live/livestream（将localhost换成虚拟机IP地址）</p> 
</blockquote> 
<p>8. 选择WebRTC拉流播放</p> 
<blockquote> 
 <p>推流完成后，打开http://10.1.4.111:8080/players/rtc_player.html<br> 选择RTC播放器，点击播放（10.1.4.111是虚拟机中的IP地址）<br> URL：webrtc://10.1.4.111/live/livestream</p> 
</blockquote> 
<p><img alt="" height="649" src="https://images2.imgbox.com/1e/79/kV5YmXFn_o.png" width="1106"></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3c9ff35ce59f90c2e91ec26127f0d6ee/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">春秋云境：CVE-2022-24112</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/809db1f1e71610f71188f8e50bdc413f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ping命令的使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>