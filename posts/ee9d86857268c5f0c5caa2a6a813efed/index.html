<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>pandas 常用函数总结（待更新） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="pandas 常用函数总结（待更新）" />
<meta property="og:description" content="目录
1. 将时间字符串转化为时间戳
2. 设置索引列
3. 读取文件columns细节处理
3.1 csv默认将第一行设置为columns
3.2 想要换一个别的列名（原来有）
3.3 想加列名，原来没有
3.4 不想加列名，原来也没有
4. groupby
4.1 agg聚合操作
4.2 apply操作
1. 将时间字符串转化为时间戳 原始数据： 观测时间 经度 纬度 强度 陡度
0 2012-02-22 12:14:52.0 118.6845 31.6724 55.66 5.02
1 2012-02-22 12:21:55.0 118.6875 31.7405 72.99 62.28
2 2012-02-22 12:27:46.0 118.6998 31.7565 77.46 8.93
3 2012-02-22 12:35:34.0 118.9438 31.4310 -29.47 -17.97
4 2012-02-22 12:35:34.0 118.9416 31.4422 -13.43 -6.88
代码： data[&#39;观测时间&#39;]=data[&#39;观测时间&#39;].apply(lambda x:time.mktime(time.strptime(x,&#39;%Y-%m-%d %H:%M:%S.0&#39;))) 效果：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ee9d86857268c5f0c5caa2a6a813efed/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-01-09T21:06:07+08:00" />
<meta property="article:modified_time" content="2020-01-09T21:06:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">pandas 常用函数总结（待更新）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="1.%20%E5%B0%86%E6%97%B6%E9%97%B4%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E5%8C%96%E4%B8%BA%E6%97%B6%E9%97%B4%E6%88%B3-toc" style="margin-left:40px;"><a href="#1.%20%E5%B0%86%E6%97%B6%E9%97%B4%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E5%8C%96%E4%B8%BA%E6%97%B6%E9%97%B4%E6%88%B3" rel="nofollow" title="1. 将时间字符串转化为时间戳">1. 将时间字符串转化为时间戳</a></p> 
<p id="2.%20%E8%AE%BE%E7%BD%AE%E7%B4%A2%E5%BC%95%E5%88%97-toc" style="margin-left:40px;"><a href="#2.%20%E8%AE%BE%E7%BD%AE%E7%B4%A2%E5%BC%95%E5%88%97" rel="nofollow" title="2. 设置索引列">2. 设置索引列</a></p> 
<p id="3.%20%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6columns%E7%BB%86%E8%8A%82%E5%A4%84%E7%90%86-toc" style="margin-left:40px;"><a href="#3.%20%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6columns%E7%BB%86%E8%8A%82%E5%A4%84%E7%90%86" rel="nofollow" title="3. 读取文件columns细节处理">3. 读取文件columns细节处理</a></p> 
<p id="3.1%20csv%E9%BB%98%E8%AE%A4%E5%B0%86%E7%AC%AC%E4%B8%80%E8%A1%8C%E8%AE%BE%E7%BD%AE%E4%B8%BAcolumns-toc" style="margin-left:80px;"><a href="#3.1%20csv%E9%BB%98%E8%AE%A4%E5%B0%86%E7%AC%AC%E4%B8%80%E8%A1%8C%E8%AE%BE%E7%BD%AE%E4%B8%BAcolumns" rel="nofollow" title="3.1 csv默认将第一行设置为columns">3.1 csv默认将第一行设置为columns</a></p> 
<p id="3.2%20%E6%83%B3%E8%A6%81%E6%8D%A2%E4%B8%80%E4%B8%AA%E5%88%AB%E7%9A%84%E5%88%97%E5%90%8D%EF%BC%88%E5%8E%9F%E6%9D%A5%E6%9C%89%EF%BC%89-toc" style="margin-left:80px;"><a href="#3.2%20%E6%83%B3%E8%A6%81%E6%8D%A2%E4%B8%80%E4%B8%AA%E5%88%AB%E7%9A%84%E5%88%97%E5%90%8D%EF%BC%88%E5%8E%9F%E6%9D%A5%E6%9C%89%EF%BC%89" rel="nofollow" title="3.2 想要换一个别的列名（原来有）">3.2 想要换一个别的列名（原来有）</a></p> 
<p id="3.3%20%E6%83%B3%E5%8A%A0%E5%88%97%E5%90%8D%EF%BC%8C%E5%8E%9F%E6%9D%A5%E6%B2%A1%E6%9C%89-toc" style="margin-left:80px;"><a href="#3.3%20%E6%83%B3%E5%8A%A0%E5%88%97%E5%90%8D%EF%BC%8C%E5%8E%9F%E6%9D%A5%E6%B2%A1%E6%9C%89" rel="nofollow" title="3.3 想加列名，原来没有">3.3 想加列名，原来没有</a></p> 
<p id="3.4%20%E4%B8%8D%E6%83%B3%E5%8A%A0%E5%88%97%E5%90%8D%EF%BC%8C%E5%8E%9F%E6%9D%A5%E4%B9%9F%E6%B2%A1%E6%9C%89-toc" style="margin-left:80px;"><a href="#3.4%20%E4%B8%8D%E6%83%B3%E5%8A%A0%E5%88%97%E5%90%8D%EF%BC%8C%E5%8E%9F%E6%9D%A5%E4%B9%9F%E6%B2%A1%E6%9C%89" rel="nofollow" title="3.4 不想加列名，原来也没有">3.4 不想加列名，原来也没有</a></p> 
<p id="4.%20groupby-toc" style="margin-left:40px;"><a href="#4.%20groupby" rel="nofollow" title="4. groupby">4. groupby</a></p> 
<p id="4.1%20agg%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C-toc" style="margin-left:80px;"><a href="#4.1%20agg%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C" rel="nofollow" title="4.1 agg聚合操作">4.1 agg聚合操作</a></p> 
<p id="4.2%20apply%E6%93%8D%E4%BD%9C-toc" style="margin-left:80px;"><a href="#4.2%20apply%E6%93%8D%E4%BD%9C" rel="nofollow" title="4.2 apply操作">4.2 apply操作</a></p> 
<hr id="hr-toc"> 
<h3 id="1.%20%E5%B0%86%E6%97%B6%E9%97%B4%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E5%8C%96%E4%B8%BA%E6%97%B6%E9%97%B4%E6%88%B3">1. 将时间字符串转化为时间戳</h3> 
<p>原始数据： </p> 
<blockquote> 
 <p>                    观测时间        经度       纬度     强度     陡度<br> 0  2012-02-22 12:14:52.0  118.6845  31.6724  55.66   5.02<br> 1  2012-02-22 12:21:55.0  118.6875  31.7405  72.99  62.28<br> 2  2012-02-22 12:27:46.0  118.6998  31.7565  77.46   8.93<br> 3  2012-02-22 12:35:34.0  118.9438  31.4310 -29.47 -17.97<br> 4  2012-02-22 12:35:34.0  118.9416  31.4422 -13.43  -6.88</p> 
</blockquote> 
<p><u>代码： </u></p> 
<pre class="has"><code class="language-python">data['观测时间']=data['观测时间'].apply(lambda x:time.mktime(time.strptime(x,'%Y-%m-%d %H:%M:%S.0')))</code></pre> 
<p> 效果：</p> 
<blockquote> 
 <p>            观测时间        经度       纬度      强度      陡度<br> 0   1.329884e+09  118.6845  31.6724   55.66    5.02<br> 1   1.329885e+09  118.6875  31.7405   72.99   62.28<br> 2   1.329885e+09  118.6998  31.7565   77.46    8.93<br> 3   1.329885e+09  118.9438  31.4310  -29.47  -17.97<br> 4   1.329885e+09  118.9416  31.4422  -13.43   -6.88 </p> 
</blockquote> 
<p> 解释：</p> 
<p>strptime函数是将字符串按照<strong>后面的格式</strong>转换成时间元组类型；mktime函数则是将时间元组转换成时间戳。</p> 
<hr> 
<h3 id="2.%20%E8%AE%BE%E7%BD%AE%E7%B4%A2%E5%BC%95%E5%88%97">2. 设置索引列</h3> 
<p><u>代码： </u></p> 
<pre class="has"><code class="language-python">data.set_index("观测时间", inplace=True)	</code></pre> 
<p>解释：</p> 
<p>将 data["观测时间"] 作为新的索引。</p> 
<hr> 
<h3 id="3.%20%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6columns%E7%BB%86%E8%8A%82%E5%A4%84%E7%90%86">3. 读取文件columns细节处理</h3> 
<p>以 read_csv() 为例</p> 
<h4 id="3.1%20csv%E9%BB%98%E8%AE%A4%E5%B0%86%E7%AC%AC%E4%B8%80%E8%A1%8C%E8%AE%BE%E7%BD%AE%E4%B8%BAcolumns">3.1 csv默认将第一行设置为columns</h4> 
<pre><code class="language-python">import pandas as pd 

df_example = pd.read_csv('xxx.csv')
# 等同于：
df_example = pd.read_csv('xxx.csv', header=0)</code></pre> 
<h4 id="3.2%20%E6%83%B3%E8%A6%81%E6%8D%A2%E4%B8%80%E4%B8%AA%E5%88%AB%E7%9A%84%E5%88%97%E5%90%8D%EF%BC%88%E5%8E%9F%E6%9D%A5%E6%9C%89%EF%BC%89">3.2 想要换一个别的列名（原来有）</h4> 
<pre><code class="language-python">df_example = pd.read_csv('xxx.csv', names=['A', 'B','C']) 

# 即
df_example = pd.read_csv('xxx.csv', header=0, names=['A', 'B','C']) 

# header=0 来说明文件里原来有列名</code></pre> 
<h4 id="3.3%20%E6%83%B3%E5%8A%A0%E5%88%97%E5%90%8D%EF%BC%8C%E5%8E%9F%E6%9D%A5%E6%B2%A1%E6%9C%89">3.3 想加列名，原来没有</h4> 
<pre><code class="language-python">df_example = pd.read_csv('xxx.csv', header=None, names=['A', 'B','C']) 
# header=None 来说明原来是没有columns的</code></pre> 
<h4 id="3.4%20%E4%B8%8D%E6%83%B3%E5%8A%A0%E5%88%97%E5%90%8D%EF%BC%8C%E5%8E%9F%E6%9D%A5%E4%B9%9F%E6%B2%A1%E6%9C%89">3.4 不想加列名，原来也没有</h4> 
<pre><code class="language-python">df_example = pd.read_csv('xxx.csv', header=None) 
# header=None 来说明原来是没有columns的</code></pre> 
<hr> 
<h3 id="4.%20groupby">4. groupby</h3> 
<p><code>groupby</code>的过程就是将原有的<code>DataFrame</code>按照<code>groupby</code>，划分为若干个<code>分组DataFrame</code>。但此时数据结构为DataFrameGroupBy，可以在此基础上调用get_group()，返回的则是一个·DataFrame·对象。所以说，在<code>groupby</code>之后的一系列操作（如<code>agg</code>、<code>apply</code>等），均是基于<code>子DataFrame</code>的操作。</p> 
<p></p> 
<pre><code class="language-python">group = data.groupby("company")

# 根据company将原有DataFrame分成不同的子DataFrame</code></pre> 
<h4 id="4.1%20agg%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C">4.1 agg聚合操作</h4> 
<p>针对样例数据集，如果我想求不同公司员工的平均年龄和平均薪水，可以按照下方的代码进行：</p> 
<pre><code>In [12]: data.groupby("company").agg('mean')
Out[12]:
         salary    age
company
A         21.50  27.50
B         13.00  29.00
C         29.25  27.25</code></pre> 
<p>如果想对针对不同的列求不同的值，比如要计算不同公司员工的平均年龄以及薪水的中位数，可以利用字典进行聚合操作的指定：</p> 
<pre><code>In [17]: data.groupby('company').agg({'salary':'median','age':'mean'})
Out[17]:
         salary    age
company
A          21.5  27.50
B          10.0  29.00
C          30.0  27.25</code></pre> 
<h4 id="4.2%20apply%E6%93%8D%E4%BD%9C">4.2 apply操作</h4> 
<p><code>aggregate</code>函数不同于<code>apply</code>，前者是对所有的数值进行一个聚合的操作，而后者则是对每个数值进行单独的一个操作。</p> 
<pre><code class="language-python">def addOne(data):
    return data + 1

df['Age'] = df['Age'].apply(addOne)
df['Age'] = df['Age'].apply(int)
</code></pre> 
<hr> 
<p>感谢（不断增加 =，=）：</p> 
<p><a href="https://blog.csdn.net/qq_32618817/article/details/80690744" title="pandas将日期转换成timestamp">pandas将日期转换成timestamp</a></p> 
<p><a href="https://zhuanlan.zhihu.com/p/44503744" rel="nofollow" title="Pandas在读取csv时如何设置列名--常用方法集锦">Pandas在读取csv时如何设置列名--常用方法集锦</a><a href="https://blog.csdn.net/FrankieHello/article/details/97272990" title="pandas之分组groupby()的使用整理与总结_敲代码的quant的博客-CSDN博客">pandas之分组groupby()的使用整理与总结_敲代码的quant的博客-CSDN博客</a></p> 
<p><a href="https://www.jianshu.com/p/42f1d2909bb6" rel="nofollow" title="超好用的 pandas 之 groupby - 简书">超好用的 pandas 之 groupby - 简书</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/20a7a6abbe416d33bfd00bfd106c9d63/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Sonatype Nexus Repository Manager 搭建maven 私仓</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0f796858cd220fc981c526c9f433f724/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">01背包——饭卡</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>