<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>利用VLMCSD部署本地KMS服务器（Windows &#43; CentOS7） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="利用VLMCSD部署本地KMS服务器（Windows &#43; CentOS7）" />
<meta property="og:description" content="利用KMS激活Windows操作系统和Office早已不是什么新鲜事，但是呢，不信任来路不明的激活工具，外部服务器又不稳定，随时可能停服，所以，还是发扬自己动手、丰衣足食的优良作风，求人不如求己，那就自己搭一台好了。当然，这里说的部署并不是真的要部署一台微软的KMS服务器，显然博主掏不起那个银子，所以，薅羊毛而已啦，下面进入正题。
项目名称：VLMCSD
项目简介：KMS Emulator in C (Currently runs on Linux, Mac OS, iOS, Windows with or without Cygwin)
项目主页：https://github.com/Wind4/vlmcsd
软件下载：https://github.com/Wind4/vlmcsd/releases/download/svn1112/binaries.tar.gz
首先通过上述下载页面将软件下载下来，不过由于GitHub自身原因，下载不是特别的稳定，博主已经把最新版本的源代码和编译好的工具下载好并打包上传，网友们可以自行下载。信不过博主的，可以通过上述链接自行下载。
# vlmcsd-1112-2018-10-20-Hotbird64
链接: https://pan.baidu.com/s/1Bh4BJR3zwWuucXvgSJr2XA
提取码: dgr4
1. Windows 平台部署KMS服务器 将下载好的工具软件解压到指定的目录下，记得事先关闭杀毒软件（Windows自带的Windows Defender也算）以防发生意外。将工具软件的服务端拷贝到系统文件夹中，方便后续创建系统服务，操作如下：
# VLMCSD 服务端参考路径 # $APP_PATH\vlmcsd-1112-2018-10-20-Hotbird64\binaries\Windows\intel\vlmcsd-Windows-x64.exe copy vlmcsd-Windows-x64.exe %windir%\System32\vlmcsd.exe 接下来，以管理员模式创建命令提示符窗口，我们要创建系统服务并设置为自动启动，同时打开防火墙服务端口，参考命令如下：
# Create System Service sc create KMSSrv binpath=%windir%\System32\vlmcsd.exe type=own start=auto displayname=&#34;KMS Emulator&#34; # Run Vlmcsd net start KMSSrv # Open Port:1688 netsh advfirewall firewall add rule name=&#34;KMS Emulator Server&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/88e80501f45352c02068ff2318fe8f0c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-06-05T00:13:28+08:00" />
<meta property="article:modified_time" content="2019-06-05T00:13:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">利用VLMCSD部署本地KMS服务器（Windows &#43; CentOS7）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><img alt="" class="has" height="240" src="https://images2.imgbox.com/97/78/zCGC5c8k_o.jpg" width="962"></p> 
<p>利用KMS激活Windows操作系统和Office早已不是什么新鲜事，但是呢，不信任来路不明的激活工具，外部服务器又不稳定，随时可能停服，所以，还是发扬自己动手、丰衣足食的优良作风，求人不如求己，那就自己搭一台好了。当然，这里说的部署并不是真的要部署一台微软的KMS服务器，显然博主掏不起那个银子，所以，薅羊毛而已啦，下面进入正题。</p> 
<p><strong>项目名称</strong>：VLMCSD<br><strong>项目简介</strong>：KMS Emulator in C (Currently runs on Linux, Mac OS, iOS, Windows with or without Cygwin)<br><strong>项目主页</strong>：<a href="https://github.com/Wind4/vlmcsd">https://github.com/Wind4/vlmcsd</a><br><strong>软件下载</strong>：<a href="https://github.com/Wind4/vlmcsd/releases/download/svn1112/binaries.tar.gz">https://github.com/Wind4/vlmcsd/releases/download/svn1112/binaries.tar.gz</a></p> 
<p><img alt="" class="has" height="697" src="https://images2.imgbox.com/d6/27/pmz84htg_o.png" width="962"></p> 
<p>首先通过上述下载页面将软件下载下来，不过由于GitHub自身原因，下载不是特别的稳定，博主已经把最新版本的源代码和编译好的工具下载好并打包上传，网友们可以自行下载。信不过博主的，可以通过上述链接自行下载。</p> 
<blockquote> 
 <p># vlmcsd-1112-2018-10-20-Hotbird64<br><strong>链接</strong>: <a href="https://pan.baidu.com/s/1Bh4BJR3zwWuucXvgSJr2XA" rel="nofollow">https://pan.baidu.com/s/1Bh4BJR3zwWuucXvgSJr2XA</a><br><strong>提取码</strong>: dgr4</p> 
</blockquote> 
<h4>1. Windows 平台部署KMS服务器 </h4> 
<p><img alt="" class="has" height="593" src="https://images2.imgbox.com/76/b2/HWa0gGnp_o.png" width="962"></p> 
<p>将下载好的工具软件解压到指定的目录下，记得事先关闭杀毒软件（Windows自带的Windows Defender也算）以防发生意外。将工具软件的服务端拷贝到系统文件夹中，方便后续创建系统服务，操作如下：</p> 
<pre class="has"><code class="language-bash"># VLMCSD 服务端参考路径
# $APP_PATH\vlmcsd-1112-2018-10-20-Hotbird64\binaries\Windows\intel\vlmcsd-Windows-x64.exe
copy vlmcsd-Windows-x64.exe %windir%\System32\vlmcsd.exe</code></pre> 
<p><img alt="" class="has" height="593" src="https://images2.imgbox.com/ff/be/9PPPZSL0_o.png" width="962"></p> 
<p>接下来，以管理员模式创建命令提示符窗口，我们要创建系统服务并设置为自动启动，同时打开防火墙服务端口，参考命令如下：</p> 
<pre class="has"><code class="language-bash"># Create System Service
sc create KMSSrv binpath=%windir%\System32\vlmcsd.exe type=own start=auto displayname="KMS Emulator"

# Run Vlmcsd
net start KMSSrv

# Open Port:1688
netsh advfirewall firewall add rule name="KMS Emulator Server" dir=in action=allow protocol=TCP localport=1688
</code></pre> 
<p><img alt="" class="has" height="387" src="https://images2.imgbox.com/3a/3b/NN15RzT9_o.png" width="962"></p> 
<p> 至此，KMS服务器算是搭建完毕了，接下来，就要测试下服务器是否生效，同样在刚才解压的工具软件目录下，找到如下客户端程序并拷贝到系统文件夹，参照下述命令执行：</p> 
<pre class="has"><code># 拷贝客户端程序到SysWow64
copy vlmcs-Windows-x64.exe %windir%\SysWOW64\vlmcs.exe

# 执行测试命令
vlmcs.exe -v -l 3 localhost</code></pre> 
<p><img alt="" class="has" height="622" src="https://images2.imgbox.com/91/8f/5xzH43Zk_o.png" width="962"></p> 
<h4>2. Linux 平台部署KMS服务器</h4> 
<p>下面的内容要求读者至少要有Linux操作系统的基础知识，这里以CentOS为例进行演示，博主不会讲解的特别详细，对Linux系统不了解的朋友可以不必向后看了。</p> 
<p><strong>操作系统</strong>：CentOS7 (1804) 64Bit<br><strong>测试平台</strong>：VMWare Workstation 14</p> 
<p>同样，首先要把软件包取回本地，博主这里因为是虚拟机环境，为了节省时间，所以就直接使用VMWare-Tools提供的共享目录功能替代了下载过程，wget命令换cp的区别而已，参考注释掉的wget命令即可。</p> 
<p><img alt="" class="has" height="605" src="https://images2.imgbox.com/a3/f9/8YCXwr9l_o.png" width="962"></p> 
<pre class="has"><code class="language-bash"># 获取工具软件包
# wget -O /tmp/binaries.tar.gz https://github.com/Wind4/vlmcsd/releases/download/svn1112/binaries.tar.gz
cp /mnt/hgfs/SandBox/Swap/binaries.tar.gz /tmp/

# 解包
tar -xzf /tmp/binaries.tar.gz -C /tmp/</code></pre> 
<p> <img alt="" class="has" height="605" src="https://images2.imgbox.com/37/d3/6heD0O5k_o.png" width="962"></p> 
<p><img alt="" class="has" height="605" src="https://images2.imgbox.com/35/d3/SiDWzDBs_o.png" width="962"></p> 
<p>现在，是最关键的一步，需要为VLMCSD创建系统服务，参照下述命令以及上述截图，请读者自行配置该服务。</p> 
<pre class="has"><code class="language-bash"># 拷贝Vlmcsd服务端到目标目录
cp /tmp/binaries/Linux/intel/static/vlmcsd-x64-musl-static /usr/bin/
# 修改文件权限添加可执行权限
chmod 755 /usr/bin/vlmcsd-x64-musl-static
# 为服务创建PID文件
touch /var/run/vlmcsd.pid
# 创建服务配置文件
touch /lib/systemd/system/vlmcsd.service
# 参照下述模板编辑服务配置
vim /lib/systemd/system/vlmcsd.service</code></pre> 
<blockquote> 
 <p>[Unit]<br> Description=KMS Emulator<br> After=network.target</p> 
 <p>[Service]<br> Type=forking<br> PIDFile=/var/run/vlmcsd.pid<br> ExecStart=/usr/bin/vlmcsd-x64-musl-static -p /var/run/vlmcsd.pid<br> ExecStop=/bin/kill -HUP $MAINPID<br> PrivateTmp=true</p> 
 <p>[Install]<br> WantedBy=multi-user.target</p> 
</blockquote> 
<p>服务创建完毕之后，接下来就是启动服务并开通防火墙默认1688端口，见证奇迹的时刻到了！</p> 
<p><img alt="" class="has" height="605" src="https://images2.imgbox.com/e1/e3/UGF4F7o6_o.png" width="962"></p> 
<pre class="has"><code class="language-bash"># 重新载入服务
systemctl daemon-reload
# 设置Vlmcsd服务自启动
systemctl enable vlmcsd.service
# 启动Vlmcsd服务
systemctl start  vlmcsd.service
# 添加防火墙规则放通1688端口
firewall-cmd --zone=public --add-port=1688/tcp --permanent
firewall-cmd --reload</code></pre> 
<p><img alt="" class="has" height="605" src="https://images2.imgbox.com/b5/e7/LMS4q0yj_o.png" width="962"></p> 
<pre class="has"><code class="language-bash"># 测试Vlmcsd服务器
vlmcs.exe -v -l 8 192.168.3.18</code></pre> 
<p>好了，至此，如何利用VLMCSD在Windows及Linux系统中部署KMS服务器已经讲解完毕，输入如上命令测试下服务器看看服务是否正常运行了？记得把IP地址替换成自己的哟！<span style="color:#f33b45;"><u>需要特别补充说明的是，该项目最后一次发布的RELEASE版本（也就是上文提供网盘下载的版本）仅支持到Office 2016以及Windows 10 Enterprise 2016 LTSB，是不支持、也无法激活Office 2019以及Windows 10 Enteprise LTSC 2019版本的</u></span>。支持激活的应用列表可参考下图，有更高版本需要的，请自行下载、编译最新项目代码。</p> 
<p><img alt="" class="has" height="742" src="https://images2.imgbox.com/a4/53/Zv3fAuJZ_o.png" width="962"></p> 
<h4>3. 获取最新版VLMCSD代码并编译</h4> 
<p><img alt="" class="has" height="573" src="https://images2.imgbox.com/b6/73/bEkqkrtl_o.png" width="961"></p> 
<p><img alt="" class="has" height="573" src="https://images2.imgbox.com/40/19/kdHA7noE_o.png" width="961"></p> 
<p><img alt="" class="has" height="605" src="https://images2.imgbox.com/96/c6/9dXshDuM_o.png" width="962"></p> 
<p>可以看到，最新版本的VLMCSD是支持激活Office 2019以及Windows 10 Enterprise LTSC 2019的，有需要的朋友可以自行下载编译最新项目代码获取支持，这里就不再详述了。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d7eb35a9f84866fad06d3f299762061a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SQL语言书写规范（持续更新）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cf486f58602d5fe2203a371c27decbca/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SheetJS/js-xlsx修改表头</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>