<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PC端Tab栏与页面滚动联动（VUE2.0版本） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PC端Tab栏与页面滚动联动（VUE2.0版本）" />
<meta property="og:description" content="业务背景 一个页面以tab栏作为区块划分时，tab栏与页面彼此间的联动交互，往往能提供更好的体验：点击tab栏时页面滚动到tab栏对应的页面区域，同时滚动页面时tab栏随之改变。
本文基于VUE2.0实现此功能，图例如下：
HTML部分 &lt;!-- 使用Affix（antd affix）组件固定tab在顶部48px位置上 --&gt; &lt;!-- getTargetEle确定固定目标元素（需与页面滚动元素一致） --&gt; &lt;div class=&#34;a-container&#34;&gt; &lt;Affix :offset-top=&#34;48&#34; :target=&#34;getIdEle&#34;&gt; &lt;div class=&#34;a-tabbar&#34;&gt; &lt;div v-for=&#34;(item, index) in tabList&#34; :key=&#34;item&#34; class=&#34;a-tabbar-item&#34; :class=&#34;activeKey === item ? &#39;a-tabbar-item-active&#39; : &#39;&#39;&#34; @click=&#34;handleTabClick(item, index)&#34; &gt; &lt;div class=&#34;a-tabbar-item-title&#34;&gt;tab栏{{ index }}&lt;/div&gt; &lt;!-- 分割线显示 --&gt; &lt;div v-if=&#34;index &lt; tabList.length - 1&#34; class=&#34;a-tabbar-item-split&#34;&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/Affix&gt; &lt;div class=&#34;a-content&#34;&gt; &lt;!-- 页面主体 --&gt; &lt;div class=&#34;a-content-item&#34; :class=&#34;activeKey === item ? &#39;a-content-item-active&#39; : &#39;&#39;&#34; v-for=&#34;(item, index) in tabPaneList&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/494389324309bbd1ac2bf37c8018d3a4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-24T15:45:31+08:00" />
<meta property="article:modified_time" content="2023-11-24T15:45:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PC端Tab栏与页面滚动联动（VUE2.0版本）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>业务背景</h2> 
<p>一个页面以tab栏作为区块划分时，tab栏与页面彼此间的联动交互，往往能提供更好的体验：点击tab栏时页面滚动到tab栏对应的页面区域，同时滚动页面时tab栏随之改变。</p> 
<p>本文基于VUE2.0实现此功能，图例如下：<br><img alt="" height="451" src="https://images2.imgbox.com/bd/81/T6LUM2w2_o.png" width="171"></p> 
<h2> HTML部分</h2> 
<pre><code class="language-html">
&lt;!-- 使用Affix（antd affix）组件固定tab在顶部48px位置上 --&gt;
&lt;!-- getTargetEle确定固定目标元素（需与页面滚动元素一致） --&gt;
&lt;div class="a-container"&gt;
  &lt;Affix :offset-top="48" :target="getIdEle"&gt;
    &lt;div class="a-tabbar"&gt;
      &lt;div
        v-for="(item, index) in tabList"
        :key="item"
        class="a-tabbar-item"
        :class="activeKey === item ? 'a-tabbar-item-active' : ''"
        @click="handleTabClick(item, index)"
      &gt;
        &lt;div class="a-tabbar-item-title"&gt;tab栏{<!-- -->{ index }}&lt;/div&gt;
        &lt;!-- 分割线显示 --&gt;
        &lt;div v-if="index &lt; tabList.length - 1" class="a-tabbar-item-split"&gt;&lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/Affix&gt;
  &lt;div class="a-content"&gt;
    &lt;!-- 页面主体 --&gt;
    &lt;div
      class="a-content-item"
      :class="activeKey === item ? 'a-content-item-active' : ''"
      v-for="(item, index) in tabPaneList"
      :key="item"
    &gt;
      &lt;div class="a-content-item-title"&gt;tab区域{<!-- -->{ index }}&lt;/div&gt;
      &lt;div style="height: 120px"&gt;&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;!-- 返回顶部按钮显示 --&gt;
  &lt;div class="backToTop" @click="backToTop" v-if="showScrollTop"&gt;
    &lt;i class="icon iconfont icon-fanhuidingbu"&gt;&lt;/i&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre> 
<p><span style="color:#ff9900;">注：getTargetEle一般不需格外指定，默认为window，本文因样式问题，指定为VUE根DOM——app</span></p> 
<h2>JS部分</h2> 
<pre><code class="language-javascript">export default {
  // 引入固钉组件
  components: {
    Affix,
  },
  data() {
    return {
      activeKey: "1",
      tabList: ["1", "2", "3", "4", "5", "6", "7", "8", "9"],
      tabPaneList: ["1", "2", "3", "4", "5", "6", "7", "8", "9"],
      positionList: [],
      showScrollTop: false,
    };
  },
  mounted() {
    // 页面挂载阶段添加滚动事件、获取滚动位置
    document.getElementById("app").addEventListener("scroll", this.handleScroll);
    this.getScroll()
  },
  methods: {
    getScroll() {
      setTimeout(() =&gt; {
        // 重置定位列表
        this.positionList = [];
        const contentList = document.getElementsByClassName("a-content-item");
        const container = document.getElementsByClassName("a-container")[0];
        // 获取默认高度
        const defaultTop = (container.offsetTop ? container.offsetTop : 0) - 61;
        Array.from(contentList).forEach((item) =&gt; {
          this.positionList.push(item.offsetTop + defaultTop);
        });
      });
    },
    // tab栏点击时指定页面滚动位置
    handleTabClick(key, index) {
      document.getElementById("app").scrollTop = this.positionList[index];
      this.activeKey = key;
    },
    // 返回顶部
    backToTop() {
      document.getElementById("app").scrollTo({
        top: 0,
        behavior: "smooth",
      });
    },
    handleScroll(e) {
      if (e.target.id === "app") {
        const scrollTop = e.target.scrollTop;
        this.showScrollTop = scrollTop &gt; this.positionList[2];
        // 获取就近tab activeKey
        const findNearIndex = (sT) =&gt; {
          let min = null;
          let index = 0;
          this.positionList.forEach((item, i) =&gt; {
            const distance = Math.abs(sT - item);
            if (min) {
              if (distance &lt; min) {
                min = distance;
                index = i;
              }
            } else {
              min = distance;
            }
          });
          return index;
        };
        const index = findNearIndex(scrollTop);
        this.activeKey = this.tabList[index];
      }
    },
    getIdEle() {
      return document.getElementById("app");
    },
  },
  beforeDestroy() {
    // 页面注销之前，移除滚动事件
    document.getElementById("app").removeEventListener("scroll", this.handleScroll);
  },

}</code></pre> 
<p>本文以VUE根DOM为滚动参考，页面未做特殊配置时，handleScroll事件中前两行写法</p> 
<blockquote> 
 <p><s> <span style="color:#956fe7;">if</span> (e.target.id === "<span style="color:#a2e043;">app</span>") {<!-- --><br>         <span style="color:#956fe7;">const</span> scrollTop = e.target.scrollTop;</s></p> 
 <p>                           ↓</p> 
 <p><span style="color:#956fe7;">if</span> (e.target.scrollingElement.nodeName === "<span style="color:#ff9900;">HTML</span>") {<!-- --></p> 
 <p>        <span style="color:#956fe7;">let</span> scrollTop = e.target.scrollingElement.scrollTop;</p> 
 <p></p> 
</blockquote> 
<p>handleTabClick事件代码需替换</p> 
<blockquote> 
 <p><s> <span style="color:#956fe7;">document</span>.<span style="color:#38d8f0;">getElementById</span>("<span style="color:#a2e043;">app</span>").scrollTop = <span style="color:#ff9900;">this</span>.positionList[index];</s></p> 
 <p>                           ↓</p> 
 <p> <s><span style="color:#956fe7;">document</span></s>.<span style="color:#38d8f0;">documentElement</span>.scrollTop = <span style="color:#ff9900;">this</span>.positionList[index];</p> 
</blockquote> 
<p><span style="color:#ff9900;">注： getScroll函数中defaultTop为此功能组件的默认高度，引入组件的位置有时并非在页面最顶端，需要获取默认高度。<u>61为系统顶部菜单栏高度，若系统中无顶部菜单，可忽略</u></span></p> 
<h2>CSS部分</h2> 
<pre><code class="language-css">
.a-tabbar {
  z-index: 2;
  display: flex;
  background-color: #fff;
  padding: 20px 0;
}
.a-tabbar-item {
  font-family: PingFangSC-Regular;
  font-size: 14px;
  color: #4e5969;
  display: flex;
  align-items: center;
  cursor: pointer;
  &amp;:hover {
    color: #3270ff;
  }
  .a-tabbar-item-split {
    width: 1px;
    margin: 0 12px;
    height: 15px;
    background-color: rgba(184, 188, 196, 1);
  }
}
.a-tabbar-item-active {
  color: #3270ff;
}
.a-content {
  padding-top: 0;
}
.a-content-item {
  margin-top: 32px;
  .a-content-item-title {
    font-family: PingFangSC-Medium;
    font-size: 16px;
    color: #1d2129;
    line-height: 22px;
    font-weight: 600;
    margin-bottom: 16px;
  }
}
.a-content-item:first-child {
  margin-top: 12px;
}
.a-container {
  position: relative;
}
.backToTop {
  width: 40px;
  height: 40px;
  background: #ffffff;
  box-shadow: 0px 0px 14px 0px rgba(0, 0, 0, 0.11);
  border-radius: 27px;
  display: flex;
  justify-content: center;
  align-items: center;
  position: fixed;
  right: 32px;
  bottom: 85px;
  z-index: 1;
}</code></pre> 
<h2>总结</h2> 
<p>具体实现时，还需注意tab中数据是否为异步加载，以及特殊操作时造成的tab栏与tabpane区域的变动。针对此问题的解决方案为，异步加载的回调函数（promise对象的then属性等）中，或者在特殊操作之后<span style="color:#fe2c24;"><strong>调用getScroll函数，重新获取tab项的定位列表。</strong></span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1cd5136b6024cc1616d292f58531c5b4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">前端学习（应对面试）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2efb1f9b2ce609690cf2a39a216c5470/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">前后端分离项目—通用后台管理系统（Vue &#43; SpringBoot）【二】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>