<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>安装服务器Ubuntu16&#43;Rsync&#43;Nginx&#43;php7.3&#43;MySQL&#43;Node&#43;npm&#43;Vue&#43;composer&#43;Laravel5.8&#43;let‘sEncrypt自动证书 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="安装服务器Ubuntu16&#43;Rsync&#43;Nginx&#43;php7.3&#43;MySQL&#43;Node&#43;npm&#43;Vue&#43;composer&#43;Laravel5.8&#43;let‘sEncrypt自动证书" />
<meta property="og:description" content="安装一台服务器 安装服务器MacOS下使用证书登陆SSH腾讯云安装配置rsync安装Nginx和PHP7&#43;MySQL安装node.js 和 npm安装 VUE安装Laravel 5.8Rsync命令参数详解通过指令从腾讯云SSL的CRT文件生成PEM文件ubuntu 下 安装 Let’s Encrypt 自动更新SSL证书白痴也会写Cron定时器表达式 安装服务器 MacOS下使用证书登陆SSH腾讯云 cd ~/.ssh 腾讯云证书复制进来
ssh-keygen -t rsa 看看config，里面应该是：
Host aliasname1 HostName 10.10.10.10 Port 22 User ubuntu IdentityFile ~/.ssh/zhengshumingzi Host aliasname2 HostName 11.11.11.11 Port 22 User ubuntu IdentityFile ~/.ssh/zhengshumingzi 如果出错：
Permissions 0755 for ‘zhengshu’ are too open.
则：chmod 400 *
Warning: Permanently added &#39;8.8.8.8 (ECDSA) to the list of known hosts.
则：ssh-keygen -R 8.8.8.8
然后直接 ssh aliasname1 就可以登陆服务器了。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ab0a582b5fc858a727ab7a45e131ad42/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-07T16:25:06+08:00" />
<meta property="article:modified_time" content="2023-05-07T16:25:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">安装服务器Ubuntu16&#43;Rsync&#43;Nginx&#43;php7.3&#43;MySQL&#43;Node&#43;npm&#43;Vue&#43;composer&#43;Laravel5.8&#43;let‘sEncrypt自动证书</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>安装一台服务器</h4> 
 <ul><li><a href="#_2" rel="nofollow">安装服务器</a></li><li><ul><li><a href="#MacOSSSH_3" rel="nofollow">MacOS下使用证书登陆SSH腾讯云</a></li><li><a href="#rsync_41" rel="nofollow">安装配置rsync</a></li><li><a href="#NginxPHP7MySQL_106" rel="nofollow">安装Nginx和PHP7+MySQL</a></li><li><a href="#nodejs__npm_197" rel="nofollow">安装node.js 和 npm</a></li><li><a href="#_VUE_240" rel="nofollow">安装 VUE</a></li><li><a href="#Laravel_58_302" rel="nofollow">安装Laravel 5.8</a></li><li><a href="#Rsync_365" rel="nofollow">Rsync命令参数详解</a></li><li><a href="#SSLCRTPEM_451" rel="nofollow">通过指令从腾讯云SSL的CRT文件生成PEM文件</a></li><li><a href="#ubuntu___Lets_Encrypt_SSL_459" rel="nofollow">ubuntu 下 安装 Let’s Encrypt 自动更新SSL证书</a></li><li><a href="#Cron_532" rel="nofollow">白痴也会写Cron定时器表达式</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>安装服务器</h2> 
<h3><a id="MacOSSSH_3"></a>MacOS下使用证书登陆SSH腾讯云</h3> 
<pre><code>cd ~/.ssh
</code></pre> 
<p>腾讯云证书复制进来</p> 
<pre><code>ssh-keygen -t rsa
</code></pre> 
<p>看看config，里面应该是：</p> 
<pre><code>Host    aliasname1
        HostName        10.10.10.10
        Port            22
        User            ubuntu
        IdentityFile    ~/.ssh/zhengshumingzi
Host    aliasname2
        HostName        11.11.11.11
        Port            22
        User            ubuntu
        IdentityFile    ~/.ssh/zhengshumingzi
</code></pre> 
<p>如果出错：<br> Permissions 0755 for ‘zhengshu’ are too open.<br> 则：<code>chmod 400 *</code></p> 
<p>Warning: Permanently added '8.8.8.8 (ECDSA) to the list of known hosts.<br> 则：<code>ssh-keygen -R 8.8.8.8</code></p> 
<p><strong>然后直接 <code>ssh aliasname1</code> 就可以登陆服务器了。</strong></p> 
<h3><a id="rsync_41"></a>安装配置rsync</h3> 
<p>ubuntu 16.04默认已安装rsync，rsync服务默认不是启动的，我们要修改rsync文件。</p> 
<pre><code>sudo vim /etc/default/rsync
</code></pre> 
<p>修改配置项：</p> 
<pre><code>RSYNC_ENABLE=true   #false改true
</code></pre> 
<p>创建配置文件，将rsyncd.conf 复制到 /etc目录下</p> 
<pre><code>sudo cp /usr/share/doc/rsync/examples/rsyncd.conf /etc
sudo vi /etc/rsyncd.conf
</code></pre> 
<p>其中 path 是需要同步的路径，你可以暂时只对此项配置，然后即可测试。<br> 启动 rsync</p> 
<pre><code>sudo /etc/init.d/rsync start

[ ok ] Starting rsync (via systemctl): rsync.service.
</code></pre> 
<p>设置密码：</p> 
<pre><code>sudo vi /etc/rsyncd.conf
</code></pre> 
<p>修改：</p> 
<pre><code>	auth users = zhao
	secrets file = /etc/rsyncd.secrets
</code></pre> 
<p>然后创建 密码文件：</p> 
<pre><code>sudo vi /etc/rsyncd.secrets
</code></pre> 
<p>内容为：</p> 
<pre><code>zhao:password
</code></pre> 
<p>保存后记得修改权限：</p> 
<pre><code>sudo chmod 600 /etc/rsyncd.secrets
</code></pre> 
<p>然后重启Rsync</p> 
<pre><code>sudo /etc/init.d/rsync restart
</code></pre> 
<p>客户端如果是MacOS，直接打开命令行</p> 
<pre><code>rsync -vzrtopag --progress --password-file=./rsync.pwd  .  zhao@8.8.8.8::ftp
</code></pre> 
<p>本地的 ./rsync.pwd 的内容只需要密码即可。</p> 
<p>要注意，如果有权限问题，可能是rsync.conf文件里的uid和gid与实际不符。</p> 
<h3><a id="NginxPHP7MySQL_106"></a>安装Nginx和PHP7+MySQL</h3> 
<pre><code>sudo apt-get install nginx
</code></pre> 
<p>然后</p> 
<pre><code>sudo apt-get install php7.0-fpm
</code></pre> 
<p>如果需要安装php 7.3（Laravel 高版本需求）则需要更新下库，然后安装php7.3</p> 
<pre><code>sudo apt-get install software-properties-common
sudo add-apt-repository ppa:ondrej/php
sudo apt-get update
sudo apt-get install -y php7.3
</code></pre> 
<p>安装MySQL</p> 
<pre><code>sudo apt-get install mysql-server-5.7
</code></pre> 
<p>中途会输入root密码<br> 然后<br> 安装PHP7.0的各种模块：</p> 
<pre><code>sudo apt-get install php7.0-intl       php7.0-mysql      php7.0-pspell     php7.0-sqlite3    php7.0-xsl php7.0-bcmath     php7.0-curl       php7.0-gd         php7.0-json       php7.0-odbc       php7.0-readline   php7.0-sybase     php7.0-zip php7.0-bz2        php7.0-dba        php7.0-gmp        php7.0-ldap       php7.0-opcache    php7.0-recode     php7.0-tidy   php7.0-cgi        php7.0-dev        php7.0-imap       php7.0-mbstring   php7.0-pgsql      php7.0-snmp       php7.0-xml        php7.0-cli        php7.0-enchant    php7.0-interbase  php7.0-mcrypt     php7.0-phpdbg     php7.0-soap       php7.0-xmlrpc
</code></pre> 
<p>如果要安装的PHP7.3<br> 则可以搜一下有哪些模块：</p> 
<pre><code>sudo apt-cache search php7*
</code></pre> 
<p>然后按需要或者全部安装php7.3模块：</p> 
<pre><code>sudo apt install php7.3-common php7.3-fpm php7.3-intl php7.3-odbc php7.3-readline php7.3-sybase php7.3-zip php7.3-bcmath php7.3-curl php7.3-gd php7.3-json php7.3-opcache php7.3-recode php7.3-tidy php7.3-bz2 php7.3-dba php7.3-gmp php7.3-ldap php7.3-pgsql php7.3-snmp php7.3-xml php7.3-cgi php7.3-dev php7.3-imap php7.3-mbstring php7.3-phpdbg php7.3-soap php7.3-xmlrpc php7.3-cli php7.3-enchant php7.3-interbase php7.3-mysql php7.3-pspell php7.3-sqlite3 php7.3-xsl 
</code></pre> 
<p>然后设置 php.ini</p> 
<pre><code>sudo vi /etc/php/7.0/fpm/php.ini
//找到 ;cgi.fix_pathinfo=1 
//改成 cgi.fix_pathinfo=0 
</code></pre> 
<p>修改nginx的配置：</p> 
<pre><code>sudo vi /etc/nginx/conf.d/my.conf
</code></pre> 
<p>参照sites-available下的default写就好了。<br> 关于PHP7.3+nginx的设置，范例如下：</p> 
<pre><code>server {
	listen 80;
	listen [::]:80;
	server_name api.xxx.cn;
	root /var/www/zhao/html_xxx;
	index index.html index.htm index.php;
	location / {
		try_files $uri $uri/ =404;
	}
        location ~ \.php$ {
                include snippets/fastcgi-php.conf;
                # With php7.0-cgi alone:
                #fastcgi_pass 127.0.0.1:9000;
                # With php7.0-fpm:
                fastcgi_pass unix:/run/php/php7.3-fpm.sock;
        }
}
</code></pre> 
<p>snippets/fastcgi-php.conf里面的内容如下，原来的不需要改：</p> 
<pre><code># regex to split $uri to $fastcgi_script_name and $fastcgi_path
fastcgi_split_path_info ^(.+\.php)(/.+)$;

# Check that the PHP script exists before passing it
try_files $fastcgi_script_name =404;

# Bypass the fact that try_files resets $fastcgi_path_info
# see: http://trac.nginx.org/nginx/ticket/321?
fastcgi_param PATH_INFO $path_info;

fastcgi_index index.php;
include fastcgi.conf;
</code></pre> 
<h3><a id="nodejs__npm_197"></a>安装node.js 和 npm</h3> 
<p><code>sudo apt-get update</code> 下</p> 
<p>首先需要安装依赖包python-software-properties。</p> 
<pre><code>sudo apt-get install python-software-properties
</code></pre> 
<p>安装ppa</p> 
<pre><code>curl -sL https://deb.nodesource.com/setup_8.x | sudo -E bash -
</code></pre> 
<p>如果提示没有安装curl，需要先安装curl。<br> 接下来安装nodejs，安装完成之后npm也自动安装好了。</p> 
<pre><code>sudo apt-get install nodejs
</code></pre> 
<p>安装完成之后我们查看一下nodejs和npm的版本</p> 
<pre><code>node -v
npm -v
</code></pre> 
<p>因为国内的网络环境，直接从npm官方源安装软件包速度会比较慢，甚至导致安装不成功。我们可以安装nrm工具，用于管理软件源。</p> 
<pre><code>sudo npm install -g nrm
</code></pre> 
<p>安装完成之后，列出可用的软件源：</p> 
<pre><code>sudo nrm ls
</code></pre> 
<p>在国内，我们可以使用taobao的源，速度还相对不错。</p> 
<pre><code>sudo nrm use taobao
</code></pre> 
<p>初始化一下 npm，创建 package.json</p> 
<pre><code>sudo npm init -y
</code></pre> 
<h3><a id="_VUE_240"></a>安装 VUE</h3> 
<p>由于安装vue 是会出现提示， 更新一下package.json的内容：<br> npm warn package.json @1.0.0 no repository field.</p> 
<pre><code>{
    ...
    "repository": {
        "type": "git",
        "url": "http://baidu.com"
    },
    ...
}
</code></pre> 
<p>或者声明私有化</p> 
<pre><code>{
    ...
    "private": true,
    ...
}
</code></pre> 
<p>然后安装VUE</p> 
<pre><code>sudo npm install vue
</code></pre> 
<p>Vue.js 提供一个官方命令行工具，可用于快速搭建大型单页应用。该工具提供开箱即用的构建工具配置，带来现代化的前端开发流程。只需一分钟即可启动带热重载、保存时静态检查以及可用于生产环境的构建配置的项目：</p> 
<pre><code># 全局安装 vue-cli 脚手架
$ sudo npm install --global vue-cli

#如果输入vue，出现说明，说明正常了。

# 创建一个基于 webpack 模板的新项目
$ sudo vue init webpack my-project

# 按提示回车和输入就好了。。。。

$ cd my-project
$ sudo npm install
$ sudo npm run dev
#或者
$sudo npm run build
</code></pre> 
<p>注意，npm run 后的 dist目录才是web访问的主目录。<br> 如果出现空白页面，则查看config目录下面的config.js里面的路径是否配置正确。</p> 
<p>重要: Github 仓库的 /dist 文件夹只有在新版本发布时才会更新。如果想要使用 Github 上 Vue 最新的源码，你需要自己构建。</p> 
<pre><code>sudo git clone https://github.com/vuejs/vue.git node_modules/vue
cd node_modules/vue
sudo npm install
sudo npm run build
</code></pre> 
<p>然后访问网站吧~~</p> 
<h3><a id="Laravel_58_302"></a>安装Laravel 5.8</h3> 
<p>首先安装 Composer</p> 
<pre><code>sudo curl -sS https://getcomposer.org/installer | php
</code></pre> 
<pre><code>mv composer.phar /usr/bin/composer
</code></pre> 
<p>运行 <code>composer</code> 出现版本号和说明就可以了。</p> 
<p>然后安装Laravel ，注意，不能在root和super user账号下安装。<br> 可以新建一个账号：</p> 
<pre><code>useradd -m zhao
passwd zhao
su - zhao
</code></pre> 
<p>然后再安装。</p> 
<pre><code>composer global require laravel/installer
</code></pre> 
<p>如果安装报错，composer 报错：proc_open(): fork failed</p> 
<p>解决方法：</p> 
<pre><code>/bin/dd if=/dev/zero of=/var/swap.1 bs=1M count=1024 
/sbin/mkswap /var/swap.1 
/sbin/swapon /var/swap.1
</code></pre> 
<p>安装完了laravel ，创建一个项目：</p> 
<pre><code>~/.config/composer/vendor/bin/laravel new myproject
</code></pre> 
<p>laravel找不到的话，就看一下安装上一步时候提示的路径。</p> 
<blockquote> 
 <p>Changed current directory to /home/用户名/.config/composer</p> 
</blockquote> 
<p>创建完成提示：</p> 
<blockquote> 
 <p>…<br> Package manifest generated successfully.<br> Application ready! Build something amazing.</p> 
</blockquote> 
<p>如果之前已经安装过旧版本的 Laravel 安装器，需要更新后才能安装基于 Laravel 5.8 框架的新应用：</p> 
<pre><code>composer global update
</code></pre> 
<p>安装完成后， myproject 目录就是项目目录。可以复制到指定地方，注意权限。<br> 访问 目录中的 public/index.php 就是入口</p> 
<p><a href="https://laravelacademy.org/category/laravel-5_8" rel="nofollow">Laravel 5.8 学院文档</a></p> 
<h3><a id="Rsync_365"></a>Rsync命令参数详解</h3> 
<p>Rsync 的几种指令格式：</p> 
<pre><code>rsync [OPTION]... SRC DEST
#拷贝本地文件。当SRC和DES路径信息都不包含有单个冒号”:”分隔符时就启动这种工作模式。如：rsync -a /data /backup

rsync [OPTION]... SRC [USER@]HOST:DEST
#使用一个远程shell程序(如rsh、ssh)来实现将本地机器的内容拷贝到远程机器。当DST路径地址包含单个冒号”:”分隔符时启动该模式。如：rsync -avz *.c foo:src

rsync [OPTION]... [USER@]HOST:SRC DEST
#使用一个远程shell程序(如rsh、ssh)来实现将远程机器的内容拷贝到本地机器。当SRC地址路径包含单个冒号”:”分隔符时启动该模式。如：rsync -avz foo:src/bar /data

rsync [OPTION]... [USER@]HOST::SRC DEST
#从远程rsync服务器中拷贝文件到本地机。当SRC路径信息包含”::”分隔符时启动该模式。如：rsync -av root@8.8.8.8::www /databack

rsync [OPTION]... SRC [USER@]HOST::DEST
#从本地机器拷贝文件到远程rsync服务器中。当DST路径信息包含”::”分隔符时启动该模式。如：rsync -av /databack root@8.8.8.8::www

rsync [OPTION]... rsync://[USER@]HOST[:PORT]/SRC [DEST]
#列远程机的文件列表。这类似于rsync传输，不过只要在命令中省略掉本地机信息即可。如：rsync -v rsync://8.8.8.8/www
</code></pre> 
<p>rsync参数的具体解释如下：</p> 
<blockquote> 
 <p>-v, --verbose 详细模式输出<br> -q, --quiet 精简输出模式<br> -c, --checksum 打开校验开关，强制对文件传输进行校验<br> -a, --archive 归档模式，表示以递归方式传输文件，并保持所有文件属性，等于-rlptgoD<br> -r, --recursive 对子目录以递归模式处理<br> -R, --relative 使用相对路径信息<br> -b, --backup 创建备份，也就是对于目的已经存在有同样的文件名时，将老的文件重新命名为~filename。可以使用–suffix选项来指定不同的备份文件前缀。<br> –backup-dir 将备份文件(如~filename)存放在在目录下。<br> -suffix=SUFFIX 定义备份文件前缀<br> -u, --update 仅仅进行更新，也就是跳过所有已经存在于DST，并且文件时间晚于要备份的文件。(不覆盖更新的文件)<br> -l, --links 保留软链结<br> -L, --copy-links 想对待常规文件一样处理软链结<br> –copy-unsafe-links 仅仅拷贝指向SRC路径目录树以外的链结<br> –safe-links 忽略指向SRC路径目录树以外的链结<br> -H, --hard-links 保留硬链结<br> -p, --perms 保持文件权限<br> -o, --owner 保持文件属主信息<br> -g, --group 保持文件属组信息<br> -D, --devices 保持设备文件信息<br> -t, --times 保持文件时间信息<br> -S, --sparse 对稀疏文件进行特殊处理以节省DST的空间<br> -n, --dry-run现实哪些文件将被传输<br> -W, --whole-file 拷贝文件，不进行增量检测<br> -x, --one-file-system 不要跨越文件系统边界<br> -B, --block-size=SIZE 检验算法使用的块尺寸，默认是700字节<br> -e, --rsh=COMMAND 指定使用rsh、ssh方式进行数据同步<br> –rsync-path=PATH 指定远程服务器上的rsync命令所在路径信息<br> -C, --cvs-exclude 使用和CVS一样的方法自动忽略文件，用来排除那些不希望传输的文件<br> –existing 仅仅更新那些已经存在于DST的文件，而不备份那些新创建的文件<br> –delete 删除那些DST中SRC没有的文件<br> –delete-excluded 同样删除接收端那些被该选项指定排除的文件<br> –delete-after 传输结束以后再删除<br> –ignore-errors 及时出现IO错误也进行删除<br> –max-delete=NUM 最多删除NUM个文件<br> –partial 保留那些因故没有完全传输的文件，以是加快随后的再次传输<br> –force 强制删除目录，即使不为空<br> –numeric-ids 不将数字的用户和组ID匹配为用户名和组名<br> –timeout=TIME IP超时时间，单位为秒<br> -I, --ignore-times 不跳过那些有同样的时间和长度的文件<br> –size-only 当决定是否要备份文件时，仅仅察看文件大小而不考虑文件时间<br> –modify-window=NUM 决定文件是否时间相同时使用的时间戳窗口，默认为0<br> -T --temp-dir=DIR 在DIR中创建临时文件<br> –compare-dest=DIR 同样比较DIR中的文件来决定是否需要备份<br> -P 等同于 --partial<br> –progress 显示备份过程<br> -z, --compress 对备份的文件在传输时进行压缩处理<br> –exclude=PATTERN 指定排除不需要传输的文件模式<br> –include=PATTERN 指定不排除而需要传输的文件模式<br> –exclude-from=FILE 排除FILE中指定模式的文件<br> –include-from=FILE 不排除FILE指定模式匹配的文件<br> –version 打印版本信息<br> –address 绑定到特定的地址<br> –config=FILE 指定其他的配置文件，不使用默认的rsyncd.conf文件<br> –port=PORT 指定其他的rsync服务端口<br> –blocking-io 对远程shell使用阻塞IO<br> -stats 给出某些文件的传输状态<br> –progress 在传输时现实传输过程<br> –log-format=formAT 指定日志文件格式<br> –password-file=FILE 从FILE中得到密码<br> –bwlimit=KBPS 限制I/O带宽，KBytes per second<br> -h, --help 显示帮助信息</p> 
</blockquote> 
<h3><a id="SSLCRTPEM_451"></a>通过指令从腾讯云SSL的CRT文件生成PEM文件</h3> 
<pre><code>openssl x509 -in mycert.crt -out mycert.pem -outform PEM
</code></pre> 
<h3><a id="ubuntu___Lets_Encrypt_SSL_459"></a>ubuntu 下 安装 Let’s Encrypt 自动更新SSL证书</h3> 
<p>安装 letsencrypt</p> 
<pre><code>sudo apt-get install letsencrypt
</code></pre> 
<p>生成证书</p> 
<pre><code>sudo letsencrypt certonly --webroot -w /var/www/html -d www.domain.com -d domain.com 
</code></pre> 
<p>注意：</p> 
<blockquote> 
 <p>********* 很重要 *******必须先配置 80端口可以访问该域名，才能够生成证书！！！！！<br> certonly 表示只颁发证书<br> –webroot 表示自动验证域名<br> -w 表示网站目录 （所以后面的路径，必须是该域名的主目录，需要验证域名有效性，要保证此目录可以通过http访问到。 ）<br> -d 表示颁发证书的域名，可以配置该目录下的多个域名。</p> 
</blockquote> 
<p>配置 nginx 服务器</p> 
<pre><code>#如果需要自动重生成证书，记得要有80端口访问，否则验证域名会失败。

server {
	listen 80;
	listen [::]:80;
	server_name www.domain.com domain.com;
	root ...... 省略
}

server {
        listen 443;
        listen [::]:443;
        server_name www.domain.com domain.com;
        
        ssl_certificate /etc/letsencrypt/live/www.a.com/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/www.a.com/privkey.pem;
        ssl on;
 ... 下面省略
}

</code></pre> 
<p>然后重启动 Nginx</p> 
<pre><code>sudo service nginx restart
</code></pre> 
<p>证书每三个月会失效，所以还要重新申请，重新申请很简单，一条指令即可：</p> 
<pre><code>sudo certbot renew
或者
sudo certbot renew --quiet --force-renewal
</code></pre> 
<p>如果不想每三个月登陆服务器输入一次，那就配置一下 crontab ，每两个月自动执行一次。</p> 
<pre><code>sudo vi /etc/crontab
</code></pre> 
<p>在开头加上：</p> 
<pre><code>SHELL=/bin/bash
PATH=/sbin:/bin:/usr/sbin:/usr/bin
# 下面的是 ubuntu 自带。
SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

0 0 1 */2 * root certbot renew --quiet --force-renewal
... 后面原有的不变
</code></pre> 
<h3><a id="Cron_532"></a>白痴也会写Cron定时器表达式</h3> 
<p>到现在都记不住 cron定时器表达式怎么写，终于不用再动脑子了。<br> 直接在线生成表达式吧~</p> 
<p><a href="http://cron.qqe2.com/" rel="nofollow">在线 Cron 定时器表达式生成</a><br> 直接点击上面或者输入网页：http://cron.qqe2.com/</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d7679e26c361f7a72cfc4c4d62ff7cf7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">微信小程序如何通过fastadmin的api获取openid和手机号码？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2fbad11db849fd98d2e11e5ab35e67e8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">高并发秒杀系统解决方案</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>