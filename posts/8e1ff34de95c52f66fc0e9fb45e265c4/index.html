<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MyBatis 的使用方法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MyBatis 的使用方法" />
<meta property="og:description" content="观前提示:本篇博客演示使用的 IDEA 版本为2021.3.3版本,使用的是Java8(又名jdk1.8)
前端使用 VSCode(Visual Studio Code1.78.2)
电脑使用的操作系统版本为 Windows 10
目录
Mybatis是什么?
Mybatis 有什么用?
Mybatis 框架交流
Mybatis 项目环境搭建
1. 添加 Mybatis 框架支持
2.设置 Mybatis 配置信息
2.1 建立数据库
2.2 设置数据库连接的相关信息以及 MyBatis 的 xml 保存路径和 xml 命名模式
Mybatis 模式开发
后端开发思路
添加实体类
添加 Mapper 接口
添加 Mapper.xml
添加 Service
添加 Controller
启动项目
单元测试
进入单元测试
Mybatis 动态获取参数
参数占位符 #{} 和 ${}
# 和 $ 的区别
SQL 注入 $ 优点
改、删、增操作
1. 修改密码
2. 删除用户操作" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/8e1ff34de95c52f66fc0e9fb45e265c4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-21T02:18:11+08:00" />
<meta property="article:modified_time" content="2023-06-21T02:18:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MyBatis 的使用方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="color:#ff9900;">观前提示:本篇博客演示使用的 IDEA 版本为2021.3.3版本,使用的是Java8(又名jdk1.8)</span></p> 
<p><span style="color:#ff9900;">前端使用 VSCode(Visual Studio Code1.78.2)</span></p> 
<p><span style="color:#ff9900;">电脑使用的操作系统版本为 Windows 10</span></p> 
<hr> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="Mybatis%E6%98%AF%E4%BB%80%E4%B9%88%3F-toc" style="margin-left:0px;"><a href="#Mybatis%E6%98%AF%E4%BB%80%E4%B9%88%3F" rel="nofollow">Mybatis是什么?</a></p> 
<p id="Mybatis%20%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8%3F-toc" style="margin-left:0px;"><a href="#Mybatis%20%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8%3F" rel="nofollow">Mybatis 有什么用?</a></p> 
<p id="Mybatis%20%E6%A1%86%E6%9E%B6%E4%BA%A4%E6%B5%81-toc" style="margin-left:40px;"><a href="#Mybatis%20%E6%A1%86%E6%9E%B6%E4%BA%A4%E6%B5%81" rel="nofollow">Mybatis 框架交流</a></p> 
<p id="Mybatis%20%E9%A1%B9%E7%9B%AE%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-toc" style="margin-left:0px;"><a href="#Mybatis%20%E9%A1%B9%E7%9B%AE%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA" rel="nofollow">Mybatis 项目环境搭建</a></p> 
<p id="1.%20%E6%B7%BB%E5%8A%A0%20Mybatis%20%E6%A1%86%E6%9E%B6%E6%94%AF%E6%8C%81-toc" style="margin-left:40px;"><a href="#1.%20%E6%B7%BB%E5%8A%A0%20Mybatis%20%E6%A1%86%E6%9E%B6%E6%94%AF%E6%8C%81" rel="nofollow">1. 添加 Mybatis 框架支持</a></p> 
<p id="2.%E8%AE%BE%E7%BD%AE%20Mybatis%20%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF-toc" style="margin-left:40px;"><a href="#2.%E8%AE%BE%E7%BD%AE%20Mybatis%20%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF" rel="nofollow">2.设置 Mybatis 配置信息</a></p> 
<p id="2.1%20%E5%BB%BA%E7%AB%8B%E6%95%B0%E6%8D%AE%E5%BA%93-toc" style="margin-left:80px;"><a href="#2.1%20%E5%BB%BA%E7%AB%8B%E6%95%B0%E6%8D%AE%E5%BA%93" rel="nofollow">2.1 建立数据库</a></p> 
<p id="2.2%C2%A0%E8%AE%BE%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E7%9A%84%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E4%BB%A5%E5%8F%8A%20MyBatis%20%E7%9A%84%20xml%20%E4%BF%9D%E5%AD%98%E8%B7%AF%E5%BE%84%E5%92%8C%20xml%20%E5%91%BD%E5%90%8D%E6%A8%A1%E5%BC%8F-toc" style="margin-left:80px;"><a href="#2.2%C2%A0%E8%AE%BE%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E7%9A%84%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E4%BB%A5%E5%8F%8A%20MyBatis%20%E7%9A%84%20xml%20%E4%BF%9D%E5%AD%98%E8%B7%AF%E5%BE%84%E5%92%8C%20xml%20%E5%91%BD%E5%90%8D%E6%A8%A1%E5%BC%8F" rel="nofollow">2.2 设置数据库连接的相关信息以及 MyBatis 的 xml 保存路径和 xml 命名模式</a></p> 
<p id="Mybatis%20%E6%A8%A1%E5%BC%8F%E5%BC%80%E5%8F%91-toc" style="margin-left:0px;"><a href="#Mybatis%20%E6%A8%A1%E5%BC%8F%E5%BC%80%E5%8F%91" rel="nofollow">Mybatis 模式开发</a></p> 
<p id="%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E6%80%9D%E8%B7%AF-toc" style="margin-left:40px;"><a href="#%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E6%80%9D%E8%B7%AF" rel="nofollow">后端开发思路</a></p> 
<p id="%E6%B7%BB%E5%8A%A0%E5%AE%9E%E4%BD%93%E7%B1%BB-toc" style="margin-left:40px;"><a href="#%E6%B7%BB%E5%8A%A0%E5%AE%9E%E4%BD%93%E7%B1%BB" rel="nofollow">添加实体类</a></p> 
<p id="%E6%B7%BB%E5%8A%A0%20Mapper%20%E6%8E%A5%E5%8F%A3-toc" style="margin-left:40px;"><a href="#%E6%B7%BB%E5%8A%A0%20Mapper%20%E6%8E%A5%E5%8F%A3" rel="nofollow">添加 Mapper 接口</a></p> 
<p id="%E6%B7%BB%E5%8A%A0%20Mapper.xml-toc" style="margin-left:40px;"><a href="#%E6%B7%BB%E5%8A%A0%20Mapper.xml" rel="nofollow">添加 Mapper.xml</a></p> 
<p id="%E6%B7%BB%E5%8A%A0%20Service-toc" style="margin-left:40px;"><a href="#%E6%B7%BB%E5%8A%A0%20Service" rel="nofollow">添加 Service</a></p> 
<p id="%E6%B7%BB%E5%8A%A0%20Controller-toc" style="margin-left:40px;"><a href="#%E6%B7%BB%E5%8A%A0%20Controller" rel="nofollow">添加 Controller</a></p> 
<p id="%E5%90%AF%E5%8A%A8%E9%A1%B9%E7%9B%AE-toc" style="margin-left:80px;"><a href="#%E5%90%AF%E5%8A%A8%E9%A1%B9%E7%9B%AE" rel="nofollow">启动项目</a></p> 
<p id="%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95-toc" style="margin-left:40px;"><a href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95" rel="nofollow">单元测试</a></p> 
<p id="%E8%BF%9B%E5%85%A5%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95-toc" style="margin-left:80px;"><a href="#%E8%BF%9B%E5%85%A5%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95" rel="nofollow">进入单元测试</a></p> 
<p id="Mybatis%20%E5%8A%A8%E6%80%81%E8%8E%B7%E5%8F%96%E5%8F%82%E6%95%B0-toc" style="margin-left:40px;"><a href="#Mybatis%20%E5%8A%A8%E6%80%81%E8%8E%B7%E5%8F%96%E5%8F%82%E6%95%B0" rel="nofollow">Mybatis 动态获取参数</a></p> 
<p id="%E5%8F%82%E6%95%B0%E5%8D%A0%E4%BD%8D%E7%AC%A6%20%23%7B%7D%20%E5%92%8C%20%24%7B%7D-toc" style="margin-left:80px;"><a href="#%E5%8F%82%E6%95%B0%E5%8D%A0%E4%BD%8D%E7%AC%A6%20%23%7B%7D%20%E5%92%8C%20%24%7B%7D" rel="nofollow">参数占位符 #{} 和 ${}</a></p> 
<p id="%23%20%E5%92%8C%20%24%20%E7%9A%84%E5%8C%BA%E5%88%AB-toc" style="margin-left:120px;"><a href="#%23%20%E5%92%8C%20%24%20%E7%9A%84%E5%8C%BA%E5%88%AB" rel="nofollow"># 和 $ 的区别</a></p> 
<p id="SQL%20%E6%B3%A8%E5%85%A5%C2%A0-toc" style="margin-left:160px;"><a href="#SQL%20%E6%B3%A8%E5%85%A5%C2%A0" rel="nofollow">SQL 注入 </a></p> 
<p id="%24%C2%A0%20%E4%BC%98%E7%82%B9-toc" style="margin-left:160px;"><a href="#%24%C2%A0%20%E4%BC%98%E7%82%B9" rel="nofollow">$  优点</a></p> 
<p id="%E6%94%B9%E3%80%81%E5%88%A0%E3%80%81%E5%A2%9E%E6%93%8D%E4%BD%9C-toc" style="margin-left:40px;"><a href="#%E6%94%B9%E3%80%81%E5%88%A0%E3%80%81%E5%A2%9E%E6%93%8D%E4%BD%9C" rel="nofollow">改、删、增操作</a></p> 
<p id="1.%20%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81-toc" style="margin-left:80px;"><a href="#1.%20%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81" rel="nofollow">1. 修改密码</a></p> 
<p id="2.%20%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7%E6%93%8D%E4%BD%9C-toc" style="margin-left:80px;"><a href="#2.%20%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7%E6%93%8D%E4%BD%9C" rel="nofollow">2. 删除用户操作</a></p> 
<p id="3.%20%E5%A2%9E%E5%8A%A0%E7%94%A8%E6%88%B7%E6%93%8D%E4%BD%9C-toc" style="margin-left:80px;"><a href="#3.%20%E5%A2%9E%E5%8A%A0%E7%94%A8%E6%88%B7%E6%93%8D%E4%BD%9C" rel="nofollow">3. 增加用户操作</a></p> 
<p id="%E7%89%B9%E5%88%AB%E7%9A%84%E6%B7%BB%E5%8A%A0%3A%20%E8%BF%94%E5%9B%9E%E8%87%AA%E5%A2%9E%20id-toc" style="margin-left:120px;"><a href="#%E7%89%B9%E5%88%AB%E7%9A%84%E6%B7%BB%E5%8A%A0%3A%20%E8%BF%94%E5%9B%9E%E8%87%AA%E5%A2%9E%20id" rel="nofollow">特别的添加: 返回自增 id</a></p> 
<p id="%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C-toc" style="margin-left:40px;"><a href="#%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C" rel="nofollow">查询操作</a></p> 
<p id="1.%20%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2-toc" style="margin-left:80px;"><a href="#1.%20%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2" rel="nofollow">1. 模糊查询</a></p> 
<p id="2.%20%E5%A4%9A%E8%A1%A8%E8%81%94%E6%9F%A5-toc" style="margin-left:80px;"><a href="#2.%20%E5%A4%9A%E8%A1%A8%E8%81%94%E6%9F%A5" rel="nofollow">2. 多表联查</a></p> 
<p id="%E5%B9%B6%E5%8F%91%E6%9F%A5%E8%AF%A2-toc" style="margin-left:120px;"><a href="#%E5%B9%B6%E5%8F%91%E6%9F%A5%E8%AF%A2" rel="nofollow">并发查询</a></p> 
<p id="%E5%8A%A8%E6%80%81%20SQL%C2%A0-toc" style="margin-left:40px;"><a href="#%E5%8A%A8%E6%80%81%20SQL%C2%A0" rel="nofollow">动态 SQL </a></p> 
<p id="%3Cif%3E%20%E6%A0%87%E7%AD%BE-toc" style="margin-left:80px;"><a href="#%3Cif%3E%20%E6%A0%87%E7%AD%BE" rel="nofollow"> 标签</a></p> 
<p id="%3Ctrim%3E%20%E6%A0%87%E7%AD%BE-toc" style="margin-left:80px;"><a href="#%3Ctrim%3E%20%E6%A0%87%E7%AD%BE" rel="nofollow"> 标签</a></p> 
<p id="Mybatis%20%E4%B8%AD%E5%A4%9A%E4%B8%AA%E9%83%BD%E6%98%AF%E9%9D%9E%E5%BF%85%E4%BC%A0%E5%8F%82%E6%95%B0%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-toc" style="margin-left:40px;"><a href="#Mybatis%20%E4%B8%AD%E5%A4%9A%E4%B8%AA%E9%83%BD%E6%98%AF%E9%9D%9E%E5%BF%85%E4%BC%A0%E5%8F%82%E6%95%B0%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" rel="nofollow">Mybatis 中多个都是非必传参数的解决方案</a></p> 
<p id="%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%881%3A%201%3D1%20%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-toc" style="margin-left:80px;"><a href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%881%3A%201%3D1%20%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" rel="nofollow">解决方案1: 1=1 解决方案</a></p> 
<p id="%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%882%3A%20trim%20%E7%9A%84%E6%96%B9%E5%BC%8F-toc" style="margin-left:80px;"><a href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%882%3A%20trim%20%E7%9A%84%E6%96%B9%E5%BC%8F" rel="nofollow">解决方案2: trim 的方式</a></p> 
<p id="%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%883%3A%20%3Cwhere%3E%20%E6%A0%87%E7%AD%BE%E6%96%B9%E5%BC%8F-toc" style="margin-left:80px;"><a href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%883%3A%20%3Cwhere%3E%20%E6%A0%87%E7%AD%BE%E6%96%B9%E5%BC%8F" rel="nofollow">解决方案3: 标签方式</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="Mybatis%E6%98%AF%E4%BB%80%E4%B9%88%3F">Mybatis是什么?</h2> 
<p>MyBatis是一款优秀的Java持久层框架。它通过 XML 或注解的方式将要执行的 SQL 语句映射成为 Java 对象中的方法，然后利用 JDBC 执行 SQL 并将查</p> 
<p>询结果映射为 Java 对象返回。MyBatis 的设计思想是将 SQL 语句与 Java 代码分离，通过 XML 或注解来定义 SQL 语句，这样不仅方便了开发人员对 SQL</p> 
<p>语句进行管理和维护，而且使得 SQL 语句与 Java 代码解耦，提高了代码的可读性和可维护性。</p> 
<p></p> 
<h2 id="Mybatis%20%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8%3F">Mybatis 有什么用?</h2> 
<p>对于后端开发来说，程序是由以下两个重要的部分组成的：</p> 
<p>1. 后端程序</p> 
<p>2. 数据库</p> 
<p><img alt="" height="620" src="https://images2.imgbox.com/3d/75/A8UmMcxL_o.png" width="1200"></p> 
<p></p> 
<p>使用 JDBC ，整个操作⾮常的繁琐，我们不但要拼接每⼀个参数，⽽且还要按照模板代码的⽅式，⼀步步的操作数据库，并且在每次操作完，还要⼿动关</p> 
<p>闭连接等，⽽所有的这些操作步骤都需要在每个⽅法中重复书写。</p> 
<p>MyBatis 可以帮助我们更⽅便、更快速的操作数据库。</p> 
<p></p> 
<h3 id="Mybatis%20%E6%A1%86%E6%9E%B6%E4%BA%A4%E6%B5%81">Mybatis 框架交流</h3> 
<p><img alt="" height="736" src="https://images2.imgbox.com/83/6f/wQ9tPaN4_o.png" width="1200"></p> 
<p></p> 
<p><span style="color:#fe2c24;">MyBatis 是⼀个 ORM 框架，ORM（Object Relational Mapping），即对象关系映射。在⾯向对象编程语⾔中，将关系型数据库中的数据与对象建⽴起</span></p> 
<p><span style="color:#fe2c24;">映射关系，进⽽⾃动的完成数据与对象的互相转换：</span></p> 
<p><span style="color:#fe2c24;">1. 将输⼊数据（即传⼊对象）+SQL 映射成原⽣ SQL</span></p> 
<p><span style="color:#fe2c24;">2. 将结果集映射为返回对象，即输出对象</span></p> 
<p><span style="color:#1a439c;">ORM 把数据库映射为对象：</span></p> 
<p><span style="color:#1a439c;">数据库表（table）--&gt; 类（class）</span></p> 
<p><span style="color:#1a439c;">记录（record，⾏数据）--&gt; 对象（object）</span></p> 
<p><span style="color:#1a439c;">字段（field） --&gt; 对象的属性（attribute）</span></p> 
<p>⼀般的 ORM 框架，会将数据库模型的每张表都映射为⼀个 Java 类。也就是说使⽤ MyBatis 可以像操作对象⼀样来操作数据库中的表，可以实现对象和</p> 
<p>数据库表之间的转换。</p> 
<p></p> 
<h2 id="Mybatis%20%E9%A1%B9%E7%9B%AE%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA">Mybatis 项目环境搭建</h2> 
<h3 id="1.%20%E6%B7%BB%E5%8A%A0%20Mybatis%20%E6%A1%86%E6%9E%B6%E6%94%AF%E6%8C%81">1. 添加 Mybatis 框架支持</h3> 
<p>还是先创建一个 Spring-Boot项目, 把Spring Boot DevTools, Lombok, Spring Web 勾选上</p> 
<p>再找到 SQL, 把MyBatis Framework 和 MySQL Driver 勾选上</p> 
<p>到目前为止,一个带有 Mybatis 的 Spring-Boot项目已经创建完成</p> 
<p></p> 
<p><img alt="" height="691" src="https://images2.imgbox.com/28/14/FFz8tDIU_o.png" width="1200"></p> 
<p></p> 
<p>虽然 MyBatis 项目创建完成了, 但是启动的时候是必然会失败的</p> 
<p>原因很简单, <strong>没有连接数据库</strong></p> 
<p></p> 
<h3 id="2.%E8%AE%BE%E7%BD%AE%20Mybatis%20%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF">2.设置 Mybatis 配置信息</h3> 
<p>在 <strong>application.properties</strong> 里面进行连接数据库操作, 在连接之前需要先建立数据库</p> 
<p></p> 
<h4 id="2.1%20%E5%BB%BA%E7%AB%8B%E6%95%B0%E6%8D%AE%E5%BA%93">2.1 建立数据库</h4> 
<pre><code>-- 创建数据库
drop database if exists bolgtest;
create database bolgtest DEFAULT CHARACTER SET utf8mb4;

-- 使用数据数据
use bolgtest;

-- 创建表[用户表]
drop table if exists  userinfo;
create table userinfo(
    id int primary key auto_increment,
    username varchar(100) not null,
    password varchar(32) not null,
    photo varchar(500) default '',
    createtime timestamp default current_timestamp,
    updatetime timestamp default current_timestamp,
    `state` int default 1
) default charset 'utf8mb4';

-- 创建文章表
drop table if exists  articleinfo;
create table articleinfo(
    id int primary key auto_increment,
    title varchar(100) not null,
    content text not null,
    createtime timestamp default current_timestamp,
    updatetime timestamp default current_timestamp,
    uid int not null,
    rcount int not null default 1,
    `state` int default 1
)default charset 'utf8mb4';

-- 创建视频表
drop table if exists videoinfo;
create table videoinfo(
  	vid int primary key,
  	`title` varchar(250),
  	`url` varchar(1000),
		createtime timestamp default current_timestamp,
		updatetime timestamp default current_timestamp,
  	uid int
)default charset 'utf8mb4';

-- 添加一个用户信息
INSERT INTO `bolgtest`.`userinfo` (`id`, `username`, `password`, `photo`, `createtime`, `updatetime`, `state`) VALUES 
(1, 'admin', 'admin', '', '2021-12-06 17:10:48', '2021-12-06 17:10:48', 1);

-- 文章添加测试数据
insert into articleinfo(title,content,uid)
    values('Java','Java正文',1);
    
-- 添加视频
insert into videoinfo(vid,title,url,uid) values(1,'java title','http://www.baidu.com',1);</code></pre> 
<p></p> 
<p><img alt="" height="639" src="https://images2.imgbox.com/d9/01/XC2L6V7g_o.png" width="1200"></p> 
<p></p> 
<p>数据库建立成功就会提示 Query OK ,1 row affected</p> 
<p>只要最后一行都显示这个,前面就不用看了</p> 
<p></p> 
<h4 id="2.2%C2%A0%E8%AE%BE%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E7%9A%84%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E4%BB%A5%E5%8F%8A%20MyBatis%20%E7%9A%84%20xml%20%E4%BF%9D%E5%AD%98%E8%B7%AF%E5%BE%84%E5%92%8C%20xml%20%E5%91%BD%E5%90%8D%E6%A8%A1%E5%BC%8F">2.2 设置数据库连接的相关信息以及 MyBatis 的 xml 保存路径和 xml 命名模式</h4> 
<pre><code class="hljs">#1.链接数据库
spring.datasource.url=jdbc:mysql://localhost:3306/bolgtest?characterEncoding=utf8&amp;useSSL=false
spring.datasource.username=root
# 注意！！！ password 要写自己本机mysql密码，不是固定的111111
spring.datasource.password=111111
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
# 2.设置MyBatis
mybatis.mapper-locations=classpath:/mybatis/*Mapper.xml
#打印 mybatis 执行 SQL
mybatis.configuration.log-impl=org.apache.ibatis.logging.stdout.StdOutImpl
#配置打印
logging.level.com.example.demo=debug</code></pre> 
<p></p> 
<p><span style="color:#fe2c24;"><strong>注意: </strong></span></p> 
<p><img alt="" height="296" src="https://images2.imgbox.com/d6/4e/S7pNUdqw_o.png" width="1200"></p> 
<p> </p> 
<p><img alt="" height="329" src="https://images2.imgbox.com/79/f5/6VbJgLax_o.png" width="866"> </p> 
<p> </p> 
<p><img alt="" height="586" src="https://images2.imgbox.com/27/78/4V40tkeo_o.png" width="1200"></p> 
<p></p> 
<p><img alt="" height="625" src="https://images2.imgbox.com/8f/0e/AtVnhmKG_o.png" width="1200"> </p> 
<p><img alt="" height="738" src="https://images2.imgbox.com/43/dc/TqeKcHaY_o.png" width="1200"></p> 
<p></p> 
<h2 id="Mybatis%20%E6%A8%A1%E5%BC%8F%E5%BC%80%E5%8F%91">Mybatis 模式开发</h2> 
<h3 id="%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E6%80%9D%E8%B7%AF">后端开发思路</h3> 
<p>下⾯按照后端开发的⼯程思路，也就是下⾯的流程来实现 MyBatis 查询所有⽤户的功能</p> 
<p><img alt="" height="811" src="https://images2.imgbox.com/9d/88/nrF4nH2m_o.png" width="1200"></p> 
<p></p> 
<p>本篇博客建立分层就是按照上图进行建立, 不过是先建立实体类, 在按照 Mapper -&gt; Servic -&gt; Controller 的顺序建立 </p> 
<p></p> 
<h3 id="%E6%B7%BB%E5%8A%A0%E5%AE%9E%E4%BD%93%E7%B1%BB">添加实体类</h3> 
<p>在 com.example.demo 建立 Entity, 再在 Entity  里建 UserEntity 类</p> 
<p><span style="color:#fe2c24;">实体类里面有什么东西, 取决于数据库里面有什么东西</span></p> 
<p></p> 
<p><img alt="" height="639" src="https://images2.imgbox.com/f1/05/6g6lTRio_o.png" width="955"></p> 
<p></p> 
<p>把数据库 userinfo 里面的信息全部录入到 UserEntity 里面, 剩下的 mybatis 自己会解决</p> 
<p></p> 
<pre><code class="hljs">package com.example.demo.Entity;

import lombok.Data;

import java.time.LocalDateTime;

@Data
public class UserEntity {
    private Integer id;
    private String username;
    private String password;
    private String photo;
    private LocalDateTime createtime;
    private LocalDateTime updatetime;
    private Integer state;
}
</code></pre> 
<p></p> 
<h3 id="%E6%B7%BB%E5%8A%A0%20Mapper%20%E6%8E%A5%E5%8F%A3">添加 Mapper 接口</h3> 
<p><span style="color:#fe2c24;">注意: Mapper 接口是 interface, 让其它层可以注入使用的接口</span></p> 
<p>在 com.example.demo 建立 Mapper, 再在 Mapper 里建 UserMapper 接口</p> 
<pre><code class="hljs">package com.example.demo.Mapper;

import com.example.demo.Entity.UserEntity;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Param;

import java.util.List;

@Mapper
public interface UserMapper {
    List&lt;UserEntity&gt; getAll()
}
</code></pre> 
<p></p> 
<h3 id="%E6%B7%BB%E5%8A%A0%20Mapper.xml">添加 Mapper.xml</h3> 
<p><span style="color:#fe2c24;">注意: 具体实现 sql(它是 interface 的 "实现")</span></p> 
<p>在 resource 里建立 Mybatis, 再在 Mybatis里建 UserMapper.xml</p> 
<pre><code class="hljs">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;
&lt;mapper namespace="com.example.demo.Mapper.UserMapper"&gt;
    &lt;select id="getAll" resultType="com.example.demo.Entity.UserEntity"&gt;
        select * from userinfo
    &lt;/select&gt;
&lt;/mapper&gt;</code></pre> 
<p></p> 
<p><span style="color:#fe2c24;"><strong>注意: </strong></span></p> 
<p><img alt="" height="776" src="https://images2.imgbox.com/02/32/DCn4PPmf_o.png" width="1200"></p> 
<p> </p> 
<h3 id="%E6%B7%BB%E5%8A%A0%20Service">添加 Service</h3> 
<pre><code class="hljs">package com.example.demo.Service;

import com.example.demo.Entity.UserEntity;
import com.example.demo.Mapper.UserMapper;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class UserService {
    @Autowired
    private UserMapper userMapper;

    public List&lt;UserEntity&gt; getAll() {
        return userMapper.getAll();
    }
}
</code></pre> 
<p></p> 
<h3 id="%E6%B7%BB%E5%8A%A0%20Controller">添加 Controller</h3> 
<pre><code class="hljs">package com.example.demo.Controller;

import com.example.demo.Entity.UserEntity;
import com.example.demo.Service.UserService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;

@RestController
@RequestMapping("/user")
public class UserController {
    @Autowired
    private UserService userService;

    @RequestMapping("/getall")
    public List&lt;UserEntity&gt; getAll() {
        return userService.getAll();
    }
}
</code></pre> 
<p></p> 
<p><span style="color:#fe2c24;"><strong>注意: URL 在写的时候绝对不要出现大写字母, 可以出现 阿拉伯数字甚至汉字</strong></span></p> 
<p><img alt="" height="34" src="https://images2.imgbox.com/c5/a5/pzCxwjbb_o.png" width="1200"></p> 
<p><span style="color:#1a439c;"> 比如.哔哩哔哩的视频 URL 它就是出现阿拉伯数字, 也不会出现大写字母</span></p> 
<p></p> 
<p><img alt="" height="39" src="https://images2.imgbox.com/9d/5b/XqVuydRU_o.png" width="1200"></p> 
<p><span style="color:#1a439c;">我拿必应搜索百度, 可以看到他的 URL 出现了汉字在里面, 但是依然没有大写字母 </span></p> 
<p></p> 
<p><span style="color:#be191c;">因为: RFC 1738 针对早期的 Web 环境制定了 URL 基本格式的标准。该标准要求 URL 中的字母必须采用 US-ASCII 字符集，并限制所有大写字符转换为相</span></p> 
<p><span style="color:#be191c;">应的小写字符。而 RFC 3986 则对之前的规范做了更新和扩展，对字符集的要求进行了更加严格的规定，同时保留了大小写敏感的部分。因此，为了遵守</span></p> 
<p><span style="color:#be191c;">URL 的标准规范，在 URL 中使用大写字母可能会导致 URL 不被正确解析或无法访问。</span></p> 
<p>说白了就是:<strong>乌龟的屁股------龟腚</strong></p> 
<p></p> 
<p>全部分层建立完</p> 
<p><img alt="" height="611" src="https://images2.imgbox.com/23/83/2wUY0fiq_o.png" width="338"></p> 
<p> </p> 
<p></p> 
<h4 id="%E5%90%AF%E5%8A%A8%E9%A1%B9%E7%9B%AE">启动项目</h4> 
<p><img alt="" height="204" src="https://images2.imgbox.com/c9/93/xqDhjuZQ_o.png" width="1200"></p> 
<p></p> 
<p>返回服务器</p> 
<p><img alt="" height="441" src="https://images2.imgbox.com/68/2a/thMQdETm_o.png" width="1200"> </p> 
<p></p> 
<p>成功使用带有 MyBatis 的 Spring-Boot 项目通过 URL 进行访问</p> 
<p>给数据库在添加一条数据,看看还能不能通过 URL 访问到</p> 
<pre><code class="hljs">-- 添加一个测试信息
INSERT INTO `bolgtest`.`userinfo` (`id`, `username`, `password`, `photo`, `createtime`, `updatetime`, `state`) VALUES 
(2, 'zhangsan', 'zhangsan', '', '2021-12-06 17:10:48', '2021-12-06 17:10:48', 1);</code></pre> 
<p><img alt="" height="118" src="https://images2.imgbox.com/06/de/6XYPvoUM_o.png" width="1200"></p> 
<p></p> 
<p>查询数据库, 发现两条信息</p> 
<p><img alt="" height="191" src="https://images2.imgbox.com/c6/62/P4YJs5xX_o.png" width="910"> </p> 
<p> </p> 
<p>刷新 URL , 这边也可以查询到</p> 
<p><img alt="" height="107" src="https://images2.imgbox.com/89/9a/0ifkqDCQ_o.png" width="1200"></p> 
<p> </p> 
<h3 id="%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95">单元测试</h3> 
<p>单元测试的优点</p> 
<p>1、可以⾮常简单、直观、快速的测试某⼀个功能是否正确。</p> 
<p>2、使⽤单元测试可以帮我们在打包的时候，发现⼀些问题，因为在打包之前，所以的单元测试必须通过，否则不能打包成功。</p> 
<p>3、使⽤单元测试，在测试功能的时候，可以不污染连接的数据库，也就是可以不对数据库进⾏任何改变的情况下，测试功能。</p> 
<p>4. 可以绕过用户登录验证进行单元测试</p> 
<p></p> 
<p>进行单元测试需要 在 pom.xml 引入依赖,好消息是不需要管他, 因为他自己已经引入了</p> 
<p><img alt="" height="246" src="https://images2.imgbox.com/7a/38/S0p3enYo_o.png" width="915"></p> 
<p> <span style="color:#fe2c24;"><strong>每一个 Spring-Boot 的项目都会自带单元测试</strong></span></p> 
<p></p> 
<p><img alt="" height="258" src="https://images2.imgbox.com/39/b3/ZG2b0IJd_o.png" width="827"></p> 
<p><span style="color:#fe2c24;"><strong> junit 和 mockito 都是自带的</strong></span></p> 
<p></p> 
<h4 id="%E8%BF%9B%E5%85%A5%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95">进入单元测试</h4> 
<p>先把测试需要的代码写上</p> 
<p>usermapper</p> 
<pre><code class="hljs">package com.example.demo.Mapper;

import com.example.demo.Entity.UserEntity;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Param;

import java.util.List;

@Mapper
public interface UserMapper {
    List&lt;UserEntity&gt; getAll();

    //根据 id 查询用户对象
    UserEntity getUserById(@Param("id") Integer id);
}

// @Param 来自于 ibatis, 是 MyBatis 的前身
// 用于指定 SQL 语句中的参数名称和类型。MyBatis 框架会根据 @Param 注解来映射参数的名称和值，方便实现动态 SQL。</code></pre> 
<p></p> 
<p>usermapper.xml</p> 
<pre><code class="hljs">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;
&lt;mapper namespace="com.example.demo.Mapper.UserMapper"&gt;
    &lt;select id="getAll" resultType="com.example.demo.Entity.UserEntity"&gt;
        select * from userinfo
    &lt;/select&gt;

    &lt;select id="getUserById" resultType="com.example.demo.Entity.UserEntity"&gt;
        select * from userinfo where id=${id}
    &lt;/select&gt;

&lt;/mapper&gt;</code></pre> 
<p> </p> 
<p>再要测试的类上面右键 Generate 生成</p> 
<p><img alt="" height="1030" src="https://images2.imgbox.com/7f/20/CCNaV3TK_o.png" width="1200"></p> 
<p><img alt="" height="132" src="https://images2.imgbox.com/75/82/1DEw7shk_o.png" width="344"> </p> 
<p> <img alt="" height="697" src="https://images2.imgbox.com/b3/01/Uamgmfup_o.png" width="1200"></p> 
<p></p> 
<p>勾选完,他会自动生成类,可以看到他在 Test 里面 </p> 
<p> 只勾选一个</p> 
<p><img alt="" height="674" src="https://images2.imgbox.com/9b/f2/Bgs1QB4Z_o.png" width="1042"></p> 
<p> 因为 UserEntity 里面有 @Data, 所以可以直接打印</p> 
<pre><code class="hljs">package com.example.demo.Mapper;

import com.example.demo.Entity.UserEntity;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;

@SpringBootTest// 表示当前单元测试的类是运行在 Spring Boot 环境中
class UserMapperTest {
    @Autowired
    private UserMapper userMapper;

    @Test
    void getUserById() {
        //查询zhangsan,所以里面是放2
        UserEntity user = userMapper.getUserById(2);
        System.out.println(user);
    }
}</code></pre> 
<p><img alt="" height="693" src="https://images2.imgbox.com/d3/8a/486gX5Dw_o.png" width="715"></p> 
<p>运行测试类 </p> 
<p><img alt="" height="591" src="https://images2.imgbox.com/1b/5e/p44ucKKG_o.png" width="1200"></p> 
<p> </p> 
<p>上次只测试了 getUserById, 现在测试 getAll, 生成测试的时候会报错,问你是否还在这个测试类里面继续生成新的测试,选 OK</p> 
<p><img alt="" height="651" src="https://images2.imgbox.com/85/d2/e3EChhEb_o.png" width="743"></p> 
<p> </p> 
<p><img alt="" height="766" src="https://images2.imgbox.com/05/e6/fOpI4HUv_o.png" width="1184"></p> 
<p> </p> 
<p> 测试代码</p> 
<pre><code class="hljs">@Test
    void getAll() {
        List&lt;UserEntity&gt; list = userMapper.getAll();
        System.out.println(list.size());
    }</code></pre> 
<p></p> 
<p>运行测试类</p> 
<p><img alt="" height="538" src="https://images2.imgbox.com/40/fc/MyDpon7V_o.png" width="1200"></p> 
<p> </p> 
<p>观察上面两个单元测试会发现, 每次只运行一个,所以里面可以有多个</p> 
<p>可以使用断言,但是不常用</p> 
<p></p> 
<h3 id="Mybatis%20%E5%8A%A8%E6%80%81%E8%8E%B7%E5%8F%96%E5%8F%82%E6%95%B0">Mybatis 动态获取参数</h3> 
<h4 id="%E5%8F%82%E6%95%B0%E5%8D%A0%E4%BD%8D%E7%AC%A6%20%23%7B%7D%20%E5%92%8C%20%24%7B%7D">参数占位符 #{} 和 ${}</h4> 
<p><span style="color:#1a439c;"><strong>1. ${paramName} -&gt; 直接替换</strong></span></p> 
<p><span style="color:#1a439c;"><strong>2. #{paramName} -&gt; 占位符替换</strong></span></p> 
<p></p> 
<p><img alt="" height="261" src="https://images2.imgbox.com/09/9b/AMQc2R42_o.png" width="1151"></p> 
<p> 这三行就可以看出来 $ 和 #</p> 
<p><img alt="" height="652" src="https://images2.imgbox.com/e1/85/5F1cbt6H_o.png" width="1200"></p> 
<p> <img alt="" height="695" src="https://images2.imgbox.com/ea/8e/aeBdv1Ra_o.png" width="1200"></p> 
<p> </p> 
<h5 id="%23%20%E5%92%8C%20%24%20%E7%9A%84%E5%8C%BA%E5%88%AB"># 和 $ 的区别</h5> 
<p><span style="color:#fe2c24;">先使用 #</span></p> 
<p>mapper</p> 
<pre><code class="hljs">//根据名称查询用户对象
UserEntity getUserByName(@Param("username") String username);</code></pre> 
<p></p> 
<p>mapper.xml</p> 
<pre><code class="hljs">&lt;select id="getUserByName" resultType="com.example.demo.Entity.UserEntity"&gt;
        select * from userinfo where username=#{username}
    &lt;/select&gt;</code></pre> 
<p></p> 
<p>生成单元测试</p> 
<pre><code class="hljs">@Test
    void getUserByName() {
        UserEntity user = userMapper.getUserByName("zhangsan");
        System.out.println(user);
    }</code></pre> 
<p><img alt="" height="240" src="https://images2.imgbox.com/82/63/Wq7pQm8w_o.png" width="1200"></p> 
<p> </p> 
<p><span style="color:#fe2c24;">再使用 $</span></p> 
<p>只有 mapper.xml 需要修改</p> 
<pre><code class="hljs">&lt;select id="getUserByName" resultType="com.example.demo.Entity.UserEntity"&gt;
        select * from userinfo where username=${username}
    &lt;/select&gt;</code></pre> 
<p></p> 
<p>重新运行单元测试</p> 
<p><img alt="" height="178" src="https://images2.imgbox.com/9b/17/2kOjYOIX_o.png" width="1200"></p> 
<p>抛出异常 </p> 
<p>使用 $ 会报错,显示找不到 zhangsan Unknown column 'zhangsan' in 'where clause'</p> 
<p><span style="color:#fe2c24;">$ 是所见即所得,不会进行预处理,加上 '   ' 可以解决问题,但是有 SQL 注入问题</span></p> 
<pre><code class="hljs">&lt;select id="getUserByName" resultType="com.example.demo.Entity.UserEntity"&gt;
        select * from userinfo where username='${username}'
    &lt;/select&gt;</code></pre> 
<p>此时进行单元测试,一切正常</p> 
<p><img alt="" height="607" src="https://images2.imgbox.com/98/03/rjs1rNxx_o.png" width="1200"></p> 
<p></p> 
<h6 id="SQL%20%E6%B3%A8%E5%85%A5%C2%A0">SQL 注入 </h6> 
<p>使用最简单的 SQL 注入, 需要先删除一条数据,因为多条数据他有 bug</p> 
<p><img alt="" height="83" src="https://images2.imgbox.com/6c/7f/kf0gM6QS_o.png" width="448"></p> 
<p> <img alt="" height="157" src="https://images2.imgbox.com/e8/37/sRTKQuf2_o.png" width="942"></p> 
<p> </p> 
<p>使用登录来进行 SQL 注入演示</p> 
<p>Mapper</p> 
<pre><code class="hljs">//登录
UserEntity login(UserEntity user);</code></pre> 
<p>Mapper.xml</p> 
<pre><code class="hljs">&lt;select id="login" resultType="com.example.demo.Entity.UserEntity"&gt;
         select * from userinfo where username='${username}' and password='${password}'
    &lt;/select&gt;</code></pre> 
<p>单元测试</p> 
<pre><code class="hljs">@Test
    void login() {
        String username = "admin";
        String password = "admin";
        UserEntity inputUser = new UserEntity();
        inputUser.setUsername(username);
        inputUser.setPassword(password);
        UserEntity user = userMapper.login(inputUser);
        System.out.println(user);
    }</code></pre> 
<p><img alt="" height="201" src="https://images2.imgbox.com/82/2a/94nWFp32_o.png" width="1200"></p> 
<p></p> 
<p><span style="color:#fe2c24;">现在开始 SQL 注入</span></p> 
<pre><code class="hljs">@Test
    void login() {
        String username = "admin";
        String password = "' or 1='1";
        UserEntity inputUser = new UserEntity();
        inputUser.setUsername(username);
        inputUser.setPassword(password);
        UserEntity user = userMapper.login(inputUser);
        System.out.println(user);
    }</code></pre> 
<p><img alt="" height="206" src="https://images2.imgbox.com/bf/ec/KnsoAvgE_o.png" width="1200"> </p> 
<p><span style="color:#1a439c;"><strong>原因: SQL 注入问题的出现，主要是因为在拼接 SQL 语句时，未对输入数据进行充分的过滤和转义处理。</strong></span></p> 
<p><span style="color:#1a439c;"><strong>这条 SQL 语句的条件部分中含有一个逻辑表达式 <code>'1'='1'</code>，这个表达式的值永远为真。因此，不管数据库中是否存在名为 admin 的用户，这条 SQL 语句</strong></span></p> 
<p><span style="color:#1a439c;"><strong>都会返回用户表中的所有记录，甚至可能返回所有表中的记录。这就是 SQL 注入攻击的原理。</strong></span></p> 
<p> </p> 
<p>解决方法:</p> 
<p>使用 #</p> 
<p><span style="color:#1a439c;"><strong>当有可能存在 SQL 注入攻击时，MyBatis 会自动将参数进行转义处理，从而避免了通过插入恶意代码来实现 SQL 注入攻击的可能性。</strong></span></p> 
<pre><code class="hljs">&lt;select id="login" resultType="com.example.demo.Entity.UserEntity"&gt;
        select * from userinfo where username=#{username} and password=#{password}
    &lt;/select&gt;</code></pre> 
<p><img alt="" height="721" src="https://images2.imgbox.com/36/ee/NhCkfeNm_o.png" width="1077"></p> 
<p> </p> 
<h6 id="%24%C2%A0%20%E4%BC%98%E7%82%B9">$  优点</h6> 
<p>Mapper</p> 
<pre><code class="hljs">    List&lt;UserEntity&gt; getAllByIdOrder(@Param("ord") String ord);
</code></pre> 
<p>Mapper.xml</p> 
<pre><code class="hljs">&lt;select id="getAllByIdOrder" resultType="com.example.demo.Entity.UserEntity"&gt;
        select * from userinfo order by id ${ord}
    &lt;/select&gt;</code></pre> 
<p></p> 
<p>单元测试</p> 
<pre><code class="hljs">@Test
    void getAllByIdOrder() {
        List&lt;UserEntity&gt; list = userMapper.getAllByIdOrder("desc");
        System.out.println(list.size());
    }</code></pre> 
<p><img alt="" height="391" src="https://images2.imgbox.com/b0/b5/cRHBZIIV_o.png" width="1200"></p> 
<p></p> 
<p>使用 #, 单元测试就会报错</p> 
<p><img alt="" height="94" src="https://images2.imgbox.com/bb/25/MGw3ytcb_o.png" width="1200"> </p> 
<p>使⽤ ${sort} 可以实现排序查询，⽽使⽤ #{sort} 就不能实现排序查询了，因为当使⽤ #{sort} 查询时，如果传递的值为 String 则会加单引号，就会导致 sql</p> 
<p>错误。</p> 
<p></p> 
<h3 id="%E6%94%B9%E3%80%81%E5%88%A0%E3%80%81%E5%A2%9E%E6%93%8D%E4%BD%9C">改、删、增操作</h3> 
<h4 id="1.%20%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81">1. 修改密码</h4> 
<p>mapper</p> 
<pre><code class="hljs">//修改密码
    int updatePassword(@Param("id") Integer id,
                       @Param("password") String password,
                       @Param("newPassword") String newPassword);</code></pre> 
<p></p> 
<p>mapper.xml</p> 
<pre><code class="hljs">&lt;update id="updatePassword"&gt;
        update userinfo set password=#{newPassword}
        where id=#{id} and password=#{password}
    &lt;/update&gt;</code></pre> 
<p></p> 
<p>单元测试</p> 
<pre><code class="hljs">@Transactional
    //事务,保证不会污染数据库(代码执行完,rollback 回滚)
    //可以加载类上,也可以加载方法上
    @Test
    void updatePassword() {
        int result = userMapper.updatePassword(1, "admin", "123456");
        System.out.println("修改: " + result);
    }</code></pre> 
<p><img alt="" height="327" src="https://images2.imgbox.com/2b/05/NWWRWvll_o.png" width="1200"></p> 
<p> 事务成功回滚</p> 
<p></p> 
<h4 id="2.%20%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7%E6%93%8D%E4%BD%9C">2. 删除用户操作</h4> 
<p>mapper</p> 
<pre><code class="hljs">//删除用户
    int delById (@Param("id")Integer id);</code></pre> 
<p> </p> 
<p>mapper.xml</p> 
<pre><code class="hljs">&lt;delete id="delById"&gt;
        delete from userinfo where id=#{id}
    &lt;/delete&gt;</code></pre> 
<p></p> 
<p>单元测试</p> 
<pre><code class="hljs">@Transactional
    @Test
    void delById() {
        int id = 1;
        int result = userMapper.delById(id);
        System.out.println("删除结果: " + result);
    }</code></pre> 
<p><img alt="" height="276" src="https://images2.imgbox.com/75/6e/IKnwUWTf_o.png" width="1200"></p> 
<p> </p> 
<h4 id="3.%20%E5%A2%9E%E5%8A%A0%E7%94%A8%E6%88%B7%E6%93%8D%E4%BD%9C">3. 增加用户操作</h4> 
<p>mapper</p> 
<pre><code class="hljs">//新增用户
    int addUser(UserEntity user);</code></pre> 
<p></p> 
<p>mapper.xml</p> 
<pre><code class="hljs">&lt;insert id="addUser"&gt;
        insert into userinfo(username,password) values(#{username},#{password})
    &lt;/insert&gt;</code></pre> 
<p></p> 
<p>单元测试</p> 
<pre><code class="hljs">@Test
    void addUser() {
        UserEntity user = new UserEntity();
        user.setUsername("zhangsan");
        user.setPassword("123456");
        int result = userMapper.addUser(user);
        System.out.println("添加: " + result);
    }</code></pre> 
<p><img alt="" height="181" src="https://images2.imgbox.com/57/35/NDFM5XVq_o.png" width="1200"></p> 
<p> <img alt="" height="184" src="https://images2.imgbox.com/4b/b7/6QJR4suY_o.png" width="983"></p> 
<p> </p> 
<h5 id="%E7%89%B9%E5%88%AB%E7%9A%84%E6%B7%BB%E5%8A%A0%3A%20%E8%BF%94%E5%9B%9E%E8%87%AA%E5%A2%9E%20id">特别的添加: 返回自增 id</h5> 
<p>mapper</p> 
<pre><code class="hljs">//添加返回影响行数和id
    int addUserGetId(UserEntity user);</code></pre> 
<p> </p> 
<p>mapper.xml</p> 
<pre><code class="hljs">&lt;insert id="addUserGetId" useGeneratedKeys="true" keyProperty="id"&gt;
        &lt;!--useGeneratedKeys 是否自动生成 id, 默认是 false--&gt;
        &lt;!--keyProperty 自动生成 分配给 id--&gt;
        insert into userinfo(username,password) values(#{username},#{password})
    &lt;/insert&gt;</code></pre> 
<p> </p> 
<p>单元测试</p> 
<pre><code class="hljs">@Test
    void addUserGetId() {
        UserEntity user = new UserEntity();
        user.setUsername("lisi");
        user.setPassword("123456");
        int result = userMapper.addUserGetId(user);
        System.out.println("添加结果: " + result);
        System.out.println("ID: " + user.getId());
    }</code></pre> 
<p><img alt="" height="311" src="https://images2.imgbox.com/b8/d5/lOPnnKMN_o.png" width="1200"></p> 
<p> <img alt="" height="206" src="https://images2.imgbox.com/c5/b0/AwBzedz2_o.png" width="958"></p> 
<p> </p> 
<h3 id="%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C">查询操作</h3> 
<h4 id="1.%20%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2">1. 模糊查询</h4> 
<p>mapper</p> 
<pre><code class="hljs">//根据用户模糊查询
    List&lt;UserEntity&gt; getListByName(@Param("username") String username);</code></pre> 
<p></p> 
<p>mapper.xml</p> 
<pre><code class="hljs">&lt;select id="getListByName" resultType="com.example.demo.Entity.UserEntity"&gt;
        select id,username,password as pwd from userinfo where username like concat ('%',#{username},'%')
    &lt;/select&gt;</code></pre> 
<p>这个写法,使用了 concat 进行拼接, 组成一个模糊匹配的查询条件，即查询所有用户名中包含指定字符串的用户信息。</p> 
<p></p> 
<p>单元测试</p> 
<pre><code class="hljs">@Test
    void getListByName() {
        String username = "zhang";
        List&lt;UserEntity&gt; list = userMapper.getListByName(username);
        list.stream().forEach(System.out::println);
    }</code></pre> 
<p><img alt="" height="238" src="https://images2.imgbox.com/f9/24/4ScmOGqW_o.png" width="1200"></p> 
<p> </p> 
<h4 id="2.%20%E5%A4%9A%E8%A1%A8%E8%81%94%E6%9F%A5">2. 多表联查</h4> 
<p>新建一个实体类 ArticleInfo</p> 
<pre><code class="hljs">package com.example.demo.Entity;

import lombok.Data;

import java.time.LocalDateTime;

@Data
public class ArticleInfo {
    private int id;
    private String title;
    private String content;
    private LocalDateTime createtime;
    private LocalDateTime updatetime;
    private int uid;
    private int rcount;
    private int state;
}
</code></pre> 
<p></p> 
<p>在entity 建立一个 vo 在新建一个实体类 ArticleInfoVo</p> 
<pre><code class="hljs">package com.example.demo.Entity.vo;

import com.example.demo.Entity.ArticleInfo;
import lombok.Data;

//作者名
@Data
public class ArticleInfoVO extends ArticleInfo {
    private String username;

    @Override
    public String toString() {
        return "ArticleInfoVO{" +
                "username='" + username + '\'' +
                "} " + super.toString();
    }
}
</code></pre> 
<p></p> 
<p>mapper</p> 
<p>新建一个 ArticleMapper </p> 
<pre><code class="hljs">package com.example.demo.Mapper;

import com.example.demo.Entity.vo.ArticleInfoVO;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Param;

@Mapper
public interface ArticleMapper {
    // 查询文章详情
    ArticleInfoVO getDetail(@Param("id") Integer id);
}
</code></pre> 
<p></p> 
<p>mapper.xml</p> 
<p>对于的新建一个 ArticleMapper.xml</p> 
<pre><code class="hljs">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;
&lt;mapper namespace="com.example.demo.Mapper.ArticleMapper"&gt;

    &lt;select id="getDetail" resultType="com.example.demo.Entity.vo.ArticleInfoVO"&gt;
        select a.*,u.username from articleinfo a
        left join userinfo u on u.id=a.uid
        where a.id=#{id}
    &lt;/select&gt;

    
&lt;/mapper&gt;</code></pre> 
<p> </p> 
<p>文章表和详情表进行多表联查</p> 
<p></p> 
<p>单元测试</p> 
<pre><code class="hljs">package com.example.demo.Mapper;

import com.example.demo.Entity.vo.ArticleInfoVO;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;

import static org.junit.jupiter.api.Assertions.*;

@SpringBootTest
class ArticleMapperTest {
@Autowired
private ArticleMapper articleMapper;

    @Test
    void getDetail() {
        ArticleInfoVO articleInfoVO = articleMapper.getDetail(1);
        System.out.println(articleInfoVO);
        System.out.println("title:" + articleInfoVO.getTitle());
    }
}</code></pre> 
<p><img alt="" height="354" src="https://images2.imgbox.com/c8/60/5GxGPq8r_o.png" width="1200"></p> 
<p></p> 
<h5 id="%E5%B9%B6%E5%8F%91%E6%9F%A5%E8%AF%A2">并发查询</h5> 
<p>数据库新增文章数据</p> 
<p><img alt="" height="82" src="https://images2.imgbox.com/ec/2d/kQdU6Gtf_o.png" width="1062"> </p> 
<p> mapper</p> 
<pre><code class="hljs">//并发查询
    List&lt;ArticleInfoVO&gt; getListByUid(@Param("uid")Integer id);</code></pre> 
<p> </p> 
<p>mapper.xml</p> 
<pre><code class="hljs">&lt;select id="getListByUid" resultType="com.example.demo.Entity.vo.ArticleInfoVO"&gt;
        select a.*,u.username from articleinfo a
        left join userinfo u on u.id=a.uid
        where a.uid=#{uid}
    &lt;/select&gt;</code></pre> 
<p></p> 
<p>单元测试</p> 
<pre><code class="hljs">@Test
    void getListByUid() {
        Integer uid = 1;
        List&lt;ArticleInfoVO&gt; list = articleMapper.getListByUid(uid);
        list.stream().parallel().forEach(System.out::println);
}</code></pre> 
<p>这是并发</p> 
<p></p> 
<pre><code class="hljs">list.stream().forEach(System.out::println);</code></pre> 
<p>这是不并发</p> 
<p></p> 
<h3 id="%E5%8A%A8%E6%80%81%20SQL%C2%A0">动态 SQL </h3> 
<p>动态 SQL 是指在构建 SQL 语句时，根据需要动态地生成 SQL 语句的一种技术。它使用程序的控制流程和条件逻辑来决定 SQL 语句的组成</p> 
<p>部分，从而实现更加灵活和可变的数据库操作。</p> 
<p>与静态 SQL 相比，动态 SQL 能够根据不同的条件生成不同的 SQL 语句，从而适应更加复杂和多变的业务需求。常见的场景包括根据用</p> 
<p>户输入的参数进行数据查询、动态生成复杂的查询条件、动态生成排序规则等。</p> 
<p>在 Java 开发中，常用的动态 SQL 技术包括使用 PreparedStatement 对象进行参数化查询、使用 MyBatis 框架的动态 SQL 功能等。这些技</p> 
<p>术都可以帮助开发人员灵活地构建 SQL 语句，从而提高代码的灵活性和可维护性。</p> 
<p>需要注意的是，动态 SQL 也可能会带来一些性能问题，如在运行时动态生成 SQL 语句可能会影响查询效率。因此，在实际应用中，需要</p> 
<p>权衡灵活性和性能之间的关系，并谨慎使用动态 SQL 技术。</p> 
<p></p> 
<h4 id="%3Cif%3E%20%E6%A0%87%E7%AD%BE">&lt;if&gt; 标签</h4> 
<p>回到 UserMapper</p> 
<p>mapper</p> 
<pre><code class="hljs">//动态 SQL
    int addUser2(UserEntity user);</code></pre> 
<p> </p> 
<p>mapper.xml</p> 
<pre><code class="hljs">&lt;insert id="addUser2"&gt;
        insert into userinfo(username,
        &lt;if test="photo!=null and photo!='' "&gt;
            photo,
        &lt;/if&gt;
        password)values(#{username},
        &lt;if test="photo!=null and photo!=''"&gt;
            #{photo},
        &lt;/if&gt;
        #{password})
    &lt;/insert&gt;</code></pre> 
<p> </p> 
<p>单元测试</p> 
<pre><code class="hljs">@Transactional
    @Test
    void addUser2() {
        String username = "liliu";
        String password = "123456";
        UserEntity user = new UserEntity();
        user.setUsername(username);
        user.setPassword(password);
        user.setPhoto("cat.png");
        int result = userMapper.addUser2(user);
        System.out.println("添加: " + result);
    }</code></pre> 
<p><img alt="" height="266" src="https://images2.imgbox.com/10/9b/0mJFSbxq_o.png" width="1200"></p> 
<p> </p> 
<h4 id="%3Ctrim%3E%20%E6%A0%87%E7%AD%BE">&lt;trim&gt; 标签</h4> 
<p>之前的插⼊用户功能，只是有⼀个 sex 字段可能是选填项，如果所有字段都是⾮必填项，就考虑使用 &lt;trim&gt; 标签结合 &lt;if&gt; 标签，对多个字</p> 
<p>段都采取动态生成的⽅式。</p> 
<p>&lt;trim&gt;标签中有如下属性：</p> 
<p>prefix：表示整个语句块，以prefix的值作为前缀</p> 
<p>suffix：表示整个语句块，以suffix的值作为后缀</p> 
<p>prefixOverrides：表示整个语句块要去除掉的前缀</p> 
<p>suffixOverrides：表示整个语句块要去除掉的后缀<br>  </p> 
<p>mapper</p> 
<pre><code class="hljs">//trim 演示
    int addUser3(UserEntity user);</code></pre> 
<p></p> 
<p>mapper.xml</p> 
<pre><code class="hljs">&lt;insert id="addUser3"&gt;
        insert into userinfo
        &lt;trim prefix="(" suffix=")" suffixOverrides=","&gt;
            &lt;if test="username!=null and username!='' "&gt;
                username,
            &lt;/if&gt;
            &lt;if test="photo!=null and photo!='' "&gt;
                photo,
            &lt;/if&gt;
            &lt;if test="password!=null and password!='' "&gt;
                password,
            &lt;/if&gt;
        &lt;/trim&gt;
        values
        &lt;trim prefix="(" suffix=")" suffixOverrides=","&gt;
            &lt;if test="username!=null and username!='' "&gt;
                #{username},
            &lt;/if&gt;
            &lt;if test="photo!=null and photo!=''"&gt;
                #{photo},
            &lt;/if&gt;
            &lt;if test="password!=null and password!='' "&gt;
                #{password},
            &lt;/if&gt;
        &lt;/trim&gt;
    &lt;/insert&gt;</code></pre> 
<p></p> 
<p>单元测试</p> 
<pre><code class="hljs">@Transactional
    @Test
    void addUser3() {
        String username = "liliu";
        String password = "123456";
        UserEntity user = new UserEntity();
        user.setUsername(username);
        user.setPassword(password);
        int result = userMapper.addUser3(user);
        System.out.println("添加: " + result);
    }</code></pre> 
<p><img alt="" height="269" src="https://images2.imgbox.com/58/d0/HT7FTry6_o.png" width="1200"></p> 
<p> </p> 
<h3 id="Mybatis%20%E4%B8%AD%E5%A4%9A%E4%B8%AA%E9%83%BD%E6%98%AF%E9%9D%9E%E5%BF%85%E4%BC%A0%E5%8F%82%E6%95%B0%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">Mybatis 中多个都是非必传参数的解决方案</h3> 
<h4 id="%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%881%3A%201%3D1%20%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">解决方案1: 1=1 解决方案</h4> 
<p>mapper</p> 
<pre><code class="hljs">List&lt;ArticleInfoVO&gt; getListByIdOrTitle(@Param("id")Integer id,
                                           @Param("title")String title);</code></pre> 
<p></p> 
<p>mapper.xml</p> 
<pre><code class="hljs">&lt;select id="getListByIdOrTitle" resultType="com.example.demo.Entity.vo.ArticleInfoVO"&gt;
        select * from articleinfo
        where 1=1
        &lt;trim prefixOverrides="and"&gt;
            &lt;if test="id!=null and id&gt;0"&gt;
                and id=#{id}
            &lt;/if&gt;
            &lt;if test="title!=null and title!=''"&gt;
                and title like concat('%',#{title},'%')
            &lt;/if&gt;
        &lt;/trim&gt;
    &lt;/select&gt;</code></pre> 
<p> </p> 
<h4 id="%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%882%3A%20trim%20%E7%9A%84%E6%96%B9%E5%BC%8F">解决方案2: trim 的方式</h4> 
<p>mapper.xml</p> 
<p></p> 
<pre><code class="hljs">&lt;select id="getListByIdOrTitle" resultType="com.example.demo.Entity.vo.ArticleInfoVO"&gt;
        select * from articleinfo
        &lt;trim prefix="where" suffixOverrides="and"&gt;
            &lt;if test="id!=null and id&gt;0"&gt;
                id=#{id} and
            &lt;/if&gt;
            &lt;if test="title!=null and title!=''"&gt;
                title like concat('%',#{title},'%')
            &lt;/if&gt;
        &lt;/trim&gt;
    &lt;/select&gt;</code></pre> 
<p> </p> 
<p>当 trim 中生成代码, 那么才会添加 &lt;trim&gt; 里面的前缀和后缀的, 如果 trim 中没有生成代码, 则前缀和后缀都会省略</p> 
<p></p> 
<p>单元测试</p> 
<pre><code class="hljs">@Test
    void getListByIdOrTitle() {
        List&lt;ArticleInfoVO&gt; list = articleMapper.getListByIdOrTitle(null,null);
        System.out.println(list.size());
    }</code></pre> 
<p><img alt="" height="377" src="https://images2.imgbox.com/41/b5/djtivybu_o.png" width="1200"></p> 
<p> </p> 
<h4 id="%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%883%3A%20%3Cwhere%3E%20%E6%A0%87%E7%AD%BE%E6%96%B9%E5%BC%8F">解决方案3: &lt;where&gt; 标签方式</h4> 
<p>mapper.xml</p> 
<pre><code class="hljs"> &lt;select id="getListByIdOrTitle" resultType="com.example.demo.Entity.vo.ArticleInfoVO"&gt;
        select * from articleinfo
        &lt;where&gt;
            &lt;if test="id!=null and id&gt;0"&gt;
                id=#{id}
            &lt;/if&gt;
            &lt;if test="title!=null and title!=''"&gt;
                and title like concat('%',#{title},'%')
            &lt;/if&gt;
        &lt;/where&gt;
    &lt;/select&gt;</code></pre> 
<p></p> 
<p>单元测试</p> 
<pre><code class="hljs">@Test
    void getListByIdOrTitle() {
        List&lt;ArticleInfoVO&gt; list = articleMapper.getListByIdOrTitle(1,null);
        System.out.println(list.size());
    }</code></pre> 
<p><img alt="" height="233" src="https://images2.imgbox.com/e8/a8/cyzxo6Jz_o.png" width="1200"></p> 
<p><img alt="" height="702" src="https://images2.imgbox.com/f5/30/IoeS9JFr_o.png" width="1200"></p> 
<p> </p> 
<hr> 
<p><span style="color:#ff9900;">本文完,感谢观看,不足之处请在评论区指出 !</span></p> 
<p style="text-align:center;"><span style="color:#ff9900;"><img alt="" src="https://images2.imgbox.com/4e/af/aJj6XK4e_o.jpg"></span></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6c90c9958dd0805e4f51908ad3567d3d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">学习笔记--模拟退火</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4b064bbfeb5ba85683ae3d11a9e58612/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">电脑常用软件，让你的电脑更加便捷的黑科技软件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>