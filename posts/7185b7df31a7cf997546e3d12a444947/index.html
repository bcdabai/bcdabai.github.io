<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【SWAT水文模型】SWAT水文模型建立及应用第六期：SWAT-CUP参数敏感性分析 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【SWAT水文模型】SWAT水文模型建立及应用第六期：SWAT-CUP参数敏感性分析" />
<meta property="og:description" content="SWAT CUP的下载及安装参见另一博客-【SWAT水文模型】SWAT-CUP安装及使用。本博客主要介绍SWAT模型参数敏感性分析。
SWAT模型参数敏感性分析（SWAT CUP） 1 原理1.1 Latin-Hypercube（LH）1.2 One-factor-At-a-Time 抽样1.3 LH-OAT 分析 2 率定参数3 敏感性分析3.1 OAT3.2 全局敏感性分析 运行不同目标函数（如R2/NSE/Pbias）参考 地理信息系统（GIS）支持下的 SWAT（Soiland Water Assessent Tool）半分布式水文模型以流域离散化空间参数来描述流域水文变化特性，从物理意义上表达流域内的水文过程，但众多不确定的参数影响了模型的应用效果，因此有必要对参数进行敏感性分析。 基于 DEM 的分布式水文模型由于充分考虑了流域陆面参数在空间上的变异性，同时又能较好地表达流域水文过程的物理意义，已成为径流模拟新的发展方向。与传统的集总式模型相比，建立在物理机制上的分布式水文模型要求输入的参数较多，并且由于水文陆面过程中参数的空间差异性、获取过程中的误差及参数评估的困难使得模型初始参数值的输入具有很大的不确定性，降低了分布式水文模型的运行效率和模拟精度。此外对模型参数敏感性认识的不足也是影响分布式水文模型应用的一个重要因素。
因此需要理解模型中每一个参数对模拟结果的影响，通过对参数的敏感性分析进行参数筛选，减少模型率定参数的数量，提高模型运行时间效率和减少参数的不确定性，为模型的进一步改进提供更加可靠的依据。
1 原理 模型通过自带的LH-OAT (Latin Hypercube One-factor-At-a-Time) 敏感性分析方法和SCE-UA (Shuffled Complex Evolution Algorithm) 自动校准分析方法来率定敏感性参数的取值。
1.1 Latin-Hypercube（LH） 基于蒙特卡洛模型，但基于统计插样方法把每个参数分布划为N个空间，随即抽样，每个空间的被抽到的概率为1/N，参数随机组合，模型运行N次。如对平壤KS值，其取值范围为0100cm/hr。Latin-Hypercube随机采样过程中Ks值将被分为 (0-10)10-20)…、(90-100)共10个取值区间(20-30)模型结果利用多参数线性回归或相关分析方法分析不足: 多元回归分析的前提假设为线性变化，可能导致偏差输出结果的变化并 不总能明确地归因于某一特定输育清参数值的变化 1.2 One-factor-At-a-Time 抽样 运行一次只改变一个参数每次模拟仅改变1个参数的值，这样便于将模拟结果的变化无偏差地归因到该参数的变化上某一特定输入参数值的变化引起的输出结果的灵敏度大小依赖于模型其他参数值的选取 1.3 LH-OAT 分析 参数敏感度分析采用ArcSWAT提供的参数敏感度分析模块进行分析，此模块采用的方法是LH-OAT灵敏度分析方法，该方法对每一抽样点（LH抽样法）进行OAT灵敏度分析，灵敏度最终值是各局部灵敏度之和的平均值，是综合LH抽样法和OAT灵敏度分析的一种新方法，同时兼备两种方法的优点。
采用LH-OAT法可确保所有参数在取值范围内均被取样两者优点，弥补不足每次仅对1个参数进行敏感性分析，将其按固定比例调整大小（如取值范围的5%）其他参数按LatinHypercurbe采样方法随机变化模拟m次，并统计分析对模拟结果的影响，m为取值区间的个数如对n个参数进行敏感性分析，把参数划分为m个空间，模型共需m*(n&#43;1)次模拟 2 率定参数 在ArcSWAT2012版本中将敏感性分析和自动校正都去掉了，只剩下了手动校正。
SWAT模型种与水文过程相关的参数包括土壤参数、土地利用参数、地下水径流参数、融雪径流参数、地表特征参数，这些参数既有流域级的又有子单元级的。
选取以下参数（部分）进行率定：
3 敏感性分析 采用SWAT-CUP中的SUFI-2算法进行敏感性分析。
3.1 OAT OAT属于局部敏感性分析方法，做法是保持其他参数不变，调动单个参数，观察目标函数变化。OAT操作简单，可快速估计参数敏感程度。
3.2 全局敏感性分析 t值表示参数敏感性的大小，其绝对值越大，代表该参数在某一区域越敏感；p值表示该参数敏感性的置信水平，其值越接近0，代表该参数越重要。在p值小于等于0.05的情况下，该参数比较敏感重要；而在p值大于等于0.3的情况下，该参数不敏感。 根据SWAT CUP界面结果：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/7185b7df31a7cf997546e3d12a444947/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-13T19:13:39+08:00" />
<meta property="article:modified_time" content="2023-11-13T19:13:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【SWAT水文模型】SWAT水文模型建立及应用第六期：SWAT-CUP参数敏感性分析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>SWAT CUP的下载及安装参见另一博客-<a href="https://blog.csdn.net/qq_44246618/article/details/130515741">【SWAT水文模型】SWAT-CUP安装及使用</a>。本博客主要介绍SWAT模型参数敏感性分析。<br> </p> 
<div class="toc"> 
 <h4>SWAT模型参数敏感性分析（SWAT CUP）</h4> 
 <ul><li><a href="#1__6" rel="nofollow">1 原理</a></li><li><ul><li><a href="#11_LatinHypercubeLH_8" rel="nofollow">1.1 Latin-Hypercube（LH）</a></li><li><a href="#12_OnefactorAtaTime__15" rel="nofollow">1.2 One-factor-At-a-Time 抽样</a></li><li><a href="#13_LHOAT__20" rel="nofollow">1.3 LH-OAT 分析</a></li></ul> 
  </li><li><a href="#2__27" rel="nofollow">2 率定参数</a></li><li><a href="#3__34" rel="nofollow">3 敏感性分析</a></li><li><ul><li><a href="#31_OAT_37" rel="nofollow">3.1 OAT</a></li><li><a href="#32__40" rel="nofollow">3.2 全局敏感性分析</a></li></ul> 
  </li><li><a href="#R2NSEPbias_49" rel="nofollow">运行不同目标函数（如R2/NSE/Pbias）</a></li><li><a href="#_51" rel="nofollow">参考</a></li></ul> 
</div> 
<br> 地理信息系统（GIS）支持下的 SWAT（Soiland Water Assessent Tool）半分布式水文模型以流域离散化空间参数来描述流域水文变化特性，从物理意义上表达流域内的水文过程，但众多不确定的参数影响了模型的应用效果，因此有必要对参数进行敏感性分析。 
<p></p> 
<p>基于 DEM 的<strong>分布式水文模型</strong>由于充分考虑了流域陆面参数在空间上的变异性，同时又能较好地表达流域水文过程的物理意义，已成为径流模拟新的发展方向。与传统的集总式模型相比，建立在物理机制上的分布式水文模型要求输入的<strong>参数较多</strong>，并且由于水文陆面过程中参数的空间差异性、获取过程中的误差及参数评估的困难使得模型初始参数值的输入具有很大的不确定性，降低了分布式水文模型的运行效率和模拟精度。此外对<strong>模型参数敏感性</strong>认识的不足也是影响分布式水文模型应用的一个重要因素。<br> 因此需要理解模型中每一个参数对模拟结果的影响，通过对参数的敏感性分析进行参数筛选，减少模型率定参数的数量，提高模型运行时间效率和减少参数的不确定性，为模型的进一步改进提供更加可靠的依据。</p> 
<h2><a id="1__6"></a>1 原理</h2> 
<p>模型通过自带的<strong>LH-OAT (Latin Hypercube One-factor-At-a-Time)</strong> 敏感性分析方法和<strong>SCE-UA (Shuffled Complex Evolution Algorithm)</strong> 自动校准分析方法来率定敏感性参数的取值。</p> 
<h3><a id="11_LatinHypercubeLH_8"></a>1.1 Latin-Hypercube（LH）</h3> 
<ul><li>基于蒙特卡洛模型，但基于统计插样方法</li><li>把每个参数分布划为N个空间，随即抽样，每个空间的被抽到的概率为1/N，参数随机组合，模型运行N次。如对平壤KS值，其取值范围为0100cm/hr。Latin-Hypercube随机采样过程中Ks值将被分为 (0-10)10-20)…、(90-100)共10个取值区间(20-30)</li><li>模型结果利用多参数线性回归或相关分析方法分析</li><li>不足: 多元回归分析的前提假设为线性变化，可能导致偏差</li><li>输出结果的变化并 不总能明确地归因于某一特定输育清参数值的变化</li></ul> 
<h3><a id="12_OnefactorAtaTime__15"></a>1.2 One-factor-At-a-Time 抽样</h3> 
<ul><li>运行一次只改变一个参数</li><li>每次模拟仅改变1个参数的值，这样便于将模拟结果的变化无偏差地归因到该参数的变化上</li><li>某一特定输入参数值的变化引起的输出结果的灵敏度大小依赖于模型其他参数值的选取</li></ul> 
<h3><a id="13_LHOAT__20"></a>1.3 LH-OAT 分析</h3> 
<p>参数敏感度分析采用ArcSWAT提供的参数敏感度分析模块进行分析，此模块采用的方法是<strong>LH-OAT灵敏度</strong>分析方法，该方法对每一抽样点（LH抽样法）进行OAT灵敏度分析，灵敏度最终值是各局部灵敏度之和的平均值，是综合LH抽样法和OAT灵敏度分析的一种新方法，同时兼备两种方法的优点。</p> 
<ul><li>采用LH-OAT法可确保所有参数在取值范围内均被取样</li><li>两者优点，弥补不足</li><li>每次仅对1个参数进行敏感性分析，将其按固定比例调整大小（如取值范围的5%）</li><li>其他参数按LatinHypercurbe采样方法随机变化模拟m次，并统计分析对模拟结果的影响，m为取值区间的个数</li><li>如对n个参数进行敏感性分析，把参数划分为m个空间，模型共需m*(n+1)次模拟</li></ul> 
<h2><a id="2__27"></a>2 率定参数</h2> 
<p>在<strong>ArcSWAT2012</strong>版本中将<strong>敏感性分析</strong>和自动校正都去掉了，只剩下了<strong>手动校正</strong>。</p> 
<p>SWAT模型种与水文过程相关的参数包括土壤参数、土地利用参数、地下水径流参数、融雪径流参数、地表特征参数，这些参数既有流域级的又有子单元级的。</p> 
<p>选取以下参数（部分）进行率定：<br> <img src="https://images2.imgbox.com/7c/21/iXlKWyJQ_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3__34"></a>3 敏感性分析</h2> 
<p>采用SWAT-CUP中的<strong>SUFI-2算法</strong>进行敏感性分析。<br> <img src="https://images2.imgbox.com/5a/cd/Vdpa3aZV_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="31_OAT_37"></a>3.1 OAT</h3> 
<p>OAT属于局部敏感性分析方法，做法是保持其他参数不变，调动单个参数，观察目标函数变化。OAT操作简单，可快速估计参数敏感程度。</p> 
<h3><a id="32__40"></a>3.2 全局敏感性分析</h3> 
<ul><li>t值表示参数敏感性的大小，其绝对值越大，代表该参数在某一区域越敏感；p值表示该参数敏感性的置信水平，其值越接近0，代表该参数越重要。</li><li>在p值小于等于0.05的情况下，该参数比较敏感重要；而在p值大于等于0.3的情况下，该参数不敏感。</li></ul> 
<p>根据SWAT CUP界面结果：<br> <img src="https://images2.imgbox.com/d2/0d/jWFbWdBX_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/91/b7/PIVIVYWf_o.png" alt="在这里插入图片描述"><br> 成图如下：<br> <img src="https://images2.imgbox.com/cf/40/9lTZJ7Ne_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="R2NSEPbias_49"></a>运行不同目标函数（如R2/NSE/Pbias）</h2> 
<p>注意：在一个迭代后，用户可以改变<strong>目标函数的类型</strong>并单独运行SUFI2_Post.bat，以看到不同目标函数的效果，而不需要再次运行SWAT。这样信息非常丰富，因为它显示了目标函数的选择是如何影响逆解的。</p> 
<h2><a id="_51"></a>参考</h2> 
<p>1、<a href="https://max.book118.com/html/2018/0312/156997087.shtm" rel="nofollow">第10讲 SWAT模型参数率定和验证</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f63e07cdfa91e6c43ef6c5258030f90c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python用pychart库，实现将经纬度信息在地图上显示</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ffde938f1f96b59ca3e1b6e27f3ea01d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">2023高教社杯国赛数学建模C题思路&#43;模型&#43;代码（9.7晚开赛后第一时间更新）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>