<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>chrome浏览器爬虫崩溃，怎么办？python &#43; selenium &#43; chrome &#43; headless模式 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="chrome浏览器爬虫崩溃，怎么办？python &#43; selenium &#43; chrome &#43; headless模式" />
<meta property="og:description" content="chrome浏览器爬虫崩溃，怎么办？python &#43; selenium &#43; chrome &#43; headless模式 1. 背景 在使用selenium &#43; chrome浏览器渲染模式爬取数据时，如果并发任务过多，或者爬虫的运行时间很长，那么很容易出现浏览器崩溃的现象，如下： 这一般是资源消耗过大造成的（据说chrome浏览器有内存泄漏的情况）。那如何解决这个问题呢？
这种情况下，我们首先就会想到使用无界面的浏览器PhantomJS，但是PhantomJS现在年久失修，后继无人，对很多新的特性支持并不够好。不过好在Google今年在chrome中增加了一项新的特性： Headless mode ，这样我们就可以使用无界面的chrome来爬取数据了，占用资源更少，速度更快。而且可喜的是，google的团队承诺会一直维护它… 2. 环境 系统：win7MongoDB 3.4.6python 3.6.1IDE：pycharm安装过chrome浏览器（63.0.3239.132 (正式版本) 32 位）selenium 3.7.0配置好chromedriver v2.34
特别说明：
因为Headless mode 是新推出的特性，只有高级的版本才能使用，并不向前兼容，所以对chrome浏览器和chromedriver的版本有要求： 1. 对chrome浏览器来说： linux，unix系统需要 chrome浏览器 &gt;= 59 Windows系统需要 chrome浏览器 &gt;= 60 2. chromeDriver版本与chrome浏览器匹配： 这个部分参考文章：http://blog.csdn.net/zwq912318834/article/details/78550666 3. 代码 from selenium import webdriver from selenium.webdriver.common.by import By from selenium.webdriver.support.ui import WebDriverWait from selenium.webdriver.support import expected_conditions as EC from selenium.webdriver.common.action_chains import ActionChains from selenium." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/50c064df77e0e007e9aac326b10cc77a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-01-08T11:35:41+08:00" />
<meta property="article:modified_time" content="2018-01-08T11:35:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">chrome浏览器爬虫崩溃，怎么办？python &#43; selenium &#43; chrome &#43; headless模式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2 id="chrome浏览器爬虫崩溃怎么办python-selenium-chrome-headless模式">chrome浏览器爬虫崩溃，怎么办？python + selenium + chrome + headless模式</h2> 
<h3 id="1-背景">1. 背景</h3> 
<ul><li><p>在使用selenium + chrome浏览器渲染模式爬取数据时，如果并发任务过多，或者爬虫的运行时间很长，那么很容易出现浏览器崩溃的现象，如下： <br> <img src="https://images2.imgbox.com/95/ef/DhNGW7Du_o.png" alt="这里写图片描述" title=""></p></li><li><p>这一般是资源消耗过大造成的（据说chrome浏览器有内存泄漏的情况）。那如何解决这个问题呢？</p> 
  <ul><li>这种情况下，我们首先就会想到使用无界面的浏览器PhantomJS，但是PhantomJS现在年久失修，后继无人，对很多新的特性支持并不够好。不过好在Google今年在chrome中增加了一项新的特性： Headless mode ，这样我们就可以使用无界面的chrome来爬取数据了，占用资源更少，速度更快。而且可喜的是，google的团队承诺会一直维护它…</li></ul></li></ul> 
<h3 id="2-环境">2. 环境</h3> 
<ul><li>系统：win7</li><li>MongoDB 3.4.6</li><li>python 3.6.1</li><li>IDE：pycharm</li><li>安装过chrome浏览器（63.0.3239.132 (正式版本) 32 位）</li><li>selenium 3.7.0</li><li><p>配置好chromedriver v2.34</p></li><li><p><strong>特别说明：</strong></p></li></ul> 
<pre class="prettyprint"><code class=" hljs markdown">因为Headless mode 是新推出的特性，只有高级的版本才能使用，并不向前兼容，所以对chrome浏览器和chromedriver的版本有要求： 
<span class="hljs-bullet">1. </span>对chrome浏览器来说： 
   linux，unix系统需要 chrome浏览器 &gt;= 59 
   Windows系统需要 chrome浏览器 &gt;= 60
<span class="hljs-bullet">2. </span>chromeDriver版本与chrome浏览器匹配：
   这个部分参考文章：http://blog.csdn.net/zwq912318834/article/details/78550666</code></pre> 
<h3 id="3-代码">3. 代码</h3> 
<pre class="prettyprint"><code class="language-python 3.6.1 hljs "><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver
<span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By
<span class="hljs-keyword">from</span> selenium.webdriver.support.ui <span class="hljs-keyword">import</span> WebDriverWait
<span class="hljs-keyword">from</span> selenium.webdriver.support <span class="hljs-keyword">import</span> expected_conditions <span class="hljs-keyword">as</span> EC
<span class="hljs-keyword">from</span> selenium.webdriver.common.action_chains <span class="hljs-keyword">import</span> ActionChains
<span class="hljs-keyword">from</span> selenium.webdriver.common.keys <span class="hljs-keyword">import</span> Keys

chrome_options = webdriver.ChromeOptions()
<span class="hljs-comment"># 使用headless无界面浏览器模式</span>
chrome_options.add_argument(<span class="hljs-string">'--headless'</span>)
chrome_options.add_argument(<span class="hljs-string">'--disable-gpu'</span>)

<span class="hljs-comment"># 启动浏览器，获取网页源代码</span>
browser = webdriver.Chrome(chrome_options=chrome_options)
mainUrl = <span class="hljs-string">"https://www.taobao.com/"</span>
browser.get(mainUrl)
print(f<span class="hljs-string">"browser text = {browser.page_source}"</span>)
browser.quit()</code></pre> 
<ul><li>可以看到已经没有浏览器界面了。</li><li>一般我们开发的顺序是：1. 首先拿掉这个headless参数，在浏览器界面进行开发； 2. 开发完成稳定之后，加入headless参数，进行测试，观察是否稳定； 3. 如果稳定，再进行部署。</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ea408835e73c0819b46b46783ffec98e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Exception 为什么有的需要抛异常有的不需要</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c650f416e2a7a12ada1e78c227e5984f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Greenplum介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>