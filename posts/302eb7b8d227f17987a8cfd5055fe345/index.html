<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【SWAT水文模型】SWAT水文模型建立及应用第六期：SWAT模型率定（SWAT CUP） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【SWAT水文模型】SWAT水文模型建立及应用第六期：SWAT模型率定（SWAT CUP）" />
<meta property="og:description" content="SWAT模型率定（SWAT CUP） 1 准备工作2 水文模型率定（SWAT CUP）2.1 数据准备输入数据注意事项 2.2 运行流程Step1：建立SWAT CUP工程Step2：输入文件参数及数据Step2：Executable Files（执行文件）Step3：校准输出文件说明 Step4：模型检验 参考 SWAT CUP的下载及安装参见另一博客-【SWAT水文模型】SWAT-CUP安装及使用
注意：率定的月径流单位为：m^3/s
下面将具体介绍基于实测水文站数据进行水文模型的率定。
1 准备工作 水文站位置如下：（以洮河流域为例）
水文站信息如下：（6个实测水文站）
本研究时段为1970-2020年（共51）年，则分配如下：
预热期（Warmup）：1970-1975年（6年）率定期（calibration）：1976-2005年（30年）检验期（validation）：2006-2020年（15年） 流域位置如下：（66个子流域）
据此，根据SWAT水文模型划分子流域，确定相关参数，用于后续SWAT CUP率定。
查阅MonitoringPoint表，根据TYPE=O，确定观测站点所在子流域，如下：
水文站与子流域对应序号如下所示：
水文站名子流域序号红旗2临洮18李家村20岷县47下巴沟34 2 水文模型率定（SWAT CUP） 2.1 数据准备 已经进行过至少一次模拟的swat输出文件，一般放于Scenarios目录下swatcup需要的是其中的txtinout文件夹。
选取以下参数进行率定：
对应变量及范围如下：
1、文本视图（Text View）
13 : Number of Parameters 10 : number of simulations r__CN2.mgt	-0.2 0.2 v__SURLAG.bsn	0.05 24 v__OV_N.hru	0.01 30 v__ESCO.hru	0.1 1.0 v__GW_REVAP.gw 0.02 0.02 v__ALPHA_BF.gw 0.0 1.0 v__GW_DELAY.gw	30.0 450." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/302eb7b8d227f17987a8cfd5055fe345/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-05T15:30:40+08:00" />
<meta property="article:modified_time" content="2023-12-05T15:30:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【SWAT水文模型】SWAT水文模型建立及应用第六期：SWAT模型率定（SWAT CUP）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>SWAT模型率定（SWAT CUP）</h4> 
 <ul><li><a href="#1__6" rel="nofollow">1 准备工作</a></li><li><a href="#2_SWAT_CUP_29" rel="nofollow">2 水文模型率定（SWAT CUP）</a></li><li><ul><li><a href="#21__30" rel="nofollow">2.1 数据准备</a></li><li><ul><li><a href="#_67" rel="nofollow">输入数据注意事项</a></li></ul> 
   </li><li><a href="#22__71" rel="nofollow">2.2 运行流程</a></li><li><ul><li><a href="#Step1SWAT_CUP_72" rel="nofollow">Step1：建立SWAT CUP工程</a></li><li><a href="#Step2_99" rel="nofollow">Step2：输入文件参数及数据</a></li><li><a href="#Step2Executable_Files_216" rel="nofollow">Step2：Executable Files（执行文件）</a></li><li><a href="#Step3_231" rel="nofollow">Step3：校准输出</a></li><li><ul><li><a href="#_232" rel="nofollow">文件说明</a></li></ul> 
    </li><li><a href="#Step4_251" rel="nofollow">Step4：模型检验</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_256" rel="nofollow">参考</a></li></ul> 
</div> 
<p></p> 
<p>SWAT CUP的下载及安装参见另一博客-<a href="https://blog.csdn.net/qq_44246618/article/details/130515741">【SWAT水文模型】SWAT-CUP安装及使用</a></p> 
<p>注意：率定的月径流单位为：m^3/s<br> 下面将具体介绍基于实测水文站数据进行水文模型的<strong>率定</strong>。</p> 
<h2><a id="1__6"></a>1 准备工作</h2> 
<p>水文站位置如下：（以洮河流域为例）<br> <img src="https://images2.imgbox.com/82/46/LBbYzSHb_o.png" alt="在这里插入图片描述"><br> 水文站信息如下：（6个实测水文站）<br> <img src="https://images2.imgbox.com/41/e1/o0K0C6a2_o.png" alt="在这里插入图片描述"><br> 本研究时段为1970-2020年（共51）年，则分配如下：</p> 
<ul><li>预热期（Warmup）：1970-1975年（6年）</li><li>率定期（calibration）：1976-2005年（30年）</li><li>检验期（validation）：2006-2020年（15年）</li></ul> 
<p>流域位置如下：（66个子流域）<br> <img src="https://images2.imgbox.com/a0/bb/6athINFM_o.png" alt="在这里插入图片描述"><br> 据此，根据SWAT水文模型划分子流域，确定相关参数，用于后续SWAT CUP率定。<br> 查阅<strong>MonitoringPoint表</strong>，根据TYPE=O，确定观测站点所在子流域，如下：<br> <img src="https://images2.imgbox.com/6c/e3/ImXeZMsF_o.png" alt="在这里插入图片描述"><br> 水文站与子流域对应序号如下所示：</p> 
<table><thead><tr><th>水文站名</th><th>子流域序号</th></tr></thead><tbody><tr><td>红旗</td><td>2</td></tr><tr><td>临洮</td><td>18</td></tr><tr><td>李家村</td><td>20</td></tr><tr><td>岷县</td><td>47</td></tr><tr><td>下巴沟</td><td>34</td></tr></tbody></table> 
<h2><a id="2_SWAT_CUP_29"></a>2 水文模型率定（SWAT CUP）</h2> 
<h3><a id="21__30"></a>2.1 数据准备</h3> 
<p>已经进行过至少一次模拟的swat输出文件，一般放于Scenarios目录下swatcup需要的是其中的txtinout文件夹。<br> <img src="https://images2.imgbox.com/b9/43/2d5foRrW_o.png" alt="在这里插入图片描述"><br> 选取以下参数进行率定：<br> <img src="https://images2.imgbox.com/83/3b/nYm3k8Ca_o.png" alt="在这里插入图片描述"><br> 对应变量及范围如下：<br> <strong>1、文本视图（Text View）</strong></p> 
<pre><code class="prism language-csharp"> <span class="token number">13</span>  <span class="token punctuation">:</span> Number of Parameters
 <span class="token number">10</span>  <span class="token punctuation">:</span> number of simulations


r__CN2<span class="token punctuation">.</span>mgt	              <span class="token operator">-</span><span class="token number">0.2</span>       <span class="token number">0.2</span>
v__SURLAG<span class="token punctuation">.</span>bsn	           <span class="token number">0.05</span>      <span class="token number">24</span>
v__OV_N<span class="token punctuation">.</span>hru	               <span class="token number">0.01</span>      <span class="token number">30</span>
v__ESCO<span class="token punctuation">.</span>hru	               <span class="token number">0.1</span>       <span class="token number">1.0</span>
v__GW_REVAP<span class="token punctuation">.</span>gw             <span class="token number">0.02</span>      <span class="token number">0.02</span>
v__ALPHA_BF<span class="token punctuation">.</span>gw             <span class="token number">0.0</span>       <span class="token number">1.0</span>
v__GW_DELAY<span class="token punctuation">.</span>gw	           <span class="token number">30.0</span>      <span class="token number">450.0</span>
v__CH_N2<span class="token punctuation">.</span>rte    <span class="token operator">-</span><span class="token number">0.01</span>   <span class="token number">0.3</span>
v__CH_K2<span class="token punctuation">.</span>rte    <span class="token operator">-</span><span class="token number">0.01</span>   <span class="token number">500</span>
v__ALPHA_BNK<span class="token punctuation">.</span>rte    <span class="token number">0.0</span>   <span class="token number">1.0</span>
<span class="token function">r__SOL_K</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sol    <span class="token number">0.0</span>   <span class="token number">2000</span>
<span class="token function">r__SOL_AWC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sol    <span class="token number">0.0</span>   <span class="token number">1.0</span>
<span class="token function">r__SOL_BD</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sol    <span class="token number">0.9</span>   <span class="token number">2.5</span>
</code></pre> 
<p>2、表格视图（Form View）<br> <img src="https://images2.imgbox.com/a1/f8/G32QLA2p_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>修改方案说明：</strong><br> 方案1：v<br> 表示参数由最终值替换<br> 方案2：r（此时min/max范围应为[-1,1]）<br> 表示参数由参数初始值×（1+最终值）替换。<br> 方案3：a<br> 表示参数由（初始值+a）替换</p> 
</blockquote> 
<h4><a id="_67"></a>输入数据注意事项</h4> 
<ul><li>Obsered_rch.txt 和observed.txt里校准数据如果有多个站点，建议起止时间一致，（小于等于simulation运行的时长），并且开始时间应与simulation开始时间一致</li><li>注意有缺失数据的格式</li><li>SUFI2_extract_rch.def里需要提取的column和reach要确保正确</li></ul> 
<h3><a id="22__71"></a>2.2 运行流程</h3> 
<h4><a id="Step1SWAT_CUP_72"></a>Step1：建立SWAT CUP工程</h4> 
<p>1、选择New建立工程<br> <img src="https://images2.imgbox.com/f0/fc/ieVCIcrV_o.png" alt="在这里插入图片描述"></p> 
<p>2、选择txtinout文件夹（选择正确的位置才可导入）<br> <img src="https://images2.imgbox.com/37/fc/Lf6Jb9S9_o.png" alt="在这里插入图片描述"><br> 选择SWAT版本：<br> <img src="https://images2.imgbox.com/b8/e8/MD85Z4aA_o.png" alt="在这里插入图片描述"></p> 
<p>3、选择校准时的模拟方法<br> （注意不同算法对应的操作界面可能有所不同，以第一个算法SUFI2为例）</p> 
<ul><li>SUFI2：Sequential Uncertainty Fitting version 2连续不确定率定法V2</li><li>GLUE：广义最大似然不确定估计</li><li>ParaSol：参数优化方法</li><li>McMc：蒙特卡罗过程</li><li>PSO：粒子群优化算法</li></ul> 
<p>根据需要，选择校准时的模拟方法：<br> <img src="https://images2.imgbox.com/3d/0b/t3E1i95R_o.png" alt="在这里插入图片描述"></p> 
<p>4、命名并选择输出文件夹（自定义）。注意“Project Name”窗口右侧的默认附加名。<br> 程序创建想要的工程目录并复制所有TxtInOut 文件到那里，同样创建名为“Backup”的目录，并复制所有SWAT 文件到那里。Backup 目录文件的参数作为<strong>默认参数</strong>而不会改变。<br> <img src="https://images2.imgbox.com/98/ec/YtrnZExP_o.png" alt="在这里插入图片描述"><br> 点击【Finish】后，弹出以下界面：<br> <img src="https://images2.imgbox.com/58/a7/X0XRI8yR_o.png" alt="在这里插入图片描述"><br> 工程自动建立完成后，界面如下：<br> <img src="https://images2.imgbox.com/51/8a/U5TvWzv9_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="Step2_99"></a>Step2：输入文件参数及数据</h4> 
<p><strong>1、Calibration Inputs文件夹：</strong> 参数信息</p> 
<ul><li> <p><strong>Par_inf.txt</strong> file——包含参与最优化的输入参数（优化参数个数及模拟次数）。这个文件需要由用户编辑，例子给出了格式，根据需要来编辑，下面解释了参数设定。<br> 如果提示参数较少，可以通过 Add a new parameter 按钮新增参数。<br> <img src="https://images2.imgbox.com/ec/13/Y5qqN7wd_o.png" alt="在这里插入图片描述"><br> 这里是设置校准参数的地方，需要做的是<strong>更改参数</strong>并为每个参数<strong>设定取值范围</strong>，需要注意的是，参数的修改方法有v__, a__, r__三种，分别是赋值，加值，乘以某值（百分比浮动），具体可见说明书。每个参数后面的两个数字别是在下一次模拟中该参数取值的下界和上界，可以根据需要随便赋值，前提是不能超过理论上的最大范围。<br> <strong>注意1：</strong> swatcup中的Sol_BD和ALPHA_BNK两个参数不在swat中的自带调参工具中。<br> <strong>注意2：</strong> .bsn为后缀的参数，是全流域性质的参数，因此不可以按子流域修改，手动调参的时候不能指定某各子流域改参数，因此在此处填写的时候，不用选流域。</p> </li><li> <p><strong>SUFI2_swEdit.def</strong>（算法信息）——分别输入起始与终止的模拟次数，分别为1与n。<br> <img src="https://images2.imgbox.com/a0/5d/FR7IObwA_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>File.cio</strong>（SWAT-CUP运行的基本参数）——这是一个SWAT 文件。放在这里是为了方便起见，我们需要从这个文件得到的是模拟的年数和预热期的数目(NYSKIP)，以正确地给SWAT-CUP 提供模拟期的起始年和结束年(不包括预热期)。<br> NBYR：number of year simulated，模拟念书（1970-2020年，共51年）<br> IYR：模拟的起始年（1970）<br> IDAF：起始日的年积日（1）<br> IDAL：结束日的年积日（365，此项如果模拟最终年份为闰年，被4整除，则此项为366，输错可能引起错误）<br> <img src="https://images2.imgbox.com/94/de/xhDcUbj2_o.png" alt="在这里插入图片描述"></p> </li><li> <p><strong>Absolute_SWAT_Values.txt</strong>（修改参数的上下界）——所有要被拟合的参数应该在这个文件中并加上它们的绝对最小和最大范围。当前大多数但不是所有参数都包括在此文件中。简单地以所显示的格式添加不存在的参数到这里。<br> 此项一般不做修改。<br> <img src="https://images2.imgbox.com/b6/05/HAmHmjS6_o.png" alt="在这里插入图片描述"><br> <strong>2、Observation文件夹：</strong><br> 下面是3 个包含监测值的文件。监测值对应于output.rch（河道）、output.hru（HRU）和output.sub（子流域） 文件中的变量。不同文件的变量现在可以包括在内，以形成多目标目标函数。只要简单地编辑应用于项目的这些文件，不要担心那些不应用的文件。格式应该与如程序包括的例子显示的格式完全一样。这里可以存在<strong>缺测</strong>的数据，如例子文件所显示的那样。<br> <img src="https://images2.imgbox.com/ee/78/wPwAIiCu_o.png" alt="在这里插入图片描述"></p> </li><li> <p>第一列是模拟时段起始日开始的顺序号(例子中的第4、5 个的数据缺失)。</p> </li><li> <p>第二列是任意格式，这里是变量名、月份和年份。</p> </li><li> <p>第三列是变量值。输入的时候注意单位，output的月值单位为cms，实测值应该与其对应。</p> </li></ul> 
<p>输入观测数据需要只需要激活rch即可，激活需要点击上方的Rch按钮。针对Observed_rch.txt（河道）文件，格式是：序号（空格）FLOW_OUT_月（日）_年（空格）观测值。<br> <strong>注意</strong>，这里的月（日）是指这一年的第几个月（日）。</p> 
<blockquote> 
 <p>Number of observed variables，指观测变量个数，如果同时校准多个rch的流量，这里填的是rch的个数。<br> 例如，如果要校正5个出口的流量，这里就写5；如果校正2个流量，2个泥沙，这里就写4。<br> FLOW_OUT_1，需改后边的数字，改为每个rch的Gis代码。 141，为rch1的实测数据的个数，如果为月值，2年的数据，个数填24。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/b7/c4/RZEbe1oO_o.png" alt="在这里插入图片描述"><br> MATLAB输出<strong>相应流量序列代码</strong>如下：</p> 
<pre><code class="prism language-csharp">clc
close all
clear
<span class="token operator">%</span><span class="token operator">%</span> 基本设置
pathFiles<span class="token operator">=</span> '<span class="token punctuation">.</span>\DataFiles\' <span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 导入数据
<span class="token function">load</span><span class="token punctuation">(</span>'RunoffTaohe<span class="token punctuation">.</span>mat'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">nMonth</span><span class="token punctuation">,</span> <span class="token class-name">nStation</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span>RunoffTaohe<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span><span class="token operator">%</span> 获取径流序号
yearStart <span class="token operator">=</span> <span class="token number">1970</span><span class="token punctuation">;</span>
yearEnd <span class="token operator">=</span> <span class="token number">2020</span><span class="token punctuation">;</span>
nYear <span class="token operator">=</span> yearEnd<span class="token operator">-</span>yearStart<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>

Q <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>nMonth<span class="token punctuation">,</span> nStation<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">Q</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">GetYearMonth</span><span class="token punctuation">(</span>yearStart<span class="token punctuation">,</span> yearEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">Q</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">:</span>end<span class="token punctuation">)</span> <span class="token operator">=</span> RunoffTaohe<span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 输出文件 序号（空格）FLOW_OUT_月（日）_年（空格）观测值

<span class="token keyword">for</span> iN<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token class-name">nStation</span>
    Title <span class="token operator">=</span> <span class="token punctuation">[</span>'FLOW_OUT'<span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span> iN <span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    fid <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token punctuation">[</span>pathFiles<span class="token punctuation">,</span>Title<span class="token punctuation">,</span>'<span class="token punctuation">.</span>txt'<span class="token punctuation">]</span><span class="token punctuation">,</span>'wt'<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span> iMonth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token return-type class-name">nMonth</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span>fid<span class="token punctuation">,</span>'<span class="token operator">%</span>s'<span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span> iMonth <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">fprintf</span><span class="token punctuation">(</span>fid<span class="token punctuation">,</span>'<span class="token operator">%</span>s'<span class="token punctuation">,</span><span class="token punctuation">[</span>' FLOW_OUT_'<span class="token punctuation">,</span> <span class="token function">num2str</span><span class="token punctuation">(</span> <span class="token function">Q</span><span class="token punctuation">(</span>iMonth<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token char">'_'</span><span class="token punctuation">,</span> <span class="token function">num2str</span><span class="token punctuation">(</span> <span class="token function">Q</span><span class="token punctuation">(</span>iMonth<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">,</span><span class="token function">num2str</span><span class="token punctuation">(</span> <span class="token function">Q</span><span class="token punctuation">(</span>iMonth<span class="token punctuation">,</span>iN<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
        <span class="token function">fprintf</span><span class="token punctuation">(</span>fid<span class="token punctuation">,</span><span class="token char">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
end


<span class="token operator">%</span><span class="token operator">%</span> 调用函数
<span class="token class-name">function</span> Output <span class="token operator">=</span> <span class="token function">GetYearMonth</span><span class="token punctuation">(</span>yearStart<span class="token punctuation">,</span> yearEnd<span class="token punctuation">)</span>
<span class="token operator">%</span> 此函数获取年月序号

nYear <span class="token operator">=</span> yearEnd<span class="token operator">-</span>yearStart<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token function">Year</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> yearStart<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span>yearEnd<span class="token punctuation">;</span>
yearTemp <span class="token operator">=</span> <span class="token function">repmat</span><span class="token punctuation">(</span>Year<span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">monthOfYear</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">;</span>
monthTemp <span class="token operator">=</span> <span class="token function">repmat</span><span class="token punctuation">(</span>monthOfYear<span class="token punctuation">,</span>nYear<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token function">yearTemp</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token function">monthTemp</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

end
</code></pre> 
<p>输出结果如下：<br> <img src="https://images2.imgbox.com/85/00/Kp0x9MIk_o.png" alt="在这里插入图片描述"><br> <strong>3、Extraction文件夹：</strong><br> 有2 类与SWAT 输出文件output.rch、output.hru 和output.sub对应的文件，.txt 和.def。如果你有与这些文件变量对应的监测值，则你需要从这些文件中提取相应的模拟值。<br> .txt 文件只包含提取值应该写入的文件的名称，而.def 则定义了需要从哪个子流域提取变量。<br> 这些文件相对是不需要解释的。这里再次仅编辑需要的文件。<br> <img src="https://images2.imgbox.com/63/b2/h096r3sB_o.png" alt="在这里插入图片描述"><br> 由于本案例仅输入河道数据，更改var_file_rch文件如下：<br> 【注意】：这里填写子流域代码时，必须从小到大填写！不按照上下游的顺序！<br> <img src="https://images2.imgbox.com/cc/9e/t5RRw9rh_o.png" alt="在这里插入图片描述"><br> 更改SUFI2_extract_rch文件如下：</p> 
<blockquote> 
 <p>2，变量个数，不是rch的个数，而是变量的种类，不同的rch都输出为flowout，因此变量个数为1；但是如果同时校正流量和泥沙，不管矫正多少个出口，这里都为2.<br> 7，变量所在swat输出文件的列（SWAT输出文件的列与Output的列数两者相差1） 流域的总数量，根据实际情填写；<br> 3，第一个变量，Flow_out，用到的子流域个数，如果选择4个子流域的Flow_out，则填4；<br> 1__3__7，第一变量的子流域的代码，有多个出口，则需在中间隔2个空格； 1990，包括预热期在内的模拟起始年份；<br> 2001，模拟结束年份； 2，模拟的时间步长，1日，2月，3年。</p> 
</blockquote> 
<p>【注意】：这里填写子流域代码时，必须从小到大填写！不按照上下游的顺序！</p> 
<blockquote> 
 <p>【总结】：variables和 observed variables的区别<br> variables：单独的variables意味着变量的种类，种类为流量、泥沙、N含量，是指的类别 observed<br> variables：是指观测的变量，为流域出口的各种变量的和，一个出口的3种变量则为3，3个出口的1个变量，也为3</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/bc/4f/AVEIbAd5_o.png" alt="在这里插入图片描述"></p> 
<p><strong>4、定义Objective Function</strong><br> 应该编辑observed.txt 文件。这个文件包含了observed_rch.txt、observed_hru.txt 和observed_sub.txt 文件中的所有信息，加上一些计算目标函数的附加信息。<br> <img src="https://images2.imgbox.com/69/27/nhXytT4z_o.png" alt="在这里插入图片描述"><br> 同样地，Var_file_name.txt 包含了应该包括在目标函数中的所有变量的名字。这些名字与Extraction 部分var_file_*.txt 中的名字类似。<br> 【注意】：这里填写子流域代码时，必须从小到大填写！不按照上下游的顺序！<br> <img src="https://images2.imgbox.com/ce/98/XdugFaWG_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="Step2Executable_Files_216"></a>Step2：Executable Files（执行文件）</h4> 
<p>Executable Files在SWAT-CUP 担任引擎的角色。4 个批处理文件表明应该或不应该运行。</p> 
<ul><li>SUFI2_pre.bat——这个批处理文件运行预处理程序，现在包括运行拉丁超立方抽样程序。这个文件通常不需要编辑。</li><li>SUFI2_run.bat——这个程序执行SUFI2_execute.exe，运行SWAT_Edit.exe，提取批处理文件，还有SWAT2009.exe。</li><li>SUFI2_post.bat——运行后处理批处理文件，运行目标函数计算、新参数计算、95ppu计算、行为模拟的95ppu和无监测值变量的95ppu等程序。<br> <img src="https://images2.imgbox.com/a7/be/dqOqJpny_o.png" alt="在这里插入图片描述"></li><li>SUFI2_Extract.bat——这个批处理文件应该包含所有有或没有监测值的提取程序的名字。目前支持6个程序：<br> 这个文件必须编辑，且不想要运行的程序应该“被注释掉”如下所示：<br> <img src="https://images2.imgbox.com/b0/d2/DefBmyC5_o.png" alt="在这里插入图片描述"><br> 下一步，编辑过所有输入文件后，就可以执行Calibration中的程序。这一部分中，执行以下3步：</li><li>Sufi2_pre.bat——这个命令运行Sufi2_pre.bat 文件。在每一个新迭代启动前都必须运行这个文件。</li><li>SUFI2_run.bat——这个命令运行批处理文件。这个文件在第8 步中做了说明。</li><li>SUFI2_post.bat——在所有模拟结束之后，这个命令执行第8 步中说明的后处理批处理文件。</li></ul> 
<p>所有步骤执行完成后，即可进行下一步，校准输出。</p> 
<h4><a id="Step3_231"></a>Step3：校准输出</h4> 
<h5><a id="_232"></a>文件说明</h5> 
<ul><li> <p>95ppu plot——这个命令展示了所有变量的95ppu，也展示了当前迭代的监测值和最佳模拟值。</p> </li><li> <p>95ppu-No_Observed plot——这个命令展示了所有无监测值变量的95ppu。</p> </li><li> <p>Dotty Plots——这个命令展示了所有参数的dotty plots图。这些是参数值对目标函数的图。这些图的主要目的是展示抽样点的分布以及使人明白参数敏感性。<br> 参数点状图分析</p> </li><li> <p>Best_Par.txt——这个命令展示了当前迭代的<strong>最佳参数</strong>(给出目标函数的最佳值)<br> <img src="https://images2.imgbox.com/84/82/FWOeN6y8_o.png" alt="在这里插入图片描述"><br> 复制并粘贴到model.in文件中。</p> </li><li> <p>Best_Sim.txt——这个命令展示了最佳模拟值。</p> </li><li> <p>Goal.txt——这个命令展示了所有参数组的值以及最后一列的目标函数值。</p> </li><li> <p>New_Pars.txt——这个文件展示了下次迭代可以使用的新参数的建议值。这些值可以复制和粘贴到Par_inf.txt文件中以作下一次迭代。应该检查新参数中可能不合理的值(比如，负的渗透系数等)。这些参数值应该手动改正。</p> </li><li> <p>Summary_Stat——这个文件含有通过p-factor和r-factor对比监测数据和模拟带的统计信息和使用R2、NS、bR2、MSE和SSQR的当前迭代的最佳模拟。这些函数的定义可参见另一博客-<a href="https://blog.csdn.net/qq_44246618/article/details/128999913">【水文模型】评价指标</a>。同样展示的还有目标函数类型、当前迭代的最佳模拟编号和当前运行的最佳目标函数值。</p> </li></ul> 
<h4><a id="Step4_251"></a>Step4：模型检验</h4> 
<p><img src="https://images2.imgbox.com/ae/fe/KuqjYeiD_o.png" alt="在这里插入图片描述"><br> 要执行SUFI2中的验证，在必要时，编辑验证期的observed_rch.txt、observed_hru.txt、obsrved_sub.txt和observed.txt文件。<br> 同样，提取文件和file.cio也得对应是验证期。然后，不用再改变参数，使用校准过的参数范围去做一个完整的迭代(使用calibration按钮)。</p> 
<h2><a id="_256"></a>参考</h2> 
<p>1、<a href="https://blog.sciencenet.cn/blog-3459054-1308727.html" rel="nofollow">轻松学会SWAT系列4–基于SWATCUP的参数率定</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c15e7837eaf4482f93a3951218578a24/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Ubuntu20 USB 权限配置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6400674a16ab61ded888bb13f48c9dbd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">FreeRTOS调度器启动过程分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>