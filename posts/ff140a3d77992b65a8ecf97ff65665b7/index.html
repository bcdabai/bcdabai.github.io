<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ZFNet 详细解读 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ZFNet 详细解读" />
<meta property="og:description" content="❤ 文章有点长，可以收藏一下慢慢看哦 ~ 提出本模型的论文：
Visualizing and Understanding Convolutional Networks
一、写在前面的话 1. 为什么神经网络能够表现这么好？
仅靠一个理论上的自学习和一个理论上的多参数和一个理论上的非线性分类是无法令人们满意的。神经网络的黑盒子特性也让充满好奇心的机器学习学者们拼命想解开神经网络的秘密。在解密神经网络的庞大队伍中的重要分支是想要利用可视化等技术来对神经网络一探究竟，其中 Z 和 F 二人 开篇性的找到了将卷积核可视化的一种可行的方式。中南大学赵颖老师带领的可解释机器学习项目也加入其中，从此……
2. ZFNet 仅仅是在 AlexNet 上做了一些调参：
改变了 AlexNet 的第一层，即将滤波器的大小 11x11 变成 7x7，并且将步长 4 变成了 2（就这么一丁丁操作就改变了整个卷积神经网络的性能，并在2013年ImageNet大赛中夺冠）
========== 对比图：上为 AlexNet，下为 ZFNet ==========
3. ZFNet 凭什么将 11 改成 7，将步长减 2，是盲目调参吗？
显然发了这篇论文肯定是有自己的一个调参方法——根据可视化结果判断模型的效果，并可以确定一定的优化调参方向。
========== 对比图：========== 4. 当然这篇论文还根据遮挡图像的局部对分类结果的影响来探讨了对分类任务而言到底哪部分输入信息更重要。
二、ZFNet 中做出的改进，以及 Z 和 F 在神经网络可视化方面的独到见解 首先肯定是看看可视化神经网络的方式 （1）可视化什么东西： 卷积层提取出来的特征图像。
（2）如何可视化卷积核提取出来的特征图像？
复习 ： 每一层的基本操作是 : 卷积 -&gt; relu -&gt; 池化 -&gt; 归一化" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ff140a3d77992b65a8ecf97ff65665b7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-04T17:56:17+08:00" />
<meta property="article:modified_time" content="2023-11-04T17:56:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ZFNet 详细解读</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <hr> ❤ 文章有点长，可以收藏一下慢慢看哦 ~ 
<hr> 
<p><strong>提出本模型的论文：</strong></p> 
<blockquote> 
 <p>Visualizing and Understanding Convolutional Networks</p> 
</blockquote> 
<br> 
<h3><a id="_9"></a>一、写在前面的话</h3> 
<br> 
<p><strong>1. 为什么神经网络能够表现这么好？</strong></p> 
<p>仅靠一个理论上的自学习和一个理论上的多参数和一个理论上的非线性分类是无法令人们满意的。神经网络的黑盒子特性也让充满好奇心的机器学习学者们拼命想解开神经网络的秘密。在解密神经网络的庞大队伍中的重要分支是想要利用可视化等技术来对神经网络一探究竟，其中 <font color="red"><strong>Z 和 F 二人</strong></font> 开篇性的找到了<mark>将卷积核可视化的一种可行的方式</mark>。中南大学赵颖老师带领的可解释机器学习项目也加入其中，从此……</p> 
<br> 
<p><strong>2. ZFNet 仅仅是在 AlexNet 上做了一些调参：</strong></p> 
<p><mark>改变了 AlexNet 的第一层，即将滤波器的大小 11x11 变成 7x7，并且将步长 4 变成了 2</mark>（就这么一丁丁操作就改变了整个卷积神经网络的性能，并在2013年ImageNet大赛中夺冠）</p> 
<p><font color="blue">========== 对比图：上为 AlexNet，下为 ZFNet ==========</font><br> <img src="https://images2.imgbox.com/5a/2b/6gGGdWUu_o.png" alt="在这里插入图片描述"><br> <strong>3. ZFNet 凭什么将 11 改成 7，将步长减 2，是盲目调参吗？</strong></p> 
<p>显然发了这篇论文肯定是有自己的一个调参方法——<mark>根据可视化结果判断模型的效果，并可以确定一定的优化调参方向</mark>。</p> 
<p><font color="blue">========== 对比图：========== </font></p> 
<p><img src="https://images2.imgbox.com/0d/de/kR3OfJO2_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p><strong>4.</strong> 当然这篇论文还根据<mark>遮挡图像的局部对分类结果的影响</mark>来探讨了对分类任务而言到底<mark>哪部分输入信息更重要</mark>。</p> 
<br> 
<hr> 
<h3><a id="ZFNet__Z__F__38"></a>二、ZFNet 中做出的改进，以及 Z 和 F 在神经网络可视化方面的独到见解</h3> 
<br> 
<h5><a id="font_colorred__41"></a><font color="red"> 首先肯定是看看可视化神经网络的方式</font></h5> 
<p>（1）<strong>可视化什么东西：</strong> 卷积层提取出来的特征图像。<br> （2）<strong>如何可视化卷积核提取出来的特征图像？</strong></p> 
<h6><a id="font_colororange_font_45"></a><font color="orange">复习 ：</font></h6> 
<p><strong>每一层的基本操作是 :</strong> <mark>卷积 -&gt; relu -&gt; 池化 -&gt; 归一化</mark></p> 
<p><strong>卷积操作：</strong><br> <img src="https://images2.imgbox.com/fd/a2/BOV4B9ps_o.png" alt="在这里插入图片描述"><strong>池化操作：</strong><img src="https://images2.imgbox.com/a2/13/3rpkigbA_o.png" alt="在这里插入图片描述"><br> <font color="red"> 思考：</font> 看到这里每一层的基本操作之后，如果我们想要可视化一下输出的图片是不是挺好？那能直接转变成像素图片进行可视化吗？或者是进行一些什么样的操作？</p> 
<p><font color="red"> Z和F的思考：</font> <mark>截取最终模型的池化层的输出，然后反池化，“反relu”，反卷积，将得到的图片进行展示。</mark> 如下图：<br> <img src="https://images2.imgbox.com/11/44/2NeNNlsc_o.png" alt="在这里插入图片描述"><br> <font color="red">问题1：</font><strong>是对任意一个输入的图片的任意一层的任意一个卷积核的卷积出来的结果进行该操作然后展示吗？</strong></p> 
<p>显然不是，因为一张狗的图片对于一个可以提取人脸信息的卷积核是提取不到有用的信息的。那么在选用图片的时候选择一个能让该卷积核<mark>激活最大化</mark>的图片作为输入就可以了。（ 激活最大化可以理解为：这张图片里面的某一特征正好可以被该卷积核完美的提取出来。官方解释论文还未阅读 ）</p> 
<br> 
<p><font color="red">问题2：</font><strong>为什么不从截取归一化的操作进行反归一化然后反池化……</strong></p> 
<p>在已经训练出来神经网络模型之后，通过输入图片一层一层的正向传播最终的到输出，而归一化的主要作用是限制每一层的输出范围，提取特征的任务<mark>主要</mark>交给<mark>卷积、激活 和 池化</mark>操作。况且归一化也确实不好进行逆向计算。</p> 
<br> 
<p><font color="red">问题3：</font><strong>如何反池化？ 如何“反relu” ？ 如何反卷积（转置卷积）?</strong></p> 
<p>这两个人开创性的想到：</p> 
<p><strong>① 反池化：</strong> 利用一组<mark>转换变量switch</mark>在每个池化区域记录最大值的位置来确定最有效的特征值的位置。那么就可以将池化后的输出Pooled Map 按照 switch 记录的位置填回去喽。</p> 
<p><img src="https://images2.imgbox.com/5f/f6/i5FMIgKs_o.png" alt="在这里插入图片描述"><br></p> 
<p><strong>② “反relu”：</strong> <mark>根据 y 求 x 喽</mark> ，又因为 y = max(x) ，经过pooling后大概率是正数 ，那么就 <mark>x = y</mark> 呗，如果 y = 0 的话信息已经丢掉了也没法弥补x= 0。<em>（我的理解 这里论文没有讲述）</em></p> 
<p><strong>③ 反卷积：</strong> 大数学论证，（<mark>由卷积之后获得的特征值获得原图像大小的数据分布</mark>）简单的说就是存在一种技术让下图中的 5×5 的像素经过卷积之后得到的 3×3 输出，经过一系列变换 ，再变回 5×5 的像素排列（尽管会有部分数据损失，但是也没办法，此技术不为论文重点，作者也是直接用的该技术）。</p> 
<p><font color="oange"> ========== 例子1 ==========</font><br> <strong>卷积：</strong><br> <img src="https://images2.imgbox.com/95/9b/LJao9S0c_o.png" alt="在这里插入图片描述"><br> <strong>反卷积：</strong><br> <img src="https://images2.imgbox.com/f0/b9/3SUbPa8O_o.png" alt="在这里插入图片描述"><br> <strong>反卷积中的 padding stride 卷积核大小的确定：</strong></p> 
<p><mark>P反 = 卷积核大小 - P正 - 1</mark>，图中为（3-0-1=2）<br> <mark>Stride反 = stride的倒数</mark>， 那么就用填充 0 来表示倒数卷积核大小与正卷积核大小相同<br> <br></p> 
<p><font color="oange"> ========== 例子2 ==========</font><br> <strong>卷积：</strong><br> <img src="https://images2.imgbox.com/23/76/v43fvYGB_o.png" alt="在这里插入图片描述"><br> <strong>反卷积：</strong><br> <img src="https://images2.imgbox.com/7b/7c/eM1sjVT0_o.png" alt="在这里插入图片描述"><br> Padding = 3 -1 - 1 = 1<br> Stride = 1/2 相当于填充一个白格子</p> 
<br> 
<hr> 
<h3><a id="_101"></a>三、结果</h3> 
<h5><a id="font_colorred_font_102"></a><font color="red"> 根据该方法可以在一定程度上可视化得到卷积层中每个卷积核提取出来的特征。</font></h5> 
<p><img src="https://images2.imgbox.com/96/e5/cJzNn2lc_o.png" alt="在这里插入图片描述"><br> <font color="red">发现1：</font>由上图可以看到：<br> ① 第二层应对角落和其他边缘或者颜色的结合；<br> ② 第三层有更加复杂的不变性，捕捉到了相似的纹理；<br> ③ 第四层显示了特定类间显著的差异性；<br> ④ 第五层显示了有显著构成变化的整个物体。</p> 
<br> 
<p><font color="red">发现2：</font>模型的底层在少数几个 epoches 就能收敛聚集，然而上层在一个相当多的 epoches (40-50) 之后才能有所变化，这显示了<mark>让模型完全训练到完全收敛的必要性</mark>。</p> 
<p><strong>可以由下图看到颜色对比度都逐步增强：</strong><br> <img src="https://images2.imgbox.com/f2/ae/L5xjlN1w_o.png" alt="在这里插入图片描述"><br> <br></p> 
<p><font color="red">发现3：</font> <mark>特征不变性</mark>：一般来说，小的变化对于模型的第一层都有非常大的影响，但对于最高层的影响却几乎没有。对于图像的平移、尺度、旋转的变化来说，网络的输出对于平移和尺度变化都是稳定的，但却不具有旋转不变性，除非目标图像时旋转对称的。</p> 
<p><strong>下图为分别对平移，尺度，旋转做的分析图：</strong><br> <img src="https://images2.imgbox.com/f8/a0/DrW3ABg6_o.png" alt="在这里插入图片描述"><br> <strong>分析：</strong> 上图按行顺序分别为对5类图像进行不同程度的垂直方向上的平移、尺度变换、旋转对输出结果影响的分析图。按列顺序分别为原始变换图像，第一层中原始图片和变换后的图片的欧氏距离，第7层中原始图片和变换后的图片的欧氏距离，变换后图片被正确分类的概率图。</p> 
<br> 
<p><font color="red">思考：</font><strong>到现在，我们一直存在一个疑问：</strong><br> <mark>模型可以根据一个图片提取出来不计其数的特征</mark>，尤其是卷积操作还是平移着一部分一部分地尝试提取特征的，<mark>哪个特征最有效?</mark> 一张狗的图片中顶多一部分是狗对吧，不可能贡献一般大的。那么<mark>图片中的哪个部分贡献最大?</mark></p> 
<br> 
<hr> 
<h3><a id="_132"></a>四、其他一</h3> 
<h5><a id="font_colorred_____font_133"></a><font color="red"> 该论文还描述了通过 &lt;遮挡实验&gt; 来确定一张图片中最重要的部分是哪（ 通过哪一部分得出的相应结果 ）。</font></h5> 
<p><strong>1、方法：</strong> 用一个灰色小方块来挡住图像中的目标，然后再观测输出的分类情况来分析。</p> 
<p><strong>2、结果：</strong></p> 
<p><img src="https://images2.imgbox.com/97/ca/PytKlguv_o.png" alt="在这里插入图片描述"><br> 上图为对三个不同的测试图片中的不同位置用灰色小方块进行掩盖后，观测分类输出的改变情况。</p> 
<p>第一列（a）为原始测试图片；<br> 第二列（b）为某个区域被灰色小方块掩盖后的网络结构中第五层的特征图；<br> 第三列（c）为将第五层的特征图投影到输入图像的可视化图像；<br> 第四列（d）为正确分类概率的图；<br> 第五列（e）为最有可能的标签。</p> 
<p>第一行表明最强烈的特征表现在狗狗的面部区域。</p> 
<p><mark>上述结果表明，如果图像中的目标被遮挡，那么被正确分类的概率会显著降低，这表明这种可视化与激发特征图的图像结构式真正对应上的。即大概能知道位置。</mark></p> 
<p><font color="red">思考：</font>如何利用可视化来优化参数？</p> 
<br> 
<hr> 
<h3><a id="_157"></a>五、其他二</h3> 
<h5><a id="font_colorred__158"></a><font color="red"> 通过判断提取出来的特征是否有效，失效在什么地方？来决定自己的参数优化趋势。</font></h5> 
<p><img src="https://images2.imgbox.com/2e/48/DODYeNXN_o.png" alt="在这里插入图片描述"></p> 
<p><font color="red">发现：</font> 原有的 <mark>AlexNet</mark> 中提取出来的特征因为 <mark>卷积核太大，池化部分步长设置过大</mark> 导致是 <mark>有一部分失效的</mark> ，<mark>所以减小第一层卷积核大小11-&gt;7 池化步长4-&gt;2</mark></p> 
<br> 
<hr> 
<h3><a id="_166"></a>六、启发</h3> 
<h5><a id="font_colorred__167"></a><font color="red"> 盲目调参费时费力，充分挖掘神经网络可视化的方法有助于我们进一步地打开神经网络这个黑匣子。</font></h5>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8a43a74849b747503fec5bc3bef78f4d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[第七届集创赛]紫光同创杯--部分讲解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6fb0349fda130b365a2ced377fd3d4b4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">wandb 网络连接问题解决指南</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>