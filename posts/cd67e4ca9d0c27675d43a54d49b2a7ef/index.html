<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python基础知识——Pandas数据分析篇 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python基础知识——Pandas数据分析篇" />
<meta property="og:description" content="Pandas数据结构 Pandas有3种数据结构：系列（Series）、数据帧（DataFrame）和面板（Panel），这些数据结构可以构建在NumPy数组之上
1、Series(系列)——具有均匀数据的一维数组结构 pandas.Series(data, index, dtype, copy)
2、DataFrame(数据帧)——具有异构数据的二维数组 pandas.DataFrame(data, index, coloumns, dtype, copy)
3、Panel(面板)——具有异构数据的三维数据结构 pandas.Panel(data, items, major_axis, minor_axis, dtype, copy)
Series
# Series import pandas as pd import numpy as np data = np.array([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;]) s1 = pd.Series(data) print(&#39;默认索引：&#39;) print(s1) print(&#39;#####################&#39;) s2 = pd.Series(data, index=[100, 101, 102, 103, 200]) # 指定索引 print(&#39;指定索引：&#39;) print(s2) print(&#39;#####################&#39;) print(&#39;索引s1[0:2]=&#39;) # 左闭右开 print(s1[0:2]) print(&#39;#####################&#39;) print(&#39;索引s2[[100, 102]]=&#39;) print(s2[[100, 102]]) # 进行选择 print(&#39;#####################&#39;) print(&#39;索引s2[100]=&#39;, s2[100]) print(&#39;#####################&#39;) print(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/cd67e4ca9d0c27675d43a54d49b2a7ef/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-04T15:45:01+08:00" />
<meta property="article:modified_time" content="2023-01-04T15:45:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python基础知识——Pandas数据分析篇</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Pandas_0"></a>Pandas数据结构</h2> 
<p>Pandas有3种数据结构：系列（Series）、数据帧（DataFrame）和面板（Panel），这些数据结构可以构建在NumPy数组之上<br> 1、Series(系列)——具有均匀数据的一维数组结构 pandas.Series(data, index, dtype, copy)<br> 2、DataFrame(数据帧)——具有异构数据的二维数组 pandas.DataFrame(data, index, coloumns, dtype, copy)<br> 3、Panel(面板)——具有异构数据的三维数据结构 pandas.Panel(data, items, major_axis, minor_axis, dtype, copy)</p> 
<p><strong>Series</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># Series</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'默认索引：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

s2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>data<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 指定索引</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'指定索引：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'索引s1[0:2]='</span><span class="token punctuation">)</span> <span class="token comment"># 左闭右开</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'索引s2[[100, 102]]='</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s2<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 进行选择</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'索引s2[100]='</span><span class="token punctuation">,</span> s2<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"系列中修改c的元素组成的系列：s1[s1&lt;'c']="</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s1<span class="token punctuation">[</span>s1<span class="token operator">&lt;</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'s2.index='</span><span class="token punctuation">,</span> s2<span class="token punctuation">.</span>index<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
默认索引：
<span class="token number">0</span>    a
<span class="token number">1</span>    b
<span class="token number">2</span>    c
<span class="token number">3</span>    d
<span class="token number">4</span>    e
dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>
<span class="token comment">#####################</span>
指定索引：
<span class="token number">100</span>    a
<span class="token number">101</span>    b
<span class="token number">102</span>    c
<span class="token number">103</span>    d
<span class="token number">200</span>    e
dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>
<span class="token comment">#####################</span>
索引s1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token number">0</span>    a
<span class="token number">1</span>    b
dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>
<span class="token comment">#####################</span>
索引s2<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token number">100</span>    a
<span class="token number">102</span>    c
dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>
<span class="token comment">#####################</span>
索引s2<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token operator">=</span> a
<span class="token comment">#####################</span>
系列中修改c的元素组成的系列：s1<span class="token punctuation">[</span>s1<span class="token operator">&lt;</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token operator">=</span>
<span class="token number">0</span>    a
<span class="token number">1</span>    b
dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>
<span class="token comment">#####################</span>
s2<span class="token punctuation">.</span>index<span class="token operator">=</span> Int64Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int64'</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>DataFrame</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># DataFrame</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'创建空数据帧：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'df1='</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'小明'</span><span class="token punctuation">,</span><span class="token string">'小花'</span><span class="token punctuation">,</span><span class="token string">'小兰'</span><span class="token punctuation">,</span><span class="token string">'小胜'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'gender'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'df2=\n'</span><span class="token punctuation">,</span>df2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token string">'gender'</span><span class="token punctuation">:</span><span class="token string">'男'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string">'小花'</span><span class="token punctuation">,</span> <span class="token string">'gender'</span><span class="token punctuation">:</span><span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
df3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'gender'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 设置行列名</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'df3='</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df3<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

d <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'b'</span><span class="token punctuation">:</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'5'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token comment"># 将Series嵌套调用进DataFrame，索引中为空的值直接补'NaN'</span>
df4 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'df4='</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df4<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'df2.index='</span><span class="token punctuation">,</span> df2<span class="token punctuation">.</span>index<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'df2.columns='</span><span class="token punctuation">,</span> df2<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
创建空数据帧：
Empty DataFrame
Columns<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
Index<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment">#####################</span>
df1<span class="token operator">=</span>
    <span class="token number">0</span>
<span class="token number">0</span>  <span class="token number">11</span>
<span class="token number">1</span>  <span class="token number">12</span>
<span class="token number">2</span>  <span class="token number">13</span>
<span class="token number">3</span>  <span class="token number">14</span>
<span class="token comment">#####################</span>
df2<span class="token operator">=</span>
   name gender
<span class="token number">0</span>   小明      男
<span class="token number">1</span>   小花      女
<span class="token number">2</span>   小兰      女
<span class="token number">3</span>   小胜      男
<span class="token comment">#####################</span>
df3<span class="token operator">=</span>
  name gender   age
<span class="token number">1</span>   小明      男   NaN
<span class="token number">2</span>   小花      女  <span class="token number">32.0</span>
<span class="token comment">#####################</span>
df4<span class="token operator">=</span>
     a    b
<span class="token number">1</span>  <span class="token number">0.0</span>  <span class="token number">0.0</span>
<span class="token number">2</span>  <span class="token number">1.0</span>  <span class="token number">1.0</span>
<span class="token number">3</span>  <span class="token number">2.0</span>  NaN
<span class="token number">4</span>  NaN  <span class="token number">2.0</span>
<span class="token number">5</span>  NaN  <span class="token number">3.0</span>
<span class="token comment">#####################</span>
df2<span class="token punctuation">.</span>index<span class="token operator">=</span> RangeIndex<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> stop<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> step<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
df2<span class="token punctuation">.</span>columns<span class="token operator">=</span> Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'gender'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span>
<span class="token comment">#####################</span>
</code></pre> 
<p><strong>Panel</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># Panel</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd 
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
data <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment"># rand——服从[0,1)之间的均匀分布，randn——服从标准正态分布</span>
p <span class="token operator">=</span> pd<span class="token punctuation">.</span>Panel<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'第一个p='</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'Item1'</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token string">'Item2'</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
p <span class="token operator">=</span> pd<span class="token punctuation">.</span>Panel<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'第二个p='</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"p['Item1']="</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token string">'Item1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
第一个p<span class="token operator">=</span>
<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'pandas.core.panel.Panel'</span><span class="token operator">&gt;</span>
Dimensions<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">(</span>items<span class="token punctuation">)</span> x <span class="token number">4</span> <span class="token punctuation">(</span>major_axis<span class="token punctuation">)</span> x <span class="token number">5</span> <span class="token punctuation">(</span>minor_axis<span class="token punctuation">)</span>
Items axis<span class="token punctuation">:</span> <span class="token number">0</span> to <span class="token number">1</span>
Major_axis axis<span class="token punctuation">:</span> <span class="token number">0</span> to <span class="token number">3</span>
Minor_axis axis<span class="token punctuation">:</span> <span class="token number">0</span> to <span class="token number">4</span>
<span class="token comment">#####################</span>
第二个p<span class="token operator">=</span>
<span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'pandas.core.panel.Panel'</span><span class="token operator">&gt;</span>
Dimensions<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">(</span>items<span class="token punctuation">)</span> x <span class="token number">4</span> <span class="token punctuation">(</span>major_axis<span class="token punctuation">)</span> x <span class="token number">3</span> <span class="token punctuation">(</span>minor_axis<span class="token punctuation">)</span>
Items axis<span class="token punctuation">:</span> Item1 to Item2
Major_axis axis<span class="token punctuation">:</span> <span class="token number">0</span> to <span class="token number">3</span>
Minor_axis axis<span class="token punctuation">:</span> <span class="token number">0</span> to <span class="token number">2</span>
p<span class="token punctuation">[</span><span class="token string">'Item1'</span><span class="token punctuation">]</span><span class="token operator">=</span>
          <span class="token number">0</span>         <span class="token number">1</span>         <span class="token number">2</span>
<span class="token number">0</span> <span class="token operator">-</span><span class="token number">1.216973</span> <span class="token operator">-</span><span class="token number">0.804201</span>  <span class="token number">0.612168</span>
<span class="token number">1</span> <span class="token operator">-</span><span class="token number">0.607057</span>  <span class="token number">0.694872</span> <span class="token operator">-</span><span class="token number">0.113100</span>
<span class="token number">2</span> <span class="token operator">-</span><span class="token number">2.127714</span> <span class="token operator">-</span><span class="token number">0.560315</span>  <span class="token number">2.004696</span>
<span class="token number">3</span> <span class="token operator">-</span><span class="token number">0.013660</span>  <span class="token number">0.894818</span> <span class="token operator">-</span><span class="token number">0.642299</span>
</code></pre> 
<h2><a id="DataFrame_196"></a>DataFrame基本功能</h2> 
<p>DataFrame的基本功能包括数据帧的重要属性和方法。<br> 查看DataFrame对象的小样本，可使用head()和tail()方法，head()返回前n行（观察索引值），显示元素默认为5。tail()返回后n行。<br> df.T——转置；df.axes——轴序列；df.dtypes——数据类型；df.empty——是否为空；df.ndim——维度；df.shape——形状；df.size——元素数量；df.values——实际数据的NumPy表示；</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
d <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'name'</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'小明'</span><span class="token punctuation">,</span><span class="token string">'小花'</span><span class="token punctuation">,</span><span class="token string">'小兰'</span><span class="token punctuation">,</span><span class="token string">'小胜'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'gender'</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'age'</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'calss'</span><span class="token punctuation">:</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'1班'</span><span class="token punctuation">,</span><span class="token string">'1班'</span><span class="token punctuation">,</span><span class="token string">'2班'</span><span class="token punctuation">,</span><span class="token string">'1班'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'原数据帧：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'转置：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>T<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'轴序列：'</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>axes<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'数据类型：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'是否为空'</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>empty<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'维度'</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>ndim<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'形状'</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'元素数量'</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'实际数据的NumPy表示：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>values<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#####################'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'前3行数据：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'后3行数据：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>tail<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
原数据帧：
  name gender  age calss
<span class="token number">0</span>   小明      男   <span class="token number">20</span>    <span class="token number">1</span>班
<span class="token number">1</span>   小花      女   <span class="token number">22</span>    <span class="token number">1</span>班
<span class="token number">2</span>   小兰      女   <span class="token number">19</span>    <span class="token number">2</span>班
<span class="token number">3</span>   小胜      男   <span class="token number">23</span>    <span class="token number">1</span>班
<span class="token comment">#####################</span>
转置：
         <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">2</span>   <span class="token number">3</span>
name    小明  小花  小兰  小胜
gender   男   女   女   男
age     <span class="token number">20</span>  <span class="token number">22</span>  <span class="token number">19</span>  <span class="token number">23</span>
calss   <span class="token number">1</span>班  <span class="token number">1</span>班  <span class="token number">2</span>班  <span class="token number">1</span>班
<span class="token comment">#####################</span>
轴序列： <span class="token punctuation">[</span>RangeIndex<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> stop<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> step<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'gender'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'calss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
数据类型：
name      <span class="token builtin">object</span>
gender    <span class="token builtin">object</span>
age        int64
calss     <span class="token builtin">object</span>
dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>
是否为空 <span class="token boolean">False</span>
维度 <span class="token number">2</span>
形状 <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
元素数量 <span class="token number">16</span>
实际数据的NumPy表示：
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'小明'</span> <span class="token string">'男'</span> <span class="token number">20</span> <span class="token string">'1班'</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token string">'小花'</span> <span class="token string">'女'</span> <span class="token number">22</span> <span class="token string">'1班'</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token string">'小兰'</span> <span class="token string">'女'</span> <span class="token number">19</span> <span class="token string">'2班'</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token string">'小胜'</span> <span class="token string">'男'</span> <span class="token number">23</span> <span class="token string">'1班'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token comment">#####################</span>
前<span class="token number">3</span>行数据：
  name gender  age calss
<span class="token number">0</span>   小明      男   <span class="token number">20</span>    <span class="token number">1</span>班
<span class="token number">1</span>   小花      女   <span class="token number">22</span>    <span class="token number">1</span>班
<span class="token number">2</span>   小兰      女   <span class="token number">19</span>    <span class="token number">2</span>班
后<span class="token number">3</span>行数据：
  name gender  age calss
<span class="token number">1</span>   小花      女   <span class="token number">22</span>    <span class="token number">1</span>班
<span class="token number">2</span>   小兰      女   <span class="token number">19</span>    <span class="token number">2</span>班
<span class="token number">3</span>   小胜      男   <span class="token number">23</span>    <span class="token number">1</span>班
</code></pre> 
<h2><a id="Pandas_279"></a>Pandas数据运算</h2> 
<h3><a id="_280"></a>算术运算</h3> 
<p>Pandas的Series/DataFrame数据对象在进行算术运算时，如果有相同索引名，则对相同索引的数据进行运算；如果没有，则引入缺失值。<br> Pandas的Series和DataFrame对象也可以进行算术运算，因为维度不同，所以运算遵循广播规则。</p> 
<p><strong>系列(Series)算术运算</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
s1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'s1='</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'s2='</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'s1+s2='</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s1<span class="token operator">+</span>s2<span class="token punctuation">)</span> <span class="token comment"># 如果有相同索引名，则对相同索引的数据进行运算；如果没有，则引入缺失值</span>

s3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s4 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'s3+s4='</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s3<span class="token operator">+</span>s4<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
s1<span class="token operator">=</span>
a    <span class="token number">1</span>
b    <span class="token number">2</span>
c    <span class="token number">3</span>
dtype<span class="token punctuation">:</span> int64
s2<span class="token operator">=</span>
a    <span class="token number">11</span>
b    <span class="token number">12</span>
d    <span class="token number">13</span>
dtype<span class="token punctuation">:</span> int64
s1<span class="token operator">+</span>s2<span class="token operator">=</span>
a    <span class="token number">12.0</span>
b    <span class="token number">14.0</span>
c     NaN
d     NaN
dtype<span class="token punctuation">:</span> float64
s3<span class="token operator">+</span>s4<span class="token operator">=</span>
<span class="token number">0</span>    <span class="token number">12</span>
<span class="token number">1</span>    <span class="token number">14</span>
<span class="token number">2</span>    <span class="token number">16</span>
dtype<span class="token punctuation">:</span> int64
</code></pre> 
<p><strong>数据帧(DataFrame)算术运算</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
d1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>d1<span class="token punctuation">)</span>

d2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     <span class="token string">'d'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>d2<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token operator">+</span>df2<span class="token punctuation">)</span> <span class="token comment"># 如果有相同索引名，则对相同索引的数据进行运算；如果没有，则引入缺失值</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
    a   b   c   d
<span class="token number">0</span>  <span class="token number">12</span>  <span class="token number">16</span> NaN NaN
<span class="token number">1</span>  <span class="token number">14</span>  <span class="token number">18</span> NaN NaN
</code></pre> 
<p><strong>系列(Series)和数据帧(DataFrame)算术运算</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token operator">+</span>s<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
   a  b  c
<span class="token number">0</span>  <span class="token number">2</span>  <span class="token number">5</span>  <span class="token number">8</span>
<span class="token number">1</span>  <span class="token number">3</span>  <span class="token number">6</span>  <span class="token number">9</span>
</code></pre> 
<h3><a id="_370"></a>函数应用与映射运算</h3> 
<p>函数应用与映射运算的作用是将其他函数或者自定义函数应用于Pandas对象，主要包括：pipe()、apply()、applymap()和map()。<br> 函数pipe()将其他函数套用在整个DataFrame函数上；<br> 函数apply()将其他函数套用到DataFrame的行或列上；<br> 函数applymap()将其他函数套用到DataFrame的每一个元素上；<br> 函数map()将其他函数套用到Series的每个元素中，DataFrame的行或者列都是Series对象。</p> 
<p><strong>pipe()函数应用</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># pipe()函数应用</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">def</span> <span class="token function">fun</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> ele<span class="token operator">*</span><span class="token number">2</span>
data <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>pipe<span class="token punctuation">(</span>fun<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
    a   b   c
<span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">4</span>
<span class="token number">1</span>   <span class="token number">6</span>   <span class="token number">8</span>  <span class="token number">10</span>
<span class="token number">2</span>  <span class="token number">12</span>  <span class="token number">14</span>  <span class="token number">16</span>
</code></pre> 
<p><strong>apply()函数应用</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># apply()函数应用</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
   a  b   c   d
<span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">1</span>   <span class="token number">2</span>   <span class="token number">3</span>
<span class="token number">1</span>  <span class="token number">4</span>  <span class="token number">5</span>   <span class="token number">6</span>   <span class="token number">7</span>
<span class="token number">2</span>  <span class="token number">8</span>  <span class="token number">9</span>  <span class="token number">10</span>  <span class="token number">11</span>
a    <span class="token number">4.0</span>
b    <span class="token number">5.0</span>
c    <span class="token number">6.0</span>
d    <span class="token number">7.0</span>
dtype<span class="token punctuation">:</span> float64
<span class="token number">0</span>    <span class="token number">1.5</span>
<span class="token number">1</span>    <span class="token number">5.5</span>
<span class="token number">2</span>    <span class="token number">9.5</span>
dtype<span class="token punctuation">:</span> float64
a    <span class="token number">12</span>
b    <span class="token number">15</span>
c    <span class="token number">18</span>
d    <span class="token number">21</span>
dtype<span class="token punctuation">:</span> int64
</code></pre> 
<p><strong>applymap()函数应用</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># applymap()函数应用</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>applymap<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>power<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
   a  b   c   d
<span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">1</span>   <span class="token number">2</span>   <span class="token number">3</span>
<span class="token number">1</span>  <span class="token number">4</span>  <span class="token number">5</span>   <span class="token number">6</span>   <span class="token number">7</span>
<span class="token number">2</span>  <span class="token number">8</span>  <span class="token number">9</span>  <span class="token number">10</span>  <span class="token number">11</span>
    a   b    c    d
<span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span>    <span class="token number">4</span>    <span class="token number">9</span>
<span class="token number">1</span>  <span class="token number">16</span>  <span class="token number">25</span>   <span class="token number">36</span>   <span class="token number">49</span>
<span class="token number">2</span>  <span class="token number">64</span>  <span class="token number">81</span>  <span class="token number">100</span>  <span class="token number">121</span>
</code></pre> 
<h3><a id="_453"></a>排序</h3> 
<p>Pandas有两种排序方式，分别是：按标签排序和按实际值排序。<br> 1、sort_index()函数——按标签排序<br> 2、sort_values()函数——按实际值排序</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'原数据帧：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'按行索引升序：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'按行索引降序：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'按列索引升序：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'按列索引降序：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#############'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'按b排序：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'先按b排序，若b相同再按c排序'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 先按b排序，若b相同再按c排序</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
原数据帧：
    a   c  b   d
<span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">5</span>  <span class="token number">3</span>   <span class="token number">7</span>
<span class="token number">4</span>  <span class="token number">16</span>  <span class="token number">14</span>  <span class="token number">2</span>  <span class="token number">16</span>
<span class="token number">2</span>  <span class="token number">29</span>  <span class="token number">27</span>  <span class="token number">2</span>  <span class="token number">25</span>
按行索引升序：
    a   c  b   d
<span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">5</span>  <span class="token number">3</span>   <span class="token number">7</span>
<span class="token number">2</span>  <span class="token number">29</span>  <span class="token number">27</span>  <span class="token number">2</span>  <span class="token number">25</span>
<span class="token number">4</span>  <span class="token number">16</span>  <span class="token number">14</span>  <span class="token number">2</span>  <span class="token number">16</span>
按行索引降序：
    a   c  b   d
<span class="token number">4</span>  <span class="token number">16</span>  <span class="token number">14</span>  <span class="token number">2</span>  <span class="token number">16</span>
<span class="token number">2</span>  <span class="token number">29</span>  <span class="token number">27</span>  <span class="token number">2</span>  <span class="token number">25</span>
<span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">5</span>  <span class="token number">3</span>   <span class="token number">7</span>
按列索引升序：
    a  b   c   d
<span class="token number">0</span>   <span class="token number">2</span>  <span class="token number">3</span>   <span class="token number">5</span>   <span class="token number">7</span>
<span class="token number">4</span>  <span class="token number">16</span>  <span class="token number">2</span>  <span class="token number">14</span>  <span class="token number">16</span>
<span class="token number">2</span>  <span class="token number">29</span>  <span class="token number">2</span>  <span class="token number">27</span>  <span class="token number">25</span>
按列索引降序：
    d   c  b   a
<span class="token number">0</span>   <span class="token number">7</span>   <span class="token number">5</span>  <span class="token number">3</span>   <span class="token number">2</span>
<span class="token number">4</span>  <span class="token number">16</span>  <span class="token number">14</span>  <span class="token number">2</span>  <span class="token number">16</span>
<span class="token number">2</span>  <span class="token number">25</span>  <span class="token number">27</span>  <span class="token number">2</span>  <span class="token number">29</span>
<span class="token comment">#############</span>
按b排序：
    a   c  b   d
<span class="token number">4</span>  <span class="token number">16</span>  <span class="token number">14</span>  <span class="token number">2</span>  <span class="token number">16</span>
<span class="token number">2</span>  <span class="token number">29</span>  <span class="token number">27</span>  <span class="token number">2</span>  <span class="token number">25</span>
<span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">5</span>  <span class="token number">3</span>   <span class="token number">7</span>
先按b排序，若b相同再按c排序
    a   c  b   d
<span class="token number">4</span>  <span class="token number">16</span>  <span class="token number">14</span>  <span class="token number">2</span>  <span class="token number">16</span>
<span class="token number">2</span>  <span class="token number">29</span>  <span class="token number">27</span>  <span class="token number">2</span>  <span class="token number">25</span>
<span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">5</span>  <span class="token number">3</span>   <span class="token number">7</span>
</code></pre> 
<h3><a id="_525"></a>迭代</h3> 
<h4><a id="DataFrame_526"></a>迭代DataFrame的列</h4> 
<p><strong>DataFrame迭代</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># DataFrame迭代</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">for</span> col <span class="token keyword">in</span> df<span class="token punctuation">:</span> <span class="token comment"># 找到列索引</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>col<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
    a   c  b   d
<span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">5</span>  <span class="token number">3</span>   <span class="token number">7</span>
<span class="token number">4</span>  <span class="token number">16</span>  <span class="token number">14</span>  <span class="token number">2</span>  <span class="token number">16</span>
<span class="token number">2</span>  <span class="token number">29</span>  <span class="token number">27</span>  <span class="token number">2</span>  <span class="token number">25</span>
a
<span class="token number">0</span>     <span class="token number">2</span>
<span class="token number">4</span>    <span class="token number">16</span>
<span class="token number">2</span>    <span class="token number">29</span>
Name<span class="token punctuation">:</span> a<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int32
c
<span class="token number">0</span>     <span class="token number">5</span>
<span class="token number">4</span>    <span class="token number">14</span>
<span class="token number">2</span>    <span class="token number">27</span>
Name<span class="token punctuation">:</span> c<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int32
b
<span class="token number">0</span>    <span class="token number">3</span>
<span class="token number">4</span>    <span class="token number">2</span>
<span class="token number">2</span>    <span class="token number">2</span>
Name<span class="token punctuation">:</span> b<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int32
d
<span class="token number">0</span>     <span class="token number">7</span>
<span class="token number">4</span>    <span class="token number">16</span>
<span class="token number">2</span>    <span class="token number">25</span>
Name<span class="token punctuation">:</span> d<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int32
</code></pre> 
<p><strong>iteritems()迭代函数应用</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># iteritems()迭代函数应用</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> df<span class="token punctuation">.</span>iteritems<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'key='</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
key<span class="token operator">=</span> a
<span class="token number">0</span>     <span class="token number">2</span>
<span class="token number">4</span>    <span class="token number">16</span>
<span class="token number">2</span>    <span class="token number">29</span>
Name<span class="token punctuation">:</span> a<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int32
key<span class="token operator">=</span> c
<span class="token number">0</span>     <span class="token number">5</span>
<span class="token number">4</span>    <span class="token number">14</span>
<span class="token number">2</span>    <span class="token number">27</span>
Name<span class="token punctuation">:</span> c<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int32
key<span class="token operator">=</span> b
<span class="token number">0</span>    <span class="token number">3</span>
<span class="token number">4</span>    <span class="token number">2</span>
<span class="token number">2</span>    <span class="token number">2</span>
Name<span class="token punctuation">:</span> b<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int32
key<span class="token operator">=</span> d
<span class="token number">0</span>     <span class="token number">7</span>
<span class="token number">4</span>    <span class="token number">16</span>
<span class="token number">2</span>    <span class="token number">25</span>
Name<span class="token punctuation">:</span> d<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int32
</code></pre> 
<h4><a id="DataFrame_605"></a>迭代DataFrame的行</h4> 
<p>遍历DataFrame的行可以使用以下函数：<br> ①iterrows(): 将行迭代为对，产生每个行索引值以及包含每行数据的序列；<br> ②itertuples(): 以namedtuples的形式迭代行，是一个命名元组迭代器，其中的值是行的数据。</p> 
<p><strong>iterrows()迭代函数应用</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># iterrows()迭代函数应用</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> row_index<span class="token punctuation">,</span> row <span class="token keyword">in</span> df<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'row_index='</span><span class="token punctuation">,</span>row_index<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
row_index<span class="token operator">=</span> <span class="token number">0</span>
a    <span class="token number">2</span>
c    <span class="token number">5</span>
b    <span class="token number">3</span>
d    <span class="token number">7</span>
Name<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int32
row_index<span class="token operator">=</span> <span class="token number">4</span>
a    <span class="token number">16</span>
c    <span class="token number">14</span>
b     <span class="token number">2</span>
d    <span class="token number">16</span>
Name<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int32
row_index<span class="token operator">=</span> <span class="token number">2</span>
a    <span class="token number">29</span>
c    <span class="token number">27</span>
b     <span class="token number">2</span>
d    <span class="token number">25</span>
Name<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int32
</code></pre> 
<p><strong>itertuples()函数应用</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># itertuples()函数应用</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> df<span class="token punctuation">.</span>itertuples<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
Pandas<span class="token punctuation">(</span>Index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> a<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> b<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> d<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>
Pandas<span class="token punctuation">(</span>Index<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> a<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">,</span> b<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> d<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
Pandas<span class="token punctuation">(</span>Index<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> a<span class="token operator">=</span><span class="token number">29</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">,</span> b<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> d<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_661"></a>唯一值与值计数</h3> 
<p>唯一值函数unique()的作用是去重，只留下不重复的元素；<br> 值计数函数value_counts()的作用是计算去重之后的每一个元素的个数。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'everyone should learn pandas'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'s.unique='</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'计数：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'--------------'</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'--------------'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 行</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
s<span class="token punctuation">.</span>unique<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'e'</span> <span class="token string">'v'</span> <span class="token string">'r'</span> <span class="token string">'y'</span> <span class="token string">'o'</span> <span class="token string">'n'</span> <span class="token string">' '</span> <span class="token string">'s'</span> <span class="token string">'h'</span> <span class="token string">'u'</span> <span class="token string">'l'</span> <span class="token string">'d'</span> <span class="token string">'a'</span> <span class="token string">'p'</span><span class="token punctuation">]</span>
计数：
e    <span class="token number">4</span>
n    <span class="token number">3</span>
     <span class="token number">3</span>
a    <span class="token number">3</span>
o    <span class="token number">2</span>
l    <span class="token number">2</span>
r    <span class="token number">2</span>
d    <span class="token number">2</span>
s    <span class="token number">2</span>
u    <span class="token number">1</span>
h    <span class="token number">1</span>
p    <span class="token number">1</span>
y    <span class="token number">1</span>
v    <span class="token number">1</span>
dtype<span class="token punctuation">:</span> int64
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span><span class="token punctuation">]</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token number">2</span>    <span class="token number">2</span>
Name<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int64
</code></pre> 
<h2><a id="_703"></a>描述性统计</h2> 
<blockquote> 
 <p>注意：<br> ① abs()、prod()、cumprod()函数无法执行包含字符或字符串的数据，否则会出现异常 ；<br> ② 函数通常采用轴参数进行统计，轴参数可以通过名称或整数来指定，当axis=0(默认)时按行(index)来统计，当axis=1时按列(column)来统计；<br> ③ describe()函数的参数include，指定显示摘要的哪些信息，其值包括3个，object（汇总字符串列）、number（汇总数字列）、all（将所有列汇总在一起），include的默认值为number。</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
d <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'count='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 非空观测数量</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'mean='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 所有值的平均值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'sum='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 所有值之和</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'median='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 取中位数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'mode='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 值的模值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'std='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 值的标准偏差</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'min='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 最小值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'max='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 最大值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'abs='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 绝对值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'prod='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>prod<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 数组元素的乘积</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cumsum='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 累计总和</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cumprod='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>cumprod<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 累计乘积</span>

</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
   a  b   c
<span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">5</span>   <span class="token number">9</span>
<span class="token number">1</span>  <span class="token number">2</span>  <span class="token number">6</span>  <span class="token number">10</span>
<span class="token number">2</span>  <span class="token number">3</span>  <span class="token number">7</span>  <span class="token number">11</span>
<span class="token number">3</span>  <span class="token number">4</span>  <span class="token number">8</span>  <span class="token number">12</span>
count<span class="token operator">=</span> a    <span class="token number">4</span>
b    <span class="token number">4</span>
c    <span class="token number">4</span>
dtype<span class="token punctuation">:</span> int64
mean<span class="token operator">=</span> a     <span class="token number">2.5</span>
b     <span class="token number">6.5</span>
c    <span class="token number">10.5</span>
dtype<span class="token punctuation">:</span> float64
<span class="token builtin">sum</span><span class="token operator">=</span> a    <span class="token number">10</span>
b    <span class="token number">26</span>
c    <span class="token number">42</span>
dtype<span class="token punctuation">:</span> int64
median<span class="token operator">=</span> a     <span class="token number">2.5</span>
b     <span class="token number">6.5</span>
c    <span class="token number">10.5</span>
dtype<span class="token punctuation">:</span> float64
mode<span class="token operator">=</span>    a  b   c
<span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">5</span>   <span class="token number">9</span>
<span class="token number">1</span>  <span class="token number">2</span>  <span class="token number">6</span>  <span class="token number">10</span>
<span class="token number">2</span>  <span class="token number">3</span>  <span class="token number">7</span>  <span class="token number">11</span>
<span class="token number">3</span>  <span class="token number">4</span>  <span class="token number">8</span>  <span class="token number">12</span>
std<span class="token operator">=</span> a    <span class="token number">1.290994</span>
b    <span class="token number">1.290994</span>
c    <span class="token number">1.290994</span>
dtype<span class="token punctuation">:</span> float64
<span class="token builtin">min</span><span class="token operator">=</span> a    <span class="token number">1</span>
b    <span class="token number">5</span>
c    <span class="token number">9</span>
dtype<span class="token punctuation">:</span> int64
<span class="token builtin">max</span><span class="token operator">=</span> a     <span class="token number">4</span>
b     <span class="token number">8</span>
c    <span class="token number">12</span>
dtype<span class="token punctuation">:</span> int64
<span class="token builtin">abs</span><span class="token operator">=</span>    a  b   c
<span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">5</span>   <span class="token number">9</span>
<span class="token number">1</span>  <span class="token number">2</span>  <span class="token number">6</span>  <span class="token number">10</span>
<span class="token number">2</span>  <span class="token number">3</span>  <span class="token number">7</span>  <span class="token number">11</span>
<span class="token number">3</span>  <span class="token number">4</span>  <span class="token number">8</span>  <span class="token number">12</span>
prod<span class="token operator">=</span> a       <span class="token number">24</span>
b     <span class="token number">1680</span>
c    <span class="token number">11880</span>
dtype<span class="token punctuation">:</span> int64
cumsum<span class="token operator">=</span>     a   b   c
<span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">5</span>   <span class="token number">9</span>
<span class="token number">1</span>   <span class="token number">3</span>  <span class="token number">11</span>  <span class="token number">19</span>
<span class="token number">2</span>   <span class="token number">6</span>  <span class="token number">18</span>  <span class="token number">30</span>
<span class="token number">3</span>  <span class="token number">10</span>  <span class="token number">26</span>  <span class="token number">42</span>
cumprod<span class="token operator">=</span>     a     b      c
<span class="token number">0</span>   <span class="token number">1</span>     <span class="token number">5</span>      <span class="token number">9</span>
<span class="token number">1</span>   <span class="token number">2</span>    <span class="token number">30</span>     <span class="token number">90</span>
<span class="token number">2</span>   <span class="token number">6</span>   <span class="token number">210</span>    <span class="token number">990</span>
<span class="token number">3</span>  <span class="token number">24</span>  <span class="token number">1680</span>  <span class="token number">11880</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
d <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'mean(axis=1)='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'sum(axis=1)='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cumsum(axis=1)='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cumprod(axis=1)='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>cumprod<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'describe='</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
   a  b   c
<span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">5</span>   <span class="token number">9</span>
<span class="token number">1</span>  <span class="token number">2</span>  <span class="token number">6</span>  <span class="token number">10</span>
<span class="token number">2</span>  <span class="token number">3</span>  <span class="token number">7</span>  <span class="token number">11</span>
<span class="token number">3</span>  <span class="token number">4</span>  <span class="token number">8</span>  <span class="token number">12</span>
mean<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">0</span>    <span class="token number">5.0</span>
<span class="token number">1</span>    <span class="token number">6.0</span>
<span class="token number">2</span>    <span class="token number">7.0</span>
<span class="token number">3</span>    <span class="token number">8.0</span>
dtype<span class="token punctuation">:</span> float64
<span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">0</span>    <span class="token number">15</span>
<span class="token number">1</span>    <span class="token number">18</span>
<span class="token number">2</span>    <span class="token number">21</span>
<span class="token number">3</span>    <span class="token number">24</span>
dtype<span class="token punctuation">:</span> int64
cumsum<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>    a   b   c
<span class="token number">0</span>  <span class="token number">1</span>   <span class="token number">6</span>  <span class="token number">15</span>
<span class="token number">1</span>  <span class="token number">2</span>   <span class="token number">8</span>  <span class="token number">18</span>
<span class="token number">2</span>  <span class="token number">3</span>  <span class="token number">10</span>  <span class="token number">21</span>
<span class="token number">3</span>  <span class="token number">4</span>  <span class="token number">12</span>  <span class="token number">24</span>
cumprod<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>    a   b    c
<span class="token number">0</span>  <span class="token number">1</span>   <span class="token number">5</span>   <span class="token number">45</span>
<span class="token number">1</span>  <span class="token number">2</span>  <span class="token number">12</span>  <span class="token number">120</span>
<span class="token number">2</span>  <span class="token number">3</span>  <span class="token number">21</span>  <span class="token number">231</span>
<span class="token number">3</span>  <span class="token number">4</span>  <span class="token number">32</span>  <span class="token number">384</span>
describe<span class="token operator">=</span>               a         b          c
count  <span class="token number">4.000000</span>  <span class="token number">4.000000</span>   <span class="token number">4.000000</span>
mean   <span class="token number">2.500000</span>  <span class="token number">6.500000</span>  <span class="token number">10.500000</span>
std    <span class="token number">1.290994</span>  <span class="token number">1.290994</span>   <span class="token number">1.290994</span>
<span class="token builtin">min</span>    <span class="token number">1.000000</span>  <span class="token number">5.000000</span>   <span class="token number">9.000000</span>
<span class="token number">25</span><span class="token operator">%</span>    <span class="token number">1.750000</span>  <span class="token number">5.750000</span>   <span class="token number">9.750000</span>
<span class="token number">50</span><span class="token operator">%</span>    <span class="token number">2.500000</span>  <span class="token number">6.500000</span>  <span class="token number">10.500000</span>
<span class="token number">75</span><span class="token operator">%</span>    <span class="token number">3.250000</span>  <span class="token number">7.250000</span>  <span class="token number">11.250000</span>
<span class="token builtin">max</span>    <span class="token number">4.000000</span>  <span class="token number">8.000000</span>  <span class="token number">12.000000</span>
</code></pre> 
<h2><a id="_849"></a>缺失值</h2> 
<h3><a id="_850"></a>检测缺失值</h3> 
<p>isnull()函数可以检查数据中的缺失值，返回一个布尔值的矩阵；<br> notnull()函数与isnull()函数意思相反，返回的布尔值为True时表示非缺失值。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token string">'d'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'原数据：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
原数据：
     a    b     c   d
<span class="token number">0</span>  <span class="token number">1.0</span>  <span class="token number">5.0</span>   <span class="token number">9.0</span>  <span class="token number">13</span>
<span class="token number">1</span>  <span class="token number">2.0</span>  NaN  <span class="token number">10.0</span>  <span class="token number">14</span>
<span class="token number">2</span>  NaN  <span class="token number">7.0</span>  <span class="token number">11.0</span>  <span class="token number">15</span>
<span class="token number">3</span>  <span class="token number">4.0</span>  <span class="token number">8.0</span>   NaN  <span class="token number">16</span>
       a      b      c      d
<span class="token number">0</span>  <span class="token boolean">False</span>  <span class="token boolean">False</span>  <span class="token boolean">False</span>  <span class="token boolean">False</span>
<span class="token number">1</span>  <span class="token boolean">False</span>   <span class="token boolean">True</span>  <span class="token boolean">False</span>  <span class="token boolean">False</span>
<span class="token number">2</span>   <span class="token boolean">True</span>  <span class="token boolean">False</span>  <span class="token boolean">False</span>  <span class="token boolean">False</span>
<span class="token number">3</span>  <span class="token boolean">False</span>  <span class="token boolean">False</span>   <span class="token boolean">True</span>  <span class="token boolean">False</span>
       a      b      c     d
<span class="token number">0</span>   <span class="token boolean">True</span>   <span class="token boolean">True</span>   <span class="token boolean">True</span>  <span class="token boolean">True</span>
<span class="token number">1</span>   <span class="token boolean">True</span>  <span class="token boolean">False</span>   <span class="token boolean">True</span>  <span class="token boolean">True</span>
<span class="token number">2</span>  <span class="token boolean">False</span>   <span class="token boolean">True</span>   <span class="token boolean">True</span>  <span class="token boolean">True</span>
<span class="token number">3</span>   <span class="token boolean">True</span>   <span class="token boolean">True</span>  <span class="token boolean">False</span>  <span class="token boolean">True</span>
</code></pre> 
<h3><a id="_886"></a>处理缺失值</h3> 
<p>缺失值的处理主要有4种方法：<br> 删除法——dropna()<br> 固定值替换法——replace()<br> 填充法——fillna()<br> 插值法——拉格朗日插值法(lagrange)和牛顿插值法</p> 
<p><strong>删除法</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 删除法</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token string">'d'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'原数据：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'删除包含NaN值的行：'</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------------------'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'删除包含NaN值的列：'</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------------------'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'删除都是NaN值的行：'</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>how<span class="token operator">=</span><span class="token string">'all'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------------------'</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>nan
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'第0行都是NaN值，删除：'</span><span class="token punctuation">,</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>how<span class="token operator">=</span><span class="token string">'all'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
原数据：
     a    b     c   d
<span class="token number">0</span>  <span class="token number">1.0</span>  <span class="token number">5.0</span>   <span class="token number">9.0</span>  <span class="token number">13</span>
<span class="token number">1</span>  <span class="token number">2.0</span>  NaN  <span class="token number">10.0</span>  <span class="token number">14</span>
<span class="token number">2</span>  NaN  <span class="token number">7.0</span>  <span class="token number">11.0</span>  <span class="token number">15</span>
<span class="token number">3</span>  <span class="token number">4.0</span>  <span class="token number">8.0</span>   NaN  <span class="token number">16</span>
删除包含NaN值的行：      a    b    c   d
<span class="token number">0</span>  <span class="token number">1.0</span>  <span class="token number">5.0</span>  <span class="token number">9.0</span>  <span class="token number">13</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
     a    b     c   d
<span class="token number">0</span>  <span class="token number">1.0</span>  <span class="token number">5.0</span>   <span class="token number">9.0</span>  <span class="token number">13</span>
<span class="token number">1</span>  <span class="token number">2.0</span>  NaN  <span class="token number">10.0</span>  <span class="token number">14</span>
<span class="token number">2</span>  NaN  <span class="token number">7.0</span>  <span class="token number">11.0</span>  <span class="token number">15</span>
<span class="token number">3</span>  <span class="token number">4.0</span>  <span class="token number">8.0</span>   NaN  <span class="token number">16</span>
删除包含NaN值的列：     d
<span class="token number">0</span>  <span class="token number">13</span>
<span class="token number">1</span>  <span class="token number">14</span>
<span class="token number">2</span>  <span class="token number">15</span>
<span class="token number">3</span>  <span class="token number">16</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
删除都是NaN值的行：      a    b     c   d
<span class="token number">0</span>  <span class="token number">1.0</span>  <span class="token number">5.0</span>   <span class="token number">9.0</span>  <span class="token number">13</span>
<span class="token number">1</span>  <span class="token number">2.0</span>  NaN  <span class="token number">10.0</span>  <span class="token number">14</span>
<span class="token number">2</span>  NaN  <span class="token number">7.0</span>  <span class="token number">11.0</span>  <span class="token number">15</span>
<span class="token number">3</span>  <span class="token number">4.0</span>  <span class="token number">8.0</span>   NaN  <span class="token number">16</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
第<span class="token number">0</span>行都是NaN值，删除：      a    b     c     d
<span class="token number">1</span>  <span class="token number">2.0</span>  NaN  <span class="token number">10.0</span>  <span class="token number">14.0</span>
<span class="token number">2</span>  NaN  <span class="token number">7.0</span>  <span class="token number">11.0</span>  <span class="token number">15.0</span>
<span class="token number">3</span>  <span class="token number">4.0</span>  <span class="token number">8.0</span>   NaN  <span class="token number">16.0</span>
</code></pre> 
<p><strong>固定值替换法</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 固定值替换法</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token string">'d'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'原数据：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'替换后数据：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
原数据：
     a    b     c   d
<span class="token number">0</span>  <span class="token number">1.0</span>  <span class="token number">5.0</span>   <span class="token number">9.0</span>  <span class="token number">13</span>
<span class="token number">1</span>  <span class="token number">2.0</span>  NaN  <span class="token number">10.0</span>  <span class="token number">14</span>
<span class="token number">2</span>  NaN  <span class="token number">7.0</span>  <span class="token number">11.0</span>  <span class="token number">15</span>
<span class="token number">3</span>  <span class="token number">4.0</span>  <span class="token number">8.0</span>   NaN  <span class="token number">16</span>

替换后数据：
     a    b     c   d
<span class="token number">0</span>  <span class="token number">1.0</span>  <span class="token number">5.0</span>   <span class="token number">9.0</span>  <span class="token number">13</span>
<span class="token number">1</span>  <span class="token number">2.0</span>  <span class="token number">0.0</span>  <span class="token number">10.0</span>  <span class="token number">14</span>
<span class="token number">2</span>  <span class="token number">0.0</span>  <span class="token number">7.0</span>  <span class="token number">11.0</span>  <span class="token number">15</span>
<span class="token number">3</span>  <span class="token number">4.0</span>  <span class="token number">8.0</span>   <span class="token number">0.0</span>  <span class="token number">16</span>

</code></pre> 
<p><strong>填充法</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 填充法</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token string">'c'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token string">'d'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'原数据：'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'#########################'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#固定值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#平均值（列）</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'bfill'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 最近邻，向下</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
原数据：
     a    b     c   d
<span class="token number">0</span>  <span class="token number">1.0</span>  <span class="token number">5.0</span>   <span class="token number">9.0</span>  <span class="token number">13</span>
<span class="token number">1</span>  <span class="token number">2.0</span>  NaN  <span class="token number">10.0</span>  <span class="token number">14</span>
<span class="token number">2</span>  NaN  <span class="token number">7.0</span>  <span class="token number">11.0</span>  <span class="token number">15</span>
<span class="token number">3</span>  <span class="token number">4.0</span>  <span class="token number">8.0</span>   NaN  <span class="token number">16</span>
<span class="token comment">#########################</span>
     a    b     c   d
<span class="token number">0</span>  <span class="token number">1.0</span>  <span class="token number">5.0</span>   <span class="token number">9.0</span>  <span class="token number">13</span>
<span class="token number">1</span>  <span class="token number">2.0</span>  <span class="token number">0.0</span>  <span class="token number">10.0</span>  <span class="token number">14</span>
<span class="token number">2</span>  <span class="token number">0.0</span>  <span class="token number">7.0</span>  <span class="token number">11.0</span>  <span class="token number">15</span>
<span class="token number">3</span>  <span class="token number">4.0</span>  <span class="token number">8.0</span>   <span class="token number">0.0</span>  <span class="token number">16</span>
          a         b     c   d
<span class="token number">0</span>  <span class="token number">1.000000</span>  <span class="token number">5.000000</span>   <span class="token number">9.0</span>  <span class="token number">13</span>
<span class="token number">1</span>  <span class="token number">2.000000</span>  <span class="token number">6.666667</span>  <span class="token number">10.0</span>  <span class="token number">14</span>
<span class="token number">2</span>  <span class="token number">2.333333</span>  <span class="token number">7.000000</span>  <span class="token number">11.0</span>  <span class="token number">15</span>
<span class="token number">3</span>  <span class="token number">4.000000</span>  <span class="token number">8.000000</span>  <span class="token number">10.0</span>  <span class="token number">16</span>
     a    b     c   d
<span class="token number">0</span>  <span class="token number">1.0</span>  <span class="token number">5.0</span>   <span class="token number">9.0</span>  <span class="token number">13</span>
<span class="token number">1</span>  <span class="token number">2.0</span>  <span class="token number">7.0</span>  <span class="token number">10.0</span>  <span class="token number">14</span>
<span class="token number">2</span>  <span class="token number">4.0</span>  <span class="token number">7.0</span>  <span class="token number">11.0</span>  <span class="token number">15</span>
<span class="token number">3</span>  <span class="token number">4.0</span>  <span class="token number">8.0</span>   NaN  <span class="token number">16</span>
</code></pre> 
<p><strong>插值法</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 插值法 interpolate lagrange interpld </span>
<span class="token keyword">import</span> scipy<span class="token punctuation">.</span>interpolate <span class="token keyword">as</span> interpolate
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span>
b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
linear <span class="token operator">=</span> interpolate<span class="token punctuation">.</span>interpld<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> kind<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>linear<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'-.'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'线性插值法求出的ss[7:9]='</span><span class="token punctuation">,</span> linear<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
lagrange <span class="token operator">=</span> interpolate<span class="token punctuation">.</span>lagrange<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>lagrange<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'--'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'拉格朗日插值法求出的ss[2]='</span><span class="token punctuation">,</span> lagrange<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">## 输出 ##</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">]</span>

AttributeError<span class="token punctuation">:</span> module <span class="token string">'scipy.interpolate'</span> has no attribute <span class="token string">'interpld'</span>
<span class="token comment">### 这里有报错，可能是因为包更新的缘故，但使用方法大差不差</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/616c0ed25cb6cb13b1ce416adf37a6e4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">设计模式--04--结构型--04--外观模式及与代理的区别</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ec09bae8c1b826558b4ff1333bea4a3c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Excel函数公式大全—IF家族函数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>