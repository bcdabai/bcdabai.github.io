<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【重点推荐】iOS开发之芝麻信用SDK的超详细使用教程 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【重点推荐】iOS开发之芝麻信用SDK的超详细使用教程" />
<meta property="og:description" content="其实每一个第三方SDK的使用都差不多，看着官方给的开发文档和Demo就能依样画瓢自己做出来。我只是希望帮助一下刚入行不久的新人。
先附上官方文档的地址：芝麻信用iOS开发文档
一、先做一些必备的工作
由于需要导入的Framework比较多，先创建一个Frameworks分组（分组和文件夹可不一样哦）
1. 将资源bundle导入工程
H5Service.bundle
Poseidon.bundle
直接把下载到的这两个文件拖进Frameworks分组中
2. 向工程中导入SDK Framework文件
ZMCreditSDK.framework
ZMDependUponSDK.framework
注意1：如果商户引入支付宝钱包SDK,则不需要再引入ZMBuildUponSDK.framework, 因为这样可以解决相同类库冲突的问题
注意：这两个文件导入之前一定要把他复制到你的项目中去，一般就放项目根目录下就行，跟xcodeproj文件在同一目录下
这里需要选择Add Others，然后会弹出文件选择框，把刚刚复制到项目根目录下的这两个framework选进来就行了
（第三步中的其他依赖库，都是系统的，直接search就行了，第三步就不贴图了）
3. 导入其他依赖库
SDK中依赖了其他基础库来保证正常运行，请添加如下依赖库:
MobileCoreServices.framewrok
CFNetwork.framework
MessageUI.framework
EventKit.framework
AssetsLibrary.framework
CoreMotion.framework
Libz.dylib （Xcode 7 之后是libz.tbd）
SystemConfiguration.framework
CoreTelephony.framework 二、开始使用芝麻信用SDK
自己先把流程走一遍，一切都会变的很容易。（流程见下图）
首先，在AppDelegate里面来注册应用：
[[ALCreditService sharedService] resgisterApp]; 当然，在AppDelegate中和请求芝麻信用分数的Controller中肯定也都需要引入头文件 #import &lt;ZMCreditSDK/ALCreditService.h&gt; 接下来就是正式使用芝麻信用SDK了
①我们把用户的信息（姓名、手机号、身份证号码）通过APP传给公司的服务器（这一步其实基本不属于芝麻信用的使用范畴，现在哪个APP获取不到用户的个人信息？！我们这里其实只传了姓名和身份证号码，其实有了身份证号码，芝麻信用自然就能锁定到那个唯一的人）只要能够获取到姓名和身份证号码，服务器那边就能传给我们一个经过加密的param和一个经过加密的sign
注意2：界面跳转是基于navigationController的push功能，并且使用的是系统的nav bar，如果商户端有对nav bar作自定义，请在调用SDK之前，进行nav bar的调整。
- (void)buttonAction:(UIButton *)button { // ①把用户数据传给服务器，即传入参数（字典） //（如果后台从别的页面已经获取到用户的这些数据了，此处也可以不传参数，这就看你跟后台怎么商量了；IDCardNumber和userName是后台给你的，不是固定死的） NSDictionary *dict = [NSDictionary dictionaryWithObjectsAndKeys:@&#34;18位身份证号码&#34;, @&#34;IDCardNumber&#34;, @&#34;用户姓名&#34;, @&#34;userName&#34;, nil]; // 创建网络请求管理对象 AFHTTPSessionManager *manager = [AFHTTPSessionManager manager]; // 申明返回的结果是json类型 manager." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/16792a40e09abe3828b14fc34bddb1cf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-04-26T23:49:28+08:00" />
<meta property="article:modified_time" content="2016-04-26T23:49:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【重点推荐】iOS开发之芝麻信用SDK的超详细使用教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="font-size:14px">其实每一个第三方SDK的使用都差不多，看着官方给的开发文档和Demo就能依样画瓢自己做出来。我只是希望帮助一下刚入行不久的新人。</span></p> 
<p><span style="font-size:14px">先附上官方文档的地址：<a target="_blank" href="https://zmmcportal.zmxy.com.cn/technology/openDoc.htm?id=88" rel="nofollow noopener noreferrer">芝麻信用iOS开发文档</a></span></p> 
<p><span style="font-size:24px; background-color:rgb(255,102,102)">一、先做一些必备的工作</span></p> 
<p><span style="font-size:18px">由于需要导入的Framework比较多，先创建一个Frameworks分组（分组和文件夹可不一样哦）</span></p> 
<p><img src="https://images2.imgbox.com/fa/52/c3l6u7nc_o.jpg" alt=""><br> </p> 
<p><span style="font-size:18px">1. 将资源bundle导入工程<br>      H5Service.bundle<br>      Poseidon.bundle</span><br> </p> 
<p><strong><span style="font-size:18px; color:#cc6600">直接把下载到的这两个文件拖进Frameworks分组中</span></strong></p> 
<p><img src="https://images2.imgbox.com/4c/d0/JqkCxE6d_o.jpg" alt=""><br> </p> 
<p><span style="font-size:18px">2. 向工程中导入SDK Framework文件<br>      ZMCreditSDK.framework<br>      ZMDependUponSDK.framework</span><br> <span style="font-size:24px; color:#ff0000">注意1：如果商户引入支付宝钱包SDK,则不需要再引入ZMBuildUponSDK.framework, 因为这样可以解决相同类库冲突的问题</span></p> 
<p><span style="font-size:18px; color:#996633"><strong>注意：这两个文件导入之前一定要把他复制到你的项目中去，一般就放项目根目录下就行，跟xcodeproj文件在同一目录下</strong></span></p> 
<p><img src="https://images2.imgbox.com/19/0b/DQOYjO8D_o.jpg" alt=""><br> <span style="font-size:18px">这里需要选择Add Others，然后会弹出文件选择框，把刚刚复制到项目根目录下的这两个framework选进来就行了</span></p> 
<p><span style="font-size:18px">（第三步中的其他依赖库，都是系统的，直接search就行了，第三步就不贴图了）</span><br> <img src="https://images2.imgbox.com/d3/31/zQ9ePXsw_o.jpg" alt=""><br>  <br> <span style="font-size:18px">3. 导入其他依赖库<br>     SDK中依赖了其他基础库来保证正常运行，请添加如下依赖库:<br>     MobileCoreServices.framewrok<br>     CFNetwork.framework<br>     MessageUI.framework<br>     EventKit.framework<br>     AssetsLibrary.framework<br>     CoreMotion.framework<br>     Libz.dylib （Xcode 7 之后是libz.tbd）<br>     SystemConfiguration.framework<br>     CoreTelephony.framework </span><br> </p> 
<p><span style="font-size:24px; background-color:rgb(255,102,102)">二、开始使用芝麻信用SDK</span></p> 
<p><span style="font-size:14px">自己先把流程走一遍，一切都会变的很容易。（流程见下图）</span><img src="https://images2.imgbox.com/e0/c5/j0slw8mf_o.png" alt=""></p> 
<p><span style="font-size:14px">首先，在AppDelegate里面来注册应用：</span><br> </p> 
<p></p> 
<pre><code class="language-objc">[[ALCreditService sharedService] resgisterApp];</code></pre> 
<br> 
<span style="font-size:14px">当然，在AppDelegate中和请求芝麻信用分数的Controller中肯定也都需要引入头文件</span> 
<p></p> 
<p></p> 
<pre><code class="language-objc">#import &lt;ZMCreditSDK/ALCreditService.h&gt;</code></pre> 
<p></p> 
<p><span style="color:rgb(255,0,0)"><strong>接下来就是正式使用芝麻信用SDK了</strong></span></p> 
<p><span style="font-size:14px">①我们把用户的信息（姓名、手机号、身份证号码）通过APP传给公司的服务器（这一步其实基本不属于芝麻信用的使用范畴，现在哪个APP获取不到用户的个人信息？！我们这里其实只传了姓名和身份证号码，其实有了身份证号码，芝麻信用自然就能锁定到那个唯一的人）只要能够获取到姓名和身份证号码，服务器那边就能传给我们一个经过加密的param和一个经过加密的sign</span></p> 
<p><span style="font-size:18px; color:#ff0000">注意2：界面跳转是基于navigationController的push功能，并且使用的是系统的nav bar，如果商户端有对nav bar作自定义，请在调用SDK之前，进行nav bar的调整。</span><br> </p> 
<p></p> 
<pre><code class="language-objc">- (void)buttonAction:(UIButton *)button {
    // ①把用户数据传给服务器，即传入参数（字典）
    //（如果后台从别的页面已经获取到用户的这些数据了，此处也可以不传参数，这就看你跟后台怎么商量了；IDCardNumber和userName是后台给你的，不是固定死的）
    NSDictionary *dict = [NSDictionary dictionaryWithObjectsAndKeys:@"18位身份证号码", @"IDCardNumber", @"用户姓名", @"userName", nil];
    // 创建网络请求管理对象
    AFHTTPSessionManager *manager = [AFHTTPSessionManager manager];
    // 申明返回的结果是json类型
    manager.responseSerializer = [AFJSONResponseSerializer serializer];
    // 申明请求的数据是json类型
    manager.requestSerializer = [AFJSONRequestSerializer serializer];
    // 如果报接受类型不一致请替换一致text/html或别的
    manager.responseSerializer.acceptableContentTypes = [NSSet setWithObjects:@"text/html", nil];
    
    [manager POST:URL parameters:dict constructingBodyWithBlock:^(id&lt;AFMultipartFormData&gt;  _Nonnull formData) {
        
    } progress:^(NSProgress * _Nonnull uploadProgress) {
        
    } success:^(NSURLSessionDataTask * _Nonnull task, id  _Nullable responseObject) {
        
        // ②芝麻信用SDK提供的方法，就是这么简单，就一行代码，搞定。（APP ID由公司给你，这个是固定的，写死就行）
        // ②这里只要传三个参数就行，app id、sign、params，芝麻信用会返回给我们一个字典，在result中
        [[ALCreditService sharedService] queryUserAuthReq:@"APP ID" sign:responseObject[@"sign"] params:responseObject[@"param"] extParams:nil selector:@selector(result:) target:self];
        
    } failure:^(NSURLSessionDataTask * _Nullable task, NSError * _Nonnull error) {
        
    }];
}</code></pre> 
<br> 
<span style="font-size:14px">②根据SDK给的方法，把第二步获取到的这两个参数和APP ID传进去，这些就被传到芝麻信用的服务器，然后会返回给我们授权token，字段名也是sign和params</span> 
<p></p> 
<p></p> 
<pre><code class="language-objc">// ②芝麻信用SDK提供的方法，就是这么简单，就一行代码，搞定。（APP ID由公司给你，这个是固定的，写死就行）
// ②这里只要传三个参数就行，app id、sign、params，芝麻信用会返回给我们一个字典，在result中
[[ALCreditService sharedService] queryUserAuthReq:@"APP ID" sign:responseObject[@"sign"] params:responseObject[@"param"] extParams:nil selector:@selector(result:) target:self];</code></pre> 
<span style="font-size:14px">这一步的代码不用复制，就在第一步的AFN网络请求成功后写这一行代码（上面第一步中有）<br> </span> 
<p></p> 
<p><span style="font-size:14px">③我们再把params提交给公司的服务器，然后服务器就能通过这个token获取到用户的芝麻信用分数，最后把分数返回给我们就好了。（我们这里只传了params就能请求的到芝麻信用分数）</span></p> 
<p></p> 
<pre><code class="language-objc">- (void)result:(NSMutableDictionary*)dic{
    // ③从第二步中芝麻信用返回给我们的字典就是这的dic，你可以试着打印看一下
    // ③把params提交给服务器，服务器就能把芝麻信用分数返回给我们了，这里dict的key：params也是后台给你的，不是固定的。
    NSDictionary *dict = [NSDictionary dictionaryWithObjectsAndKeys:dic[@"params"], @"params", nil];
    // 创建网络请求管理对象
    AFHTTPSessionManager *manager = [AFHTTPSessionManager manager];
    // 申明返回的结果是json类型
    manager.responseSerializer = [AFJSONResponseSerializer serializer];
    // 申明请求的数据是json类型
    manager.requestSerializer = [AFJSONRequestSerializer serializer];
    // 如果报接受类型不一致请替换一致text/html或别的
    manager.responseSerializer.acceptableContentTypes = [NSSet setWithObjects:@"text/html", nil];
    
    [manager POST:URL parameters:dict constructingBodyWithBlock:^(id&lt;AFMultipartFormData&gt;  _Nonnull formData) {
        
    } progress:^(NSProgress * _Nonnull uploadProgress) {
        
    } success:^(NSURLSessionDataTask * _Nonnull task, id  _Nullable responseObject) {
        
        // 看看这里是不是打印出了你想要的芝麻分数了呢
        NSLog(@"%@", responseObject);
        
    } failure:^(NSURLSessionDataTask * _Nullable task, NSError * _Nonnull error) {
        
    }];  
}</code></pre> 
<span style="font-size:18px; color:#ff0000">注意3：由于sdk里面有用到c编译,请把调用queryUserAuthReq的controller后缀名改成.mm</span> 
<br> 
<br> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/290fccd151ea2af78db691359c514968/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android5.0之NavigationView的使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9475442286b640be7801801676915aae/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android gitignore文件解析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>