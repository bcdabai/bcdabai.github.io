<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>阻止文件不被上传到iCloud - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="阻止文件不被上传到iCloud" />
<meta property="og:description" content="IOS--阻止文件被iTunes和iCloud同步，Do Not Backup属性 (2013-01-14 10:28:06) 转载▼ 标签： 杂谈 分类： iphone开发 http://www.cocoachina.com/bbs/read.php?tid=86244 http://www.ooso.net/archives/617 http://blog.csdn.net/theonezh/article/details/7711749 https://gist.github.com/4527957 如何阻止文件被iTunes和iCloud同步 How do I prevent files from being backed up to iCloud and iTunes? iOS 5有了iCloud后，Apple更新了数据存储指导方针，以适应于iCloud存储，同时增加了“不要备份”文件属性，可以指定文件不备份和上传到iCloud 摘录如下，供大家参考： iOS 数据存储指导方针 iCloud 包括了备份，会通过Wi-Fi每天自动备份用户iOS设备。app的home目录下的所有东西都会被备份，除了应用Bundle本身、缓存目录和temp 目录。已购买的音乐、应用、书籍、Camera Roll、设备设置、主屏幕、App组织、消息、铃声也都会被备份。由于备份通过无线进行，并且为每个用户存储在iCloud中，应用需最小化自己存储的 数据数量。大文件会延长备份时间，并且消耗用户的可用iCloud空间。 为了确保备份尽可能快速高效，应用存储数据需要遵循以下指导方针： 1. 只有那些用户生成的文档或其它数据，或者应用不能重新创建的数据，才应该存储在/Documents目录下，并且会被自动备份到iCloud。 2. 可以重新下载或生成的数据，应该存储在/Library/Caches目录。例如数据库缓存文件、可下载文件（杂志、报纸、地图应用使用的数据）等都属于这一类。 3. 临时使用的数据应该存放在/tmp目录。尽管这些文件不会被iCloud备份，应用在使用完之后需要记得删除这些文件，这样才不会继续占用用户设备的空间。 4. 使用&#34;不要备份&#34;属性来指定那些需要保留在设备中的文件（即使是低存储空间情况下）。那些能够重新生成，但在低存储空间时仍需保留，对应用正常运行有影 响，或者用户希望文件在离线时可用的文件，需要使用这个属性。无论哪个目录下的文件（包括Documents目录），都可以使用这个属性。这些文件不会被 删除，也不会包含在用户的iCloud或iTunes备份中。由于这些文件一直占用着用户设备的存储空间，应用有责任定期监控和删除这些文件。 iOS 5.0.1开始支持&#34;do not back up&#34;文件属性，允许开发者明确地指定哪些文件应该被备份，哪些是本地缓存可以自动删除，哪些文件不需要备份但不能删除。此外，对目录设置这个属性，会阻止备份该目录和目录中的所有内容。 注 意&#34;do not back up&#34;属性只能用于iOS 5.0.1以后版本。之前版本的应用需要存储数据到/Library/Caches目录才能避免被备 份。由于老的系统忽略这个属性，你需要确保应用在所有iOS版本中，都遵循上面的iOS Data Storage Guidelines。 数据处理分类 com.apple.MobileBackup 文件属性就是iOS 5.0.1引入的&#34;do not back up&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/61243460ba22b06b976f667a3b9468b8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-08-05T16:30:36+08:00" />
<meta property="article:modified_time" content="2014-08-05T16:30:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">阻止文件不被上传到iCloud</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="articalTitle" style="clear:both; line-height:20px; padding-bottom:10px; color:rgb(70,70,70); font-family:Verdana,宋体,sans-serif; background-color:rgb(234,247,253)"> 
 <h3 id="t_77e356ee0101avne" class="titName SG_txta" style="margin:0px; padding:0px; border:0px; list-style:none; color:rgb(65,104,77); font-size:18px; font-family:微软雅黑,黑体; font-weight:300; display:inline"> IOS--阻止文件被iTunes和iCloud同步，Do Not Backup属性</h3>   
 <span class="img2" style="white-space:nowrap; padding-top:4px"><img width="15" height="15" align="absmiddle" title="此博文包含图片" src="https://images2.imgbox.com/92/d4/WO6kYoTH_o.gif" class="SG_icon SG_icon18" alt="" style="margin:0px 0px 0px 5px; padding:0px; border:0px; list-style:none; vertical-align:text-bottom"> </span> 
 <span class="time SG_txtc" style="color:rgb(153,173,159); white-space:nowrap; font-family:Arial; font-size:10px; margin-left:5px; margin-right:13px">(2013-01-14 10:28:06)</span> 
 <div class="turnBoxzz" style="float:right"> 
  <a target="_blank" class="SG_aBtn SG_aBtn_ico SG_turn" style="color:rgb(65,104,77); padding:0px 0px 0px 3px; overflow:hidden; white-space:nowrap; display:inline-block; margin-right:6px; position:relative; letter-spacing:5px; width:86px; zoom:1"><cite style="font-style:normal; line-height:23px; padding:0px 20px 0px 32px; height:23px; min-width:1px; overflow-x:visible; width:34px; display:inline-block!important"><img class="SG_icon SG_icon111" src="https://images2.imgbox.com/a0/5a/J1v2NNLG_o.gif" width="15" height="15" align="absmiddle" alt="" style="margin:0px; padding:0px; border:0px; list-style:none; position:absolute; left:11px; top:4px">转载<span class="arrow" style="font-size:7px; position:absolute; right:5px; top:2px">▼</span></cite></a> 
 </div> 
</div> 
<div class="articalTag" id="sina_keyword_ad_area" style="width:690px; clear:both; word-break:break-all; line-height:20px; color:rgb(70,70,70); font-family:Verdana,宋体,sans-serif; background-color:rgb(234,247,253)"> 
 <table style="margin:0px; padding:0px"><tbody><tr><td class="blog_tag" style="margin:0px; padding:0px 10px 0px 0px; font-family:宋体; vertical-align:top"> <span class="SG_txtb" style="color:rgb(153,173,159)">标签：</span>  <h4 style="margin:0px 5px 0px 0px; padding:0px; border:0px; list-style:none; display:inline; font-size:12px; font-weight:normal"> <a target="_blank" href="http://search.sina.com.cn/?c=blog&amp;q=%D4%D3%CC%B8&amp;by=tag" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(65,104,77); white-space:nowrap">杂谈</a></h4> </td><td class="blog_class" style="margin:0px; padding:0px; font-family:宋体; vertical-align:top; width:220px; white-space:nowrap"> <span class="SG_txtb" style="color:rgb(153,173,159)">分类：</span> <a target="_blank" href="http://blog.sina.com.cn/s/articlelist_2011387630_1_1.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(65,104,77)">iphone开发</a></td></tr></tbody></table> 
</div> 
<div id="sina_keyword_ad_area2" class="articalContent   " style="width:690px; clear:both; padding-top:18px; font-size:14px; line-height:21px; padding-bottom:30px; word-wrap:normal; word-break:normal; overflow:hidden; font-family:simsun; color:rgb(70,70,70); background-color:rgb(234,247,253)"> 
 <a target="_blank" href="http://www.cocoachina.com/bbs/read.php?tid=86244" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(65,104,77)">http://www.cocoachina.com/bbs/read.php?tid=86244</a> 
 <br> 
 <br> 
 <a target="_blank" href="http://www.ooso.net/archives/617" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(65,104,77)">http://www.ooso.net/archives/617</a> 
 <br> 
 <br> 
 <a target="_blank" href="http://blog.csdn.net/theonezh/article/details/7711749" style="text-decoration:none; color:rgb(65,104,77)" rel="noopener noreferrer">http://blog.csdn.net/theonezh/article/details/7711749</a> 
 <br> 
 <br> 
 <a target="_blank" href="https://gist.github.com/4527957" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(65,104,77)">https://gist.github.com/4527957</a> 
 <br> 
 <h4 style="margin:0px; padding:0px; border:0px; list-style:none"><span style="word-wrap:normal; word-break:normal; line-height:24.569997787475586px"><a target="_blank" href="http://blog.csdn.net/i2c_rs485/article/details/7386444" style="text-decoration:none; color:rgb(65,104,77)" rel="noopener noreferrer">如何阻止文件被iTunes和iCloud同步 How do I prevent files from being backed up to iCloud and iTunes?</a></span></h4> 
 <br> 
 <br> iOS 5有了iCloud后，Apple更新了数据存储指导方针，以适应于iCloud存储，同时增加了“不要备份”文件属性，可以指定文件不备份和上传到iCloud 
 <br> 
 <br> 摘录如下，供大家参考： 
 <br> 
 <br> 
 <span style="font-size:24px; word-wrap:normal; word-break:normal; line-height:36px"><span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)"><strong>iOS 数据存储指导方针</strong></span></span></span></span> 
 <br> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">iCloud 包括了备份，会通过Wi-Fi每天自动备份用户iOS设备。app的home目录下的所有东西都会被备份，除了应用Bundle本身、缓存目录和temp 目录。已购买的音乐、应用、书籍、Camera Roll、设备设置、主屏幕、App组织、消息、铃声也都会被备份。由于备份通过无线进行，并且为每个用户存储在iCloud中，应用需最小化自己存储的 数据数量。大文件会延长备份时间，并且消耗用户的可用iCloud空间。</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">为了确保备份尽可能快速高效，应用存储数据需要遵循以下指导方针：</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">1. 只有那些用户生成的文档或其它数据，或者应用不能重新创建的数据，才应该存储在/Documents目录下，并且会被自动备份到iCloud。</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">2. 可以重新下载或生成的数据，应该存储在/Library/Caches目录。例如数据库缓存文件、可下载文件（杂志、报纸、地图应用使用的数据）等都属于这一类。</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">3. 临时使用的数据应该存放在/tmp目录。尽管这些文件不会被iCloud备份，应用在使用完之后需要记得删除这些文件，这样才不会继续占用用户设备的空间。</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">4. 使用"不要备份"属性来指定那些需要保留在设备中的文件（即使是低存储空间情况下）。那些能够重新生成，但在低存储空间时仍需保留，对应用正常运行有影 响，或者用户希望文件在离线时可用的文件，需要使用这个属性。无论哪个目录下的文件（包括Documents目录），都可以使用这个属性。这些文件不会被 删除，也不会包含在用户的iCloud或iTunes备份中。由于这些文件一直占用着用户设备的存储空间，应用有责任定期监控和删除这些文件。</span></span></span> 
 <br> 
 <hr> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">iOS 5.0.1开始支持"do not back up"文件属性，允许开发者明确地指定哪些文件应该被备份，哪些是本地缓存可以自动删除，哪些文件不需要备份但不能删除。此外，对目录设置这个属性，会阻止备份该目录和目录中的所有内容。</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">注 意"do not back up"属性只能用于iOS 5.0.1以后版本。之前版本的应用需要存储数据到/Library/Caches目录才能避免被备 份。由于老的系统忽略这个属性，你需要确保应用在所有iOS版本中，都遵循上面的iOS Data Storage Guidelines。</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:18px; word-wrap:normal; word-break:normal; line-height:27px"><span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)"><strong>数据处理分类</strong></span></span></span></span> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">com.apple.MobileBackup 文件属性就是iOS 5.0.1引入的"do not back up"特性，用于指定文件或目录不需要备份（不管在文件系统的什么位置）。通过使用这个新的文件属性，并且将文件存放在指定的目录下，文件可以分为以下四 种数据类型：s.</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)"><strong>关键数据</strong></span></span></span> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">这 些是用户创建的数据，或其它不能重新生成的数据。应该存放在/Documents目录下，并且不应该标 记为"do not backup"属性。关键数据在低存储空间时也会保留，而且会被iCloud或iTunes备份。</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)"><strong>缓存数据</strong></span></span></span> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">可 以重新下载或生成的数据，而且没有这些数据也不会妨碍用户离线使用应用的功能。缓存数据应该保存 在/Library/Caches目录下。缓存数据在设备低存储空间时可能会被删除，iTunes或 iCloud不会对其进行备份。</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)"><strong>临时数据</strong></span></span></span> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">应 用需要写到本地存储，内部使用的临时数据，但不需要长期保留使用。临时数据应该保存在/tmp目录。系 统可能会清空该目录下的数据，iTunes或iCloud也不会对其进行备份。应用在不需要使用这些数据时，应该尽快地删除临时数据，以避免浪费用户的存 储空间。</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)"><strong>离线数据</strong></span></span></span> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">可 以下载，或重新创建，但用户希望在离线时也能访问这些数据。离线数据应该存放在/Documents目 录或/Library/Private Documents目录，并标记为"do not backup"属性。这两个位置的数据在低存储空间时都会保留，而"do not backup"属性会阻止iTunes或iCloud备份。应用不再需要离线数据文件时，应该尽快删除，以避免浪费用户的存储空间。ce.</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:18px; word-wrap:normal; word-break:normal; line-height:27px"><span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)"><strong>设置Do Not Backup扩展属性</strong></span></span></span></span> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">注意："do not backup"扩展属性可以添加到任何文件或目录，在旧版本的系统中也能够设置。但旧系统仍然会备份这些文件，一旦设备更新到iOS 5.0.1，这些文件会被重新正确地配置。</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">使用下面方法来设置"do not back up"扩展属性。当你创建不需要备份的文件或目录时，向文件写入数据，然后调用下面方法，并传递一个文件URL。</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)"><strong>设置扩展属性</strong></span></span></span> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">#include</span></span></span> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">- (BOOL)addSkipBackupAttributeTo<wbr></wbr>ItemAtURL:(NSURL *)URL</span></span></span> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">{<!-- --></span></span></span> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)"> <wbr></wbr> <wbr></wbr></span></span></span>  
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">const char* filePath = [[URL path] fileSystemRepresentation<wbr></wbr>];</span></span></span> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)"> <wbr></wbr> <wbr></wbr> const char* attrName = "com.apple.MobileBackup";</span></span></span> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)"> <wbr></wbr> <wbr></wbr></span></span></span>  
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">u_int8_t attrValue = 1;</span></span></span> 
 <br> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)"> <wbr></wbr> <wbr></wbr></span></span></span>  
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">int result = setxattr(filePath, attrName, &amp;attrValue, sizeof(attrValue), 0, 0);</span></span></span> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)"> <wbr></wbr> <wbr></wbr></span></span></span>  
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">return result == 0;</span></span></span> 
 <br> 
 <span style="font-size:14px; word-wrap:normal; word-break:normal; line-height:24px"><span style="font-family:tahoma; word-wrap:normal; word-break:normal"><span style="word-wrap:normal; word-break:normal; color:rgb(0,0,0)">}<br> <br> <br> <br> </span></span></span>苹果在iOS 5系统时，对app的文件存储提出了新的要求。从 
 <a target="_blank" href="https://developer.apple.com/icloud/documentation/data-storage/" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(65,104,77)">它的guildline</a>来看，是推荐开发者尽量把app生成的文件放在Caches目录下的。原文如下: 
 <blockquote> 
  <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> Only user-generated data or that cannot otherwise be recreated by your application, should be stored in the /Documents directory and rest should be stored to /Library/Caches directory。</p> 
 </blockquote> 
 <h3 style="margin:0px; padding:0px; border:0px; list-style:none">照做会怎么样？</h3> 
 <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 如果这么做的话，会出现两种情况</p> 
 <ol style="margin:0px; padding:0px; border:0px; list-style:none"><li style="margin:0px 0px 0px 30px; padding:0px; border:0px; list-style:decimal"> 如果对此置之不理，继续把应用生成的文件放在Documents目录下，那么这些文件会被备份到iTunes或者iCloud。如果这些文件很大，那么用户可能需要为了同步消耗不少流量，然后苹果可能会因此拒绝你的应用上架，这是一个悲剧。</li><li style="margin:0px 0px 0px 30px; padding:0px; border:0px; list-style:decimal"> 如果开发者照Apple说的干，把应用生成的文件放在Caches目录下，那么苹果不会拒绝你的应用，很happy。但是iOS 5会在磁盘空间紧张的时候删除Caches目录下的文件，这对用户来说可能是一个更大的悲剧。</li></ol> 
 <h3 style="margin:0px; padding:0px; border:0px; list-style:none">如何应对新的文件存储策略?</h3> 
 <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 开发者在这时陷入了两难的境地，但是到了iOS 5.0.1的时候，开发者多了第三种选择:</p> 
 <ul style="margin:0px; padding:0px; border:0px; list-style:none"><li style="margin:0px 0px 0px 30px; padding:0px; border:0px; list-style:disc">继续把文件存储在Documents目录下，但是标记这些文件为不需要备份。详情请参考 technote (<a target="_blank" href="http://developer.apple.com/library/ios/#qa/qa1719/_index.html#//apple_ref/doc/uid/DTS40011342" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(65,104,77)">QA1719</a>)</li></ul> 
 <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 原文如下:</p> 
 <blockquote> 
  <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> Q: My app has a number of files that need to be stored on the device permanently for my app to function properly offline. However, those files do not contain user data and don’t need to be backed up. How should I store those files in iOS 5?</p> 
  <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> A: Starting in iOS 5.0.1 a new “do not back up” file attribute has been introduced allowing developers to clearly specify which files should be backed up, which files are local caches only and subject to purge, and which files should not be backed up but should also not be purged. In addition, setting this attribute on a folder will prevent the folder and all of its contents from being backed up.</p> 
 </blockquote> 
 <h3 style="margin:0px; padding:0px; border:0px; list-style:none">代码示例</h3> 
 <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 给文件加上”do not back up”属性的代码如下，需要注意这个是iOS 5.0.1才有效，低于这个版本就别费劲了。</p> 
 <pre style="white-space:normal"><code><span style="word-wrap:normal; word-break:normal">#include</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">
 <wbr></wbr></span><span style="word-wrap:normal; word-break:normal">-</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">(</span><span style="word-wrap:normal; word-break:normal">BOOL</span><span style="word-wrap:normal; word-break:normal">)</span><span style="word-wrap:normal; word-break:normal">addSkipBackupAttributeTo<wbr></wbr>ItemAtURL</span><span style="word-wrap:normal; word-break:normal">:(</span><span style="word-wrap:normal; word-break:normal">NSURL </span><span style="word-wrap:normal; word-break:normal">*)</span><span style="word-wrap:normal; word-break:normal">URL 
</span><span style="word-wrap:normal; word-break:normal">{<!-- --></span><span style="word-wrap:normal; word-break:normal">
 <wbr></wbr></span><span style="word-wrap:normal; word-break:normal">const</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">char</span><span style="word-wrap:normal; word-break:normal">*</span><span style="word-wrap:normal; word-break:normal"> filePath </span><span style="word-wrap:normal; word-break:normal">=</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">[[</span><span style="word-wrap:normal; word-break:normal">URL path</span><span style="word-wrap:normal; word-break:normal">]</span><span style="word-wrap:normal; word-break:normal"> fileSystemRepresentation<wbr></wbr></span><span style="word-wrap:normal; word-break:normal">];</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">const</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">char</span><span style="word-wrap:normal; word-break:normal">*</span><span style="word-wrap:normal; word-break:normal"> attrName </span><span style="word-wrap:normal; word-break:normal">=</span><span style="word-wrap:normal; word-break:normal"></span><span style="word-wrap:normal; word-break:normal">"com.apple.MobileBackup"</span><span style="word-wrap:normal; word-break:normal">;</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">u_int8_t</span><span style="word-wrap:normal; word-break:normal"> attrValue </span><span style="word-wrap:normal; word-break:normal">=</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">1</span><span style="word-wrap:normal; word-break:normal">;</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">int</span><span style="word-wrap:normal; word-break:normal"> result </span><span style="word-wrap:normal; word-break:normal">=</span><span style="word-wrap:normal; word-break:normal"> setxattr</span><span style="word-wrap:normal; word-break:normal">(</span><span style="word-wrap:normal; word-break:normal">filePath</span><span style="word-wrap:normal; word-break:normal">,</span><span style="word-wrap:normal; word-break:normal">attrName</span><span style="word-wrap:normal; word-break:normal">,</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">&amp;</span><span style="word-wrap:normal; word-break:normal">attrValue</span><span style="word-wrap:normal; word-break:normal">,</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">sizeof</span><span style="word-wrap:normal; word-break:normal">(</span><span style="word-wrap:normal; word-break:normal">attrValue</span><span style="word-wrap:normal; word-break:normal">),</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">0</span><span style="word-wrap:normal; word-break:normal">,</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">0</span><span style="word-wrap:normal; word-break:normal">);</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">return</span><span style="word-wrap:normal; word-break:normal"> result </span><span style="word-wrap:normal; word-break:normal">==</span><span style="word-wrap:normal; word-break:normal"> </span><span style="word-wrap:normal; word-break:normal">0</span><span style="word-wrap:normal; word-break:normal">;</span><span style="word-wrap:normal; word-break:normal">
 <wbr></wbr></span><span style="word-wrap:normal; word-break:normal">}</span></code></pre> 
 <br> 
 <code>//设置扩展属性</code> 
 <div> 
  <div> 
   <code>#include</code> 
  </div> 
  <div> 
   <code>- (</code> 
   <code>BOOL</code> 
   <code>)addSkipBackupAttributeTo<wbr></wbr>ItemAtURL:(</code> 
   <code>NSURL</code>  
   <code>*)URL</code> 
  </div> 
  <div> 
   <code>{<!-- --></code> 
  </div> 
  <div> 
   <code>const</code>  
   <code>char</code> 
   <code>* filePath = [[URL path] fileSystemRepresentation<wbr></wbr>];</code> 
  </div> 
  <div>
      
   <wbr></wbr> 
  </div> 
  <div> 
   <code>const</code>  
   <code>char</code> 
   <code>* attrName =</code>  
   <code>"com.apple.MobileBackup"</code> 
   <code>;</code> 
  </div> 
  <div> 
   <code>u_int8_t attrValue = 1;</code> 
  </div> 
  <div>
      
   <wbr></wbr> 
  </div> 
  <div> 
   <code>int</code>  
   <code>result = setxattr(filePath, attrName, &amp;attrValue,</code>  
   <code>sizeof</code> 
   <code>(attrValue), 0, 0);</code> 
  </div> 
  <div> 
   <code>return</code>  
   <code>result == 0;</code> 
  </div> 
  <div> 
   <code>}<br> <br> </code>You can put data in Documents folder but before keep in documents folder create a folder within Documents folder suppose namely temp. Then write the following code to not backup in iCloud. 
   <br> 
   <br> [[NSFileManager defaultManager] createDirectoryAtPath:temp 
   <br>   
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr> withIntermediateDirector 
   <wbr></wbr>ies:NO 
   <br>   
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr> attributes:nil 
   <br>   
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr> error:nil]; 
   <br> NSURL *dbURLPath = [NSURL URLWithString:temp]; 
   <br> [self addSkipBackupAttributeTo 
   <wbr></wbr>ItemAtURL:dbURLPath]; 
   <br> Also implement the method addSkipBackupAttributeTo 
   <wbr></wbr>ItemAtURL do not forget to include 
   <br> #include 
   <br> 
   <br> - (BOOL)addSkipBackupAttributeTo 
   <wbr></wbr>ItemAtURL:(NSURL *)URL { 
   <br>   
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr> const char* filePath = [[URL path] fileSystemRepresentation 
   <wbr></wbr>]; 
   <br> 
   <br>   
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr> const char* attrName = "com.apple.MobileBackup"; 
   <br>   
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr> u_int8_t attrValue = 1; 
   <br> 
   <br>   
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr> int result = setxattr(filePath, attrName, &amp;attrValue, sizeof(attrValue), 0, 0); 
   <br>   
   <wbr></wbr>  
   <wbr></wbr>  
   <wbr></wbr> return result == 0; 
   <br> } 
   <br> 
   <br> 
   <h2 style="margin:0px; padding:0px; border:0px; list-style:none"><span style="word-wrap:normal; word-break:normal; line-height:48px; font-size:24pt">iOS的文件分类、存放路径及文件属性</span></h2> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal">  <wbr></wbr></p> 
   <h3 style="margin:0px; padding:0px; border:0px; list-style:none"><span style="word-wrap:normal; word-break:normal; line-height:36px; font-size:18pt">关键数据</span></h3> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 内容：用户创建的数据文件，无法在删除后自动重新创建，且会</p> 
   <p style="margin:5px auto; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 路径：主目录/Documents</p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 属性：不要设置"不备份"</p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 管理：iOS系统即时遇到存储空间不足的情况下，也不会清除，同时会备份到iTunes或iCloud中 <wbr></wbr> <wbr></wbr></p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> <span style="word-wrap:normal; word-break:normal; line-height:31px; font-size:18pt"><strong>缓存数据<span style="word-wrap:normal; word-break:normal; line-height:21px; font-size:14px; font-weight:normal"> <wbr></wbr></span></strong></span></p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 内容：可用于离线环境，可被重复下载重复生成，即时在离线时缺失，应用本身也可以正常运行</p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 路径：主目录/Library/Caches</p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 属性：默认</p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 管理：在存储空间不足的情况下，会清空， 并且不会被自动备份到iTunes和iCloud中</p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> <span style="word-wrap:normal; word-break:normal; line-height:31px; font-size:18pt"><strong>临时数据</strong></span></p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 内容：应用运行时，为完成某个内部操作临时生成的文件</p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 路径：主目录/tmp</p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 属性：默认</p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 管理：随时可能被iOS系统清除，且不会自动备份到iTunes和iCloud，尽量在文件不再使用时，应用自己情况，避免对用户设备空间的浪费 <wbr></wbr></p> 
   <h3 style="margin:0px; padding:0px; border:0px; list-style:none"><span style="word-wrap:normal; word-break:normal; line-height:36px; font-size:18pt">离线数据</span></h3> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 内容：与缓存数据类似，可以被重新下载和重建，但是用户往往希望在离线时数据依然能够托托地存在着</p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 目录：主目录/Documents  <wbr></wbr>或 主目录/Library/自定义的文件夹</p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 属性：放于Documents下不需设置，放在自定义文件夹中需设置"不备份" <wbr></wbr></p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal"> 管理：与关键数据类似，即时在存储空间不足的情况下也不会清楚，应用自己应该清除已经不再使用的文件，以免浪费用户设备空间</p> 
   <p style="margin-top:0px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal">  <wbr></wbr><a target="_blank" href="http://photo.blog.sina.com.cn/showpic.html#blogid=77e356ee0101avne&amp;url=http://s9.sinaimg.cn/orignal/77e356eetd33d93a9f8c8" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(65,104,77)"><img src="https://images2.imgbox.com/01/5a/DMuBwk5Z_o.gif" height="393" width="690" name="image_operate_51951358161340424" alt="IOS--阻止文件被iTunes和iCloud同步，Do &lt;wbr&gt;Not &lt;wbr&gt;Backup属性" title="IOS--阻止文件被iTunes和iCloud同步，Do &lt;wbr&gt;Not &lt;wbr&gt;Backup属性" style="margin:0px; padding:0px; border:0px; list-style:none"></a><br> <br> </p> 
   <h2 style="margin:0px; padding:0px; border:0px; list-style:none"><span style="word-wrap:normal; word-break:normal; line-height:48px; font-size:24pt">从iOS5.0.1引入的设置不要备份文件（文件夹也适用）的扩展属性</span></h2> 
   <br> 
   <br> 
   <h4 style="margin:0px; padding:0px; border:0px; list-style:none"><span style="word-wrap:normal; word-break:normal; line-height:24.569997787475586px"><a target="_blank" href="http://blog.csdn.net/i2c_rs485/article/details/7386444" style="text-decoration:none; color:rgb(65,104,77)" rel="noopener noreferrer">from being backed up to iCloud and iTunes?</a></span></h4> 
   <div> 
    <span style="word-wrap:normal; word-break:normal">分类： <a target="_blank" href="http://blog.csdn.net/i2c_rs485/article/category/959954" style="text-decoration:none; color:rgb(65,104,77)" rel="noopener noreferrer">iphone开发</a></span>  
    <span style="word-wrap:normal; word-break:normal">2012-03-23 11:28</span>  
    <span title="阅读次数" style="word-wrap:normal; word-break:normal">452人阅读</span>  
    <span title="评论次数" style="word-wrap:normal; word-break:normal"><a target="_blank" href="http://blog.csdn.net/i2c_rs485/article/details/7386444#comments" style="text-decoration:none; color:rgb(65,104,77)" rel="noopener noreferrer">评论</a>(0)</span>  
    <span style="word-wrap:normal; word-break:normal"><a target="_blank" title="收藏" style="text-decoration:underline; color:rgb(65,104,77)">收藏</a></span>  
    <span style="word-wrap:normal; word-break:normal"><a target="_blank" href="http://blog.csdn.net/i2c_rs485/article/details/7386444#report" title="举报" style="text-decoration:none; color:rgb(65,104,77)" rel="noopener noreferrer">举报</a></span> 
   </div> 
   <div> 
    <span style="word-wrap:normal; word-break:normal; line-height:17px; color:rgb(85,85,85); font-family:Verdana,'Bitstream vera sans',Tahoma,Helvetica,sans-serif">先阅读官方说明：</span> 
    <p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal; line-height:17px; color:rgb(85,85,85); font-family:Verdana,'Bitstream vera sans',Tahoma,Helvetica,sans-serif">  <wbr></wbr></p> 
    <div style="margin:0px; padding:0px; color:rgb(85,85,85); font-family:Verdana,'Bitstream vera sans',Tahoma,Helvetica,sans-serif; line-height:17px"> 
     <a target="_blank" href="https://developer.apple.com/library/ios/#qa/qa1719/_index.html" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(65,104,77)">https://developer.apple.com/library/ios/#qa/qa1719/_index.html</a> 
    </div> 
    <div style="margin:0px; padding:0px; color:rgb(85,85,85); font-family:Verdana,'Bitstream vera sans',Tahoma,Helvetica,sans-serif; line-height:17px">
      使用方法： 
    </div> 
    <div style="margin:0px; padding:0px; color:rgb(85,85,85); font-family:Verdana,'Bitstream vera sans',Tahoma,Helvetica,sans-serif; line-height:17px">
      #import “sys/xattr.h” 
     <p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal; line-height:21px">  <wbr></wbr></p> 
     <p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal; line-height:21px"> - (BOOL)addSkipBackupAttributeTo<wbr></wbr>ItemAtURL:(NSURL *)URL<br> {<!-- --><br> const char* filePath = [[URL path] fileSystemRepresentation<wbr></wbr>];</p> 
     <p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal; line-height:21px"> const char* attrName = “com.apple.MobileBackup”;<br> u_int8_t attrValue = 1;</p> 
     <p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal; line-height:21px"> int result = setxattr(filePath, attrName, &amp;attrValue, sizeof(attrValue), 0, 0);<br> return result == 0;<br> }</p> 
     <p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; border:0px; list-style:none; word-wrap:normal; word-break:normal; line-height:21px"> - (void)addSkipBackupAttributeTo<wbr></wbr>Path:(NSString*)path {<!-- --><br> u_int8_t b = 1;<br> setxattr([path fileSystemRepresentation<wbr></wbr>], “com.apple.MobileBackup”, &amp;b, 1, 0, 0);<br> }</p> 
    </div> 
    <div style="margin:0px; padding:0px; color:rgb(85,85,85); font-family:Verdana,'Bitstream vera sans',Tahoma,Helvetica,sans-serif; line-height:17px">
      对文件夹的path使用这两个方法中的任意一个，就可以使该目录和该目录包含的所有文件和文件夹不被icloud和itunes同步了！ 
    </div> 
    <div style="margin:0px; padding:0px; color:rgb(85,85,85); font-family:Verdana,'Bitstream vera sans',Tahoma,Helvetica,sans-serif; line-height:17px">
      对于数据的同步与否的设计规则 详细看上面的官方说明链接。 
    </div> 
    <div style="margin:0px; padding:0px; color:rgb(85,85,85); font-family:Verdana,'Bitstream vera sans',Tahoma,Helvetica,sans-serif; line-height:17px"> 
     <span style="word-wrap:normal; word-break:normal; line-height:21px; color:rgb(153,51,0)">注意：setxattr在iOS 5.0.1之前的系统里不会起作用的，(但是那些系统也没有iCloud只有iTunes^.^)。经测试发现虽然不会起作用，但调用该函数也不会引起空 指针错误。  <wbr></wbr>这是一项挺有意思的技术：新系统里加入了原先系统里没有的func，在原先的系统里调用，居然没有nullpoint错误。 莫非这函数地址早就存在，预留好了后面把功能挂上？ 奇怪了。</span> 
    </div> 
    <div style="margin:0px; padding:0px; color:rgb(85,85,85); font-family:Verdana,'Bitstream vera sans',Tahoma,Helvetica,sans-serif; line-height:17px"> 
    </div> 
    <div style="margin:0px; padding:0px; color:rgb(85,85,85); font-family:Verdana,'Bitstream vera sans',Tahoma,Helvetica,sans-serif; line-height:17px">
      另外补充一下，对这个特性的测试要有耐心，因为icloud识别应用程序里要同步的数据量大小显示要等几秒（菊花。。）， 
    </div> 
    <div style="margin:0px; padding:0px; color:rgb(85,85,85); font-family:Verdana,'Bitstream vera sans',Tahoma,Helvetica,sans-serif; line-height:17px">
      参考文档：apple官方文档， 
    </div> 
    <div style="margin:0px; padding:0px; color:rgb(85,85,85); font-family:Verdana,'Bitstream vera sans',Tahoma,Helvetica,sans-serif; line-height:17px">
      stackoverflow问答： 
     <a target="_blank" href="http://stackoverflow.com/questions/8694112/adding-the-do-not-backup-attribute-to-a-folder-hierarchy-in-ios-5-0-1" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(65,104,77)">http://stackoverflow.com/questions/8694112/adding-the-do-not-backup-attribute-to-a-folder-hierarchy-in-ios-5-0-1</a> 
    </div> 
    <div style="margin:0px; padding:0px; color:rgb(85,85,85); font-family:Verdana,'Bitstream vera sans',Tahoma,Helvetica,sans-serif; line-height:17px">
      原文链接： 
     <a target="_blank" href="http://chishangjin.sinaapp.com/?p=14" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(65,104,77)">http://chishangjin.sinaapp.com/?p=14</a> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/03d2aa45771ee97c7f547e77599dce9a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C#下操作USB设备的方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/01660a31386eab831e27f311c17404aa/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ARM汇编编程基础</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>