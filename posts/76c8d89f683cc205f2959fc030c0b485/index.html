<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>KNN算法实战之手写数字识别 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="KNN算法实战之手写数字识别" />
<meta property="og:description" content="文章目录 一、说明二、题目三、实践部分3.1 准备数据：将图像转换为测试向量3.2 KNN算法3.3 测试算法：使用kNN识别手写数字3.4 截图 四、源代码4.1 KNN.py4.2 KNN.ipynb 一、说明 我是在jupyter完成的，然后导出成markdown格式，ipynb文件导出为markdown的命令如下：
jupyter nbconvert --to markdown xxx.ipynb
二、题目 构造使用K-近邻分类器的手写识别系统。由于能力有限，这里构造的系统只能识别0-9。需要识别的数字已经使用图形处理软件，处理成具有相同的色彩和大小：32像素*32像素的黑白图像。
例如：
当前使用文本格式存储图像，即使不能有效的利用空间，但是为了方便理解，还是将图像转换成文本格式。
示例：使用k-近邻算法的手写识别系统
（1）收集数据：提供文本文件。
（2）处理数据：编写img2vector()函数，将图像格式转换成分类器使用的向量格式。
（3）分析数据：在Python命令提示符中检查数据，确保它符合要求。
（4）训练算法：此步骤不适用于k-近邻算法。
（5）测试算法：编写函数使用提供的部分数据集作为测试样本，对学习算法进行测试。
（6）使用算法：本例没有完成此步骤
三、实践部分 3.1 准备数据：将图像转换为测试向量 trainingDigits中包含了大约2000个例子，每个数字大约有200个样本；测试文件testDigits中包含了大约900个测试数据。两组数据没有重叠。为了使用kNN算法分类器必须将一个3232的二进制矩阵转换为11024的向量，以便我们使用分类器处理数字图像信息。
首先定义img2vector()函数，将3232的二进制矩阵转换成11024的矩阵并返回。
# 图片 to 向量 def img2vector(filename): returnVect = zeros((1, 1024)) fr = open(filename) for i in range(32): lineStr = fr.readline() for j in range(32): returnVect[0, 32 * i &#43; j] = int(lineStr[j]) return returnVect 该函数使用方法
testVector = img2vector(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/76c8d89f683cc205f2959fc030c0b485/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-04-09T22:31:24+08:00" />
<meta property="article:modified_time" content="2020-04-09T22:31:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">KNN算法实战之手写数字识别</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_4" rel="nofollow">一、说明</a></li><li><a href="#_11" rel="nofollow">二、题目</a></li><li><a href="#_34" rel="nofollow">三、实践部分</a></li><li><ul><li><a href="#31__35" rel="nofollow">3.1 准备数据：将图像转换为测试向量</a></li><li><a href="#32_KNN_63" rel="nofollow">3.2 KNN算法</a></li><li><a href="#33_kNN_95" rel="nofollow">3.3 测试算法：使用kNN识别手写数字</a></li><li><a href="#34__129" rel="nofollow">3.4 截图</a></li></ul> 
  </li><li><a href="#_155" rel="nofollow">四、源代码</a></li><li><ul><li><a href="#41_KNNpy_157" rel="nofollow">4.1 KNN.py</a></li><li><a href="#42_KNNipynb_230" rel="nofollow">4.2 KNN.ipynb</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_4"></a>一、说明</h2> 
<p>我是在jupyter完成的，然后导出成markdown格式，ipynb文件导出为markdown的命令如下：</p> 
<blockquote> 
 <p>jupyter nbconvert --to markdown xxx.ipynb</p> 
</blockquote> 
<h2><a id="_11"></a>二、题目</h2> 
<p>  构造使用K-近邻分类器的手写识别系统。由于能力有限，这里构造的系统只能识别0-9。需要识别的数字已经使用图形处理软件，处理成具有相同的色彩和大小：32像素*32像素的黑白图像。<br> 例如：<br> <img src="https://images2.imgbox.com/ff/44/GkHgm1zl_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c4/29/kKl8e7Vp_o.png" alt="在这里插入图片描述"></p> 
<p>  当前使用文本格式存储图像，即使不能有效的利用空间，但是为了方便理解，还是将图像转换成文本格式。</p> 
<p>示例：使用k-近邻算法的手写识别系统</p> 
<p>（1）收集数据：提供文本文件。</p> 
<p>（2）处理数据：编写img2vector()函数，将图像格式转换成分类器使用的向量格式。</p> 
<p>（3）分析数据：在Python命令提示符中检查数据，确保它符合要求。</p> 
<p>（4）训练算法：此步骤不适用于k-近邻算法。</p> 
<p>（5）测试算法：编写函数使用提供的部分数据集作为测试样本，对学习算法进行测试。</p> 
<p>（6）使用算法：本例没有完成此步骤</p> 
<h2><a id="_34"></a>三、实践部分</h2> 
<h3><a id="31__35"></a>3.1 准备数据：将图像转换为测试向量</h3> 
<p>  trainingDigits中包含了大约2000个例子，每个数字大约有200个样本；测试文件testDigits中包含了大约900个测试数据。两组数据没有重叠。为了使用kNN算法分类器必须将一个32<em>32的二进制矩阵转换为1</em>1024的向量，以便我们使用分类器处理数字图像信息。</p> 
<p>  首先定义img2vector()函数，将32<em>32的二进制矩阵转换成1</em>1024的矩阵并返回。</p> 
<pre><code class="prism language-python"><span class="token comment"># 图片 to 向量</span>
<span class="token keyword">def</span> <span class="token function">img2vector</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    returnVect <span class="token operator">=</span> zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    fr <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        lineStr <span class="token operator">=</span> fr<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            returnVect<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span> <span class="token operator">*</span> i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>lineStr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> returnVect

</code></pre> 
<p>该函数使用方法</p> 
<pre><code class="prism language-python">testVector <span class="token operator">=</span> img2vector<span class="token punctuation">(</span><span class="token string">"testDigits/0_1.txt"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>testVector<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>testVector<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">:</span><span class="token number">61</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/88/6b/JkBiGPr5_o.png" alt="在这里插入图片描述"></p> 
<p><br><br></p> 
<h3><a id="32_KNN_63"></a>3.2 KNN算法</h3> 
<pre><code class="prism language-python"><span class="token comment"># kNN分类器</span>
<span class="token keyword">def</span> <span class="token function">classify0</span><span class="token punctuation">(</span>inX<span class="token punctuation">,</span> dataSet<span class="token punctuation">,</span> labels<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">'''
    :param inX:
    :param dataSet:  数据集合  矩阵
    :param labels:  类别名
    :param k: K值      int
    :return:
    '''</span>
    dataSetSize <span class="token operator">=</span> dataSet<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment">#得到数据总量</span>
    diffMat <span class="token operator">=</span> tile<span class="token punctuation">(</span>inX<span class="token punctuation">,</span><span class="token punctuation">(</span>dataSetSize<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> dataSet <span class="token comment">#将输入数据扩充成与数据集同样大小的矩阵并作差</span>
    sqDiffMat <span class="token operator">=</span> diffMat<span class="token operator">**</span><span class="token number">2</span>
    sqDistances <span class="token operator">=</span> sqDiffMat<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#axis = 1 参数是维度参数等于1在此处表示将一个矩阵的每一行向量相加</span>
    distances <span class="token operator">=</span> sqDistances<span class="token operator">**</span> <span class="token number">0.5</span>
    sortedDistancesIndicies <span class="token operator">=</span> distances <span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#将列表值进行对比返回一个按照数值升序的下标值</span>
    classCount<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        voteIlabel <span class="token operator">=</span> labels<span class="token punctuation">[</span>sortedDistancesIndicies<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
        classCount<span class="token punctuation">[</span>voteIlabel<span class="token punctuation">]</span> <span class="token operator">=</span> classCount<span class="token punctuation">.</span>get<span class="token punctuation">(</span>voteIlabel<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>
        <span class="token comment">#dict.get("key") 返回value  dict.get("key",default= None)如果能找到就返回对应的value找不到返回默认值</span>
    sortedClassCount <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>classCount<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>key <span class="token operator">=</span> operator<span class="token punctuation">.</span>itemgetter<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token comment">#sorted 返回一个list  operator.itemgetter(x,y)表示根据x+1维度的第y+1维度</span>
    <span class="token keyword">return</span> sortedClassCount<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

</code></pre> 
<p><br><br></p> 
<h3><a id="33_kNN_95"></a>3.3 测试算法：使用kNN识别手写数字</h3> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">handwritingClassTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    hwLabels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># 训练数据真实值数组</span>
    trainingFileList <span class="token operator">=</span> listdir<span class="token punctuation">(</span><span class="token string">"trainingDigits"</span><span class="token punctuation">)</span>  <span class="token comment"># 获取trainingDigits文件子目录的列表</span>
    m <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>trainingFileList<span class="token punctuation">)</span>  <span class="token comment"># 获得训练数据总数</span>
    trainingMat <span class="token operator">=</span> zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 初始化训练数据矩阵</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 循环将trainingDigits文件下的训练数据文本文件放入矩阵traningMat中，真实值放入hwLabels中</span>
        fileNameStr <span class="token operator">=</span> trainingFileList<span class="token punctuation">[</span>i<span class="token punctuation">]</span>  <span class="token comment"># 获取该次循环的文件名字符串</span>
        fileStr <span class="token operator">=</span> fileNameStr<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># 将获得的字符串按分隔符'.'分隔并取第一个即去拓展名的文件名</span>
        classNumber <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 获取训练数据的真实值 非numpy数据需要指定数据类型int</span>
        hwLabels<span class="token punctuation">.</span>append<span class="token punctuation">(</span>classNumber<span class="token punctuation">)</span>  <span class="token comment"># 将得到的单个真实值按顺序加入到真实值列表hwLabels中</span>
        trainingMat<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> img2vector<span class="token punctuation">(</span><span class="token string">"trainingDigits/%s"</span> <span class="token operator">%</span> fileNameStr<span class="token punctuation">)</span>  <span class="token comment"># 把32*32的二进制文本文件转换成1*1024矩阵并按行存储到训练数据总矩阵中</span>
    testFileList <span class="token operator">=</span> listdir<span class="token punctuation">(</span><span class="token string">"testDigits"</span><span class="token punctuation">)</span>
    errorCount <span class="token operator">=</span> <span class="token number">0.0</span>  <span class="token comment"># 错误预测计数器</span>
    mTest <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>testFileList<span class="token punctuation">)</span>  <span class="token comment"># 测试数据总量</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>mTest<span class="token punctuation">)</span><span class="token punctuation">:</span>
        fileNameStr <span class="token operator">=</span> testFileList<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        fileStr <span class="token operator">=</span> fileNameStr<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        classNumber <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        vectorUnderTest <span class="token operator">=</span> img2vector<span class="token punctuation">(</span><span class="token string">"testDigits/%s"</span> <span class="token operator">%</span> fileNameStr<span class="token punctuation">)</span>
        classifierResult <span class="token operator">=</span> classify0<span class="token punctuation">(</span>vectorUnderTest<span class="token punctuation">,</span> trainingMat<span class="token punctuation">,</span> hwLabels<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># 用kNN分类算法分类</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>classifierResult <span class="token operator">!=</span> classNumber<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 判断预测是否正确，不正确计数器+1打印错误预测</span>
            errorCount <span class="token operator">+=</span> <span class="token number">1.0</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"预测值为：%d ,真实值为：%d "</span> <span class="token operator">%</span> <span class="token punctuation">(</span>classifierResult<span class="token punctuation">,</span> classNumber<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"测试总数：%d,预测错误总数：%d ,错误率为：%f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>mTest<span class="token punctuation">,</span> errorCount<span class="token punctuation">,</span> errorCount <span class="token operator">/</span> <span class="token builtin">float</span><span class="token punctuation">(</span>mTest<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/b6/54/LmeafiAS_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a0/6d/Q6UXzG4n_o.png" alt="在这里插入图片描述"></p> 
<p><br><br></p> 
<h3><a id="34__129"></a>3.4 截图</h3> 
<p><img src="https://images2.imgbox.com/0a/5d/9IDXmSSO_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ff/a1/ma8Xbjd7_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/5f/18/cf8jcJ8Y_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/59/9b/QUCUKPs1_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/b4/f2/gauCIbq7_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/c5/e7/hyMkXEGc_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/7c/d0/mtVfpWlH_o.png" alt="在这里插入图片描述"></p> 
<p><br><br></p> 
<h2><a id="_155"></a>四、源代码</h2> 
<h3><a id="41_KNNpy_157"></a>4.1 KNN.py</h3> 
<pre><code class="prism language-python"><span class="token comment"># 自定义knn分类器</span>
<span class="token keyword">def</span> <span class="token function">classify0</span><span class="token punctuation">(</span>inX<span class="token punctuation">,</span> dataSet<span class="token punctuation">,</span> labels<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    :param inX:
    :param dataSet:  数据集合  矩阵
    :param labels:  类别名
    :param k: K值      int
    :return:
    '''</span>
    dataSetSize <span class="token operator">=</span> dataSet<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    diffMat <span class="token operator">=</span> tile<span class="token punctuation">(</span>inX<span class="token punctuation">,</span> <span class="token punctuation">(</span>dataSetSize<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> dataSet
    sqDiffMat <span class="token operator">=</span> diffMat <span class="token operator">**</span> <span class="token number">2</span>
    sqDistances <span class="token operator">=</span> sqDiffMat<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    distances <span class="token operator">=</span> sqDistances <span class="token operator">**</span> <span class="token number">0.5</span>
    sortedDistIndicies <span class="token operator">=</span> distances<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token punctuation">)</span>
    classCount <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        voteIlabel <span class="token operator">=</span> labels<span class="token punctuation">[</span>sortedDistIndicies<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
        classCount<span class="token punctuation">[</span>voteIlabel<span class="token punctuation">]</span> <span class="token operator">=</span> classCount<span class="token punctuation">.</span>get<span class="token punctuation">(</span>voteIlabel<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    sortedClassCount <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>classCount<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span>operator<span class="token punctuation">.</span>itemgetter<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> sortedClassCount<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>


<span class="token comment"># 图片 to 向量</span>
<span class="token keyword">def</span> <span class="token function">img2vector</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    returnVect <span class="token operator">=</span> zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    fr <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        lineStr <span class="token operator">=</span> fr<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            returnVect<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span> <span class="token operator">*</span> i <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>lineStr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> returnVect


<span class="token comment"># 手写数据集测试类</span>
<span class="token keyword">def</span> <span class="token function">handwritingClassTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    hwLabels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    trainingFileList <span class="token operator">=</span> listdir<span class="token punctuation">(</span><span class="token string">'trainingDigits'</span><span class="token punctuation">)</span>  <span class="token comment"># load the training set</span>
    m <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>trainingFileList<span class="token punctuation">)</span>
    trainingMat <span class="token operator">=</span> zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
        fileNameStr <span class="token operator">=</span> trainingFileList<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        fileStr <span class="token operator">=</span> fileNameStr<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># take off .txt</span>
        classNumStr <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        hwLabels<span class="token punctuation">.</span>append<span class="token punctuation">(</span>classNumStr<span class="token punctuation">)</span>
        trainingMat<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> img2vector<span class="token punctuation">(</span><span class="token string">'trainingDigits/%s'</span> <span class="token operator">%</span> fileNameStr<span class="token punctuation">)</span>
    testFileList <span class="token operator">=</span> listdir<span class="token punctuation">(</span><span class="token string">'testDigits'</span><span class="token punctuation">)</span>  <span class="token comment"># iterate through the test set</span>
    errorCount <span class="token operator">=</span> <span class="token number">0.0</span>
    mTest <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>testFileList<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>mTest<span class="token punctuation">)</span><span class="token punctuation">:</span>

        fileNameStr <span class="token operator">=</span> testFileList<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

        fileStr <span class="token operator">=</span> fileNameStr<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># take off .txt</span>

        classNumStr <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        vectorUnderTest <span class="token operator">=</span> img2vector<span class="token punctuation">(</span><span class="token string">'testDigits/%s'</span> <span class="token operator">%</span> fileNameStr<span class="token punctuation">)</span>

        classifierResult <span class="token operator">=</span> classify0<span class="token punctuation">(</span>vectorUnderTest<span class="token punctuation">,</span> trainingMat<span class="token punctuation">,</span> hwLabels<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"the classifier came back with: %d, the real answer is: %d"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>classifierResult<span class="token punctuation">,</span> classNumStr<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>classifierResult <span class="token operator">!=</span> classNumStr<span class="token punctuation">)</span><span class="token punctuation">:</span>
            errorCount <span class="token operator">+=</span> <span class="token number">1.0</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nthe total number of errors is: %d"</span> <span class="token operator">%</span> errorCount<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nthe total error rate is: %f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>errorCount <span class="token operator">/</span> <span class="token builtin">float</span><span class="token punctuation">(</span>mTest<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="42_KNNipynb_230"></a>4.2 KNN.ipynb</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> datasets
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt 
<span class="token keyword">import</span> time
</code></pre> 
<pre><code class="prism language-python">
<span class="token comment"># 自定义一个kNN分类器类</span>
<span class="token keyword">class</span> <span class="token class-name">MyKNNClassfier</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> distance<span class="token operator">=</span><span class="token string">'euc'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>k <span class="token operator">=</span> k
        self<span class="token punctuation">.</span>distance <span class="token operator">=</span> distance
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token boolean">None</span>
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">fit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        :param X: X_train  array-like [n_samples,shape]
        :param Y: Y_train  array-like [n_samples,1]
        :return:
        '''</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> X
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> Y

    <span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X_test<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        用X_test预测出Y_test_predict
        Y_test : array-like [n_samples,1]
        :param X_test: array-like [n_samples,shape]
        :return:   output  array-like [n_samples,1]
        '''</span>
        output <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>X_test<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>X_test<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            dis <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>x<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> self<span class="token punctuation">.</span>distance <span class="token operator">==</span> <span class="token string">'euc'</span><span class="token punctuation">:</span>  <span class="token comment"># 欧式距离</span>
                    dis<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>X_test<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>x<span class="token punctuation">[</span>j<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            index <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>dis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span>dis<span class="token punctuation">.</span>__getitem__<span class="token punctuation">)</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
                labels<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>y<span class="token punctuation">[</span>index<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            counts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> label <span class="token keyword">in</span> labels<span class="token punctuation">:</span>
                counts<span class="token punctuation">.</span>append<span class="token punctuation">(</span>labels<span class="token punctuation">.</span>count<span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span>
            output<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> labels<span class="token punctuation">[</span>np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>counts<span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> output

    <span class="token keyword">def</span> <span class="token function">score</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        分数评估，用来比较test数据集，查看预测成功的百分数
        :param x: X_test
        :param y: Y_test
        :return:  准确率xx%
        '''</span>
        pred <span class="token operator">=</span> self<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        err <span class="token operator">=</span> <span class="token number">0.0</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> pred<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
                err <span class="token operator">=</span> err <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">-</span> <span class="token builtin">float</span><span class="token punctuation">(</span>err <span class="token operator">/</span> x<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 加载手写图片数据集</span>
<span class="token comment"># 数据集详情说明： https://blog.csdn.net/Asun0204/article/details/75607948</span>
digits <span class="token operator">=</span> datasets<span class="token punctuation">.</span>load_digits<span class="token punctuation">(</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> digits<span class="token punctuation">.</span>data
y <span class="token operator">=</span> digits<span class="token punctuation">.</span>target
</code></pre> 
<pre><code class="prism language-python">digits<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>dict_keys(['data', 'target', 'target_names', 'images', 'DESCR'])
</code></pre> 
<pre><code class="prism language-python">x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code>array([[ 0.,  0.,  5., 13.,  9.,  1.,  0.,  0.,  0.,  0., 13., 15., 10.,
        15.,  5.,  0.,  0.,  3., 15.,  2.,  0., 11.,  8.,  0.,  0.,  4.,
        12.,  0.,  0.,  8.,  8.,  0.,  0.,  5.,  8.,  0.,  0.,  9.,  8.,
         0.,  0.,  4., 11.,  0.,  1., 12.,  7.,  0.,  0.,  2., 14.,  5.,
        10., 12.,  0.,  0.,  0.,  0.,  6., 13., 10.,  0.,  0.,  0.],
       [ 0.,  0.,  0., 12., 13.,  5.,  0.,  0.,  0.,  0.,  0., 11., 16.,
         9.,  0.,  0.,  0.,  0.,  3., 15., 16.,  6.,  0.,  0.,  0.,  7.,
        15., 16., 16.,  2.,  0.,  0.,  0.,  0.,  1., 16., 16.,  3.,  0.,
         0.,  0.,  0.,  1., 16., 16.,  6.,  0.,  0.,  0.,  0.,  1., 16.,
        16.,  6.,  0.,  0.,  0.,  0.,  0., 11., 16., 10.,  0.,  0.],
       [ 0.,  0.,  0.,  4., 15., 12.,  0.,  0.,  0.,  0.,  3., 16., 15.,
        14.,  0.,  0.,  0.,  0.,  8., 13.,  8., 16.,  0.,  0.,  0.,  0.,
         1.,  6., 15., 11.,  0.,  0.,  0.,  1.,  8., 13., 15.,  1.,  0.,
         0.,  0.,  9., 16., 16.,  5.,  0.,  0.,  0.,  0.,  3., 13., 16.,
        16., 11.,  5.,  0.,  0.,  0.,  0.,  3., 11., 16.,  9.,  0.]])
</code></pre> 
<pre><code class="prism language-python">y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code>array([0, 1, 2])
</code></pre> 
<pre><code class="prism language-python">myknn_start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
clf <span class="token operator">=</span> MyKNNClassfier<span class="token punctuation">(</span>k<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'myknn score:'</span><span class="token punctuation">,</span>clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
myknn_end_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'myknn uses time:'</span><span class="token punctuation">,</span>myknn_end_time<span class="token operator">-</span>myknn_start_time<span class="token punctuation">)</span>
</code></pre> 
<pre><code>myknn score: 0.991652754590985
myknn uses time: 20.894031763076782
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neighbors <span class="token keyword">import</span> KNeighborsClassifier
</code></pre> 
<pre><code class="prism language-python">sklearnknn_start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
clf_sklearn <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span>n_neighbors<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
clf_sklearn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'sklearn score:'</span><span class="token punctuation">,</span>clf_sklearn<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
sklearnknn_end_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'sklearn uses time:'</span><span class="token punctuation">,</span>sklearnknn_end_time<span class="token operator">-</span>sklearnknn_start_time<span class="token punctuation">)</span>
</code></pre> 
<pre><code>sklearn score: 0.9905397885364496
sklearn uses time: 0.44499993324279785
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 对数据进行切分，即分出数据集和测试集</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split   <span class="token comment">#引入数据集拆分的模块</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 划分训练集</span>
<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>
 X_test<span class="token punctuation">,</span>
 Y_train<span class="token punctuation">,</span>
 Y_test<span class="token punctuation">)</span> <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> train_size<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

</code></pre> 
<pre><code class="prism language-python">X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code>array([[ 0.,  0.,  0.,  2., 15.,  8.,  0.,  0.,  0.,  0.,  1., 15., 13.,
         3.,  0.,  0.,  0.,  0.,  9., 13.,  1.,  0.,  0.,  0.,  0.,  1.,
        15.,  6.,  0.,  5., 11.,  0.,  0.,  7., 14.,  0.,  1., 15.,  8.,
         0.,  0.,  8., 15.,  9., 15., 16.,  3.,  0.,  0.,  1., 11., 16.,
        16., 10.,  0.,  0.,  0.,  0.,  0.,  2., 15.,  5.,  0.,  0.],
       [ 0.,  0.,  0.,  7., 16., 16., 11.,  0.,  0.,  0.,  6., 16., 16.,
        16., 16.,  0.,  0.,  0., 11., 16., 16., 16.,  9.,  0.,  0.,  0.,
         2.,  9., 11., 14., 10.,  0.,  0.,  0.,  0.,  0.,  0., 10.,  6.,
         0.,  0.,  0.,  0.,  0.,  4., 11.,  1.,  0.,  0.,  0.,  0.,  2.,
        14.,  2.,  0.,  0.,  0.,  0.,  0., 11.,  3.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  6., 11.,  0.,  0.,  0.,  0.,  0.,  0., 15., 10.,
         0.,  0.,  0.,  0.,  0.,  7., 15.,  2.,  0.,  0.,  0.,  0.,  0.,
        16.,  6.,  0.,  0.,  0.,  0.,  0.,  3., 16.,  7.,  5.,  5.,  0.,
         0.,  0.,  2., 16., 13.,  9., 13., 11.,  0.,  0.,  0.,  8., 13.,
         7.,  5., 15.,  3.,  0.,  0.,  0.,  5., 11., 13., 12.,  2.]])
</code></pre> 
<pre><code class="prism language-python">Y_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code>array([4, 9, 6])
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 新创建一个knn分类器</span>
knn01 <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 创建模型</span>
knn01<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> Y_train<span class="token punctuation">)</span>
</code></pre> 
<pre><code>KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',
                     metric_params=None, n_jobs=None, n_neighbors=5, p=2,
                     weights='uniform')
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 查看预测的准确性</span>
knn01<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> Y_test<span class="token punctuation">)</span>
</code></pre> 
<pre><code>0.9944444444444445
</code></pre> 
<pre><code class="prism language-python">knn01<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>array([1, 5, 0])
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 采用支持向量机分类器来尝试看看</span>
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> svm
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">#在数字数据集的情况下，任务是给出图像来预测其表示的数字，共有10个可能类，在这些类上拟合一个估计</span>
clf01 <span class="token operator">=</span> svm<span class="token punctuation">.</span>SVC<span class="token punctuation">(</span>gamma<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">,</span>C<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment"># 估计器实例命名为clf01</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment">#使用除了最后一张意外的所有图像，用[:-1]语法选择这个训练集</span>
clf01<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>digits<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>digits<span class="token punctuation">.</span>target<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>SVC(C=100.0, break_ties=False, cache_size=200, class_weight=None, coef0=0.0,
    decision_function_shape='ovr', degree=3, gamma=0.001, kernel='rbf',
    max_iter=-1, probability=False, random_state=None, shrinking=True,
    tol=0.001, verbose=False)
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 预测</span>
clf01<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>digits<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>array([8])
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 建立svm模型</span>
clf01<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>Y_train<span class="token punctuation">)</span>
</code></pre> 
<pre><code>SVC(C=100.0, break_ties=False, cache_size=200, class_weight=None, coef0=0.0,
    decision_function_shape='ovr', degree=3, gamma=0.001, kernel='rbf',
    max_iter=-1, probability=False, random_state=None, shrinking=True,
    tol=0.001, verbose=False)
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 查看准确率</span>
clf01<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>Y_test<span class="token punctuation">)</span>
</code></pre> 
<pre><code>0.9916666666666667
</code></pre> 
<pre><code class="prism language-python">
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5c12cd8bd549fe4984fe181501a83905/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Django 的 Admin 界面Excel数据导出</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/982438ffaa28ba18859bce51def4f3f6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">sql Server2012 彻底删除</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>