<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>超详细解析wireshark捕获过滤器语法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="超详细解析wireshark捕获过滤器语法" />
<meta property="og:description" content="这里写目录标题 使用捕获过滤器指定捕获过滤器基于类型过滤基于传输方向的过滤基于协议过滤基于数据过滤使用多个捕获过滤器使用预置表达式 使用捕获过滤器 指定捕获过滤器 捕获过滤器的语法格式为：
&lt;Protocol&gt; &lt;Direction&gt; &lt;Host&gt; &lt;Value&gt; &lt;Logical Operation&gt; &lt;other expression&gt;
以上语法解析：
● Protocol (协议) :该选项用来指定协议。可使用的值有ether、fddi、 wlan、 ip、arprarp、decnet、 lat、 sca、 moproc、 mopdl、 tcp 和udp.如果没有特别指明是什么
议，则默认使用所有支持的协议。
●Direction (方向) :该选项用来指定来源或目的地，默认使用src or dst作为关键该选项可使用的值有src、dst、 sre and dst和src or dst。
●Host(s): 指定主机地址。如果没有指定，默认使用host 关键字。可能使用的值有
net、port、 host 和portrange.
●Logical Operations (逻辑运算):该选项用来指定逻辑运算符。可能使用的值有and和or.其中，not (否)具有最高的优先级; or (或)和and (与)具有
优先级，运算时从左至右进行。
●Other expression (其他表达式) :使用其他表达式捕获过滤器。
例如：
指定捕获tcp协议且端口为80 的数据包：
基于类型过滤 Wireshark可以基于类型进行捕获过滤。其中可能使用的类型有主机host，网段net，端口port，端口范围portrange和特殊类型。
主机host 语法格式： host host
解析：第一个host表示过滤器类型为host：第二个host表示主机地址，可以是ipv4或Ipv6地址。 例：捕获主机192.168.1.10 的数据包。
host 192.168.1.10" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/4ea181dd6d1bca874cc6a349471f3ddf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-03T16:26:35+08:00" />
<meta property="article:modified_time" content="2020-11-03T16:26:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">超详细解析wireshark捕获过滤器语法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>这里写目录标题</h4> 
 <ul><li><a href="#_1" rel="nofollow">使用捕获过滤器</a></li><li><ul><li><a href="#_2" rel="nofollow">指定捕获过滤器</a></li><li><a href="#_30" rel="nofollow">基于类型过滤</a></li><li><a href="#_95" rel="nofollow">基于传输方向的过滤</a></li><li><a href="#_145" rel="nofollow">基于协议过滤</a></li><li><a href="#_174" rel="nofollow">基于数据过滤</a></li><li><a href="#_200" rel="nofollow">使用多个捕获过滤器</a></li><li><a href="#_216" rel="nofollow">使用预置表达式</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>使用捕获过滤器</h2> 
<h3><a id="_2"></a>指定捕获过滤器</h3> 
<p><img src="https://images2.imgbox.com/81/64/8uu7Vsjr_o.png" alt="在这里插入图片描述"><br> <strong>捕获过滤器的语法格式为：</strong><br> &lt;Protocol&gt; &lt;Direction&gt; &lt;Host&gt; &lt;Value&gt; &lt;Logical Operation&gt; &lt;other expression&gt;</p> 
<p><strong>以上语法解析：</strong></p> 
<p>● Protocol (协议) :该选项用来指定协议。可使用的值有ether、fddi、 wlan、 ip、arprarp、decnet、 lat、 sca、 moproc、 mopdl、 tcp 和udp.如果没有特别指明是什么<br> 议，则默认使用所有支持的协议。</p> 
<p>●Direction (方向) :该选项用来指定来源或目的地，默认使用src or dst作为关键该选项可使用的值有src、dst、 sre and dst和src or dst。</p> 
<p>●Host(s): 指定主机地址。如果没有指定，默认使用host 关键字。可能使用的值有<br> <strong>net</strong>、<strong>port</strong>、 <strong>host</strong> 和<strong>portrange.</strong></p> 
<p>●Logical Operations (逻辑运算):该选项用来指定逻辑运算符。可能使用的值有and和or.其中，not (否)具有最高的优先级; or (或)和and (与)具有<br> 优先级，运算时从左至右进行。</p> 
<p>●Other expression (其他表达式) :使用其他表达式捕获过滤器。</p> 
<p><strong>例如</strong>：</p> 
<p>指定捕获tcp协议且端口为80 的数据包：<br> <img src="https://images2.imgbox.com/c7/0a/yEp4nJ6e_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_30"></a>基于类型过滤</h3> 
<p>Wireshark可以基于类型进行捕获过滤。其中可能使用的类型有主机host，网段net，端口port，端口范围portrange和特殊类型。</p> 
<ol><li><strong>主机host</strong></li></ol> 
<p><strong>语法格式：</strong> host host</p> 
<pre><code>解析：第一个host表示过滤器类型为host：第二个host表示主机地址，可以是ipv4或Ipv6地址。
</code></pre> 
<p>例：捕获主机192.168.1.10 的数据包。</p> 
<blockquote> 
 <p>host 192.168.1.10</p> 
</blockquote> 
<p>-2 <strong>网段net</strong><br> net用来指定捕获那个网段的数据包，其中网络类型的过滤器有三种形式。分别是：<br> <strong>net net<br> net mask<br> net CIDR</strong></p> 
<ul><li>net net</li></ul> 
<blockquote> 
 <p>net 192.168.1.0 //对应掩码 255.255.255.255<br> net 192.168.1 //对应掩码 255.255.255.0<br> net 192.168 //对应掩码 255.255.0.0<br> net 192 //对应掩码255.0.0.0</p> 
</blockquote> 
<ul><li>net mask形式</li></ul> 
<blockquote> 
 <p>net 192.168.1.0 mask 255.255.255.0</p> 
</blockquote> 
<ul><li>net CIDR形式</li></ul> 
<blockquote> 
 <p>net 192.168.1.0/24</p> 
</blockquote> 
<ol start="3"><li><strong>端口port</strong></li></ol> 
<p>语法格式： port port</p> 
<blockquote> 
 <p>例： port 80</p> 
</blockquote> 
<ol start="4"><li><strong>端口范围</strong></li></ol> 
<p>语法：portrange port1-port2</p> 
<blockquote> 
 <p>例： portrange 1-100</p> 
</blockquote> 
<ol start="5"><li><strong>特殊类型</strong></li></ol> 
<p>gateway host</p> 
<h3><a id="_95"></a>基于传输方向的过滤</h3> 
<p><strong>1. 源src</strong><br> 可以在host，net，port，portrange类型前面田间src；</p> 
<blockquote> 
 <p>src host host //仅捕获地址为指定主机的数据包<br> src net net //仅捕获源地址为指定网段的数据包<br> src port port //仅捕获源端口为指定端口的数据包<br> src portrange port1-port2 //仅捕获端口范围为指定端口范围的数据包</p> 
</blockquote> 
<p><strong>2. 目标dst</strong></p> 
<blockquote> 
 <p>dst host host //仅捕获地址为指定主机的数据包<br> dst net net //仅捕获源地址为指定网段的数据包<br> dst port port //仅捕获源端口为指定端口的数据包<br> dst portrange port1-port2 //仅捕获端口范围为指定端口范围的数据包</p> 
</blockquote> 
<p><strong>3. 源或者目标</strong></p> 
<blockquote> 
 <p>src or dst host<br> src or dst net<br> src or dst port<br> src or dst portrange port1-port2</p> 
</blockquote> 
<p><strong>4. 源和目标</strong></p> 
<blockquote> 
 <p>src and dst host<br> src and dst net<br> src and dst port<br> src and dst portrange port1-port2</p> 
</blockquote> 
<p><strong>5. 特殊方向</strong><br> 除了上述还有两种特殊方向捕获过滤器，分别是：<br> <strong>广播：broadcast<br> 多播：multicast</strong></p> 
<blockquote> 
 <p>ether broadcast //捕获以太网广播流量<br> ip broadcast //捕获ip广播流量<br> ether multicast //捕获哦以太网多播流量</p> 
</blockquote> 
<p><a href="https://zhidao.baidu.com/question/48206411.html" rel="nofollow">广播和多播的区别</a></p> 
<p>实例：捕获IPV4多播数据包</p> 
<p><img src="https://images2.imgbox.com/a3/d7/mYD864C5_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/95/c0/2ywCWWO2_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_145"></a>基于协议过滤</h3> 
<p><strong>1. 协议</strong><br> 支持的协议过滤器</p> 
<table><thead><tr><th>协议</th><th>含义</th></tr></thead><tbody><tr><td>ether</td><td>以太网协议</td></tr><tr><td>fddi</td><td>fddi是以太网协议的别名</td></tr><tr><td>tr</td><td>tr是以太网协议的别名</td></tr><tr><td>wlan</td><td>无线协议也是以太网协议的别名</td></tr><tr><td>ip</td><td>互联网ipv4协议</td></tr><tr><td>ip6</td><td>互联网ipv6协议</td></tr><tr><td>arp</td><td>地址解析协议</td></tr><tr><td>rarp</td><td>反向地址解析协议</td></tr><tr><td>decent</td><td>由数字设备公司推出并支持的一组协议集合</td></tr><tr><td>tcp</td><td>传输控制协议</td></tr><tr><td>udp</td><td>用户数据报协议</td></tr><tr><td>icmp</td><td>internet控制报文协议</td></tr></tbody></table> 
<p><strong>这些可以搭配前面所讲的过滤方式达到更加巧妙的过滤方式</strong></p> 
<p><strong>例子</strong>：过滤源主机为192.168.1.100并且为tcp协议端口80的数据</p> 
<p><img src="https://images2.imgbox.com/81/14/ba90sym1_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_174"></a>基于数据过滤</h3> 
<p><strong>1. 长度过滤</strong><br> 可以使用 <strong>less ，greater</strong>关键字</p> 
<blockquote> 
 <p>less 12 也可写成 len &lt;=12<br> greater 12 也可写成 len&gt;=12</p> 
</blockquote> 
<p><strong>2. 基于内容过滤</strong></p> 
<blockquote> 
 <p><strong>语法格式</strong>： proto[expr:size] relop express</p> 
</blockquote> 
<p><strong>参数解析：</strong></p> 
<ul><li>proto：支持的协议，有ether，fddi,tr,wlan,ppp,slip,link,ip,arp,rarp,tcp,udp,icmp,ip6或radio</li><li>expr :指定协议的偏移地址</li><li>size：指定数据长度其中，单位bit</li><li>relop：指定使用的运算符，关系运算符有，&gt;,&lt;,&gt;=,&lt;=.=,!=，二进制运算符有，+，-，*，/，%，&amp;，|，^,&lt;&lt;,&gt;&gt;</li></ul> 
<p>例如：捕获所有ipv4地址包，</p> 
<blockquote> 
 <p>ip[0] &amp; 0xf !=5</p> 
</blockquote> 
<h3><a id="_200"></a>使用多个捕获过滤器</h3> 
<p>通过结合逻辑运算符可以同时使用多个捕获过滤器。</p> 
<p>有： <strong>not (!) ,and(&amp;&amp;),or(||) ,</strong></p> 
<p>例如：捕获主机192.168.1.100，而且tcp端口为80的数据包</p> 
<blockquote> 
 <p>host 192.168.1.100 and tcp port 80</p> 
</blockquote> 
<p><strong>注意</strong>： not(!) 具有最高优先级，and(&amp;&amp;)和 or(||）优先级相等。</p> 
<h3><a id="_216"></a>使用预置表达式</h3> 
<p><img src="https://images2.imgbox.com/a0/ea/KsjafjXJ_o.png" alt="在这里插入图片描述"><br> 然后点击管理捕获过滤器</p> 
<p><img src="https://images2.imgbox.com/dd/cb/jzu3fkcH_o.png" alt="在这里插入图片描述"><br> 可以将平时常用，或者，想到骚操作记录下来，下次就可以直接使用了。</p> 
<p><strong>ok，捕获过滤器的内容到这里就结束了，接下来会持续更新，显示过滤器，数据的处理与分析，等内容，持续关注吧😉。</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e1b5b7522baa0ae8e19f0713b5787646/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">软件测试和软件开发哪个发展更好</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4e35f5aeff68577677edb402e5308d70/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Scala连接mysql的方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>