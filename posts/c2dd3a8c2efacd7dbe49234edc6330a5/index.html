<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>单词发音，为语音识别准备素材 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="单词发音，为语音识别准备素材" />
<meta property="og:description" content="单词发音，为语音识别准备素材 环境windows下安装pyttsx3linux下安装pyttsx3 界面展示图形化界面输出文档 写作过程注意事项完整代码 环境 这里我用的是python3.7.9。pycharm编译器。windows系统。 windows下安装pyttsx3 pip install pyttsx3 linux下安装pyttsx3 linux下安装pyttsx3时，要先安装两个插件，要不用起来会报错 sudo apt-get install alsa-utils sudo apt-get install espeak pip install pyttsx3 界面展示 图形化界面 图形化界面，很简陋的一个
输出文档 是我做好之后的音频素材文档
保存单词的word.txt
单词发音
写作过程 1.导入相关包。
os，用来进行文件的读写。re，正则匹配。pyttsx3，文字读语音。
import os import tkinter from tkinter.filedialog import * from tkinter import ttk import pyttsx3 import re 2.这里我准备了一个类来做图形化界面，函数功能也直接在类里面实现了。结果就是看起来十分臃肿，一点都不美观。不过这解决了函数放在类外面出现的一些问题。比如说变量调用很麻烦之类的。
里面变量有些数字大的在前面，这是因为我写的时候是按照从小到大开始写的，但刚开始有些功能没有想明白，把新代码插在了中间。
self.path: 存放文件的输入框
self.path1: 单词的输入框
self.language: 选择发音
self.prompt_statement: 提示语句
self.batch_file: 批文件的输入框。文件里面存放多个英文单词
self.words: 文件里面的单词数量
class painting(): def __init__(self): self.app1 = tkinter." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c2dd3a8c2efacd7dbe49234edc6330a5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-24T21:52:41+08:00" />
<meta property="article:modified_time" content="2022-03-24T21:52:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">单词发音，为语音识别准备素材</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>单词发音，为语音识别准备素材</h4> 
 <ul><li><a href="#_2" rel="nofollow">环境</a></li><li><ul><li><a href="#windowspyttsx3_4" rel="nofollow">windows下安装pyttsx3</a></li><li><a href="#linuxpyttsx3_6" rel="nofollow">linux下安装pyttsx3</a></li></ul> 
  </li><li><a href="#_12" rel="nofollow">界面展示</a></li><li><ul><li><a href="#_13" rel="nofollow">图形化界面</a></li><li><a href="#_17" rel="nofollow">输出文档</a></li></ul> 
  </li><li><a href="#_24" rel="nofollow">写作过程</a></li><li><a href="#_230" rel="nofollow">注意事项</a></li><li><a href="#_244" rel="nofollow">完整代码</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>环境</h2> 
<pre><code>这里我用的是python3.7.9。pycharm编译器。windows系统。
</code></pre> 
<h3><a id="windowspyttsx3_4"></a>windows下安装pyttsx3</h3> 
<pre><code>pip install pyttsx3
</code></pre> 
<h3><a id="linuxpyttsx3_6"></a>linux下安装pyttsx3</h3> 
<pre><code>linux下安装pyttsx3时，要先安装两个插件，要不用起来会报错
sudo apt-get install alsa-utils
sudo apt-get install espeak
pip install pyttsx3
</code></pre> 
<h2><a id="_12"></a>界面展示</h2> 
<h3><a id="_13"></a>图形化界面</h3> 
<p>图形化界面，很简陋的一个<br> <img src="https://images2.imgbox.com/44/05/OFDzfHhK_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_17"></a>输出文档</h3> 
<p>是我做好之后的音频素材文档<br> <img src="https://images2.imgbox.com/90/7c/NWuocPgr_o.png" alt="在这里插入图片描述"><br> 保存单词的word.txt<br> <img src="https://images2.imgbox.com/e3/f7/F5CWdviQ_o.png" alt="在这里插入图片描述"><br> 单词发音<br> <img src="https://images2.imgbox.com/7c/9a/qbknSDUk_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_24"></a>写作过程</h2> 
<p>1.导入相关包。<br> os，用来进行文件的读写。re，正则匹配。pyttsx3，文字读语音。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> tkinter
<span class="token keyword">from</span> tkinter<span class="token punctuation">.</span>filedialog <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> tkinter <span class="token keyword">import</span> ttk
<span class="token keyword">import</span> pyttsx3
<span class="token keyword">import</span> re
</code></pre> 
<p>2.这里我准备了一个类来做图形化界面，函数功能也直接在类里面实现了。结果就是看起来十分臃肿，一点都不美观。不过这解决了函数放在类外面出现的一些问题。比如说变量调用很麻烦之类的。</p> 
<p><strong>里面变量有些数字大的在前面，这是因为我写的时候是按照从小到大开始写的，但刚开始有些功能没有想明白，把新代码插在了中间。</strong></p> 
<p>self.path: 存放文件的输入框<br> self.path1: 单词的输入框<br> self.language: 选择发音<br> self.prompt_statement: 提示语句<br> self.batch_file: 批文件的输入框。文件里面存放多个英文单词<br> self.words: 文件里面的单词数量</p> 
<pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">painting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>app1 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>app1<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"单词音频保存"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>app1<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">"760x430"</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>path <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>path1 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>languages <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>prompt_statement <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'提示语句!'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>batch_file <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token comment"># 初始化输入框</span>
        <span class="token comment"># self.path.set(os.path.abspath('.'))</span>

        self<span class="token punctuation">.</span>label1 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"单词:"</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">70</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>entry1 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> textvariable<span class="token operator">=</span>self<span class="token punctuation">.</span>path1<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">130</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>button1 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"下载"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>self<span class="token punctuation">.</span>audio_save<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>label4 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"批量下载："</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">70</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">65</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>entry4 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>self<span class="token punctuation">.</span>batch_file<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">130</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">65</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>button4 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"批量导入"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>self<span class="token punctuation">.</span>batch_load<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">65</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>button5 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"批量下载"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>self<span class="token punctuation">.</span>batch_save<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">580</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">65</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>label2 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"保存目录："</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">70</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>entry2 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> textvariable<span class="token operator">=</span>self<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">130</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>button2 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"选择目录"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>self<span class="token punctuation">.</span>output_file_path<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>label3 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"发音语言："</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">70</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Chinese"</span><span class="token punctuation">,</span> <span class="token string">"English"</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>dropdown_box <span class="token operator">=</span> ttk<span class="token punctuation">.</span>Combobox<span class="token punctuation">(</span>values<span class="token operator">=</span>self<span class="token punctuation">.</span>values<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>self<span class="token punctuation">.</span>languages<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">130</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>label4 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>app1<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>3.图像化界面创建好了，接下来就可以写功能了。以下功能写在类里面。<br> 定义输出文件。</p> 
<pre><code class="prism language-python"><span class="token comment"># 定义输出文件</span>
    <span class="token keyword">def</span> <span class="token function">output_file_path</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 打开文件</span>
        <span class="token comment"># file_name=str(askopenfile())[25:-28]</span>
        <span class="token comment"># 选择文件夹</span>
        file_path <span class="token operator">=</span> askdirectory<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
        <span class="token comment"># print(file_path)</span>
</code></pre> 
<p>检查文字与发音选择是否对应：</p> 
<pre><code class="prism language-python">    <span class="token comment"># 检测发音</span>
    <span class="token keyword">def</span> <span class="token function">detect_languages</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        language <span class="token operator">=</span> self<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> language <span class="token operator">==</span> <span class="token string">"Chinese"</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>is_Chinese<span class="token punctuation">(</span>self<span class="token punctuation">.</span>path1<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># print('不是中文！')</span>
                self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'不是中文'</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token boolean">False</span>
            <span class="token keyword">return</span> <span class="token string">"Chinese"</span>
        <span class="token keyword">elif</span> language <span class="token operator">==</span> <span class="token string">"English"</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">"English"</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># print('发音选择错误，请重新开始选择！')</span>
            self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'发音选择错误，请重新开始选择！'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
</code></pre> 
<p>里面用到了判断是否是中文的函数。这是因为在linux下中文如果用不小心用了英文发音器，只会发出letter,letter的声音。很不友好。</p> 
<pre><code class="prism language-python"><span class="token comment"># 判断是否中文</span>
    <span class="token keyword">def</span> <span class="token function">is_Chinese</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> word<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> ch <span class="token keyword">in</span> word<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token string">'\u4e00'</span> <span class="token operator">&lt;=</span> ch <span class="token operator">&lt;=</span> <span class="token string">'\u9fff'</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token boolean">True</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
</code></pre> 
<p>检查单词长度。这里我们不希望单词太长，对单词长度做了限制。</p> 
<pre><code class="prism language-python"><span class="token comment"># 检查单词长度</span>
    <span class="token keyword">def</span> <span class="token function">detect_word_length</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        word <span class="token operator">=</span> self<span class="token punctuation">.</span>path1<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"单词太长了！"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> word
</code></pre> 
<p>单词发音，没有储存目录则默认不会存储。</p> 
<pre><code class="prism language-python"><span class="token comment"># 单词发音转音频，未选择保存目录则只发音不保存音频</span>
    <span class="token keyword">def</span> <span class="token function">word_to_audio</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> word<span class="token punctuation">,</span> output_path<span class="token punctuation">,</span> language<span class="token punctuation">)</span><span class="token punctuation">:</span>
        engine <span class="token operator">=</span> pyttsx3<span class="token punctuation">.</span>init<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 增大音量</span>
        volume <span class="token operator">=</span> engine<span class="token punctuation">.</span>getProperty<span class="token punctuation">(</span><span class="token string">'volume'</span><span class="token punctuation">)</span>
        volume <span class="token operator">=</span> engine<span class="token punctuation">.</span>setProperty<span class="token punctuation">(</span><span class="token string">'volume'</span><span class="token punctuation">,</span> volume <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token comment"># 选择是否中文</span>
        <span class="token keyword">if</span> language <span class="token operator">==</span> <span class="token string">"Chinese"</span><span class="token punctuation">:</span>
            voices <span class="token operator">=</span> engine<span class="token punctuation">.</span>getProperty<span class="token punctuation">(</span><span class="token string">'voices'</span><span class="token punctuation">)</span>
            engine<span class="token punctuation">.</span>setProperty<span class="token punctuation">(</span><span class="token string">'voice'</span><span class="token punctuation">,</span> voices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
            engine<span class="token punctuation">.</span>say<span class="token punctuation">(</span>word<span class="token punctuation">)</span>
            engine<span class="token punctuation">.</span>save_to_file<span class="token punctuation">(</span>word<span class="token punctuation">,</span> output_path<span class="token punctuation">)</span>
            <span class="token comment"># print("language:","Chinese")</span>
            self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"Language: Chinese"</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 默认英文。</span>
            voices <span class="token operator">=</span> engine<span class="token punctuation">.</span>getProperty<span class="token punctuation">(</span><span class="token string">'voices'</span><span class="token punctuation">)</span>
            engine<span class="token punctuation">.</span>setProperty<span class="token punctuation">(</span><span class="token string">'voice'</span><span class="token punctuation">,</span> voices<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
            engine<span class="token punctuation">.</span>say<span class="token punctuation">(</span>word<span class="token punctuation">)</span>
            engine<span class="token punctuation">.</span>save_to_file<span class="token punctuation">(</span>word<span class="token punctuation">,</span> output_path<span class="token punctuation">)</span>
            <span class="token comment"># print("language:", "English")</span>
            self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"Language：English"</span><span class="token punctuation">)</span>
        engine<span class="token punctuation">.</span>runAndWait<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>存储文件的路径问题：</p> 
<pre><code class="prism language-python"><span class="token comment"># 发音保存</span>
    <span class="token keyword">def</span> <span class="token function">audio_save</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        word <span class="token operator">=</span> self<span class="token punctuation">.</span>detect_word_length<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> word<span class="token punctuation">:</span>
            word_save_folder <span class="token operator">=</span> self<span class="token punctuation">.</span>path<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> word
            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>word_save_folder<span class="token punctuation">)</span><span class="token punctuation">:</span>
                word_save_path <span class="token operator">=</span> word_save_folder <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> word <span class="token operator">+</span> <span class="token string">'.wav'</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>word_save_folder<span class="token punctuation">)</span>
                word_save_path <span class="token operator">=</span> word_save_folder <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> word <span class="token operator">+</span> <span class="token string">'.wav'</span>
        language <span class="token operator">=</span> self<span class="token punctuation">.</span>detect_languages<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> language<span class="token punctuation">:</span>
            <span class="token comment"># print(language)</span>
            <span class="token comment"># print(word,word_save_path,"English")</span>
            self<span class="token punctuation">.</span>word_to_audio<span class="token punctuation">(</span>word<span class="token punctuation">,</span> word_save_path<span class="token punctuation">,</span> language<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
</code></pre> 
<p>4.一个个单词发音太麻烦了。这里，我选择从文本导入英文单词，执行发音函数。当然，也可以选择从网上爬取英文单词和音频。不过我爬虫学的不怎么好，这里就不献丑了。<br> 这里我只选择了前四个单词作输入。我单词文本第一行不是英文。</p> 
<pre><code class="prism language-python"><span class="token comment"># 批量导入英文单词</span>
    <span class="token keyword">def</span> <span class="token function">batch_load</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        file_path <span class="token operator">=</span> askopenfilename<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>batch_file<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
        file_name <span class="token operator">=</span> self<span class="token punctuation">.</span>batch_file<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            content <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                word <span class="token operator">=</span> re<span class="token punctuation">.</span>match<span class="token punctuation">(</span><span class="token string">r'[A-Za-z0-9]*'</span><span class="token punctuation">,</span> content<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>words<span class="token punctuation">.</span>append<span class="token punctuation">(</span>word<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">finally</span><span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>words<span class="token punctuation">)</span>
</code></pre> 
<p>批量保存：</p> 
<pre><code class="prism language-python"><span class="token comment"># 批量下载</span>
    <span class="token keyword">def</span> <span class="token function">batch_save</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>words<span class="token punctuation">:</span>
            <span class="token comment"># print('没有单词')</span>
            self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"没有单词！"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>path<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'批量下载输出路径没有定义！'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">for</span> word <span class="token keyword">in</span> self<span class="token punctuation">.</span>words<span class="token punctuation">:</span>
            word_save_folder <span class="token operator">=</span> self<span class="token punctuation">.</span>path<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> word
            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>word_save_folder<span class="token punctuation">)</span><span class="token punctuation">:</span>
                word_save_path <span class="token operator">=</span> word_save_folder <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> word <span class="token operator">+</span> <span class="token string">'.wav'</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>word_save_folder<span class="token punctuation">)</span>
                word_save_path <span class="token operator">=</span> word_save_folder <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> word <span class="token operator">+</span> <span class="token string">'.wav'</span>
            self<span class="token punctuation">.</span>word_to_audio<span class="token punctuation">(</span>word<span class="token punctuation">,</span> word_save_path<span class="token punctuation">,</span> <span class="token string">'English'</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_230"></a>注意事项</h2> 
<p>1.在创建图像化界面的时候，点击函数对应的功能。记住函数后面不能带"()"。否则打开图像化界面，按钮就被默认点击了一次，里面的函数也会同步执行一次。<br> 错误：self.button1 = tkinter.Button(self.app1, text=“下载”, command=<strong>self.audio_save()</strong>).place(x=500, y=25)<br> 正确：self.button1 = tkinter.Button(self.app1, text=“下载”, command=<strong>self.audio_save</strong>).place(x=500, y=25)</p> 
<p>2.在linux执行保存音频的时候，出现了错误。查找之后发现是python版本的问题。**python3.7以下不能用pyttsx3保存音频。**由于我做机器学习linux下的python版本用的是python3.6，所以这个准备素材的活在Windows下写了。</p> 
<p>3.Linux下选择中文发音器时。普通话中文发音器是倒数第二个，而windows下是第一个。</p> 
<pre><code class="prism language-python">voices <span class="token operator">=</span> engine<span class="token punctuation">.</span>getProperty<span class="token punctuation">(</span><span class="token string">'voices'</span><span class="token punctuation">)</span>
engine<span class="token punctuation">.</span>setProperty<span class="token punctuation">(</span><span class="token string">'voice'</span><span class="token punctuation">,</span> voices<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_244"></a>完整代码</h2> 
<pre><code class="prism language-python"><span class="token comment"># tkinter进行图像化设计</span>
<span class="token keyword">import</span> os
<span class="token keyword">import</span> tkinter
<span class="token keyword">from</span> tkinter<span class="token punctuation">.</span>filedialog <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> tkinter <span class="token keyword">import</span> ttk
<span class="token keyword">import</span> pyttsx3
<span class="token keyword">import</span> re


<span class="token keyword">class</span> <span class="token class-name">painting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>app1 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>app1<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"单词音频保存"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>app1<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">"760x430"</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>path <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>path1 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>languages <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>prompt_statement <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'提示语句!'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>batch_file <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token comment"># 初始化输入框</span>
        <span class="token comment"># self.path.set(os.path.abspath('.'))</span>

        self<span class="token punctuation">.</span>label1 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"单词:"</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">70</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>entry1 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> textvariable<span class="token operator">=</span>self<span class="token punctuation">.</span>path1<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">130</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>button1 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"下载"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>self<span class="token punctuation">.</span>audio_save<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>label4 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"批量下载："</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">70</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">65</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>entry4 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>self<span class="token punctuation">.</span>batch_file<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">130</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">65</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>button4 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"批量导入"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>self<span class="token punctuation">.</span>batch_load<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">65</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>button5 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"批量下载"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>self<span class="token punctuation">.</span>batch_save<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">580</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">65</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>label2 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"保存目录："</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">70</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>entry2 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> textvariable<span class="token operator">=</span>self<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">130</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>button2 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"选择目录"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>self<span class="token punctuation">.</span>output_file_path<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>label3 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"发音语言："</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">70</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Chinese"</span><span class="token punctuation">,</span> <span class="token string">"English"</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>dropdown_box <span class="token operator">=</span> ttk<span class="token punctuation">.</span>Combobox<span class="token punctuation">(</span>values<span class="token operator">=</span>self<span class="token punctuation">.</span>values<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>self<span class="token punctuation">.</span>languages<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">130</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>label4 <span class="token operator">=</span> tkinter<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>self<span class="token punctuation">.</span>app1<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>app1<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 检查单词长度</span>
    <span class="token keyword">def</span> <span class="token function">detect_word_length</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        word <span class="token operator">=</span> self<span class="token punctuation">.</span>path1<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"单词太长了！"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> word

    <span class="token comment"># 判断是否中文</span>
    <span class="token keyword">def</span> <span class="token function">is_Chinese</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> word<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> ch <span class="token keyword">in</span> word<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token string">'\u4e00'</span> <span class="token operator">&lt;=</span> ch <span class="token operator">&lt;=</span> <span class="token string">'\u9fff'</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token boolean">True</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>

    <span class="token comment"># 检测发音</span>
    <span class="token keyword">def</span> <span class="token function">detect_languages</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        language <span class="token operator">=</span> self<span class="token punctuation">.</span>languages<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> language <span class="token operator">==</span> <span class="token string">"Chinese"</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>is_Chinese<span class="token punctuation">(</span>self<span class="token punctuation">.</span>path1<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># print('不是中文！')</span>
                self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'不是中文'</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token boolean">False</span>
            <span class="token keyword">return</span> <span class="token string">"Chinese"</span>
        <span class="token keyword">elif</span> language <span class="token operator">==</span> <span class="token string">"English"</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">"English"</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># print('发音选择错误，请重新开始选择！')</span>
            self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'发音选择错误，请重新开始选择！'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>

    <span class="token comment"># 单词发音转音频，未选择保存目录则只发音不保存音频</span>
    <span class="token keyword">def</span> <span class="token function">word_to_audio</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> word<span class="token punctuation">,</span> output_path<span class="token punctuation">,</span> language<span class="token punctuation">)</span><span class="token punctuation">:</span>
        engine <span class="token operator">=</span> pyttsx3<span class="token punctuation">.</span>init<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 增大音量</span>
        volume <span class="token operator">=</span> engine<span class="token punctuation">.</span>getProperty<span class="token punctuation">(</span><span class="token string">'volume'</span><span class="token punctuation">)</span>
        volume <span class="token operator">=</span> engine<span class="token punctuation">.</span>setProperty<span class="token punctuation">(</span><span class="token string">'volume'</span><span class="token punctuation">,</span> volume <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token comment"># 选择是否中文</span>
        <span class="token keyword">if</span> language <span class="token operator">==</span> <span class="token string">"Chinese"</span><span class="token punctuation">:</span>
            voices <span class="token operator">=</span> engine<span class="token punctuation">.</span>getProperty<span class="token punctuation">(</span><span class="token string">'voices'</span><span class="token punctuation">)</span>
            engine<span class="token punctuation">.</span>setProperty<span class="token punctuation">(</span><span class="token string">'voice'</span><span class="token punctuation">,</span> voices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
            engine<span class="token punctuation">.</span>say<span class="token punctuation">(</span>word<span class="token punctuation">)</span>
            engine<span class="token punctuation">.</span>save_to_file<span class="token punctuation">(</span>word<span class="token punctuation">,</span> output_path<span class="token punctuation">)</span>
            <span class="token comment"># print("language:","Chinese")</span>
            self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"Language: Chinese"</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 默认英文。</span>
            voices <span class="token operator">=</span> engine<span class="token punctuation">.</span>getProperty<span class="token punctuation">(</span><span class="token string">'voices'</span><span class="token punctuation">)</span>
            engine<span class="token punctuation">.</span>setProperty<span class="token punctuation">(</span><span class="token string">'voice'</span><span class="token punctuation">,</span> voices<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
            engine<span class="token punctuation">.</span>say<span class="token punctuation">(</span>word<span class="token punctuation">)</span>
            engine<span class="token punctuation">.</span>save_to_file<span class="token punctuation">(</span>word<span class="token punctuation">,</span> output_path<span class="token punctuation">)</span>
            <span class="token comment"># print("language:", "English")</span>
            self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"Language：English"</span><span class="token punctuation">)</span>
        engine<span class="token punctuation">.</span>runAndWait<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 发音保存</span>
    <span class="token keyword">def</span> <span class="token function">audio_save</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        word <span class="token operator">=</span> self<span class="token punctuation">.</span>detect_word_length<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> word<span class="token punctuation">:</span>
            word_save_folder <span class="token operator">=</span> self<span class="token punctuation">.</span>path<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> word
            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>word_save_folder<span class="token punctuation">)</span><span class="token punctuation">:</span>
                word_save_path <span class="token operator">=</span> word_save_folder <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> word <span class="token operator">+</span> <span class="token string">'.wav'</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>word_save_folder<span class="token punctuation">)</span>
                word_save_path <span class="token operator">=</span> word_save_folder <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> word <span class="token operator">+</span> <span class="token string">'.wav'</span>
        language <span class="token operator">=</span> self<span class="token punctuation">.</span>detect_languages<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> language<span class="token punctuation">:</span>
            <span class="token comment"># print(language)</span>
            <span class="token comment"># print(word,word_save_path,"English")</span>
            self<span class="token punctuation">.</span>word_to_audio<span class="token punctuation">(</span>word<span class="token punctuation">,</span> word_save_path<span class="token punctuation">,</span> language<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>

    <span class="token comment"># 定义输出文件</span>
    <span class="token keyword">def</span> <span class="token function">output_file_path</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 打开文件</span>
        <span class="token comment"># file_name=str(askopenfile())[25:-28]</span>
        <span class="token comment"># 选择文件夹</span>
        file_path <span class="token operator">=</span> askdirectory<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
        <span class="token comment"># print(file_path)</span>

    <span class="token comment"># 批量导入英文单词</span>
    <span class="token keyword">def</span> <span class="token function">batch_load</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        file_path <span class="token operator">=</span> askopenfilename<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>batch_file<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
        file_name <span class="token operator">=</span> self<span class="token punctuation">.</span>batch_file<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            content <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                word <span class="token operator">=</span> re<span class="token punctuation">.</span>match<span class="token punctuation">(</span><span class="token string">r'[A-Za-z0-9]*'</span><span class="token punctuation">,</span> content<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>words<span class="token punctuation">.</span>append<span class="token punctuation">(</span>word<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">finally</span><span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>words<span class="token punctuation">)</span>

    <span class="token comment"># 批量下载</span>
    <span class="token keyword">def</span> <span class="token function">batch_save</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>words<span class="token punctuation">:</span>
            <span class="token comment"># print('没有单词')</span>
            self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"没有单词！"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>path<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>prompt_statement<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'批量下载输出路径没有定义！'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">for</span> word <span class="token keyword">in</span> self<span class="token punctuation">.</span>words<span class="token punctuation">:</span>
            word_save_folder <span class="token operator">=</span> self<span class="token punctuation">.</span>path<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> word
            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>word_save_folder<span class="token punctuation">)</span><span class="token punctuation">:</span>
                word_save_path <span class="token operator">=</span> word_save_folder <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> word <span class="token operator">+</span> <span class="token string">'.wav'</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>word_save_folder<span class="token punctuation">)</span>
                word_save_path <span class="token operator">=</span> word_save_folder <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> word <span class="token operator">+</span> <span class="token string">'.wav'</span>
            self<span class="token punctuation">.</span>word_to_audio<span class="token punctuation">(</span>word<span class="token punctuation">,</span> word_save_path<span class="token punctuation">,</span> <span class="token string">'English'</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    painting<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6e9b442ce5d557632b3b05304385d1e4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue组件以及插槽</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5fda65e07e28c1916922cc212a512dc2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">计算电磁吐血整理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>