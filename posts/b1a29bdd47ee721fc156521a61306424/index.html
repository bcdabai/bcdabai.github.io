<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>突变点检测：Mann-Kendall突变点检测（python） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="突变点检测：Mann-Kendall突变点检测（python）" />
<meta property="og:description" content="不废话，直接上python代码
# Mann-Kendall突变点检测 # 数据序列y # 结果序列UF，UB #-------------------------------------------- import numpy as np import matplotlib.pyplot as plt plt.rcParams[&#39;font.sans-serif&#39;]=[&#39;SimHei&#39;] #用来正常显示中文标签 plt.rcParams[&#39;axes.unicode_minus&#39;]=False #用来正常显示负号 def Kendall_change_point_detection(inputdata): inputdata = np.array(inputdata) n=inputdata.shape[0] # 正序列计算--------------------------------- # 定义累计量序列Sk，初始值=0 Sk = [0] # 定义统计量UFk，初始值 =0 UFk = [0] # 定义Sk序列元素s，初始值 =0 s = 0 Exp_value = [0] Var_value = [0] # i从1开始，因为根据统计量UFk公式，i=0时，Sk(0)、E(0)、Var(0)均为0 # 此时UFk无意义，因此公式中，令UFk(0)=0 for i in range(1,n): for j in range(i): if inputdata[i] &gt; inputdata[j]: s = s&#43;1 else: s = s&#43;0 Sk." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b1a29bdd47ee721fc156521a61306424/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-08-24T13:52:44+08:00" />
<meta property="article:modified_time" content="2018-08-24T13:52:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">突变点检测：Mann-Kendall突变点检测（python）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>不废话，直接上python代码</p> 
<pre><code class="prism language-python"><span class="token comment"># Mann-Kendall突变点检测</span>
<span class="token comment"># 数据序列y</span>
<span class="token comment"># 结果序列UF，UB</span>
<span class="token comment">#--------------------------------------------</span>


<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt


plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span> <span class="token comment">#用来正常显示中文标签</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span> <span class="token comment">#用来正常显示负号</span>


<span class="token keyword">def</span> <span class="token function">Kendall_change_point_detection</span><span class="token punctuation">(</span>inputdata<span class="token punctuation">)</span><span class="token punctuation">:</span>
    inputdata <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>inputdata<span class="token punctuation">)</span>
    n<span class="token operator">=</span>inputdata<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token comment"># 正序列计算---------------------------------</span>
    <span class="token comment"># 定义累计量序列Sk，初始值=0</span>
    Sk             <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token comment"># 定义统计量UFk，初始值 =0</span>
    UFk            <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token comment"># 定义Sk序列元素s，初始值 =0</span>
    s              <span class="token operator">=</span>  <span class="token number">0</span>
    Exp_value      <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    Var_value      <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token comment"># i从1开始，因为根据统计量UFk公式，i=0时，Sk(0)、E(0)、Var(0)均为0</span>
    <span class="token comment"># 此时UFk无意义，因此公式中，令UFk(0)=0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> inputdata<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> inputdata<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>
                s <span class="token operator">=</span> s<span class="token operator">+</span><span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                s <span class="token operator">=</span> s<span class="token operator">+</span><span class="token number">0</span>
        Sk<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
        Exp_value<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">4</span> <span class="token punctuation">)</span>                     <span class="token comment"># Sk[i]的均值</span>
        Var_value<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>i<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">72</span> <span class="token punctuation">)</span>            <span class="token comment"># Sk[i]的方差</span>
        UFk<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>Sk<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>Exp_value<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>Var_value<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># ------------------------------正序列计算</span>
    <span class="token comment"># 逆序列计算---------------------------------</span>
    <span class="token comment"># 定义逆序累计量序列Sk2，长度与inputdata一致，初始值=0</span>
    Sk2             <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token comment"># 定义逆序统计量UBk，长度与inputdata一致，初始值=0</span>
    UBk             <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    UBk2            <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token comment"># s归0</span>
    s2              <span class="token operator">=</span>  <span class="token number">0</span>
    Exp_value2      <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    Var_value2      <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token comment"># 按时间序列逆转样本y</span>
    inputdataT <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">reversed</span><span class="token punctuation">(</span>inputdata<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># i从2开始，因为根据统计量UBk公式，i=1时，Sk2(1)、E(1)、Var(1)均为0</span>
    <span class="token comment"># 此时UBk无意义，因此公式中，令UBk(1)=0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> inputdataT<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> inputdataT<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>
                s2 <span class="token operator">=</span> s2<span class="token operator">+</span><span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                s2 <span class="token operator">=</span> s2<span class="token operator">+</span><span class="token number">0</span>
        Sk2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s2<span class="token punctuation">)</span>
        Exp_value2<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">4</span> <span class="token punctuation">)</span>                     <span class="token comment"># Sk[i]的均值</span>
        Var_value2<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>i<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">72</span> <span class="token punctuation">)</span>            <span class="token comment"># Sk[i]的方差</span>
        UBk<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>Sk2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>Exp_value2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>Var_value2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        UBk2<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token operator">-</span>UBk<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 由于对逆序序列的累计量Sk2的构建中，依然用的是累加法，即后者大于前者时s加1，</span>
    <span class="token comment"># 则s的大小表征了一种上升的趋势的大小，而序列逆序以后，应当表现出与原序列相反</span>
    <span class="token comment"># 的趋势表现，因此，用累加法统计Sk2序列，统计量公式(S(i)-E(i))/sqrt(Var(i))</span>
    <span class="token comment">#也不应改变，但统计量UBk应取相反数以表征正确的逆序序列的趋势</span>
    <span class="token comment">#  UBk(i)=0-(Sk2(i)-E)/sqrt(Var)</span>
    <span class="token comment"># ------------------------------逆序列计算</span>
    <span class="token comment"># 此时上一步的到UBk表现的是逆序列在逆序时间上的趋势统计量</span>
    <span class="token comment"># 与UFk做图寻找突变点时，2条曲线应具有同样的时间轴，因此</span>
    <span class="token comment"># 再按时间序列逆转结果统计量UBk，得到时间正序的UBkT，</span>
    UBkT <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">reversed</span><span class="token punctuation">(</span>UBk2<span class="token punctuation">)</span><span class="token punctuation">)</span>
    diff <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>UFk<span class="token punctuation">)</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>UBkT<span class="token punctuation">)</span>
    K    <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 找出交叉点</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> diff<span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>diff<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">:</span>
            K<span class="token punctuation">.</span>append<span class="token punctuation">(</span>k<span class="token punctuation">)</span>
    <span class="token comment"># 做突变检测图时，使用UFk和UBkT</span>
    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>UFk  <span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">'UFk'</span><span class="token punctuation">)</span> <span class="token comment"># UFk</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>UBkT <span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">'UBk'</span><span class="token punctuation">)</span> <span class="token comment"># UBk</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'UFk-UBk'</span><span class="token punctuation">)</span>
    x_lim <span class="token operator">=</span> plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x_lim<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.96</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1.96</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'m--'</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x_lim<span class="token punctuation">,</span><span class="token punctuation">[</span>  <span class="token number">0</span>  <span class="token punctuation">,</span>  <span class="token number">0</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'m--'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x_lim<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">+</span><span class="token number">1.96</span><span class="token punctuation">,</span><span class="token operator">+</span><span class="token number">1.96</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'m--'</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># 图例</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> K
</code></pre> 
<p>测试(下面对照了其他突变方法，下文讲)：</p> 
<pre><code class="prism language-python">dt <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">15.4</span><span class="token punctuation">,</span><span class="token number">14.6</span><span class="token punctuation">,</span><span class="token number">15.8</span><span class="token punctuation">,</span><span class="token number">14.8</span><span class="token punctuation">,</span><span class="token number">15.0</span><span class="token punctuation">,</span><span class="token number">15.1</span><span class="token punctuation">,</span><span class="token number">15.1</span><span class="token punctuation">,</span><span class="token number">15.0</span><span class="token punctuation">,</span><span class="token number">15.2</span><span class="token punctuation">,</span><span class="token number">15.4</span><span class="token punctuation">,</span>
      <span class="token number">14.8</span><span class="token punctuation">,</span><span class="token number">15.0</span><span class="token punctuation">,</span><span class="token number">15.1</span><span class="token punctuation">,</span><span class="token number">14.7</span><span class="token punctuation">,</span><span class="token number">16.0</span><span class="token punctuation">,</span><span class="token number">15.7</span><span class="token punctuation">,</span><span class="token number">15.4</span><span class="token punctuation">,</span><span class="token number">14.5</span><span class="token punctuation">,</span><span class="token number">15.1</span><span class="token punctuation">,</span><span class="token number">15.3</span><span class="token punctuation">,</span>
      <span class="token number">15.5</span><span class="token punctuation">,</span><span class="token number">15.1</span><span class="token punctuation">,</span><span class="token number">15.6</span><span class="token punctuation">,</span><span class="token number">15.1</span><span class="token punctuation">,</span><span class="token number">15.1</span><span class="token punctuation">,</span><span class="token number">14.9</span><span class="token punctuation">,</span><span class="token number">15.5</span><span class="token punctuation">,</span><span class="token number">15.3</span><span class="token punctuation">,</span><span class="token number">15.3</span><span class="token punctuation">,</span><span class="token number">15.4</span><span class="token punctuation">,</span>
      <span class="token number">15.7</span><span class="token punctuation">,</span><span class="token number">15.2</span><span class="token punctuation">,</span><span class="token number">15.5</span><span class="token punctuation">,</span><span class="token number">15.5</span><span class="token punctuation">,</span><span class="token number">15.6</span><span class="token punctuation">,</span><span class="token number">15.1</span><span class="token punctuation">,</span><span class="token number">15.1</span><span class="token punctuation">,</span><span class="token number">16.0</span><span class="token punctuation">,</span><span class="token number">16.0</span><span class="token punctuation">,</span><span class="token number">16.8</span><span class="token punctuation">,</span>
      <span class="token number">16.2</span><span class="token punctuation">,</span><span class="token number">16.2</span><span class="token punctuation">,</span><span class="token number">16.0</span><span class="token punctuation">,</span><span class="token number">15.6</span><span class="token punctuation">,</span><span class="token number">15.9</span><span class="token punctuation">,</span><span class="token number">16.2</span><span class="token punctuation">,</span><span class="token number">16.7</span><span class="token punctuation">,</span><span class="token number">15.8</span><span class="token punctuation">,</span><span class="token number">16.2</span><span class="token punctuation">,</span><span class="token number">15.9</span><span class="token punctuation">,</span>
      <span class="token number">15.8</span><span class="token punctuation">,</span><span class="token number">15.5</span><span class="token punctuation">,</span><span class="token number">15.9</span><span class="token punctuation">,</span><span class="token number">16.8</span><span class="token punctuation">,</span><span class="token number">15.5</span><span class="token punctuation">,</span><span class="token number">15.8</span><span class="token punctuation">,</span><span class="token number">15.0</span><span class="token punctuation">,</span><span class="token number">14.9</span><span class="token punctuation">,</span><span class="token number">15.3</span><span class="token punctuation">,</span><span class="token number">16.0</span><span class="token punctuation">,</span>
      <span class="token number">16.1</span><span class="token punctuation">,</span><span class="token number">16.5</span><span class="token punctuation">,</span><span class="token number">15.5</span><span class="token punctuation">,</span><span class="token number">15.6</span><span class="token punctuation">,</span><span class="token number">16.1</span><span class="token punctuation">,</span><span class="token number">15.6</span><span class="token punctuation">,</span><span class="token number">16.0</span><span class="token punctuation">,</span><span class="token number">15.4</span><span class="token punctuation">,</span><span class="token number">15.5</span><span class="token punctuation">,</span><span class="token number">15.2</span><span class="token punctuation">,</span>
      <span class="token number">15.4</span><span class="token punctuation">,</span><span class="token number">15.6</span><span class="token punctuation">,</span><span class="token number">15.1</span><span class="token punctuation">,</span><span class="token number">15.8</span><span class="token punctuation">,</span><span class="token number">15.5</span><span class="token punctuation">,</span><span class="token number">16.0</span><span class="token punctuation">,</span><span class="token number">15.2</span><span class="token punctuation">,</span><span class="token number">15.8</span><span class="token punctuation">,</span><span class="token number">16.2</span><span class="token punctuation">,</span><span class="token number">16.2</span><span class="token punctuation">,</span>
      <span class="token number">15.2</span><span class="token punctuation">,</span><span class="token number">15.7</span><span class="token punctuation">,</span><span class="token number">16.0</span><span class="token punctuation">,</span><span class="token number">16.0</span><span class="token punctuation">,</span><span class="token number">15.7</span><span class="token punctuation">,</span><span class="token number">15.9</span><span class="token punctuation">,</span><span class="token number">15.7</span><span class="token punctuation">,</span><span class="token number">16.7</span><span class="token punctuation">,</span><span class="token number">15.3</span><span class="token punctuation">,</span><span class="token number">16.1</span><span class="token punctuation">,</span><span class="token number">16.2</span><span class="token punctuation">]</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>dt<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>dt<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>dt<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'m--'</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>dt<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>dt<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'m--'</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>dt<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>dt<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'o--'</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'orange'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">68</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>dt<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">:</span><span class="token number">69</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>dt<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">:</span><span class="token number">69</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'o--'</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'orange'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>dt<span class="token punctuation">[</span><span class="token number">70</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>dt<span class="token punctuation">[</span><span class="token number">70</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'o--'</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'orange'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Mann-Kendall:"</span><span class="token punctuation">,</span>Kendall_change_point_detection<span class="token punctuation">(</span>dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Pettitt:"</span><span class="token punctuation">,</span>Pettitt_change_point_detection<span class="token punctuation">(</span>dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Buishand U Test:"</span><span class="token punctuation">,</span>Buishand_U_change_point_detection<span class="token punctuation">(</span>dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Standard Normal Homogeneity Test (SNHT):"</span><span class="token punctuation">,</span>SNHT_change_point_detection<span class="token punctuation">(</span>dt<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c7/59/G2zMZNM1_o.jpg" alt="这里写图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/968e1c40b31413194e3e77e2752148da/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【My SQL】常见语句</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cc99a5dd631ee2a81714f034aa612520/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Mongo】mongo更新字段为另一字段的值</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>