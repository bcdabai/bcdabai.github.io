<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>windows socket网络编程一：最简单的服务器和客户端搭建 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="windows socket网络编程一：最简单的服务器和客户端搭建" />
<meta property="og:description" content="文章目录 简介服务器网络版本1、打开网络库2、校验版本3、创建socket4、绑定地址和端口5、监听6、接受链接7、与客户端收发消息 客户端1、打开网络库2、校验版本3、创建socket4、连接服务器5、与客户端收发消息类比 运行结果源码链接遇到的问题头文件冲突 简介 socket又是什么？
将网络底层复杂的协议体系，执行流程，进行了封装后就是SOCKET了，也就是说，SOCKET是我们调用协议进行通信的操作接口，将复杂的协议过程与我们编程人员分开，我们直接操作一个简单SOCKET就行了，对于底层的协议 过程细节，我们可以完全不用知道。
在编译器转定义后就是一个unsigned int，目测当作id使用。
最简单的客户端、服务器通信流程大致如下：
收发信息可以进行很多次。
服务器 网络版本 我们使用新版本第二版
网络版本一：
#include &lt;winsock.h&gt; #pragma comment(lib, &#34;wsock32.lib&#34;) 网络版本二：
#include &lt;WinSock2.h&gt; #pragma comment(lib, &#34;ws2_32.lib&#34;) 注：不管是64编译环境还是32编译环境，都是用这个ws2_32.lib，并没有ws2_64.lib。
1、打开网络库 int WSAAPI WSAStartup( WORD wVersionRequested, LPWSADATA lpWSAData ); 功能：打开网络库/启动网络库（函数名字分析W—windows、S—socket、A—Asynchronous 异步）
参数：
wVersionRequested — 调用者可以使用的Windows套接字规范的最高版本。高位字节指定次版本号；低位字节指定主版本号。（支持版本：1.0、1.1、2.0、2.1、2.2）lpWSAData — 接收Windows套接字实现的详细信息。struct WSAData { WORD wVersion;	// 我们要使用的版本 WORD wHighVersion;	// 系统能提供给我们最高的版本 unsigned short iMaxSockets;	// 返回可用的socket的数量，二版本之后就没用了 unsigned short iMaxUdpDg;	// UDP数据报信息的大小，2版本之后就没用了 char *lpVendorInfo;	// 供应商特定的信息，2版本之后就没用了 char szDescription[WSADESCRIPTION_LEN &#43; 1];	// 当前库的描述信息 char szSystemStatus[WSASYS_STATUS_LEN &#43; 1]; } 程序调试截图：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/475527cd525d3bff752055f32ed83e88/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-03T22:07:13+08:00" />
<meta property="article:modified_time" content="2021-01-03T22:07:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">windows socket网络编程一：最简单的服务器和客户端搭建</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">简介</a></li><li><a href="#_10" rel="nofollow">服务器</a></li><li><ul><li><a href="#_11" rel="nofollow">网络版本</a></li><li><a href="#1_26" rel="nofollow">1、打开网络库</a></li><li><a href="#2_93" rel="nofollow">2、校验版本</a></li><li><a href="#3socket_105" rel="nofollow">3、创建socket</a></li><li><a href="#4_160" rel="nofollow">4、绑定地址和端口</a></li><li><a href="#5_224" rel="nofollow">5、监听</a></li><li><a href="#6_257" rel="nofollow">6、接受链接</a></li><li><a href="#7_293" rel="nofollow">7、与客户端收发消息</a></li></ul> 
  </li><li><a href="#_382" rel="nofollow">客户端</a></li><li><ul><li><a href="#1_383" rel="nofollow">1、打开网络库</a></li><li><a href="#2_386" rel="nofollow">2、校验版本</a></li><li><a href="#3socket_389" rel="nofollow">3、创建socket</a></li><li><a href="#4_392" rel="nofollow">4、连接服务器</a></li><li><a href="#5_426" rel="nofollow">5、与客户端收发消息</a></li><li><a href="#_429" rel="nofollow">类比</a></li></ul> 
  </li><li><a href="#_439" rel="nofollow">运行结果</a></li><li><a href="#_442" rel="nofollow">源码链接</a></li><li><a href="#_446" rel="nofollow">遇到的问题</a></li><li><ul><li><a href="#_447" rel="nofollow">头文件冲突</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>简介</h2> 
<p>socket又是什么？<br> 将网络底层复杂的协议体系，执行流程，进行了封装后就是SOCKET了，也就是说，<strong>SOCKET是我们调用协议进行通信的操作接口</strong>，将复杂的协议过程与我们编程人员分开，我们直接操作一个简单SOCKET就行了，对于底层的协议 过程细节，我们可以完全不用知道。<br> 在编译器转定义后就是一个<code>unsigned int</code>，目测当作id使用。</p> 
<p>最简单的客户端、服务器通信流程大致如下：<br> <img src="https://images2.imgbox.com/4a/b5/WcwEDNfY_o.png" alt="在这里插入图片描述"><br> 收发信息可以进行很多次。</p> 
<h2><a id="_10"></a>服务器</h2> 
<h3><a id="_11"></a>网络版本</h3> 
<blockquote> 
 <p>我们使用新版本第二版</p> 
</blockquote> 
<p>网络版本一：</p> 
<pre><code class="prism language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;winsock.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">pragma</span> comment(lib, "wsock32.lib")</span>
</code></pre> 
<p>网络版本二：</p> 
<pre><code class="prism language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;WinSock2.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">pragma</span> comment(lib, "ws2_32.lib")</span>
</code></pre> 
<p>注：不管是64编译环境还是32编译环境，都是用这个<code>ws2_32.lib</code>，并没有<code>ws2_64.lib</code>。</p> 
<h3><a id="1_26"></a>1、打开网络库</h3> 
<pre><code class="prism language-c"><span class="token keyword">int</span> WSAAPI <span class="token function">WSAStartup</span><span class="token punctuation">(</span>
  WORD      wVersionRequested<span class="token punctuation">,</span>
  LPWSADATA lpWSAData
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>功能：打开网络库/启动网络库（函数名字分析W—windows、S—socket、A—Asynchronous 异步）<br> 参数：</p> 
<ul><li>wVersionRequested — 调用者可以使用的Windows套接字规范的最高版本。高位字节指定次版本号；低位字节指定主版本号。（支持版本：1.0、1.1、2.0、2.1、2.2）</li><li>lpWSAData — 接收Windows套接字实现的详细信息。<pre><code class="prism language-c"><span class="token keyword">struct</span> WSAData <span class="token punctuation">{<!-- --></span>
  WORD           wVersion<span class="token punctuation">;</span>		<span class="token comment">// 我们要使用的版本</span>
  WORD           wHighVersion<span class="token punctuation">;</span>	<span class="token comment">// 系统能提供给我们最高的版本</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">short</span> iMaxSockets<span class="token punctuation">;</span>	<span class="token comment">// 返回可用的socket的数量，二版本之后就没用了</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">short</span> iMaxUdpDg<span class="token punctuation">;</span>		<span class="token comment">// UDP数据报信息的大小，2版本之后就没用了</span>
  <span class="token keyword">char</span>           <span class="token operator">*</span>lpVendorInfo<span class="token punctuation">;</span>	<span class="token comment">// 供应商特定的信息，2版本之后就没用了</span>
  <span class="token keyword">char</span>           szDescription<span class="token punctuation">[</span>WSADESCRIPTION_LEN <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>	<span class="token comment">// 当前库的描述信息</span>
  <span class="token keyword">char</span>           szSystemStatus<span class="token punctuation">[</span>WSASYS_STATUS_LEN <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> 
</code></pre> 程序调试截图：<br> <img src="https://images2.imgbox.com/5d/77/3kAFo3vQ_o.png" alt="在这里插入图片描述"></li></ul> 
<p>返回值：</p> 
<ul><li>如果成功，返回零。</li><li>如果失败，返回错误码。 
  <table><thead><tr><th>错误码</th><th>宏展开</th><th>直翻原因</th><th>通俗解释原因</th></tr></thead><tbody><tr><td>WSASYSNOTREADY</td><td>10091</td><td>底层网络子系统尚未准备好进行网络通信</td><td>系统配置问题，重启下电脑，检查ws2_32库是否存在，或者是否在环境配置目录下</td></tr><tr><td>WSAVERNOTSUPPORTED</td><td>10092</td><td>此特定Windows套接字实现不提供所请求的Windows套接字支持的版本。</td><td>要使用的版本不支持</td></tr><tr><td>WSAEPROCLIM</td><td>10067</td><td>已达到对Windows套接字实现支持的任务数量的限制</td><td>Windows Sockets实现可能限制同时使用它的应用程序的数量</td></tr><tr><td>WSAEINPROGRESS</td><td>10036</td><td>正在阻止Windows Sockets 1.1操作。</td><td>当前函数运行期间，由于某些原因造成阻塞，会返回在这个错误码，其他操作均禁止</td></tr><tr><td>WSAEFAULT</td><td>10014</td><td>lpWSAData参数不是有效指针</td><td>参数写错了</td></tr></tbody></table> </li></ul> 
<p>代码（错误处理就简单点了）：</p> 
<pre><code class="prism language-c"><span class="token comment">// 开启网络库</span>
WORD wVersionRequird <span class="token operator">=</span> <span class="token function">MAKEWORD</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// MAKEWORD(主版本,副版本)</span>
WSADATA wdScokMsg<span class="token punctuation">;</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token function">WSAStartup</span><span class="token punctuation">(</span>wVersionRequird<span class="token punctuation">,</span> <span class="token operator">&amp;</span>wdScokMsg<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">case</span> WSASYSNOTREADY<span class="token punctuation">:</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"重启电脑试试，或者检查网络库\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">case</span> WSAVERNOTSUPPORTED<span class="token punctuation">:</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请更新网络库\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">case</span> WSAEPROCLIM<span class="token punctuation">:</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请尝试关掉不必要的软件，以为当前网络运行提供充足的资源\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">case</span> WSAEINPROGRESS<span class="token punctuation">:</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请重新启动\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>虽然我们有正确的代码，但是我们也可以测试一下不正确的版本号会发生什么：</p> 
<table><thead><tr><th>错误版本号</th><th>问题</th></tr></thead><tbody><tr><td>主版本号为0</td><td>返回错误码WSAVERNOTSUPPORTED，不支持该版本</td></tr><tr><td>有对应的主版本，没有对应的副版本</td><td>没问题，得到该主版本的最大副版本 1.1 2.2并使用</td></tr><tr><td>超过最大主版本</td><td>没问题，使用系统能提供的最大的版本 2.2</td></tr></tbody></table> 
<h3><a id="2_93"></a>2、校验版本</h3> 
<p>这一步也许不是必须的，不过网络版本还是比较重要的，需要确定。</p> 
<pre><code class="prism language-c"><span class="token comment">// 校验版本</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">!=</span> <span class="token function">HIBYTE</span><span class="token punctuation">(</span>wdScokMsg<span class="token punctuation">.</span>wVersion<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token function">LOBYTE</span><span class="token punctuation">(</span>wdScokMsg<span class="token punctuation">.</span>wVersion<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"版本不存在\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">WSACleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="3socket_105"></a>3、创建socket</h3> 
<pre><code class="prism language-c">SOCKET WSAAPI <span class="token function">socket</span><span class="token punctuation">(</span>
  <span class="token keyword">int</span> af<span class="token punctuation">,</span>
  <span class="token keyword">int</span> type<span class="token punctuation">,</span>
  <span class="token keyword">int</span> protocol
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>功能：创建一个SOCKET<br> 参数：</p> 
<ul><li>af — 地址族 
  <table><thead><tr><th>常用地址族</th><th>宏展开</th><th>含义</th></tr></thead><tbody><tr><td>AF_INET</td><td>2</td><td>IPv4</td></tr><tr><td>AF_INET6</td><td>23</td><td>IPv6</td></tr><tr><td>AF_IRDA</td><td>26</td><td>红外</td></tr><tr><td>AF_BTH</td><td>32</td><td>蓝牙</td></tr></tbody></table> </li><li>type — 套接字类型 
  <table><thead><tr><th>套接字类型</th><th>宏展开</th><th>含义</th></tr></thead><tbody><tr><td>SOCK_STREAM</td><td>1</td><td>一种套接字类型，提供带有OOB数据传输机制的顺序，可靠，双向，基于连接的字节流。 此套接字类型使用传输控制协议（TCP）作为Internet地址系列（AF_INET或AF_INET6）。</td></tr><tr><td>SOCK_DGRAM</td><td>2</td><td>一种支持数据报的套接字类型，它是固定（通常很小）最大长度的无连接，不可靠的缓冲区。 此套接字类型使用用户数据报协议（UDP）作为Internet地址系列（AF_INET或AF_INET6）。</td></tr><tr><td>SOCK_RAW</td><td>3</td><td>一种套接字类型，提供允许应用程序操作下一个上层协议头的原始套接字。 要操作IPv4标头，必须在套接字上设置IP_HDRINCL套接字选项。 要操作IPv6标头，必须在套接字上设置IPV6_HDRINCL套接字选项。</td></tr><tr><td>SOCK_RDM</td><td>4</td><td>一种套接字类型，提供可靠的消息数据报。 这种类型的一个示例是Windows中的实用通用多播（PGM）多播协议实现，通常称为可靠多播节目。仅在安装了可靠多播协议时才支持此类型值。</td></tr><tr><td>SOCK_SEQPACKET</td><td>5</td><td>一种套接字类型，提供基于数据报的伪流数据包。</td></tr></tbody></table> </li><li>protocol — 协议类型 
  <table><thead><tr><th>协议类型</th><th>含义</th></tr></thead><tbody><tr><td>IPPROTO_TCP</td><td>传输控制协议（TCP）。 当af参数为AF_INET或AF_INET6且类型参数为SOCK_STREAM时，这是一个可能的值。</td></tr><tr><td>IPPROTO_UDP</td><td>用户数据报协议（UDP）。 当af参数为AF_INET或AF_INET6且类型参数为SOCK_DGRAM时，这是一个可能的值。</td></tr><tr><td>IPPROTO_ICMP</td><td>Internet控制消息协议（ICMP）。 当af参数为AF_UNSPEC，AF_INET或AF_INET6且类型参数为SOCK_RAW或未指定时，这是一个可能的值。</td></tr><tr><td>IPPROTO_IGMP</td><td>Internet组管理协议（IGMP）。 当af参数为AF_UNSPEC，AF_INET或AF_INET6且类型参数为SOCK_RAW或未指定时，这是一个可能的值。</td></tr><tr><td>IPPROTO_RM</td><td>用于可靠多播的PGM协议。 当af参数为AF_INET且类型参数为SOCK_RDM时，这是一个可能的值。 在针对Windows Vista及更高版本发布的Windows SDK上，此协议也称为IPPROTO_PGM。仅在安装了可靠多播协议时才支持此协议值。</td></tr><tr><td>0</td><td>调用者不希望指定协议，服务提供商将选择要使用的协议。</td></tr></tbody></table> </li></ul> 
<p>通过上面对参数的描述来看我们三个参数需要配合使用，比如说我们使用tcp通信需要基于字节流，而不是数据包，不能乱用。</p> 
<p>返回值：</p> 
<ul><li>如果成功，返回socket。</li><li>如果失败，返回INVALID_SOCKET。</li></ul> 
<p>代码：</p> 
<pre><code class="prism language-c"><span class="token comment">// 创建服务器socket（监听套接字）</span>
SOCKET socketServer <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> SOCK_STREAM<span class="token punctuation">,</span> IPPROTO_TCP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>INVALID_SOCKET <span class="token operator">==</span> socketServer<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"创建socket失败 error:%d\n"</span><span class="token punctuation">,</span> <span class="token function">WSAGetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">WSACleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>我们测试一下基于数据包的tcp（<code>SOCKET socketServer = socket(AF_INET, SOCK_DGRAM, IPPROTO_TCP);</code>）会有什么问题：<br> <img src="https://images2.imgbox.com/b8/02/iGLe5H0M_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/07/79/xmX5e2to_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_160"></a>4、绑定地址和端口</h3> 
<pre><code class="prism language-c"><span class="token keyword">int</span> WSAAPI <span class="token function">bind</span><span class="token punctuation">(</span>
  SOCKET         s<span class="token punctuation">,</span>
  <span class="token keyword">const</span> sockaddr <span class="token operator">*</span>name<span class="token punctuation">,</span>
  <span class="token keyword">int</span>            namelen
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>功能：给socket绑定具体地址（定位到电脑）与端口号（定位到具体应用）<br> 参数：</p> 
<ul><li>s — socket</li><li>name — 地址和端口<pre><code class="prism language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> sockaddr <span class="token punctuation">{<!-- --></span>
<span class="token macro property">#<span class="token directive keyword">if</span> (_WIN32_WINNT &lt; 0x0600)</span>
    u_short sa_family<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
    ADDRESS_FAMILY sa_family<span class="token punctuation">;</span>           <span class="token comment">// Address family.</span>
<span class="token macro property">#<span class="token directive keyword">endif</span> </span><span class="token comment">//(_WIN32_WINNT &lt; 0x0600)</span>
    CHAR sa_data<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                   <span class="token comment">// Up to 14 bytes of direct address.</span>
<span class="token punctuation">}</span> SOCKADDR<span class="token punctuation">,</span> <span class="token operator">*</span>PSOCKADDR<span class="token punctuation">,</span> FAR <span class="token operator">*</span>LPSOCKADDR<span class="token punctuation">;</span>

<span class="token comment">// 和sockaddr相同 便于我们赋值</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> sockaddr_in <span class="token punctuation">{<!-- --></span>
<span class="token macro property">#<span class="token directive keyword">if</span>(_WIN32_WINNT &lt; 0x0600)</span>
    <span class="token keyword">short</span>   sin_family<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">else</span> </span><span class="token comment">//(_WIN32_WINNT &lt; 0x0600)</span>
    ADDRESS_FAMILY sin_family<span class="token punctuation">;</span>	<span class="token comment">// 地址族</span>
<span class="token macro property">#<span class="token directive keyword">endif</span> </span><span class="token comment">//(_WIN32_WINNT &lt; 0x0600)</span>
    USHORT sin_port<span class="token punctuation">;</span>	<span class="token comment">// 端口</span>
    IN_ADDR sin_addr<span class="token punctuation">;</span>	<span class="token comment">// 地址</span>
    CHAR sin_zero<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> SOCKADDR_IN<span class="token punctuation">,</span> <span class="token operator">*</span>PSOCKADDR_IN<span class="token punctuation">;</span>
</code></pre> </li><li>namelen — 参数二的大小</li></ul> 
<p>其中端口号理论上取值范围0~65535。实际上介于0～1023，为系统保留占用端口号，（如：21端口分配给FTP(文件传输协议)服务、25端口分配给SMTP（简单邮件传输协议）服务、80端口分配给HTTP服务）所以我们使用其他的端口号。<br> 因为同一个端口号不能同时被两个程序使用，万一我们想要的端口号被占用了，想知道是什么程序占用的，可以使用cmd查看：</p> 
<ul><li>打开运行cmd输入netstat -ano，查看被使用的所有端口</li><li>netstat -aon | findstr “12345”，检查我们要使用的端口号是否被使用了</li></ul> 
<p>返回值：</p> 
<ul><li>如果成功，返回0。</li><li>如果失败，返回SOCKET_ERROR。</li></ul> 
<p>代码：</p> 
<pre><code class="prism language-c"><span class="token comment">// 绑定地址</span>
SOCKADDR_IN sockAddress<span class="token punctuation">;</span>
sockAddress<span class="token punctuation">.</span>sin_family <span class="token operator">=</span> AF_INET<span class="token punctuation">;</span>
sockAddress<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> <span class="token function">inet_addr</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// INADDR_ANY --- 任何地址都可以</span>
sockAddress<span class="token punctuation">.</span>sin_port <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span><span class="token number">6666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>SOCKET_ERROR <span class="token operator">==</span> <span class="token function">bind</span><span class="token punctuation">(</span>socketServer<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>sockAddress<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>sockAddress<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"bind 失败 error:%d\n"</span><span class="token punctuation">,</span> <span class="token function">WSAGetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">closesocket</span><span class="token punctuation">(</span>socketServer<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">WSACleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>我们测试一下已经被占用的端口：<br> <img src="https://images2.imgbox.com/c6/1b/nZnvN9Hc_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/0c/4b/nUnZmjcH_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5_224"></a>5、监听</h3> 
<pre><code class="prism language-c"><span class="token keyword">int</span> WSAAPI <span class="token function">listen</span><span class="token punctuation">(</span>
  SOCKET s<span class="token punctuation">,</span>
  <span class="token keyword">int</span>    backlog
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>功能：将套接字置于正在侦听传入连接的状态<br> 参数：</p> 
<ul><li>s — socket</li><li>backlog — 挂起的连接队列的最大长度。如果设置为SOMAXCONN，则负责套接字s的基础服务提供商将积压设置为最大合理值。</li></ul> 
<p>返回值：</p> 
<ul><li>如果成功，返回0。</li><li>如果失败，返回SOCKET_ERROR。</li></ul> 
<p>代码：</p> 
<pre><code class="prism language-c"><span class="token comment">// 开始监听</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>SOCKET_ERROR <span class="token operator">==</span> <span class="token function">listen</span><span class="token punctuation">(</span>socketServer<span class="token punctuation">,</span> SOMAXCONN<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"listen 失败 error:%d\n"</span><span class="token punctuation">,</span> <span class="token function">WSAGetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">closesocket</span><span class="token punctuation">(</span>socketServer<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">WSACleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>我们测试一下未bind的情况：<br> <img src="https://images2.imgbox.com/d1/48/Bt9SxMHB_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/fd/e6/CbpZbvkv_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="6_257"></a>6、接受链接</h3> 
<pre><code class="prism language-c">SOCKET WSAAPI <span class="token function">accept</span><span class="token punctuation">(</span>
  SOCKET   s<span class="token punctuation">,</span>
  sockaddr <span class="token operator">*</span>addr<span class="token punctuation">,</span>
  <span class="token keyword">int</span>      <span class="token operator">*</span>addrlen
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>作用：允许在套接字上进行传入连接尝试。listen监听客户端来的链接，accept将客户端的信息绑定到一个socket上，也就是给客户端创建一个socket,通过返回值返回给我们客户端的socket。（一次只能创建一个，有几个客户端链接，就要调用几次。）<br> 参数：</p> 
<ul><li>s — socket</li><li>addr — 客户端地址和端口</li><li>addrlen — 参数二的大小</li></ul> 
<p>注：如果参数二和参数三都填NULL，那就不是直接得不到客户端信息。可以通过函数得到客户端信息<code>getpeername(newSocket, (struct sockaddr*)&amp;sockClient, &amp;nLen);</code>。对应的得到本地服务器信息<code>getsockname(sSocket, (sockaddr*)&amp;addr, &amp;nLen);</code>。</p> 
<p>返回值：</p> 
<ul><li>如果成功，返回客户端socket。</li><li>如果失败，返回INVALID_SOCKET。</li></ul> 
<p>代码：</p> 
<pre><code class="prism language-c"><span class="token comment">// 接受链接</span>
SOCKADDR_IN sockClient<span class="token punctuation">;</span>
<span class="token keyword">int</span> nLen <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>sockClient<span class="token punctuation">)</span><span class="token punctuation">;</span>
SOCKET socketClient <span class="token operator">=</span> <span class="token function">accept</span><span class="token punctuation">(</span>socketServer<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>sockClient<span class="token punctuation">,</span> <span class="token operator">&amp;</span>nLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>INVALID_SOCKET <span class="token operator">==</span> socketClient<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"accept 失败 error:%d\n"</span><span class="token punctuation">,</span> <span class="token function">WSAGetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">closesocket</span><span class="token punctuation">(</span>socketServer<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">WSACleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"客户端连接成功\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="7_293"></a>7、与客户端收发消息</h3> 
<pre><code class="prism language-c"><span class="token keyword">int</span> WSAAPI <span class="token function">recv</span><span class="token punctuation">(</span>
  SOCKET s<span class="token punctuation">,</span>
  <span class="token keyword">char</span>   <span class="token operator">*</span>buf<span class="token punctuation">,</span>
  <span class="token keyword">int</span>    len<span class="token punctuation">,</span>
  <span class="token keyword">int</span>    flags
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>功能：得到指定目标（参数1）发来的消息<br> 参数：</p> 
<ul><li>s — socket</li><li>buf — 消息数据的存储空间（网络传输得最大单元MTU为1500字节，也就是客户端发过来得数据，一次最大就是1500字节，当然可以减去报文的40字节，这是协议规定，这个数值也是根据很多情况，总结出来得最优值。）</li><li>len — buf参数指向的缓冲区的长度（以字节为单位）</li><li>flags — 数据的读取方式 
  <table><thead><tr><th>值</th><th>含义</th></tr></thead><tbody><tr><td>MSG_PEEK</td><td>窥视传入的数据。 数据将复制到缓冲区中，但不会从输入队列中删除。</td></tr><tr><td>MSG_OOB</td><td>处理带外（OOB）数据。就是传输一段数据，在外带一个额外的特殊数据。不建议被使用，实在不行send两次。</td></tr><tr><td>MSG_WAITALL</td><td>当满足事件之一（调用方提供的缓冲区已满、连接已关闭、该请求已被取消或发生错误）就读取数据，并从输入队列中删除。</td></tr><tr><td>0</td><td>有数据就读取数据，并从输入队列中删除。</td></tr></tbody></table> </li></ul> 
<p>返回值：</p> 
<ul><li>如果成功，返回接收到的字节数。</li><li>如果已正常关闭连接，返回值为零。</li><li>如果失败，返回SOCKET_ERROR。</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">int</span> WSAAPI <span class="token function">send</span><span class="token punctuation">(</span>
  SOCKET     s<span class="token punctuation">,</span>
  <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span>
  <span class="token keyword">int</span>        len<span class="token punctuation">,</span>
  <span class="token keyword">int</span>        flags
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>功能：向目标发送数据<br> 参数：</p> 
<ul><li>s — socket</li><li>buf — 要发送的数据</li><li>len — buf参数指向的缓冲区的长度（以字节为单位）</li><li>flags — 数据的发送方式 
  <table><thead><tr><th>值</th><th>含义</th></tr></thead><tbody><tr><td>MSG_OOB</td><td>与上面对应处理带外（OOB）数据。</td></tr><tr><td>MSG_DONTROUTE</td><td>指定数据不应受路由限制。 Windows套接字服务提供程序可以选择忽略此标志。</td></tr><tr><td>0</td><td>正常发送</td></tr></tbody></table> </li></ul> 
<p>返回值：</p> 
<ul><li>如果成功，返回已发送的字节数。</li><li>如果失败，返回SOCKET_ERROR。</li></ul> 
<p>代码：</p> 
<pre><code class="prism language-c"><span class="token comment">// 与客户端收发消息</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 缓冲区</span>
	<span class="token keyword">char</span> szRecvBuffer<span class="token punctuation">[</span><span class="token number">1500</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> szSendBuffer<span class="token punctuation">[</span><span class="token number">1500</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token function">recv</span><span class="token punctuation">(</span>socketClient<span class="token punctuation">,</span> szRecvBuffer<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>szRecvBuffer<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> result<span class="token punctuation">)</span>	<span class="token comment">// 客户端正常关闭</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"客户端正常下线\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>	<span class="token comment">// 因为这个例子只接受一次客户端请求所以服务器关闭</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>SOCKET_ERROR <span class="token operator">==</span> result<span class="token punctuation">)</span>	<span class="token comment">// recv出错</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"recv 失败 error:%d\n"</span><span class="token punctuation">,</span> <span class="token function">WSAGetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>	<span class="token comment">// 给客户端发消息</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 接收到客户端消息 </span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Client Data : %s \n"</span><span class="token punctuation">,</span> szRecvBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 给客户回信</span>
		<span class="token function">scanf_s</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> szSendBuffer<span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>SOCKET_ERROR <span class="token operator">==</span> <span class="token function">send</span><span class="token punctuation">(</span>socketClient<span class="token punctuation">,</span> szSendBuffer<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>szSendBuffer<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"send 失败 error:%d\n"</span><span class="token punctuation">,</span> <span class="token function">WSAGetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_382"></a>客户端</h2> 
<h3><a id="1_383"></a>1、打开网络库</h3> 
<p>与服务器类似</p> 
<h3><a id="2_386"></a>2、校验版本</h3> 
<p>与服务器类似</p> 
<h3><a id="3socket_389"></a>3、创建socket</h3> 
<p>与服务器类似</p> 
<h3><a id="4_392"></a>4、连接服务器</h3> 
<pre><code class="prism language-c"><span class="token keyword">int</span> WSAAPI <span class="token function">connect</span><span class="token punctuation">(</span>
  SOCKET         s<span class="token punctuation">,</span>
  <span class="token keyword">const</span> sockaddr <span class="token operator">*</span>name<span class="token punctuation">,</span>
  <span class="token keyword">int</span>            namelen
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>功能：连接服务器<br> 参数：</p> 
<ul><li>s — socket</li><li>name — 服务器ip地址端口号结构体</li><li>namelen — 参数二的大小</li></ul> 
<p>返回值：</p> 
<ul><li>如果成功，返回0。</li><li>如果失败，返回SOCKET_ERROR。</li></ul> 
<p>代码：</p> 
<pre><code class="prism language-c"><span class="token comment">// 连接服务器</span>
SOCKADDR_IN sockAddress<span class="token punctuation">;</span>
sockAddress<span class="token punctuation">.</span>sin_family <span class="token operator">=</span> AF_INET<span class="token punctuation">;</span>
sockAddress<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> <span class="token function">inet_addr</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sockAddress<span class="token punctuation">.</span>sin_port <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span><span class="token number">6666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>SOCKET_ERROR <span class="token operator">==</span> <span class="token function">connect</span><span class="token punctuation">(</span>socketClient<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>sockAddress<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>sockAddress<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"connect 失败 error:%d\n"</span><span class="token punctuation">,</span> <span class="token function">WSAGetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">closesocket</span><span class="token punctuation">(</span>socketClient<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">WSACleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="5_426"></a>5、与客户端收发消息</h3> 
<p>与服务器类似</p> 
<h3><a id="_429"></a>类比</h3> 
<p>我们可以把操作socket类比于操作file：</p> 
<table><thead><tr><th>socket</th><th>文件</th></tr></thead><tbody><tr><td>建立socket socket</td><td>声明File*</td></tr><tr><td>连接服务器 connect</td><td>打开文件fopen</td></tr><tr><td>向服务器发送数据 send</td><td>写文件fwrite</td></tr><tr><td>接收服务器数据 recv</td><td>读文件fread</td></tr><tr><td>关闭socket closesocket</td><td>关闭文件fclose</td></tr></tbody></table> 
<h2><a id="_439"></a>运行结果</h2> 
<p><img src="https://images2.imgbox.com/cf/5c/uIBEUqVk_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_442"></a>源码链接</h2> 
<p>百度云链接：https://pan.baidu.com/s/1xBOiSADlAG2gO1TC6BBO_A<br> 提取码：sxbd</p> 
<h2><a id="_446"></a>遇到的问题</h2> 
<h3><a id="_447"></a>头文件冲突</h3> 
<p>代码：</p> 
<pre><code class="prism language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;Windows.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;WinSock2.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>报错：<br> <img src="https://images2.imgbox.com/d5/b2/ToFU337o_o.png" alt="在这里插入图片描述"><br> 解决方法：</p> 
<ol><li>交换<code>#include &lt;WinSock2.h&gt;</code>写在<code>#include &lt;Windows.h&gt;</code>上方</li><li>在头文件上方添加宏<code>#define WIN32_LEAN_AND_MEAN</code></li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/548a790465eef8aaf5800eae2eb679ee/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">农作物管理系统（openlayers、python、django）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7ea4388864a409d95570e64a67e90f85/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">小苗快速培养盆景苗方法_紫薇树怎么种植？紫薇树的种植技术与养护方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>