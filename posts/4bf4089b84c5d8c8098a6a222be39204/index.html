<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Vue.js 生产打包上线实战 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Vue.js 生产打包上线实战" />
<meta property="og:description" content="项目管理后台采用Vue.js 架构，开发完毕后设计到打包上传到服务器发布。
发布成功后，总结出主要要决绝两个主要问题：
1.打包前，环境设置
2.上传到服务器，直接放在Tomcat中出现跨域访问问题。
此次项目实际处理方法为：
一、打包
有人说需要再config文件夹中index.js中 所以
assetsPublicPath: &#39;/&#39;, 改为
assetsPublicPath: &#39;./&#39;,
其实这是不需要的，因为生产环境打包时，这里根本不会包含进入，这里只用于本地开发环境，vue.js本地产生的服务用于跨域转发，解决跨域访问产生的问题。
module.exports = { dev: { // Paths assetsSubDirectory: &#39;static&#39;, assetsPublicPath: &#39;/&#39;, proxyTable: { &#39;/zpin/*&#39;:{ // 本地开发环境设置 // target:&#39;http://localhost:8081&#39;, // 本地开发环境连接服务器生产环境 target:&#39;http://www.yi********.com:8081&#39;, changeOrigin:true, pathRewrite:{ &#39;^/zpin&#39;: &#39;/zpin&#39; } } }, 包括在build 文件中的 uils.js 中 添加 if (options.extract) { return ExtractTextPlugin.extract({ use: loaders, // 这里是不需要添加的，除非你对默认目录做了大的修改 // publicPath:&#39;../../&#39;, fallback: &#39;vue-style-loader&#39; }) } 如果你在最后和跨域问题一并解决后，其实只需要更改一处，就是修改axios库的baseurl地址即可，我的设置文件是这样的 let base = &#39;&#39;//本地测试环境 let base = &#39;http://besu." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/4bf4089b84c5d8c8098a6a222be39204/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-11T09:57:11+08:00" />
<meta property="article:modified_time" content="2023-03-11T09:57:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Vue.js 生产打包上线实战</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>项目管理后台采用Vue.js 架构，开发完毕后设计到打包上传到服务器发布。</p> 
<p>发布成功后，总结出主要要决绝两个主要问题：</p> 
<p>1.打包前，环境设置</p> 
<p>2.上传到服务器，直接放在Tomcat中出现跨域访问问题。</p> 
<p>此次项目实际处理方法为：</p> 
<p>一、打包</p> 
<p>有人说需要再config文件夹中index.js中 所以</p> 
<p>assetsPublicPath: '/', 改为</p> 
<p>assetsPublicPath: './',</p> 
<p>其实这是不需要的，因为生产环境打包时，这里根本不会包含进入，这里只用于本地开发环境，vue.js本地产生的服务用于跨域转发，解决跨域访问产生的问题。</p> 
<pre><code class="language-javascript">module.exports = {
  dev: {

    // Paths
    assetsSubDirectory: 'static',
    assetsPublicPath: '/',
    proxyTable: {
      '/zpin/*':{
        // 本地开发环境设置
        // target:'http://localhost:8081',
        // 本地开发环境连接服务器生产环境
        target:'http://www.yi********.com:8081',
        changeOrigin:true,
        pathRewrite:{
          '^/zpin': '/zpin'
        }
      }
    },</code></pre> 
<p>包括在build 文件中的 uils.js 中 添加 </p> 
<pre><code class="language-javascript">if (options.extract) {
      return ExtractTextPlugin.extract({
        use: loaders,
        // 这里是不需要添加的，除非你对默认目录做了大的修改
        // publicPath:'../../',
        fallback: 'vue-style-loader'
      })
}</code></pre> 
<pre> 如果你在最后和跨域问题一并解决后，其实只需要更改一处，就是修改axios库的baseurl地址即可，我的设置文件是这样的</pre> 
<pre><code class="language-javascript">let base = ''//本地测试环境
 let base = 'http://besu.******.com'//打包前设置
export const postRequest = (url, params) =&gt; {
  return axios({
    method: 'post',
    url: `${base}${url}`,
    data: params
  })
}

export const putRequest = (url, params) =&gt; {
  return axios({
    method: 'put',
    url: `${base}${url}`,
    data: params
  })
}
</code></pre> 
<p>修改完成后直接  npm run build  进行打包</p> 
<p>打包完成后用FileZilla 上传到服务器存放目录中，至此打包完成，发布完成。</p> 
<p>二、解决跨域错误</p> 
<p>如果你不用Nginx做反向代理的话，无论你前端是这样的设置</p> 
<pre><code class="language-javascript">axios.defaults.withCredentials = true
axios.defaults.headers = {
  'Content-Type': 'application/json;charset=utf-8',
  'Access-Control-Allow-Credentials': 'true',
  'Access-Control-Allow-Origin': `http://www.*******.com`,
  'Access-Control-Allow-Methods': 'POST, GET, OPTIONS, DELETE, PUT',
  'Access-Control-Allow-Headers': 'x-requested-with, Content-Type, origin, authorization, accept, client-security-token'
}</code></pre> 
<p>还是后台进行跨域设置，短时间内很难解决，出现错误多多，要想快速轻松解决，就必须用Nginx做反向代理。</p> 
<p>Nginx配置文件设置内容为：</p> 
<pre><code class="language-javascript">http {
    include       mime.types;
    default_type  application/octet-stream;

    #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
    #                  '$status $body_bytes_sent "$http_referer" '
    #                  '"$http_user_agent" "$http_x_forwarded_for"';

    #access_log  logs/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  65;

    #gzip  on;

    //网站
    server {
        listen       80;
        server_name  www.*******.com;
        #server_name  localhost;

        #charset koi8-r;

        #access_log  logs/host.access.log  main;

        location / {
            root   /usr/local/tomcat/webapps/ymys;
            index  index.html index.htm;
        }
    }
    //管理后台
    server {

        listen        80;
        server_name   besu.*****.com;
        location  / {
            root   /usr/local/ymysweb/dist;
            index  index.html customer.html media.html;
        }

        #跨域 ip和port自行替换
        location /zhpin {
            proxy_pass http://101.200.12.18:8081;
        }
        error_page   500 502 503 504  /50x.html;
       location = /50x.html {
            root   html;
        }
    }
</code></pre> 
<p>编辑完毕保存后 nginx -s rolad 既可生效 </p> 
<p>在浏览器中数据访问地址，成功进入登录页面，登录有各个页面接口请求不再有跨域及其他错误。</p> 
<p>切记在build 文件中的 uils.js 中不要添加 publicPath:'../../' ，否则刷新页面会出现白板的问题。</p> 
<p>到此，全部完成，是不是很简单！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e22f53a06678f17de2c1347bdc552da8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Altium Designer(AD)软件使用记录05-PCB叠层设计</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1371f6cf60c37a2d39c0df3b0dd75433/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Js实现在线Hex转Base64,在线Base64转Hex</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>