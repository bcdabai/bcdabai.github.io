<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>一波三折：一次CPU使用率过高故障分析SQL优化解决过程 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="一波三折：一次CPU使用率过高故障分析SQL优化解决过程" />
<meta property="og:description" content="关注我们获得更多内容
作者 | 罗贵林： 云和恩墨技术工程师，具有8年以上的 Oracle 数据库工作经验，曾任职于大型的国家电信、省级财政、省级公安的维护，性能调优等。精通 Oracle 数据库管理，调优，问题诊断。擅长 SQL 调优，Oracle Rac 等维护，管理。
1.问题描述
2018年9月13日一大早接到客户电话说核心数据库RAC两主机CPU使用很高，90%以上，系统操作缓慢，需要马上紧急处理。
2.把问题想清楚
CPU使用高一般有几种原因？可以从哪些方面入手分析？客户系统情况，故障是高峰期累积的还是突发的？
一般CPU占用高是由排序、SQL解析、执行计划突变、全表扫描、会话阻塞等，可能的原因较多，需要抽丝剥茧，逐步定位根因；
分析方法主要由主机top/topas占CPU高的进程查询相应SQL、会话增长趋势、阻塞分析、ASH/AWR报告分析、SQL执行时间/执行计划变化等；
需要询问客户业务场景，业务上有没有变更，例如开发功能变更、业务使用量增加等，是当前突发的，还是持续了一段时间的问题。
经询问，本次故障是三天前突发的，问题已持续了三天时间。
3.分析：问题逐步排查
3.1. 主机topas信息
本次通过AIX主机topas信息看到进程使用CPU都很平均，无法直接定位是某个进程某个SQL引起的CPU使用过高的问题，如果可以直接明显看出资源过高损耗，定位可用以下方法：
--找到占用系统资源特别大的Oracle的Session及执行的SQL语句(根据进程号查找)
select a.username,a.machine,a.program,a.sid,a.serial#,a.status,c.piece,c.sql_text from v$session a, v$process b,v$sqltext c
where b.spid=&amp;pid and b.addr=a.paddr and a.sql_address=c.address(&#43;) order by c.piece;
--根据sid查找session的执行语句
select sid,sql_text from v$session s,v$sql q
where sid = &amp;sid and (q.sql_id=s.sql_id or q.sql_id = s.prev_sql_id);
3.2. 会话的增长趋势 通过查询V$SYSMETRIC_HISTORY视图（记录了上一小时里每1分钟的指标信息，上3分钟里每15s的指标信息），可以得出每分钟内会话数的增长趋势：
select begin_time,trunc(value) from V$SYSMETRIC_HISTORY where metric_name=&#39;Average Active Sessions&#39; and group_id=2 order by begin_time;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/933029ed1b181dd362054a36924fb3b9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-10-08T23:59:00+08:00" />
<meta property="article:modified_time" content="2018-10-08T23:59:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">一波三折：一次CPU使用率过高故障分析SQL优化解决过程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="rich_media_content" id="js_content"> 
 <p style="font-size:17px;text-align:center;">关注我们获得更多内容</p> 
 <p style="text-align:justify;"><strong style="color:rgb(51,51,51);font-family:'-apple-system-font', BlinkMacSystemFont, 'Helvetica Neue', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei UI', 'Microsoft YaHei', Arial, sans-serif;font-size:17px;letter-spacing:.544px;line-height:27.2px;background-color:rgb(255,255,255);"><span style="font-size:15px;">作者 | 罗贵林：</span></strong><span style="color:rgb(51,51,51);font-family:'-apple-system-font', BlinkMacSystemFont, 'Helvetica Neue', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei UI', 'Microsoft YaHei', Arial, sans-serif;letter-spacing:.544px;font-size:15px;background-color:rgb(255,255,255);"><span class="Apple-converted-space"> </span>云和恩墨技术工程师，具有8年以上的 Oracle 数据库工作经验，曾任职于大型的国家电信、省级财政、省级公安的维护，性能调优等。精通 Oracle 数据库管理，调优，问题诊断。擅长 SQL 调优，Oracle Rac 等维护，管理。</span></p> 
 <p><span style="font-size:16px;"><strong>1.</strong></span><span style="font-size:16px;"><strong>问题描述</strong></span></p> 
 <p style="text-align:justify;"><span style="font-size:15px;">2018年9月13日一大早接到客户电话说核心数据库RAC两主机CPU使用很高，90%以上，系统操作缓慢，需要马上紧急处理。</span><br></p> 
 <p><span style="font-size:16px;"><strong>2.把问题想清楚</strong></span></p> 
 <p style="text-align:justify;"><strong><span style="font-size:15px;">CPU使用高一般有几种原因？可以从哪些方面入手分析？客户系统情况，故障是高峰期累积的还是突发的？</span></strong></p> 
 <p style="text-align:justify;"><span style="font-size:15px;"><br></span></p> 
 <ul class="list-paddingleft-2"><li><p style="text-align:justify;"><span style="font-size:15px;">一般CPU占用高是由<strong>排序、SQL解析、执行计划突变、全表扫描、会话阻塞</strong>等，可能的原因较多，需要抽丝剥茧，逐步定位根因；</span></p></li><li><p style="text-align:justify;"><span style="font-size:15px;">分析方法主要由主机top/topas占CPU高的进程查询相应SQL、会话增长趋势、阻塞分析、ASH/AWR报告分析、SQL执行时间/执行计划变化等；</span></p></li><li><p style="text-align:justify;"><span style="font-size:15px;">需要询问客户业务场景，业务上有没有变更，例如开发功能变更、业务使用量增加等，是当前突发的，还是持续了一段时间的问题。</span></p></li></ul> 
 <p style="text-align:justify;"><strong><span style="font-size:15px;">经询问，本次故障是三天前突发的，问题已持续了三天时间</span></strong><span style="font-size:15px;">。</span></p> 
 <p><span style="font-size:16px;"><strong>3.分析：问题逐步排查</strong></span></p> 
 <h3 style="text-align:justify;"><strong><span style="font-size:15px;">3.1.  主机topas信息</span></strong><br></h3> 
 <p style="text-align:justify;"><span style="font-size:15px;">本次通过AIX主机topas信息看到进程使用CPU都很平均，无法直接定位是某个进程某个SQL引起的CPU使用过高的问题，<strong>如果可以直接明显看出资源过高损耗，定位可用以下方法：</strong></span></p> 
 <blockquote> 
  <p style="text-align:left;"><span style="font-size:12px;"><strong>--找到占用系统资源特别大的Oracle的Session及执行的SQL语句(根据进程号查找)</strong></span></p> 
  <p style="text-align:left;"><span style="font-size:12px;">select a.username,a.machine,a.program,a.sid,a.serial#,a.status,c.piece,c.sql_text from v$session a, v$process b,v$sqltext c</span></p> 
  <p style="text-align:left;"><span style="font-size:12px;">where b.spid=&amp;pid and b.addr=a.paddr and a.sql_address=c.address(+) order by c.piece;</span></p> 
  <p style="text-align:left;"><span style="font-size:12px;"><strong>--根据sid查找session的执行语句</strong></span></p> 
  <p style="text-align:left;"><span style="font-size:12px;">select sid,sql_text from v$session s,v$sql q</span></p> 
  <p style="text-align:left;"><span style="font-size:12px;">where sid = &amp;sid and (q.sql_id=s.sql_id or q.sql_id = s.prev_sql_id);</span></p> 
 </blockquote> 
 <h3 style="text-align:justify;"><span style="font-size:15px;"><br></span></h3> 
 <h3 style="text-align:justify;"><strong><span style="font-size:15px;">3.2.  会话的增长趋势</span></strong></h3> 
 <p style="text-align:justify;"><span style="font-size:15px;">通过查询V$SYSMETRIC_HISTORY视图（记录了上一小时里每1分钟的指标信息，上3分钟里每15s的指标信息），可以得出每分钟内会话数的增长趋势：</span></p> 
 <blockquote> 
  <p style="text-align:left;"><span style="font-size:12px;">select begin_time,trunc(value) </span></p> 
  <p style="text-align:left;"><span style="font-size:12px;">from V$SYSMETRIC_HISTORY </span></p> 
  <p style="text-align:left;"><span style="font-size:12px;">where metric_name='Average Active Sessions' </span></p> 
  <p style="text-align:left;"><span style="font-size:12px;">and group_id=2 order by begin_time;</span></p> 
 </blockquote> 
 <p style="text-align:justify;"><span style="font-size:15px;">经查询，本次每分钟会话数增长正常，不是会话暴增导致的问题。</span></p> 
 <h3 style="text-align:justify;"><span style="font-size:15px;"><br></span></h3> 
 <h3 style="text-align:justify;"><strong><span style="font-size:15px;">3.3.  等待事件阻情况</span></strong></h3> 
 <p style="text-align:left;"><span style="font-size:15px;">分析ASH信息，查询v$active_session_history/ dba_hist_active_sess_history视图</span></p> 
 <p style="text-align:justify;"><span style="font-size:15px;"> </span></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/06/20/xjoaIB6Z_o.png" alt="640?wx_fmt=png"></p> 
 <p style="text-align:center;"><br></p> 
 <p style="text-align:justify;"><span style="font-size:15px;">可以看到行锁等待特别严重，进一步查看等待事件发生的时间趋势：</span><br></p> 
 <p style="text-align:justify;"><span style="font-size:15px;"> </span></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/96/59/zzX6jXRG_o.png" alt="640?wx_fmt=png"></p> 
 <p style="text-align:justify;"><span style="font-size:15px;">可以看到在9：15分和9：27分有突发的等待事件发生，但相差不大，需要进一步分析，通过分析等待事件链根源：</span><br></p> 
 <blockquote> 
  <p><span style="font-size:12px;">with ash as (select /*+ materialize*/ * from   v$active_session_history t</span></p> 
  <p><span style="font-size:12px;"> where sample_time &gt;=</span></p> 
  <p><span style="font-size:12px;">       to_date('2018-09-13 08:30:00', 'yyyy-mm-dd hh24:mi:ss')</span></p> 
  <p><span style="font-size:12px;">   and sample_time &lt;</span></p> 
  <p><span style="font-size:12px;">       to_date('2018-09-13 11:00:00', 'yyyy-mm-dd hh24:mi:ss')),</span></p> 
  <p><span style="font-size:12px;">   chains as (</span></p> 
  <p><span style="font-size:12px;">   select session_id, level lvl,</span></p> 
  <p><span style="font-size:12px;">          sys_connect_by_path(session_id||' '|| sql_id || ' '||event, ' -&gt; ' ) path,</span></p> 
  <p><span style="font-size:12px;">          connect_by_isleaf isleaf</span></p> 
  <p><span style="font-size:12px;">     from ash</span></p> 
  <p><span style="font-size:12px;">    start with event in ( 'enq: TX - row lock contention')</span></p> 
  <p><span style="font-size:12px;">    connect by nocycle ( prior blocking_session = session_id</span></p> 
  <p><span style="font-size:12px;">    and prior blocking_session_serial# = session_serial# and prior sample_id = sample_id))</span></p> 
  <p><span style="font-size:12px;"> select lpad(round (ratio_to_report(count(*)) over () * 100 )||'%', 5,' ' ) "%This",</span></p> 
  <p><span style="font-size:12px;">        count(*) samples,</span></p> 
  <p><span style="font-size:12px;">        path</span></p> 
  <p><span style="font-size:12px;">   from chains</span></p> 
  <p><span style="font-size:12px;">  where isleaf = 1</span></p> 
  <p><span style="font-size:12px;">  group by path</span></p> 
  <p><span style="font-size:12px;">  order by samples desc ;</span></p> 
 </blockquote> 
 <p style="text-align:justify;"><span style="font-size:15px;"><br></span></p> 
 <p style="text-align:justify;"><strong><span style="font-size:15px;">查看到主要发生行锁的等待SQL：</span></strong></p> 
 <blockquote> 
  <p style="text-align:justify;"><span style="font-size:12px;">-&gt; 2750 85ttdm4hu93yn enq: TX - row lock contention</span></p> 
  <p style="text-align:justify;"><span style="font-size:12px;">-&gt; 14518 g78jw4psdfsqc enq: TX - row lock contention</span></p> 
  <p style="text-align:justify;"><span style="font-size:12px;">-&gt; 9505 g78jw4psdfsqc enq: TX - row lock contention</span></p> 
  <p style="text-align:justify;"><span style="font-size:12px;">-&gt; 13090 0qpy58c2urytn enq: TX - row lock contention</span></p> 
  <p style="text-align:justify;"><span style="font-size:12px;">-&gt; 16872 9dmsja7c69xdj enq: TX - row lock contention</span></p> 
  <p style="text-align:justify;"><span style="font-size:12px;">-&gt; 505 85ttdm4hu93yn enq: TX - row lock contention</span></p> 
  <p style="text-align:justify;"><span style="font-size:12px;">-&gt; 15381 0qpy58c2urytn enq: TX - row lock contention -&gt; 13090 0qpy58c2urytn enq: TX - row lock contention</span></p> 
  <p style="text-align:justify;"><span style="font-size:12px;">-&gt; 13756 0qpy58c2urytn enq: TX - row lock contention</span></p> 
  <p style="text-align:justify;"><span style="font-size:12px;">-&gt; 13276 85ttdm4hu93yn enq: TX - row lock contention</span></p> 
 </blockquote> 
 <p style="text-align:justify;"><span style="font-size:15px;"><br></span></p> 
 <p style="text-align:justify;"><strong><span style="font-size:15px;">但</span></strong><span style="font-size:15px;"><strong>行锁占比都很平均，只能反映出SQL性能较低</strong>，无法与CPU使用率高进行关联，因为很可能是因为CPU高才产生的大量行锁，不是根因而是结果，但也反应出这些行锁的SQL存在性能问题。</span></p> 
 <p style="text-align:justify;"><span style="font-size:15px;"><br></span></p> 
 <h3 style="text-align:justify;"><strong><span style="font-size:15px;">3.4.  AWR整体分析</span></strong></h3> 
 <p style="text-align:justify;"><span style="font-size:15px;">业务没变化、top没明显问题、会话正常、阻塞分析无法定位根因，因此进一步取AWR报告进行整体分析（这里可以进行同时段AWR对比分析）。</span></p> 
 <p style="text-align:justify;"><span style="font-size:15px;"> </span></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/8c/55/xbiUOgIO_o.png" alt="640?wx_fmt=png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/44/b7/J7cou9uy_o.png" alt="640?wx_fmt=png"></p> 
 <p style="text-align:justify;line-height:normal;"><span style="font-size:15px;"> </span><br></p> 
 <p style="text-align:justify;"><span style="font-size:15px;">从9：00到9：30的awr报告中，可以看到，故障时段，853by1q5drtc2语句占用最大的CPU时间和逻辑读：半小时语句执行406次，每次执行19.233秒。明显可以看出是这个SQL引起的CPU使用率过高，接下去就是怎么优化这个SQL的问题。</span></p> 
 <p><span style="font-size:16px;"><strong>4.分析：分析源头是关键</strong></span></p> 
 <h3 style="text-align:justify;"><strong><span style="font-size:15px;">4.1.  原因分析</span></strong><br></h3> 
 <blockquote> 
  <p><span style="font-size:12px;">SELECT  (SELECT IS_FUND_VOUCHER</span></p> 
  <p><span style="font-size:12px;">          FROM t1 AVT</span></p> 
  <p><span style="font-size:12px;">         WHERE AV.ADMDIVCODE = AVT.ADMDIVCODE</span></p> 
  <p><span style="font-size:12px;">           AND AV.VT_CODE = AVT.VT_CODE) as IS_FUND_VOUCHER,</span></p> 
  <p><span style="font-size:12px;">       AV.*</span></p> 
  <p><span style="font-size:12px;">  FROM t1 AV</span></p> 
  <p><span style="font-size:12px;"> WHERE AV.ADMDIVCODE = 469006</span></p> 
  <p><span style="font-size:12px;">   AND AV.STYEAR = 2018</span></p> 
  <p><span style="font-size:12px;">   AND AV.VT_CODE = 8202</span></p> 
  <p><span style="font-size:12px;">   AND AV.VOUCHER_NO = 'v18x010077927'</span></p> 
  <p><span style="font-size:12px;">   AND AV.IS_CANCEL = 0</span></p> 
  <p><span style="font-size:12px;">   AND AV.IS_OUT_DATA = 0</span></p> 
  <p><span style="font-size:12px;">   AND AV.SIGN_NO =</span></p> 
  <p><span style="font-size:12px;">       (SELECT MAX(SIGN_NO)</span></p> 
  <p><span style="font-size:12px;">          FROM t1 AV1</span></p> 
  <p><span style="font-size:12px;">         WHERE AV1.ADMDIVCODE = AV.ADMDIVCODE</span></p> 
  <p><span style="font-size:12px;">           AND AV1.STYEAR = AV.STYEAR</span></p> 
  <p><span style="font-size:12px;">           AND AV1.VT_CODE = AV.VT_CODE</span></p> 
  <p><span style="font-size:12px;">           AND AV1.VOUCHER_NO = AV.VOUCHER_NO</span></p> 
  <p><span style="font-size:12px;">           AND AV1.IS_CANCEL = 0</span></p> 
  <p><span style="font-size:12px;">           AND EXISTS (SELECT 1</span></p> 
  <p><span style="font-size:12px;">                  FROM t1_temp AVS1</span></p> 
  <p><span style="font-size:12px;">                 WHERE AVS1.VOUCHER_ID = AV1.VOUCHER_ID</span></p> 
  <p><span style="font-size:12px;">                   AND AVS1.STAMP_STATUS &gt; 0))</span></p> 
 </blockquote> 
 <p style="text-align:justify;"><span style="font-size:15px;"> </span></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/a7/61/IUzWEK3a_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:justify;"><span style="font-size:15px;">通过执行计划可以看到，主要问题在第9行临时表的全表扫描上，被作为驱动表首先进行查询，而临时表的数据量存在不确定性，查看SQL执行计划历史情况：</span></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/d1/94/8ovYpoIP_o.png" alt="640?wx_fmt=png"></p> 
 <p style="text-align:justify;"><span style="color:rgb(255,0,0);"><strong><span style="font-size:15px;"><br></span></strong></span></p> 
 <p style="text-align:justify;"><span style="color:rgb(255,0,0);"><strong><span style="font-size:15px;">可以看到执行计划产生了不合理的变化，执行时间差异很大，这是CPU占用过大的根本原因。</span></strong></span><br></p> 
 <p style="text-align:justify;"><span style="font-size:15px;"><br></span></p> 
 <h3 style="text-align:justify;"><strong><span style="font-size:15px;">4.2.  问题处理</span></strong></h3> 
 <p style="text-align:justify;"><span style="font-size:15px;">定位了是SQL问题，首先就要考虑开发是否能修改SQL，如果可以则可以通过改写或指定HINT的方式修正执行计划，实在无法修改SQL的再使用SPM或SQLPROFILE进行绑定，本次开发回复可以修改代码，于是进行如下修改：</span></p> 
 <blockquote> 
  <p><span style="font-size:12px;">SELECT  /*+ </span><span style="font-size:12px;color:rgb(255,0,0);">leading(AV) </span><span style="font-size:12px;">*/  (SELECT IS_FUND_VOUCHER</span></p> 
  <p><span style="font-size:12px;">          FROM t1 AVT</span></p> 
  <p><span style="font-size:12px;">         WHERE AV.ADMDIVCODE = AVT.ADMDIVCODE</span></p> 
  <p><span style="font-size:12px;">           AND AV.VT_CODE = AVT.VT_CODE) as IS_FUND_VOUCHER,</span></p> 
  <p><span style="font-size:12px;">       AV.*</span></p> 
  <p><span style="font-size:12px;">  FROM t1 AV</span></p> 
  <p><span style="font-size:12px;"> WHERE AV.ADMDIVCODE = '460200'</span></p> 
  <p><span style="font-size:12px;">   AND AV.STYEAR = 2018</span></p> 
  <p><span style="font-size:12px;">   AND AV.VT_CODE = '8202'</span></p> 
  <p><span style="font-size:12px;">   AND AV.VOUCHER_NO = 'HI18x12018082017'</span></p> 
  <p><span style="font-size:12px;">   AND AV.IS_CANCEL = 0</span></p> 
  <p><span style="font-size:12px;">   AND AV.IS_OUT_DATA = 0</span></p> 
  <p><span style="font-size:12px;">   AND AV.SIGN_NO =</span></p> 
  <p><span style="font-size:12px;">       (SELECT  /*+ </span><span style="font-size:12px;color:rgb(255,0,0);">leading(AV1,AVS1)</span><span style="font-size:12px;"> */  MAX(SIGN_NO)</span></p> 
  <p><span style="font-size:12px;">          FROM t1 AV1</span></p> 
  <p><span style="font-size:12px;">         WHERE AV1.ADMDIVCODE = AV.ADMDIVCODE</span></p> 
  <p><span style="font-size:12px;">           AND AV1.STYEAR = AV.STYEAR</span></p> 
  <p><span style="font-size:12px;">           AND AV1.VT_CODE = AV.VT_CODE</span></p> 
  <p><span style="font-size:12px;">           AND AV1.VOUCHER_NO = AV.VOUCHER_NO</span></p> 
  <p><span style="font-size:12px;">           AND AV1.IS_CANCEL = 0</span></p> 
  <p><span style="font-size:12px;">           AND EXISTS (SELECT /*+ </span><span style="font-size:12px;color:rgb(255,0,0);">INDEX(AVS1,UQ_TEMP_2018</span><span style="font-size:12px;">) */ 1</span></p> 
  <p><span style="font-size:12px;">                  FROM </span><span style="font-size:12px;color:rgb(255,0,0);">t1_temp</span><span style="font-size:12px;"> AVS1</span></p> 
  <p><span style="font-size:12px;">                 WHERE AVS1.VOUCHER_ID = AV1.VOUCHER_ID</span></p> 
  <p><span style="font-size:12px;">                   AND AVS1.STAMP_STATUS &gt; 0));</span></p> 
 </blockquote> 
 <p style="text-align:justify;"><span style="font-size:15px;"><br></span></p> 
 <p style="text-align:justify;"><span style="font-size:15px;">指定驱动表后，t1_temp表使用上了正确的索引，实际执行时间由169秒改变为不到1秒。</span></p> 
 <h3 style="text-align:justify;"><span style="font-size:15px;"><br></span></h3> 
 <h3 style="text-align:justify;"><strong><span style="font-size:15px;">4.3.  处理前后压力对比</span></strong></h3> 
 <h3 style="text-align:left;"><span style="font-size:15px;">通过开发替换SQL后，可以通过AWR的AAS做简单的前后压力对比，如下示：</span></h3> 
 <p style="text-align:left;"><img src="https://images2.imgbox.com/7f/3e/ifUDbEY3_o.png" alt="640?wx_fmt=png"></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/15/b7/ogm7UDkP_o.png" alt="640?wx_fmt=png"></p> 
 <p style="text-align:justify;"><span style="font-size:15px;">从这里可以看到数据库压力<strong>减轻35%左右</strong>。</span></p> 
 <p style="text-align:justify;"><span style="font-size:15px;">从主机的TOPAS看到CPU维护在75%左右，本来以为事情到这边就结束了，但客户反馈平时CPU只在50%以下，当前的优化效果不明显，因此通过查看AWR得知加索引的 /*+ INDEX(AVS1,UQ_TEMP_2018) */ HINT并没有加到SQL中，和开发再次沟通得知由于索引有以年度作为标识，加索引HINT存在工作量大的困难而没有修改，但却没有通知到我（这里可以看到<strong>和开发确认最终的优化版本是非常重要的</strong>），导致当前优化效果夭折。</span></p> 
 <h3 style="text-align:justify;"><strong><span style="font-size:15px;"><br></span></strong></h3> 
 <h3 style="text-align:justify;"><strong><span style="font-size:15px;">4.4.  承接压力再次分析问题</span></strong></h3> 
 <p style="text-align:justify;"><strong><span style="font-size:15px;">开发无法增加索引HINT，达不到最终的优化效果</span></strong><span style="font-size:15px;">，接下去的方法就是绑定执行计划，但这套库的维护是从来没有进行执行计划绑定的，为什么在这里就需要进行绑定？是不是可以不绑定达到效果？</span></p> 
 <p style="text-align:justify;line-height:normal;"><span style="font-size:15px;"><br></span></p> 
 <p style="text-align:justify;"><span style="font-size:15px;">因为SQL已经指定了驱动表，没有引用正确的索引可能存在其他问题。此时如果没有这些思考，就去进行执行计划绑定，就会忽略之后的问题，而只是解决当前问题，多了一些思考后，此时才想到会不会是</span><strong style="font-size:15px;">统计信息不准</strong><span style="font-size:15px;">引起的问题，本来是第一时间需要检查的事项，在这次故障处理中被忽略了。</span><br></p> 
 <p style="text-align:justify;"><span style="font-size:15px;"><br></span></p> 
 <p style="text-align:justify;"><strong><span style="font-size:15px;">查看表最后一次分析时间，如下示：</span></strong></p> 
 <p style="text-align:justify;"><span style="font-size:15px;"> </span></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/1c/6b/rEScld5j_o.png" alt="640?wx_fmt=jpeg"></p> 
 <p style="text-align:justify;"><strong><span style="font-size:15px;">可以看到很多表统计信息没有自动收集成功，而ORACLE是根据数据改变量大于10%才进行统计信息的收集，且对静态表并不收集统计信息，但当前并不是因为采集任务过重未能及时收集完成，而是基本没有收集。</span></strong></p> 
 <blockquote> 
  <p><span style="font-size:12px;">--大于10%的改变量的表实际没有及时收集到统计信息，重新收集后dba_tab_modifications重新计算</span></p> 
  <p><span style="font-size:12px;">select table_owner,</span></p> 
  <p><span style="font-size:12px;">       table_name,</span></p> 
  <p><span style="font-size:12px;">       (inserts + updates + deletes) all_update_num,</span></p> 
  <p><span style="font-size:12px;">       (inserts + updates + deletes) /</span></p> 
  <p><span style="font-size:12px;">       nvl((select num_rows</span></p> 
  <p><span style="font-size:12px;">             from dba_tables</span></p> 
  <p><span style="font-size:12px;">            where owner = a.table_owner</span></p> 
  <p><span style="font-size:12px;">              and table_name = a.table_name</span></p> 
  <p><span style="font-size:12px;">              and num_rows &lt;&gt; 0),</span></p> 
  <p><span style="font-size:12px;">           1) * 100 flag</span></p> 
  <p><span style="font-size:12px;">  from dba_tab_modifications a</span></p> 
  <p><span style="font-size:12px;"> where a.table_owner in ('用户名')</span></p> 
  <p><span style="font-size:12px;"> order by (inserts + updates + deletes) desc;</span></p> 
 </blockquote> 
 <p style="text-align:justify;"><strong><span style="font-size:15px;"><br></span></strong></p> 
 <p style="text-align:justify;"><strong><span style="font-size:15px;">能过查询可以确认几乎所有的表都没有进行收集，进一步查询自动统计信息收集信息：</span></strong></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/61/f9/etsBSPSc_o.png" alt="640?wx_fmt=png"></p> 
 <p style="text-align:justify;"><span style="font-size:15px;text-align:left;">可以看到自动采集任务都停止了，确定统计信息过旧，执行统计信息收集后， </span></p> 
 <blockquote> 
  <p style="text-align:left;"><span style="font-size:12px;">exec dbms_stats.gather_table_stats(ownname =&gt;'用户名' ,tabname =&gt; '表名',estimate_percent =&gt;10,cascade =&gt; true);</span></p> 
 </blockquote> 
 <p style="text-align:left;"><span style="font-size:15px;"><br></span></p> 
 <p style="text-align:left;"><span style="font-size:15px;">再次确认853by1q5drtc2语句使用上了正确的执行计划，通过运行execute DBMS_AUTO_TASK_ADMIN.enable();重新开启采集任务。</span></p> 
 <p style="line-height:normal;"><br></p> 
 <p style="text-align:justify;"><strong><span style="font-size:15px;"></span></strong></p> 
 <p style="text-align:justify;"><strong><span style="font-size:15px;">至此，CPU使用率高的问题得到了最终解决，最终是由于统计信息没有正确收集导致的，而自动统计信息任务处于关闭状态，</span></strong><span style="font-size:15px;">在AWR中853by1q5drtc2语句占用CPU的8.9%，35%的降低可以知道不仅853by1q5drtc2这个SQL因统计信息不准确走错执行计划导致CPU占用高，实际上ASH中那些行锁的SQL也占用了不少的CPU，这里降低效果明显可能是因为这个SQL和行锁语句存在业务关系（这里可以看到优化占用资源消耗第一位的SQL很重要），正确的统计信息收集也将使其他SQL的执行计划更准确。至于为什么采集任务没有开启，由于时间过去久远，已经无法再追踪了。</span></p> 
 <p><span style="font-size:16px;"><strong>5.分析：扩展知识</strong></span></p> 
 <p style="text-align:justify;"><span style="font-size:15px;">这里涉及到统计信息收集的问题，而随着数据量的日益增大，当前库很可能造成自动统计信息不能及时收集完成，因此这里做一下附加调整方法。</span></p> 
 <p style="text-align:justify;"><strong><span style="font-size:15px;"><br></span></strong></p> 
 <h3 style="text-align:justify;"><strong><span style="font-size:15px;">5.1.  锁定部分表使自动统计信息不收集</span></strong></h3> 
 <table cellspacing="0" width="378"><tbody><tr><td width="676"><p style="text-align:justify;"><span style="font-size:12px;">如果一些分区表统计信息没有及时收集，可考虑锁定统计信息，采用手工收集</span></p><p style="text-align:justify;"><span style="font-size:12px;">--考虑锁定num_rows很大，last_analyzed收集信息较旧的表</span></p><p style="text-align:justify;"><span style="font-size:12px;">select t.table_owner,</span></p><p style="text-align:justify;"><span style="font-size:12px;">       t.table_name,</span></p><p style="text-align:justify;"><span style="font-size:12px;">       t.partition_name,</span></p><p style="text-align:justify;"><span style="font-size:12px;">       t.num_rows,</span></p><p style="text-align:justify;"><span style="font-size:12px;">       t.last_analyzed</span></p><p style="text-align:justify;"><span style="font-size:12px;">  from dba_tab_partitions t</span></p><p style="text-align:justify;"><span style="font-size:12px;"> where t.table_owner = 'P2BEMADM'</span></p><p style="text-align:justify;"><span style="font-size:12px;"> order by t.num_rows desc;</span></p><p style="text-align:justify;"><span style="font-size:12px;">--大于10%的改变量的表实际没有及时收集到统计信息</span></p><p style="text-align:justify;"><span style="font-size:12px;">select table_owner,</span></p><p style="text-align:justify;"><span style="font-size:12px;">       table_name,</span></p><p style="text-align:justify;"><span style="font-size:12px;">       (inserts + updates + deletes) all_update_num,</span></p><p style="text-align:justify;"><span style="font-size:12px;">       (inserts + updates + deletes) /</span></p><p style="text-align:justify;"><span style="font-size:12px;">       nvl((select num_rows</span></p><p style="text-align:justify;"><span style="font-size:12px;">             from dba_tables</span></p><p style="text-align:justify;"><span style="font-size:12px;">            where owner = a.table_owner</span></p><p style="text-align:justify;"><span style="font-size:12px;">              and table_name = a.table_name</span></p><p style="text-align:justify;"><span style="font-size:12px;">              and num_rows &lt;&gt; 0),</span></p><p style="text-align:justify;"><span style="font-size:12px;">           1) * 100 flag</span></p><p style="text-align:justify;"><span style="font-size:12px;">  from dba_tab_modifications a</span></p><p style="text-align:justify;"><span style="font-size:12px;"> where a.table_owner in ('P2BEMADM')</span></p><p style="text-align:justify;"><span style="font-size:12px;"> order by (inserts + updates + deletes) desc;</span></p><p style="text-align:justify;"><span style="font-size:12px;">每日的改动量很大，也超过10%，对于这样的表进行锁定统计信息，让自动统计收集过滤这些表，然后定期做手工收集统计信息，放到自动JOB过程里。</span></p><p style="text-align:justify;"><span style="font-size:12px;">dbms_stats.lock_table_stats('用户名','表名');</span></p><p style="text-align:justify;"><span style="font-size:12px;">定期执行以下内容（举例）：</span></p><p style="text-align:justify;"><span style="font-size:12px;">begin</span></p><p style="text-align:justify;"><span style="font-size:12px;">dbms_stats.unlock_table_stats('用户名','表名');</span></p><p style="text-align:justify;"><span style="font-size:12px;">dbms_stats.gather_table_stats(ownname =&gt; '用户名',tabname =&gt;’表名’,estimate_percent =&gt; 0.2,cascade =&gt;true);</span></p><p style="text-align:justify;"><span style="font-size:12px;">dbms_stats.gather_table_stats(ownname =&gt; '用户名',tabname =&gt;’表名’,partname =&gt;’分区名’,estimate_percent =&gt; 0.2,cascade =&gt;true);</span></p><p style="text-align:justify;"><span style="font-size:12px;">dbms_stats.gather_table_stats(ownname=&gt;'用户名',tabname=&gt;'表名',granularty=&gt;'APPROX_GLOBAL AND PARTITION',partname=&gt;'分区名',estimate=&gt;0.00001,cascade=&gt;true);</span></p><p style="text-align:justify;"><span style="font-size:12px;">dbms_stats.lock_table_stats('用户名','表名');</span></p><p style="text-align:justify;"><span style="font-size:12px;">end;</span></p></td></tr></tbody></table> 
 <p style="text-align:justify;"><span style="font-size:15px;"> </span></p> 
 <h3 style="text-align:justify;"><span style="font-size:15px;">5.2.  临时表禁用自动统计信息收集_参考方案</span></h3> 
 <p style="text-align:left;"><span style="font-size:15px;">如果存在临时表（global temporary table），为避免数据库引用错误的临时表统计信息，禁用临时表统计信息收集，如下示：</span></p> 
 <table cellspacing="0" width="378"><tbody><tr><td width="568"><p style="text-align:justify;"><span style="font-size:12px;">禁用临时表统计信息收集</span></p><p style="text-align:justify;"><span style="font-size:12px;">select s.table_name, s.STATTYPE_LOCKED</span></p><p style="text-align:justify;"><span style="font-size:12px;">     from dba_TAB_STATISTICS s</span></p><p style="text-align:justify;"><span style="font-size:12px;">    where S.table_name IN (select T1.table_name</span></p><p style="text-align:justify;"><span style="font-size:12px;">                          from dba_tables t1</span></p><p style="text-align:justify;"><span style="font-size:12px;">                         where t1.temporary = 'Y'</span></p><p style="text-align:justify;"><span style="font-size:12px;">                           and owner = '用户名')</span></p><p style="text-align:justify;"><span style="font-size:12px;">其中STATTYPE_LOCKED字段为空表示没有锁定统计信息。</span></p><p style="text-align:justify;"><span style="font-size:12px;">为避免数据库引用错误的临时表统计信息进行锁定临时表统计信息，而让其进行动态采样收集</span></p><p style="text-align:justify;"><span style="font-size:12px;">begin</span></p><p style="text-align:justify;"><span style="font-size:12px;">dbms_stats.unlock_table_stats('用户名','表名');</span></p><p style="text-align:justify;"><span style="font-size:12px;">dbms_stats.delete_table_stats(用户名,'表名'); </span></p><p style="text-align:justify;"><span style="font-size:12px;">dbms_stats.lock_table_stats(用户名,'表名');</span></p><p style="text-align:justify;"><span style="font-size:12px;">end;</span></p></td></tr></tbody></table> 
 <p style="text-align:justify;"><span style="font-size:15px;"> </span></p> 
 <h3 style="text-align:justify;"><strong><span style="font-size:15px;">5.3.  启用11G新特性的增量统计信息收集技术</span></strong></h3> 
 <p style="text-align:justify;"><span style="font-size:15px;">除锁定表不自动收集统计信息外，也可考虑使用11G新特性的增量统计信息收集技术，<strong>当系统有很大的分区表时，如果总是全部收集则会比较慢，11g之后可以设置INCREMENTAL只对数据有变动的分区做收集，如下示：</strong></span></p> 
 <blockquote> 
  <p style="text-align:justify;"><span style="font-size:12px;">exec dbms_stats.set_table_prefs('JD','IMS_RES_MONITOR_2','INCREMENTAL','TRUE');</span></p> 
  <p style="text-align:justify;"><span style="font-size:12px;">exec dbms_stats.set_table_prefs(user,'table_name','INCREMENTAL','TRUE'); --只收集数据变动的分区</span></p> 
  <p style="text-align:justify;"><span style="font-size:12px;">select dbms_stats.get_prefs('INCREMENTAL',null,'table_name') from dual;  --查看分区表INCREMENTAL的值</span></p> 
 </blockquote> 
 <p style="text-align:justify;"><span style="font-size:15px;color:rgb(255,0,0);">注：启用增量统计信息收集会占用SYSAUX表空间，在设定前需要加大SYSAUX表空间大小。</span></p> 
 <h3 style="text-align:justify;"><span style="font-size:15px;"><br></span></h3> 
 <h3 style="text-align:justify;"><strong><span style="font-size:15px;">5.4.  延长自动统计信息收集时间</span></strong></h3> 
 <p style="text-align:justify;"><span style="font-size:15px;">自动收集统计信息的时间是周一到周五每晚22:00:00到第二天2:00结束，周六周日两天全天收集。在经过以上方法优化统计信息收集后，可进一步考虑工作日时段延长2小时，即周一到周五时段统计信息收集到第二天4:00结束。</span></p> 
 <p style="text-align:justify;"><strong><span style="font-size:15px;">修改脚本如下：</span></strong></p> 
 <table cellspacing="0" width="378"><tbody><tr><td width="568"><p style="text-align:justify;"><span style="font-size:12px;">--下面修改配置(使用sys用户登录oracle执行)</span></p><p style="text-align:justify;"><span style="font-size:12px;">sqlplus sys/xxx@xxxdb as sysdba</span></p><p style="text-align:justify;"><span style="font-size:12px;">--修改SATURDAY_WINDOW、SUNDAY_WINDOW的配置 (改成和平常相同,即每日都是22:00向后4小时,至次日凌晨2点)</span></p><p style="text-align:justify;"><span style="font-size:12px;">--下面的方式也可修改周六、周日的时间Window</span></p><p style="text-align:justify;"><span style="font-size:12px;">begin</span></p><p style="text-align:justify;"><span style="font-size:12px;">  sys.dbms_scheduler.set_attribute(name =&gt; 'SYS.SATURDAY_WINDOW', attribute =&gt; 'repeat_interval', value =&gt; 'Freq=daily;ByDay=SAT;ByHour=22;ByMinute=0;BySecond=0');</span></p><p style="text-align:justify;"><span style="font-size:12px;">  sys.dbms_scheduler.set_attribute(name =&gt; 'SYS.SATURDAY_WINDOW', attribute =&gt; 'duration', value =&gt; '0 04:00:00');</span></p><p style="text-align:justify;"><span style="font-size:12px;">end;</span></p><p style="text-align:justify;"><span style="font-size:12px;">/</span></p><p style="text-align:justify;"><span style="font-size:12px;">begin</span></p><p style="text-align:justify;"><span style="font-size:12px;">  sys.dbms_scheduler.set_attribute(name =&gt; 'SYS.SUNDAY_WINDOW', attribute =&gt; 'repeat_interval', value =&gt; 'Freq=daily;ByDay=SUN;ByHour=22;ByMinute=0;BySecond=0');</span></p><p style="text-align:justify;"><span style="font-size:12px;">  sys.dbms_scheduler.set_attribute(name =&gt; 'SYS.SUNDAY_WINDOW', attribute =&gt; 'duration', value =&gt; '0 04:00:00');</span></p><p style="text-align:justify;"><span style="font-size:12px;">end;</span></p><p style="text-align:justify;"><span style="font-size:12px;">/</span></p><p style="text-align:justify;"><span style="font-size:12px;">--查看修改结果:</span></p><p style="text-align:justify;"><span style="font-size:12px;">select t1.window_name,t1.repeat_interval,t1.duration from dba_scheduler_windows t1,dba_scheduler_wingroup_members t2</span></p><p style="text-align:justify;"><span style="font-size:12px;"> where t1.window_name=t2.window_name and t2.window_group_name='MAINTENANCE_WINDOW_GROUP';</span></p><p style="text-align:justify;"><span style="font-size:12px;">/*           WINDOW_NAME        REPEAT_INTERVAL        DURATION</span></p><p style="text-align:justify;"><span style="font-size:12px;">1        MONDAY_WINDOW        freq=daily;byday=MON;byhour=22;byminute=0; bysecond=0        +000 04:00:00</span></p><p style="text-align:justify;"><span style="font-size:12px;">2        TUESDAY_WINDOW        freq=daily;byday=TUE;byhour=22;byminute=0; bysecond=0        +000 04:00:00</span></p><p style="text-align:justify;"><span style="font-size:12px;">3        WEDNESDAY_WINDOW        freq=daily;byday=WED;byhour=22;byminute=0; bysecond=0        +000 04:00:00</span></p><p style="text-align:justify;"><span style="font-size:12px;">4        THURSDAY_WINDOW        freq=daily;byday=THU;byhour=22;byminute=0; bysecond=0        +000 04:00:00</span></p><p style="text-align:justify;"><span style="font-size:12px;">5        FRIDAY_WINDOW        freq=daily;byday=FRI;byhour=22;byminute=0; bysecond=0        +000 04:00:00</span></p><p style="text-align:justify;"><span style="font-size:12px;">6        SATURDAY_WINDOW        Freq=daily;ByDay=SAT;ByHour=22;ByMinute=0;BySecond=0        +000 04:00:00</span></p><p style="text-align:justify;"><span style="font-size:12px;">7        SUNDAY_WINDOW        Freq=daily;ByDay=SUN;ByHour=22;ByMinute=0;BySecond=0        +000 04:00:00</span></p><p style="text-align:justify;"><span style="font-size:12px;">*/</span></p></td></tr></tbody></table> 
 <p><span style="font-size:16px;"><strong>6.总结：思路决定效率</strong></span></p> 
 <p style="text-align:justify;"><span style="font-size:15px;">总结这个故障，究其原因就是<strong>一次统计信息失真</strong>导致SQL执行计划走错的简单案例，但有时往往入手的思路错了，导致中间分析的道路过于曲折，且与客户的实际沟通与诉求存在偏差（以为加了HINT使SQL达到优化效果就结束了），往往导致问题处理的曲折性。</span></p> 
 <p style="text-align:justify;"><span style="font-size:15px;"><br></span></p> 
 <p style="text-align:justify;"><strong><span style="font-size:15px;">在实践中，针对故障和问题需要充分考虑多个可能性，以其一击中的</span></strong><span style="font-size:15px;">，在本次的故障处理中最终分析是由于统计信息未自动收集导致一系列的性能问题。</span></p> 
 <p style="text-align:justify;"><span style="font-size:15px;"><strong><br></strong></span></p> 
 <p style="text-align:justify;"><span style="font-size:15px;"><strong>总结SQL执行计划走错的问题注意以下几点：</strong></span></p> 
 <blockquote> 
  <p style="text-align:justify;"><span style="font-size:12px;">1. SQL执行计划是不是突变的，这个通过SQL执行历史信息可以查看到。</span></p> 
  <p style="text-align:justify;"><span style="font-size:12px;">2. SQL涉及的表的统计信息是不是最新的，如果不是，需要重新收集。</span></p> 
  <p style="text-align:justify;"><span style="font-size:12px;">3. 在开发可以变更的情况下，不建议使用绑定执行计划的方法，使用通用HINT方法优于执行计划绑定。</span></p> 
  <p style="text-align:justify;"><span style="font-size:12px;">4. 开发无法变更的情况下，可以通过绑定执行计划的方法快速处理SQL执行效率低下的问题。</span></p> 
 </blockquote> 
 <p style="text-align:justify;"><span style="font-size:15px;"><br></span></p> 
 <p style="text-align:justify;"><span style="font-size:15px;">另外，还需要及时熟悉客户现场情况和实际变更情况，避免沟通确认上引起一些不必要的麻烦和误会，延误分析时间和实际优化效果，故障处理后，还需要评估后续可能产生的问题，予以准备，在本次故障处理中收集了一些自动统计信息的优化方法以备后续使用。</span></p> 
 <p style="text-align:justify;"><span style="font-size:15px;"> </span></p> 
 <p><span style="color:#595959;font-size:14px;letter-spacing:1px;"><em>原创：罗贵林。</em></span></p> 
 <p style="color:rgb(51,51,51);"><em><span style="font-size:14px;color:#595959;letter-spacing:1px;">投稿：有投稿意向技术人请在公众号对话框留言。</span></em></p> 
 <p style="color:rgb(51,51,51);"><em><span style="font-size:14px;color:#595959;letter-spacing:1px;">转载：意向文章下方留言。</span></em></p> 
 <p style="color:rgb(51,51,51);"><em><span style="font-size:14px;color:#595959;letter-spacing:1px;">更多精彩请关注 “数据和云” 公众号 。</span></em></p> 
 <p style="text-align:justify;"><span style="font-size:15px;"> </span></p> 
 <hr> 
 <p><span style="font-size:15px;">资源下载</span></p> 
 <p style="margin-left:8px;font-size:1em;line-height:1.75em;"><span style="font-size:15px;letter-spacing:.5px;">关注公众号：数据和云（</span><span style="font-size:15px;letter-spacing:.5px;color:rgb(255,0,0);">OraNews</span><span style="font-size:15px;letter-spacing:.5px;">）回复关键字获取</span></p> 
 <p style="margin-left:8px;font-size:1em;line-height:normal;"><span style="font-size:12px;color:rgb(255,0,0);"><strong><span style="letter-spacing:.5px;"><strong style="color:rgb(62,62,62);">2018DTCC </strong><span style="color:rgb(62,62,62);">, 数据库大会PPT</span></span></strong></span></p> 
 <p style="margin-left:8px;font-size:1em;line-height:normal;"><span style="font-size:12px;"><span style="color:rgb(255,0,0);"><strong><span style="letter-spacing:.5px;">2017DTC</span></strong></span><span style="letter-spacing:.5px;">，2017 DTC 大会 PPT<br></span></span></p> 
 <p style="margin-left:8px;font-size:1em;line-height:normal;"><span style="font-size:12px;"><strong><span style="letter-spacing:.5px;">DBALIFE </span></strong><span style="letter-spacing:.5px;">，“DBA 的一天”海报<br></span></span></p> 
 <p style="margin-left:8px;line-height:normal;"><span style="font-size:12px;"><strong><span style="letter-spacing:.5px;">DBA04 </span></strong><span style="letter-spacing:.5px;">，DBA 手记4 电子书</span></span></p> 
 <p style="margin-left:8px;font-size:1em;line-height:normal;"><span style="font-size:14px;"><strong><span style="font-size:12px;letter-spacing:.5px;">122ARCH </span></strong><span style="font-size:12px;letter-spacing:.5px;">，Oracle 12.2体系结构图</span><br></span></p> 
 <p style="margin-left:8px;font-size:1em;line-height:normal;"><span style="font-size:12px;"><strong><span style="letter-spacing:.5px;">2017OOW </span></strong><span style="letter-spacing:.5px;">，Oracle OpenWorld 资料<br></span></span></p> 
 <p style="margin-left:8px;font-size:1em;line-height:normal;"><span style="font-size:12px;"><strong><span style="letter-spacing:.5px;">PRELECTION </span></strong><span style="letter-spacing:.5px;">，大讲堂讲师课程资料</span></span></p> 
 <span style="font-size:14.08px;color:rgb(255,255,255);background-color:rgb(0,140,207);"><span style="text-decoration:underline;font-size:14px;">近期文章</span></span> 
 <p style="line-height:25.6px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5MDAxOTk2MQ==&amp;mid=2650279435&amp;idx=2&amp;sn=fc107d6148992559c52825357b15015e&amp;chksm=be47961d89301f0b4ef2f1c28f15b21016ec659a336892d18068f2269fa64584d01011501874&amp;scene=21#wechat_redirect" rel="nofollow" style="text-decoration:underline;font-size:12px;"><span style="font-size:12px;">删了库之后，不要着急跑路</span></a></p> 
 <p style="line-height:25.6px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5MDAxOTk2MQ==&amp;mid=2650279266&amp;idx=1&amp;sn=da7cb25ba0a3769668514e8571ab480e&amp;chksm=be47957489301c6290ae0bf06adda399c0c9666f4b289bc983ff4e9a428350a30fa40baa8d7d&amp;scene=21#wechat_redirect" rel="nofollow" style="text-decoration:underline;font-size:12px;"><span style="font-size:12px;">一道面试题看数据库性能和安全的方方面面</span></a><br></p> 
 <p style="line-height:25.6px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5MDAxOTk2MQ==&amp;mid=2650279423&amp;idx=1&amp;sn=c3271060af20cd8186304cd0e354e4a5&amp;chksm=be4795e989301cff5d8b448627d86ffc22b550d4e8d54499af05e8cf327be73d47e50d6b5d60&amp;scene=21#wechat_redirect" rel="nofollow" style="text-decoration:underline;font-size:12px;"><span style="font-size:12px;">Percona发布XtraBackup for MySQL 8.0</span></a><br></p> 
 <p style="line-height:25.6px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5MDAxOTk2MQ==&amp;mid=2650279209&amp;idx=1&amp;sn=4f79b29132cde954c44158ab106ef2e4&amp;chksm=be47953f89301c29dffd56df8bdb21084b08c60effdcd999113574441928ee6448a7de03f430&amp;scene=21#wechat_redirect" rel="nofollow" style="text-decoration:underline;font-size:12px;"><span style="font-size:12px;">独立发布的Oracle严重CVE-2018-3110公告</span></a><br></p> 
 <p style="line-height:25.6px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5MDAxOTk2MQ==&amp;mid=2650279197&amp;idx=1&amp;sn=9a92a4e0936651d257e2cf8ea1555cef&amp;chksm=be47950b89301c1d284cb5ee7c7c4d2973a4eb33827163ae2a0db25d68da39d02b91c3821613&amp;scene=21#wechat_redirect" rel="nofollow" style="text-decoration:underline;font-size:12px;"><span style="font-size:12px;">Oracle宣布在云上正式上线 自治事务处理数据库</span></a><br></p> 
 <p style="line-height:25.6px;"><a href="http://mp.weixin.qq.com/s?__biz=MjM5MDAxOTk2MQ==&amp;mid=2650279111&amp;idx=1&amp;sn=a8446d0e186c2a8e190a0531c96cd710&amp;chksm=be4794d189301dc745294e0a14a9eb8628795f31d0e15a384e7cc5f99078bc7b380ccaafa399&amp;scene=21#wechat_redirect" rel="nofollow" style="text-decoration:underline;font-size:12px;"><span style="font-size:12px;">为什么看了那么多灾难，还是过不好备份这一关？</span></a></p> 
 <p style="line-height:normal;"><br></p> 
 <p style="line-height:25.6px;text-align:center;"><img style="width:557.5px;" src="https://images2.imgbox.com/d9/fa/5NM510Ai_o.png" alt="640?wx_fmt=jpeg"></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9100203a9e18d771ee1de7e736e4b071/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Logstash 参考指南（File输出插件）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dc9429752e88c585aa834f2d61d87d6b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Web测试与App测试的区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>