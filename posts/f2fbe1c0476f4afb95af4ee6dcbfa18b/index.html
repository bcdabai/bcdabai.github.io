<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Opencv：验证码图像处理 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Opencv：验证码图像处理" />
<meta property="og:description" content="本篇讲的主要是对验证码图片的二值去边去线降噪。
最近天热了。人也有点疲惫，不打太多字。
首先安装 opencv ：（点击链接查看）
https://blog.csdn.net/weixin_43582101/article/details/88660570
我自己画了个图（下文图片数据根据这张图写的）
图片名：1234567.png：
读入图片1234567.png
import cv2 im = cv2.imread(&#39;1234567.png&#39;) 使用cvtColor方法进行颜色空间转换，转成黑白的
im = cv2.cvtColor(im, cv2.COLOR_BGR2GRAY) 可以保存下看看：
cv2.imwrite(&#39;33333.png&#39;,im) 然后我们先去除边框：
啥原理呢，就是把这个边框范围的 所有坐标的像素 都变成 255 白色的。这个具体要看你的图片的边框值是多少，需要你看情况。
def clear_border(img): h, w = img.shape[:2] # h高、w宽 for y in range(0, w): for x in range(0, h): if y &lt; 50 or y &gt; w - 61: # 把在50以内的像素坐标[0,0]到[高,50],[0,宽-50]到[高，宽]，都变白色 img[x, y] = 255 if x &lt; 60 or x &gt; h - 60: # 如上 img[x, y] = 255 cv2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f2fbe1c0476f4afb95af4ee6dcbfa18b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-05-27T18:33:53+08:00" />
<meta property="article:modified_time" content="2019-05-27T18:33:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Opencv：验证码图像处理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>本篇讲的主要是对验证码图片的二值去边去线降噪。</p> 
<p>最近天热了。人也有点疲惫，不打太多字。</p> 
<p>首先安装 opencv ：（点击链接查看）<br> <a href="https://blog.csdn.net/weixin_43582101/article/details/88660570">https://blog.csdn.net/weixin_43582101/article/details/88660570</a></p> 
<p>我自己画了个图（下文图片数据根据这张图写的）<br> 图片名：1234567.png：<br> <img src="https://images2.imgbox.com/fd/fc/2tqkGCCa_o.png" alt="在这里插入图片描述"><br> 读入图片1234567.png</p> 
<pre><code>import cv2
im = cv2.imread('1234567.png')
</code></pre> 
<p>使用cvtColor方法进行颜色空间转换，转成黑白的</p> 
<pre><code>im = cv2.cvtColor(im, cv2.COLOR_BGR2GRAY)
</code></pre> 
<p>可以保存下看看：</p> 
<pre><code> cv2.imwrite('33333.png',im)
</code></pre> 
<p><img src="https://images2.imgbox.com/68/4f/gzBuVadW_o.png" alt="在这里插入图片描述"><br> 然后我们先去除边框：<br> 啥原理呢，就是把这个边框范围的 所有坐标的像素 都变成 255 白色的。这个具体要看你的图片的边框值是多少，需要你看情况。</p> 
<pre><code>def clear_border(img):
  h, w = img.shape[:2]                          # h高、w宽
  for y in range(0, w):
    for x in range(0, h):
      if y &lt; 50 or y &gt; w - 61:     # 把在50以内的像素坐标[0,0]到[高,50],[0,宽-50]到[高，宽]，都变白色
        img[x, y] = 255
      if x &lt; 60 or x &gt; h - 60:    #  如上
        img[x, y] = 255
  cv2.imwrite('22222.png',img)
  return img
</code></pre> 
<p>看下 22222.png:<br> <img src="https://images2.imgbox.com/78/b8/OTtz4NJX_o.png" alt="在这里插入图片描述"><br> 框没了。</p> 
<p>现在我们来去除下线：也就是干扰线降噪</p> 
<p>这个原理呢，就是来判断这个像素点旁边是不是白的，如果是说明他是干扰线，就把他也变成白的。</p> 
<pre><code>def interference_line(img):
  h, w = img.shape[:2]
  # opencv矩阵点是反的
  # img[1,2] 1:图片的高度，2：图片的宽度
  for y in range(1, w - 1):
    for x in range(1, h - 1):
      count = 0
      if img[x, y - 1] &gt; 245:
        count = count + 1
      if img[x, y + 1] &gt; 245:
        count = count + 1
      if img[x - 1, y] &gt; 245:
        count = count + 1
      if img[x + 1, y] &gt; 245:
        count = count + 1
      if count &gt; 2:
        img[x, y] = 255         #判断一圈有多少白的，超过2，就转成白的。
  cv2.imwrite('44444.png',img)
  return img
</code></pre> 
<p>看下44444.png:<br> <img src="https://images2.imgbox.com/e1/57/JhbtaIE5_o.png" alt="在这里插入图片描述"><br> 线去的差不多了。但是还有些干扰点了什么的。</p> 
<p>点降噪：</p> 
<p>点降噪的话可以自己看情况来写，也可以利用已经封装好的方法。</p> 
<p><strong>中值滤波medianBlur：</strong></p> 
<p>这个中值滤波 基本思想是用像素点邻域 灰度值的中值 来代替该像素点的灰度值，让周围的像素值接近真实的值从而消除孤立的噪声点。</p> 
<pre><code>import numpy
image = cv2.imread('44444.png')
result = numpy.array(image)
ss = cv2.medianBlur(result,5)
cv2.imwrite('66666.png',ss)
</code></pre> 
<p>看下66666.png<br> <img src="https://images2.imgbox.com/eb/4d/JSKBRW9W_o.png" alt="在这里插入图片描述"><br> 是不是好多了。你还可以再次调用这个方法。</p> 
<p><strong>高斯滤波：GaussianBlur函数：</strong></p> 
<p>高斯滤波 是需要对一个像素的周围的像素给予更多的重视。因此，可通过分配权重来重新计算这些周围点的值。这可通过高斯函数（钟形函数，即喇叭形数）的权重方案来解决</p> 
<pre><code># 将每个像素替换为该像素周围像素的均值
image1 = cv2.imread('66666.png')
result = cv2.blur(image1,(5,5))
gaussianResult = cv2.GaussianBlur(result,(5,5),1.5)
cv2.imwrite('77777.png',gaussianResult)
</code></pre> 
<p>再看77777.png<br> <img src="https://images2.imgbox.com/39/f3/tL9P1NVK_o.png" alt="在这里插入图片描述"></p> 
<p>好了，先到这吧。其实没多少东西，如果想研究下降噪的原理话，可以与我联系一起再深入学习下。</p> 
<p>完整流程代码：</p> 
<pre><code>import cv2
import numpy


def cvt(img):
  img = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
  return img

def clear_border(img):
  h, w = img.shape[:2]                          # h高、w宽
  for y in range(0, w):
    for x in range(0, h):
      if y &lt; 50 or y &gt; w - 61:     # 把在50以内的像素坐标[0,0]到[高,50],[0,宽-50]到[高，宽]，都变白色
        img[x, y] = 255
      if x &lt; 60 or x &gt; h - 60:    #  如上
        img[x, y] = 255
  cv2.imwrite('22222.png',img)
  return img

def interference_line(img):
  h, w = img.shape[:2]
  # opencv矩阵点是反的
  # img[1,2] 1:图片的高度，2：图片的宽度
  for y in range(1, w - 1):
    for x in range(1, h - 1):
      count = 0
      if img[x, y - 1] &gt; 245:
        count = count + 1
      if img[x, y + 1] &gt; 245:
        count = count + 1
      if img[x - 1, y] &gt; 245:
        count = count + 1
      if img[x + 1, y] &gt; 245:
        count = count + 1
      if count &gt; 2:
        img[x, y] = 255         #判断一圈都是白的，就转成白的。
  return img

def dian_medianBlur(image):
  result = numpy.array(image)
  image = cv2.medianBlur(result,5)
  return image

def dian_GaussianBlur(image):
  result = cv2.blur(image,(5,5))
  gaussianResult = cv2.GaussianBlur(result,(5,5),1.5)
  return gaussianResult

if __name__ == '__main__':
  img = cv2.imread('1234567.png')
  image = dian_GaussianBlur(dian_medianBlur(interference_line(clear_border(cvt(img)))))
  cv2.imwrite('88888.png',image)
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e67479890461657504ba6997d9baed53/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">sqlsever 2008 创建用户并指定该用户只能看指定的视图或表</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fbb54b310bcef954876c61a34c13ee0e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">postgresql报错28000 pg_hba.conf</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>