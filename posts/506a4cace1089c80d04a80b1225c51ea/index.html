<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java 客户端调用minio服务 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java 客户端调用minio服务" />
<meta property="og:description" content="maven项目引入jar 依赖
&lt;dependency&gt;
&lt;groupId&gt;io.minio&lt;/groupId&gt;
&lt;artifactId&gt;minio&lt;/artifactId&gt;
&lt;version&gt;8.3.5&lt;/version&gt;
&lt;/dependency&gt;
一、链接客户端
//构造方法 minio客户端
MinioClient minioClient = MinioClient.builder()
.endpoint(&#34;http://youduk1:9029&#34;)
.credentials(&#34;admin&#34;, &#34;admin456789&#34;)
.build();
System.out.println(&#34;客户端链接成功&#34;);
MinioClient minioClient =
MinioClient.builder()
.endpoint(&#34;https://play.min.io:9000&#34;)
.credentials(&#34;Q3AM3UQ867SPQQA43P2F&#34;, &#34;zuf&#43;tfteSlswRu7BJ86wekitnifILbZam1KYY3TG&#34;)
.region(&#34;eu-east-1&#34;)
.httpClient(customHttpClient)
.build();
二、桶操作
1、判断桶是否存在
boolean found =
minioClient.bucketExists(BucketExistsArgs.builder().bucket(&#34;my-bucketname&#34;).build());
if (found) {
System.out.println(&#34;my-bucketname exists&#34;);
} else {
System.out.println(&#34;my-bucketname does not exist&#34;);
}
2、创建桶
// 创建桶
boolean boo = minioClient.bucketExists(BucketExistsArgs.builder().bucket(&#34;my-bucketname1&#34;).build());
if (!boo) {
minioClient.makeBucket(MakeBucketArgs.builder().bucket(&#34;my-bucketname1&#34;).build());
System.out.println(&#34;my-bucketname1 is created successfully&#34;);
}
//创建桶指定区域
if (!minioClient.bucketExists(
BucketExistsArgs.builder().bucket(&#34;my-bucketname-in-eu&#34;).build())) {" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/506a4cace1089c80d04a80b1225c51ea/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-21T21:54:04+08:00" />
<meta property="article:modified_time" content="2022-12-21T21:54:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java 客户端调用minio服务</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><br> maven项目引入jar 依赖</p> 
<p>&lt;dependency&gt;<br>     &lt;groupId&gt;io.minio&lt;/groupId&gt;<br>     &lt;artifactId&gt;minio&lt;/artifactId&gt;<br>     &lt;version&gt;8.3.5&lt;/version&gt;<br> &lt;/dependency&gt;<br><br> 一、链接客户端<br>     //构造方法 minio客户端<br>     MinioClient minioClient =  MinioClient.builder()<br>         .endpoint("http://youduk1:9029")<br>         .credentials("admin", "admin456789")<br>            .build();<br>     System.out.println("客户端链接成功");<br>     <br>     <br>     MinioClient minioClient =<br>     MinioClient.builder()<br>         .endpoint("https://play.min.io:9000")<br>         .credentials("Q3AM3UQ867SPQQA43P2F", "zuf+tfteSlswRu7BJ86wekitnifILbZam1KYY3TG")<br>         .region("eu-east-1")<br>         .httpClient(customHttpClient)<br>         .build();<br>     <br> 二、桶操作<br> 1、判断桶是否存在<br>   boolean found =<br>           minioClient.bucketExists(BucketExistsArgs.builder().bucket("my-bucketname").build());<br>   if (found) {<!-- --><br>       System.out.println("my-bucketname exists");<br>   } else {<!-- --><br>       System.out.println("my-bucketname does not exist");<br>   }<br><br> 2、创建桶<br>          // 创建桶<br>         boolean boo = minioClient.bucketExists(BucketExistsArgs.builder().bucket("my-bucketname1").build());<br>         if (!boo) {<!-- --><br>             minioClient.makeBucket(MakeBucketArgs.builder().bucket("my-bucketname1").build());<br>             System.out.println("my-bucketname1 is created successfully");<br>         }<br>         //创建桶指定区域<br>         if (!minioClient.bucketExists(<br>                 BucketExistsArgs.builder().bucket("my-bucketname-in-eu").build())) {<!-- --><br>             minioClient.makeBucket(<br>                     MakeBucketArgs.builder().bucket("my-bucketname-in-eu").region("eu-west-1").build());<br>             System.out.println("my-bucketname-in-eu is created successfully");<br>         }<br>         // Create bucket 'my-bucketname-in-eu-with-object-lock' in 'eu-west-1' with object lock<br>         // functionality enabled.</p> 
<p>        //创建桶，加入锁<br>         if (!minioClient.bucketExists(<br>                 BucketExistsArgs.builder().bucket("my-bucketname-in-eu-with-object-lock").build())) {<!-- --><br>             minioClient.makeBucket(<br>                     MakeBucketArgs.builder()<br>                             .bucket("my-bucketname-in-eu-with-object-lock")<br>                             .region("eu-west-1")<br>                             .objectLock(true)<br>                             .build());<br>             System.out.println("my-bucketname-in-eu-with-object-lock is created successfully");<br>         }<br><br> 3、列出所有桶<br> // 列出所有桶<br> List&lt;Bucket&gt; bucketList = minioClient.listBuckets();<br> for (Bucket bucket : bucketList) {<!-- --><br>     System.out.println(bucket.creationDate() + ", " + bucket.name());<br> }</p> 
<p>//列出所有桶，包括桶的信息。<br> List&lt;Bucket&gt; bucketList = minioClient.listBuckets(ListBuckets.builder().extraHeaders(headers).build());<br> for (Bucket bucket : bucketList) {<!-- --><br>   System.out.println(bucket.creationDate() + ", " + bucket.name());<br> }</p> 
<p><br> //获取加密通getBucketEncryption<br> SseConfiguration config =<br>     minioClient.getBucketEncryption(<br>         GetBucketEncryptionArgs.builder().bucket("my-bucketname").build());</p> 
<p>//获取生命周期桶getBucketLifecycle<br> LifecycleConfiguration config =<br>     minioClient.getBucketLifecycle(<br>         GetBucketLifecycleArgs.builder().bucket("my-bucketname").build());<br> System.out.println("Lifecycle configuration: " + config);</p> 
<p>//获取通知桶信息getBucketNotification<br> NotificationConfiguration config =<br>     minioClient.getBucketNotification(<br>         GetBucketNotificationArgs.builder().bucket("my-bucketname").build());<br> //获取策略桶信息getBucketPolicy        <br> String config =<br>     minioClient.getBucketPolicy(GetBucketPolicyArgs.builder().bucket("my-bucketname").build());<br> //获取复制桶getBucketReplication   <br> ReplicationConfiguration config =<br>     minioClient.getBucketReplication(<br>         GetBucketReplicationArgs.builder().bucket("my-bucketname").build());<br> //获取标签桶getBucketTags       <br> Tags tags = minioClient.getBucketTags(GetBucketTagsArgs.builder().bucket("my-bucketname").build());<br> 获取版本桶getBucketVersioning<br> VersioningConfiguration config =<br>     minioClient.getBucketVersioning(<br>         GetBucketVersioningArgs.builder().bucket("my-bucketname").build());<br> //获取对象锁的桶信息getObjectLockConfiguration        <br> ObjectLockConfiguration config =<br>     minioClient.getObjectLockConfiguration(<br>         GetObjectLockConfigurationArgs.builder().bucket("my-bucketname").build());<br> System.out.println("Mode: " + config.mode());<br> System.out.println("Duration: " + config.duration().duration() + " " + config.duration().unit());</p> 
<p><br><br> 4、删除一个桶。<br> 注意: - removeBucket不会删除存储桶里的对象，你需要通过removeObject API来删除它们。</p> 
<p>  boolean found =  minioClient.bucketExists(BucketExistsArgs.builder().bucket("my-bucketname").build());<br>   if (found) {<!-- --><br>      minioClient.removeBucket(RemoveBucketArgs.builder().bucket("my-bucketname").build());<br>     System.out.println("my-bucketname is removed successfully");<br>   } else {<!-- --><br>     System.out.println("my-bucketname does not exist");<br>   }<br>   <br>   //删除加密桶<br>   minioClient.deleteBucketEncryption(DeleteBucketEncryptionArgs.builder().bucket("my-bucketname").build());<br>   //删除桶生命周期<br>   minioClient.deleteBucketLifecycle(DeleteBucketLifecycleArgs.builder().bucket("my-bucketname").build());<br>   //删除桶标签<br>   minioClient.deleteBucketTags(DeleteBucketTagsArgs.builder().bucket("my-bucketname").build());<br>   //删除桶策略<br>   minioClient.deleteBucketTags(DeleteBucketPolicyArgs.builder().bucket("my-bucketname").build());<br>   //删除桶复制配置<br>   minioClient.deleteBucketReplication(DeleteBucketReplicationArgs.builder().bucket("my-bucketname").build());<br>   //删除桶通知<br>   minioClient.deleteBucketNotification(DeleteBucketNotificationArgs.builder().bucket("my-bucketname").build());<br>   //删除桶对象锁object-lock配置在<br>   minioClient.deleteObjectLockConfiguration(DeleteObjectLockConfigurationArgs.builder().bucket("my-bucketname").build()); <br><br> 5、监听通信息<br> String[] events = {"s3:ObjectCreated:*", "s3:ObjectAccessed:*"};<br> try (CloseableIterator&lt;Result&lt;NotificationRecords&gt;&gt; ci =<br>              minioClient.listenBucketNotification(<br>                      ListenBucketNotificationArgs.builder()<br>                              .bucket("bucketName")<br>                              .prefix("")<br>                              .suffix("")<br>                              .events(events)<br>                              .build())) {<!-- --><br>     while (ci.hasNext()) {<!-- --><br>         NotificationRecords records = ci.next().get();<br>         for (Event event : records.events()) {<!-- --><br>             System.out.println("Event " + event.eventType() + " occurred at " + event.eventTime()<br>                     + " for " + event.bucketName() + "/" + event.objectName());<br>         }<br>     }<br> }<br><br> 6、列出桶中所有对象<br>        //列出桶中对象<br>        Iterable&lt;Result&lt;Item&gt;&gt; results =<br>                 minioClient.listObjects(ListObjectsArgs.builder().bucket("my-bucketname").build());<br>         for (Result&lt;Item&gt; result : results) {<!-- --><br>             Item item = result.get();<br>             System.out.println(item.lastModified() + "\t" + item.size() + "\t" + item.objectName());<br>         }</p> 
<p>           minioClient.listObjects(<br>                         ListObjectsArgs.builder()<br>                             .bucket("my-bucketname")<br>                             .recursive(true) //是否递归查找，如果是false,就模拟文件夹结构查找。<br>                             .useApiVersion1(false) //boolean    如果是true, 使用版本1 REST API<br>                             .startAfter("ExampleGuide.pdf")  //在ExampleGuide.pdf之后<br>                             .prefix("新建") //对象名称的前缀<br>                             .maxKeys(100)//列出最多100个<br>                             .build()<br>         );<br>         for (Result&lt;Item&gt; result : results1) {<!-- --><br>             Item item = result.get();<br>             System.out.println(item.lastModified() + "\t" + item.size() + "\t" + item.objectName());<br>         }<br><br> 7、设置桶信息<br> //设置加密<br> minioClient.setBucketEncryption(<br>         SetBucketEncryptionArgs.builder().bucket("my-bucketname").config(SseConfiguration.newConfigWithSseS3Rule()).build());<br> //设置生命周期<br> List&lt;LifecycleRule&gt; rules = new LinkedList&lt;&gt;();<br> rules.add(<br>     new LifecycleRule(<br>         Status.ENABLED,<br>         null,<br>         null,<br>         new RuleFilter("documents/"),<br>         "rule1",<br>         null,<br>         null,<br>         new Transition((ZonedDateTime) null, 30, "GLACIER")));<br> rules.add(<br>     new LifecycleRule(<br>         Status.ENABLED,<br>         null,<br>         new Expiration((ZonedDateTime) null, 365, null),<br>         new RuleFilter("logs/"),<br>         "rule2",<br>         null,<br>         null,<br>         null));<br> LifecycleConfiguration config = new LifecycleConfiguration(rules);<br> minioClient.setBucketLifecycle(<br>     SetBucketLifecycleArgs.builder().bucket("my-bucketname").config(config).build());<br> //设置通知<br> List&lt;EventType&gt; eventList = new LinkedList&lt;&gt;();<br> eventList.add(EventType.OBJECT_CREATED_PUT);<br> eventList.add(EventType.OBJECT_CREATED_COPY);<br> QueueConfiguration queueConfiguration = new QueueConfiguration();<br> queueConfiguration.setQueue("arn:minio:sqs::1:webhook");<br> queueConfiguration.setEvents(eventList);<br> queueConfiguration.setPrefixRule("images");<br> queueConfiguration.setSuffixRule("pg");</p> 
<p>List&lt;QueueConfiguration&gt; queueConfigurationList = new LinkedList&lt;&gt;();<br> queueConfigurationList.add(queueConfiguration);</p> 
<p>NotificationConfiguration config = new NotificationConfiguration();<br> config.setQueueConfigurationList(queueConfigurationList);</p> 
<p>minioClient.setBucketNotification(<br>     SetBucketNotificationArgs.builder().bucket("my-bucketname").config(config).build());</p> 
<p>//设置规则<br> // Assume policyJson contains below JSON string;<br> // {<!-- --><br> //     "Statement": [<br> //         {<!-- --><br> //             "Action": [<br> //                 "s3:GetBucketLocation",<br> //                 "s3:ListBucket"<br> //             ],<br> //             "Effect": "Allow",<br> //             "Principal": "*",<br> //             "Resource": "arn:aws:s3:::my-bucketname"<br> //         },<br> //         {<!-- --><br> //             "Action": "s3:GetObject",<br> //             "Effect": "Allow",<br> //             "Principal": "*",<br> //             "Resource": "arn:aws:s3:::my-bucketname/myobject*"<br> //         }<br> //     ],<br> //     "Version": "2012-10-17"<br> // }<br> //<br> minioClient.setBucketPolicy(<br>     SetBucketPolicyArgs.builder().bucket("my-bucketname").config(policyJson).build());<br>     <br> //设置副本<br> Map&lt;String, String&gt; tags = new HashMap&lt;&gt;();<br> tags.put("key1", "value1");<br> tags.put("key2", "value2");</p> 
<p>ReplicationRule rule =<br>     new ReplicationRule(<br>         new DeleteMarkerReplication(Status.DISABLED),<br>         new ReplicationDestination(<br>             null, null, "REPLACE-WITH-ACTUAL-DESTINATION-BUCKET-ARN", null, null, null, null),<br>         null,<br>         new RuleFilter(new AndOperator("TaxDocs", tags)),<br>         "rule1",<br>         null,<br>         1,<br>         null,<br>         Status.ENABLED);</p> 
<p>List&lt;ReplicationRule&gt; rules = new LinkedList&lt;&gt;();<br> rules.add(rule);</p> 
<p>ReplicationConfiguration config =<br>     new ReplicationConfiguration("REPLACE-WITH-ACTUAL-ROLE", rules);</p> 
<p>minioClient.setBucketReplication(<br>     SetBucketReplicationArgs.builder().bucket("my-bucketname").config(config).build());<br>  <br> //设置标签<br> Map&lt;String, String&gt; map = new HashMap&lt;&gt;();<br> map.put("Project", "Project One");<br> map.put("User", "jsmith");<br> minioClient.setBucketTags(SetBucketTagsArgs.builder().bucket("my-bucketname").tags(map).build());</p> 
<p>//设置新版本<br> minioClient.setBucketVersioning(<br>     SetBucketVersioningArgs.builder().bucket("my-bucketname").config(config).build());<br> //设置对象锁配置<br> ObjectLockConfiguration config = new ObjectLockConfiguration(RetentionMode.COMPLIANCE, new RetentionDurationDays(100));<br> minioClient.setObjectLockConfiguration(SetObjectLockConfigurationArgs.builder().bucket("my-bucketname").config(config).build());</p> 
<p><br> 三、对象操作<br> 1、对象合并<br>   List&lt;ComposeSource&gt; sourceObjectList = new ArrayList&lt;ComposeSource&gt;();<br>         sourceObjectList.add(<br>                 ComposeSource.builder().bucket("my-bucketname").object("新建文本文档.txt").build()<br>         );<br>         sourceObjectList.add(<br>                 ComposeSource.builder().bucket("my-bucketname").object("新建文本文档1.txt").build()<br>         );<br>         sourceObjectList.add(<br>                 ComposeSource.builder().bucket("my-bucketname").object("新建文本文档2.txt").build()<br>         );<br>         System.out.println(sourceObjectList.size());<br>         //创建对象my-bucketname/composeObject1 组合列表合并的数据<br> //        minioClient.composeObject(<br> //                ComposeObjectArgs.builder()<br> //                        .bucket("my-bucketname")<br> //                        .object("composeObject1")<br> //                        .sources(sourceObjectList)<br> //                        .build());<br>         //创建对象my-bucketname/composeObject2 组合列表合并的数据, 用户结合源对象的元数据<br>         Map&lt;String, String&gt; userMetadata = new HashMap&lt;&gt;();<br>         userMetadata.put("My-Project", "ProjectOne");<br> //        minioClient.composeObject(<br> //        ComposeObjectArgs.builder()<br> //                .bucket("my-bucketname")<br> //                .object("composeObject2")<br> //                .sources(sourceObjectList)<br> //                .userMetadata(userMetadata)<br> //                .build());</p> 
<p><br>         //加密<br>         ServerSideEncryptionCustomerKey srcSsec =<br>                 new ServerSideEncryptionCustomerKey(<br>                         new SecretKeySpec(<br>                                 "01234567890123456789012345678901".getBytes(StandardCharsets.UTF_8), "AES"));<br>         minioClient.composeObject(<br>                 ComposeObjectArgs.builder()<br>                         .bucket("my-bucketname")<br>                         .object("my-objectname")<br>                         .sources(sourceObjectList)<br>                         .userMetadata(userMetadata)<br> //                        .ssec(srcSsec)<br>                         .build());</p> 
<p><br>         ServerSideEncryption sse =<br>                 new ServerSideEncryptionCustomerKey(<br>                         new SecretKeySpec(<br>                                 "12345678912345678912345678912345".getBytes(StandardCharsets.UTF_8), "AES"));<br>         minioClient.composeObject(<br>                 ComposeObjectArgs.builder()<br>                         .bucket("my-destination-bucket")<br>                         .object("my-destination-object")<br>                         .sources(sourceObjectList)<br>                         .userMetadata(userMetadata)<br>                         .sse(sse)<br>                         .build());<br><br> 2、对象复制<br> //创建一个对象my-bucketname/my-objectname  数据从my-source-bucketname中复制过来<br> minioClient.copyObject(<br>         CopyObjectArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 //.srcBucket("my-source-bucketname")<br>                 .source(<br>                         CopySource.builder()<br>                                 .bucket("my-source-bucketname")<br>                                 .build())<br>                 .build());<br> //创建一个对象my-bucketname/my-objectname  数据从my-source-bucketname/my-source-objectname对象中复制过来<br> minioClient.copyObject(<br>         CopyObjectArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 .source(<br>                         CopySource.builder()<br>                                 .bucket("my-source-bucketname")<br>                                 .object("my-source-objectname")<br>                                 .build())<br>                 .build());<br> //  //创建一个对象my-bucketname/my-objectname  数据从my-source-bucketname中复制过来 数据sse加密</p> 
<p>ServerSideEncryption sse =<br>         new ServerSideEncryptionCustomerKey(<br>                 new SecretKeySpec(<br>                         "12345678912345678912345678912345".getBytes(StandardCharsets.UTF_8), "AES"));<br> minioClient.copyObject(<br>         CopyObjectArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 .source(<br>                         CopySource.builder()<br>                                 .bucket("my-source-bucketname")<br>                                 .build())<br>                 .sse(sse)<br>                 .build());</p> 
<p>Map&lt;String, String&gt; headersCopy = new HashMap&lt;String,String&gt;();<br> headersCopy.put("Content-Type","json/plain");<br> Map&lt;String, String&gt; tag = new HashMap&lt;String,String&gt;();<br> tag.put("test","miniotest");<br> tag.put("label","miniotest");<br> //创建一个对象my-bucketname/my-objectname  数据从my-source-bucketname中复制过来  用户自定义headers信息<br> minioClient.copyObject(<br>         CopyObjectArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 .source(<br>                         CopySource.builder()<br>                                 .bucket("my-source-bucketname")<br>                                 .build())<br>                 .headers(headersCopy)<br>                 .tags(tag)<br>                 .build());<br><br> 3、删除对象标签<br> minioClient.deleteObjectTags(<br>         DeleteObjectTagsArgs.builder().bucket("my-bucketname").object("my-objectname").build());<br> 1<br> 2<br> 4、禁用对象<br> // Disables legal hold on an object.<br> minioClient.disableObjectLegalHold(<br>         DisableObjectLegalHoldArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 .build());<br> 1<br> 2<br> 3<br> 4<br> 5<br> 6<br> 5、启用对象<br> // Disables legal hold on an object.<br> minioClient.enableObjectLegalHold(<br>         EnableObjectLegalHoldArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 .build());<br><br> 6、获取对象<br> //获得对象流<br> try (InputStream stream = minioClient.getObject(<br>         GetObjectArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 .build())) {<!-- --><br>     // Read data from stream<br> }<br> // 获得对象流 。设置偏移量 seek用法相同<br> try (InputStream stream = minioClient.getObject(<br>         GetObjectArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 .offset(1024L)<br>                 .build())) {<!-- --><br>     // Read data from stream<br> }<br> // 获取读取流长度<br> try (InputStream stream = minioClient.getObject(<br>         GetObjectArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 .offset(1024L)<br>                 .length(4096L)<br>                 .build())) {<!-- --><br>     // Read data from stream<br> }</p> 
<p>ServerSideEncryptionCustomerKey srcSsec =<br> new ServerSideEncryptionCustomerKey(<br>         new SecretKeySpec(<br>                 "01234567890123456789012345678901".getBytes(StandardCharsets.UTF_8), "AES"));<br> // 获取读取 sse-c 加密文件<br> try (InputStream stream = minioClient.getObject(<br>         GetObjectArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 .ssec(srcSsec)<br>                 .build())) {<!-- --><br>     // Read data from stream<br> }<br> // 获取读取 sse-c 加密文件  带偏移量 带长度<br> try (InputStream stream = minioClient.getObject(<br>         GetObjectArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 .offset(1024L)<br>                 .length(4096L)<br>                 .ssec(srcSsec)<br>                 .build())) {<!-- --><br>     // Read data from stream<br> }<br><br> 7、下载对象<br> //下载文件到输出流my-filename<br> minioClient.downloadObject(<br>         DownloadObjectArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 .filename("my-filename")<br>                 .build());<br> System.out.println("my-objectname is successfully downloaded to my-filename");</p> 
<p>//下载带有密码的文件<br> ServerSideEncryptionCustomerKey srcSsec =<br>         new ServerSideEncryptionCustomerKey(<br>                 new SecretKeySpec(<br>                         "01234567890123456789012345678901".getBytes(StandardCharsets.UTF_8), "AES"));<br> minioClient.downloadObject(<br>         DownloadObjectArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 .ssec(srcSsec)<br>                 .filename("my-object-file")<br>                 .build());<br><br> 8、获取对象副本<br>  // Object with version id.<br>     Retention retention =<br>             minioClient.getObjectRetention(<br>                     GetObjectRetentionArgs.builder()<br>                             .bucket("my-bucketname")<br>                             .object("my-objectname")<br>                             .versionId("object-version-id")<br>                             .build());<br>     System.out.println("mode: " + retention.mode() + "until: " + retention.retainUntilDate());</p> 
<p><br> 9、获取对象标签<br> Tags tags = minioClient.getObjectTags(<br>         GetObjectTagsArgs.builder().bucket("my-bucketname").object("my-objectname").build());<br> 1<br> 2<br> 10、获得预对象路径<br> String url =  minioClient.getPresignedObjectUrl(<br>                 GetPresignedObjectUrlArgs.builder()<br>                         .method(Method.GET) //get 方法<br>                         .bucket("my-bucketname") // 名称<br>                         .object("miniotest.txt") //对象名称<br>                         .expiry(2, TimeUnit.HOURS) //过期时间<br>                         .extraQueryParams(reqParams)  //参数配置<br>                         .build());<br> System.out.println(url);<br> //设置过期时间为1天<br> String url1 =<br>         minioClient.getPresignedObjectUrl(<br>                 GetPresignedObjectUrlArgs.builder()<br>                         .method(Method.PUT)<br>                         .bucket("my-bucketname")<br>                         .object("my-objectname")<br>                         .expiry(1, TimeUnit.DAYS)  //设置过期1天<br>                         .build());<br> System.out.println(url1);<br> String url3 =<br>         minioClient.getPresignedObjectUrl(<br>                 GetPresignedObjectUrlArgs.builder()<br>                         .method(Method.HEAD)<br>                         .bucket("my-bucketname")<br>                         .object("my-objectname")<br>                         .expiry(2, TimeUnit.HOURS)<br>                         .extraQueryParams(reqParams)<br>                         .build());<br> System.out.println(url3);<br> 1<br> 2<br> 3<br> 4<br> 5<br> 6<br> 7<br> 8<br> 9<br> 10<br> 11<br> 12<br> 13<br> 14<br> 15<br> 16<br> 17<br> 18<br> 19<br> 20<br> 21<br> 22<br> 23<br> 24<br> 25<br> 26<br> 27<br> 28<br> 29<br> 11、对象是否合法<br> //查看对象是否可用<br> boolean status =<br>         minioClient.isObjectLegalHoldEnabled(<br>                 IsObjectLegalHoldEnabledArgs.builder()<br>                         .bucket("my-bucketname")<br>                         .object("my-objectname")<br>                         .versionId("object-versionId")<br>                         .build());<br> if (status) {<!-- --><br>     System.out.println("Legal hold is on");<br> }<br> else {<!-- --><br>         System.out.println("Legal hold is off");<br> }<br> 1<br> 2<br> 3<br> 4<br> 5<br> 6<br> 7<br> 8<br> 9<br> 10<br> 11<br> 12<br> 13<br> 14<br> 12、form-data表达上传数据<br> //创建一个桶  规则7 天后过期<br> PostPolicy policy = new PostPolicy("my-bucketname", ZonedDateTime.now().plusDays(7));<br> //设置对象名<br> policy.addEqualsCondition("key", "test.jpg");<br> //设置Content-Type条件<br> policy.addStartsWithCondition("Content-Type", "image/");<br> //设置上传文件大小between 64kiB to 10MiB.<br> policy.addContentLengthRangeCondition(/*64 * 1024*/ 0, 10 * 1024 * 1024);<br> Map&lt;String, String&gt; formData = minioClient.getPresignedPostFormData(policy);<br> // Upload an image using POST object with form-data.<br> MultipartBody.Builder multipartBuilder = new MultipartBody.Builder();<br> multipartBuilder.setType(MultipartBody.FORM);<br> for (Map.Entry&lt;String, String&gt; entry : formData.entrySet()) {<!-- --><br>     multipartBuilder.addFormDataPart(entry.getKey(), entry.getValue());<br> }<br> multipartBuilder.addFormDataPart("key", "test.jpg");<br> multipartBuilder.addFormDataPart("Content-Type", "image/png");<br> multipartBuilder.addFormDataPart(<br>         "file", "test.jpg", RequestBody.create(new File("d://pictures.jpg"), null)<br> );<br> Request request =<br>         new Request.Builder()<br>                 .url("http://youduk1:9029/my-bucketname")<br>                 .post(multipartBuilder.build())<br>                 .build();<br> OkHttpClient httpClient = new OkHttpClient().newBuilder().build();<br> Response response = httpClient.newCall(request).execute();<br> if (response.isSuccessful()) {<!-- --><br>     System.out.println("Pictures/avatar.png is uploaded successfully using POST object");<br> } else {<!-- --><br>     System.out.println("Failed to upload Pictures/avatar.png");<br> }<br> 1<br> 2<br> 3<br> 4<br> 5<br> 6<br> 7<br> 8<br> 9<br> 10<br> 11<br> 12<br> 13<br> 14<br> 15<br> 16<br> 17<br> 18<br> 19<br> 20<br> 21<br> 22<br> 23<br> 24<br> 25<br> 26<br> 27<br> 28<br> 29<br> 30<br> 31<br> 32<br> 13、上传流数据到对象<br>           //上传已经长度的流<br>         File f = new File("D://pictures.jpg");<br>         InputStream inputStream =new FileInputStream(f);<br>         minioClient.putObject(<br>                 PutObjectArgs.builder().bucket("my-bucketname").object("test2.jpg").stream(<br>                         inputStream, f.length(), -1)<br>                         .contentType("image/jpg")<br>                         .build());<br>         //上传未知长度的流<br>         minioClient.putObject(<br>                 PutObjectArgs.builder().bucket("my-bucketname").object("test3.jpg").stream(<br>                         inputStream, -1, 10485760)<br>                         .contentType("image/jpg")<br>                         .build());<br>         //创建路径<br>         minioClient.putObject(<br>                 PutObjectArgs.builder().bucket("my-bucketname").object("path/to/").stream(<br>                         new ByteArrayInputStream(new byte[] {}), 0, -1)<br>                         .build());<br>         //上传带有标题和用户元数据的输入流。<br>         Map&lt;String, String&gt; headers = new HashMap&lt;&gt;();<br>         headers.put("X-Amz-Storage-Class", "REDUCED_REDUNDANCY");<br>         Map&lt;String, String&gt; userMetadata = new HashMap&lt;&gt;();<br>         userMetadata.put("My-Project", "Project One");<br>         minioClient.putObject(<br>                 PutObjectArgs.builder().bucket("my-bucketname").object("path/to/test4.jpg").stream(<br>                         inputStream, f.length(), -1)<br>                         .headers(headers)<br>                         .userMetadata(userMetadata)<br>                         .build());<br>         //上传文件加密<br>         ServerSideEncryption sse =<br>                 new ServerSideEncryptionCustomerKey(<br>                         new SecretKeySpec(<br>                                 "12345678912345678912345678912345".getBytes(StandardCharsets.UTF_8), "AES"));<br>         minioClient.putObject(<br>                 PutObjectArgs.builder().bucket("my-bucketname").object("my-objectname").stream(<br>                         inputStream, f.length(), -1)<br>                         .sse(sse)<br>                         .build());<br> 1<br> 2<br> 3<br> 4<br> 5<br> 6<br> 7<br> 8<br> 9<br> 10<br> 11<br> 12<br> 13<br> 14<br> 15<br> 16<br> 17<br> 18<br> 19<br> 20<br> 21<br> 22<br> 23<br> 24<br> 25<br> 26<br> 27<br> 28<br> 29<br> 30<br> 31<br> 32<br> 33<br> 34<br> 35<br> 36<br> 37<br> 38<br> 39<br> 40<br> 14、上传文件<br> // 上传json文件.<br> minioClient.uploadObject(<br>         UploadObjectArgs.builder()<br>                 .bucket("my-bucketname").object("my-objectname").filename("d://person.json").build());<br> // 上传mp4文件<br> minioClient.uploadObject(<br>         UploadObjectArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 .filename("D:/my-video.avi")<br>                 .contentType("video/mp4")<br>                 .build());<br> 1<br> 2<br> 3<br> 4<br> 5<br> 6<br> 7<br> 8<br> 9<br> 10<br> 11<br> 12<br> 15、批量上传多个文件<br>     List&lt;SnowballObject&gt; objects = new ArrayList&lt;SnowballObject&gt;();<br>     objects.add(<br>             new SnowballObject(<br>                     "my-object-one",<br>                     new ByteArrayInputStream("hello".getBytes(StandardCharsets.UTF_8)),<br>                     5,<br>                     null));<br>     objects.add(<br>             new SnowballObject(<br>                     "my-object-two",<br>                     new ByteArrayInputStream("java".getBytes(StandardCharsets.UTF_8)),<br>                     4,<br>                     null));<br>     minioClient.uploadSnowballObjects(<br>             UploadSnowballObjectsArgs.builder().bucket("my-bucketname").objects(objects).build());<br><br> 16、删除对象<br> // 删除对象<br> minioClient.removeObject(<br>         RemoveObjectArgs.builder().bucket("my-bucketname").object("my-objectname").build());</p> 
<p>// 删除对应版本的对象<br> minioClient.removeObject(<br>         RemoveObjectArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-versioned-objectname")<br>                 .versionId("my-versionid")<br>                 .build());</p> 
<p>// 绕过治理模式删除版本化对象。<br> minioClient.removeObject(<br>         RemoveObjectArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-versioned-objectname")<br>                 .versionId("my-versionid")<br>                 .bypassGovernanceMode(true)<br>                 .build());<br><br> 17、批量删除对象<br> List&lt;DeleteObject&gt; objects = new LinkedList&lt;&gt;();<br> objects.add(new DeleteObject("my-objectname1"));<br> objects.add(new DeleteObject("my-objectname2"));<br> objects.add(new DeleteObject("my-objectname3"));<br> Iterable&lt;Result&lt;DeleteError&gt;&gt; results =<br>         minioClient.removeObjects(<br>                 RemoveObjectsArgs.builder().bucket("my-bucketname").objects(objects).build());<br> for (Result&lt;DeleteError&gt; result : results) {<!-- --><br>     DeleteError error = result.get();<br>     System.out.println(<br>             "Error in deleting object " + error.objectName() + "; " + error.message());<br> }<br><br> 18、选取对象内容<br> 选择内容对象的SQL表达式</p> 
<p>String sqlExpression = "select * from S3Object limit  0,10 ";<br> InputSerialization is = new InputSerialization(null, false, null, null, FileHeaderInfo.USE, null, null, null);<br> OutputSerialization os = new OutputSerialization(null, null, null, QuoteFields.ASNEEDED, null);<br> SelectResponseStream stream =<br>         minioClient.selectObjectContent(<br>                 SelectObjectContentArgs.builder()<br>                         .bucket("my-bucketname")<br>                         .object("miniotest.txt")<br>                         .sqlExpression(sqlExpression)<br>                         .inputSerialization(is)<br>                         .outputSerialization(os)<br>                         .requestProgress(true)<br>                         .build());</p> 
<p>byte[] buf = new byte[512];<br> int bytesRead = stream.read(buf, 0, buf.length);<br> System.out.println(new String(buf, 0, bytesRead, StandardCharsets.UTF_8));</p> 
<p>Stats stats = stream.stats();<br> System.out.println("bytes scanned: " + stats.bytesScanned());<br> System.out.println("bytes processed: " + stats.bytesProcessed());<br> System.out.println("bytes returned: " + stats.bytesReturned());</p> 
<p>stream.close();<br><br> 19、设置对象保留配置<br> Retention retention = new Retention(RetentionMode.COMPLIANCE, ZonedDateTime.now().plusYears(1));<br> minioClient.setObjectRetention(<br>         SetObjectRetentionArgs.builder()<br>                 .bucket("my-bucketname")<br>                 .object("my-objectname")<br>                 .config(retention)<br>                 .bypassGovernanceMode(true)<br>                 .build());<br> 1<br> 2<br> 3<br> 4<br> 5<br> 6<br> 7<br> 8<br> 20、为对象设置标签<br> Map&lt;String, String&gt; map = new HashMap&lt;&gt;();<br> map.put("Project", "Project One");<br> map.put("User", "jsmith");<br> minioClient.setObjectTags(<br>         SetObjectTagsArgs.builder().bucket("my-bucketname").object("miniotest.txt").tags(map).build());<br><br> 21、获取对象信息和元数据对象<br> ServerSideEncryptionCustomerKey srcSsec =<br>         new ServerSideEncryptionCustomerKey(<br>                 new SecretKeySpec(<br>                         "01234567890123456789012345678901".getBytes(StandardCharsets.UTF_8), "AES"));<br> // 获取对象信息<br> StatObjectResponse objectStat =<br>         minioClient.statObject(<br>                 StatObjectArgs.builder().bucket("my-bucketname").object("my-objectname").build());<br> // 获取SSE-C加密对象<br> StatObjectResponse objectStat1 =<br>         minioClient.statObject(<br>                 StatObjectArgs.builder()<br>                         .bucket("my-bucketname")<br>                         .object("my-objectname")<br>                         .ssec(srcSsec)<br>                         .build());</p> 
<p>// 获取带版本的对象<br> StatObjectResponse objectStat2 =<br>         minioClient.statObject(<br>                 StatObjectArgs.builder()<br>                         .bucket("my-bucketname")<br>                         .object("my-objectname")<br>                         .versionId("version-id")<br>                         .build());<br> // 获取带版本号的SSE-C加密对象<br> StatObjectResponse objectStat3 =<br>         minioClient.statObject(<br>                 StatObjectArgs.builder()<br>                         .bucket("my-bucketname")<br>                         .object("my-objectname")<br>                         .versionId("version-id")<br>                         .ssec(srcSsec)<br>                         .build());<br><br> 文章知识点与官方知识档案匹配，可进一步学习相关知<br>  </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9bc33ead0722cc53d968eeaeac8f3bc5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">网络编程套接字Socket(通过两个用例,逐行注释,详细理解)干活满满建议收藏</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8cb1a542a50193ce55fb6bae67ec3173/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">word导航窗格应用：如何对文档进行快速查找定位？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>