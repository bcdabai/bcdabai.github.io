<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>2023年第四届MathorCup大数据挑战赛（B题）|电商零售商家需求预测及库存优化问题|数学建模完整代码&#43;建模过程全解全析 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="2023年第四届MathorCup大数据挑战赛（B题）|电商零售商家需求预测及库存优化问题|数学建模完整代码&#43;建模过程全解全析" />
<meta property="og:description" content="让我们来看看MathorCup的B题！
问题重述 这是一个电商零售商家需求预测及库存优化问题的描述。这个问题涉及到电商平台上的上千个商家，它们将商品放在不同的仓库中，而电商平台需要进行供应链管理，以降低库存成本并保证按时交货。主要问题包括需求预测和库存优化。
问题一：使用历史出货量数据（附件1）和相关附件中的信息，需要预测各商家在各仓库的商品在2023年5月16日至2023年5月30日的需求量。预测的结果需要填写在结果表1，并上传至竞赛平台。同时，需要对模型的预测性能进行评价，并讨论如何对这些时间序列进行分类以找到相似特征。
问题二：有一些新的商家&#43;仓库&#43;商品维度出现（附件5），需要根据历史数据（附件1）找到相似序列并预测这些新维度在2023年5月16日至2023年5月30日的需求量。预测结果需要填写在结果表2，并上传至竞赛平台。
问题三：每年6月有大型促销，给需求预测和履约带来挑战。附件6提供了去年双十一期间的需求量数据，需要参考这些数据并给出2023年6月1日至2023年6月20日的需求量预测值，填写在结果表3中并上传至竞赛平台。
问题一 问题一涉及对各商家在各仓库的商品需求进行预测，此题我们使用ARIMA模型来进行预测。
步骤1：数据预处理
首先，对历史出货量数据进行预处理，包括数据清洗、缺失值处理等，以确保数据的质量和一致性。对附件2-4的信息也进行必要的数据关联，以便使用商品、商家和仓库的特征信息。
步骤2：时间序列分类
根据问题描述，需要对不同商家、仓库和商品的时间序列进行分类，以找到相似的特征。这可以通过以下步骤来实现：
a. 对每个商家在各仓库的商品需求量序列进行聚类分析，例如使用K均值聚类。
b. 对聚类后的序列进行统计特征提取，如平均值、标准差、季节性等。
c. 基于提取的特征，使用聚类结果将序列分为不同的类别。
步骤3：需求预测
对于每个时间序列类别，使用ARIMA模型进行需求预测。
步骤4：模型评价
评估模型的性能可以使用各种指标，如1-wmape，MAE，RMSE等。1-wmape在问题描述中已经给出，可以计算每个序列的预测误差并汇总为模型整体性能。
ARIMA模型
ARIMA（AutoRegressive Integrated Moving Average）模型是一种经典的时间序列分析方法，用于对时间序列数据进行建模和预测。它结合了自回归（AR）、差分（I）和滑动平均（MA）三个组成部分，用于处理具有趋势和季节性的时间序列数据。ARIMA模型旨在捕捉数据中的自相关性和移动平均性，从而生成未来时间点的预测。 下面是ARIMA模型的核心概念：
自回归（AR）部分：ARIMA模型中的&#34;AR&#34;代表&#34;自回归&#34;。这部分考虑了时间序列中的自相关性，即过去时间点的观测值对当前时间点的影响。AR部分表示为p，它表示在模型中考虑多少期的过去观测值。例如，ARIMA(p, d, q)中的p。
差分（I）部分：ARIMA模型中的&#34;I&#34;代表&#34;差分&#34;。这部分用于处理非稳定的时间序列，即具有趋势和季节性的序列。通过差分，可以将非稳定序列转化为稳定的序列。d表示差分的次数。例如，ARIMA(p, d, q)中的d。
滑动平均（MA）部分：ARIMA模型中的&#34;MA&#34;代表&#34;滑动平均&#34;。这部分考虑了时间序列中的滑动平均性，即过去时间点的预测误差对当前时间点的影响。MA部分表示为q，它表示在模型中考虑多少期的滑动平均误差。例如，ARIMA(p, d, q)中的q。
ARIMA模型的建模步骤通常包括以下几个关键步骤：
观察时间序列数据：首先，分析时间序列数据，检查是否存在趋势、季节性以及自相关性。
差分操作：如果时间序列数据不是稳定的，需要进行差分操作，直到数据变得稳定。差分的次数由参数d决定。
模型识别：通过观察自相关函数（ACF）和偏自相关函数（PACF）的图表，确定ARIMA模型的阶数（p、d、q）。
拟合ARIMA模型：使用选定的参数，拟合ARIMA模型到时间序列数据。
模型诊断：检查模型的残差，确保其是白噪声，没有自相关性。
预测：使用拟合好的ARIMA模型生成未来时间点的预测。
在问题一中，使用ARIMA模型的主要原因是针对历史出货量数据进行需求预测。原因在于：
存在趋势和季节性：ARIMA模型适用于具有趋势和季节性的时间序列数据，这在电商领域通常是普遍存在的情况。历史出货量数据往往受季节性促销、市场趋势等因素的影响，因此需要模型来捕捉这些影响。
稳定性处理：ARIMA模型中的&#34;差分&#34;（I）部分用于将非稳定的时间序列数据转化为稳定的序列。这对于处理数据中的趋势和季节性非常重要，以便模型能够准确预测未来需求。
自相关性和滑动平均性：ARIMA模型的&#34;自回归&#34;（AR）和&#34;滑动平均&#34;（MA）部分分别考虑了时间序列数据中的自相关性和滑动平均性，从而更好地捕捉数据的内在模式。
参数调整：ARIMA模型的参数（p、d、q）可以根据时间序列数据的特点进行调整，以获得更准确的预测。这使得ARIMA模型非常灵活，适应不同类型的时间序列。
因为它可以帮助预测各商家在各仓库的商品需求，考虑了历史趋势、季节性和自相关性，有助于更好地管理库存和满足客户需求。此外，ARIMA模型的参数可以根据不同商家、仓库和商品的需求模式进行调整，从而提高预测的准确性。
代码如下：
import pandas as pd import numpy as np import statsmodels.api as sm from statsmodels.tsa.stattools import adfuller # 读取历史出货量数据 historical_data = pd." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a648205af1a0e514bae4b30e06e9442d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-03T11:10:57+08:00" />
<meta property="article:modified_time" content="2023-11-03T11:10:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2023年第四届MathorCup大数据挑战赛（B题）|电商零售商家需求预测及库存优化问题|数学建模完整代码&#43;建模过程全解全析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>让我们来看看MathorCup的B题！<br> <img src="https://images2.imgbox.com/7d/b7/d82y7Dte_o.jpg" alt="在这里插入图片描述"></p> 
<h3><a id="_4"></a>问题重述</h3> 
<p>这是一个电商零售商家需求预测及库存优化问题的描述。这个问题涉及到电商平台上的上千个商家，它们将商品放在不同的仓库中，而电商平台需要进行供应链管理，以降低库存成本并保证按时交货。主要问题包括需求预测和库存优化。</p> 
<p>问题一：使用历史出货量数据（附件1）和相关附件中的信息，需要预测各商家在各仓库的商品在2023年5月16日至2023年5月30日的需求量。预测的结果需要填写在结果表1，并上传至竞赛平台。同时，需要对模型的预测性能进行评价，并讨论如何对这些时间序列进行分类以找到相似特征。</p> 
<p>问题二：有一些新的商家+仓库+商品维度出现（附件5），需要根据历史数据（附件1）找到相似序列并预测这些新维度在2023年5月16日至2023年5月30日的需求量。预测结果需要填写在结果表2，并上传至竞赛平台。</p> 
<p>问题三：每年6月有大型促销，给需求预测和履约带来挑战。附件6提供了去年双十一期间的需求量数据，需要参考这些数据并给出2023年6月1日至2023年6月20日的需求量预测值，填写在结果表3中并上传至竞赛平台。</p> 
<h3><a id="_14"></a>问题一</h3> 
<p>问题一涉及对各商家在各仓库的商品需求进行预测，此题我们使用ARIMA模型来进行预测。</p> 
<p><strong>步骤1：数据预处理</strong><br> 首先，对历史出货量数据进行预处理，包括数据清洗、缺失值处理等，以确保数据的质量和一致性。对附件2-4的信息也进行必要的数据关联，以便使用商品、商家和仓库的特征信息。</p> 
<p><strong>步骤2：时间序列分类</strong><br> 根据问题描述，需要对不同商家、仓库和商品的时间序列进行分类，以找到相似的特征。这可以通过以下步骤来实现：</p> 
<p>a. 对每个商家在各仓库的商品需求量序列进行聚类分析，例如使用K均值聚类。</p> 
<p>b. 对聚类后的序列进行统计特征提取，如平均值、标准差、季节性等。</p> 
<p>c. 基于提取的特征，使用聚类结果将序列分为不同的类别。</p> 
<p><strong>步骤3：需求预测</strong></p> 
<p>对于每个时间序列类别，使用ARIMA模型进行需求预测。</p> 
<p><strong>步骤4：模型评价</strong><br> 评估模型的性能可以使用各种指标，如1-wmape，MAE，RMSE等。1-wmape在问题描述中已经给出，可以计算每个序列的预测误差并汇总为模型整体性能。</p> 
<p><strong>ARIMA模型</strong></p> 
<ul><li>ARIMA（AutoRegressive Integrated Moving Average）模型是一种经典的时间序列分析方法，用于对时间序列数据进行建模和预测。它结合了自回归（AR）、差分（I）和滑动平均（MA）三个组成部分，用于处理具有趋势和季节性的时间序列数据。ARIMA模型旨在捕捉数据中的自相关性和移动平均性，从而生成未来时间点的预测。</li></ul> 
<p>下面是ARIMA模型的核心概念：</p> 
<ol><li> <p><strong>自回归（AR）部分</strong>：ARIMA模型中的"AR"代表"自回归"。这部分考虑了时间序列中的自相关性，即过去时间点的观测值对当前时间点的影响。AR部分表示为p，它表示在模型中考虑多少期的过去观测值。例如，ARIMA(p, d, q)中的p。</p> </li><li> <p><strong>差分（I）部分</strong>：ARIMA模型中的"I"代表"差分"。这部分用于处理非稳定的时间序列，即具有趋势和季节性的序列。通过差分，可以将非稳定序列转化为稳定的序列。d表示差分的次数。例如，ARIMA(p, d, q)中的d。</p> </li><li> <p><strong>滑动平均（MA）部分</strong>：ARIMA模型中的"MA"代表"滑动平均"。这部分考虑了时间序列中的滑动平均性，即过去时间点的预测误差对当前时间点的影响。MA部分表示为q，它表示在模型中考虑多少期的滑动平均误差。例如，ARIMA(p, d, q)中的q。</p> </li></ol> 
<p>ARIMA模型的建模步骤通常包括以下几个关键步骤：</p> 
<ol><li> <p><strong>观察时间序列数据</strong>：首先，分析时间序列数据，检查是否存在趋势、季节性以及自相关性。</p> </li><li> <p><strong>差分操作</strong>：如果时间序列数据不是稳定的，需要进行差分操作，直到数据变得稳定。差分的次数由参数d决定。</p> </li><li> <p><strong>模型识别</strong>：通过观察自相关函数（ACF）和偏自相关函数（PACF）的图表，确定ARIMA模型的阶数（p、d、q）。</p> </li><li> <p><strong>拟合ARIMA模型</strong>：使用选定的参数，拟合ARIMA模型到时间序列数据。</p> </li><li> <p><strong>模型诊断</strong>：检查模型的残差，确保其是白噪声，没有自相关性。</p> </li><li> <p><strong>预测</strong>：使用拟合好的ARIMA模型生成未来时间点的预测。</p> </li></ol> 
<p>在问题一中，使用ARIMA模型的主要原因是针对历史出货量数据进行需求预测。原因在于：</p> 
<ol><li> <p><strong>存在趋势和季节性</strong>：ARIMA模型适用于具有趋势和季节性的时间序列数据，这在电商领域通常是普遍存在的情况。历史出货量数据往往受季节性促销、市场趋势等因素的影响，因此需要模型来捕捉这些影响。</p> </li><li> <p><strong>稳定性处理</strong>：ARIMA模型中的"差分"（I）部分用于将非稳定的时间序列数据转化为稳定的序列。这对于处理数据中的趋势和季节性非常重要，以便模型能够准确预测未来需求。</p> </li><li> <p><strong>自相关性和滑动平均性</strong>：ARIMA模型的"自回归"（AR）和"滑动平均"（MA）部分分别考虑了时间序列数据中的自相关性和滑动平均性，从而更好地捕捉数据的内在模式。</p> </li><li> <p><strong>参数调整</strong>：ARIMA模型的参数（p、d、q）可以根据时间序列数据的特点进行调整，以获得更准确的预测。这使得ARIMA模型非常灵活，适应不同类型的时间序列。</p> </li></ol> 
<p>因为它可以帮助预测各商家在各仓库的商品需求，考虑了历史趋势、季节性和自相关性，有助于更好地管理库存和满足客户需求。此外，ARIMA模型的参数可以根据不同商家、仓库和商品的需求模式进行调整，从而提高预测的准确性。<br> 代码如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> statsmodels<span class="token punctuation">.</span>api <span class="token keyword">as</span> sm
<span class="token keyword">from</span> statsmodels<span class="token punctuation">.</span>tsa<span class="token punctuation">.</span>stattools <span class="token keyword">import</span> adfuller

<span class="token comment"># 读取历史出货量数据</span>
historical_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'附件1.csv'</span><span class="token punctuation">)</span>
<span class="token comment"># 假设历史数据按日期升序排列</span>
historical_data<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>historical_data<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 定义检测时间序列稳定性的函数</span>
<span class="token keyword">def</span> <span class="token function">test_stationarity</span><span class="token punctuation">(</span>timeseries<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 进行滚动统计检验（Rolling Statistics）</span>
    rolmean <span class="token operator">=</span> timeseries<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 选择合适的窗口大小</span>
    rolstd <span class="token operator">=</span> timeseries<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 绘制滚动统计检验结果</span>
    orig <span class="token operator">=</span> plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>timeseries<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'原始数据'</span><span class="token punctuation">)</span>
    mean <span class="token operator">=</span> plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>rolmean<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'滚动均值'</span><span class="token punctuation">)</span>
    std <span class="token operator">=</span> plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>rolstd<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'滚动标准差'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'best'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'滚动均值和滚动标准差'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 进行Dicky-Fuller检验</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Dicky-Fuller检验结果：'</span><span class="token punctuation">)</span>
    dftest <span class="token operator">=</span> adfuller<span class="token punctuation">(</span>timeseries<span class="token punctuation">,</span> autolag<span class="token operator">=</span><span class="token string">'AIC'</span><span class="token punctuation">)</span>
    dfoutput <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>dftest<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Test Statistic'</span><span class="token punctuation">,</span> <span class="token string">'p-value'</span><span class="token punctuation">,</span> <span class="token string">'#Lags Used'</span><span class="token punctuation">,</span> <span class="token string">'Number of Observations Used'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> dftest<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        dfoutput<span class="token punctuation">[</span><span class="token string">'Critical Value (%s)'</span> <span class="token operator">%</span> key<span class="token punctuation">]</span> <span class="token operator">=</span> value
    <span class="token keyword">print</span><span class="token punctuation">(</span>dfoutput<span class="token punctuation">)</span>

<span class="token comment"># 做时间序列稳定性检验</span>
test_stationarity<span class="token punctuation">(</span>historical_data<span class="token punctuation">[</span><span class="token string">'qty'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 进行时间序列差分以达到稳定性</span>
<span class="token comment"># 通常需要多次差分，直到时间序列变得稳定</span>
differenced_data <span class="token operator">=</span> historical_data<span class="token punctuation">[</span><span class="token string">'qty'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>diff<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 再次进行稳定性检验</span>
test_stationarity<span class="token punctuation">(</span>differenced_data<span class="token punctuation">)</span>

<span class="token comment"># 使用ARIMA模型进行预测</span>
model <span class="token operator">=</span> sm<span class="token punctuation">.</span>tsa<span class="token punctuation">.</span>ARIMA<span class="token punctuation">(</span>historical_data<span class="token punctuation">[</span><span class="token string">'qty'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 选择合适的ARIMA参数</span>
results <span class="token operator">=</span> model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 输出模型的统计摘要</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>results<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_127"></a>问题二</h3> 
<p>问题二要求针对新出现的商家+仓库+商品维度进行需求预测，这些维度在历史数据中没有出现过。建模思路可以分为以下几个步骤：</p> 
<p><strong>步骤1：数据准备</strong></p> 
<ul><li>首先，需要识别出历史数据中不存在的商家+仓库+商品维度。这些新维度可能代表新上市的商品或改变了商品存放的仓库。</li></ul> 
<p><strong>步骤2：相似序列查找</strong></p> 
<ul><li> <p>针对每个新出现的商家+仓库+商品维度，需要查找历史数据中与之相似的时间序列。相似性可以通过多种方式来衡量，如时间序列模式、统计特征等。以下是一种计算相似性的思路：</p> <p>a. 对于每个新维度，计算其与历史数据中所有商家+仓库+商品维度的相似性分数。这可以使用各种距离度量方法（如欧氏距离、相关系数等）来计算。</p> <p>b. 选择与新维度相似性得分最高的一组历史时间序列。这组历史序列将被用作预测新维度的参考。</p> </li></ul> 
<p><strong>步骤3：需求预测</strong></p> 
<ul><li>使用选定的相似历史序列，可以应用相同的需求预测模型（例如，ARIMA、加权移动平均或其他时间序列模型）来预测新维度的需求。预测的时间段为2023-05-16至2023-05-30。</li></ul> 
<p><strong>步骤4：结果记录</strong></p> 
<ul><li>将预测结果填写在结果表2中，并上传至竞赛平台。</li></ul> 
<p>公式表示：</p> 
<ol><li> <p><strong>相似性计算</strong>（可以使用欧氏距离作为相似性度量的一个示例）：</p> <p>欧氏距离公式：</p> </li></ol> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          Distance 
         
        
          ( 
         
        
          X 
         
        
          , 
         
        
          Y 
         
        
          ) 
         
        
          = 
         
         
          
           
           
             ∑ 
            
            
            
              i 
             
            
              = 
             
            
              1 
             
            
           
             n 
            
           
          
            ( 
           
           
           
             X 
            
           
             i 
            
           
          
            − 
           
           
           
             Y 
            
           
             i 
            
           
           
           
             ) 
            
           
             2 
            
           
          
         
        
       
         \text{Distance}(X, Y) = \sqrt{\sum_{i=1}^{n} (X_i - Y_i)^2} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">Distance</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 3.1568em; vertical-align: -1.2777em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.8791em;"><span class="svg-align" style="top: -5.1168em;"><span class="pstrut" style="height: 5.1168em;"></span><span class="mord" style="padding-left: 1.056em;"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6514em;"><span class="" style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span class=""></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.8391em;"><span class="pstrut" style="height: 5.1168em;"></span><span class="hide-tail" style="min-width: 0.742em; height: 3.1968em;"> 
            <svg width="400em" height="3.1968em" viewbox="0 0 400000 3196" preserveaspectratio="xMinYMin slice"> 
             <path d="M702 80H40000040
H742v3062l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 80H400000v40H742z"></path> 
            </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p> 
<p>其中，X 和 Y是两个时间序列，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          X 
         
        
          i 
         
        
       
      
        X_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          Y 
         
        
          i 
         
        
       
      
        Y_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>分别是它们的对应时间点的值，(n) 是时间序列长度。</p> 
<ol start="2"><li> <p><strong>需求预测</strong>：</p> <p>对于新维度，使用选定的相似历史序列中的模型（如ARIMA）进行需求预测。</p> </li></ol> 
<p>这个建模思路允许你根据历史数据中的相似性来预测新维度的需求，而不需要依赖完全没有历史数据的新维度。因此，你可以根据相似性找到最合适的历史数据，并基于这些历史数据来进行需求预测。</p> 
<p>其中，(X) 和 (Y) 是两个时间序列，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          X 
         
        
          i 
         
        
       
      
        X_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          Y 
         
        
          i 
         
        
       
      
        Y_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>分别是它们的对应时间点的值，(n) 是时间序列长度。</p> 
<ol start="2"><li> <p><strong>需求预测</strong>：</p> <p>对于新维度，使用选定的相似历史序列中的模型（如ARIMA）进行需求预测。<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            Demand Forecast 
           
          
            ( 
           
          
            X 
           
          
            ) 
           
          
            = 
           
          
            Model 
           
          
            ( 
           
           
           
             X 
            
           
             similar 
            
           
          
            ) 
           
          
         
           \text{Demand Forecast}(X) = \text{Model}(X_{\text{similar}}) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">Demand Forecast</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">Model</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">similar</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span><br> 代码：</p> </li></ol> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>spatial<span class="token punctuation">.</span>distance <span class="token keyword">import</span> euclidean
<span class="token keyword">from</span> statsmodels<span class="token punctuation">.</span>tsa<span class="token punctuation">.</span>arima_model <span class="token keyword">import</span> ARIMA

<span class="token comment"># 读取历史数据、新维度数据</span>
historical_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'附件1.csv'</span><span class="token punctuation">)</span>
new_dimension_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'附件5.csv'</span><span class="token punctuation">)</span>

<span class="token comment"># 存储新维度的预测结果</span>
result_table_2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'seller_no'</span><span class="token punctuation">,</span> <span class="token string">'warehouse_no'</span><span class="token punctuation">,</span> <span class="token string">'product_no'</span><span class="token punctuation">,</span> <span class="token string">'date'</span><span class="token punctuation">,</span> <span class="token string">'predicted_demand'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 针对每个新维度进行需求预测</span>
<span class="token keyword">for</span> index<span class="token punctuation">,</span> new_dimension_row <span class="token keyword">in</span> new_dimension_data<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 获取新维度的商家、仓库、商品信息</span>
    seller <span class="token operator">=</span> new_dimension_row<span class="token punctuation">[</span><span class="token string">'seller_no'</span><span class="token punctuation">]</span>
    warehouse <span class="token operator">=</span> new_dimension_row<span class="token punctuation">[</span><span class="token string">'warehouse_no'</span><span class="token punctuation">]</span>
    product <span class="token operator">=</span> new_dimension_row<span class="token punctuation">[</span><span class="token string">'product_no'</span><span class="token punctuation">]</span>
    
    <span class="token comment"># 查找与新维度相似的历史数据，使用欧氏距离进行相似性计算</span>
    historical_data<span class="token punctuation">[</span><span class="token string">'similarity'</span><span class="token punctuation">]</span> <span class="token operator">=</span> historical_data<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>
        <span class="token keyword">lambda</span> row<span class="token punctuation">:</span> euclidean<span class="token punctuation">(</span><span class="token punctuation">[</span>row<span class="token punctuation">[</span><span class="token string">'seller_no'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> row<span class="token punctuation">[</span><span class="token string">'warehouse_no'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> row<span class="token punctuation">[</span><span class="token string">'product_no'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                             <span class="token punctuation">[</span>seller<span class="token punctuation">,</span> warehouse<span class="token punctuation">,</span> product<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        axis<span class="token operator">=</span><span class="token number">1</span>
    <span class="token punctuation">)</span>
    
    <span class="token comment"># 选择相似性得分最高的历史序列</span>
    most_similar_row <span class="token operator">=</span> historical_data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>historical_data<span class="token punctuation">[</span><span class="token string">'similarity'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>idxmin<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    
    <span class="token comment"># 获取历史相似序列的需求历史数据</span>
    historical_demand <span class="token operator">=</span> most_similar_row<span class="token punctuation">[</span><span class="token string">'qty'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
    
    <span class="token comment"># 使用ARIMA模型进行需求预测</span>
    <span class="token comment"># 这里需要根据你的数据和需求进一步调整ARIMA模型的参数</span>
    arima_model <span class="token operator">=</span> ARIMA<span class="token punctuation">(</span>historical_demand<span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 举例使用ARIMA(5,1,0)</span>
    arima_fit <span class="token operator">=</span> arima_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>disp<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 预测新维度的需求</span>
    forecast <span class="token operator">=</span> arima_fit<span class="token punctuation">.</span>forecast<span class="token punctuation">(</span>steps<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>  <span class="token comment"># 预测未来15天的需求</span>
    
    <span class="token comment"># 构建预测结果并添加到结果表2</span>
    forecast_dates <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token string">'2023-05-16'</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">'2023-05-30'</span><span class="token punctuation">)</span>
    forecast_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
</code></pre> 
<h3><a id="_224"></a>问题三</h3> 
<p>问题三要求预测商家+仓库+商品维度在2023-06-01至2023-06-20期间的需求，考虑到大型促销对需求的影响。以下是问题三的建模思路：</p> 
<p><strong>步骤1：数据准备</strong></p> 
<ul><li>读取历史数据，包括商家+仓库+商品维度在去年双十一期间的需求量数据（附件）。</li></ul> 
<p><strong>步骤2：特定日期范围的历史数据选择</strong></p> 
<ul><li>从历史数据中筛选出与目标日期范围（2023-06-01至2023-06-20）相对应的数据，这些数据将用于建模。</li></ul> 
<p><strong>步骤3：需求预测</strong></p> 
<ul><li>使用时间序列模型（如ARIMA）或其他适当的模型，对商家+仓库+商品维度在目标日期范围内的需求进行预测。需要考虑大型促销对需求的影响，可以将促销期视为外部变量。</li></ul> 
<p><strong>步骤4：结果记录</strong></p> 
<ul><li>将预测结果填写在结果表3中，并上传至竞赛平台。</li></ul> 
<p>以下是一些公式示例，用于表示ARIMA模型中的差分（用于稳定性处理）和需求预测：</p> 
<p><strong>差分（Differencing）</strong>：</p> 
<p>差分用于将非稳定的时间序列数据转化为稳定的序列，以便ARIMA模型能够准确预测。差分一次通常表示将时间序列减去其前一时刻的值。</p> 
<p>差分公式：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          Difference 
         
        
          ( 
         
         
         
           Y 
          
         
           t 
          
         
        
          ) 
         
        
          = 
         
         
         
           Y 
          
         
           t 
          
         
        
          − 
         
         
         
           Y 
          
          
          
            t 
           
          
            − 
           
          
            1 
           
          
         
        
       
         \text{Difference}(Y_t) = Y_t - Y_{t-1} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">Difference</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.8917em; vertical-align: -0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>需求预测：</p> 
<p>需求预测可以使用ARIMA模型中的预测方法。具体的预测公式取决于ARIMA模型的参数和历史数据的性质。</p> 
<p>ARIMA模型的预测公式：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
          
          
            Y 
           
          
            ^ 
           
          
          
          
            t 
           
          
            + 
           
          
            h 
           
          
         
        
          = 
         
        
          μ 
         
        
          + 
         
         
         
           ∑ 
          
          
          
            i 
           
          
            = 
           
          
            1 
           
          
         
           p 
          
         
         
         
           ϕ 
          
         
           i 
          
         
         
         
           Y 
          
          
          
            t 
           
          
            + 
           
          
            h 
           
          
            − 
           
          
            i 
           
          
         
        
          − 
         
         
         
           ∑ 
          
          
          
            j 
           
          
            = 
           
          
            1 
           
          
         
           q 
          
         
         
         
           θ 
          
         
           j 
          
         
         
          
          
            Y 
           
          
            ^ 
           
          
          
          
            t 
           
          
            + 
           
          
            h 
           
          
            − 
           
          
            j 
           
          
         
        
       
         \hat{Y}_{t+h} = \mu + \sum_{i=1}^{p} \phi_i Y_{t+h-i} - \sum_{j=1}^{q} \theta_j \hat{Y}_{t+h-j} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.1551em; vertical-align: -0.2083em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9468em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span></span><span class="" style="top: -3.2523em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 2.9762em; vertical-align: -1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6985em;"><span class="" style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3471em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.2777em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">h</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 3.1123em; vertical-align: -1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6985em;"><span class="" style="top: -1.8723em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">∑</span></span></span><span class="" style="top: -4.3471em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.4138em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9468em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span></span><span class="" style="top: -3.2523em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">h</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p> 
<p>其中，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
         
         
           Y 
          
         
           ^ 
          
         
         
         
           t 
          
         
           + 
          
         
           h 
          
         
        
       
      
        \hat{Y}_{t+h} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.1551em; vertical-align: -0.2083em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.9468em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">Y</span></span><span class="" style="top: -3.2523em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: -0.2222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示在时间<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         t 
        
       
         + 
        
       
         h 
        
       
      
        t+h 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6984em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span></span> 的预测值，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         μ 
        
       
      
        \mu 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span></span> 是模型的均值，(p) 和 (q) 是ARIMA模型的阶数，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          ϕ 
         
        
          i 
         
        
       
      
        \phi_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          θ 
         
        
          j 
         
        
       
      
        \theta_j 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 是模型的参数。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> statsmodels<span class="token punctuation">.</span>tsa<span class="token punctuation">.</span>arima_model <span class="token keyword">import</span> ARIMA

<span class="token comment"># 读取历史数据（附件6）</span>
historical_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'附件6.csv'</span><span class="token punctuation">)</span>

<span class="token comment"># 存储预测结果</span>
result_table_3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'seller_no'</span><span class="token punctuation">,</span> <span class="token string">'warehouse_no'</span><span class="token punctuation">,</span> <span class="token string">'product_no'</span><span class="token punctuation">,</span> <span class="token string">'date'</span><span class="token punctuation">,</span> <span class="token string">'predicted_demand'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 针对每个商家+仓库+商品维度进行需求预测</span>
<span class="token keyword">for</span> index<span class="token punctuation">,</span> row <span class="token keyword">in</span> historical_data<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    seller <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">'seller_no'</span><span class="token punctuation">]</span>
    warehouse <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">'warehouse_no'</span><span class="token punctuation">]</span>
    product <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">'product_no'</span><span class="token punctuation">]</span>
    
    <span class="token comment"># 获取历史需求数据，以便建立ARIMA模型</span>
    historical_demand <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">'qty'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
    
    <span class="token comment"># 使用ARIMA模型进行需求预测</span>
    <span class="token comment"># 这里需要根据你的数据和需求进一步调整ARIMA模型的参数</span>
    arima_model <span class="token operator">=</span> ARIMA<span class="token punctuation">(</span>historical_demand<span class="token punctuation">,</span> order<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 举例使用ARIMA(5,1,0)</span>
    arima_fit <span class="token operator">=</span> arima_model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>disp<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 预测2023-06-01至2023-06-20的需求</span>
    forecast_dates <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token string">'2023-06-01'</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">'2023-06-20'</span><span class="token punctuation">)</span>
    forecast <span class="token operator">=</span> arima_fit<span class="token punctuation">.</span>forecast<span class="token punctuation">(</span>steps<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>forecast_dates<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 构建预测结果并添加到结果表3</span>
    forecast_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token string">'seller_no'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>seller<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>forecast_dates<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'warehouse_no'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>warehouse<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>forecast_dates<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'product_no'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>product<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>forecast_dates<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'date'</span><span class="token punctuation">:</span> forecast_dates<span class="token punctuation">,</span>
   <span class="token comment">#见完整代码</span>

</code></pre> 
<p>更多完整版代码+思路<br> <a href="https://docs.qq.com/doc/DTktuZlROUUNFcmhX" rel="nofollow">2023年第四届MathorCup大数据挑战赛（B题）</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ba088411327c6af5ff6dc8857ce89496/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">磁盘和硬盘的区别</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9dfe971b78317cddd388115481edb033/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">把整形数字转换为二进制</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>