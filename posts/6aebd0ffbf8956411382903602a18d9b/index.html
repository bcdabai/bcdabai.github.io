<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【C语言】文件操作函数 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【C语言】文件操作函数" />
<meta property="og:description" content="一、文件打开与关闭 1、fopen函数 函数原型：
FILE *fopen(const char *filename, const char *mode); 函数功能：
fopen函数用于打开一个具有指定文件名的文件，并返回一个文件指针，以供后续的文件读写操作使用。
参数说明：
filename：要打开的文件名，可以包含路径信息。注意，文件名应该是一个以字符串形式表示的C字符数组。mode：打开文件的模式，以字符串形式表示。通常使用以下几种模式： &#34;r&#34;：只读方式打开文件。 &#34;w&#34;：写方式打开文件。如果文件不存在，则创建一个新的空文件；如果文件存在，则清空文件内容。 &#34;a&#34;：追加方式打开文件。如果文件不存在，则创建一个新的空文件；如果文件存在，则将写入的数据追加到文件末尾。 &#34;r&#43;&#34;：读写方式打开文件，该文件必须已经存在。指针位于文件的开头。可以进行读取和写入操作。 &#34;w&#43;&#34;：读写方式打开文件。如果文件存在，则清空文件内容；如果文件不存在，则创建一个新的空文件。可以进行读取和写入操作。 &#34;a&#43;&#34;：读写方式打开文件。如果文件存在，则指针位于文件末尾；如果文件不存在，则创建一个新的空文件。可以进行读取和写入操作，写入的数据追加到文件末尾。 &#34;rb&#34;：只读方式打开二进制文件。如果文件不存在，则打开失败。 &#34;wb&#34;：写方式打开二进制文件。如果文件不存在，则创建一个新的空文件；如果文件存在，则清空文件内容。 &#34;ab&#34;：追加方式打开二进制文件。如果文件不存在，则创建一个新的空文件；如果文件存在，则将写入的数据追加到文件末尾。 &#34;rb&#43;&#34;：以二进制形式的读写方式打开文件，该文件必须已经存在。指针位于文件的开头。可以进行二进制数据的读取和写入操作。 &#34;wb&#43;&#34;：以二进制形式的读写方式打开文件。如果文件存在，则清空文件内容；如果文件不存在，则创建一个新的空文件。可以进行二进制数据的读取和写入操作。 &#34;ab&#43;&#34;：以二进制形式的读写方式打开文件。如果文件存在，则指针位于文件末尾；如果文件不存在，则创建一个新的空文件。可以进行二进制数据的读取和写入操作，写入的数据追加到文件末尾。 返回值：
如果成功打开文件，则返回指向 FILE 结构体的指针，称为文件指针。该文件指针用于后续对文件进行读、写或关闭等操作。如果打开文件失败，则返回 NULL。 示例：
FILE *file = fopen(&#34;example.txt&#34;, &#34;r&#34;); if (file != NULL) { // 打开文件成功，进行文件读写操作 fclose(file); // 关闭文件 } else { // 打开文件失败，进行错误处理 } 需要注意的是，在操作文件之后，应该使用 fclose 函数关闭文件，以确保文件资源被正确释放。
总结：fopen函数在C语言中用于打开文件，并返回一个指向文件的指针，可以根据指定的文件名和打开模式进行不同类型的文件操作。
2、fclose函数 函数原型：
int fclose(FILE *stream); 函数功能：
fclose函数用于关闭一个打开的文件，并释放与文件相关的资源。
参数说明：
stream：指向要关闭的文件的指针。 返回值：
fclose函数返回一个整数值，表示关闭文件的状态。如果成功关闭文件，则返回0；如果关闭文件失败，则返回非零值。 示例：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/6aebd0ffbf8956411382903602a18d9b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-01T17:22:29+08:00" />
<meta property="article:modified_time" content="2024-01-01T17:22:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【C语言】文件操作函数</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="text-align:center;"> <img alt="" src="https://images2.imgbox.com/3f/56/758bopR4_o.png"></p> 
<h3> 一、文件打开与关闭</h3> 
<div></div> 
<h6> 1、fopen函数</h6> 
<blockquote> 
 <p>函数原型：</p> 
 <pre><code>FILE *fopen(const char *filename, const char *mode);
</code></pre> 
 <p>函数功能：<br><code>fopen</code>函数用于打开一个具有指定文件名的文件，并返回一个文件指针，以供后续的文件读写操作使用。</p> 
 <p>参数说明：</p> 
 <ul><li><code>filename</code>：要打开的文件名，可以包含路径信息。注意，文件名应该是一个以字符串形式表示的C字符数组。</li><li><code>mode</code>：打开文件的模式，以字符串形式表示。通常使用以下几种模式： <h6></h6> 
   <ul><li> <h6><code>"r"</code>：只读方式打开文件。</h6> </li><li> <h6><code>"w"</code>：写方式打开文件。如果文件不存在，则创建一个新的空文件；如果文件存在，则清空文件内容。</h6> </li><li> <h6><code>"a"</code>：追加方式打开文件。如果文件不存在，则创建一个新的空文件；如果文件存在，则将写入的数据追加到文件末尾。</h6> </li><li> <h6><code>"r+"</code>：读写方式打开文件，该文件必须已经存在。指针位于文件的开头。可以进行读取和写入操作。</h6> </li><li> <h6><code>"w+"</code>：读写方式打开文件。如果文件存在，则清空文件内容；如果文件不存在，则创建一个新的空文件。可以进行读取和写入操作。</h6> </li><li> <h6><code>"a+"</code>：读写方式打开文件。如果文件存在，则指针位于文件末尾；如果文件不存在，则创建一个新的空文件。可以进行读取和写入操作，写入的数据追加到文件末尾。</h6> </li><li> <h6><code>"rb"</code>：只读方式打开二进制文件。如果文件不存在，则打开失败。</h6> </li><li> <h6><code>"wb"</code>：写方式打开二进制文件。如果文件不存在，则创建一个新的空文件；如果文件存在，则清空文件内容。</h6> </li><li> <h6><code>"ab"</code>：追加方式打开二进制文件。如果文件不存在，则创建一个新的空文件；如果文件存在，则将写入的数据追加到文件末尾。</h6> </li><li> <h6><code>"rb+"</code>：以二进制形式的读写方式打开文件，该文件必须已经存在。指针位于文件的开头。可以进行二进制数据的读取和写入操作。</h6> </li><li> <h6><code>"wb+"</code>：以二进制形式的读写方式打开文件。如果文件存在，则清空文件内容；如果文件不存在，则创建一个新的空文件。可以进行二进制数据的读取和写入操作。</h6> </li><li> <h6><code>"ab+"</code>：以二进制形式的读写方式打开文件。如果文件存在，则指针位于文件末尾；如果文件不存在，则创建一个新的空文件。可以进行二进制数据的读取和写入操作，写入的数据追加到文件末尾。</h6> </li></ul></li></ul> 
 <p>返回值：</p> 
 <ul><li>如果成功打开文件，则返回指向 <code>FILE</code> 结构体的指针，称为文件指针。该文件指针用于后续对文件进行读、写或关闭等操作。</li><li>如果打开文件失败，则返回 <code>NULL</code>。</li></ul> 
 <p>示例：</p> 
 <pre><code>FILE *file = fopen("example.txt", "r");
if (file != NULL) {
    // 打开文件成功，进行文件读写操作
    fclose(file); // 关闭文件
} else {
    // 打开文件失败，进行错误处理
}
</code></pre> 
 <p></p> 
 <p>需要注意的是，在操作文件之后，应该使用 <code>fclose</code> 函数关闭文件，以确保文件资源被正确释放。</p> 
 <p>总结：<code>fopen</code>函数在C语言中用于打开文件，并返回一个指向文件的指针，可以根据指定的文件名和打开模式进行不同类型的文件操作。</p> 
</blockquote> 
<h6>2、fclose函数</h6> 
<blockquote> 
 <p>函数原型：</p> 
 <pre><code>int fclose(FILE *stream);
</code></pre> 
 <p>函数功能：<br><code>fclose</code>函数用于关闭一个打开的文件，并释放与文件相关的资源。</p> 
 <p>参数说明：</p> 
 <ul><li><code>stream</code>：指向要关闭的文件的指针。</li></ul> 
 <p>返回值：</p> 
 <ul><li><code>fclose</code>函数返回一个整数值，表示关闭文件的状态。如果成功关闭文件，则返回0；如果关闭文件失败，则返回非零值。</li></ul> 
 <p>示例：</p> 
 <pre><code>FILE *file = fopen("example.txt", "r");
if (file != NULL) {
    // 对文件进行读写操作
    fclose(file);  // 关闭文件
} else {
    // 处理文件打开失败的情况
}
</code></pre> 
 <p></p> 
 <p>在处理完文件后，应该调用<code>fclose</code>函数关闭文件，以确保文件资源得到正确释放。这对于避免资源泄漏和确保文件数据的完整性至关重要。</p> 
 <p>需要注意的是，<code>fclose</code>函数在关闭文件后，将无法再对该文件进行读写操作。因此，在调用<code>fclose</code>函数之后，应该确保不再需要对该文件进行操作，以免出现意外的错误。</p> 
 <p></p> 
</blockquote> 
<h3>二、文件操作函数</h3> 
<h6>1、fgetc函数：</h6> 
<blockquote> 
 <ul><li>原型：<code>int fgetc(FILE *stream)</code></li><li>功能：从文件流 <code>stream</code> 中获取一个字符。</li><li>返回值：返回获取到的字符。如果到达文件末尾或读取失败，则返回EOF（-1）。</li><li>示例： <pre><code>FILE *file = fopen("example.txt", "r");
if (file != NULL) {
    int c = fgetc(file);
    while (c != EOF) {
        printf("%c", c);
        c = fgetc(file);
    }
    fclose(file);
}</code></pre> </li></ul> 
</blockquote> 
<h6>2、fputc函数</h6> 
<blockquote> 
 <ul><li>原型：<code>int fputc(int c, FILE *stream)</code> 
   <ul><li><code>c</code>：要写入的字符，以整数形式表示。</li><li><code>stream</code>：指向要写入的文件的指针。</li></ul></li><li>功能：将字符 <code>c</code> 写入到文件流 <code>stream</code> 中。</li><li>返回值：返回写入的字符。如果写入失败，则返回EOF（-1）。</li><li>示例： <pre><code>FILE *file = fopen("example.txt", "w");
if (file != NULL) {
    fputc('H', file);
    fputc('e', file);
    fputc('l', file);
    fputc('l', file);
    fputc('o', file);
    fclose(file);
}</code></pre> </li></ul> 
</blockquote> 
<h6>3、fgets函数</h6> 
<blockquote> 
 <ul><li>原型：<code>char *fgets(char *str, int n, FILE *stream)</code> 
   <ul><li><code>str</code>：指向用于存储读取的字符串的字符数组的指针。</li><li><code>n</code>：要读取的最大字符数（包括空字符 ‘\0’）。</li><li><code>stream</code>：指向要读取的文件的指针。</li></ul></li><li>功能：从文件流 <code>stream</code> 中读取<strong>一行</strong>字符串，并将其存储到 <code>str</code> 缓冲区中。</li><li>返回值：返回读取到的字符串。如果到达文件末尾或读取失败，则返回NULL。</li><li>示例： <pre><code>FILE *file = fopen("example.txt", "r");
if (file != NULL) {
    char buffer[100];
    while (fgets(buffer, sizeof(buffer), file) != NULL) {
        printf("%s", buffer);
    }
    fclose(file);
}</code></pre> </li></ul> 
</blockquote> 
<p><strong>fgets函数易错点： </strong></p> 
<blockquote> 
 <p>fgets函数最多只能读取n-1个数据，因为fgets函数在读取字符串时会在最后添加一个空字符’\0’作为字符串的结束标志。所以，为了在缓冲区末尾留出空间放置空字符，实际读取的最大字符数为n-1。因此，当使用fgets函数读取字符串时，需要确保缓冲区大小至少为n个字符。</p> 
</blockquote> 
<h6>4、fputs函数</h6> 
<blockquote> 
 <ul><li>原型：<code>int fputs(const char *str, FILE *stream)</code></li><li>功能：将字符串 <code>str</code> 写入到文件流 <code>stream</code> 中。</li><li>返回值：返回非负值表示成功，返回EOF（-1）表示写入失败。</li><li>示例： <pre><code>FILE *file = fopen("example.txt", "w");
if (file != NULL) {
    fputs("Hello, World!", file);
    fclose(file);
}</code></pre> </li></ul> 
</blockquote> 
<h6>5、fscanf函数</h6> 
<blockquote> 
 <ul><li>原型：<code>int fscanf(FILE *stream, const char *format, ...)</code> 
   <ul><li><code>stream</code>：指向要读取的文件的指针。</li><li><code>format</code>：格式化字符串，指定了读取数据的格式。</li><li><code>...</code>：可变数量的参数，根据<code>format</code>字符串中的格式指示符进行赋值。</li></ul></li><li>功能：从文件流 <code>stream</code> 中根据指定的格式字符串 <code>format</code> 进行格式化输入。</li><li>返回值：返回成功匹配并赋值的输入项数，如果达到文件末尾或格式不匹配，则返回EOF（-1）。</li><li>示例： <pre><code>FILE *file = fopen("example.txt", "r");
if (file != NULL) {
    int num1, num2;
    fscanf(file, "%d %d", &amp;num1, &amp;num2);
    printf("Num1: %d, Num2: %d\n", num1, num2);
    fclose(file);
}</code></pre> </li></ul> 
</blockquote> 
<h6>6、fprintf函数</h6> 
<blockquote> 
 <ul><li>原型：<code>int fprintf(FILE *stream, const char *format, ...)</code> 
   <ul><li><code>stream</code>：指向要写入的文件的指针。</li><li><code>format</code>：格式化字符串，指定了写入数据的格式。</li><li><code>...</code>：可变数量的参数，根据<code>format</code>字符串中的格式指示符进行匹配。</li></ul></li><li>功能：将格式化的数据按指定的格式字符串 <code>format</code> 写入到文件流 <code>stream</code> 中。</li><li>返回值：成功写入的字符数，如果写入失败，则返回负值。</li><li>示例： <pre><code>FILE *file = fopen("example.txt", "w");
if (file != NULL) {
    int num1 = 10, num2 = 20;
    fprintf(file, "Num1: %d, Num2: %d\n", num1, num2);
    fclose(file);
}</code></pre> </li></ul> 
</blockquote> 
<h6>7、fwrite函数</h6> 
<blockquote> 
 <ul><li>原型：<code>size_t fwrite(const void *ptr, size_t size, size_t count, FILE *stream)</code> 
   <ul><li><code>ptr</code>：指向要写入数据块的内存地址的指针。</li><li><code>size</code>：每个数据项的字节数。</li><li><code>count</code>：要写入的数据项的个数。</li><li><code>stream</code>：指向要写入的文件的指针。</li></ul></li><li>功能：将二进制数据块从指针 <code>ptr</code> 指向的内存写入到文件流 <code>stream</code> 中。</li><li>返回值：返回实际写入的数据块个数，如果写入失败，则返回一个小于 <code>count</code> 的值。</li><li>示例： <pre><code>FILE *file = fopen("example.bin", "wb");
if (file != NULL) {
    int nums[] = {1, 2, 3, 4, 5};
    fwrite(nums, sizeof(int), sizeof(nums) / sizeof(int), file);
    fclose(file);
}</code></pre> </li></ul> 
</blockquote> 
<h6>8、fread函数</h6> 
<blockquote> 
 <ul><li>原型：<code>size_t fread(void *ptr, size_t size, size_t count, FILE *stream)</code> 
   <ul><li><code>ptr</code>：指向读取数据存储的内存地址的指针。</li><li><code>size</code>：每个数据项的字节数。</li><li><code>count</code>：要读取的数据项的个数。</li><li><code>stream</code>：指向要读取的文件的指针。</li></ul></li><li>功能：从文件流 <code>stream</code> 中读取二进制数据块到指针 <code>ptr</code> 指向的内存中。</li><li>返回值：返回实际读取的数据块个数，如果读取失败或已到达文件末尾，则返回一个小于 <code>count</code> 的值。</li><li>示例： <pre><code>FILE *file = fopen("example.bin", "rb");
if (file != NULL) {
    int nums[5];
    fread(nums, sizeof(int), sizeof(nums) / sizeof(int), file);
    fclose(file);
}</code></pre> </li></ul> 
</blockquote> 
<h6>9、fseek函数</h6> 
<blockquote> 
 <ul><li>原型：<code>int fseek(FILE *stream, long offset, int whence)</code> 
   <ul><li><code>stream</code>：指向要操作的文件的指针。</li><li><code>offset</code>：需要偏移的字节数或记录数，根据<code>whence</code>的值进行解释。</li><li><code>whence</code>：指定偏移的起点，可以是下列值之一： 
     <ul><li><code>SEEK_SET</code>：从文件起始位置开始计算偏移（<code>offset</code>为正表示向文件末尾方向移动，<code>offset</code>为负表示向文件起始位置方向移动）。</li><li><code>SEEK_CUR</code>：以当前位置为基点进行偏移（<code>offset</code>为正表示向文件末尾方向移动，<code>offset</code>为负表示向文件起始位置方向移动）。</li><li><code>SEEK_END</code>：以文件末尾为基点进行偏移（<code>offset</code>为正表示向文件起始位置方向移动，<code>offset</code>为负表示向文件末尾方向移动）。</li></ul></li></ul></li><li>功能：<code>fseek</code>函数将文件指针移动到<code>offset</code>指定的位置，位置的计算基于<code>whence</code>参数。移动成功后，可以在新的位置进行读取或写入操作。</li><li>返回值：返回0表示成功，非零值表示失败。</li><li>示例： <pre><code>FILE *file = fopen("example.txt", "r");
if (file != NULL) {
    fseek(file, 5, SEEK_SET);  // 将文件指针移动到文件开头偏移量为5的位置
    fclose(file);
}</code></pre> </li></ul> 
</blockquote> 
<h6>10、ftell函数</h6> 
<blockquote> 
 <p></p> 
 <ul><li>原型：<code>long ftell(FILE *stream)</code></li><li>功能：获取文件流 <code>stream</code> 的当前文件指针位置。</li><li>返回值：返回当前文件指针的位置（以字节为单位），如果失败，则返回-1。</li><li>示例： <pre><code>FILE *file = fopen("example.txt", "r");
if (file != NULL) {
    fseek(file, 0, SEEK_END);  // 将文件指针移动到文件末尾
    long size = ftell(file);  // 获取当前文件指针位置
    printf("File size: %ld bytes\n", size);
    fclose(file);
}</code></pre> </li></ul> 
</blockquote> 
<h6>11、rewind函数</h6> 
<blockquote> 
 <ul><li>原型：<code>void rewind(FILE *stream)</code></li><li>功能：将文件流 <code>stream</code> 的文件指针重置到文件的起始位置。</li><li>示例： <pre><code>FILE *file = fopen("example.txt", "r");
if (file != NULL) {
    fseek(file, 0, SEEK_END);  // 将文件指针移动到文件末尾
    rewind(file);  // 将文件指针重置到文件起始位置
    fclose(file);
}</code></pre> </li></ul> 
</blockquote> 
<h6>12、feof函数</h6> 
<blockquote> 
 <ul><li>原型：<code>int feof(FILE *stream)</code></li><li>功能：检测文件流 <code>stream</code> 是否已到达文件末尾。</li><li>返回值：如果已到达文件末尾，返回非零值；否则，返回零。</li><li> <p><strong>注意：</strong> <span style="color:#333333;">在文件读取过程中，不能用feof函数的返回值直接用来判断文件的是否结束。 而是<strong>应用于当文件读取结束的时候，判断是读取失败结束，还是遇到文件尾结束。</strong></span></p> </li><li> 
   <div> 
    <span style="color:#333333;">EOF </span> 
    <span style="color:#333333;">（ </span> 
    <span style="color:#333333;">fgetc </span> 
    <span style="color:#333333;">），或者 </span> 
    <span style="color:#333333;">NULL </span> 
    <span style="color:#333333;">（ </span> 
    <span style="color:#333333;">fgets ）。 </span> 
    <span style="color:#333333;">二进制文件的读取结束判断，判断返回值是否小于实际要读的个数。</span> 
   </div> 
   <div></div> 
   <div> 
    <p></p> 
   </div> 
   <div> 
    <span style="color:#333333;">文本文件读取是否结束，判断返回值是否为 </span> 
   </div> 
   <ul><li> 
     <div> 
      <strong><span style="color:#333333;">fgetc </span><span style="color:#333333;">判断是否为 </span><span style="color:#333333;">EOF </span><span style="color:#333333;">.</span></strong> 
     </div> </li><li> 
     <div> 
      <strong><span style="color:#333333;">fgets </span><span style="color:#333333;">判断返回值是否为 </span><span style="color:#333333;">NULL </span></strong>。 
     </div> </li><li> 
     <div> 
      <strong><span style="color:#333333;">fread</span><span style="color:#333333;">判断返回值是否小于实际要读的个数。</span></strong> 
     </div> </li></ul></li></ul> 
 <div> 
  <pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
int main(void)
{
    int c; // 注意：int，非char，要求处理EOF
    FILE* fp = fopen("test.txt", "r");
    if(!fp) {
        perror("File opening failed");
        return EXIT_FAILURE;
   }
 //fgetc 当读取失败的时候或者遇到文件结束的时候，都会返回EOF
    while ((c = fgetc(fp)) != EOF) // 标准C I/O读取文件循环
   { 
       putchar(c);
   }
//判断是什么原因结束的
    if (ferror(fp))
        puts("I/O error when reading");
    else if (feof(fp))
        puts("End of file reached successfully");
    fclose(fp);
}</code></pre> 
 </div> 
</blockquote> 
<div></div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/45eae214fa23b6501df47bd7a17eb2b8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python异常处理TypeError: translation() got an unexpected keyword argument ‘codeset‘</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1e21cd47a9722870925e1744cb17871f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">带你玩转PX4无人机仿真(2) —— 定点飞行</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>