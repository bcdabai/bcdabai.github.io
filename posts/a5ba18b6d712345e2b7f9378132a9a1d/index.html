<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>http服务器升级配置信息错误,Http升级到Https （本地测试，无须域名和认证） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="http服务器升级配置信息错误,Http升级到Https （本地测试，无须域名和认证）" />
<meta property="og:description" content="在之前的语音识别的项目中，一切都在本地进行得很顺利，然后把写的Demo部署到服务器上给老大看的时候，通过IP访问(http://192.168.xxx.xxx:8080这样的形式)时，从一开始就坏掉了，使用Chrome都不能开启录音的权限了，就谈不上语音转换了，用Firefox来访问居然迷之没有问题，说明我写的Demo没有问题，那一定就是Chrome的问题了。调出错误的报告显示得是
Only secure origins are allowed (see: https://goo.gl/Y0ZkNV).
找到问题立马一百度就出来了
报错的原因大概就是谷歌浏览器认为我的url是不安全的，不能开启麦克风，摄像头，定位等权限。那怎么才是安全的呢，只能把http协议升级为https。
因为升级https需要购买SSL证书之类的，并且都没有自己的域名，所以只能在本地使用java的Keytool命令生成一个，来测试一下升级到Https是否能解决我的问题。
本文一下内容参考博客
Tomcat配置https及访问http自动跳转至https
一、生成证书文件
步骤：
(1)打开cmd，输入
keytool -genkey -alias tomcat -keyalg RSA -keystore F:omcat.keystore -validity 36500
参数简要说明：“F:omcat.keystore”含义是将证书文件保存在F盘，证书文件名称是tomcat.keystore ；
“-validity 36500”含义是证书有效期，36500表示100年，默认值是90天
(2)在命令行填写必要的参数
输入密钥库密码：此处需要输入大于6个字符的字符串，例如123456
输入两次密码之后弹出以下问题
“您的名字与姓氏是什么？”这是必填项，并且必须是TOMCAT部署主机的域名或者IP[如：gbcom.com 或者 192.168.145.170]，就是你将来要在浏览器中输入的访问地址
“你的组织单位名称是什么？”、“您的组织名称是什么？”、“您所在城市或区域名称是什么？”、“您所在的州或者省份名称是什么？”、“该单位的两字母国家代码是什么？” 可以按照需要填写也可以不填写直接回车，在系统询问“正确吗？”时，对照输入信息，如果符合要求则使用键盘输入字母“y”，否则输入“n”重新填写上面的信息
(3)输入tomcat主密码
输入的主密码，这项较为重要，会在tomcat配置文件中使用，建议输入与keystore的密码一致，设置其它密码也可以
生成完成，可在指定目录下找到证书文件。
二、配置Tomcat服务器
1、修改server.xml文件
(1)将生成的证书文件拷贝到Tomcat要引用的位置
(2)打开apache-tomcat-8.0.50confserver.xml，修改如下：
修改①：
(Tomcat版本不同该标签中内容会有一些变动，但大致不变)
去掉注释且修改参数
其中keystoreFile是证书存放的路径，keystorePass为生成证书时输入的密码
修改③：
修改参数
2、修改web.xml文件(可不修改)
打开apache-tomcat-8.0.50confweb.xml，修改如下：
在后面加上这样一段
CLIENT-CERT
Client Cert Users-only Area
SSL
/*
CONFIDENTIAL
上述配置完成后，重启Tomcat后即可以使用SSL。IE地址栏中可以直接输入地址不必输入“http://” 或者 “https://” ；也可以输入 “http:// ” 会跳转成为 “https://” 来登录" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a5ba18b6d712345e2b7f9378132a9a1d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-08T04:17:50+08:00" />
<meta property="article:modified_time" content="2021-08-08T04:17:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">http服务器升级配置信息错误,Http升级到Https （本地测试，无须域名和认证）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>在之前的语音识别的项目中，一切都在本地进行得很顺利，然后把写的Demo部署到服务器上给老大看的时候，通过IP访问(http://192.168.xxx.xxx:8080这样的形式)时，从一开始就坏掉了，使用Chrome都不能开启录音的权限了，就谈不上语音转换了，用Firefox来访问居然迷之没有问题，说明我写的Demo没有问题，那一定就是Chrome的问题了。调出错误的报告显示得是</p> 
 <p>Only secure origins are allowed (see: https://goo.gl/Y0ZkNV).</p> 
 <p>找到问题立马一百度就出来了</p> 
 <p>报错的原因大概就是谷歌浏览器认为我的url是不安全的，不能开启麦克风，摄像头，定位等权限。那怎么才是安全的呢，只能把http协议升级为https。</p> 
 <p>因为升级https需要购买SSL证书之类的，并且都没有自己的域名，所以只能在本地使用java的Keytool命令生成一个，来测试一下升级到Https是否能解决我的问题。</p> 
 <p>本文一下内容参考博客</p> 
 <p>Tomcat配置https及访问http自动跳转至https</p> 
 <p>一、生成证书文件</p> 
 <p>步骤：</p> 
 <p>(1)打开cmd，输入</p> 
 <p>keytool -genkey -alias tomcat -keyalg RSA -keystore F:omcat.keystore -validity 36500</p> 
 <p>参数简要说明：“F:omcat.keystore”含义是将证书文件保存在F盘，证书文件名称是tomcat.keystore ；</p> 
 <p>“-validity 36500”含义是证书有效期，36500表示100年，默认值是90天</p> 
 <p>(2)在命令行填写必要的参数</p> 
 <p align="center"><img src="https://images2.imgbox.com/dc/06/rHYiDotI_o.png" alt="5991d4e7fa739f1d98135a8aadeefba3.png"></p> 
 <p>输入密钥库密码：此处需要输入大于6个字符的字符串，例如123456</p> 
 <p>输入两次密码之后弹出以下问题</p> 
 <p align="center"><img src="https://images2.imgbox.com/29/09/fs2CMrZ3_o.png" alt="8e687a93e0e53cb3181aeddb656868c0.png"></p> 
 <p>“您的名字与姓氏是什么？”这是必填项，并且必须是TOMCAT部署主机的域名或者IP[如：gbcom.com 或者 192.168.145.170]，就是你将来要在浏览器中输入的访问地址</p> 
 <p>“你的组织单位名称是什么？”、“您的组织名称是什么？”、“您所在城市或区域名称是什么？”、“您所在的州或者省份名称是什么？”、“该单位的两字母国家代码是什么？” 可以按照需要填写也可以不填写直接回车，在系统询问“正确吗？”时，对照输入信息，如果符合要求则使用键盘输入字母“y”，否则输入“n”重新填写上面的信息</p> 
 <p align="center"><img src="https://images2.imgbox.com/6f/04/PpURDtMG_o.png" alt="eaf7b0ecbd2724b7e0d018f371815790.png"></p> 
 <p>(3)输入tomcat主密码</p> 
 <p>输入的主密码，这项较为重要，会在tomcat配置文件中使用，建议输入与keystore的密码一致，设置其它密码也可以</p> 
 <p>生成完成，可在指定目录下找到证书文件。</p> 
 <p>二、配置Tomcat服务器</p> 
 <p>1、修改server.xml文件</p> 
 <p>(1)将生成的证书文件拷贝到Tomcat要引用的位置</p> 
 <p>(2)打开apache-tomcat-8.0.50confserver.xml，修改如下：</p> 
 <p>修改①：</p> 
 <p align="center"><img src="https://images2.imgbox.com/4a/71/WMpGqYsc_o.png" alt="60801372e702e212b14aa127e1bbb787.png"></p> 
 <p>(Tomcat版本不同该标签中内容会有一些变动，但大致不变)</p> 
 <p>去掉注释且修改参数</p> 
 <p>其中keystoreFile是证书存放的路径，keystorePass为生成证书时输入的密码</p> 
 <p>修改③：</p> 
 <p align="center"><img src="https://images2.imgbox.com/0f/ef/qqP82hDT_o.png" alt="216c71e2ec5fd8cd81c779698152a0ca.png"></p> 
 <p>修改参数</p> 
 <p>2、修改web.xml文件(可不修改)</p> 
 <p>打开apache-tomcat-8.0.50confweb.xml，修改如下：</p> 
 <p>在后面加上这样一段</p> 
 <p align="center"><img src="https://images2.imgbox.com/0e/51/QlVs7Od7_o.png" alt="b2d245c88fdf9dadd4f17b03376b92ca.png"></p> 
 <p>CLIENT-CERT</p> 
 <p>Client Cert Users-only Area</p> 
 <p>SSL</p> 
 <p>/*</p> 
 <p>CONFIDENTIAL</p> 
 <p>上述配置完成后，重启Tomcat后即可以使用SSL。IE地址栏中可以直接输入地址不必输入“http://” 或者 “https://” ；也可以输入 “http:// ” 会跳转成为 “https://” 来登录</p> 
 <p>注意事项：</p> 
 <p>(1)生成证书的时间，如果IE客户端所在机器的时间早于证书生效时间，或者晚于有效时间，IE会提示“该安全证书已到期或还未生效”</p> 
 <p>(2)如果浏览器提示“安全证书上的名称无效或者与站点名称不匹配”，则是由生成证书时填写的服务器所在主机的域名“您的名字与姓氏是什么？”您的名字与姓氏是什么?”不正确引起的</p> 
 <p>Tomcat配置完成后，使用Https访问，Chrome会提示安全警告，点击“高级”，继续访问即可，结果再https下使用ip地址访问是没有问题的可以获取浏览器麦克风权限。</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/06b4b0063e804d7ff7542c6a9bccd8f9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">浏览器 服务器结构的信息管理模式,基于浏览器/服务器结构的CAD图纸管理系统...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/726f6fb367692161973a1327fc23b716/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C语言实现-求m到n之和</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>