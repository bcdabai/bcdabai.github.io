<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Charles抓包使用及常用问题 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Charles抓包使用及常用问题" />
<meta property="og:description" content="简介 Charles其实是一款代理服务器，通过成为电脑或者浏览器的代理，然后截取请求和请求结果达到分析抓包的目的。该软件是用Java写的，能够在Windows，Mac，Linux上使用，安装Charles的时候要先装好Java环境。
Charles是在 常用的网络封包截取工具，在做移动开发时，我们为了调试与服务器端的网络通讯协议，常常需要截取网络封包来分析。Charles 通过将自己设置成系统的网络访问代理服务器，使得所有的网络访问请求都通过它来完成，从而实现了网络封包的截取和分析。除了在做移动开发中调试端口外，Charles 也可以用于分析第三方应用的通讯协议。配合 Charles 的 SSL 功能，Charles 还可以分析 HTTP协议。
Charles 是收费软件，可以免费试用 30 天。试用期过后，未付费的用户仍然可以继续使用，但是每次使用时间不能超过 30 分钟，并且启动时将会有 10 秒种的延时。因此，该付费方案对广大用户还是相当友好的，即使你长期不付费，也能使用完整的软件功能。只是当你需要长时间进行封包调试时，会因为 Charles 强制关闭而遇到影响。（可以自行网上查找破解版软件）
Charles 主要的功能包括：
截取 Http 和 Https 网络封包。
支持重发网络请求，方便后端调试。
支持修改网络请求参数。
支持网络请求的截获并动态修改。
支持模拟慢速网络。
1. Charles安装
前提先安装配置好Java环境，官网下载安装Charles:https://www.charlesproxy.com/download/
2. HTTP抓包
（1）查看电脑IP地址
方法一： 打开”运行”（快捷键：win&#43;R键；或者在任务栏的”搜索”按钮中查找并点击”运行”），输入“cmd”后进入命令行窗口，在命令行窗口中输入”ipconfig”命令查看IP 方法二： 在charles中查看 ：Help -&gt; Local IP Address
（2）Charles代理设置
接下来打开Charles的代理设置：Proxy-&gt;Proxy Settings，设置一下端口号，默认的是8888，这个只要不和其他程序的冲突即可,并且勾选Enable transparent HTTP proxying。
（3）在手机设备、模拟器或者远程浏览器上设置代理，抓取手机设备上的请求包（手机和电脑必须在同一个局域网内，并关闭电脑防火墙、其他代理或者翻墙软件）
第一步：在手机wifi 上设置代理 -&gt; 长按无线网络--&gt;修改网络--&gt;高级选项--&gt;代理 手动--&gt;手动输入输入IP、端口号
服务器IP：PC机器的IP（通过之前介绍的查看IP的方法）
端口号：8888（通过之前介绍的查看端口的方法） 第二步：Charles弹出询问“allow”或者“deny”,点击“allow”按钮允许；出现手机的HTTP请求列表
安装证书
第三步：抓取https数据需要在手机上安装证书，HTTPS的抓包需要在HTTP抓包基础上再进行设置
如果我们需要在iOS或Android机器上截取 Https 协议的通讯内容，还需要在手机上安装相应的证书。
设置前抓包HTTPS接口显示unknown（图左），设置后接口正常展示，如下图右" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e9f784e4fbf1ae2d83f0d7a66a229bf5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-02T21:15:00+08:00" />
<meta property="article:modified_time" content="2021-12-02T21:15:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Charles抓包使用及常用问题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>简介</h2> 
<p>Charles其实是一款代理服务器，通过成为电脑或者浏览器的代理，然后截取请求和请求结果达到分析抓包的目的。该软件是用Java写的，能够在Windows，Mac，<a href="https://so.csdn.net/so/search?from=pc_blog_highlight&amp;q=Linux" title="Linux">Linux</a>上使用，<strong>安装Charles的时候要先装好Java环境</strong>。</p> 
<p><a href="http://www.charlesproxy.com/" rel="nofollow" title="Charles">Charles</a>是在 常用的网络封包截取工具，在做<a href="http://lib.csdn.net/base/wechat" rel="nofollow" title="移动开发">移动开发</a>时，我们为了调试与服务器端的网络通讯协议，常常需要截取网络封包来分析。Charles 通过将自己设置成系统的网络访问代理服务器，使得所有的网络访问请求都通过它来完成，从而实现了网络封包的截取和分析。除了在做移动开发中调试端口外，Charles 也可以用于分析第三方应用的通讯协议。配合 Charles 的 SSL 功能，Charles 还可以分析 <a href="https://www.cnblogs.com/ranyonsue/p/5984001.html" rel="nofollow" title="HTTP协议">HTTP协议</a>。</p> 
<p>Charles 是收费软件，可以免费试用 30 天。试用期过后，未付费的用户仍然可以继续使用，但是每次使用时间不能超过 30 分钟，并且启动时将会有 10 秒种的延时。因此，该付费方案对广大用户还是相当友好的，即使你长期不付费，也能使用完整的软件功能。只是当你需要长时间进行封包调试时，会因为 Charles 强制关闭而遇到影响。（可以自行网上查找破解版软件）</p> 
<p>Charles 主要的功能包括：</p> 
<p>截取 Http 和 Https 网络封包。</p> 
<p>支持重发网络请求，方便后端调试。</p> 
<p>支持修改网络请求参数。</p> 
<p>支持网络请求的截获并动态修改。</p> 
<p>支持模拟慢速网络。</p> 
<p><strong>1. Charles安装</strong></p> 
<p>前提先安装配置好Java环境，官网下载安装Charles:<a href="https://link.jianshu.com/?t=https://www.charlesproxy.com/download/" rel="nofollow" title="https://www.charlesproxy.com/download/">https://www.charlesproxy.com/download/</a></p> 
<p>2. HTTP抓包</p> 
<p><strong>（1）查看电脑IP地址</strong></p> 
<p>方法一： 打开”运行”（快捷键：win+R键；或者在任务栏的”搜索”按钮中查找并点击”运行”），输入“cmd”后进入命令行窗口，在命令行窗口中输入”ipconfig”命令查看IP </p> 
<p>方法二： 在charles中查看 ：Help -&gt; Local IP Address</p> 
<p><img alt="" src="https://images2.imgbox.com/19/5c/MPrxMq1D_o.png"></p> 
<p><strong>（2）Charles代理设置</strong></p> 
<p>接下来打开Charles的代理设置：Proxy-&gt;Proxy Settings，设置一下端口号，默认的是8888，这个只要不和其他程序的冲突即可,并且勾选Enable transparent HTTP proxying。</p> 
<p><img alt="" src="https://images2.imgbox.com/a3/67/WTpoHfJD_o.png"></p> 
<p><strong>（3）在手机设备、模拟器或者远程浏览器上设置代理，</strong>抓取手机设备上的请求包（手机和电脑必须在同一个局域网内，并关闭电脑防火墙、其他代理或者翻墙软件）</p> 
<p>第一步：在手机wifi 上设置代理 -&gt; 长按无线网络--&gt;修改网络--&gt;高级选项--&gt;代理 手动--&gt;手动输入输入IP、端口号</p> 
<p>服务器IP：PC机器的IP（通过之前介绍的查看IP的方法）</p> 
<p>端口号：8888（通过之前介绍的查看端口的方法） </p> 
<p><img alt="" src="https://images2.imgbox.com/82/56/dnNK8DJF_o.png"></p> 
<p> 第二步：Charles弹出询问“allow”或者“deny”,点击“allow”按钮允许；出现手机的HTTP请求列表</p> 
<p><img alt="" src="https://images2.imgbox.com/9d/4b/WqiTO7Dw_o.png"></p> 
<p>安装证书</p> 
<p>第三步：抓取https数据需要在手机上安装证书，HTTPS的抓包需要在HTTP抓包基础上再进行设置</p> 
<p>如果我们需要在<a href="http://lib.csdn.net/base/ios" rel="nofollow" title="iOS">iOS</a>或<a href="http://lib.csdn.net/base/android" rel="nofollow" title="Android">Android</a>机器上截取 Https 协议的通讯内容，还需要在手机上安装相应的证书。</p> 
<p>设置前抓包HTTPS接口显示unknown（图左），设置后接口正常展示，如下图右</p> 
<p><img alt="" src="https://images2.imgbox.com/4e/01/65lIJCwo_o.png"></p> 
<p>安装证书</p> 
<p>如果你发现返回的是乱码，首先看是在http请求还是https请求，如果是http请求，那么应该就是返回来的中文乱码,解决方案是找到该软件显示包内容，Contents目录下的info.plist，打开文件找到vmoption,添加-Dfile.encoding=UTF-8即可。</p> 
<p>如果是https请求出现的乱码，如下图这种情况</p> 
<p><img alt="" src="https://images2.imgbox.com/f3/a0/D11AfYG5_o.png"></p> 
<p>https请求出现乱码</p> 
<p>这时候你就需要安装Charles的CA证书了</p> 
<p><strong>以下为在HTTP抓包基础上进行HTTP抓包的进一步设置步骤:</strong></p> 
<p>Help -&gt; SSL proxying -&gt; Install charles root certificate on a Mobile Device or remote browser…</p> 
<p>出现弹窗得到地址<a href="https://link.jianshu.com/?t=chls.pro/ssl" rel="nofollow" title="chls.pro/ssl">chls.pro/ssl</a></p> 
<p>在手机自带的系统浏览器输入地址<a href="https://link.jianshu.com/?t=chls.pro/ssl" rel="nofollow" title="chls.pro/ssl">chls.pro/ssl</a>，出现证书安装页面，点击安装，手机设置有密码的输入密码进行安装。安装完证书后，就可以截取手机上的 Https 通讯内容了。不过同样需要注意，默认情况下 Charles 并不做截取，你还需要在要截取的网络请求上右击，选择 SSL proxy 菜单项。</p> 
<p><strong><em>注意2：</em>iOS 10.3系统，需要在<em>设置→通用→关于本机→证书信任设置</em>里面启用完全信任Charles证书</strong></p> 
<p><img alt="" src="https://images2.imgbox.com/0f/87/9USZWWdT_o.png"></p> 
<p><strong>Charles设置Proxy代理</strong></p> 
<p>Proxy -&gt; SSL Proxying Settings... 勾选Enable SSL Proxying,点击Add,点击Add，Host设置要抓取的https接口，  </p> 
<p>Host : * (使用通配符表示检测所有网络请求；建议还是设置单个需要抓取的https host，尽量避免使用 * 通配符)</p> 
<p>Port：443</p> 
<p><img alt="" src="https://images2.imgbox.com/29/f2/2akjZg48_o.png"></p> 
<p> 比如想抓这个，Host填写：<a href="https://link.jianshu.com/?t=https://api.weibo.cn" rel="nofollow" title="https://api.weibo.cn">https://api.weibo.cn</a>Port填写：443</p> 
<p><img alt="" src="https://images2.imgbox.com/60/56/28lK7w0d_o.png"></p> 
<p> ！！！完成以上操作，就完成Charles抓取HTTP(S)数据包的所有配置了。查看Charles,我们可以看到数据包的内容了。 </p> 
<h2>Charles 主界面介绍</h2> 
<p>主要是会话的两种视图模式以及对应的 requet/response 面板组成:</p> 
<p><img alt="" src="https://images2.imgbox.com/2d/5e/P83MM2Jv_o.png"></p> 
<p> </p> 
<p>Structure视图</p> 
<p><img alt="" src="https://images2.imgbox.com/11/4e/P7NkyfSG_o.png"></p> 
<p> </p> 
<p>Sequence视图</p> 
<p>Structure：树状结构显示，将网络请求按访问的域名分类；</p> 
<p>Sequence：水平结构显示，将网络请求按访问的时间排序</p> 
<p>Structure视图模式下,列表会按照域名来归类所有请求,而Sequence视图则是按照请求发生的顺序来展示;如果不习惯Sequence默认的上下视图,可以修改为类似Fiddler的左右视图模式(有更符合眼睛的习惯):快捷键 cmd+,-&gt;Charles Preferences-&gt;Viewers选择Sequence view layout为Tall即可;</p> 
<p>常用的功能在图上已经有注释,不多说,感觉Chales的右键功能比Fiddler多一点,简单看几个:</p> 
<p>Save response: 保存response数据到文件中,方便后面用于重定向功能map local...;选择多条记录后再右键就会有Save All...可以方便的把所有response信息一次性导出到某个目录中,然后通过map local...结合通配符来批量重定向请求;</p> 
<p>Export: 可以将选中的多个会话信息完整导出成文件(*.chls),通过File - import来导入chls文件,方便不同开发人员进行调试或者现象复现分析;</p> 
<p>repeat advanced...: 可以重发次数以及并发数,用于进行简单的服务器压测,看到有些简友还用它来对付一般的钓鱼网站,有点意思..</p> 
<p><img alt="" src="https://images2.imgbox.com/a6/78/Gkv8Y3Jo_o.png"></p> 
<p><strong>Filter </strong>： 过滤，可以输入关键字来快速筛选出 URL 中带指定关键字的网络请求</p> 
<p><strong>Overview </strong>： 查看这次请求的详细内容，例如耗时详细列车了请求开始时间、结束时间，响应开始时间、结束时间，总耗时、DNS耗时、网络延时等。</p> 
<p>对于Size也详细列出了请求头大小、响应头大小、压缩比例等内容。 </p> 
<p><strong>URL</strong>：进行网络请求的链接；</p> 
<p><strong>Status</strong>：当前状态，complete表示请求完成；</p> 
<p><strong>Responce Code</strong>：返回码。不同的接口，不同的请求结果，返回码都不同；</p> 
<p><strong>Protocol：</strong>使用的协议；</p> 
<p><strong>Method：</strong>请求方式，如GET请求，POST请求等；</p> 
<p><strong>Kept Alive：</strong>判断当前是否正在链接（活跃）；</p> 
<p><strong>Content-Type:</strong>发送的内容类型，如这里用的是XML文本，以UTF8的方式发送；</p> 
<p><strong>Client Address：</strong>客户端的IP地址；</p> 
<p><strong>Remote Address：</strong>远程服务器的IP；</p> 
<p>Timing: </p> 
<p><strong>Request Start Time：</strong>请求开始的时间；</p> 
<p><strong>Request End Time：</strong>请求结束的时间；</p> 
<p><strong>Response Start Time：</strong>返回开始的时间；</p> 
<p><strong>Response End Time :</strong> 返回结束的时间；</p> 
<p><strong>Duration :</strong> 总时间；</p> 
<p>Size: </p> 
<p><strong>Request Header ：</strong>请求的头部大小；</p> 
<p><strong>Response Header：</strong>返回的头部大小；</p> 
<p><strong>Request : </strong>请求发送的大小；</p> 
<p><strong>Response：</strong>返回数据的大小；</p> 
<p><strong>Total：</strong>所有数据大小；</p> 
<p><strong>Request Compression :</strong> 请求压缩；</p> 
<p><strong>Response Compression : </strong>返回压缩；</p> 
<p><strong>Request ：</strong> 查看请求内容（底下的Headers，Query String，Cookies，Raw。）</p> 
<p><strong>Headers：</strong>发送请求的头部信息；</p> 
<p><strong>Query String : </strong>发送参数列表；</p> 
<p><strong>Cookies：</strong> 浏览器缓存；</p> 
<p><strong>Raw：</strong>发送的原生数据，包括了头部和参数；</p> 
<p><strong>Reponse :</strong> 查看响应内容</p> 
<p><strong>Headers：</strong>是返回的头部信息；</p> 
<p><strong>Text：</strong>返回信息（除去头部）后的文本；</p> 
<p><strong>Hex：</strong>返回信息的16进制表示；</p> 
<p><strong>XML：</strong>我返回的数据是XML。如果你返回的是JSON，这里就会显示JSON；</p> 
<p><strong>XML Text：</strong>如果你返回JSON，这里会显示JSON Text；</p> 
<p><strong>Raw：</strong>返回的所有原生数据，包括头部；</p> 
<p><strong>Summary: </strong>查看发送数据的一些简要信息（主机，状态码，数据的类型，header和body大下，加载时间，总时间）</p> 
<p><strong>Chart: </strong>Summary中简要信息以图表形式展示</p> 
<p><strong>Notes: </strong>其他信息</p> 
<p><a href="http://tool.oschina.net/commons?type=5" rel="nofollow" title="抓包接口测试需要了解下相关HTTP状态码所对应说明">抓包接口测试需要了解下相关HTTP状态码所对应说明</a></p> 
<h2>菜单</h2> 
<p>Proxy 菜单</p> 
<p>这个用得比较多,在这里设置跟踪捕捉过滤功能:</p> 
<p><img alt="" src="https://images2.imgbox.com/58/10/X9Pw4Yn3_o.png"></p> 
<p>Proxy菜单</p> 
<p>过滤( Recording Settings )</p> 
<p><img alt="" src="https://images2.imgbox.com/d7/b3/1o77Ow93_o.png"></p> 
<p>Recording Settings </p> 
<p>设置会话捕捉条件，include 面板用于启用/停止可以捕捉/显示的会话;</p> 
<p>exclude 表示不显示的会话,在会话列表中右键选择 ignore 时,对应的url会出现在这里;</p> 
<p><img alt="" src="https://images2.imgbox.com/80/06/LLuGoL3j_o.png"></p> 
<p>record_setting_add</p> 
<p>比较好用的是过滤条件支持通配符,*表示任意多个字符,?表示一个字符,如Protocol中有http,https和 "",选择空白或者输入*都可以表示任意协议的请求;</p> 
<p>也可以通过主界面底部的Filter来简单设置过滤条件,不支持通配符</p> 
<p><img alt="" src="https://images2.imgbox.com/71/ac/2dBZQZGT_o.png"></p> 
<p>filter</p> 
<p>还有一种方法就是在一个网址上右击，选择Focus，然后其他的请求就会被放到一个叫Other Host的文件夹里面，这样也达到了过滤的目的。</p> 
<p>设置允许连接的ip地址(Access control Settings)</p> 
<p><img alt="" src="https://images2.imgbox.com/f3/7a/1CMwVLDD_o.png"></p> 
<p>access_control_settings</p> 
<p>模拟网络环境(Throttle Settings)</p> 
<p><img alt="" src="https://images2.imgbox.com/3e/3a/huylj8uk_o.png"></p> 
<p>throttle_settings</p> 
<p>在这里选择要模拟的网络环境,选项比Fidder多很多,也可以自定义,最人性的还可以对指定的url进行网络环境摸, 好评...</p> 
<p>这里设置完成后通过Proxy-Start Throttling(Ctrl+T)或者常用工具栏按钮来启用或停止;</p> 
<p>设置为代理服务器,并捕获手机请求(Proxy Settings)</p> 
<p><img alt="" src="https://images2.imgbox.com/29/b7/cu3Kzmx0_o.png"></p> 
<p>proxy_settings</p> 
<p>端口号 Port 默认8888,跟Fiddler一样,省得切换软件的时候,手机还得重新设置wifi代理了;</p> 
<p>记得启用Enable transtarent HTTP proxying</p> 
<p>手机上的设置跟Fiddler类似,切换到wifi设置页面,选择高级选项--&gt;代理模式选择手动,代理服务器设置为 Charles 所在设备的ip,端口就是上面设定的8888, 注意: 手机和Charles所在机器需处于同一个wifi网络中;</p> 
<p>以上设定完成后,就可以charles中捕获手机请求了,第一次连接的时候charles会弹出确认提示框,选择 allow 就好了,后续可在 proxy -&gt; access control settings 中进行管理:</p> 
<p><img alt="" src="https://images2.imgbox.com/fd/32/mMzQMQWb_o.png"></p> 
<p>mobile_connect</p> 
<h2>Tools菜单</h2> 
<p><img alt="" src="https://images2.imgbox.com/a6/8c/tkNdhCOE_o.png"></p> 
<p>tools</p> 
<p>rewrite 动态修改 request/response 信息</p> 
<p>跟map local类似,也可以对response进行修改,不过他改变的只是部份信息,比如:主机地址(Host),返回状态码(response status),返回信息内容(body)等:</p> 
<p><img alt="" src="https://images2.imgbox.com/e7/48/pUvjKTMW_o.png"></p> 
<p>rewrite</p> 
<p>捕获https请求</p> 
<p>1.  在本机上安装证书</p> 
<p><img alt="" src="https://images2.imgbox.com/86/7d/hUi7Mh4g_o.png"></p> 
<p>help - ssl proxying</p> 
<p>这里可以直接选择Install charles root certificate,会在本机上安装证书,也可以如图选择保存证书,然后手动导入到需要的位置,操作类似:</p> 
<p><img alt="" src="https://images2.imgbox.com/2d/40/dwlZmYJV_o.gif"></p> 
<p>安装证书</p> 
<p>mac上的操作请看<a href="https://link.jianshu.com/?t=http%3A%2F%2Fblog.csdn.net%2Fyangmeng13930719363%2Farticle%2Fdetails%2F51645435" rel="nofollow" title="这篇">这篇</a></p> 
<p>2. 在手机上安装证书</p> 
<p>单击help--ssl proxying-install charles root certificate on a mobile device or remote browser,会弹出提示框,然后在手机浏览器上输入网址:chls.pro/ssl,然后根据提示保存证书即可:</p> 
<p><img alt="" src="https://images2.imgbox.com/5a/48/7Na0lJYA_o.png"></p> 
<p><strong>3. 启用https捕捉</strong></p> 
<p><img alt="" src="https://images2.imgbox.com/50/e7/e2Ehdf3l_o.png"></p> 
<p>enable https</p> 
<p>启用后就可以在会话视图列表中看到https请求了;</p> 
<p><strong>4.断点功能</strong></p> 
<p>方法:</p> 
<p>在会话列表中右键点击某个会话,然后在菜单中选择Breakpoints;</p> 
<p>通过Proxy-Breakpoint settings...中手动新建/启用某个断点;</p> 
<p>要求勾选enable breakpoints</p> 
<p>之后当下次再有该请求时,会自动进入断点模式;</p> 
<p>一个完整请求会进入断点模式2次:</p> 
<p>request的发出之前;</p> 
<p>收到服务器的response但尚未返回给客户端的时候;</p> 
<p>断点request的时候,可以修改request信息,不过我们程序都有对请求header做校验和处理,修改参数后一般就直接报错了,所以这里看看response就好,反正操作类似:</p> 
<p><img alt="" src="https://images2.imgbox.com/42/c7/2aHfw4Wj_o.png"></p> 
<p><strong>breakpoint</strong></p> 
<p>在edit response中可以双击直接修改json文件的key/value值,很方便,修改完成后单击execute继续执行其他操作,将修改后的response返回给客户端;</p> 
<p>response 重定向功能</p> 
<p>这个跟Fiddler的autoResponse功能类似,可以指定本地文件(map local...)也可以指定为其他服务器(map remote...)上的文件,我们介绍前一种;</p> 
<p>这里的map local只能重定向response的数据内容部分,而headers</p> 
<p>还是会保留服务器返回的,比如要修改返回码之类的操作,目前来看,只能通过断点或者rewrite来进行,这一点比Filder弱,不太方便,也可能是我还没发现怎么处理,有知道的请不吝告知,谢谢;</p> 
<p>断点可以用于临时修改数据,也是一种重定向功能,若是要长期重定向,咱还是将返回重定向到本机文件比较方便,具体方法:</p> 
<p>准备一份要返回给客户端的 response 数据文件,可以从前面介绍的save Response来保存正常数据,然后修改,也可以自己构造一份(用于服务端api尚未发布,但移动端又需要进行调试的时候);</p> 
<p>右键单击某个请求,从菜单中选择map local ..., 也可以单击Tools-Map Local...打开map lcoal settings来添加一个映射关系,两种操作是一样的,前者只不过直接把url信息给写好了:</p> 
<p><img alt="" src="https://images2.imgbox.com/3e/ba/Eiehp33C_o.png"></p> 
<p>map local</p> 
<p>完成设定后,后续符合条件的请求都会用本地映射文件替代;</p> 
<p>最后: 我之前在Windows下是 Fiddler 和 Charles 配合使用,主要是 Fiddler 的https抓包一直出问题,而 Charles 就很一切正常,后来更换mbp后就一直用 Charles 了,不过Charles也有自己的不足:</p> 
<p>删除多个会话时会感觉得到卡,而Fiddler很顺畅;</p> 
<p>filter功能没Fiddler强大;</p> 
<p>Fiddler提供脚本自定义功能,如果是C#开发者的话,还可以很方便的集成fiddler_core到自己的应用中;</p> 
<h2><a name="t5" title=""></a><strong>常见问题解决</strong></h2> 
<p>1 . 手机无法抓包的问题</p> 
<p>检查是否配置好代理IP,端口号</p> 
<p>检查是否与电脑在同一个局域网</p> 
<p>检查是否关闭防火墙，代理，翻墙软件</p> 
<p>弹出询问点击“allow”或者“deny”时，误点“deny”，关闭charles重启，手机再次浏览则会重新弹出询问</p> 
<p>2 . 解决request和response信息中的中文乱码问题。</p> 
<p>方法一 ：修改charles windows版本安装目录下也有一个Charles.ini的配置文件 </p> 
<p>原配置文件</p> 
<p><img alt="" src="https://images2.imgbox.com/38/71/YoNQxGFL_o.png"></p> 
<p>修改后的配置文件 增加vmarg.3参数，并设置编码格式为UTF-8</p> 
<p><img alt="" src="https://images2.imgbox.com/98/51/EQcWPuSA_o.png"></p> 
<p>方法二 ： Tools -&gt; Rewrite… -&gt; Rules -&gt; Add –&gt;配置信息 </p> 
<p>选中 Request 和 Response</p> 
<p>Match </p> 
<p>Name : Content-Type</p> 
<p>Value : application/x-zip</p> 
<p>Replace </p> 
<p>Name : Content-Type</p> 
<p>Value : application/json;charset=UTF-8</p> 
<p>选中 Replace All</p> 
<p><img alt="" src="https://images2.imgbox.com/d6/ce/iDkKwjcb_o.png"></p> 
<p>–》点击OK，完成配置。</p> 
<p>！！！通过以上方法就可以解决Request和Response的中文乱码问题了。</p> 
<p>3 . 本地映射配置错了，删除错误的映射</p> 
<p>Tools -&gt; Map Local… -&gt; 选中需要删除的映射 -&gt; Remove -&gt; OK</p> 
<p><img alt="" src="https://images2.imgbox.com/e6/d1/p26xyqTx_o.png"></p> 
<p>注意：不抓包请关闭手机HTTP代理，否则断开与电脑连接后会连不上网</p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/14085679cb3958e35fd7560805c59f0a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Impala入门操作</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/57d479f165ffee158dab4324e26bf61c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">VS生成自己的DLL并调用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>