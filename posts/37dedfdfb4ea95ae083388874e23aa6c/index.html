<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ã€Œreactè¿›é˜¶ã€ reactå…¨éƒ¨apiè§£è¯»&#43;åŸºç¡€å®è·µå¤§å…¨(å¤¯å®åŸºç¡€) - ç¼–ç¨‹å¤§ç™½çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ã€Œreactè¿›é˜¶ã€ reactå…¨éƒ¨apiè§£è¯»&#43;åŸºç¡€å®è·µå¤§å…¨(å¤¯å®åŸºç¡€)" />
<meta property="og:description" content="å¾ˆå¤šåŒå­¦ç”¨reactå¼€å‘çš„æ—¶å€™ï¼ŒçœŸæ­£ç”¨åˆ°çš„Reactçš„apiå°‘ä¹‹åˆå°‘ï¼ŒåŸºæœ¬åœç•™åœ¨Component,React.memoç­‰å±‚é¢,å®é™…reactæºç ä¸­ï¼Œæš´éœ²å‡ºæ¥çš„æ–¹æ³•å¹¶ä¸å°‘ï¼Œåªæ˜¯æˆ‘ä»¬å¹³æ—¶å¾ˆå°‘ç”¨ã€‚ä½†æ˜¯Reactæš´éœ²å‡ºè¿™ä¹ˆå¤šapiå¹¶éæ²¡æœ‰ç”¨ï¼Œæƒ³è¦ç©è½¬react,å°±è¦æ˜ç™½è¿™äº›APIç©¶ç«Ÿæ˜¯å¹²ä»€ä¹ˆçš„ï¼Œåº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Œä»Šå¤©å°±è®©æˆ‘ä»¬ä»react åˆ° react-dom,ä¸€æ¬¡æ€§æŠŠreactç”Ÿäº§ç¯å¢ƒçš„æš´éœ²apiå¤ä¹ ä¸ªé(æ¶µç›–90%&#43;)ã€‚
æˆ‘ä»¬æŠŠreact,APIï¼Œåˆ†ä¸ºç»„ä»¶ç±»ï¼Œå·¥å…·ç±»ï¼Œhooksï¼Œå†åŠ ä¸Š react-dom ï¼Œä¸€å…±å››å¤§æ–¹å‘ï¼Œåˆ†åˆ«åŠ ä»¥æ¢è®¨ã€‚
ä¸ºäº†èƒ½è®©å±å¹•å‰çš„ä½ ï¼Œæ›´ç†è§£api,æˆ‘æ˜¯ç»å°½è„‘æ±,æœ¬æ–‡çš„æ¯ä¸€ä¸ªapiåŸºæœ¬éƒ½ä¼šå‡ºä¸€ä¸ªdemoæ¼”ç¤ºæ•ˆæœ,å¼¥è¡¥ä¸€ä¸‹å¤©ä¹¦èˆ¬çš„reactæ–‡æ¡£ğŸ˜‚ğŸ˜‚ğŸ˜‚ï¼Œè¿˜æœ‰å°±æ˜¯æˆ‘å¯¹apiåŸºæœ¬æ¦‚å¿µçš„ç†è§£ã€‚åˆ›ä½œä¸æ˜“ï¼Œå¸Œæœ›å±å¹•å‰çš„ä½ èƒ½ç»™ç¬”è€…èµä¸ªèµï¼Œä»¥æ­¤é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œå‰ç«¯ç¡¬æ–‡ã€‚
è€è§„çŸ©ï¼Œæˆ‘ä»¬å¸¦ç€ç–‘é—®å¼€å§‹ä»Šå¤©çš„é˜…è¯»(è‡ªæµ‹æŒæ¡ç¨‹åº¦)ï¼Ÿ
1 reactæš´éœ²çš„apiæœ‰å“ªäº›ï¼Œè¯¥å¦‚ä½•ä½¿ç”¨ï¼Ÿ2 reactæä¾›äº†å“ªäº›è‡ªæµ‹æ€§èƒ½çš„æ‰‹æ®µï¼Ÿ3 refæ—¢ç„¶ä¸èƒ½ç”¨åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œé‚£ä¹ˆçˆ¶ç»„ä»¶å¦‚ä½•æ§åˆ¶å‡½æ•°å­ç»„ä»¶å†…çš„stateå’Œæ–¹æ³•ï¼Ÿ4 createElementå’ŒcloneElementæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ5 reactå†…ç½®çš„childrenéå†æ–¹æ³•ï¼Œå’Œæ•°ç»„æ–¹æ³•,æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ6 reactæ€ä¹ˆå°†å­å…ƒç´ æ¸²æŸ“åˆ°æŒ‡å®šçˆ¶å…ƒç´ ä¹‹å¤–çš„æŒ‡å®šå®¹å™¨ä¸­ï¼Ÿâ€¦ æˆ‘ç›¸ä¿¡è¯»å®Œè¿™ç¯‡æ–‡ç« ï¼Œè¿™äº›é—®é¢˜å…¨éƒ½ä¼šè¿åˆƒè€Œè§£ï¼Ÿ
ç»„ä»¶ç±» ç»„ä»¶ç±»ï¼Œè¯¦ç»†åˆ†çš„è¯æœ‰ä¸‰ç§ç±»ï¼Œç¬¬ä¸€ç±»è¯´ç™½äº†å°±æ˜¯æˆ‘å¹³æ—¶ç”¨äºç»§æ‰¿çš„åŸºç±»ç»„ä»¶Component,PureComponent,è¿˜æœ‰å°±æ˜¯reactæä¾›çš„å†…ç½®çš„ç»„ä»¶ï¼Œæ¯”å¦‚Fragment,StrictMode,å¦ä¸€éƒ¨åˆ†å°±æ˜¯é«˜é˜¶ç»„ä»¶forwardRef,memoç­‰ã€‚
Component Componentæ˜¯classç»„ä»¶çš„æ ¹åŸºã€‚ç±»ç»„ä»¶ä¸€åˆ‡å§‹äºComponentã€‚å¯¹äºReact.Componentä½¿ç”¨ï¼Œæˆ‘ä»¬æ²¡æœ‰ä»€ä¹ˆå¥½è®²çš„ã€‚æˆ‘ä»¬è¿™é‡Œé‡ç‚¹ç ”ç©¶ä¸€ä¸‹reactå¯¹Componentåšäº†äº›ä»€ä¹ˆã€‚
react/src/ReactBaseClasses.js
function Component(props, context, updater) { this.props = props; this.context = context; this.refs = emptyObject; this.updater = updater || ReactNoopUpdateQueue; } è¿™å°±æ˜¯Componentå‡½æ•°ï¼Œå…¶ä¸­updaterå¯¹è±¡ä¸Šä¿å­˜ç€æ›´æ–°ç»„ä»¶çš„æ–¹æ³•ã€‚
æˆ‘ä»¬å£°æ˜çš„ç±»ç»„ä»¶æ˜¯ä»€ä¹ˆæ—¶å€™ä»¥ä½•ç§å½¢å¼è¢«å®ä¾‹åŒ–çš„å‘¢ï¼Ÿ
react-reconciler/src/ReactFiberClassComponent.js
constructClassInstance
function constructClassInstance( workInProgress, ctor, props ){ const instance = new ctor(props, context); instance.updater = { isMounted, enqueueSetState(){ /* setState è§¦å‘è¿™é‡Œé¢çš„é€»è¾‘ */ }, enqueueReplaceState(){}, enqueueForceUpdate(){ /* forceUpdate è§¦å‘è¿™é‡Œçš„é€»è¾‘ */ } } } å¯¹äºComponentï¼Œ react å¤„ç†é€»è¾‘è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œå®ä¾‹åŒ–æˆ‘ä»¬ç±»ç»„ä»¶ï¼Œç„¶åèµ‹å€¼updaterå¯¹è±¡ï¼Œè´Ÿè´£ç»„ä»¶çš„æ›´æ–°ã€‚ç„¶ååœ¨ç»„ä»¶å„ä¸ªé˜¶æ®µï¼Œæ‰§è¡Œç±»ç»„ä»¶çš„renderå‡½æ•°ï¼Œå’Œå¯¹åº”çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°å°±å¯ä»¥äº†ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/37dedfdfb4ea95ae083388874e23aa6c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-19T13:49:50+08:00" />
<meta property="article:modified_time" content="2021-04-19T13:49:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§ç™½çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§ç™½çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ã€Œreactè¿›é˜¶ã€ reactå…¨éƒ¨apiè§£è¯»&#43;åŸºç¡€å®è·µå¤§å…¨(å¤¯å®åŸºç¡€)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>å¾ˆå¤šåŒå­¦ç”¨<code>react</code>å¼€å‘çš„æ—¶å€™ï¼ŒçœŸæ­£ç”¨åˆ°çš„<code>React</code>çš„<code>api</code>å°‘ä¹‹åˆå°‘ï¼ŒåŸºæœ¬åœç•™åœ¨<code>Component</code>,<code>React.memo</code>ç­‰å±‚é¢,å®é™…<code>react</code>æºç ä¸­ï¼Œæš´éœ²å‡ºæ¥çš„æ–¹æ³•å¹¶ä¸å°‘ï¼Œåªæ˜¯æˆ‘ä»¬å¹³æ—¶å¾ˆå°‘ç”¨ã€‚ä½†æ˜¯<code>React</code>æš´éœ²å‡ºè¿™ä¹ˆå¤š<code>api</code>å¹¶éæ²¡æœ‰ç”¨ï¼Œæƒ³è¦ç©è½¬<code>react</code>,å°±è¦æ˜ç™½è¿™äº›<code>API</code>ç©¶ç«Ÿæ˜¯å¹²ä»€ä¹ˆçš„ï¼Œåº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Œä»Šå¤©å°±è®©æˆ‘ä»¬ä»<code>react</code> åˆ° <code>react-dom</code>,ä¸€æ¬¡æ€§æŠŠ<code>react</code>ç”Ÿäº§ç¯å¢ƒçš„æš´éœ²<code>api</code>å¤ä¹ ä¸ªé(æ¶µç›–90%+)ã€‚</p> 
<p>æˆ‘ä»¬æŠŠ<code>react</code>,<code>API</code>ï¼Œåˆ†ä¸º<strong>ç»„ä»¶ç±»</strong>ï¼Œ<strong>å·¥å…·ç±»</strong>ï¼Œ<strong><code>hooks</code></strong>ï¼Œå†åŠ ä¸Š <strong><code>react-dom</code></strong> ï¼Œä¸€å…±å››å¤§æ–¹å‘ï¼Œåˆ†åˆ«åŠ ä»¥æ¢è®¨ã€‚</p> 
<p>ä¸ºäº†èƒ½è®©å±å¹•å‰çš„ä½ ï¼Œæ›´ç†è§£<code>api</code>,æˆ‘æ˜¯ç»å°½è„‘æ±,æœ¬æ–‡çš„æ¯ä¸€ä¸ª<code>api</code>åŸºæœ¬éƒ½ä¼šå‡ºä¸€ä¸ª<code>demo</code>æ¼”ç¤ºæ•ˆæœ,å¼¥è¡¥ä¸€ä¸‹å¤©ä¹¦èˆ¬çš„<code>react</code>æ–‡æ¡£ğŸ˜‚ğŸ˜‚ğŸ˜‚ï¼Œè¿˜æœ‰å°±æ˜¯æˆ‘å¯¹<code>api</code>åŸºæœ¬æ¦‚å¿µçš„ç†è§£ã€‚åˆ›ä½œä¸æ˜“ï¼Œå¸Œæœ›å±å¹•å‰çš„ä½ èƒ½ç»™ç¬”è€…èµä¸ª<strong>èµ</strong>ï¼Œä»¥æ­¤é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œå‰ç«¯ç¡¬æ–‡ã€‚</p> 
<p>è€è§„çŸ©ï¼Œæˆ‘ä»¬å¸¦ç€ç–‘é—®å¼€å§‹ä»Šå¤©çš„é˜…è¯»(<strong>è‡ªæµ‹æŒæ¡ç¨‹åº¦</strong>)ï¼Ÿ</p> 
<ul><li>1 <code>react</code>æš´éœ²çš„<code>api</code>æœ‰å“ªäº›ï¼Œè¯¥å¦‚ä½•ä½¿ç”¨ï¼Ÿ</li><li>2 <code>react</code>æä¾›äº†å“ªäº›è‡ªæµ‹æ€§èƒ½çš„æ‰‹æ®µï¼Ÿ</li><li>3 <code>ref</code>æ—¢ç„¶ä¸èƒ½ç”¨åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œé‚£ä¹ˆçˆ¶ç»„ä»¶å¦‚ä½•æ§åˆ¶å‡½æ•°å­ç»„ä»¶å†…çš„<code>state</code>å’Œæ–¹æ³•ï¼Ÿ</li><li>4 <code>createElement</code>å’Œ<code>cloneElement</code>æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</li><li>5 <code>react</code>å†…ç½®çš„<code>children</code>éå†æ–¹æ³•ï¼Œå’Œæ•°ç»„æ–¹æ³•,æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li><li>6 <code>react</code>æ€ä¹ˆå°†å­å…ƒç´ æ¸²æŸ“åˆ°æŒ‡å®šçˆ¶å…ƒç´ ä¹‹å¤–çš„æŒ‡å®šå®¹å™¨ä¸­ï¼Ÿ</li><li>â€¦</li></ul> 
<p>æˆ‘ç›¸ä¿¡è¯»å®Œè¿™ç¯‡æ–‡ç« ï¼Œè¿™äº›é—®é¢˜å…¨éƒ½ä¼šè¿åˆƒè€Œè§£ï¼Ÿ</p> 
<h2><a id="_20"></a>ç»„ä»¶ç±»</h2> 
<p>ç»„ä»¶ç±»ï¼Œè¯¦ç»†åˆ†çš„è¯æœ‰ä¸‰ç§ç±»ï¼Œç¬¬ä¸€ç±»è¯´ç™½äº†å°±æ˜¯æˆ‘å¹³æ—¶ç”¨äºç»§æ‰¿çš„åŸºç±»ç»„ä»¶<code>Component</code>,<code>PureComponent</code>,è¿˜æœ‰å°±æ˜¯<code>react</code>æä¾›çš„å†…ç½®çš„ç»„ä»¶ï¼Œæ¯”å¦‚<code>Fragment</code>,<code>StrictMode</code>,å¦ä¸€éƒ¨åˆ†å°±æ˜¯é«˜é˜¶ç»„ä»¶<code>forwardRef</code>,<code>memo</code>ç­‰ã€‚</p> 
<p><img src="https://images2.imgbox.com/94/21/yNRoTxVa_o.png" alt="comp.jpg"></p> 
<h3><a id="Component_27"></a>Component</h3> 
<p><code>Component</code>æ˜¯<code>class</code>ç»„ä»¶çš„æ ¹åŸºã€‚ç±»ç»„ä»¶ä¸€åˆ‡å§‹äº<code>Component</code>ã€‚å¯¹äº<code>React.Component</code>ä½¿ç”¨ï¼Œæˆ‘ä»¬æ²¡æœ‰ä»€ä¹ˆå¥½è®²çš„ã€‚æˆ‘ä»¬è¿™é‡Œé‡ç‚¹ç ”ç©¶ä¸€ä¸‹<code>react</code>å¯¹<code>Component</code>åšäº†äº›ä»€ä¹ˆã€‚</p> 
<p><code>react/src/ReactBaseClasses.js</code></p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">Component</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> context<span class="token punctuation">,</span> updater<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>props <span class="token operator">=</span> props<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>context <span class="token operator">=</span> context<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>refs <span class="token operator">=</span> emptyObject<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>updater <span class="token operator">=</span> updater <span class="token operator">||</span> ReactNoopUpdateQueue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>è¿™å°±æ˜¯<code>Component</code>å‡½æ•°ï¼Œå…¶ä¸­<code>updater</code>å¯¹è±¡ä¸Šä¿å­˜ç€æ›´æ–°ç»„ä»¶çš„æ–¹æ³•ã€‚</p> 
<p><strong>æˆ‘ä»¬å£°æ˜çš„ç±»ç»„ä»¶æ˜¯ä»€ä¹ˆæ—¶å€™ä»¥ä½•ç§å½¢å¼è¢«å®ä¾‹åŒ–çš„å‘¢ï¼Ÿ</strong></p> 
<p><code>react-reconciler/src/ReactFiberClassComponent.js</code></p> 
<p><strong>constructClassInstance</strong></p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">constructClassInstance</span><span class="token punctuation">(</span>
    workInProgress<span class="token punctuation">,</span>
    ctor<span class="token punctuation">,</span>
    props
<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
   <span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctor</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    instance<span class="token punctuation">.</span>updater <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        isMounted<span class="token punctuation">,</span>
        <span class="token function">enqueueSetState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/* setState è§¦å‘è¿™é‡Œé¢çš„é€»è¾‘ */</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">enqueueReplaceState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">enqueueForceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">/* forceUpdate è§¦å‘è¿™é‡Œçš„é€»è¾‘ */</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>å¯¹äº<code>Component</code>ï¼Œ <code>react</code> å¤„ç†é€»è¾‘è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œå®ä¾‹åŒ–æˆ‘ä»¬ç±»ç»„ä»¶ï¼Œç„¶åèµ‹å€¼<code>updater</code>å¯¹è±¡ï¼Œè´Ÿè´£ç»„ä»¶çš„æ›´æ–°ã€‚ç„¶ååœ¨ç»„ä»¶å„ä¸ªé˜¶æ®µï¼Œæ‰§è¡Œç±»ç»„ä»¶çš„<code>render</code>å‡½æ•°ï¼Œå’Œå¯¹åº”çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°å°±å¯ä»¥äº†ã€‚</p> 
<h3><a id="PureComponent_72"></a>PureComponent</h3> 
<p><code>PureComponent</code>å’Œ <code>Component</code>ç”¨æ³•ï¼Œå·®ä¸å¤šä¸€æ ·ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œçº¯ç»„ä»¶<code>PureComponent</code>ä¼šæµ…æ¯”è¾ƒï¼Œ<code>props</code>å’Œ<code>state</code>æ˜¯å¦ç›¸åŒï¼Œæ¥å†³å®šæ˜¯å¦é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚æ‰€ä»¥ä¸€èˆ¬ç”¨äº<strong>æ€§èƒ½è°ƒä¼˜</strong>ï¼Œå‡å°‘<strong>render</strong>æ¬¡æ•°ã€‚</p> 
<p>ä»€ä¹ˆå«åš<strong>æµ…æ¯”è¾ƒ</strong>ï¼Œæˆ‘è¿™é‡Œä¸¾ä¸ªåˆ—å­ï¼š</p> 
<pre><code class="prism language-js"><span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>PureComponent</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
           data<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
              name<span class="token punctuation">:</span><span class="token string">'alien'</span><span class="token punctuation">,</span>
              age<span class="token punctuation">:</span><span class="token number">28</span>
           <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">handerClick</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
        data<span class="token punctuation">.</span>age<span class="token operator">++</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> data <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"box"</span> <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"show"</span> <span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span> ä½ çš„å§“åæ˜¯<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> data<span class="token punctuation">.</span>name <span class="token punctuation">}</span> <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span> å¹´é¾„ï¼š <span class="token punctuation">{<!-- --></span> data<span class="token punctuation">.</span>age  <span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token keyword">this</span><span class="token punctuation">.</span>handerClick <span class="token punctuation">}</span> <span class="token operator">&gt;</span>age<span class="token operator">++</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/59/d2/MTJ894cy_o.gif" alt="pureComponent.gif"><br> <strong>ç‚¹å‡»æŒ‰é’®ï¼Œæ²¡æœ‰ä»»ä½•ååº”</strong>ï¼Œå› ä¸º<code>PureComponent</code>ä¼šæ¯”è¾ƒä¸¤æ¬¡<code>data</code>å¯¹è±¡ï¼Œéƒ½æŒ‡å‘åŒä¸€ä¸ª<code>data</code>,æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œæ‰€ä»¥ä¸æ›´æ–°è§†å›¾ã€‚</p> 
<p>è§£å†³è¿™ä¸ªé—®é¢˜å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨<code>handerClick</code>äº‹ä»¶ä¸­è¿™ä¹ˆå†™ï¼š</p> 
<pre><code class="prism language-js"> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> data<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span><span class="token operator">...</span>data<span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>æµ…æ‹·è´</strong>å°±èƒ½æ ¹æœ¬è§£å†³é—®é¢˜ã€‚</p> 
<h3><a id="memo_121"></a>memo</h3> 
<p><code>React.memo</code>å’Œ<code>PureComponent</code>ä½œç”¨ç±»ä¼¼ï¼Œå¯ä»¥ç”¨ä½œæ€§èƒ½ä¼˜åŒ–ï¼Œ<code>React.memo</code> æ˜¯é«˜é˜¶ç»„ä»¶ï¼Œå‡½æ•°ç»„ä»¶å’Œç±»ç»„ä»¶éƒ½å¯ä»¥ä½¿ç”¨ï¼Œ å’ŒåŒºåˆ«<code>PureComponent</code>æ˜¯ <code>React.memo</code>åªèƒ½å¯¹<code>props</code>çš„æƒ…å†µç¡®å®šæ˜¯å¦æ¸²æŸ“ï¼Œè€Œ<code>PureComponent</code>æ˜¯é’ˆå¯¹<code>props</code>å’Œ<code>state</code>ã€‚</p> 
<p><code>React.memo</code> æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°åŸå§‹ç»„ä»¶æœ¬èº«ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼Œå¯ä»¥æ ¹æ®ä¸€æ¬¡æ›´æ–°ä¸­<code>props</code>æ˜¯å¦ç›¸åŒå†³å®šåŸå§‹ç»„ä»¶æ˜¯å¦é‡æ–°æ¸²æŸ“ã€‚æ˜¯ä¸€ä¸ªè¿”å›å¸ƒå°”å€¼ï¼Œ<code>true</code> è¯æ˜ç»„ä»¶æ— é¡»é‡æ–°æ¸²æŸ“ï¼Œ<code>false</code>è¯æ˜ç»„ä»¶éœ€è¦é‡æ–°æ¸²æŸ“ï¼Œè¿™ä¸ªå’Œç±»ç»„ä»¶ä¸­çš„<code>shouldComponentUpdate()</code>æ­£å¥½ç›¸å ã€‚</p> 
<p><strong>React.memo: ç¬¬äºŒä¸ªå‚æ•° è¿”å› <code>true</code> ç»„ä»¶ä¸æ¸²æŸ“ ï¼Œ è¿”å› <code>false</code> ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</strong><br> <strong>shouldComponentUpdate: è¿”å› <code>true</code> ç»„ä»¶æ¸²æŸ“ ï¼Œ è¿”å› <code>false</code> ç»„ä»¶ä¸æ¸²æŸ“ã€‚</strong></p> 
<p>æ¥ä¸‹æ¥æˆ‘ä»¬åšä¸€ä¸ªåœºæ™¯ï¼Œæ§åˆ¶ç»„ä»¶åœ¨ä»…æ­¤ä¸€ä¸ª<code>props</code>æ•°å­—å˜é‡ï¼Œä¸€å®šèŒƒå›´æ¸²æŸ“ã€‚</p> 
<p>ä¾‹å­ğŸŒ°ï¼š</p> 
<p>æ§åˆ¶ <code>props</code> ä¸­çš„ <code>number</code> ï¼š</p> 
<ul><li> <p>1 åªæœ‰ <code>number</code> æ›´æ”¹ï¼Œç»„ä»¶æ¸²æŸ“ã€‚</p> </li><li> <p>2 åªæœ‰ <code>number</code> å°äº 5 ï¼Œç»„ä»¶æ¸²æŸ“ã€‚</p> </li></ul> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">TextMemo</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å­ç»„ä»¶æ¸²æŸ“'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>hello<span class="token punctuation">,</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span> 
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">controlIsRender</span> <span class="token operator">=</span> <span class="token punctuation">(</span>pre<span class="token punctuation">,</span>next<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>pre<span class="token punctuation">.</span>number <span class="token operator">===</span> next<span class="token punctuation">.</span>number  <span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token comment">// number ä¸æ”¹å˜ ï¼Œä¸æ¸²æŸ“ç»„ä»¶</span>
       <span class="token keyword">return</span> <span class="token boolean">true</span> 
   <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>pre<span class="token punctuation">.</span>number <span class="token operator">!==</span> next<span class="token punctuation">.</span>number <span class="token operator">&amp;&amp;</span> next<span class="token punctuation">.</span>number <span class="token operator">&gt;</span> <span class="token number">5</span> <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// number æ”¹å˜ ï¼Œä½†å€¼å¤§äº5 ï¼Œ ä¸æ¸²æŸ“ç»„ä»¶</span>
       <span class="token keyword">return</span> <span class="token boolean">true</span>
   <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// å¦åˆ™æ¸²æŸ“ç»„ä»¶</span>
       <span class="token keyword">return</span> <span class="token boolean">false</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> NewTexMemo <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span>TextMemo<span class="token punctuation">,</span>controlIsRender<span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
            number<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
            num<span class="token punctuation">:</span><span class="token number">1</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> num <span class="token punctuation">,</span> number <span class="token punctuation">}</span>  <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                æ”¹å˜numï¼šå½“å‰å€¼ <span class="token punctuation">{<!-- --></span> num <span class="token punctuation">}</span>  
                <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> num<span class="token punctuation">:</span>num <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token operator">&gt;</span>num<span class="token operator">++</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> num<span class="token punctuation">:</span>num <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token operator">&gt;</span>num<span class="token operator">--</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>  
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                æ”¹å˜numberï¼š å½“å‰å€¼ <span class="token punctuation">{<!-- --></span> number <span class="token punctuation">}</span> 
                <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> number<span class="token punctuation">:</span>number <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token operator">&gt;</span> number <span class="token operator">++</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> number<span class="token punctuation">:</span>number <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token operator">&gt;</span> number <span class="token operator">--</span> <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>  
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>NewTexMemo num<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> num <span class="token punctuation">}</span> number<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>number<span class="token punctuation">}</span>  <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ•ˆæœï¼š</strong></p> 
<p><img src="https://images2.imgbox.com/65/fb/qwfxIF20_o.gif" alt="memo.gif"></p> 
<p>å®Œç¾è¾¾åˆ°äº†æ•ˆæœï¼Œ<code>React.memo</code>ä¸€å®šç¨‹åº¦ä¸Šï¼Œå¯ä»¥ç­‰ä»·äºç»„ä»¶å¤–éƒ¨ä½¿ç”¨<code>shouldComponentUpdate</code> ï¼Œç”¨äºæ‹¦æˆªæ–°è€<code>props</code>ï¼Œç¡®å®šç»„ä»¶æ˜¯å¦æ›´æ–°ã€‚</p> 
<h3><a id="forwardRef_195"></a>forwardRef</h3> 
<p>å®˜ç½‘å¯¹<code>forwardRef</code>çš„æ¦‚å¿µå’Œç”¨æ³•å¾ˆç¬¼ç»Ÿï¼Œä¹Ÿæ²¡æœ‰ç»™å®šä¸€ä¸ªå…·ä½“çš„æ¡ˆä¾‹ã€‚å¾ˆå¤šåŒå­¦ä¸çŸ¥é“ <code>forwardRef</code>å…·ä½“æ€ä¹ˆç”¨ï¼Œä¸‹é¢æˆ‘ç»“åˆå…·ä½“ä¾‹å­ç»™å¤§å®¶è®²è§£<code>forwardRef</code>åº”ç”¨åœºæ™¯ã€‚</p> 
<p><strong>1 è½¬å‘å¼•å…¥Ref</strong></p> 
<p>è¿™ä¸ªåœºæ™¯å®é™…å¾ˆç®€å•ï¼Œæ¯”å¦‚çˆ¶ç»„ä»¶æƒ³è·å–å­™ç»„ä»¶ï¼ŒæŸä¸€ä¸ª<code>dom</code>å…ƒç´ ã€‚è¿™ç§éš”ä»£<code>ref</code>è·å–å¼•ç”¨ï¼Œå°±éœ€è¦<code>forwardRef</code>æ¥åŠ©åŠ›ã€‚</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">Son</span> <span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> grandRef <span class="token punctuation">}</span> <span class="token operator">=</span> props
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span> i am alien <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>grandRef<span class="token punctuation">}</span> <span class="token operator">&gt;</span>è¿™ä¸ªæ˜¯æƒ³è¦è·å–å…ƒç´ <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Father</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Son grandRef<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>grandRef<span class="token punctuation">}</span>  <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> NewFather <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span>ref<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token operator">&lt;</span>Father grandRef<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>ref<span class="token punctuation">}</span>  <span class="token punctuation">{<!-- --></span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>  <span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">GrandFather</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    node <span class="token operator">=</span> <span class="token keyword">null</span> 
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>node<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>NewFather ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>node <span class="token operator">=</span> node <span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ•ˆæœ</strong></p> 
<p><img src="https://images2.imgbox.com/98/1d/dKLTXD07_o.png" alt="forwaedRef.jpg"></p> 
<p><code>react</code>ä¸å…è®¸<code>ref</code>é€šè¿‡<code>props</code>ä¼ é€’ï¼Œå› ä¸ºç»„ä»¶ä¸Šå·²ç»æœ‰ <code>ref</code> è¿™ä¸ªå±æ€§,åœ¨ç»„ä»¶è°ƒå’Œè¿‡ç¨‹ä¸­ï¼Œå·²ç»è¢«ç‰¹æ®Šå¤„ç†ï¼Œ<code>forwardRef</code>å‡ºç°å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒæŠŠ<code>ref</code>è½¬å‘åˆ°è‡ªå®šä¹‰çš„<code>forwardRef</code>å®šä¹‰çš„å±æ€§ä¸Šï¼Œè®©<code>ref</code>ï¼Œå¯ä»¥é€šè¿‡<code>props</code>ä¼ é€’ã€‚</p> 
<p><strong>2 é«˜é˜¶ç»„ä»¶è½¬å‘Ref</strong></p> 
<p>ä¸€æ–‡åƒé€<code>hoc</code>æ–‡ç« ä¸­è®²åˆ°ï¼Œç”±äºå±æ€§ä»£ç†çš„<code>hoc</code>ï¼Œè¢«åŒ…è£¹ä¸€å±‚ï¼Œæ‰€ä»¥å¦‚æœæ˜¯ç±»ç»„ä»¶ï¼Œæ˜¯é€šè¿‡<code>ref</code>æ‹¿ä¸åˆ°åŸå§‹ç»„ä»¶çš„å®ä¾‹çš„ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>forWardRef</code>è½¬å‘<code>ref</code>ã€‚</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token constant">HOC</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">class</span> <span class="token class-name">Wrap</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
     <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> forwardedRef <span class="token punctuation">,</span><span class="token operator">...</span>otherprops  <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>Component ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>forwardedRef<span class="token punctuation">}</span>  <span class="token punctuation">{<!-- --></span><span class="token operator">...</span>otherprops<span class="token punctuation">}</span>  <span class="token operator">/</span><span class="token operator">&gt;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span>  React<span class="token punctuation">.</span><span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span>ref<span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>Wrap forwardedRef<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>ref<span class="token punctuation">}</span> <span class="token punctuation">{<!-- --></span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">666</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>hello<span class="token punctuation">,</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> HocIndex <span class="token operator">=</span>  <span class="token constant">HOC</span><span class="token punctuation">(</span>Index<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> node <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
     <span class="token comment">/* å°±å¯ä»¥è·¨å±‚çº§ï¼Œæ•è·åˆ° Index ç»„ä»¶çš„å®ä¾‹äº† */</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>current<span class="token punctuation">.</span>componentDidMount<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span>HocIndex ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>node<span class="token punctuation">}</span>  <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>å¦‚ä¸Šï¼Œè§£å†³äº†é«˜é˜¶ç»„ä»¶å¼•å…¥<code>Ref</code>çš„é—®é¢˜ã€‚</p> 
<h3><a id="lazy_284"></a>lazy</h3> 
<blockquote> 
 <p>React.lazy å’Œ Suspense æŠ€æœ¯è¿˜ä¸æ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“ã€‚å¦‚æœä½ æƒ³è¦åœ¨ä½¿ç”¨æœåŠ¡ç«¯æ¸²æŸ“çš„åº”ç”¨ä¸­ä½¿ç”¨ï¼Œæˆ‘ä»¬æ¨è Loadable Components è¿™ä¸ªåº“</p> 
</blockquote> 
<p><code>React.lazy</code>å’Œ<code>Suspense</code>é…åˆä¸€èµ·ç”¨ï¼Œèƒ½å¤Ÿæœ‰åŠ¨æ€åŠ è½½ç»„ä»¶çš„æ•ˆæœã€‚<code>React.lazy</code> æ¥å—ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°éœ€è¦åŠ¨æ€è°ƒç”¨ <code>import()</code>ã€‚å®ƒå¿…é¡»è¿”å›ä¸€ä¸ª <code>Promise</code> ï¼Œè¯¥ <code>Promise</code> éœ€è¦ <code>resolve</code> ä¸€ä¸ª <code>default export</code> çš„ <code>React</code> ç»„ä»¶ã€‚</p> 
<p>æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªåŠ¨æ€åŠ è½½çš„åœºæ™¯ã€‚</p> 
<p><strong>çˆ¶ç»„ä»¶</strong></p> 
<pre><code class="prism language-js"><span class="token keyword">import</span> Test <span class="token keyword">from</span> <span class="token string">'./comTest'</span>
<span class="token keyword">const</span> LazyComponent <span class="token operator">=</span>  React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
          <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
              <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>Test <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>   
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"context_box"</span>  style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token punctuation">{<!-- --></span> marginTop <span class="token punctuation">:</span><span class="token string">'50px'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>   <span class="token operator">&gt;</span>
           <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Suspense fallback<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"icon"</span> <span class="token operator">&gt;</span><span class="token operator">&lt;</span>SyncOutlined  spin  <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span> <span class="token punctuation">}</span> <span class="token operator">&gt;</span>
               <span class="token operator">&lt;</span>LazyComponent <span class="token operator">/</span><span class="token operator">&gt;</span>
           <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Suspense<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>æˆ‘ä»¬ç”¨<code>setTimeout</code>æ¥æ¨¡æ‹Ÿ<code>import</code>å¼‚æ­¥å¼•å…¥æ•ˆæœã€‚</p> 
<p><strong>Test</strong></p> 
<pre><code class="prism language-js"><span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'--componentDidMount--'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>alien<span class="token punctuation">}</span>  className<span class="token operator">=</span><span class="token string">"alien"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ•ˆæœ</strong></p> 
<p><img src="https://images2.imgbox.com/9c/a1/04SyzlZR_o.gif" alt="lazy.gif"></p> 
<h3><a id="Suspense_339"></a>Suspense</h3> 
<p>ä½•ä¸º<code>Suspense</code>, <code>Suspense</code> è®©ç»„ä»¶â€œç­‰å¾…â€æŸä¸ªå¼‚æ­¥æ“ä½œï¼Œç›´åˆ°è¯¥å¼‚æ­¥æ“ä½œç»“æŸå³å¯æ¸²æŸ“ã€‚</p> 
<p>ç”¨äºæ•°æ®è·å–çš„ <code>Suspense</code> æ˜¯ä¸€ä¸ªæ–°ç‰¹æ€§ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>&lt;Suspense&gt;</code> ä»¥å£°æ˜çš„æ–¹å¼æ¥â€œç­‰å¾…â€ä»»ä½•å†…å®¹ï¼ŒåŒ…æ‹¬æ•°æ®ã€‚æœ¬æ–‡é‡ç‚¹ä»‹ç»å®ƒåœ¨æ•°æ®è·å–çš„ç”¨ä¾‹ï¼Œå®ƒä¹Ÿå¯ä»¥ç”¨äºç­‰å¾…å›¾åƒã€è„šæœ¬æˆ–å…¶ä»–å¼‚æ­¥çš„æ“ä½œã€‚</p> 
<p>ä¸Šé¢è®²åˆ°é«˜é˜¶ç»„ä»¶<code>lazy</code>æ—¶å€™ï¼Œå·²ç»ç”¨ <code>lazy</code> + <code>Suspense</code>æ¨¡å¼ï¼Œæ„å»ºäº†å¼‚æ­¥æ¸²æŸ“ç»„ä»¶ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹å®˜ç½‘æ–‡æ¡£ä¸­çš„æ¡ˆä¾‹ï¼š</p> 
<pre><code class="prism language-js"><span class="token keyword">const</span> ProfilePage <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./ProfilePage'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‡’åŠ è½½</span>
<span class="token operator">&lt;</span>Suspense fallback<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token operator">&lt;</span>Spinner <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>ProfilePage <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Suspense<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="Fragment_355"></a>Fragment</h3> 
<p><code>react</code>ä¸å…è®¸ä¸€ä¸ªç»„ä»¶è¿”å›å¤šä¸ªèŠ‚ç‚¹å…ƒç´ ï¼Œæ¯”å¦‚è¯´å¦‚ä¸‹æƒ…å†µ</p> 
<pre><code class="prism language-js"><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> ğŸğŸğŸ <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
           <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> ğŸŒğŸŒğŸŒ <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
           <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> ğŸ‡ğŸ‡ğŸ‡ <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>å¦‚æœæˆ‘ä»¬æƒ³è§£å†³è¿™ä¸ªæƒ…å†µï¼Œå¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨å¤–å±‚å¥—ä¸€ä¸ªå®¹å™¨å…ƒç´ ã€‚</p> 
<pre><code class="prism language-js"><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
           <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> ğŸğŸğŸ <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
           <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> ğŸŒğŸŒğŸŒ <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
           <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> ğŸ‡ğŸ‡ğŸ‡ <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>ä½†æ˜¯æˆ‘ä»¬ä¸æœŸæœ›ï¼Œå¢åŠ é¢å¤–çš„<code>dom</code>èŠ‚ç‚¹ï¼Œæ‰€ä»¥<code>react</code>æä¾›<code>Fragment</code>ç¢ç‰‡æ¦‚å¿µï¼Œèƒ½å¤Ÿè®©ä¸€ä¸ªç»„ä»¶è¿”å›å¤šä¸ªå…ƒç´ ã€‚<br> æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™</p> 
<pre><code class="prism language-js"><span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> ğŸğŸğŸ <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> ğŸŒğŸŒğŸŒ <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> ğŸ‡ğŸ‡ğŸ‡ <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">&gt;</span>
</code></pre> 
<p>è¿˜å¯ä»¥ç®€å†™æˆï¼š</p> 
<pre><code class="prism language-js"><span class="token operator">&lt;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> ğŸğŸğŸ <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> ğŸŒğŸŒğŸŒ <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span> ğŸ‡ğŸ‡ğŸ‡ <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> 
<p>å’Œ<code>Fragment</code>åŒºåˆ«æ˜¯ï¼Œ<code>Fragment</code>å¯ä»¥æ”¯æŒ<code>key</code>å±æ€§ã€‚<code>&lt;&gt;&lt;/&gt;</code>ä¸æ”¯æŒ<code>key</code>å±æ€§ã€‚</p> 
<p><strong>æ¸©é¦¨æç¤º</strong>ã€‚æˆ‘ä»¬é€šè¿‡<code>map</code>éå†åçš„å…ƒç´ ï¼Œ<code>react</code>åº•å±‚ä¼šå¤„ç†ï¼Œé»˜è®¤åœ¨å¤–éƒ¨åµŒå¥—ä¸€ä¸ª<code>&lt;Fragment&gt;</code>ã€‚</p> 
<p>æ¯”å¦‚ï¼š</p> 
<pre><code class="prism language-js"><span class="token punctuation">{<!-- --></span>
   <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item<span class="token operator">=&gt;</span><span class="token operator">&lt;</span>span key<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span> <span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span> item<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>react</code>åº•å±‚å¤„ç†ä¹‹åï¼Œç­‰ä»·äºï¼š</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Fragment</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Fragment</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3><a id="Profiler_421"></a>Profiler</h3> 
<p><code>Profiler</code>è¿™ä¸ª<code>api</code>ä¸€èˆ¬ç”¨äºå¼€å‘é˜¶æ®µï¼Œæ€§èƒ½æ£€æµ‹ï¼Œæ£€æµ‹ä¸€æ¬¡<code>react</code>ç»„ä»¶æ¸²æŸ“ç”¨æ—¶ï¼Œæ€§èƒ½å¼€é”€ã€‚</p> 
<p><code>Profiler</code> éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼š</p> 
<p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæ˜¯ <code>id</code>ï¼Œç”¨äºè¡¨è¯†å”¯ä¸€æ€§çš„<code>Profiler</code>ã€‚</p> 
<p>ç¬¬äºŒä¸ªå‚æ•°ï¼š<code>onRender</code>å›è°ƒå‡½æ•°ï¼Œç”¨äºæ¸²æŸ“å®Œæˆï¼Œæ¥å—æ¸²æŸ“å‚æ•°ã€‚</p> 
<p><strong>å®è·µï¼š</strong></p> 
<pre><code class="prism language-js"><span class="token keyword">const</span> <span class="token function-variable function">index</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> <span class="token function-variable function">callback</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>arg<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div <span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Profiler id<span class="token operator">=</span><span class="token string">"root"</span> onRender<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> callback <span class="token punctuation">}</span>  <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Router  <span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Meuns<span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>KeepaliveRouterSwitch withoutRoute <span class="token operator">&gt;</span>
              <span class="token punctuation">{<!-- --></span> <span class="token function">renderRoutes</span><span class="token punctuation">(</span>menusList<span class="token punctuation">)</span> <span class="token punctuation">}</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>KeepaliveRouterSwitch<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Profiler<span class="token operator">&gt;</span> 
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>ç»“æœ</strong></p> 
<p><img src="https://images2.imgbox.com/28/1c/ofIKfKZ1_o.png" alt="Profiler.jpg"></p> 
<p>onRender</p> 
<ul><li>0 -id: <code>root</code> -&gt; <code>Profiler</code> æ ‘çš„ <code>id</code> ã€‚</li><li>1 -phase: <code>mount</code> -&gt; <code>mount</code> æŒ‚è½½ ï¼Œ <code>update</code> æ¸²æŸ“äº†ã€‚</li><li>2 -actualDuration: <code>6.685000262223184</code> -&gt; æ›´æ–° <code>committed</code> èŠ±è´¹çš„æ¸²æŸ“æ—¶é—´ã€‚</li><li>3 -baseDuration: <code>4.430000321008265</code> -&gt; æ¸²æŸ“æ•´é¢—å­æ ‘éœ€è¦çš„æ—¶é—´</li><li>4 -startTime : <code>689.7299999836832</code> -&gt; æœ¬æ¬¡æ›´æ–°å¼€å§‹æ¸²æŸ“çš„æ—¶é—´</li><li>5 -commitTime : <code>698.5799999674782</code> -&gt; æœ¬æ¬¡æ›´æ–°committed çš„æ—¶é—´</li><li>6 -interactions: <code>set{}</code> -&gt; æœ¬æ¬¡æ›´æ–°çš„ <code>interactions</code> çš„é›†åˆ</li></ul> 
<blockquote> 
 <p>å°½ç®¡ Profiler æ˜¯ä¸€ä¸ªè½»é‡çº§ç»„ä»¶ï¼Œæˆ‘ä»¬ä¾ç„¶åº”è¯¥åœ¨éœ€è¦æ—¶æ‰å»ä½¿ç”¨å®ƒã€‚å¯¹ä¸€ä¸ªåº”ç”¨æ¥è¯´ï¼Œæ¯æ·»åŠ ä¸€äº›éƒ½ä¼šç»™ CPU å’Œå†…å­˜å¸¦æ¥ä¸€äº›è´Ÿæ‹…ã€‚</p> 
</blockquote> 
<h3><a id="StrictMode_470"></a>StrictMode</h3> 
<p><code>StrictMode</code>è§åçŸ¥æ„ï¼Œä¸¥æ ¼æ¨¡å¼ï¼Œç”¨äºæ£€æµ‹<code>react</code>é¡¹ç›®ä¸­çš„æ½œåœ¨çš„é—®é¢˜ï¼Œã€‚ä¸ <code>Fragment</code> ä¸€æ ·ï¼Œ <code>StrictMode</code> ä¸ä¼šæ¸²æŸ“ä»»ä½•å¯è§çš„ <code>UI</code> ã€‚å®ƒä¸ºå…¶åä»£å…ƒç´ è§¦å‘é¢å¤–çš„æ£€æŸ¥å’Œè­¦å‘Šã€‚</p> 
<blockquote> 
 <p>ä¸¥æ ¼æ¨¡å¼æ£€æŸ¥ä»…åœ¨å¼€å‘æ¨¡å¼ä¸‹è¿è¡Œï¼›å®ƒä»¬ä¸ä¼šå½±å“ç”Ÿäº§æ„å»ºã€‚</p> 
</blockquote> 
<p><code>StrictMode</code>ç›®å‰æœ‰åŠ©äºï¼š</p> 
<ul><li>â‘ è¯†åˆ«ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸã€‚</li><li>â‘¡å…³äºä½¿ç”¨è¿‡æ—¶å­—ç¬¦ä¸² <code>ref API</code> çš„è­¦å‘Š</li><li>â‘¢å…³äºä½¿ç”¨åºŸå¼ƒçš„ <code>findDOMNode</code> æ–¹æ³•çš„è­¦å‘Š</li><li>â‘£æ£€æµ‹æ„å¤–çš„å‰¯ä½œç”¨</li><li>â‘¤æ£€æµ‹è¿‡æ—¶çš„ <code>context API</code></li></ul> 
<p><strong>å®è·µ:è¯†åˆ«ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸ</strong></p> 
<p>å¯¹äºä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸï¼ŒæŒ‡çš„æ˜¯<code>UNSAFE_componentWillMount</code>ï¼Œ<code>UNSAFE_componentWillReceiveProps</code> , <code>UNSAFE_componentWillUpdate</code></p> 
<p><code>å¤–å±‚å¼€å¯ä¸¥æ ¼æ¨¡å¼ï¼š</code></p> 
<pre><code class="prism language-js"><span class="token operator">&lt;</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span> 
    <span class="token operator">&lt;</span>Router  <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Meuns<span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>KeepaliveRouterSwitch withoutRoute <span class="token operator">&gt;</span>
            <span class="token punctuation">{<!-- --></span> <span class="token function">renderRoutes</span><span class="token punctuation">(</span>menusList<span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>KeepaliveRouterSwitch<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span>
</code></pre> 
<p><code>æˆ‘ä»¬åœ¨å†…å±‚ç»„ä»¶ä¸­ï¼Œä½¿ç”¨ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸ:</code></p> 
<pre><code class="prism language-js"><span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>    
    <span class="token function">UNSAFE_componentWillReceiveProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>      
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"box"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>   
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>æ•ˆæœï¼š</code></p> 
<p><img src="https://images2.imgbox.com/5d/cf/rEc6v2Du_o.png" alt="strictMode.jpg"></p> 
<h2><a id="_522"></a>å·¥å…·ç±»</h2> 
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä¸€èµ·æ¥æ¢ç©¶ä¸€ä¸‹<code>react</code>å·¥å…·ç±»å‡½æ•°çš„ç”¨æ³•ã€‚</p> 
<p><img src="https://images2.imgbox.com/b1/58/54MeNkhE_o.png" alt="utils.jpg"></p> 
<h3><a id="createElement_529"></a>createElement</h3> 
<p>ä¸€æåˆ°<code>createElement</code>ï¼Œå°±ä¸ç”±å¾—å’Œ<code>JSX</code>è”ç³»ä¸€èµ·ã€‚æˆ‘ä»¬å†™çš„<code>jsx</code>ï¼Œæœ€ç»ˆä¼šè¢« <code>babel</code>ï¼Œç”¨<code>createElement</code>ç¼–è¯‘æˆ<code>react</code>å…ƒç´ å½¢å¼ã€‚æˆ‘å†™ä¸€ä¸ªç»„ä»¶ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ä¼šè¢«ç¼–è¯‘æˆä»€ä¹ˆæ ·å­ï¼Œ</p> 
<p>å¦‚æœæˆ‘ä»¬åœ¨<code>render</code>é‡Œé¢è¿™ä¹ˆå†™ï¼š</p> 
<pre><code class="prism language-js"><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"box"</span> <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"item"</span>  <span class="token operator">&gt;</span>ç”Ÿå‘½å‘¨æœŸ<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Text  mes<span class="token operator">=</span><span class="token string">"hello,world"</span>  <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">&gt;</span> Flagment <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">&gt;</span>
        <span class="token punctuation">{<!-- --></span> <span class="token comment">/*  */</span> <span class="token punctuation">}</span>
        textæ–‡æœ¬
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>ä¼šè¢«ç¼–è¯‘æˆè¿™æ ·ï¼š</p> 
<pre><code class="prism language-js"><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> className<span class="token punctuation">:</span> <span class="token string">"box"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> className<span class="token punctuation">:</span> <span class="token string">"item"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"\u751F\u547D\u5468\u671F"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>Text<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> mes<span class="token punctuation">:</span> <span class="token string">"hello,world"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>React<span class="token punctuation">.</span>Fragment<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">" Flagment "</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">"text\u6587\u672C"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>å½“ç„¶æˆ‘ä»¬å¯ä»¥ä¸ç”¨<code>jsx</code>æ¨¡å¼ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡<code>createElement</code>è¿›è¡Œå¼€å‘ã€‚</p> 
<p><strong><code>createElement</code>æ¨¡å‹:</strong></p> 
<pre><code class="prism language-js">React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>
  type<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>props<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token operator">...</span>children<span class="token punctuation">]</span>
<span class="token punctuation">)</span>
</code></pre> 
<p><code>createElement</code>å‚æ•°ï¼š</p> 
<p>**ç¬¬ä¸€ä¸ªå‚æ•°:**å¦‚æœæ˜¯ç»„ä»¶ç±»å‹ï¼Œä¼šä¼ å…¥ç»„ä»¶ï¼Œå¦‚æœæ˜¯<code>dom</code>å…ƒç´ ç±»å‹ï¼Œä¼ å…¥<code>div</code>æˆ–è€…<code>span</code>ä¹‹ç±»çš„å­—ç¬¦ä¸²ã€‚</p> 
<p><strong>ç¬¬äºŒä¸ªå‚æ•°:</strong>:ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨<code>dom</code>ç±»å‹ä¸­ä¸º<strong>å±æ€§</strong>ï¼Œåœ¨<code>ç»„ä»¶</code>ç±»å‹ä¸­ä¸º<strong>props</strong>ã€‚</p> 
<p><strong>å…¶ä»–å‚æ•°:</strong>ï¼Œä¾æ¬¡ä¸º<code>children</code>ï¼Œæ ¹æ®é¡ºåºæ’åˆ—ã€‚</p> 
<p><strong>createElementåšäº†äº›ä»€ä¹ˆï¼Ÿ</strong></p> 
<p>ç»è¿‡<code>createElement</code>å¤„ç†ï¼Œæœ€ç»ˆä¼šå½¢æˆ <code>$$typeof = Symbol(react.element)</code>å¯¹è±¡ã€‚å¯¹è±¡ä¸Šä¿å­˜äº†è¯¥<code>react.element</code>çš„ä¿¡æ¯ã€‚</p> 
<h3><a id="cloneElement_584"></a>cloneElement</h3> 
<p>å¯èƒ½æœ‰çš„åŒå­¦è¿˜å‚»å‚»çš„åˆ†ä¸æ¸…æ¥š<code>cloneElement</code>å’Œ<code>createElement</code>åŒºåˆ«å’Œä½œç”¨ã€‚</p> 
<p><code>createElement</code>æŠŠæˆ‘ä»¬å†™çš„<code>jsx</code>ï¼Œå˜æˆ<code>element</code>å¯¹è±¡; è€Œ<code>cloneElement</code>çš„ä½œç”¨æ˜¯ä»¥ <code>element</code> å…ƒç´ ä¸ºæ ·æ¿å…‹éš†å¹¶è¿”å›æ–°çš„ <code>React</code> å…ƒç´ ã€‚è¿”å›å…ƒç´ çš„ <code>props</code> æ˜¯å°†æ–°çš„ <code>props</code> ä¸åŸå§‹å…ƒç´ çš„ <code>props</code> æµ…å±‚åˆå¹¶åçš„ç»“æœã€‚</p> 
<p>é‚£ä¹ˆ<code>cloneElement</code>æ„Ÿè§‰åœ¨æˆ‘ä»¬å®é™…ä¸šåŠ¡ç»„ä»¶ä¸­ï¼Œå¯èƒ½æ²¡ä»€ä¹ˆç”¨ï¼Œä½†æ˜¯åœ¨<strong>ä¸€äº›å¼€æºé¡¹ç›®ï¼Œæˆ–è€…æ˜¯å…¬å…±æ’æ§½ç»„ä»¶ä¸­</strong>ç”¨å¤„è¿˜æ˜¯è›®å¤§çš„ï¼Œæ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç»„ä»¶ä¸­ï¼ŒåŠ«æŒ<code>children element</code>ï¼Œç„¶åé€šè¿‡<code>cloneElement</code>å…‹éš†<code>element</code>ï¼Œæ··å…¥<code>props</code>ã€‚ç»å…¸çš„æ¡ˆä¾‹å°±æ˜¯ <code>react-router</code>ä¸­çš„<code>Swtich</code>ç»„ä»¶ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ¥åŒ¹é…å”¯ä¸€çš„ <code>Route</code>å¹¶åŠ ä»¥æ¸²æŸ“ã€‚</p> 
<p>æˆ‘ä»¬è®¾ç½®ä¸€ä¸ªåœºæ™¯ï¼Œåœ¨ç»„ä»¶ä¸­ï¼Œå»åŠ«æŒ<code>children</code>ï¼Œç„¶åç»™<code>children</code>èµ‹èƒ½ä¸€äº›é¢å¤–çš„<code>props</code>:</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">FatherComponent</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> children <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> newChildren <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span> newChildren <span class="token punctuation">}</span> <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SonComponent</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>hello<span class="token punctuation">,</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>    
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>      
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"box"</span> <span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>FatherComponent<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>SonComponent name<span class="token operator">=</span><span class="token string">"alien"</span>  <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>FatherComponent<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>   
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ‰“å°ï¼š</strong></p> 
<p><img src="https://images2.imgbox.com/70/74/lmVBaQBm_o.png" alt="cloneElment.jpg"></p> 
<p>å®Œç¾è¾¾åˆ°äº†æ•ˆæœï¼</p> 
<h3><a id="createContext_623"></a>createContext</h3> 
<p><code>createContext</code>ç”¨äºåˆ›å»ºä¸€ä¸ª<code>Context</code>å¯¹è±¡ï¼Œ<code>createContext</code>å¯¹è±¡ä¸­ï¼ŒåŒ…æ‹¬ç”¨äºä¼ é€’ <code>Context</code> å¯¹è±¡å€¼ <code>value</code>çš„<code>Provider</code>ï¼Œå’Œæ¥å—<code>value</code>å˜åŒ–è®¢é˜…çš„<code>Consumer</code>ã€‚</p> 
<pre><code class="prism language-js"><span class="token keyword">const</span> MyContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span>defaultValue<span class="token punctuation">)</span>
</code></pre> 
<p><code>createContext</code>æ¥å—ä¸€ä¸ªå‚æ•°<code>defaultValue</code>ï¼Œå¦‚æœ<code>Consumer</code>ä¸Šä¸€çº§ä¸€ç›´æ²¡æœ‰<code>Provider</code>,åˆ™ä¼šåº”ç”¨<code>defaultValue</code>ä½œä¸º<code>value</code>ã€‚<strong>åªæœ‰</strong>å½“ç»„ä»¶æ‰€å¤„çš„æ ‘ä¸­æ²¡æœ‰åŒ¹é…åˆ° <code>Provider</code> æ—¶ï¼Œå…¶ <code>defaultValue</code> å‚æ•°æ‰ä¼šç”Ÿæ•ˆã€‚</p> 
<p>æˆ‘ä»¬æ¥æ¨¡æ‹Ÿä¸€ä¸ª <code>Context.Provider</code>å’Œ<code>Context.Consumer</code>çš„ä¾‹å­ï¼š</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">ComponentB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">/* ç”¨ Consumer è®¢é˜…ï¼Œ æ¥è‡ª Provider ä¸­ value çš„æ”¹å˜  */</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>MyContext<span class="token punctuation">.</span>Consumer<span class="token operator">&gt;</span>
        <span class="token punctuation">{<!-- --></span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>ComponentA  <span class="token punctuation">{<!-- --></span><span class="token operator">...</span>value<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>MyContext<span class="token punctuation">.</span>Consumer<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">ComponentA</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> name <span class="token punctuation">,</span> mes <span class="token punctuation">}</span> <span class="token operator">=</span> props
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span> 
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span> å§“åï¼š <span class="token punctuation">{<!-- --></span> name <span class="token punctuation">}</span>  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span> æƒ³å¯¹å¤§å®¶è¯´ï¼š <span class="token punctuation">{<!-- --></span> mes <span class="token punctuation">}</span>  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
         <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span> value <span class="token punctuation">,</span> <span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        name<span class="token punctuation">:</span><span class="token string">'alien'</span><span class="token punctuation">,</span>
        mes<span class="token punctuation">:</span><span class="token string">'let us learn React '</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> marginTop<span class="token punctuation">:</span><span class="token string">'50px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>MyContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>value<span class="token punctuation">}</span>  <span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>ComponentB <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>MyContext<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ‰“å°ç»“æœï¼š</strong></p> 
<p><img src="https://images2.imgbox.com/b8/b8/VWydEF8C_o.png" alt="createContent.jpg"></p> 
<p><code>Provider</code>å’Œ<code>Consumer</code>çš„è‰¯å¥½çš„ç‰¹æ€§ï¼Œå¯ä»¥åšæ•°æ®çš„<strong>å­˜</strong>å’Œ<strong>å–</strong>ï¼Œ<code>Consumer</code>ä¸€æ–¹é¢ä¼ é€’<code>value</code>,å¦ä¸€æ–¹é¢å¯ä»¥è®¢é˜…<code>value</code>çš„æ”¹å˜ã€‚</p> 
<p><code>Provider</code>è¿˜æœ‰ä¸€ä¸ªç‰¹æ€§å¯ä»¥å±‚å±‚ä¼ é€’<code>value</code>ï¼Œè¿™ç§ç‰¹æ€§åœ¨<code>react-redux</code>ä¸­è¡¨ç°çš„æ·‹æ¼“å°½è‡´ã€‚</p> 
<h3><a id="createFactory_672"></a>createFactory</h3> 
<pre><code class="prism language-js">React<span class="token punctuation">.</span><span class="token function">createFactory</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span>
</code></pre> 
<p>è¿”å›ç”¨äºç”ŸæˆæŒ‡å®šç±»å‹ React å…ƒç´ çš„å‡½æ•°ã€‚ç±»å‹å‚æ•°æ—¢å¯ä»¥æ˜¯æ ‡ç­¾åå­—ç¬¦ä¸²ï¼ˆåƒæ˜¯ â€˜<code>div</code>â€™ æˆ– â€˜<code>span</code>â€™ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯ React ç»„ä»¶ ç±»å‹ ï¼ˆ <code>class</code> ç»„ä»¶æˆ–å‡½æ•°ç»„ä»¶ï¼‰ï¼Œæˆ–æ˜¯ <code>React fragment</code> ç±»å‹ã€‚</p> 
<p>ä½¿ç”¨ï¼š</p> 
<pre><code class="prism language-js"> <span class="token keyword">const</span> Text <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createFactory</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>hello<span class="token punctuation">,</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">)</span> 
<span class="token keyword">function</span> <span class="token function">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>  
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> marginTop<span class="token punctuation">:</span><span class="token string">'50px'</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Text<span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ•ˆæœ</strong></p> 
<p><img src="https://images2.imgbox.com/e7/af/FjRViVfh_o.png" alt="createFactory.jpg"></p> 
<p>æŠ¥å‡ºè­¦å‘Šï¼Œè¿™ä¸ª<code>api</code>å°†è¦è¢«åºŸå¼ƒï¼Œæˆ‘ä»¬è¿™é‡Œå°±ä¸å¤šè®²äº†ï¼Œå¦‚æœæƒ³è¦è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼Œè¯·ç”¨<code>React.createElement</code></p> 
<h3><a id="createRef_698"></a>createRef</h3> 
<p><code>createRef</code>å¯ä»¥åˆ›å»ºä¸€ä¸ª <code>ref</code> å…ƒç´ ï¼Œé™„åŠ åœ¨<code>react</code>å…ƒç´ ä¸Šã€‚</p> 
<p><strong>ç”¨æ³•ï¼š</strong></p> 
<pre><code class="prism language-js"><span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>node <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>node<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>node<span class="token punctuation">}</span> <span class="token operator">&gt;</span> my name is alien <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>ä¸ªäººè§‰å¾—<code>createRef</code>è¿™ä¸ªæ–¹æ³•ï¼Œå¾ˆé¸¡è‚‹ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥<code>class</code>ç±»ç»„ä»¶ä¸­è¿™ä¹ˆå†™ï¼Œæ¥æ•è·<code>ref</code>ã€‚</p> 
<pre><code class="prism language-js"><span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    node <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>node<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>node <span class="token punctuation">}</span> <span class="token operator">&gt;</span> my name is alien <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>æˆ–è€…åœ¨<code>function</code>ç»„ä»¶ä¸­è¿™ä¹ˆå†™ï¼š</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> node <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>node<span class="token punctuation">}</span> <span class="token operator">&gt;</span>  my name is alien <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="isValidElement_742"></a>isValidElement</h3> 
<p>è¿™ä¸ªæ–¹æ³•å¯ä»¥ç”¨æ¥æ£€æµ‹æ˜¯å¦ä¸º<code>react element</code>å…ƒç´ ,æ¥å—å¾…éªŒè¯å¯¹è±¡ï¼Œè¿”å›<code>true</code>æˆ–è€…<code>false</code>ã€‚è¿™ä¸ªapiå¯èƒ½å¯¹äºä¸šåŠ¡ç»„ä»¶çš„å¼€å‘ï¼Œä½œç”¨ä¸å¤§ï¼Œå› ä¸ºå¯¹äºç»„ä»¶å†…éƒ¨çŠ¶æ€ï¼Œéƒ½æ˜¯å·²çŸ¥çš„ï¼Œæˆ‘ä»¬æ ¹æœ¬å°±ä¸éœ€è¦å»éªŒè¯ï¼Œæ˜¯å¦æ˜¯<code>react element</code> å…ƒç´ ã€‚<br> ä½†æ˜¯ï¼Œå¯¹äºä¸€èµ·å…¬å…±ç»„ä»¶æˆ–æ˜¯å¼€æºåº“ï¼Œ<code>isValidElement</code>å°±å¾ˆæœ‰ä½œç”¨äº†ã€‚</p> 
<p><strong>å®è·µ</strong></p> 
<p>æˆ‘ä»¬åšä¸€ä¸ªåœºæ™¯ï¼ŒéªŒè¯å®¹å™¨ç»„ä»¶çš„æ‰€æœ‰å­ç»„ä»¶ï¼Œè¿‡æ»¤åˆ°é<code>react element</code>ç±»å‹ã€‚</p> 
<p>æ²¡æœ‰ç”¨<code>isValidElement</code>éªŒè¯ä¹‹å‰ï¼š</p> 
<pre><code class="prism language-js"><span class="token keyword">const</span> <span class="token function-variable function">Text</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>hello<span class="token punctuation">,</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span> 
<span class="token keyword">class</span> <span class="token class-name">WarpComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> marginTop<span class="token punctuation">:</span><span class="token string">'50px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>WarpComponent<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Text<span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span> my name is alien <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            Let's learn react together<span class="token operator">!</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>WarpComponent<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>è¿‡æ»¤ä¹‹å‰çš„æ•ˆæœ</strong></p> 
<p><img src="https://images2.imgbox.com/99/d2/7njvfPAM_o.png" alt="isValidElement.jpg"></p> 
<p><strong>æˆ‘ä»¬ç”¨<code>isValidElement</code>è¿›è¡Œ<code>react element</code>éªŒè¯:</strong></p> 
<pre><code class="prism language-js"><span class="token keyword">class</span> <span class="token class-name">WarpComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>newChidren <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> React<span class="token punctuation">.</span><span class="token function">isValidElement</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>newChidren
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>è¿‡æ»¤ä¹‹åæ•ˆæœ</strong></p> 
<p><img src="https://images2.imgbox.com/8a/65/obJVkYPz_o.png" alt="isValidElement111.jpg"></p> 
<p>è¿‡æ»¤æ‰äº†é<code>react element</code> çš„ <code>Let's learn react together!</code>ã€‚</p> 
<h3><a id="Childrenmap_798"></a>Children.map</h3> 
<p>æ¥ä¸‹æ¥çš„äº”ä¸ª<code>api</code>éƒ½æ˜¯å’Œ<code>react.Chidren</code>ç›¸å…³çš„ï¼Œæˆ‘ä»¬æ¥åˆ†åˆ«ä»‹ç»ä¸€ä¸‹ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å®˜ç½‘çš„æè¿°ï¼Œ<code>React.Children</code> æä¾›äº†ç”¨äºå¤„ç† <code>this.props.children</code> ä¸é€æ˜æ•°æ®ç»“æ„çš„å®ç”¨æ–¹æ³•ã€‚</p> 
<p>æœ‰çš„åŒå­¦ä¼šé—®éå† <code>children</code>ç”¨æ•°ç»„æ–¹æ³•,<code>map</code> ï¼Œ<code>forEach</code> ä¸å°±å¯ä»¥äº†å—ï¼Ÿ è¯·æˆ‘ä»¬æ³¨æ„ä¸€ä¸‹<code>ä¸é€æ˜æ•°æ®ç»“æ„</code>,ä»€ä¹ˆå«åšä¸é€æ˜ç»“æ„?</p> 
<p><strong>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹é€æ˜çš„ç»“æ„ï¼š</strong></p> 
<pre><code class="prism language-js"><span class="token keyword">class</span> <span class="token class-name">Text</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>hello<span class="token punctuation">,</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">WarpComponent</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>children<span class="token punctuation">)</span>
    <span class="token keyword">return</span> props<span class="token punctuation">.</span>children
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> marginTop<span class="token punctuation">:</span><span class="token string">'50px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>WarpComponent<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Text<span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Text<span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Text<span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>hello<span class="token punctuation">,</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>WarpComponent<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ‰“å°</strong></p> 
<p><img src="https://images2.imgbox.com/95/64/lA88fNEU_o.png" alt="chidrenmap.jpg"></p> 
<p>ä½†æ˜¯æˆ‘ä»¬æŠŠ<code>Index</code>ç»“æ„æ”¹å˜ä¸€ä¸‹ï¼š</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> marginTop<span class="token punctuation">:</span><span class="token string">'50px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>WarpComponent<span class="token operator">&gt;</span>
            <span class="token punctuation">{<!-- --></span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token operator">&lt;</span>Text<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
            <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>hello<span class="token punctuation">,</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>WarpComponent<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ‰“å°</strong></p> 
<p><img src="https://images2.imgbox.com/46/fa/1kTcuKqY_o.png" alt="chidrenmap2.jpg"></p> 
<p>è¿™ä¸ªæ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬ä¸èƒ½æ­£å¸¸çš„éå†äº†ï¼Œå³ä½¿éå†ä¹Ÿä¸èƒ½éå†ï¼Œæ¯ä¸€ä¸ªå­å…ƒç´ ã€‚æ­¤æ—¶å°±éœ€è¦ <code>react.Chidren</code> æ¥å¸®å¿™äº†ã€‚</p> 
<p>ä½†æ˜¯æˆ‘ä»¬æŠŠ<code>WarpComponent</code>ç»„ä»¶ç”¨<code>react.Chidren</code>å¤„ç†<code>children</code>:</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">WarpComponent</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> newChildren <span class="token operator">=</span> React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>children<span class="token punctuation">,</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">=&gt;</span>item<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newChildren<span class="token punctuation">)</span>
    <span class="token keyword">return</span> newChildren
<span class="token punctuation">}</span> 
</code></pre> 
<p>æ­¤æ—¶å°±èƒ½æ­£å¸¸éå†äº†ï¼Œè¾¾åˆ°äº†é¢„æœŸæ•ˆæœã€‚</p> 
<p><img src="https://images2.imgbox.com/e7/52/22jpfVVJ_o.png" alt="C71364B2-25E8-4F7D-A26D-50CA36AF4E33.jpg"></p> 
<p><strong>æ³¨æ„</strong><br> å¦‚æœ <code>children</code> æ˜¯ä¸€ä¸ª <code>Fragment</code> å¯¹è±¡ï¼Œå®ƒå°†è¢«è§†ä¸ºå•ä¸€å­èŠ‚ç‚¹çš„æƒ…å†µå¤„ç†ï¼Œè€Œä¸ä¼šè¢«éå†ã€‚</p> 
<h3><a id="ChildrenforEach_872"></a>Children.forEach</h3> 
<p><code>Children.forEach</code>å’Œ<code>Children.map</code> ç”¨æ³•ç±»ä¼¼ï¼Œ<code>Children.map</code>å¯ä»¥è¿”å›æ–°çš„æ•°ç»„ï¼Œ<code>Children.forEach</code>ä»…åœç•™åœ¨éå†é˜¶æ®µã€‚</p> 
<p>æˆ‘ä»¬å°†ä¸Šé¢çš„<code>WarpComponent</code>æ–¹æ³•ï¼Œç”¨<code>Children.forEach</code>æ”¹ä¸€ä¸‹ã€‚</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">WarpComponent</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>children<span class="token punctuation">,</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">=&gt;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> props<span class="token punctuation">.</span>children
<span class="token punctuation">}</span>   
</code></pre> 
<h3><a id="Childrencount_885"></a>Children.count</h3> 
<p><code>children</code> ä¸­çš„ç»„ä»¶æ€»æ•°é‡ï¼Œç­‰åŒäºé€šè¿‡ <code>map</code> æˆ– <code>forEach</code> è°ƒç”¨å›è°ƒå‡½æ•°çš„æ¬¡æ•°ã€‚å¯¹äºæ›´å¤æ‚çš„ç»“æœï¼Œ<code>Children.count</code>å¯ä»¥è¿”å›åŒä¸€çº§åˆ«å­ç»„ä»¶çš„æ•°é‡ã€‚</p> 
<p>æˆ‘ä»¬è¿˜æ˜¯æŠŠä¸Šè¿°ä¾‹å­è¿›è¡Œæ”¹é€ ï¼š</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">WarpComponent</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> childrenCount <span class="token operator">=</span>  React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>children<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>childrenCount<span class="token punctuation">,</span><span class="token string">'childrenCount'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> props<span class="token punctuation">.</span>children
<span class="token punctuation">}</span>   
<span class="token keyword">function</span> <span class="token function">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> marginTop<span class="token punctuation">:</span><span class="token string">'50px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>WarpComponent<span class="token operator">&gt;</span>
            <span class="token punctuation">{<!-- --></span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>index1<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token operator">&lt;</span>Text key<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>index<span class="token operator">+</span>index1<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
            <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>hello<span class="token punctuation">,</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>WarpComponent<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ•ˆæœ:</strong></p> 
<p><img src="https://images2.imgbox.com/07/7d/ubRpeCbz_o.png" alt="chidrencunt.jpg"></p> 
<h3><a id="ChildrentoArray_913"></a>Children.toArray</h3> 
<p><code>Children.toArray</code>è¿”å›ï¼Œ<code>props.children</code>æ‰å¹³åŒ–åç»“æœã€‚</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">WarpComponent</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> newChidrenArray <span class="token operator">=</span>  React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>children<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newChidrenArray<span class="token punctuation">,</span><span class="token string">'newChidrenArray'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> newChidrenArray
<span class="token punctuation">}</span>   
<span class="token keyword">function</span> <span class="token function">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> marginTop<span class="token punctuation">:</span><span class="token string">'50px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>WarpComponent<span class="token operator">&gt;</span>
            <span class="token punctuation">{<!-- --></span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>index1<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token operator">&lt;</span>Text key<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>index<span class="token operator">+</span>index1<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
            <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>hello<span class="token punctuation">,</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>WarpComponent<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ•ˆæœï¼š</strong></p> 
<p><img src="https://images2.imgbox.com/81/fe/A5xEsilr_o.png" alt="chuldeanarrgy.jpg"></p> 
<p><strong>newChidrenArray</strong> ,å°±æ˜¯æ‰å¹³åŒ–çš„æ•°ç»„ç»“æ„ã€‚<code>React.Children.toArray()</code> åœ¨æ‹‰å¹³å±•å¼€å­èŠ‚ç‚¹åˆ—è¡¨æ—¶ï¼Œæ›´æ”¹ <code>key</code> å€¼ä»¥ä¿ç•™åµŒå¥—æ•°ç»„çš„è¯­ä¹‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ <code>toArray</code> ä¼šä¸ºè¿”å›æ•°ç»„ä¸­çš„æ¯ä¸ª <code>key</code> æ·»åŠ å‰ç¼€ï¼Œä»¥ä½¿å¾—æ¯ä¸ªå…ƒç´  <code>key</code> çš„èŒƒå›´éƒ½é™å®šåœ¨æ­¤å‡½æ•°å…¥å‚æ•°ç»„çš„å¯¹è±¡å†…ã€‚</p> 
<h3><a id="Childrenonly_941"></a>Children.only</h3> 
<p>éªŒè¯ <code>children</code> æ˜¯å¦åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹ï¼ˆä¸€ä¸ª <code>React</code> å…ƒç´ ï¼‰ï¼Œå¦‚æœæœ‰åˆ™è¿”å›å®ƒï¼Œå¦åˆ™æ­¤æ–¹æ³•ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p> 
<p><strong>ä¸å”¯ä¸€</strong></p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">WarpComponent</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">only</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> props<span class="token punctuation">.</span>children
<span class="token punctuation">}</span>   
<span class="token keyword">function</span> <span class="token function">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> marginTop<span class="token punctuation">:</span><span class="token string">'50px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>WarpComponent<span class="token operator">&gt;</span>
            <span class="token punctuation">{<!-- --></span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token operator">&lt;</span>Text key<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>index<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
            <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>hello<span class="token punctuation">,</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>WarpComponent<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ•ˆæœ</strong></p> 
<p><img src="https://images2.imgbox.com/cf/f5/R4hdU0aj_o.png" alt="falseonly.jpg"></p> 
<p><strong>å”¯ä¸€</strong></p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">WarpComponent</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">only</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> props<span class="token punctuation">.</span>children
<span class="token punctuation">}</span>   
<span class="token keyword">function</span> <span class="token function">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> marginTop<span class="token punctuation">:</span><span class="token string">'50px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>WarpComponent<span class="token operator">&gt;</span>
           <span class="token operator">&lt;</span>Text<span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>WarpComponent<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ•ˆæœ</strong></p> 
<p><img src="https://images2.imgbox.com/87/df/dRhgMuQR_o.png" alt="only.jpg"></p> 
<p><code>React.Children.only()</code> ä¸æ¥å— <code>React.Children.map()</code> çš„è¿”å›å€¼ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªæ•°ç»„è€Œå¹¶ä¸æ˜¯ <code>React</code> å…ƒç´ ã€‚</p> 
<h2><a id="reacthooks_988"></a>react-hooks</h2> 
<p>å¯¹äº<code>react-hooks</code>,æˆ‘å·²ç»å†™äº†ä¸‰éƒ¨æ›²ï¼Œä»‹ç»äº†<code>react-hooks</code>ä½¿ç”¨ï¼Œè‡ªå®šä¹‰<code>hooks</code>ï¼Œä»¥åŠ<code>react-hooks</code>åŸç†ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»çœ‹çœ‹ï¼Œæ–‡ç« æœ«å°¾æœ‰é“¾æ¥ï¼Œå¯¹äºå¸¸ç”¨çš„<code>api</code>ï¼Œæˆ‘è¿™é‡Œå‚è€ƒäº†<code>react-hooks</code>å¦‚ä½•ä½¿ç”¨é‚£ç¯‡æ–‡ç« ã€‚å¹¶åšäº†ç›¸åº”æ•´ç†å’Œè¡¥å……ã€‚</p> 
<p><img src="https://images2.imgbox.com/54/4f/1M7PhiuC_o.png" alt="hooks.jpg"></p> 
<h3><a id="useState_995"></a>useState</h3> 
<p><code>useState</code>å¯ä»¥å¼¥è¡¥å‡½æ•°ç»„ä»¶æ²¡æœ‰<code>state</code>çš„ç¼ºé™·ã€‚<code>useState</code>å¯ä»¥æ¥å—ä¸€ä¸ªåˆè¯†å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°<code>action</code>ï¼Œ<code>action</code>è¿”å›å€¼ä½œä¸ºæ–°çš„<code>state</code>ã€‚è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå€¼ä¸º<code>state</code>è¯»å–å€¼ï¼Œç¬¬äºŒä¸ªå€¼ä¸ºæ”¹å˜<code>state</code>çš„<code>dispatchAction</code>å‡½æ•°ã€‚</p> 
<p>æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p> 
<pre><code class="prism language-jsx">const DemoState = (props) =&gt; {
   /* numberä¸ºæ­¤æ—¶stateè¯»å–å€¼ ï¼ŒsetNumberä¸ºæ´¾å‘æ›´æ–°çš„å‡½æ•° */
   let [number, setNumber] = useState(0) /* 0ä¸ºåˆå§‹å€¼ */
   return (&lt;div&gt;
       &lt;span&gt;{ number }&lt;/span&gt;
       &lt;button onClick={ ()=&gt; {
         setNumber(number+1) /* å†™æ³•ä¸€ */
         setNumber(number=&gt;number + 1 ) /* å†™æ³•äºŒ */
         console.log(number) /* è¿™é‡Œçš„numberæ˜¯ä¸èƒ½å¤Ÿå³æ—¶æ”¹å˜çš„  */
       } } &gt;num++&lt;/button&gt;
   &lt;/div&gt;)
}
</code></pre> 
<h3><a id="useEffect_1016"></a>useEffect</h3> 
<p><code>useEffect</code>å¯ä»¥å¼¥è¡¥å‡½æ•°ç»„ä»¶æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸçš„ç¼ºç‚¹ã€‚æˆ‘ä»¬å¯ä»¥åœ¨<code>useEffect</code>ç¬¬ä¸€ä¸ªå‚æ•°å›è°ƒå‡½æ•°ä¸­ï¼Œåšä¸€äº›è¯·æ±‚æ•°æ®ï¼Œäº‹ä»¶ç›‘å¬ç­‰æ“ä½œï¼Œç¬¬äºŒä¸ªå‚æ•°ä½œä¸º<code>dep</code>ä¾èµ–é¡¹ï¼Œå½“ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–ï¼Œé‡æ–°æ‰§è¡Œç¬¬ä¸€ä¸ªå‡½æ•°ã€‚</p> 
<p><strong>useEffectå¯ä»¥ç”¨ä½œæ•°æ®äº¤äº’ã€‚</strong></p> 
<pre><code class="prism language-jsx">/* æ¨¡æ‹Ÿæ•°æ®äº¤äº’ */
function getUserInfo(a){
    return new Promise((resolve)=&gt;{
        setTimeout(()=&gt;{ 
           resolve({
               name:a,
               age:16,
           }) 
        },500)
    })
}
const DemoEffect = ({ a }) =&gt; {
    const [ userMessage , setUserMessage ] :any= useState({})
    const div= useRef()
    const [number, setNumber] = useState(0)
    /* æ¨¡æ‹Ÿäº‹ä»¶ç›‘å¬å¤„ç†å‡½æ•° */
    const handleResize =()=&gt;{}
    /* useEffectä½¿ç”¨ ï¼Œè¿™é‡Œå¦‚æœä¸åŠ é™åˆ¶ ï¼Œä¼šæ˜¯å‡½æ•°é‡å¤æ‰§è¡Œï¼Œé™·å…¥æ­»å¾ªç¯*/
    useEffect(()=&gt;{
        /* è¯·æ±‚æ•°æ® */
       getUserInfo(a).then(res=&gt;{
           setUserMessage(res)
       })
       /* æ“ä½œdom  */
       console.log(div.current) /* div */
       /* äº‹ä»¶ç›‘å¬ç­‰ */
        window.addEventListener('resize', handleResize)
    /* åªæœ‰å½“props-&gt;aå’Œstate-&gt;numberæ”¹å˜çš„æ—¶å€™ ,useEffectå‰¯ä½œç”¨å‡½æ•°é‡æ–°æ‰§è¡Œ ï¼Œå¦‚æœæ­¤æ—¶æ•°ç»„ä¸ºç©º[]ï¼Œè¯æ˜å‡½æ•°åªæœ‰åœ¨åˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œä¸€æ¬¡ç›¸å½“äºcomponentDidMount */
    },[ a ,number ])
    return (&lt;div ref={div} &gt;
        &lt;span&gt;{ userMessage.name }&lt;/span&gt;
        &lt;span&gt;{ userMessage.age }&lt;/span&gt;
        &lt;div onClick={ ()=&gt; setNumber(1) } &gt;{ number }&lt;/div&gt;
    &lt;/div&gt;)
}

</code></pre> 
<p><strong>useEffectå¯ä»¥ç”¨ä½œäº‹ä»¶ç›‘å¬ï¼Œè¿˜æœ‰ä¸€äº›åŸºäº<code>dom</code>çš„æ“ä½œã€‚</strong>,åˆ«å¿˜äº†åœ¨<code>useEffect</code>ç¬¬ä¸€ä¸ªå‚æ•°å›è°ƒå‡½æ•°ï¼Œè¿”ä¸€ä¸ªå‡½æ•°ç”¨äºæ¸…é™¤äº‹ä»¶ç›‘å¬ç­‰æ“ä½œã€‚</p> 
<pre><code class="prism language-jsx">const DemoEffect = ({ a }) =&gt; {
    /* æ¨¡æ‹Ÿäº‹ä»¶ç›‘å¬å¤„ç†å‡½æ•° */
    const handleResize =()=&gt;{}
    useEffect(()=&gt;{
       /* å®šæ—¶å™¨ å»¶æ—¶å™¨ç­‰ */
       const timer = setInterval(()=&gt;console.log(666),1000)
       /* äº‹ä»¶ç›‘å¬ */
       window.addEventListener('resize', handleResize)
       /* æ­¤å‡½æ•°ç”¨äºæ¸…é™¤å‰¯ä½œç”¨ */
       return function(){
           clearInterval(timer) 
           window.removeEventListener('resize', handleResize)
       }
    },[ a ])
    return (&lt;div  &gt;
    &lt;/div&gt;)
}

</code></pre> 
<h3><a id="useMemo_1083"></a>useMemo</h3> 
<p><code>useMemo</code>æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›å€¼ç”¨äºäº§ç”Ÿ<strong>ä¿å­˜å€¼</strong>ã€‚ ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä½œä¸º<code>dep</code>ä¾èµ–é¡¹ï¼Œæ•°ç»„é‡Œé¢çš„ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–ï¼Œé‡æ–°æ‰§è¡Œç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œäº§ç”Ÿ<strong>æ–°çš„å€¼</strong>ã€‚</p> 
<p>åº”ç”¨åœºæ™¯ï¼š<br> <strong>1 ç¼“å­˜ä¸€äº›å€¼ï¼Œé¿å…é‡æ–°æ‰§è¡Œä¸Šä¸‹æ–‡</strong></p> 
<pre><code class="prism language-js"><span class="token keyword">const</span> number <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">/** ....å¤§é‡çš„é€»è¾‘è¿ç®— **/</span>
   <span class="token keyword">return</span> number
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span> props<span class="token punctuation">.</span>number <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// åªæœ‰ props.number æ”¹å˜çš„æ—¶å€™ï¼Œé‡æ–°è®¡ç®—numberçš„å€¼ã€‚</span>
</code></pre> 
<p><strong>2 å‡å°‘ä¸å¿…è¦çš„<code>dom</code>å¾ªç¯</strong></p> 
<pre><code class="prism language-js"><span class="token comment">/* ç”¨ useMemoåŒ…è£¹çš„listå¯ä»¥é™å®šå½“ä¸”ä»…å½“listæ”¹å˜çš„æ—¶å€™æ‰æ›´æ–°æ­¤listï¼Œè¿™æ ·å°±å¯ä»¥é¿å…selectListé‡æ–°å¾ªç¯ */</span>
 <span class="token punctuation">{<!-- --></span><span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span>
          selectList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
              <span class="token operator">&lt;</span>span
                  className<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>style<span class="token punctuation">.</span>listSpan<span class="token punctuation">}</span>
                  key<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>v<span class="token punctuation">}</span> <span class="token operator">&gt;</span>
                  <span class="token punctuation">{<!-- --></span>i<span class="token punctuation">.</span>patentName<span class="token punctuation">}</span> 
              <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
          <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>selectList<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span>

</code></pre> 
<p><strong>3 å‡å°‘å­ç»„ä»¶æ¸²æŸ“</strong></p> 
<pre><code class="prism language-js"><span class="token comment">/* åªæœ‰å½“propsä¸­ï¼Œliståˆ—è¡¨æ”¹å˜çš„æ—¶å€™ï¼Œå­ç»„ä»¶æ‰æ¸²æŸ“ */</span>
<span class="token keyword">const</span>  goodListChild <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>GoodList list<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> props<span class="token punctuation">.</span>list <span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token punctuation">,</span><span class="token punctuation">[</span> props<span class="token punctuation">.</span>list <span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="useCallback_1121"></a>useCallback</h3> 
<p><code>useMemo</code> å’Œ <code>useCallback</code> æ¥æ”¶çš„å‚æ•°éƒ½æ˜¯ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨å…¶ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–åæ‰æ‰§è¡Œï¼Œéƒ½æ˜¯è¿”å›ç¼“å­˜çš„å€¼ï¼ŒåŒºåˆ«åœ¨äº <code>useMemo</code> è¿”å›çš„æ˜¯å‡½æ•°è¿è¡Œçš„ç»“æœï¼Œ <code>useCallback</code> è¿”å›çš„æ˜¯å‡½æ•°ã€‚ è¿”å›çš„<code>callback</code>å¯ä»¥ä½œä¸º<code>props</code>å›è°ƒå‡½æ•°ä¼ é€’ç»™å­ç»„ä»¶ã€‚</p> 
<pre><code class="prism language-js"><span class="token comment">/* ç”¨react.memo */</span>
<span class="token keyword">const</span> DemoChildren <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">memo</span><span class="token punctuation">(</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
   <span class="token comment">/* åªæœ‰åˆå§‹åŒ–çš„æ—¶å€™æ‰“å°äº† å­ç»„ä»¶æ›´æ–° */</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å­ç»„ä»¶æ›´æ–°'</span><span class="token punctuation">)</span>
   <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
       props<span class="token punctuation">.</span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token string">'å­ç»„ä»¶'</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
   <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>å­ç»„ä»¶<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">DemoUseCallback</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> id <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>number<span class="token punctuation">,</span> setNumber<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">/* æ­¤æ—¶usecallbackçš„ç¬¬ä¸€å‚æ•° (sonName)=&gt;{ console.log(sonName) }
     ç»è¿‡å¤„ç†èµ‹å€¼ç»™ getInfo */</span>
    <span class="token keyword">const</span> getInfo  <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sonName<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sonName<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">{<!-- --></span><span class="token comment">/* ç‚¹å‡»æŒ‰é’®è§¦å‘çˆ¶ç»„ä»¶æ›´æ–° ï¼Œä½†æ˜¯å­ç»„ä»¶æ²¡æœ‰æ›´æ–° */</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">setNumber</span><span class="token punctuation">(</span>number<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token operator">&gt;</span>å¢åŠ <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>DemoChildren getInfo<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>getInfo<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="useRef_1150"></a>useRef</h3> 
<p><code>useRef</code>çš„ä½œç”¨ï¼š</p> 
<ul><li>ä¸€ æ˜¯å¯ä»¥ç”¨æ¥è·å–<code>dom</code>å…ƒç´ ï¼Œæˆ–è€…<code>class</code>ç»„ä»¶å®ä¾‹ ã€‚</li><li>äºŒ <code>react-hooksåŸç†</code>æ–‡ç« ä¸­è®²è¿‡ï¼Œåˆ›å»º<code>useRef</code>æ—¶å€™ï¼Œä¼šåˆ›å»ºä¸€ä¸ªåŸå§‹å¯¹è±¡ï¼Œåªè¦å‡½æ•°ç»„ä»¶ä¸è¢«é”€æ¯ï¼ŒåŸå§‹å¯¹è±¡å°±ä¼šä¸€ç›´å­˜åœ¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œæ¥é€šè¿‡<code>useRef</code>ä¿å­˜ä¸€äº›æ•°æ®ã€‚</li></ul> 
<pre><code class="prism language-jsx">const DemoUseRef = ()=&gt;{
    const dom= useRef(null)
    const handerSubmit = ()=&gt;{
        /*  &lt;div &gt;è¡¨å•ç»„ä»¶&lt;/div&gt;  dom èŠ‚ç‚¹ */
        console.log(dom.current)
    }
    return &lt;div&gt;
        {/* ref æ ‡è®°å½“å‰domèŠ‚ç‚¹ */}
        &lt;div ref={dom} &gt;è¡¨å•ç»„ä»¶&lt;/div&gt;
        &lt;button onClick={()=&gt;handerSubmit()} &gt;æäº¤&lt;/button&gt; 
    &lt;/div&gt;
}
</code></pre> 
<h3><a id="useLayoutEffect_1171"></a>useLayoutEffect</h3> 
<p><strong><code>useEffect</code>æ‰§è¡Œé¡ºåº:</strong> ç»„ä»¶æ›´æ–°æŒ‚è½½å®Œæˆ -&gt; æµè§ˆå™¨ <code>dom</code> ç»˜åˆ¶å®Œæˆ -&gt; æ‰§è¡Œ <code>useEffect</code> å›è°ƒã€‚<br> <strong><code>useLayoutEffect</code> æ‰§è¡Œé¡ºåº:</strong> ç»„ä»¶æ›´æ–°æŒ‚è½½å®Œæˆ -&gt; æ‰§è¡Œ <code>useLayoutEffect</code> å›è°ƒ-&gt; æµè§ˆå™¨<code>dom</code>ç»˜åˆ¶å®Œæˆã€‚</p> 
<p>æ‰€ä»¥è¯´ <code>useLayoutEffect</code> ä»£ç å¯èƒ½ä¼šé˜»å¡æµè§ˆå™¨çš„ç»˜åˆ¶ ã€‚æˆ‘ä»¬å†™çš„ <code>effect</code>å’Œ <code>useLayoutEffect</code>ï¼Œ<code>react</code>åœ¨åº•å±‚ä¼šè¢«åˆ†åˆ«æ‰“ä¸Š<code>PassiveEffect</code>ï¼Œ<code>HookLayout</code>ï¼Œåœ¨<code>commit</code>é˜¶æ®µåŒºåˆ†å‡ºï¼Œåœ¨ä»€ä¹ˆæ—¶æœºæ‰§è¡Œã€‚</p> 
<pre><code class="prism language-jsx">const DemoUseLayoutEffect = () =&gt; {
    const target = useRef()
    useLayoutEffect(() =&gt; {
        /*æˆ‘ä»¬éœ€è¦åœ¨domç»˜åˆ¶ä¹‹å‰ï¼Œç§»åŠ¨domåˆ°åˆ¶å®šä½ç½®*/
        const { x ,y } = getPositon() /* è·å–è¦ç§»åŠ¨çš„ x,yåæ ‡ */
        animate(target.current,{ x,y })
    }, []);
    return (
        &lt;div &gt;
            &lt;span ref={ target } className="animate"&gt;&lt;/span&gt;
        &lt;/div&gt;
    )
}
</code></pre> 
<h3><a id="useReducer_1194"></a>useReducer</h3> 
<p>åœ¨<code>react-hooks</code>åŸç†é‚£ç¯‡æ–‡ç« ä¸­è®²è§£åˆ°ï¼Œ<code>useState</code>åº•å±‚å°±æ˜¯ä¸€ä¸ªç®€å•ç‰ˆçš„<code>useReducer</code></p> 
<p><code>useReducer</code> æ¥å—çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºå®ƒå°±æ˜¯ä¸€ä¸ª <code>reducer</code> , <code>reducer</code> çš„å‚æ•°å°±æ˜¯å¸¸è§„ <code>reducer</code> é‡Œé¢çš„ <code>state</code> å’Œ <code>action</code> ,è¿”å›æ”¹å˜åçš„ <code>state</code> , <code>useReducer</code> ç¬¬äºŒä¸ªå‚æ•°ä¸º <code>state</code> çš„åˆå§‹å€¼ è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„ç¬¬ä¸€é¡¹å°±æ˜¯æ›´æ–°ä¹‹å <code>state</code> çš„å€¼ ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ´¾å‘æ›´æ–°çš„ <code>dispatch</code> å‡½æ•°ã€‚</p> 
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>useReducer</code>å¦‚ä½•ä½¿ç”¨ï¼š</p> 
<pre><code class="prism language-js"><span class="token keyword">const</span> <span class="token function-variable function">DemoUseReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">/* numberä¸ºæ›´æ–°åçš„stateå€¼,  dispatchNumbner ä¸ºå½“å‰çš„æ´¾å‘å‡½æ•° */</span>
   <span class="token keyword">const</span> <span class="token punctuation">[</span> number <span class="token punctuation">,</span> dispatchNumbner <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span>action<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
       <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> payload <span class="token punctuation">,</span> name  <span class="token punctuation">}</span> <span class="token operator">=</span> action
       <span class="token comment">/* returnçš„å€¼ä¸ºæ–°çš„state */</span>
       <span class="token keyword">switch</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
           <span class="token keyword">case</span> <span class="token string">'add'</span><span class="token punctuation">:</span>
               <span class="token keyword">return</span> state <span class="token operator">+</span> <span class="token number">1</span>
           <span class="token keyword">case</span> <span class="token string">'sub'</span><span class="token punctuation">:</span>
               <span class="token keyword">return</span> state <span class="token operator">-</span> <span class="token number">1</span> 
           <span class="token keyword">case</span> <span class="token string">'reset'</span><span class="token punctuation">:</span>
             <span class="token keyword">return</span> payload       
       <span class="token punctuation">}</span>
       <span class="token keyword">return</span> state
   <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
   <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      å½“å‰å€¼ï¼š<span class="token punctuation">{<!-- --></span> number <span class="token punctuation">}</span>
      <span class="token punctuation">{<!-- --></span> <span class="token comment">/* æ´¾å‘æ›´æ–° */</span> <span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">dispatchNumbner</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> name<span class="token punctuation">:</span><span class="token string">'add'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>å¢åŠ <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">dispatchNumbner</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> name<span class="token punctuation">:</span><span class="token string">'sub'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>å‡å°‘<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">dispatchNumbner</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> name<span class="token punctuation">:</span><span class="token string">'reset'</span> <span class="token punctuation">,</span>payload<span class="token punctuation">:</span><span class="token number">666</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>èµ‹å€¼<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token punctuation">{<!-- --></span> <span class="token comment">/* æŠŠdispatch å’Œ state ä¼ é€’ç»™å­ç»„ä»¶  */</span> <span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>MyChildren  dispatch<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> dispatchNumbner <span class="token punctuation">}</span> State<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> number <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="useContext_1230"></a>useContext</h3> 
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>useContext</code> ï¼Œæ¥è·å–çˆ¶çº§ç»„ä»¶ä¼ é€’è¿‡æ¥çš„ <code>context</code> å€¼ï¼Œè¿™ä¸ªå½“å‰å€¼å°±æ˜¯æœ€è¿‘çš„çˆ¶çº§ç»„ä»¶ <code>Provider</code> è®¾ç½®çš„ <code>value</code> <code>å€¼ï¼ŒuseContext</code> å‚æ•°ä¸€èˆ¬æ˜¯ç”± <code>createContext</code> æ–¹å¼å¼•å…¥ ,ä¹Ÿå¯ä»¥çˆ¶çº§ä¸Šä¸‹æ–‡ <code>context</code> ä¼ é€’ ( å‚æ•°ä¸º <code>context</code> )ã€‚<code>useContext</code> å¯ä»¥ä»£æ›¿ <code>context.Consumer</code> æ¥è·å– <code>Provider</code> ä¸­ä¿å­˜çš„ <code>value</code> å€¼</p> 
<pre><code class="prism language-jsx">/* ç”¨useContextæ–¹å¼ */
const DemoContext = ()=&gt; {
    const value:any = useContext(Context)
    /* my name is alien */
return &lt;div&gt; my name is { value.name }&lt;/div&gt;
}
/* ç”¨Context.Consumer æ–¹å¼ */
const DemoContext1 = ()=&gt;{
    return &lt;Context.Consumer&gt;
         {/*  my name is alien  */}
        { (value)=&gt; &lt;div&gt; my name is { value.name }&lt;/div&gt; }
    &lt;/Context.Consumer&gt;
}

export default ()=&gt;{
    return &lt;div&gt;
        &lt;Context.Provider value={<!-- -->{ name:'alien' , age:18 }} &gt;
            &lt;DemoContext /&gt;
            &lt;DemoContext1 /&gt;
        &lt;/Context.Provider&gt;
    &lt;/div&gt;
}
</code></pre> 
<h3><a id="useImperativeHandle_1259"></a>useImperativeHandle</h3> 
<p><code>useImperativeHandle</code> å¯ä»¥é…åˆ <code>forwardRef</code>è‡ªå®šä¹‰æš´éœ²ç»™çˆ¶ç»„ä»¶çš„å®ä¾‹å€¼ã€‚è¿™ä¸ªå¾ˆæœ‰ç”¨ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºå­ç»„ä»¶ï¼Œå¦‚æœæ˜¯<code>class</code>ç±»ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>ref</code>è·å–ç±»ç»„ä»¶çš„å®ä¾‹ï¼Œä½†æ˜¯åœ¨å­ç»„ä»¶æ˜¯å‡½æ•°ç»„ä»¶çš„æƒ…å†µï¼Œå¦‚æœæˆ‘ä»¬ä¸èƒ½ç›´æ¥é€šè¿‡<code>ref</code>çš„ï¼Œé‚£ä¹ˆæ­¤æ—¶<code>useImperativeHandle</code>å’Œ <code>forwardRef</code>é…åˆå°±èƒ½è¾¾åˆ°æ•ˆæœã€‚</p> 
<p><code>useImperativeHandle</code>æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š</p> 
<ul><li> <p>ç¬¬ä¸€ä¸ªå‚æ•°ref: æ¥å— <code>forWardRef</code> ä¼ é€’è¿‡æ¥çš„ <code>ref</code>ã€‚</p> </li><li> <p>ç¬¬äºŒä¸ªå‚æ•° <code>createHandle</code> ï¼šå¤„ç†å‡½æ•°ï¼Œè¿”å›å€¼ä½œä¸ºæš´éœ²ç»™çˆ¶ç»„ä»¶çš„<code>ref</code>å¯¹è±¡ã€‚</p> </li><li> <p>ç¬¬ä¸‰ä¸ªå‚æ•° <code>deps</code>:ä¾èµ–é¡¹ <code>deps</code>ï¼Œä¾èµ–é¡¹æ›´æ”¹å½¢æˆæ–°çš„<code>ref</code>å¯¹è±¡ã€‚</p> </li></ul> 
<p><strong>æˆ‘ä»¬æ¥æ¨¡æ‹Ÿç»™åœºæ™¯ï¼Œç”¨<code>useImperativeHandle</code>ï¼Œä½¿å¾—çˆ¶ç»„ä»¶èƒ½è®©å­ç»„ä»¶ä¸­çš„<code>input</code>è‡ªåŠ¨èµ‹å€¼å¹¶èšç„¦ã€‚</strong></p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">Son</span> <span class="token punctuation">(</span>props<span class="token punctuation">,</span>ref<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token keyword">const</span> inputRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span> inputValue <span class="token punctuation">,</span> setInputValue <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token function">useImperativeHandle</span><span class="token punctuation">(</span>ref<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
       <span class="token keyword">const</span> handleRefs <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
           <span class="token comment">/* å£°æ˜æ–¹æ³•ç”¨äºèšç„¦inputæ¡† */</span>
           <span class="token function">onFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
              inputRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
           <span class="token punctuation">}</span><span class="token punctuation">,</span>
           <span class="token comment">/* å£°æ˜æ–¹æ³•ç”¨äºæ”¹å˜inputçš„å€¼ */</span>
           <span class="token function">onChangeValue</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
               <span class="token function">setInputValue</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
       <span class="token keyword">return</span> handleRefs
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>input
            placeholder<span class="token operator">=</span><span class="token string">"è¯·è¾“å…¥å†…å®¹"</span>
            ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>inputRef<span class="token punctuation">}</span>
            value<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>inputValue<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> ForwarSon <span class="token operator">=</span> <span class="token function">forwardRef</span><span class="token punctuation">(</span>Son<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    cur <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token function">handerClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
       <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> onFocus <span class="token punctuation">,</span> onChangeValue <span class="token punctuation">}</span> <span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>cur
       <span class="token function">onFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
       <span class="token function">onChangeValue</span><span class="token punctuation">(</span><span class="token string">'let us learn React!'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> marginTop<span class="token punctuation">:</span><span class="token string">'50px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>ForwarSon ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>cur <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cur <span class="token operator">=</span> cur<span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>handerClick<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>æ“æ§å­ç»„ä»¶<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ•ˆæœ:</strong></p> 
<p><img src="https://images2.imgbox.com/2b/e2/0Jm7Y0ku_o.gif" alt="useImperativeHandle.gif"></p> 
<h3><a id="useDebugValue_1323"></a>useDebugValue</h3> 
<p><code>useDebugValue</code> å¯ç”¨äºåœ¨ <code>React</code> å¼€å‘è€…å·¥å…·ä¸­æ˜¾ç¤ºè‡ªå®šä¹‰ <code>hook</code> çš„æ ‡ç­¾ã€‚è¿™ä¸ª<code>hooks</code>ç›®çš„å°±æ˜¯æ£€æŸ¥è‡ªå®šä¹‰<code>hooks</code></p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">useFriendStatus</span><span class="token punctuation">(</span>friendID<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isOnline<span class="token punctuation">,</span> setIsOnline<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
  <span class="token comment">// åœ¨å¼€å‘è€…å·¥å…·ä¸­çš„è¿™ä¸ª Hook æ—è¾¹æ˜¾ç¤ºæ ‡ç­¾</span>
  <span class="token comment">// e.g. "FriendStatus: Online"</span>
  <span class="token function">useDebugValue</span><span class="token punctuation">(</span>isOnline <span class="token operator">?</span> <span class="token string">'Online'</span> <span class="token punctuation">:</span> <span class="token string">'Offline'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> isOnline<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>æˆ‘ä»¬ä¸æ¨èä½ å‘æ¯ä¸ªè‡ªå®šä¹‰ Hook æ·»åŠ  debug å€¼ã€‚å½“å®ƒä½œä¸ºå…±äº«åº“çš„ä¸€éƒ¨åˆ†æ—¶æ‰æœ€æœ‰ä»·å€¼ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ ¼å¼åŒ–å€¼çš„æ˜¾ç¤ºå¯èƒ½æ˜¯ä¸€é¡¹å¼€é”€å¾ˆå¤§çš„æ“ä½œã€‚é™¤ééœ€è¦æ£€æŸ¥ Hookï¼Œå¦åˆ™æ²¡æœ‰å¿…è¦è¿™ä¹ˆåšã€‚å› æ­¤ï¼ŒuseDebugValue æ¥å—ä¸€ä¸ªæ ¼å¼åŒ–å‡½æ•°ä½œä¸ºå¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚è¯¥å‡½æ•°åªæœ‰åœ¨ Hook è¢«æ£€æŸ¥æ—¶æ‰ä¼šè¢«è°ƒç”¨ã€‚å®ƒæ¥å— debug å€¼ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”ä¼šè¿”å›ä¸€ä¸ªæ ¼å¼åŒ–çš„æ˜¾ç¤ºå€¼ã€‚</p> 
</blockquote> 
<h3><a id="useTransition_1343"></a>useTransition</h3> 
<p><code>useTransition</code>å…è®¸å»¶æ—¶ç”±<code>state</code>æ”¹å˜è€Œå¸¦æ¥çš„è§†å›¾æ¸²æŸ“ã€‚é¿å…ä¸å¿…è¦çš„æ¸²æŸ“ã€‚å®ƒè¿˜å…è®¸ç»„ä»¶å°†é€Ÿåº¦è¾ƒæ…¢çš„æ•°æ®è·å–æ›´æ–°æ¨è¿Ÿåˆ°éšåæ¸²æŸ“ï¼Œä»¥ä¾¿èƒ½å¤Ÿç«‹å³æ¸²æŸ“æ›´é‡è¦çš„æ›´æ–°ã€‚</p> 
<pre><code class="prism language-js"><span class="token keyword">const</span> <span class="token constant">TIMEOUT_MS</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> timeoutMs<span class="token punctuation">:</span> <span class="token number">2000</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>startTransition<span class="token punctuation">,</span> isPending<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useTransition</span><span class="token punctuation">(</span><span class="token constant">TIMEOUT_MS</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li> <p><code>useTransition</code> æ¥å—ä¸€ä¸ªå¯¹è±¡ï¼Œ <code>timeoutMs</code>ä»£ç éœ€è¦å»¶æ—¶çš„æ—¶é—´ã€‚</p> </li><li> <p>è¿”å›ä¸€ä¸ªæ•°ç»„ã€‚<strong>ç¬¬ä¸€ä¸ªå‚æ•°ï¼š</strong> æ˜¯ä¸€ä¸ªæ¥å—å›è°ƒçš„å‡½æ•°ã€‚æˆ‘ä»¬ç”¨å®ƒæ¥å‘Šè¯‰ <code>React</code> éœ€è¦æ¨è¿Ÿçš„ <code>state</code> ã€‚ <strong>ç¬¬äºŒä¸ªå‚æ•°ï¼š</strong> ä¸€ä¸ªå¸ƒå°”å€¼ã€‚è¡¨ç¤ºæ˜¯å¦æ­£åœ¨ç­‰å¾…ï¼Œè¿‡åº¦çŠ¶æ€çš„å®Œæˆ(å»¶æ—¶<code>state</code>çš„æ›´æ–°)ã€‚</p> </li></ul> 
<p>ä¸‹é¢æˆ‘ä»¬å¼•å…¥å®˜ç½‘çš„åˆ—å­ï¼Œæ¥äº†è§£<code>useTransition</code>çš„ä½¿ç”¨ã€‚</p> 
<pre><code class="prism language-js"><span class="token keyword">const</span> <span class="token constant">SUSPENSE_CONFIG</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> timeoutMs<span class="token punctuation">:</span> <span class="token number">2000</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>resource<span class="token punctuation">,</span> setResource<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initialResource<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>startTransition<span class="token punctuation">,</span> isPending<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useTransition</span><span class="token punctuation">(</span><span class="token constant">SUSPENSE_CONFIG</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button
        disabled<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>isPending<span class="token punctuation">}</span>
        onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token function">startTransition</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">const</span> nextUserId <span class="token operator">=</span> <span class="token function">getNextId</span><span class="token punctuation">(</span>resource<span class="token punctuation">.</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">setResource</span><span class="token punctuation">(</span><span class="token function">fetchProfileData</span><span class="token punctuation">(</span>nextUserId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token operator">&gt;</span>
        Next
      <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token punctuation">{<!-- --></span>isPending <span class="token operator">?</span> <span class="token string">" åŠ è½½ä¸­..."</span> <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>Suspense fallback<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token operator">&lt;</span>Spinner <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>ProfilePage resource<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>resource<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Suspense<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>startTransition</code> åŒ…è£…äº†æˆ‘ä»¬çš„æ•°æ®è·å–ã€‚è¿™ä½¿æˆ‘ä»¬å¯ä»¥ç«‹å³å¼€å§‹è·å–ç”¨æˆ·èµ„æ–™çš„æ•°æ®ï¼ŒåŒæ—¶æ¨è¿Ÿä¸‹ä¸€ä¸ªç”¨æˆ·èµ„æ–™é¡µé¢ä»¥åŠå…¶å…³è”çš„ <code>Spinner</code> çš„æ¸²æŸ“ 2 ç§’é’Ÿï¼ˆ <code>timeoutMs</code> ä¸­æ˜¾ç¤ºçš„æ—¶é—´ï¼‰ã€‚</p> 
<p>è¿™ä¸ª<code>api</code>ç›®å‰å¤„äºå®éªŒé˜¶æ®µï¼Œæ²¡æœ‰è¢«å®Œå…¨å¼€æ”¾å‡ºæ¥ã€‚</p> 
<h2><a id="reactdom_1397"></a>react-dom</h2> 
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥ä¸€èµ·ç ”ç©¶<code>react-dom</code>ä¸­æ¯”è¾ƒé‡è¦çš„<code>api</code>ã€‚</p> 
<p><img src="https://images2.imgbox.com/ce/e9/stwFjTa9_o.png" alt="react-dom.jpg"></p> 
<h3><a id="render_1404"></a>render</h3> 
<p><code>render</code> æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„<code>react-dom</code>çš„ <code>api</code>ï¼Œç”¨äºæ¸²æŸ“ä¸€ä¸ª<code>react</code>å…ƒç´ ï¼Œä¸€èˆ¬<code>react</code>é¡¹ç›®æˆ‘ä»¬éƒ½ç”¨å®ƒï¼Œæ¸²æŸ“æ ¹éƒ¨å®¹å™¨<code>app</code>ã€‚</p> 
<pre><code class="prism language-js">ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> container<span class="token punctuation">[</span><span class="token punctuation">,</span> callback<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>ä½¿ç”¨</strong></p> 
<pre><code class="prism language-jsx">ReactDOM.render(
    &lt; App / &gt;,
    document.getElementById('app')
)
</code></pre> 
<p><code>ReactDOM.render</code>ä¼šæ§åˆ¶<code>container</code>å®¹å™¨èŠ‚ç‚¹é‡Œçš„å†…å®¹ï¼Œä½†æ˜¯ä¸ä¼šä¿®æ”¹å®¹å™¨èŠ‚ç‚¹æœ¬èº«ã€‚</p> 
<h3><a id="hydrate_1424"></a>hydrate</h3> 
<p>æœåŠ¡ç«¯æ¸²æŸ“ç”¨<code>hydrate</code>ã€‚ç”¨æ³•ä¸ <code>render()</code> ç›¸åŒï¼Œä½†å®ƒç”¨äºåœ¨ <code>ReactDOMServer</code> æ¸²æŸ“çš„å®¹å™¨ä¸­å¯¹ <code>HTML</code> çš„å†…å®¹è¿›è¡Œ <code>hydrate</code> æ“ä½œã€‚</p> 
<pre><code class="prism language-js">ReactDOM<span class="token punctuation">.</span><span class="token function">hydrate</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> container<span class="token punctuation">[</span><span class="token punctuation">,</span> callback<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="createPortal_1432"></a>createPortal</h3> 
<p><code>Portal</code> æä¾›äº†ä¸€ç§å°†å­èŠ‚ç‚¹æ¸²æŸ“åˆ°å­˜åœ¨äºçˆ¶ç»„ä»¶ä»¥å¤–çš„ <code>DOM</code> èŠ‚ç‚¹çš„ä¼˜ç§€çš„æ–¹æ¡ˆã€‚<code>createPortal</code> å¯ä»¥æŠŠå½“å‰ç»„ä»¶æˆ– <code>element</code> å…ƒç´ çš„å­èŠ‚ç‚¹ï¼Œæ¸²æŸ“åˆ°ç»„ä»¶ä¹‹å¤–çš„å…¶ä»–åœ°æ–¹ã€‚</p> 
<p>é‚£ä¹ˆå…·ä½“åº”ç”¨åˆ°ä»€ä¹ˆåœºæ™¯å‘¢ï¼Ÿ</p> 
<p>æ¯”å¦‚ä¸€äº›å…¨å±€çš„å¼¹çª—ç»„ä»¶<code>model</code>,<code>&lt;Model/&gt;</code>ç»„ä»¶ä¸€èˆ¬éƒ½å†™åœ¨æˆ‘ä»¬çš„ç»„ä»¶å†…éƒ¨ï¼Œå€’æ˜¯çœŸæ­£æŒ‚è½½çš„<code>dom</code>ï¼Œéƒ½æ˜¯åœ¨å¤–å±‚å®¹å™¨ï¼Œæ¯”å¦‚<code>body</code>ä¸Šã€‚æ­¤æ—¶å°±å¾ˆé€‚åˆ<code>createPortal</code>APIã€‚</p> 
<p><code>createPortal</code>æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p> 
<pre><code class="prism language-js">ReactDOM<span class="token punctuation">.</span><span class="token function">createPortal</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> container<span class="token punctuation">)</span>
</code></pre> 
<p>ç¬¬ä¸€ä¸ªï¼š <code>child</code> æ˜¯ä»»ä½•å¯æ¸²æŸ“çš„ <code>React</code> å­å…ƒç´ <br> ç¬¬äºŒä¸ªï¼š <code>container</code>æ˜¯ä¸€ä¸ª <code>DOM</code> å…ƒç´ ã€‚</p> 
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å®è·µä¸€ä¸‹ï¼š</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">WrapComponent</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> children <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> domRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span> PortalComponent<span class="token punctuation">,</span> setPortalComponent <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
    React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">setPortalComponent</span><span class="token punctuation">(</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createPortal</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span>domRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span> 
        <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"container"</span> ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> domRef <span class="token punctuation">}</span> <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">{<!-- --></span> PortalComponent <span class="token punctuation">}</span>
     <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> marginTop<span class="token punctuation">:</span><span class="token string">'50px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>
             <span class="token operator">&lt;</span>WrapComponent<span class="token operator">&gt;</span>
               <span class="token operator">&lt;</span>div  <span class="token operator">&gt;</span>hello<span class="token punctuation">,</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>WrapComponent<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ•ˆæœ</strong></p> 
<p><img src="https://images2.imgbox.com/d5/51/brPHwDya_o.png" alt="createPortal.jpg"></p> 
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬<code>children</code>å®é™…åœ¨<code>container</code> ä¹‹å¤–æŒ‚è½½çš„ï¼Œä½†æ˜¯å·²ç»è¢«<code>createPortal</code>æ¸²æŸ“åˆ°<code>container</code>ä¸­ã€‚</p> 
<h3><a id="unstable_batchedUpdates_1482"></a>unstable_batchedUpdates</h3> 
<p>åœ¨<code>react-legacy</code>æ¨¡å¼ä¸‹ï¼Œå¯¹äºäº‹ä»¶ï¼Œ<code>react</code>äº‹ä»¶æœ‰æ‰¹é‡æ›´æ–°æ¥å¤„ç†åŠŸèƒ½,ä½†æ˜¯è¿™ä¸€äº›éå¸¸è§„çš„äº‹ä»¶ä¸­ï¼Œæ‰¹é‡æ›´æ–°åŠŸèƒ½ä¼šè¢«æ‰“ç ´ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨<code>react-dom</code>ä¸­æä¾›çš„<code>unstable_batchedUpdates</code> æ¥è¿›è¡Œæ‰¹é‡æ›´æ–°ã€‚</p> 
<p><strong>ä¸€æ¬¡ç‚¹å‡»å®ç°çš„æ‰¹é‡æ›´æ–°</strong></p> 
<pre><code class="prism language-js"><span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
       <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
           numer<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
       <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">handerClick</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> numer <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> numer <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> numer <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div  style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> marginTop<span class="token punctuation">:</span><span class="token string">'50px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span> 
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token keyword">this</span><span class="token punctuation">.</span>handerClick <span class="token punctuation">}</span> <span class="token operator">&gt;</span>click me<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ•ˆæœ</strong></p> 
<p><img src="https://images2.imgbox.com/56/d6/oj92KVgt_o.png" alt="batch1.jpg"></p> 
<p>æ¸²æŸ“æ¬¡æ•°ä¸€æ¬¡ã€‚</p> 
<p><strong>æ‰¹é‡æ›´æ–°æ¡ä»¶è¢«æ‰“ç ´</strong></p> 
<pre><code class="prism language-js"> <span class="token function-variable function">handerClick</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> numer <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> numer <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> numer <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ•ˆæœ</strong></p> 
<p><img src="https://images2.imgbox.com/2f/7c/Qz9I8JXV_o.png" alt="batch2.jpg"></p> 
<p>æ¸²æŸ“æ¬¡æ•°ä¸‰æ¬¡ã€‚</p> 
<p><strong>unstable_batchedUpdateåŠ©åŠ›</strong></p> 
<pre><code class="prism language-js"> <span class="token function-variable function">handerClick</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
            ReactDOM<span class="token punctuation">.</span><span class="token function">unstable_batchedUpdates</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> numer <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer<span class="token punctuation">)</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> numer <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer<span class="token punctuation">)</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> numer <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>numer<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span> 
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>æ¸²æŸ“æ¬¡æ•°ä¸€æ¬¡,å®Œç¾è§£å†³æ‰¹é‡æ›´æ–°é—®é¢˜ã€‚</p> 
<h3><a id="flushSync_1562"></a>flushSync</h3> 
<p><code>flushSync</code> å¯ä»¥å°†å›è°ƒå‡½æ•°ä¸­çš„æ›´æ–°ä»»åŠ¡ï¼Œæ”¾åœ¨ä¸€ä¸ªè¾ƒé«˜çš„ä¼˜å…ˆçº§ä¸­ã€‚æˆ‘ä»¬çŸ¥é“<code>react</code>è®¾å®šäº†å¾ˆå¤šä¸åŒä¼˜å…ˆçº§çš„æ›´æ–°ä»»åŠ¡ã€‚å¦‚æœä¸€æ¬¡æ›´æ–°ä»»åŠ¡åœ¨<code>flushSync</code>å›è°ƒå‡½æ•°å†…éƒ¨ï¼Œé‚£ä¹ˆå°†è·å¾—ä¸€ä¸ªè¾ƒé«˜ä¼˜å…ˆçº§çš„æ›´æ–°ã€‚æ¯”å¦‚</p> 
<pre><code class="prism language-js">ReactDOM<span class="token punctuation">.</span><span class="token function">flushSync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">/* æ­¤æ¬¡æ›´æ–°å°†è®¾ç½®ä¸€ä¸ªè¾ƒé«˜ä¼˜å…ˆçº§çš„æ›´æ–° */</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> name<span class="token punctuation">:</span> <span class="token string">'alien'</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>ä¸ºäº†è®©å¤§å®¶ç†è§£<code>flushSync</code>ï¼Œæˆ‘è¿™é‡Œåšä¸€ä¸ª<code>demo</code>å¥‰ä¸Šï¼Œ</p> 
<pre><code class="prism language-js"><span class="token comment">/* flushSync */</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    state<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> number<span class="token punctuation">:</span><span class="token number">0</span> <span class="token punctuation">}</span>
    <span class="token function-variable function">handerClick</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> number<span class="token punctuation">:</span> <span class="token number">1</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> number<span class="token punctuation">:</span> <span class="token number">2</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span>
        ReactDOM<span class="token punctuation">.</span><span class="token function">flushSync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> number<span class="token punctuation">:</span> <span class="token number">3</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> number<span class="token punctuation">:</span> <span class="token number">4</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> number <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token comment">// æ‰“å°ä»€ä¹ˆï¼Ÿï¼Ÿ</span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span> number <span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>handerClick<span class="token punctuation">}</span> <span class="token operator">&gt;</span>æµ‹è¯•flushSync<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>å…ˆä¸çœ‹ç­”æ¡ˆï¼Œç‚¹å‡»ä¸€ä¸‹æŒ‰é’®ï¼Œæ‰“å°ä»€ä¹ˆå‘¢ï¼Ÿ</p> 
<p><strong>æˆ‘ä»¬æ¥ç‚¹å‡»ä¸€ä¸‹çœ‹çœ‹</strong></p> 
<p><img src="https://images2.imgbox.com/4b/72/tabfJAHc_o.gif" alt="flushSync.gif"></p> 
<p>æ‰“å° 0 3 4 1 ï¼Œç›¸ä¿¡ä¸éš¾ç†è§£ä¸ºä»€ä¹ˆè¿™ä¹ˆæ‰“å°äº†ã€‚</p> 
<ul><li>é¦–å…ˆ <code>flushSync</code> <code>this.setState({ number: 3 })</code>è®¾å®šäº†ä¸€ä¸ªé«˜ä¼˜å…ˆçº§çš„æ›´æ–°ï¼Œæ‰€ä»¥3 å…ˆè¢«æ‰“å°</li><li>2 4 è¢«æ‰¹é‡æ›´æ–°ä¸º 4</li></ul> 
<p>ç›¸ä¿¡è¿™ä¸ª<code>demo</code>è®©æˆ‘ä»¬æ›´æ·±å…¥äº†è§£äº†<code>flushSync</code>ã€‚</p> 
<h3><a id="findDOMNode_1613"></a>findDOMNode</h3> 
<p><code>findDOMNode</code>ç”¨äºè®¿é—®ç»„ä»¶<code>DOM</code>å…ƒç´ èŠ‚ç‚¹ï¼Œ<code>react</code>æ¨èä½¿ç”¨<code>ref</code>æ¨¡å¼ï¼Œä¸æœŸæœ›ä½¿ç”¨<code>findDOMNode</code>ã€‚</p> 
<pre><code class="prism language-js">ReactDOM<span class="token punctuation">.</span><span class="token function">findDOMNode</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span>
</code></pre> 
<p>æ³¨æ„çš„æ˜¯ï¼š</p> 
<ul><li> <p>1 <code>findDOMNode</code>åªèƒ½ç”¨åœ¨å·²ç»æŒ‚è½½çš„ç»„ä»¶ä¸Šã€‚</p> </li><li> <p>2 å¦‚æœç»„ä»¶æ¸²æŸ“å†…å®¹ä¸º <code>null</code> æˆ–è€…æ˜¯ <code>false</code>ï¼Œé‚£ä¹ˆ <code>findDOMNode</code>è¿”å›å€¼ä¹Ÿæ˜¯ <code>null</code>ã€‚</p> </li><li> <p>3 <code>findDOMNode</code> ä¸èƒ½ç”¨äºå‡½æ•°ç»„ä»¶ã€‚</p> </li></ul> 
<p>æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼Œ<code>findDOMNode</code>å…·ä½“æ€ä¹ˆä½¿ç”¨çš„ï¼š</p> 
<pre><code class="prism language-js"><span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    <span class="token function-variable function">handerFindDom</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ReactDOM<span class="token punctuation">.</span><span class="token function">findDOMNode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> marginTop<span class="token punctuation">:</span><span class="token string">'100px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>hello<span class="token punctuation">,</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token keyword">this</span><span class="token punctuation">.</span>handerFindDom <span class="token punctuation">}</span> <span class="token operator">&gt;</span>è·å–å®¹å™¨dom<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ•ˆæœï¼š</strong></p> 
<p><img src="https://images2.imgbox.com/dc/d0/jagMaPJq_o.gif" alt="findNodedom.gif"></p> 
<p>æˆ‘ä»¬å®Œå…¨å¯ä»¥å°†å¤–å±‚å®¹å™¨ç”¨<code>ref</code>æ¥æ ‡è®°ï¼Œè·å–æ•è·åŸç”Ÿçš„<code>dom</code>èŠ‚ç‚¹ã€‚</p> 
<h3><a id="unmountComponentAtNode_1654"></a>unmountComponentAtNode</h3> 
<p>ä» <code>DOM</code> ä¸­å¸è½½ç»„ä»¶ï¼Œä¼šå°†å…¶äº‹ä»¶å¤„ç†å™¨å’Œ <code>state</code> ä¸€å¹¶æ¸…é™¤ã€‚ å¦‚æœæŒ‡å®šå®¹å™¨ä¸Šæ²¡æœ‰å¯¹åº”å·²æŒ‚è½½çš„ç»„ä»¶ï¼Œè¿™ä¸ªå‡½æ•°ä»€ä¹ˆä¹Ÿä¸ä¼šåšã€‚å¦‚æœç»„ä»¶è¢«ç§»é™¤å°†ä¼šè¿”å› <code>true</code> ï¼Œå¦‚æœæ²¡æœ‰ç»„ä»¶å¯è¢«ç§»é™¤å°†ä¼šè¿”å› <code>false</code> ã€‚</p> 
<p>æˆ‘ä»¬æ¥ç®€å•ä¸¾ä¾‹çœ‹çœ‹<code>unmountComponentAtNode</code>å¦‚ä½•ä½¿ç”¨ï¼Ÿ</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>hello<span class="token punctuation">,</span>world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{<!-- --></span>
    node <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
       <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
       <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
           numer<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
       <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">/*  ç»„ä»¶åˆå§‹åŒ–çš„æ—¶å€™ï¼Œåˆ›å»ºä¸€ä¸ª container å®¹å™¨ */</span>
        ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Text<span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>node <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">handerClick</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
       <span class="token comment">/* ç‚¹å‡»å¸è½½å®¹å™¨ */</span> 
       <span class="token keyword">const</span> state <span class="token operator">=</span>  ReactDOM<span class="token punctuation">.</span><span class="token function">unmountComponentAtNode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>node<span class="token punctuation">)</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div  style<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> marginTop<span class="token punctuation">:</span><span class="token string">'50px'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>  <span class="token operator">&gt;</span> 
             <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token punctuation">(</span> node <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>node <span class="token operator">=</span> node  <span class="token punctuation">}</span>  <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>  
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> <span class="token keyword">this</span><span class="token punctuation">.</span>handerClick <span class="token punctuation">}</span> <span class="token operator">&gt;</span>click me<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>æ•ˆæœ</strong></p> 
<p><img src="https://images2.imgbox.com/7b/12/r04RNVAy_o.gif" alt="unmounted.gif"></p> 
<h2><a id="_1697"></a>æ€»ç»“</h2> 
<p>æœ¬æ–‡é€šè¿‡<code>react</code>ç»„ä»¶å±‚é¢ï¼Œå·¥å…·å±‚é¢ï¼Œ<code>hooks</code>å±‚é¢ï¼Œ<code>react-dom</code>äº†è§£äº†<code>api</code>çš„ç”¨æ³•ï¼Œå¸Œæœ›çœ‹å®Œçš„åŒå­¦ï¼Œèƒ½å¤Ÿå¯¹ç€æ–‡ç« ä¸­çš„<code>demo</code>è‡ªå·±æ•²ä¸€éï¼Œåˆ°å¤´æ¥ä¼šå‘ç°è‡ªå·±æˆé•¿ä¸å°‘ã€‚</p> 
<p>æœ€å, é€äººç«ç‘°ï¼Œæ‰‹ç•™ä½™é¦™ï¼Œè§‰å¾—æœ‰æ”¶è·çš„æœ‹å‹å¯ä»¥ç»™ç¬”è€…<strong>ç‚¹èµï¼Œå…³æ³¨</strong>ä¸€æ³¢ ï¼Œé™†ç»­æ›´æ–°å‰ç«¯è¶…ç¡¬æ ¸æ–‡ç« ã€‚</p> 
<p>æå‰é€æ¼ï¼šæ¥ä¸‹æ¥ä¼šå‡ºä¸€éƒ¨æ­ç§˜<code>react</code>äº‹ä»¶ç³»ç»Ÿçš„æ–‡ç« ã€‚æ„Ÿå…´è¶£çš„åŒå­¦è¯·å…³æ³¨æˆ‘ï¼</p> 
<h3><a id="react_1705"></a>å¾€æœŸreactæ–‡ç« </h3> 
<p>æ–‡ç« ä¸­ï¼Œå¯¹äºå…¶ä»–æ²¡æœ‰è®²åˆ°çš„<code>react-hooks</code>ï¼Œå»ºè®®å¤§å®¶çœ‹<code>react-hooks</code>ä¸‰éƒ¨æ›²ã€‚</p> 
<p><strong>react-hooksä¸‰éƒ¨æ›²</strong></p> 
<ul><li> <p><a href="https://juejin.cn/post/6864438643727433741" rel="nofollow">ç¬¬ä¸€éƒ¨ï¼š react-hookså¦‚ä½•ä½¿ç”¨</a> <code>150+</code> èµğŸ‘</p> </li><li> <p><a href="https://juejin.cn/post/6890738145671938062" rel="nofollow">ç¬¬äºŒéƒ¨ï¼šç©è½¬react-hooks,è‡ªå®šä¹‰hooksè®¾è®¡æ¨¡å¼åŠå…¶å®æˆ˜</a> <code>240+</code> ğŸ‘èµ</p> </li><li> <p><a href="https://juejin.cn/post/6944863057000529933" rel="nofollow">ç¬¬ä¸‰éƒ¨ï¼šã€Œreactè¿›é˜¶ã€ä¸€æ–‡åƒé€react-hooksåŸç†</a> <code>820</code></p> </li></ul> 
<h3><a id="_1720"></a>å‚è€ƒæ–‡æ¡£</h3> 
<p><a href="https://reactjs.org/" rel="nofollow">reactä¸­æ–‡æ–‡æ¡£</a></p> 
<p><strong>å¾®ä¿¡æ‰«ç å…³æ³¨å…¬ä¼—å·ï¼Œå®šæœŸåˆ†äº«æŠ€æœ¯æ–‡ç« </strong></p> 
<p><img src="https://images2.imgbox.com/3d/d1/KvywxAKH_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/918f4997e0c03706317e74a6727fed13/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">Pythonå®ç°å­çº¿ç¨‹ä»£ç â€œåŒæ—¶â€æ‰§è¡Œå®Œæ¯•åï¼Œå†æ‰§è¡Œåç»­å‡½æ•°æ¨¡å—</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c17915ef5753f942a5786b520f2c472f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">WHEA_INTERNAL_ERROR ä¸€ä¸ªå…³äºæˆ´å°”ç”µè„‘G3 G5 G7 æ‰€æœ‰ç³»åˆ—çš„ä¸€ä¸ªè¿‘æœŸç¡¬ä»¶BUGå¼‚å¸¸</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§ç™½çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>