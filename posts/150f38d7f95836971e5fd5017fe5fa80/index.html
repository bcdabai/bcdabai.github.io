<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>知识图谱---Neo4J篇 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="知识图谱---Neo4J篇" />
<meta property="og:description" content="一、什么是Neo4J 知识图谱由于其数据包含实体、属性、关系等，常见的关系型数据库诸如MySQL之类不能很好的体现数据的这些特点，因此知识图谱数据的存储一般是采用图数据库（Graph Databases）。而Neo4j是其中最为常见的图数据库。
Neo4j是基于Java的图形数据库，运行Neo4j需要启动JVM进程，因此必须安装JAVA SE的JDK，并且JDK版本需要和Neo4j版本兼容。
二、Neo4J安装 官网下载（下载很慢）
https://neo4j.com/download-center/#releases
国内的下载地址
http://neo4j.com.cn/topic/5b003eae9662eee704f31cee
步骤 将解压后的文件解压到任意盘符下：本文解压到D:\neo4j-community-3.5.5-windows配置系统环境变量。
编辑path，且新建：
之后一直确定就行。验证是否安装成功：输入neo4j.bat console，出现下图则安装成功
访问Neo4j数据库 访问http://localhost:7474，（Neo4j三种连接方式中的一种），默认用户名和密码为：neo4j，需要修改为自己的密码。访问后如下图：
注册neo4j服务
输入neo4j install-service
2.neo4j服务
输入 neo4j start 开启neo4j服务
输入 neo4j stop 停止neo4j服务
输入 neo4j restart 重启neo4j服务
输入 neo4j status 查询neo4j服务
可以使用Neo4j了 Cypher查询语言 Cypher是Neo4J的声明式图形查询语言，允许用户不必编写图形结构的遍历代码，就可以对图形数据进行高效的查询。Cypher的设计目的类似SQL，适合于开发者以及在数据库上做点对点模式（ad-hoc）查询的专业操作人员。
其具备的能力包括：
创建、更新、删除节点和关系通过模式匹配来查询和修改节点和关系管理索引和约束等 三、Neo4J实战教程 本文通过一个实际的案例来一步一步使用Cypher来操作Neo4J。
这个案例的节点主要包括人物和城市两类，人物和人物之间有朋友、夫妻等关系，人物和城市之间有出生地的关系。
首先，我们删除数据库中以往的图，确保一个空白的环境进行操作： MATCH (n) DETACH DELETE n 这里，MATCH是匹配操作，而小括号()代表一个节点node（可理解为括号类似一个圆形），括号里面的n为标识符。
原有数据：
使用该语言后：
2. 接着，我们创建一个人物节点：
CREATE (n:Person {name:&#39;John&#39;}) RETURN n CREATE是创建操作，Person是标签，代表节点的类型。花括号{}代表节点的属性，属性类似Python的字典。这条语句的含义就是创建一个标签为Person的节点，该节点具有一个name属性，属性值是John。
如图所示，在Neo4J的界面上可以看到创建成功的节点。
3. 我们继续来创建更多的人物节点，并分别命名：
CREATE (n:Person {name:&#39;Sally&#39;}) RETURN n CREATE (n:Person {name:&#39;Steve&#39;}) RETURN n CREATE (n:Person {name:&#39;Mike&#39;}) RETURN n CREATE (n:Person {name:&#39;Liz&#39;}) RETURN n CREATE (n:Person {name:&#39;Shawn&#39;}) RETURN n 如图所示，6个人物节点创建成功" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/150f38d7f95836971e5fd5017fe5fa80/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-01T00:47:07+08:00" />
<meta property="article:modified_time" content="2021-09-01T00:47:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">知识图谱---Neo4J篇</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Neo4J_0"></a>一、什么是Neo4J</h2> 
<p>知识图谱由于其数据包含实体、属性、关系等，常见的关系型数据库诸如MySQL之类不能很好的体现数据的这些特点，因此知识图谱数据的存储一般是采用图数据库（Graph Databases）。而Neo4j是其中最为常见的图数据库。<br> Neo4j是基于Java的图形数据库，运行Neo4j需要启动JVM进程，因此必须安装JAVA SE的JDK，并且JDK版本需要和Neo4j版本兼容。</p> 
<h2><a id="Neo4J_3"></a>二、Neo4J安装</h2> 
<p>官网下载（下载很慢）<br> https://neo4j.com/download-center/#releases<br> 国内的下载地址<br> http://neo4j.com.cn/topic/5b003eae9662eee704f31cee</p> 
<h4><a id="_9"></a>步骤</h4> 
<ol><li>将解压后的文件解压到任意盘符下：本文解压到D:\neo4j-community-3.5.5-windows</li><li>配置系统环境变量。<br> <img src="https://images2.imgbox.com/56/cd/WITRDO5P_o.png" alt="在这里插入图片描述"><br> 编辑path，且新建：<br> <img src="https://images2.imgbox.com/a9/31/Hxx7WszJ_o.png" alt="在这里插入图片描述"><br> 之后一直确定就行。</li><li>验证是否安装成功：输入neo4j.bat console，出现下图则安装成功<br> <img src="https://images2.imgbox.com/5c/b6/yNP10wV2_o.png" alt="在这里插入图片描述"></li></ol> 
<h4><a id="Neo4j_19"></a>访问Neo4j数据库</h4> 
<p>访问http://localhost:7474，（Neo4j三种连接方式中的一种），默认用户名和密码为：neo4j，需要修改为自己的密码。访问后如下图：<br> <img src="https://images2.imgbox.com/05/77/isgDR0lP_o.png" alt="在这里插入图片描述"></p> 
<ol><li>注册neo4j服务<br> 输入neo4j install-service<br> <img src="https://images2.imgbox.com/ff/33/TCysnHaR_o.png" alt="在这里插入图片描述"><br> 2.neo4j服务<br> 输入 neo4j start 开启neo4j服务<br> 输入 neo4j stop 停止neo4j服务<br> 输入 neo4j restart 重启neo4j服务<br> 输入 neo4j status 查询neo4j服务<br> 可以使用Neo4j了</li></ol> 
<h4><a id="Cypher_33"></a>Cypher查询语言</h4> 
<p>Cypher是Neo4J的声明式图形查询语言，允许用户不必编写图形结构的遍历代码，就可以对图形数据进行高效的查询。Cypher的设计目的类似SQL，适合于开发者以及在数据库上做点对点模式（ad-hoc）查询的专业操作人员。<br> 其具备的能力包括：</p> 
<ul><li>创建、更新、删除节点和关系</li><li>通过模式匹配来查询和修改节点和关系</li><li>管理索引和约束等</li></ul> 
<h2><a id="Neo4J_40"></a>三、Neo4J实战教程</h2> 
<p>本文通过一个实际的案例来一步一步使用Cypher来操作Neo4J。<br> 这个案例的节点主要包括人物和城市两类，人物和人物之间有朋友、夫妻等关系，人物和城市之间有出生地的关系。</p> 
<ol><li>首先，我们删除数据库中以往的图，确保一个空白的环境进行操作：</li></ol> 
<pre><code> MATCH (n) DETACH DELETE n
</code></pre> 
<blockquote> 
 <p>这里，MATCH是匹配操作，而小括号()代表一个节点node（可理解为括号类似一个圆形），括号里面的n为标识符。</p> 
</blockquote> 
<p>原有数据：<img src="https://images2.imgbox.com/84/b9/9zaGhgZQ_o.png" alt="在这里插入图片描述"><br> 使用该语言后：<br> <img src="https://images2.imgbox.com/60/09/R4FBkvqF_o.png" alt="在这里插入图片描述"><br> 2. 接着，我们创建一个人物节点：</p> 
<pre><code>CREATE (n:Person {name:'John'}) RETURN n
</code></pre> 
<blockquote> 
 <p>CREATE是创建操作，Person是标签，代表节点的类型。花括号{}代表节点的属性，属性类似Python的字典。这条语句的含义就是创建一个标签为Person的节点，该节点具有一个name属性，属性值是John。<br> 如图所示，在Neo4J的界面上可以看到创建成功的节点。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/7f/34/vtJYBJvo_o.png" alt="在这里插入图片描述"><br> 3. 我们继续来创建更多的人物节点，并分别命名：</p> 
<pre><code>CREATE (n:Person {name:'Sally'}) RETURN n
CREATE (n:Person {name:'Steve'}) RETURN n
CREATE (n:Person {name:'Mike'}) RETURN n
CREATE (n:Person {name:'Liz'}) RETURN n
CREATE (n:Person {name:'Shawn'}) RETURN n
</code></pre> 
<blockquote> 
 <p>如图所示，6个人物节点创建成功</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/1b/10/bGjMbKGA_o.png" alt="在这里插入图片描述"><br> 4. 接下来创建地区节点</p> 
<pre><code>CREATE (n:Location {city:'Miami', state:'FL'})
CREATE (n:Location {city:'Boston', state:'MA'})
CREATE (n:Location {city:'Lynn', state:'MA'})
CREATE (n:Location {city:'Portland', state:'ME'})
CREATE (n:Location {city:'San Francisco', state:'CA'})
</code></pre> 
<blockquote> 
 <p>可以看到，节点类型为Location，属性包括city和state。</p> 
 <p>如图所示，共有6个人物节点、5个地区节点，Neo4J贴心地使用不用的颜色来表示不同类型的节点。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/79/02/fj1QhXmZ_o.png" alt="在这里插入图片描述"><br> 5. 接下来创建关系</p> 
<pre><code>MATCH (a:Person {name:'Liz'}), 
      (b:Person {name:'Mike'}) 
MERGE (a)-[:FRIENDS]-&gt;(b)
</code></pre> 
<blockquote> 
 <p>这里的方括号[]即为关系，FRIENDS为关系的类型。注意这里的箭头–&gt;是有方向的，表示是从a到b的关系。 如图，Liz和Mike之间建立了FRIENDS关系，通过Neo4J的可视化很明显的可以看出：</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/60/7c/ZjegtOC6_o.png" alt="在这里插入图片描述"><br> 6. 关系也可以增加属性</p> 
<pre><code>MATCH (a:Person {name:'Shawn'}), 
      (b:Person {name:'Sally'}) 
MERGE (a)-[:FRIENDS {since:2001}]-&gt;(b)
</code></pre> 
<blockquote> 
 <p>在关系中，同样的使用花括号{}来增加关系的属性，也是类似Python的字典，这里给FRIENDS关系增加了since属性，属性值为2001，表示他们建立朋友关系的时间。</p> 
</blockquote> 
<ol start="7"><li>接下来增加更多的关系</li></ol> 
<pre><code>MATCH (a:Person {name:'Shawn'}), (b:Person {name:'John'}) MERGE (a)-[:FRIENDS {since:2012}]-&gt;(b)
MATCH (a:Person {name:'Mike'}), (b:Person {name:'Shawn'}) MERGE (a)-[:FRIENDS {since:2006}]-&gt;(b)
MATCH (a:Person {name:'Liz'}), (b:Person {name:'John'}) MERGE (a)-[:MARRIED {since:1998}]-&gt;(b)
</code></pre> 
<blockquote> 
 <p>如图，人物关系图已建立好</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/be/de/kngAvqwV_o.png" alt="在这里插入图片描述"><br> 8. 然后，我们需要建立不同类型节点之间的关系-人物和地点的关系</p> 
<pre><code>MATCH (a:Person {name:'John'}), (b:Location {city:'Boston'}) MERGE (a)-[:BORN_IN {year:1978}]-&gt;(b)
</code></pre> 
<blockquote> 
 <p>这里的关系是BORN_IN，表示出生地，同样有一个属性，表示出生年份。<br> 如图，在人物节点和地区节点之间，人物出生地关系已建立好。</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/70/ec/tbEsebyG_o.png" alt="在这里插入图片描述"></p> 
<ol start="9"><li>同样建立更多人的出生地</li></ol> 
<pre><code>MATCH (a:Person {name:'Liz'}), (b:Location {city:'Boston'}) MERGE (a)-[:BORN_IN {year:1981}]-&gt;(b)
MATCH (a:Person {name:'Mike'}), (b:Location {city:'San Francisco'}) MERGE (a)-[:BORN_IN {year:1960}]-&gt;(b)
MATCH (a:Person {name:'Shawn'}), (b:Location {city:'Miami'}) MERGE (a)-[:BORN_IN {year:1960}]-&gt;(b)
MATCH (a:Person {name:'Steve'}), (b:Location {city:'Lynn'}) MERGE (a)-[:BORN_IN {year:1970}]-&gt;(b)
</code></pre> 
<pre><code>建好以后，整个图如下
</code></pre> 
<p><img src="https://images2.imgbox.com/b3/08/93TQmV3E_o.png" alt="在这里插入图片描述"><br> 10. 至此，知识图谱的数据已经插入完毕，可以开始做查询了。我们查询下所有在Boston出生的人物</p> 
<pre><code>MATCH (a:Person)-[:BORN_IN]-&gt;(b:Location {city:'Boston'}) RETURN a,b
</code></pre> 
<p><img src="https://images2.imgbox.com/df/7d/0Fzzfm3s_o.png" alt="在这里插入图片描述"><br> 11. 查询所有对外有关系的节点</p> 
<pre><code>MATCH (a)--&gt;() RETURN a
</code></pre> 
<pre><code>注意这里箭头的方向，返回结果不含任何地区节点，因为地区并没有指向其他节点（只是被指向）
</code></pre> 
<p><img src="https://images2.imgbox.com/69/4c/Uusfn45o_o.png" alt="在这里插入图片描述"><br> 12. 查询所有有关系的节点</p> 
<pre><code>MATCH (a)--() RETURN a
</code></pre> 
<p><img src="https://images2.imgbox.com/08/e9/bWPDXp7V_o.png" alt="在这里插入图片描述"></p> 
<ol start="13"><li>查询所有对外有关系的节点，以及关系类型</li></ol> 
<pre><code>MATCH (a)-[r]-&gt;() RETURN a.name, type(r)
</code></pre> 
<ol start="14"><li>查询所有有结婚关系的节点</li></ol> 
<pre><code>MATCH (n)-[:MARRIED]-() RETURN n
</code></pre> 
<p><img src="https://images2.imgbox.com/3d/76/XUfShs6Y_o.png" alt="在这里插入图片描述"><br> 15. 创建节点的时候就建好关系</p> 
<pre><code>CREATE (a:Person {name:'Todd'})-[r:FRIENDS]-&gt;(b:Person {name:'Carlos'})
</code></pre> 
<p><img src="https://images2.imgbox.com/c0/1b/m4KcA98h_o.png" alt="在这里插入图片描述"><br> 16. 查找某人的朋友的朋友</p> 
<pre><code>MATCH (a:Person {name:'Mike'})-[r1:FRIENDS]-()-[r2:FRIENDS]-(friend_of_a_friend) RETURN friend_of_a_friend.name AS fofName
</code></pre> 
<p><img src="https://images2.imgbox.com/cd/e6/MZhGFvs0_o.png" alt="在这里插入图片描述"><br> 17. 增加/修改节点的属性</p> 
<pre><code>MATCH (a:Person {name:'Liz'}) SET a.age=34
MATCH (a:Person {name:'Shawn'}) SET a.age=32
MATCH (a:Person {name:'John'}) SET a.age=44
MATCH (a:Person {name:'Mike'}) SET a.age=25
</code></pre> 
<p>这里，SET表示修改操作</p> 
<ol start="18"><li>删除节点的属性</li></ol> 
<pre><code>MATCH (a:Person {name:'Mike'}) SET a.test='test'
MATCH (a:Person {name:'Mike'}) REMOVE a.test
</code></pre> 
<p>删除属性操作主要通过REMOVE<br> 19. 删除节点</p> 
<pre><code>MATCH (a:Location {city:'Portland'}) DELETE a
</code></pre> 
<p>删除节点操作是DELETE</p> 
<ol start="20"><li>删除有关系的节点</li></ol> 
<pre><code>MATCH (a:Person {name:'Todd'})-[rel]-(b:Person) DELETE a,b,rel
</code></pre> 
<h2><a id="_226"></a>总结</h2> 
<p>本文重点针对常见的知识图谱图数据库Neo4J进行了介绍、安装，并且采用一个实际的案例来说明Neo4J的查询语言Cypher的使用方法。</p> 
<p>当然，类似MySQL一样，在实际的生产应用中，除了简单的查询操作会在Neo4J的web页面进行外，一般还是使用Python、Java等的driver来在程序中实现</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f7c35bd62df4361ccf3b77bd68ae4d16/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Containerd 学习</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5b87bf313982fd537209ccc440fb6ac0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">❤️连续面试失败后，我总结了57道面试真题❤️，如果时光可以倒流...（附答案，建议收藏）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>