<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>django&#43;vue&#43;nginx&#43;frp搭建漫画网站之接入谷歌统计和百度统计（三） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="django&#43;vue&#43;nginx&#43;frp搭建漫画网站之接入谷歌统计和百度统计（三）" />
<meta property="og:description" content="地址：http://www.iewoai.com/
1、背景 书接上文，打算监控网站的流量等访问情况，一开始打算用matomo，但是看了视频后发现直接接入谷歌统计和百度统计是一种更方便省事的手段。（那我还获取个锤子的访客真实ip）
https://www.bilibili.com/video/BV1pE411g7tN
2、谷歌统计 找到谷歌统计官网，登录账号，新增网站。参考[1]中所说，建议使用vue-analytics，但是安装包时
npm i vue-analytics --save 出现：npm WARN deprecated vue-analytics@5.22.1: Sorry but vue-analytics is no longer maintained. I would suggest you switch to vue-gtag, with love, the guy who made the package.
网上搜寻该包的github主页发现，这个包已经不再维护了，其在主页上建议使用vue-gtag。谷歌统计上的建议是使用全局代码：
但是用于目前vue项目使用的是单页面模式，不同路由之间需要手动配置一下~~，麻烦~~。
因此决定使用vue-gtag，由于项目使用vue的版本的是2.9.6，因此参考vue-gtag1.0版本的文档[3]。
安装：
npm add vue-gtag 在main.js加入如下：
// 引入 vue-gtag import VueGtag from &#39;vue-gtag&#39; Vue.use(VueGtag, { config: { id: &#34;G-1234567&#34; } }, router); 结果：
浏览器打开F12检查可看到：
谷歌统计平台上可看到（一般会有延迟）：
3、百度统计 一样的找到百度统计官网、登录、新增网站。与谷歌统计一样，百度统计也有组件vue-ba可以用[9]，
// 引入 vue-ba import ba from &#39;vue-ba&#39; Vue." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/d109aec5b1ea7f25f4fa2821b8abc6f1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-22T15:46:54+08:00" />
<meta property="article:modified_time" content="2021-07-22T15:46:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">django&#43;vue&#43;nginx&#43;frp搭建漫画网站之接入谷歌统计和百度统计（三）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>地址：<a href="http://www.iewoai.com/" rel="nofollow">http://www.iewoai.com/</a></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/1b/e3/ab7kUVNE_o.jpg" alt="在这里插入图片描述"></p> 
<h3><a id="1_5"></a>1、背景</h3> 
<p>书接上文，打算监控网站的流量等访问情况，一开始打算用<a href="https://matomo.org/" rel="nofollow">matomo</a>，但是看了视频后发现直接接入谷歌统计和百度统计是一种更方便省事的手段。<s>（那我还获取个锤子的访客真实ip）</s></p> 
<p><a href="https://www.bilibili.com/video/BV1pE411g7tN" rel="nofollow">https://www.bilibili.com/video/BV1pE411g7tN</a></p> 
<h3><a id="2_12"></a>2、谷歌统计</h3> 
<p>找到<a href="https://analytics.google.com/" rel="nofollow">谷歌统计官网</a>，登录账号，新增网站。参考<a href="https://www.cnblogs.com/pheye/p/9014797.html" rel="nofollow">[1]</a>中所说，建议使用<code>vue-analytics</code>，但是安装包时</p> 
<pre><code class="prism language-Bash">npm i vue-analytics --save
</code></pre> 
<p>出现：npm WARN deprecated vue-analytics@5.22.1: Sorry but vue-analytics is no longer maintained. I would suggest you switch to vue-gtag, with love, the guy who made the package.</p> 
<p>网上搜寻该包的github主页发现，这个包已经不再维护了，其在主页上建议使用<code>vue-gtag</code>。谷歌统计上的建议是使用全局代码：</p> 
<p><a href="https://p5-tt.byteimg.com/origin/pgc-image/cc73688029fd41518c6995f8b694c6ec.png" rel="nofollow"><img src="https://images2.imgbox.com/cd/e0/MLB6gDQA_o.png" alt="image.png"></a></p> 
<p>但是用于目前<code>vue</code>项目使用的是单页面模式，不同路由之间需要手动配置一下~~，麻烦~~。</p> 
<p>因此决定使用<code>vue-gtag</code>，由于项目使用<code>vue</code>的版本的是2.9.6，因此参考<code>vue-gtag</code>1.0版本的文档<a href="https://matteo-gabriele.gitbook.io/vue-gtag/" rel="nofollow">[3]</a>。</p> 
<p>安装：</p> 
<pre><code class="prism language-·">npm add vue-gtag
</code></pre> 
<p>在<code>main.js</code>加入如下：</p> 
<pre><code class="prism language-JavaScript">// 引入 vue-gtag
import VueGtag from 'vue-gtag'
Vue.use(VueGtag, {
  config: { id: "G-1234567" } 
}, router);

</code></pre> 
<p>结果：</p> 
<p>浏览器打开<code>F12</code>检查可看到：</p> 
<p><a href="https://p6-tt.byteimg.com/origin/pgc-image/997f4fb69e2c4f8aa625b433aa572a34.png" rel="nofollow"><img src="https://images2.imgbox.com/f3/2a/ehmuzrtZ_o.png" alt="image_1.png"></a></p> 
<p>谷歌统计平台上可看到（一般会有延迟）：</p> 
<p><a href="https://p26-tt.byteimg.com/origin/pgc-image/084c66b1f63b4920bae7b01d1ef0c8d2.png" rel="nofollow"><img src="https://images2.imgbox.com/a9/39/213pWuFw_o.png" alt="image_2.png"></a></p> 
<h3><a id="3_60"></a>3、百度统计</h3> 
<p>一样的找到<a href="https://tongji.baidu.com/" rel="nofollow">百度统计官网</a>、登录、新增网站。与谷歌统计一样，百度统计也有组件<code>vue-ba</code>可以用<a href="https://github.com/minlingchao1/vue-ba">[9]</a>，</p> 
<pre><code class="prism language-JavaScript">// 引入 vue-ba
import ba from 'vue-ba'
Vue.use(ba, 'ac892a04b10230b4a6f23f6000d874ee');
</code></pre> 
<p>结果：</p> 
<p><a href="https://p5-tt.byteimg.com/origin/pgc-image/ccadc6cc502143d8b84387b101a1411f.png" rel="nofollow"><img src="https://images2.imgbox.com/b3/1b/LV3GPHQa_o.png" alt="image_3.png"></a></p> 
<p>使用百度统计的代码安装检查：</p> 
<p><a href="https://p5-tt.byteimg.com/origin/pgc-image/0db2f538b5c8410dbc77cfc51be7c9f7.png" rel="nofollow"><img src="https://images2.imgbox.com/98/ff/daMYZTUz_o.png" alt="image_4.png"></a></p> 
<p>使用百度统计推荐的检查工具手动检查：</p> 
<p><a href="https://p26-tt.byteimg.com/origin/pgc-image/874be867c225406eabc51c3bed13f3c3.png" rel="nofollow"><img src="https://images2.imgbox.com/0b/66/MO5iSpMb_o.png" alt="image_5.png"></a></p> 
<p>百度统计平台上可以看到：</p> 
<p><a href="https://p9-tt.byteimg.com/origin/pgc-image/d363d1cf1aec4e62906d879ed8c8b0be.png" rel="nofollow"><img src="https://images2.imgbox.com/12/33/FWQJCIcy_o.png" alt="image_6.png"></a></p> 
<h3><a id="4_87"></a>4、其他</h3> 
<p>关于一些事件统计等操作，这里暂时用不到，等用到的时候再整理。</p> 
<h4><a id="1_91"></a>1、百度统计页面热力图</h4> 
<p>百度统计可使用通配符<a href="https://tongji.baidu.com/web/help/article?id=246&amp;type=0" rel="nofollow">[12]</a>（类似于正则表达式）来对设置的页面进行热力图统计，初步设置如下：</p> 
<p><a href="https://p3-tt.byteimg.com/origin/pgc-image/ea3474457acf496fab92b885ba11b07d.png" rel="nofollow"><img src="https://images2.imgbox.com/a3/14/NgGjnqUJ_o.png" alt="image_7.png"></a></p> 
<p>注：</p> 
<h5><a id="1url_99"></a>1、url里包含中文需要编码，否则会出现：</h5> 
<p><a href="https://p3-tt.byteimg.com/origin/pgc-image/cfc97b0eb2464e1093da9f5f6a23b5ba.png" rel="nofollow"><img src="https://images2.imgbox.com/40/59/S11wRArX_o.png" alt="image_8.png"></a></p> 
<p>url中文编码可参考python里的<code>quote</code>和<code>unquote</code>：</p> 
<pre><code class="prism language-Python">from urllib.parse import quote,unquote

quote("鬼灭之刃") 
# '%E9%AC%BC%E7%81%AD%E4%B9%8B%E5%88%83'

unquote("%E9%AC%BC%E7%81%AD%E4%B9%8B%E5%88%83")
# '鬼灭之刃'
</code></pre> 
<h5><a id="2_116"></a>2、热力图一般需要隔一天才能查看</h5> 
<p><a href="https://p3-tt.byteimg.com/origin/pgc-image/484312cdbb1c42aea84ac511e1f8b926.png" rel="nofollow"><img src="https://images2.imgbox.com/a7/42/DIP0uXsG_o.png" alt="image_9.png"></a></p> 
<p>若隔一天仍然看不到，请参考<a href="https://tongji.baidu.com/web/help/article?id=207&amp;type=0" rel="nofollow">[13]</a></p> 
<h3><a id="2Django_122"></a>2、电脑端<code>Django</code>项目引入谷歌和百度统计</h3> 
<blockquote> 
 <p>2021-07-21新增</p> 
</blockquote> 
<p>想了想还是决定将电脑端的页面也计入统计范畴，直接在<code>template</code>文件夹下的模板文件头添加即可，最好是有全局模板文件，如类似base.html等，这样就只需要在<code>header</code>标签内添加一次即可。另一种方式就是将<code>js</code>添加到外部<code>js</code>中，注意要去掉<code>script</code>标签：</p> 
<ul><li>百度</li></ul> 
<pre><code class="prism language-JavaScript">// baidu.js（js名称仅做参考）
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?你的id";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();

// base.html（模板名称仅做参考）
&lt;script type="text/javascript" src="你的js路径/baidu.js"&gt;&lt;/script&gt;

</code></pre> 
<ul><li>谷歌</li></ul> 
<pre><code class="prism language-JavaScript">// google.js（js名称仅做参考）
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-xxxxxxxx');

// base.html（模板名称仅做参考）
&lt;script async src="https://www.googletagmanager.com/gtag/js?id=你的id"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="你的js路径/google.js"&gt;&lt;/script&gt;

</code></pre> 
<p>参考链接：</p> 
<ol><li> <p>vue-cli的工程如何正确使用Google Analytics？ <a href="https://www.cnblogs.com/pheye/p/9014797.html" rel="nofollow">https://www.cnblogs.com/pheye/p/9014797.html</a></p> </li><li> <p>vue-analytics <a href="https://github.com/MatteoGabriele/vue-analytics/blob/master/README.md">https://github.com/MatteoGabriele/vue-analytics/blob/master/README.md</a></p> </li><li> <p>Get started <a href="https://matteo-gabriele.gitbook.io/vue-gtag/" rel="nofollow">https://matteo-gabriele.gitbook.io/vue-gtag/</a></p> </li><li> <p>vue-gtag<a href="https://github.com/MatteoGabriele/vue-gtag"> https://github.com/MatteoGabriele/vue-gtag</a></p> </li><li> <p>网站分析平台：是选择百度统计，还是 Google Analytics 呢？ <a href="https://www.cnblogs.com/zhenqichai/p/baidu-tongji-google-analytics.html" rel="nofollow">https://www.cnblogs.com/zhenqichai/p/baidu-tongji-google-analytics.html</a></p> </li><li> <p>开始使用 Analytics（分析） <a href="https://support.google.com/analytics/answer/9306384?hl=zh-Hans&amp;ref_topic=9303319" rel="nofollow">https://support.google.com/analytics/answer/9306384?hl=zh-Hans&amp;ref_topic=9303319</a></p> </li><li> <p>页面添加GA代码，10个GA基础应用 <a href="https://blog.csdn.net/chinaplan/article/details/16986923">https://blog.csdn.net/chinaplan/article/details/16986923</a></p> </li><li> <p>gTag使用实录 <a href="https://blog.csdn.net/wwz123124/article/details/93919216">https://blog.csdn.net/wwz123124/article/details/93919216</a></p> </li><li> <p>vue-ba <a href="https://github.com/minlingchao1/vue-ba">https://github.com/minlingchao1/vue-ba</a></p> </li><li> <p>手动检查代码的方法 <a href="https://tongji.baidu.com/web/help/article?id=93&amp;type=0" rel="nofollow">https://tongji.baidu.com/web/help/article?id=93&amp;type=0</a></p> </li><li> <p>单页面vue引入百度统计的使用方法！<a href="https://www.cnblogs.com/zengfp/p/9778119.html" rel="nofollow"> https://www.cnblogs.com/zengfp/p/9778119.html</a></p> </li><li> <p>通配符与正则表达式 <a href="https://tongji.baidu.com/web/help/article?id=246&amp;type=0" rel="nofollow">https://tongji.baidu.com/web/help/article?id=246&amp;type=0</a></p> </li><li> <p>为什么看不到热力图<br> <a href="https://tongji.baidu.com/web/help/article?id=207&amp;type=0" rel="nofollow"> https://tongji.baidu.com/web/help/article?id=207&amp;type=0</a></p> </li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bc3ac1fb1fdff69b577fc4925b767516/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">微信小程序regeneratorRuntime is not defined解决方案</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4c17731172fbfb440d192ba67d66200e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">fbx 多个Clips动画单个动画拿到3dmax编辑后重新导入unity</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>