<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ã€appç¯‡ã€‘å†™ä¸ªç®€å•çš„BLEè°ƒè¯•appï¼Œç»ƒç»ƒæ‰‹ï¼ŒåŒæ—¶ä¸ºåç»­è°ƒè¯•ESP32 BLEåšä¸ªæ”¯æŒ - ç¼–ç¨‹å¤§ç™½çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ã€appç¯‡ã€‘å†™ä¸ªç®€å•çš„BLEè°ƒè¯•appï¼Œç»ƒç»ƒæ‰‹ï¼ŒåŒæ—¶ä¸ºåç»­è°ƒè¯•ESP32 BLEåšä¸ªæ”¯æŒ" />
<meta property="og:description" content="å¿˜è®°è¿‡å»ï¼Œè¶…è¶Šè‡ªå·±
â¤ï¸ åšå®¢ä¸»é¡µ å•ç‰‡æœºèœé¸Ÿå“¥ï¼Œä¸€ä¸ªé‡ç”Ÿéä¸“ä¸šç¡¬ä»¶IOTçˆ±å¥½è€… â¤ï¸â¤ï¸ æœ¬ç¯‡åˆ›å»ºè®°å½• 2023-09-25 â¤ï¸â¤ï¸ æœ¬ç¯‡æ›´æ–°è®°å½• 2023-09-25 â¤ï¸ğŸ‰ æ¬¢è¿å…³æ³¨ ğŸ”ç‚¹èµ ğŸ‘æ”¶è— â­ï¸ç•™è¨€ğŸ“ğŸ™ æ­¤åšå®¢å‡ç”±åšä¸»å•ç‹¬ç¼–å†™ï¼Œä¸å­˜åœ¨ä»»ä½•å•†ä¸šå›¢é˜Ÿè¿è¥ï¼Œå¦‚å‘ç°é”™è¯¯ï¼Œè¯·ç•™è¨€è½°ç‚¸å“¦ï¼åŠæ—¶ä¿®æ­£ï¼æ„Ÿè°¢æ”¯æŒï¼ğŸ”¥ Arduino ESP8266æ•™ç¨‹ç´¯è®¡å¸®åŠ©è¿‡è¶…è¿‡1W&#43;åŒå­¦å…¥é—¨å­¦ä¹ ç¡¬ä»¶ç½‘ç»œç¼–ç¨‹ï¼Œå…¥é€‰è¿‡é€‰ä¿®è¯¾ç¨‹ï¼ŒåˆŠç™»è¿‡æ— çº¿ç”µæ‚å¿— ğŸ”¥é›¶åŸºç¡€ä»å…¥é—¨åˆ°ç†Ÿæ‚‰Arduinoå¹³å°ä¸‹å¼€å‘ESP8266ï¼ŒåŒæ—¶ä¼šæ¶‰åŠç½‘ç»œç¼–ç¨‹çŸ¥è¯†ã€‚ä¸“æ æ–‡ç« ç´¯è®¡è¶…è¿‡60ç¯‡ï¼Œåˆ†ä¸ºåŸºç¡€ç¯‡ã€ç½‘ç»œç¯‡ã€åº”ç”¨ç¯‡ã€é«˜çº§ç¯‡ï¼Œæ¶µç›–ESP8266å¤§éƒ¨åˆ†å¼€å‘æŠ€å·§ã€‚ å¿«é€Ÿå¯¼èˆª
å•ç‰‡æœºèœé¸Ÿçš„åšå®¢å¿«é€Ÿç´¢å¼•(å¿«é€Ÿæ‰¾åˆ°ä½ è¦çš„)
å¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œéº»çƒ¦ç‚¹èµæ”¶è—ï¼Œæ‚¨çš„æ”¯æŒæ˜¯åšä¸»åˆ›ä½œçš„åŠ¨åŠ›ã€‚
æ–‡ç« ç›®å½• 1. å‰è¨€2. å‚è€ƒèµ„æ–™3. Appæºç 4. ESP32 BLEæµ‹è¯•ä»£ç 5. Arduinoæµ‹è¯•ç»“æœ 1. å‰è¨€ æœ€è¿‘åœ¨ç©ç©esp32 bleç›¸å…³çŸ¥è¯†ç‚¹ï¼Œéœ€è¦è°ƒè¯•å†…å®¹ï¼Œæ‰€ä»¥å¹²è„†å°±æŸ¥é˜…ç›¸å…³èµ„æ–™å†™äº†ä¸€ä¸ªappã€‚
appä¸‹è½½é“¾æ¥ï¼Œ0ç§¯åˆ†ä¸‹è½½ï¼Œäº²æµ‹å¯ç”¨
BLEè°ƒè¯•åŠ©æ‰‹APP
2. å‚è€ƒèµ„æ–™ ä½¿ç”¨åˆ°äº†FastBLE
https://github.com/Jasonchenlijian/FastBle
3. Appæºç  éœ€è¦appæºç åŒå­¦ç›´æ¥ç•™è¨€é‚®ç®±ï¼Œè§åˆ°å¤„ç†ã€‚
4. ESP32 BLEæµ‹è¯•ä»£ç  æŠŠä»¥ä¸‹ä»£ç çƒ§å½•åˆ°ESP32-C3æˆ–è€…æœ‰BLEåŠŸèƒ½çš„ESP32å³å¯ã€‚
#include &lt;BLEDevice.h&gt; #include &lt;BLEServer.h&gt; #include &lt;BLEUtils.h&gt; #include &lt;BLE2902.h&gt; BLECharacteristic *pCharacteristicRead; BLECharacteristic *pCharacteristicNotify; BLECharacteristic *pCharacteristicWrite; BLEServer *pServer; bool deviceConnected = false; char BLEbuf[32] = {0}; uint32_t cnt = 0; #define SERVICE_UUID &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/efc18e3cbc8663b7cee661b311c4027d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-25T17:36:02+08:00" />
<meta property="article:modified_time" content="2023-09-25T17:36:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§ç™½çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§ç™½çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ã€appç¯‡ã€‘å†™ä¸ªç®€å•çš„BLEè°ƒè¯•appï¼Œç»ƒç»ƒæ‰‹ï¼ŒåŒæ—¶ä¸ºåç»­è°ƒè¯•ESP32 BLEåšä¸ªæ”¯æŒ</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>å¿˜è®°è¿‡å»ï¼Œè¶…è¶Šè‡ªå·±</p> 
 <ul><li>â¤ï¸ åšå®¢ä¸»é¡µ <a href="https://blog.csdn.net/dpjcn1990">å•ç‰‡æœºèœé¸Ÿå“¥ï¼Œä¸€ä¸ªé‡ç”Ÿéä¸“ä¸šç¡¬ä»¶IOTçˆ±å¥½è€…</a> â¤ï¸</li><li>â¤ï¸ æœ¬ç¯‡åˆ›å»ºè®°å½• 2023-09-25 â¤ï¸</li><li>â¤ï¸ æœ¬ç¯‡æ›´æ–°è®°å½• 2023-09-25 â¤ï¸</li><li>ğŸ‰ æ¬¢è¿å…³æ³¨ ğŸ”ç‚¹èµ ğŸ‘æ”¶è— â­ï¸ç•™è¨€ğŸ“</li><li>ğŸ™ æ­¤åšå®¢å‡ç”±åšä¸»å•ç‹¬ç¼–å†™ï¼Œä¸å­˜åœ¨ä»»ä½•å•†ä¸šå›¢é˜Ÿè¿è¥ï¼Œå¦‚å‘ç°é”™è¯¯ï¼Œè¯·ç•™è¨€è½°ç‚¸å“¦ï¼åŠæ—¶ä¿®æ­£ï¼æ„Ÿè°¢æ”¯æŒï¼</li><li>ğŸ”¥ Arduino ESP8266æ•™ç¨‹ç´¯è®¡å¸®åŠ©è¿‡è¶…è¿‡1W+åŒå­¦å…¥é—¨å­¦ä¹ ç¡¬ä»¶ç½‘ç»œç¼–ç¨‹ï¼Œå…¥é€‰è¿‡é€‰ä¿®è¯¾ç¨‹ï¼ŒåˆŠç™»è¿‡æ— çº¿ç”µæ‚å¿— ğŸ”¥é›¶åŸºç¡€ä»å…¥é—¨åˆ°ç†Ÿæ‚‰Arduinoå¹³å°ä¸‹å¼€å‘ESP8266ï¼ŒåŒæ—¶ä¼šæ¶‰åŠç½‘ç»œç¼–ç¨‹çŸ¥è¯†ã€‚ä¸“æ æ–‡ç« ç´¯è®¡è¶…è¿‡60ç¯‡ï¼Œåˆ†ä¸ºåŸºç¡€ç¯‡ã€ç½‘ç»œç¯‡ã€åº”ç”¨ç¯‡ã€é«˜çº§ç¯‡ï¼Œæ¶µç›–ESP8266å¤§éƒ¨åˆ†å¼€å‘æŠ€å·§ã€‚</li></ul> 
</blockquote> 
<p><strong>å¿«é€Ÿå¯¼èˆª</strong><br> <a href="https://blog.csdn.net/dpjcn1990/article/details/92831918">å•ç‰‡æœºèœé¸Ÿçš„åšå®¢å¿«é€Ÿç´¢å¼•(å¿«é€Ÿæ‰¾åˆ°ä½ è¦çš„)</a></p> 
<p>å¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œéº»çƒ¦ç‚¹èµæ”¶è—ï¼Œæ‚¨çš„æ”¯æŒæ˜¯åšä¸»åˆ›ä½œçš„åŠ¨åŠ›ã€‚</p> 
<p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><ul><li><a href="#1__18" rel="nofollow">1. å‰è¨€</a></li><li><a href="#2__25" rel="nofollow">2. å‚è€ƒèµ„æ–™</a></li><li><a href="#3_App_30" rel="nofollow">3. Appæºç </a></li><li><a href="#4_ESP32_BLE_33" rel="nofollow">4. ESP32 BLEæµ‹è¯•ä»£ç </a></li><li><a href="#5_Arduino_138" rel="nofollow">5. Arduinoæµ‹è¯•ç»“æœ</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="1__18"></a>1. å‰è¨€</h3> 
<p>æœ€è¿‘åœ¨ç©ç©esp32 bleç›¸å…³çŸ¥è¯†ç‚¹ï¼Œéœ€è¦è°ƒè¯•å†…å®¹ï¼Œæ‰€ä»¥å¹²è„†å°±æŸ¥é˜…ç›¸å…³èµ„æ–™å†™äº†ä¸€ä¸ªappã€‚<br> <a href="https://download.csdn.net/download/dpjcn1990/88374209">appä¸‹è½½é“¾æ¥ï¼Œ0ç§¯åˆ†ä¸‹è½½ï¼Œäº²æµ‹å¯ç”¨</a></p> 
<p></p> 
<div class="csdn-video-box"> 
 <iframe id="qZwQCxEI-1695634382147" frameborder="0" src="https://live.csdn.net/v/embed/330636" allowfullscreen="true" data-mediaembed="csdn"></iframe> 
 <p>BLEè°ƒè¯•åŠ©æ‰‹APP</p> 
</div> 
<p></p> 
<h3><a id="2__25"></a>2. å‚è€ƒèµ„æ–™</h3> 
<p>ä½¿ç”¨åˆ°äº†FastBLE<br> <img src="https://images2.imgbox.com/b8/30/9n9w4dkW_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<blockquote> 
 <p><a href="https://github.com/Jasonchenlijian/FastBle">https://github.com/Jasonchenlijian/FastBle</a></p> 
</blockquote> 
<h3><a id="3_App_30"></a>3. Appæºç </h3> 
<p>éœ€è¦appæºç åŒå­¦ç›´æ¥ç•™è¨€é‚®ç®±ï¼Œè§åˆ°å¤„ç†ã€‚<br> <img src="https://images2.imgbox.com/93/80/BWgD7Fe3_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="4_ESP32_BLE_33"></a>4. ESP32 BLEæµ‹è¯•ä»£ç </h3> 
<p>æŠŠä»¥ä¸‹ä»£ç çƒ§å½•åˆ°ESP32-C3æˆ–è€…æœ‰BLEåŠŸèƒ½çš„ESP32å³å¯ã€‚</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;BLEDevice.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;BLEServer.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;BLEUtils.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;BLE2902.h&gt;</span></span>

BLECharacteristic <span class="token operator">*</span>pCharacteristicRead<span class="token punctuation">;</span>
BLECharacteristic <span class="token operator">*</span>pCharacteristicNotify<span class="token punctuation">;</span>
BLECharacteristic <span class="token operator">*</span>pCharacteristicWrite<span class="token punctuation">;</span>
BLEServer <span class="token operator">*</span>pServer<span class="token punctuation">;</span>

bool deviceConnected <span class="token operator">=</span> false<span class="token punctuation">;</span>
<span class="token keyword">char</span> BLEbuf<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">uint32_t</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SERVICE_UUID</span>           <span class="token string">"6E400001-B5A3-F393-E0A9-E50E24DCCA9E"</span> <span class="token comment">// UART service UUID</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CHARACTERISTIC_UUID_RX</span> <span class="token string">"6E400002-B5A3-F393-E0A9-E50E24DCCA9E"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CHARACTERISTIC_UUID_TX</span> <span class="token string">"6E400003-B5A3-F393-E0A9-E50E24DCCA9E"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CHARACTERISTIC_UUID_READ</span> <span class="token string">"6E400003-B5A3-F393-E0A9-E50E24DCCA9F"</span></span>

class MyServerCallbacks<span class="token operator">:</span> public BLEServerCallbacks <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">void</span> <span class="token function">onConnect</span><span class="token punctuation">(</span>BLEServer<span class="token operator">*</span> pServer<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      deviceConnected <span class="token operator">=</span> true<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">onDisconnect</span><span class="token punctuation">(</span>BLEServer<span class="token operator">*</span> pServer<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      deviceConnected <span class="token operator">=</span> false<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

class MyWriteCallbacks<span class="token operator">:</span> public BLECharacteristicCallbacks <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">void</span> <span class="token function">onWrite</span><span class="token punctuation">(</span>BLECharacteristic <span class="token operator">*</span>pCharacteristic<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      std<span class="token operator">::</span>string rxValue <span class="token operator">=</span> pCharacteristic<span class="token operator">-&gt;</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>rxValue<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"------&gt;Received Value: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rxValue<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        for (int i = 0; i &lt; rxValue.length(); i++) {<!-- --></span>
<span class="token comment">//          Serial.print(rxValue[i]);</span>
<span class="token comment">//        }</span>
        Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>rxValue<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Rx A!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>rxValue<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"B"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Rx B!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	Serial<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token number">115200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// åˆ›å»ºä¸€ä¸ªbleè®¾å¤‡</span>
	BLEDevice<span class="token operator">::</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token string">"BLE_TEST"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  BLEDevice<span class="token operator">::</span><span class="token function">setMTU</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// åˆ›å»ºä¸€ä¸ªbleæœåŠ¡å™¨</span>
	pServer <span class="token operator">=</span> BLEDevice<span class="token operator">::</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	pServer<span class="token operator">-&gt;</span><span class="token function">setCallbacks</span><span class="token punctuation">(</span>new <span class="token function">MyServerCallbacks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// åˆ›å»ºä¸€ä¸ªbleæœåŠ¡</span>
	BLEService <span class="token operator">*</span>pService <span class="token operator">=</span> pServer<span class="token operator">-&gt;</span><span class="token function">createService</span><span class="token punctuation">(</span>SERVICE_UUID<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// åˆ›å»ºä¸€ä¸ªbleç‰¹å¾ï¼Œç”¨äºé€šçŸ¥å¯¹æ–¹</span>
	pCharacteristicNotify <span class="token operator">=</span> pService<span class="token operator">-&gt;</span><span class="token function">createCharacteristic</span><span class="token punctuation">(</span>CHARACTERISTIC_UUID_TX<span class="token punctuation">,</span> BLECharacteristic<span class="token operator">::</span>PROPERTY_NOTIFY<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ·»åŠ ä¸€ä¸ªç‰¹å¾æè¿°ç¬¦</span>
	pCharacteristicNotify<span class="token operator">-&gt;</span><span class="token function">addDescriptor</span><span class="token punctuation">(</span>new <span class="token function">BLE2902</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// åˆ›å»ºä¸€ä¸ªåªè¯»bleç‰¹å¾</span>
	pCharacteristicRead <span class="token operator">=</span> pService<span class="token operator">-&gt;</span><span class="token function">createCharacteristic</span><span class="token punctuation">(</span>CHARACTERISTIC_UUID_READ<span class="token punctuation">,</span> BLECharacteristic<span class="token operator">::</span>PROPERTY_READ<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>BLEbuf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">memcpy</span><span class="token punctuation">(</span>BLEbuf<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"åªè¯»æ•°æ®!"</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  pCharacteristicRead<span class="token operator">-&gt;</span><span class="token function">setValue</span><span class="token punctuation">(</span>BLEbuf<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// åˆ›å»ºä¸€ä¸ªbleç‰¹å¾ï¼Œç”¨äºæ”¶åˆ°å¯¹æ–¹æ•°æ®</span>
	pCharacteristicWrite <span class="token operator">=</span> pService<span class="token operator">-&gt;</span><span class="token function">createCharacteristic</span><span class="token punctuation">(</span>CHARACTERISTIC_UUID_RX<span class="token punctuation">,</span> BLECharacteristic<span class="token operator">::</span>PROPERTY_WRITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	pCharacteristicWrite<span class="token operator">-&gt;</span><span class="token function">setCallbacks</span><span class="token punctuation">(</span>new <span class="token function">MyWriteCallbacks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// å¯åŠ¨æœåŠ¡å™¨</span>
	pService<span class="token operator">-&gt;</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// å¯åŠ¨å¹¿æ’­</span>
	pServer<span class="token operator">-&gt;</span><span class="token function">getAdvertising</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Waiting a client connection to notify..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"MTU:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>BLEDevice<span class="token operator">::</span><span class="token function">getMTU</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>deviceConnected<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">memset</span><span class="token punctuation">(</span>BLEbuf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">memcpy</span><span class="token punctuation">(</span>BLEbuf<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token string">"Hello BLE APP!"</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		pCharacteristicNotify<span class="token operator">-&gt;</span><span class="token function">setValue</span><span class="token punctuation">(</span>BLEbuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
		pCharacteristicNotify<span class="token operator">-&gt;</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Send the value to the app!</span>
		Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"*** Sent Value: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>BLEbuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
		Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">" ***"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
	  pServer<span class="token operator">-&gt;</span><span class="token function">getAdvertising</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Waiting a client connection to notify..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="5_Arduino_138"></a>5. Arduinoæµ‹è¯•ç»“æœ</h3> 
<p><img src="https://images2.imgbox.com/73/e1/Ayn80p4P_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> æ•´ä½“è¿‡ç¨‹æ˜¯é€šè·¯çš„ï¼Œåé¢å³å¯åœ¨ä¸Šé¢è¿›è¡Œä¸šåŠ¡å¼€å‘ã€‚</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6264a240dcd8a750b88e82a97806b50f/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">146. LRU ç¼“å­˜</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c41cfe7e058e0c19f1f44f309d19da69/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">ã€ŒèŠè®¾è®¡æ¨¡å¼ã€ä¹‹åŸå‹æ¨¡å¼ï¼ˆPrototypeï¼‰</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§ç™½çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>