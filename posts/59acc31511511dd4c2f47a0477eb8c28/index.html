<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【在Visual Studio中使用CMake构建项目工程】 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【在Visual Studio中使用CMake构建项目工程】" />
<meta property="og:description" content="在Visual Studio中使用CMake构建项目工程 1 CMake概述2 CMake的使用2.1 注释2.1.1 注释行2.1.2 注释块 2.2只有源文件2.2.1 共处一室 2.3私人订制2.3.1 定义变量2.3.2 指定使用的C&#43;&#43;标准2.3.3 指定输出的路径 2.4搜索文件2.4.1 方式12.4.2方式2 2.5 包含头文件2.6 制作动态库或静态库2.6.1 制作静态库2.6.2 制作动态库2.6.3 指定输出的路径 2.7 包含库文件2.7.1 链接静态库2.7.2 链接动态库2.7.3链接第三方动态库 2.8日志2.9 变量操作2.9.1 追加2.9.2 字符串移除2.9.3list命令其它功能 2.9 宏定义 3. 预定义宏4. 嵌套的CMake4.1 准备工作4.1.1 节点关系4.1.2 添加子目录 4.2 解决问题4.2.1 根目录4.2.2 calc 目录4.2.3 sort 目录4.2.4 test1 目录4.2.5 test2 目录4.2.6 构建项目 5. 流程控制5.1 条件判断5.1.1 基本表达式5.1.2 逻辑判断5.1.3 比较5.1.4 文件操作5.1.5 其它 5.2 循环5.2.1 foreach5.2.2 while 1 CMake概述 CMake 是一个项目构建工具，并且是跨平台的。关于项目构建我们所熟知的还有Makefile（通过 make 命令进行项目的构建），大多是IDE软件都集成了make，比如：VS 的 nmake、linux 下的 GNU make、Qt 的 qmake等，如果自己动手写 makefile，会发现，makefile 通常依赖于当前的编译平台，而且编写 makefile 的工作量比较大，解决依赖关系时也容易出错。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/59acc31511511dd4c2f47a0477eb8c28/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-28T18:39:18+08:00" />
<meta property="article:modified_time" content="2023-12-28T18:39:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【在Visual Studio中使用CMake构建项目工程】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>在Visual Studio中使用CMake构建项目工程</h4> 
 <ul><li><a href="#1_CMake_1" rel="nofollow">1 CMake概述</a></li><li><a href="#2_CMake_19" rel="nofollow">2 CMake的使用</a></li><li><ul><li><a href="#21__26" rel="nofollow">2.1 注释</a></li><li><ul><li><a href="#211__27" rel="nofollow">2.1.1 注释行</a></li><li><a href="#212__34" rel="nofollow">2.1.2 注释块</a></li></ul> 
   </li><li><a href="#22_43" rel="nofollow">2.2只有源文件</a></li><li><ul><li><a href="#221__44" rel="nofollow">2.2.1 共处一室</a></li></ul> 
   </li><li><a href="#23_212" rel="nofollow">2.3私人订制</a></li><li><ul><li><a href="#231__213" rel="nofollow">2.3.1 定义变量</a></li><li><a href="#232_C_233" rel="nofollow">2.3.2 指定使用的C++标准</a></li><li><a href="#233__247" rel="nofollow">2.3.3 指定输出的路径</a></li></ul> 
   </li><li><a href="#24_275" rel="nofollow">2.4搜索文件</a></li><li><ul><li><a href="#241_1_278" rel="nofollow">2.4.1 方式1</a></li><li><a href="#2422_296" rel="nofollow">2.4.2方式2</a></li></ul> 
   </li><li><a href="#25__317" rel="nofollow">2.5 包含头文件</a></li><li><a href="#26__357" rel="nofollow">2.6 制作动态库或静态库</a></li><li><ul><li><a href="#261__360" rel="nofollow">2.6.1 制作静态库</a></li><li><a href="#262__384" rel="nofollow">2.6.2 制作动态库</a></li><li><a href="#263__409" rel="nofollow">2.6.3 指定输出的路径</a></li></ul> 
   </li><li><a href="#27__435" rel="nofollow">2.7 包含库文件</a></li><li><ul><li><a href="#271__438" rel="nofollow">2.7.1 链接静态库</a></li><li><a href="#272__495" rel="nofollow">2.7.2 链接动态库</a></li><li><a href="#273_551" rel="nofollow">2.7.3链接第三方动态库</a></li></ul> 
   </li><li><a href="#28_584" rel="nofollow">2.8日志</a></li><li><a href="#29__611" rel="nofollow">2.9 变量操作</a></li><li><ul><li><a href="#291__612" rel="nofollow">2.9.1 追加</a></li><li><a href="#292__667" rel="nofollow">2.9.2 字符串移除</a></li><li><a href="#293list_700" rel="nofollow">2.9.3list命令其它功能</a></li></ul> 
   </li><li><a href="#29__820" rel="nofollow">2.9 宏定义</a></li></ul> 
  </li><li><a href="#3__858" rel="nofollow">3. 预定义宏</a></li><li><a href="#4_CMake_861" rel="nofollow">4. 嵌套的CMake</a></li><li><ul><li><a href="#41__900" rel="nofollow">4.1 准备工作</a></li><li><ul><li><a href="#411__901" rel="nofollow">4.1.1 节点关系</a></li><li><a href="#412__907" rel="nofollow">4.1.2 添加子目录</a></li></ul> 
   </li><li><a href="#42__920" rel="nofollow">4.2 解决问题</a></li><li><ul><li><a href="#421__929" rel="nofollow">4.2.1 根目录</a></li><li><a href="#422_calc__962" rel="nofollow">4.2.2 calc 目录</a></li><li><a href="#423_sort__979" rel="nofollow">4.2.3 sort 目录</a></li><li><a href="#424_test1__996" rel="nofollow">4.2.4 test1 目录</a></li><li><a href="#425_test2__1017" rel="nofollow">4.2.5 test2 目录</a></li><li><a href="#426__1039" rel="nofollow">4.2.6 构建项目</a></li></ul> 
  </li></ul> 
  </li><li><a href="#5__1048" rel="nofollow">5. 流程控制</a></li><li><ul><li><a href="#51__1050" rel="nofollow">5.1 条件判断</a></li><li><ul><li><a href="#511__1064" rel="nofollow">5.1.1 基本表达式</a></li><li><a href="#512__1075" rel="nofollow">5.1.2 逻辑判断</a></li><li><a href="#513__1099" rel="nofollow">5.1.3 比较</a></li><li><a href="#514__1134" rel="nofollow">5.1.4 文件操作</a></li><li><a href="#515__1176" rel="nofollow">5.1.5 其它</a></li></ul> 
   </li><li><a href="#52__1230" rel="nofollow">5.2 循环</a></li><li><ul><li><a href="#521_foreach_1232" rel="nofollow">5.2.1 foreach</a></li><li><a href="#522_while_1434" rel="nofollow">5.2.2 while</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1_CMake_1"></a>1 CMake概述</h2> 
<p>CMake 是一个项目构建工具，并且是跨平台的。关于项目构建我们所熟知的还有Makefile（通过 make 命令进行项目的构建），大多是IDE软件都集成了make，比如：VS 的 nmake、linux 下的 GNU make、Qt 的 qmake等，如果自己动手写 makefile，会发现，makefile 通常依赖于当前的编译平台，而且编写 makefile 的工作量比较大，解决依赖关系时也容易出错。</p> 
<p>而 CMake 恰好能解决上述问题， 其允许开发者指定整个工程的编译流程，在根据编译平台，自动生成本地化的Makefile和工程文件，最后用户只需make编译即可，所以可以把CMake看成一款自动生成 Makefile的工具，其编译流程如下图：</p> 
<p><img src="https://images2.imgbox.com/8f/d1/hhjIg90z_o.png" alt="在这里插入图片描述"><br> 蓝色虚线表示使用makefile构建项目的过程<br> 红色实线表示使用cmake构建项目的过程<br> 介绍完CMake的作用之后，再来总结一下它的优点：</p> 
<ul><li>跨平台</li><li>能够管理大型项目</li><li>简化编译构建过程和编译过程</li><li>可扩展：可以为 cmake 编写特定功能的模块，扩充 cmake 功能</li></ul> 
<h2><a id="2_CMake_19"></a>2 CMake的使用</h2> 
<p>CMake支持大写、小写、混合大小写的命令。如果在编写CMakeLists.txt文件时使用的工具有对应的命令提示，那么大小写随缘即可，不要太过在意。</p> 
<p><strong>下载CMake软件</strong><br> 在CMake官方网站下载软件<br> <img src="https://images2.imgbox.com/fb/cb/enMQN2wJ_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="21__26"></a>2.1 注释</h3> 
<h4><a id="211__27"></a>2.1.1 注释行</h4> 
<p>CMake 使用 <strong>#</strong> 进行行注释，可以放在任何位置。</p> 
<pre><code class="prism language-cpp"># 这是一个 CMakeLists<span class="token punctuation">.</span>txt 文件
<span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="212__34"></a>2.1.2 注释块</h4> 
<p>CMake 使用 <strong>#[[ ]]</strong> 形式进行块注释。</p> 
<pre><code class="prism language-cpp">#<span class="token punctuation">[</span><span class="token punctuation">[</span> 这是一个 CMakeLists<span class="token punctuation">.</span>txt 文件。
这是一个 CMakeLists<span class="token punctuation">.</span>txt 文件
这是一个 CMakeLists<span class="token punctuation">.</span>txt 文件<span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="22_43"></a>2.2只有源文件</h3> 
<h4><a id="221__44"></a>2.2.1 共处一室</h4> 
<p>1、准备工作，为了方便测试，在我本地电脑准备了这么几个测试文件</p> 
<p><img src="https://images2.imgbox.com/79/e8/q1VYvZBa_o.png" alt="在这里插入图片描述"></p> 
<p><strong>add.c</strong></p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"head.h"</span></span>

<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>sub.c</strong></p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"head.h"</span></span>

<span class="token comment">// 你好</span>
<span class="token keyword">int</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> a<span class="token operator">-</span>b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>mult.c</strong></p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"head.h"</span></span>

<span class="token keyword">int</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> a<span class="token operator">*</span>b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>div.c</strong></p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"head.h"</span></span>

<span class="token keyword">double</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>a<span class="token operator">/</span>b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>head.h</strong></p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_HEAD_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_HEAD_H</span></span>
<span class="token comment">// 加法</span>
<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 减法</span>
<span class="token keyword">int</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 乘法</span>
<span class="token keyword">int</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 除法</span>
<span class="token keyword">double</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre> 
<p><strong>main.c</strong></p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"head.h"</span></span>
<span class="token comment">//#include &lt;iostream&gt;</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a = %d, b = %d\n"</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a + b = %d\n"</span><span class="token punctuation">,</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a - b = %d\n"</span><span class="token punctuation">,</span> <span class="token function">subtract</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a * b = %d\n"</span><span class="token punctuation">,</span> <span class="token function">multiply</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a / b = %f\n"</span><span class="token punctuation">,</span> <span class="token function">divide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>2、添加 <strong>CMakeLists.txt</strong> 文件<br> 在上述源文件所在目录下添加一个新文件 CMakeLists.txt，文件内容如下：</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>CALC<span class="token punctuation">)</span>
<span class="token function">add_executable</span><span class="token punctuation">(</span>app add<span class="token punctuation">.</span>c div<span class="token punctuation">.</span>c main<span class="token punctuation">.</span>c mult<span class="token punctuation">.</span>c sub<span class="token punctuation">.</span>c<span class="token punctuation">)</span>
</code></pre> 
<p>接下来依次介绍一下在 CMakeLists.txt 文件中添加的三个命令:</p> 
<p><strong>cmake_minimum_required</strong>：指定使用的 cmake 的最低版本，可选，非必须，如果不加可能会有警告。</p> 
<p><strong>project</strong>：定义工程名称，并可指定工程的版本、工程描述、web主页地址、支持的语言（默认情况支持所有语言），如果不需要这些都是可以忽略的，只需要指定出工程名字即可。</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">PROJECT 指令的语法是：</span></span>
<span class="token function">project</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>PROJECT<span class="token operator">-</span>NAME<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>language<span class="token operator">-</span>name<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>PROJECT<span class="token operator">-</span>NAME<span class="token operator">&gt;</span>
       <span class="token punctuation">[</span>VERSION <span class="token operator">&lt;</span>major<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token operator">&lt;</span>minor<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token operator">&lt;</span>patch<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token operator">&lt;</span>tweak<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
       <span class="token punctuation">[</span>DESCRIPTION <span class="token operator">&lt;</span>project<span class="token operator">-</span>description<span class="token operator">-</span>string<span class="token operator">&gt;</span><span class="token punctuation">]</span>
       <span class="token punctuation">[</span>HOMEPAGE_URL <span class="token operator">&lt;</span>url<span class="token operator">-</span>string<span class="token operator">&gt;</span><span class="token punctuation">]</span>
       <span class="token punctuation">[</span>LANGUAGES <span class="token operator">&lt;</span>language<span class="token operator">-</span>name<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre> 
<p><strong>add_executable</strong>：定义工程会生成一个可执行程序</p> 
<pre><code class="prism language-c"><span class="token function">add_executable</span><span class="token punctuation">(</span>可执行程序名 源文件名称<span class="token punctuation">)</span>
</code></pre> 
<ul><li>这里的可执行程序名和project中的项目名没有任何关系。</li><li>源文件名可以是一个也可以是多个，如有多个可用空格或;间隔。</li></ul> 
<pre><code class="prism language-c"># 样式<span class="token number">1</span>
<span class="token function">add_executable</span><span class="token punctuation">(</span>app add<span class="token punctuation">.</span>c div<span class="token punctuation">.</span>c main<span class="token punctuation">.</span>c mult<span class="token punctuation">.</span>c sub<span class="token punctuation">.</span>c<span class="token punctuation">)</span>
# 样式<span class="token number">2</span>
<span class="token function">add_executable</span><span class="token punctuation">(</span>app add<span class="token punctuation">.</span>c<span class="token punctuation">;</span>div<span class="token punctuation">.</span>c<span class="token punctuation">;</span>main<span class="token punctuation">.</span>c<span class="token punctuation">;</span>mult<span class="token punctuation">.</span>c<span class="token punctuation">;</span>sub<span class="token punctuation">.</span>c<span class="token punctuation">)</span>
</code></pre> 
<p>3、<strong>CMakeLists.txt</strong> 文件</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>   #指定使用的 cmake 的最低版本
<span class="token function">project</span><span class="token punctuation">(</span>CALC<span class="token punctuation">)</span>    #定义工程名称
<span class="token function">set</span><span class="token punctuation">(</span>SRC_LIST add<span class="token punctuation">.</span>c<span class="token punctuation">;</span>div<span class="token punctuation">.</span>c<span class="token punctuation">;</span>main<span class="token punctuation">.</span>c<span class="token punctuation">;</span>mult<span class="token punctuation">.</span>c<span class="token punctuation">;</span>sub<span class="token punctuation">.</span>c<span class="token punctuation">)</span>
<span class="token function">add_executable</span><span class="token punctuation">(</span>app  $<span class="token punctuation">{<!-- --></span>SRC_LIST<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>4、<strong>cmake-vs2019-debug.bat</strong>文件<br> cmake-vs2019-debug.bat文件，是用来执行cmake的，执行之后可以生成项目工程。这里使用的是VS2019平台。</p> 
<pre><code class="prism language-c">mkdir build_x64_2019
cd build_x64_2019
cmake<span class="token punctuation">.</span>exe <span class="token operator">-</span>G <span class="token string">"Visual Studio 16 2019"</span> <span class="token operator">-</span>T v142 <span class="token operator">-</span>DCMAKE_BUILD_TYPE<span class="token operator">=</span>Debug <span class="token punctuation">.</span><span class="token punctuation">.</span>
pause
</code></pre> 
<p><img src="https://images2.imgbox.com/00/1a/UzhOLpaF_o.png" alt="在这里插入图片描述"></p> 
<p>双击 <strong>cmake-vs2019-debug.bat</strong>文件，就会生成工程文件夹。</p> 
<p><img src="https://images2.imgbox.com/b6/b9/cazRwflf_o.png" alt="在这里插入图片描述"></p> 
<p>双击C<strong>ALC.sln</strong>打开工程</p> 
<p><img src="https://images2.imgbox.com/48/0b/HLY7Ihwm_o.png" alt="在这里插入图片描述"></p> 
<p>生成解决方案</p> 
<p><img src="https://images2.imgbox.com/91/1c/D8d8A7YJ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/28/9c/b86pqtA9_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="23_212"></a>2.3私人订制</h3> 
<h4><a id="231__213"></a>2.3.1 定义变量</h4> 
<p>在上面的例子中一共提供了5个源文件，假设这五个源文件需要反复被使用，每次都直接将它们的名字写出来确实是很麻烦，此时我们就需要定义一个变量，将文件名对应的字符串存储起来，在cmake里定义变量需要使用set。</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">SET 指令的语法是：</span></span>
# <span class="token punctuation">[</span><span class="token punctuation">]</span> 中的参数为可选项<span class="token punctuation">,</span> 如不需要可以不写
<span class="token function">SET</span><span class="token punctuation">(</span>VAR <span class="token punctuation">[</span>VALUE<span class="token punctuation">]</span> <span class="token punctuation">[</span>CACHE TYPE DOCSTRING <span class="token punctuation">[</span>FORCE<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-c"># 方式<span class="token number">1</span><span class="token operator">:</span> 各个源文件之间使用空格间隔
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">set</span><span class="token expression"><span class="token punctuation">(</span>SRC_LIST add<span class="token punctuation">.</span>c  div<span class="token punctuation">.</span>c   main<span class="token punctuation">.</span>c  mult<span class="token punctuation">.</span>c  sub<span class="token punctuation">.</span>c<span class="token punctuation">)</span></span></span>

# 方式<span class="token number">2</span><span class="token operator">:</span> 各个源文件之间使用分号 <span class="token punctuation">;</span> 间隔
<span class="token function">set</span><span class="token punctuation">(</span>SRC_LIST add<span class="token punctuation">.</span>c<span class="token punctuation">;</span>div<span class="token punctuation">.</span>c<span class="token punctuation">;</span>main<span class="token punctuation">.</span>c<span class="token punctuation">;</span>mult<span class="token punctuation">.</span>c<span class="token punctuation">;</span>sub<span class="token punctuation">.</span>c<span class="token punctuation">)</span>
<span class="token function">add_executable</span><span class="token punctuation">(</span>app  $<span class="token punctuation">{<!-- --></span>SRC_LIST<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> 
<h4><a id="232_C_233"></a>2.3.2 指定使用的C++标准</h4> 
<p>在编写C++程序的时候，可能会用到C++11、C++14、C++17、C++20等新特性，那么就需要在编译的时候在编译命令中指定出要使用哪个标准：</p> 
<p>在 CMakeLists.txt 中通过 set 命令指定</p> 
<pre><code class="prism language-c">#增加<span class="token operator">-</span>std<span class="token operator">=</span>c<span class="token operator">++</span><span class="token number">11</span>
<span class="token function">set</span><span class="token punctuation">(</span>CMAKE_CXX_STANDARD <span class="token number">11</span><span class="token punctuation">)</span>
#增加<span class="token operator">-</span>std<span class="token operator">=</span>c<span class="token operator">++</span><span class="token number">14</span>
<span class="token function">set</span><span class="token punctuation">(</span>CMAKE_CXX_STANDARD <span class="token number">14</span><span class="token punctuation">)</span>
#增加<span class="token operator">-</span>std<span class="token operator">=</span>c<span class="token operator">++</span><span class="token number">17</span>
<span class="token function">set</span><span class="token punctuation">(</span>CMAKE_CXX_STANDARD <span class="token number">17</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="233__247"></a>2.3.3 指定输出的路径</h4> 
<p>在CMake中指定可执行程序输出的路径，也对应一个宏，叫做<strong>EXECUTABLE_OUTPUT_PATH</strong>，它的值还是通过set命令进行设置:</p> 
<pre><code class="prism language-c"><span class="token function">set</span><span class="token punctuation">(</span>HOME <span class="token operator">/</span>home<span class="token operator">/</span>robin<span class="token operator">/</span>Linux<span class="token operator">/</span>Sort<span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>EXECUTABLE_OUTPUT_PATH $<span class="token punctuation">{<!-- --></span>HOME<span class="token punctuation">}</span><span class="token operator">/</span>bin<span class="token punctuation">)</span>
</code></pre> 
<p><strong>第一行：定义一个变量用于存储一个绝对路径</strong><br> <strong>第二行：将拼接好的路径值设置给EXECUTABLE_OUTPUT_PATH宏</strong></p> 
<p>如果这个路径中的子目录不存在，会自动生成，无需自己手动创建。</p> 
<p>重新弄编写<strong>CMakeLists.txt</strong> 文件，指定可执行程序的输出路径。</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>   #指定使用的 cmake 的最低版本
<span class="token function">project</span><span class="token punctuation">(</span>CALC<span class="token punctuation">)</span>    #定义工程名称
<span class="token function">set</span><span class="token punctuation">(</span>SRC_LIST add<span class="token punctuation">.</span>c<span class="token punctuation">;</span>div<span class="token punctuation">.</span>c<span class="token punctuation">;</span>main<span class="token punctuation">.</span>c<span class="token punctuation">;</span>mult<span class="token punctuation">.</span>c<span class="token punctuation">;</span>sub<span class="token punctuation">.</span>c<span class="token punctuation">)</span>

# 指定使用C<span class="token operator">++</span><span class="token number">11</span>
<span class="token function">set</span><span class="token punctuation">(</span>CMAKE_CXX_STANDARD <span class="token number">11</span><span class="token punctuation">)</span>
#指定可执行程序的输出路径
<span class="token function">set</span><span class="token punctuation">(</span>HOME C<span class="token operator">:</span><span class="token operator">/</span>Users<span class="token operator">/</span>LIUYANG64426<span class="token operator">/</span>Desktop<span class="token operator">/</span>test_demo<span class="token operator">/</span>OUTPUT_PATH<span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>EXECUTABLE_OUTPUT_PATH $<span class="token punctuation">{<!-- --></span>HOME<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">add_executable</span><span class="token punctuation">(</span>app  $<span class="token punctuation">{<!-- --></span>SRC_LIST<span class="token punctuation">}</span><span class="token punctuation">)</span> #生成可执行程序
</code></pre> 
<p><img src="https://images2.imgbox.com/ec/48/m3WFZi20_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="24_275"></a>2.4搜索文件</h3> 
<p>如果一个项目里边的源文件很多，在编写CMakeLists.txt文件的时候不可能将项目目录的各个文件一一罗列出来，这样太麻烦也不现实。所以，在CMake中为我们提供了搜索文件的命令，可以使用aux_source_directory命令或者file命令。</p> 
<h4><a id="241_1_278"></a>2.4.1 方式1</h4> 
<p>在 CMake 中使用<strong>aux_source_directory</strong> 命令可以查找某个路径下的所有源文件，命令格式为：</p> 
<pre><code class="prism language-c"><span class="token function">aux_source_directory</span><span class="token punctuation">(</span><span class="token operator">&lt;</span> dir <span class="token operator">&gt;</span> <span class="token operator">&lt;</span> variable <span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>dir</strong>：要搜索的目录<br> <strong>variable</strong>：将从dir目录下搜索到的源文件列表存储到该变量中</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>CALC<span class="token punctuation">)</span>
<span class="token function">include_directories</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>PROJECT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>include<span class="token punctuation">)</span>
# 搜索 src 目录下的源文件 存放在SRC_LIST中
<span class="token function">aux_source_directory</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>CMAKE_CURRENT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>src SRC_LIST<span class="token punctuation">)</span>
<span class="token function">add_executable</span><span class="token punctuation">(</span>app  $<span class="token punctuation">{<!-- --></span>SRC_LIST<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="2422_296"></a>2.4.2方式2</h4> 
<p>在CMake中为我们提供了搜索文件的命令，他就是file（当然，除了搜索以外通过 file 还可以做其他事情）。</p> 
<pre><code class="prism language-c"><span class="token function">file</span><span class="token punctuation">(</span>GLOB<span class="token operator">/</span>GLOB_RECURSE 变量名 要搜索的文件路径和文件类型<span class="token punctuation">)</span>
</code></pre> 
<p><strong>GLOB:</strong> 将指定目录下搜索到的满足条件的所有文件名生成一个列表，并将其存储到变量中。<br> <strong>GLOB_RECURSE</strong>: 递归搜索指定目录，将搜索到的满足条件的文件名生成一个列表，并将其存储到变量中。搜索当前目录的src目录下所有的源文件，并存储到变量中.</p> 
<pre><code class="prism language-c"><span class="token function">file</span><span class="token punctuation">(</span>GLOB MAIN_SRC $<span class="token punctuation">{<!-- --></span>CMAKE_CURRENT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>src<span class="token comment">/*.cpp)
file(GLOB MAIN_HEAD ${CMAKE_CURRENT_SOURCE_DIR}/include/*.h)
</span></code></pre> 
<p><strong>CMAKE_CURRENT_SOURCE_DIR</strong> 宏表示当前访问的 <strong>CMakeLists.txt</strong> 文件所在的路径。</p> 
<p>关于要搜索的文件路径和类型可加双引号，也可不加:</p> 
<pre><code class="prism language-c"><span class="token function">file</span><span class="token punctuation">(</span>GLOB MAIN_HEAD <span class="token string">"${CMAKE_CURRENT_SOURCE_DIR}/src/*.h"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="25__317"></a>2.5 包含头文件</h3> 
<p>在编译项目源文件的时候，很多时候都需要将源文件对应的头文件路径指定出来，这样才能保证在编译过程中编译器能够找到这些头文件，并顺利通过编译。在CMake中设置要包含的目录也很简单，通过一个命令就可以搞定了，他就是i<strong>nclude_directories</strong>:</p> 
<pre><code class="prism language-c"><span class="token function">include_directories</span><span class="token punctuation">(</span>headpath<span class="token punctuation">)</span>
</code></pre> 
<p>举例说明，有源文件若干，其目录结构如下：</p> 
<p><img src="https://images2.imgbox.com/3f/1f/6n4rzaQG_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">$ tree
<span class="token punctuation">.</span>
├── CMakeLists<span class="token punctuation">.</span>txt
├── include
│   └── head<span class="token punctuation">.</span>h
└── src
    ├── add<span class="token punctuation">.</span>cpp
    ├── div<span class="token punctuation">.</span>cpp
    ├── main<span class="token punctuation">.</span>cpp
    ├── mult<span class="token punctuation">.</span>cpp
    └── sub<span class="token punctuation">.</span>cpp

</code></pre> 
<p><strong>CMakeLists.txt</strong>文件内容如下:</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>CALC<span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>CMAKE_CXX_STANDARD <span class="token number">11</span><span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>HOME <span class="token operator">/</span>home<span class="token operator">/</span>robin<span class="token operator">/</span>Linux<span class="token operator">/</span>calc<span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>EXECUTABLE_OUTPUT_PATH $<span class="token punctuation">{<!-- --></span>HOME<span class="token punctuation">}</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token punctuation">)</span>
<span class="token function">include_directories</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>PROJECT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>include<span class="token punctuation">)</span>
<span class="token function">file</span><span class="token punctuation">(</span>GLOB SRC_LIST $<span class="token punctuation">{<!-- --></span>CMAKE_CURRENT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>src<span class="token comment">/*.cpp)
add_executable(app  ${SRC_LIST})
</span></code></pre> 
<p>其中，第<strong>六行</strong>指定就是头文件的路径，<strong>PROJECT_SOURCE_DIR</strong>宏对应的值就是我们在使用cmake命令时，后面紧跟的目录，一般是工程的根目录。</p> 
<h3><a id="26__357"></a>2.6 制作动态库或静态库</h3> 
<p>有些时候我们编写的源代码并不需要将他们编译生成可执行程序，而是生成一些静态库或动态库提供给第三方使用，下面来讲解在cmake中生成这两类库文件的方法。</p> 
<h4><a id="261__360"></a>2.6.1 制作静态库</h4> 
<p>在cmake中，如果要制作静态库，需要使用的命令如下：</p> 
<pre><code class="prism language-c"><span class="token function">add_library</span><span class="token punctuation">(</span>库名称 STATIC 源文件<span class="token number">1</span> <span class="token punctuation">[</span>源文件<span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> 
</code></pre> 
<p>根据 <strong>2.5</strong> 中的文件目录，需要将src目录中的源文件编译成静态库，然后再使用：</p> 
<p>目录结构，可以这样编写<strong>CMakeLists.txt</strong>文件:</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>CALC<span class="token punctuation">)</span>
<span class="token function">include_directories</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>PROJECT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>include<span class="token punctuation">)</span>
<span class="token function">file</span><span class="token punctuation">(</span>GLOB SRC_LIST <span class="token string">"${CMAKE_CURRENT_SOURCE_DIR}/src/*.cpp"</span><span class="token punctuation">)</span>
<span class="token function">add_library</span><span class="token punctuation">(</span>calc STATIC $<span class="token punctuation">{<!-- --></span>SRC_LIST<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>1、双击<strong>cmake-vs2019-debug.bat</strong>文件<br> 2、生成项目工程<strong>build_x64_2019</strong><br> 3、打开<strong>build_x64_2019</strong>文件下，<strong>CALC.sln</strong>文件<br> 4、重新生成解决方案<br> 5、查看生成的<strong>Debug</strong>文件，在<strong>Debug</strong>文件下有生成的静态库<strong>calc.lib</strong>。<br> <img src="https://images2.imgbox.com/b0/bb/QJ6dmpoW_o.png" alt="在这里插入图片描述"><br> 这样最终就会生成对应的静态库文件.</p> 
<h4><a id="262__384"></a>2.6.2 制作动态库</h4> 
<p>在cmake中，如果要制作动态库，需要使用的命令如下：</p> 
<pre><code class="prism language-c"><span class="token function">add_library</span><span class="token punctuation">(</span>库名称 SHARED 源文件<span class="token number">1</span> <span class="token punctuation">[</span>源文件<span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> 
</code></pre> 
<p>根据 <strong>2.5</strong> 中的文件目录，需要将src目录中的源文件编译成静态库，然后再使用：</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>CALC<span class="token punctuation">)</span>
<span class="token function">include_directories</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>PROJECT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>include<span class="token punctuation">)</span>
<span class="token function">file</span><span class="token punctuation">(</span>GLOB SRC_LIST <span class="token string">"${CMAKE_CURRENT_SOURCE_DIR}/src/*.c"</span><span class="token punctuation">)</span>
<span class="token function">add_library</span><span class="token punctuation">(</span>calc SHARED $<span class="token punctuation">{<!-- --></span>SRC_LIST<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> 
<p>1、双击<strong>cmake-vs2019-debug.bat</strong>文件<br> 2、生成项目工程<strong>build_x64_2019</strong><br> 3、打开<strong>build_x64_2019</strong>文件下，<strong>CALC.sln</strong>文件<br> 4、重新生成解决方案<br> 5、查看生成的<strong>Debug</strong>文件，在<strong>Debug</strong>文件下有生成的静态库<strong>calc.dll</strong>。</p> 
<p><img src="https://images2.imgbox.com/1c/49/IsX6poB5_o.png" alt="在这里插入图片描述"><br> 这样最终就会生成对应的动态库文件。</p> 
<h4><a id="263__409"></a>2.6.3 指定输出的路径</h4> 
<p><strong>方式1 - 适用于动态库</strong><br> 使用<strong>LIBRARY_OUTPUT_PATH</strong>，这个宏对应静态库文件和动态库文件都适用。</p> 
<p><strong>CMakeLists.txt</strong>文件如下:</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>CALC<span class="token punctuation">)</span>
<span class="token function">include_directories</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>PROJECT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>include<span class="token punctuation">)</span>
<span class="token function">file</span><span class="token punctuation">(</span>GLOB SRC_LIST <span class="token string">"${CMAKE_CURRENT_SOURCE_DIR}/src/*.c"</span><span class="token punctuation">)</span>
# 设置动态库<span class="token operator">/</span>静态库生成路径
<span class="token function">set</span><span class="token punctuation">(</span>LIBRARY_OUTPUT_PATH $<span class="token punctuation">{<!-- --></span>PROJECT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>lib<span class="token punctuation">)</span>
# 生成动态库
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">add</span><span class="token expression"><span class="token function">_library</span><span class="token punctuation">(</span>calc SHARED $<span class="token punctuation">{<!-- --></span>SRC_LIST<span class="token punctuation">}</span><span class="token punctuation">)</span></span></span>
# 生成静态库
<span class="token function">add_library</span><span class="token punctuation">(</span>calc STATIC $<span class="token punctuation">{<!-- --></span>SRC_LIST<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> 
<p>1、双击<strong>cmake-vs2019-debug.bat</strong>文件<br> 2、生成项目工程<strong>build_x64_2019</strong><br> 3、打开<strong>build_x64_2019</strong>文件下，<strong>CALC.sln</strong>文件<br> 4、重新生成解决方案<br> 5、查看生成的<strong>lib</strong>文件，在<strong>lib</strong>文件下有生成的静态库<strong>calc.lib</strong>。</p> 
<p><img src="https://images2.imgbox.com/72/1b/0u8bFi4T_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="27__435"></a>2.7 包含库文件</h3> 
<p>在编写程序的过程中，可能会用到一些系统提供的动态库或者自己制作出的动态库或者静态库文件，cmake中也为我们提供了相关的加载动态库的命令。</p> 
<h4><a id="271__438"></a>2.7.1 链接静态库</h4> 
<pre><code class="prism language-c">src
├── add<span class="token punctuation">.</span>cpp
├── div<span class="token punctuation">.</span>cpp
├── main<span class="token punctuation">.</span>cpp
├── mult<span class="token punctuation">.</span>cpp
└── sub<span class="token punctuation">.</span>cpp
</code></pre> 
<p>现在我们把上面<strong>src</strong>目录中的<strong>add.cpp、div.cpp、mult.cpp、sub.cpp</strong>编译成一个静态库文件<strong>calc.a</strong>。</p> 
<pre><code class="prism language-c">$ tree 
<span class="token punctuation">.</span>
├── build
├── CMakeLists<span class="token punctuation">.</span>txt
├── include
│   └── head<span class="token punctuation">.</span>h
├── lib
│   └── calc<span class="token punctuation">.</span>a     # 制作出的静态库的名字
└── src
    └── main<span class="token punctuation">.</span>cpp
</code></pre> 
<p>在<strong>cmake</strong>中，链接静态库的命令如下：</p> 
<pre><code class="prism language-c"><span class="token function">link_libraries</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token keyword">static</span> lib<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span><span class="token keyword">static</span> lib<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>参数1：指定出要链接的静态库的名字</li><li>参数2-N：要链接的其它静态库的名字</li></ul> 
<p>如果该静态库不是系统提供的（自己制作或者使用第三方提供的静态库）可能出现静态库找不到的情况，此时可以将静态库的路径也指定出来：</p> 
<pre><code class="prism language-c"><span class="token function">link_directories</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>lib path<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<p>这样，修改之后的CMakeLists.txt文件内容如下:</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>CALC<span class="token punctuation">)</span>
# 搜索指定目录下源文件
<span class="token function">file</span><span class="token punctuation">(</span>GLOB SRC_LIST $<span class="token punctuation">{<!-- --></span>CMAKE_CURRENT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>src<span class="token comment">/*.cpp)
# 包含头文件路径
include_directories(${PROJECT_SOURCE_DIR}/include)
# 包含静态库路径
link_directories(${PROJECT_SOURCE_DIR}/lib)
# 链接静态库
link_libraries(calc)
add_executable(app ${SRC_LIST})
</span></code></pre> 
<p>添加了第8行的代码，就可以根据参数指定的路径找到这个静态库了。</p> 
<h4><a id="272__495"></a>2.7.2 链接动态库</h4> 
<p>在cmake中链接动态库的命令如下:</p> 
<pre><code class="prism language-c"><span class="token function">target_link_libraries</span><span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>target<span class="token operator">&gt;</span> 
    <span class="token operator">&lt;</span>PRIVATE<span class="token operator">|</span>PUBLIC<span class="token operator">|</span>INTERFACE<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>item<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 
    <span class="token punctuation">[</span><span class="token operator">&lt;</span>PRIVATE<span class="token operator">|</span>PUBLIC<span class="token operator">|</span>INTERFACE<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>item<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>target：指定要加载动态库的文件的名字</li></ul> 
<p>该文件可能是一个源文件<br> 该文件可能是一个动态库文件<br> 该文件可能是一个可执行文件</p> 
<ul><li>PRIVATE|PUBLIC|INTERFACE：动态库的访问权限，默认为PUBLIC<br> 如果各个动态库之间没有依赖关系，无需做任何设置，三者没有没有区别，一般无需指定，使用默认的 PUBLIC 即可。</li></ul> 
<p><strong>动态库的链接具有传递性，如果动态库 A 链接了动态库B、C，动态库D链接了动态库A，此时动态库D相当于也链接了动态库B、C，并可以使用动态库B、C中定义的方法。</strong></p> 
<pre><code class="prism language-c"><span class="token function">target_link_libraries</span><span class="token punctuation">(</span>A B C<span class="token punctuation">)</span>
<span class="token function">target_link_libraries</span><span class="token punctuation">(</span>D A<span class="token punctuation">)</span>
</code></pre> 
<ul><li> <p>PUBLIC：在public后面的库会被Link到前面的target中，并且里面的符号也会被导出，提供给第三方使用。</p> </li><li> <p>PRIVATE：在private后面的库仅被link到前面的target中，并且终结掉，第三方不能感知你调了啥库</p> </li><li> <p>INTERFACE：在interface后面引入的库不会被链接到前面的target中，只会导出符号。</p> </li><li> <p><strong>链接系统动态库</strong></p> </li></ul> 
<p>动态库的链接和静态库是完全不同的：</p> 
<ol><li>静态库会在生成可执行程序的链接阶段被打包到可执行程序中，所以可执行程序启动，静态库就被加载到内存中了。</li><li>动态库在生成可执行程序的链接阶段不会被打包到可执行程序中，当可执行程序被启动并且调用了动态库中的函数的时候，动态库才会被加载到内存</li></ol> 
<p><strong>因此，在cmake中指定要链接的动态库的时候，应该将命令写到生成了可执行文件之后：</strong></p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>TEST<span class="token punctuation">)</span>
<span class="token function">file</span><span class="token punctuation">(</span>GLOB SRC_LIST $<span class="token punctuation">{<!-- --></span>CMAKE_CURRENT_SOURCE_DIR<span class="token punctuation">}</span><span class="token comment">/*.cpp)
# 添加并指定最终生成的可执行程序名
add_executable(app ${SRC_LIST})
# 指定可执行程序要链接的动态库名字
target_link_libraries(app pthread)
</span></code></pre> 
<p>在target_link_libraries(app pthread)中：</p> 
<p>app: 对应的是最终生成的可执行程序的名字<br> pthread：这是可执行程序要加载的动态库，这个库是系统提供的线程库.</p> 
<h4><a id="273_551"></a>2.7.3链接第三方动态库</h4> 
<p>现在，自己生成了一个动态库，对应的目录结构如下：</p> 
<pre><code class="prism language-c">$ tree 
<span class="token punctuation">.</span>
├── build
├── CMakeLists<span class="token punctuation">.</span>txt
├── include
│   └── head<span class="token punctuation">.</span>h            # 动态库对应的头文件
├── lib
│   └── calc<span class="token punctuation">.</span>dll        # 自己制作的动态库文件
└── main<span class="token punctuation">.</span>cpp              # 测试用的源文件
</code></pre> 
<p>假设在测试文件main.cpp中既使用了自己制作的动态库calc.dll又使用了系统提供的线程库，此时CMakeLists.txt文件可以这样写：</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>TEST<span class="token punctuation">)</span>
<span class="token function">file</span><span class="token punctuation">(</span>GLOB SRC_LIST $<span class="token punctuation">{<!-- --></span>CMAKE_CURRENT_SOURCE_DIR<span class="token punctuation">}</span><span class="token comment">/*.cpp)
# 指定源文件或者动态库对应的头文件路径
include_directories(${PROJECT_SOURCE_DIR}/include)
# 指定要链接的动态库的路径
link_directories(${PROJECT_SOURCE_DIR}/lib)
# 添加并生成一个可执行程序
add_executable(app ${SRC_LIST})
# 指定要链接的动态库
target_link_libraries(app pthread calc)
</span></code></pre> 
<p><strong>通过link_directories指定了动态库的路径之后，在执行生成的可执行程序的时候，就不会出现找不到动态库的问题了。</strong></p> 
<h3><a id="28_584"></a>2.8日志</h3> 
<p>在CMake中可以用用户显示一条消息，该命令的名字为message：</p> 
<pre><code class="prism language-c"><span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">[</span>STATUS<span class="token operator">|</span>WARNING<span class="token operator">|</span>AUTHOR_WARNING<span class="token operator">|</span>FATAL_ERROR<span class="token operator">|</span>SEND_ERROR<span class="token punctuation">]</span> <span class="token string">"message to display"</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>(无) ：重要消息</li><li>STATUS ：非重要消息</li><li>WARNING：CMake 警告, 会继续执行</li><li>AUTHOR_WARNING：CMake 警告 (dev), 会继续执行</li><li>SEND_ERROR：CMake 错误, 继续执行，但是会跳过生成的步骤</li><li>FATAL_ERROR：CMake 错误, 终止所有处理过程</li></ul> 
<p>CMake的命令行工具会在stdout上显示STATUS消息，在stderr上显示其他所有消息。CMake的GUI会在它的log区域显示所有消息。</p> 
<p>CMake警告和错误消息的文本显示使用的是一种简单的标记语言。文本没有缩进，超过长度的行会回卷，段落之间以新行做为分隔符。</p> 
<pre><code class="prism language-c"># 输出一般日志信息
<span class="token function">message</span><span class="token punctuation">(</span>STATUS <span class="token string">"source path: ${PROJECT_SOURCE_DIR}"</span><span class="token punctuation">)</span>
# 输出警告信息
<span class="token function">message</span><span class="token punctuation">(</span>WARNING <span class="token string">"source path: ${PROJECT_SOURCE_DIR}"</span><span class="token punctuation">)</span>
# 输出错误信息
<span class="token function">message</span><span class="token punctuation">(</span>FATAL_ERROR <span class="token string">"source path: ${PROJECT_SOURCE_DIR}"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="29__611"></a>2.9 变量操作</h3> 
<h4><a id="291__612"></a>2.9.1 追加</h4> 
<p>有时候项目中的源文件并不一定都在同一个目录中，但是这些源文件最终却需要一起进行编译来生成最终的可执行文件或者库文件。如果我们通过file命令对各个目录下的源文件进行搜索，最后还需要做一个字符串拼接的操作，关于字符串拼接可以使用set命令也可以使用list命令。</p> 
<p><strong>使用set拼接</strong><br> 如果使用set进行字符串拼接，对应的命令格式如下：</p> 
<pre><code class="prism language-c"><span class="token function">set</span><span class="token punctuation">(</span>变量名<span class="token number">1</span> $<span class="token punctuation">{<!-- --></span>变量名<span class="token number">1</span><span class="token punctuation">}</span> $<span class="token punctuation">{<!-- --></span>变量名<span class="token number">2</span><span class="token punctuation">}</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre> 
<p>关于上面的命令其实就是将从<strong>第二个参数</strong>开始往后所有的字符串进行拼接，最后将结果存储到<strong>第一个参数</strong>中，如果第一个参数中原来有数据会对原数据就行覆盖。</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>TEST<span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>TEMP <span class="token string">"hello,world"</span><span class="token punctuation">)</span>
<span class="token function">file</span><span class="token punctuation">(</span>GLOB SRC_1 $<span class="token punctuation">{<!-- --></span>PROJECT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>src1<span class="token comment">/*.cpp)
file(GLOB SRC_2 ${PROJECT_SOURCE_DIR}/src2/*.cpp)
# 追加(拼接)
set(SRC_1 ${SRC_1} ${SRC_2} ${TEMP})
message(STATUS "message: ${SRC_1}")
</span></code></pre> 
<p><strong>使用list拼接</strong><br> 如果使用list进行字符串拼接，对应的命令格式如下：</p> 
<pre><code class="prism language-c"><span class="token function">list</span><span class="token punctuation">(</span>APPEND <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>element<span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>list命令的功能比set要强大，字符串拼接只是它的其中一个功能，所以需要在它第一个参数的位置指定出我们要做的操作，<strong>APPEND</strong>表示进行数据追加，后边的参数和set就一样了。</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>TEST<span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>TEMP <span class="token string">"hello,world"</span><span class="token punctuation">)</span>
<span class="token function">file</span><span class="token punctuation">(</span>GLOB SRC_1 $<span class="token punctuation">{<!-- --></span>PROJECT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>src1<span class="token comment">/*.cpp)
file(GLOB SRC_2 ${PROJECT_SOURCE_DIR}/src2/*.cpp)
# 追加(拼接)
list(APPEND SRC_1 ${SRC_1} ${SRC_2} ${TEMP})
message(STATUS "message: ${SRC_1}")
</span></code></pre> 
<p>在CMake中，使用set命令可以创建一个list。一个在list内部是一个由分号 ; 分割的一组字符串。<strong>例如，set(var a b c d e)命令将会创建一个list:a;b;c;d;e，但是最终打印变量值的时候得到的是abcde</strong>。</p> 
<pre><code class="prism language-c"><span class="token function">set</span><span class="token punctuation">(</span>tmp1 a<span class="token punctuation">;</span>b<span class="token punctuation">;</span>c<span class="token punctuation">;</span>d<span class="token punctuation">;</span>e<span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>tmp2 a b c d e<span class="token punctuation">)</span>
<span class="token function">message</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>tmp1<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">message</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>tmp2<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出的结果:</p> 
<pre><code class="prism language-c">abcde
abcde
</code></pre> 
<h4><a id="292__667"></a>2.9.2 字符串移除</h4> 
<p>我们在通过file搜索某个目录就得到了该目录下所有的源文件，但是其中有些源文件并不是我们所需要的，比如：</p> 
<pre><code class="prism language-c">$ tree
<span class="token punctuation">.</span>
├── add<span class="token punctuation">.</span>cpp
├── div<span class="token punctuation">.</span>cpp
├── main<span class="token punctuation">.</span>cpp
├── mult<span class="token punctuation">.</span>cpp
└── sub<span class="token punctuation">.</span>cpp
</code></pre> 
<p>在当前这么目录有五个源文件，其中<strong>main.cpp</strong>是一个测试文件。如果我们想要把计算器相关的源文件生成一个动态库给别人使用，那么只需要<strong>add.cpp、div.cpp、mult.cpp、sub.cpp</strong>这四个源文件就可以了。此时，就需要将<strong>main.cpp</strong>从搜索到的数据中剔除出去，想要实现这个功能，也可以使用<strong>list</strong></p> 
<pre><code class="prism language-c"><span class="token function">list</span><span class="token punctuation">(</span>REMOVE_ITEM <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>value<span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>通过上面的命令原型可以看到删除和追加数据类似，只不过是第一个参数变成了REMOVE_ITEM。</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>TEST<span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>TEMP <span class="token string">"hello,world"</span><span class="token punctuation">)</span>
<span class="token function">file</span><span class="token punctuation">(</span>GLOB SRC_1 $<span class="token punctuation">{<!-- --></span>PROJECT_SOURCE_DIR<span class="token punctuation">}</span><span class="token comment">/*.cpp)
# 移除前日志
message(STATUS "message: ${SRC_1}")
# 移除 main.cpp
list(REMOVE_ITEM SRC_1 ${PROJECT_SOURCE_DIR}/main.cpp)
# 移除后日志
message(STATUS "message: ${SRC_1}")
</span></code></pre> 
<p>可以看到，在第8行把将要移除的文件的名字指定给list就可以了。但是一定要注意通过 file 命令搜索源文件的时候<strong>得到的是文件的绝对路径</strong>（<strong>在list中每个文件对应的路径都是一个item，并且都是绝对路径</strong>），那么在移除的时候也要将该文件的绝对路径指定出来才可以，否是移除操作不会成功。</p> 
<h4><a id="293list_700"></a>2.9.3list命令其它功能</h4> 
<ol><li>获取 list 的长度。</li></ol> 
<pre><code class="prism language-c"><span class="token function">list</span><span class="token punctuation">(</span>LENGTH <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>output variable<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>LENGTH：子命令LENGTH用于读取列表长度</li><li>list：当前操作的列表</li><li>output variable：新创建的变量，用于存储列表的长度。</li></ul> 
<ol start="2"><li>读取列表中指定索引的元素，可以指定多个索引</li></ol> 
<pre><code class="prism language-c"><span class="token function">list</span><span class="token punctuation">(</span>GET <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>element index<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>element index<span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span>output variable<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>list：当前操作的列表</li><li>element index：列表元素的索引</li></ul> 
<p>从0开始编号，索引0的元素为列表中的第一个元素；<br> 索引也可以是负数，-1表示列表的最后一个元素，-2表示列表倒数第二个元素，以此类推<br> 当索引（不管是正还是负）超过列表的长度，运行会报错</p> 
<ul><li>output variable：新创建的变量，存储指定索引元素的返回结果，也是一个列表。</li></ul> 
<ol start="3"><li>将列表中的元素用连接符（字符串）连接起来组成一个字符串</li></ol> 
<pre><code class="prism language-c"><span class="token function">list</span> <span class="token punctuation">(</span>JOIN <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>glue<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>output variable<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<p>list：当前操作的列表<br> glue：指定的连接符（字符串）<br> output variable：新创建的变量，存储返回的字符串</p> 
<ol start="4"><li>查找列表是否存在指定的元素，若果未找到，返回-1</li></ol> 
<pre><code class="prism language-c"><span class="token function">list</span><span class="token punctuation">(</span>FIND <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>output variable<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<p>list：当前操作的列表<br> value：需要再列表中搜索的元素<br> output variable：新创建的变量<br> 如果列表list中存在value，那么返回value在列表中的索引<br> 如果未找到则返回-1。</p> 
<ol start="5"><li>将元素追加到列表中</li></ol> 
<pre><code class="prism language-c"><span class="token function">list</span> <span class="token punctuation">(</span>APPEND <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>element<span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="6"><li>在list中指定的位置插入若干元素</li></ol> 
<pre><code class="prism language-c"><span class="token function">list</span><span class="token punctuation">(</span>INSERT <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>element_index<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>element<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>element<span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="7"><li>将元素插入到列表的0索引位置</li></ol> 
<pre><code class="prism language-c"><span class="token function">list</span> <span class="token punctuation">(</span>PREPEND <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>element<span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="8"><li>将列表中最后元素移除</li></ol> 
<pre><code class="prism language-c"><span class="token function">list</span> <span class="token punctuation">(</span>POP_BACK <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>out<span class="token operator">-</span>var<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="9"><li>将列表中第一个元素移除</li></ol> 
<pre><code class="prism language-c"><span class="token function">list</span> <span class="token punctuation">(</span>POP_FRONT <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>out<span class="token operator">-</span>var<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="10"><li>将指定的元素从列表中移除</li></ol> 
<pre><code class="prism language-c"><span class="token function">list</span> <span class="token punctuation">(</span>REMOVE_ITEM <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>value<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>value<span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="11"><li>将指定索引的元素从列表中移除</li></ol> 
<pre><code class="prism language-c"><span class="token function">list</span> <span class="token punctuation">(</span>REMOVE_AT <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>index<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>index<span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="12"><li>移除列表中的重复元素</li></ol> 
<pre><code class="prism language-c"><span class="token function">list</span> <span class="token punctuation">(</span>REMOVE_DUPLICATES <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="13"><li>列表翻转</li></ol> 
<pre><code class="prism language-c"><span class="token function">list</span><span class="token punctuation">(</span>REVERSE <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<ol start="14"><li>列表排序</li></ol> 
<pre><code class="prism language-c"><span class="token function">list</span> <span class="token punctuation">(</span>SORT <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> <span class="token punctuation">[</span>COMPARE <span class="token operator">&lt;</span>compare<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>CASE <span class="token operator">&lt;</span><span class="token keyword">case</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>ORDER <span class="token operator">&lt;</span>order<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>COMPARE：指定排序方法。有如下几种值可选：</li></ul> 
<p>STRING:按照字母顺序进行排序，为默认的排序方法<br> FILE_BASENAME：如果是一系列路径名，会使用basename进行排序<br> NATURAL：使用自然数顺序排序</p> 
<ul><li>CASE：指明是否大小写敏感。有如下几种值可选：</li></ul> 
<p>SENSITIVE: 按照大小写敏感的方式进行排序，为默认值<br> INSENSITIVE：按照大小写不敏感方式进行排序</p> 
<ul><li>ORDER：指明排序的顺序。有如下几种值可选：</li></ul> 
<p>ASCENDING:按照升序排列，为默认值<br> DESCENDING：按照降序排列</p> 
<h3><a id="29__820"></a>2.9 宏定义</h3> 
<p>在进行程序测试的时候，我们可以在代码中添加一些宏定义，通过这些宏来控制这些代码是否生效，如下所示：</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NUMBER</span>  <span class="token expression"><span class="token number">3</span></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">DEBUG</span></span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"我是一个程序猿, 我不会爬树...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>NUMBER<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"hello, GCC!!!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>在程序的第七行对DEBUG宏进行了判断，如果该宏被定义了，那么第八行就会进行日志输出，如果没有定义这个宏，第八行就相当于被注释掉了，因此最终无法看到日志输入出（上述代码中并没有定义这个宏）。</p> 
<p>在CMake中，对应的命令叫做add_definitions:</p> 
<pre><code class="prism language-c"><span class="token function">add_definitions</span><span class="token punctuation">(</span><span class="token operator">-</span>D宏名称<span class="token punctuation">)</span>
</code></pre> 
<p>针对于上面的源文件编写一个CMakeLists.txt，内容如下：</p> 
<pre><code class="prism language-cpp"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>TEST<span class="token punctuation">)</span>
# 自定义 DEBUG 宏
<span class="token function">add_definitions</span><span class="token punctuation">(</span><span class="token operator">-</span>DDEBUG<span class="token punctuation">)</span>
<span class="token function">add_executable</span><span class="token punctuation">(</span>app <span class="token punctuation">.</span><span class="token operator">/</span>test<span class="token punctuation">.</span>c<span class="token punctuation">)</span>
</code></pre> 
<p>通过这种方式，上述代码中的第八行日志就能够被输出出来了。</p> 
<h2><a id="3__858"></a>3. 预定义宏</h2> 
<p>下面的列表中为大家整理了一些CMake中常用的宏：<br> <img src="https://images2.imgbox.com/76/59/k1cQIgsx_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="4_CMake_861"></a>4. 嵌套的CMake</h2> 
<p>如果项目很大，或者项目中有很多的源码目录，在通过CMake管理项目的时候如果只使用一个CMakeLists.txt，那么这个文件相对会比较复杂，有一种化繁为简的方式就是给每个源码目录都添加一个CMakeLists.txt文件（头文件目录不需要），这样每个文件都不会太复杂，而且更灵活，更容易维护。</p> 
<p>先来看一下下面的这个的目录结构：</p> 
<pre><code class="prism language-c">$ tree
<span class="token punctuation">.</span>
├── build
├── calc
│   ├── add<span class="token punctuation">.</span>cpp
│   ├── CMakeLists<span class="token punctuation">.</span>txt
│   ├── div<span class="token punctuation">.</span>cpp
│   ├── mult<span class="token punctuation">.</span>cpp
│   └── sub<span class="token punctuation">.</span>cpp
├── CMakeLists<span class="token punctuation">.</span>txt
├── include
│   ├── calc<span class="token punctuation">.</span>h
│   └── sort<span class="token punctuation">.</span>h
├── sort
│   ├── CMakeLists<span class="token punctuation">.</span>txt
│   ├── insert<span class="token punctuation">.</span>cpp
│   └── select<span class="token punctuation">.</span>cpp
├── test1
│   ├── calc<span class="token punctuation">.</span>cpp
│   └── CMakeLists<span class="token punctuation">.</span>txt
└── test2
    ├── CMakeLists<span class="token punctuation">.</span>txt
    └── sort<span class="token punctuation">.</span>cpp

</code></pre> 
<p><strong>include</strong> 目录：头文件目录<br> <strong>calc</strong> 目录：目录中的四个源文件对应的加、减、乘、除算法<br> 对应的头文件是include中的calc.h<br> <strong>sort</strong> 目录 ：目录中的两个源文件对应的是插入排序和选择排序算法<br> 对应的头文件是include中的sort.h<br> <strong>test1</strong> 目录：测试目录，对加、减、乘、除算法进行测试<br> <strong>test2</strong> 目录：测试目录，对排序算法进行测试<br> 可以看到各个源文件目录所需要的CMakeLists.txt文件现在已经添加完毕了。接下来庖丁解牛，我们依次分析一下各个文件中需要添加的内容。</p> 
<h3><a id="41__900"></a>4.1 准备工作</h3> 
<h4><a id="411__901"></a>4.1.1 节点关系</h4> 
<p>CMake 是一个树状结构，最顶层的 CMakeLists.txt 是根节点，其次都是子节点。因此，我们需要了解一些关于 CMakeLists.txt 文件变量作用域的一些信息：</p> 
<ul><li>根节点CMakeLists.txt中的变量全局有效</li><li>父节点CMakeLists.txt中的变量可以在子节点中使用</li><li>子节点CMakeLists.txt中的变量只能在当前节点中使用</li></ul> 
<h4><a id="412__907"></a>4.1.2 添加子目录</h4> 
<p>接下来我们还需要知道在 CMake 中父子节点之间的关系是如何建立的，这里需要用到一个 CMake 命令：</p> 
<pre><code class="prism language-c"><span class="token function">add_subdirectory</span><span class="token punctuation">(</span>source_dir <span class="token punctuation">[</span>binary_dir<span class="token punctuation">]</span> <span class="token punctuation">[</span>EXCLUDE_FROM_ALL<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>source_dir：指定了CMakeLists.txt源文件和代码文件的位置，其实就是指定子目录</li><li>binary_dir：指定了输出文件的路径，一般不需要指定，忽略即可。</li><li>EXCLUDE_FROM_ALL：在子路径下的目标默认不会被包含到父路径的ALL目标里，并且也会被排除在IDE工程文件之外。用户必须显式构建在子路径下的目标。</li></ul> 
<p>通过这种方式CMakeLists.txt文件之间的父子关系就被构建出来了。</p> 
<h3><a id="42__920"></a>4.2 解决问题</h3> 
<p>在上面的目录中我们要做如下事情：</p> 
<ul><li>通过 test1 目录中的测试文件进行计算器相关的测试</li><li>通过 test2 目录中的测试文件进行排序相关的测试</li></ul> 
<p>现在相当于是要进行模块化测试，对于<strong>calc</strong>和<strong>sort</strong>目录中的源文件来说，可以将它们先编译成库文件（可以是静态库也可以是动态库）然后在提供给测试文件使用即可。库文件的本质其实还是代码，只不过是从文本格式变成了二进制格式。</p> 
<h4><a id="421__929"></a>4.2.1 根目录</h4> 
<p>根目录中的 CMakeLists.txt文件内容如下：</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span>
# 定义变量
# 静态库生成的路径
<span class="token function">set</span><span class="token punctuation">(</span>LIB_PATH $<span class="token punctuation">{<!-- --></span>CMAKE_CURRENT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>lib<span class="token punctuation">)</span>
# 测试程序生成的路径
<span class="token function">set</span><span class="token punctuation">(</span>EXEC_PATH $<span class="token punctuation">{<!-- --></span>CMAKE_CURRENT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>bin<span class="token punctuation">)</span>
# 头文件目录
<span class="token function">set</span><span class="token punctuation">(</span>HEAD_PATH $<span class="token punctuation">{<!-- --></span>CMAKE_CURRENT_SOURCE_DIR<span class="token punctuation">}</span><span class="token operator">/</span>include<span class="token punctuation">)</span>
# 静态库的名字
<span class="token function">set</span><span class="token punctuation">(</span>CALC_LIB calc<span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>SORT_LIB sort<span class="token punctuation">)</span>
# 可执行程序的名字
<span class="token function">set</span><span class="token punctuation">(</span>APP_NAME_1 test1<span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>APP_NAME_2 test2<span class="token punctuation">)</span>
# 添加子目录
<span class="token function">add_subdirectory</span><span class="token punctuation">(</span>calc<span class="token punctuation">)</span>
<span class="token function">add_subdirectory</span><span class="token punctuation">(</span>sort<span class="token punctuation">)</span>
<span class="token function">add_subdirectory</span><span class="token punctuation">(</span>test1<span class="token punctuation">)</span>
<span class="token function">add_subdirectory</span><span class="token punctuation">(</span>test2<span class="token punctuation">)</span>

</code></pre> 
<p><strong>在根节点对应的文件中主要做了两件事情：定义全局变量和添加子目录。</strong></p> 
<ul><li>定义的全局变量主要是给子节点使用，目的是为了提高子节点中的CMakeLists.txt文件的可读性和可维护性，避免冗余并降低出差的概率。</li><li>一共添加了四个子目录，每个子目录中都有一个CMakeLists.txt文件，这样它们的父子关系就被确定下来了。</li></ul> 
<h4><a id="422_calc__962"></a>4.2.2 calc 目录</h4> 
<p>calc 目录中的 CMakeLists.txt文件内容如下：</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>CALCLIB<span class="token punctuation">)</span>
<span class="token function">aux_source_directory</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">/</span> SRC<span class="token punctuation">)</span>
<span class="token function">include_directories</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>HEAD_PATH<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>LIBRARY_OUTPUT_PATH $<span class="token punctuation">{<!-- --></span>LIB_PATH<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">add_library</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>CALC_LIB<span class="token punctuation">}</span> STATIC $<span class="token punctuation">{<!-- --></span>SRC<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> 
<p><strong>第3行aux_source_directory：搜索当前目录（calc目录）下的所有源文件<br> 第4行include_directories：包含头文件路径，HEAD_PATH是在根节点文件中定义的<br> 第5行set：设置库的生成的路径，LIB_PATH是在根节点文件中定义的<br> 第6行add_library：生成静态库，静态库名字CALC_LIB是在根节点文件中定义的</strong></p> 
<h4><a id="423_sort__979"></a>4.2.3 sort 目录</h4> 
<p>sort 目录中的 CMakeLists.txt文件内容如下：</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>SORTLIB<span class="token punctuation">)</span>
<span class="token function">aux_source_directory</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">/</span> SRC<span class="token punctuation">)</span>
<span class="token function">include_directories</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>HEAD_PATH<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>LIBRARY_OUTPUT_PATH $<span class="token punctuation">{<!-- --></span>LIB_PATH<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">add_library</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>SORT_LIB<span class="token punctuation">}</span> SHARED $<span class="token punctuation">{<!-- --></span>SRC<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> 
<p><strong>第6行add_library：生成动态库，动态库名字SORT_LIB是在根节点文件中定义的</strong><br> 这个文件中的内容和calc节点文件中的内容类似，只不过这次生成的是动态库。</p> 
<p>建议：在生成库文件的时候，这个库可以是静态库也可以是动态库，一般需要根据实际情况来确定。如果生成的库比较大，建议将其制作成动态库。</p> 
<h4><a id="424_test1__996"></a>4.2.4 test1 目录</h4> 
<pre><code class="prism language-c">test1 目录中的 CMakeLists<span class="token punctuation">.</span>txt文件内容如下：
<span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>CALCTEST<span class="token punctuation">)</span>
<span class="token function">aux_source_directory</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">/</span> SRC<span class="token punctuation">)</span>
<span class="token function">include_directories</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>HEAD_PATH<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">link_directories</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>LIB_PATH<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">link_libraries</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>CALC_LIB<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>EXECUTABLE_OUTPUT_PATH $<span class="token punctuation">{<!-- --></span>EXEC_PATH<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">add_executable</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>APP_NAME_1<span class="token punctuation">}</span> $<span class="token punctuation">{<!-- --></span>SRC<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>第4行include_directories：指定头文件路径，HEAD_PATH变量是在根节点文件中定义的<br> 第6行link_libraries：指定可执行程序要链接的静态库，CALC_LIB变量是在根节点文件中定义的<br> 第7行set：指定可执行程序生成的路径，EXEC_PATH变量是在根节点文件中定义的<br> 第8行add_executable：生成可执行程序，APP_NAME_1变量是在根节点文件中定义的</strong></p> 
<p><strong>此处的可执行程序链接的是静态库，最终静态库会被打包到可执行程序中，可执行程序启动之后，静态库也就随之被加载到内存中了。</strong></p> 
<h4><a id="425_test2__1017"></a>4.2.5 test2 目录</h4> 
<p>test2 目录中的 CMakeLists.txt文件内容如下：</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>SORTTEST<span class="token punctuation">)</span>
<span class="token function">aux_source_directory</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">/</span> SRC<span class="token punctuation">)</span>
<span class="token function">include_directories</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>HEAD_PATH<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>EXECUTABLE_OUTPUT_PATH $<span class="token punctuation">{<!-- --></span>EXEC_PATH<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">link_directories</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>LIB_PATH<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">add_executable</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>APP_NAME_2<span class="token punctuation">}</span> $<span class="token punctuation">{<!-- --></span>SRC<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">target_link_libraries</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>APP_NAME_2<span class="token punctuation">}</span> $<span class="token punctuation">{<!-- --></span>SORT_LIB<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>第四行include_directories：包含头文件路径，HEAD_PATH变量是在根节点文件中定义的<br> 第五行set：指定可执行程序生成的路径，EXEC_PATH变量是在根节点文件中定义的<br> 第六行link_directories：指定可执行程序要链接的动态库的路径，LIB_PATH变量是在根节点文件中定义的<br> 第七行add_executable：生成可执行程序，APP_NAME_2变量是在根节点文件中定义的<br> 第八行target_link_libraries：指定可执行程序要链接的动态库的名字</strong></p> 
<p><mark>在生成可执行程序的时候，动态库不会被打包到可执行程序内部。当可执行程序启动之后动态库也不会被加载到内存，只有可执行程序调用了动态库中的函数的时候，动态库才会被加载到内存中，且多个进程可以共用内存中的同一个动态库，所以动态库又叫共享库</mark>。</p> 
<h4><a id="426__1039"></a>4.2.6 构建项目</h4> 
<p>一切准备就绪之后，开始构建项目，双击<strong>cmake-vs2019-debug.bat</strong>，如下：<br> 可以得到如下信息：</p> 
<ul><li>在项目根目录的lib目录中生成了静态库libcalc.a</li><li>在项目根目录的lib目录中生成了动态库libsort.so</li><li>在项目根目录的bin目录中生成了可执行程序test1</li><li>在项目根目录的bin目录中生成了可执行程序test2</li></ul> 
<h2><a id="5__1048"></a>5. 流程控制</h2> 
<p>在 CMake 的 CMakeLists.txt 中也可以进行流程控制，也就是说可以像写 shell 脚本那样进行条件判断和循环。</p> 
<h3><a id="51__1050"></a>5.1 条件判断</h3> 
<p>关于条件判断其语法格式如下：</p> 
<pre><code class="prism language-c"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>condition<span class="token operator">&gt;</span><span class="token punctuation">)</span>
  <span class="token operator">&lt;</span>commands<span class="token operator">&gt;</span>
<span class="token function">elseif</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>condition<span class="token operator">&gt;</span><span class="token punctuation">)</span> # 可选快<span class="token punctuation">,</span> 可以重复
  <span class="token operator">&lt;</span>commands<span class="token operator">&gt;</span>
<span class="token keyword">else</span><span class="token punctuation">(</span><span class="token punctuation">)</span>              # 可选快
  <span class="token operator">&lt;</span>commands<span class="token operator">&gt;</span>
<span class="token function">endif</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>在进行条件判断的时候，如果有多个条件，那么可以写多个elseif，最后一个条件可以使用else，但是开始和结束是必须要成对出现的，分别为：<strong>if 和 endif</strong>。</p> 
<h4><a id="511__1064"></a>5.1.1 基本表达式</h4> 
<pre><code class="prism language-c"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>expression<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<p>如果是基本表达式，expression 有以下三种情况：常量、变量、字符串。</p> 
<ul><li>如果是1, ON, YES, TRUE, Y, 非零值，非空字符串时，条件判断返回True</li><li>如果是 0, OFF, NO, FALSE, N, IGNORE, NOTFOUND，空字符串时，条件判断返回False</li></ul> 
<h4><a id="512__1075"></a>5.1.2 逻辑判断</h4> 
<ul><li>NOT</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>NOT <span class="token operator">&lt;</span>condition<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<p>其实这就是一个取反操作，如果条件<strong>condition为True将返回False，如果条件condition为False将返回True</strong>。</p> 
<ul><li>AND</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>cond1<span class="token operator">&gt;</span> AND <span class="token operator">&lt;</span>cond2<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<p>如果<strong>cond1和cond2同时为True，返回True否则返回False</strong>。</p> 
<ul><li>OR</li></ul> 
<pre><code class="prism language-c"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>cond1<span class="token operator">&gt;</span> OR <span class="token operator">&lt;</span>cond2<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<p>如果<strong>cond1和cond2两个条件中至少有一个为True，返回True，如果两个条件都为False则返回False</strong>。</p> 
<h4><a id="513__1099"></a>5.1.3 比较</h4> 
<p><strong>基于数值的比较</strong></p> 
<pre><code class="prism language-c"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span> LESS <span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span> GREATER <span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span> EQUAL <span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span> LESS_EQUAL <span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span> GREATER_EQUAL <span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span><span class="token punctuation">)</span>

</code></pre> 
<ul><li>LESS：如果左侧数值小于右侧，返回True</li><li>GREATER：如果左侧数值大于右侧，返回True</li><li>EQUAL：如果左侧数值等于右侧，返回True</li><li>LESS_EQUAL：如果左侧数值小于等于右侧，返回True</li><li>GREATER_EQUAL：如果左侧数值大于等于右侧，返回True</li></ul> 
<p><strong>基于字符串的比较</strong></p> 
<pre><code class="prism language-c"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span> STRLESS <span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span> STRGREATER <span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span> STREQUAL <span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span> STRLESS_EQUAL <span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span> STRGREATER_EQUAL <span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span><span class="token punctuation">)</span>

</code></pre> 
<ul><li>STRLESS：如果左侧字符串小于右侧，返回True</li><li>STRGREATER：如果左侧字符串大于右侧，返回True</li><li>STREQUAL：如果左侧字符串等于右侧，返回True</li><li>STRLESS_EQUAL：如果左侧字符串小于等于右侧，返回True</li><li>STRGREATER_EQUAL：如果左侧字符串大于等于右侧，返回True</li></ul> 
<h4><a id="514__1134"></a>5.1.4 文件操作</h4> 
<ol><li>判断文件或者目录是否存在</li></ol> 
<pre><code class="prism language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>EXISTS path<span class="token operator">-</span>to<span class="token operator">-</span>file<span class="token operator">-</span>or<span class="token operator">-</span>directory<span class="token punctuation">)</span>
</code></pre> 
<p>如果文件或者目录存在返回True，否则返回False。</p> 
<ol start="2"><li>判断是不是目录</li></ol> 
<pre><code class="prism language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>IS_DIRECTORY path<span class="token punctuation">)</span>
</code></pre> 
<ul><li>此处目录的 path 必须是绝对路径</li><li>如果目录存在返回True，目录不存在返回False。</li></ul> 
<ol start="3"><li>判断是不是软连接</li></ol> 
<pre><code class="prism language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>IS_SYMLINK file<span class="token operator">-</span>name<span class="token punctuation">)</span>
</code></pre> 
<ul><li>此处的 file-name 对应的路径必须是绝对路径</li><li>如果软链接存在返回True，软链接不存在返回False。</li><li>软链接相当于 Windows 里的快捷方式</li></ul> 
<ol start="4"><li>判断是不是绝对路径</li></ol> 
<pre><code class="prism language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>IS_ABSOLUTE path<span class="token punctuation">)</span>
</code></pre> 
<ul><li>关于绝对路径:</li></ul> 
<p>如果是Linux，该路径需要从根目录开始描述<br> 如果是Windows，该路径需要从盘符开始描述</p> 
<ul><li>如果是绝对路径返回True，如果不是绝对路径返回False。</li></ul> 
<h4><a id="515__1176"></a>5.1.5 其它</h4> 
<p><strong>判断某个元素是否在列表中</strong></p> 
<pre><code class="prism language-c"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span> IN_LIST <span class="token operator">&lt;</span>variable<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>CMake 版本要求：大于等于3.3</li><li>如果这个元素在列表中返回True，否则返回False。</li></ul> 
<p><strong>比较两个路径是否相等</strong></p> 
<pre><code class="prism language-c"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span> PATH_EQUAL <span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>CMake 版本要求：大于等于3.24</strong><br> <strong>如果这个元素在列表中返回True，否则返回False。</strong></p> 
<p>关于路径的比较其实就是另个字符串的比较，如果路径格式书写没有问题也可以通过下面这种方式进行比较：</p> 
<pre><code class="prism language-c"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span> STREQUAL <span class="token operator">&lt;</span>variable<span class="token operator">|</span>string<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<p>我们在书写某个路径的时候，可能由于误操作会多写几个分隔符，比如把/a/b/c写成/a//b///c，此时通过STREQUAL对这两个字符串进行比较肯定是不相等的，但是通过PATH_EQUAL去比较两个路径，得到的结果确实相等的，可以看下面的例子：</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.26</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"/home//robin///Linux"</span> PATH_EQUAL <span class="token string">"/home/robin/Linux"</span><span class="token punctuation">)</span>
    <span class="token function">message</span><span class="token punctuation">(</span><span class="token string">"路径相等"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">message</span><span class="token punctuation">(</span><span class="token string">"路径不相等"</span><span class="token punctuation">)</span>
<span class="token function">endif</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">message</span><span class="token punctuation">(</span>STATUS <span class="token string">"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"/home//robin///Linux"</span> STREQUAL <span class="token string">"/home/robin/Linux"</span><span class="token punctuation">)</span>
    <span class="token function">message</span><span class="token punctuation">(</span><span class="token string">"路径相等"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">message</span><span class="token punctuation">(</span><span class="token string">"路径不相等"</span><span class="token punctuation">)</span>
<span class="token function">endif</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>输出的日志信息如下:</p> 
<pre><code class="prism language-c">路径相等
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
路径不相等
</code></pre> 
<p>通过得到的结果我们可以得到一个结论：在进行路径比较的时候，如果使用 PATH_EQUAL 可以自动剔除路径中多余的分割线然后再进行路径的对比，使用 STREQUAL 则只能进行字符串比较。</p> 
<h3><a id="52__1230"></a>5.2 循环</h3> 
<p>在 CMake 中循环有两种方式，分别是：<strong>foreach 和 while</strong>。</p> 
<h4><a id="521_foreach_1232"></a>5.2.1 foreach</h4> 
<p>使用 <strong>foreach</strong> 进行循环，语法格式如下：</p> 
<pre><code class="prism language-c"><span class="token function">foreach</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>loop_var<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>items<span class="token operator">&gt;</span><span class="token punctuation">)</span>
    <span class="token operator">&lt;</span>commands<span class="token operator">&gt;</span>
<span class="token function">endforeach</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>通过<strong>foreach</strong>我们就可以对<strong>items</strong>中的数据进行遍历，然后通过<strong>loop_var</strong>将遍历到的当前的值取出，在取值的时候有以下几种用法：</p> 
<p><strong>方法1</strong></p> 
<pre><code class="prism language-c"><span class="token function">foreach</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>loop_var<span class="token operator">&gt;</span> RANGE <span class="token operator">&lt;</span>stop<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>RANGE：关键字，表示要遍历范围</li><li>stop：这是一个正整数，表示范围的结束值，在遍历的时候从 0 开始，最大值为 stop。</li><li>loop_var：存储每次循环取出的值</li></ul> 
<p><strong>举例说明：</strong></p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.2</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span>
# 循环
<span class="token function">foreach</span><span class="token punctuation">(</span>item RANGE <span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token function">message</span><span class="token punctuation">(</span>STATUS <span class="token string">"当前遍历的值为: ${item}"</span> <span class="token punctuation">)</span>
<span class="token function">endforeach</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>输出的日志信息是这样的：</p> 
<pre><code class="prism language-c"><span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">0</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">1</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">2</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">3</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">4</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">5</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">6</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">7</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">8</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">9</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">10</span>
</code></pre> 
<p>再次强调：在对一个整数区间进行遍历的时候，得到的范围是这样的 <strong>【0，stop】</strong>，右侧是闭区间包含 stop 这个值。</p> 
<p><strong>方法2</strong></p> 
<pre><code class="prism language-c"><span class="token function">foreach</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>loop_var<span class="token operator">&gt;</span> RANGE <span class="token operator">&lt;</span>start<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>stop<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>step<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>这是上面方法1的加强版，我们在遍历一个整数区间的时候，除了可以指定起始范围，还可以指定步长。</strong></p> 
<ul><li>RANGE：关键字，表示要遍历范围</li><li>start：这是一个正整数，表示范围的起始值，也就是说最小值为 start</li><li>stop：这是一个正整数，表示范围的结束值，也就是说最大值为 stop</li><li>step：控制每次遍历的时候以怎样的步长增长，默认为1，可以不设置</li><li>loop_var：存储每次循环取出的值</li></ul> 
<p>举例说明：</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.2</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span>

<span class="token function">foreach</span><span class="token punctuation">(</span>item RANGE <span class="token number">10</span> <span class="token number">30</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">message</span><span class="token punctuation">(</span>STATUS <span class="token string">"当前遍历的值为: ${item}"</span> <span class="token punctuation">)</span>
<span class="token function">endforeach</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出的结果如下:</p> 
<pre><code class="prism language-c"><span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">10</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">12</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">14</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">16</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">18</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">20</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">22</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">24</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">26</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">28</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> <span class="token number">30</span>
</code></pre> 
<p>再次强调：在使用上面的方式对一个整数区间进行遍历的时候，得到的范围是这样的 【start，stop】，左右两侧都是闭区间，包含 start 和 stop 这两个值，步长 step 默认为1，可以不设置。</p> 
<p><strong>方法3</strong></p> 
<pre><code class="prism language-c"><span class="token function">foreach</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>loop_var<span class="token operator">&gt;</span> IN <span class="token punctuation">[</span>LISTS <span class="token punctuation">[</span><span class="token operator">&lt;</span>lists<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>ITEMS <span class="token punctuation">[</span><span class="token operator">&lt;</span>items<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>这是foreach的另一个变体，通过这种方式我们可以对更加复杂的数据进行遍历，前两种方式只适用于对某个正整数范围内的遍历。</p> 
<ul><li>IN：关键字，表示在 xxx 里边</li><li>LISTS：关键字，对应的是列表list，通过set、list可以获得</li><li>ITEMS：关键字，对应的也是列表</li><li>loop_var：存储每次循环取出的值</li></ul> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.2</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span>
# 创建 list
<span class="token function">set</span><span class="token punctuation">(</span>WORD a b c d<span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>NAME ace sabo luffy<span class="token punctuation">)</span>
# 遍历 list
<span class="token function">foreach</span><span class="token punctuation">(</span>item IN LISTS WORD NAME<span class="token punctuation">)</span>
    <span class="token function">message</span><span class="token punctuation">(</span>STATUS <span class="token string">"当前遍历的值为: ${item}"</span> <span class="token punctuation">)</span>
<span class="token function">endforeach</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>在上面的例子中，创建了两个 list 列表，在遍历的时候对它们两个都进行了遍历（可以根据实际需求选择同时遍历多个或者只遍历一个）。输出的日志信息如下：</p> 
<pre><code class="prism language-c"><span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> a
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> b
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> c
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> d
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> ace
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> sabo
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> luffy
</code></pre> 
<p>一共输出了7个字符串，说明遍历是没有问题的。接下来看另外一种方式：</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.2</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span>

<span class="token function">set</span><span class="token punctuation">(</span>WORD a b c <span class="token string">"d e f"</span><span class="token punctuation">)</span>
<span class="token function">set</span><span class="token punctuation">(</span>NAME ace sabo luffy<span class="token punctuation">)</span>
<span class="token function">foreach</span><span class="token punctuation">(</span>item IN ITEMS $<span class="token punctuation">{<!-- --></span>WORD<span class="token punctuation">}</span> $<span class="token punctuation">{<!-- --></span>NAME<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">message</span><span class="token punctuation">(</span>STATUS <span class="token string">"当前遍历的值为: ${item}"</span> <span class="token punctuation">)</span>
<span class="token function">endforeach</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>在上面的例子中，遍历过程中将关键字LISTS改成了ITEMS，后边跟的还是一个或者多个列表，只不过此时需要通过${}将列表中的值取出。其输出的信息和上一个例子是一样的：</p> 
<pre><code class="prism language-c"><span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> a
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> b
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> c
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> d e f
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> ace
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> sabo
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> luffy
</code></pre> 
<p><strong>小细节：在通过 set 组织列表的时候，如果某个字符串中有空格，可以通过双引号将其包裹起来，具体的操作方法可以参考上面的例子</strong></p> 
<p><strong>方法4</strong></p> 
<p>注意事项：这种循环方式要求CMake的版本大于等于 3.17。</p> 
<pre><code class="prism language-c"><span class="token function">foreach</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>loop_var<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> IN ZIP_LISTS <span class="token operator">&lt;</span>lists<span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<p>通过这种方式，遍历的还是一个或多个列表，可以理解为是方式3的加强版。因为通过上面的方式遍历多个列表，但是又想把指定列表中的元素取出来使用是做不到的，在这个加强版中就可以轻松实现。</p> 
<ul><li>loop_var：存储每次循环取出的值，可以根据要遍历的列表的数量指定多个变量，用于存储对应的列表当前取出的那个值。</li><li>如果指定了多个变量名，它们的数量应该和列表的数量相等</li><li>如果只给出了一个 loop_var，那么它将一系列的 loop_var_N 变量来存储对应列表中的当前项，也就是说 loop_var_0<br> 对应第一个列表，loop_var_1 对应第二个列表，以此类推…</li><li>如果遍历的多个列表中一个列表较短，当它遍历完成之后将不会再参与后续的遍历（因为其它列表还没有遍历完）。</li><li>IN：关键字，表示在 xxx 里边</li><li>ZIP_LISTS：关键字，对应的是列表list，通过set 、list可以获得</li></ul> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.17</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span>
# 通过list给列表添加数据
<span class="token function">list</span><span class="token punctuation">(</span>APPEND WORD hello world <span class="token string">"hello world"</span><span class="token punctuation">)</span>
<span class="token function">list</span><span class="token punctuation">(</span>APPEND NAME ace sabo luffy zoro sanji<span class="token punctuation">)</span>
# 遍历列表
<span class="token function">foreach</span><span class="token punctuation">(</span>item1 item2 IN ZIP_LISTS WORD NAME<span class="token punctuation">)</span>
    <span class="token function">message</span><span class="token punctuation">(</span>STATUS <span class="token string">"当前遍历的值为: item1 = ${item1}, item2=${item2}"</span> <span class="token punctuation">)</span>
<span class="token function">endforeach</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">message</span><span class="token punctuation">(</span><span class="token string">"============================="</span><span class="token punctuation">)</span>
# 遍历列表
<span class="token function">foreach</span><span class="token punctuation">(</span>item  IN ZIP_LISTS WORD NAME<span class="token punctuation">)</span>
    <span class="token function">message</span><span class="token punctuation">(</span>STATUS <span class="token string">"当前遍历的值为: item1 = ${item_0}, item2=${item_1}"</span> <span class="token punctuation">)</span>
<span class="token function">endforeach</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>在这个例子中关于列表数据的添加是通过list来实现的。在遍历列表的时候一共使用了两种方式，一种提供了多个变量来存储当前列表中的值，另一种只有一个变量，但是实际取值的时候需要通过变量名_0、变量名_1、变量名_N 的方式来操作，注意事项：第一个列表对应的编号是0，第一个列表对应的编号是0，第一个列表对应的编号是0。</p> 
<p>上面的例子输出的结果如下：</p> 
<pre><code class="prism language-c"><span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> item1 <span class="token operator">=</span> hello<span class="token punctuation">,</span> item2<span class="token operator">=</span>ace
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> item1 <span class="token operator">=</span> world<span class="token punctuation">,</span> item2<span class="token operator">=</span>sabo
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> item1 <span class="token operator">=</span> hello world<span class="token punctuation">,</span> item2<span class="token operator">=</span>luffy
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> item1 <span class="token operator">=</span> <span class="token punctuation">,</span> item2<span class="token operator">=</span>zoro
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> item1 <span class="token operator">=</span> <span class="token punctuation">,</span> item2<span class="token operator">=</span>sanji
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> item1 <span class="token operator">=</span> hello<span class="token punctuation">,</span> item2<span class="token operator">=</span>ace
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> item1 <span class="token operator">=</span> world<span class="token punctuation">,</span> item2<span class="token operator">=</span>sabo
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> item1 <span class="token operator">=</span> hello world<span class="token punctuation">,</span> item2<span class="token operator">=</span>luffy
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> item1 <span class="token operator">=</span> <span class="token punctuation">,</span> item2<span class="token operator">=</span>zoro
<span class="token operator">--</span> 当前遍历的值为<span class="token operator">:</span> item1 <span class="token operator">=</span> <span class="token punctuation">,</span> item2<span class="token operator">=</span>sanji
</code></pre> 
<h4><a id="522_while_1434"></a>5.2.2 while</h4> 
<p>除了使用<strong>foreach</strong>也可以使用 <strong>while</strong> 进行循环，关于循环结束对应的条件判断的书写格式和<strong>if/elseif</strong> 是一样的。<strong>while</strong>的语法格式如下：</p> 
<pre><code class="prism language-c"><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>condition<span class="token operator">&gt;</span><span class="token punctuation">)</span>
    <span class="token operator">&lt;</span>commands<span class="token operator">&gt;</span>
<span class="token function">endwhile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>while</strong>循环比较简单，只需要指定出循环结束的条件即可：</p> 
<pre><code class="prism language-c"><span class="token function">cmake_minimum_required</span><span class="token punctuation">(</span>VERSION <span class="token number">3.5</span><span class="token punctuation">)</span>
<span class="token function">project</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span>
# 创建一个列表 NAME
<span class="token function">set</span><span class="token punctuation">(</span>NAME luffy sanji zoro nami robin<span class="token punctuation">)</span>
# 得到列表长度
<span class="token function">list</span><span class="token punctuation">(</span>LENGTH NAME LEN<span class="token punctuation">)</span>
# 循环
<span class="token keyword">while</span><span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>LEN<span class="token punctuation">}</span> GREATER  <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token function">message</span><span class="token punctuation">(</span>STATUS <span class="token string">"names = ${NAME}"</span><span class="token punctuation">)</span>
    # 弹出列表头部元素
    <span class="token function">list</span><span class="token punctuation">(</span>POP_FRONT NAME<span class="token punctuation">)</span>
    # 更新列表长度
    <span class="token function">list</span><span class="token punctuation">(</span>LENGTH NAME LEN<span class="token punctuation">)</span>
<span class="token function">endwhile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出的结果如下:</p> 
<pre><code class="prism language-c"><span class="token operator">--</span> names <span class="token operator">=</span> luffy<span class="token punctuation">;</span>sanji<span class="token punctuation">;</span>zoro<span class="token punctuation">;</span>nami<span class="token punctuation">;</span>robin
<span class="token operator">--</span> names <span class="token operator">=</span> sanji<span class="token punctuation">;</span>zoro<span class="token punctuation">;</span>nami<span class="token punctuation">;</span>robin
<span class="token operator">--</span> names <span class="token operator">=</span> zoro<span class="token punctuation">;</span>nami<span class="token punctuation">;</span>robin
<span class="token operator">--</span> names <span class="token operator">=</span> nami<span class="token punctuation">;</span>robin
<span class="token operator">--</span> names <span class="token operator">=</span> robin
</code></pre> 
<p>可以看到当列表中的元素全部被弹出之后，列表的长度变成了0，此时<strong>while</strong>循环也就退出了。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d699edd56074ac28d8c75ac9fb4f62a5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Electron】富文本编辑器之文本粘贴</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c1cc2318ec93c242ba5170b10b8e0d8a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">产品经理学习-从0-1搭建策略产品</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>