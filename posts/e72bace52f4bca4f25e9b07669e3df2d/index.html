<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ArcMap 字段计算器（Field Calculator）的使用总结 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ArcMap 字段计算器（Field Calculator）的使用总结" />
<meta property="og:description" content="1.某一个字段写入 固定字符串 ----选择python，字符串 gxsj=&#34;2018-06-25&#34; 点击确定。 2.根据ID字段填写URL字段
----新建url字段，类型为文本类型，简单模式下选择Python脚本 ----输入表达式：&#34;assets/imgs/M2U004&#34;&#43;str(int( !ID! %26&#43;30))&#43;&#34;.jpg&#34; ----其中%为取余；int为取整；str为数值转字符。 3.高级模式
4.注意python语法之缩进问题，字段类型要与返回结果类型一致。
5.实现ID字段自增：注意缩进语法
----Python #程序语言 ----Code Block: #下面这部分是具体实现，注意在放字段计算器时只需要下面这部分 rec=0 def autoIncrement(): #定义方法名 global rec pStart = 1 #初始值, 可以调整 pInterval = 1 #自增间隔, 可以调整 if (rec == 0): rec = pStart else: rec = rec &#43; pInterval return rec ---表达式 autoIncrement() #表达式方法 6.计算数值型字段的累加值
-----Python -----Code Block: #下面这部分是具体实现，注意在放字段计算器时只需要下面这部分 total = 0 def accumulate(increment): global total if total: total &#43;= increment else: total = increment return total ----表达式 accumulate(!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e72bace52f4bca4f25e9b07669e3df2d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-06-25T17:31:28+08:00" />
<meta property="article:modified_time" content="2018-06-25T17:31:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ArcMap 字段计算器（Field Calculator）的使用总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong><span style="color:#333333;">1.某一个字段写入 固定字符串</span></strong>         </p> 
<pre class="has"><code class="language-python">----选择python，字符串

gxsj="2018-06-25"

点击确定。</code></pre> 
<p><strong>2.根据ID字段填写URL字段</strong></p> 
<pre class="has"><code class="language-python">----新建url字段，类型为文本类型，简单模式下选择Python脚本

----输入表达式："assets/imgs/M2U004"+str(int( !ID! %26+30))+".jpg"

----其中%为取余；int为取整；str为数值转字符。</code></pre> 
<p><strong>3.高级模式</strong></p> 
<p><img alt="" class="has" height="563" src="https://images2.imgbox.com/a2/2f/P39DzTu5_o.png" width="464"></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/c2/ce/BYHOChPB_o.png"></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/b4/ac/DFhHVEZb_o.png"></p> 
<p><strong>4.注意python语法之缩进问题，字段类型要与返回结果类型一致。</strong></p> 
<p><strong>5.实现ID字段自增：注意缩进语法</strong></p> 
<pre class="has"><code class="language-python">----Python   #程序语言
----Code Block:        #下面这部分是具体实现，注意在放字段计算器时只需要下面这部分 
rec=0 
def autoIncrement():     #定义方法名 
global rec 
pStart = 1    #初始值, 可以调整  
pInterval = 1    #自增间隔, 可以调整 
if (rec == 0): 
    rec = pStart   
else: 
    rec = rec + pInterval 
return rec 

---表达式
autoIncrement()   #表达式方法</code></pre> 
<p><strong>6.<span style="color:#000000;">计算数值型字段的累加值</span></strong></p> 
<pre class="has"><code class="language-python">-----Python
-----Code Block:           #下面这部分是具体实现，注意在放字段计算器时只需要下面这部分 
total = 0 
def accumulate(increment): 
global total 
if total: 
    total += increment 
else: 
    total = increment 
return total

----表达式
accumulate(!FieldA!)      #该函数需要输入字段做参数</code></pre> 
<p><strong>7.<span style="color:#000000;">通过 numpy 站点包来计算 0.0 和 1.0 之间的随机浮点值</span></strong></p> 
<pre class="has"><code class="language-python">----Python

---Code Block: 
import numpy.random as R

def getRandomValue(): 
    return R.random() 

----表达式
getRandomValue()</code></pre> 
<p><strong>8.根据其他字段的值给这个字段赋值：</strong></p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/cd/7e/oV8yHMYW_o.png"></p> 
<pre><code class="language-python">def cal (YB,SB):
    return YB+SB


BM =
cal(!BDCDYH_YB!,!BDCDYH_SB!)

##########
YB和SB是一个二选一的字段，预编有字符串的话，实编就为null，需求是把它们两个合成一个字段BM，
那就定义一个函数把它们结合起来就可以了
##########

或者简单一点：
BM =
!BDCDYH_YB!+!BDCDYH_SB!</code></pre> 
<p> </p> 
<p><strong>9.字符串截取</strong></p> 
<pre class="has"><code class="language-python">----在字段计算器内选择Python
----截取前面两位字符串：!BM![0:2]

----从第3位开始截取后面的字符串：!BM![3:]    ---即把前面3个中文字符删除

#去除字符中间的其他符号
!BM![:4]+!BM![5:7]+!BM![7:11]</code></pre> 
<p><strong><span style="color:#000000;">10.几何体计算</span></strong><span style="color:#000000;">    </span></p> 
<pre class="has"><code class="language-python">计算图斑面积：!Shape.Area!    #单位是  平方米

质心X坐标：!Shape.CENTROID.X!

质心Y坐标：!Shape.CENTROID.Y!

将平方米转换为平方公里：!Area! /1000000</code></pre> 
<p><strong>11.整数(int)转换为字符串(str)</strong></p> 
<pre class="has"><code class="language-python">----在字段计算器内选择Python，选择字符串

----输入str(!整数字段的名字!)</code></pre> 
<p><strong>12.字符串截取、连接、赋值等</strong></p> 
<pre class="has"><code class="language-python">------定义函数
dm_1=""
def test(dm):
    if dm[4:6] == "83":
        dm_1 = dm[0:4] + "18" +dm[6:]
    elif dm[4:6] == "84":
        dm_1 = dm[0:4] + "17" +dm[6:]
    elif dm[4:6] == "16":
        dm_1 = dm[0:4] + "12" +dm[6:]
    else:
        dm_1 = dm
    return dm_1

-----表达式
test(!xzqhdm!)</code></pre> 
<p><strong>13.字符串与日期字段的转换</strong></p> 
<p><strong><span style="color:#f33b45;">   需要使用到python中time和datetime包，这两个包的使用，请参考：</span><a href="https://blog.csdn.net/aganliang/article/details/83180355"><span style="color:#f33b45;">python中time和datetime</span></a></strong></p> 
<pre class="has"><code class="language-python">-----字段计算器，高级模式，选择Python
-----定义函数
def str_to_datetime(str):
   if str =="_":   ----因为日期字符串里面有这种非法字段
         d=datetime.datetime.strptime('2018-07-30 00:00:00','%Y-%m-%d %H:%M:%S')
   else:
         d= datetime.datetime.strptime(str,'%Y-%m-%d %H:%M:%S')
   return d


----调用函数
str_to_datetime( !TFSJ! )


PS:开始总是转换不成功，报错，后来才发现日期字符串是这样的：'2018-05-15 11:10:56.0'
即后面多了一个.0
-----浪费了一个上午，才发现这个问题
</code></pre> 
<p> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f3a36dd383df478924288f0da3daf1dc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于深度学习的Image Inpainting (图像修复)论文推荐(持续更新)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2b963d8fd4a6e4924ce80a749f392824/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java并发编程之ConcurrentLinkedQueue详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>