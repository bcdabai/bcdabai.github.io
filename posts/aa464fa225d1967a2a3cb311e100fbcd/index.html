<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>协方差矩阵的几何解释 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="协方差矩阵的几何解释" />
<meta property="og:description" content="介绍 在本文中，我们通过探索线性变换与所得数据协方差之间的关系提供协方差矩阵一个直观的几何解释。大部分教科书基于协方差矩阵的概念解释数据的形状。相反，我们采取一个反向的方法，根据数据的形状来解释协方差矩阵的概念。
在《为什么样本方差除以N-1？》的文章中，我们会讨论方差的概念，并提供了众所周知的估算样本方差公式的推导和证明。这篇文章中使用的图1表明标准差（方差的平方根）提供了数据在特征空间上传播多少的量度。 我们发现，样本方差的无偏估计可由下式获得： 然而，方差只能用于解释平行于特征空间轴方向的数据传播。考虑图2所示的二维特征空间： 对于这个数据，我们可以计算出在x方向上的方差和y方向上的方差。然而，数据的水平传播和垂直传播不能解释明显的对角线关系。图2清楚地显示，平均而言，如果一个数据点的x值增加，则y值也将增加，这产生了正相关。这种相关性可以通过扩展方差概念到所谓的数据“协方差”捕捉到： 对于2D数据，我们得到，这些值可以用矩阵来表示，该矩阵叫做协方差矩阵： 如果x与y是正相关的，那么y和x也是正相关的。换句话说，。因此，协方差矩阵始终是一个对称矩阵，其对角线上是方差，非对角线上是协方差。二维正态分布数据由它的均值和2x2协方差矩阵就可以完全解释。同样，一个3x3协方差矩阵用于捕捉三维数据的传播，一个NxN协方差矩阵捕获N维数据的传播。
图3展示了数据的整体形状如何定义协方差矩阵： 协方差矩阵的特征值分解 在下一节，我们将讨论协方差矩阵如何被解释为白色数据转换成我们观察到数据的线性操作。然而，在深入技术细节之前，对特征向量和特征值如何唯一地确定协方差矩阵（数据形状）有一个直观的认识是非常重要的。
正如我们在图3看到的，协方差矩阵定义了我们数据的传播（方差）和方向（协方差）。因此，如果我们想用一个向量和它的大小来表示协方差矩阵，我们应该简单地尝试找到指向数据最大传播方向上的向量，其大小等于这个方向上的传播（方差）。
如果我们定义这个向量为，那么我们数据D到这个向量上的映射为，映射数据的方差是。由于我们正在寻找指向最大方差方向的向量，所以我们应该选择它的成分，使得映射数据的协方差矩阵尽可能的大。最大化的形式为的任何函数，其中是归一化单位向量，可以用一个所谓的瑞利商表示。通过设置等于矩阵的最大特征特征向量可以获得这样瑞利商的最大值。
换句话说，协方差矩阵的最大特征向量总是指向数据最大方差的方向，并且该向量的幅度等于相应的特征值。第二大特征向量总是正交于最大特征向量，并指向第二大数据的传播方向。
现在，让我们来看看一些例子。在文章《特征值和特征向量》中http://blog.csdn.net/u010182633/article/details/45921929，我们看到一个线性变换矩阵T完全由它的特征向量和特征值定义。应用到协方差矩阵，这意味着： 如果我们数据的协方差矩阵是对角矩阵，使得协方差是零，那么这意味着方差必须等于特征值λ。如图4所示，特征向量用绿色和品红色表示，特征值显然等于协方差矩阵的方差分量。 然而，如果协方差矩阵不是对角的，使得协方差不为零，那么情况稍微更复杂一些。特征值仍代表数据最大传播方向的方差大小，协方差矩阵的方差分量仍然表示x轴和y轴方向上的方差大小。但是，因为数据不是轴对齐的，所以这些值不再与图5所示的相同。 通过比较图5与图4，可以清楚地看到特征值表示沿特征向量方向数据的方差，而协方差矩阵的方差分量表示沿轴的传播。如果没有协方差，则这两个值是相等的。
协方差矩阵作为线性变换 现在，让我们忘了协方差矩阵。图3的实例可以简单地认为是图6的一个线性变换实例： 图6所示的数据是D，则图3所示的每个实例可以通过线性变换D得到：
其中T是变换矩阵，包括一个旋转矩阵R和缩放矩阵S： 这些矩阵定义如下： 其中是旋转角度。
分别是x方向和y方向的比例因子。
在下面的段落中，我们将讨论协方差矩阵与线性变换矩阵T= RS之间的关系。
让我们先从未缩放（缩放相当于1）和未旋转的数据开始。在统计中，这往往为“白数据’，因为它的样本是从标准正态分布引出的，因此对应于白（不相关）噪声： 这个“白色”数据的协方差矩阵等于单位矩阵，使得方差和标准差等于1，协方差等于零： 现在让我们用因子4在x方向缩放数据： 数据D’现在如下： D’的协方差现在是： D’的协方差与线性变换矩阵T有关系，D=TD，其中: 然而，虽然数据在x和y方向上缩放时等式（12）成立，但是应用旋转是否依然成立呢？为了调查一般情况下线性变换矩阵T和协方差矩阵之间的关系，我们试图分解协方差矩阵为旋转和缩放矩阵的乘积。
正如我们前面所看到的，我们可以用特征向量和特征值表示协方差矩阵： 等式（13）保存矩阵Σ的每个特征向量和特征值。在2D情况下，我们得到两个特征值和两个特征值。由公式（13）定义的两个等式可以有效地用矩阵符号来表示： 其中V是矩阵，它的列是Σ的特征向量，L是对角矩阵，其非零元素对应特征值。
这意味着我们可以将协方差矩阵表示为特征向量和特征值的函数： 方程（15）就是所谓协方差矩阵特征值分解，并可以使用奇异值分解算法来获得。而特征向量表示数据最大方差的方向，特征值表示那些方向方差的幅度。换言之，V表示旋转矩阵，而表示一个缩放矩阵。协方差矩阵可以进一步分解为： 在等式（6）中，我们定义了一个线性变换T= RS。由于S是对角缩放矩阵，所以S=ST。此外，由于R为正交矩阵，R-1=RT。因此，协方差矩阵可以写为： 换言之，如果我们应用由T=RS定义的线性变换到图7所示的原始白数据，我们得到了旋转和缩放的数据D’及协方差矩阵。这示于图10： 图10的彩色箭头表示特征向量。最大特征向量，即与最大特征值对应的特征向量，总是指向数据最大方差的方向，并由此确定其方位。次特征向量总是正交于最大特征向量，因为旋转矩阵的正交性。
总结 在本文中，我们表明观察到数据的协方差矩阵与白色不相关数据的线性变换有直接的关系。此线性变换完全由数据的特征向量和特征值确定。而特征向量表示旋转矩阵，特征值对应于每个维度上缩放因子的平方。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/aa464fa225d1967a2a3cb311e100fbcd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-05-23T20:34:54+08:00" />
<meta property="article:modified_time" content="2015-05-23T20:34:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">协方差矩阵的几何解释</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3 id="介绍">介绍</h3> 
<p>在本文中，我们通过探索线性变换与所得数据协方差之间的关系提供协方差矩阵一个直观的几何解释。大部分教科书基于协方差矩阵的概念解释数据的形状。相反，我们采取一个反向的方法，根据数据的形状来解释协方差矩阵的概念。</p> 
<p>在《为什么样本方差除以N-1？》的文章中，我们会讨论方差的概念，并提供了众所周知的估算样本方差公式的推导和证明。这篇文章中使用的图1表明标准差（方差的平方根）提供了数据在特征空间上传播多少的量度。 <br> <img src="https://images2.imgbox.com/31/bc/6k9F1q3F_o.png" alt="这里写图片描述" title=""></p> 
<p>我们发现，样本方差的无偏估计可由下式获得： <br> <img src="https://images2.imgbox.com/2b/28/4tcgAq3P_o.png" alt="这里写图片描述" title=""></p> 
<p>然而，方差只能用于解释平行于特征空间轴方向的数据传播。考虑图2所示的二维特征空间： <br> <img src="https://images2.imgbox.com/69/9c/8p2HDlYE_o.png" alt="这里写图片描述" title=""></p> 
<p>对于这个数据，我们可以计算出在x方向上的方差<img src="https://images2.imgbox.com/5f/2a/T4pgufOW_o.png" alt="这里写图片描述" title="">和y方向上的方差<img src="https://images2.imgbox.com/fb/d1/wZmtdheg_o.png" alt="这里写图片描述" title="">。然而，数据的水平传播和垂直传播不能解释明显的对角线关系。图2清楚地显示，平均而言，如果一个数据点的x值增加，则y值也将增加，这产生了正相关。这种相关性可以通过扩展方差概念到所谓的数据“协方差”捕捉到： <br> <img src="https://images2.imgbox.com/b7/29/imjFwy84_o.png" alt="这里写图片描述" title=""></p> 
<p>对于2D数据，我们得到<img src="https://images2.imgbox.com/62/31/1x1OuhWP_o.png" alt="这里写图片描述" title="">，这些值可以用矩阵来表示，该矩阵叫做协方差矩阵： <br> <img src="https://images2.imgbox.com/88/f0/2PAodS8H_o.png" alt="这里写图片描述" title=""></p> 
<p>如果x与y是正相关的，那么y和x也是正相关的。换句话说，<img src="https://images2.imgbox.com/d9/54/RF6Uur7B_o.png" alt="这里写图片描述" title="">。因此，协方差矩阵始终是一个对称矩阵，其对角线上是方差，非对角线上是协方差。二维正态分布数据由它的均值和2x2协方差矩阵就可以完全解释。同样，一个3x3协方差矩阵用于捕捉三维数据的传播，一个NxN协方差矩阵捕获N维数据的传播。</p> 
<p>图3展示了数据的整体形状如何定义协方差矩阵： <br> <img src="https://images2.imgbox.com/f3/bc/0QVLBzxH_o.png" alt="这里写图片描述" title=""></p> 
<h3 id="协方差矩阵的特征值分解">协方差矩阵的特征值分解</h3> 
<p>在下一节，我们将讨论协方差矩阵如何被解释为白色数据转换成我们观察到数据的线性操作。然而，在深入技术细节之前，对特征向量和特征值如何唯一地确定协方差矩阵（数据形状）有一个直观的认识是非常重要的。</p> 
<p>正如我们在图3看到的，协方差矩阵定义了我们数据的传播（方差）和方向（协方差）。因此，如果我们想用一个向量和它的大小来表示协方差矩阵，我们应该简单地尝试找到指向数据最大传播方向上的向量，其大小等于这个方向上的传播（方差）。</p> 
<p>如果我们定义这个向量为<img src="https://images2.imgbox.com/42/03/SvS1y2d7_o.png" alt="这里写图片描述" title="">，那么我们数据D到这个向量上的映射为<img src="https://images2.imgbox.com/69/de/sHQdwgvx_o.png" alt="这里写图片描述" title="">，映射数据的方差是<img src="https://images2.imgbox.com/43/7d/CgmosblG_o.png" alt="这里写图片描述" title="">。由于我们正在寻找指向最大方差方向的向量<img src="https://images2.imgbox.com/99/70/4xvxfV1n_o.png" alt="这里写图片描述" title="">，所以我们应该选择它的成分，使得映射数据的协方差矩阵<img src="https://images2.imgbox.com/bb/01/NUKGTuIK_o.png" alt="这里写图片描述" title="">尽可能的大。最大化<img src="https://images2.imgbox.com/03/d2/YsYsC0YM_o.png" alt="这里写图片描述" title="">的形式为<img src="https://images2.imgbox.com/53/d1/DTvxUJ2w_o.png" alt="这里写图片描述" title="">的任何函数，其中<img src="https://images2.imgbox.com/fd/92/OlvoLnmA_o.png" alt="这里写图片描述" title="">是归一化单位向量，可以用一个所谓的瑞利商表示。通过设置<img src="https://images2.imgbox.com/7e/51/kwucIjd6_o.png" alt="这里写图片描述" title="">等于矩阵的最大特征特征向量<img src="https://images2.imgbox.com/4f/01/nKGXjrVX_o.png" alt="这里写图片描述" title="">可以获得这样瑞利商的最大值。</p> 
<p>换句话说，协方差矩阵的最大特征向量总是指向数据最大方差的方向，并且该向量的幅度等于相应的特征值。第二大特征向量总是正交于最大特征向量，并指向第二大数据的传播方向。</p> 
<p>现在，让我们来看看一些例子。在文章《特征值和特征向量》中<a href="http://blog.csdn.net/u010182633/article/details/45921929">http://blog.csdn.net/u010182633/article/details/45921929</a>，我们看到一个线性变换矩阵T完全由它的特征向量和特征值定义。应用到协方差矩阵，这意味着： <br> <img src="https://images2.imgbox.com/a8/6d/zROfzMUe_o.png" alt="这里写图片描述" title=""> <br> <img src="https://images2.imgbox.com/c8/86/asNhZJox_o.png" alt="这里写图片描述" title=""></p> 
<p>如果我们数据的协方差矩阵是对角矩阵，使得协方差是零，那么这意味着方差必须等于特征值λ。如图4所示，特征向量用绿色和品红色表示，特征值显然等于协方差矩阵的方差分量。 <br> <img src="https://images2.imgbox.com/5e/a7/qXifPjpH_o.png" alt="这里写图片描述" title=""></p> 
<p>然而，如果协方差矩阵不是对角的，使得协方差不为零，那么情况稍微更复杂一些。特征值仍代表数据最大传播方向的方差大小，协方差矩阵的方差分量仍然表示x轴和y轴方向上的方差大小。但是，因为数据不是轴对齐的，所以这些值不再与图5所示的相同。 <br> <img src="https://images2.imgbox.com/21/2c/jlvYhHIz_o.png" alt="这里写图片描述" title=""></p> 
<p>通过比较图5与图4，可以清楚地看到特征值表示沿特征向量方向数据的方差，而协方差矩阵的方差分量表示沿轴的传播。如果没有协方差，则这两个值是相等的。</p> 
<h3 id="协方差矩阵作为线性变换">协方差矩阵作为线性变换</h3> 
<p>现在，让我们忘了协方差矩阵。图3的实例可以简单地认为是图6的一个线性变换实例： <br> <img src="https://images2.imgbox.com/19/9a/xkbxNoB2_o.png" alt="这里写图片描述" title=""></p> 
<p>图6所示的数据是D，则图3所示的每个实例可以通过线性变换D得到：<img src="https://images2.imgbox.com/c0/64/4aSjBGXP_o.png" alt="这里写图片描述" title=""></p> 
<p>其中T是变换矩阵，包括一个旋转矩阵R和缩放矩阵S： <br> <img src="https://images2.imgbox.com/07/b4/3Bj6eAXo_o.png" alt="这里写图片描述" title=""></p> 
<p>这些矩阵定义如下： <br> <img src="https://images2.imgbox.com/f1/17/0gFoDlX1_o.png" alt="这里写图片描述" title=""> <br> 其中<img src="https://images2.imgbox.com/e7/2d/Sv30Gw5P_o.png" alt="这里写图片描述" title="">是旋转角度。</p> 
<p><img src="https://images2.imgbox.com/78/1a/SXr11q9O_o.png" alt="这里写图片描述" title=""> <br> <img src="https://images2.imgbox.com/80/4c/D6IBD69l_o.png" alt="这里写图片描述" title="">分别是x方向和y方向的比例因子。</p> 
<p>在下面的段落中，我们将讨论协方差矩阵<img src="https://images2.imgbox.com/6f/99/CEAMa47z_o.png" alt="这里写图片描述" title="">与线性变换矩阵T= RS之间的关系。</p> 
<p>让我们先从未缩放（缩放相当于1）和未旋转的数据开始。在统计中，这往往为“白数据’，因为它的样本是从标准正态分布引出的，因此对应于白（不相关）噪声： <br> <img src="https://images2.imgbox.com/66/ca/xzWQyyY5_o.png" alt="这里写图片描述" title=""></p> 
<p>这个“白色”数据的协方差矩阵等于单位矩阵，使得方差和标准差等于1，协方差等于零： <br> <img src="https://images2.imgbox.com/f9/46/wVnnCUua_o.png" alt="这里写图片描述" title=""></p> 
<p>现在让我们用因子4在x方向缩放数据： <br> <img src="https://images2.imgbox.com/59/68/Sl4R76Hf_o.png" alt="这里写图片描述" title=""></p> 
<p>数据D’现在如下： <br> <img src="https://images2.imgbox.com/f3/d1/qkaZ0vyh_o.png" alt="这里写图片描述" title=""></p> 
<p>D’的协方差<img src="https://images2.imgbox.com/10/ec/LXMKQiQy_o.png" alt="这里写图片描述" title="">现在是： <br> <img src="https://images2.imgbox.com/dc/0e/hDI2AnKh_o.png" alt="这里写图片描述" title=""></p> 
<p>D’的协方差<img src="https://images2.imgbox.com/66/01/4jYpqnj7_o.png" alt="这里写图片描述" title="">与线性变换矩阵T有关系，D=TD，其中: <br> <img src="https://images2.imgbox.com/71/ab/nklccCbU_o.png" alt="这里写图片描述" title=""></p> 
<p>然而，虽然数据在x和y方向上缩放时等式（12）成立，但是应用旋转是否依然成立呢？为了调查一般情况下线性变换矩阵T和协方差矩阵<img src="https://images2.imgbox.com/68/52/bJZWvLP6_o.png" alt="这里写图片描述" title="">之间的关系，我们试图分解协方差矩阵为旋转和缩放矩阵的乘积。</p> 
<p>正如我们前面所看到的，我们可以用特征向量和特征值表示协方差矩阵： <br> <img src="https://images2.imgbox.com/75/65/3FA2k4RA_o.png" alt="这里写图片描述" title=""> <br> <img src="https://images2.imgbox.com/63/3c/tQOZ8fCg_o.jpg" alt="这里写图片描述" title=""></p> 
<p>等式（13）保存矩阵Σ的每个特征向量和特征值。在2D情况下，我们得到两个特征值和两个特征值。由公式（13）定义的两个等式可以有效地用矩阵符号来表示： <br> <img src="https://images2.imgbox.com/4c/34/glRk7MSu_o.jpg" alt="这里写图片描述" title=""> <br> 其中V是矩阵，它的列是Σ的特征向量，L是对角矩阵，其非零元素对应特征值。</p> 
<p>这意味着我们可以将协方差矩阵表示为特征向量和特征值的函数： <br> <img src="https://images2.imgbox.com/a1/be/rBOwf5T1_o.jpg" alt="这里写图片描述" title=""></p> 
<p>方程（15）就是所谓协方差矩阵特征值分解，并可以使用奇异值分解算法来获得。而特征向量表示数据最大方差的方向，特征值表示那些方向方差的幅度。换言之，V表示旋转矩阵，而<img src="https://images2.imgbox.com/c5/c7/TxWmt7qw_o.jpg" alt="这里写图片描述" title="">表示一个缩放矩阵。协方差矩阵可以进一步分解为： <br> <img src="https://images2.imgbox.com/c0/54/HfSnGJCW_o.jpg" alt="这里写图片描述" title=""> <br> <img src="https://images2.imgbox.com/02/d6/uPUyMAjW_o.jpg" alt="这里写图片描述" title=""></p> 
<p>在等式（6）中，我们定义了一个线性变换T= RS。由于S是对角缩放矩阵，所以S=ST。此外，由于R为正交矩阵，R-1=RT。因此，<img src="https://images2.imgbox.com/0b/38/9nDSqVv8_o.jpg" alt="这里写图片描述" title="">协方差矩阵可以写为： <br> <img src="https://images2.imgbox.com/ad/59/7JcqtWBx_o.jpg" alt="这里写图片描述" title=""></p> 
<p>换言之，如果我们应用由T=RS定义的线性变换到图7所示的原始白数据，我们得到了旋转和缩放的数据D’及协方差矩阵<img src="https://images2.imgbox.com/aa/94/MziDBRJB_o.jpg" alt="这里写图片描述" title="">。这示于图10： <br> <img src="https://images2.imgbox.com/6a/e4/TlmkUoba_o.jpg" alt="这里写图片描述" title=""> <br> 图10的彩色箭头表示特征向量。最大特征向量，即与最大特征值对应的特征向量，总是指向数据最大方差的方向，并由此确定其方位。次特征向量总是正交于最大特征向量，因为旋转矩阵的正交性。</p> 
<p>总结 <br> 在本文中，我们表明观察到数据的协方差矩阵与白色不相关数据的线性变换有直接的关系。此线性变换完全由数据的特征向量和特征值确定。而特征向量表示旋转矩阵，特征值对应于每个维度上缩放因子的平方。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fc3bb3ab52b7d63d8bb916a0b047ccd1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">解析错误富文本json字符串（带双引号）的解决办法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b3e062bcb65b5c83219cdc2bea2c2ef9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">2014世界10大DRAM公司</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>