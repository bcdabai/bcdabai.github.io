<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>用Excel辅助做数独 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="用Excel辅助做数独" />
<meta property="og:description" content="做数独游戏的时候，画在纸上很容易弄花眼，所以我考虑用Excel辅助做一个。
界面如下：
按下初始化表格区域按钮，会在所有单元格中填充“123456789”。如下图：
当某个单元格删除得只剩一个数字时，会将同一行、同一列和同一区域的其它单元格中的相同数字删除。如下图：
实现上述效果的VBA如下：
1、初始化按钮的代码：
Sub startup_Click() Dim row%, col% For row = 1 To 9 For col = 1 To 9 Cells(row, col) = &#34;&#39;123456789&#34; Next Next End Sub 以上代码仅仅简单遍历相关单元格并填充字符串。
实现自动删除关联单元格中的数字的功能的代码放在工作表的Worksheet_Change事件中，这样，只要修改相关游戏区域中的单元格，就会自动执行检查并删除有关数字。代码如下：
Private Sub Worksheet_Change(ByVal Target As Range) Dim row%, col%, changeRow%, changeCol%, rngRow%, rngCol%, txt$ changeRow = Target.row changeCol = Target.Column &#39;记录刚修改单元格的内容 txt = Cells(changeRow, changeCol) &#39;如果刚修改的单元格只剩下一个数字，则执行自动消除 If Len(txt) = 1 Then &#39;防止修改单元格内容时工作表改变事件被循环触发 Application.EnableEvents = False &#39;确定同一区域单元格第一行行号 If changeRow &lt; 4 Then rngRow = 1 ElseIf changeRow &gt; 6 Then rngRow = 7 Else rngRow = 4 End If &#39;确定同一区域单元格第一列列号 If changeCol &lt; 4 Then rngCol = 1 ElseIf changeCol &gt; 6 Then rngCol = 7 Else rngCol = 4 End If &#39;将同一行、列及区域单元格中相关的数字删除 For row = 1 To 9 For col = 1 To 9 If row = changeRow Or col = changeCol Or (row &gt;= rngRow And row &lt; rngRow &#43; 3 _ And col &gt;= rngCol And col &lt; rngCol &#43; 3) Then Cells(row, col) = Replace(Cells(row, col), txt, &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a9e9da6ba2b30c95a87ae712abc2de2f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-22T20:03:31+08:00" />
<meta property="article:modified_time" content="2024-01-22T20:03:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">用Excel辅助做数独</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>做数独游戏的时候，画在纸上很容易弄花眼，所以我考虑用Excel辅助做一个。<br> 界面如下：<br> <img src="https://images2.imgbox.com/48/ea/lJ8643rv_o.png" alt="在这里插入图片描述"><br> 按下初始化表格区域按钮，会在所有单元格中填充“123456789”。如下图：<br> <img src="https://images2.imgbox.com/54/5e/ykherzir_o.png" alt="在这里插入图片描述"><br> 当某个单元格删除得只剩一个数字时，会将同一行、同一列和同一区域的其它单元格中的相同数字删除。如下图：<br> <img src="https://images2.imgbox.com/ee/a9/3v4Jav7p_o.png" alt="在这里插入图片描述"><br> 实现上述效果的VBA如下：<br> 1、初始化按钮的代码：</p> 
<pre><code class="prism language-vbnet"><span class="token keyword">Sub</span> startup_Click<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> row%<span class="token punctuation">,</span> col%
    <span class="token keyword">For</span> row <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
        <span class="token keyword">For</span> col <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
            Cells<span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"'123456789"</span>
        <span class="token keyword">Next</span>
    <span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> 
<p>以上代码仅仅简单遍历相关单元格并填充字符串。<br> 实现自动删除关联单元格中的数字的功能的代码放在工作表的<code>Worksheet_Change</code>事件中，这样，只要修改相关游戏区域中的单元格，就会自动执行检查并删除有关数字。代码如下：</p> 
<pre><code class="prism language-vbnet"><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_Change<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> row%<span class="token punctuation">,</span> col%<span class="token punctuation">,</span> changeRow%<span class="token punctuation">,</span> changeCol%<span class="token punctuation">,</span> rngRow%<span class="token punctuation">,</span> rngCol%<span class="token punctuation">,</span> txt$
    changeRow <span class="token operator">=</span> Target.row
    changeCol <span class="token operator">=</span> Target.Column
    
    <span class="token comment">'记录刚修改单元格的内容</span>
    txt <span class="token operator">=</span> Cells<span class="token punctuation">(</span>changeRow<span class="token punctuation">,</span> changeCol<span class="token punctuation">)</span>
    
    <span class="token comment">'如果刚修改的单元格只剩下一个数字，则执行自动消除</span>
    <span class="token keyword">If</span> <span class="token function">Len</span><span class="token punctuation">(</span>txt<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>
        <span class="token comment">'防止修改单元格内容时工作表改变事件被循环触发</span>
        Application.EnableEvents <span class="token operator">=</span> <span class="token keyword">False</span>
        
        <span class="token comment">'确定同一区域单元格第一行行号</span>
        <span class="token keyword">If</span> changeRow <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token keyword">Then</span>
            rngRow <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">ElseIf</span> changeRow <span class="token operator">&gt;</span> <span class="token number">6</span> <span class="token keyword">Then</span>
            rngRow <span class="token operator">=</span> <span class="token number">7</span>
        <span class="token keyword">Else</span>
            rngRow <span class="token operator">=</span> <span class="token number">4</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token comment">'确定同一区域单元格第一列列号</span>
        <span class="token keyword">If</span> changeCol <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token keyword">Then</span>
            rngCol <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">ElseIf</span> changeCol <span class="token operator">&gt;</span> <span class="token number">6</span> <span class="token keyword">Then</span>
            rngCol <span class="token operator">=</span> <span class="token number">7</span>
        <span class="token keyword">Else</span>
            rngCol <span class="token operator">=</span> <span class="token number">4</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
 
        <span class="token comment">'将同一行、列及区域单元格中相关的数字删除</span>
        <span class="token keyword">For</span> row <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
            <span class="token keyword">For</span> col <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
                <span class="token keyword">If</span> row <span class="token operator">=</span> changeRow <span class="token keyword">Or</span> col <span class="token operator">=</span> changeCol <span class="token keyword">Or</span> <span class="token punctuation">(</span>row <span class="token operator">&gt;=</span> rngRow <span class="token keyword">And</span> row <span class="token operator">&lt;</span> rngRow <span class="token operator">+</span> <span class="token number">3</span> _
                            <span class="token keyword">And</span> col <span class="token operator">&gt;=</span> rngCol <span class="token keyword">And</span> col <span class="token operator">&lt;</span> rngCol <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">Then</span>
                    Cells<span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> Replace<span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">,</span> txt<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
                <span class="token keyword">End</span> <span class="token keyword">If</span>
            <span class="token keyword">Next</span>
        <span class="token keyword">Next</span>
        Cells<span class="token punctuation">(</span>changeRow<span class="token punctuation">,</span> changeCol<span class="token punctuation">)</span> <span class="token operator">=</span> txt
        <span class="token comment">'恢复事件处理以继续响应工作表改变事件</span>
        Application.EnableEvents <span class="token operator">=</span> <span class="token keyword">True</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre> 
<p>下面再附上一个用VBA做数独的程序，不过没有优化：</p> 
<pre><code class="prism language-vbnet"><span class="token keyword">Sub</span> VBA做数独<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> targetRegion <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> origStr<span class="token punctuation">,</span> tmpStr<span class="token punctuation">,</span> tStr <span class="token keyword">As</span> <span class="token keyword">String</span>
   <span class="token comment">'i, j, r, c, tmpr, tmpc, tr, 用于遍历表格</span>
    <span class="token comment">'stackR为堆栈指针</span>
    <span class="token keyword">Dim</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> r<span class="token punctuation">,</span> c<span class="token punctuation">,</span> tmpr<span class="token punctuation">,</span> tmpc<span class="token punctuation">,</span> tr<span class="token punctuation">,</span> tc<span class="token punctuation">,</span> tmpLen<span class="token punctuation">,</span> targetRow<span class="token punctuation">,</span> targetCol<span class="token punctuation">,</span> stackR <span class="token keyword">As</span> <span class="token keyword">Integer</span>

    <span class="token keyword">Dim</span> change <span class="token keyword">As</span> <span class="token keyword">Boolean</span>
    <span class="token keyword">Dim</span> startTime<span class="token punctuation">,</span> endTime <span class="token keyword">As</span> <span class="token keyword">Date</span>

   startTime <span class="token operator">=</span> Now<span class="token punctuation">(</span><span class="token punctuation">)</span>
   origStr <span class="token operator">=</span> <span class="token string">"1,2,3,4,5,6,7,8,9"</span>
   targetRegion <span class="token operator">=</span> <span class="token string">"A1:I9"</span>
   stackR <span class="token operator">=</span> <span class="token number">1</span>
   Application.ScreenUpdating <span class="token operator">=</span> <span class="token keyword">False</span>   

填写<span class="token punctuation">:</span>
   change <span class="token operator">=</span> <span class="token keyword">False</span>
    <span class="token keyword">For</span> r <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
       <span class="token keyword">For</span> c <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
           <span class="token keyword">If</span> <span class="token function">Len</span><span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">Then</span>
                tmpStr <span class="token operator">=</span> Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token comment">'单元格内容为已去掉用过的数字后的字串</span>
           <span class="token keyword">ElseIf</span> <span class="token function">Len</span><span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">And</span> Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
                 <span class="token keyword">GoTo</span> 跳到下一单元格  <span class="token comment">'单元格数字已确定，跳到下一单元格</span>
           <span class="token keyword">Else</span>
                tmpStr <span class="token operator">=</span> origStr <span class="token comment">'单元格为空单元格，设定内容为原始字符串</span>
           <span class="token keyword">End</span> <span class="token keyword">If</span> 
                <span class="token comment">'将同一行中已用过的数字从原始字串中去除</span>
                <span class="token keyword">For</span> tmpc <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
                    <span class="token keyword">If</span> <span class="token function">Len</span><span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> tmpc<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>
                        <span class="token keyword">If</span> InStr<span class="token punctuation">(</span>tmpStr<span class="token punctuation">,</span> Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> tmpc<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
                            tmpStr <span class="token operator">=</span> Replace<span class="token punctuation">(</span>tmpStr<span class="token punctuation">,</span> Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> tmpc<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
                            change <span class="token operator">=</span> <span class="token keyword">True</span>
                        <span class="token keyword">End</span> <span class="token keyword">If</span>
                    <span class="token keyword">End</span> <span class="token keyword">If</span>
                <span class="token keyword">Next</span>
                 <span class="token comment">'将同一列中已用过的数字从原始字串中去除</span>
                <span class="token keyword">For</span> tmpr <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
                    <span class="token keyword">If</span> <span class="token function">Len</span><span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>tmpr<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>
                        <span class="token keyword">If</span> InStr<span class="token punctuation">(</span>tmpStr<span class="token punctuation">,</span> Cells<span class="token punctuation">(</span>tmpr<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
                           tmpStr <span class="token operator">=</span> Replace<span class="token punctuation">(</span>tmpStr<span class="token punctuation">,</span> Cells<span class="token punctuation">(</span>tmpr<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
                            change <span class="token operator">=</span> <span class="token keyword">True</span>
                        <span class="token keyword">End</span> <span class="token keyword">If</span>
                    <span class="token keyword">End</span> <span class="token keyword">If</span>
                <span class="token keyword">Next</span>
                <span class="token comment">'将同一区域中已用过的数字从原始字串中去除</span>
                <span class="token keyword">If</span> r <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token keyword">Then</span>
                    tr <span class="token operator">=</span> <span class="token number">1</span>
                <span class="token keyword">ElseIf</span> r <span class="token operator">&gt;</span> <span class="token number">6</span> <span class="token keyword">Then</span>
                    tr <span class="token operator">=</span> <span class="token number">7</span>
                <span class="token keyword">Else</span>
                    tr <span class="token operator">=</span> <span class="token number">4</span>
                <span class="token keyword">End</span> <span class="token keyword">If</span>               

                <span class="token keyword">If</span> c <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token keyword">Then</span>
                    tc <span class="token operator">=</span> <span class="token number">1</span>
                <span class="token keyword">ElseIf</span> c <span class="token operator">&gt;</span> <span class="token number">6</span> <span class="token keyword">Then</span>
                    tc <span class="token operator">=</span> <span class="token number">7</span>
                <span class="token keyword">Else</span>
                    tc <span class="token operator">=</span> <span class="token number">4</span>
                <span class="token keyword">End</span> <span class="token keyword">If</span>

                <span class="token keyword">For</span> tmpr <span class="token operator">=</span> tr <span class="token keyword">To</span> tr <span class="token operator">+</span> <span class="token number">2</span>
                    <span class="token keyword">For</span> tmpc <span class="token operator">=</span> tc <span class="token keyword">To</span> tc <span class="token operator">+</span> <span class="token number">2</span>
                        <span class="token keyword">If</span> <span class="token function">Len</span><span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>tmpr<span class="token punctuation">,</span> tmpc<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>
                            <span class="token keyword">If</span> InStr<span class="token punctuation">(</span>tmpStr<span class="token punctuation">,</span> Cells<span class="token punctuation">(</span>tmpr<span class="token punctuation">,</span> tmpc<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
                                tmpStr <span class="token operator">=</span> Replace<span class="token punctuation">(</span>tmpStr<span class="token punctuation">,</span> Cells<span class="token punctuation">(</span>tmpr<span class="token punctuation">,</span> tmpc<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
                                change <span class="token operator">=</span> <span class="token keyword">True</span>
                            <span class="token keyword">End</span> <span class="token keyword">If</span>
                        <span class="token keyword">End</span> <span class="token keyword">If</span>
                    <span class="token keyword">Next</span>
                <span class="token keyword">Next</span>

                tStr <span class="token operator">=</span> Replace<span class="token punctuation">(</span>tmpStr<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
                <span class="token comment">'某个单元格的数字全部删完，那么这种填法错误</span>
                <span class="token keyword">If</span> <span class="token function">Len</span><span class="token punctuation">(</span>tStr<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">Then</span>
                    <span class="token keyword">If</span> stackR <span class="token operator">&gt;</span> <span class="token number">10</span> <span class="token keyword">Then</span>
                       <span class="token comment">'出栈</span>
                       Range<span class="token punctuation">(</span><span class="token string">"A"</span> <span class="token operator">&amp;</span> stackR <span class="token operator">&amp;</span> <span class="token string">":i"</span> <span class="token operator">&amp;</span> stackR <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>.<span class="token keyword">Select</span>
                       Selection.Cut
                       Range<span class="token punctuation">(</span><span class="token string">"A1"</span><span class="token punctuation">)</span>.<span class="token keyword">Select</span>
                       Paste
                       <span class="token comment">'调整堆栈指针</span>
                       stackR <span class="token operator">=</span> stackR <span class="token operator">-</span> <span class="token number">10</span>
                       <span class="token keyword">GoTo</span> 填写
                    <span class="token keyword">Else</span>
                        MsgBox <span class="token string">"(@﹏@)~，这题无解。"</span> <span class="token comment">'堆栈到底，没有可能情况了，无解</span>
                        <span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
                    <span class="token keyword">End</span> <span class="token keyword">If</span>            

                <span class="token keyword">ElseIf</span> <span class="token function">Len</span><span class="token punctuation">(</span>tStr<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>
                    Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">=</span> tStr
                <span class="token keyword">Else</span>
                    Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">=</span> tmpStr
                <span class="token keyword">End</span> <span class="token keyword">If</span>
                tmpStr <span class="token operator">=</span> origStr
                tStr <span class="token operator">=</span> <span class="token string">""</span>           

跳到下一单元格<span class="token punctuation">:</span>
       <span class="token keyword">Next</span>
      <span class="token keyword">Next</span>      

      <span class="token keyword">If</span> change <span class="token operator">=</span> <span class="token keyword">False</span> <span class="token keyword">Then</span>
         <span class="token keyword">For</span> r <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
                <span class="token keyword">For</span> c <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span> 
                        <span class="token comment">'分析同一行的情况，判断是否出现可确定数字的单元格</span>
                        <span class="token keyword">For</span> tmpc <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
                            <span class="token keyword">If</span> <span class="token function">Len</span><span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> tmpc<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">Then</span>
                                tStr <span class="token operator">=</span> tStr <span class="token operator">&amp;</span> Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> tmpc<span class="token punctuation">)</span>
                            <span class="token keyword">End</span> <span class="token keyword">If</span>
                        <span class="token keyword">Next</span>                       

                        <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
                            <span class="token keyword">If</span> <span class="token function">Len</span><span class="token punctuation">(</span>tStr<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">Len</span><span class="token punctuation">(</span>Replace<span class="token punctuation">(</span>tStr<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>
                                <span class="token keyword">For</span> tmpc <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
                                    <span class="token keyword">If</span> InStr<span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> tmpc<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
                                       Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> tmpc<span class="token punctuation">)</span> <span class="token operator">=</span> i
                                        <span class="token keyword">GoTo</span> 填写
                                    <span class="token keyword">End</span> <span class="token keyword">If</span>
                                <span class="token keyword">Next</span>
                            <span class="token keyword">End</span> <span class="token keyword">If</span>
                        <span class="token keyword">Next</span>
                        tStr <span class="token operator">=</span> <span class="token string">""</span>
                         <span class="token comment">'分析同一列的情况，判断是否出现可确定数字的单元格</span>
                        <span class="token keyword">For</span> tmpr <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
                            <span class="token keyword">If</span> <span class="token function">Len</span><span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>tmpr<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&gt;</span> <span class="token number">1</span> <span class="token keyword">Then</span>
                                tStr <span class="token operator">=</span> tStr <span class="token operator">&amp;</span> Cells<span class="token punctuation">(</span>tmpr<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
                            <span class="token keyword">End</span> <span class="token keyword">If</span>
                        <span class="token keyword">Next</span>

                        <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
                            <span class="token keyword">If</span> <span class="token function">Len</span><span class="token punctuation">(</span>tStr<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">Len</span><span class="token punctuation">(</span>Replace<span class="token punctuation">(</span>tStr<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>
                                <span class="token keyword">For</span> tmpr <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
                                    <span class="token keyword">If</span> InStr<span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>tmpr<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
                                        Cells<span class="token punctuation">(</span>tmpr<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">=</span> i
                                        <span class="token keyword">GoTo</span> 填写
                                    <span class="token keyword">End</span> <span class="token keyword">If</span>
                                <span class="token keyword">Next</span>
                            <span class="token keyword">End</span> <span class="token keyword">If</span>
                        <span class="token keyword">Next</span>
                        tStr <span class="token operator">=</span> <span class="token string">""</span>

                        <span class="token comment">'分析同一区域的情况，判断是否出现可确定数字的单元格</span>

                        <span class="token keyword">If</span> r <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token keyword">Then</span>
                            tr <span class="token operator">=</span> <span class="token number">1</span>
                        <span class="token keyword">ElseIf</span> r <span class="token operator">&gt;</span> <span class="token number">6</span> <span class="token keyword">Then</span>
                            tr <span class="token operator">=</span> <span class="token number">7</span>
                        <span class="token keyword">Else</span>
                            tr <span class="token operator">=</span> <span class="token number">4</span>
                        <span class="token keyword">End</span> <span class="token keyword">If</span>

                        <span class="token keyword">If</span> c <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token keyword">Then</span>
                            tc <span class="token operator">=</span> <span class="token number">1</span>
                        <span class="token keyword">ElseIf</span> c <span class="token operator">&gt;</span> <span class="token number">6</span> <span class="token keyword">Then</span>
                            tc <span class="token operator">=</span> <span class="token number">7</span>
                        <span class="token keyword">Else</span>
                            tc <span class="token operator">=</span> <span class="token number">4</span>
                        <span class="token keyword">End</span> <span class="token keyword">If</span>

                        <span class="token keyword">For</span> tmpr <span class="token operator">=</span> tr <span class="token keyword">To</span> tr <span class="token operator">+</span> <span class="token number">2</span>
                            <span class="token keyword">For</span> tmpc <span class="token operator">=</span> tc <span class="token keyword">To</span> tc <span class="token operator">+</span> <span class="token number">2</span>
                                <span class="token keyword">If</span> <span class="token function">Len</span><span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>tmpr<span class="token punctuation">,</span> tmpc<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&gt;</span> <span class="token number">1</span> <span class="token keyword">Then</span>
                                    tStr <span class="token operator">=</span> tStr <span class="token operator">&amp;</span> Cells<span class="token punctuation">(</span>tmpr<span class="token punctuation">,</span> tmpc<span class="token punctuation">)</span>
                                <span class="token keyword">End</span> <span class="token keyword">If</span>
                            <span class="token keyword">Next</span>
                        <span class="token keyword">Next</span>
                        <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
                            <span class="token keyword">If</span> <span class="token function">Len</span><span class="token punctuation">(</span>tStr<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">Len</span><span class="token punctuation">(</span>Replace<span class="token punctuation">(</span>tStr<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>
                                <span class="token keyword">For</span> tmpr <span class="token operator">=</span> tr <span class="token keyword">To</span> tr <span class="token operator">+</span> <span class="token number">2</span>
                                    <span class="token keyword">For</span> tmpc <span class="token operator">=</span> tc <span class="token keyword">To</span> tc <span class="token operator">+</span> <span class="token number">2</span>
                                        <span class="token keyword">If</span> InStr<span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>tmpr<span class="token punctuation">,</span> tmpc<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
                                               Cells<span class="token punctuation">(</span>tmpr<span class="token punctuation">,</span> tmpc<span class="token punctuation">)</span> <span class="token operator">=</span> i
                                               <span class="token keyword">GoTo</span> 填写
                                        <span class="token keyword">End</span> <span class="token keyword">If</span>
                                    <span class="token keyword">Next</span>
                                <span class="token keyword">Next</span>
                            <span class="token keyword">End</span> <span class="token keyword">If</span>
                        <span class="token keyword">Next</span> 
                <span class="token keyword">Next</span>
       <span class="token keyword">Next</span>

       <span class="token keyword">For</span> r <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
           <span class="token keyword">For</span> c <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
                <span class="token keyword">If</span> <span class="token function">Len</span><span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token keyword">Then</span>
                    <span class="token comment">'找到可填数字最少的未定单元格（也就是其中字符串长度最短的），使堆栈最小</span>
                    tmpLen <span class="token operator">=</span> <span class="token number">17</span>
                    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
                        <span class="token keyword">For</span> j <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token number">9</span>
                           <span class="token keyword">If</span> <span class="token function">Len</span><span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&gt;</span> <span class="token number">1</span> <span class="token keyword">And</span> <span class="token function">Len</span><span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> tmpLen <span class="token keyword">Then</span>
                                tmpLen <span class="token operator">=</span> <span class="token function">Len</span><span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span>
                                targetRow <span class="token operator">=</span> i
                                targetCol <span class="token operator">=</span> j
                           <span class="token keyword">End</span> <span class="token keyword">If</span>
                        <span class="token keyword">Next</span>
                    <span class="token keyword">Next</span>
                    Range<span class="token punctuation">(</span>targetRegion<span class="token punctuation">)</span>.Copy
                    p <span class="token operator">=</span> <span class="token number">1</span>
                    s <span class="token operator">=</span> Replace<span class="token punctuation">(</span>Cells<span class="token punctuation">(</span>targetRow<span class="token punctuation">,</span> targetCol<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
                    <span class="token comment">'将所有可能情况入栈，最后一种可能情况直接在目标区修改</span>
                    <span class="token keyword">While</span> p <span class="token operator">&lt;</span> <span class="token function">Len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
                        stackR <span class="token operator">=</span> stackR <span class="token operator">+</span> <span class="token number">10</span>
                        Range<span class="token punctuation">(</span><span class="token string">"A"</span> <span class="token operator">&amp;</span> stackR<span class="token punctuation">)</span>.<span class="token keyword">Select</span>
                        Paste
                        Cells<span class="token punctuation">(</span>stackR <span class="token operator">+</span> targetRow <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> targetCol<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Mid</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> p<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
                        p <span class="token operator">=</span> p <span class="token operator">+</span> <span class="token number">1</span>
                    <span class="token keyword">Wend</span>
                    Cells<span class="token punctuation">(</span>targetRow<span class="token punctuation">,</span> targetCol<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Mid</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> p<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token keyword">GoTo</span> 填写
                <span class="token keyword">End</span> <span class="token keyword">If</span>
           <span class="token keyword">Next</span>
       <span class="token keyword">Next</span>  

    <span class="token keyword">Else</span>
     <span class="token keyword">GoTo</span> 填写
    <span class="token keyword">End</span> <span class="token keyword">If</span>
   Application.ScreenUpdating <span class="token operator">=</span> <span class="token keyword">True</span>
   endTime <span class="token operator">=</span> Now<span class="token punctuation">(</span><span class="token punctuation">)</span>
   MsgBox <span class="token string">"~\(≧▽≦)/~，解决了!耗时："</span> <span class="token operator">+</span> Application.<span class="token function">Text</span><span class="token punctuation">(</span>endTime <span class="token operator">-</span> startTime<span class="token punctuation">,</span> <span class="token string">"m:s"</span><span class="token punctuation">)</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1d01be4ec0573745fdaddf0c250edbce/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">springboot/java/php/node/python儿童早教课程管理系统【计算机毕设】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fbf1f3a57cccffade9fa88fa63e3fb13/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">全球 IPv4 耗尽，下月开始收费！开发者尝试迁移：IPv6 是一场“灾难”，没有可以直接用的东西...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>