<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【二分图|推理&#43;最大匹配】POJ-1043 What&#39;s In A Name? - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【二分图|推理&#43;最大匹配】POJ-1043 What&#39;s In A Name?" />
<meta property="og:description" content="What&#39;s In A Name? Time Limit: 1000MS Memory Limit: 10000K Description
The FBI is conducting a surveillance of a known criminal hideout which serves as a communication center for a number of men and women of nefarious intent. Using sophisticated decryption software and good old fashion wiretaps, they are able to decode any e-mail messages leaving the site. However, before any arrest warrants can be served, they must match actual names with the user ID&#39;s on the messages." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c2677ff61ddee4101a715c1b5ddc79b2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-11-07T21:26:07+08:00" />
<meta property="article:modified_time" content="2014-11-07T21:26:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【二分图|推理&#43;最大匹配】POJ-1043 What&#39;s In A Name?</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="ptt" lang="en-US" style="text-align:center; font-size:18pt; font-weight:bold; color:blue">
  What's In A Name? 
</div> 
<div class="plm" style="text-align:center; font-size:14px"> 
 <table align="center"><tbody><tr><td><strong>Time Limit:</strong> 1000MS</td><td width="10px"> </td><td><strong>Memory Limit:</strong> 10000K</td></tr><tr><td> </td><td width="10px"> </td><td> </td></tr></tbody></table> 
</div> 
<p class="pst" style="font-size:18pt; font-weight:bold; color:blue">Description</p> 
<div class="ptx" lang="en-US" style="font-family:'Times New Roman',Times,serif; font-size:14px">
  The FBI is conducting a surveillance of a known criminal hideout which serves as a communication center for a number of men and women of nefarious intent. Using sophisticated decryption software and good old fashion wiretaps, they are able to decode any e-mail messages leaving the site. However, before any arrest warrants can be served, they must match actual names with the user ID's on the messages. While these criminals are evil, they're not stupid, so they use random strings of letters for  
 <br> their ID's (no dillingerj ID's found here). The FBI knows that each criminal uses only one ID. The only other information they have which will help them is a log of names of the people who enter and leave the hideout. In many cases, this is enough to link the names to the ID's. 
</div> 
<p class="pst" style="font-size:18pt; font-weight:bold; color:blue">Input</p> 
<div class="ptx" lang="en-US" style="font-family:'Times New Roman',Times,serif; font-size:14px">
  Input consists of one problem instance. The first line contains a single positive integer n indicating the number of criminals using the hideout. The maximum value for n will be 20. The next line contains the n user ID's, separated by single spaces. Next will be the log entries in chronological order. Each entry in the log has the form type arg , where type is either E, L or M: E indicates that criminal arg has entered the hideout; L indicates criminal arg has left the hideout; M indicates a message was intercepted from user ID arg. A line containing only the letter Q indicates the end of the log. Note that not all user ID's may be present in the log but each criminal name will be guaranteed to be in the log at least once. At the start of the log, the hideout is presumed to be empty. All names and user ID's consist of only lowercase letters and have length at most 20. Note: The line containing only the user ID's may contain more than 80 characters. 
</div> 
<p class="pst" style="font-size:18pt; font-weight:bold; color:blue">Output</p> 
<div class="ptx" lang="en-US" style="font-family:'Times New Roman',Times,serif; font-size:14px">
  Output consists of n lines, each containing a list of criminal names and their corresponding user ID's, if known. The list should be sorted in alphabetical order by the criminal names. Each line has the form name:userid , where name is the criminal's name and userid is either their user ID or the string ??? if their user ID could not be determined from the surveillance log. 
</div> 
<p class="pst" style="font-size:18pt; font-weight:bold; color:blue">Sample Input</p> 
<pre class="sio" style="font-family:'Courier New',Courier,monospace; font-size:14px">7 
bigman mangler sinbad fatman bigcheese frenchie capodicapo 
E mugsy 
E knuckles 
M bigman 
M mangler 
L mugsy 
E clyde 
E bonnie 
M bigman 
M fatman 
M frenchie 
L clyde 
M fatman 
E ugati 
M sinbad 
E moriarty 
E booth 
Q </pre> 
<p class="pst" style="font-size:18pt; font-weight:bold; color:blue">Sample Output</p> 
<pre class="sio" style="font-family:'Courier New',Courier,monospace; font-size:14px">bonnie:fatman
booth:???
clyde:frenchie
knuckles:bigman
moriarty:???
mugsy:mangler
ugati:sinbad</pre> 
<div> 
 <span style="font-size:14px">————————————————————緻密な分割線————————————————————</span> 
</div> 
<div> 
 <span style="font-size:18px">前言：你是大侦探吗？（我看了题解和代码……唉）</span> 
</div> 
<div> 
 <span style="font-size:18px">思路：我们不知道关在一个小黑屋里的ID和人名之间的关系。</span> 
</div> 
<div> 
 <span style="font-size:18px">就算我们知道一些可能的关系，但是我们很难知道全部的可能关系。</span> 
</div> 
<div> 
 <span style="font-size:18px">正常思维建图一定会漏。</span> 
</div> 
<div> 
 <span style="font-size:18px">但是我们可以利用排除法～</span> 
</div> 
<div> 
 <span style="font-size:18px">不在小黑屋里的人一定不可能拥有小黑屋里面存在的ID～</span> 
</div> 
<div> 
 <span style="font-size:18px">通过不可能的关系，可以确定不可能的边。</span> 
</div> 
<div> 
 <span style="font-size:18px">而求匹配数的时候，剩余的都是可能关系。</span> 
</div> 
<div> 
 <span style="font-size:18px">求完了之后，枚举每个可能关系，删除它，再求一次最大匹配，如果匹配数减少，说明删除了一个唯一对应的关系。</span> 
</div> 
<div> 
 <span style="font-size:18px">代码如下：</span> 
</div> 
<div> 
 <span style="font-size:18px"></span> 
 <pre><code class="language-cpp">/*
ID: j.sure.1
PROG:
LANG: C++
*/
/****************************************/
#include &lt;cstdio&gt;
#include &lt;cstdlib&gt;
#include &lt;cstring&gt;
#include &lt;algorithm&gt;
#include &lt;ctime&gt;
#include &lt;cmath&gt;
#include &lt;stack&gt;
#include &lt;queue&gt;
#include &lt;vector&gt;
#include &lt;set&gt;
#include &lt;map&gt;
#include &lt;string&gt;
#include &lt;climits&gt;
#include &lt;iostream&gt;
#define LL long long
using namespace std;
const int INF = 0x3f3f3f3f;
/****************************************/
const int N = 25;
int nx, ny, cou[N], tot, relat[N];
bool vis[N], in[N], G[N][N];
map &lt;string, int&gt; name, ID;
map &lt;string, int&gt;::iterator it1, it2;
set &lt;int&gt; hide;
set &lt;int&gt;::iterator its;

void init()
{
	ny = 0;
	memset(relat, -1, sizeof(relat));
	memset(G, 0, sizeof(G));
	hide.clear(); ID.clear(); name.clear();
}

int dfs(int u)
{
	for(int v = 0; v &lt; nx; v++) {
		if(!G[u][v] &amp;&amp; !vis[v]) {//对可能的关系进行匹配
			vis[v] = true;
			if(cou[v] == -1 || dfs(cou[v])) {
				cou[v] = u;
				return 1;
			}
		}
	}
	return 0;
}

int match()
{
	int ret = 0;
	memset(cou, -1, sizeof(cou));
	for(int i = 0; i &lt; nx; i++) {
		memset(vis, 0, sizeof(vis));
		ret += dfs(i);
	}
	return ret;
}

void solve(int ans)
{
	for(int i = 0; i &lt; nx; i++) {
		for(int j = 0; j &lt; nx; j++) if(!G[i][j]) {
			G[i][j] = 1;//枚举删除某个匹配，若删除的是唯一匹配，匹配数会减少
			int t = match();
			G[i][j] = 0;
			if(t &lt; ans) {
				relat[i] = j;
				break;
			}
		}
	}
}

void PR()
{
	for(it1 = name.begin(); it1 != name.end(); it1++) {
		int &amp;i = it1-&gt;second;
		if(relat[i] != -1) {
			for(it2 = ID.begin(); it2 != ID.end(); it2++) {
				if(it2-&gt;second == relat[i]) {
					cout &lt;&lt; it1-&gt;first &lt;&lt; ":" &lt;&lt; it2-&gt;first &lt;&lt; endl;
					break;
				}
			}
		}
		else {
			cout &lt;&lt; it1-&gt;first &lt;&lt; ":???" &lt;&lt; endl;
		}
	}
}

int main()
{
#ifdef J_Sure
//	freopen("000.in", "r", stdin);
//	freopen(".out", "w", stdout);
#endif
	while(~scanf("%d", &amp;nx)) {
		init();
		char s[30], op[2];
		for(int i = 0; i &lt; nx; i++) {
			scanf("%s", s);
			ID[s] = i;
		}
		while(scanf("%s", op), op[0] != 'Q') {
			scanf("%s", s);
			if(op[0] == 'E') {
				if(!name.count(s)) name[s] = ny++;
				hide.insert(name[s]);
			}
			else if(op[0] == 'L') {
				its = hide.find(name[s]);
				hide.erase(its);
			}
			else if(op[0] == 'M') {//每拦截到一个ID，遍历不在房间里的人，建反边
				int v = ID[s];
				memset(in, 0, sizeof(in));
				for(its = hide.begin(); its != hide.end(); its++) {
					in[*its] = 1;//给藏匿点的人染色
				}
				for(int u = 0; u &lt; nx; u++) if(!in[u]) {
					G[u][v] = 1;//不可能关系的边
				}
			}
		}
		int ans = match();
		solve(ans);
		PR();
	}
	return 0;
}
</code></pre> 
 <br> 
 <br> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/645f42f4a3af4819a942c68fce8e394c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">串行通信  现场总线（网络）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d08c13fefacebb36d24eaa3dc68205ed/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">内存分配—new，malloc，calloc</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>