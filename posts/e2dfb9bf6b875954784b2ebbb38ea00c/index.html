<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Selenium基础 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Selenium基础" />
<meta property="og:description" content="最近在学习爬虫的有关知识，发现一个很有意思的工具Selenium，所以打算花点时间看Selenium提供的手册来学习，为了防止以后忘记和方便复习，打算记录一下我的学习过程，我使用的Selenium版本是4.8.2。
目录
Selenium概述
网页操作
创建驱动会话
导航网页和关闭网页
刷新网页
退回上一页
前进下一页
查询与定位元素
获取元素信息
Actions接口交互
键盘操作
键盘按下和释放
键盘输入
键盘输入清除
键盘复制粘贴
鼠标操作
鼠标悬停
鼠标双击
单击并且长按住
单击并且瞬间释放
右键单击
长按拖动并释放
窗口操作
获取/设置窗口大小
获取/调整窗口位置
窗口大小格式设置
屏幕截图
关闭当前页面
获取窗口句柄
窗口 / 标签切换
Selenium概述 首先我们需要知道Selenium的功能和存在的价值：Selenium是一个自动化的测试工具，它用于帮助我们实现跨浏览器的自动化测试Web应用。我将理解为是通过提供一些工具帮助我们用编程语言自动化模仿浏览器的相关行为动作，其中我们常使用的API和协议是WebDriver。它定义了一个可以满足很多语言的接口，帮助我们实现浏览器应用程序的自动化测试，Selenium使用手册中对它的描述还提到：
WebDriver 不要求使用应用程序代码编译其 API, 因此它本质上不具有侵入性. 因此, 您测试的应用程序与实时推送的应用程序相同
在如何具体使用WebDriver之前手册还为我们提供了一些相关术语的介绍，这里我打算列一部分出来：
1、API：API是应用程序的编程接口，我们可以通过所提供的API来实现对WebDriver的控制和操作。
2、驱动程序（代理）：这个很重要（相当于驱动遥控车的遥控器），我们使用WebDriver控制浏览器之前，我们首先要确保浏览器是可以和我们进行对话，也就是需要使用一套程序来作为中介连接浏览器和我们的控制代码，这套程序就是驱动程序。
网页操作 创建驱动会话 一个最简单的打开网页操作共分为三部：
获取驱动对话导航到对应网页关闭对话 首先我们从selenium模块里面导入webdriver。调用webdriver里面的Edge方法创建Edge浏览器的驱动对象（如果是Firefox则调用Firefox的方法、是谷歌则调用Chrome方法...）
from selenium import webdriver
driver = webdriver.Chrome()
# driver = webdriver.Edge()
# driver = webdriver.Firefox()
导航网页和关闭网页 然后我们像requests模块一样调用get方法来导航到网页：
driver.get(&#34;https://baike.baidu.com/item/百度百科&#34;)
最后打开网页后记得将我们的驱动对话给关闭：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e2dfb9bf6b875954784b2ebbb38ea00c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-06T23:29:28+08:00" />
<meta property="article:modified_time" content="2023-10-06T23:29:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Selenium基础</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>最近在学习爬虫的有关知识，发现一个很有意思的工具Selenium，所以打算花点时间看Selenium提供的手册来学习，为了防止以后忘记和方便复习，打算记录一下我的学习过程，我使用的Selenium版本是4.8.2。</p> 
<p><img alt="" height="178" src="https://images2.imgbox.com/92/4d/xP3DrBTh_o.png" width="591"></p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="-toc"></p> 
<p id="Selenium%E6%A6%82%E8%BF%B0-toc"><a href="#Selenium%E6%A6%82%E8%BF%B0" rel="nofollow">Selenium概述</a></p> 
<p id="Selenium%E4%BD%BF%E7%94%A8-toc"><a href="#Selenium%E4%BD%BF%E7%94%A8" rel="nofollow">网页操作</a></p> 
<p id="%E5%88%9B%E5%BB%BA%E9%A9%B1%E5%8A%A8%E4%BC%9A%E8%AF%9D-toc"><a href="#%E5%88%9B%E5%BB%BA%E9%A9%B1%E5%8A%A8%E4%BC%9A%E8%AF%9D" rel="nofollow">创建驱动会话</a></p> 
<p id="%E5%AF%BC%E8%88%AA%E7%BD%91%E9%A1%B5%E5%92%8C%E5%85%B3%E9%97%AD%E7%BD%91%E9%A1%B5-toc"><a href="#%E5%AF%BC%E8%88%AA%E7%BD%91%E9%A1%B5%E5%92%8C%E5%85%B3%E9%97%AD%E7%BD%91%E9%A1%B5" rel="nofollow">导航网页和关闭网页</a></p> 
<p id="%E5%88%B7%E6%96%B0%E7%BD%91%E9%A1%B5-toc"><a href="#%E5%88%B7%E6%96%B0%E7%BD%91%E9%A1%B5" rel="nofollow">刷新网页</a></p> 
<p id="%E9%80%80%E5%9B%9E%E4%B8%8A%E4%B8%80%E9%A1%B5-toc"><a href="#%E9%80%80%E5%9B%9E%E4%B8%8A%E4%B8%80%E9%A1%B5" rel="nofollow">退回上一页</a></p> 
<p id="%E5%89%8D%E8%BF%9B%E4%B8%8B%E4%B8%80%E9%A1%B5-toc"><a href="#%E5%89%8D%E8%BF%9B%E4%B8%8B%E4%B8%80%E9%A1%B5" rel="nofollow">前进下一页</a></p> 
<p id="%E6%9F%A5%E8%AF%A2%E4%B8%8E%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0-toc"><a href="#%E6%9F%A5%E8%AF%A2%E4%B8%8E%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0" rel="nofollow">查询与定位元素</a></p> 
<p id="%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E4%BF%A1%E6%81%AF-toc"><a href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E4%BF%A1%E6%81%AF" rel="nofollow">获取元素信息</a></p> 
<p id="Actions%E6%8E%A5%E5%8F%A3%E4%BA%A4%E4%BA%92-toc"><a href="#Actions%E6%8E%A5%E5%8F%A3%E4%BA%A4%E4%BA%92" rel="nofollow">Actions接口交互</a></p> 
<p id="%E9%94%AE%E7%9B%98%E6%93%8D%E4%BD%9C-toc"><a href="#%E9%94%AE%E7%9B%98%E6%93%8D%E4%BD%9C" rel="nofollow">键盘操作</a></p> 
<p id="%E9%94%AE%E7%9B%98%E6%8C%89%E4%B8%8B%E5%92%8C%E9%87%8A%E6%94%BE-toc"><a href="#%E9%94%AE%E7%9B%98%E6%8C%89%E4%B8%8B%E5%92%8C%E9%87%8A%E6%94%BE" rel="nofollow">键盘按下和释放</a></p> 
<p id="%E9%94%AE%E7%9B%98%E8%BE%93%E5%85%A5-toc"><a href="#%E9%94%AE%E7%9B%98%E8%BE%93%E5%85%A5" rel="nofollow">键盘输入</a></p> 
<p id="%E9%94%AE%E7%9B%98%E8%BE%93%E5%85%A5%E6%B8%85%E9%99%A4-toc"><a href="#%E9%94%AE%E7%9B%98%E8%BE%93%E5%85%A5%E6%B8%85%E9%99%A4" rel="nofollow">键盘输入清除</a></p> 
<p id="%E9%94%AE%E7%9B%98%E5%A4%8D%E5%88%B6%E7%B2%98%E8%B4%B4-toc"><a href="#%E9%94%AE%E7%9B%98%E5%A4%8D%E5%88%B6%E7%B2%98%E8%B4%B4" rel="nofollow">键盘复制粘贴</a></p> 
<p id="%E9%BC%A0%E6%A0%87-toc"><a href="#%E9%BC%A0%E6%A0%87" rel="nofollow">鼠标操作</a></p> 
<p id="%E9%BC%A0%E6%A0%87%E6%82%AC%E5%81%9C-toc"><a href="#%E9%BC%A0%E6%A0%87%E6%82%AC%E5%81%9C" rel="nofollow">鼠标悬停</a></p> 
<p id="%E9%BC%A0%E6%A0%87%E5%8F%8C%E5%87%BB-toc"><a href="#%E9%BC%A0%E6%A0%87%E5%8F%8C%E5%87%BB" rel="nofollow">鼠标双击</a></p> 
<p id="%E5%8D%95%E5%87%BB%E5%B9%B6%E4%B8%94%E9%95%BF%E6%8C%89%E4%BD%8F-toc"><a href="#%E5%8D%95%E5%87%BB%E5%B9%B6%E4%B8%94%E9%95%BF%E6%8C%89%E4%BD%8F" rel="nofollow">单击并且长按住</a></p> 
<p id="%E5%8D%95%E5%87%BB%E5%B9%B6%E4%B8%94%E7%9E%AC%E9%97%B4%E9%87%8A%E6%94%BE-toc"><a href="#%E5%8D%95%E5%87%BB%E5%B9%B6%E4%B8%94%E7%9E%AC%E9%97%B4%E9%87%8A%E6%94%BE" rel="nofollow">单击并且瞬间释放</a></p> 
<p id="%E5%8F%B3%E9%94%AE%E5%8D%95%E5%87%BB-toc"><a href="#%E5%8F%B3%E9%94%AE%E5%8D%95%E5%87%BB" rel="nofollow">右键单击</a></p> 
<p id="%E9%95%BF%E6%8C%89%E6%8B%96%E5%8A%A8%E5%B9%B6%E9%87%8A%E6%94%BE-toc"><a href="#%E9%95%BF%E6%8C%89%E6%8B%96%E5%8A%A8%E5%B9%B6%E9%87%8A%E6%94%BE" rel="nofollow">长按拖动并释放</a></p> 
<p id="%E7%AA%97%E5%8F%A3%E6%93%8D%E4%BD%9C-toc"><a href="#%E7%AA%97%E5%8F%A3%E6%93%8D%E4%BD%9C" rel="nofollow">窗口操作</a></p> 
<p id="%E8%8E%B7%E5%8F%96%2F%E8%AE%BE%E7%BD%AE%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F-toc"><a href="#%E8%8E%B7%E5%8F%96%2F%E8%AE%BE%E7%BD%AE%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F" rel="nofollow">获取/设置窗口大小</a></p> 
<p id="%E8%8E%B7%E5%8F%96%2F%E8%B0%83%E6%95%B4%E7%AA%97%E5%8F%A3%E4%BD%8D%E7%BD%AE-toc"><a href="#%E8%8E%B7%E5%8F%96%2F%E8%B0%83%E6%95%B4%E7%AA%97%E5%8F%A3%E4%BD%8D%E7%BD%AE" rel="nofollow">获取/调整窗口位置</a></p> 
<p id="%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F%E6%A0%BC%E5%BC%8F%E8%AE%BE%E7%BD%AE-toc"><a href="#%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F%E6%A0%BC%E5%BC%8F%E8%AE%BE%E7%BD%AE" rel="nofollow">窗口大小格式设置</a></p> 
<p id="%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE-toc"><a href="#%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE" rel="nofollow">屏幕截图</a></p> 
<p id="%E5%85%B3%E9%97%AD%E5%BD%93%E5%89%8D%E9%A1%B5%E9%9D%A2-toc"><a href="#%E5%85%B3%E9%97%AD%E5%BD%93%E5%89%8D%E9%A1%B5%E9%9D%A2" rel="nofollow">关闭当前页面</a></p> 
<p id="%E8%8E%B7%E5%8F%96%E7%AA%97%E5%8F%A3%E5%8F%A5%E6%9F%84-toc"><a href="#%E8%8E%B7%E5%8F%96%E7%AA%97%E5%8F%A3%E5%8F%A5%E6%9F%84" rel="nofollow">获取窗口句柄</a></p> 
<p id="%E7%AA%97%E5%8F%A3%20%2F%20%E6%A0%87%E7%AD%BE%E5%88%87%E6%8D%A2-toc"><a href="#%E7%AA%97%E5%8F%A3%20%2F%20%E6%A0%87%E7%AD%BE%E5%88%87%E6%8D%A2" rel="nofollow">窗口 / 标签切换</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="Selenium%E6%A6%82%E8%BF%B0">Selenium概述</h2> 
<p>首先我们需要知道Selenium的功能和存在的价值：Selenium是一个自动化的测试工具，它用于帮助我们实现跨浏览器的自动化测试Web应用。我将理解为是通过提供一些工具帮助我们用编程语言自动化模仿浏览器的相关行为动作，其中我们常使用的API和协议是<strong>WebDriver</strong>。它定义了一个可以满足很多语言的接口，帮助我们实现浏览器应用程序的自动化测试，Selenium使用手册中对它的描述还提到：</p> 
<blockquote> 
 <p><strong>WebDriver 不要求使用应用程序代码编译其 API, 因此它本质上不具有侵入性. 因此, 您测试的应用程序与实时推送的应用程序相同</strong></p> 
</blockquote> 
<p>在如何具体使用WebDriver之前手册还为我们提供了一些相关术语的介绍，这里我打算列一部分出来：</p> 
<p>1、API：API是应用程序的编程接口，我们可以通过所提供的API来实现对WebDriver的控制和操作。</p> 
<p>2、驱动程序（代理）：这个很重要（相当于驱动遥控车的遥控器），我们使用WebDriver控制浏览器之前，我们首先要确保浏览器是可以和我们进行对话，也就是需要使用一套程序来作为中介连接浏览器和我们的控制代码，这套程序就是驱动程序。</p> 
<p><img alt="" height="319" src="https://images2.imgbox.com/a8/67/zly1q0EX_o.png" width="680"></p> 
<h2 id="Selenium%E4%BD%BF%E7%94%A8">网页操作</h2> 
<h4 id="%E5%88%9B%E5%BB%BA%E9%A9%B1%E5%8A%A8%E4%BC%9A%E8%AF%9D">创建驱动会话</h4> 
<p>一个最简单的打开网页操作共分为三部：</p> 
<ul><li>获取驱动对话</li><li>导航到对应网页</li><li>关闭对话</li></ul> 
<p>首先我们从selenium模块里面导入webdriver。调用webdriver里面的Edge方法创建Edge浏览器的驱动对象（如果是Firefox则调用Firefox的方法、是谷歌则调用Chrome方法...）</p> 
<blockquote> 
 <p><strong>from selenium import webdriver</strong></p> 
 <p></p> 
 <p><strong>driver = webdriver.Chrome()<br> # driver = webdriver.Edge()<br> # driver = webdriver.Firefox()</strong></p> 
</blockquote> 
<h4 id="%E5%AF%BC%E8%88%AA%E7%BD%91%E9%A1%B5%E5%92%8C%E5%85%B3%E9%97%AD%E7%BD%91%E9%A1%B5">导航网页和关闭网页</h4> 
<p>然后我们像requests模块一样调用get方法来导航到网页：</p> 
<blockquote> 
 <p><strong>driver.get("https://baike.baidu.com/item/百度百科")</strong></p> 
</blockquote> 
<p>最后打开网页后记得将我们的驱动对话给关闭：</p> 
<blockquote> 
 <p><strong>driver.quit()</strong></p> 
</blockquote> 
<pre><code class="language-python">from selenium import webdriver
driver = webdriver.Edge()
driver.get("https://baike.baidu.com/item/百度百科")
driver.quit()</code></pre> 
<p>最后实现的效果如下，如果想让浏览器停一下目前可以先调用sleep函数来暂停一下。</p> 
<p><img alt="" height="360" src="https://images2.imgbox.com/7a/1e/IJmn96pd_o.gif" width="640"></p> 
<h4 id="%E5%88%B7%E6%96%B0%E7%BD%91%E9%A1%B5">刷新网页</h4> 
<p>刷新网页就是我们键盘中的F5的功能，我们调用驱动会话中的refresh方法进行刷新：</p> 
<blockquote> 
 <p><strong>driver.refresh()</strong></p> 
</blockquote> 
<h4 id="%E9%80%80%E5%9B%9E%E4%B8%8A%E4%B8%80%E9%A1%B5">退回上一页</h4> 
<p>退回上一页就是回到上一个跳转的页面</p> 
<p><img alt="" height="288" src="https://images2.imgbox.com/c9/56/eT2dfCLJ_o.png" width="307"></p> 
<p>我们常用下面的方法来实现：</p> 
<blockquote> 
 <p><strong>driver.back()</strong></p> 
</blockquote> 
<h4 id="%E5%89%8D%E8%BF%9B%E4%B8%8B%E4%B8%80%E9%A1%B5">前进下一页</h4> 
<p>前进上一页就是快进到下一个的页面</p> 
<p><img alt="" height="287" src="https://images2.imgbox.com/52/81/873p8PBM_o.png" width="309"></p> 
<p>我们常用下面的方法来实现：</p> 
<blockquote> 
 <p>driver.forward()</p> 
</blockquote> 
<h2 id="%E6%9F%A5%E8%AF%A2%E4%B8%8E%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0">查询与定位元素</h2> 
<p>常看到的网页由多个元素组合而成，我们利用selenium创建的操作会话可以用来定位到我们打开的网页里面的某个信息，一般来说是调用创建的驱动会话driver里的find_element方法来查找单个元素、find_elements来查找多个元素；find_element它会返回<strong>第一个</strong>符合要求的标签的位置信息，而find_elements会返回符合条件的所有标签位置信息元组，我们可以通过这些信息来找到里面的内容或者作为中介继续向下找内容：</p> 
<blockquote> 
 <p><strong>driver.find_element(By.查找方式, "值")</strong></p> 
 <p><strong>driver.find_elements(By.查找方式, "值")</strong></p> 
</blockquote> 
<p>但是要记得在使用之前要从selenimu里面将By导入！！！</p> 
<blockquote> 
 <p><strong>from selenium.webdriver.common.by import By</strong></p> 
</blockquote> 
<p>随后我们就可以根据不同的定位方式来定位到某一个标签，WebDriver在为我们提供了8种搜索方式可供我们选择，：</p> 
<table border="1" cellpadding="1" cellspacing="1"><tbody><tr><th>参数1 </th><th>参数2</th></tr><tr><td>CLASS_NAME</td><td>定位class属性与搜索值匹配的元素（不允许使用复合类名）</td></tr><tr><td>CSS_SELECTOR</td><td>定位 CSS 选择器匹配的元素</td></tr><tr><td>ID</td><td>定位 id 属性与搜索值匹配的元素</td></tr><tr><td>NAME</td><td>定位 name 属性与搜索值匹配的元素</td></tr><tr><td>lLINK_TEXT</td><td>定位link text可视文本与搜索值完全匹配的锚元素</td></tr><tr><td>PARTIAL_LINK_TEXT</td><td>定位link text可视文本部分与搜索值部分匹配的锚点元素。如果匹配多个元素，则只选择第一个元素。</td></tr><tr><td>TAG_NAME</td><td>定位标签名称与搜索值匹配的元素</td></tr><tr><td>XPATH</td><td>定位与 XPath 表达式匹配的元素</td></tr></tbody></table> 
<p>以获取百度首页的热搜第三条为例，我们按下F12查看当前页面的元素element界面即可获取到这段我们想要获取的信息所处的标签的相关信息，利用这些标签信息就可以拿到我们所需的内容。</p> 
<p><img alt="" height="271" src="https://images2.imgbox.com/39/f1/KjFpfHnU_o.png" width="612"></p> 
<p>该文字段所处的标签的位置：</p> 
<p><img alt="" height="33" src="https://images2.imgbox.com/e8/5b/v9OTjGV3_o.png" width="579"></p> 
<p><strong>ID+TAG_NAME的方式：</strong></p> 
<pre><code class="language-python">from selenium import webdriver
from selenium.webdriver.common.by import By
driver = webdriver.Edge()
driver.get("https://www.baidu.com/")
ret = driver.find_element(By.ID, "hotsearch-content-wrapper").find_elements(By.TAG_NAME,"span" )
print(ret[4].text)
driver.quit()</code></pre> 
<p><strong>CSS的方式：</strong></p> 
<pre><code class="language-python">from selenium import webdriver
from selenium.webdriver.common.by import By
driver = webdriver.Edge()
driver.get("https://www.baidu.com/")
print(driver.find_element(By.CSS_SELECTOR, "#hotsearch-content-wrapper &gt; li:nth-child(2) &gt; a &gt; span.title-content-title").text)
driver.quit()</code></pre> 
<p><strong>XPTH的方式：</strong></p> 
<pre><code class="language-python">from selenium import webdriver
from selenium.webdriver.common.by import By
driver = webdriver.Edge()
driver.get("https://www.baidu.com/")
print(driver.find_element(By.XPATH, "//*[@id='hotsearch-content-wrapper']/li[2]/a/span[2]").text)
driver.quit()</code></pre> 
<h2 id="%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E4%BF%A1%E6%81%AF">获取元素信息</h2> 
<p>网页中的元素或者页面结构等会有很多信息，下面我们来看看如何获取一些元素的信息</p> 
<p><strong>查看元素是否显示的信息：</strong></p> 
<p>网页中有很多元素，但有时候如果出现某些问题，或许一些元素没有办法在上下文中显示出来，为了检查有没有正确显示某个函数，我们利用find_element下的.is_displayed方法确定，如果正确显示则返回True，反之为False</p> 
<blockquote> 
 <p><strong>check = driver.find_element(By.查找方式, "值").is_displayed()</strong></p> 
</blockquote> 
<p><strong>查看元素是否选定的信息：</strong></p> 
<p>selenium中提供了一个方法供我们判断当前页面的某个元素是否正在被选中，是则返回True，反之为False，这个功能常用于选择元素</p> 
<blockquote> 
 <p><strong>check = driver.find_element(By.查找方式, "值").is_selected()</strong></p> 
</blockquote> 
<p><strong>查看元素是否启用的信息：</strong></p> 
<p>页面中的某些元素可能由于某些情况会被禁用，所有我们需要有一个方法来判断当前元素是否目前是启用的，是则返回True，反之为False</p> 
<blockquote> 
 <p><strong>check = driver.find_element(By.查找方式, "值").is_enabled()</strong></p> 
</blockquote> 
<p><strong>查看元素的文本内容：</strong></p> 
<p>我们需要的网页内容很多情况下是存在于元素标签中的，要想获取元素标签中的信息，我们常用text属性</p> 
<blockquote> 
 <p><strong>text = driver.find_element(BBy.查找方式, "值").text()</strong></p> 
</blockquote> 
<p><strong>查看元素的标签名和CSS值：</strong></p> 
<p>我们利用下面的方法来获取元素的标签名</p> 
<blockquote> 
 <p><strong>tag_name = driver.find_element(By.查找方式, "值").tag_name</strong></p> 
</blockquote> 
<p><img alt="" height="26" src="https://images2.imgbox.com/f4/e0/hQFkpuJW_o.png" width="557">  </p> 
<p><strong>查看元素的位置信息：</strong></p> 
<p>一个元素在我们的页面是有自己的特定x、y坐标以及它的长宽等信息，这些信息我们都可以通过下面的方法获取：</p> 
<blockquote> 
 <p><strong>position = driver.find_element(By.查找方式, "值").rect</strong></p> 
</blockquote> 
<p>获取的某个元素位置信息： </p> 
<p><img alt="" height="42" src="https://images2.imgbox.com/4b/c3/NPMuXlQu_o.png" width="655"></p> 
<p><strong>查看元素的属性：</strong></p> 
<p>我们知道，元素标签里面会含有很多属性，这些属性不在标签里面夹着，这是在标签的尖角括号里面，我们要想拿到这些标签就需要使用<strong>get_attribute()</strong>这个方法，向其传入要查找的属性名即可返回对应属性名的属性值</p> 
<blockquote> 
 <p><strong>href = driver.find_element(By.查找方式, "值").get_attribute('href')</strong></p> 
</blockquote> 
<blockquote> 
 <p><strong>target = driver.find_element(By.查找方式, "值").get_attribute('target')</strong></p> 
</blockquote> 
<p>这样我们就可以拿到a标签里面的href和target属性信息了：</p> 
<p>网页：</p> 
<p><img alt="" height="64" src="https://images2.imgbox.com/a3/ec/4mttNWAT_o.png" width="1200"></p> 
<p>输出： </p> 
<p><img alt="" height="116" src="https://images2.imgbox.com/3c/b4/SdI8NX6p_o.png" width="1200"></p> 
<h2 id="Actions%E6%8E%A5%E5%8F%A3%E4%BA%A4%E4%BA%92">Actions接口交互</h2> 
<p>首先我们要知道Actions是一个什么东西：Actions是一个低级的<strong>接口</strong>，能够向Web服务器提供虚拟化的输入。我们使用浏览器经常要用到鼠标、键盘等进行点击和键盘输入操作，下面我们来看看如何用Selenium给我们提供的Actions接口来模拟实现这些操作。</p> 
<h3 id="%E9%94%AE%E7%9B%98%E6%93%8D%E4%BD%9C">键盘操作</h3> 
<p>selenium中支持许多键盘按键，但是键盘主要的动作归根结底就是两个：按下和放开。这两个动作对应在selenium中就使用key_down和key_up两个方法来模拟。</p> 
<h4 id="%E9%94%AE%E7%9B%98%E6%8C%89%E4%B8%8B%E5%92%8C%E9%87%8A%E6%94%BE"><strong>键盘按下和释放</strong></h4> 
<p>关于键盘按下和释放我们使用的是key_down和key_up方法，这两个方法位于类Actionchains中（Actionchains中记得传输驱动会话参数），同时按键存储在类Keys中，所以为了使用方便，在使用之前我们可以先将对应的方法直接导入：</p> 
<pre><code class="language-python">from selenium.webdriver import ActionChains
from selenium.webdriver import Keys</code></pre> 
<p>当我们想在新打开的页面中按下shift和松开shift键就是使用下面的函数，它的参数就是我们要操作的按键，注意最后要调用perform()方法，否则操作会不显示出来。</p> 
<blockquote> 
 <p><strong>ActionChains(driver).key_down(Keys.SHIFT).perform()<br> ActionChains(driver).key_up(Keys.SHIFT).perform()</strong></p> 
</blockquote> 
<p>因为驱动会话会记录我们输入过的操作指令，即使我们创建一个新的Actions类它也会记录我们之前的指针位置。所以如果我们想要进行连续的操作，需要在上次操作的基础上最后再加上ActionBuilder(driver).clear_actions()这个方法对驱动会话进行指令清理。</p> 
<h4 id="%E9%94%AE%E7%9B%98%E8%BE%93%E5%85%A5"><strong>键盘输入</strong></h4> 
<p>虽然我们有key_down和key_up两个方法表示按键的松紧，但是我们很多情况下发送信息都是由专门的方法进行发送到，这个方法就是send_keys，并且它不需要使用到Actionchains这个类</p> 
<blockquote> 
 <p><strong>driver.find_element().send_keys(“文本内容”)</strong></p> 
</blockquote> 
<p>这个方法的主要思路是我们先找到页面中等待输入的元素，然后在找到的元素位置的基础上调用这个函数直接发送文本信息。</p> 
<p> 我们使用该方法打开百度然后搜索搜狗：</p> 
<pre><code class="language-python">from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from time import *

driver = webdriver.Edge()
driver.get("https://www.baidu.com")
sleep(2)
driver.find_element(By.XPATH, "//*[@id='kw']").send_keys("搜狗"+Keys.ENTER)
sleep(5)
driver.quit()</code></pre> 
<p>执行结果：</p> 
<p><img alt="" height="360" src="https://images2.imgbox.com/82/ba/QLDc9cLM_o.gif" width="640"></p> 
<p>或者我们还可以使用Actionchains里的键入方法来进行输入，这就需要调用里面自带的send_keys_to_element方法了</p> 
<blockquote> 
 <p><strong>ActionChains(driver).send_keys_to_element( 定位到的输入的位置,"输入内容").perform()</strong></p> 
</blockquote> 
<p>例如输入hello：</p> 
<pre><code class="language-python">from selenium import webdriver
from time import *
from selenium.webdriver import ActionChains
from selenium.webdriver import Keys
from selenium.webdriver.common.actions.action_builder import ActionBuilder
from selenium.webdriver.common.by import By
driver = webdriver.Edge()
driver.get("https://www.baidu.com/")
ret = driver.find_element(By.XPATH, "//*[@id='kw']")
ActionChains(driver).send_keys_to_element( ret,"hello").perform()
ActionBuilder(driver).clear_actions()
driver.quit()</code></pre> 
<h4 id="%E9%94%AE%E7%9B%98%E8%BE%93%E5%85%A5%E6%B8%85%E9%99%A4"><strong>键盘输入清除</strong></h4> 
<p>我们刚才在上面利用send_keys进行了输入，但是有时候我们往往需要对输入内容进行清空，这时候就需要使用我们的输入清空的方法了：</p> 
<p><strong>driver.find_element().clear()</strong></p> 
<p>例如我们将刚才输入的搜狗清除掉，改为输入360：</p> 
<pre><code class="language-python">from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from time import *

driver = webdriver.Edge()
driver.get("https://www.baidu.com")
sleep(2)
ret = driver.find_element(By.XPATH, "//*[@id='kw']")
ret.send_keys("搜狗")
sleep(2)
ret.clear()
sleep(2)
ret.send_keys("360"+Keys.ENTER)
sleep(5)
driver.quit()</code></pre> 
<p>执行结果：</p> 
<p><img alt="" height="360" src="https://images2.imgbox.com/09/e1/d9bz5uIL_o.gif" width="640"></p> 
<h4 id="%E9%94%AE%E7%9B%98%E5%A4%8D%E5%88%B6%E7%B2%98%E8%B4%B4">键盘复制粘贴</h4> 
<p>键盘的复制和粘贴也是我们常用到的操作，这里我使用send_keys来模拟实现全选、复制和粘贴：</p> 
<pre><code class="language-python">from selenium import webdriver
from time import *
from selenium.webdriver import Keys
from selenium.webdriver.common.by import By
import sys
driver = webdriver.Edge()
driver.get("https://www.baidu.com/")
ret = driver.find_element(By.XPATH, '//*[@id="kw"]')
ret.send_keys("hello")
sleep(2)
ret.send_keys(Keys.CONTROL, 'a')
sleep(2)
ret.send_keys(Keys.CONTROL, 'x')
sleep(2)
ret.send_keys(Keys.CONTROL, 'v')
sleep(2)
driver.quit()</code></pre> 
<p>执行结果：</p> 
<p><img alt="" height="360" src="https://images2.imgbox.com/da/0a/ZyIcZzE8_o.gif" width="640"></p> 
<h3 id="%E9%BC%A0%E6%A0%87">鼠标操作</h3> 
<p>我们使用鼠标常用到的操作一般是3个：点击，放开，移动。而针对这三个操作selenium中为我们提供了对应的操作方法。</p> 
<h4 id="%E9%BC%A0%E6%A0%87%E6%82%AC%E5%81%9C">鼠标悬停</h4> 
<p>鼠标悬停又被称为鼠标移动，就是将我们鼠标移动到某一个位置，它的具体实现函数是move_to_element()，需要向其传入鼠标的目标位置</p> 
<blockquote> 
 <p><strong>ActionChains(driver).move_to_element(要悬停的目标元素的位置).perform()</strong></p> 
</blockquote> 
<h4 id="%E9%BC%A0%E6%A0%87%E5%8F%8C%E5%87%BB">鼠标双击</h4> 
<p>鼠标双击也是我们常用的功能，它主要依赖方法double_click，我们照旧传入目标元素位置即可</p> 
<blockquote> 
 <p><strong>ActionChains(driver).double_click(要双击的目标元素).perform()</strong></p> 
</blockquote> 
<h4 id="%E5%8D%95%E5%87%BB%E5%B9%B6%E4%B8%94%E9%95%BF%E6%8C%89%E4%BD%8F">单击并且长按住</h4> 
<p>单击长按住的方法为调用Actionchains里面的click_and_hold方法，需要传入目标元素的位置即可</p> 
<blockquote> 
 <p><strong>ActionChains(driver).click_and_hold(点击的元素位置).perform()</strong></p> 
</blockquote> 
<h4 id="%E5%8D%95%E5%87%BB%E5%B9%B6%E4%B8%94%E7%9E%AC%E9%97%B4%E9%87%8A%E6%94%BE">单击并且瞬间释放</h4> 
<p>一个完整的鼠标动作，一般都是单击某个元素为后会进行释放动作，所以我们需要看看如何进行释放动作，一般是调用Actionchains里面的click方法，它代表单击动作</p> 
<blockquote> 
 <p><strong>ActionChains(driver).click(click_place).perform()</strong></p> 
</blockquote> 
<p>下面是一个完整的点击动作，点击百度页面的某个标签</p> 
<pre><code class="language-python">from selenium import webdriver
from time import *
from selenium.webdriver.common.by import By
from selenium.webdriver import ActionChains

driver = webdriver.Edge()
driver.get('https://www.baidu.com/')
click_place = driver.find_element(By.XPATH, '//*[@id="hotsearch-content-wrapper"]/li[2]/a/span[2]')
ActionChains(driver).click(click_place).perform()
sleep(2)
driver.quit()</code></pre> 
<h4 id="%E5%8F%B3%E9%94%AE%E5%8D%95%E5%87%BB">右键单击</h4> 
<p>对比左键，我们有时候也需要使用到右键单击，不同的是我们右键一般只有单击而不会去长按，而我们实现右键单击用的是context_click，并且传入要点击的位置即可</p> 
<blockquote> 
 <p><strong>ActionChains(driver).context_click(要右键点击的目标元素位置).perform()</strong></p> 
</blockquote> 
<h4 id="%E9%95%BF%E6%8C%89%E6%8B%96%E5%8A%A8%E5%B9%B6%E9%87%8A%E6%94%BE">长按拖动并释放</h4> 
<p>想象一下，我们经常有将文件长按并且拖动到某个位置，而selenium也为我们提供了这个功能，通过调用drag_and_drop方法，向其传入初始元素（要拖动的元素）位置和要放置的目标元素的位置即可</p> 
<blockquote> 
 <p><strong>ActionChains(driver).drag_and_drop(初始位置, 末尾位置).perform()</strong></p> 
</blockquote> 
<h2 id="%E7%AA%97%E5%8F%A3%E6%93%8D%E4%BD%9C">窗口操作</h2> 
<p>我们浏览器一般打开窗口不止会打开一个，所以我们很有必要去学校如何使用selenium里面的方法来操控这些窗口。在selenium中窗口和标签页没有进行仔细区分，不过我们都是可以通过句柄来进行控制这些窗口或者标签页。</p> 
<h4 id="%E8%8E%B7%E5%8F%96%2F%E8%AE%BE%E7%BD%AE%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F">获取/设置窗口大小</h4> 
<p>对于我们任意一个打开的窗口，它都会有一个窗口的宽和高，我们就可以通过调用driver驱动会话里面的方法get_window_size下面的get方法来获取宽和高，注意get里面的width和height不要拼错......</p> 
<blockquote> 
 <p><strong>width = driver.get_window_size().get('width')<br> height = driver.get_window_size().get('height')</strong></p> 
</blockquote> 
<p>类似地，如果我们想要设置窗口的大小可以使用set_window_size方法：</p> 
<blockquote> 
 <p><strong>driver.set_window_size(宽, 高)</strong></p> 
</blockquote> 
<h4 id="%E8%8E%B7%E5%8F%96%2F%E8%B0%83%E6%95%B4%E7%AA%97%E5%8F%A3%E4%BD%8D%E7%BD%AE">获取/调整窗口位置</h4> 
<p>selenium中也为我们提供了一些获取窗口的位置和调整窗口位置的方法，它们的使用可以和前面获取/设置窗口大小的方法来类比：</p> 
<p>获取窗口位置：</p> 
<blockquote> 
 <p><strong>x = driver.get_window_position().get('x')<br> y = driver.get_window_position().get('y')</strong></p> 
</blockquote> 
<p>调整窗口位置：</p> 
<blockquote> 
 <p><strong>driver.set_window_position(x, y)</strong></p> 
</blockquote> 
<h4 id="%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F%E6%A0%BC%E5%BC%8F%E8%AE%BE%E7%BD%AE">窗口大小格式设置</h4> 
<p>我们一般可以对窗口进行最大化、最小化、全屏等操作，selenium中也为我们提供了一些相关的操作以供我们更好操作窗口</p> 
<p><strong>窗口最大化：</strong></p> 
<blockquote> 
 <p><strong>driver.maximize_window()</strong></p> 
</blockquote> 
<p><strong>窗口最小化：</strong></p> 
<blockquote> 
 <p><strong>driver.minimize_window()</strong></p> 
</blockquote> 
<p><strong>窗口全屏：</strong></p> 
<blockquote> 
 <p><strong>driver.fullscreen_window()</strong></p> 
</blockquote> 
<p><img alt="" height="360" src="https://images2.imgbox.com/c6/0e/VwCUVtHI_o.gif" width="640"></p> 
<h4 id="%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE">屏幕截图</h4> 
<p>我们有时候或许需要对窗口的某些内容进行记录，这时候就需要我们进行屏幕截图了，在我的电脑我可以用shift+win+s来进行截图，但是selenium也为我们提供一个截图的方法，不过是整窗截图。</p> 
<blockquote> 
 <p><strong>driver.save_screenshot('图片保存位置')</strong></p> 
</blockquote> 
<p>当然我们也可以进行元素局部截图，例如我想截图百度的logo，我可以将驱动会话改为当前元素位置，然后再调用screenshot方法也可以。</p> 
<blockquote> 
 <p><strong>元素位置.screenshot('图片保存位置')</strong></p> 
</blockquote> 
<h4 id="%E5%85%B3%E9%97%AD%E5%BD%93%E5%89%8D%E9%A1%B5%E9%9D%A2">关闭当前页面</h4> 
<p>我们经常需要关闭一些页面，只保留一些有用的页面，在selenium中也为我们提供了一个类似于这样的方法：</p> 
<blockquote> 
 <p><strong>driver.close()</strong></p> 
</blockquote> 
<p>但是这个方法和driver.quit()不同，这个方法代表的只是关闭当前的页面，而quit代表的则是关闭掉整个驱动会话。</p> 
<h4 id="%E8%8E%B7%E5%8F%96%E7%AA%97%E5%8F%A3%E5%8F%A5%E6%9F%84">获取窗口句柄</h4> 
<p>selenium中提供了一个获取窗口句柄的方法current_window_handle，它是一个driver的方法，我们通过调用它就可以获取当前窗口的句柄。</p> 
<blockquote> 
 <p><strong>handle = driver.current_window_handle</strong></p> 
</blockquote> 
<h4 id="%E7%AA%97%E5%8F%A3%20%2F%20%E6%A0%87%E7%AD%BE%E5%88%87%E6%8D%A2">窗口 / 标签切换</h4> 
<p>我们有时候会打开很多标签页，而我们浏览网页的时候有时候会返回去看之前的标签页，这个过程就是一个切换标签的过程，这个切换标签的操作selenium中也为我们提供了。</p> 
<p>我们网页上的标签都会被存到一个名为window.handles的属性里面，而切换标签的动作是调用驱动会话driver里面的swith_to下面的window方法，向其传入要前往的标签句柄即可。</p> 
<blockquote> 
 <p><strong>driver.switch_to.window(目标标签的ID)</strong></p> 
</blockquote> 
<p>下面是一个切换标签的例子：</p> 
<pre><code class="language-python">from selenium import webdriver
from time import *
from selenium.webdriver.common.by import By

driver = webdriver.Edge()
driver.get("https://www.baidu.com")
original_ID = driver.current_window_handle
driver.find_element(By.XPATH, '/html/body/div[1]/div[1]/div[5]/div/div/div[3]/ul/li[1]/a').click()
sleep(2)
driver.switch_to.window(original_ID)
sleep(2)
driver.switch_to.window(driver.window_handles[1])
sleep(2)
driver.quit()</code></pre> 
<p> 实际效果：</p> 
<p><img alt="" height="360" src="https://images2.imgbox.com/fb/41/cVpEdlh3_o.gif" width="640"></p> 
<h2>无头浏览器</h2> 
<p>所谓的无头浏览器是指我们使用selenium进行自动化操作浏览器的时候浏览器不出现，只在后台进行操作。要想实现无头浏览器需要加上下面的代码：</p> 
<p>参考资料：</p> 
<p><a href="https://www.selenium.dev/zh-cn/documentation/overview/" rel="nofollow" title="Selenium操作手册">Selenium操作手册</a></p> 
<p><a href="https://blog.csdn.net/qq_43965708/article/details/120658713?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167746128916782425630298%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=167746128916782425630298&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-120658713-null-null.142%5Ev73%5Ewechat_v2,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&amp;utm_term=selenium" title="selenium用法详解【从入门到实战】【Python爬虫】【4万字】_Dream丶Killer的博客-CSDN博客">selenium用法详解【从入门到实战】【Python爬虫】【4万字】_Dream丶Killer的博客-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_54219272/article/details/123338773?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167746128916782425630298%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=167746128916782425630298&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-123338773-null-null.142%5Ev73%5Ewechat_v2,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&amp;utm_term=selenium" title="自动化测试——selenium（完结篇)_selenium自动化测试_鸢也的博客-CSDN博客">自动化测试——selenium（完结篇)_selenium自动化测试_鸢也的博客-CSDN博客</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/22428395e0ef03ce79c28508a77ee7d4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Ubuntu、stm32下的C程序中堆、栈、全局、局部等变量的分配地址</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2bf8b68de86fa3b47963bc36c8a35b44/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringBoot&#43;Vue校园管理系统(源码&#43;论文&#43;答辩PPT)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>