<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【字符串处理函数】sprintf与snprintf - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【字符串处理函数】sprintf与snprintf" />
<meta property="og:description" content="sprintf与snprintf 1、功能1.1 sprintf1.2 snprintf 2、函数说明2.1 sprintf2.1.1 函数原型2.1.2 参数列表：2.1.3 返回值： 2.2 snprintf2.2.1 函数原型2.2.2 参数列表：2.2.3 返回值 3、区别4、Demo4.1 sprintf4. 2 snprintf 1、功能 1.1 sprintf 主要功能是把格式化的数据写入某个字符串中，即发送格式化输出到 string 所指向的字符串。
主要功能是把格式化的数据写入某个字符串中，即发送格式化输出到 string 所指向的字符串。
1.2 snprintf 将可变个参数(…)按照format格式化成字符串，然后将其复制到str中。
(1) 如果格式化后的字符串长度 &lt; size，则将此字符串全部复制到str中，并给其后添加一个字符串结束符(‘\0’)；
(2) 如果格式化后的字符串长度 &gt;= size，则只将其中的(size-1)个字符复制到str中，并给其后添加一个字符串结束符(‘\0’)，返回值为欲写入的字符串长度。
2、函数说明 2.1 sprintf 2.1.1 函数原型 int sprintf(char *string, char *format [,argument,...]); 2.1.2 参数列表： string：这是指向一个字符数组的指针，该数组存储了最终格式化后的 字符串。
format：指明字符串的格式，包含了要被写入到字符串 str 的文本。它可以嵌入随后的附加参数中指定的值替换（如(“%d%c%f”, num, chr, f)，参数的个数应与 % 标签的个数相同。），按需求进行格式化。
[argument]…：根据不同的 format 字符串，函数可能需要一系列的附加参数，每个参数包含了一个要被插入的值，替换了 format 参数中指定的每个 % 标签，如(“%d%c%f”, num, chr, f)。参数的个数应与 % 标签的个数相同。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ddc63a4905412c219929ae20b9a67eb4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-11T16:18:22+08:00" />
<meta property="article:modified_time" content="2022-09-11T16:18:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【字符串处理函数】sprintf与snprintf</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>sprintf与snprintf</h4> 
 <ul><li><a href="#1_1" rel="nofollow">1、功能</a></li><li><ul><li><a href="#11_sprintf_2" rel="nofollow">1.1 sprintf</a></li><li><a href="#12_snprintf_5" rel="nofollow">1.2 snprintf</a></li></ul> 
  </li><li><a href="#2_9" rel="nofollow">2、函数说明</a></li><li><ul><li><a href="#21_sprintf_10" rel="nofollow">2.1 sprintf</a></li><li><ul><li><a href="#211__11" rel="nofollow">2.1.1 函数原型</a></li><li><a href="#212__15" rel="nofollow">2.1.2 参数列表：</a></li><li><a href="#213__19" rel="nofollow">2.1.3 返回值：</a></li></ul> 
   </li><li><a href="#22_snprintf_22" rel="nofollow">2.2 snprintf</a></li><li><ul><li><a href="#221__23" rel="nofollow">2.2.1 函数原型</a></li><li><a href="#222__27" rel="nofollow">2.2.2 参数列表：</a></li><li><a href="#223__31" rel="nofollow">2.2.3 返回值</a></li></ul> 
  </li></ul> 
  </li><li><a href="#3_35" rel="nofollow">3、区别</a></li><li><a href="#4Demo_39" rel="nofollow">4、Demo</a></li><li><ul><li><a href="#41_sprintf_40" rel="nofollow">4.1 sprintf</a></li><li><a href="#4_2_snprintf_65" rel="nofollow">4. 2 snprintf</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1_1"></a>1、功能</h2> 
<h3><a id="11_sprintf_2"></a>1.1 sprintf</h3> 
<p>  主要功能是把格式化的数据写入某个字符串中，即发送格式化输出到 string 所指向的字符串。<br>   主要功能是把格式化的数据写入某个字符串中，即发送格式化输出到 string 所指向的字符串。</p> 
<h3><a id="12_snprintf_5"></a>1.2 snprintf</h3> 
<p>将可变个参数(…)按照format格式化成字符串，然后将其复制到str中。<br>   <strong>(1)</strong> 如果格式化后的字符串长度 &lt; size，则将此字符串全部复制到str中，并给其后添加一个字符串结束符(‘\0’)；<br>   <strong>(2)</strong> 如果格式化后的字符串长度 &gt;= size，则只将其中的(size-1)个字符复制到str中，并给其后添加一个字符串结束符(‘\0’)，返回值为欲写入的字符串长度。</p> 
<h2><a id="2_9"></a>2、函数说明</h2> 
<h3><a id="21_sprintf_10"></a>2.1 sprintf</h3> 
<h4><a id="211__11"></a>2.1.1 函数原型</h4> 
<pre><code class="prism language-c"><span class="token keyword">int</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>string<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>format <span class="token punctuation">[</span><span class="token punctuation">,</span>argument<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="212__15"></a>2.1.2 参数列表：</h4> 
<p>   <strong>string</strong>：这是指向一个字符数组的指针，该数组存储了最终格式化后的 字符串。<br>    <strong>format</strong>：指明字符串的格式，包含了要被写入到字符串 str 的文本。它可以嵌入随后的附加参数中指定的值替换（如(“%d%c%f”, num, chr, f)，参数的个数应与 % 标签的个数相同。），按需求进行格式化。<br>    <strong>[argument]…</strong>：根据不同的 format 字符串，函数可能需要一系列的附加参数，每个参数包含了一个要被插入的值，替换了 format 参数中指定的每个 % 标签，如(“%d%c%f”, num, chr, f)。参数的个数应与 % 标签的个数相同。</p> 
<h4><a id="213__19"></a>2.1.3 返回值：</h4> 
<p>   如果成功，则返回写入的字符总数，不包括字符串追加在字符串末尾的空字符。如果失败，则返回一个负数。<br>    sprintf 返回以format为格式argument为内容组成的结果被写入string的字节数，结束字符‘\0’不计入内。即，如果“Hello”被写入空间足够大的string后，函数sprintf 返回5。</p> 
<h3><a id="22_snprintf_22"></a>2.2 snprintf</h3> 
<h4><a id="221__23"></a>2.2.1 函数原型</h4> 
<pre><code class="prism language-c"><span class="token keyword">int</span> <span class="token function">snprintf</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> dest_str<span class="token punctuation">,</span><span class="token class-name">size_t</span> size<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> format<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="222__27"></a>2.2.2 参数列表：</h4> 
<p>   <strong>dest_str</strong>：这是指向一个字符数组的指针，该数组存储了最终格式化后的 字符串。<br>    <strong>size</strong>：对格式化字符串的长度做出限制，<br>    <strong>format</strong>：指明字符串的格式，包含了要被写入到字符串 str 的文本。它可以嵌入随后的附加参数中指定的值替换（如(“格式化为%d%c%f”, num, chr, f)），按需求进行格式化。</p> 
<h4><a id="223__31"></a>2.2.3 返回值</h4> 
<p>   若成功则返回预写入的字符串长度，若出错则返回负值。<br>    与snprintf的返回值不同，sprintf的返回值是成功写入的字符串长度，此处需要谨慎处理。</p> 
<h2><a id="3_35"></a>3、区别</h2> 
<p>  （1）从函数命名上 snprintf 比 sprintf多出了一个n，函数定义上，多出了第二个参数n 用来控制输出字符的最大数量，其控制生成的字符长度最多为n-1，为附加的终止空字符留出空间。<br>   （2）因此 snprintf 是一个较为安全的函数，相比 sprintf 它可以避免缓冲区溢出问题, 如果输出的字符长度超过 n，它可以被自动截断。<br>   （3）在函数的返回值上，snprintf 和 sprintf 返回的都是 预期被写入到缓冲区的字符串长度(不包括终止符)。 对于snprintf来说，由于支持长度限制、自动截断的能力，因此它的返回值可能比实际写入到缓冲区的长度大。</p> 
<h2><a id="4Demo_39"></a>4、Demo</h2> 
<h3><a id="41_sprintf_40"></a>4.1 sprintf</h3> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span> <span class="token keyword">void</span> <span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
   <span class="token keyword">char</span>  buffer<span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">]</span>；
   <span class="token keyword">char</span> s<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"hello world"</span><span class="token punctuation">;</span><span class="token comment">//字符串数组</span>
   <span class="token keyword">char</span> c <span class="token operator">=</span> <span class="token char">'c'</span><span class="token punctuation">;</span><span class="token comment">//字符</span>
   <span class="token keyword">int</span>  i <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span><span class="token comment">//整型</span>
   <span class="token keyword">int</span>  length<span class="token punctuation">;</span>
   <span class="token keyword">float</span> fp <span class="token operator">=</span> <span class="token number">3.1415926f</span><span class="token punctuation">;</span><span class="token comment">//浮点型</span>
   <span class="token comment">// 格式化并打印各种数据到buffer</span>
   length  <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span> buffer<span class="token punctuation">,</span>    <span class="token string">"   String:    %s\n"</span><span class="token punctuation">,</span> s <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 字符串数组</span>
   length <span class="token operator">+=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span> buffer <span class="token operator">+</span> length  <span class="token punctuation">,</span> <span class="token string">"   Character: %c\n"</span><span class="token punctuation">,</span> c <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 字符</span>
   length <span class="token operator">+=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span> buffer <span class="token operator">+</span> length  <span class="token punctuation">,</span> <span class="token string">"   Integer:   %d\n"</span><span class="token punctuation">,</span> i <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 整型</span>
   length <span class="token operator">+=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span> buffer <span class="token operator">+</span> length  <span class="token punctuation">,</span> <span class="token string">"   Float:     %f\n"</span><span class="token punctuation">,</span> fp <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 浮点型</span>
    
   <span class="token function">printf</span><span class="token punctuation">(</span> <span class="token string">"Output:\n%s\ncharacter string_length = %d\n"</span><span class="token punctuation">,</span> buffer<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>输出结果：</strong><br> <img src="https://images2.imgbox.com/09/e3/BIZyZlqE_o.png" alt="输出结果"></p> 
<h3><a id="4_2_snprintf_65"></a>4. 2 snprintf</h3> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> str_len<span class="token operator">=</span><span class="token function">snprintf</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"123456789012345678"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"str = %s\n"</span><span class="token punctuation">,</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"write_len = %d\n"</span><span class="token punctuation">,</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印格式化字符串的实际长度</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"str_len = %d\n"</span><span class="token punctuation">,</span>str_len<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打印snprintf返回值</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>  <strong>编译警告</strong>：从编译警告可以看出snprintf所发挥的作用，当要格式化的字符串超出buffer长度时，snprintf函数的size参数就可以起到避免溢出的效果.<br>   而如果此时使用sprintf，就会造成buffer溢出。<br> <img src="https://images2.imgbox.com/59/38/5V4y9myJ_o.png" alt="编译警告"><br> <strong>输出结果：</strong><br> <img src="https://images2.imgbox.com/7d/b2/BtesgGMw_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9cefdaa4d8eef40387fb91d45a2f17e2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Rust语言入门（3）—— 环境搭建</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a6346991b7f25047f72aba8cb23dbd89/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Rust语言入门（4）—— Hello world&amp; Cargo</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>