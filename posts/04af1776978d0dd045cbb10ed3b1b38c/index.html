<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MATLAB的各种疑难杂症和小技巧 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MATLAB的各种疑难杂症和小技巧" />
<meta property="og:description" content="（￣△￣；）这里是目录 使用技巧如何更改启动后的默认工作路径方法一方法二 AVL Cruise与Simulink联合仿真（通过MATLAB DLL方式）1.AVL Cruise与Simulink联合仿真的不同方式及各自优缺点1.1MATLAB DLL方式1.2MATLAB API方式 2.DLL联合仿真MATLAB配置过程2.1在MATLAB里安装编译器2.2在MATLAB中安装DLL的必要文件并设置编译器 3 AVL Cruise和MATLAB DLL联合仿真时快速生成Simulink模型的方法4.Simulink编译DLL文件5.联合仿真 使用技巧 如何更改启动后的默认工作路径 方法一 打开MATLAB后，点击设置路径：
点击添加文件夹然后选择一个你要加入的路径，例如我这里选择的是桌面：
选中添加的路径后，点击移至顶端再点击保存，重新启动MATLAB后默认工作路径修改完成：
方法二 在你打开MATLAB的地方，右键单击图标，选择属性并打开（如果是开始菜单里的，则要先点击打开文件位置）：
在弹出来的界面中，把起始位置改成你想要改为的默认工作路径后点击确定，再次启动MATLAB即可变为新的工作路径：
AVL Cruise与Simulink联合仿真（通过MATLAB DLL方式） 最近毕业设计需要用到AVL Cruise与Simulink进行联合仿真，分析汽车模型的经济性。下面介绍一下我所知的AVL Cruise与Simulink联合仿真的几种方式，它们各自的优缺点，以及DLL方式联合仿真的具体配置过程。我这里用的MATLAB软件版本是2021a，Cruise软件版本是2019.2，电脑操作系统是Windows11。
1.AVL Cruise与Simulink联合仿真的不同方式及各自优缺点 1.1MATLAB DLL方式 该方式是先把SImulink中建立的模型编译成一个DLL文件，之后把这个文件内嵌到Cruise软件中作为一个模块，并进行仿真的方法。
优点：因为是内嵌到Cruise软件中了，因此运行时不需要调用Simulink，运行速度非常快，且是由Simulink模型编译生成的dll文件，在Cruise软件里看不到具体的模型是如何搭建的，比较保密，不会泄露控制模型信息。
缺点：同样是因为内嵌到Cruise软件中了，因此运行时无法实时查看模型内部的参数，不适用于调试Simulink控制模型，因为改一点模型就需要编译一次dll文件，且无法有效的定位模型中出错的地方。
1.2MATLAB API方式 该方式是Cruise在前台，处于主要地位，联合仿真时打开对应的Simulink模型，由Cruise向Simulink发送必要的参数以及指令，在Simulink中完成计算后把结果返回到Cruise中，继续进行下一步。该方法和DLL方法的优缺点正好反过来了。
优点：可以实时查看Simulink模型中的参数变化，便于调试，更改模型后不需要重新编译dll文件就能进行联合仿真。
缺点：没有内嵌到Cruise模型中，运行时需要实时调用Simulink，因此运行速度极慢无比，且必须要拿到Simulink控制模型源文件才能进行联合仿真，容易泄露信息。
2.DLL联合仿真MATLAB配置过程 2.1在MATLAB里安装编译器 编译dll文件是需要编译器的，我的MATLAB版本没有自带编译器，因此需要外部安装一个，这里我选择了TDM-GCC-64编译器，该安装包我已经上传到了CSDN资源库，可以从这里下载。下载完成后进行安装，这里因为我的电脑操作系统就是64位的，因此安装的版本选择了64位的：
期间安装程序会自动去网上下载必要的安装文件，因为可能是外网，因此下载速度会很慢，如果安装失败，建议换个网络后重新安装。在计算机处右键单击，选择属性按钮：
点击高级系统设置：
在弹出的窗口中选择环境变量：
点击系统变量下的新建按钮：
在弹出框中，变量名处输入MW_MINGW64_LOC，变量值处输入刚刚TDM-GCC-64的安装路径C:\TDM-GCC-64，之后点击确定：
可以看到系统变量里已经有了刚刚加入的环境变量，注意查看此处显示的环境变量名和值是否为MW_MINGW64_LOC和安装目录。 2.2在MATLAB中安装DLL的必要文件并设置编译器 先把MATLAB软件的当前目录展开至Cruise软件安装目录下的AVL\R2019.2\CRUISE\matlab\Install_DLL文件夹，并双击打开Install.m文件，如下图所示：
打开后点击运行按钮，结果如下图所示：
在下方的输入框中输入mex -setup后按回车： 提示如下图所示，代表已经成功的为C语言编译选择了编译器：
3 AVL Cruise和MATLAB DLL联合仿真时快速生成Simulink模型的方法 在Cruise软件里拖入MATLAB DLL模型后，进行数据总线连接，这里输入信号连接了Cockpit里的Velocity信号，输出信号连接了Engine里的Desired Torque信号，如下图所示：
双击MATLAB DLL模块，打开设置菜单，切换到Description of Data Bus选项卡，并点击下方的update按钮：
可以看到这里更新了连接到MATLAB DLL模块的信号，双击每个信号中Unit的空白处，对该信号进行必要的设置，比如设置单位等：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/04af1776978d0dd045cbb10ed3b1b38c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-15T15:01:33+08:00" />
<meta property="article:modified_time" content="2023-11-15T15:01:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MATLAB的各种疑难杂症和小技巧</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>（￣△￣；）这里是目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">使用技巧</a></li><li><ul><li><a href="#_3" rel="nofollow">如何更改启动后的默认工作路径</a></li><li><ul><li><a href="#_4" rel="nofollow">方法一</a></li><li><a href="#_14" rel="nofollow">方法二</a></li></ul> 
   </li><li><a href="#AVL_CruiseSimulinkMATLAB_DLL_20" rel="nofollow">AVL Cruise与Simulink联合仿真（通过MATLAB DLL方式）</a></li><li><ul><li><a href="#1AVL_CruiseSimulink_22" rel="nofollow">1.AVL Cruise与Simulink联合仿真的不同方式及各自优缺点</a></li><li><ul><li><a href="#11MATLAB_DLL_23" rel="nofollow">1.1MATLAB DLL方式</a></li><li><a href="#12MATLAB_API_27" rel="nofollow">1.2MATLAB API方式</a></li></ul> 
    </li><li><a href="#2DLLMATLAB_31" rel="nofollow">2.DLL联合仿真MATLAB配置过程</a></li><li><ul><li><a href="#21MATLAB_32" rel="nofollow">2.1在MATLAB里安装编译器</a></li><li><a href="#22MATLABDLL_48" rel="nofollow">2.2在MATLAB中安装DLL的必要文件并设置编译器</a></li></ul> 
    </li><li><a href="#3_AVL_CruiseMATLAB_DLLSimulink_56" rel="nofollow">3 AVL Cruise和MATLAB DLL联合仿真时快速生成Simulink模型的方法</a></li><li><a href="#4SimulinkDLL_75" rel="nofollow">4.Simulink编译DLL文件</a></li><li><a href="#5_90" rel="nofollow">5.联合仿真</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>使用技巧</h2> 
<h3><a id="_3"></a>如何更改启动后的默认工作路径</h3> 
<h4><a id="_4"></a>方法一</h4> 
<ol><li>打开MATLAB后，点击<code>设置路径</code>：<br> <img src="https://images2.imgbox.com/c4/71/bZkOFroM_o.png" alt="在这里插入图片描述"></li><li>点击<code>添加文件夹</code>然后选择一个你要加入的路径，例如我这里选择的是桌面：<br> <img src="https://images2.imgbox.com/87/b6/ZW5kXv91_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/93/bd/eVp2LiSe_o.png" alt="在这里插入图片描述"></li><li>选中添加的路径后，点击<code>移至顶端</code>再点击<code>保存</code>，重新启动MATLAB后默认工作路径修改完成：<br> <img src="https://images2.imgbox.com/c6/94/mWXCrWM9_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/3a/82/E6qDmOMQ_o.png" alt="在这里插入图片描述"></li></ol> 
<h4><a id="_14"></a>方法二</h4> 
<ol><li>在你打开MATLAB的地方，右键单击图标，选择属性并打开（如果是开始菜单里的，则要先点击<code>打开文件位置</code>）：<br> <img src="https://images2.imgbox.com/3f/e7/mSECvVvu_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/9d/d8/3k7awezv_o.png" alt="在这里插入图片描述"></li><li>在弹出来的界面中，把<code>起始位置</code>改成你想要改为的默认工作路径后点击<code>确定</code>，再次启动MATLAB即可变为新的工作路径：<br> <img src="https://images2.imgbox.com/04/4b/rEPf8G3g_o.png" alt="在这里插入图片描述"></li></ol> 
<h3><a id="AVL_CruiseSimulinkMATLAB_DLL_20"></a>AVL Cruise与Simulink联合仿真（通过MATLAB DLL方式）</h3> 
<p>  最近毕业设计需要用到AVL Cruise与Simulink进行联合仿真，分析汽车模型的经济性。下面介绍一下我所知的AVL Cruise与Simulink联合仿真的几种方式，它们各自的优缺点，以及DLL方式联合仿真的具体配置过程。我这里用的MATLAB软件版本是2021a，Cruise软件版本是2019.2，电脑操作系统是Windows11。</p> 
<h4><a id="1AVL_CruiseSimulink_22"></a>1.AVL Cruise与Simulink联合仿真的不同方式及各自优缺点</h4> 
<h5><a id="11MATLAB_DLL_23"></a>1.1MATLAB DLL方式</h5> 
<p>该方式是先把SImulink中建立的模型编译成一个DLL文件，之后把这个文件内嵌到Cruise软件中作为一个模块，并进行仿真的方法。<br> 优点：因为是内嵌到Cruise软件中了，因此运行时不需要调用Simulink，运行速度非常快，且是由Simulink模型编译生成的dll文件，在Cruise软件里看不到具体的模型是如何搭建的，比较保密，不会泄露控制模型信息。<br> 缺点：同样是因为内嵌到Cruise软件中了，因此运行时无法实时查看模型内部的参数，不适用于调试Simulink控制模型，因为改一点模型就需要编译一次dll文件，且无法有效的定位模型中出错的地方。</p> 
<h5><a id="12MATLAB_API_27"></a>1.2MATLAB API方式</h5> 
<p>该方式是Cruise在前台，处于主要地位，联合仿真时打开对应的Simulink模型，由Cruise向Simulink发送必要的参数以及指令，在Simulink中完成计算后把结果返回到Cruise中，继续进行下一步。该方法和DLL方法的优缺点正好反过来了。<br> 优点：可以实时查看Simulink模型中的参数变化，便于调试，更改模型后不需要重新编译dll文件就能进行联合仿真。<br> 缺点：没有内嵌到Cruise模型中，运行时需要实时调用Simulink，因此运行速度极慢无比，且必须要拿到Simulink控制模型源文件才能进行联合仿真，容易泄露信息。</p> 
<h4><a id="2DLLMATLAB_31"></a>2.DLL联合仿真MATLAB配置过程</h4> 
<h5><a id="21MATLAB_32"></a>2.1在MATLAB里安装编译器</h5> 
<ol><li>编译dll文件是需要编译器的，我的MATLAB版本没有自带编译器，因此需要外部安装一个，这里我选择了TDM-GCC-64编译器，该安装包我已经上传到了CSDN资源库，<a href="https://download.csdn.net/download/weixin_44056757/85342627">可以从这里下载</a>。下载完成后进行安装，这里因为我的电脑操作系统就是64位的，因此安装的版本选择了64位的：<br> <img src="https://images2.imgbox.com/ac/54/3MJkEmSm_o.png" alt="在这里插入图片描述"><br> 期间安装程序会自动去网上下载必要的安装文件，因为可能是外网，因此下载速度会很慢，如果安装失败，建议换个网络后重新安装。</li><li>在计算机处右键单击，选择属性按钮：<br> <img src="https://images2.imgbox.com/11/db/4cnSbLca_o.png" alt="在这里插入图片描述"></li><li>点击高级系统设置：<br> <img src="https://images2.imgbox.com/13/92/BZKIajKD_o.png" alt="在这里插入图片描述"></li><li>在弹出的窗口中选择环境变量：<br> <img src="https://images2.imgbox.com/81/80/Y7S6j1kF_o.png" alt="在这里插入图片描述"></li><li>点击系统变量下的新建按钮：<br> <img src="https://images2.imgbox.com/40/a3/u3j91WMW_o.png" alt="在这里插入图片描述"></li><li>在弹出框中，变量名处输入<code>MW_MINGW64_LOC</code>，变量值处输入刚刚TDM-GCC-64的安装路径<code>C:\TDM-GCC-64</code>，之后点击确定：<br> <img src="https://images2.imgbox.com/33/08/y33Y2aUE_o.png" alt="在这里插入图片描述"><br> 可以看到系统变量里已经有了刚刚加入的环境变量，注意查看此处显示的环境变量名和值是否为<code>MW_MINGW64_LOC</code>和安装目录。</li></ol> 
<h5><a id="22MATLABDLL_48"></a>2.2在MATLAB中安装DLL的必要文件并设置编译器</h5> 
<ol><li>先把MATLAB软件的当前目录展开至Cruise软件安装目录下的AVL\R2019.2\CRUISE\matlab\Install_DLL文件夹，并双击打开Install.m文件，如下图所示：<br> <img src="https://images2.imgbox.com/68/50/zEK0ksOs_o.png" alt="在这里插入图片描述"></li><li>打开后点击运行按钮，结果如下图所示：<br> <img src="https://images2.imgbox.com/31/ae/IVbzGnrj_o.png" alt="在这里插入图片描述"></li><li>在下方的输入框中输入<code>mex -setup</code>后按回车： <img src="https://images2.imgbox.com/5a/4e/SkmYoIvH_o.png" alt=""></li><li>提示如下图所示，代表已经成功的为C语言编译选择了编译器：<br> <img src="https://images2.imgbox.com/6f/85/UdpkFd4j_o.png" alt="在这里插入图片描述"></li></ol> 
<h4><a id="3_AVL_CruiseMATLAB_DLLSimulink_56"></a>3 AVL Cruise和MATLAB DLL联合仿真时快速生成Simulink模型的方法</h4> 
<ol><li> <p>在Cruise软件里拖入MATLAB DLL模型后，进行数据总线连接，这里输入信号连接了Cockpit里的Velocity信号，输出信号连接了Engine里的Desired Torque信号，如下图所示：<br> <img src="https://images2.imgbox.com/95/26/YkoBuCck_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e9/15/oGYEeYRD_o.png" alt="在这里插入图片描述"></p> </li><li> <p>双击MATLAB DLL模块，打开设置菜单，切换到Description of Data Bus选项卡，并点击下方的update按钮：<br> <img src="https://images2.imgbox.com/bd/66/Idi0PjtL_o.png" alt="在这里插入图片描述"></p> </li><li> <p>可以看到这里更新了连接到MATLAB DLL模块的信号，双击每个信号中Unit的空白处，对该信号进行必要的设置，比如设置单位等：<br> <img src="https://images2.imgbox.com/11/1f/vNWsSWJD_o.png" alt="在这里插入图片描述"></p> </li><li> <p>点击下拉框，可以选择对应的项目和单位，比如这里选择Velocity，km/h，并点击OK完成设置：<br> <img src="https://images2.imgbox.com/08/ee/JkJcQVxY_o.png" alt="在这里插入图片描述"></p> </li><li> <p>依次设置完每个信号的单位，点击最下方的Create mdl-File，即可创建含有对应输入输出信号的Simulink模型：<br> <img src="https://images2.imgbox.com/d5/73/jP5nAK8x_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b2/b2/qAfWAP2B_o.png" alt="在这里插入图片描述"></p> </li><li> <p>该模型保存在Cruise模型根目录下的userdata文件夹中，其中这个后缀为.mdl的文件就是刚刚生成的Simulink模型文件：<br> <img src="https://images2.imgbox.com/7e/d9/L5ShYl7v_o.png" alt="在这里插入图片描述"></p> </li></ol> 
<h4><a id="4SimulinkDLL_75"></a>4.Simulink编译DLL文件</h4> 
<p>对生成的SImulink文件进行必要的建模之后，就开始进行编译DLL文件的准备工作，具体如下所示：</p> 
<ol><li>点击SImulink模型中最上面的APPS，再点击SImulink Coder打开编译器，如果红色框处没有SImulink Coder，那么就点击右侧的下拉框，在里面寻找SImulink Coder并点击打开：<br> <img src="https://images2.imgbox.com/ff/cd/2lDxr6Mn_o.png" alt="在这里插入图片描述"></li><li>点击Settings：<br> <img src="https://images2.imgbox.com/e1/2c/PrTrk8dp_o.png" alt="在这里插入图片描述"></li><li>在Slover选项卡中按标红所示的参数进行设置：<br> <img src="https://images2.imgbox.com/34/1e/xC0UpfYw_o.png" alt="在这里插入图片描述"></li><li>在Data Import/Export选项卡中，设置Format为Array：<br> <img src="https://images2.imgbox.com/ef/2b/HiYAX1Bm_o.png" alt="在这里插入图片描述"></li><li>Code Generation选项卡中按如下图所示进行配置：<img src="https://images2.imgbox.com/91/7a/j5CcFEka_o.png" alt="在这里插入图片描述"></li><li>完成上述设置后，点击Build按钮进行编译DLL文件：<br> <img src="https://images2.imgbox.com/58/72/rWV1ZVER_o.png" alt="在这里插入图片描述"></li><li>左下角显示Ready并且没有报错后即完成了DLL文件的编译：<br> <img src="https://images2.imgbox.com/c4/52/UpWQjMmj_o.png" alt="在这里插入图片描述"></li></ol> 
<h4><a id="5_90"></a>5.联合仿真</h4> 
<ol><li>在Cruise软件中打开DLL模块，点击图中所画的按钮，选择之前上一步编译Simulink文件得到的后缀名为.dll的文件，点击OK并确定，即完成了DLL模块的配置。<br> <img src="https://images2.imgbox.com/b3/68/UWwTNF7q_o.png" alt=""></li><li>保持页面在Sub-System 001页面的情况下，点击上方的options并选择Layout，设置编译平台为Win64，并点击OK确定。<img src="https://images2.imgbox.com/9c/39/JFPHVo0C_o.png" alt=""><br> <img src="https://images2.imgbox.com/57/34/KSMdcBRj_o.png" alt="在这里插入图片描述"></li><li>切换到计算中心，点击开始计算按钮，即可开始运行设定好的仿真任务，实现联合仿真。</li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/164bc2fb804d84e6fd84767ecbf9ee20/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">西门子博途软件安装问题汇总</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bd165f0bc115ebfc33a2d373bf1efd84/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">类加载器（classloader）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>