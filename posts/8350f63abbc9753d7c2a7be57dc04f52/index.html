<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Kubernetes --kubectl命令管理 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Kubernetes --kubectl命令管理" />
<meta property="og:description" content="文章目录 一、kubectl --help帮助文档介绍二、完整项目周期实例 一、kubectl --help帮助文档介绍 [root@master01 dashboard]# kubectl --help Basic Commands (Beginner): create Create a resource from a file or from stdin.根据文件或者输入流创建资源 expose 使用 replication controller, service, deployment 或者 pod并暴露它作为一个新的 Kubernetes Service run 在集群中运行一个指定的镜像 set 为 objects 设置一个指定的特征 Basic Commands (Intermediate): explain 查看资源的文档 get 显示一个或更多 resources edit 在服务器上编辑一个资源 delete Delete resources by filenames, stdin, resources and names, or by resources and label selector Deploy Commands: rollout Manage the rollout of a resource；回滚，如果更新出问题了可以立马回滚 scale 为 Deployment, ReplicaSet, Replication Controller 或者 Job 设置一个新的副本数量； 弹性伸缩，特别是无状态的web服务 autoscale 自动调整一个 Deployment, ReplicaSet, 或者ReplicationController的副本数量；自动弹性伸缩 Cluster Management Commands: certificate 修改 certificate 资源." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/8350f63abbc9753d7c2a7be57dc04f52/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-10-13T23:58:37+08:00" />
<meta property="article:modified_time" content="2020-10-13T23:58:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Kubernetes --kubectl命令管理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#kubectl_help_2" rel="nofollow">一、kubectl --help帮助文档介绍</a></li><li><a href="#_63" rel="nofollow">二、完整项目周期实例</a></li></ul> 
</div> 
<p></p> 
<h2><a id="kubectl_help_2"></a>一、kubectl --help帮助文档介绍</h2> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@master01 dashboard<span class="token punctuation">]</span># kubectl <span class="token operator">--</span>help
Basic <span class="token function">Commands</span> <span class="token punctuation">(</span>Beginner<span class="token punctuation">)</span><span class="token punctuation">:</span>
  create           Create a resource <span class="token keyword">from</span> a file or <span class="token keyword">from</span> stdin<span class="token punctuation">.</span>根据文件或者输入流创建资源
  expose         使用 replication controller<span class="token punctuation">,</span> service<span class="token punctuation">,</span> deployment 或者 pod并暴露它作为一个新的 Kubernetes Service
  run            在集群中运行一个指定的镜像
  <span class="token keyword">set</span>            为 objects 设置一个指定的特征

Basic <span class="token function">Commands</span> <span class="token punctuation">(</span>Intermediate<span class="token punctuation">)</span><span class="token punctuation">:</span>
  explain     查看资源的文档
  <span class="token keyword">get</span>           显示一个或更多 resources
  edit           在服务器上编辑一个资源
  <span class="token keyword">delete</span>       Delete resources by filenames<span class="token punctuation">,</span> stdin<span class="token punctuation">,</span> resources and names<span class="token punctuation">,</span> or by resources and label selector

Deploy Commands<span class="token punctuation">:</span>
  rollout        Manage the rollout <span class="token keyword">of</span> a resource；回滚，如果更新出问题了可以立马回滚
  scale          为 Deployment<span class="token punctuation">,</span> ReplicaSet<span class="token punctuation">,</span> Replication Controller 或者 Job 设置一个新的副本数量；
                     弹性伸缩，特别是无状态的web服务
  autoscale    自动调整一个 Deployment<span class="token punctuation">,</span> ReplicaSet<span class="token punctuation">,</span> 或者ReplicationController的副本数量；自动弹性伸缩

Cluster Management Commands<span class="token punctuation">:</span>
  certificate    修改 certificate 资源<span class="token punctuation">.</span>（比如同意node节点加入时）
  cluster<span class="token operator">-</span>info   显示集群信息
  top            Display <span class="token function">Resource</span> <span class="token punctuation">(</span><span class="token constant">CPU</span><span class="token operator">/</span>Memory<span class="token operator">/</span>Storage<span class="token punctuation">)</span> usage<span class="token punctuation">.</span>动态查看资源使用情况
  cordon        标记 node 为 unschedulable
  uncordon    标记 node 为 schedulable
  drain          Drain node <span class="token keyword">in</span> preparation <span class="token keyword">for</span> maintenance；节点维护时
  taint            更新一个或者多个node 上的 taints；污点  <span class="token operator">--</span>一旦某个node被标记污点，就不会在这个节点上创建pod了

Troubleshooting and Debugging Commands<span class="token punctuation">:</span>
  describe    显示一个指定 resource 或者 group 的 resources 详情    <span class="token operator">--</span>排障
  logs           输出容器在 pod 中的日志         <span class="token operator">--</span>排障
  attach         连接到一个运行中的container
  exec           进入container中执行命令
  port<span class="token operator">-</span>forward   Forward one or more local ports to a pod；端口转发
  proxy          运行一个 proxy 到 Kubernetes <span class="token constant">API</span> server
  cp             复制 files 和 directories 到 containers，和从容器中复制 files 和 directories<span class="token punctuation">.</span>
  auth          验证

Advanced Commands<span class="token punctuation">:</span>
  apply         <span class="token function">通过文件名或标准输入流</span><span class="token punctuation">(</span>stdin<span class="token punctuation">)</span>对资源进行配置；资源创建、重新部署，更新
  patch         使用 strategic merge patch 更新一个资源的 <span class="token function">field</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
  replace      通过 filename 或者 stdin替换一个资源
  wait           Experimental<span class="token punctuation">:</span> Wait <span class="token keyword">for</span> a specific condition on one or many resources<span class="token punctuation">.</span>
  convert     在不同的 <span class="token constant">API</span> versions 转换配置文件

Settings Commands<span class="token punctuation">:</span>
  label             更新在这个资源上的 labels
  annotate       更新一个资源的注释
  completion    Output shell completion code <span class="token keyword">for</span> the specified <span class="token function">shell</span> <span class="token punctuation">(</span>bash or zsh<span class="token punctuation">)</span>；输出shell代码到指定的终端上

Other Commands<span class="token punctuation">:</span>
  alpha               Commands <span class="token keyword">for</span> features <span class="token keyword">in</span> alpha
  api<span class="token operator">-</span>resources  Print the supported <span class="token constant">API</span> resources on the server；可以看到哪些资源可以缩写
  api<span class="token operator">-</span>versions   Print the supported <span class="token constant">API</span> versions on the server<span class="token punctuation">,</span> <span class="token keyword">in</span> the form <span class="token keyword">of</span> <span class="token string">"group/version"</span>
  config         修改 kubeconfig 文件
  plugin         Provides utilities <span class="token keyword">for</span> interacting <span class="token keyword">with</span> plugins<span class="token punctuation">.</span>
  version        输出 client 和 server 的版本信息
</code></pre> 
<h2><a id="_63"></a>二、完整项目周期实例</h2> 
<p>项目的生命周期，创建–》发布–》更新–》回滚–》删除<br> 1.创建nginx</p> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@master01 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl run nginx<span class="token operator">-</span>test <span class="token operator">--</span>image<span class="token operator">=</span>nginx <span class="token operator">--</span>port<span class="token operator">=</span><span class="token number">80</span>  <span class="token operator">--</span>replicas<span class="token operator">=</span><span class="token number">3</span> 
<span class="token punctuation">[</span>root@master01 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">get</span> all     #等于kubectl <span class="token keyword">get</span> pods<span class="token punctuation">,</span>svc<span class="token punctuation">,</span>deployment<span class="token punctuation">,</span>replicaset
</code></pre> 
<p>2.发布nginx #可以再为service提供负载均衡的功能</p> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@master01 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl expose deployment nginx<span class="token operator">-</span>test <span class="token operator">--</span>port<span class="token operator">=</span><span class="token number">80</span> <span class="token operator">--</span>target<span class="token operator">-</span>port<span class="token operator">=</span><span class="token number">80</span> <span class="token operator">--</span>name<span class="token operator">=</span>nginx<span class="token operator">-</span>service <span class="token operator">--</span>type<span class="token operator">=</span>NodePort    #为nginx服务开放NodePort类型的端口
service<span class="token operator">/</span>nginx<span class="token operator">-</span>service exposed
pod是一组容器的集合，有四种端口
节点端口：nodeport
pod端口：port
容器发布端口：targetport
容器内部端口：containerport
</code></pre> 
<p><img src="https://images2.imgbox.com/be/a9/YvkBgTGh_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@master01 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">get</span> svc <span class="token operator">-</span>o wide  
<span class="token constant">NAME</span>            <span class="token constant">TYPE</span>        <span class="token constant">CLUSTER</span><span class="token operator">-</span><span class="token constant">IP</span>   <span class="token constant">EXTERNAL</span><span class="token operator">-</span><span class="token constant">IP</span>   <span class="token constant">PORT</span><span class="token punctuation">(</span><span class="token constant">S</span><span class="token punctuation">)</span>        <span class="token constant">AGE</span>   <span class="token constant">SELECTOR</span>
kubernetes      ClusterIP   <span class="token number">10.0</span><span class="token number">.0</span><span class="token number">.1</span>     <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">443</span><span class="token operator">/</span><span class="token constant">TCP</span>                <span class="token number">18</span>h        <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
nginx<span class="token operator">-</span>service   NodePort    <span class="token number">10.0</span><span class="token number">.0</span><span class="token number">.86</span>    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">80</span><span class="token punctuation">:</span><span class="token number">31641</span><span class="token operator">/</span><span class="token constant">TCP</span>   <span class="token number">44</span>s         run<span class="token operator">=</span>nginx<span class="token operator">-</span>test
</code></pre> 
<p>#查看资源对象简写（选取了常用的部分内容）</p> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl api<span class="token operator">-</span>resources
<span class="token constant">NAME</span>                              <span class="token constant">SHORTNAMES</span>   <span class="token constant">APIGROUP</span>                       <span class="token constant">NAMESPACED</span>   <span class="token constant">KIND</span>
endpoints                         ep                                          <span class="token boolean">true</span>         Endpoints
events                            ev                                          <span class="token boolean">true</span>         Event
namespaces                        ns                                          <span class="token boolean">false</span>        Namespace
nodes                             no                                          <span class="token boolean">false</span>        Node
pods                              po                                          <span class="token boolean">true</span>         Pod
replicationcontrollers            rc                                          <span class="token boolean">true</span>         ReplicationController
resourcequotas                    quota                                       <span class="token boolean">true</span>         ResourceQuota
services                          svc                                         <span class="token boolean">true</span>         Service
deployments                       deploy       apps                           <span class="token boolean">true</span>         Deployment
replicasets                       rs           apps                           <span class="token boolean">true</span>         ReplicaSet
certificatesigningrequests        csr          certificates<span class="token punctuation">.</span>k8s<span class="token punctuation">.</span>io            <span class="token boolean">false</span>        
events                            ev           events<span class="token punctuation">.</span>k8s<span class="token punctuation">.</span>io                  <span class="token boolean">true</span>         Event
deployments                       deploy       extensions                     <span class="token boolean">true</span>         Deployment
replicasets                       rs           extensions                     <span class="token boolean">true</span>         ReplicaSet
</code></pre> 
<p>#查看终端节点的IP和端口</p> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">get</span> endpoints
<span class="token constant">NAME</span>            <span class="token constant">ENDPOINTS</span>                                      <span class="token constant">AGE</span>
kubernetes      <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.80</span><span class="token punctuation">:</span><span class="token number">6443</span>                                 <span class="token number">22</span>h
nginx<span class="token operator">-</span>service   <span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.4</span><span class="token punctuation">:</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.5</span><span class="token punctuation">:</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">172.17</span><span class="token number">.42</span><span class="token number">.3</span><span class="token punctuation">:</span><span class="token number">80</span>   <span class="token number">4</span>h29m
</code></pre> 
<p>#查看网络状态详细信息</p> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">get</span> pods <span class="token operator">-</span>o wide
<span class="token constant">NAME</span>                          <span class="token constant">READY</span>   <span class="token constant">STATUS</span>    <span class="token constant">RESTARTS</span>   <span class="token constant">AGE</span>     <span class="token constant">IP</span>            <span class="token constant">NODE</span>        <span class="token constant">NOMINATED</span> <span class="token constant">NODE</span>
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>kfstr   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>     Running   <span class="token number">0</span>          <span class="token number">4</span>h43m   <span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.5</span>   <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.60</span>   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>vqmw6   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>     Running   <span class="token number">0</span>          <span class="token number">4</span>h43m   <span class="token number">172.17</span><span class="token number">.42</span><span class="token number">.3</span>   <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.70</span>   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>zhptn   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>     Running   <span class="token number">0</span>          <span class="token number">4</span>h43m   <span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.4</span>   <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.60</span>   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
</code></pre> 
<p>#查看服务暴露的端口（随机）</p> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">get</span> svc
<span class="token constant">NAME</span>            <span class="token constant">TYPE</span>        <span class="token constant">CLUSTER</span><span class="token operator">-</span><span class="token constant">IP</span>   <span class="token constant">EXTERNAL</span><span class="token operator">-</span><span class="token constant">IP</span>   <span class="token constant">PORT</span><span class="token punctuation">(</span><span class="token constant">S</span><span class="token punctuation">)</span>        <span class="token constant">AGE</span>
kubernetes      ClusterIP   <span class="token number">10.0</span><span class="token number">.0</span><span class="token number">.1</span>     <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">443</span><span class="token operator">/</span><span class="token constant">TCP</span>        <span class="token number">22</span>h
nginx<span class="token operator">-</span>service   NodePort    <span class="token number">10.0</span><span class="token number">.0</span><span class="token number">.86</span>    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">80</span><span class="token punctuation">:</span><span class="token number">31641</span><span class="token operator">/</span><span class="token constant">TCP</span>   <span class="token number">4</span>h32m
</code></pre> 
<p>//在node01操作，查看负载均衡端口31641<br> //kubernetes里kube-proxy支持三种模式，在v1.8之前我们使用的是iptables 以及 userspace两种模式，在kubernetes 1.8之后引入了ipvs模式</p> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@node01 <span class="token operator">~</span><span class="token punctuation">]</span># yum <span class="token operator">-</span>y install ipvsadm
<span class="token punctuation">[</span>root@node01 <span class="token operator">~</span><span class="token punctuation">]</span># ipvsadm <span class="token operator">-</span><span class="token constant">L</span> <span class="token operator">-</span>n    #能够看到另一个node中的pod是因为装了flannel网络组件
<span class="token constant">TCP</span>  <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.60</span><span class="token punctuation">:</span><span class="token number">31641</span> rr
  <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.4</span><span class="token punctuation">:</span><span class="token number">80</span>               Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
  <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.5</span><span class="token punctuation">:</span><span class="token number">80</span>               Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
  <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">172.17</span><span class="token number">.42</span><span class="token number">.3</span><span class="token punctuation">:</span><span class="token number">80</span>               Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
<span class="token comment">//在node02操作 同样安装ipvsadmin工具查看</span>
<span class="token punctuation">[</span>root@node02 <span class="token operator">~</span><span class="token punctuation">]</span># ipvsadm <span class="token operator">-</span><span class="token constant">L</span> <span class="token operator">-</span>n    
<span class="token constant">TCP</span>  <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.70</span><span class="token punctuation">:</span><span class="token number">31641</span> rr
  <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.4</span><span class="token punctuation">:</span><span class="token number">80</span>               Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
  <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.5</span><span class="token punctuation">:</span><span class="token number">80</span>               Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
  <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">172.17</span><span class="token number">.42</span><span class="token number">.3</span><span class="token punctuation">:</span><span class="token number">80</span>               Masq    <span class="token number">1</span>      <span class="token number">0</span>          <span class="token number">0</span>
<span class="token comment">//在master01操作，查看访问日志</span>

<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">get</span> pods <span class="token operator">-</span>o wide
<span class="token constant">NAME</span>                          <span class="token constant">READY</span>   <span class="token constant">STATUS</span>    <span class="token constant">RESTARTS</span>   <span class="token constant">AGE</span>     <span class="token constant">IP</span>            <span class="token constant">NODE</span>        <span class="token constant">NOMINATED</span> <span class="token constant">NODE</span>
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>kfstr   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>     Running   <span class="token number">0</span>          <span class="token number">4</span>h55m   <span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.5</span>   <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.60</span>   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>vqmw6   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>     Running   <span class="token number">0</span>          <span class="token number">4</span>h55m   <span class="token number">172.17</span><span class="token number">.42</span><span class="token number">.3</span>   <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.70</span>   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>zhptn   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>     Running   <span class="token number">0</span>          <span class="token number">4</span>h55m   <span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.4</span>   <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.60</span>   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>

<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl logs nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>zhptn
<span class="token number">2020</span><span class="token operator">/</span><span class="token number">10</span><span class="token operator">/</span><span class="token number">09</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token number">47</span> <span class="token punctuation">[</span>error<span class="token punctuation">]</span> <span class="token number">28</span>#<span class="token number">28</span><span class="token punctuation">:</span> <span class="token operator">*</span><span class="token number">2</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token string">"/usr/share/nginx/html/favicon.ico"</span> <span class="token function">failed</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">:</span> No such file or directory<span class="token punctuation">)</span><span class="token punctuation">,</span> client<span class="token punctuation">:</span> <span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.1</span><span class="token punctuation">,</span> server<span class="token punctuation">:</span> localhost<span class="token punctuation">,</span> request<span class="token punctuation">:</span> <span class="token string">"GET /favicon.ico HTTP/1.1"</span><span class="token punctuation">,</span> host<span class="token punctuation">:</span> <span class="token string">"14.0.0.60:31641"</span>      #访问<span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.60</span><span class="token punctuation">:</span><span class="token number">31641</span>产生的日志
<span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.1</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">09</span><span class="token operator">/</span>Oct<span class="token operator">/</span><span class="token number">2020</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token number">47</span> <span class="token operator">+</span><span class="token number">0000</span><span class="token punctuation">]</span> <span class="token string">"GET /favicon.ico HTTP/1.1"</span> <span class="token number">404</span> <span class="token number">153</span> <span class="token string">"-"</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko"</span> <span class="token string">"-"</span>
<span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.1</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">09</span><span class="token operator">/</span>Oct<span class="token operator">/</span><span class="token number">2020</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token number">28</span> <span class="token operator">+</span><span class="token number">0000</span><span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> <span class="token number">304</span> <span class="token number">0</span> <span class="token string">"-"</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko"</span> <span class="token string">"-"</span>
<span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.1</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">09</span><span class="token operator">/</span>Oct<span class="token operator">/</span><span class="token number">2020</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token number">28</span> <span class="token operator">+</span><span class="token number">0000</span><span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> <span class="token number">304</span> <span class="token number">0</span> <span class="token string">"-"</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko"</span> <span class="token string">"-"</span>
<span class="token number">172.17</span><span class="token number">.42</span><span class="token number">.0</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">09</span><span class="token operator">/</span>Oct<span class="token operator">/</span><span class="token number">2020</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token number">09</span> <span class="token operator">+</span><span class="token number">0000</span><span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> <span class="token number">200</span> <span class="token number">612</span> <span class="token string">"-"</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko"</span> <span class="token string">"-"</span>
<span class="token number">2020</span><span class="token operator">/</span><span class="token number">10</span><span class="token operator">/</span><span class="token number">09</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token number">09</span> <span class="token punctuation">[</span>error<span class="token punctuation">]</span> <span class="token number">28</span>#<span class="token number">28</span><span class="token punctuation">:</span> <span class="token operator">*</span><span class="token number">3</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token string">"/usr/share/nginx/html/favicon.ico"</span> <span class="token function">failed</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">:</span> No such file or directory<span class="token punctuation">)</span><span class="token punctuation">,</span> client<span class="token punctuation">:</span> <span class="token number">172.17</span><span class="token number">.42</span><span class="token number">.0</span><span class="token punctuation">,</span> server<span class="token punctuation">:</span> localhost<span class="token punctuation">,</span> request<span class="token punctuation">:</span> <span class="token string">"GET /favicon.ico HTTP/1.1"</span><span class="token punctuation">,</span> host<span class="token punctuation">:</span> <span class="token string">"14.0.0.70:31641"</span>      #访问<span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.70</span><span class="token punctuation">:</span><span class="token number">31641</span>产生的日志
<span class="token number">172.17</span><span class="token number">.42</span><span class="token number">.0</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">09</span><span class="token operator">/</span>Oct<span class="token operator">/</span><span class="token number">2020</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token number">09</span> <span class="token operator">+</span><span class="token number">0000</span><span class="token punctuation">]</span> <span class="token string">"GET /favicon.ico HTTP/1.1"</span> <span class="token number">404</span> <span class="token number">153</span> <span class="token string">"-"</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko"</span> <span class="token string">"-"</span>
<span class="token number">172.17</span><span class="token number">.42</span><span class="token number">.0</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">09</span><span class="token operator">/</span>Oct<span class="token operator">/</span><span class="token number">2020</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token number">11</span> <span class="token operator">+</span><span class="token number">0000</span><span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> <span class="token number">304</span> <span class="token number">0</span> <span class="token string">"-"</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko"</span> <span class="token string">"-"</span>
<span class="token number">172.17</span><span class="token number">.42</span><span class="token number">.0</span> <span class="token operator">-</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token number">09</span><span class="token operator">/</span>Oct<span class="token operator">/</span><span class="token number">2020</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token number">11</span> <span class="token operator">+</span><span class="token number">0000</span><span class="token punctuation">]</span> <span class="token string">"GET / HTTP/1.1"</span> <span class="token number">304</span> <span class="token number">0</span> <span class="token string">"-"</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko"</span> <span class="token string">"-"</span>
</code></pre> 
<p>3.更新nginx为1.14版本<br> 谷歌浏览器按F12刷新页面查看nginx版本信息<br> <img src="https://images2.imgbox.com/d8/6d/bKuwbpuT_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-javascript">#获取修改模板
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">set</span> <span class="token operator">--</span>help
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">set</span> image <span class="token operator">--</span>help
Examples<span class="token punctuation">:</span>
  # Set a deployment<span class="token string">'s nginx container image to '</span>nginx<span class="token punctuation">:</span><span class="token number">1.9</span><span class="token number">.1</span>'<span class="token punctuation">,</span> and its busybox
container image to <span class="token string">'busybox'</span><span class="token punctuation">.</span>
  kubectl <span class="token keyword">set</span> image deployment<span class="token operator">/</span>nginx busybox<span class="token operator">=</span>busybox nginx<span class="token operator">=</span>nginx<span class="token punctuation">:</span><span class="token number">1.9</span><span class="token number">.1</span>
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">set</span> image deployment<span class="token operator">/</span>nginx<span class="token operator">-</span>test nginx<span class="token operator">-</span>test<span class="token operator">=</span>nginx<span class="token punctuation">:</span><span class="token number">1.14</span>
deployment<span class="token punctuation">.</span>extensions<span class="token operator">/</span>nginx<span class="token operator">-</span>test image updated
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">get</span> pods <span class="token operator">-</span>w    #动态查看更新过程
<span class="token constant">NAME</span>                          <span class="token constant">READY</span>   <span class="token constant">STATUS</span>              <span class="token constant">RESTARTS</span>   <span class="token constant">AGE</span>
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>kfstr   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>     Running             <span class="token number">0</span>          <span class="token number">5</span>h23m
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>vqmw6   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>     Running             <span class="token number">0</span>          <span class="token number">5</span>h23m
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>zhptn   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>     Running             <span class="token number">0</span>          <span class="token number">5</span>h23m
nginx<span class="token operator">-</span>test<span class="token operator">-</span>b884fcd65<span class="token operator">-</span><span class="token number">65</span>tkj    <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>     ContainerCreating   <span class="token number">0</span>          <span class="token number">9</span>s
nginx<span class="token operator">-</span>test<span class="token operator">-</span>b884fcd65<span class="token operator">-</span><span class="token number">65</span>tkj   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>   Running   <span class="token number">0</span>     <span class="token number">11</span>s
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>kfstr   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>   Terminating   <span class="token number">0</span>     <span class="token number">5</span>h23m
nginx<span class="token operator">-</span>test<span class="token operator">-</span>b884fcd65<span class="token operator">-</span><span class="token number">8</span>sv8h   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   Pending   <span class="token number">0</span>     <span class="token number">0</span>s
nginx<span class="token operator">-</span>test<span class="token operator">-</span>b884fcd65<span class="token operator">-</span><span class="token number">8</span>sv8h   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   Pending   <span class="token number">0</span>     <span class="token number">1</span>s
nginx<span class="token operator">-</span>test<span class="token operator">-</span>b884fcd65<span class="token operator">-</span><span class="token number">8</span>sv8h   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   ContainerCreating   <span class="token number">0</span>     <span class="token number">1</span>s
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>kfstr   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   Terminating   <span class="token number">0</span>     <span class="token number">5</span>h23m
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>kfstr   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   Terminating   <span class="token number">0</span>     <span class="token number">5</span>h23m
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>kfstr   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   Terminating   <span class="token number">0</span>     <span class="token number">5</span>h23m
nginx<span class="token operator">-</span>test<span class="token operator">-</span>b884fcd65<span class="token operator">-</span><span class="token number">8</span>sv8h   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>   Running   <span class="token number">0</span>     <span class="token number">11</span>s
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>vqmw6   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>   Terminating   <span class="token number">0</span>     <span class="token number">5</span>h24m
nginx<span class="token operator">-</span>test<span class="token operator">-</span>b884fcd65<span class="token operator">-</span>g5szj   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   Pending   <span class="token number">0</span>     <span class="token number">0</span>s
nginx<span class="token operator">-</span>test<span class="token operator">-</span>b884fcd65<span class="token operator">-</span>g5szj   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   Pending   <span class="token number">0</span>     <span class="token number">0</span>s
nginx<span class="token operator">-</span>test<span class="token operator">-</span>b884fcd65<span class="token operator">-</span>g5szj   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   ContainerCreating   <span class="token number">0</span>     <span class="token number">0</span>s
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>vqmw6   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   Terminating   <span class="token number">0</span>     <span class="token number">5</span>h24m
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>vqmw6   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   Terminating   <span class="token number">0</span>     <span class="token number">5</span>h24m
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>vqmw6   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   Terminating   <span class="token number">0</span>     <span class="token number">5</span>h24m
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>vqmw6   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   Terminating   <span class="token number">0</span>     <span class="token number">5</span>h24m
nginx<span class="token operator">-</span>test<span class="token operator">-</span>b884fcd65<span class="token operator">-</span>g5szj   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>   Running   <span class="token number">0</span>     <span class="token number">17</span>s
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>zhptn   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>   Terminating   <span class="token number">0</span>     <span class="token number">5</span>h24m
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>zhptn   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   Terminating   <span class="token number">0</span>     <span class="token number">5</span>h24m
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>zhptn   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   Terminating   <span class="token number">0</span>     <span class="token number">5</span>h24m
nginx<span class="token operator">-</span>test<span class="token operator">-</span><span class="token number">7</span>fcfb6488c<span class="token operator">-</span>zhptn   <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>   Terminating   <span class="token number">0</span>     <span class="token number">5</span>h24m
</code></pre> 
<p>业务更新：采用滚动更新的方式：先创建一个新的，等running以后再终止一个旧的（因为要维持副本数不变）<br> #谷歌浏览器上刷新页面，发现成功更新版本为1.14版本<br> <img src="https://images2.imgbox.com/67/95/oQMMQZ1u_o.png" alt="在这里插入图片描述"></p> 
<p>4.回滚nginx</p> 
<pre><code class="prism language-javascript"><span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl rollout <span class="token operator">--</span>help
Examples<span class="token punctuation">:</span>
  # Rollback to the previous deployment
  kubectl rollout undo deployment<span class="token operator">/</span>abc
Available Commands<span class="token punctuation">:</span>
  history     显示 rollout 历史
  pause       标记提供的 resource 为中止状态
  resume      继续一个停止的 resource
  status      显示 rollout 的状态
  undo        撤销上一次的 rollout
Usage<span class="token punctuation">:</span>
  kubectl rollout <span class="token constant">SUBCOMMAND</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span>
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl rollout history deployment<span class="token operator">/</span>nginx<span class="token operator">-</span>test   #查看历史版本
deployment<span class="token punctuation">.</span>extensions<span class="token operator">/</span>nginx<span class="token operator">-</span>test
<span class="token constant">REVISION</span>  <span class="token constant">CHANGE</span><span class="token operator">-</span><span class="token constant">CAUSE</span>
<span class="token number">1</span>         <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
<span class="token number">2</span>         <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl rollout undo deployment<span class="token operator">/</span>nginx<span class="token operator">-</span>test    #执行回滚
deployment<span class="token punctuation">.</span>extensions<span class="token operator">/</span>nginx<span class="token operator">-</span>test
#同样是先创建一个新的，再删除一个旧的pod
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl rollout status deployment<span class="token operator">/</span>nginx<span class="token operator">-</span>test  #查看回滚执行状态
deployment <span class="token string">"nginx-test"</span> successfully rolled out
</code></pre> 
<p><img src="https://images2.imgbox.com/08/ab/cGZrM16U_o.png" alt="在这里插入图片描述"></p> 
<p>5.删除nginx</p> 
<pre><code class="prism language-javascript">#查看deployment
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">get</span> deploy
<span class="token constant">NAME</span>         <span class="token constant">DESIRED</span>   <span class="token constant">CURRENT</span>   <span class="token constant">UP</span><span class="token operator">-</span><span class="token constant">TO</span><span class="token operator">-</span><span class="token constant">DATE</span>   <span class="token constant">AVAILABLE</span>   <span class="token constant">AGE</span>
nginx<span class="token operator">-</span>test   <span class="token number">3</span>         <span class="token number">3</span>         <span class="token number">3</span>            <span class="token number">3</span>           <span class="token number">5</span>h43m
#删除控制器才能彻底删除（除了svc资源）
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">delete</span> deploy<span class="token operator">/</span>nginx<span class="token operator">-</span>test  
deployment<span class="token punctuation">.</span>extensions <span class="token string">"nginx-test"</span> deleted
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">get</span> pods<span class="token punctuation">,</span>deploy<span class="token punctuation">,</span>rs
No resources found<span class="token punctuation">.</span>
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">get</span> svc
<span class="token constant">NAME</span>            <span class="token constant">TYPE</span>        <span class="token constant">CLUSTER</span><span class="token operator">-</span><span class="token constant">IP</span>   <span class="token constant">EXTERNAL</span><span class="token operator">-</span><span class="token constant">IP</span>   <span class="token constant">PORT</span><span class="token punctuation">(</span><span class="token constant">S</span><span class="token punctuation">)</span>        <span class="token constant">AGE</span>
kubernetes      ClusterIP   <span class="token number">10.0</span><span class="token number">.0</span><span class="token number">.1</span>     <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">443</span><span class="token operator">/</span><span class="token constant">TCP</span>        <span class="token number">23</span>h
nginx<span class="token operator">-</span>service   NodePort    <span class="token number">10.0</span><span class="token number">.0</span><span class="token number">.86</span>    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">80</span><span class="token punctuation">:</span><span class="token number">31641</span><span class="token operator">/</span><span class="token constant">TCP</span>   <span class="token number">5</span>h34m
#删除服务svc
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">delete</span> svc<span class="token operator">/</span>nginx<span class="token operator">-</span>service
service <span class="token string">"nginx-service"</span> deleted
#查看资源的详细信息
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl describe pod nginx<span class="token operator">-</span>dbddb74b8<span class="token operator">-</span><span class="token number">5</span>j5nx
Name<span class="token punctuation">:</span>               nginx<span class="token operator">-</span>dbddb74b8<span class="token operator">-</span><span class="token number">5</span>j5nx
Namespace<span class="token punctuation">:</span>          <span class="token keyword">default</span>
Priority<span class="token punctuation">:</span>           <span class="token number">0</span>
PriorityClassName<span class="token punctuation">:</span>  <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
Node<span class="token punctuation">:</span>               <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.60</span><span class="token operator">/</span><span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.60</span>
Start Time<span class="token punctuation">:</span>         Fri<span class="token punctuation">,</span> <span class="token number">09</span> Oct <span class="token number">2020</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">09</span><span class="token punctuation">:</span><span class="token number">32</span> <span class="token operator">+</span><span class="token number">0800</span>
Labels<span class="token punctuation">:</span>             pod<span class="token operator">-</span>template<span class="token operator">-</span>hash<span class="token operator">=</span>dbddb74b8
                    run<span class="token operator">=</span>nginx
Annotations<span class="token punctuation">:</span>        <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
Status<span class="token punctuation">:</span>             Running
<span class="token constant">IP</span><span class="token punctuation">:</span>                 <span class="token number">172.17</span><span class="token number">.29</span><span class="token number">.2</span>
Controlled By<span class="token punctuation">:</span>      ReplicaSet<span class="token operator">/</span>nginx<span class="token operator">-</span>dbddb74b8
Containers<span class="token punctuation">:</span>
  nginx<span class="token punctuation">:</span>
    Container <span class="token constant">ID</span><span class="token punctuation">:</span>   docker<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">9</span>bf37a4d6541a337b3019c940283bbaf45483f3b990d7733ec9e1539a7d21bd2
    Image<span class="token punctuation">:</span>          nginx
    Image <span class="token constant">ID</span><span class="token punctuation">:</span>       docker<span class="token operator">-</span>pullable<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>nginx@sha256<span class="token punctuation">:</span>fc66cdef5ca33809823182c9c5d72ea86fd2cef7713cf3363e1a0b12a5d77500
    Port<span class="token punctuation">:</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
    Host Port<span class="token punctuation">:</span>      <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
    State<span class="token punctuation">:</span>          Running
      Started<span class="token punctuation">:</span>      Fri<span class="token punctuation">,</span> <span class="token number">09</span> Oct <span class="token number">2020</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">09</span><span class="token punctuation">:</span><span class="token number">34</span> <span class="token operator">+</span><span class="token number">0800</span>
    Ready<span class="token punctuation">:</span>          True
    Restart Count<span class="token punctuation">:</span>  <span class="token number">0</span>
    Environment<span class="token punctuation">:</span>    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
    Mounts<span class="token punctuation">:</span>
      <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>run<span class="token operator">/</span>secrets<span class="token operator">/</span>kubernetes<span class="token punctuation">.</span>io<span class="token operator">/</span>serviceaccount <span class="token keyword">from</span> <span class="token keyword">default</span><span class="token operator">-</span>token<span class="token operator">-</span><span class="token function">dzqfg</span> <span class="token punctuation">(</span>ro<span class="token punctuation">)</span>
Conditions<span class="token punctuation">:</span>
  Type              Status
  Initialized       True
  Ready             True
  ContainersReady   True
  PodScheduled      True
Volumes<span class="token punctuation">:</span>
  <span class="token keyword">default</span><span class="token operator">-</span>token<span class="token operator">-</span>dzqfg<span class="token punctuation">:</span>
    Type<span class="token punctuation">:</span>        <span class="token function">Secret</span> <span class="token punctuation">(</span>a volume populated by a Secret<span class="token punctuation">)</span>
    SecretName<span class="token punctuation">:</span>  <span class="token keyword">default</span><span class="token operator">-</span>token<span class="token operator">-</span>dzqfg
    Optional<span class="token punctuation">:</span>    <span class="token boolean">false</span>
QoS Class<span class="token punctuation">:</span>       BestEffort
Node<span class="token operator">-</span>Selectors<span class="token punctuation">:</span>  <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>

Events<span class="token punctuation">:</span>    #显示了pod创建的每步详细信息
  Type    Reason     Age   From                Message
  <span class="token operator">--</span><span class="token operator">--</span>    <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>     <span class="token operator">--</span><span class="token operator">--</span>  <span class="token operator">--</span><span class="token operator">--</span>                <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
  Normal  Scheduled  <span class="token number">37</span>s   <span class="token keyword">default</span><span class="token operator">-</span>scheduler   Successfully assigned <span class="token keyword">default</span><span class="token operator">/</span>nginx<span class="token operator">-</span>dbddb74b8<span class="token operator">-</span><span class="token number">5</span>j5nx to <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.60</span>       #scheduler调度pod创建到哪个节点上
  Normal  Pulling    <span class="token number">37</span>s   kubelet<span class="token punctuation">,</span> <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.60</span>  pulling image <span class="token string">"nginx"</span>   #下载镜像
  Normal  Pulled     <span class="token number">35</span>s   kubelet<span class="token punctuation">,</span> <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.60</span>  Successfully pulled image <span class="token string">"nginx"</span>
  Normal  Created    <span class="token number">35</span>s   kubelet<span class="token punctuation">,</span> <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.60</span>  Created container      #创建容器
  Normal  Started    <span class="token number">35</span>s   kubelet<span class="token punctuation">,</span> <span class="token number">14.0</span><span class="token number">.0</span><span class="token number">.60</span>  Started container

#查看deployment控制器资源
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl describe deployment<span class="token punctuation">.</span>apps<span class="token operator">/</span>nginx
Name<span class="token punctuation">:</span>                   nginx
Namespace<span class="token punctuation">:</span>              <span class="token keyword">default</span>
CreationTimestamp<span class="token punctuation">:</span>      Fri<span class="token punctuation">,</span> <span class="token number">09</span> Oct <span class="token number">2020</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">09</span><span class="token punctuation">:</span><span class="token number">32</span> <span class="token operator">+</span><span class="token number">0800</span>
Labels<span class="token punctuation">:</span>                 run<span class="token operator">=</span>nginx
Annotations<span class="token punctuation">:</span>            deployment<span class="token punctuation">.</span>kubernetes<span class="token punctuation">.</span>io<span class="token operator">/</span>revision<span class="token punctuation">:</span> <span class="token number">1</span>
Selector<span class="token punctuation">:</span>               run<span class="token operator">=</span>nginx
Replicas<span class="token punctuation">:</span>               <span class="token number">1</span> desired <span class="token operator">|</span> <span class="token number">1</span> updated <span class="token operator">|</span> <span class="token number">1</span> total <span class="token operator">|</span> <span class="token number">1</span> available <span class="token operator">|</span> <span class="token number">0</span> unavailable
StrategyType<span class="token punctuation">:</span>           RollingUpdate
MinReadySeconds<span class="token punctuation">:</span>        <span class="token number">0</span>
RollingUpdateStrategy<span class="token punctuation">:</span>  <span class="token number">25</span><span class="token operator">%</span> max unavailable<span class="token punctuation">,</span> <span class="token number">25</span><span class="token operator">%</span> max surge
Pod Template<span class="token punctuation">:</span>
  Labels<span class="token punctuation">:</span>  run<span class="token operator">=</span>nginx
  Containers<span class="token punctuation">:</span>
   nginx<span class="token punctuation">:</span>
    Image<span class="token punctuation">:</span>        nginx
    Port<span class="token punctuation">:</span>         <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
    Host Port<span class="token punctuation">:</span>    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
    Environment<span class="token punctuation">:</span>  <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
    Mounts<span class="token punctuation">:</span>       <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
  Volumes<span class="token punctuation">:</span>        <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
Conditions<span class="token punctuation">:</span>
  Type           Status  Reason
  <span class="token operator">--</span><span class="token operator">--</span>           <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>  <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
  Available      True    MinimumReplicasAvailable
  Progressing    True    NewReplicaSetAvailable
OldReplicaSets<span class="token punctuation">:</span>  <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
NewReplicaSet<span class="token punctuation">:</span>   nginx<span class="token operator">-</span><span class="token function">dbddb74b8</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span> replicas created<span class="token punctuation">)</span>
Events<span class="token punctuation">:</span>
  Type    Reason             Age    From                   Message
  <span class="token operator">--</span><span class="token operator">--</span>    <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>             <span class="token operator">--</span><span class="token operator">--</span>   <span class="token operator">--</span><span class="token operator">--</span>                   <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
  Normal  ScalingReplicaSet  <span class="token number">5</span>m49s  deployment<span class="token operator">-</span>controller  Scaled up replica <span class="token keyword">set</span> nginx<span class="token operator">-</span>dbddb74b8 to <span class="token number">1</span>  
#处理集群中常规后台任务，一个资源对应一个控制器，控制器定义资源的类型，而controller<span class="token operator">-</span>manager就是负责管理这些控制器的；维持副本期望的数目
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl <span class="token keyword">get</span> pods
<span class="token constant">NAME</span>                    <span class="token constant">READY</span>   <span class="token constant">STATUS</span>    <span class="token constant">RESTARTS</span>   <span class="token constant">AGE</span>
nginx<span class="token operator">-</span>dbddb74b8<span class="token operator">-</span><span class="token number">5</span>j5nx   <span class="token number">1</span><span class="token operator">/</span><span class="token number">1</span>     Running   <span class="token number">0</span>          <span class="token number">9</span>m36s
#进入pod
<span class="token punctuation">[</span>root@master02 <span class="token operator">~</span><span class="token punctuation">]</span># kubectl exec <span class="token operator">-</span>it nginx<span class="token operator">-</span>dbddb74b8<span class="token operator">-</span><span class="token number">5</span>j5nx bash
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/88b8d6605fd9411204088062fc1a3075/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">c&#43;&#43;编译中出现‘vtable for ***未定义的引用解决办法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cff9ff62cfa25592d8d189a76badea86/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">限定通配符和非限定通配符_什么是通配符？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>