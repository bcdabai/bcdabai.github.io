<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>LLM（六）| Gemini：谷歌Gemini Pro 开放API ，Gemini Pro 可免费使用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="LLM（六）| Gemini：谷歌Gemini Pro 开放API ，Gemini Pro 可免费使用" />
<meta property="og:description" content="近期，Google Gemini Pro 开放API 了，且Gemini Pro 可免费使用！Gemini Pro支持全球180个国家的38种语言，目前接受文本作为输入并生成文本作为输出。
Gemini API 地址：http://ai.google.dev
Gemini Pro 的表现超越了其他同类模型，当前版本配备了 32K 文本上下文窗口，可免费使用，且其定价将十分有竞争力。
具备丰富的功能：函数调用、数据嵌入、语义检索、自定义知识嵌入以及聊天功能。可处理文本输入并生成文本输出，以及专门的 Gemini Pro 视觉多模态终端，能够处理图像和文本输入，输出文本。
提供多种 SDK，以便开发者在不同平台上构建应用，包括 Python、Android (Kotlin)、Node.js、Swift 和 JavaScript。
Gemini Pro 提供了易于使用的 SDK，助力开发者在任何平台上快速构建应用。还提供了一个免费的在线开发工具 Google AI Studio，快速构建 Gemini 应用。
Studio ：https://makersuite.google.com
Gemini Pro Python API使用 下面将介绍如何使用Python SDK使用Gemini API，具体内容如下：
设置开发环境和申请Gemini API访问权限；
根据文本输入生成文本响应；
从多模式输入（文本和图像）生成文本响应；
使用Gemini进行多轮对话（聊天）；
使用Gemini进行embedding。
1）设置开发环境和申请Gemini API访问权限 安装相关库
!pip install -q -U google-generativeai 导入相关包
import pathlibimport textwrap​import google.generativeai as genai​# Used to securely store your API keyfrom google." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/657e939e6e72f2adaa10d11d276f9427/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-14T15:41:29+08:00" />
<meta property="article:modified_time" content="2023-12-14T15:41:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">LLM（六）| Gemini：谷歌Gemini Pro 开放API ，Gemini Pro 可免费使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<p class="img-center"><img alt="" height="249" src="https://images2.imgbox.com/8d/e5/LScsuT61_o.png" width="1080"></p> 
<p>       近期，Google Gemini Pro 开放API 了，且Gemini Pro 可免费使用！Gemini Pro支持全球180个国家的38种语言，目前接受文本作为输入并生成文本作为输出。</p> 
<p><strong>Gemini API 地址</strong>：http://ai.google.dev</p> 
<p></p> 
<p class="img-center"><img alt="" height="408" src="https://images2.imgbox.com/6b/37/OIrLfmk6_o.png" width="1080"></p> 
<p>       Gemini Pro 的表现超越了其他同类模型，当前版本配备了 32K 文本上下文窗口，可免费使用，且其定价将十分有竞争力。</p> 
<p>       具备丰富的功能：函数调用、数据嵌入、语义检索、自定义知识嵌入以及聊天功能。可处理文本输入并生成文本输出，以及专门的 Gemini Pro 视觉多模态终端，能够处理图像和文本输入，输出文本。</p> 
<p>       提供多种 SDK，以便开发者在不同平台上构建应用，包括 Python、Android (Kotlin)、Node.js、Swift 和 JavaScript。</p> 
<p></p> 
<p class="img-center"><img alt="" height="599" src="https://images2.imgbox.com/62/a0/VpbyFixK_o.png" width="1080"></p> 
<p>       Gemini Pro 提供了易于使用的 SDK，助力开发者在任何平台上快速构建应用。还提供了一个免费的在线开发工具 Google AI Studio，快速构建 Gemini 应用。</p> 
<p><strong>Studio</strong> ：https://makersuite.google.com</p> 
<h2><strong>Gemini Pro Python API使用</strong></h2> 
<p>下面将介绍如何使用Python SDK使用Gemini API，具体内容如下：</p> 
<ol><li> <p>设置开发环境和申请Gemini API访问权限；</p> </li><li> <p>根据文本输入生成文本响应；</p> </li><li> <p>从多模式输入（文本和图像）生成文本响应；</p> </li><li> <p>使用Gemini进行多轮对话（聊天）；</p> </li><li> <p>使用Gemini进行embedding。</p> </li></ol> 
<h3><strong>1）</strong><strong>设置开发环境和申请Gemini API访问权限</strong></h3> 
<p><strong>安装相关库</strong></p> 
<pre><code>!pip install -q -U google-generativeai</code></pre> 
<p><strong>导入相关包</strong></p> 
<pre><code>import pathlib</code><code>import textwrap</code><code>​</code><code>import google.generativeai as genai</code><code>​</code><code># Used to securely store your API key</code><code>from google.colab import userdata</code><code>​</code><code>from IPython.display import display</code><code>from IPython.display import Markdown</code><code>​</code><code>​</code><code>def to_markdown(text):</code><code>  text = text.replace('•', '  *')</code><code>  return Markdown(textwrap.indent(text, '&gt; ', predicate=lambda _: True))</code></pre> 
<p><strong>设置Gemini API Key</strong></p> 
<p><strong>申请API Key地址</strong>： https://makersuite.google.com/app/apikey</p> 
<pre><code># Or use `os.getenv('GOOGLE_API_KEY')` to fetch an environment variable.</code><code>GOOGLE_API_KEY=userdata.get('GOOGLE_API_KEY')</code><code>​</code><code>genai.configure(api_key=GOOGLE_API_KEY)</code></pre> 
<p><strong>查看支持的大模型</strong></p> 
<pre><code>for m in genai.list_models():</code><code>  if 'generateContent' in m.supported_generation_methods:</code><code>    print(m.name)</code></pre> 
<h3><strong>2）根据文本输入生成文本响应</strong></h3> 
<pre><code>model = genai.GenerativeModel('gemini-pro')</code></pre> 
<p>       generate_content方法可以处理各种各样的用例，包括多回合聊天和多模式输入，这取决于底层模型支持什么。可用的模型仅支持文本和图像作为输入，文本作为输出。</p> 
<p>在最简单的情况下，可以将Prompt字符串传递给GenerativeModel.generate_content方法：</p> 
<pre><code>%%time</code><code>response = model.generate_content("What is the meaning of life?")</code><code>​</code><code># 输出</code><code>CPU times: user 110 ms, sys: 12.3 ms, total: 123 ms</code><code>Wall time: 8.25 s</code></pre> 
<p>在简单的情况下，response.text访问器就是您所需要的全部。要显示格式化的Markdown文本，请使用To_Markdown功能：</p> 
<pre><code>to_markdown(response.text)</code></pre> 
<pre><code>The query of life's purpose has perplexed people across centuries, cultures, and continents. While there is no universally recognized response, many ideas have been put forth, and the response is frequently dependent on individual ideas, beliefs, and life experiences.</code><code>​</code><code>Happiness and Well-being: Many individuals believe that the goal of life is to attain personal happiness and well-being. This might entail locating pursuits that provide joy, establishing significant connections, caring for one's physical and mental health, and pursuing personal goals and interests.</code><code>​</code><code>Meaningful Contribution: Some believe that the purpose of life is to make a meaningful contribution to the world. This might entail pursuing a profession that benefits others, engaging in volunteer or charitable activities, generating art or literature, or inventing.</code><code>​</code><code>Self-realization and Personal Growth: The pursuit of self-realization and personal development is another common goal in life. This might entail learning new skills, pushing one's boundaries, confronting personal obstacles, and evolving as a person.</code><code>​</code><code>Ethical and Moral Behavior: Some believe that the goal of life is to act ethically and morally. This might entail adhering to one's moral principles, doing the right thing even when it is difficult, and attempting to make the world a better place.</code><code>​</code><code>Spiritual Fulfillment: For some, the purpose of life is connected to spiritual or religious beliefs. This might entail seeking a connection with a higher power, practicing religious rituals, or following spiritual teachings.</code><code>​</code><code>Experiencing Life to the Fullest: Some individuals believe that the goal of life is to experience all that it has to offer. This might entail traveling, trying new things, taking risks, and embracing new encounters.</code><code>​</code><code>Legacy and Impact: Others believe that the purpose of life is to leave a lasting legacy and impact on the world. This might entail accomplishing something noteworthy, being remembered for one's contributions, or inspiring and motivating others.</code><code>​</code><code>Finding Balance and Harmony: For some, the purpose of life is to find balance and harmony in all aspects of their lives. This might entail juggling personal, professional, and social obligations, seeking inner peace and contentment, and living a life that is in accordance with one's values and beliefs.</code><code>​</code><code>Ultimately, the meaning of life is a personal journey, and different individuals may discover their own unique purpose through their experiences, reflections, and interactions with the world around them.</code></pre> 
<p>如果API没有返回结果，可以使用GenerateContentRespose.compt_feedback查看它是否因提示的安全问题而被阻止。</p> 
<pre><code>response.prompt_feedback</code></pre> 
<pre><code>safety_ratings {<!-- --></code><code>  category: HARM_CATEGORY_SEXUALLY_EXPLICIT</code><code>  probability: NEGLIGIBLE</code><code>}</code><code>safety_ratings {<!-- --></code><code>  category: HARM_CATEGORY_HATE_SPEECH</code><code>  probability: NEGLIGIBLE</code><code>}</code><code>safety_ratings {<!-- --></code><code>  category: HARM_CATEGORY_HARASSMENT</code><code>  probability: NEGLIGIBLE</code><code>}</code><code>safety_ratings {<!-- --></code><code>  category: HARM_CATEGORY_DANGEROUS_CONTENT</code><code>  probability: NEGLIGIBLE</code><code>}</code></pre> 
<p>      Gemini可以对一个提示产生多种可能的反应。这些可能的回答被称为候选者，您可以对其进行审查，以选择最合适的一个作为回答。</p> 
<p>使用GenerateContentResponse.candidates查看候选响应：</p> 
<pre><code>response.candidates</code></pre> 
<pre><code>[content {<!-- --></code><code>  parts {<!-- --></code><code>    text: "The query of life\'s purpose has perplexed people across centuries, cultures, and continents. While there is no universally recognized response, many ideas have been put forth, and the response is frequently dependent on individual ideas, beliefs, and life experiences.\n\n1. **Happiness and Well-being:** Many individuals believe that the goal of life is to attain personal happiness and well-being. This might entail locating pursuits that provide joy, establishing significant connections, caring for one\'s physical and mental health, and pursuing personal goals and interests.\n\n2. **Meaningful Contribution:** Some believe that the purpose of life is to make a meaningful contribution to the world. This might entail pursuing a profession that benefits others, engaging in volunteer or charitable activities, generating art or literature, or inventing.\n\n3. **Self-realization and Personal Growth:** The pursuit of self-realization and personal development is another common goal in life. This might entail learning new skills, pushing one\'s boundaries, confronting personal obstacles, and evolving as a person.\n\n4. **Ethical and Moral Behavior:** Some believe that the goal of life is to act ethically and morally. This might entail adhering to one\'s moral principles, doing the right thing even when it is difficult, and attempting to make the world a better place.\n\n5. **Spiritual Fulfillment:** For some, the purpose of life is connected to spiritual or religious beliefs. This might entail seeking a connection with a higher power, practicing religious rituals, or following spiritual teachings.\n\n6. **Experiencing Life to the Fullest:** Some individuals believe that the goal of life is to experience all that it has to offer. This might entail traveling, trying new things, taking risks, and embracing new encounters.\n\n7. **Legacy and Impact:** Others believe that the purpose of life is to leave a lasting legacy and impact on the world. This might entail accomplishing something noteworthy, being remembered for one\'s contributions, or inspiring and motivating others.\n\n8. **Finding Balance and Harmony:** For some, the purpose of life is to find balance and harmony in all aspects of their lives. This might entail juggling personal, professional, and social obligations, seeking inner peace and contentment, and living a life that is in accordance with one\'s values and beliefs.\n\nUltimately, the meaning of life is a personal journey, and different individuals may discover their own unique purpose through their experiences, reflections, and interactions with the world around them."</code><code>  }</code><code>  role: "model"</code><code>}</code><code>finish_reason: STOP</code><code>index: 0</code><code>safety_ratings {<!-- --></code><code>  category: HARM_CATEGORY_SEXUALLY_EXPLICIT</code><code>  probability: NEGLIGIBLE</code><code>}</code><code>safety_ratings {<!-- --></code><code>  category: HARM_CATEGORY_HATE_SPEECH</code><code>  probability: NEGLIGIBLE</code><code>}</code><code>safety_ratings {<!-- --></code><code>  category: HARM_CATEGORY_HARASSMENT</code><code>  probability: NEGLIGIBLE</code><code>}</code><code>safety_ratings {<!-- --></code><code>  category: HARM_CATEGORY_DANGEROUS_CONTENT</code><code>  probability: NEGLIGIBLE</code><code>}</code><code>]</code></pre> 
<p>       默认情况下，模型在完成整个生成过程后返回一个响应。您还可以在生成响应时对其进行流式传输，一旦生成响应，模型就会返回响应块。</p> 
<p>要流式传输响应，请使用GenerativeModel.generate_content（…，stream=True）。</p> 
<pre><code>%%time</code><code>response = model.generate_content("What is the meaning of life?", stream=True)</code></pre> 
<pre><code>CPU times: user 102 ms, sys: 25.1 ms, total: 128 ms</code><code>Wall time: 7.94 s</code></pre> 
<pre><code>for chunk in response:</code><code>  print(chunk.text)</code><code>  print("_"*80)</code></pre> 
<pre><code>The query of life's purpose has perplexed people across centuries, cultures, and</code><code>________________________________________________________________________________</code><code> continents. While there is no universally recognized response, many ideas have been put forth, and the response is frequently dependent on individual ideas, beliefs, and life experiences</code><code>________________________________________________________________________________</code><code>.</code><code>​</code><code>1. **Happiness and Well-being:** Many individuals believe that the goal of life is to attain personal happiness and well-being. This might entail locating pursuits that provide joy, establishing significant connections, caring for one's physical and mental health, and pursuing personal goals and aspirations.</code><code>​</code><code>2. **Meaning</code><code>________________________________________________________________________________</code><code>ful Contribution:** Some believe that the purpose of life is to make a meaningful contribution to the world. This might entail pursuing a profession that benefits others, engaging in volunteer or charitable activities, generating art or literature, or inventing.</code><code>​</code><code>3. **Self-realization and Personal Growth:** The pursuit of self-realization and personal development is another common goal in life. This might entail learning new skills, exploring one's interests and abilities, overcoming obstacles, and becoming the best version of oneself.</code><code>​</code><code>4. **Connection and Relationships:** For many individuals, the purpose of life is found in their relationships with others. This might entail building</code><code>________________________________________________________________________________</code><code> strong bonds with family and friends, fostering a sense of community, and contributing to the well-being of those around them.</code><code>​</code><code>5. **Spiritual Fulfillment:** For those with religious or spiritual beliefs, the purpose of life may be centered on seeking spiritual fulfillment or enlightenment. This might entail following religious teachings, engaging in spiritual practices, or seeking a deeper understanding of the divine.</code><code>​</code><code>6. **Experiencing the Journey:** Some believe that the purpose of life is simply to experience the journey itself, with all its joys and sorrows. This perspective emphasizes embracing the present moment, appreciating life's experiences, and finding meaning in the act of living itself.</code><code>​</code><code>7. **Legacy and Impact:** For others, the goal of life is to leave a lasting legacy or impact on the world. This might entail making a significant contribution to a particular field, leaving a positive mark on future generations, or creating something that will be remembered and cherished long after one's lifetime.</code><code>​</code><code>Ultimately, the meaning of life is a personal and subjective question, and there is no single, universally accepted answer. It is about discovering what brings you fulfillment, purpose, and meaning in your own life, and living in accordance with those values.</code><code>________________________________________________________________________________</code></pre> 
<p>流式传输时，在迭代完所有响应块之后，某些响应属性才可用。如下所示：</p> 
<pre><code>response = model.generate_content("What is the meaning of life?", stream=True)</code></pre> 
<pre><code># prompt_feedback属性可以使用</code><code>response.prompt_feedback</code></pre> 
<pre><code>safety_ratings {<!-- --></code><code>  category: HARM_CATEGORY_SEXUALLY_EXPLICIT</code><code>  probability: NEGLIGIBLE</code><code>}</code><code>safety_ratings {<!-- --></code><code>  category: HARM_CATEGORY_HATE_SPEECH</code><code>  probability: NEGLIGIBLE</code><code>}</code><code>safety_ratings {<!-- --></code><code>  category: HARM_CATEGORY_HARASSMENT</code><code>  probability: NEGLIGIBLE</code><code>}</code><code>safety_ratings {<!-- --></code><code>  category: HARM_CATEGORY_DANGEROUS_CONTENT</code><code>  probability: NEGLIGIBLE</code><code>}</code></pre> 
<pre><code># text属性不可用</code><code>try:</code><code>  response.text</code><code>except Exception as e:</code><code>  print(f'{type(e).__name__}: {e}')</code></pre> 
<pre><code>IncompleteIterationError: Please let the response complete iteration before accessing the final accumulated</code><code>attributes (or call `response.resolve()`)</code></pre> 
<h3><strong>3）从多模式输入（文本和图像）生成文本响应</strong></h3> 
<p>      Gemini提供了一个多模态模型（Gemini-pro-vision），可以接受文本、图像和输入。GenerativeModel.generate_content API用于处理多模态Prompt并返回文本输出。</p> 
<p>下载一张图片：</p> 
<pre><code>!curl -o image.jpg https://t0.gstatic.com/licensed-image?q=tbn:ANd9GcQ_Kevbk21QBRy-PgB4kQpS79brbmmEG7m3VOTShAn4PecDU5H5UxrJxE3Dw1JiaG17V88QIol19-3TM2wCHw</code></pre> 
<p>查看该图片：</p> 
<pre><code>import PIL.Image</code><code>​</code><code>img = PIL.Image.open('image.jpg')</code><code>img</code></pre> 
<p></p> 
<p class="img-center"><img alt="" height="720" src="https://images2.imgbox.com/0c/a9/JP0tfoMf_o.png" width="1080"></p> 
<p>使用gemini-pro-vision模型，并将图像传递给generate_content模型。</p> 
<pre><code>model = genai.GenerativeModel('gemini-pro-vision')</code></pre> 
<pre><code>response = model.generate_content(img)</code><code>​</code><code>to_markdown(response.text)</code></pre> 
<pre><code>Chicken Teriyaki Meal Prep Bowls with brown rice, roasted broccoli and bell peppers.</code></pre> 
<p>在Prompt中同时输入文本和图像，需要把字符串和图像以list格式输入：</p> 
<pre><code>response = model.generate_content(["Write a short, engaging blog post based on this picture. It should include a description of the meal in the photo and talk about my journey meal prepping.", img], stream=True)</code><code>response.resolve()</code></pre> 
<pre><code>to_markdown(response.text)</code></pre> 
<pre><code>Meal prepping is a great way to save time and money, and it can also help you to eat healthier. This meal is a great example of a healthy and delicious meal that can be easily prepped ahead of time.</code><code>​</code><code>This meal features brown rice, roasted vegetables, and chicken teriyaki. The brown rice is a whole grain that is high in fiber and nutrients. The roasted vegetables are a great way to get your daily dose of vitamins and minerals. And the chicken teriyaki is a lean protein source that is also packed with flavor.</code><code>​</code><code>This meal is easy to prepare ahead of time. Simply cook the brown rice, roast the vegetables, and cook the chicken teriyaki. Then, divide the meal into individual containers and store them in the refrigerator. When you're ready to eat, simply grab a container and heat it up.</code><code>​</code><code>This meal is a great option for busy people who are looking for a healthy and delicious way to eat. It's also a great meal for those who are trying to lose weight or maintain a healthy weight.</code><code>​</code><code>If you're looking for a healthy and delicious meal that can be easily prepped ahead of time, this meal is a great option. Give it a try today!</code></pre> 
<h3><strong>4）使用Gemini进行多轮对话（聊天）</strong></h3> 
<p>       Gemini支持多轮对话。ChatSession类通过管理会话的状态来简化过程，这与generate_content不同，不必将会话历史记录存储为列表。</p> 
<p>初始化聊天：</p> 
<pre><code>model = genai.GenerativeModel('gemini-pro')</code><code>chat = model.start_chat(history=[])</code><code>chat</code></pre> 
<pre><code>&lt;google.generativeai.generative_models.ChatSession at 0x7b7b68250100&gt;</code></pre> 
<p><strong>PS：视觉模型gemini-pro-vision没有针对多轮对话优化。</strong></p> 
<p>ChatSession.send_message方法返回与GenerativeModel.generate_content相同的GenerateContentResponse类型，还将您的消息和响应附加到聊天历史记录中：</p> 
<pre><code>response = chat.send_message("In one sentence, explain how a computer works to a young child.")</code><code>to_markdown(response.text)</code><code># 输出</code><code>A computer is like a very smart machine that can understand and follow our instructions, help us with our work, and even play games with us!</code></pre> 
<pre><code>chat.history</code><code># 输出</code><code>[parts {   text: "In one sentence, explain how a computer works to a young child." } role: "user", parts {   text: "A computer is like a very smart machine that can understand and follow our instructions, help us with our work, and even play games with us!" } role: "model"]</code></pre> 
<p>使用stream=True参数可以设置流式传输聊天，可以持续输入内容：</p> 
<pre><code>response = chat.send_message("Okay, how about a more detailed explanation to a high schooler?", stream=True)</code><code>​</code><code>for chunk in response:</code><code>  print(chunk.text)</code><code>  print("_"*80)</code># 输出<code>A computer works by following instructions, called a program, which tells it what to</code><code>________________________________________________________________________________ </code><code>do. These instructions are written in a special language that the computer can understand, and they are stored in the computer's memory. The computer's processor</code><code>________________________________________________________________________________</code><code>, or CPU, reads the instructions from memory and carries them out, performing calculations and making decisions based on the program's logic. The results of these calculations and decisions are then displayed on the computer's screen or stored in memory for later use.</code><code>To give you a simple analogy, imagine a computer as a</code><code>________________________________________________________________________________</code><code> chef following a recipe. The recipe is like the program, and the chef's actions are like the instructions the computer follows. The chef reads the recipe (the program) and performs actions like gathering ingredients (fetching data from memory), mixing them together (performing calculations), and cooking them (processing data). The final dish (the output) is then presented on a plate (the computer screen).</code><code> In summary, a computer works by executing a series of instructions, stored in its memory, to perform calculations, make decisions, and display or store the results.</code><code> ________________________________________________________________________________</code></pre> 
<p>      glm.Content对象包含一个glm.Part对象列表。每个glm.Part对象都包含text（字符串）或inline_data（glm.Blob），其中blob包含二进制数据和mime_type。聊天历史记录在以glm.Content列表的形式存储在ChatSession.history对象中：</p> 
<pre><code>for message in chat.history:</code><code>  display(to_markdown(f'**{message.role}**: {message.parts[0].text}'))</code><code># 输出</code><code>user: In one sentence, explain how a computer works to a young child.</code><code>​</code><code>model: A computer is like a very smart machine that can understand and follow our instructions, help us with our work, and even play games with us!</code><code>​</code><code>user: Okay, how about a more detailed explanation to a high schooler?</code><code>​</code><code>model: A computer works by following instructions, called a program, which tells it what to do. These instructions are written in a special language that the computer can understand, and they are stored in the computer's memory. The computer's processor, or CPU, reads the instructions from memory and carries them out, performing calculations and making decisions based on the program's logic. The results of these calculations and decisions are then displayed on the computer's screen or stored in memory for later use.</code><code>​</code><code>To give you a simple analogy, imagine a computer as a chef following a recipe. The recipe is like the program, and the chef's actions are like the instructions the computer follows. The chef reads the recipe (the program) and performs actions like gathering ingredients (fetching data from memory), mixing them together (performing calculations), and cooking them (processing data). The final dish (the output) is then presented on a plate (the computer screen).</code><code>​</code><code>In summary, a computer works by executing a series of instructions, stored in its memory, to perform calculations, make decisions, and display or store the results.</code></pre> 
<h3><strong>5）使用Gemini进行embedding</strong></h3> 
<p>      使用embed_content方法生成embedding，可以对以下任务（task_type）进行embedding：</p> 
<table><thead><tr><th>Task Type</th><th>Description</th></tr></thead><tbody><tr><td>RETRIEVAL_QUERY</td><td>Specifies the given text is a query in a search/retrieval setting.</td></tr><tr><td>RETRIEVAL_DOCUMENT</td><td>Specifies the given text is a document in a search/retrieval setting. Using this task type requires a <code>title</code>.</td></tr><tr><td>SEMANTIC_SIMILARITY</td><td>Specifies the given text will be used for Semantic Textual Similarity (STS).</td></tr><tr><td>CLASSIFICATION</td><td>Specifies that the embeddings will be used for classification.</td></tr><tr><td>CLUSTERING</td><td>Specifies that the embeddings will be used for clustering.</td></tr></tbody></table> 
<p>下面为文档检索生成单个字符串的embedding：</p> 
<pre><code>result = genai.embed_content(</code><code>    model="models/embedding-001",</code><code>    content="What is the meaning of life?",</code><code>    task_type="retrieval_document",</code><code>    title="Embedding of single string")</code><code>​</code><code># 1 input &gt; 1 vector output</code><code>print(str(result['embedding'])[:50], '... TRIMMED]')</code></pre> 
<pre><code>[-0.003216741, -0.013358698, -0.017649598, -0.0091 ... TRIMMED]</code></pre> 
<p><strong>PS：retrieval_document任务类型是唯一接受标题的任务。</strong></p> 
<p>可以在content中传入一个字符串列表来对字符串进行批处理：</p> 
<pre><code>result = genai.embed_content(</code><code>    model="models/embedding-001",</code><code>    content=[</code><code>      'What is the meaning of life?',</code><code>      'How much wood would a woodchuck chuck?',</code><code>      'How does the brain work?'],</code><code>    task_type="retrieval_document",</code><code>    title="Embedding of list of strings")</code><code>​</code><code># A list of inputs &gt; A list of vectors output</code><code>for v in result['embedding']:</code><code>  print(str(v)[:50], '... TRIMMED ...')</code></pre> 
<pre><code>[0.0040260437, 0.004124458, -0.014209415, -0.00183 ... TRIMMED ...</code><code>[-0.004049845, -0.0075574904, -0.0073463684, -0.03 ... TRIMMED ...</code><code>[0.025310587, -0.0080734305, -0.029902633, 0.01160 ... TRIMMED ...</code></pre> 
<p>      虽然genai.embedd_content函数接受简单的字符串或字符串列表，但它实际上是围绕glm.Content类型构建的（比如GemerativeModel.generate_content）。glm.Content 在会话API中通常用来初始化会话。</p> 
<p>       然而，glm.Content对象是多模态的，embedd_content方法只支持文本嵌入。这种设计为API提供了扩展到多模式嵌入的可能性。</p> 
<pre><code>response.candidates[0].content</code><code>#输出</code><code>parts {<!-- --></code><code>  text: "A computer works by following instructions, called a program, which tells it what to do. These instructions are written in a special language that the computer can understand, and they are stored in the computer\'s memory. The computer\'s processor, or CPU, reads the instructions from memory and carries them out, performing calculations and making decisions based on the program\'s logic. The results of these calculations and decisions are then displayed on the computer\'s screen or stored in memory for later use.\n\nTo give you a simple analogy, imagine a computer as a chef following a recipe. The recipe is like the program, and the chef\'s actions are like the instructions the computer follows. The chef reads the recipe (the program) and performs actions like gathering ingredients (fetching data from memory), mixing them together (performing calculations), and cooking them (processing data). The final dish (the output) is then presented on a plate (the computer screen).\n\nIn summary, a computer works by executing a series of instructions, stored in its memory, to perform calculations, make decisions, and display or store the results."</code><code>}</code><code>role: "model"</code></pre> 
<pre><code>result = genai.embed_content(</code><code>    model = 'models/embedding-001',</code><code>    content = response.candidates[0].content)</code><code>​</code><code># 1 input &gt; 1 vector output</code><code>print(str(result['embedding'])[:50], '... TRIMMED ...')</code><code>#输出</code><code>[-0.013921871, -0.03504407, -0.0051786783, 0.03113 ... TRIMMED ...</code></pre> 
<p>      同样，聊天历史记录也包含一个glm.Content对象列表。可以直接传递给embed_content函数：</p> 
<pre><code>chat.history</code><code># 输出</code><code>[parts {   text: "In one sentence, explain how a computer works to a young child." } role: "user", parts {   text: "A computer is like a very smart machine that can understand and follow our instructions, help us with our work, and even play games with us!" } role: "model", parts {   text: "Okay, how about a more detailed explanation to a high schooler?" } role: "user", parts {   text: "A computer works by following instructions, called a program, which tells it what to do. These instructions are written in a special language that the computer can understand, and they are stored in the computer\'s memory. The computer\'s processor, or CPU, reads the instructions from memory and carries them out, performing calculations and making decisions based on the program\'s logic. The results of these calculations and decisions are then displayed on the computer\'s screen or stored in memory for later use.\n\nTo give you a simple analogy, imagine a computer as a chef following a recipe. The recipe is like the program, and the chef\'s actions are like the instructions the computer follows. The chef reads the recipe (the program) and performs actions like gathering ingredients (fetching data from memory), mixing them together (performing calculations), and cooking them (processing data). The final dish (the output) is then presented on a plate (the computer screen).\n\nIn summary, a computer works by executing a series of instructions, stored in its memory, to perform calculations, make decisions, and display or store the results." } role: "model"]</code></pre> 
<pre><code>result = genai.embed_content(</code><code>    model = 'models/embedding-001',</code><code>    content = chat.history)</code><code>​</code><code># 1 input &gt; 1 vector output</code><code>for i,v in enumerate(result['embedding']):</code><code>  print(str(v)[:50], '... TRIMMED...')</code></pre> 
<pre><code>[-0.014632266, -0.042202696, -0.015757175, 0.01548 ... TRIMMED...</code><code>[-0.010979066, -0.024494737, 0.0092659835, 0.00803 ... TRIMMED...</code><code>[-0.010055617, -0.07208932, -0.00011750793, -0.023 ... TRIMMED...</code><code>[-0.013921871, -0.03504407, -0.0051786783, 0.03113 ... TRIMMED...</code></pre> 
<h2><strong>参考文献：</strong></h2> 
<p>[1] https://ai.google.dev/</p> 
<p>[2] makersuite.google.com</p> 
<p>[3] https://ai.google.dev/docs?hl=zh-cn</p> 
<p>[4] https://colab.research.google.com/github/google/generative-ai-docs/blob/main/site/en/tutorials/python_quickstart.ipynb#scrollTo=GMUvWNkZ11x4</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ba33788d8b1ed98b30d455004d3bba83/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">60.ORA-12528: TNS:listener</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c41235d748a0391ebc95845477c962d4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C&#43;&#43;力扣题目24--两两交换链表中的节点</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>