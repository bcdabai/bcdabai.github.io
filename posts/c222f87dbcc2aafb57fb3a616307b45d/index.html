<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python è‡ªåŠ¨åŒ–åŠå…¬- openpyxl åˆ›å»ºä¸€ä¸ª Excel å†™å…¥æ•°æ®è‡ªåŠ¨å­˜å‚¨ - ç¼–ç¨‹å¤§ç™½çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python è‡ªåŠ¨åŒ–åŠå…¬- openpyxl åˆ›å»ºä¸€ä¸ª Excel å†™å…¥æ•°æ®è‡ªåŠ¨å­˜å‚¨" />
<meta property="og:description" content="ä¸Šä¸€ç¯‡ è‡ªåŠ¨åŒ–åŠå…¬æ–‡ç« ä¸­ä»‹ç»äº† openpyxl æ¨¡å—å¤„ç† Excel æ–‡ä»¶çš„ä¸€äº›åŸºæœ¬å‘½ä»¤ï¼Œä½†æ–‡ç« ä¸­æ¶‰åŠçš„æ“ä½œå‘½ä»¤å¹¶ä¸æ˜¯å¾ˆå…¨ï¼Œå› æ­¤å°±æœ‰äº†æœ¬ç¯‡æ–‡ç« ï¼›å¼•å…¥ä¸€ä¸ªä¾‹å­ä» åˆ›å»º Workbook åˆ°å­˜å‚¨åˆ°æœ¬åœ°ç£ç›˜ï¼Œæ¶‰åŠçš„æ“ä½œå‘½ä»¤ä¼šæ›´å…¨é¢ä¸€äº›ï¼Œå†…å®¹æ¦‚æ‹¬å¦‚ä¸‹ï¼š
æ–°å»º Workbookï¼Œå¹¶ä¿å­˜ï¼›æ–°å»º sheet ï¼Œä¿®æ”¹æ ‡é¢˜ã€tabColorï¼›å¯¹ sheet ä¸­çš„å•å…ƒæ ¼è¿›è¡Œèµ‹å€¼ï¼›åˆ é™¤ sheet ä¸­æŒ‡å®šè¡Œã€åˆ—(å¯å¤šè¡Œã€å¤šåˆ—)ï¼›æ’å…¥ sheet ä¸­æŒ‡å®šè¡Œã€åˆ—(å¯å¤šè¡Œã€å¤šåˆ—)ï¼›sheet ä¸­æŒ‡å®šåˆ—æ·»åŠ ç­›é€‰æœºåˆ¶ï¼›åˆå¹¶å•å…ƒè¡Œï¼›è®¾ç½®å•å…ƒæ ¼å­—ä½“æ ·å¼ã€å¡«å……æ ·å¼ã€å¯¹é½æ ·å¼ï¼›åº”ç”¨ Excel è¡¨æ ¼ä¸­å‡½æ•°å‘½ä»¤ï¼› æœ¬æ–‡ä¸‹é¢Pythonæ„å»ºçš„åŠå…¬è‡ªåŠ¨åŒ–é¡¹ç›®éƒ½æœ‰è¯¦ç»†çš„é…å¥—æ•™ç¨‹ä»¥åŠæºç ï¼Œéƒ½å·²ç»æ‰“åŒ…å¥½ä¸Šä¼ åˆ°ç™¾åº¦äº‘äº†ï¼Œé“¾æ¥åœ¨æ–‡ç« ç»“å°¾å¤„ï¼
æ‰«ç æ­¤å¤„é¢†å–å¤§å®¶è‡ªè¡Œè·å–å³å¯~~~
1ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Excel æ–‡ä»¶(Workbook)
from openpyxl import Workbook from openpyxl.utils import get_column_letter wb = Workbook() dest_filename = &#34;Empty_book.xlsx&#34; wb.save(dest_filename) 2ï¼Œæ›´æ”¹ sheet æ ‡é¢˜
ws1 = wb.active ws1.title = &#39;range names&#39; **3ï¼Œåœ¨ç¬¬ä¸€ä¸ª sheet 40*600 ä¸ªå•å…ƒæ ¼ä¸­å¡«å……æ•°æ® **
for row in range(1,40): ws1.append(range(600)) 4ï¼Œåº”ç”¨æ±‚å’Œå‡½æ•°å…¬å¼
openpyxl è¿˜æœ‰ä¸€ä¸ªå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨ Excel è¡¨æ ¼å†…ç½®å‡½æ•°ï¼›å‡½æ•°è¯­æ³•ä¸ Excel ä¸­çš„åŸºæœ¬ç›¸åŒï¼Œä½¿ç”¨ä¹‹å‰éœ€è¦åœ¨ å¯¼å…¥æ¨¡å—åŠ å…¥ä¸€è¡Œä»£ç å¯¼å…¥ FORMULAE æ¨¡å—" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c222f87dbcc2aafb57fb3a616307b45d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-05T21:38:00+08:00" />
<meta property="article:modified_time" content="2024-01-05T21:38:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§ç™½çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§ç™½çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python è‡ªåŠ¨åŒ–åŠå…¬- openpyxl åˆ›å»ºä¸€ä¸ª Excel å†™å…¥æ•°æ®è‡ªåŠ¨å­˜å‚¨</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>ä¸Šä¸€ç¯‡ è‡ªåŠ¨åŒ–åŠå…¬æ–‡ç« ä¸­ä»‹ç»äº† openpyxl æ¨¡å—å¤„ç† Excel æ–‡ä»¶çš„ä¸€äº›åŸºæœ¬å‘½ä»¤ï¼Œä½†æ–‡ç« ä¸­æ¶‰åŠçš„æ“ä½œå‘½ä»¤å¹¶ä¸æ˜¯å¾ˆå…¨ï¼Œå› æ­¤å°±æœ‰äº†æœ¬ç¯‡æ–‡ç« ï¼›å¼•å…¥ä¸€ä¸ªä¾‹å­ä» åˆ›å»º Workbook åˆ°å­˜å‚¨åˆ°æœ¬åœ°ç£ç›˜ï¼Œæ¶‰åŠçš„æ“ä½œå‘½ä»¤ä¼šæ›´å…¨é¢ä¸€äº›ï¼Œå†…å®¹æ¦‚æ‹¬å¦‚ä¸‹ï¼š</p> 
<ul><li>æ–°å»º Workbookï¼Œå¹¶ä¿å­˜ï¼›</li><li>æ–°å»º sheet ï¼Œä¿®æ”¹æ ‡é¢˜ã€tabColorï¼›</li><li>å¯¹ sheet ä¸­çš„å•å…ƒæ ¼è¿›è¡Œèµ‹å€¼ï¼›</li><li>åˆ é™¤ sheet ä¸­æŒ‡å®šè¡Œã€åˆ—(å¯å¤šè¡Œã€å¤šåˆ—)ï¼›</li><li>æ’å…¥ sheet ä¸­æŒ‡å®šè¡Œã€åˆ—(å¯å¤šè¡Œã€å¤šåˆ—)ï¼›</li><li>sheet ä¸­æŒ‡å®šåˆ—æ·»åŠ ç­›é€‰æœºåˆ¶ï¼›</li><li>åˆå¹¶å•å…ƒè¡Œï¼›</li><li>è®¾ç½®å•å…ƒæ ¼å­—ä½“æ ·å¼ã€å¡«å……æ ·å¼ã€å¯¹é½æ ·å¼ï¼›</li><li>åº”ç”¨ Excel è¡¨æ ¼ä¸­å‡½æ•°å‘½ä»¤ï¼›</li><li></ul> 
<p>æœ¬æ–‡ä¸‹é¢Pythonæ„å»ºçš„åŠå…¬è‡ªåŠ¨åŒ–é¡¹ç›®éƒ½æœ‰è¯¦ç»†çš„é…å¥—æ•™ç¨‹ä»¥åŠæºç ï¼Œéƒ½å·²ç»æ‰“åŒ…å¥½ä¸Šä¼ åˆ°ç™¾åº¦äº‘äº†ï¼Œé“¾æ¥åœ¨æ–‡ç« ç»“å°¾å¤„ï¼</p> 
<p>æ‰«ç æ­¤å¤„é¢†å–å¤§å®¶è‡ªè¡Œè·å–å³å¯~~~</p> 
<center> 
 <img src="https://images2.imgbox.com/60/93/wLwjy8X8_o.png"> 
 <center> 
 </center> 
</center> 
<p><strong>1ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Excel æ–‡ä»¶(Workbook)</strong></p> 
<pre><code>from openpyxl import Workbook
from openpyxl.utils import get_column_letter

wb = Workbook()
dest_filename = "Empty_book.xlsx"
wb.save(dest_filename)
</code></pre> 
<p><img src="https://images2.imgbox.com/74/ab/JytQ2y1a_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>2ï¼Œæ›´æ”¹ sheet æ ‡é¢˜</strong></p> 
<pre><code>ws1 = wb.active
ws1.title = 'range names'
</code></pre> 
<p><img src="https://images2.imgbox.com/f0/b1/waANEdaN_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>**3ï¼Œåœ¨ç¬¬ä¸€ä¸ª sheet 40*600 ä¸ªå•å…ƒæ ¼ä¸­å¡«å……æ•°æ® **</p> 
<pre><code>for row in range(1,40):
    ws1.append(range(600))
</code></pre> 
<p><img src="https://images2.imgbox.com/b8/ec/ADidR41C_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>4ï¼Œåº”ç”¨æ±‚å’Œå‡½æ•°å…¬å¼</strong></p> 
<p>openpyxl è¿˜æœ‰ä¸€ä¸ªå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨ Excel è¡¨æ ¼å†…ç½®å‡½æ•°ï¼›å‡½æ•°è¯­æ³•ä¸ Excel ä¸­çš„åŸºæœ¬ç›¸åŒï¼Œä½¿ç”¨ä¹‹å‰éœ€è¦åœ¨ å¯¼å…¥æ¨¡å—åŠ å…¥ä¸€è¡Œä»£ç å¯¼å…¥ FORMULAE æ¨¡å—</p> 
<pre><code>from openpyxl.utils import FORMULAE
</code></pre> 
<p>åˆ©ç”¨ SUM å‡½æ•°æ±‚å–æ¯è¡Œå„åˆ—å€¼ä¹‹å’Œï¼Œå¹¶åˆ›å»ºæ–°çš„ä¸€åˆ—è¿›è¡Œå­˜å‚¨</p> 
<pre><code>for row in range(1,40):
    ws1["WC{}".format(row)] = '=SUM(A{}:WB{})'.format(row,row)
</code></pre> 
<p><strong>5ï¼Œè¡¨æ ¼é¦–è¡ŒåŠ å…¥ç­›é€‰æœºåˆ¶</strong></p> 
<p>åœ¨åŠ å…¥ç­›é€‰æœºåˆ¶ä¹‹å‰ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ä¸‹å…ˆæŒ‡å®šå•å…ƒæ ¼èŒƒå›´ï¼Œç”¨åˆ° auto_filter æ¨¡å—ä¸­çš„ ref å‚æ•°</p> 
<pre><code>ws1.auto_filter.ref = "A1:WC39"
</code></pre> 
<p>å†å¯¹æŒ‡å®šè¦æ·»åŠ ç­›é€‰çš„åˆ—è¿›è¡Œä¿®æ”¹ï¼Œè¿™é‡Œæˆ‘å¯¹è¡¨æ ¼ä¸­æ¯ä¸€ä¸ªåˆ—éƒ½åŠ å…¥äº† ç­›é€‰æ¨¡å—ï¼›</p> 
<pre><code>for row in range(600):
    ws1.auto_filter.add_filter_column(row,vals = ['1','25'])#å¯¹æ¯ä¸€åˆ—åŠ å…¥è¿‡æ»¤æœºåˆ¶
</code></pre> 
<p><img src="https://images2.imgbox.com/f2/c1/kylmcPYN_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> add_filter_column()å‡½æ•°ä¸­ row ç”¨äºæŒ‡å®šè¦æ·»åŠ çš„åˆ—ç´¢å¼•ï¼Œä¾‹å¦‚ 0å°±æ˜¯ç¬¬ä¸€åˆ—ï¼Œåé¢ vals æš‚æ—¶è¿˜æ²¡å‘ç°æœ‰ç”¨å¤„ï¼Œ</p> 
<p>å¦å¤–è¿™é‡Œåæ§½ä¸€ä¸‹ï¼Œä¼¼ä¹ openpyxl åŒ…ä¸­çš„ add_sort_condition æ¨¡å—ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œæš‚ä¸æ¸…æ¥šè‡ªå·±æ˜¯ä»£ç å†™é”™äº†è¿˜æ˜¯ä»€ä¹ˆåŸå› ï¼Œè§‰å¾—å°±æ˜¯ä¸ªé¸¡è‚‹ï¼Œè¿™é‡Œæˆ‘åŠ å…¥äº† æ’åºåŠŸèƒ½ï¼Œä½†ä»£ç è¿è¡Œå®Œè¡¨æ ¼å¤„ç†å®Œä¹‹åè¿˜æ˜¯å¤„äºæ— åºçŠ¶æ€</p> 
<pre><code>ws1.auto_filter.ref = "A1:WC39"

for row in range(600):
    ws1.auto_filter.add_filter_column(row,vals = ['1','25'])#å¯¹æ¯ä¸€åˆ—åŠ å…¥è¿‡æ»¤æœºåˆ¶

for i in range(2,40):
    ws1['A{}'.format(i)] = random.choice(range(50))# æ›´æ”¹ç¬¬ä¸€åˆ—æ•°æ®

ws1.auto_filter.add_sort_condition("WC2:WC35") # å¯¹Excel ç¬¬ä¸€åˆ—è¿›è¡Œæ’åº
</code></pre> 
<p><img src="https://images2.imgbox.com/32/76/1YxHwARv_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>6ï¼Œä¸­æ’å…¥è¡Œã€åˆ—</strong></p> 
<p>æ’å…¥è¡Œæ–¹æ³•</p> 
<ul><li>insert_rows(idxï¼Œamount),</li></ul> 
<p>åœ¨æŒ‡å®šè¡Œ idx å‰é¢æ’å…¥ï¼Œamount è¡¨ç¤ºè¦æ’å…¥ çš„è¡Œæ•°ï¼Œé»˜è®¤ä¸º1ï¼›</p> 
<p>æ’å…¥åˆ—æ–¹æ³•</p> 
<ul><li>insert_cols(idxï¼Œamount)</li></ul> 
<p>åœ¨æŒ‡å®šåˆ—å‰é¢æ’å…¥ï¼Œamount è¡¨ç¤ºè¦æ’å…¥çš„åˆ—æ•°ï¼Œé»˜è®¤ä¸º1ï¼›</p> 
<pre><code># æ’å…¥è¡Œå’Œåˆ—

ws1.insert_rows(2,amount = 2) #åœ¨ç¬¬äºŒè¡Œå‰é¢åŠ å…¥ä¸¤ç©ºè¡Œ
ws1.insert_cols(2,amount = 3) # åœ¨ç¬¬äºŒåˆ—å‰é¢åŠ å…¥ä¸‰ä¸ªç©ºåˆ—
</code></pre> 
<p><img src="https://images2.imgbox.com/e8/43/YktttFnj_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>7ï¼Œåˆ é™¤è¡Œã€åˆ—(å¯å¤šè¡Œã€å¯å•è¡Œ)</strong></p> 
<p>åˆ é™¤åˆ—æ–¹æ³•</p> 
<ul><li>delete_cols(idx,amount)</li></ul> 
<p>åˆ é™¤ä»¥åˆ—ç´¢å¼•ä¸º idx ä¸ºèµ·å§‹ï¼Œamount æŒ‡ç¤ºåˆ é™¤åˆ—çš„æ•°é‡ï¼›</p> 
<ul><li>delete_rows(idx,amount)</li></ul> 
<p>åˆ é™¤ä»¥è¡Œç´¢å¼•ä¸º idx ä¸ºèµ·å§‹ï¼Œamount è¡¨ç¤ºåˆ é™¤è¡Œçš„æ•°é‡ï¼›</p> 
<pre><code># åˆ é™¤è¡Œä¸åˆ—

ws1.delete_cols(2,amount = 3) # åˆ é™¤ ç¬¬ 2 åˆ—ä¸ºèµ·å§‹ç´¢å¼•ï¼Œå…±3åˆ—
ws1.delete_rows(4,amount = 5) # åˆ é™¤ ç¬¬ 4 è¡Œä¸ºèµ·å§‹ç´¢å¼•ï¼Œå…±5è¡Œ
</code></pre> 
<p><img src="https://images2.imgbox.com/1e/b5/McepbuZx_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>8ï¼Œåˆå¹¶è¡Œ</strong></p> 
<ul><li>merge_cells(range_string,start_row,start_column,end_row,end_column)</li></ul> 
<p>range_stringï¼Œè¡¨ç¤ºå•å…ƒæ ¼åˆå¹¶å•å…ƒæ ¼èŒƒå›´ï¼Œä¾‹å¦‚ â€œA2:F3â€ï¼Œåˆå¹¶æ—¶åªéœ€è®¾ç½®è¿™ä¸ªå‚æ•°å³å¯ï¼›<br> start_rowï¼Œèµ·å§‹è¡Œï¼Œä¾‹å¦‚ start_row = 2;<br> end_rowï¼Œä¸­æ­¢è¡Œï¼Œä¾‹end_row = 3;<br> start_column ï¼Œèµ·å§‹åˆ—ï¼Œstart_column = 1;<br> end_columnï¼Œç»ˆæ­¢åˆ—ï¼Œend_column = 5;<br> ws1.merge_cells(range_string = â€œA2:F3â€) # åˆå¹¶å¤šä¸ªå•å…ƒæ ¼ï¼ŒA2-F3</p> 
<pre><code># ws1.merge_cells(start_row=2, start_column=1, end_row=3, end_column=5) # ä¸ä¸Šé¢æ•ˆæœç­‰ä»·;
</code></pre> 
<p><img src="https://images2.imgbox.com/30/fb/Ev9Cnuz7_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>9ï¼Œè®¾ç½®å•å…ƒæ ¼æ ·å¼</strong></p> 
<p>å­—ä½“æ ·å¼è®¾ç½®ï¼Œè¿™é‡Œéœ€ç”¨åˆ° openpyxl.styles.fonts æ¨¡å—ä¸­çš„ Font å‡½æ•°ï¼Œ</p> 
<p><strong>9.1ï¼Œå­—ä½“æ ·å¼è®¾ç½®ï¼Œç”¨åˆ° Font()å‡½æ•°æ¨¡å—</strong></p> 
<p>åº”ç”¨å­—ä½“æ ·å¼æ—¶ï¼ŒæŠŠè®¾ç½®å¥½çš„ Font() æ ·å¼èµ‹å€¼ä¸º å•å…ƒæ ¼.font å±æ€§å³å¯ï¼Œå¦‚ä¸‹</p> 
<pre><code>from openpyxl.styles import colors, Font, Fill, NamedStyle
from openpyxl.styles import PatternFill, Border, Side, Alignment

ws1['A2'].font = Font(bold = True,color ='FFB6C1',sz = 15.0,i = True,outline = True)
</code></pre> 
<p><img src="https://images2.imgbox.com/56/a7/cJByoKtN_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>9.2ï¼Œ è®¾ç½®å¯¹é½æ–¹å¼ï¼Œéœ€ç”¨åˆ° openpyxl.styles.alignment æ¨¡å—ä¸­çš„ Alignment å‡½æ•°</p> 
<p>åº”ç”¨æ—¶ä¸å­—ä½“æ–¹å¼ç›¸ä¼¼ï¼Œåˆ›å»º Alignment æ–¹æ³•ä¹‹åï¼Œèµ‹å€¼ç»™ å•å…ƒæ ¼.alignment å³å¯ï¼Œæ ¼å¼å¦‚ä¸‹</p> 
<pre><code>ws1['A2'].alignment = Alignment(horizontal = 'centerContinuous',shrinkToFit = True,textRotation = 20,vertical = 'bottom',wrapText = True)
</code></pre> 
<p><img src="https://images2.imgbox.com/0a/d0/gRf95aiG_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>9.3ï¼Œè®¾ç½®å¡«å……æ ·å¼ ï¼Œç”¨åˆ° openpyxl.styles.fills æ¨¡å—æä¾›ä¸¤ç§å¸¸ç”¨çš„å¡«å……æ–¹æ³•ï¼Œ GrdaientFill -&gt; æ¸å˜å¡«å…… å’Œ PatternFill -&gt; æ¨¡å¼å¡«å……ï¼›</p> 
<p>åº”ç”¨æ—¶ï¼Œåˆ›å»ºä¸€ä¸ª GradientFill() æˆ– PatternFill() æ–¹æ³•ï¼Œå‚æ•°è®¾ç½®å®Œä¹‹åï¼Œèµ‹å€¼ç»™ å•å…ƒæ ¼.fill å³å¯</p> 
<pre><code>ws1['A2'].fill = PatternFill(bgColor ='DC143C',fill_type = 'solid')
</code></pre> 
<p><img src="https://images2.imgbox.com/df/db/TuOFR96J_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>**10ï¼Œåˆ›å»ºæ–°çš„ sheet **</p> 
<p>**10.1ï¼Œ**æ–°å»ºä¸€ä¸ª sheetï¼Œä¿®æ”¹æ ‡é¢˜ ã€æŒ‡å®šå•å…ƒæ ¼ã€ tabColorï¼›</p> 
<pre><code>ws2 = wb.create_sheet(title = "Pi")
ws2['F5'] = 3.14 # 
ws2.sheet_properties.tabColor = "FF0000" # ä¿®æ”¹é¢œè‰²
</code></pre> 
<p><img src="https://images2.imgbox.com/c1/9a/svZhd418_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>10.2ï¼Œ æ–°å»º sheet ï¼Œå¯¹ 10-20è¡Œï¼Œ27-54åˆ—åŒºåŸŸçš„å•å…ƒæ ¼èµ‹å€¼(åˆ—åå³å¯)ï¼Œ</p> 
<pre><code>ws3 = wb.create_sheet(title = "Data")
for row in range(10,20):
    for col in range(27,54):
        _ = ws3.cell(column = col,row =row,value = "{0}".format(get_column_letter(col)))
</code></pre> 
<p><img src="https://images2.imgbox.com/05/77/lGJaNbHu_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><strong>11ï¼ŒExcel ä¿å­˜</strong></p> 
<p>æœ€åç§»éƒ¨ï¼ŒæŠŠä¿®æ”¹ä¹‹åçš„ Excel è¡¨æ ¼å­˜å‚¨åœ¨æŒ‡å®šä½ç½®</p> 
<pre><code>wb.save(filename = dest_filename)
</code></pre> 
<p>æ¡ˆä¾‹ä¸­çš„å®Œæ•´ä»£ç è´´åœ¨ä¸‹æ–¹ï¼Œéœ€è¦çš„å°ä¼™ä¼´ä»¬è‡ªå–</p> 
<pre><code>from openpyxl import Workbook
from openpyxl.utils import get_column_letter
from openpyxl.utils import FORMULAE
import random

wb =  Workbook()
dest_filename = "Empty_book.xlsx"
ws1 = wb.active
ws1.title = 'range names'


# å¯¹ç¬¬ä¸€ä¸ª sheet æ“ä½œ
for row in range(1,40):
    ws1.append(range(600))
for row in range(1,40):
    ws1["WC{}".format(row)] = '=SUM(A{}:WB{})'.format(row,row)
    
ws1.auto_filter.ref = "A1:WC39"

for row in range(600):
    ws1.auto_filter.add_filter_column(row,vals = ['1','25'])#å¯¹æ¯ä¸€åˆ—åŠ å…¥è¿‡æ»¤æœºåˆ¶

for i in range(2,40):
    ws1['A{}'.format(i)] = random.choice(range(50))# æ›´æ”¹ç¬¬ä¸€åˆ—æ•°æ®

ws1.auto_filter.add_sort_condition("WC2:WC35") # å¯¹Excel ç¬¬ä¸€åˆ—è¿›è¡Œæ’åº


# æ’å…¥è¡Œå’Œåˆ—
ws1.insert_rows(2,amount = 2) #åœ¨ç¬¬äºŒè¡Œå‰é¢åŠ å…¥ä¸¤ç©ºè¡Œ
ws1.insert_cols(2,amount = 3) # åœ¨ç¬¬äºŒåˆ—å‰é¢åŠ å…¥ä¸‰ä¸ªç©ºåˆ—


# åˆ é™¤è¡Œä¸åˆ—
ws1.delete_cols(2,amount = 3) # åˆ é™¤ ç¬¬ 2 åˆ—ï¼Œ3åˆ—
ws1.delete_rows(4,amount = 5) # åˆ é™¤ ç¬¬ 4 è¡Œï¼Œ5è¡Œ


# åˆå¹¶å•å…ƒæ ¼
ws1.merge_cells(range_string = "A2:F3") # åˆå¹¶å¤šä¸ªå•å…ƒæ ¼ï¼ŒA2-F3
# ws1.merge_cells(start_row=2, start_column=1, end_row=3, end_column=5) # ä¸ä¸Šé¢æ•ˆæœç­‰ä»·;

from openpyxl.styles import colors, Font, Fill, NamedStyle
from openpyxl.styles import PatternFill, Border, Side, Alignment

ws1['A2'] = 'åˆå¹¶åæ ‡é¢˜'
ws1['A2'].font = Font(bold = True,color ='FFB6C1',sz = 15.0,i = True,outline = True)

# å•å…ƒæ ¼å¯¹å…¶è®¾ç½®
ws1['A2'].alignment = Alignment(horizontal = 'centerContinuous',shrinkToFit = True,textRotation = 20,vertical = 'bottom',wrapText = True)


# å•å…ƒæ ¼å¡«å……é¢œè‰²è®¾ç½®
ws1['A2'].fill = PatternFill(bgColor ='DC143C',fill_type = 'solid')

# å¯¹ç¬¬äºŒä¸ª sheet æ“ä½œ
ws2 = wb.create_sheet(title = "Pi")
ws2['F5'] = 3.14 # 
ws2.sheet_properties.tabColor = "FF0000" # ä¿®æ”¹é¢œè‰²

# å¯¹ç¬¬ä¸‰ä¸ª sheet æ“ä½œ
ws3 = wb.create_sheet(title = "Data")
for row in range(10,20):
    for col in range(27,54):
        _ = ws3.cell(column = col,row =row,value = "{0}".format(get_column_letter(col)))
        
# ä¿å­˜Excel è¡¨æ ¼
wb.save(dest_filename)
</code></pre> 
<h4><a id="_295"></a>åç»­ä¼šé™†é™†ç»­ç»­è¡¥ä¸Šä¸€äº›å…¶å®ƒæœ‰è¶£çš„åŠå…¬è‡ªåŠ¨åŒ–æŠ€å·§</h4> 
<p><strong>åœ¨å­¦ä¹ pythonä¸­æœ‰ä»»ä½•å›°éš¾ä¸æ‡‚çš„å¯ä»¥å¾®ä¿¡æ‰«æä¸‹æ–¹CSDNå®˜æ–¹è®¤è¯äºŒç»´ç åŠ å…¥pythonäº¤æµå­¦ä¹ ï¼Œå¤šå¤šäº¤æµé—®é¢˜ï¼Œäº’å¸®äº’åŠ©ï¼Œè¿™é‡Œæœ‰ä¸é”™çš„å­¦ä¹ æ•™ç¨‹å’Œå¼€å‘å·¥å…·ã€‚</strong><br> ï¼ˆè¿™é‡Œæ¯å¤©éƒ½ä¼šä¸å®šæ—¶æ›´æ–°pythonä¸åŒé¢˜å‹å’Œæ•™ç¨‹ï¼Œå¸Œæœ›å¤§å®¶ä¸€èµ·å­¦ä¹ ï¼Œä¸€èµ·è¿›æ­¥ï¼‰</p> 
<blockquote> 
 <p>ğŸ‘‰<a href="https://mp.weixin.qq.com/s/ZxS5RO3rb59V5z2G4hLRUA" rel="nofollow">[[<font color="red">CSDNå¤§ç¤¼åŒ…ï¼š</font>ã€Špythonå®‰è£…åŒ…&amp;å…¨å¥—å­¦ä¹ èµ„æ–™ã€‹å…è´¹åˆ†äº«]]</a><font color="green">ï¼ˆ<strong>å®‰å…¨é“¾æ¥ï¼Œæ”¾å¿ƒç‚¹å‡»</strong>ï¼‰</font></p> 
</blockquote> 
<center> 
 <img src="https://images2.imgbox.com/c7/63/j4t9eGDj_o.png"> 
 <center> 
 </center> 
</center> 
<h4><a id="Python_306"></a>Pythonå­¦ä¹ å¤§çº²</h4> 
<p>Pythonæ‰€æœ‰æ–¹å‘çš„æŠ€æœ¯ç‚¹åšçš„æ•´ç†ï¼Œå½¢æˆå„ä¸ªé¢†åŸŸçš„çŸ¥è¯†ç‚¹æ±‡æ€»ï¼Œå®ƒçš„ç”¨å¤„å°±åœ¨äºï¼Œä½ å¯ä»¥æŒ‰ç…§ä¸Šé¢çš„çŸ¥è¯†ç‚¹å»æ‰¾å¯¹åº”çš„å­¦ä¹ èµ„æºï¼Œä¿è¯è‡ªå·±å­¦å¾—è¾ƒä¸ºå…¨é¢ã€‚<br> <img src="https://images2.imgbox.com/8a/bb/iDsNO0IM_o.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h4><a id="_309"></a>å…¥é—¨å­¦ä¹ è§†é¢‘</h4> 
<p><img src="https://images2.imgbox.com/8d/04/haCn5lmx_o.png" alt=""></p> 
<h4><a id="Python_311"></a>Pythonå®æˆ˜æ¡ˆä¾‹</h4> 
<p>å…‰å­¦ç†è®ºæ˜¯æ²¡ç”¨çš„ï¼Œè¦å­¦ä¼šè·Ÿç€ä¸€èµ·æ•²ï¼Œè¦åŠ¨æ‰‹å®æ“ï¼Œæ‰èƒ½å°†è‡ªå·±çš„æ‰€å­¦è¿ç”¨åˆ°å®é™…å½“ä¸­å»ï¼Œè¿™æ—¶å€™å¯ä»¥æç‚¹å®æˆ˜æ¡ˆä¾‹æ¥å­¦ä¹ ã€‚<br> <img src="https://images2.imgbox.com/d5/3c/qyCRv9gQ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> <img src="https://images2.imgbox.com/6e/78/QM7y16IT_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> <strong>æœ€åï¼Œåƒä¸‡åˆ«è¾œè´Ÿè‡ªå·±å½“æ—¶å¼€å§‹çš„ä¸€è…”çƒ­è¡€ï¼Œä¸€èµ·å˜å¼ºå¤§å˜ä¼˜ç§€ã€‚</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/34fd421a0eccc5f2f0eecd9222c69bed/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">é¢è¯•ç»å…¸é¢˜---6.Zå­—å½¢å˜æ¢</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/159e5adb3abf7f993d628b4e671dcca1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">æ–°æ‰‹å¦‚ä½•ä¸‹è½½å¹¶å®‰è£…Tableauï¼Ÿ</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§ç™½çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>