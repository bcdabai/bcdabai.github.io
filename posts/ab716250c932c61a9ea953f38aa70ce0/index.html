<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>拓竹实习1面 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="拓竹实习1面" />
<meta property="og:description" content="面试流程 首先写道题，写一个分页器。
start = (pageSize*pageNun)，end = in.length&gt;(start&#43;pageSize)?(start&#43;pageSize):in.length
了解你能够实习的时长。
1、web接口太慢，怎么优化，有什么思路去优化？
数据库优化代码优化负载均衡缓存优化网络优化 2、怎么通过查看日志去排错和优化？
监控系统状态调试和排错题。性能优化安全监控。业务分析 3、redis储存了一个set集合，更新的时候存在并发问题，怎么解决？
redis的乐观锁和悲观锁实现这是一个项目中值得考虑改进的操作！！！！！！ 4、了解过聚合索引吗？
聚合索引就是内容按一定顺序排序；非聚合索引索引和内容分开储存。 5、代码管理工具git的工作流，代码分支怎么使用？
master、develop、feature、release、hotfix5种分支 此外，补充一些面试后的知识学习 1、为什么不可以用synchronize来限制同步客户端对服务器中的redis的数据更新请求？ 虽然synchronize关键字可以用来在多线程程序中保证共享数据的同步和互斥访问，但在分布式系统中，synchronize并不能有效地限制同步客户端对Redis服务器中的数据更新请求。
这是因为在分布式系统中，Redis服务器可以被多个客户端同时访问和更新，而**不同客户端之间的线程并不共享内存。**因此，使用synchronize关键字在不同客户端之间进行同步是不可能的。
在分布式系统中，一般采用分布式锁或乐观锁等机制来限制并发访问和更新。Redis中支持的WATCH和MULTI命令可以用来实现基于版本号的乐观锁，而SETNX和EXPIRE命令可以用来实现基于锁的悲观锁。使用这些机制可以保证在多个客户端同时对Redis进行访问和更新时，数据的原子性和一致性。
2、单体web应用中更新redis中的数据存在并发问题，怎么解决? 在单体web应用中更新Redis中的数据存在并发问题时，可以考虑以下几种解决方法：
使用Redis的事务机制：Redis支持事务机制，可以将多个操作一起提交，从而确保操作的原子性。可以使用Redis的MULTI和EXEC指令来执行事务，确保在事务执行期间不会被其他客户端打断。使用Redis的乐观锁机制：通过对Redis中的数据进行版本控制，当要更新某个数据时，首先检查该数据的版本号是否与自己持有的版本号一致，如果一致则执行更新操作，否则放弃更新。这种方式不会阻塞其他客户端对数据的访问，但是需要注意版本号的更新策略，以避免出现数据不一致的情况。使用Redis的悲观锁机制：通过在更新数据时对数据进行加锁，确保同一时间只有一个客户端可以对数据进行修改。可以使用Redis的SETNX指令实现悲观锁，但是需要注意加锁时间过长会降低并发性能。使用分布式锁：在集群环境下，可以使用分布式锁来确保并发更新的数据的一致性。可以使用ZooKeeper或者Redisson等开源框架实现分布式锁机制。 3、java分别实现一下redis的乐观锁和悲观锁操作 redis乐观锁
public boolean updateWithOptimisticLock(String key, String expectedValue, String newValue) { Jedis jedis = null; try { jedis = pool.getResource(); //连接到redis jedis.watch(key); //监视，保证同步 String currentValue = jedis.get(key); if (currentValue != null &amp;&amp; currentValue.equals( expectedValue )) { Transaction tx = jedis.multi(); //redis事务 tx.set(key, newValue); List&lt;Object&gt; result = tx." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ab716250c932c61a9ea953f38aa70ce0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-17T15:30:39+08:00" />
<meta property="article:modified_time" content="2023-03-17T15:30:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">拓竹实习1面</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h5><a id="_0"></a>面试流程</h5> 
<p>首先写道题，写一个分页器。<br> start = (pageSize*pageNun)，end = in.length&gt;(start+pageSize)?(start+pageSize):in.length</p> 
<p>了解你能够实习的时长。</p> 
<p>1、web接口太慢，怎么优化，有什么思路去优化？</p> 
<ul><li>数据库优化</li><li>代码优化</li><li>负载均衡</li><li>缓存优化</li><li>网络优化</li></ul> 
<p>2、怎么通过查看日志去排错和优化？</p> 
<ul><li>监控系统状态</li><li>调试和排错题。</li><li>性能优化</li><li>安全监控。</li><li>业务分析</li></ul> 
<p>3、redis储存了一个set集合，更新的时候存在并发问题，怎么解决？</p> 
<ul><li>redis的乐观锁和悲观锁实现</li><li>这是一个项目中值得考虑改进的操作！！！！！！</li></ul> 
<p>4、了解过聚合索引吗？</p> 
<ul><li>聚合索引就是内容按一定顺序排序；非聚合索引索引和内容分开储存。</li></ul> 
<p>5、代码管理工具git的工作流，代码分支怎么使用？</p> 
<ul><li>master、develop、feature、release、hotfix5种分支</li></ul> 
<h5><a id="_40"></a>此外，补充一些面试后的知识学习</h5> 
<h6><a id="1synchronizeredis_42"></a>1、为什么不可以用synchronize来限制同步客户端对服务器中的redis的数据更新请求？</h6> 
<ul><li> <p>虽然synchronize关键字可以用来在多线程程序中保证共享数据的同步和互斥访问，但在分布式系统中，synchronize并不能有效地限制同步客户端对Redis服务器中的数据更新请求。</p> </li><li> <p>这是因为在分布式系统中，Redis服务器可以被多个客户端同时访问和更新，而**不同客户端之间的线程并不共享内存。**因此，使用synchronize关键字在不同客户端之间进行同步是不可能的。</p> </li><li> <p>在分布式系统中，一<strong>般采用分布式锁或乐观锁等机制来限制并发访问和更新</strong>。Redis中支持的<strong>WATCH和MULTI</strong>命令可以用来实现基于版本号的乐观锁，而<strong>SETNX和EXPIRE</strong>命令可以用来实现基于锁的悲观锁。使用这些机制可以保证在多个客户端同时对Redis进行访问和更新时，数据的原子性和一致性。</p> </li></ul> 
<h6><a id="2webredis_50"></a>2、单体web应用中更新redis中的数据存在并发问题，怎么解决?</h6> 
<p>在单体web应用中更新Redis中的数据存在并发问题时，可以考虑以下几种解决方法：</p> 
<ul><li>使用Redis的事务机制：Redis支持事务机制，可以将多个操作一起提交，从而确保操作的原子性。可以使用Redis的MULTI和EXEC指令来执行事务，确保在事务执行期间不会被其他客户端打断。</li><li>使用Redis的乐观锁机制：通过对Redis中的数据进行版本控制，当要更新某个数据时，首先检查该数据的版本号是否与自己持有的版本号一致，如果一致则执行更新操作，否则放弃更新。这种方式不会阻塞其他客户端对数据的访问，但是需要注意版本号的更新策略，以避免出现数据不一致的情况。</li><li>使用Redis的悲观锁机制：通过在更新数据时对数据进行加锁，确保同一时间只有一个客户端可以对数据进行修改。可以使用Redis的SETNX指令实现悲观锁，但是需要注意加锁时间过长会降低并发性能。</li><li>使用分布式锁：在集群环境下，可以使用分布式锁来确保并发更新的数据的一致性。可以使用ZooKeeper或者Redisson等开源框架实现分布式锁机制。</li></ul> 
<h6><a id="3javaredis_59"></a>3、java分别实现一下redis的乐观锁和悲观锁操作</h6> 
<p><strong>redis乐观锁</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">updateWithOptimisticLock</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> expectedValue<span class="token punctuation">,</span> <span class="token class-name">String</span> newValue<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        jedis <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//连接到redis</span>
        jedis<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//监视，保证同步</span>
        <span class="token class-name">String</span> currentValue <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currentValue <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> currentValue<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span> expectedValue <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">multi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//redis事务</span>
            tx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> newValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> tx<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//执行结果</span>
            <span class="token keyword">return</span> result <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>result<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>jedis <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">//释放连接</span>
            jedis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>上述代码中，使用Jedis库建立与Redis服务器的连接，然后通过<strong>watch方法来监视key所对应的值，如果key的值在watch和exec方法之间没有被其他客户端修改，则可以执行更新操作。</strong><br> 这里应该加上，如果被修改了，那就应该重试。</p> 
<ul><li>基于版本号的乐观锁实现原子性更新数据： 
  <ol><li>客户端获取要更新数据的版本号和当前值。</li><li>客户端根据要更新的数据的版本号和当前值计算出新的值，然后通过Redis的WATCH命令监视要更新的数据。</li><li>如果被监视的数据在WATCH命令和UPDATE操作之间没有被其他客户端修改，那么客户端执行UPDATE操作并提交事务，否则客户端需要重试更新操作。</li><li></ol> </li></ul> 
<p><strong>Redis悲观锁：</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">updateWithPessimisticLock</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> newValue<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        jedis <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//链接</span>
        <span class="token class-name">Long</span> lock <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">setnx</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">"_lock"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//枷锁</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>lock <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            jedis<span class="token punctuation">.</span><span class="token function">expire</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">"_lock"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> newValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
            jedis<span class="token punctuation">.</span><span class="token function">del</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">"_lock"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>jedis <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            jedis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>上述代码中，使用setnx方法来对key加锁，如果加锁成功，则可以执行更新操作。在更新完成后，需要使用del方法释放锁。</p> 
<p>需要注意的是，使用悲观锁可能会降低系统的并发性能，因此应该根据具体业务情况选择适当的锁机制。同时，在使用乐观锁时，需要根据具体的场景进行版本号的更新策略，以避免出现数据不一致的情况。</p> 
<ul><li>基于SETNX指令的悲观锁实现原子性更新数据： 
  <ol><li>客户端使用SETNX命令对要更新的数据进行加锁，如果加锁成功则进行更新操作，否则等待一段时间后重试。</li><li>客户端在完成更新操作后需要使用DEL命令释放锁。</li></ol> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b1f78548fc937cc9213ffb302aba96ef/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何理解软件需要驱动才能安装</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f666a8bc4db4506bc0c7aa3032fa5715/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux驱动开发之【pinctrl和gpio子系统】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>