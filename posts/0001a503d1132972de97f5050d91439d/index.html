<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQL Server数据库 笔记----对表的查询 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SQL Server数据库 笔记----对表的查询" />
<meta property="og:description" content="操作数据之插入数据 对表的操作：插入，更新，删除
1.单条数据插入 --1) insert （into） 表名(列名，列名......) values(值，值......) --2) insert 表名（列名......） select 值...... 2.多条插入 一次性插入多条 批量插入操作
--1) insert into 表名（列名1，列名2......） values (值1，值2......),(值1，值2......),(值1，值2......)...... --2)union去除，union all允许重复 union all 效率比 union 高 insert 表名（列名1，列名2......） select (值1，值2......) union select(值1，值2......) union ...... select(值1，值2......) 3.克隆表数据 将一张表的数所复制到另一张表
--1）目标表在数据库中已经存在 insert into 目标表名(目标表中列名) select 源表中列名 from 源表 --2）目标表之前数据库中不存在，执行操作时自动创建 select 源表中列名 into 新表--目标表 from 源表 操作数据之更新删除数据 1.更新数据 update update 表名 set 列名=值，列名=值 where 标识列=值 （and | or）条件 --修改的某一列 注：主键不可以修改" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/0001a503d1132972de97f5050d91439d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-23T14:29:21+08:00" />
<meta property="article:modified_time" content="2023-05-23T14:29:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQL Server数据库 笔记----对表的查询</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<ul><li> <h3>操作数据之插入数据</h3> </li></ul> 
<p>对表的操作：插入，更新，删除</p> 
<h4>1.单条数据插入</h4> 
<pre><code>--1)

insert （into） 表名(列名，列名......)

values(值，值......)

--2)

insert  表名（列名......）

select 值......</code></pre> 
<p></p> 
<h4>2.多条插入</h4> 
<p>一次性插入多条 批量插入操作</p> 
<pre><code>--1)

insert into 表名（列名1，列名2......）

values (值1，值2......),(值1，值2......),(值1，值2......)......

--2)union去除，union all允许重复

union all 效率比 union 高

insert  表名（列名1，列名2......）

select (值1，值2......) union

select(值1，值2......) union

......

select(值1，值2......)</code></pre> 
<p></p> 
<p></p> 
<h4>3.克隆表数据</h4> 
<p>将一张表的数所复制到另一张表</p> 
<pre><code>--1）目标表在数据库中已经存在

insert into 目标表名(目标表中列名)

select 源表中列名 from 源表

--2）目标表之前数据库中不存在，执行操作时自动创建

select 源表中列名 into 新表--目标表

from 源表</code></pre> 
<p></p> 
<ul><li> <h3>操作数据之更新删除数据</h3> </li></ul> 
<h4>1.更新数据 update</h4> 
<pre><code>update 表名  set 列名=值，列名=值

where 标识列=值 （and | or）条件
--修改的某一列</code></pre> 
<p>注：主键不可以修改</p> 
<p>       如果不加where条件，会把整个表的数据都修改了</p> 
<p></p> 
<h4>2.删除数据</h4> 
<p>--1）只是删除数据，表还在</p> 
<p><strong>1.delete from 表名</strong></p> 
<pre><code>delete from 表名 
where 条件</code></pre> 
<p>----不加条件，会删除整个表数据，几乎都要where，加where条件  标识列 值还是接着删除前的值而自增。（假设删除的标识列为：6，7，8，删除后再添加列，标识列从9开始）</p> 
<p>--delete 语句会造成标识列的值不连续</p> 
<p></p> 
<p>如果想要删除数据，让标识列的值恢复到初始值：</p> 
<p><strong>2.truncate table 表名（不带条件）</strong></p> 
<pre><code>truncate table 表名</code></pre> 
<p>---表数据清空，恢复到初始化，标识列也恢复</p> 
<p>--truncate 效率比delete 高，delete每删除一条数据，都会在日志里记录，truncate不会记录日志，不激活触发器，drop，truncate是即时操作，不可恢复。</p> 
<p>--慎用truncate一旦删除，不能恢复。</p> 
<p></p> 
<ul><li> <h3>查询数据之单表查询</h3> </li></ul> 
<h4>--1.查询所有数据</h4> 
<p>--*表示所有列</p> 
<pre><code>select * from 表名</code></pre> 
<h4>-- 2.查询表的部分数据</h4> 
<pre><code>select 列名1，列名2......
from 表名
where 条件
</code></pre> 
<h4>--3. 列命别名</h4> 
<p>--列名 AS 别名</p> 
<p>--列名   别名</p> 
<p>--别名 = 列名</p> 
<p></p> 
<h4>--4.排序 order by</h4> 
<pre><code>select 列名1,列名2......
from 表名
order by 列名 asc</code></pre> 
<p>--主键默认就有排序功能，从小到大</p> 
<p>--asc 升序，从小到大</p> 
<p>--desc 降序，从大到小</p> 
<p>--多个字段排序，用逗号隔开</p> 
<p>--条件，分组在前，order by 永远在后</p> 
<p></p> 
<ul><li> <h3>查询之模糊查询</h3> </li></ul> 
<pre><code>select 列名

from 表名

where 列名 like .....</code></pre> 
<p>匹配模式：</p> 
<h4>1. %  0个或多个</h4> 
<p>like '%2%'   包含2</p> 
<p>like '%4'       以4结尾</p> 
<p>like ' 2%'      以2开头</p> 
<p></p> 
<h4>2. _   匹配单个字符</h4> 
<p>一个'_'一个字符,限制表达式的字符长度</p> 
<p></p> 
<h4>3.[ ]    范围匹配，括号中所有字符中的一个</h4> 
<p>[mnd] 匹配到字符中有m,n,d中任意一个</p> 
<p>[1-9]   匹配到有1-9数字中任意一个的字符</p> 
<p></p> 
<h4>4.[^]    不在括号中所有字符之内的单个字符</h4> 
<p>[^mnd]     匹配到字符中没有m,n,d的</p> 
<p>[^1-9]       匹配到没有1-9数字的字符</p> 
<p></p> 
<ul><li> <h3>查询之范围查询</h3> </li></ul> 
<h4>1.select  from where 子句 条件--给定范围</h4> 
<p><strong>--1）比较运算符</strong></p> 
<p>&gt;        &lt;        &gt;=        &lt;=        </p> 
<p><strong>--2)  in（ ）/  not in ( )</strong></p> 
<p>in(2,3,4)    在2，3，4范围内</p> 
<p>not in(2,3,4)     不在2，3，4范围内</p> 
<p>in(子查询)         在查询的结果范围内</p> 
<p><strong>--3）between and</strong></p> 
<p>--在20-30范围内</p> 
<p>--between 20 and 30</p> 
<p>--ID &gt;= 20 and &lt;=30</p> 
<p></p> 
<h4>2.前面多少条，百分比</h4> 
<pre><code>--前10条
select  top 10 *

from 表名</code></pre> 
<pre><code>--前10%
select  top 10 percent *

from 表名</code></pre> 
<p></p> 
<ul><li> <h3>聚合函数</h3> </li></ul> 
<p>聚合函数：对一组值执行计算并返回单一的值。</p> 
<pre><code>select count(*) from 表名

select count(1) from 表名-----一般统计一个表的记录数
--select count(1)伪造列</code></pre> 
<p><strong>--count 记录个数</strong></p> 
<p><strong>--sum 求和，相加</strong></p> 
<p><strong>--avg 求平均</strong></p> 
<p><strong>--max 求最大</strong></p> 
<p><strong>--min 求最小</strong></p> 
<p>    </p> 
<ul><li> <h3>分组查询group by</h3> </li></ul> 
<p>语法:</p> 
<p>select ......where...... group by ......  having..... order by .....</p> 
<p>--group by结合聚合函数，根据一列或多个列对结果集进行分组。</p> 
<p>--having 分组后的筛选条件</p> 
<pre><code class="hljs">--select  列名，count(1) 用户数

--from 表名

--group by  列名</code></pre> 
<p></p> 
<ul><li> <h3>连接查询</h3> </li></ul> 
<p>连接查询: 根据两个或多个表之间的关系,从这些表中查询数据.</p> 
<p>目的: 实现多表查询</p> 
<p>分类: 内连接, 外连接, 全连接, 交叉连接</p> 
<ul><li> <h4>内连接</h4> </li></ul> 
<p>inner join  使用比较运算符 = &gt; &lt; &gt;= &lt;= 进行表间的比较,查询与条件相匹配的数据.</p> 
<p>本质上是<strong>等值连接 </strong>, 结果: 相匹配的数据查询出来,显示匹配出来的结果,如果没有匹配上,就没有结果.</p> 
<p><strong>显式连接 </strong></p> 
<p><strong>inner join on 关联条件</strong></p> 
<p>表 inner join  表  on  条件  where</p> 
<pre><code class="hljs">select 列名
from 表1
inner join 表2 on 关联条件  -- and ...
</code></pre> 
<p><strong>隐式连接</strong></p> 
<p>select ...... from 表,表 where 关联条件</p> 
<pre><code class="hljs">select *
from 表1,表2
where 关联条件 </code></pre> 
<ul><li> <h4>外连接</h4> </li></ul> 
<p>外连接分类:  左外连接, 右外连接, 全外连接 </p> 
<p><strong>1.  左连接</strong> left (outer) join</p> 
<p>结果:         左表:  所有行</p> 
<p>                 右表:  行数与左表相同,没有匹配上的,显示NULL</p> 
<pre><code class="hljs">select * from 左表

left join  右表

on 关联条件
</code></pre> 
<p></p> 
<p><strong>2.   右连接</strong> right  (outer) join</p> 
<p>结果:         左表:  行数与右表相同,没有匹配上的,显示NULL</p> 
<p>                 右表: 所有行</p> 
<pre><code class="hljs">select * from 左表

right join  右表

on 关联条件
</code></pre> 
<p><strong>3.全连接</strong>  full  (outer ) join </p> 
<p>结果:        左表和右表所有数据都会出来, 每一行的数据, 如果在另一个表里匹配不上, 就是对应显示NULL</p> 
<pre><code class="hljs">select *  from 表1

full join 表2

on 关联条件</code></pre> 
<p><strong>4.交叉连接</strong> cross (outer) join</p> 
<p>如果不带where 子句时,返回被连接的两个表的笛卡尔积,  返回的行数 是两个表行数的乘积.</p> 
<pre><code class="hljs">select * from 表1

cross join 表2 --不带where的显示为表的行数乘积

where 关联条件  --只显示匹配出来的行数</code></pre> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/79f71f6b812004c56e11c6a7ef2163f0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">latex各类符号（红心、方块、五角星等）集合</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/539a2c798b6e1fe57147953743fff0e0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java基础之对象类型</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>