<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>redis.conf 默认出厂内容 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="redis.conf 默认出厂内容" />
<meta property="og:description" content="# Redis configuration file example. # # Note that in order to read the configuration file, Redis must be # started with the file path as first argument: # # ./redis-server /path/to/redis.conf # Note on units: when memory size is needed, it is possible to specify # it in the usual form of 1k 5GB 4M and so forth: # # 1k =&gt; 1000 bytes # 1kb =&gt; 1024 bytes # 1m =&gt; 1000000 bytes # 1mb =&gt; 1024*1024 bytes # 1g =&gt; 1000000000 bytes # 1gb =&gt; 1024*1024*1024 bytes # # units are case insensitive so 1GB 1Gb 1gB are all the same." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/43192a7e1ed558362710b8c7d0defc6e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-08T21:23:23+08:00" />
<meta property="article:modified_time" content="2024-01-08T21:23:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">redis.conf 默认出厂内容</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre><code class="prism language-java"># <span class="token class-name">Redis</span> configuration file example<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Note</span> that in order <span class="token keyword">to</span> <span class="token namespace">read</span> the configuration file<span class="token punctuation">,</span> <span class="token class-name">Redis</span> must be
 
# started <span class="token keyword">with</span> <span class="token namespace">the</span> file path as first argument<span class="token operator">:</span>
 
#
 
# <span class="token punctuation">.</span>/redis<span class="token operator">-</span>server <span class="token operator">/</span>path<span class="token operator">/</span><span class="token keyword">to</span><span class="token operator">/</span>redis<span class="token punctuation">.</span>conf
 
 
 
# <span class="token class-name">Note</span> on units<span class="token operator">:</span> when memory size is needed<span class="token punctuation">,</span> it is possible <span class="token keyword">to</span> <span class="token namespace">specify</span>
 
# it in the usual form of <span class="token number">1</span>k <span class="token number">5</span><span class="token constant">GB</span> <span class="token number">4</span>M and so forth<span class="token operator">:</span>
 
#
 
# <span class="token number">1</span>k <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">1000</span> bytes
 
# <span class="token number">1</span>kb <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">1024</span> bytes
 
# <span class="token number">1</span>m <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">1000000</span> bytes
 
# <span class="token number">1</span>mb <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span> bytes
 
# <span class="token number">1</span>g <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">1000000000</span> bytes
 
# <span class="token number">1</span>gb <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span> bytes
 
#
 
# units are <span class="token keyword">case</span> insensitive so <span class="token number">1</span><span class="token constant">GB</span> <span class="token number">1</span>Gb <span class="token number">1</span>gB are all the same<span class="token punctuation">.</span>
 
 
 
################################## <span class="token constant">INCLUDES</span> ###################################
 
 
 
# <span class="token class-name">Include</span> one or more other config files <span class="token class-name"><span class="token namespace">here<span class="token punctuation">.</span></span>  This</span> is useful <span class="token keyword">if</span> you
 
# have a standard template that goes <span class="token keyword">to</span> <span class="token namespace">all</span> <span class="token class-name">Redis</span> servers but also need
 
# <span class="token keyword">to</span> <span class="token namespace">customize</span> a few per<span class="token operator">-</span>server <span class="token class-name"><span class="token namespace">settings<span class="token punctuation">.</span></span>  Include</span> files can include
 
# other files<span class="token punctuation">,</span> so use <span class="token keyword">this</span> wisely<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Notice</span> option <span class="token string">"include"</span> won't be rewritten by command <span class="token string">"CONFIG REWRITE"</span>
 
# from admin or <span class="token class-name">Redis</span> <span class="token class-name">Sentinel<span class="token punctuation">.</span> Since</span> <span class="token class-name">Redis</span> always <span class="token keyword">uses</span> <span class="token namespace">the</span> last processed
 
# line as value of a configuration directive<span class="token punctuation">,</span> you'd better put includes
 
# at the beginning of <span class="token keyword">this</span> file <span class="token keyword">to</span> <span class="token namespace">avoid</span> overwriting config change at runtime<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">If</span> instead you are interested in using includes <span class="token keyword">to</span> <span class="token namespace">override</span> configuration
 
# options<span class="token punctuation">,</span> it is better <span class="token keyword">to</span> <span class="token namespace">use</span> include as the last line<span class="token punctuation">.</span>
 
#
 
# include <span class="token operator">/</span>path<span class="token operator">/</span><span class="token keyword">to</span><span class="token operator">/</span>local<span class="token punctuation">.</span>conf
 
# include <span class="token operator">/</span>path<span class="token operator">/</span><span class="token keyword">to</span><span class="token operator">/</span>other<span class="token punctuation">.</span>conf
 
 
 
################################## <span class="token constant">MODULES</span> #####################################
 
 
 
# <span class="token class-name">Load</span> modules at <span class="token class-name"><span class="token namespace">startup<span class="token punctuation">.</span></span> If</span> the server is not able <span class="token keyword">to</span> <span class="token namespace">load</span> modules
 
# it will <span class="token class-name"><span class="token namespace">abort<span class="token punctuation">.</span></span> It</span> is possible <span class="token keyword">to</span> <span class="token namespace">use</span> multiple loadmodule directives<span class="token punctuation">.</span>
 
#
 
# loadmodule <span class="token operator">/</span>path<span class="token operator">/</span><span class="token keyword">to</span><span class="token operator">/</span>my_module<span class="token punctuation">.</span>so
 
# loadmodule <span class="token operator">/</span>path<span class="token operator">/</span><span class="token keyword">to</span><span class="token operator">/</span>other_module<span class="token punctuation">.</span>so
 
 
 
################################## <span class="token constant">NETWORK</span> #####################################
 
 
 
# <span class="token class-name">By</span> <span class="token keyword">default</span><span class="token punctuation">,</span> <span class="token keyword">if</span> no <span class="token string">"bind"</span> configuration directive is specified<span class="token punctuation">,</span> <span class="token class-name">Redis</span> listens
 
# <span class="token keyword">for</span> connections from all the network interfaces available on the server<span class="token punctuation">.</span>
 
# <span class="token class-name">It</span> is possible <span class="token keyword">to</span> <span class="token namespace">listen</span> <span class="token keyword">to</span> <span class="token namespace">just</span> one or multiple selected interfaces using
 
# the <span class="token string">"bind"</span> configuration directive<span class="token punctuation">,</span> followed by one or more <span class="token constant">IP</span> addresses<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Examples</span><span class="token operator">:</span>
 
#
 
# bind <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.100</span> <span class="token number">10.0</span><span class="token number">.0</span><span class="token number">.1</span>
 
# bind <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token operator">::</span><span class="token number">1</span>
 
#
 
# <span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span> <span class="token constant">WARNING</span> <span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span> <span class="token class-name">If</span> the computer running <span class="token class-name">Redis</span> is directly exposed <span class="token keyword">to</span> <span class="token namespace">the</span>
 
# internet<span class="token punctuation">,</span> binding <span class="token keyword">to</span> <span class="token namespace">all</span> the interfaces is dangerous and will expose the
 
# instance <span class="token keyword">to</span> <span class="token namespace">everybody</span> on the <span class="token class-name"><span class="token namespace">internet<span class="token punctuation">.</span></span> So</span> by <span class="token keyword">default</span> we uncomment the
 
# following bind directive<span class="token punctuation">,</span> that will force <span class="token class-name">Redis</span> <span class="token keyword">to</span> <span class="token namespace">listen</span> only into
 
# the <span class="token class-name">IPv4</span> loopback <span class="token keyword">interface</span> address <span class="token punctuation">(</span><span class="token keyword">this</span> means <span class="token class-name">Redis</span> will be able <span class="token keyword">to</span>
 
# accept connections only from clients running into the same computer it
 
# is running<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token constant">IF</span> <span class="token constant">YOU</span> <span class="token constant">ARE</span> <span class="token constant">SURE</span> <span class="token constant">YOU</span> <span class="token constant">WANT</span> <span class="token constant">YOUR</span> <span class="token constant">INSTANCE</span> <span class="token constant">TO</span> <span class="token constant">LISTEN</span> <span class="token constant">TO</span> <span class="token constant">ALL</span> <span class="token constant">THE</span> <span class="token constant">INTERFACES</span>
 
# <span class="token constant">JUST</span> <span class="token constant">COMMENT</span> <span class="token constant">THE</span> <span class="token constant">FOLLOWING</span> <span class="token constant">LINE</span><span class="token punctuation">.</span>
 
# <span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span>
 
#bind <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>
 
 
 
# <span class="token class-name">Protected</span> mode is a layer of security protection<span class="token punctuation">,</span> in order <span class="token keyword">to</span> <span class="token namespace">avoid</span> that
 
# <span class="token class-name">Redis</span> instances left <span class="token keyword">open</span> <span class="token namespace">on</span> the internet are accessed and exploited<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">When</span> <span class="token keyword">protected</span> mode is on and <span class="token keyword">if</span><span class="token operator">:</span>
 
#
 
# <span class="token number">1</span><span class="token punctuation">)</span> <span class="token class-name">The</span> server is not binding explicitly <span class="token keyword">to</span> <span class="token namespace">a</span> set of addresses using the
 
#    <span class="token string">"bind"</span> directive<span class="token punctuation">.</span>
 
# <span class="token number">2</span><span class="token punctuation">)</span> <span class="token class-name">No</span> password is configured<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> server only accepts connections from clients connecting from the
 
# <span class="token class-name">IPv4</span> and <span class="token class-name">IPv6</span> loopback addresses <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> and <span class="token operator">::</span><span class="token number">1</span><span class="token punctuation">,</span> and from <span class="token class-name">Unix</span> domain
 
# sockets<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">By</span> <span class="token keyword">default</span> <span class="token keyword">protected</span> mode is <span class="token class-name"><span class="token namespace">enabled<span class="token punctuation">.</span></span> You</span> should disable it only <span class="token keyword">if</span>
 
# you are sure you want clients from other hosts <span class="token keyword">to</span> <span class="token namespace">connect</span> <span class="token keyword">to</span> <span class="token class-name">Redis</span>
 
# even <span class="token keyword">if</span> no authentication is configured<span class="token punctuation">,</span> nor a specific set of interfaces
 
# are explicitly listed using the <span class="token string">"bind"</span> directive<span class="token punctuation">.</span>
 
<span class="token keyword">protected</span><span class="token operator">-</span>mode no
 
 
 
# <span class="token class-name">Accept</span> connections on the specified port<span class="token punctuation">,</span> <span class="token keyword">default</span> is <span class="token number">6379</span> <span class="token punctuation">(</span><span class="token constant">IANA</span> #<span class="token number">815344</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
 
# <span class="token class-name">If</span> port <span class="token number">0</span> is specified <span class="token class-name">Redis</span> will not listen on a <span class="token constant">TCP</span> socket<span class="token punctuation">.</span>
 
port <span class="token number">6379</span>
 
 
 
# <span class="token class-name">TCP</span> <span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> backlog<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">In</span> high requests<span class="token operator">-</span>per<span class="token operator">-</span>second environments you need an high backlog in order
 
# <span class="token keyword">to</span> <span class="token namespace">avoid</span> slow clients connections <span class="token class-name"><span class="token namespace">issues<span class="token punctuation">.</span></span> Note</span> that the <span class="token class-name">Linux</span> kernel
 
# will silently truncate it <span class="token keyword">to</span> <span class="token namespace">the</span> value of <span class="token operator">/</span>proc<span class="token operator">/</span>sys<span class="token operator">/</span>net<span class="token operator">/</span>core<span class="token operator">/</span>somaxconn so
 
# make sure <span class="token keyword">to</span> <span class="token namespace">raise</span> both the value of somaxconn and tcp_max_syn_backlog
 
# in order <span class="token keyword">to</span> <span class="token namespace">get</span> the desired effect<span class="token punctuation">.</span>
 
tcp<span class="token operator">-</span>backlog <span class="token number">511</span>
 
 
 
# <span class="token class-name">Unix</span> socket<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Specify</span> the path <span class="token keyword">for</span> the <span class="token class-name">Unix</span> socket that will be used <span class="token keyword">to</span> <span class="token namespace">listen</span> <span class="token keyword">for</span>
 
# incoming <span class="token class-name"><span class="token namespace">connections<span class="token punctuation">.</span></span> There</span> is no <span class="token keyword">default</span><span class="token punctuation">,</span> so <span class="token class-name">Redis</span> will not listen
 
# on a unix socket when not specified<span class="token punctuation">.</span>
 
#
 
# unixsocket <span class="token operator">/</span>tmp<span class="token operator">/</span>redis<span class="token punctuation">.</span>sock
 
# unixsocketperm <span class="token number">700</span>
 
 
 
# <span class="token class-name">Close</span> the connection after a client is idle <span class="token keyword">for</span> <span class="token class-name">N</span> seconds <span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">to</span> <span class="token namespace">disable</span><span class="token punctuation">)</span>
 
timeout <span class="token number">0</span>
 
 
 
# <span class="token constant">TCP</span> keepalive<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">If</span> non<span class="token operator">-</span>zero<span class="token punctuation">,</span> use <span class="token constant">SO_KEEPALIVE</span> <span class="token keyword">to</span> <span class="token namespace">send</span> <span class="token constant">TCP</span> <span class="token class-name">ACKs</span> <span class="token keyword">to</span> <span class="token namespace">clients</span> in absence
 
# of <span class="token class-name"><span class="token namespace">communication<span class="token punctuation">.</span></span> This</span> is useful <span class="token keyword">for</span> two reasons<span class="token operator">:</span>
 
#
 
# <span class="token number">1</span><span class="token punctuation">)</span> <span class="token class-name">Detect</span> dead peers<span class="token punctuation">.</span>
 
# <span class="token number">2</span><span class="token punctuation">)</span> <span class="token class-name">Take</span> the connection alive from the point of view of network
 
#    equipment in the middle<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">On</span> <span class="token class-name">Linux</span><span class="token punctuation">,</span> the specified value <span class="token punctuation">(</span>in seconds<span class="token punctuation">)</span> is the period used <span class="token keyword">to</span> <span class="token namespace">send</span> <span class="token class-name">ACKs</span><span class="token punctuation">.</span>
 
# <span class="token class-name">Note</span> that <span class="token keyword">to</span> <span class="token namespace">close</span> the connection the <span class="token keyword">double</span> of the time is needed<span class="token punctuation">.</span>
 
# <span class="token class-name">On</span> other kernels the period depends on the kernel configuration<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">A</span> reasonable value <span class="token keyword">for</span> <span class="token keyword">this</span> option is <span class="token number">300</span> seconds<span class="token punctuation">,</span> which is the <span class="token keyword">new</span>
 
# <span class="token class-name">Redis</span> <span class="token keyword">default</span> starting <span class="token keyword">with</span> <span class="token class-name">Redis</span> <span class="token number">3.2</span><span class="token number">.1</span><span class="token punctuation">.</span>
 
tcp<span class="token operator">-</span>keepalive <span class="token number">300</span>
 
 
 
################################# <span class="token constant">GENERAL</span> #####################################
 
 
 
# <span class="token class-name">By</span> <span class="token keyword">default</span> <span class="token class-name">Redis</span> does not run as a <span class="token class-name"><span class="token namespace">daemon<span class="token punctuation">.</span></span> Use</span> <span class="token char">'yes'</span> <span class="token keyword">if</span> you need it<span class="token punctuation">.</span>
 
# <span class="token class-name">Note</span> that <span class="token class-name">Redis</span> will write a pid file in <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>run<span class="token operator">/</span>redis<span class="token punctuation">.</span>pid when daemonized<span class="token punctuation">.</span>
 
daemonize no
 
 
 
# <span class="token class-name">If</span> you run <span class="token class-name">Redis</span> from upstart or systemd<span class="token punctuation">,</span> <span class="token class-name">Redis</span> can interact <span class="token keyword">with</span> <span class="token namespace">your</span>
 
# supervision <span class="token class-name"><span class="token namespace">tree<span class="token punctuation">.</span></span> Options</span><span class="token operator">:</span>
 
#   supervised no      <span class="token operator">-</span> no supervision interaction
 
#   supervised upstart <span class="token operator">-</span> signal upstart by putting <span class="token class-name">Redis</span> into <span class="token constant">SIGSTOP</span> mode
 
#   supervised systemd <span class="token operator">-</span> signal systemd by writing <span class="token constant">READY</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">to</span> $<span class="token constant">NOTIFY_SOCKET</span>
 
#   supervised auto    <span class="token operator">-</span> detect upstart or systemd method based on
 
#                        <span class="token constant">UPSTART_JOB</span> or <span class="token constant">NOTIFY_SOCKET</span> environment variables
 
# <span class="token class-name">Note</span><span class="token operator">:</span> these supervision methods only signal <span class="token string">"process is ready."</span>
 
#       <span class="token class-name">They</span> <span class="token keyword">do</span> not enable continuous liveness pings back <span class="token keyword">to</span> <span class="token namespace">your</span> supervisor<span class="token punctuation">.</span>
 
supervised no
 
 
 
# <span class="token class-name">If</span> a pid file is specified<span class="token punctuation">,</span> <span class="token class-name">Redis</span> writes it where specified at startup
 
# and removes it at exit<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">When</span> the server runs non daemonized<span class="token punctuation">,</span> no pid file is created <span class="token keyword">if</span> none is
 
# specified in the <span class="token class-name"><span class="token namespace">configuration<span class="token punctuation">.</span></span> When</span> the server is daemonized<span class="token punctuation">,</span> the pid file
 
# is used even <span class="token keyword">if</span> not specified<span class="token punctuation">,</span> defaulting <span class="token keyword">to</span> <span class="token string">"/var/run/redis.pid"</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Creating</span> a pid file is best effort<span class="token operator">:</span> <span class="token keyword">if</span> <span class="token class-name">Redis</span> is not able <span class="token keyword">to</span> <span class="token namespace">create</span> it
 
# nothing bad happens<span class="token punctuation">,</span> the server will start and run normally<span class="token punctuation">.</span>
 
pidfile <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>run<span class="token operator">/</span>redis_6379<span class="token punctuation">.</span>pid
 
 
 
# <span class="token class-name">Specify</span> the server verbosity level<span class="token punctuation">.</span>
 
# <span class="token class-name">This</span> can be one of<span class="token operator">:</span>
 
# debug <span class="token punctuation">(</span>a lot of information<span class="token punctuation">,</span> useful <span class="token keyword">for</span> development<span class="token operator">/</span>testing<span class="token punctuation">)</span>
 
# verbose <span class="token punctuation">(</span>many rarely useful info<span class="token punctuation">,</span> but not a mess like the debug level<span class="token punctuation">)</span>
 
# notice <span class="token punctuation">(</span>moderately verbose<span class="token punctuation">,</span> what you want in production probably<span class="token punctuation">)</span>
 
# warning <span class="token punctuation">(</span>only very important <span class="token operator">/</span> critical messages are logged<span class="token punctuation">)</span>
 
loglevel notice
 
 
 
# <span class="token class-name">Specify</span> the log file <span class="token class-name"><span class="token namespace">name<span class="token punctuation">.</span></span> Also</span> the empty string can be used <span class="token keyword">to</span> <span class="token namespace">force</span>
 
# <span class="token class-name">Redis</span> <span class="token keyword">to</span> <span class="token namespace">log</span> on the standard <span class="token class-name"><span class="token namespace">output<span class="token punctuation">.</span></span> Note</span> that <span class="token keyword">if</span> you use standard
 
# output <span class="token keyword">for</span> logging but daemonize<span class="token punctuation">,</span> logs will be sent <span class="token keyword">to</span> <span class="token operator">/</span>dev<span class="token operator">/</span><span class="token keyword">null</span>
 
logfile <span class="token string">""</span>
 
 
 
# <span class="token class-name">To</span> enable logging <span class="token keyword">to</span> <span class="token namespace">the</span> system logger<span class="token punctuation">,</span> just set 'syslog<span class="token operator">-</span>enabled' <span class="token keyword">to</span> <span class="token namespace">yes</span><span class="token punctuation">,</span>
 
# and optionally update the other syslog parameters <span class="token keyword">to</span> <span class="token namespace">suit</span> your needs<span class="token punctuation">.</span>
 
# syslog<span class="token operator">-</span>enabled no
 
 
 
# <span class="token class-name">Specify</span> the syslog identity<span class="token punctuation">.</span>
 
# syslog<span class="token operator">-</span>ident redis
 
 
 
# <span class="token class-name">Specify</span> the syslog <span class="token class-name"><span class="token namespace">facility<span class="token punctuation">.</span></span> Must</span> be <span class="token constant">USER</span> or between <span class="token constant">LOCAL0</span><span class="token operator">-</span><span class="token constant">LOCAL7</span><span class="token punctuation">.</span>
 
# syslog<span class="token operator">-</span>facility local0
 
 
 
# <span class="token class-name">Set</span> the number of <span class="token class-name"><span class="token namespace">databases<span class="token punctuation">.</span></span> The</span> <span class="token keyword">default</span> database is <span class="token class-name">DB</span> <span class="token number">0</span><span class="token punctuation">,</span> you can select
 
# a different one on a per<span class="token operator">-</span>connection basis using <span class="token constant">SELECT</span> <span class="token generics"><span class="token punctuation">&lt;</span>dbid<span class="token punctuation">&gt;</span></span> where
 
# dbid is a number between <span class="token number">0</span> and 'databases'<span class="token operator">-</span><span class="token number">1</span>
 
databases <span class="token number">16</span>
 
 
 
# <span class="token class-name">By</span> <span class="token keyword">default</span> <span class="token class-name">Redis</span> shows an <span class="token constant">ASCII</span> art logo only when started <span class="token keyword">to</span> <span class="token namespace">log</span> <span class="token keyword">to</span> <span class="token namespace">the</span>
 
# standard output and <span class="token keyword">if</span> the standard output is a <span class="token class-name">TTY<span class="token punctuation">.</span> Basically</span> <span class="token keyword">this</span> means
 
# that normally a logo is displayed only in interactive sessions<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">However</span> it is possible <span class="token keyword">to</span> <span class="token namespace">force</span> the pre<span class="token operator">-</span><span class="token number">4.0</span> behavior and always show a
 
# <span class="token constant">ASCII</span> art logo in startup logs by setting the following option <span class="token keyword">to</span> <span class="token namespace">yes<span class="token punctuation">.</span></span>
 
always<span class="token operator">-</span>show<span class="token operator">-</span>logo yes
 
 
 
################################ <span class="token constant">SNAPSHOTTING</span>  ################################
 
#
 
# <span class="token class-name">Save</span> the <span class="token constant">DB</span> on disk<span class="token operator">:</span>
 
#
 
#   save <span class="token generics"><span class="token punctuation">&lt;</span>seconds<span class="token punctuation">&gt;</span></span> <span class="token generics"><span class="token punctuation">&lt;</span>changes<span class="token punctuation">&gt;</span></span>
 
#
 
#   <span class="token class-name">Will</span> save the <span class="token constant">DB</span> <span class="token keyword">if</span> both the given number of seconds and the given
 
#   number of write operations against the <span class="token constant">DB</span> occurred<span class="token punctuation">.</span>
 
#
 
#   <span class="token class-name">In</span> the example below the behaviour will be <span class="token keyword">to</span> <span class="token namespace">save</span><span class="token operator">:</span>
 
#   after <span class="token number">900</span> sec <span class="token punctuation">(</span><span class="token number">15</span> min<span class="token punctuation">)</span> <span class="token keyword">if</span> at least <span class="token number">1</span> key changed
 
#   after <span class="token number">300</span> sec <span class="token punctuation">(</span><span class="token number">5</span> min<span class="token punctuation">)</span> <span class="token keyword">if</span> at least <span class="token number">10</span> keys changed
 
#   after <span class="token number">60</span> sec <span class="token keyword">if</span> at least <span class="token number">10000</span> keys changed
 
#
 
#   <span class="token class-name">Note</span><span class="token operator">:</span> you can disable saving completely by commenting out all <span class="token string">"save"</span> lines<span class="token punctuation">.</span>
 
#
 
#   <span class="token class-name">It</span> is also possible <span class="token keyword">to</span> <span class="token namespace">remove</span> all the previously configured save
 
#   points by adding a save directive <span class="token keyword">with</span> <span class="token namespace">a</span> single empty string argument
 
#   like in the following example<span class="token operator">:</span>
 
#
 
#   save <span class="token string">""</span>
 
 
 
save <span class="token number">900</span> <span class="token number">1</span>
 
save <span class="token number">300</span> <span class="token number">10</span>
 
save <span class="token number">60</span> <span class="token number">10000</span>
 
 
 
# <span class="token class-name">By</span> <span class="token keyword">default</span> <span class="token class-name">Redis</span> will stop accepting writes <span class="token keyword">if</span> <span class="token constant">RDB</span> snapshots are enabled
 
# <span class="token punctuation">(</span>at least one save point<span class="token punctuation">)</span> and the latest background save failed<span class="token punctuation">.</span>
 
# <span class="token class-name">This</span> will make the user aware <span class="token punctuation">(</span>in a hard way<span class="token punctuation">)</span> that data is not persisting
 
# on disk properly<span class="token punctuation">,</span> otherwise chances are that no one will notice and some
 
# disaster will happen<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">If</span> the background saving process will start working again <span class="token class-name">Redis</span> will
 
# automatically allow writes again<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">However</span> <span class="token keyword">if</span> you have setup your proper monitoring of the <span class="token class-name">Redis</span> server
 
# and persistence<span class="token punctuation">,</span> you may want <span class="token keyword">to</span> <span class="token namespace">disable</span> <span class="token keyword">this</span> feature so that <span class="token class-name">Redis</span> will
 
# <span class="token keyword">continue</span> <span class="token keyword">to</span> <span class="token namespace">work</span> as usual even <span class="token keyword">if</span> there are problems <span class="token keyword">with</span> <span class="token namespace">disk</span><span class="token punctuation">,</span>
 
# permissions<span class="token punctuation">,</span> and so forth<span class="token punctuation">.</span>
 
stop<span class="token operator">-</span>writes<span class="token operator">-</span>on<span class="token operator">-</span>bgsave<span class="token operator">-</span>error yes
 
 
 
# <span class="token class-name">Compress</span> string objects using <span class="token constant">LZF</span> when dump <span class="token punctuation">.</span>rdb databases<span class="token operator">?</span>
 
# <span class="token class-name">For</span> <span class="token keyword">default</span> that's set <span class="token keyword">to</span> <span class="token char">'yes'</span> as it's almost always a win<span class="token punctuation">.</span>
 
# <span class="token class-name">If</span> you want <span class="token keyword">to</span> <span class="token namespace">save</span> some <span class="token constant">CPU</span> in the saving child set it <span class="token keyword">to</span> <span class="token char">'no'</span> but
 
# the dataset will likely be bigger <span class="token keyword">if</span> you have compressible values or keys<span class="token punctuation">.</span>
 
rdbcompression yes
 
 
 
# <span class="token class-name">Since</span> version <span class="token number">5</span> of <span class="token constant">RDB</span> a <span class="token constant">CRC64</span> checksum is placed at the end of the file<span class="token punctuation">.</span>
 
# <span class="token class-name">This</span> makes the format more resistant <span class="token keyword">to</span> <span class="token namespace">corruption</span> but there is a performance
 
# hit <span class="token keyword">to</span> <span class="token namespace">pay</span> <span class="token punctuation">(</span>around <span class="token number">10</span><span class="token operator">%</span><span class="token punctuation">)</span> when saving and loading <span class="token class-name">RDB</span> files<span class="token punctuation">,</span> so you can disable it
 
# <span class="token keyword">for</span> maximum performances<span class="token punctuation">.</span>
 
#
 
# <span class="token constant">RDB</span> files created <span class="token keyword">with</span> <span class="token namespace">checksum</span> disabled have a checksum of zero that will
 
# tell the loading code <span class="token keyword">to</span> <span class="token namespace">skip</span> the check<span class="token punctuation">.</span>
 
rdbchecksum yes
 
 
 
# <span class="token class-name">The</span> filename where <span class="token keyword">to</span> <span class="token namespace">dump</span> the <span class="token constant">DB</span>
 
dbfilename dump<span class="token punctuation">.</span>rdb
 
 
 
# <span class="token class-name">The</span> working directory<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> <span class="token constant">DB</span> will be written inside <span class="token keyword">this</span> directory<span class="token punctuation">,</span> <span class="token keyword">with</span> <span class="token namespace">the</span> filename specified
 
# above using the 'dbfilename' configuration directive<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> <span class="token class-name">Append</span> <span class="token class-name">Only</span> <span class="token class-name">File</span> will also be created inside <span class="token keyword">this</span> directory<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Note</span> that you must specify a directory here<span class="token punctuation">,</span> not a file name<span class="token punctuation">.</span>
 
dir <span class="token punctuation">.</span>/
 
 
 
################################# <span class="token constant">REPLICATION</span> #################################
 
 
 
# <span class="token class-name">Master</span><span class="token operator">-</span><span class="token class-name">Replica</span> <span class="token class-name"><span class="token namespace">replication<span class="token punctuation">.</span></span> Use</span> replicaof <span class="token keyword">to</span> <span class="token namespace">make</span> a <span class="token class-name">Redis</span> instance a copy of
 
# another <span class="token class-name">Redis</span> <span class="token class-name"><span class="token namespace">server<span class="token punctuation">.</span></span> A</span> few things <span class="token keyword">to</span> <span class="token namespace">understand</span> <span class="token constant">ASAP</span> about <span class="token class-name">Redis</span> replication<span class="token punctuation">.</span>
 
#
 
#   <span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>      <span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
 
#   <span class="token operator">|</span>      <span class="token class-name">Master</span>      <span class="token operator">|</span> <span class="token operator">--</span><span class="token operator">-&gt;</span> <span class="token operator">|</span>    <span class="token class-name">Replica</span>    <span class="token operator">|</span>
 
#   <span class="token operator">|</span> <span class="token punctuation">(</span>receive writes<span class="token punctuation">)</span> <span class="token operator">|</span>      <span class="token operator">|</span>  <span class="token punctuation">(</span>exact copy<span class="token punctuation">)</span> <span class="token operator">|</span>
 
#   <span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>      <span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
 
#
 
# <span class="token number">1</span><span class="token punctuation">)</span> <span class="token class-name">Redis</span> replication is asynchronous<span class="token punctuation">,</span> but you can configure a master <span class="token keyword">to</span>
 
#    stop accepting writes <span class="token keyword">if</span> it appears <span class="token keyword">to</span> <span class="token namespace">be</span> not connected <span class="token keyword">with</span> <span class="token namespace">at</span> least
 
#    a given number of replicas<span class="token punctuation">.</span>
 
# <span class="token number">2</span><span class="token punctuation">)</span> <span class="token class-name">Redis</span> replicas are able <span class="token keyword">to</span> <span class="token namespace">perform</span> a partial resynchronization <span class="token keyword">with</span> <span class="token namespace">the</span>
 
#    master <span class="token keyword">if</span> the replication link is lost <span class="token keyword">for</span> a relatively small amount of
 
#    <span class="token class-name"><span class="token namespace">time<span class="token punctuation">.</span></span> You</span> may want <span class="token keyword">to</span> <span class="token namespace">configure</span> the replication backlog size <span class="token punctuation">(</span>see the next
 
#    sections of <span class="token keyword">this</span> file<span class="token punctuation">)</span> <span class="token keyword">with</span> <span class="token namespace">a</span> sensible value depending on your needs<span class="token punctuation">.</span>
 
# <span class="token number">3</span><span class="token punctuation">)</span> <span class="token class-name">Replication</span> is automatic and does not need user <span class="token class-name"><span class="token namespace">intervention<span class="token punctuation">.</span></span> After</span> a
 
#    network partition replicas automatically <span class="token keyword">try</span> <span class="token keyword">to</span> <span class="token namespace">reconnect</span> <span class="token keyword">to</span> <span class="token namespace">masters</span>
 
#    and resynchronize <span class="token keyword">with</span> <span class="token namespace">them<span class="token punctuation">.</span></span>
 
#
 
# replicaof <span class="token generics"><span class="token punctuation">&lt;</span>masterip<span class="token punctuation">&gt;</span></span> <span class="token generics"><span class="token punctuation">&lt;</span>masterport<span class="token punctuation">&gt;</span></span>
 
 
 
# <span class="token class-name">If</span> the master is password <span class="token keyword">protected</span> <span class="token punctuation">(</span>using the <span class="token string">"requirepass"</span> configuration
 
# directive below<span class="token punctuation">)</span> it is possible <span class="token keyword">to</span> <span class="token namespace">tell</span> the replica <span class="token keyword">to</span> <span class="token namespace">authenticate</span> before
 
# starting the replication synchronization process<span class="token punctuation">,</span> otherwise the master will
 
# refuse the replica request<span class="token punctuation">.</span>
 
#
 
# masterauth <span class="token operator">&lt;</span>master<span class="token operator">-</span>password<span class="token operator">&gt;</span>
 
 
 
# <span class="token class-name">When</span> a replica loses its connection <span class="token keyword">with</span> <span class="token namespace">the</span> master<span class="token punctuation">,</span> or when the replication
 
# is still in progress<span class="token punctuation">,</span> the replica can act in two different ways<span class="token operator">:</span>
 
#
 
# <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">if</span> replica<span class="token operator">-</span>serve<span class="token operator">-</span>stale<span class="token operator">-</span>data is set <span class="token keyword">to</span> <span class="token char">'yes'</span> <span class="token punctuation">(</span>the <span class="token keyword">default</span><span class="token punctuation">)</span> the replica will
 
#    still reply <span class="token keyword">to</span> <span class="token namespace">client</span> requests<span class="token punctuation">,</span> possibly <span class="token keyword">with</span> <span class="token namespace">out</span> of date data<span class="token punctuation">,</span> or the
 
#    data set may just be empty <span class="token keyword">if</span> <span class="token keyword">this</span> is the first synchronization<span class="token punctuation">.</span>
 
#
 
# <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">if</span> replica<span class="token operator">-</span>serve<span class="token operator">-</span>stale<span class="token operator">-</span>data is set <span class="token keyword">to</span> <span class="token char">'no'</span> the replica will reply <span class="token keyword">with</span>
 
#    an error <span class="token string">"SYNC with master in progress"</span> <span class="token keyword">to</span> <span class="token namespace">all</span> the kind of commands
 
#    but <span class="token keyword">to</span> <span class="token constant">INFO</span><span class="token punctuation">,</span> replicaOF<span class="token punctuation">,</span> <span class="token constant">AUTH</span><span class="token punctuation">,</span> <span class="token constant">PING</span><span class="token punctuation">,</span> <span class="token constant">SHUTDOWN</span><span class="token punctuation">,</span> <span class="token constant">REPLCONF</span><span class="token punctuation">,</span> <span class="token constant">ROLE</span><span class="token punctuation">,</span> <span class="token constant">CONFIG</span><span class="token punctuation">,</span>
 
#    <span class="token constant">SUBSCRIBE</span><span class="token punctuation">,</span> <span class="token constant">UNSUBSCRIBE</span><span class="token punctuation">,</span> <span class="token constant">PSUBSCRIBE</span><span class="token punctuation">,</span> <span class="token constant">PUNSUBSCRIBE</span><span class="token punctuation">,</span> <span class="token constant">PUBLISH</span><span class="token punctuation">,</span> <span class="token constant">PUBSUB</span><span class="token punctuation">,</span>
 
#    <span class="token constant">COMMAND</span><span class="token punctuation">,</span> <span class="token constant">POST</span><span class="token punctuation">,</span> <span class="token constant">HOST</span><span class="token operator">:</span> and <span class="token constant">LATENCY</span><span class="token punctuation">.</span>
 
#
 
replica<span class="token operator">-</span>serve<span class="token operator">-</span>stale<span class="token operator">-</span>data yes
 
 
 
# <span class="token class-name">You</span> can configure a replica instance <span class="token keyword">to</span> <span class="token namespace">accept</span> writes or <span class="token class-name"><span class="token namespace">not<span class="token punctuation">.</span></span> Writing</span> against
 
# a replica instance may be useful <span class="token keyword">to</span> <span class="token namespace">store</span> some ephemeral data <span class="token punctuation">(</span>because data
 
# written on a replica will be easily deleted after resync <span class="token keyword">with</span> <span class="token namespace">the</span> master<span class="token punctuation">)</span> but
 
# may also cause problems <span class="token keyword">if</span> clients are writing <span class="token keyword">to</span> <span class="token namespace">it</span> because of a
 
# misconfiguration<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Since</span> <span class="token class-name">Redis</span> <span class="token number">2.6</span> by <span class="token keyword">default</span> replicas are read<span class="token operator">-</span>only<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Note</span><span class="token operator">:</span> read only replicas are not designed <span class="token keyword">to</span> <span class="token namespace">be</span> exposed <span class="token keyword">to</span> <span class="token namespace">untrusted</span> clients
 
# on the <span class="token class-name"><span class="token namespace">internet<span class="token punctuation">.</span></span> It</span>'s just a protection layer against misuse of the instance<span class="token punctuation">.</span>
 
# <span class="token class-name">Still</span> a read only replica <span class="token keyword">exports</span> <span class="token namespace">by</span> <span class="token keyword">default</span> all the administrative commands
 
# such as <span class="token constant">CONFIG</span><span class="token punctuation">,</span> <span class="token constant">DEBUG</span><span class="token punctuation">,</span> and so <span class="token class-name"><span class="token namespace">forth<span class="token punctuation">.</span></span> To</span> a limited extent you can improve
 
# security of read only replicas using 'rename<span class="token operator">-</span>command' <span class="token keyword">to</span> <span class="token namespace">shadow</span> all the
 
# administrative <span class="token operator">/</span> dangerous commands<span class="token punctuation">.</span>
 
replica<span class="token operator">-</span>read<span class="token operator">-</span>only yes
 
 
 
# <span class="token class-name">Replication</span> <span class="token constant">SYNC</span> strategy<span class="token operator">:</span> disk or socket<span class="token punctuation">.</span>
 
#
 
# <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
 
# <span class="token constant">WARNING</span><span class="token operator">:</span> <span class="token constant">DISKLESS</span> <span class="token constant">REPLICATION</span> <span class="token constant">IS</span> <span class="token constant">EXPERIMENTAL</span> <span class="token constant">CURRENTLY</span>
 
# <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
 
#
 
# <span class="token class-name">New</span> replicas and reconnecting replicas that are not able <span class="token keyword">to</span> <span class="token keyword">continue</span> the replication
 
# process just receiving differences<span class="token punctuation">,</span> need <span class="token keyword">to</span> <span class="token keyword">do</span> what is called a "full
 
# synchronization"<span class="token punctuation">.</span> <span class="token class-name">An</span> <span class="token constant">RDB</span> file is transmitted from the master <span class="token keyword">to</span> <span class="token namespace">the</span> replicas<span class="token punctuation">.</span>
 
# <span class="token class-name">The</span> transmission can happen in two different ways<span class="token operator">:</span>
 
#
 
# <span class="token number">1</span><span class="token punctuation">)</span> <span class="token class-name">Disk</span><span class="token operator">-</span>backed<span class="token operator">:</span> <span class="token class-name">The</span> <span class="token class-name">Redis</span> master creates a <span class="token keyword">new</span> process that writes the <span class="token constant">RDB</span>
 
#                 file on <span class="token class-name"><span class="token namespace">disk<span class="token punctuation">.</span></span> Later</span> the file is transferred by the parent
 
#                 process <span class="token keyword">to</span> <span class="token namespace">the</span> replicas incrementally<span class="token punctuation">.</span>
 
# <span class="token number">2</span><span class="token punctuation">)</span> <span class="token class-name">Diskless</span><span class="token operator">:</span> <span class="token class-name">The</span> <span class="token class-name">Redis</span> master creates a <span class="token keyword">new</span> process that directly writes the
 
#              <span class="token constant">RDB</span> file <span class="token keyword">to</span> <span class="token namespace">replica</span> sockets<span class="token punctuation">,</span> without touching the disk at all<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">With</span> disk<span class="token operator">-</span>backed replication<span class="token punctuation">,</span> <span class="token keyword">while</span> the <span class="token constant">RDB</span> file is generated<span class="token punctuation">,</span> more replicas
 
# can be queued and served <span class="token keyword">with</span> <span class="token namespace">the</span> <span class="token constant">RDB</span> file as soon as the current child producing
 
# the <span class="token constant">RDB</span> file finishes its <span class="token class-name"><span class="token namespace">work<span class="token punctuation">.</span></span> With</span> diskless replication instead once
 
# the transfer starts<span class="token punctuation">,</span> <span class="token keyword">new</span> replicas arriving will be queued and a <span class="token keyword">new</span> transfer
 
# will start when the current one terminates<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">When</span> diskless replication is used<span class="token punctuation">,</span> the master waits a configurable amount of
 
# time <span class="token punctuation">(</span>in seconds<span class="token punctuation">)</span> before starting the transfer in the hope that multiple replicas
 
# will arrive and the transfer can be parallelized<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">With</span> slow disks and fast <span class="token punctuation">(</span>large bandwidth<span class="token punctuation">)</span> networks<span class="token punctuation">,</span> diskless replication
 
# works better<span class="token punctuation">.</span>
 
repl<span class="token operator">-</span>diskless<span class="token operator">-</span>sync no
 
 
 
# <span class="token class-name">When</span> diskless replication is enabled<span class="token punctuation">,</span> it is possible <span class="token keyword">to</span> <span class="token namespace">configure</span> the delay
 
# the server waits in order <span class="token keyword">to</span> <span class="token namespace">spawn</span> the child that transfers the <span class="token constant">RDB</span> via socket
 
# <span class="token keyword">to</span> <span class="token namespace">the</span> replicas<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">This</span> is important since once the transfer starts<span class="token punctuation">,</span> it is not possible <span class="token keyword">to</span> <span class="token namespace">serve</span>
 
# <span class="token keyword">new</span> replicas arriving<span class="token punctuation">,</span> that will be queued <span class="token keyword">for</span> the next <span class="token class-name">RDB</span> transfer<span class="token punctuation">,</span> so the server
 
# waits a delay in order <span class="token keyword">to</span> <span class="token namespace">let</span> more replicas arrive<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> delay is specified in seconds<span class="token punctuation">,</span> and by <span class="token keyword">default</span> is <span class="token number">5</span> <span class="token class-name"><span class="token namespace">seconds<span class="token punctuation">.</span></span> To</span> disable
 
# it entirely just set it <span class="token keyword">to</span> <span class="token number">0</span> seconds and the transfer will start <span class="token constant">ASAP</span><span class="token punctuation">.</span>
 
repl<span class="token operator">-</span>diskless<span class="token operator">-</span>sync<span class="token operator">-</span>delay <span class="token number">5</span>
 
 
 
# <span class="token class-name">Replicas</span> send <span class="token class-name">PINGs</span> <span class="token keyword">to</span> <span class="token namespace">server</span> in a predefined <span class="token class-name"><span class="token namespace">interval<span class="token punctuation">.</span></span> It</span>'s possible <span class="token keyword">to</span> <span class="token namespace">change</span>
 
# <span class="token keyword">this</span> interval <span class="token keyword">with</span> <span class="token namespace">the</span> repl_ping_replica_period <span class="token class-name"><span class="token namespace">option<span class="token punctuation">.</span></span> The</span> <span class="token keyword">default</span> value is <span class="token number">10</span>
 
# seconds<span class="token punctuation">.</span>
 
#
 
# repl<span class="token operator">-</span>ping<span class="token operator">-</span>replica<span class="token operator">-</span>period <span class="token number">10</span>
 
 
 
# <span class="token class-name">The</span> following option sets the replication timeout <span class="token keyword">for</span><span class="token operator">:</span>
 
#
 
# <span class="token number">1</span><span class="token punctuation">)</span> <span class="token class-name">Bulk</span> transfer <span class="token class-name">I</span><span class="token operator">/</span><span class="token class-name">O</span> during <span class="token constant">SYNC</span><span class="token punctuation">,</span> from the point of view of replica<span class="token punctuation">.</span>
 
# <span class="token number">2</span><span class="token punctuation">)</span> <span class="token class-name">Master</span> timeout from the point of view of replicas <span class="token punctuation">(</span>data<span class="token punctuation">,</span> pings<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
# <span class="token number">3</span><span class="token punctuation">)</span> <span class="token class-name">Replica</span> timeout from the point of view of masters <span class="token punctuation">(</span><span class="token constant">REPLCONF</span> <span class="token class-name">ACK</span> pings<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">It</span> is important <span class="token keyword">to</span> <span class="token namespace">make</span> sure that <span class="token keyword">this</span> value is greater than the value
 
# specified <span class="token keyword">for</span> repl<span class="token operator">-</span>ping<span class="token operator">-</span>replica<span class="token operator">-</span>period otherwise a timeout will be detected
 
# every time there is low traffic between the master and the replica<span class="token punctuation">.</span>
 
#
 
# repl<span class="token operator">-</span>timeout <span class="token number">60</span>
 
 
 
# <span class="token class-name">Disable</span> <span class="token constant">TCP_NODELAY</span> on the replica socket after <span class="token constant">SYNC</span><span class="token operator">?</span>
 
#
 
# <span class="token class-name">If</span> you select <span class="token string">"yes"</span> <span class="token class-name">Redis</span> will use a smaller number of <span class="token constant">TCP</span> packets and
 
# less bandwidth <span class="token keyword">to</span> <span class="token namespace">send</span> data <span class="token keyword">to</span> <span class="token namespace">replicas<span class="token punctuation">.</span></span> <span class="token class-name">But</span> <span class="token keyword">this</span> can add a delay <span class="token keyword">for</span>
 
# the data <span class="token keyword">to</span> <span class="token namespace">appear</span> on the replica side<span class="token punctuation">,</span> up <span class="token keyword">to</span> <span class="token number">40</span> milliseconds <span class="token keyword">with</span>
 
# <span class="token class-name">Linux</span> kernels using a <span class="token keyword">default</span> configuration<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">If</span> you select <span class="token string">"no"</span> the delay <span class="token keyword">for</span> data <span class="token keyword">to</span> <span class="token namespace">appear</span> on the replica side will
 
# be reduced but more bandwidth will be used <span class="token keyword">for</span> replication<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">By</span> <span class="token keyword">default</span> we optimize <span class="token keyword">for</span> low latency<span class="token punctuation">,</span> but in very high traffic conditions
 
# or when the master and replicas are many hops away<span class="token punctuation">,</span> turning <span class="token keyword">this</span> <span class="token keyword">to</span> <span class="token string">"yes"</span> may
 
# be a good idea<span class="token punctuation">.</span>
 
repl<span class="token operator">-</span>disable<span class="token operator">-</span>tcp<span class="token operator">-</span>nodelay no
 
 
 
# <span class="token class-name">Set</span> the replication backlog <span class="token class-name"><span class="token namespace">size<span class="token punctuation">.</span></span> The</span> backlog is a buffer that accumulates
 
# replica data when replicas are disconnected <span class="token keyword">for</span> some time<span class="token punctuation">,</span> so that when a replica
 
# wants <span class="token keyword">to</span> <span class="token namespace">reconnect</span> again<span class="token punctuation">,</span> often a full resync is not needed<span class="token punctuation">,</span> but a partial
 
# resync is enough<span class="token punctuation">,</span> just passing the portion of data the replica missed <span class="token keyword">while</span>
 
# disconnected<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> bigger the replication backlog<span class="token punctuation">,</span> the longer the time the replica can be
 
# disconnected and later be able <span class="token keyword">to</span> <span class="token namespace">perform</span> a partial resynchronization<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> backlog is only allocated once there is at least a replica connected<span class="token punctuation">.</span>
 
#
 
# repl<span class="token operator">-</span>backlog<span class="token operator">-</span>size <span class="token number">1</span>mb
 
 
 
# <span class="token class-name">After</span> a master has no longer connected replicas <span class="token keyword">for</span> some time<span class="token punctuation">,</span> the backlog
 
# will be <span class="token class-name"><span class="token namespace">freed<span class="token punctuation">.</span></span> The</span> following option configures the amount of seconds that
 
# need <span class="token keyword">to</span> <span class="token namespace">elapse</span><span class="token punctuation">,</span> starting from the time the last replica disconnected<span class="token punctuation">,</span> <span class="token keyword">for</span>
 
# the backlog buffer <span class="token keyword">to</span> <span class="token namespace">be</span> freed<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Note</span> that replicas never free the backlog <span class="token keyword">for</span> timeout<span class="token punctuation">,</span> since they may be
 
# promoted <span class="token keyword">to</span> <span class="token namespace">masters</span> later<span class="token punctuation">,</span> and should be able <span class="token keyword">to</span> <span class="token namespace">correctly</span> "partially
 
# resynchronize" <span class="token keyword">with</span> <span class="token namespace">the</span> replicas<span class="token operator">:</span> hence they should always accumulate backlog<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">A</span> value of <span class="token number">0</span> means <span class="token keyword">to</span> <span class="token namespace">never</span> release the backlog<span class="token punctuation">.</span>
 
#
 
# repl<span class="token operator">-</span>backlog<span class="token operator">-</span>ttl <span class="token number">3600</span>
 
 
 
# <span class="token class-name">The</span> replica priority is an integer number published by <span class="token class-name">Redis</span> in the <span class="token constant">INFO</span> output<span class="token punctuation">.</span>
 
# <span class="token class-name">It</span> is used by <span class="token class-name">Redis</span> <span class="token class-name">Sentinel</span> in order <span class="token keyword">to</span> <span class="token namespace">select</span> a replica <span class="token keyword">to</span> <span class="token namespace">promote</span> into a
 
# master <span class="token keyword">if</span> the master is no longer working correctly<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">A</span> replica <span class="token keyword">with</span> <span class="token namespace">a</span> low priority number is considered better <span class="token keyword">for</span> promotion<span class="token punctuation">,</span> so
 
# <span class="token keyword">for</span> instance <span class="token keyword">if</span> there are three replicas <span class="token keyword">with</span> <span class="token namespace">priority</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">25</span> <span class="token class-name">Sentinel</span> will
 
# pick the one <span class="token keyword">with</span> <span class="token namespace">priority</span> <span class="token number">10</span><span class="token punctuation">,</span> that is the lowest<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">However</span> a special priority of <span class="token number">0</span> marks the replica as not able <span class="token keyword">to</span> <span class="token namespace">perform</span> the
 
# role of master<span class="token punctuation">,</span> so a replica <span class="token keyword">with</span> <span class="token namespace">priority</span> of <span class="token number">0</span> will never be selected by
 
# <span class="token class-name">Redis</span> <span class="token class-name">Sentinel</span> <span class="token keyword">for</span> promotion<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">By</span> <span class="token keyword">default</span> the priority is <span class="token number">100.</span>
 
replica<span class="token operator">-</span>priority <span class="token number">100</span>
 
 
 
# <span class="token class-name">It</span> is possible <span class="token keyword">for</span> a master <span class="token keyword">to</span> <span class="token namespace">stop</span> accepting writes <span class="token keyword">if</span> there are less than
 
# <span class="token class-name">N</span> replicas connected<span class="token punctuation">,</span> having a lag less or equal than <span class="token class-name">M</span> seconds<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> <span class="token class-name">N</span> replicas need <span class="token keyword">to</span> <span class="token namespace">be</span> in <span class="token string">"online"</span> state<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> lag in seconds<span class="token punctuation">,</span> that must be <span class="token operator">&lt;=</span> the specified value<span class="token punctuation">,</span> is calculated from
 
# the last ping received from the replica<span class="token punctuation">,</span> that is usually sent every second<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">This</span> option does not <span class="token constant">GUARANTEE</span> that <span class="token class-name">N</span> replicas will accept the write<span class="token punctuation">,</span> but
 
# will limit the window of exposure <span class="token keyword">for</span> lost writes in <span class="token keyword">case</span> not enough replicas
 
# are available<span class="token punctuation">,</span> <span class="token keyword">to</span> <span class="token namespace">the</span> specified number of seconds<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">For</span> example <span class="token keyword">to</span> <span class="token namespace">require</span> at least <span class="token number">3</span> replicas <span class="token keyword">with</span> <span class="token namespace">a</span> lag <span class="token operator">&lt;=</span> <span class="token number">10</span> seconds use<span class="token operator">:</span>
 
#
 
# min<span class="token operator">-</span>replicas<span class="token operator">-</span><span class="token keyword">to</span><span class="token operator">-</span>write <span class="token number">3</span>
 
# min<span class="token operator">-</span>replicas<span class="token operator">-</span>max<span class="token operator">-</span>lag <span class="token number">10</span>
 
#
 
# <span class="token class-name">Setting</span> one or the other <span class="token keyword">to</span> <span class="token number">0</span> disables the feature<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">By</span> <span class="token keyword">default</span> min<span class="token operator">-</span>replicas<span class="token operator">-</span><span class="token keyword">to</span><span class="token operator">-</span>write is set <span class="token keyword">to</span> <span class="token number">0</span> <span class="token punctuation">(</span>feature disabled<span class="token punctuation">)</span> and
 
# min<span class="token operator">-</span>replicas<span class="token operator">-</span>max<span class="token operator">-</span>lag is set <span class="token keyword">to</span> <span class="token number">10.</span>
 
 
 
# <span class="token class-name">A</span> <span class="token class-name">Redis</span> master is able <span class="token keyword">to</span> <span class="token namespace">list</span> the address and port of the attached
 
# replicas in different <span class="token class-name"><span class="token namespace">ways<span class="token punctuation">.</span></span> For</span> example the <span class="token string">"INFO replication"</span> section
 
# offers <span class="token keyword">this</span> information<span class="token punctuation">,</span> which is used<span class="token punctuation">,</span> among other tools<span class="token punctuation">,</span> by
 
# <span class="token class-name">Redis</span> <span class="token class-name">Sentinel</span> in order <span class="token keyword">to</span> <span class="token namespace">discover</span> replica instances<span class="token punctuation">.</span>
 
# <span class="token class-name">Another</span> place where <span class="token keyword">this</span> info is available is in the output of the
 
# <span class="token string">"ROLE"</span> command of a master<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> listed <span class="token constant">IP</span> and address normally reported by a replica is obtained
 
# in the following way<span class="token operator">:</span>
 
#
 
#   <span class="token constant">IP</span><span class="token operator">:</span> <span class="token class-name">The</span> address is auto detected by checking the peer address
 
#   of the socket used by the replica <span class="token keyword">to</span> <span class="token namespace">connect</span> <span class="token keyword">with</span> <span class="token namespace">the</span> master<span class="token punctuation">.</span>
 
#
 
#   <span class="token class-name">Port</span><span class="token operator">:</span> <span class="token class-name">The</span> port is communicated by the replica during the replication
 
#   handshake<span class="token punctuation">,</span> and is normally the port that the replica is using <span class="token keyword">to</span>
 
#   listen <span class="token keyword">for</span> connections<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">However</span> when port forwarding or <span class="token class-name">Network</span> <span class="token class-name">Address</span> <span class="token class-name">Translation</span> <span class="token punctuation">(</span><span class="token constant">NAT</span><span class="token punctuation">)</span> is
 
# used<span class="token punctuation">,</span> the replica may be actually reachable via different <span class="token constant">IP</span> and port
 
# <span class="token class-name"><span class="token namespace">pairs<span class="token punctuation">.</span></span> The</span> following two options can be used by a replica in order <span class="token keyword">to</span>
 
# report <span class="token keyword">to</span> <span class="token namespace">its</span> master a specific set of <span class="token constant">IP</span> and port<span class="token punctuation">,</span> so that both <span class="token constant">INFO</span>
 
# and <span class="token constant">ROLE</span> will report those values<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">There</span> is no need <span class="token keyword">to</span> <span class="token namespace">use</span> both the options <span class="token keyword">if</span> you need <span class="token keyword">to</span> <span class="token namespace">override</span> just
 
# the port or the <span class="token constant">IP</span> address<span class="token punctuation">.</span>
 
#
 
# replica<span class="token operator">-</span>announce<span class="token operator">-</span>ip <span class="token number">5.5</span><span class="token number">.5</span><span class="token number">.5</span>
 
# replica<span class="token operator">-</span>announce<span class="token operator">-</span>port <span class="token number">1234</span>
 
 
 
################################## <span class="token constant">SECURITY</span> ###################################
 
 
 
# <span class="token class-name">Require</span> clients <span class="token keyword">to</span> <span class="token namespace">issue</span> <span class="token constant">AUTH</span> <span class="token generics"><span class="token punctuation">&lt;</span>PASSWORD<span class="token punctuation">&gt;</span></span> before processing any other
 
# <span class="token class-name"><span class="token namespace">commands<span class="token punctuation">.</span></span>  This</span> might be useful in environments in which you <span class="token keyword">do</span> not trust
 
# others <span class="token keyword">with</span> <span class="token namespace">access</span> <span class="token keyword">to</span> <span class="token namespace">the</span> host running redis<span class="token operator">-</span>server<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">This</span> should stay commented out <span class="token keyword">for</span> backward compatibility and because most
 
# people <span class="token keyword">do</span> not need auth <span class="token punctuation">(</span>e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> they run their own servers<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Warning</span><span class="token operator">:</span> since <span class="token class-name">Redis</span> is pretty fast an outside user can <span class="token keyword">try</span> up <span class="token keyword">to</span>
 
# <span class="token number">150</span>k passwords per second against a good <span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span> This</span> means that you should
 
# use a very strong password otherwise it will be very easy <span class="token keyword">to</span> <span class="token keyword">break</span><span class="token punctuation">.</span>
 
#
 
# requirepass foobared
 
 
 
# <span class="token class-name">Command</span> renaming<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">It</span> is possible <span class="token keyword">to</span> <span class="token namespace">change</span> the name of dangerous commands in a shared
 
# <span class="token class-name"><span class="token namespace">environment<span class="token punctuation">.</span></span> For</span> instance the <span class="token constant">CONFIG</span> command may be renamed into something
 
# hard <span class="token keyword">to</span> <span class="token namespace">guess</span> so that it will still be available <span class="token keyword">for</span> internal<span class="token operator">-</span>use tools
 
# but not available <span class="token keyword">for</span> general clients<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Example</span><span class="token operator">:</span>
 
#
 
# rename<span class="token operator">-</span>command <span class="token constant">CONFIG</span> b840fc02d524045429941cc15f59e41cb7be6c52
 
#
 
# <span class="token class-name">It</span> is also possible <span class="token keyword">to</span> <span class="token namespace">completely</span> kill a command by renaming it into
 
# an empty string<span class="token operator">:</span>
 
#
 
# rename<span class="token operator">-</span>command <span class="token constant">CONFIG</span> <span class="token string">""</span>
 
#
 
# <span class="token class-name">Please</span> note that changing the name of commands that are logged into the
 
# <span class="token constant">AOF</span> file or transmitted <span class="token keyword">to</span> <span class="token namespace">replicas</span> may cause problems<span class="token punctuation">.</span>
 
 
 
################################### <span class="token constant">CLIENTS</span> ####################################
 
 
 
# <span class="token class-name">Set</span> the max number of connected clients at the same <span class="token class-name"><span class="token namespace">time<span class="token punctuation">.</span></span> By</span> <span class="token keyword">default</span>
 
# <span class="token keyword">this</span> limit is set <span class="token keyword">to</span> <span class="token number">10000</span> clients<span class="token punctuation">,</span> however <span class="token keyword">if</span> the <span class="token class-name">Redis</span> server is not
 
# able <span class="token keyword">to</span> <span class="token namespace">configure</span> the process file limit <span class="token keyword">to</span> <span class="token namespace">allow</span> <span class="token keyword">for</span> the specified limit
 
# the max number of allowed clients is set <span class="token keyword">to</span> <span class="token namespace">the</span> current file limit
 
# minus <span class="token number">32</span> <span class="token punctuation">(</span>as <span class="token class-name">Redis</span> reserves a few file descriptors <span class="token keyword">for</span> internal <span class="token keyword">uses</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Once</span> the limit is reached <span class="token class-name">Redis</span> will close all the <span class="token keyword">new</span> connections sending
 
# an error 'max number of clients reached'<span class="token punctuation">.</span>
 
#
 
# maxclients <span class="token number">10000</span>
 
 
 
############################## <span class="token constant">MEMORY</span> <span class="token constant">MANAGEMENT</span> ################################
 
 
 
# <span class="token class-name">Set</span> a memory usage limit <span class="token keyword">to</span> <span class="token namespace">the</span> specified amount of bytes<span class="token punctuation">.</span>
 
# <span class="token class-name">When</span> the memory limit is reached <span class="token class-name">Redis</span> will <span class="token keyword">try</span> <span class="token keyword">to</span> <span class="token namespace">remove</span> keys
 
# according <span class="token keyword">to</span> <span class="token namespace">the</span> eviction policy selected <span class="token punctuation">(</span>see maxmemory<span class="token operator">-</span>policy<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">If</span> <span class="token class-name">Redis</span> can't remove keys according <span class="token keyword">to</span> <span class="token namespace">the</span> policy<span class="token punctuation">,</span> or <span class="token keyword">if</span> the policy is
 
# set <span class="token keyword">to</span> 'noeviction'<span class="token punctuation">,</span> <span class="token class-name">Redis</span> will start <span class="token keyword">to</span> <span class="token namespace">reply</span> <span class="token keyword">with</span> <span class="token namespace">errors</span> <span class="token keyword">to</span> <span class="token namespace">commands</span>
 
# that would use more memory<span class="token punctuation">,</span> like <span class="token constant">SET</span><span class="token punctuation">,</span> <span class="token constant">LPUSH</span><span class="token punctuation">,</span> and so on<span class="token punctuation">,</span> and will <span class="token keyword">continue</span>
 
# <span class="token keyword">to</span> <span class="token namespace">reply</span> <span class="token keyword">to</span> <span class="token namespace">read</span><span class="token operator">-</span>only commands like <span class="token constant">GET</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">This</span> option is usually useful when using <span class="token class-name">Redis</span> as an <span class="token constant">LRU</span> or <span class="token class-name">LFU</span> cache<span class="token punctuation">,</span> or <span class="token keyword">to</span>
 
# set a hard memory limit <span class="token keyword">for</span> an instance <span class="token punctuation">(</span>using the 'noeviction' policy<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token constant">WARNING</span><span class="token operator">:</span> <span class="token class-name">If</span> you have replicas attached <span class="token keyword">to</span> <span class="token namespace">an</span> instance <span class="token keyword">with</span> <span class="token namespace">maxmemory</span> on<span class="token punctuation">,</span>
 
# the size of the output buffers needed <span class="token keyword">to</span> <span class="token namespace">feed</span> the replicas are subtracted
 
# from the used memory count<span class="token punctuation">,</span> so that network problems <span class="token operator">/</span> resyncs will
 
# not trigger a loop where keys are evicted<span class="token punctuation">,</span> and in turn the output
 
# buffer of replicas is full <span class="token keyword">with</span> <span class="token class-name">DELs</span> of keys evicted triggering the deletion
 
# of more keys<span class="token punctuation">,</span> and so forth until the database is completely emptied<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">In</span> <span class="token keyword">short</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">if</span> you have replicas attached it is suggested that you set a lower
 
# limit <span class="token keyword">for</span> maxmemory so that there is some free <span class="token constant">RAM</span> on the system <span class="token keyword">for</span> replica
 
# output buffers <span class="token punctuation">(</span>but <span class="token keyword">this</span> is not needed <span class="token keyword">if</span> the policy is 'noeviction'<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# maxmemory <span class="token generics"><span class="token punctuation">&lt;</span>bytes<span class="token punctuation">&gt;</span></span>
 
 
 
# <span class="token constant">MAXMEMORY</span> <span class="token constant">POLICY</span><span class="token operator">:</span> how <span class="token class-name">Redis</span> will select what <span class="token keyword">to</span> <span class="token namespace">remove</span> when maxmemory
 
# is <span class="token class-name"><span class="token namespace">reached<span class="token punctuation">.</span></span> You</span> can select among five behaviors<span class="token operator">:</span>
 
#
 
# <span class="token keyword">volatile</span><span class="token operator">-</span>lru <span class="token operator">-&gt;</span> <span class="token class-name">Evict</span> using approximated <span class="token constant">LRU</span> among the keys <span class="token keyword">with</span> <span class="token namespace">an</span> expire set<span class="token punctuation">.</span>
 
# allkeys<span class="token operator">-</span>lru <span class="token operator">-&gt;</span> <span class="token class-name">Evict</span> any key using approximated <span class="token constant">LRU</span><span class="token punctuation">.</span>
 
# <span class="token keyword">volatile</span><span class="token operator">-</span>lfu <span class="token operator">-&gt;</span> <span class="token class-name">Evict</span> using approximated <span class="token constant">LFU</span> among the keys <span class="token keyword">with</span> <span class="token namespace">an</span> expire set<span class="token punctuation">.</span>
 
# allkeys<span class="token operator">-</span>lfu <span class="token operator">-&gt;</span> <span class="token class-name">Evict</span> any key using approximated <span class="token constant">LFU</span><span class="token punctuation">.</span>
 
# <span class="token keyword">volatile</span><span class="token operator">-</span>random <span class="token operator">-&gt;</span> <span class="token class-name">Remove</span> a random key among the ones <span class="token keyword">with</span> <span class="token namespace">an</span> expire set<span class="token punctuation">.</span>
 
# allkeys<span class="token operator">-</span>random <span class="token operator">-&gt;</span> <span class="token class-name">Remove</span> a random key<span class="token punctuation">,</span> any key<span class="token punctuation">.</span>
 
# <span class="token keyword">volatile</span><span class="token operator">-</span>ttl <span class="token operator">-&gt;</span> <span class="token class-name">Remove</span> the key <span class="token keyword">with</span> <span class="token namespace">the</span> nearest expire time <span class="token punctuation">(</span>minor <span class="token constant">TTL</span><span class="token punctuation">)</span>
 
# noeviction <span class="token operator">-&gt;</span> <span class="token class-name">Don</span>'t evict anything<span class="token punctuation">,</span> just <span class="token keyword">return</span> an error on write operations<span class="token punctuation">.</span>
 
#
 
# <span class="token constant">LRU</span> means <span class="token class-name">Least</span> <span class="token class-name">Recently</span> <span class="token class-name">Used</span>
 
# <span class="token constant">LFU</span> means <span class="token class-name">Least</span> <span class="token class-name">Frequently</span> <span class="token class-name">Used</span>
 
#
 
# <span class="token class-name">Both</span> <span class="token constant">LRU</span><span class="token punctuation">,</span> <span class="token constant">LFU</span> and <span class="token keyword">volatile</span><span class="token operator">-</span>ttl are implemented using approximated
 
# randomized algorithms<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Note</span><span class="token operator">:</span> <span class="token keyword">with</span> <span class="token namespace">any</span> of the above policies<span class="token punctuation">,</span> <span class="token class-name">Redis</span> will <span class="token keyword">return</span> an error on write
 
#       operations<span class="token punctuation">,</span> when there are no suitable keys <span class="token keyword">for</span> eviction<span class="token punctuation">.</span>
 
#
 
#       <span class="token class-name">At</span> the date of writing these commands are<span class="token operator">:</span> set setnx setex append
 
#       incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd
 
#       sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby
 
#       zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby
 
#       getset mset msetnx exec sort
 
#
 
# <span class="token class-name">The</span> <span class="token keyword">default</span> is<span class="token operator">:</span>
 
#
 
# maxmemory<span class="token operator">-</span>policy noeviction
 
 
 
# <span class="token constant">LRU</span><span class="token punctuation">,</span> <span class="token constant">LFU</span> and minimal <span class="token constant">TTL</span> algorithms are not precise algorithms but approximated
 
# algorithms <span class="token punctuation">(</span>in order <span class="token keyword">to</span> <span class="token namespace">save</span> memory<span class="token punctuation">)</span><span class="token punctuation">,</span> so you can tune it <span class="token keyword">for</span> speed or
 
# <span class="token class-name"><span class="token namespace">accuracy<span class="token punctuation">.</span></span> For</span> <span class="token keyword">default</span> <span class="token class-name">Redis</span> will check five keys and pick the one that was
 
# used less recently<span class="token punctuation">,</span> you can change the sample size using the following
 
# configuration directive<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> <span class="token keyword">default</span> of <span class="token number">5</span> produces good enough results<span class="token punctuation">.</span> <span class="token number">10</span> <span class="token class-name">Approximates</span> very closely
 
# <span class="token boolean">true</span> <span class="token constant">LRU</span> but costs more <span class="token constant">CPU</span><span class="token punctuation">.</span> <span class="token number">3</span> is faster but not very accurate<span class="token punctuation">.</span>
 
#
 
# maxmemory<span class="token operator">-</span>samples <span class="token number">5</span>
 
 
 
# <span class="token class-name">Starting</span> from <span class="token class-name">Redis</span> <span class="token number">5</span><span class="token punctuation">,</span> by <span class="token keyword">default</span> a replica will ignore its maxmemory setting
 
# <span class="token punctuation">(</span>unless it is promoted <span class="token keyword">to</span> <span class="token namespace">master</span> after a failover or manually<span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token class-name">It</span> means
 
# that the eviction of keys will be just handled by the master<span class="token punctuation">,</span> sending the
 
# <span class="token constant">DEL</span> commands <span class="token keyword">to</span> <span class="token namespace">the</span> replica as keys evict in the master side<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">This</span> behavior ensures that masters and replicas stay consistent<span class="token punctuation">,</span> and is usually
 
# what you want<span class="token punctuation">,</span> however <span class="token keyword">if</span> your replica is writable<span class="token punctuation">,</span> or you want the replica <span class="token keyword">to</span> <span class="token namespace">have</span>
 
# a different memory setting<span class="token punctuation">,</span> and you are sure all the writes performed <span class="token keyword">to</span> <span class="token namespace">the</span>
 
# replica are idempotent<span class="token punctuation">,</span> then you may change <span class="token keyword">this</span> <span class="token keyword">default</span> <span class="token punctuation">(</span>but be sure <span class="token keyword">to</span> <span class="token namespace">understand</span>
 
# what you are doing<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Note</span> that since the replica by <span class="token keyword">default</span> does not evict<span class="token punctuation">,</span> it may end using more
 
# memory than the one set via maxmemory <span class="token punctuation">(</span>there are certain buffers that may
 
# be larger on the replica<span class="token punctuation">,</span> or data structures may sometimes take more memory and so
 
# forth<span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token class-name">So</span> make sure you monitor your replicas and make sure they have enough
 
# memory <span class="token keyword">to</span> <span class="token namespace">never</span> hit a real out<span class="token operator">-</span>of<span class="token operator">-</span>memory condition before the master hits
 
# the configured maxmemory setting<span class="token punctuation">.</span>
 
#
 
# replica<span class="token operator">-</span>ignore<span class="token operator">-</span>maxmemory yes
 
 
 
############################# <span class="token constant">LAZY</span> <span class="token constant">FREEING</span> ####################################
 
 
 
# <span class="token class-name">Redis</span> has two primitives <span class="token keyword">to</span> <span class="token namespace">delete</span> <span class="token class-name"><span class="token namespace">keys<span class="token punctuation">.</span></span> One</span> is called <span class="token constant">DEL</span> and is a blocking
 
# deletion of the <span class="token class-name"><span class="token namespace">object<span class="token punctuation">.</span></span> It</span> means that the server stops processing <span class="token keyword">new</span> commands
 
# in order <span class="token keyword">to</span> <span class="token namespace">reclaim</span> all the memory associated <span class="token keyword">with</span> <span class="token namespace">an</span> object in a synchronous
 
# <span class="token class-name"><span class="token namespace">way<span class="token punctuation">.</span></span> If</span> the key deleted is associated <span class="token keyword">with</span> <span class="token namespace">a</span> small object<span class="token punctuation">,</span> the time needed
 
# in order <span class="token keyword">to</span> <span class="token namespace">execute</span> the <span class="token constant">DEL</span> command is very small and comparable <span class="token keyword">to</span> <span class="token namespace">most</span> other
 
# <span class="token class-name">O</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> or <span class="token class-name">O</span><span class="token punctuation">(</span>log_N<span class="token punctuation">)</span> commands in <span class="token class-name">Redis<span class="token punctuation">.</span> However</span> <span class="token keyword">if</span> the key is associated <span class="token keyword">with</span> <span class="token namespace">an</span>
 
# aggregated value containing millions of elements<span class="token punctuation">,</span> the server can block <span class="token keyword">for</span>
 
# a <span class="token keyword">long</span> time <span class="token punctuation">(</span>even seconds<span class="token punctuation">)</span> in order <span class="token keyword">to</span> <span class="token namespace">complete</span> the operation<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">For</span> the above reasons <span class="token class-name">Redis</span> also offers non blocking deletion primitives
 
# such as <span class="token constant">UNLINK</span> <span class="token punctuation">(</span>non blocking <span class="token constant">DEL</span><span class="token punctuation">)</span> and the <span class="token constant">ASYNC</span> option of <span class="token constant">FLUSHALL</span> and
 
# <span class="token class-name">FLUSHDB</span> commands<span class="token punctuation">,</span> in order <span class="token keyword">to</span> <span class="token namespace">reclaim</span> memory in <span class="token class-name"><span class="token namespace">background<span class="token punctuation">.</span></span> Those</span> commands
 
# are executed in constant <span class="token class-name"><span class="token namespace">time<span class="token punctuation">.</span></span> Another</span> thread will incrementally free the
 
# object in the background as fast as possible<span class="token punctuation">.</span>
 
#
 
# <span class="token constant">DEL</span><span class="token punctuation">,</span> <span class="token constant">UNLINK</span> and <span class="token constant">ASYNC</span> option of <span class="token constant">FLUSHALL</span> and <span class="token constant">FLUSHDB</span> are user<span class="token operator">-</span>controlled<span class="token punctuation">.</span>
 
# <span class="token class-name">It</span>'s up <span class="token keyword">to</span> <span class="token namespace">the</span> design of the application <span class="token keyword">to</span> <span class="token namespace">understand</span> when it is a good
 
# idea <span class="token keyword">to</span> <span class="token namespace">use</span> one or the <span class="token class-name"><span class="token namespace">other<span class="token punctuation">.</span></span> However</span> the <span class="token class-name">Redis</span> server sometimes has <span class="token keyword">to</span>
 
# delete keys or flush the whole database as a side effect of other operations<span class="token punctuation">.</span>
 
# <span class="token class-name">Specifically</span> <span class="token class-name">Redis</span> deletes objects independently of a user call in the
 
# following scenarios<span class="token operator">:</span>
 
#
 
# <span class="token number">1</span><span class="token punctuation">)</span> <span class="token class-name">On</span> eviction<span class="token punctuation">,</span> because of the maxmemory and maxmemory policy configurations<span class="token punctuation">,</span>
 
#    in order <span class="token keyword">to</span> <span class="token namespace">make</span> room <span class="token keyword">for</span> <span class="token keyword">new</span> data<span class="token punctuation">,</span> without going over the specified
 
#    memory limit<span class="token punctuation">.</span>
 
# <span class="token number">2</span><span class="token punctuation">)</span> <span class="token class-name">Because</span> of expire<span class="token operator">:</span> when a key <span class="token keyword">with</span> <span class="token namespace">an</span> associated time <span class="token keyword">to</span> <span class="token namespace">live</span> <span class="token punctuation">(</span>see the
 
#    <span class="token class-name">EXPIRE</span> command<span class="token punctuation">)</span> must be deleted from memory<span class="token punctuation">.</span>
 
# <span class="token number">3</span><span class="token punctuation">)</span> <span class="token class-name">Because</span> of a side effect of a command that stores data on a key that may
 
#    already <span class="token class-name"><span class="token namespace">exist<span class="token punctuation">.</span></span> For</span> example the <span class="token constant">RENAME</span> command may delete the old key
 
#    content when it is replaced <span class="token keyword">with</span> <span class="token namespace">another</span> <span class="token class-name"><span class="token namespace">one<span class="token punctuation">.</span></span> Similarly</span> <span class="token constant">SUNIONSTORE</span>
 
#    or <span class="token constant">SORT</span> <span class="token keyword">with</span> <span class="token constant">STORE</span> option may delete existing <span class="token class-name"><span class="token namespace">keys<span class="token punctuation">.</span></span> The</span> <span class="token constant">SET</span> command
 
#    itself removes any old content of the specified key in order <span class="token keyword">to</span> <span class="token namespace">replace</span>
 
#    it <span class="token keyword">with</span> <span class="token namespace">the</span> specified string<span class="token punctuation">.</span>
 
# <span class="token number">4</span><span class="token punctuation">)</span> <span class="token class-name">During</span> replication<span class="token punctuation">,</span> when a replica performs a full resynchronization <span class="token keyword">with</span>
 
#    its master<span class="token punctuation">,</span> the content of the whole database is removed in order <span class="token keyword">to</span>
 
#    load the <span class="token constant">RDB</span> file just transferred<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">In</span> all the above cases the <span class="token keyword">default</span> is <span class="token keyword">to</span> <span class="token namespace">delete</span> objects in a blocking way<span class="token punctuation">,</span>
 
# like <span class="token keyword">if</span> <span class="token constant">DEL</span> was <span class="token class-name"><span class="token namespace">called<span class="token punctuation">.</span></span> However</span> you can configure each <span class="token keyword">case</span> specifically
 
# in order <span class="token keyword">to</span> <span class="token namespace">instead</span> release memory in a non<span class="token operator">-</span>blocking way like <span class="token keyword">if</span> <span class="token constant">UNLINK</span>
 
# was called<span class="token punctuation">,</span> using the following configuration directives<span class="token operator">:</span>
 
 
 
lazyfree<span class="token operator">-</span>lazy<span class="token operator">-</span>eviction no
 
lazyfree<span class="token operator">-</span>lazy<span class="token operator">-</span>expire no
 
lazyfree<span class="token operator">-</span>lazy<span class="token operator">-</span>server<span class="token operator">-</span>del no
 
replica<span class="token operator">-</span>lazy<span class="token operator">-</span>flush no
 
 
 
############################## <span class="token constant">APPEND</span> <span class="token constant">ONLY</span> <span class="token constant">MODE</span> ###############################
 
 
 
# <span class="token class-name">By</span> <span class="token keyword">default</span> <span class="token class-name">Redis</span> asynchronously dumps the dataset on <span class="token class-name"><span class="token namespace">disk<span class="token punctuation">.</span></span> This</span> mode is
 
# good enough in many applications<span class="token punctuation">,</span> but an issue <span class="token keyword">with</span> <span class="token namespace">the</span> <span class="token class-name">Redis</span> process or
 
# a power outage may result into a few minutes of writes lost <span class="token punctuation">(</span>depending on
 
# the configured save points<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> <span class="token class-name">Append</span> <span class="token class-name">Only</span> <span class="token class-name">File</span> is an alternative persistence mode that <span class="token keyword">provides</span>
 
# much better <span class="token class-name"><span class="token namespace">durability<span class="token punctuation">.</span></span> For</span> instance using the <span class="token keyword">default</span> data fsync policy
 
# <span class="token punctuation">(</span>see later in the config file<span class="token punctuation">)</span> <span class="token class-name">Redis</span> can lose just one second of writes in a
 
# dramatic event like a server power outage<span class="token punctuation">,</span> or a single write <span class="token keyword">if</span> something
 
# wrong <span class="token keyword">with</span> <span class="token namespace">the</span> <span class="token class-name">Redis</span> process itself happens<span class="token punctuation">,</span> but the operating system is
 
# still running correctly<span class="token punctuation">.</span>
 
#
 
# <span class="token constant">AOF</span> and <span class="token constant">RDB</span> persistence can be enabled at the same time without problems<span class="token punctuation">.</span>
 
# <span class="token class-name">If</span> the <span class="token constant">AOF</span> is enabled on startup <span class="token class-name">Redis</span> will load the <span class="token constant">AOF</span><span class="token punctuation">,</span> that is the file
 
# <span class="token keyword">with</span> <span class="token namespace">the</span> better durability guarantees<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Please</span> check http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>redis<span class="token punctuation">.</span>io<span class="token operator">/</span>topics<span class="token operator">/</span>persistence <span class="token keyword">for</span> more information<span class="token punctuation">.</span>
 
 
 
appendonly no
 
 
 
# <span class="token class-name">The</span> name of the append only file <span class="token punctuation">(</span><span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">"appendonly.aof"</span><span class="token punctuation">)</span>
 
 
 
appendfilename <span class="token string">"appendonly.aof"</span>
 
 
 
# <span class="token class-name">The</span> <span class="token function">fsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span> call tells the <span class="token class-name">Operating</span> <span class="token class-name">System</span> <span class="token keyword">to</span> <span class="token namespace">actually</span> write data on disk
 
# instead of waiting <span class="token keyword">for</span> more data in the output <span class="token class-name"><span class="token namespace">buffer<span class="token punctuation">.</span></span> Some</span> <span class="token constant">OS</span> will really flush
 
# data on disk<span class="token punctuation">,</span> some other <span class="token constant">OS</span> will just <span class="token keyword">try</span> <span class="token keyword">to</span> <span class="token keyword">do</span> it <span class="token constant">ASAP</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Redis</span> supports three different modes<span class="token operator">:</span>
 
#
 
# no<span class="token operator">:</span> don't fsync<span class="token punctuation">,</span> just let the <span class="token constant">OS</span> flush the data when it <span class="token class-name"><span class="token namespace">wants<span class="token punctuation">.</span></span> Faster</span><span class="token punctuation">.</span>
 
# always<span class="token operator">:</span> fsync after every write <span class="token keyword">to</span> <span class="token namespace">the</span> append only <span class="token class-name"><span class="token namespace">log<span class="token punctuation">.</span></span> Slow</span><span class="token punctuation">,</span> <span class="token class-name">Safest</span><span class="token punctuation">.</span>
 
# everysec<span class="token operator">:</span> fsync only one time every <span class="token class-name"><span class="token namespace">second<span class="token punctuation">.</span></span> Compromise</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> <span class="token keyword">default</span> is <span class="token string">"everysec"</span><span class="token punctuation">,</span> as that's usually the right compromise between
 
# speed and data <span class="token class-name"><span class="token namespace">safety<span class="token punctuation">.</span></span> It</span>'s up <span class="token keyword">to</span> <span class="token namespace">you</span> <span class="token keyword">to</span> <span class="token namespace">understand</span> <span class="token keyword">if</span> you can relax <span class="token keyword">this</span> <span class="token keyword">to</span>
 
# <span class="token string">"no"</span> that will let the operating system flush the output buffer when
 
# it wants<span class="token punctuation">,</span> <span class="token keyword">for</span> better performances <span class="token punctuation">(</span>but <span class="token keyword">if</span> you can live <span class="token keyword">with</span> <span class="token namespace">the</span> idea of
 
# some data loss consider the <span class="token keyword">default</span> persistence mode that's snapshotting<span class="token punctuation">)</span><span class="token punctuation">,</span>
 
# or on the contrary<span class="token punctuation">,</span> use <span class="token string">"always"</span> that's very slow but a bit safer than
 
# everysec<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">More</span> details please check the following article<span class="token operator">:</span>
 
# http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>antirez<span class="token punctuation">.</span>com<span class="token operator">/</span>post<span class="token operator">/</span>redis<span class="token operator">-</span>persistence<span class="token operator">-</span>demystified<span class="token punctuation">.</span>html
 
#
 
# <span class="token class-name">If</span> unsure<span class="token punctuation">,</span> use <span class="token string">"everysec"</span><span class="token punctuation">.</span>
 
 
 
# appendfsync always
 
appendfsync everysec
 
# appendfsync no
 
 
 
# <span class="token class-name">When</span> the <span class="token constant">AOF</span> fsync policy is set <span class="token keyword">to</span> <span class="token namespace">always</span> or everysec<span class="token punctuation">,</span> and a background
 
# saving process <span class="token punctuation">(</span>a background save or <span class="token constant">AOF</span> log background rewriting<span class="token punctuation">)</span> is
 
# performing a lot of <span class="token class-name">I</span><span class="token operator">/</span><span class="token class-name">O</span> against the disk<span class="token punctuation">,</span> in some <span class="token class-name">Linux</span> configurations
 
# <span class="token class-name">Redis</span> may block too <span class="token keyword">long</span> on the <span class="token function">fsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token namespace">call<span class="token punctuation">.</span></span> Note</span> that there is no fix <span class="token keyword">for</span>
 
# <span class="token keyword">this</span> currently<span class="token punctuation">,</span> as even performing fsync in a different thread will block
 
# our synchronous <span class="token function">write</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> call<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">In</span> order <span class="token keyword">to</span> <span class="token namespace">mitigate</span> <span class="token keyword">this</span> problem it's possible <span class="token keyword">to</span> <span class="token namespace">use</span> the following option
 
# that will prevent <span class="token function">fsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span> from being called in the main process <span class="token keyword">while</span> a
 
# <span class="token constant">BGSAVE</span> or <span class="token constant">BGREWRITEAOF</span> is in progress<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">This</span> means that <span class="token keyword">while</span> another child is saving<span class="token punctuation">,</span> the durability of <span class="token class-name">Redis</span> is
 
# the same as <span class="token string">"appendfsync none"</span><span class="token punctuation">.</span> <span class="token class-name">In</span> practical terms<span class="token punctuation">,</span> <span class="token keyword">this</span> means that it is
 
# possible <span class="token keyword">to</span> <span class="token namespace">lose</span> up <span class="token keyword">to</span> <span class="token number">30</span> seconds of log in the worst scenario <span class="token punctuation">(</span><span class="token keyword">with</span> <span class="token namespace">the</span>
 
# <span class="token keyword">default</span> <span class="token class-name">Linux</span> settings<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">If</span> you have latency problems turn <span class="token keyword">this</span> <span class="token keyword">to</span> <span class="token string">"yes"</span><span class="token punctuation">.</span> <span class="token class-name">Otherwise</span> leave it as
 
# <span class="token string">"no"</span> that is the safest pick from the point of view of durability<span class="token punctuation">.</span>
 
 
 
no<span class="token operator">-</span>appendfsync<span class="token operator">-</span>on<span class="token operator">-</span>rewrite no
 
 
 
# <span class="token class-name">Automatic</span> rewrite of the append only file<span class="token punctuation">.</span>
 
# <span class="token class-name">Redis</span> is able <span class="token keyword">to</span> <span class="token namespace">automatically</span> rewrite the log file implicitly calling
 
# <span class="token constant">BGREWRITEAOF</span> when the <span class="token constant">AOF</span> log size grows by the specified percentage<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">This</span> is how it works<span class="token operator">:</span> <span class="token class-name">Redis</span> remembers the size of the <span class="token constant">AOF</span> file after the
 
# latest rewrite <span class="token punctuation">(</span><span class="token keyword">if</span> no rewrite has happened since the restart<span class="token punctuation">,</span> the size of
 
# the <span class="token constant">AOF</span> at startup is used<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">This</span> base size is compared <span class="token keyword">to</span> <span class="token namespace">the</span> current <span class="token class-name"><span class="token namespace">size<span class="token punctuation">.</span></span> If</span> the current size is
 
# bigger than the specified percentage<span class="token punctuation">,</span> the rewrite is <span class="token class-name"><span class="token namespace">triggered<span class="token punctuation">.</span></span> Also</span>
 
# you need <span class="token keyword">to</span> <span class="token namespace">specify</span> a minimal size <span class="token keyword">for</span> the <span class="token constant">AOF</span> file <span class="token keyword">to</span> <span class="token namespace">be</span> rewritten<span class="token punctuation">,</span> <span class="token keyword">this</span>
 
# is useful <span class="token keyword">to</span> <span class="token namespace">avoid</span> rewriting the <span class="token constant">AOF</span> file even <span class="token keyword">if</span> the percentage increase
 
# is reached but it is still pretty small<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Specify</span> a percentage of zero in order <span class="token keyword">to</span> <span class="token namespace">disable</span> the automatic <span class="token constant">AOF</span>
 
# rewrite feature<span class="token punctuation">.</span>
 
 
 
auto<span class="token operator">-</span>aof<span class="token operator">-</span>rewrite<span class="token operator">-</span>percentage <span class="token number">100</span>
 
auto<span class="token operator">-</span>aof<span class="token operator">-</span>rewrite<span class="token operator">-</span>min<span class="token operator">-</span>size <span class="token number">64</span>mb
 
 
 
# <span class="token class-name">An</span> <span class="token constant">AOF</span> file may be found <span class="token keyword">to</span> <span class="token namespace">be</span> truncated at the end during the <span class="token class-name">Redis</span>
 
# startup process<span class="token punctuation">,</span> when the <span class="token constant">AOF</span> data gets loaded back into memory<span class="token punctuation">.</span>
 
# <span class="token class-name">This</span> may happen when the system where <span class="token class-name">Redis</span> is running
 
# crashes<span class="token punctuation">,</span> especially when an ext4 filesystem is mounted without the
 
# data<span class="token operator">=</span>ordered option <span class="token punctuation">(</span>however <span class="token keyword">this</span> can't happen when <span class="token class-name">Redis</span> itself
 
# crashes or aborts but the operating system still works correctly<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Redis</span> can either exit <span class="token keyword">with</span> <span class="token namespace">an</span> error when <span class="token keyword">this</span> happens<span class="token punctuation">,</span> or load as much
 
# data as possible <span class="token punctuation">(</span>the <span class="token keyword">default</span> now<span class="token punctuation">)</span> and start <span class="token keyword">if</span> the <span class="token constant">AOF</span> file is found
 
# <span class="token keyword">to</span> <span class="token namespace">be</span> truncated at the <span class="token class-name"><span class="token namespace">end<span class="token punctuation">.</span></span> The</span> following option controls <span class="token keyword">this</span> behavior<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">If</span> aof<span class="token operator">-</span>load<span class="token operator">-</span>truncated is set <span class="token keyword">to</span> <span class="token namespace">yes</span><span class="token punctuation">,</span> a truncated <span class="token constant">AOF</span> file is loaded and
 
# the <span class="token class-name">Redis</span> server starts emitting a log <span class="token keyword">to</span> <span class="token namespace">inform</span> the user of the event<span class="token punctuation">.</span>
 
# <span class="token class-name">Otherwise</span> <span class="token keyword">if</span> the option is set <span class="token keyword">to</span> <span class="token namespace">no</span><span class="token punctuation">,</span> the server aborts <span class="token keyword">with</span> <span class="token namespace">an</span> error
 
# and refuses <span class="token keyword">to</span> <span class="token namespace">start<span class="token punctuation">.</span></span> <span class="token class-name">When</span> the option is set <span class="token keyword">to</span> <span class="token namespace">no</span><span class="token punctuation">,</span> the user <span class="token keyword">requires</span>
 
# <span class="token keyword">to</span> <span class="token namespace">fix</span> the <span class="token constant">AOF</span> file using the <span class="token string">"redis-check-aof"</span> utility before <span class="token keyword">to</span> <span class="token namespace">restart</span>
 
# the server<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Note</span> that <span class="token keyword">if</span> the <span class="token constant">AOF</span> file will be found <span class="token keyword">to</span> <span class="token namespace">be</span> corrupted in the middle
 
# the server will still exit <span class="token keyword">with</span> <span class="token namespace">an</span> <span class="token class-name"><span class="token namespace">error<span class="token punctuation">.</span></span> This</span> option only applies when
 
# <span class="token class-name">Redis</span> will <span class="token keyword">try</span> <span class="token keyword">to</span> <span class="token namespace">read</span> more data from the <span class="token constant">AOF</span> file but not enough bytes
 
# will be found<span class="token punctuation">.</span>
 
aof<span class="token operator">-</span>load<span class="token operator">-</span>truncated yes
 
 
 
# <span class="token class-name">When</span> rewriting the <span class="token class-name">AOF</span> file<span class="token punctuation">,</span> <span class="token class-name">Redis</span> is able <span class="token keyword">to</span> <span class="token namespace">use</span> an <span class="token constant">RDB</span> preamble in the
 
# <span class="token constant">AOF</span> file <span class="token keyword">for</span> faster rewrites and <span class="token class-name"><span class="token namespace">recoveries<span class="token punctuation">.</span></span> When</span> <span class="token keyword">this</span> option is turned
 
# on the rewritten <span class="token constant">AOF</span> file is composed of two different stanzas<span class="token operator">:</span>
 
#
 
#   <span class="token punctuation">[</span><span class="token constant">RDB</span> file<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token constant">AOF</span> tail<span class="token punctuation">]</span>
 
#
 
# <span class="token class-name">When</span> loading <span class="token class-name">Redis</span> recognizes that the <span class="token constant">AOF</span> file starts <span class="token keyword">with</span> <span class="token namespace">the</span> <span class="token string">"REDIS"</span>
 
# string and loads the prefixed <span class="token class-name">RDB</span> file<span class="token punctuation">,</span> and continues loading the <span class="token constant">AOF</span>
 
# tail<span class="token punctuation">.</span>
 
aof<span class="token operator">-</span>use<span class="token operator">-</span>rdb<span class="token operator">-</span>preamble yes
 
 
 
################################ <span class="token constant">LUA</span> <span class="token constant">SCRIPTING</span>  ###############################
 
 
 
# <span class="token class-name">Max</span> execution time of a <span class="token class-name">Lua</span> script in milliseconds<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">If</span> the maximum execution time is reached <span class="token class-name">Redis</span> will log that a script is
 
# still in execution after the maximum allowed time and will start <span class="token keyword">to</span>
 
# reply <span class="token keyword">to</span> <span class="token namespace">queries</span> <span class="token keyword">with</span> <span class="token namespace">an</span> error<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">When</span> a <span class="token keyword">long</span> running script exceeds the maximum execution time only the
 
# <span class="token constant">SCRIPT</span> <span class="token constant">KILL</span> and <span class="token constant">SHUTDOWN</span> <span class="token constant">NOSAVE</span> commands are <span class="token class-name"><span class="token namespace">available<span class="token punctuation">.</span></span> The</span> first can be
 
# used <span class="token keyword">to</span> <span class="token namespace">stop</span> a script that did not yet called write <span class="token class-name"><span class="token namespace">commands<span class="token punctuation">.</span></span> The</span> second
 
# is the only way <span class="token keyword">to</span> <span class="token namespace">shut</span> down the server in the <span class="token keyword">case</span> a write command was
 
# already issued by the script but the user doesn't want <span class="token keyword">to</span> <span class="token namespace">wait</span> <span class="token keyword">for</span> the natural
 
# termination of the script<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Set</span> it <span class="token keyword">to</span> <span class="token number">0</span> or a negative value <span class="token keyword">for</span> unlimited execution without warnings<span class="token punctuation">.</span>
 
lua<span class="token operator">-</span>time<span class="token operator">-</span>limit <span class="token number">5000</span>
 
 
 
################################ <span class="token constant">REDIS</span> <span class="token constant">CLUSTER</span>  ###############################
 
 
 
# <span class="token class-name">Normal</span> <span class="token class-name">Redis</span> instances can't be part of a <span class="token class-name">Redis</span> <span class="token class-name">Cluster</span><span class="token punctuation">;</span> only nodes that are
 
# started as cluster nodes <span class="token class-name"><span class="token namespace">can<span class="token punctuation">.</span></span> In</span> order <span class="token keyword">to</span> <span class="token namespace">start</span> a <span class="token class-name">Redis</span> instance as a
 
# cluster node enable the cluster support uncommenting the following<span class="token operator">:</span>
 
#
 
# cluster<span class="token operator">-</span>enabled yes
 
 
 
# <span class="token class-name">Every</span> cluster node has a cluster configuration <span class="token class-name"><span class="token namespace">file<span class="token punctuation">.</span></span> This</span> file is not
 
# intended <span class="token keyword">to</span> <span class="token namespace">be</span> edited by <span class="token class-name"><span class="token namespace">hand<span class="token punctuation">.</span></span> It</span> is created and updated by <span class="token class-name">Redis</span> nodes<span class="token punctuation">.</span>
 
# <span class="token class-name">Every</span> <span class="token class-name">Redis</span> <span class="token class-name">Cluster</span> node <span class="token keyword">requires</span> <span class="token namespace">a</span> different cluster configuration file<span class="token punctuation">.</span>
 
# <span class="token class-name">Make</span> sure that instances running in the same system <span class="token keyword">do</span> not have
 
# overlapping cluster configuration file names<span class="token punctuation">.</span>
 
#
 
# cluster<span class="token operator">-</span>config<span class="token operator">-</span>file nodes<span class="token operator">-</span><span class="token number">6379.</span>conf
 
 
 
# <span class="token class-name">Cluster</span> node timeout is the amount of milliseconds a node must be unreachable
 
# <span class="token keyword">for</span> it <span class="token keyword">to</span> <span class="token namespace">be</span> considered in failure state<span class="token punctuation">.</span>
 
# <span class="token class-name">Most</span> other internal time limits are multiple of the node timeout<span class="token punctuation">.</span>
 
#
 
# cluster<span class="token operator">-</span>node<span class="token operator">-</span>timeout <span class="token number">15000</span>
 
 
 
# <span class="token class-name">A</span> replica of a failing master will avoid <span class="token keyword">to</span> <span class="token namespace">start</span> a failover <span class="token keyword">if</span> its data
 
# looks too old<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">There</span> is no simple way <span class="token keyword">for</span> a replica <span class="token keyword">to</span> <span class="token namespace">actually</span> have an exact measure of
 
# its <span class="token string">"data age"</span><span class="token punctuation">,</span> so the following two checks are performed<span class="token operator">:</span>
 
#
 
# <span class="token number">1</span><span class="token punctuation">)</span> <span class="token class-name">If</span> there are multiple replicas able <span class="token keyword">to</span> <span class="token namespace">failover</span><span class="token punctuation">,</span> they exchange messages
 
#    in order <span class="token keyword">to</span> <span class="token keyword">try</span> <span class="token keyword">to</span> <span class="token namespace">give</span> an advantage <span class="token keyword">to</span> <span class="token namespace">the</span> replica <span class="token keyword">with</span> <span class="token namespace">the</span> best
 
#    replication offset <span class="token punctuation">(</span>more data from the master processed<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#    <span class="token class-name">Replicas</span> will <span class="token keyword">try</span> <span class="token keyword">to</span> <span class="token namespace">get</span> their rank by offset<span class="token punctuation">,</span> and apply <span class="token keyword">to</span> <span class="token namespace">the</span> start
 
#    of the failover a delay proportional <span class="token keyword">to</span> <span class="token namespace">their</span> rank<span class="token punctuation">.</span>
 
#
 
# <span class="token number">2</span><span class="token punctuation">)</span> <span class="token class-name">Every</span> single replica computes the time of the last interaction <span class="token keyword">with</span>
 
#    its <span class="token class-name"><span class="token namespace">master<span class="token punctuation">.</span></span> This</span> can be the last ping or command received <span class="token punctuation">(</span><span class="token keyword">if</span> the master
 
#    is still in the <span class="token string">"connected"</span> state<span class="token punctuation">)</span><span class="token punctuation">,</span> or the time that elapsed since the
 
#    disconnection <span class="token keyword">with</span> <span class="token namespace">the</span> master <span class="token punctuation">(</span><span class="token keyword">if</span> the replication link is currently down<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#    <span class="token class-name">If</span> the last interaction is too old<span class="token punctuation">,</span> the replica will not <span class="token keyword">try</span> <span class="token keyword">to</span> <span class="token namespace">failover</span>
 
#    at all<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> point <span class="token string">"2"</span> can be tuned by <span class="token class-name"><span class="token namespace">user<span class="token punctuation">.</span></span> Specifically</span> a replica will not perform
 
# the failover <span class="token keyword">if</span><span class="token punctuation">,</span> since the last interaction <span class="token keyword">with</span> <span class="token namespace">the</span> master<span class="token punctuation">,</span> the time
 
# elapsed is greater than<span class="token operator">:</span>
 
#
 
#   <span class="token punctuation">(</span>node<span class="token operator">-</span>timeout <span class="token operator">*</span> replica<span class="token operator">-</span>validity<span class="token operator">-</span>factor<span class="token punctuation">)</span> <span class="token operator">+</span> repl<span class="token operator">-</span>ping<span class="token operator">-</span>replica<span class="token operator">-</span>period
 
#
 
# <span class="token class-name">So</span> <span class="token keyword">for</span> example <span class="token keyword">if</span> node<span class="token operator">-</span>timeout is <span class="token number">30</span> seconds<span class="token punctuation">,</span> and the replica<span class="token operator">-</span>validity<span class="token operator">-</span>factor
 
# is <span class="token number">10</span><span class="token punctuation">,</span> and assuming a <span class="token keyword">default</span> repl<span class="token operator">-</span>ping<span class="token operator">-</span>replica<span class="token operator">-</span>period of <span class="token number">10</span> seconds<span class="token punctuation">,</span> the
 
# replica will not <span class="token keyword">try</span> <span class="token keyword">to</span> <span class="token namespace">failover</span> <span class="token keyword">if</span> it was not able <span class="token keyword">to</span> <span class="token namespace">talk</span> <span class="token keyword">with</span> <span class="token namespace">the</span> master
 
# <span class="token keyword">for</span> longer than <span class="token number">310</span> seconds<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">A</span> large replica<span class="token operator">-</span>validity<span class="token operator">-</span>factor may allow replicas <span class="token keyword">with</span> <span class="token namespace">too</span> old data <span class="token keyword">to</span> <span class="token namespace">failover</span>
 
# a master<span class="token punctuation">,</span> <span class="token keyword">while</span> a too small value may prevent the cluster from being able <span class="token keyword">to</span>
 
# elect a replica at all<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">For</span> maximum availability<span class="token punctuation">,</span> it is possible <span class="token keyword">to</span> <span class="token namespace">set</span> the replica<span class="token operator">-</span>validity<span class="token operator">-</span>factor
 
# <span class="token keyword">to</span> <span class="token namespace">a</span> value of <span class="token number">0</span><span class="token punctuation">,</span> which means<span class="token punctuation">,</span> that replicas will always <span class="token keyword">try</span> <span class="token keyword">to</span> <span class="token namespace">failover</span> the
 
# master regardless of the last time they interacted <span class="token keyword">with</span> <span class="token namespace">the</span> master<span class="token punctuation">.</span>
 
# <span class="token punctuation">(</span><span class="token class-name">However</span> they'll always <span class="token keyword">try</span> <span class="token keyword">to</span> <span class="token namespace">apply</span> a delay proportional <span class="token keyword">to</span> <span class="token namespace">their</span>
 
# offset rank<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Zero</span> is the only value able <span class="token keyword">to</span> <span class="token namespace">guarantee</span> that when all the partitions heal
 
# the cluster will always be able <span class="token keyword">to</span> <span class="token keyword">continue</span><span class="token punctuation">.</span>
 
#
 
# cluster<span class="token operator">-</span>replica<span class="token operator">-</span>validity<span class="token operator">-</span>factor <span class="token number">10</span>
 
 
 
# <span class="token class-name">Cluster</span> replicas are able <span class="token keyword">to</span> <span class="token namespace">migrate</span> <span class="token keyword">to</span> <span class="token namespace">orphaned</span> masters<span class="token punctuation">,</span> that are masters
 
# that are left without working <span class="token class-name"><span class="token namespace">replicas<span class="token punctuation">.</span></span> This</span> improves the cluster ability
 
# <span class="token keyword">to</span> <span class="token namespace">resist</span> <span class="token keyword">to</span> <span class="token namespace">failures</span> as otherwise an orphaned master can't be failed over
 
# in <span class="token keyword">case</span> of failure <span class="token keyword">if</span> it has no working replicas<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Replicas</span> migrate <span class="token keyword">to</span> <span class="token namespace">orphaned</span> masters only <span class="token keyword">if</span> there are still at least a
 
# given number of other working replicas <span class="token keyword">for</span> their old <span class="token class-name"><span class="token namespace">master<span class="token punctuation">.</span></span> This</span> number
 
# is the <span class="token string">"migration barrier"</span><span class="token punctuation">.</span> <span class="token class-name">A</span> migration barrier of <span class="token number">1</span> means that a replica
 
# will migrate only <span class="token keyword">if</span> there is at least <span class="token number">1</span> other working replica <span class="token keyword">for</span> its master
 
# and so <span class="token class-name"><span class="token namespace">forth<span class="token punctuation">.</span></span> It</span> usually reflects the number of replicas you want <span class="token keyword">for</span> every
 
# master in your cluster<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Default</span> is <span class="token number">1</span> <span class="token punctuation">(</span>replicas migrate only <span class="token keyword">if</span> their masters remain <span class="token keyword">with</span> <span class="token namespace">at</span> least
 
# one replica<span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token class-name">To</span> disable migration just set it <span class="token keyword">to</span> <span class="token namespace">a</span> very large value<span class="token punctuation">.</span>
 
# <span class="token class-name">A</span> value of <span class="token number">0</span> can be set but is useful only <span class="token keyword">for</span> debugging and dangerous
 
# in production<span class="token punctuation">.</span>
 
#
 
# cluster<span class="token operator">-</span>migration<span class="token operator">-</span>barrier <span class="token number">1</span>
 
 
 
# <span class="token class-name">By</span> <span class="token keyword">default</span> <span class="token class-name">Redis</span> <span class="token class-name">Cluster</span> nodes stop accepting queries <span class="token keyword">if</span> they detect there
 
# is at least an hash slot uncovered <span class="token punctuation">(</span>no available node is serving it<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
# <span class="token class-name">This</span> way <span class="token keyword">if</span> the cluster is partially down <span class="token punctuation">(</span><span class="token keyword">for</span> example a range of hash slots
 
# are no longer covered<span class="token punctuation">)</span> all the cluster becomes<span class="token punctuation">,</span> eventually<span class="token punctuation">,</span> unavailable<span class="token punctuation">.</span>
 
# <span class="token class-name">It</span> automatically returns available as soon as all the slots are covered again<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">However</span> sometimes you want the subset of the cluster which is working<span class="token punctuation">,</span>
 
# <span class="token keyword">to</span> <span class="token keyword">continue</span> <span class="token keyword">to</span> <span class="token namespace">accept</span> queries <span class="token keyword">for</span> the part of the key space that is still
 
# <span class="token class-name"><span class="token namespace">covered<span class="token punctuation">.</span></span> In</span> order <span class="token keyword">to</span> <span class="token keyword">do</span> so<span class="token punctuation">,</span> just set the cluster<span class="token operator">-</span>require<span class="token operator">-</span>full<span class="token operator">-</span>coverage
 
# option <span class="token keyword">to</span> <span class="token namespace">no<span class="token punctuation">.</span></span>
 
#
 
# cluster<span class="token operator">-</span>require<span class="token operator">-</span>full<span class="token operator">-</span>coverage yes
 
 
 
# <span class="token class-name">This</span> option<span class="token punctuation">,</span> when set <span class="token keyword">to</span> <span class="token namespace">yes</span><span class="token punctuation">,</span> prevents replicas from trying <span class="token keyword">to</span> <span class="token namespace">failover</span> its
 
# master during master <span class="token class-name"><span class="token namespace">failures<span class="token punctuation">.</span></span> However</span> the master can still perform a
 
# manual failover<span class="token punctuation">,</span> <span class="token keyword">if</span> forced <span class="token keyword">to</span> <span class="token keyword">do</span> so<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">This</span> is useful in different scenarios<span class="token punctuation">,</span> especially in the <span class="token keyword">case</span> of multiple
 
# data center operations<span class="token punctuation">,</span> where we want one side <span class="token keyword">to</span> <span class="token namespace">never</span> be promoted <span class="token keyword">if</span> not
 
# in the <span class="token keyword">case</span> of a total <span class="token constant">DC</span> failure<span class="token punctuation">.</span>
 
#
 
# cluster<span class="token operator">-</span>replica<span class="token operator">-</span>no<span class="token operator">-</span>failover no
 
 
 
# <span class="token class-name">In</span> order <span class="token keyword">to</span> <span class="token namespace">setup</span> your cluster make sure <span class="token keyword">to</span> <span class="token namespace">read</span> the documentation
 
# available at http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>redis<span class="token punctuation">.</span>io web site<span class="token punctuation">.</span>
 
 
 
########################## <span class="token constant">CLUSTER</span> <span class="token constant">DOCKER</span><span class="token operator">/</span><span class="token constant">NAT</span> support  ########################
 
 
 
# <span class="token class-name">In</span> certain deployments<span class="token punctuation">,</span> <span class="token class-name">Redis</span> <span class="token class-name">Cluster</span> nodes address discovery fails<span class="token punctuation">,</span> because
 
# addresses are <span class="token constant">NAT</span><span class="token operator">-</span>ted or because ports are forwarded <span class="token punctuation">(</span>the typical <span class="token keyword">case</span> is
 
# <span class="token class-name">Docker</span> and other containers<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">In</span> order <span class="token keyword">to</span> <span class="token namespace">make</span> <span class="token class-name">Redis</span> <span class="token class-name">Cluster</span> working in such environments<span class="token punctuation">,</span> a <span class="token keyword">static</span>
 
# configuration where each node knows its <span class="token keyword">public</span> address is <span class="token class-name"><span class="token namespace">needed<span class="token punctuation">.</span></span> The</span>
 
# following two options are used <span class="token keyword">for</span> <span class="token keyword">this</span> scope<span class="token punctuation">,</span> and are<span class="token operator">:</span>
 
#
 
# <span class="token operator">*</span> cluster<span class="token operator">-</span>announce<span class="token operator">-</span>ip
 
# <span class="token operator">*</span> cluster<span class="token operator">-</span>announce<span class="token operator">-</span>port
 
# <span class="token operator">*</span> cluster<span class="token operator">-</span>announce<span class="token operator">-</span>bus<span class="token operator">-</span>port
 
#
 
# <span class="token class-name">Each</span> instruct the node about its address<span class="token punctuation">,</span> client port<span class="token punctuation">,</span> and cluster message
 
# bus <span class="token class-name"><span class="token namespace">port<span class="token punctuation">.</span></span> The</span> information is then published in the header of the bus packets
 
# so that other nodes will be able <span class="token keyword">to</span> <span class="token namespace">correctly</span> map the address of the node
 
# publishing the information<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">If</span> the above options are not used<span class="token punctuation">,</span> the normal <span class="token class-name">Redis</span> <span class="token class-name">Cluster</span> auto<span class="token operator">-</span>detection
 
# will be used instead<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Note</span> that when remapped<span class="token punctuation">,</span> the bus port may not be at the fixed offset of
 
# clients port <span class="token operator">+</span> <span class="token number">10000</span><span class="token punctuation">,</span> so you can specify any port and bus<span class="token operator">-</span>port depending
 
# on how they get <span class="token class-name"><span class="token namespace">remapped<span class="token punctuation">.</span></span> If</span> the bus<span class="token operator">-</span>port is not set<span class="token punctuation">,</span> a fixed offset of
 
# <span class="token number">10000</span> will be used as usually<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Example</span><span class="token operator">:</span>
 
#
 
# cluster<span class="token operator">-</span>announce<span class="token operator">-</span>ip <span class="token number">10.1</span><span class="token number">.1</span><span class="token number">.5</span>
 
# cluster<span class="token operator">-</span>announce<span class="token operator">-</span>port <span class="token number">6379</span>
 
# cluster<span class="token operator">-</span>announce<span class="token operator">-</span>bus<span class="token operator">-</span>port <span class="token number">6380</span>
 
 
 
################################## <span class="token constant">SLOW</span> <span class="token constant">LOG</span> ###################################
 
 
 
# <span class="token class-name">The</span> <span class="token class-name">Redis</span> <span class="token class-name">Slow</span> <span class="token class-name">Log</span> is a system <span class="token keyword">to</span> <span class="token namespace">log</span> queries that exceeded a specified
 
# execution <span class="token class-name"><span class="token namespace">time<span class="token punctuation">.</span></span> The</span> execution time does not include the <span class="token class-name">I</span><span class="token operator">/</span><span class="token class-name">O</span> operations
 
# like talking <span class="token keyword">with</span> <span class="token namespace">the</span> client<span class="token punctuation">,</span> sending the reply and so forth<span class="token punctuation">,</span>
 
# but just the time needed <span class="token keyword">to</span> <span class="token namespace">actually</span> execute the command <span class="token punctuation">(</span><span class="token keyword">this</span> is the only
 
# stage of command execution where the thread is blocked and can not serve
 
# other requests in the meantime<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">You</span> can configure the slow log <span class="token keyword">with</span> <span class="token namespace">two</span> parameters<span class="token operator">:</span> one tells <span class="token class-name">Redis</span>
 
# what is the execution time<span class="token punctuation">,</span> in microseconds<span class="token punctuation">,</span> <span class="token keyword">to</span> <span class="token namespace">exceed</span> in order <span class="token keyword">for</span> the
 
# command <span class="token keyword">to</span> <span class="token namespace">get</span> logged<span class="token punctuation">,</span> and the other parameter is the length of the
 
# slow <span class="token class-name"><span class="token namespace">log<span class="token punctuation">.</span></span> When</span> a <span class="token keyword">new</span> command is logged the oldest one is removed from the
 
# queue of logged commands<span class="token punctuation">.</span>
 
 
 
# <span class="token class-name">The</span> following time is expressed in microseconds<span class="token punctuation">,</span> so <span class="token number">1000000</span> is equivalent
 
# <span class="token keyword">to</span> <span class="token namespace">one</span> <span class="token class-name"><span class="token namespace">second<span class="token punctuation">.</span></span> Note</span> that a negative number disables the slow log<span class="token punctuation">,</span> <span class="token keyword">while</span>
 
# a value of zero forces the logging of every command<span class="token punctuation">.</span>
 
slowlog<span class="token operator">-</span>log<span class="token operator">-</span>slower<span class="token operator">-</span>than <span class="token number">10000</span>
 
 
 
# <span class="token class-name">There</span> is no limit <span class="token keyword">to</span> <span class="token keyword">this</span> <span class="token class-name"><span class="token namespace">length<span class="token punctuation">.</span></span> Just</span> be aware that it will consume memory<span class="token punctuation">.</span>
 
# <span class="token class-name">You</span> can reclaim memory used by the slow log <span class="token keyword">with</span> <span class="token constant">SLOWLOG</span> <span class="token constant">RESET</span><span class="token punctuation">.</span>
 
slowlog<span class="token operator">-</span>max<span class="token operator">-</span>len <span class="token number">128</span>
 
 
 
################################ <span class="token constant">LATENCY</span> <span class="token constant">MONITOR</span> ##############################
 
 
 
# <span class="token class-name">The</span> <span class="token class-name">Redis</span> latency monitoring subsystem samples different operations
 
# at runtime in order <span class="token keyword">to</span> <span class="token namespace">collect</span> data related <span class="token keyword">to</span> <span class="token namespace">possible</span> sources of
 
# latency of a <span class="token class-name">Redis</span> instance<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Via</span> the <span class="token constant">LATENCY</span> command <span class="token keyword">this</span> information is available <span class="token keyword">to</span> <span class="token namespace">the</span> user that can
 
# print graphs and obtain reports<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> system only logs operations that were performed in a time equal or
 
# greater than the amount of milliseconds specified via the
 
# latency<span class="token operator">-</span>monitor<span class="token operator">-</span>threshold configuration <span class="token class-name"><span class="token namespace">directive<span class="token punctuation">.</span></span> When</span> its value is set
 
# <span class="token keyword">to</span> <span class="token namespace">zero</span><span class="token punctuation">,</span> the latency monitor is turned off<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">By</span> <span class="token keyword">default</span> latency monitoring is disabled since it is mostly not needed
 
# <span class="token keyword">if</span> you don't have latency issues<span class="token punctuation">,</span> and collecting data has a performance
 
# impact<span class="token punctuation">,</span> that <span class="token keyword">while</span> very small<span class="token punctuation">,</span> can be measured under big <span class="token class-name"><span class="token namespace">load<span class="token punctuation">.</span></span> Latency</span>
 
# monitoring can easily be enabled at runtime using the command
 
# <span class="token string">"CONFIG SET latency-monitor-threshold &lt;milliseconds&gt;"</span> <span class="token keyword">if</span> needed<span class="token punctuation">.</span>
 
latency<span class="token operator">-</span>monitor<span class="token operator">-</span>threshold <span class="token number">0</span>
 
 
 
############################# <span class="token constant">EVENT</span> <span class="token constant">NOTIFICATION</span> ##############################
 
 
 
# <span class="token class-name">Redis</span> can notify <span class="token class-name">Pub</span><span class="token operator">/</span><span class="token class-name">Sub</span> clients about events happening in the key space<span class="token punctuation">.</span>
 
# <span class="token class-name">This</span> feature is documented at http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>redis<span class="token punctuation">.</span>io<span class="token operator">/</span>topics<span class="token operator">/</span>notifications
 
#
 
# <span class="token class-name">For</span> instance <span class="token keyword">if</span> keyspace events notification is enabled<span class="token punctuation">,</span> and a client
 
# performs a <span class="token constant">DEL</span> operation on key <span class="token string">"foo"</span> stored in the <span class="token class-name">Database</span> <span class="token number">0</span><span class="token punctuation">,</span> two
 
# messages will be published via <span class="token class-name">Pub</span><span class="token operator">/</span><span class="token class-name">Sub</span><span class="token operator">:</span>
 
#
 
# <span class="token constant">PUBLISH</span> __keyspace<span class="token annotation punctuation">@0__</span><span class="token operator">:</span>foo del
 
# <span class="token constant">PUBLISH</span> __keyevent<span class="token annotation punctuation">@0__</span><span class="token operator">:</span>del foo
 
#
 
# <span class="token class-name">It</span> is possible <span class="token keyword">to</span> <span class="token namespace">select</span> the events that <span class="token class-name">Redis</span> will notify among a set
 
# of <span class="token class-name"><span class="token namespace">classes<span class="token punctuation">.</span></span> Every</span> <span class="token keyword">class</span> is identified by a single character<span class="token operator">:</span>
 
#
 
#  <span class="token class-name">K</span>     <span class="token class-name">Keyspace</span> events<span class="token punctuation">,</span> published <span class="token keyword">with</span> __keyspace@<span class="token generics"><span class="token punctuation">&lt;</span>db<span class="token punctuation">&gt;</span></span>__ prefix<span class="token punctuation">.</span>
 
#  <span class="token class-name">E</span>     <span class="token class-name">Keyevent</span> events<span class="token punctuation">,</span> published <span class="token keyword">with</span> __keyevent@<span class="token generics"><span class="token punctuation">&lt;</span>db<span class="token punctuation">&gt;</span></span>__ prefix<span class="token punctuation">.</span>
 
#  g     <span class="token class-name">Generic</span> commands <span class="token punctuation">(</span>non<span class="token operator">-</span>type specific<span class="token punctuation">)</span> like <span class="token constant">DEL</span><span class="token punctuation">,</span> <span class="token constant">EXPIRE</span><span class="token punctuation">,</span> <span class="token constant">RENAME</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 
#  $     <span class="token class-name">String</span> commands
 
#  l     <span class="token class-name">List</span> commands
 
#  s     <span class="token class-name">Set</span> commands
 
#  h     <span class="token class-name">Hash</span> commands
 
#  z     <span class="token class-name">Sorted</span> set commands
 
#  x     <span class="token class-name">Expired</span> events <span class="token punctuation">(</span>events generated every time a key expires<span class="token punctuation">)</span>
 
#  e     <span class="token class-name">Evicted</span> events <span class="token punctuation">(</span>events generated when a key is evicted <span class="token keyword">for</span> maxmemory<span class="token punctuation">)</span>
 
#  <span class="token class-name">A</span>     <span class="token class-name">Alias</span> <span class="token keyword">for</span> g$lshzxe<span class="token punctuation">,</span> so that the <span class="token string">"AKE"</span> string means all the events<span class="token punctuation">.</span>
 
#
 
#  <span class="token class-name">The</span> <span class="token string">"notify-keyspace-events"</span> takes as argument a string that is composed
 
#  of zero or multiple <span class="token class-name"><span class="token namespace">characters<span class="token punctuation">.</span></span> The</span> empty string means that notifications
 
#  are disabled<span class="token punctuation">.</span>
 
#
 
#  <span class="token class-name">Example</span><span class="token operator">:</span> <span class="token keyword">to</span> <span class="token namespace">enable</span> list and generic events<span class="token punctuation">,</span> from the point of view of the
 
#           event name<span class="token punctuation">,</span> use<span class="token operator">:</span>
 
#
 
#  notify<span class="token operator">-</span>keyspace<span class="token operator">-</span>events <span class="token class-name">Elg</span>
 
#
 
#  <span class="token class-name">Example</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token keyword">to</span> <span class="token namespace">get</span> the stream of the expired keys subscribing <span class="token keyword">to</span> <span class="token namespace">channel</span>
 
#             name __keyevent<span class="token annotation punctuation">@0__</span><span class="token operator">:</span>expired use<span class="token operator">:</span>
 
#
 
  notify<span class="token operator">-</span>keyspace<span class="token operator">-</span>events <span class="token class-name">Ex</span>
 
#
 
#  <span class="token class-name">By</span> <span class="token keyword">default</span> all notifications are disabled because most users don't need
 
#  <span class="token keyword">this</span> feature and the feature has some <span class="token class-name"><span class="token namespace">overhead<span class="token punctuation">.</span></span> Note</span> that <span class="token keyword">if</span> you don't
 
#  specify at least one of <span class="token class-name">K</span> or <span class="token class-name">E</span><span class="token punctuation">,</span> no events will be delivered<span class="token punctuation">.</span>
 
#notify<span class="token operator">-</span>keyspace<span class="token operator">-</span>events <span class="token string">""</span>
 
 
 
############################### <span class="token constant">ADVANCED</span> <span class="token constant">CONFIG</span> ###############################
 
 
 
# <span class="token class-name">Hashes</span> are encoded using a memory efficient data structure when they have a
 
# small number of entries<span class="token punctuation">,</span> and the biggest entry does not exceed a given
 
# <span class="token class-name"><span class="token namespace">threshold<span class="token punctuation">.</span></span> These</span> thresholds can be configured using the following directives<span class="token punctuation">.</span>
 
hash<span class="token operator">-</span>max<span class="token operator">-</span>ziplist<span class="token operator">-</span>entries <span class="token number">512</span>
 
hash<span class="token operator">-</span>max<span class="token operator">-</span>ziplist<span class="token operator">-</span>value <span class="token number">64</span>
 
 
 
# <span class="token class-name">Lists</span> are also encoded in a special way <span class="token keyword">to</span> <span class="token namespace">save</span> a lot of space<span class="token punctuation">.</span>
 
# <span class="token class-name">The</span> number of entries allowed per internal list node can be specified
 
# as a fixed maximum size or a maximum number of elements<span class="token punctuation">.</span>
 
# <span class="token class-name">For</span> a fixed maximum size<span class="token punctuation">,</span> use <span class="token operator">-</span><span class="token number">5</span> through <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> meaning<span class="token operator">:</span>
 
# <span class="token operator">-</span><span class="token number">5</span><span class="token operator">:</span> max size<span class="token operator">:</span> <span class="token number">64</span> <span class="token class-name">Kb</span>  <span class="token operator">&lt;</span><span class="token operator">--</span> not recommended <span class="token keyword">for</span> normal workloads
 
# <span class="token operator">-</span><span class="token number">4</span><span class="token operator">:</span> max size<span class="token operator">:</span> <span class="token number">32</span> <span class="token class-name">Kb</span>  <span class="token operator">&lt;</span><span class="token operator">--</span> not recommended
 
# <span class="token operator">-</span><span class="token number">3</span><span class="token operator">:</span> max size<span class="token operator">:</span> <span class="token number">16</span> <span class="token class-name">Kb</span>  <span class="token operator">&lt;</span><span class="token operator">--</span> probably not recommended
 
# <span class="token operator">-</span><span class="token number">2</span><span class="token operator">:</span> max size<span class="token operator">:</span> <span class="token number">8</span> <span class="token class-name">Kb</span>   <span class="token operator">&lt;</span><span class="token operator">--</span> good
 
# <span class="token operator">-</span><span class="token number">1</span><span class="token operator">:</span> max size<span class="token operator">:</span> <span class="token number">4</span> <span class="token class-name">Kb</span>   <span class="token operator">&lt;</span><span class="token operator">--</span> good
 
# <span class="token class-name">Positive</span> numbers mean store up <span class="token keyword">to</span> _exactly_ that number of elements
 
# per list node<span class="token punctuation">.</span>
 
# <span class="token class-name">The</span> highest performing option is usually <span class="token operator">-</span><span class="token number">2</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token class-name">Kb</span> size<span class="token punctuation">)</span> or <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token class-name">Kb</span> size<span class="token punctuation">)</span><span class="token punctuation">,</span>
 
# but <span class="token keyword">if</span> your use <span class="token keyword">case</span> is unique<span class="token punctuation">,</span> adjust the settings as necessary<span class="token punctuation">.</span>
 
list<span class="token operator">-</span>max<span class="token operator">-</span>ziplist<span class="token operator">-</span>size <span class="token operator">-</span><span class="token number">2</span>
 
 
 
# <span class="token class-name">Lists</span> may also be compressed<span class="token punctuation">.</span>
 
# <span class="token class-name">Compress</span> depth is the number of quicklist ziplist nodes from <span class="token operator">*</span>each<span class="token operator">*</span> side of
 
# the list <span class="token keyword">to</span> <span class="token operator">*</span>exclude<span class="token operator">*</span> from <span class="token class-name"><span class="token namespace">compression<span class="token punctuation">.</span></span>  The</span> head and tail of the list
 
# are always uncompressed <span class="token keyword">for</span> fast push<span class="token operator">/</span>pop <span class="token class-name"><span class="token namespace">operations<span class="token punctuation">.</span></span>  Settings</span> are<span class="token operator">:</span>
 
# <span class="token number">0</span><span class="token operator">:</span> disable all list compression
 
# <span class="token number">1</span><span class="token operator">:</span> depth <span class="token number">1</span> means "don't start compressing until after <span class="token number">1</span> node into the list<span class="token punctuation">,</span>
 
#    going from either the head or tail"
 
#    <span class="token class-name">So</span><span class="token operator">:</span> <span class="token punctuation">[</span>head<span class="token punctuation">]</span><span class="token operator">-&gt;</span>node<span class="token operator">-&gt;</span>node<span class="token operator">-&gt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>-<span class="token operator">&gt;</span>node<span class="token operator">-&gt;</span><span class="token punctuation">[</span>tail<span class="token punctuation">]</span>
 
#    <span class="token punctuation">[</span>head<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>tail<span class="token punctuation">]</span> will always be uncompressed<span class="token punctuation">;</span> inner nodes will compress<span class="token punctuation">.</span>
 
# <span class="token number">2</span><span class="token operator">:</span> <span class="token punctuation">[</span>head<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">[</span>next<span class="token punctuation">]</span><span class="token operator">-&gt;</span>node<span class="token operator">-&gt;</span>node<span class="token operator">-&gt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>-<span class="token operator">&gt;</span>node<span class="token operator">-&gt;</span><span class="token punctuation">[</span>prev<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">[</span>tail<span class="token punctuation">]</span>
 
#    <span class="token number">2</span> here means<span class="token operator">:</span> don't compress head or head<span class="token operator">-&gt;</span>next or tail<span class="token operator">-&gt;</span>prev or tail<span class="token punctuation">,</span>
 
#    but compress all nodes between them<span class="token punctuation">.</span>
 
# <span class="token number">3</span><span class="token operator">:</span> <span class="token punctuation">[</span>head<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">[</span>next<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">[</span>next<span class="token punctuation">]</span><span class="token operator">-&gt;</span>node<span class="token operator">-&gt;</span>node<span class="token operator">-&gt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>-<span class="token operator">&gt;</span>node<span class="token operator">-&gt;</span><span class="token punctuation">[</span>prev<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">[</span>prev<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token punctuation">[</span>tail<span class="token punctuation">]</span>
 
# etc<span class="token punctuation">.</span>
 
list<span class="token operator">-</span>compress<span class="token operator">-</span>depth <span class="token number">0</span>
 
 
 
# <span class="token class-name">Sets</span> have a special encoding in just one <span class="token keyword">case</span><span class="token operator">:</span> when a set is composed
 
# of just strings that happen <span class="token keyword">to</span> <span class="token namespace">be</span> integers in radix <span class="token number">10</span> in the range
 
# of <span class="token number">64</span> bit signed integers<span class="token punctuation">.</span>
 
# <span class="token class-name">The</span> following configuration setting sets the limit in the size of the
 
# set in order <span class="token keyword">to</span> <span class="token namespace">use</span> <span class="token keyword">this</span> special memory saving encoding<span class="token punctuation">.</span>
 
set<span class="token operator">-</span>max<span class="token operator">-</span>intset<span class="token operator">-</span>entries <span class="token number">512</span>
 
 
 
# <span class="token class-name">Similarly</span> <span class="token keyword">to</span> <span class="token namespace">hashes</span> and lists<span class="token punctuation">,</span> sorted sets are also specially encoded in
 
# order <span class="token keyword">to</span> <span class="token namespace">save</span> a lot of <span class="token class-name"><span class="token namespace">space<span class="token punctuation">.</span></span> This</span> encoding is only used when the length and
 
# elements of a sorted set are below the following limits<span class="token operator">:</span>
 
zset<span class="token operator">-</span>max<span class="token operator">-</span>ziplist<span class="token operator">-</span>entries <span class="token number">128</span>
 
zset<span class="token operator">-</span>max<span class="token operator">-</span>ziplist<span class="token operator">-</span>value <span class="token number">64</span>
 
 
 
# <span class="token class-name">HyperLogLog</span> sparse representation bytes <span class="token class-name"><span class="token namespace">limit<span class="token punctuation">.</span></span> The</span> limit includes the
 
# <span class="token number">16</span> bytes <span class="token class-name"><span class="token namespace">header<span class="token punctuation">.</span></span> When</span> an <span class="token class-name">HyperLogLog</span> using the sparse representation crosses
 
# <span class="token keyword">this</span> limit<span class="token punctuation">,</span> it is converted into the dense representation<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">A</span> value greater than <span class="token number">16000</span> is totally useless<span class="token punctuation">,</span> since at that point the
 
# dense representation is more memory efficient<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> suggested value is <span class="token operator">~</span> <span class="token number">3000</span> in order <span class="token keyword">to</span> <span class="token namespace">have</span> the benefits of
 
# the space efficient encoding without slowing down too much <span class="token constant">PFADD</span><span class="token punctuation">,</span>
 
# which is <span class="token class-name">O</span><span class="token punctuation">(</span><span class="token class-name">N</span><span class="token punctuation">)</span> <span class="token keyword">with</span> <span class="token namespace">the</span> sparse <span class="token class-name"><span class="token namespace">encoding<span class="token punctuation">.</span></span> The</span> value can be raised <span class="token keyword">to</span>
 
# <span class="token operator">~</span> <span class="token number">10000</span> when <span class="token constant">CPU</span> is not a concern<span class="token punctuation">,</span> but space is<span class="token punctuation">,</span> and the data set is
 
# composed of many <span class="token class-name">HyperLogLogs</span> <span class="token keyword">with</span> <span class="token namespace">cardinality</span> in the <span class="token number">0</span> <span class="token operator">-</span> <span class="token number">15000</span> range<span class="token punctuation">.</span>
 
hll<span class="token operator">-</span>sparse<span class="token operator">-</span>max<span class="token operator">-</span>bytes <span class="token number">3000</span>
 
 
 
# <span class="token class-name">Streams</span> macro node max size <span class="token operator">/</span> <span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span> The</span> stream data structure is a radix
 
# tree of big nodes that encode multiple items <span class="token class-name"><span class="token namespace">inside<span class="token punctuation">.</span></span> Using</span> <span class="token keyword">this</span> configuration
 
# it is possible <span class="token keyword">to</span> <span class="token namespace">configure</span> how big a single node can be in bytes<span class="token punctuation">,</span> and the
 
# maximum number of items it may contain before switching <span class="token keyword">to</span> <span class="token namespace">a</span> <span class="token keyword">new</span> node when
 
# appending <span class="token keyword">new</span> stream <span class="token class-name"><span class="token namespace">entries<span class="token punctuation">.</span></span> If</span> any of the following settings are set <span class="token keyword">to</span>
 
# zero<span class="token punctuation">,</span> the limit is ignored<span class="token punctuation">,</span> so <span class="token keyword">for</span> instance it is possible <span class="token keyword">to</span> <span class="token namespace">set</span> just a
 
# max entires limit by setting max<span class="token operator">-</span>bytes <span class="token keyword">to</span> <span class="token number">0</span> and max<span class="token operator">-</span>entries <span class="token keyword">to</span> <span class="token namespace">the</span> desired
 
# value<span class="token punctuation">.</span>
 
stream<span class="token operator">-</span>node<span class="token operator">-</span>max<span class="token operator">-</span>bytes <span class="token number">4096</span>
 
stream<span class="token operator">-</span>node<span class="token operator">-</span>max<span class="token operator">-</span>entries <span class="token number">100</span>
 
 
 
# <span class="token class-name">Active</span> rehashing <span class="token keyword">uses</span> <span class="token number">1</span> millisecond every <span class="token number">100</span> milliseconds of <span class="token constant">CPU</span> time in
 
# order <span class="token keyword">to</span> <span class="token namespace">help</span> rehashing the main <span class="token class-name">Redis</span> hash table <span class="token punctuation">(</span>the one mapping top<span class="token operator">-</span>level
 
# keys <span class="token keyword">to</span> <span class="token namespace">values</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token class-name">The</span> hash table implementation <span class="token class-name">Redis</span> <span class="token keyword">uses</span> <span class="token punctuation">(</span>see dict<span class="token punctuation">.</span>c<span class="token punctuation">)</span>
 
# performs a lazy rehashing<span class="token operator">:</span> the more operation you run into a hash table
 
# that is rehashing<span class="token punctuation">,</span> the more rehashing <span class="token string">"steps"</span> are performed<span class="token punctuation">,</span> so <span class="token keyword">if</span> the
 
# server is idle the rehashing is never complete and some more memory is used
 
# by the hash table<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> <span class="token keyword">default</span> is <span class="token keyword">to</span> <span class="token namespace">use</span> <span class="token keyword">this</span> millisecond <span class="token number">10</span> times every second in order <span class="token keyword">to</span>
 
# actively rehash the main dictionaries<span class="token punctuation">,</span> freeing memory when possible<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">If</span> unsure<span class="token operator">:</span>
 
# use <span class="token string">"activerehashing no"</span> <span class="token keyword">if</span> you have hard latency requirements and it is
 
# not a good thing in your environment that <span class="token class-name">Redis</span> can reply from time <span class="token keyword">to</span> <span class="token namespace">time</span>
 
# <span class="token keyword">to</span> <span class="token namespace">queries</span> <span class="token keyword">with</span> <span class="token number">2</span> milliseconds delay<span class="token punctuation">.</span>
 
#
 
# use <span class="token string">"activerehashing yes"</span> <span class="token keyword">if</span> you don't have such hard requirements but
 
# want <span class="token keyword">to</span> <span class="token namespace">free</span> memory asap when possible<span class="token punctuation">.</span>
 
activerehashing yes
 
 
 
# <span class="token class-name">The</span> client output buffer limits can be used <span class="token keyword">to</span> <span class="token namespace">force</span> disconnection of clients
 
# that are not reading data from the server fast enough <span class="token keyword">for</span> some reason <span class="token punctuation">(</span>a
 
# common reason is that a <span class="token class-name">Pub</span><span class="token operator">/</span><span class="token class-name">Sub</span> client can't consume messages as fast as the
 
# publisher can produce them<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> limit can be set differently <span class="token keyword">for</span> the three different classes of clients<span class="token operator">:</span>
 
#
 
# normal <span class="token operator">-&gt;</span> normal clients including <span class="token constant">MONITOR</span> clients
 
# replica  <span class="token operator">-&gt;</span> replica clients
 
# pubsub <span class="token operator">-&gt;</span> clients subscribed <span class="token keyword">to</span> <span class="token namespace">at</span> least one pubsub channel or pattern
 
#
 
# <span class="token class-name">The</span> syntax of every client<span class="token operator">-</span>output<span class="token operator">-</span>buffer<span class="token operator">-</span>limit directive is the following<span class="token operator">:</span>
 
#
 
# client<span class="token operator">-</span>output<span class="token operator">-</span>buffer<span class="token operator">-</span>limit <span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">class</span><span class="token punctuation">&gt;</span></span> <span class="token generics"><span class="token punctuation">&lt;</span>hard limit<span class="token punctuation">&gt;</span></span> <span class="token generics"><span class="token punctuation">&lt;</span>soft limit<span class="token punctuation">&gt;</span></span> <span class="token generics"><span class="token punctuation">&lt;</span>soft seconds<span class="token punctuation">&gt;</span></span>
 
#
 
# <span class="token class-name">A</span> client is immediately disconnected once the hard limit is reached<span class="token punctuation">,</span> or <span class="token keyword">if</span>
 
# the soft limit is reached and remains reached <span class="token keyword">for</span> the specified number of
 
# seconds <span class="token punctuation">(</span>continuously<span class="token punctuation">)</span><span class="token punctuation">.</span>
 
# <span class="token class-name">So</span> <span class="token keyword">for</span> instance <span class="token keyword">if</span> the hard limit is <span class="token number">32</span> megabytes and the soft limit is
 
# <span class="token number">16</span> megabytes <span class="token operator">/</span> <span class="token number">10</span> seconds<span class="token punctuation">,</span> the client will get disconnected immediately
 
# <span class="token keyword">if</span> the size of the output buffers reach <span class="token number">32</span> megabytes<span class="token punctuation">,</span> but will also get
 
# disconnected <span class="token keyword">if</span> the client reaches <span class="token number">16</span> megabytes and continuously overcomes
 
# the limit <span class="token keyword">for</span> <span class="token number">10</span> seconds<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">By</span> <span class="token keyword">default</span> normal clients are not limited because they don't receive data
 
# without asking <span class="token punctuation">(</span>in a push way<span class="token punctuation">)</span><span class="token punctuation">,</span> but just after a request<span class="token punctuation">,</span> so only
 
# asynchronous clients may create a scenario where data is requested faster
 
# than it can read<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Instead</span> there is a <span class="token keyword">default</span> limit <span class="token keyword">for</span> pubsub and replica clients<span class="token punctuation">,</span> since
 
# subscribers and replicas receive data in a push fashion<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Both</span> the hard or the soft limit can be disabled by setting them <span class="token keyword">to</span> <span class="token namespace">zero<span class="token punctuation">.</span></span>
 
client<span class="token operator">-</span>output<span class="token operator">-</span>buffer<span class="token operator">-</span>limit normal <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>
 
client<span class="token operator">-</span>output<span class="token operator">-</span>buffer<span class="token operator">-</span>limit replica <span class="token number">256</span>mb <span class="token number">64</span>mb <span class="token number">60</span>
 
client<span class="token operator">-</span>output<span class="token operator">-</span>buffer<span class="token operator">-</span>limit pubsub <span class="token number">32</span>mb <span class="token number">8</span>mb <span class="token number">60</span>
 
 
 
# <span class="token class-name">Client</span> query buffers accumulate <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">commands<span class="token punctuation">.</span></span> They</span> are limited <span class="token keyword">to</span> <span class="token namespace">a</span> fixed
 
# amount by <span class="token keyword">default</span> in order <span class="token keyword">to</span> <span class="token namespace">avoid</span> that a protocol desynchronization <span class="token punctuation">(</span><span class="token keyword">for</span>
 
# instance due <span class="token keyword">to</span> <span class="token namespace">a</span> bug in the client<span class="token punctuation">)</span> will lead <span class="token keyword">to</span> <span class="token namespace">unbound</span> memory usage in
 
# the query <span class="token class-name"><span class="token namespace">buffer<span class="token punctuation">.</span></span> However</span> you can configure it here <span class="token keyword">if</span> you have very special
 
# needs<span class="token punctuation">,</span> such us huge multi<span class="token operator">/</span>exec requests or alike<span class="token punctuation">.</span>
 
#
 
# client<span class="token operator">-</span>query<span class="token operator">-</span>buffer<span class="token operator">-</span>limit <span class="token number">1</span>gb
 
 
 
# <span class="token class-name">In</span> the <span class="token class-name">Redis</span> protocol<span class="token punctuation">,</span> bulk requests<span class="token punctuation">,</span> that are<span class="token punctuation">,</span> elements representing single
 
# strings<span class="token punctuation">,</span> are normally limited ot <span class="token number">512</span> <span class="token class-name"><span class="token namespace">mb<span class="token punctuation">.</span></span> However</span> you can change <span class="token keyword">this</span> limit
 
# here<span class="token punctuation">.</span>
 
#
 
# proto<span class="token operator">-</span>max<span class="token operator">-</span>bulk<span class="token operator">-</span>len <span class="token number">512</span>mb
 
 
 
# <span class="token class-name">Redis</span> calls an internal function <span class="token keyword">to</span> <span class="token namespace">perform</span> many background tasks<span class="token punctuation">,</span> like
 
# closing connections of clients in timeout<span class="token punctuation">,</span> purging expired keys that are
 
# never requested<span class="token punctuation">,</span> and so forth<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Not</span> all tasks are performed <span class="token keyword">with</span> <span class="token namespace">the</span> same frequency<span class="token punctuation">,</span> but <span class="token class-name">Redis</span> checks <span class="token keyword">for</span>
 
# tasks <span class="token keyword">to</span> <span class="token namespace">perform</span> according <span class="token keyword">to</span> <span class="token namespace">the</span> specified <span class="token string">"hz"</span> value<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">By</span> <span class="token keyword">default</span> <span class="token string">"hz"</span> is set <span class="token keyword">to</span> <span class="token number">10.</span> <span class="token class-name">Raising</span> the value will use more <span class="token constant">CPU</span> when
 
# <span class="token class-name">Redis</span> is idle<span class="token punctuation">,</span> but at the same time will make <span class="token class-name">Redis</span> more responsive when
 
# there are many keys expiring at the same time<span class="token punctuation">,</span> and timeouts may be
 
# handled <span class="token keyword">with</span> <span class="token namespace">more</span> precision<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> range is between <span class="token number">1</span> and <span class="token number">500</span><span class="token punctuation">,</span> however a value over <span class="token number">100</span> is usually not
 
# a good <span class="token class-name"><span class="token namespace">idea<span class="token punctuation">.</span></span> Most</span> users should use the <span class="token keyword">default</span> of <span class="token number">10</span> and raise <span class="token keyword">this</span> up <span class="token keyword">to</span>
 
# <span class="token number">100</span> only in environments where very low latency is required<span class="token punctuation">.</span>
 
hz <span class="token number">10</span>
 
 
 
# <span class="token class-name">Normally</span> it is useful <span class="token keyword">to</span> <span class="token namespace">have</span> an <span class="token constant">HZ</span> value which is proportional <span class="token keyword">to</span> <span class="token namespace">the</span>
 
# number of clients <span class="token class-name"><span class="token namespace">connected<span class="token punctuation">.</span></span> This</span> is useful in order<span class="token punctuation">,</span> <span class="token keyword">for</span> instance<span class="token punctuation">,</span> <span class="token keyword">to</span>
 
# avoid too many clients are processed <span class="token keyword">for</span> each background task invocation
 
# in order <span class="token keyword">to</span> <span class="token namespace">avoid</span> latency spikes<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Since</span> the <span class="token keyword">default</span> <span class="token constant">HZ</span> value by <span class="token keyword">default</span> is conservatively set <span class="token keyword">to</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">Redis</span>
 
# offers<span class="token punctuation">,</span> and enables by <span class="token keyword">default</span><span class="token punctuation">,</span> the ability <span class="token keyword">to</span> <span class="token namespace">use</span> an adaptive <span class="token constant">HZ</span> value
 
# which will temporary raise when there are many connected clients<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">When</span> dynamic <span class="token constant">HZ</span> is enabled<span class="token punctuation">,</span> the actual configured <span class="token constant">HZ</span> will be used as
 
# as a baseline<span class="token punctuation">,</span> but multiples of the configured <span class="token constant">HZ</span> value will be actually
 
# used as needed once more clients are <span class="token class-name"><span class="token namespace">connected<span class="token punctuation">.</span></span> In</span> <span class="token keyword">this</span> way an idle
 
# instance will use very little <span class="token constant">CPU</span> time <span class="token keyword">while</span> a busy instance will be
 
# more responsive<span class="token punctuation">.</span>
 
dynamic<span class="token operator">-</span>hz yes
 
 
 
# <span class="token class-name">When</span> a child rewrites the <span class="token class-name">AOF</span> file<span class="token punctuation">,</span> <span class="token keyword">if</span> the following option is enabled
 
# the file will be fsync<span class="token operator">-</span>ed every <span class="token number">32</span> <span class="token constant">MB</span> of data <span class="token class-name"><span class="token namespace">generated<span class="token punctuation">.</span></span> This</span> is useful
 
# in order <span class="token keyword">to</span> <span class="token namespace">commit</span> the file <span class="token keyword">to</span> <span class="token namespace">the</span> disk more incrementally and avoid
 
# big latency spikes<span class="token punctuation">.</span>
 
aof<span class="token operator">-</span>rewrite<span class="token operator">-</span>incremental<span class="token operator">-</span>fsync yes
 
 
 
# <span class="token class-name">When</span> redis saves <span class="token class-name">RDB</span> file<span class="token punctuation">,</span> <span class="token keyword">if</span> the following option is enabled
 
# the file will be fsync<span class="token operator">-</span>ed every <span class="token number">32</span> <span class="token constant">MB</span> of data <span class="token class-name"><span class="token namespace">generated<span class="token punctuation">.</span></span> This</span> is useful
 
# in order <span class="token keyword">to</span> <span class="token namespace">commit</span> the file <span class="token keyword">to</span> <span class="token namespace">the</span> disk more incrementally and avoid
 
# big latency spikes<span class="token punctuation">.</span>
 
rdb<span class="token operator">-</span>save<span class="token operator">-</span>incremental<span class="token operator">-</span>fsync yes
 
 
 
# <span class="token class-name">Redis</span> <span class="token class-name">LFU</span> eviction <span class="token punctuation">(</span>see maxmemory setting<span class="token punctuation">)</span> can be <span class="token class-name"><span class="token namespace">tuned<span class="token punctuation">.</span></span> However</span> it is a good
 
# idea <span class="token keyword">to</span> <span class="token namespace">start</span> <span class="token keyword">with</span> <span class="token namespace">the</span> <span class="token keyword">default</span> settings and only change them after investigating
 
# how <span class="token keyword">to</span> <span class="token namespace">improve</span> the performances and how the keys <span class="token constant">LFU</span> change over time<span class="token punctuation">,</span> which
 
# is possible <span class="token keyword">to</span> <span class="token namespace">inspect</span> via the <span class="token constant">OBJECT</span> <span class="token constant">FREQ</span> command<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">There</span> are two tunable parameters in the <span class="token class-name">Redis</span> <span class="token constant">LFU</span> implementation<span class="token operator">:</span> the
 
# counter logarithm factor and the counter decay <span class="token class-name"><span class="token namespace">time<span class="token punctuation">.</span></span> It</span> is important <span class="token keyword">to</span>
 
# understand what the two parameters mean before changing them<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> <span class="token constant">LFU</span> counter is just <span class="token number">8</span> bits per key<span class="token punctuation">,</span> it's maximum value is <span class="token number">255</span><span class="token punctuation">,</span> so <span class="token class-name">Redis</span>
 
# <span class="token keyword">uses</span> <span class="token namespace">a</span> probabilistic increment <span class="token keyword">with</span> <span class="token namespace">logarithmic</span> <span class="token class-name"><span class="token namespace">behavior<span class="token punctuation">.</span></span> Given</span> the value
 
# of the old counter<span class="token punctuation">,</span> when a key is accessed<span class="token punctuation">,</span> the counter is incremented in
 
# <span class="token keyword">this</span> way<span class="token operator">:</span>
 
#
 
# <span class="token number">1.</span> <span class="token class-name">A</span> random number <span class="token class-name">R</span> between <span class="token number">0</span> and <span class="token number">1</span> is extracted<span class="token punctuation">.</span>
 
# <span class="token number">2.</span> <span class="token class-name">A</span> probability <span class="token class-name">P</span> is calculated as <span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span>old_value<span class="token operator">*</span>lfu_log_factor<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
 
# <span class="token number">3.</span> <span class="token class-name">The</span> counter is incremented only <span class="token keyword">if</span> <span class="token class-name">R</span> <span class="token operator">&lt;</span> <span class="token class-name">P</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> <span class="token keyword">default</span> lfu<span class="token operator">-</span>log<span class="token operator">-</span>factor is <span class="token number">10.</span> <span class="token class-name">This</span> is a table of how the frequency
 
# counter changes <span class="token keyword">with</span> <span class="token namespace">a</span> different number of accesses <span class="token keyword">with</span> <span class="token namespace">different</span>
 
# logarithmic factors<span class="token operator">:</span>
 
#
 
# <span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
 
# <span class="token operator">|</span> factor <span class="token operator">|</span> <span class="token number">100</span> hits   <span class="token operator">|</span> <span class="token number">1000</span> hits  <span class="token operator">|</span> <span class="token number">100</span>K hits  <span class="token operator">|</span> <span class="token number">1</span>M hits    <span class="token operator">|</span> <span class="token number">10</span>M hits   <span class="token operator">|</span>
 
# <span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
 
# <span class="token operator">|</span> <span class="token number">0</span>      <span class="token operator">|</span> <span class="token number">104</span>        <span class="token operator">|</span> <span class="token number">255</span>        <span class="token operator">|</span> <span class="token number">255</span>        <span class="token operator">|</span> <span class="token number">255</span>        <span class="token operator">|</span> <span class="token number">255</span>        <span class="token operator">|</span>
 
# <span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
 
# <span class="token operator">|</span> <span class="token number">1</span>      <span class="token operator">|</span> <span class="token number">18</span>         <span class="token operator">|</span> <span class="token number">49</span>         <span class="token operator">|</span> <span class="token number">255</span>        <span class="token operator">|</span> <span class="token number">255</span>        <span class="token operator">|</span> <span class="token number">255</span>        <span class="token operator">|</span>
 
# <span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
 
# <span class="token operator">|</span> <span class="token number">10</span>     <span class="token operator">|</span> <span class="token number">10</span>         <span class="token operator">|</span> <span class="token number">18</span>         <span class="token operator">|</span> <span class="token number">142</span>        <span class="token operator">|</span> <span class="token number">255</span>        <span class="token operator">|</span> <span class="token number">255</span>        <span class="token operator">|</span>
 
# <span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
 
# <span class="token operator">|</span> <span class="token number">100</span>    <span class="token operator">|</span> <span class="token number">8</span>          <span class="token operator">|</span> <span class="token number">11</span>         <span class="token operator">|</span> <span class="token number">49</span>         <span class="token operator">|</span> <span class="token number">143</span>        <span class="token operator">|</span> <span class="token number">255</span>        <span class="token operator">|</span>
 
# <span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
 
#
 
# <span class="token constant">NOTE</span><span class="token operator">:</span> <span class="token class-name">The</span> above table was obtained by running the following commands<span class="token operator">:</span>
 
#
 
#   redis<span class="token operator">-</span>benchmark <span class="token operator">-</span>n <span class="token number">1000000</span> incr foo
 
#   redis<span class="token operator">-</span>cli object freq foo
 
#
 
# <span class="token constant">NOTE</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token class-name">The</span> counter initial value is <span class="token number">5</span> in order <span class="token keyword">to</span> <span class="token namespace">give</span> <span class="token keyword">new</span> objects a chance
 
# <span class="token keyword">to</span> <span class="token namespace">accumulate</span> hits<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> counter decay time is the time<span class="token punctuation">,</span> in minutes<span class="token punctuation">,</span> that must elapse in order
 
# <span class="token keyword">for</span> the key counter <span class="token keyword">to</span> <span class="token namespace">be</span> divided by two <span class="token punctuation">(</span>or decremented <span class="token keyword">if</span> it has a value
 
# less <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> <span class="token keyword">default</span> value <span class="token keyword">for</span> the lfu<span class="token operator">-</span>decay<span class="token operator">-</span>time is <span class="token number">1.</span> <span class="token class-name">A</span> <span class="token class-name">Special</span> value of <span class="token number">0</span> means <span class="token keyword">to</span>
 
# decay the counter every time it happens <span class="token keyword">to</span> <span class="token namespace">be</span> scanned<span class="token punctuation">.</span>
 
#
 
# lfu<span class="token operator">-</span>log<span class="token operator">-</span>factor <span class="token number">10</span>
 
# lfu<span class="token operator">-</span>decay<span class="token operator">-</span>time <span class="token number">1</span>
 
 
 
########################### <span class="token constant">ACTIVE</span> <span class="token constant">DEFRAGMENTATION</span> #######################
 
#
 
# <span class="token constant">WARNING</span> <span class="token constant">THIS</span> <span class="token constant">FEATURE</span> <span class="token constant">IS</span> <span class="token class-name">EXPERIMENTAL<span class="token punctuation">.</span> However</span> it was stress tested
 
# even in production and manually tested by multiple engineers <span class="token keyword">for</span> some
 
# time<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">What</span> is active defragmentation<span class="token operator">?</span>
 
# <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
 
#
 
# <span class="token class-name">Active</span> <span class="token punctuation">(</span>online<span class="token punctuation">)</span> defragmentation allows a <span class="token class-name">Redis</span> server <span class="token keyword">to</span> <span class="token namespace">compact</span> the
 
# spaces left between small allocations and deallocations of data in memory<span class="token punctuation">,</span>
 
# thus allowing <span class="token keyword">to</span> <span class="token namespace">reclaim</span> back memory<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Fragmentation</span> is a natural process that happens <span class="token keyword">with</span> <span class="token namespace">every</span> allocator <span class="token punctuation">(</span>but
 
# less so <span class="token keyword">with</span> <span class="token class-name">Jemalloc</span><span class="token punctuation">,</span> fortunately<span class="token punctuation">)</span> and certain <span class="token class-name"><span class="token namespace">workloads<span class="token punctuation">.</span></span> Normally</span> a server
 
# restart is needed in order <span class="token keyword">to</span> <span class="token namespace">lower</span> the fragmentation<span class="token punctuation">,</span> or at least <span class="token keyword">to</span> <span class="token namespace">flush</span>
 
# away all the data and create it <span class="token class-name"><span class="token namespace">again<span class="token punctuation">.</span></span> However</span> thanks <span class="token keyword">to</span> <span class="token keyword">this</span> feature
 
# implemented by <span class="token class-name">Oran</span> <span class="token class-name">Agra</span> <span class="token keyword">for</span> <span class="token class-name">Redis</span> <span class="token number">4.0</span> <span class="token keyword">this</span> process can happen at runtime
 
# in an <span class="token string">"hot"</span> way<span class="token punctuation">,</span> <span class="token keyword">while</span> the server is running<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Basically</span> when the fragmentation is over a certain level <span class="token punctuation">(</span>see the
 
# configuration options below<span class="token punctuation">)</span> <span class="token class-name">Redis</span> will start <span class="token keyword">to</span> <span class="token namespace">create</span> <span class="token keyword">new</span> copies of the
 
# values in contiguous memory regions by exploiting certain specific <span class="token class-name">Jemalloc</span>
 
# features <span class="token punctuation">(</span>in order <span class="token keyword">to</span> <span class="token namespace">understand</span> <span class="token keyword">if</span> an allocation is causing fragmentation
 
# and <span class="token keyword">to</span> <span class="token namespace">allocate</span> it in a better place<span class="token punctuation">)</span><span class="token punctuation">,</span> and at the same time<span class="token punctuation">,</span> will release the
 
# old copies of the <span class="token class-name"><span class="token namespace">data<span class="token punctuation">.</span></span> This</span> process<span class="token punctuation">,</span> repeated incrementally <span class="token keyword">for</span> all the keys
 
# will cause the fragmentation <span class="token keyword">to</span> <span class="token namespace">drop</span> back <span class="token keyword">to</span> <span class="token namespace">normal</span> values<span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">Important</span> things <span class="token keyword">to</span> <span class="token namespace">understand</span><span class="token operator">:</span>
 
#
 
# <span class="token number">1.</span> <span class="token class-name">This</span> feature is disabled by <span class="token keyword">default</span><span class="token punctuation">,</span> and only works <span class="token keyword">if</span> you compiled <span class="token class-name">Redis</span>
 
#    <span class="token keyword">to</span> <span class="token namespace">use</span> the copy of <span class="token class-name">Jemalloc</span> we ship <span class="token keyword">with</span> <span class="token namespace">the</span> source code of <span class="token class-name">Redis</span><span class="token punctuation">.</span>
 
#    <span class="token class-name">This</span> is the <span class="token keyword">default</span> <span class="token keyword">with</span> <span class="token class-name">Linux</span> builds<span class="token punctuation">.</span>
 
#
 
# <span class="token number">2.</span> <span class="token class-name">You</span> never need <span class="token keyword">to</span> <span class="token namespace">enable</span> <span class="token keyword">this</span> feature <span class="token keyword">if</span> you don't have fragmentation
 
#    issues<span class="token punctuation">.</span>
 
#
 
# <span class="token number">3.</span> <span class="token class-name">Once</span> you experience fragmentation<span class="token punctuation">,</span> you can enable <span class="token keyword">this</span> feature when
 
#    needed <span class="token keyword">with</span> <span class="token namespace">the</span> command <span class="token string">"CONFIG SET activedefrag yes"</span><span class="token punctuation">.</span>
 
#
 
# <span class="token class-name">The</span> configuration parameters are able <span class="token keyword">to</span> <span class="token namespace">fine</span> tune the behavior of the
 
# defragmentation <span class="token class-name"><span class="token namespace">process<span class="token punctuation">.</span></span> If</span> you are not sure about what they mean it is
 
# a good idea <span class="token keyword">to</span> <span class="token namespace">leave</span> the defaults untouched<span class="token punctuation">.</span>
 
 
 
# <span class="token class-name">Enabled</span> active defragmentation
 
# activedefrag yes
 
 
 
# <span class="token class-name">Minimum</span> amount of fragmentation waste <span class="token keyword">to</span> <span class="token namespace">start</span> active defrag
 
# active<span class="token operator">-</span>defrag<span class="token operator">-</span>ignore<span class="token operator">-</span>bytes <span class="token number">100</span>mb
 
 
 
# <span class="token class-name">Minimum</span> percentage of fragmentation <span class="token keyword">to</span> <span class="token namespace">start</span> active defrag
 
# active<span class="token operator">-</span>defrag<span class="token operator">-</span>threshold<span class="token operator">-</span>lower <span class="token number">10</span>
 
 
 
# <span class="token class-name">Maximum</span> percentage of fragmentation at which we use maximum effort
 
# active<span class="token operator">-</span>defrag<span class="token operator">-</span>threshold<span class="token operator">-</span>upper <span class="token number">100</span>
 
 
 
# <span class="token class-name">Minimal</span> effort <span class="token keyword">for</span> defrag in <span class="token constant">CPU</span> percentage
 
# active<span class="token operator">-</span>defrag<span class="token operator">-</span>cycle<span class="token operator">-</span>min <span class="token number">5</span>
 
 
 
# <span class="token class-name">Maximal</span> effort <span class="token keyword">for</span> defrag in <span class="token constant">CPU</span> percentage
 
# active<span class="token operator">-</span>defrag<span class="token operator">-</span>cycle<span class="token operator">-</span>max <span class="token number">75</span>
 
 
 
# <span class="token class-name">Maximum</span> number of set<span class="token operator">/</span>hash<span class="token operator">/</span>zset<span class="token operator">/</span>list fields that will be processed from
 
# the main dictionary scan
 
# active<span class="token operator">-</span>defrag<span class="token operator">-</span>max<span class="token operator">-</span>scan<span class="token operator">-</span>fields <span class="token number">1000</span>
 
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/74b11cdeb27a00c83836413c53bc128e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[足式机器人]Part2 Dr. CAN学习笔记 - Ch03 傅里叶级数与变换</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d1f3531a84f0eefad9fbaa78ac801e62/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">docker compose 搭建ES集群的详细步骤，并去掉验证，使用http访问</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>