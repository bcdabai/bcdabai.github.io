<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue3之echarts3D环柱饼图 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue3之echarts3D环柱饼图" />
<meta property="og:description" content="vue3之echarts3D环柱饼图 效果：
版本
&#34;echarts&#34;: &#34;^5.4.1&#34;, &#34;echarts-gl&#34;: &#34;^2.0.9&#34;
核心代码：
&lt;template&gt; &lt;div class=&#34;content&#34;&gt; &lt;div ref=&#34;eCharts&#34; class=&#34;chart&#34;&gt;&lt;/div&gt; &lt;/div&gt; &lt;/template&gt; &lt;script setup&gt; import { onMounted, ref } from &#34;vue&#34;; import * as echarts from &#34;echarts&#34;; import &#34;echarts-gl&#34;; const eCharts = ref(null); let myChart = null; let boxHeight; let optionData = ref([ { name: &#34;林地&#34;, value: 5, itemStyle: { color: &#34;#22c4ff&#34;, }, }, { name: &#34;草地&#34;, value: 13, itemStyle: { color: &#34;#aaff00&#34;, }, }, { name: &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/be3447cf2b8fcf97e7a7c2dc3b38b84e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-29T17:17:50+08:00" />
<meta property="article:modified_time" content="2024-01-29T17:17:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue3之echarts3D环柱饼图</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h5><a id="vue3echarts3D_0"></a>vue3之echarts3D环柱饼图</h5> 
<p>效果：<br> <img src="https://images2.imgbox.com/9e/37/4LbhIOyz_o.png" alt="在这里插入图片描述"></p> 
<p>版本<br> <code>"echarts": "^5.4.1", "echarts-gl": "^2.0.9"</code></p> 
<p>核心代码：</p> 
<pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"content"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token string">"eCharts"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"chart"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> onMounted<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> echarts <span class="token keyword">from</span> <span class="token string">"echarts"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">"echarts-gl"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> eCharts <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> myChart <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> boxHeight<span class="token punctuation">;</span>
<span class="token keyword">let</span> optionData <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{<!-- --></span>
    name<span class="token operator">:</span> <span class="token string">"林地"</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    itemStyle<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      color<span class="token operator">:</span> <span class="token string">"#22c4ff"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    name<span class="token operator">:</span> <span class="token string">"草地"</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
    itemStyle<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      color<span class="token operator">:</span> <span class="token string">"#aaff00"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    name<span class="token operator">:</span> <span class="token string">"耕地"</span><span class="token punctuation">,</span>
    value<span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
    itemStyle<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      color<span class="token operator">:</span> <span class="token string">"#bbaaf1"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">getParametricEquation</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token parameter">startRatio<span class="token punctuation">,</span>
  endRatio<span class="token punctuation">,</span>
  isSelected<span class="token punctuation">,</span>
  isHovered<span class="token punctuation">,</span>
  k<span class="token punctuation">,</span>
  h</span>
<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 计算</span>
  <span class="token keyword">let</span> midRatio <span class="token operator">=</span> <span class="token punctuation">(</span>startRatio <span class="token operator">+</span> endRatio<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> startRadian <span class="token operator">=</span> startRatio <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> endRadian <span class="token operator">=</span> endRatio <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> midRadian <span class="token operator">=</span> midRatio <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token comment">// 如果只有一个扇形，则不实现选中效果。</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>startRatio <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> endRatio <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    isSelected <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 通过扇形内径/外径的值，换算出辅助参数 k（默认值 1/3）</span>
  k <span class="token operator">=</span> <span class="token keyword">typeof</span> k <span class="token operator">!==</span> <span class="token string">"undefined"</span> <span class="token operator">?</span> k <span class="token operator">:</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">;</span>
  <span class="token comment">// 计算选中效果分别在 x 轴、y 轴方向上的位移（未选中，则位移均为 0）</span>
  <span class="token keyword">let</span> offsetX <span class="token operator">=</span> isSelected <span class="token operator">?</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>midRadian<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> offsetY <span class="token operator">=</span> isSelected <span class="token operator">?</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>midRadian<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">// 计算高亮效果的放大比例（未高亮，则比例为 1）</span>
  <span class="token keyword">let</span> hoverRate <span class="token operator">=</span> isHovered <span class="token operator">?</span> <span class="token number">1.05</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token comment">// 返回曲面参数方程</span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    u<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      min<span class="token operator">:</span> <span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span>
      max<span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">,</span>
      step<span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    v<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      min<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      max<span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>
      step<span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">x</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&lt;</span> startRadian<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
          offsetX <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>startRadian<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">*</span> k<span class="token punctuation">)</span> <span class="token operator">*</span> hoverRate
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&gt;</span> endRadian<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
          offsetX <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>endRadian<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">*</span> k<span class="token punctuation">)</span> <span class="token operator">*</span> hoverRate
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> offsetX <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">*</span> k<span class="token punctuation">)</span> <span class="token operator">*</span> hoverRate<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">y</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&lt;</span> startRadian<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
          offsetY <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>startRadian<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">*</span> k<span class="token punctuation">)</span> <span class="token operator">*</span> hoverRate
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&gt;</span> endRadian<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
          offsetY <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>endRadian<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">*</span> k<span class="token punctuation">)</span> <span class="token operator">*</span> hoverRate
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> offsetY <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">*</span> k<span class="token punctuation">)</span> <span class="token operator">*</span> hoverRate<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">z</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&lt;</span> <span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&gt;</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2.5</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">*</span> h <span class="token operator">*</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">*</span> h <span class="token operator">*</span> <span class="token number">0.1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">getPie3D</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">pieData<span class="token punctuation">,</span> internalDiameterRatio</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// internalDiameterRatio:透明的空心占比</span>
  <span class="token keyword">let</span> series <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> sumValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> startValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> endValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> k <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> internalDiameterRatio<span class="token punctuation">;</span>
  pieData<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> b<span class="token punctuation">.</span>value <span class="token operator">-</span> a<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 为每一个饼图数据，生成一个 series-surface 配置</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pieData<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    sumValue <span class="token operator">+=</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token keyword">let</span> seriesItem <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
      name<span class="token operator">:</span>
        <span class="token keyword">typeof</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">"undefined"</span> <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">series</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>
      type<span class="token operator">:</span> <span class="token string">"surface"</span><span class="token punctuation">,</span>
      parametric<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      wireframe<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        show<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      pieData<span class="token operator">:</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>
      pieStatus<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        selected<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        hovered<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        k<span class="token operator">:</span> k<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      center<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"10%"</span><span class="token punctuation">,</span> <span class="token string">"50%"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle <span class="token operator">!=</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">let</span> itemStyle <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">typeof</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle<span class="token punctuation">.</span>color <span class="token operator">!=</span> <span class="token string">"undefined"</span>
        <span class="token operator">?</span> <span class="token punctuation">(</span>itemStyle<span class="token punctuation">.</span>color <span class="token operator">=</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle<span class="token punctuation">.</span>color<span class="token punctuation">)</span>
        <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token keyword">typeof</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle<span class="token punctuation">.</span>opacity <span class="token operator">!=</span> <span class="token string">"undefined"</span>
        <span class="token operator">?</span> <span class="token punctuation">(</span>itemStyle<span class="token punctuation">.</span>opacity <span class="token operator">=</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle<span class="token punctuation">.</span>opacity<span class="token punctuation">)</span>
        <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      seriesItem<span class="token punctuation">.</span>itemStyle <span class="token operator">=</span> itemStyle<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    series<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>seriesItem<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 使用上一次遍历时，计算出的数据和 sumValue，调用 getParametricEquation 函数，</span>
  <span class="token comment">// 向每个 series-surface 传入不同的参数方程 series-surface.parametricEquation，也就是实现每一个扇形。</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> series<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    endValue <span class="token operator">=</span> startValue <span class="token operator">+</span> series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>startRatio <span class="token operator">=</span> startValue <span class="token operator">/</span> sumValue<span class="token punctuation">;</span>
    series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>endRatio <span class="token operator">=</span> endValue <span class="token operator">/</span> sumValue<span class="token punctuation">;</span>
    series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>parametricEquation <span class="token operator">=</span> <span class="token function">getParametricEquation</span><span class="token punctuation">(</span>
      series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>startRatio<span class="token punctuation">,</span>
      series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>endRatio<span class="token punctuation">,</span>
      <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token boolean">false</span><span class="token punctuation">,</span>
      k<span class="token punctuation">,</span>
      series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>value <span class="token comment">// 控制各模块高度一致100   控制各模块高度根据value改变</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    startValue <span class="token operator">=</span> endValue<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  boxHeight <span class="token operator">=</span> <span class="token function">getHeight3D</span><span class="token punctuation">(</span>series<span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//通过传参设定3d饼/环的高度，26代表26PX</span>
  <span class="token keyword">return</span> series<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">getHeight3D</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">series<span class="token punctuation">,</span> height</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  series<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> b<span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>value <span class="token operator">-</span> a<span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>height <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">/</span> series<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">initCharts</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  myChart <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>eCharts<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> series <span class="token operator">=</span> <span class="token function">getPie3D</span><span class="token punctuation">(</span>optionData<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  series<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    name<span class="token operator">:</span> <span class="token string">"pie2d"</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">"pie"</span><span class="token punctuation">,</span>
    label<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      opacity<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      fontSize<span class="token operator">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
      lineHeight<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    labelLine<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      length<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
      length2<span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    startAngle<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token comment">//起始角度，支持范围[0, 360]。</span>
    clockwise<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//饼图的扇区是否是顺时针排布。上述这两项配置主要是为了对齐3d的样式</span>
    radius<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"50%"</span><span class="token punctuation">,</span> <span class="token string">"32%"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    center<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"50%"</span><span class="token punctuation">,</span> <span class="token string">"50%"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> optionData<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
    itemStyle<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      opacity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  optionData<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    item<span class="token punctuation">.</span>label <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
      color<span class="token operator">:</span> item<span class="token punctuation">.</span>itemStyle<span class="token punctuation">.</span>color<span class="token punctuation">,</span>
      show<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token function-variable function">formatter</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{b|</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>item<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> \n}</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      rich<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        b<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          fontSize<span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
          lineHeight<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> option <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    xAxis3D<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      min<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
      max<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    yAxis3D<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      min<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
      max<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    zAxis3D<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      min<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
      max<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    grid3D<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      show<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 距离上边的间距</span>
      boxHeight<span class="token punctuation">,</span> <span class="token comment">// 圆环的高度</span>
      viewControl<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 3d效果可以放大、旋转等，请自己去查看官方配置</span>
        alpha<span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token comment">// 角度</span>
        distance<span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token comment">// 调整视角到主体的距离，类似调整zoom</span>
        rotateSensitivity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 设置为0无法旋转</span>
        zoomSensitivity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 设置为0无法缩放</span>
        panSensitivity<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 设置为0无法平移</span>
        autoRotate<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 自动旋转</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    series<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  myChart<span class="token operator">?.</span><span class="token function">setOption</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">initCharts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">"scss"</span> scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>content <span class="token punctuation">{<!-- --></span>
    position<span class="token operator">:</span> relative<span class="token punctuation">;</span>

    <span class="token punctuation">.</span>chart <span class="token punctuation">{<!-- --></span>
      position<span class="token operator">:</span> absolute<span class="token punctuation">;</span>
      top<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">20</span>px<span class="token punctuation">;</span>
      left<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">20</span>px<span class="token punctuation">;</span>
      width<span class="token operator">:</span> <span class="token number">500</span>px<span class="token punctuation">;</span>
      height<span class="token operator">:</span> <span class="token number">300</span>px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b84db3638a4986bc84ff39a63da2f21b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">常见的网络安全威胁和防护方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/63a15cabba34f81a9d263b99f4941fa7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">书生浦语大模型 笔记&amp;作业汇总</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>