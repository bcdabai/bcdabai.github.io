<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Ajax怎么做跨域请求 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Ajax怎么做跨域请求" />
<meta property="og:description" content="下面我们在本地建两个站点演示一下
第一步首先我们在本地搭建好一个Apache服务器；下载地址； 第二步服务器配置好以后，在本地配置好两个虚拟的域名； 第三步我们在C盘建一个文件夹命名为”HTML5”； 第四步找到Apache虚拟主机的配置文件，然后打开配置文件 第五步在第三步建的HTML5文件夹下分别建一个文件夹a和文件夹b; 第六步修改Apache虚拟主机的配置文件,如图 第七步修改一下host文件，添加a和b的网址，通常host文件路径在C:\Windows\System32\drivers\etc 下 我们在HTML5/a文件夹下建一个7.ajax.html文件
&lt;!DOCTYPE HTML&gt; &lt;html&gt; &lt;head&gt; &lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=utf-8&#34;&gt; &lt;title&gt;获取同域下内容&lt;/title&gt; &lt;script&gt; window.onload = function() { var oBtn = document.getElementById(&#39;btn&#39;); // 忽略IE6 oBtn.onclick = function() { //创建一个ajax对象 var xhr = new XMLHttpRequest(); //监听事件 xhr.onreadystatechange = function() { if (xhr.readyState == 4) { if (xhr.status == 200) { alert(xhr.responseText); } } } xhr.open(&#39;get&#39;, &#39;ajax.php&#39;, true); xhr.send(); } } &lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;input type=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/99a25cf8e895106ef385991a06091b1b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-08-02T11:40:09+08:00" />
<meta property="article:modified_time" content="2017-08-02T11:40:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Ajax怎么做跨域请求</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>下面我们在本地建两个站点演示一下</strong></p> 
<p>第一步首先我们在本地搭建好一个Apache服务器；<a href="http://www.wampserver.com/" rel="nofollow noopener noreferrer" target="_blank">下载地址</a>； <br> 第二步服务器配置好以后，在本地配置好两个虚拟的域名； <br> 第三步我们在C盘建一个文件夹命名为”HTML5”； <br> 第四步找到Apache虚拟主机的配置文件，然后打开配置文件 <br> <img src="https://images2.imgbox.com/9e/f3/OB9futvX_o.png" alt="Apache虚拟主机的配置文件" title=""> <br> 第五步在第三步建的HTML5文件夹下分别建一个文件夹a和文件夹b; <br> 第六步修改Apache虚拟主机的配置文件,如图 <br> <img src="https://images2.imgbox.com/f3/c8/cyU6xPwa_o.png" alt="修改Apache虚拟主机的配置文件" title=""> <br> 第七步修改一下host文件，添加a和b的网址，通常host文件路径在C:\Windows\System32\drivers\etc 下 <br> <img src="https://images2.imgbox.com/02/56/whlbud3R_o.png" alt="修改一下host文件" title=""></p> 
<p>我们在HTML5/a文件夹下建一个7.ajax.html文件</p> 
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-doctype">&lt;!DOCTYPE HTML&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">http-equiv</span>=<span class="hljs-value">"Content-Type"</span> <span class="hljs-attribute">content</span>=<span class="hljs-value">"text/html; charset=utf-8"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>获取同域下内容<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span>&gt;</span><span class="javascript">
window.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>
    <span class="hljs-keyword">var</span> oBtn = document.getElementById(<span class="hljs-string">'btn'</span>);
    <span class="hljs-comment">// 忽略IE6</span>
    oBtn.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>
        <span class="hljs-comment">//创建一个ajax对象</span>
        <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest();
        <span class="hljs-comment">//监听事件</span>
        xhr.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>
            <span class="hljs-keyword">if</span> (xhr.readyState == <span class="hljs-number">4</span>) {
                <span class="hljs-keyword">if</span> (xhr.status == <span class="hljs-number">200</span>) {
                    alert(xhr.responseText);
                }
            }
        }
        xhr.open(<span class="hljs-string">'get'</span>, <span class="hljs-string">'ajax.php'</span>, <span class="hljs-literal">true</span>);
        xhr.send();
    }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"获取同域下内容"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"btn"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span></code></pre> 
<h2 id="我们先看一下同域下的请求">我们先看一下同域下的请求</h2> 
<p>我们在HTML5/a下建一个php文件，返回’hello’； <br> <img src="https://images2.imgbox.com/00/eb/2F2uBUzi_o.png" alt="ajax.php" title=""></p> 
<p>这时候我们在打开当前页面 <a href="http://www.a.com/7.ajax.html" rel="nofollow noopener noreferrer" target="_blank">http://www.a.com/7.ajax.html</a> ,点击按钮我们发现请求到了数据； <br> <img src="https://images2.imgbox.com/40/a5/uTFj3Wlw_o.png" alt="http://www.a.com/7.ajax.html" title=""></p> 
<p>================================================================</p> 
<h2 id="但是如果跨域的话即你所请求的数据和当前文件不在一个域下面这样的话就会产生跨域请求通常在这种情况下就会禁止你去访问">但是如果跨域的话，即你所请求的数据和当前文件不在一个域下面，这样的话就会产生跨域请求，通常在这种情况下就会禁止你去访问</h2> 
<p>例如我们现在将刚才在HTML5/a文件夹下的ajax.php文件放到b文件夹下， <br> <img src="https://images2.imgbox.com/b4/a0/lO6A6a2o_o.png" alt="" title=""></p> 
<p>这时候点击后我们发现请求报错了，意思是跨域请求受到了限制 <br> <img src="https://images2.imgbox.com/ad/fc/Bmpk6LcR_o.png" alt="跨域请求受到了限制" title=""></p> 
<p>这时候我们需要后端配合，你需要告诉后端在输出的时候加一个”Access-Control-Allow-Origin”头信息 <br> 比如说：如图，意思只要是这个域名的跨域请求就不受跨域策略的影响 <br> <img src="https://images2.imgbox.com/07/9f/lA3a5407_o.png" alt="允许访问的源" title=""></p> 
<p>这时候我点击的时候，就可以正常获取跨域的数据了 <br> <img src="https://images2.imgbox.com/cf/66/dXIzozKB_o.png" alt="" title=""></p> 
<p>如果你想兼容IE需要</p> 
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-doctype">&lt;!DOCTYPE HTML&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">http-equiv</span>=<span class="hljs-value">"Content-Type"</span> <span class="hljs-attribute">content</span>=<span class="hljs-value">"text/html; charset=utf-8"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>ajax跨域请求<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">script</span>&gt;</span><span class="javascript">
window.onload = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>    
    <span class="hljs-comment">/*
    在标准浏览器下，XMLHttpRequest对象已经是升级版本，支持了更多的特性，可以跨域了
    但是，如果想实现跨域请求，还需要后端的相关配合才可以
    XMLHttpRequest : 增加很多功能，他也不推荐使用onreadystatechange这个事件来监听，推荐使用onload

    */</span>
    <span class="hljs-keyword">var</span> oBtn = document.getElementById(<span class="hljs-string">'btn'</span>);
    oBtn.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>
        <span class="hljs-comment">// 这是标准浏览器写法</span>
        <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest();
        xhr.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>
            <span class="hljs-keyword">if</span> (xhr.readyState == <span class="hljs-number">4</span>) {
                <span class="hljs-keyword">if</span> (xhr.status == <span class="hljs-number">200</span>) {
                    alert(xhr.responseText);
                }
            }
        }
        xhr.open(<span class="hljs-string">'get'</span>, <span class="hljs-string">'http://www.b.com/ajax.php'</span>, <span class="hljs-literal">true</span>);
        xhr.send();
        <span class="hljs-comment">/*
        如果你想兼容IE浏览器,可以特地为IE做兼容,忽略IE6
        XDomainRequest : IE如果想实现跨域请求，则需要使用这个对象去实现
        var oXDomainRequest = new XDomainRequest();
        oXDomainRequest.onload = function() {
            alert(this.responseText);
        }
        oXDomainRequest.open('get', 'http://www.b.com/ajax.php', true);
        oXDomainRequest.send();
        */</span>
    }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"获取同域下内容"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"btn"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span></code></pre> 
<p>关于IE，详情请访问 <a href="https://msdn.microsoft.com/en-us/library/cc288060%28VS.85%29.aspx" rel="nofollow">https://msdn.microsoft.com/en-us/library/cc288060(VS.85).aspx</a> <br> Ajax最新标准请访问 <a href="https://www.w3.org/TR/XMLHttpRequest2/" rel="nofollow">https://www.w3.org/TR/XMLHttpRequest2/</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4f957dd4d5c38c099b7d7c2446581961/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Maven install命令</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c76da33180123812e1817802a5fca604/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关于node下载的模块无法使用（Cannot find module）解决方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>