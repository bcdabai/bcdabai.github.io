<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>图像特征Vol.1：计算机视觉特征度量|第二弹：【统计区域度量】 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="图像特征Vol.1：计算机视觉特征度量|第二弹：【统计区域度量】" />
<meta property="og:description" content="目录 一、前言二、统计区域度量2.1：图像矩特征2.1.1：原始矩/几何矩2.1.2：中心距2.1.3：归一化的中心矩2.1.4：不变矩——Hu矩2.1.5：OpenCv实现矩特征及其应用 2.2：点度量特征2.3：全局直方图和局部区域直方图2.4：散点图和3D直方图2.5：多尺度直方图2.6：径向直方图2.6：轮廓或边缘直方图 一、前言 在前篇图像特征Vol.1：计算机视觉特征度量【纹理区域特征】中，我们说到计算机视觉度量的三类方法，在那篇博客中，我们介绍了纹理区域度量的各个方法。在本篇博客中，我们将继续介绍纹理区域特征的第二类方法：统计区域度量。Let’s Go！
二、统计区域度量 统计区域度量，是利用统计方法，描述图像区域中像素值分布和变化情况的一种方法。 它主要应用在图像处理和计算机视觉领域。对于图像处理方面，在前面的博客【cv】图像预处理技术——从特征检测讲述图像预处理理论、实践、应用|01中，利用全局直方图和局部直方图，对图像进行光照校正、增强对比度，就是统计区域度量在图像处理方面应用的一个体现。这篇博客中，我们将介绍统计区域度量在计算机视觉特征度量中的应用体现。
常见的图像像素统计度量包括以下八种
图像矩特征点度量特征全局直方图局部直方图散点图和3D直方图多尺度直方图径向直方图轮廓或边缘直方图 这些统计度量可以通过对图像像素值进行数学运算和分析来得到。它们可以为图像处理和计算机视觉算法提供重要的特征和信息，从而提高算法的性能和鲁棒性。
接下来，我会基于每种方法给出基本原理，和步骤，以及一些简单的应用举例~Go
2.1：图像矩特征 👧🏻 什么是矩和图像矩？
矩是概率与统计中的一个概念，是随机变量的一种数字特征。在数字图像处理、计算机视觉与相关领域中，图像矩(Image moments)是指图像的某些特定像素灰度的加权平均值（矩），或者是图像具有类似功能或意义的属性。
图像矩通常用来描述 分割后的图像对象。可以通过图像的矩来获得图像的部分性质，包括面积(或总体亮度)，以及有关几何中心和方向的信息 。
💁🏻‍♀️基本思想和原理？
实际上，对于矩，我们实际上可以看作是二维图像在基空间上的投影。 为什么这么说呢？接着看完它的基本思想和原理你应该就懂了。
根据加权求和的方法不同，有不同种类的矩，且每一种矩有各自不同的表示图像特征的特征值。
2.1.1：原始矩/几何矩 对于灰度图像f,其(p&#43;q)阶矩(有时称为&#34;原始矩&#34;),定义如下:
原始矩阵中包含以下可以描述图像特征的信息：
二值图像或者或度图像的像素总和,可以表示为:
图像的几何中心也叫质心 (Cx,Cy) ,计算公式如下
2.1.2：中心距 当图像平移时，原始矩会发生变化（质心肯定会因为平移而改变嘛）。但是中心矩具有平移不变性（但在图像旋转时会发生变化；归一化中心距不仅具有平移不变性，而且具有比例不变性（尺度不变性））。相比于原始矩，它添加了一个基于质心的平移，对于灰度图像f,其(p&#43;q)阶中心矩的定义如下：
ps.述公式中（cx, cy)是用原始矩求出的图像的几何质心
中心矩可以用来计算图像的方向和形状等特征，不管是一维的序列分布还是二维的图像，不同的阶次均具备下述视觉上的规律性性质：
零阶矩：表示一维均值或二维质心；一阶中心矩：包含二维面积、质心和物体/目标大小等相关信息；二阶中心矩：与方差和2D椭圆度量相关；三阶中心矩：提供了二维形状（或偏度）的对称信息；四阶中心矩：用来度量二维分布，如高、矮、细、短、胖等形态；更高阶的矩：可由多个矩的比值组成，比如协方差。 2.1.3：归一化的中心矩 当图像发生平移时，几何距 mpq ​也会发生变化；中心矩 mupq具有平移不变性，但在图像旋转时会发生变化；归一化中心距不仅具有平移不变性，而且具有比例不变性（尺度不变性）。归一化的中心矩定义如下：
2.1.4：不变矩——Hu矩 Hu 利用二阶和三阶归一化中心距构造了 7 个不变矩 M1~M7， 在连续图像下具有平移、灰度、尺度、旋转不变性， 是高度浓缩的图像特征。不变矩能够描述图像的整体性质，从而在边缘提取、图像匹配及目标识别中得到了广泛的应用。
在实际的图像识别中，只有 M1 和 M2 的不变性比较好，而 M3~M7 的误差较大，识别率比较低。Hu不变矩对于物体的形状描述比较稳定，比较适合识别较大尺寸的物体，如水果的形状、车牌的字符等。
2.1.5：OpenCv实现矩特征及其应用 OpenCV 提供了函数 cv2.moments() 计算图像矩 Mu，函数 cv2.HuMoments() 计算目标轮廓的 Hu 不变矩。
函数说明：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b6d92877ff52dfd08cdfefcfe5d98686/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-02T22:01:33+08:00" />
<meta property="article:modified_time" content="2023-11-02T22:01:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">图像特征Vol.1：计算机视觉特征度量|第二弹：【统计区域度量】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">一、前言</a></li><li><a href="#_5" rel="nofollow">二、统计区域度量</a></li><li><ul><li><a href="#21_22" rel="nofollow">2.1：图像矩特征</a></li><li><ul><li><a href="#211_34" rel="nofollow">2.1.1：原始矩/几何矩</a></li><li><a href="#212_42" rel="nofollow">2.1.2：中心距</a></li><li><a href="#213_57" rel="nofollow">2.1.3：归一化的中心矩</a></li><li><a href="#214Hu_60" rel="nofollow">2.1.4：不变矩——Hu矩</a></li><li><a href="#215OpenCv_65" rel="nofollow">2.1.5：OpenCv实现矩特征及其应用</a></li></ul> 
   </li><li><a href="#22_316" rel="nofollow">2.2：点度量特征</a></li><li><a href="#23_378" rel="nofollow">2.3：全局直方图和局部区域直方图</a></li><li><a href="#243D_386" rel="nofollow">2.4：散点图和3D直方图</a></li><li><a href="#25_451" rel="nofollow">2.5：多尺度直方图</a></li><li><a href="#26_493" rel="nofollow">2.6：径向直方图</a></li><li><a href="#26_555" rel="nofollow">2.6：轮廓或边缘直方图</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>一、前言</h2> 
<p>在前篇<a href="https://blog.csdn.net/Yaoyao2024/article/details/134084436?spm=1001.2014.3001.5501">图像特征Vol.1：计算机视觉特征度量【纹理区域特征】</a>中，我们说到计算机视觉度量的三类方法，在那篇博客中，我们介绍了纹理区域度量的各个方法。在本篇博客中，我们将继续介绍纹理区域特征的第二类方法：统计区域度量。Let’s Go！</p> 
<h2><a id="_5"></a>二、统计区域度量</h2> 
<p>统计区域度量，<strong>是利用统计方法，描述图像区域中像素值分布和变化情况的一种方法。</strong> 它主要应用在图像处理和计算机视觉领域。对于图像处理方面，在前面的博客<a href="https://blog.csdn.net/Yaoyao2024/article/details/133294339?spm=1001.2014.3001.5502">【cv】图像预处理技术——从特征检测讲述图像预处理理论、实践、应用|01</a>中，利用全局直方图和局部直方图，对图像进行光照校正、增强对比度，就是统计区域度量在图像处理方面应用的一个体现。这篇博客中，我们将介绍统计区域度量在计算机视觉特征度量中的应用体现。</p> 
<p>常见的图像像素统计度量包括以下八种</p> 
<ol><li>图像矩特征</li><li>点度量特征</li><li>全局直方图</li><li>局部直方图</li><li>散点图和3D直方图</li><li>多尺度直方图</li><li>径向直方图</li><li>轮廓或边缘直方图</li></ol> 
<p>这些统计度量可以通过对图像像素值进行数学运算和分析来得到。它们可以为图像处理和计算机视觉算法提供重要的特征和信息，从而提高算法的性能和鲁棒性。</p> 
<p>接下来，我会基于每种方法给出基本原理，和步骤，以及一些简单的应用举例~Go</p> 
<h3><a id="21_22"></a>2.1：图像矩特征</h3> 
<p><b><font color="#e794af">👧🏻 什么是矩和图像矩？</font></b><br>  矩是概率与统计中的一个概念，是随机变量的一种数字特征。在数字图像处理、计算机视觉与相关领域中，<strong>图像矩(Image moments)是指图像的某些特定像素灰度的加权平均值（矩），或者是图像具有类似功能或意义的属性。</strong></p> 
<p> 图像矩通常用来描述 <strong>分割后</strong>的图像对象。可以通过图像的矩来获得图像的部分性质，包括<strong>面积(或总体亮度)</strong>，以及有关<strong>几何中心</strong>和<strong>方向</strong>的信息 。</p> 
<p><b><font color="#7158e2">💁🏻‍♀️基本思想和原理？</font></b><br>  实际上，<strong>对于矩，我们实际上可以看作是二维图像在基空间上的投影。</strong> 为什么这么说呢？接着看完它的基本思想和原理你应该就懂了。</p> 
<p>根据加权求和的方法不同，有不同种类的矩，且每一种矩有各自不同的表示图像特征的特征值。</p> 
<h4><a id="211_34"></a>2.1.1：原始矩/几何矩</h4> 
<p>对于灰度图像f,其<code>(p+q)阶</code>矩(有时称为"原始矩"),定义如下:<br> <img src="https://images2.imgbox.com/ec/8c/2JutTSLx_o.png" alt="在这里插入图片描述"><br> 原始矩阵中包含以下可以描述图像特征的信息：</p> 
<ol><li>二值图像或者或度图像的<strong>像素总和</strong>,可以表示为:<br> <img src="https://images2.imgbox.com/fa/41/y5VuuXHf_o.png" alt="在这里插入图片描述"></li><li>图像的几何中心也叫质心 <code>(Cx,Cy)</code> ,计算公式如下<br> <img src="https://images2.imgbox.com/33/58/HJ2rtEQJ_o.png" alt="在这里插入图片描述"></li></ol> 
<h4><a id="212_42"></a>2.1.2：中心距</h4> 
<p>当图像平移时，原始矩会发生变化（质心肯定会因为平移而改变嘛）。但是<strong>中心矩具有平移不变性</strong>（但在图像旋转时会发生变化；归一化中心距不仅具有平移不变性，而且具有比例不变性（尺度不变性））。相比于原始矩，它添加了一个基于质心的平移，对于灰度图像f,其<code>(p+q)阶</code>中心矩的定义如下：<br> <img src="https://images2.imgbox.com/af/21/N352vJi6_o.png" alt="在这里插入图片描述"><br> ps.述公式中（cx, cy)是用原始矩求出的图像的几何质心</p> 
<p>中心矩可以用来计算图像的方向和形状等特征，不管是一维的序列分布还是二维的图像，<strong>不同的阶次均具备下述视觉上的规律性性质：</strong></p> 
<ol><li>零阶矩：表示一维均值或二维质心；</li><li>一阶中心矩：包含二维面积、质心和物体/目标大小等相关信息；</li><li>二阶中心矩：与方差和2D椭圆度量相关；</li><li>三阶中心矩：提供了二维形状（或偏度）的对称信息；</li><li>四阶中心矩：用来度量二维分布，如高、矮、细、短、胖等形态；</li><li>更高阶的矩：可由多个矩的比值组成，比如协方差。</li></ol> 
<p><img src="https://images2.imgbox.com/24/97/2kcgf5GZ_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="213_57"></a>2.1.3：归一化的中心矩</h4> 
<p>当图像发生平移时，几何距 <code>mpq</code> ​也会发生变化；中心矩 <code>mupq</code>具有平移不变性，但在图像旋转时会发生变化；<strong>归一化中心距不仅具有平移不变性，而且具有比例不变性（尺度不变性）</strong>。归一化的中心矩定义如下：<br> <img src="https://images2.imgbox.com/97/28/ByCAwfSJ_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="214Hu_60"></a>2.1.4：不变矩——Hu矩</h4> 
<p>Hu 利用二阶和三阶<strong>归一化中心距</strong>构造了 7 个不变矩 M1~M7， <strong>在连续图像下具有平移、灰度、尺度、旋转不变性， 是高度浓缩的图像特征</strong>。不变矩能够描述图像的整体性质，从而在边缘提取、图像匹配及目标识别中得到了广泛的应用。<br> <img src="https://images2.imgbox.com/2c/41/XdPsGB28_o.png" alt="在这里插入图片描述"><br> 在实际的图像识别中，只有 M1 和 M2 的不变性比较好，而 M3~M7 的误差较大，识别率比较低。Hu不变矩对于物体的形状描述比较稳定，比较适合识别较大尺寸的物体，如水果的形状、车牌的字符等。</p> 
<h4><a id="215OpenCv_65"></a>2.1.5：OpenCv实现矩特征及其应用</h4> 
<p>OpenCV 提供了函数 <strong><code>cv2.moments()</code> 计算图像矩 Mu</strong>，函数 <strong><code>cv2.HuMoments()</code> 计算目标轮廓的 Hu 不变矩</strong>。</p> 
<p><strong>函数说明：</strong></p> 
<pre><code class="prism language-python">cv<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token punctuation">,</span> binaryImage<span class="token punctuation">]</span><span class="token punctuation">)</span> → Mu
cv<span class="token punctuation">.</span>HuMoments<span class="token punctuation">(</span>Mu<span class="token punctuation">[</span><span class="token punctuation">,</span> hu<span class="token punctuation">]</span><span class="token punctuation">)</span> → Hu
</code></pre> 
<p><strong>参数说明：</strong></p> 
<ol><li>array：是一幅单通道 8-bits 图像，或一个二维浮点数组（如轮廓列表 contours 中的一个轮廓）</li><li>binaryImage：指示输入图像是否二值图像</li></ol> 
<ul><li>⭐<strong>函数 cv2.moments() 以字典（Dict）形式返回图像的矩。</strong><br> 返回值 Mu 是字典格式，包括 24个键值对。<strong>[‘m00’,‘m10’,‘m01’,‘m20’,‘m11’,‘m02’,‘m30’,‘m21’,‘m12’,‘m03’,‘mu20’,‘mu11’,‘mu02’,‘mu30’,‘mu21’,‘mu12’,‘mu03’,‘nu20’,‘nu11’,‘nu02’,‘nu30’,‘nu21’,nu12’,‘nu03’]</strong> 
  <ol><li>前 10个键值 [‘m00’,‘m10’,‘m01’,‘m20’,‘m11’,‘m02’,‘m30’,‘m21’,‘m12’,‘m03’] 代表几何矩（p+q阶矩），也称原点矩</li><li>中间 7 个键值 [‘mu20’,‘mu11’,‘mu02’,‘mu30’,‘mu21’,‘mu12’,‘mu03’] 代表中心矩</li><li>最后 7 个键值 [‘nu20’,‘nu11’,‘nu02’,‘nu30’,‘nu21’,nu12’,‘nu03’] 代表归一化的中心矩</li></ol> </li><li>⭐ <strong>函数 cv2.HuMoments() 以列表（List）形式返回目标轮廓的 Hu 不变矩。</strong><br> 返回值 Hu 是一个列表（List），包括 7 个不变矩 M1~M7，浮点数。</li></ul> 
<p>🧑🏻‍🚀<b><i><font color="#ff5252">实例1、基于轮廓计算矩及其面积：</font></i></b></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

o <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'2.jpg'</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"original"</span><span class="token punctuation">,</span>o<span class="token punctuation">)</span>
gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>o<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>
ret<span class="token punctuation">,</span> binary <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>gray<span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>THRESH_BINARY<span class="token punctuation">)</span> <span class="token comment"># 转成二值图</span>
contours<span class="token punctuation">,</span> hierarchy <span class="token operator">=</span> cv2<span class="token punctuation">.</span>findContours<span class="token punctuation">(</span>binary<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>RETR_LIST<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>CHAIN_APPROX_SIMPLE<span class="token punctuation">)</span>
n<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>contours<span class="token punctuation">)</span>
contoursImg<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>         <span class="token comment"># 分别展示轮廓</span>
     temp<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>o<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
     contoursImg<span class="token punctuation">.</span>append<span class="token punctuation">(</span>temp<span class="token punctuation">)</span>
     contoursImg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>cv2<span class="token punctuation">.</span>drawContours<span class="token punctuation">(</span>contoursImg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>contours<span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
     cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"contours["</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"]"</span><span class="token punctuation">,</span>contoursImg<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"观察各个轮廓的矩（moments）:"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"轮廓"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"的矩:\n"</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>contours<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"观察各个轮廓的面积:"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"轮廓"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"的面积:%d"</span> <span class="token operator">%</span>cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>contours<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'m00'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出结果：<br> <img src="https://images2.imgbox.com/26/9a/vxK9hWSY_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash">观察各个轮廓的矩（moments）:
轮廓0的矩:
 <span class="token punctuation">{<!-- --></span><span class="token string">'m00'</span><span class="token builtin class-name">:</span> <span class="token number">1456.0</span>, <span class="token string">'m10'</span><span class="token builtin class-name">:</span> <span class="token number">58968.0</span>, <span class="token string">'m01'</span><span class="token builtin class-name">:</span> <span class="token number">242400.8333333333</span>, <span class="token string">'m20'</span><span class="token builtin class-name">:</span> <span class="token number">2504655.333333333</span>, <span class="token string">'m11'</span><span class="token builtin class-name">:</span> <span class="token number">9817233.75</span>, <span class="token string">'m02'</span><span class="token builtin class-name">:</span> <span class="token number">40623554.166666664</span>, <span class="token string">'m30'</span><span class="token builtin class-name">:</span> <span class="token number">110871099.0</span>, <span class="token string">'m21'</span><span class="token builtin class-name">:</span> <span class="token number">416981784.45</span>, <span class="token string">'m12'</span><span class="token builtin class-name">:</span> <span class="token number">1645253943.75</span>, <span class="token string">'m03'</span><span class="token builtin class-name">:</span> <span class="token number">6852302097.35</span>, <span class="token string">'mu20'</span><span class="token builtin class-name">:</span> <span class="token number">116451.33333333302</span>, <span class="token string">'mu11'</span><span class="token builtin class-name">:</span> <span class="token number">0.0</span>, <span class="token string">'mu02'</span><span class="token builtin class-name">:</span> <span class="token number">267672.2980578467</span>, <span class="token string">'mu30'</span><span class="token builtin class-name">:</span> <span class="token number">4</span>.470348358154297e-08, <span class="token string">'mu21'</span><span class="token builtin class-name">:</span> -3476.5477868951857, <span class="token string">'mu12'</span><span class="token builtin class-name">:</span> -8.568167686462402e-08, <span class="token string">'mu03'</span><span class="token builtin class-name">:</span> <span class="token number">339.670916557312</span>, <span class="token string">'nu20'</span><span class="token builtin class-name">:</span> <span class="token number">0.05493153252425217</span>, <span class="token string">'nu11'</span><span class="token builtin class-name">:</span> <span class="token number">0.0</span>, <span class="token string">'nu02'</span><span class="token builtin class-name">:</span> <span class="token number">0.1262643297051641</span>, <span class="token string">'nu30'</span><span class="token builtin class-name">:</span> <span class="token number">5</span>.526344190010775e-16, <span class="token string">'nu21'</span><span class="token builtin class-name">:</span> -4.297785792992532e-05, <span class="token string">'nu12'</span><span class="token builtin class-name">:</span> -1.0592159697520654e-15, <span class="token string">'nu03'</span><span class="token builtin class-name">:</span> <span class="token number">4</span>.199087511397351e-06<span class="token punctuation">}</span>
轮廓1的矩:
 <span class="token punctuation">{<!-- --></span><span class="token string">'m00'</span><span class="token builtin class-name">:</span> <span class="token number">3443.5</span>, <span class="token string">'m10'</span><span class="token builtin class-name">:</span> <span class="token number">420127.3333333333</span>, <span class="token string">'m01'</span><span class="token builtin class-name">:</span> <span class="token number">306481.8333333333</span>, <span class="token string">'m20'</span><span class="token builtin class-name">:</span> <span class="token number">53186976.416666664</span>, <span class="token string">'m11'</span><span class="token builtin class-name">:</span> <span class="token number">37392173.125</span>, <span class="token string">'m02'</span><span class="token builtin class-name">:</span> <span class="token number">27783857.25</span>, <span class="token string">'m30'</span><span class="token builtin class-name">:</span> <span class="token number">6959813898.700001</span>, <span class="token string">'m21'</span><span class="token builtin class-name">:</span> <span class="token number">4733709260.066667</span>, <span class="token string">'m12'</span><span class="token builtin class-name">:</span> <span class="token number">3389725532.9</span>, <span class="token string">'m03'</span><span class="token builtin class-name">:</span> <span class="token number">2562927246.9500003</span>, <span class="token string">'mu20'</span><span class="token builtin class-name">:</span> <span class="token number">1928960.9632681608</span>, <span class="token string">'mu11'</span><span class="token builtin class-name">:</span> -420.26935005933046, <span class="token string">'mu02'</span><span class="token builtin class-name">:</span> <span class="token number">506054.385658171</span>, <span class="token string">'mu30'</span><span class="token builtin class-name">:</span> -540.4464931488037, <span class="token string">'mu21'</span><span class="token builtin class-name">:</span> <span class="token number">11304.976172447205</span>, <span class="token string">'mu12'</span><span class="token builtin class-name">:</span> <span class="token number">5699.499477289617</span>, <span class="token string">'mu03'</span><span class="token builtin class-name">:</span> -140.53871870040894, <span class="token string">'nu20'</span><span class="token builtin class-name">:</span> <span class="token number">0.16267591725263073</span>, <span class="token string">'nu11'</span><span class="token builtin class-name">:</span> -3.5442760800216457e-05, <span class="token string">'nu02'</span><span class="token builtin class-name">:</span> <span class="token number">0.042677308112644856</span>, <span class="token string">'nu30'</span><span class="token builtin class-name">:</span> -7.766985329226633e-07, <span class="token string">'nu21'</span><span class="token builtin class-name">:</span> <span class="token number">1</span>.6246859807910376e-05, <span class="token string">'nu12'</span><span class="token builtin class-name">:</span> <span class="token number">8</span>.190991964093441e-06, <span class="token string">'nu03'</span><span class="token builtin class-name">:</span> -2.0197414178314225e-07<span class="token punctuation">}</span>
轮廓2的矩:
 <span class="token punctuation">{<!-- --></span><span class="token string">'m00'</span><span class="token builtin class-name">:</span> <span class="token number">368.0</span>, <span class="token string">'m10'</span><span class="token builtin class-name">:</span> <span class="token number">80776.0</span>, <span class="token string">'m01'</span><span class="token builtin class-name">:</span> <span class="token number">7728.0</span>, <span class="token string">'m20'</span><span class="token builtin class-name">:</span> <span class="token number">17746554.666666664</span>, <span class="token string">'m11'</span><span class="token builtin class-name">:</span> <span class="token number">1696296.0</span>, <span class="token string">'m02'</span><span class="token builtin class-name">:</span> <span class="token number">170138.66666666666</span>, <span class="token string">'m30'</span><span class="token builtin class-name">:</span> <span class="token number">3902490500.0</span>, <span class="token string">'m21'</span><span class="token builtin class-name">:</span> <span class="token number">372677648.0</span>, <span class="token string">'m12'</span><span class="token builtin class-name">:</span> <span class="token number">37345437.333333336</span>, <span class="token string">'m03'</span><span class="token builtin class-name">:</span> <span class="token number">3902640.0</span>, <span class="token string">'mu20'</span><span class="token builtin class-name">:</span> <span class="token number">16222.666666664183</span>, <span class="token string">'mu11'</span><span class="token builtin class-name">:</span> <span class="token number">0.0</span>, <span class="token string">'mu02'</span><span class="token builtin class-name">:</span> <span class="token number">7850.666666666657</span>, <span class="token string">'mu30'</span><span class="token builtin class-name">:</span> <span class="token number">1</span>.430511474609375e-06, <span class="token string">'mu21'</span><span class="token builtin class-name">:</span> <span class="token number">5</span>.21540641784668e-08, <span class="token string">'mu12'</span><span class="token builtin class-name">:</span> <span class="token number">4</span>.6566128730773926e-09, <span class="token string">'mu03'</span><span class="token builtin class-name">:</span> <span class="token number">4</span>.656612873077393e-10, <span class="token string">'nu20'</span><span class="token builtin class-name">:</span> <span class="token number">0.11979166666664831</span>, <span class="token string">'nu11'</span><span class="token builtin class-name">:</span> <span class="token number">0.0</span>, <span class="token string">'nu02'</span><span class="token builtin class-name">:</span> <span class="token number">0.05797101449275355</span>, <span class="token string">'nu30'</span><span class="token builtin class-name">:</span> <span class="token number">5</span>.50645125550301e-13, <span class="token string">'nu21'</span><span class="token builtin class-name">:</span> <span class="token number">2</span>.0075603535688056e-14, <span class="token string">'nu12'</span><span class="token builtin class-name">:</span> <span class="token number">1</span>.792464601400719e-15, <span class="token string">'nu03'</span><span class="token builtin class-name">:</span> <span class="token number">1</span>.7924646014007192e-16<span class="token punctuation">}</span>
观察各个轮廓的面积:
轮廓0的面积:1456
轮廓1的面积:3443
轮廓2的面积:368

</code></pre> 
<p>🧑🏻‍🚀<b><i><font color="#ff5252">实例2、Hu矩进行形状匹配</font></i></b></p> 
<p>下面这个代码是将原图像进行缩放和旋转等操作，再分别计算各自的Hu矩，根据输出结果可以看到，hu矩是具有平移不变性、旋转不变性和尺度不变性的。</p> 
<pre><code class="prism language-python"><span class="token comment"># # 14.14 特征描述之不变矩</span>
<span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">"Hu1.png"</span><span class="token punctuation">,</span> flags<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 灰度图像</span>
height<span class="token punctuation">,</span> width <span class="token operator">=</span> gray<span class="token punctuation">.</span>shape  <span class="token comment"># (568, 568)</span>

<span class="token comment"># 图像的平移，缩放，旋转和镜像</span>
grayList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
grayList<span class="token punctuation">.</span>append<span class="token punctuation">(</span>gray<span class="token punctuation">)</span>  <span class="token comment"># [0]，原始图像</span>
mat <span class="token operator">=</span> np<span class="token punctuation">.</span>float32<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
grayList<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>warpAffine<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> mat<span class="token punctuation">,</span> <span class="token punctuation">(</span>height<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># [1]，图像平移</span>
top<span class="token punctuation">,</span> bottom<span class="token punctuation">,</span> left<span class="token punctuation">,</span> right <span class="token operator">=</span> height <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> height <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> width <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> width <span class="token operator">//</span> <span class="token number">4</span>
grayResize <span class="token operator">=</span> cv2<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> <span class="token punctuation">(</span>width <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> height <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 图像缩放 (284, 284)</span>
replicate <span class="token operator">=</span> cv2<span class="token punctuation">.</span>copyMakeBorder<span class="token punctuation">(</span>grayResize<span class="token punctuation">,</span> top<span class="token punctuation">,</span> bottom<span class="token punctuation">,</span> left<span class="token punctuation">,</span> right<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>BORDER_CONSTANT<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
grayList<span class="token punctuation">.</span>append<span class="token punctuation">(</span>replicate<span class="token punctuation">)</span>  <span class="token comment"># [2]，图像缩放并填充至原来尺寸 (568, 568)</span>
grayList<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>flip<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># [3]，图像镜像，水平翻转</span>
mar <span class="token operator">=</span> cv2<span class="token punctuation">.</span>getRotationMatrix2D<span class="token punctuation">(</span><span class="token punctuation">(</span>width <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> height <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> angle<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">,</span> scale<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 图像中心作为旋转中心</span>
rotate <span class="token operator">=</span> cv2<span class="token punctuation">.</span>warpAffine<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> mar<span class="token punctuation">,</span> <span class="token punctuation">(</span>height<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 旋转变换，默认为黑色填充</span>
grayList<span class="token punctuation">.</span>append<span class="token punctuation">(</span>rotate<span class="token punctuation">)</span>  <span class="token comment"># [4]，图像旋转 45度</span>
grayList<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>rotate<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>ROTATE_90_COUNTERCLOCKWISE<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># [5]，图像逆时针旋转90度</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>gray<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> grayResize<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> replicate<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> rotate<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>grayList<span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>grayList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    moments <span class="token operator">=</span> cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>grayList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 返回几何矩 mpq, 中心矩 mupq 和归一化矩 nupq</span>
    huM <span class="token operator">=</span> cv2<span class="token punctuation">.</span>HuMoments<span class="token punctuation">(</span>moments<span class="token punctuation">)</span>  <span class="token comment"># 计算 Hu 不变矩</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>grayList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'gray'</span><span class="token punctuation">)</span>
    <span class="token comment"># print("Moments of gray:\n", moments)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"HuMoments of gray:\n"</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>log10<span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>huM<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>输出结果：<br> <img src="https://images2.imgbox.com/56/0b/OiQfk1ZX_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash">HuMoments of gray:
 <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-2.7619</span>  <span class="token parameter variable">-6.5682</span> <span class="token parameter variable">-10.2914</span>  <span class="token parameter variable">-9.8954</span> <span class="token parameter variable">-20.4914</span> <span class="token parameter variable">-13.7315</span> -20.0114<span class="token punctuation">]</span><span class="token punctuation">]</span>
HuMoments of gray:
 <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-2.7198</span>  <span class="token parameter variable">-7.1721</span>  <span class="token parameter variable">-9.9113</span>  <span class="token parameter variable">-9.5982</span> <span class="token parameter variable">-19.8569</span> <span class="token parameter variable">-13.185</span>  -19.3754<span class="token punctuation">]</span><span class="token punctuation">]</span>
HuMoments of gray:
 <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-2.7612</span>  <span class="token parameter variable">-6.5649</span> <span class="token parameter variable">-10.2883</span>  <span class="token parameter variable">-9.8929</span> <span class="token parameter variable">-20.4913</span> <span class="token parameter variable">-13.7241</span> -20.0055<span class="token punctuation">]</span><span class="token punctuation">]</span>
HuMoments of gray:
 <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-2.7619</span>  <span class="token parameter variable">-6.5682</span> <span class="token parameter variable">-10.2914</span>  <span class="token parameter variable">-9.8954</span> <span class="token parameter variable">-20.4914</span> <span class="token parameter variable">-13.7315</span> -20.0114<span class="token punctuation">]</span><span class="token punctuation">]</span>
HuMoments of gray:
 <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-2.7092</span>  <span class="token parameter variable">-6.5701</span>  <span class="token parameter variable">-9.6241</span> <span class="token parameter variable">-10.073</span>  <span class="token parameter variable">-20.0139</span> <span class="token parameter variable">-13.7624</span> -20.1516<span class="token punctuation">]</span><span class="token punctuation">]</span>
HuMoments of gray:
 <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-2.7619</span>  <span class="token parameter variable">-6.5682</span> <span class="token parameter variable">-10.2914</span>  <span class="token parameter variable">-9.8954</span> <span class="token parameter variable">-20.4914</span> <span class="token parameter variable">-13.7315</span> -20.0114<span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<p>OpenCV提供了一个名为matchShapes的实用程序函数，它<strong>可以获取两幅图像(或轮廓)，并使用Hu矩查找它们之间的距离。所以，你不需要明确地计算Hu力矩。只需要简单地对图像进行二值化并使用matchShapes。</strong></p> 
<p>方法介绍：</p> 
<pre><code class="prism language-python">retval <span class="token operator">=</span> cv2<span class="token punctuation">.</span>matchShapes<span class="token punctuation">(</span> contour1<span class="token punctuation">,</span> contour2<span class="token punctuation">,</span> method<span class="token punctuation">,</span> parameter <span class="token punctuation">)</span>
</code></pre> 
<ul><li> <p>contour1 第一个轮廓或者灰度图像</p> </li><li> <p>contour2 第二个灰度或轮廓图像 ，不管是什么，这个函数都会提前计算好对象的Hu矩。</p> </li><li> <p>method 比较两个对象的Hu 矩的方法(距离函数），ℎ𝑖𝐴和ℎ𝑖𝐵分别是对象 A 和对象 B 的 Hu 矩。</p> <p><img src="https://images2.imgbox.com/45/ce/dp8iCZqv_o.png" alt="在这里插入图片描述"><br> 以下代码实现的功能是分别将Hu1和Hu1自身比、Hu1和Hu2比、Hu1和Hu3比<br> <img src="https://images2.imgbox.com/2b/57/e2PPbbtL_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<pre><code class="prism language-python"><span class="token keyword">import</span> cv2

o1 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'Hu4.png'</span><span class="token punctuation">)</span>
o2 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'Hu5.png'</span><span class="token punctuation">)</span>
o3 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'Hu6.png'</span><span class="token punctuation">)</span>
gray1 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>o1<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>
gray2 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>o2<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>
gray3 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>o3<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>
ret<span class="token punctuation">,</span> binary1 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>gray1<span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>THRESH_BINARY<span class="token punctuation">)</span>
ret<span class="token punctuation">,</span> binary2 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>gray2<span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>THRESH_BINARY<span class="token punctuation">)</span>
ret<span class="token punctuation">,</span> binary3 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>threshold<span class="token punctuation">(</span>gray3<span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>THRESH_BINARY<span class="token punctuation">)</span>
contours1<span class="token punctuation">,</span> hierarchy <span class="token operator">=</span> cv2<span class="token punctuation">.</span>findContours<span class="token punctuation">(</span>binary1<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>RETR_LIST<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>CHAIN_APPROX_SIMPLE<span class="token punctuation">)</span>
contours2<span class="token punctuation">,</span> hierarchy <span class="token operator">=</span> cv2<span class="token punctuation">.</span>findContours<span class="token punctuation">(</span>binary2<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>RETR_LIST<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>CHAIN_APPROX_SIMPLE<span class="token punctuation">)</span>
contours3<span class="token punctuation">,</span> hierarchy <span class="token operator">=</span> cv2<span class="token punctuation">.</span>findContours<span class="token punctuation">(</span>binary3<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>RETR_LIST<span class="token punctuation">,</span>
 cv2<span class="token punctuation">.</span>CHAIN_APPROX_SIMPLE<span class="token punctuation">)</span>
cnt1 <span class="token operator">=</span> contours1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
cnt2 <span class="token operator">=</span> contours2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
cnt3 <span class="token operator">=</span> contours3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
ret0 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>matchShapes<span class="token punctuation">(</span>cnt1<span class="token punctuation">,</span>cnt1<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">)</span>
ret1 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>matchShapes<span class="token punctuation">(</span>cnt1<span class="token punctuation">,</span>cnt2<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">)</span>
ret2 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>matchShapes<span class="token punctuation">(</span>cnt1<span class="token punctuation">,</span>cnt3<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"相同图像的 matchShape="</span><span class="token punctuation">,</span>ret0<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"相似图像的 matchShape="</span><span class="token punctuation">,</span>ret1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"不相似图像的 matchShape="</span><span class="token punctuation">,</span>ret2<span class="token punctuation">)</span>


</code></pre> 
<p>输出结果：</p> 
<pre><code class="prism language-bash">相同图像的 <span class="token assign-left variable">matchShape</span><span class="token operator">=</span> <span class="token number">0.0</span>
相似图像的 <span class="token assign-left variable">matchShape</span><span class="token operator">=</span> <span class="token number">0.2135632086586597</span>
不相似图像的 <span class="token assign-left variable">matchShape</span><span class="token operator">=</span> <span class="token number">1.6939812402126888</span>
</code></pre> 
<p>🧑🏻‍🚀<b><i><font color="#ff5252">实例3、前景物体的中心点以及长轴的角度</font></i></b><br> <img src="https://images2.imgbox.com/96/a7/qb591nxx_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-bash"><span class="token comment"># 利用矩求出前景物体的中心点以及长轴的角度,我们可以计算出大雁群的质心和长轴角度</span>
<span class="token function">import</span> cv2
<span class="token function">import</span> numpy as np

<span class="token comment"># 读入图像</span>
img_file <span class="token operator">=</span> <span class="token string">"1.jpg"</span>
img <span class="token operator">=</span> cv2.imread<span class="token punctuation">(</span>img_file,cv2.IMREAD_COLOR<span class="token punctuation">)</span>
<span class="token comment"># 将图像转换为灰度图像</span>
gray_img <span class="token operator">=</span> cv2.cvtColor<span class="token punctuation">(</span>img,cv2.COLOR_RGB2GRAY<span class="token punctuation">)</span>

<span class="token comment"># 二值化，分割前景物体</span>
retval, bin_img <span class="token operator">=</span> cv2.threshold<span class="token punctuation">(</span>gray_img, <span class="token number">50</span>, <span class="token number">1</span>, cv2.THRESH_BINARY<span class="token punctuation">)</span>
<span class="token comment"># show_img = bin_img * 255</span>
show_img <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> - bin_img<span class="token punctuation">)</span> * <span class="token number">255</span>

moments <span class="token operator">=</span> cv2.moments<span class="token punctuation">(</span>show_img<span class="token punctuation">)</span>

cx <span class="token operator">=</span> moments<span class="token punctuation">[</span><span class="token string">'m10'</span><span class="token punctuation">]</span>/moments<span class="token punctuation">[</span><span class="token string">'m00'</span><span class="token punctuation">]</span> <span class="token comment"># m10/m00</span>
cy <span class="token operator">=</span> moments<span class="token punctuation">[</span><span class="token string">'m01'</span><span class="token punctuation">]</span>/moments<span class="token punctuation">[</span><span class="token string">'m00'</span><span class="token punctuation">]</span> <span class="token comment"># m01/m00</span>
print<span class="token punctuation">(</span><span class="token string">'Centriod: ({0:.2f}, {1:.2f})'</span>.format<span class="token punctuation">(</span>cx, cy<span class="token punctuation">))</span>

mu00 <span class="token operator">=</span> moments<span class="token punctuation">[</span><span class="token string">'m00'</span><span class="token punctuation">]</span>
mu11 <span class="token operator">=</span>moments<span class="token punctuation">[</span><span class="token string">'mu11'</span><span class="token punctuation">]</span>
mu20 <span class="token operator">=</span> moments<span class="token punctuation">[</span><span class="token string">'mu20'</span><span class="token punctuation">]</span>
mu02 <span class="token operator">=</span> moments<span class="token punctuation">[</span><span class="token string">'mu02'</span><span class="token punctuation">]</span>
theta <span class="token operator">=</span> <span class="token number">1</span>/2*np.arctan2<span class="token punctuation">(</span><span class="token number">2</span>*mu11/mu00, <span class="token punctuation">(</span>mu20 - mu02<span class="token punctuation">)</span>/mu00<span class="token punctuation">)</span>
angle_degrees <span class="token operator">=</span> theta * <span class="token number">180</span> / np.pi
print<span class="token punctuation">(</span><span class="token string">'Angle: {0:.2f}'</span>.format<span class="token punctuation">(</span>angle_degrees<span class="token punctuation">))</span>

<span class="token comment"># visual</span>
rho <span class="token operator">=</span> <span class="token number">800</span>
dx_major <span class="token operator">=</span> rho * np.cos<span class="token punctuation">(</span>theta<span class="token punctuation">)</span>
dy_major <span class="token operator">=</span> rho * np.sin<span class="token punctuation">(</span>theta<span class="token punctuation">)</span>
dx_minor <span class="token operator">=</span> <span class="token number">0.3</span> * rho * np.cos<span class="token punctuation">(</span>theta - np.pi / <span class="token number">2</span><span class="token punctuation">)</span>
dy_minor <span class="token operator">=</span> <span class="token number">0.3</span> * rho * np.sin<span class="token punctuation">(</span>theta - np.pi / <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># short</span>
<span class="token assign-left variable">short_axis</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span>int<span class="token punctuation">(</span>cx-dx_minor<span class="token punctuation">)</span>,int<span class="token punctuation">(</span>cy-dy_minor<span class="token punctuation">))</span>,<span class="token punctuation">(</span>int<span class="token punctuation">(</span>cx<span class="token punctuation">)</span>,int<span class="token punctuation">(</span>cy<span class="token punctuation">))</span>,<span class="token punctuation">(</span>int<span class="token punctuation">(</span>cx+dx_minor<span class="token punctuation">)</span>,int<span class="token punctuation">(</span>cy+dy_minor<span class="token punctuation">))</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>short_axis<span class="token punctuation">)</span>-1<span class="token punctuation">)</span>:
    cv2.line<span class="token punctuation">(</span>img,short_axis<span class="token punctuation">[</span>i<span class="token punctuation">]</span>,short_axis<span class="token punctuation">[</span>i+1<span class="token punctuation">]</span>,color<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">255,0</span>,0<span class="token punctuation">)</span>,thickness<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">pt</span> <span class="token keyword">in</span> short_axis:
    cv2.circle<span class="token punctuation">(</span>img,pt,radius<span class="token operator">=</span><span class="token number">5</span>,color<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">255,0</span>,0<span class="token punctuation">)</span>,thickness<span class="token operator">=</span><span class="token number">3</span>,lineType<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token comment"># long</span>
long_axis <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>int<span class="token punctuation">(</span>cx - dx_major<span class="token punctuation">)</span>, int<span class="token punctuation">(</span>cy - dy_major<span class="token punctuation">))</span>, <span class="token punctuation">(</span>int<span class="token punctuation">(</span>cx<span class="token punctuation">)</span>, int<span class="token punctuation">(</span>cy<span class="token punctuation">))</span>, <span class="token punctuation">(</span>int<span class="token punctuation">(</span>cx + dx_major<span class="token punctuation">)</span>, int<span class="token punctuation">(</span>cy + dy_major<span class="token punctuation">))</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>long_axis<span class="token punctuation">)</span> - <span class="token number">1</span><span class="token punctuation">)</span>:
    cv2.line<span class="token punctuation">(</span>img, long_axis<span class="token punctuation">[</span>i<span class="token punctuation">]</span>, long_axis<span class="token punctuation">[</span>i + <span class="token number">1</span><span class="token punctuation">]</span>, <span class="token assign-left variable">color</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">0</span>, <span class="token number">255</span><span class="token punctuation">)</span>, <span class="token assign-left variable">thickness</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">pt</span> <span class="token keyword">in</span> long_axis:
    cv2.circle<span class="token punctuation">(</span>img,pt,radius<span class="token operator">=</span><span class="token number">5</span>,color<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0,0</span>,255<span class="token punctuation">)</span>,thickness<span class="token operator">=</span><span class="token number">3</span>,lineType<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token comment"># center</span>
cv2.circle<span class="token punctuation">(</span>img, <span class="token punctuation">(</span>int<span class="token punctuation">(</span>cx<span class="token punctuation">)</span>,int<span class="token punctuation">(</span>cy<span class="token punctuation">))</span>, <span class="token assign-left variable">radius</span><span class="token operator">=</span><span class="token number">5</span>, <span class="token assign-left variable">color</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">255</span>, <span class="token number">0</span><span class="token punctuation">)</span>, <span class="token assign-left variable">thickness</span><span class="token operator">=</span><span class="token number">3</span>, <span class="token assign-left variable">lineType</span><span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token comment"># show</span>
cv2.imshow<span class="token punctuation">(</span><span class="token string">"img"</span>,img<span class="token punctuation">)</span>
cv2.waitKey<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行结果：</p> 
<pre><code class="prism language-bash">Centriod: <span class="token punctuation">(</span><span class="token number">773.86</span>, <span class="token number">497.30</span><span class="token punctuation">)</span>
Angle: <span class="token number">36.76</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d1/97/45QkvFct_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="22_316"></a>2.2：点度量特征</h3> 
<p>点度量特征主要就是指<strong>描述图像中单个像素点的特征</strong>的方法。对于像素点，特征主要包括以下几种</p> 
<ul><li>灰度值</li><li>梯度</li><li>方向</li><li>角点</li><li>纹理特征</li></ul> 
<p>其中，前三个较为常见，前面也一直有用到。对于角点，属于兴趣点特征，涉及到特征提取方面的知识，这个在后续的会深入讲解。纹理特征呢，就不是单个像素点，而是多个像素点组合的特征度量，这个在前一篇纹理特征度量中也有很好的分析。</p> 
<p>点特征度量的核心下游任务就是图像分割。</p> 
<p>这里就简单对灰度、梯度、方向三个点特征进行阐述：</p> 
<ul><li> <p>灰度<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
        
         
          
          
            I 
           
          
            ( 
           
          
            x 
           
          
            , 
           
          
            y 
           
          
            ) 
           
          
         
           I(x,y) 
          
         
       </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span></span></span></span></span></span></p> </li><li> <p>梯度</p> </li></ul> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ▽ 
         
        
          I 
         
        
          ( 
         
        
          x 
         
        
          , 
         
        
          y 
         
        
          ) 
         
        
          = 
         
        
          ( 
         
         
         
           G 
          
         
           x 
          
         
        
          , 
         
         
         
           G 
          
         
           y 
          
         
        
          ) 
         
        
          = 
         
         
         
           ( 
          
          
           
            
             
              
               
               
                 ∂ 
                
               
                 I 
                
               
               
               
                 ∂ 
                
               
                 x 
                
               
              
             
            
           
           
            
             
              
               
               
                 ∂ 
                
               
                 I 
                
               
               
               
                 ∂ 
                
               
                 y 
                
               
              
             
            
           
          
         
           ) 
          
         
        
       
         {\bigtriangledown I(x,y)=(G_{x},G_{y})=\begin{pmatrix}\frac{\partial I}{\partial x} \\\frac{\partial I}{\partial y} \end{pmatrix} } 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 2.6013em; vertical-align: -1.0507em;"></span><span class="mord"><span class="mord">▽</span><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.5507em;"><span class="" style="top: -3.6706em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8801em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.0556em;">∂</span><span class="mord mathnormal mtight">x</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.0556em;">∂</span><span class="mord mathnormal mtight" style="margin-right: 0.0785em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top: -2.4304em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8801em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.0556em;">∂</span><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">y</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right: 0.0556em;">∂</span><span class="mord mathnormal mtight" style="margin-right: 0.0785em;">I</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4811em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.0507em;"><span class=""></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></span></span></p> 
<ul><li>方向<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
         
           θ 
          
         
           ( 
          
         
           x 
          
         
           , 
          
         
           y 
          
         
           ) 
          
         
           = 
          
         
           arctan 
          
         
           ⁡ 
          
          
           
           
             G 
            
           
             x 
            
           
           
           
             G 
            
           
             y 
            
           
          
          
         
        
          \theta (x,y)=\arctan \frac{G_{x} }{G_{y}}\mathbf{} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.3324em; vertical-align: -0.9721em;"></span><span class="mop">arctan</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3603em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.9721em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"></span></span></span></span></span></span></li></ul> 
<p>🧑🏻‍🚀<b><i><font color="#ff5252">实例1、基于HSV颜色阈值的图像分割</font></i></b></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment"># 1. 加载图像</span>
img_file <span class="token operator">=</span> <span class="token string">"./lan.jpg"</span>
image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>img_file<span class="token punctuation">,</span>cv2<span class="token punctuation">.</span>IMREAD_COLOR<span class="token punctuation">)</span>

<span class="token comment"># 2. 颜色空间转换（从RGB到HSV）</span>
hsv_image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>image<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2HSV<span class="token punctuation">)</span>

<span class="token comment"># 3. 颜色阈值分割（这里选择蓝色的范围）</span>
lower_blue <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># HSV中的下限</span>
upper_blue <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># HSV中的上限</span>

<span class="token comment"># 根据颜色阈值创建一个二进制掩码</span>
mask <span class="token operator">=</span> cv2<span class="token punctuation">.</span>inRange<span class="token punctuation">(</span>hsv_image<span class="token punctuation">,</span> lower_blue<span class="token punctuation">,</span> upper_blue<span class="token punctuation">)</span>

<span class="token comment"># 4. 创建二值掩码</span>
result <span class="token operator">=</span> cv2<span class="token punctuation">.</span>bitwise_and<span class="token punctuation">(</span>image<span class="token punctuation">,</span> image<span class="token punctuation">,</span> mask<span class="token operator">=</span>mask<span class="token punctuation">)</span>

<span class="token comment"># 显示分割结果</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'origin image'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">122</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Segmented Image'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/bc/2d/EfBWV5ZA_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="23_378"></a>2.3：全局直方图和局部区域直方图</h3> 
<p>图像的全局直方图和局部区域直方图都是描述图像中像素值分布的方法，可以用来表示图像中<strong>每个灰度级别的像素数量。</strong></p> 
<p>全局直方图是一个<strong>一维向量</strong>，长度为图像的灰度级别数，向量元素值通常是该灰度值出现的像素个数或者像素频率。局部区域直方图就是加窗之后的窗内小图像的全局直方图而已。</p> 
<p>下面是SAR图像的全局直方图示例，其中右边列为对应Image的全局直方图，直方图向量的分布变化可以作为诸如SAR图像变化检测的依据<br> <img src="https://images2.imgbox.com/8e/a2/oLYpjk8E_o.png" alt="在这里插入图片描述">a</p> 
<h3><a id="243D_386"></a>2.4：散点图和3D直方图</h3> 
<p>散点图和3D直方图都是<strong>描述图像特征之间关系</strong>的方法。它们可以用来表示<strong>图像中不同特征之间的相关性和分布</strong>情况，从而提供图像的多维特征信息。</p> 
<p><strong>（1）散点图</strong><br> 散点图是二维坐标体系，其中<strong>每个点表示图像中两个特征之间的一个数据点</strong>。<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          S 
         
        
          ( 
         
        
          i 
         
        
          , 
         
        
          j 
         
        
          ) 
         
        
          = 
         
        
          ( 
         
         
         
           f 
          
         
           i 
          
         
        
          ( 
         
        
          x 
         
        
          , 
         
        
          y 
         
        
          ) 
         
        
          , 
         
         
         
           f 
          
         
           j 
          
         
        
          ( 
         
        
          x 
         
        
          , 
         
        
          y 
         
        
          ) 
         
        
          ) 
         
        
          ∣ 
         
        
          I 
         
        
          ( 
         
        
          x 
         
        
          , 
         
        
          y 
         
        
          ) 
         
        
          ∈ 
         
        
          Ω 
         
        
       
         S(i,j)=(f_{i}(x,y), f_{j}(x,y))|I(x,y)\in \Omega 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">S</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0572em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0361em; vertical-align: -0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">))</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right: 0.0785em;">I</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord">Ω</span></span></span></span></span></span></p> 
<p>其中<code>S(i,j)</code>表示特征<code>fi</code>和特征<code>fj</code>之间的散点图。比如我们要表征RGB三通道之间的相互关系，这里图像特征可以定义为不同通道下的像素值，<code>I(x,y)</code>为图像在<code>(x,y)</code>位置的像素点，<code>Ω</code>为图像的像素点集合。</p> 
<p><strong>(2) 3D直方图</strong></p> 
<p>图像3D直方图同样也是用来描述图像中不同特征之间的相关性和分布情况。</p> 
<p>下面就以一个表示图像中颜色特征分布的示例来更好得了解一下</p> 
<p>下面创建的3D直方图用于显示图像中红色通道和绿色通道的像素分布情况。这意味着x轴表示红色通道的像素值，y轴表示绿色通道的像素值，而z轴表示在这两个通道上像素值组合的频率。从图中可以了解<strong>哪些颜色组合在图像中较为常见，哪些较为罕见。这对于分析图像中的颜色特征和结构非常有帮助</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 这个示例演示了如何创建一个表示图像颜色分布的3D直方图</span>
<span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> mpl_toolkits<span class="token punctuation">.</span>mplot3d <span class="token keyword">import</span> Axes3D
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token comment"># 读取图像</span>
img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'./4.jpg'</span><span class="token punctuation">)</span>

<span class="token comment"># 将图像从BGR颜色空间转换为RGB</span>
img_rgb <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2RGB<span class="token punctuation">)</span>

<span class="token comment"># 获取图像的三个颜色通道</span>
r<span class="token punctuation">,</span> g<span class="token punctuation">,</span> b <span class="token operator">=</span> cv2<span class="token punctuation">.</span>split<span class="token punctuation">(</span>img_rgb<span class="token punctuation">)</span>

<span class="token comment"># 创建3D直方图</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">,</span> projection<span class="token operator">=</span><span class="token string">'3d'</span><span class="token punctuation">)</span>

hist<span class="token punctuation">,</span> xedges<span class="token punctuation">,</span> yedges <span class="token operator">=</span> np<span class="token punctuation">.</span>histogram2d<span class="token punctuation">(</span>r<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> g<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

x<span class="token punctuation">,</span> y <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>xedges<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> yedges<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 绘制3D直方图</span>
ax<span class="token punctuation">.</span>plot_surface<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> hist<span class="token punctuation">.</span>T<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'viridis'</span><span class="token punctuation">)</span>

<span class="token comment"># 设置坐标轴标签</span>
ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'Red Channel'</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'Green Channel'</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_zlabel<span class="token punctuation">(</span><span class="token string">'Frequency'</span><span class="token punctuation">)</span>

<span class="token comment"># 显示图形</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>结果：<br> <img src="https://images2.imgbox.com/03/24/1MSm994K_o.png" alt="在这里插入图片描述"></p> 
<ul><li> <p>直方图的箱子（Bins）： 在x轴和y轴上，像素值被划分为不同的分箱（bins），每个区间代表一个像素值范围。在这个例子中，x轴和y轴各有256个分箱，分别表示0到255的像素值范围。</p> </li><li> <p>Z轴的高度： Z轴上的高度（颜色越亮）表示在对应的红色和绿色通道像素值组合中出现的频率。较高的柱子表示该像素值组合在图像中出现的次数更多。</p> </li><li> <p>颜色映射： 3D直方图中的颜色映射（cmap）通常用于表示频率的大小。在这个示例中，使用的是’viridis’颜色映射，颜色从暗紫色到明黄色表示频率从低到高。</p> </li><li> <p>坐标轴标签： x轴标签是“Red Channel”（红色通道），y轴标签是“Green Channel”（绿色通道），z轴标签是“Frequency”（频率）。</p> </li></ul> 
<h3><a id="25_451"></a>2.5：多尺度直方图</h3> 
<p>将图像进行尺度变换后，得到不同尺度下的直方图，这有利于尺度不变的特征分析。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 读取图像</span>
image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'./5.jpg'</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>IMREAD_GRAYSCALE<span class="token punctuation">)</span>

<span class="token comment"># 定义不同尺度的比例因子</span>
scales <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">]</span>

<span class="token comment"># 初始化一个空的多分辨率直方图列表</span>
multi_resolution_histograms <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> scale <span class="token keyword">in</span> scales<span class="token punctuation">:</span>
    <span class="token comment"># 缩放图像</span>
    scaled_image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> fx<span class="token operator">=</span>scale<span class="token punctuation">,</span> fy<span class="token operator">=</span>scale<span class="token punctuation">)</span>
    
    <span class="token comment"># 计算直方图</span>
    hist <span class="token operator">=</span> cv2<span class="token punctuation">.</span>calcHist<span class="token punctuation">(</span><span class="token punctuation">[</span>scaled_image<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 归一化直方图</span>
    hist <span class="token operator">=</span> cv2<span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>hist<span class="token punctuation">,</span> hist<span class="token punctuation">)</span>
    
    <span class="token comment"># 添加到多分辨率直方图列表</span>
    multi_resolution_histograms<span class="token punctuation">.</span>append<span class="token punctuation">(</span>hist<span class="token punctuation">)</span>

<span class="token comment"># 显示多分辨率直方图</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> hist <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>multi_resolution_histograms<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>hist<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f'Scale </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>scales<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Multi-Resolution Histograms'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Pixel Value'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Frequency'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/9d/03/geW3gUk1_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="26_493"></a>2.6：径向直方图</h3> 
<p>径向直方图是一种<strong>描述图像中像素到中心点的距离和方向的关系</strong>方法，它可以用来表示图像中径向纹理和特征信息。径向直方图是由一系列的<strong>环形区域</strong>直方图组成的，每个环形区域直方图对应着图像中不同距离和方向下的像素分布情况。</p> 
<p>径向直方图的计算步骤：</p> 
<ul><li>首先计算出选定图像或者区域的质心，作为起点</li><li>定义从质心发出投影射线的数量以及步长</li><li>遍历投影射线（也就是不同方向上）计算距离质心距离为r的像素值</li></ul> 
<p><img src="https://images2.imgbox.com/04/54/GSaVaGIh_o.jpg" alt="在这里插入图片描述"><br> 在直方图中，横坐标是像素点距离质心的距离，竖坐标是累计像素值</p> 
<pre><code class="prism language-python"><span class="token comment"># 径向直方图绘制</span>
<span class="token comment"># 我们将使用形状的质心作为起点，绘制多个直线到形状的边界，并记录每条线上的像素值。然后，我们将这些像素值分箱，得到径向直方图。</span>
<span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 读取包含形状的二值图像</span>
shape_image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'./5.jpg'</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>IMREAD_GRAYSCALE<span class="token punctuation">)</span>

<span class="token comment"># 寻找形状的质心</span>
M <span class="token operator">=</span> cv2<span class="token punctuation">.</span>moments<span class="token punctuation">(</span>shape_image<span class="token punctuation">)</span>
cx <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>M<span class="token punctuation">[</span><span class="token string">'m10'</span><span class="token punctuation">]</span> <span class="token operator">/</span> M<span class="token punctuation">[</span><span class="token string">'m00'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
cy <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>M<span class="token punctuation">[</span><span class="token string">'m01'</span><span class="token punctuation">]</span> <span class="token operator">/</span> M<span class="token punctuation">[</span><span class="token string">'m00'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 定义投影的角度范围和步长</span>
num_projections <span class="token operator">=</span> <span class="token number">360</span>  <span class="token comment"># 投影线的数量</span>
angle_step <span class="token operator">=</span> <span class="token number">360</span> <span class="token operator">/</span> num_projections

<span class="token comment"># 初始化径向直方图</span>
hist_size <span class="token operator">=</span> <span class="token number">100</span>  <span class="token comment"># 直方图的箱数</span>
hist_range <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>  <span class="token comment"># 像素值范围</span>
radial_histogram <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>hist_size<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>

<span class="token comment"># 计算径向直方图</span>
<span class="token keyword">for</span> angle <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">360</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>angle_step<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    angle_rad <span class="token operator">=</span> np<span class="token punctuation">.</span>deg2rad<span class="token punctuation">(</span>angle<span class="token punctuation">)</span>
    <span class="token keyword">for</span> r <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>hist_size<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># r是像素点距离质心的距离</span>
        x <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>cx <span class="token operator">+</span> r <span class="token operator">*</span> np<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>angle_rad<span class="token punctuation">)</span><span class="token punctuation">)</span>
        y <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>cy <span class="token operator">+</span> r <span class="token operator">*</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>angle_rad<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> x <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token keyword">and</span> x <span class="token operator">&lt;</span> shape_image<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">and</span> y <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token keyword">and</span> y <span class="token operator">&lt;</span> shape_image<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            pixel_value <span class="token operator">=</span> shape_image<span class="token punctuation">[</span>y<span class="token punctuation">,</span> x<span class="token punctuation">]</span>
            radial_histogram<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">+=</span> pixel_value

<span class="token comment"># 可视化径向直方图</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>radial_histogram<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Radial Histogram'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Radius from Centroid'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Sum of Pixel Values'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>输出结果：<br> <img src="https://images2.imgbox.com/b8/e6/JbEIhj13_o.png" alt="在这里插入图片描述"><br> 径向直方图一般用于具备多个环形特征或者极坐标图像下目标特征描述、检测和定位。</p> 
<h3><a id="26_555"></a>2.6：轮廓或边缘直方图</h3> 
<p>在计算机视觉特征度量中，关于轮廓或边缘直方图描述符主要有三种,分别是：<strong>边缘直方图（Edge Histogram， EHD）、边缘方向直方图（Edge Direction Histogram,EDH)、梯度直方图（Histogram of Oriented Gradients, HOG)。</strong> 它们在特征提取和图像识别任务中有不同的应用和特点。</p> 
<p>它们的核心都是：<strong>对特征进行定位并且得到灰度图、计算得到各个像素点的梯度大小和边缘方向角（边缘检测）、对灰度图进行分块并且计算每一块子图的灰度边缘方向直方图特征向量。</strong></p> 
<p>下面展示了绘制图像边缘方向直方图并且利用计算的每个像素点的梯度信息进行了模板匹配</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 加载原始图像</span>
image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'tuxiang.jpg'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
origin_image <span class="token operator">=</span> image<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 计算边缘梯度</span>
sobel_x <span class="token operator">=</span> cv2<span class="token punctuation">.</span>Sobel<span class="token punctuation">(</span>image<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>CV_64F<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ksize<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
sobel_y <span class="token operator">=</span> cv2<span class="token punctuation">.</span>Sobel<span class="token punctuation">(</span>image<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>CV_64F<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> ksize<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
gradient_magnitude <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>sobel_x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> sobel_y<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
gradient_direction <span class="token operator">=</span> np<span class="token punctuation">.</span>arctan2<span class="token punctuation">(</span>sobel_y<span class="token punctuation">,</span> sobel_x<span class="token punctuation">)</span>


<span class="token comment"># 将梯度幅值转换为8位无符号整数类型</span>
gradient_magnitude <span class="token operator">=</span> cv2<span class="token punctuation">.</span>convertScaleAbs<span class="token punctuation">(</span>gradient_magnitude<span class="token punctuation">)</span>

<span class="token comment"># 定义边缘梯度特征的分箱和直方图参数</span>
num_bins <span class="token operator">=</span> <span class="token number">9</span>  <span class="token comment"># 分箱数目</span>
bin_range <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>np<span class="token punctuation">.</span>pi<span class="token punctuation">)</span>  <span class="token comment"># 方向范围</span>

<span class="token comment"># 计算边缘梯度特征直方图</span>
hist<span class="token punctuation">,</span> bin_edges <span class="token operator">=</span> np<span class="token punctuation">.</span>histogram<span class="token punctuation">(</span>gradient_direction<span class="token punctuation">,</span> bins<span class="token operator">=</span>num_bins<span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token operator">=</span>bin_range<span class="token punctuation">)</span>

<span class="token comment"># 可视化边缘梯度特征直方图</span>
bin_centers <span class="token operator">=</span> <span class="token punctuation">(</span>bin_edges<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> bin_edges<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>bin_centers<span class="token punctuation">,</span> hist<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>np<span class="token punctuation">.</span>pi<span class="token operator">/</span>num_bins<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Gradient Direction'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Frequency'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 加载边缘模板</span>
template <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'moshi2.jpg'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># 计算边缘梯度</span>
sobel_x_template <span class="token operator">=</span> cv2<span class="token punctuation">.</span>Sobel<span class="token punctuation">(</span>template<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>CV_64F<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ksize<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
sobel_y_template <span class="token operator">=</span> cv2<span class="token punctuation">.</span>Sobel<span class="token punctuation">(</span>template<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>CV_64F<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> ksize<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
gradient_magnitude_template <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>sobel_x_template<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> sobel_y_template<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
gradient_direction_template <span class="token operator">=</span> np<span class="token punctuation">.</span>arctan2<span class="token punctuation">(</span>sobel_y_template<span class="token punctuation">,</span> sobel_x_template<span class="token punctuation">)</span>


<span class="token comment"># 将梯度幅值转换为8位无符号整数类型</span>
gradient_magnitude_template <span class="token operator">=</span> cv2<span class="token punctuation">.</span>convertScaleAbs<span class="token punctuation">(</span>gradient_magnitude_template<span class="token punctuation">)</span>


<span class="token comment"># 进行模板匹配</span>
result <span class="token operator">=</span> cv2<span class="token punctuation">.</span>matchTemplate<span class="token punctuation">(</span>gradient_magnitude<span class="token punctuation">,</span> gradient_magnitude_template<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>TM_CCOEFF_NORMED<span class="token punctuation">)</span>

<span class="token comment"># 设置阈值，获取匹配结果的位置</span>
threshold <span class="token operator">=</span> <span class="token number">0.8</span>
locations <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>result <span class="token operator">&gt;=</span> threshold<span class="token punctuation">)</span>

<span class="token comment"># 在原始图像上绘制匹配结果的边框</span>
<span class="token keyword">for</span> loc <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span>locations<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>image<span class="token punctuation">,</span> loc<span class="token punctuation">,</span> <span class="token punctuation">(</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> template<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> template<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 显示结果图像</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">131</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>origin_image<span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'gray'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'origin image'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">132</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>template<span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'gray'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'template Image'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">133</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>image<span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'gray'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Result'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># cv2.imshow('Result', image)</span>
<span class="token comment"># cv2.waitKey(0)</span>
<span class="token comment"># cv2.destroyAllWindows()</span>
</code></pre> 
<p>输出结果：<br> <img src="https://images2.imgbox.com/92/70/im7LSXtL_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/2d/84/GHbuSKtZ_o.png" alt="在这里插入图片描述"></p> 
<p>上面关于轮廓或边缘直方图的案例种种其实没有真正用到边缘直方图作为特征描述符。在我看到的一篇发明专利<code>CN104680164A</code>确实提到了用边缘方向直方图特征实现车标特征提取的方法，它还结合了前面纹理特征的Hu不变矩特征，它将这两个特征结合，形成特征向量送入神经网络进行训练。这其实启发了一点就是不一定就是只用一种方法作为特征描述符，这样有很大局限性，比如如果仅仅只用灰度直方图，那显然弱化了图像中的纹理特征，而边缘直方图恰恰就比只用灰度直方图强，并且可以<strong>结合多个特征度量方法一同来构成特征向量</strong>。</p> 
<p>其实在写到轮廓或边缘直方图时，我觉得仅仅用它来作为特征向量在特征匹配方面有一个很大的局限性，虽然它确实能体现纹理特征，但是正是因为它和方向密切相关，导致它不具有旋转不变性！并且在学习这一特征度量方法时，我联想到了SIFT算法，它恰恰就是<strong>应用边缘方向直方图来计算得到特征的主方向，从而让特征具有旋转不变性</strong>。<br> <img src="https://images2.imgbox.com/6a/63/AIJXjBWx_o.png" alt="在这里插入图片描述"><br> 但是也只是说在特征匹配上，边缘方向直方图确实不是很好，但是正是因为它的这种方向性，我们可以看到，<strong>直方图的主导方向捕捉了人的形状，特别是在躯干和腿部周围。</strong><br> <img src="https://images2.imgbox.com/9d/a6/BQo6Dds7_o.png" alt="在这里插入图片描述"><br> 所以它的方向信息，在做<strong>运动估计行为识别</strong>可能大有用处！<br> 🧑🏻‍🚀<b><i><font color="#ff5252">实例1、方向梯度直方图（Histogram of Oriented Gradient, HOG）</font></i></b></p> 
<p>方向梯度直方图，就是基于图像的梯度和方向构建的特征描述符，梯度的幅值是边缘和角点检测的基础、梯度的方向包含着丰富的图像特征。HOG的基本思想：将图像的局部特征用<strong>梯度幅值和方向分布</strong>来描述。</p> 
<p>基本方法：</p> 
<ol><li> <p>首先，将图像划分为多个单元格(cell)<code>8x8</code>；（这种表示方法，不仅使得特征更紧凑，而且对单个像素值的变换不敏感，能够抵抗噪声干扰） <img src="https://images2.imgbox.com/65/4f/zXSExlGJ_o.png" alt="在这里插入图片描述"></p> </li><li> <p>计算单元格的方向梯度直方图</p> </li><li> <p>将<code>2x2</code>的cell组成一个子块block,通过滑动窗口，设置子块滑动步长blockStride来得到。<br> <img src="https://images2.imgbox.com/c9/57/mag4TW45_o.png" alt="在这里插入图片描述"></p> </li><li> <p>比如上面这张图，整个图片为<code>8x16</code>个cell.子块滑动步长为1，则<code>2x2</code>个cell组成一个子块block的花，有<code>(16-1)x(8-1)</code>一共105个子块，每个子块有<code>4x9=36</code>长度的特征向量。最后将这105个block合并，得到了整个图像的特征描述符，长度为<code>105x36</code>为3780</p> </li></ol> 
<p>HOG描述符的向量维数取决于检测图像大小和单元格大小。</p> 
<p>HOG描述符<strong>不具有尺度和旋转不变性，但是具有良好的<font color="#6ab04c"> 几何不变性和光学不变性</font>，适合于人体检测。</strong></p> 
<p>💁🏻‍♀️<b><font color="#8c7ae6">OpenCV中的HOGDescriptor类：</font></b><br> OpenCV提供了<code>cv::HOGDescriptor</code>类。在python中，提供了HOG类的接口函数<code>cv.HOGDescriptor</code></p> 
<ul><li> <p><b>函数原型</b></p> <pre><code class="prism language-python">cv<span class="token punctuation">.</span>HOGDescriptor<span class="token punctuation">(</span>_winSize<span class="token punctuation">,</span> _blockSize<span class="token punctuation">,</span> _blockStride<span class="token punctuation">,</span> _cellSize<span class="token punctuation">,</span> _nbins<span class="token punctuation">)</span> → retval
hog<span class="token punctuation">.</span>compute<span class="token punctuation">(</span>img<span class="token punctuation">[</span><span class="token punctuation">,</span> _winStride<span class="token operator">=</span>Size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _padding<span class="token operator">=</span>Size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> → descriptors
</code></pre> </li><li> <p><b>参数说明</b></p> 
  <ul><li><code>winSize</code>:检测窗口的大小，形如<code>(w,h)</code>的元组，默认值：<code>(64,128)</code></li><li><code>blockSize</code>:子块的大小，形如<code>(w,h)</code>的元组，默认值<code>(16,16)</code></li><li><code>blockStride</code>:子块的滑动步长，形如<code>(w,h)</code>的元组，默认值为<code>(8,8)</code></li><li><code>cellSize</code>:单元格大小，将子块划分为多个单元格。形如<code>(w,h)</code>的元组，默认值<code>(8,8)</code></li><li><code>nbins</code>:直方图的条数，默认值是<code>9</code> 【方向梯度取值范围为<code>0~180°</code>,（这被称为“无符号”梯度，认为两个完全相反的方向是相同的）等分为nbins个区间，单元格像素的梯度方向分配到nbins】, 默认值为<code>9</code></li><li><code>img</code>:输入图像，单通道，类型<code>CV_8U</code></li><li><code>winStride</code>:窗口大小，可选项，必须是<code>blockStride</code>的整数倍</li><li><code>descriptors</code>：Hog描述符，<code>Numpy</code>数组，数据类型<code>CV_32F</code></li></ul> </li><li> <p><b>函数说明</b></p> <p>⑴ 计算每个单元格cell的HOG：方向梯度的取值范围0～180度，等分为nbins个区间，单元格像素的梯度方向分配到nbins个扇形区间，累加每个区间内的像素数，得到nbins位的HOG向量。<br> ⑵ 构造子块block的HOG：多个单元格cell组合为子块，子块的HOG描述符就是多个单元格HOG向量的串联，长度为nbins*blockSize/cellSize。<br> ⑶ 整个检测窗口的HOG：子块block以步长blockStride在检测窗口内滑动，遍历检测窗口，检测窗口的HOG就是每个子块block的HOG的串联。<br> 因此，检测窗口的HOG的向量维数是：</p> <pre><code class="prism language-python">lenHOG <span class="token operator">=</span> nbins <span class="token operator">*</span> <span class="token punctuation">(</span>blockSize<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">/</span>cellSize<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>blockSize<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">/</span>cellSize<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>x<span class="token punctuation">(</span><span class="token punctuation">(</span>winSize<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span>blockSize<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>blockStride<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>x<span class="token punctuation">(</span><span class="token punctuation">(</span>winSize<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span>blockSize<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>blockStride<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> </li><li> <p><b>注意问题</b></p> 
  <ul><li>函数cv.HOGDescriptor实例化HOGDescriptor类，定义一个HOGDescriptor类对象。成员函数<code>hog.compute</code>计算给定图像的HOG描述符。</li></ul> <pre><code class="prism language-python"><span class="token comment"># 构造 HOG 检测器</span>
winSize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span>
blockSize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
blockStride <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
cellSize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
nbins <span class="token operator">=</span> <span class="token number">8</span>
hog <span class="token operator">=</span> cv<span class="token punctuation">.</span>HOGDescriptor<span class="token punctuation">(</span>winSize<span class="token punctuation">,</span> blockSize<span class="token punctuation">,</span> blockStride<span class="token punctuation">,</span> cellSize<span class="token punctuation">,</span> nbins<span class="token punctuation">)</span>
<span class="token comment"># hog = cv.HOGDescriptor(_winSize=(40,40), _blockSize=(20,20), </span>
<span class="token comment">#      _blockStride=(10,10), _cellSize=(10,10), _nbins=8)</span>

</code></pre> 
  <ul><li>检测窗口大小winSize是子块大小blockSize的整数倍，子块大小blockSize是单元格大小cellSize的整数倍，子块大小blockSize是滑动步长blockStride的整数倍</li><li>函数中方向梯度的取值范围是0～180度，而不是0～360度。</li><li>cv::HOGDescriptor类的功能丰富，参数和成员函数很多，例如可以实现尺度不变性检测。更多使用方法可以参见OpenCV官方文档</li></ul> </li><li> <p><b>例程：本例程示例HOG描述符的使用。为了便于解释HOG原理和绘图，例程中将检测窗口、子块和单元格设为相同的尺寸，实际应用时可以参考函数默认值来设置。</b></p> </li></ul> 
<pre><code class="prism language-python"><span class="token comment"># 【1609】特征描述之 HOG 描述符</span>
<span class="token keyword">import</span> cv2 <span class="token keyword">as</span> cv
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt

<span class="token keyword">def</span> <span class="token function">drawHOG</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> descriptors<span class="token punctuation">,</span> cx<span class="token punctuation">,</span> cy<span class="token punctuation">,</span> rad<span class="token punctuation">)</span><span class="token punctuation">:</span>
    angles <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">22.5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>  <span class="token comment"># start, stop, step</span>
    normGrad <span class="token operator">=</span> descriptors<span class="token operator">/</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>descriptors<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
    gx<span class="token punctuation">,</span> gy <span class="token operator">=</span> cv<span class="token punctuation">.</span>polarToCart<span class="token punctuation">(</span>normGrad<span class="token operator">*</span>rad<span class="token punctuation">,</span> angles<span class="token punctuation">,</span> angleInDegrees<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>angles<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        px<span class="token punctuation">,</span> py <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>cx<span class="token operator">+</span>gx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>cy<span class="token operator">+</span>gy<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        cv<span class="token punctuation">.</span>arrowedLine<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token punctuation">(</span>cx<span class="token punctuation">,</span>cy<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>px<span class="token punctuation">,</span> py<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> tipLength<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>  <span class="token comment"># 黑色</span>
    <span class="token keyword">return</span> image

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token comment"># (1) 读取样本图像，构造样本图像集合</span>
    img <span class="token operator">=</span> cv<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">"4.jpg"</span><span class="token punctuation">,</span> flags<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 灰度图像</span>
    height<span class="token punctuation">,</span> width<span class="token punctuation">,</span> wCell<span class="token punctuation">,</span> d <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span>
    img <span class="token operator">=</span> cv<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 调整为统一尺寸</span>

    <span class="token comment"># (2) 构造 HOG 检测器</span>
    winSize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
    blockSize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
    blockStride <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
    cellSize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
    nbins <span class="token operator">=</span> <span class="token number">8</span>
    hog <span class="token operator">=</span> cv<span class="token punctuation">.</span>HOGDescriptor<span class="token punctuation">(</span>winSize<span class="token punctuation">,</span> blockSize<span class="token punctuation">,</span> blockStride<span class="token punctuation">,</span> cellSize<span class="token punctuation">,</span> nbins<span class="token punctuation">)</span>
    lenHOG <span class="token operator">=</span> nbins <span class="token operator">*</span> <span class="token punctuation">(</span>blockSize<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">/</span>cellSize<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>blockSize<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">/</span>cellSize<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> \
            <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>winSize<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span>blockSize<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>blockStride<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> \
            <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>winSize<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span>blockSize<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>blockStride<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"length of descriptors:"</span><span class="token punctuation">,</span> lenHOG<span class="token punctuation">)</span>

    <span class="token comment"># (3) 计算检测区域的 HOG 描述符</span>
    xt<span class="token punctuation">,</span> yt <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">80</span>  <span class="token comment"># 检测区域位置</span>
    cell <span class="token operator">=</span> img<span class="token punctuation">[</span>xt<span class="token punctuation">:</span>xt<span class="token operator">+</span>wCell<span class="token punctuation">,</span> yt<span class="token punctuation">:</span>yt<span class="token operator">+</span>wCell<span class="token punctuation">]</span>
    cellDes <span class="token operator">=</span> hog<span class="token punctuation">.</span>compute<span class="token punctuation">(</span>cell<span class="token punctuation">)</span>  <span class="token comment"># HOG 描述符，(8,)</span>
    normGrad <span class="token operator">=</span> cellDes<span class="token operator">/</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>cellDes<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"shape of descriptors:{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>cellDes<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>cellDes<span class="token punctuation">)</span>

    <span class="token comment"># (4) 绘制方向梯度示意图</span>
    imgGrad <span class="token operator">=</span> cv<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>cell<span class="token punctuation">,</span> <span class="token punctuation">(</span>wCell<span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">,</span> wCell<span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> interpolation<span class="token operator">=</span>cv<span class="token punctuation">.</span>INTER_AREA<span class="token punctuation">)</span>
    Gx <span class="token operator">=</span> cv<span class="token punctuation">.</span>Sobel<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv<span class="token punctuation">.</span>CV_32F<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ksize<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment"># X 轴梯度 Gx</span>
    Gy <span class="token operator">=</span> cv<span class="token punctuation">.</span>Sobel<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv<span class="token punctuation">.</span>CV_32F<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> ksize<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment"># Y 轴梯度 Gy</span>
    magG<span class="token punctuation">,</span> angG <span class="token operator">=</span> cv<span class="token punctuation">.</span>cartToPolar<span class="token punctuation">(</span>Gx<span class="token punctuation">,</span> Gy<span class="token punctuation">,</span> angleInDegrees<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 极坐标求幅值与方向 (0~360)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>magG<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> magG<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> angG<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> angG<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    angCell <span class="token operator">=</span> angG<span class="token punctuation">[</span>xt<span class="token punctuation">:</span>xt<span class="token operator">+</span>wCell<span class="token punctuation">,</span> yt<span class="token punctuation">:</span>yt<span class="token operator">+</span>wCell<span class="token punctuation">]</span>
    box <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>int32<span class="token punctuation">)</span>  <span class="token comment"># 计算旋转矩形的顶点, (4, 2)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>wCell<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>wCell<span class="token punctuation">)</span><span class="token punctuation">:</span>
            cx<span class="token punctuation">,</span> cy <span class="token operator">=</span> i<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span>d<span class="token punctuation">,</span> j<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span>d
            rect <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>cx<span class="token punctuation">,</span>cy<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> angCell<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 旋转矩形类</span>
            box <span class="token operator">=</span> np<span class="token punctuation">.</span>int32<span class="token punctuation">(</span>cv<span class="token punctuation">.</span>boxPoints<span class="token punctuation">(</span>rect<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 计算旋转矩形的顶点, (4, 2)</span>
            cv<span class="token punctuation">.</span>drawContours<span class="token punctuation">(</span>imgGrad<span class="token punctuation">,</span> <span class="token punctuation">[</span>box<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># (5) 绘制检测区域的方向梯度直方图</span>
    cellHOG <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">,</span><span class="token number">201</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>  <span class="token comment"># 白色</span>
    cellHOG <span class="token operator">=</span> drawHOG<span class="token punctuation">(</span>cellHOG<span class="token punctuation">,</span> cellDes<span class="token punctuation">,</span> xt<span class="token operator">+</span>d<span class="token punctuation">,</span> yt<span class="token operator">+</span>d<span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span>

    <span class="token comment"># (6) 绘制图像的方向梯度直方图</span>
    imgHOG <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>img<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">255</span>  <span class="token comment"># 白色</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            xc<span class="token punctuation">,</span> yc <span class="token operator">=</span> <span class="token number">20</span><span class="token operator">*</span>i<span class="token punctuation">,</span> <span class="token number">20</span><span class="token operator">*</span>j
            cell <span class="token operator">=</span> img<span class="token punctuation">[</span>xc<span class="token punctuation">:</span>xc<span class="token operator">+</span>wCell<span class="token punctuation">,</span> yc<span class="token punctuation">:</span>yc<span class="token operator">+</span>wCell<span class="token punctuation">]</span>
            descriptors <span class="token operator">=</span> hog<span class="token punctuation">.</span>compute<span class="token punctuation">(</span>cell<span class="token punctuation">)</span>  <span class="token comment"># HOG 描述符，(8,)</span>
            imgHOG <span class="token operator">=</span> drawHOG<span class="token punctuation">(</span>imgHOG<span class="token punctuation">,</span> descriptors<span class="token punctuation">,</span> xc<span class="token operator">+</span>d<span class="token punctuation">,</span> yc<span class="token operator">+</span>d<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
    imgWeight <span class="token operator">=</span> cv<span class="token punctuation">.</span>addWeighted<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> imgHOG<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">6.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">231</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"1. Original"</span><span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">(</span>xt<span class="token punctuation">,</span>yt<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>xt<span class="token operator">+</span>wCell<span class="token punctuation">,</span>yt<span class="token operator">+</span>wCell<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 绘制 block</span>
    plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'gray'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">232</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"2. Oriented gradient"</span><span class="token punctuation">)</span>
    angNorm <span class="token operator">=</span> np<span class="token punctuation">.</span>uint8<span class="token punctuation">(</span>cv<span class="token punctuation">.</span>normalize<span class="token punctuation">(</span>angG<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> cv<span class="token punctuation">.</span>NORM_MINMAX<span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>angNorm<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'gray'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">233</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"3. Image with HOG"</span><span class="token punctuation">)</span>
    cv<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>imgWeight<span class="token punctuation">,</span> <span class="token punctuation">(</span>xt<span class="token punctuation">,</span>yt<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>xt<span class="token operator">+</span>wCell<span class="token punctuation">,</span>yt<span class="token operator">+</span>wCell<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 绘制 block</span>
    plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>imgWeight<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'gray'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">234</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"4. Grad angle of cell"</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>imgGrad<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'gray'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">235</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"5. HOG of cell"</span><span class="token punctuation">)</span>
    strAng <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">,</span> <span class="token string">"45"</span><span class="token punctuation">,</span> <span class="token string">"67"</span><span class="token punctuation">,</span> <span class="token string">"90"</span><span class="token punctuation">,</span> <span class="token string">"112"</span><span class="token punctuation">,</span> <span class="token string">"135"</span><span class="token punctuation">,</span> <span class="token string">"157"</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>strAng<span class="token punctuation">,</span> cellDes<span class="token operator">*</span>wCell<span class="token operator">*</span>wCell<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">236</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"6. HOG diagram of cell"</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>cellHOG<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'gray'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/80/73/aNo0wgVu_o.png" alt="在这里插入图片描述"><br> ⑴ 子图1是原始图像，图中黑色方框是<strong>一个单元格cell</strong>。子图2是原始图像的梯度方向图，<strong>像素值的大小反映梯度方向的角度</strong>。<br> ⑵ 子图4是子图1中方框位置单元格cell的梯度方向图，图中的线段表示像素点的梯度方向。注意例程中梯度方向的范围是0～180度。<br> ⑶ 子图5是对子图4单元格中的所有像素点，按8个方向区间绘制的方向梯度直方图。子图6是子图5的单元格方向梯度直方图的空间矢量表示。<br> ⑷ 子图3是整个图像的可视化方向梯度直方图.将图像划分为10*10个单元格，计算每个单元格的HOG，表示为如子图6的空间矢量形式。<br> ⑸ 虽然例程给出了HOG处理过程和结果的各种图像，这是为了便于理解HOG的思路和计算步骤。在实际应用中，检测图像的HOG是维数为lenHOG的特征向量，而不是二维图像。</p> 
<hr> 
<p>💐<i>本节主要讲解了计算机视觉特征度量的第二类方法：统计区域度量；<strong>关于第三类基空间变换的方法，将在下篇进行讲解~</strong><br> 因为博主个人专业能力和知识还在提升中，若文章内容有错误或有失偏颇的地方，还请大家多多指出🍊</i></p> 
<blockquote> 
 <p><em><strong>本文的部分内容参考和整合自：</strong></em><br> [1]<a href="https://zhuanlan.zhihu.com/p/424903693" rel="nofollow">一文弄懂图像的矩和相关应用</a><br> [2]<a href="https://zhuanlan.zhihu.com/p/117344473" rel="nofollow">使用Hu矩进行形状匹配</a><br> [3]<a href="https://blog.csdn.net/weixin_46192930/article/details/108717867">opencv入门：矩特征，Hu矩</a><br> [4]<a href="https://blog.csdn.net/youcans/article/details/124998103">【youcans 的 OpenCV 例程200篇】196.图像的矩和不变矩（cv.moments）</a><br> [5]<a href="https://blog.csdn.net/youcans/article/details/125704724">【OpenCV 例程 300篇】233. 区域特征之矩不变量</a><br> [6]<a href="https://zhuanlan.zhihu.com/p/627467549" rel="nofollow">第十三章 图像特征Vol.1：全局特征与区域特征</a><br> [7]<a href="https://blog.csdn.net/youcans/article/details/121169102">【youcans 的 OpenCV 例程200篇】194.寻找图像轮廓（cv.findContours）</a><br> [8]<a href="https://blog.csdn.net/saw009/article/details/79981983">边缘直方图描述符（EHD）Edge Histogram Descriptor</a><br> [9]<a href="https://bbs.easyaiforum.cn/thread-672-1-1.html" rel="nofollow">openCV【实践系列】2——OpenCV方向梯度直方图</a><br> [10]<a href="https://zhuanlan.zhihu.com/p/468851715" rel="nofollow">基于灰度直方图和边界方向直方图的图像检索</a><br> [11]<a href="https://zhuanlan.zhihu.com/p/85829145" rel="nofollow">一文讲解梯度直方图Hog</a></p> 
 <hr> 
 <p>💐在此表示感谢！</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3ba73008070127b374403fb87450b3ea/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">llava1.5模型安装、预测、训练详细教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/75bf87af5468fdd8dd89285f5b977e48/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">（linux-x86）openEuler安装配置OpenJDK1.8</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>