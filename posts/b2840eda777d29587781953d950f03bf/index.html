<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>select函数详细用法解析 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="select函数详细用法解析" />
<meta property="og:description" content="1．表头文件
#include&lt;sys/time.h&gt;
#include&lt;sys/types.h&gt;
#include&lt;unistd.h&gt;
2．函数原型
int select(int n,fd_set * readfds,fd_set * writefds,fd_set * exceptfds,struct timeval * timeout);
3．函数说明
select()用来等待文件描述词状态的改变。参数n代表最大的文件描述词加1，参数readfds、writefds 和exceptfds 称为描述词组，是用来回传该描述词的读，写或例外的状况。底下的宏提供了处理这三种描述词组的方式:
FD_CLR(inr fd,fd_set* set)；用来清除描述词组set中相关fd 的位
FD_ISSET(int fd,fd_set *set)；用来测试描述词组set中相关fd 的位是否为真
FD_SET（int fd,fd_set*set）；用来设置描述词组set中相关fd的位
FD_ZERO（fd_set *set）； 用来清除描述词组set的全部位
4．结构体说明
先说明两个结构体： 1) struct fd_set可以理解为一个集合，这个集合中存放的是文件描述符(filedescriptor)，即文件句柄，这可以是我们所说的普通意义的文件，当然Unix下任何设备、管道、FIFO等都是文件形式，全部包括在内，所以毫无疑问一个socket就是一个文件，socket句柄就是一个文件描述符。 fd_set集合可以通过一些宏由人为来操作，比如 清空集合FD_ZERO(fd_set *)； 将一个给定的文件描述符加入集合之中FD_SET(int ,fd_set*)； 将一个给定的文件描述符从集合中删除FD_CLR(int,fd_set*)； 检查集合中指定的文件描述符是否可以读写FD_ISSET(int ,fd_set* )。一会儿举例说明。 2) struct timeval是一个大家常用的结构，用来代表时间值，有两个成员，一个是秒数，另一个是毫秒数。如下所示：
struct timeval
{
time_t tv_sec;
time_t tv_usec;
};
5. 具体参数说明： 1) int n:是一个整数值，是指集合中所有文件描述符的范围，即所有文件描述符的最大值加1，不能错！在Windows中这个参数的值无所谓，可以设置不正确。 2) fd_set*readfds是指向fd_set结构的指针，这个集合中应该包括文件描述符，我们是要监视这些文件描述符的读变化的，即我们关心是否可以从这些文件中读取数据了，如果这个集合中有一个文件可读，select就会返回一个大于0的值，表示有文件可读，如果没有可读的文件，则根据timeout参数再判断是否超时，若超出timeout的时间，select返回0，若发生错误返回负值。可以传入NULL值，表示不关心任何文件的读变化。 3) fd_set*writefds是指向fd_set结构的指针，这个集合中应该包括文件描述符，我们是要监视这些文件描述符的写变化的，即我们关心是否可以向这些文件中写入数据了，如果这个集合中有一个文件可写，select就会返回一个大于0的值，表示有文件可写，如果没有可写的文件，则根据timeout参数再判断是否超时，若超出timeout的时间，select返回0，若发生错误返回负值。可以传入NULL值，表示不关心任何文件的写变化。 4) fd_set *errorfds同上面两个参数的意图，用来监视文件错误异常。 5)struct timeval *timeout是select的超时时间，这个参数至关重要，它可以使select处于三种状态，第一，若将NULL以形参传入，即不传入时间结构，就是将select置于阻塞状态，一定等到监视文件描述符集合中某个文件描述符发生变化为止；第二，若将时间值设为0秒0毫秒，就变成一个纯粹的非阻塞函数，不管文件描述符是否有变化，都立刻返回继续执行，文件无变化返回0，有变化返回一个正值；第三，timeout的值大于0，这就是等待的超时时间，即select在timeout时间内阻塞，超时时间之内有事件到来就返回了，否则在超时后不管怎样一定返回，返回值同上述。 6．返回值" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b2840eda777d29587781953d950f03bf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-11-03T16:34:51+08:00" />
<meta property="article:modified_time" content="2014-11-03T16:34:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">select函数详细用法解析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p align="left" style="color:rgb(102,102,102)"><strong><span style="font-size:14px"><span style="font-family:Times New Roman">1</span>．表头文件</span></strong></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">#include&lt;sys/time.h&gt;</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">#include&lt;sys/types.h&gt;</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">#include&lt;unistd.h&gt;</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><strong><span style="font-size:14px"><span style="font-family:Times New Roman">2</span>．函数原型</span></strong></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">int select(int n,fd_set * readfds,fd_set * writefds,fd_set * exceptfds,struct timeval * timeout);</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><strong><span style="font-size:14px"><span style="font-family:Times New Roman">3</span>．函数说明</span></strong></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px"><span style="font-family:Times New Roman">select()</span>用来等待文件描述词状态的改变。参数<span style="font-family:Times New Roman">n</span>代表最大的文件描述词加<span style="font-family:Times New Roman">1</span>，参数<span style="font-family:Times New Roman">readfds</span>、<span style="font-family:Times New Roman">writefds </span>和<span style="font-family:Times New Roman">exceptfds </span>称为描述词组，是用来回传该描述词的读，写或例外的状况。底下的宏提供了处理这三种描述词组的方式<span style="font-family:Times New Roman">:</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px"><span style="font-family:Times New Roman">FD_CLR(inr fd,fd_set* set)</span>；用来清除描述词组<span style="font-family:Times New Roman">set</span>中相关<span style="font-family:Times New Roman">fd </span>的位</span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px"><span style="font-family:Times New Roman">FD_ISSET(int fd,fd_set *set)</span>；用来测试描述词组<span style="font-family:Times New Roman">set</span>中相关<span style="font-family:Times New Roman">fd </span>的位是否为真</span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px"><span style="font-family:Times New Roman">FD_SET</span>（<span style="font-family:Times New Roman">int fd,fd_set*set</span>）；用来设置描述词组<span style="font-family:Times New Roman">set</span>中相关<span style="font-family:Times New Roman">fd</span>的位</span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px"><span style="font-family:Times New Roman">FD_ZERO</span>（<span style="font-family:Times New Roman">fd_set *set</span>）；<span style="font-family:Times New Roman"> </span>用来清除描述词组<span style="font-family:Times New Roman">set</span>的全部位<span style="font-family:Times New Roman"></span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><strong><span style="font-size:14px"><span style="font-family:Times New Roman">4</span>．结构体说明</span></strong></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px">先说明两个结构体：<span style="font-family:Times New Roman"> </span><br> <span style="font-family:Times New Roman">1) struct fd_set</span>可以理解为一个集合，这个集合中存放的是文件描述符<span style="font-family:Times New Roman">(filedescriptor)</span>，即文件句柄，这可以是我们所说的普通意义的文件，当然<span style="font-family:Times New Roman">Unix</span>下任何设备、管道、<span style="font-family:Times New Roman">FIFO</span>等都是文件形式，全部包括在内，所以毫无疑问一个<span style="font-family:Times New Roman">socket</span>就是一个文件，<span style="font-family:Times New Roman">socket</span>句柄就是一个文件描述符。<span style="font-family:Times New Roman"> <br> fd_set</span>集合可以通过一些宏由人为来操作，比如<span style="font-family:Times New Roman"> <br> </span>清空集合<span style="font-family:Times New Roman">FD_ZERO(fd_set *)</span>；<span style="font-family:Times New Roman"> <br> </span>将一个给定的文件描述符加入集合之中<span style="font-family:Times New Roman">FD_SET(int ,fd_set*)</span>；<span style="font-family:Times New Roman"> <br> </span>将一个给定的文件描述符从集合中删除<span style="font-family:Times New Roman">FD_CLR(int,fd_set*)</span>；<span style="font-family:Times New Roman"> <br> </span>检查集合中指定的文件描述符是否可以读写<span style="font-family:Times New Roman">FD_ISSET(int ,fd_set* )</span>。一会儿举例说明。<span style="font-family:Times New Roman"> <br> 2) struct timeval</span>是一个大家常用的结构，用来代表时间值，有两个成员，一个是秒数，另一个是毫秒数。如下所示：</span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">struct timeval</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">{<!-- --></span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">time_t tv_sec;</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">time_t tv_usec;</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">};</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px"><br> <strong><span style="font-family:Times New Roman">5. </span>具体参数说明：</strong><span style="font-family:Times New Roman"> <br>    1) int n:</span>是一个整数值，是指集合中所有文件描述符的范围，即所有文件描述符的最大值加<span style="font-family:Times New Roman">1</span>，不能错！在<span style="font-family:Times New Roman">Windows</span>中这个参数的值无所谓，可以设置不正确。<span style="font-family:Times New Roman"> <br>     2) fd_set*readfds</span>是指向<span style="font-family:Times New Roman">fd_set</span>结构的指针，这个集合中应该包括文件描述符，我们是要监视这些文件描述符的读变化的，即我们关心是否可以从这些文件中读取数据了，如果这个集合中有一个文件可读，<span style="font-family:Times New Roman">select</span>就会返回一个大于<span style="font-family:Times New Roman">0</span>的值，表示有文件可读，如果没有可读的文件，则根据<span style="font-family:Times New Roman">timeout</span>参数再判断是否超时，若超出<span style="font-family:Times New Roman">timeout</span>的时间，<span style="font-family:Times New Roman">select</span>返回<span style="font-family:Times New Roman">0</span>，若发生错误返回负值。可以传入<span style="font-family:Times New Roman">NULL</span>值，表示不关心任何文件的读变化。<span style="font-family:Times New Roman"> <br>      3) fd_set*writefds</span>是指向<span style="font-family:Times New Roman">fd_set</span>结构的指针，这个集合中应该包括文件描述符，我们是要监视这些文件描述符的写变化的，即我们关心是否可以向这些文件中写入数据了，如果这个集合中有一个文件可写，<span style="font-family:Times New Roman">select</span>就会返回一个大于<span style="font-family:Times New Roman">0</span>的值，表示有文件可写，如果没有可写的文件，则根据<span style="font-family:Times New Roman">timeout</span>参数再判断是否超时，若超出<span style="font-family:Times New Roman">timeout</span>的时间，<span style="font-family:Times New Roman">select</span>返回<span style="font-family:Times New Roman">0</span>，若发生错误返回负值。可以传入<span style="font-family:Times New Roman">NULL</span>值，表示不关心任何文件的写变化。<span style="font-family:Times New Roman"> <br>      4) fd_set *errorfds</span>同上面两个参数的意图，用来监视文件错误异常。<span style="font-family:Times New Roman"> <br>      5)struct timeval *timeout</span>是<span style="font-family:Times New Roman">select</span>的超时时间，这个参数至关重要，它可以使<span style="font-family:Times New Roman">select</span>处于三种状态，第一，若将<span style="font-family:Times New Roman">NULL</span>以形参传入，即不传入时间结构，就是将<span style="font-family:Times New Roman">select</span>置于阻塞状态，一定等到监视文件描述符集合中某个文件描述符发生变化为止；第二，若将时间值设为<span style="font-family:Times New Roman">0</span>秒<span style="font-family:Times New Roman">0</span>毫秒，就变成一个纯粹的非阻塞函数，不管文件描述符是否有变化，都立刻返回继续执行，文件无变化返回<span style="font-family:Times New Roman">0</span>，有变化返回一个正值；第三，<span style="font-family:Times New Roman">timeout</span>的值大于<span style="font-family:Times New Roman">0</span>，这就是等待的超时时间，即<span style="font-family:Times New Roman">select</span>在<span style="font-family:Times New Roman">timeout</span>时间内阻塞，超时时间之内有事件到来就返回了，否则在超时后不管怎样一定返回，<strong>返回值同上述。</strong><span style="font-family:Times New Roman"> <br> <strong>6</strong></span><strong>．返回值</strong><span style="font-family:Times New Roman"><strong></strong></span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px">负值：<span style="font-family:Times New Roman">select</span>错误<span style="font-family:Times New Roman"></span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px">正值：某些文件可读写或出错<span style="font-family:Times New Roman"> 0</span>：等待超时，没有可读写或错误的文件</span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px">如果参数<span style="font-family:Times New Roman">timeout</span>设为<span style="font-family:Times New Roman">NULL</span>则表示<span style="font-family:Times New Roman">select</span>（）没有<span style="font-family:Times New Roman">timeout</span>。<span style="font-family:Times New Roman"></span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><strong><span style="font-size:14px"><span style="font-family:Times New Roman">7</span>．错误代码</span></strong></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px">执行成功则返回文件描述词状态已改变的个数，如果返回<span style="font-family:Times New Roman">0</span>代表在描述词状态改变前已超过<span style="font-family:Times New Roman">timeout</span>时间，当有错误发生时则返回<span style="font-family:Times New Roman">-1</span>，错误原因存于<span style="font-family:Times New Roman">errno</span>，此时参数<span style="font-family:Times New Roman">readfds</span>，<span style="font-family:Times New Roman">writefds</span>，<span style="font-family:Times New Roman">exceptfds</span>和<span style="font-family:Times New Roman">timeout</span>的值变成不可预测。</span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px"><span style="font-family:Times New Roman">EBADF </span>文件描述词为无效的或该文件已关闭</span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px"><span style="font-family:Times New Roman">EINTR </span>此调用被信号所中断</span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px"><span style="font-family:Times New Roman">EINVAL </span>参数<span style="font-family:Times New Roman">n </span>为负值。</span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px"><span style="font-family:Times New Roman">ENOMEM </span>核心内存不足<span style="font-family:Times New Roman"></span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><strong><span style="font-size:14px"><span style="font-family:Times New Roman">8.</span>范例</span></strong></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px"><span style="font-family:Times New Roman">1) </span>在标准输入读取<span style="font-family:Times New Roman">9</span>个字节数据。</span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px">用<span style="font-family:Times New Roman">select</span>函数实现超时判断！<span style="font-family:Times New Roman"></span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">int main(int argc, char ** argv)</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">{<!-- --></span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">char buf[10] = "";</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">fd_set rdfds;//</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">struct timeval tv; //store timeout</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">int ret; // return val</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">FD_ZERO(&amp;rdfds); //clear rdfds</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">FD_SET(1, &amp;rdfds); //add stdin handle into rdfds</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">tv.tv_sec = 3;</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">tv.tv_usec = 500;</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">ret = select(1 + 1, &amp;rdfds, NULL, NULL, &amp;tv);</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">if(ret &lt; 0)</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">perror("\nselect");</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">else if(ret == 0)</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">printf("\ntimeout");</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">else</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">{<!-- --></span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">printf("\nret=%d", ret);</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">}</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">if(FD_ISSET(1, &amp;rdfds))</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">{<!-- --></span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">printf("\nreading");</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">fread(buf, 9, 1, stdin); // read form stdin</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">}</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">// read(0, buf, 9); /* read from stdin */</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">// fprintf(stdout, "%s\n", buf); /* write to stdout */</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">write(1, buf, strlen(buf)); //write to stdout</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">printf("\n%d\n", strlen(buf));</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">return 0;</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-family:Times New Roman"><span style="font-size:14px">}</span></span></p> 
<p align="left" style="color:rgb(102,102,102)"><span style="font-size:14px"><span style="font-family:'Times New Roman'">2) </span>从网络上接受数据写入一个文件中。<span style="font-family:'Times New Roman'"> <br> main() <br> { <br>     int sock; <br>     FILE *fp; <br>     struct fd_set fds; <br>     struct timeval timeout={3,0}; //select</span>等待<span style="font-family:Times New Roman">3</span>秒，<span style="font-family:Times New Roman">3</span>秒轮询，要非阻塞就置<span style="font-family:'Times New Roman'">0 <br>     char buffer[256]={0}; //256</span>字节的接收缓冲区<span style="font-family:'Times New Roman'"> <br>     /* </span>假定已经建立<span style="font-family:Times New Roman">UDP</span>连接，具体过程不写，简单，当然<span style="font-family:Times New Roman">TCP</span>也同理，主机<span style="font-family:Times New Roman">ip</span>和<span style="font-family:Times New Roman">port</span>都已经给定，要写的文件已经打开<span style="font-family:'Times New Roman'"> <br>     sock=socket(...); <br>     bind(...); <br>     fp=fopen(...); */ <br>     while(1) <br>    { <br>         FD_ZERO(&amp;fds); //</span>每次循环都要清空集合，否则不能检测描述符变化<span style="font-family:'Times New Roman'"> <br>         FD_SET(sock,&amp;fds); //</span>添加描述符<span style="font-family:'Times New Roman'"> <br>         FD_SET(fp,&amp;fds); //</span>同上<span style="font-family:'Times New Roman'"> <br>         maxfdp=sock&gt;fp?sock+1:fp+1;    //</span>描述符最大值加<span style="font-family:'Times New Roman'">1 <br>         switch(select(maxfdp,&amp;fds,&amp;fds,NULL,&amp;timeout))   //select</span>使用<span style="font-family:'Times New Roman'"> <br>         { <br>             case -1: exit(-1);break; //select</span>错误，退出程序<span style="font-family:'Times New Roman'"> <br>             case 0:break; //</span>再次轮询<span style="font-family:'Times New Roman'"> <br>             default: <br>                   if(FD_ISSET(sock,&amp;fds)) //</span>测试<span style="font-family:Times New Roman">sock</span>是否可读，即是否网络上有数据<span style="font-family:'Times New Roman'"> <br>                   { <br>                         recvfrom(sock,buffer,256,.....);//</span>接受网络数据<span style="font-family:'Times New Roman'"> <br>                         if(FD_ISSET(fp,&amp;fds)) //</span>测试文件是否可写<span style="font-family:'Times New Roman'"> <br>                             fwrite(fp,buffer...);//</span>写入文件<span style="font-family:'Times New Roman'"> <br>                          buffer</span>清空<span style="font-family:'Times New Roman'">; <br>                    }// end if break; <br>           }// end switch <br>      }//end while <br> }//end main </span></span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/539ff8df7320b77417e00cbda41f79f8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">数据结构第三章栈和队列知识结构导图</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ca443584410665fe47095806aa3b77a5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Objective-C Runtime 运行时之二：成员变量与属性</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>