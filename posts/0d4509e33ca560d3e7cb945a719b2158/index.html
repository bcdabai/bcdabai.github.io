<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python 控制SecureCRT运行脚本 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python 控制SecureCRT运行脚本" />
<meta property="og:description" content="测试工作，经常用到SecureCRT，做了一个最笨的python 脚本来控制CRT ，在运行脚本。
实现原理就是用pyautogui 来模拟快捷键。
#coding=utf-8
import pyautogui as pg
import os
import time
scriptpath= &#39;D:\script&#39;
#开启CRT软件
def openoltcrt():
os.system(r&#34; start D:\SecureCRT\SecureCRT.exe&#34;)#CRT 软件放在D盘的 ，用这句来打开CRT
pg.press(&#39;enter&#39;) #打开 CRT 后要选择你的连接。
time.sleep(2)
#关闭CRT软件
def closecrt():
pg.hotkey(&#34;alt&#34;,&#34;f4&#34;) #用快捷键来关闭 CRT 软件
pg.press(&#39;y&#39;) #关闭 CRT 软件，按Y 来确认你要关闭。
#在CRT软件里面运行脚本
def runscript(scriptpath,script):
pg.keyDown(&#39;alt&#39;)
pg.press(&#39;s&#39;) #按快捷键ALT&#43;S 来 选择script 菜单
time.sleep(1)
pg.press(&#39;r&#39;) #script 菜单出来了按r 来运行脚本
pg.keyUp(&#39;alt&#39;) #ALT 键要释放出来，不然要出问题。
time.sleep(1)
crt_script_path = str(scriptpath)
# 调用脚本打开连接
script1 = os.path.join(crt_script_path, str(script)) # 脚本存放路径，和脚本的名字" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/0d4509e33ca560d3e7cb945a719b2158/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-16T16:29:22+08:00" />
<meta property="article:modified_time" content="2023-08-16T16:29:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python 控制SecureCRT运行脚本</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>测试工作，经常用到SecureCRT，做了一个最笨的python 脚本来控制CRT ，在运行脚本。</p> 
<p>实现原理就是用pyautogui 来模拟快捷键。</p> 
<p>#coding=utf-8<br> import pyautogui as pg<br> import os<br> import time</p> 
<p><br> scriptpath= 'D:\script'</p> 
<p><span style="color:#fe2c24;"><strong>#开启CRT软件</strong></span><br> def openoltcrt():<br>     os.system(r" start D:\SecureCRT\SecureCRT.exe")#CRT 软件放在D盘的 ，用这句来打开CRT<br>     pg.press('enter') #打开 CRT 后要选择你的连接。<br>     time.sleep(2)</p> 
<p><img alt="" height="443" src="https://images2.imgbox.com/5a/93/xn8N1VF7_o.png" width="669"></p> 
<p> </p> 
<p><span style="color:#fe2c24;"><strong>#关闭CRT软件</strong></span><br> def closecrt():<br>     pg.hotkey("alt","f4") #用快捷键来关闭 CRT 软件<br>     pg.press('y') #关闭 CRT 软件，按Y 来确认你要关闭。</p> 
<p><strong><span style="color:#fe2c24;">#在CRT软件里面运行脚本</span></strong><br> def runscript(scriptpath,script):<br>     pg.keyDown('alt')<br>     pg.press('s') #按快捷键ALT+S 来 选择script 菜单<br>     time.sleep(1)<br>     pg.press('r') #script 菜单出来了按r 来运行脚本<br>     pg.keyUp('alt') #ALT 键要释放出来，不然要出问题。<br>     time.sleep(1)<br>     crt_script_path = str(scriptpath)<br>     # 调用脚本打开连接<br>     script1 = os.path.join(crt_script_path, str(script)) # 脚本存放路径，和脚本的名字<br>     pg.write(script1)<br>     time.sleep(5)<br>     pg.press('enter')<br>     time.sleep(10)</p> 
<p><span style="color:#fe2c24;"><strong>CRT 里面运行的python 脚本 </strong></span></p> 
<p><span style="color:#fe2c24;"><strong>将下面的脚本保存为test.py</strong></span></p> 
<p># $language = "python"<br> # $interface = "1.0"<br> import time</p> 
<p>def dhcpserverchange(mode):<br>       crt.Screen.WaitForString("<span style="color:#ff9900;">administrator@raspberrypi:~$</span>",2)<br>       crt.Screen.Send("<span style="color:#ff9900;">sudo cp /etc/dhcp/dhcpd6_"+str(mode)+".conf /etc/dhcp/dhcpd6.conf</span>\r\n")    </p> 
<p>dhcpserverchange("mape")</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/21d881f3ebf407b392e5f3ba0d00c4d4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">知识扫盲：安可、信创、国产化是什么意思？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/02754f4447a620ba0e2932a15a863640/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android设备通过蓝牙HID技术模拟键盘实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>