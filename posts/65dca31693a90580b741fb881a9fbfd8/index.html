<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>内存溢出异常配置最小值与最大值范围 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="内存溢出异常配置最小值与最大值范围" />
<meta property="og:description" content="//首先检查程序有没有限入死循环 这个问题主要还是由这个问题 java.lang.OutOfMemoryError: Java heap space 引起的。第一次出现这样的的问题以后，引发了其他的问题。在网上一查可能是JAVA的堆栈设置太小的原因。 跟据网上的答案大致有这两种解决方法： 1、设置环境变量 解决方法：手动设置Heap size 修改TOMCAT_HOME/bin/catalina.sh set JAVA_OPTS= -Xms32m -Xmx512m 可以根据自己机器的内存进行更改。 2、java -Xms32m -Xmx800m className 就是在执行JAVA类文件时加上这个参数，其中className是需要执行的确类名。（包括包名） 这个解决问题了。而且执行的速度比没有设置的时候快很多。 如果在测试的时候可能会用Eclispe 这时候就需要在Eclipse -&gt;run -arguments 中的VM arguments 中输入-Xms32m -Xmx800m这个参数就可以了。 后来在Eclilpse中修改了启动参数，在VM arguments 加入了-Xms32m -Xmx800m，问题解决。 一、java.lang.OutOfMemoryError: PermGen space PermGen space的全称是Permanent Generation space,是指内存的永久保存区域, 这块内存主要是被JVM存放Class和Meta信息的,Class在被Loader时就会被放到PermGen space中, 它和存放类实例(Instance)的Heap区域不同,GC(Garbage Collection)不会在主程序运行期对 PermGen space进行清理，所以如果你的应用中有很多CLASS的话,就很可能出现PermGen space错误, 这种错误常见在web服务器对JSP进行pre compile的时候。如果你的WEB APP下都用了大量的第三方jar, 其大小 超过了jvm默认的大小(4M)那么就会产生此错误信息了。 解决方法： 手动设置MaxPermSize大小 修改TOMCAT_HOME/bin/catalina.sh 在“echo &#34;Using CATALINA_BASE: $CATALINA_BASE&#34;”上面加入以下行： JAVA_OPTS=&#34;-server -XX:PermSize=64M -XX:MaxPermSize=128m 建议：将相同的第三方jar文件移置到tomcat/shared/lib目录下，这样可以达到减少jar 文档重复占用内存的目的。 二、java.lang.OutOfMemoryError: Java heap space Heap size 设置 JVM堆的设置是指java程序运行过程中JVM可以调配使用的内存空间的设置." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/65dca31693a90580b741fb881a9fbfd8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-10-21T21:59:27+08:00" />
<meta property="article:modified_time" content="2015-10-21T21:59:27+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">内存溢出异常配置最小值与最大值范围</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    //首先检查程序有没有限入死循环 
<br> 这个问题主要还是由这个问题 java.lang.OutOfMemoryError: Java heap space 引起的。第一次出现这样的的问题以后，引发了其他的问题。在网上一查可能是JAVA的堆栈设置太小的原因。 
<br> 跟据网上的答案大致有这两种解决方法： 
<br> 1、设置环境变量 
<br> 
<br> 解决方法：手动设置Heap size 
<br> 修改TOMCAT_HOME/bin/catalina.sh 
<br> set JAVA_OPTS= -Xms32m -Xmx512m 
<br> 可以根据自己机器的内存进行更改。 
<br> 
<br> 2、java -Xms32m -Xmx800m className 
<br> 就是在执行JAVA类文件时加上这个参数，其中className是需要执行的确类名。（包括包名） 
<br> 这个解决问题了。而且执行的速度比没有设置的时候快很多。 
<br> 
<br> 如果在测试的时候可能会用Eclispe 这时候就需要在Eclipse -&gt;run -arguments 中的VM arguments 中输入-Xms32m -Xmx800m这个参数就可以了。 
<br> 
<br> 后来在Eclilpse中修改了启动参数，在VM arguments 加入了-Xms32m -Xmx800m，问题解决。 
<br> 
<br> 一、java.lang.OutOfMemoryError: PermGen space 
<br> 
<br> PermGen space的全称是Permanent Generation space,是指内存的永久保存区域, 
<br> 这块内存主要是被JVM存放Class和Meta信息的,Class在被Loader时就会被放到PermGen space中, 
<br> 它和存放类实例(Instance)的Heap区域不同,GC(Garbage Collection)不会在主程序运行期对 
<br> PermGen space进行清理，所以如果你的应用中有很多CLASS的话,就很可能出现PermGen space错误, 
<br> 这种错误常见在web服务器对JSP进行pre compile的时候。如果你的WEB APP下都用了大量的第三方jar, 其大小 
<br> 超过了jvm默认的大小(4M)那么就会产生此错误信息了。 
<br> 解决方法： 手动设置MaxPermSize大小 
<br> 
<br> 修改TOMCAT_HOME/bin/catalina.sh 
<br> 在“echo "Using CATALINA_BASE:   $CATALINA_BASE"”上面加入以下行： 
<br> JAVA_OPTS="-server -XX:PermSize=64M -XX:MaxPermSize=128m 
<br> 建议：将相同的第三方jar文件移置到tomcat/shared/lib目录下，这样可以达到减少jar 文档重复占用内存的目的。 
<br> 
<br> 二、java.lang.OutOfMemoryError: Java heap space 
<br> Heap size 设置 
<br> JVM堆的设置是指java程序运行过程中JVM可以调配使用的内存空间的设置.JVM在启动的时候会自动设置Heap size的值， 
<br> 其初始空间(即-Xms)是物理内存的1/64，最大空间(-Xmx)是物理内存的1/4。可以利用JVM提供的-Xmn -Xms -Xmx等选项可 
<br> 进行设置。Heap size 的大小是Young Generation 和Tenured Generaion 之和。 
<br> 提示：在JVM中如果98％的时间是用于GC且可用的Heap size 不足2％的时候将抛出此异常信息。 
<br> 提示：Heap Size 最大不要超过可用物理内存的80％，一般的要将-Xms和-Xmx选项设置为相同，而-Xmn为1/4的-Xmx值。 
<br> 解决方法：手动设置Heap size 
<br> 修改TOMCAT_HOME/bin/catalina.sh 
<br> 在“echo "Using CATALINA_BASE:   $CATALINA_BASE"”上面加入以下行： 
<br> JAVA_OPTS="-server -Xms800m -Xmx800m   -XX:MaxNewSize=256m" 
<br> 
<br> 三、实例，以下给出1G内存环境下java jvm 的参数设置参考： 
<br> 
<br> JAVA_OPTS="-server -Xms800m -Xmx800m -XX:PermSize=64M -XX:MaxNewSize=256m -XX:MaxPermSize=128m -Djava.awt.headless=true " 
<br> 
<br> 很大的web工程，用tomcat默认分配的内存空间无法启动，如果不是在myeclipse中启动tomcat可以对tomcat这样设置： 
<br> 
<br> TOMCAT_HOME\bin\catalina.bat 中添加这样一句话： 
<br> 
<br>       
<br> 
<br>           set JAVA_OPTS= -Xmx1024M -Xms512M -XX:MaxPermSize=256m 
<br> 
<br> 如果要在myeclipse中启动，上述的修改就不起作用了，可如下设置： 
<br> 
<br> Myeclipse-&gt;preferences-&gt;myeclipse-&gt;servers-&gt;tomcat-&gt;tomcat×.×-&gt;JDK面板中的 
<br> 
<br> Optional Java VM arguments中添加：-Xmx1024M -Xms512M -XX:MaxPermSize=256m 
<br> 
<br> 以上是转贴，但本人遇见的问题是：在myeclipse中启动Tomcat时，提示"ava.lang.OutOfMemoryError: Java heap space"，解决办法就是： 
<br> 
<br> Myeclipse-&gt;preferences-&gt;myeclipse-&gt;servers-&gt;tomcat-&gt;tomcat×.×-&gt;JDK面板中的 
<br> 
<br> Optional Java VM arguments中添加：-Xmx1024M -Xms512M -XX:MaxPermSize=256m 
<br> 
<br> 挺灵的。 
<br> --------------------------------------------------------- 
<br> tomcat 启动内存设置 
<br> 其初始空间(即-Xms)是物理内存的1/64，最大空间(-Xmx)是物理内存的1/4。可以利用JVM提供的-Xmn -Xms -Xmx等选项可 
<br> 进行设置 
<br> 三、实例，以下给出1G内存环境下java jvm 的参数设置参考： 
<br> JAVA_OPTS="-server -Xms800m -Xmx800m -XX:PermSize=64M -XX:MaxNewSize=256m -XX:MaxPermSize=128m -Djava.awt.headless=true " 
<br> JAVA_OPTS="-server -Xms768m -Xmx768m -XX:PermSize=128m -XX:MaxPermSize=256m -XX: 
<br> NewSize=192m -XX:MaxNewSize=384m" 
<br> CATALINA_OPTS="-server -Xms768m -Xmx768m -XX:PermSize=128m -XX:MaxPermSize=256m 
<br> -XX:NewSize=192m -XX:MaxNewSize=384m" 
<br> Linux： 
<br> 在/usr/local/apache-tomcat-5.5.23/bin目录下的catalina.sh 
<br> 添加：JAVA_OPTS='-Xms512m -Xmx1024m' 
<br> 要加“m”说明是MB，否则就是KB了，在启动tomcat时会报内存不足。 
<br> -Xms：初始值 
<br> -Xmx：最大值 
<br> -Xmn：最小值 
<br> Windows 
<br> 在catalina.bat最前面加入 
<br> set JAVA_OPTS=-Xms128m -Xmx350m 
<br> 如果用startup.bat启动tomcat,OK设置生效.够成功的分配200M内存. 
<br> 但是如果不是执行startup.bat启动tomcat而是利用windows的系统服务启动tomcat服务,上面的设置就不生效了, 
<br> 就是说set JAVA_OPTS=-Xms128m -Xmx350m 没起作用.上面分配200M内存就OOM了.. 
<br> windows服务执行的是bin\tomcat.exe.他读取注册表中的值,而不是catalina.bat的设置. 
<br> 解决办法: 
<br> 修改注册表HKEY_LOCAL_MACHINE\SOFTWARE\Apache Software Foundation\Tomcat Service Manager\Tomcat5\Parameters\JavaOptions 
<br> 原值为 
<br> -Dcatalina.home="C:\ApacheGroup\Tomcat 5.0" 
<br> -Djava.endorsed.dirs="C:\ApacheGroup\Tomcat 5.0\common\endorsed" 
<br> -Xrs 
<br> 加入 -Xms300m -Xmx350m 
<br> 重起tomcat服务,设置生效 
<br> 
<br> 
<br> 
<br> ================================================================== 
<br> 
<br> 
<br> 
<br> 
<br> 
<br> tomcat作为windows服务的参数配置，特别是PermSize的设置 
<br> 当tomcat用startup.bat启动的时候的参数设置网上说的比较多，这里就不再描述。 
<br> 
<br> 当tomcat作为windows的系统服务的时候，网上找了很多相关的文章，都没有比较全面的参数设置方法，一般就说明了一下xms和xmx的设置，都没有提供其他方面参数的说明，不够实用。经过对apache下的procrun的研究和多次试用，总算清楚了一般参数的设置方法。其实 tomcat5.exe本身已经包含有procrun的功能，这就是很多人在网上找不到procrun.exe文件下载的原因。 
<br> procrun可以参考：http://commons.apache.org/daemon/procrun.html 
<br> 注：这里用tomcat5作为例子，应该同样适用于tomcat6. 
<br> 
<br> 这里不使用注册表，我们用tomcat提供的gui工具来设置。 
<br> 1、在命令行下执行：tomcat5w.exe //ES//TomcatService 
<br> 其中，TomcatService就是你加入windows服务的名称。这样，在windows的任务栏就会出现一个tomcat的服务管理器，图标如下 。 
<br> 2、打开tomcat服务管理器的java页，如 
<br> 
<br> 在Java Options里面输入需要设置的参数，如设置permsize的内存 
<br> -XX:PermSize=64M 
<br> -XX:MaxPermSize=192m 
<br> -XX:ReservedCodeCacheSize=48m 
<br> -Duser.timezone=GMT+08 
<br> 注：每一行后面都不能有空格。 
<br> 同样，我们也可以在注册表中进行修改，HKEY_LOCAL_MACHINE\SOFTWARE\Apache Software Foundation\Procrun 2.0\TestService\Parameters\Java 
<br>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3c0ebd7a3dddacf64544d997df28719c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Dubbo java.io.IOException: Can not lock the registry cache file</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f798b0912325d95f2d1c44187c9601a9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">iOS动画编程-View动画[ 2 ] Spring动画</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>