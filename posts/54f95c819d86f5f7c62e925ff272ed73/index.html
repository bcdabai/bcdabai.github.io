<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>android CoordinatorLayout使用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="android CoordinatorLayout使用" />
<meta property="og:description" content="一、CoordinatorLayout有什么作用 CoordinatorLayout作为“super-powered FrameLayout”基本实现两个功能： 1、作为顶层布局 2、调度协调子布局
CoordinatorLayout使用新的思路通过协调调度子布局的形式实现触摸影响布局的形式产生动画效果。CoordinatorLayout通过设置子View的 Behaviors来调度子View。系统（Support V7）提供了AppBarLayout.Behavior, AppBarLayout.ScrollingViewBehavior, FloatingActionButton.Behavior, SwipeDismissBehavior&lt;V extends View&gt; 等。 使用CoordinatorLayout需要在Gradle加入Support Design Library：
compile &#39;com.android.support:design:22.2.1&#39; 二、CoordinatorLayout与FloatingActionButton 定义布局文件：
&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt; &lt;android.support.design.widget.CoordinatorLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34; xmlns:app=&#34;http://schemas.android.com/apk/res-auto&#34; android:layout_width=&#34;match_parent&#34; android:layout_height=&#34;match_parent&#34;&gt; &lt;android.support.design.widget.FloatingActionButton android:id=&#34;@&#43;id/fab&#34; android:layout_width=&#34;wrap_content&#34; android:layout_height=&#34;wrap_content&#34; android:layout_gravity=&#34;end|bottom&#34; android:layout_margin=&#34;16dp&#34; android:src=&#34;@drawable/ic_done&#34; /&gt; &lt;/android.support.design.widget.CoordinatorLayout&gt; CoordinatorLayout作为“super-powered FrameLayout”，设置子视图的android:layout_gravity属性控制位置。
Activity:
public class MainActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); findViewById(R.id.fab).setOnClickListener(new View.OnClickListener() { @Override public void onClick(View view) { Snackbar.make(view,&#34;FAB&#34;,Snackbar.LENGTH_LONG) .setAction(&#34;cancel&#34;, new View.OnClickListener() { @Override public void onClick(View v) { //这里的单击事件代表点击消除Action后的响应事件 } }) ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/54f95c819d86f5f7c62e925ff272ed73/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-09-02T20:10:44+08:00" />
<meta property="article:modified_time" content="2015-09-02T20:10:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">android CoordinatorLayout使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3 id="一coordinatorlayout有什么作用">一、CoordinatorLayout有什么作用</h3> 
<p>CoordinatorLayout作为“super-powered FrameLayout”基本实现两个功能： <br> 1、作为顶层布局 <br> 2、调度协调子布局</p> 
<pre><code>CoordinatorLayout使用新的思路通过协调调度子布局的形式实现触摸影响布局的形式产生动画效果。CoordinatorLayout通过设置子View的 Behaviors来调度子View。系统（Support V7）提供了AppBarLayout.Behavior, AppBarLayout.ScrollingViewBehavior, FloatingActionButton.Behavior, SwipeDismissBehavior&lt;V extends View&gt; 等。
</code></pre> 
<p>使用CoordinatorLayout需要在Gradle加入Support Design Library：</p> 
<pre class="prettyprint"><code class="language-java hljs ">compile <span class="hljs-string">'com.android.support:design:22.2.1'</span></code></pre> 
<h3 id="二coordinatorlayout与floatingactionbutton">二、CoordinatorLayout与FloatingActionButton</h3> 
<p>定义布局文件：</p> 
<pre class="prettyprint"><code class="language-xml hljs "><span class="hljs-pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">android.support.design.widget.CoordinatorLayout
</span>    <span class="hljs-attribute">xmlns:android</span>=<span class="hljs-value">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attribute">xmlns:app</span>=<span class="hljs-value">"http://schemas.android.com/apk/res-auto"</span>
    <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
    <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"match_parent"</span>&gt;</span>


    <span class="hljs-tag">&lt;<span class="hljs-title">android.support.design.widget.FloatingActionButton
</span>        <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/fab"</span>
        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"wrap_content"</span>
        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"wrap_content"</span>
        <span class="hljs-attribute">android:layout_gravity</span>=<span class="hljs-value">"end|bottom"</span>
        <span class="hljs-attribute">android:layout_margin</span>=<span class="hljs-value">"16dp"</span>
        <span class="hljs-attribute">android:src</span>=<span class="hljs-value">"@drawable/ic_done"</span> /&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">android.support.design.widget.CoordinatorLayout</span>&gt;</span></code></pre> 
<p>CoordinatorLayout作为“super-powered FrameLayout”，设置子视图的android:layout_gravity属性控制位置。</p> 
<p>Activity:</p> 
<pre class="prettyprint"><code class="language-java hljs "><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AppCompatActivity</span> {<!-- --></span>

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span>(Bundle savedInstanceState) {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        findViewById(R.id.fab).setOnClickListener(<span class="hljs-keyword">new</span> View.OnClickListener() {
            <span class="hljs-annotation">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span>(View view) {

                Snackbar.make(view,<span class="hljs-string">"FAB"</span>,Snackbar.LENGTH_LONG)
                        .setAction(<span class="hljs-string">"cancel"</span>, <span class="hljs-keyword">new</span> View.OnClickListener() {
                            <span class="hljs-annotation">@Override</span>
                            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span>(View v) {
                                <span class="hljs-comment">//这里的单击事件代表点击消除Action后的响应事件</span>

                            }
                        })
                        .show();
            }
        });
    }
}</code></pre> 
<p>效果： <br> <img src="https://images2.imgbox.com/c6/04/x7TtaJ2M_o.gif" alt="" title=""></p> 
<pre><code>FloatingActionButton是最简单的使用CoordinatorLayout的例子，FloatingActionButton默认使用FloatingActionButton.Behavior。
</code></pre> 
<h3 id="三coordinatorlayout与appbarlayout">三、CoordinatorLayout与AppBarLayout</h3> 
<h4 id="31-appbarlayout嵌套tablayout">3.1 AppBarLayout嵌套TabLayout</h4> 
<p>布局文件代码：</p> 
<pre class="prettyprint"><code class="language-xml hljs ">
<span class="hljs-tag">&lt;<span class="hljs-title">android.support.design.widget.CoordinatorLayout</span> <span class="hljs-attribute">xmlns:android</span>=<span class="hljs-value">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attribute">xmlns:app</span>=<span class="hljs-value">"http://schemas.android.com/apk/res-auto"</span>
    <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/main_content"</span>
    <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
    <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"match_parent"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">android.support.design.widget.AppBarLayout
</span>        <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/appbar"</span>
        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"wrap_content"</span>
        <span class="hljs-attribute">android:theme</span>=<span class="hljs-value">"@style/ThemeOverlay.AppCompat.Dark.ActionBar"</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">android.support.v7.widget.Toolbar
</span>            <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/toolbar"</span>
            <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
            <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"?attr/actionBarSize"</span>
            <span class="hljs-attribute">android:background</span>=<span class="hljs-value">"?attr/colorPrimary"</span>
            <span class="hljs-attribute">app:popupTheme</span>=<span class="hljs-value">"@style/ThemeOverlay.AppCompat.Light"</span>
            <span class="hljs-attribute">app:layout_scrollFlags</span>=<span class="hljs-value">"scroll|enterAlways"</span> /&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">android.support.design.widget.TabLayout
</span>            <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/tabs"</span>
            <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
            <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"wrap_content"</span> /&gt;</span>

    <span class="hljs-tag">&lt;/<span class="hljs-title">android.support.design.widget.AppBarLayout</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">android.support.v4.view.ViewPager
</span>        <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/viewpager"</span>
        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"match_parent"</span>
        <span class="hljs-attribute">app:layout_behavior</span>=<span class="hljs-value">"@string/appbar_scrolling_view_behavior"</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">android.support.design.widget.FloatingActionButton
</span>        <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/fab"</span>
        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"wrap_content"</span>
        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"wrap_content"</span>
        <span class="hljs-attribute">android:layout_gravity</span>=<span class="hljs-value">"end|bottom"</span>
        <span class="hljs-attribute">android:layout_margin</span>=<span class="hljs-value">"@dimen/fab_margin"</span>
        <span class="hljs-attribute">android:src</span>=<span class="hljs-value">"@drawable/ic_done"</span> /&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">android.support.design.widget.CoordinatorLayout</span>&gt;</span></code></pre> 
<p>效果： <br> <img src="https://images2.imgbox.com/f5/07/F31Ywqd1_o.gif" alt="" title=""></p> 
<pre><code>效果显示，视图滚动时，Toolbar会隐藏，这个效果是Android Support Library里面,新增的CoordinatorLayout, AppBarLayout实现的。通过AppBarLayout的子视图的属性控制。观察AppBarLayout的子布局，Toobar有app:layout_scrollFlags属性，这就是控制滑动时视图效果的属性。app:layout_scrollFlags有四个值：
</code></pre> 
<ol><li>scroll: 所有想滚动出屏幕的view都需要设置这个flag， 没有设置这个flag的view将被固定在屏幕顶部。例如，TabLayout 没有设置这个值，将会停留在屏幕顶部。</li><li>enterAlways: 设置这个flag时，向下的滚动都会导致该view变为可见，启用快速“返回模式”。</li><li>enterAlwaysCollapsed: 当你的视图已经设置minHeight属性又使用此标志时，你的视图只能已最小高度进入，只有当滚动视图到达顶部时才扩大到完整高度。</li><li>exitUntilCollapsed: 滚动退出屏幕，最后折叠在顶端。</li></ol> 
<p>为了ToolBar可以滚动，CoordinatorLayout里面,放一个带有可滚动的View.如上的例子,放的是ViewPager,而ViewPager里面是放了RecylerView的,即是可以滚动的View。CoordinatorLayout包含的子视图中带有滚动属性的View需要设置app:layout_behavior属性。例如，示例中Viewpager设置了此属性。</p> 
<pre class="prettyprint"><code class="language-xml hljs ">app:layout_behavior="@string/appbar_scrolling_view_behavior"</code></pre> 
<blockquote> 
 <p>为了使得Toolbar有滑动效果，必须做到如下三点: <br> 1. CoordinatorLayout作为布局的父布局容器。 <br> 2. 给需要滑动的组件设置 app:layout_scrollFlags=”scroll|enterAlways” 属性。 <br> 3. 给滑动的组件设置app:layout_behavior属性</p> 
</blockquote> 
<h4 id="32-appbarlayout嵌套collapsingtoolbarlayout">3.2 AppBarLayout嵌套CollapsingToolbarLayout</h4> 
<pre class="prettyprint"><code class="language-xml hljs "><span class="hljs-pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">android.support.design.widget.CoordinatorLayout</span> <span class="hljs-attribute">xmlns:android</span>=<span class="hljs-value">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attribute">xmlns:app</span>=<span class="hljs-value">"http://schemas.android.com/apk/res-auto"</span>
    <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/main_content"</span>
    <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
    <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"match_parent"</span>
    <span class="hljs-attribute">android:fitsSystemWindows</span>=<span class="hljs-value">"true"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">android.support.design.widget.AppBarLayout
</span>        <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/appbar"</span>
        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"256dp"</span>
        <span class="hljs-attribute">android:theme</span>=<span class="hljs-value">"@style/ThemeOverlay.AppCompat.Dark.ActionBar"</span>
        <span class="hljs-attribute">android:fitsSystemWindows</span>=<span class="hljs-value">"true"</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">android.support.design.widget.CollapsingToolbarLayout
</span>            <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/collapsing_toolbar"</span>
            <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
            <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"match_parent"</span>
            <span class="hljs-attribute">app:layout_scrollFlags</span>=<span class="hljs-value">"scroll|exitUntilCollapsed"</span>
            <span class="hljs-attribute">android:fitsSystemWindows</span>=<span class="hljs-value">"true"</span>
            <span class="hljs-attribute">app:contentScrim</span>=<span class="hljs-value">"?attr/colorPrimary"</span>
            <span class="hljs-attribute">app:expandedTitleMarginStart</span>=<span class="hljs-value">"48dp"</span>
            <span class="hljs-attribute">app:expandedTitleMarginEnd</span>=<span class="hljs-value">"64dp"</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-title">ImageView
</span>                <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/backdrop"</span>
                <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
                <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"match_parent"</span>
                <span class="hljs-attribute">android:scaleType</span>=<span class="hljs-value">"centerCrop"</span>
                <span class="hljs-attribute">android:fitsSystemWindows</span>=<span class="hljs-value">"true"</span>
                <span class="hljs-attribute">android:src</span>=<span class="hljs-value">"@drawable/header"</span>
                <span class="hljs-attribute">app:layout_collapseMode</span>=<span class="hljs-value">"parallax"</span>
                /&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-title">android.support.v7.widget.Toolbar
</span>                <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/toolbar"</span>
                <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
                <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"?attr/actionBarSize"</span>
                <span class="hljs-attribute">app:popupTheme</span>=<span class="hljs-value">"@style/ThemeOverlay.AppCompat.Light"</span>
                <span class="hljs-attribute">app:layout_collapseMode</span>=<span class="hljs-value">"pin"</span> /&gt;</span>

        <span class="hljs-tag">&lt;/<span class="hljs-title">android.support.design.widget.CollapsingToolbarLayout</span>&gt;</span>

    <span class="hljs-tag">&lt;/<span class="hljs-title">android.support.design.widget.AppBarLayout</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">android.support.v4.widget.NestedScrollView
</span>        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"match_parent"</span>
        <span class="hljs-attribute">app:layout_behavior</span>=<span class="hljs-value">"@string/appbar_scrolling_view_behavior"</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">LinearLayout
</span>            <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
            <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"match_parent"</span>
            <span class="hljs-attribute">android:orientation</span>=<span class="hljs-value">"vertical"</span>
            <span class="hljs-attribute">android:paddingTop</span>=<span class="hljs-value">"24dp"</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-title">android.support.v7.widget.CardView
</span>                <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
                <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"wrap_content"</span>
                <span class="hljs-attribute">android:layout_margin</span>=<span class="hljs-value">"16dp"</span>&gt;</span>

                <span class="hljs-tag">&lt;<span class="hljs-title">LinearLayout
</span>                    <span class="hljs-attribute">style</span>=<span class="hljs-value">"@style/Widget.CardContent"</span>
                    <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
                    <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"wrap_content"</span>&gt;</span>

                    <span class="hljs-tag">&lt;<span class="hljs-title">TextView
</span>                        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
                        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"wrap_content"</span>
                        <span class="hljs-attribute">android:text</span>=<span class="hljs-value">"CardView"</span>
                        <span class="hljs-attribute">android:textAppearance</span>=<span class="hljs-value">"@style/TextAppearance.AppCompat.Title"</span> /&gt;</span>

                    <span class="hljs-tag">&lt;<span class="hljs-title">TextView
</span>                        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
                        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"wrap_content"</span>
                        <span class="hljs-attribute">android:text</span>=<span class="hljs-value">"@string/card_string"</span> /&gt;</span>

                <span class="hljs-tag">&lt;/<span class="hljs-title">LinearLayout</span>&gt;</span>

            <span class="hljs-tag">&lt;/<span class="hljs-title">android.support.v7.widget.CardView</span>&gt;</span>
          ……
        <span class="hljs-tag">&lt;/<span class="hljs-title">LinearLayout</span>&gt;</span>

    <span class="hljs-tag">&lt;/<span class="hljs-title">android.support.v4.widget.NestedScrollView</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">android.support.design.widget.FloatingActionButton
</span>        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"wrap_content"</span>
        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"wrap_content"</span>
        <span class="hljs-attribute">app:layout_anchor</span>=<span class="hljs-value">"@id/appbar"</span>
        <span class="hljs-attribute">app:layout_anchorGravity</span>=<span class="hljs-value">"bottom|right|end"</span>
        <span class="hljs-attribute">android:src</span>=<span class="hljs-value">"@drawable/ic_done"</span>
        <span class="hljs-attribute">android:layout_margin</span>=<span class="hljs-value">"@dimen/fab_margin"</span>
        <span class="hljs-attribute">android:clickable</span>=<span class="hljs-value">"true"</span>/&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">android.support.design.widget.CoordinatorLayout</span>&gt;</span>
</code></pre> 
<p>效果： <br> <img src="https://images2.imgbox.com/d0/c7/BVIl4ifF_o.gif" alt="" title=""></p> 
<p>这种效果在详情页面用的较多，展示个性化内容，图像有强烈的吸引力。这个效果重点使用了CollapsingToolbarLayout 。 <br> CollapsingToolbarLayout可实现Toolbar的折叠效果。CollapsingToolbarLayout的子视图类似与LinearLayout垂直方向排放。</p> 
<p>CollapsingToolbarLayout 提供以下属性和方法是用： <br> 1. Collapsing title：ToolBar的标题，当CollapsingToolbarLayout全屏没有折叠时，title显示的是大字体，在折叠的过程中，title不断变小到一定大小的效果。你可以调用setTitle(CharSequence)方法设置title。 <br> 2. Content scrim：ToolBar被折叠到顶部固定时候的背景，你可以调用setContentScrim(Drawable)方法改变背景或者 在属性中使用 app:contentScrim=”?attr/colorPrimary”来改变背景。 <br> 3. Status bar scrim：状态栏的背景，调用方法setStatusBarScrim(Drawable)。还没研究明白，不过这个只能在Android5.0以上系统有效果。 <br> 4. Parallax scrolling children：CollapsingToolbarLayout滑动时，子视图的视觉差，可以通过属性app:layout_collapseParallaxMultiplier=”0.6”改变。值de的范围[0.0,1.0]，值越大视察越大。 <br> 5. CollapseMode ：子视图的折叠模式，在子视图设置，有两种“pin”：固定模式，在折叠的时候最后固定在顶端；“parallax”：视差模式，在折叠的时候会有个视差折叠的效果。我们可以在布局中使用属性app:layout_collapseMode=”parallax”来改变。</p> 
<p>CoordinatorLayout 还提供了一个 layout_anchor 的属性，连同 layout_anchorGravity 一起，可以用来放置与其他视图关联在一起的悬浮视图（如 FloatingActionButton）。本例中使用FloatingActionButton。</p> 
<p>通过下面的参数设置了FloatingActionButton的位置，两个属性共同作用使得FAB 浮动按钮也能折叠消失，展现。</p> 
<pre class="prettyprint"><code class="language-xml hljs ">app:layout_anchor="@id/appbar"
app:layout_anchorGravity="bottom|right|end"</code></pre> 
<blockquote> 
 <p>使用CollapsingToolbarLayout实现折叠效果，需要注意3点 <br> 1. AppBarLayout的高度固定 <br> 2. CollapsingToolbarLayout的子视图设置layout_collapseMode属性 <br> 3. 关联悬浮视图设置app:layout_anchor，app:layout_anchorGravity属性</p> 
</blockquote> 
<h3 id="四自定义behavior">四、自定义behavior</h3> 
<p>CoordinatorLayout功能如此强大，而他的神奇之处在于Behavior对象，CoordinatorLayout自己并不控制View，所有的控制权都在Behavior。前面写到了FloatingActionButton.Behavior，AppBarLayout.Behavior, AppBarLayout.ScrollingViewBehavior。 AppBarLayout中有两个Behavior，一个是拿来给它自己用的，另一个是拿来给它的兄弟结点用的。这些Behavior实现了复杂的控制功能。系统的Behavior毕竟有限，我们可以通过自定义的方式来实现自己的Behavior。</p> 
<p>通过 CoordinatorLayout.Behavior(YourView.Behavior.class) 来定义自己的Behavior，并在layout 文件中设置 app:layout_behavior=”com.example.app.YourView$Behavior” 来达到效果。</p> 
<p>自定义Behavior 需要重写两个方法：</p> 
<pre class="prettyprint"><code class="language-java hljs "> <span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">layoutDependsOn</span>(CoordinatorLayout parent, View child, View dependency) 

 <span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">onDependentViewChanged</span>(CoordinatorLayout parent, View child, View dependency)</code></pre> 
<p>如下面的例子，实现了点击FloatingActionButton点击旋转90度，并适配Snackbar。</p> 
<pre class="prettyprint"><code class="language-java hljs "><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RotateBehavior</span>  <span class="hljs-keyword">extends</span> <span class="hljs-title">CoordinatorLayout</span>.<span class="hljs-title">Behavior</span>&lt;<span class="hljs-title">FloatingActionButton</span>&gt; {<!-- --></span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String TAG = RotateBehavior.class.getSimpleName();

    <span class="hljs-keyword">public</span> <span class="hljs-title">RotateBehavior</span>() {
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title">RotateBehavior</span>(Context context, AttributeSet attrs) {
        <span class="hljs-keyword">super</span>(context, attrs);
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">layoutDependsOn</span>(CoordinatorLayout parent, FloatingActionButton child, View dependency) {
        <span class="hljs-keyword">return</span> dependency <span class="hljs-keyword">instanceof</span> Snackbar.SnackbarLayout;
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">onDependentViewChanged</span>(CoordinatorLayout parent, FloatingActionButton child, View dependency) {
        <span class="hljs-keyword">float</span> translationY = getFabTranslationYForSnackbar(parent, child);
        <span class="hljs-keyword">float</span> percentComplete = -translationY / dependency.getHeight();
        child.setRotation(-<span class="hljs-number">90</span> * percentComplete);
        child.setTranslationY(translationY);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">float</span> <span class="hljs-title">getFabTranslationYForSnackbar</span>(CoordinatorLayout parent,
                                                FloatingActionButton fab) {
        <span class="hljs-keyword">float</span> minOffset = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">final</span> List&lt;View&gt; dependencies = parent.getDependencies(fab);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, z = dependencies.size(); i &lt; z; i++) {
            <span class="hljs-keyword">final</span> View view = dependencies.get(i);
            <span class="hljs-keyword">if</span> (view <span class="hljs-keyword">instanceof</span> Snackbar.SnackbarLayout &amp;&amp; parent.doViewsOverlap(fab, view)) {
                minOffset = Math.min(minOffset,
                        ViewCompat.getTranslationY(view) - view.getHeight());
            }
        }

        <span class="hljs-keyword">return</span> minOffset;
    }
}</code></pre> 
<pre class="prettyprint"><code class="language-xml hljs "><span class="hljs-tag">&lt;<span class="hljs-title">android.support.design.widget.CoordinatorLayout</span> <span class="hljs-attribute">xmlns:android</span>=<span class="hljs-value">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attribute">xmlns:app</span>=<span class="hljs-value">"http://schemas.android.com/apk/res-auto"</span>
    <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/main_content"</span>
    <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"match_parent"</span>
    <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"match_parent"</span>
    <span class="hljs-attribute">android:fitsSystemWindows</span>=<span class="hljs-value">"true"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">android.support.design.widget.FloatingActionButton
</span>        <span class="hljs-attribute">android:id</span>=<span class="hljs-value">"@+id/fab"</span>
        <span class="hljs-attribute">android:layout_width</span>=<span class="hljs-value">"wrap_content"</span>
        <span class="hljs-attribute">android:layout_height</span>=<span class="hljs-value">"wrap_content"</span>
        <span class="hljs-attribute">android:layout_gravity</span>=<span class="hljs-value">"end|bottom"</span>
        <span class="hljs-attribute">android:layout_margin</span>=<span class="hljs-value">"@dimen/fab_margin"</span>
        <span class="hljs-attribute">android:src</span>=<span class="hljs-value">"@drawable/ic_done"</span>
        <span class="hljs-attribute">app:layout_behavior</span>=<span class="hljs-value">"com.meizu.coordinatorlayoutdemo.RotateBehavior"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">android.support.design.widget.CoordinatorLayout</span>&gt;</span></code></pre> 
<p>效果： <br> <img src="https://images2.imgbox.com/1b/41/Kv6pEiz4_o.gif" alt="" title=""></p> 
<p>综上，基本覆盖了CoordinatorLayout的使用方式。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d1c13b51d9a19e2f3cfd847c7f5121eb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">boost无锁队列queue</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/279961c7ac10400701b7e0b7a365765c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">最小生成树-MST算法详解及代码实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>