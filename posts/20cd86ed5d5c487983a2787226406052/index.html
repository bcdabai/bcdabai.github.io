<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>注册表操作的类 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="注册表操作的类" />
<meta property="og:description" content="//注册表操作类 /// &lt;summary&gt; 注册表根节点类型 /// &lt;/summary&gt; public enum WRegisterRootKeyType { HKEY_CLASSES_ROOT = 0, HKEY_CURRENT_USER = 1, HKEY_LOCAL_MACHINE = 2, HKEY_USERS = 3, HKEY_CURRENT_CONFIG = 4 } /// &lt;summary&gt; 读写注册表的类 /// &lt;/summary&gt; public class RegistryHelper { /// &lt;summary&gt; 获得根节点注册表 /// &lt;/summary&gt; /// &lt;param name=&#34;rootKeyType&#34;&gt;根节点类型&lt;/param&gt; /// &lt;returns&gt;&lt;/returns&gt; public static RegistryKey GetRootRegisterKey(WRegisterRootKeyType rootKeyType) { switch (rootKeyType) { case WRegisterRootKeyType.HKEY_CLASSES_ROOT: return Registry.ClassesRoot; case WRegisterRootKeyType.HKEY_CURRENT_CONFIG: return Registry.CurrentConfig; case WRegisterRootKeyType.HKEY_CURRENT_USER: return Registry.CurrentUser; case WRegisterRootKeyType.HKEY_LOCAL_MACHINE: return Registry." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/20cd86ed5d5c487983a2787226406052/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-01-25T11:10:00+08:00" />
<meta property="article:modified_time" content="2018-01-25T11:10:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">注册表操作的类</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <div class="cnblogs_code"> 
  <pre><span style="color:#008000;">//</span><span style="color:#008000;">注册表操作类</span>

<span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 注册表根节点类型
</span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
<span style="color:#0000ff;">public</span> <span style="color:#0000ff;">enum</span><span style="color:#000000;"> WRegisterRootKeyType
{
    HKEY_CLASSES_ROOT </span>= <span style="color:#800080;">0</span><span style="color:#000000;">,
    HKEY_CURRENT_USER </span>= <span style="color:#800080;">1</span><span style="color:#000000;">,
    HKEY_LOCAL_MACHINE </span>= <span style="color:#800080;">2</span><span style="color:#000000;">,
    HKEY_USERS </span>= <span style="color:#800080;">3</span><span style="color:#000000;">,
    HKEY_CURRENT_CONFIG </span>= <span style="color:#800080;">4</span><span style="color:#000000;">
}

</span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 读写注册表的类
</span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
<span style="color:#0000ff;">public</span> <span style="color:#0000ff;">class</span><span style="color:#000000;"> RegistryHelper
{
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 获得根节点注册表
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="rootKeyType"&gt;</span><span style="color:#008000;">根节点类型</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span><span style="color:#000000;"> RegistryKey GetRootRegisterKey(WRegisterRootKeyType rootKeyType)
    {
        </span><span style="color:#0000ff;">switch</span><span style="color:#000000;"> (rootKeyType)
        {
        </span><span style="color:#0000ff;">case</span><span style="color:#000000;"> WRegisterRootKeyType.HKEY_CLASSES_ROOT:
            </span><span style="color:#0000ff;">return</span><span style="color:#000000;"> Registry.ClassesRoot;
        </span><span style="color:#0000ff;">case</span><span style="color:#000000;"> WRegisterRootKeyType.HKEY_CURRENT_CONFIG:
            </span><span style="color:#0000ff;">return</span><span style="color:#000000;"> Registry.CurrentConfig;
        </span><span style="color:#0000ff;">case</span><span style="color:#000000;"> WRegisterRootKeyType.HKEY_CURRENT_USER:
            </span><span style="color:#0000ff;">return</span><span style="color:#000000;"> Registry.CurrentUser;
        </span><span style="color:#0000ff;">case</span><span style="color:#000000;"> WRegisterRootKeyType.HKEY_LOCAL_MACHINE:
            </span><span style="color:#0000ff;">return</span><span style="color:#000000;"> Registry.LocalMachine;
        </span><span style="color:#0000ff;">default</span><span style="color:#000000;">:
            </span><span style="color:#0000ff;">throw</span> <span style="color:#0000ff;">new</span> Exception(<span style="color:#800000;">"</span><span style="color:#800000;">注册表类型未定义！</span><span style="color:#800000;">"</span><span style="color:#000000;">);
        }
    }

    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 在指定注册表项下创建注册表子项
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="fatherKey"&gt;</span><span style="color:#008000;">父注册表项</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyPath"&gt;</span><span style="color:#008000;">注册表路径</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> RegistryKey CreateRegistryKey(RegistryKey fatherKey, <span style="color:#0000ff;">string</span><span style="color:#000000;"> keyPath)
    {
        RegistryKey returnKey </span>=<span style="color:#000000;"> fatherKey.CreateSubKey(keyPath);
        </span><span style="color:#0000ff;">return</span><span style="color:#000000;"> returnKey;
    }

    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 在指定注册表项下创建注册表子项
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="fatherKey"&gt;</span><span style="color:#008000;">父注册表项</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyPath"&gt;</span><span style="color:#008000;">注册表路径</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyValueName"&gt;</span><span style="color:#008000;">要添加的注册表项值名称</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyValue"&gt;</span><span style="color:#008000;">要添加的注册表项值</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> RegistryKey CreateRegistryKey(RegistryKey fatherKey, <span style="color:#0000ff;">string</span> keyPath, <span style="color:#0000ff;">string</span> keyValueName, <span style="color:#0000ff;">string</span><span style="color:#000000;"> keyValue)
    {
        RegistryKey returnKey </span>=<span style="color:#000000;"> CreateRegistryKey(fatherKey, keyPath);
        returnKey.SetValue(keyValueName, keyValue);
        </span><span style="color:#0000ff;">return</span><span style="color:#000000;"> returnKey;
    }

    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 在指定注册表项下创建注册表子项
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="rootKeyType"&gt;</span><span style="color:#008000;">注册表根节点项类型</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyPath"&gt;</span><span style="color:#008000;">注册表路径</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> RegistryKey CreateRegistryKey(WRegisterRootKeyType rootKeyType, <span style="color:#0000ff;">string</span><span style="color:#000000;"> keyPath)
    {
        RegistryKey rootKey </span>=<span style="color:#000000;"> GetRootRegisterKey(rootKeyType);
        </span><span style="color:#0000ff;">return</span><span style="color:#000000;"> CreateRegistryKey(rootKey, keyPath);
    }

    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 在指定注册表项下创建注册表子项
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="rootKeyType"&gt;</span><span style="color:#008000;">注册表根节点项类型</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyPath"&gt;</span><span style="color:#008000;">注册表路径</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyValueName"&gt;</span><span style="color:#008000;">要添加的注册表项值名称</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyValue"&gt;</span><span style="color:#008000;">要添加的注册表项值</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> RegistryKey CreateRegistryKey(WRegisterRootKeyType rootKeyType, <span style="color:#0000ff;">string</span> keyPath, <span style="color:#0000ff;">string</span> keyValueName, <span style="color:#0000ff;">string</span><span style="color:#000000;"> keyValue)
    {
        RegistryKey returnKey </span>=<span style="color:#000000;"> CreateRegistryKey(rootKeyType, keyPath);
        returnKey.SetValue(keyValueName, keyValue);
        </span><span style="color:#0000ff;">return</span><span style="color:#000000;"> returnKey;
    }

    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 删除注册表子项
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="rootKeyType"&gt;</span><span style="color:#008000;">注册表根节点项类型</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyPath"&gt;</span><span style="color:#008000;">注册表路径</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> <span style="color:#0000ff;">bool</span> DeleteRegistryKey(WRegisterRootKeyType rootKeyType, <span style="color:#0000ff;">string</span> keyPath, <span style="color:#0000ff;">string</span><span style="color:#000000;"> keyName)
    {
        RegistryKey rootKey </span>=<span style="color:#000000;"> GetRootRegisterKey(rootKeyType);
        RegistryKey deleteKey </span>= rootKey.OpenSubKey(keyPath, <span style="color:#0000ff;">true</span><span style="color:#000000;">);
        </span><span style="color:#0000ff;">if</span><span style="color:#000000;"> (IsKeyHaveSubKey(deleteKey, keyName))
        {
            deleteKey.DeleteSubKey(keyName);
            </span><span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
        }
        </span><span style="color:#0000ff;">return</span> <span style="color:#0000ff;">false</span><span style="color:#000000;">;
    }

    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 获取注册表项
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="rootKeyType"&gt;</span><span style="color:#008000;">注册表根节点项类型</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyPath"&gt;</span><span style="color:#008000;">注册表路径</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> RegistryKey GetRegistryKey(WRegisterRootKeyType rootKeyType, <span style="color:#0000ff;">string</span><span style="color:#000000;"> keyPath)
    {
        RegistryKey rootKey </span>=<span style="color:#000000;"> GetRootRegisterKey(rootKeyType);
        </span><span style="color:#0000ff;">return</span><span style="color:#000000;"> rootKey.OpenSubKey(keyPath);
    }

    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 获取注册表项指定值
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="rootKeyType"&gt;</span><span style="color:#008000;">注册表根节点项类型</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyPath"&gt;</span><span style="color:#008000;">注册表路径</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyName"&gt;</span><span style="color:#008000;">要获得值的注册表值名称</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> <span style="color:#0000ff;">string</span> GetRegistryValue(WRegisterRootKeyType rootKeyType, <span style="color:#0000ff;">string</span> keyPath, <span style="color:#0000ff;">string</span><span style="color:#000000;"> keyName)
    {
        RegistryKey key </span>=<span style="color:#000000;"> GetRegistryKey(rootKeyType, keyPath);
        </span><span style="color:#0000ff;">if</span><span style="color:#000000;"> (IsKeyHaveValue(key, keyName))
        {
            </span><span style="color:#0000ff;">return</span><span style="color:#000000;"> key.GetValue(keyName).ToString();
        }
        </span><span style="color:#0000ff;">return</span> <span style="color:#0000ff;">null</span><span style="color:#000000;">;
    }

    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 设置注册表项值
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="key"&gt;</span><span style="color:#008000;">注册表项</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyValueName"&gt;</span><span style="color:#008000;">值名称</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyValue"&gt;</span><span style="color:#008000;">值</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> <span style="color:#0000ff;">bool</span> SetRegistryValue(RegistryKey key, <span style="color:#0000ff;">string</span> keyValueName, <span style="color:#0000ff;">string</span><span style="color:#000000;"> keyValue)
    {
        key.SetValue(keyValueName, keyValue);
        </span><span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
    }

    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 设置注册表项值
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="rootKeyType"&gt;</span><span style="color:#008000;">注册表根节点项类型</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyPath"&gt;</span><span style="color:#008000;">注册表路径</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyValueName"&gt;</span><span style="color:#008000;">值名称</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyValue"&gt;</span><span style="color:#008000;">值</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> <span style="color:#0000ff;">bool</span> SetRegistryValue(WRegisterRootKeyType rootKeyType, <span style="color:#0000ff;">string</span> keyPath, <span style="color:#0000ff;">string</span> keyValueName, <span style="color:#0000ff;">string</span><span style="color:#000000;"> keyValue)
    {
        RegistryKey key </span>=<span style="color:#000000;"> GetRegistryKey(rootKeyType, keyPath);
        key.SetValue(keyValueName, keyValue);
        </span><span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
    }

    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 删除注册表项值
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="key"&gt;</span><span style="color:#008000;">注册表项</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyValueName"&gt;</span><span style="color:#008000;">值名称</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyValue"&gt;</span><span style="color:#008000;">值</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> <span style="color:#0000ff;">bool</span> DeleteRegistryValue(RegistryKey key, <span style="color:#0000ff;">string</span><span style="color:#000000;"> keyValueName)
    {
        </span><span style="color:#0000ff;">if</span><span style="color:#000000;"> (IsKeyHaveValue(key, keyValueName))
        {
            key.DeleteValue(keyValueName);
            </span><span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
        }
        </span><span style="color:#0000ff;">return</span> <span style="color:#0000ff;">false</span><span style="color:#000000;">;
    }

    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 删除注册表项值
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="rootKeyType"&gt;</span><span style="color:#008000;">注册表根节点项类型</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyPath"&gt;</span><span style="color:#008000;">注册表路径</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyValueName"&gt;</span><span style="color:#008000;">值名称</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> <span style="color:#0000ff;">bool</span> DeleteRegistryValue(WRegisterRootKeyType rootKeyType, <span style="color:#0000ff;">string</span> keyPath, <span style="color:#0000ff;">string</span><span style="color:#000000;"> keyValueName)
    {
        RegistryKey key </span>=<span style="color:#000000;"> GetRegistryKey(rootKeyType, keyPath);
        </span><span style="color:#0000ff;">if</span><span style="color:#000000;"> (IsKeyHaveValue(key, keyValueName))
        {
            key.DeleteValue(keyValueName);
            </span><span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
        }
        </span><span style="color:#0000ff;">return</span> <span style="color:#0000ff;">false</span><span style="color:#000000;">;
    }

    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 判断注册表项是否有指定的注册表值
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="key"&gt;</span><span style="color:#008000;">注册表项</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="valueName"&gt;</span><span style="color:#008000;">注册表值</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> <span style="color:#0000ff;">bool</span> IsKeyHaveValue(RegistryKey key, <span style="color:#0000ff;">string</span><span style="color:#000000;"> valueName)
    {
        </span><span style="color:#0000ff;">string</span>[] keyNames =<span style="color:#000000;"> key.GetValueNames();
        </span><span style="color:#0000ff;">foreach</span> (<span style="color:#0000ff;">string</span> keyName <span style="color:#0000ff;">in</span><span style="color:#000000;"> keyNames)
        {
            </span><span style="color:#0000ff;">if</span> (keyName.Trim() ==<span style="color:#000000;"> valueName.Trim())
            {
                </span><span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
            }
        }
        </span><span style="color:#0000ff;">return</span> <span style="color:#0000ff;">false</span><span style="color:#000000;">;
    }

    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 判断注册表项是否有指定的子项
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="key"&gt;</span><span style="color:#008000;">注册表项</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyName"&gt;</span><span style="color:#008000;">子项名称</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> <span style="color:#0000ff;">bool</span> IsKeyHaveSubKey(RegistryKey key, <span style="color:#0000ff;">string</span><span style="color:#000000;"> keyName)
    {
        </span><span style="color:#0000ff;">string</span>[] subKeyNames =<span style="color:#000000;"> key.GetSubKeyNames();
        </span><span style="color:#0000ff;">foreach</span> (<span style="color:#0000ff;">string</span> subKeyName <span style="color:#0000ff;">in</span><span style="color:#000000;"> subKeyNames)
        {
            </span><span style="color:#0000ff;">if</span> (keyName.Trim() ==<span style="color:#000000;"> subKeyName.Trim())
            {
                </span><span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
            }
        }
        </span><span style="color:#0000ff;">return</span> <span style="color:#0000ff;">false</span><span style="color:#000000;">;
    }

    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span><span style="color:#008000;"> 根据注册表键路径获得注册表键名称
    </span><span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;param name="keyPath"&gt;</span><span style="color:#008000;">注册表键路径</span><span style="color:#808080;">&lt;/param&gt;</span>
    <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;returns&gt;&lt;/returns&gt;</span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> <span style="color:#0000ff;">string</span> GetKeyNameByPath(<span style="color:#0000ff;">string</span><span style="color:#000000;"> keyPath)
    {
        </span><span style="color:#0000ff;">int</span> keyIndex = keyPath.LastIndexOf(<span style="color:#800000;">"</span><span style="color:#800000;">/</span><span style="color:#800000;">"</span><span style="color:#000000;">);
        </span><span style="color:#0000ff;">return</span> keyPath.Substring(keyIndex + <span style="color:#800080;">1</span><span style="color:#000000;">);
    }
}

</span><span style="color:#008000;">//</span><span style="color:#008000;">调试

</span><span style="color:#008000;">//</span><span style="color:#008000;">获取 HKEY_LOCAL_MACHINE 下的子项数量
</span><span style="color:#008000;">//</span><span style="color:#008000;">如果要获取其他根节点，只需修改参数即可，参数是个枚举类型，具体查看 注册表根节点类型</span>
RegistryKey Rjc =<span style="color:#000000;"> RegistryHelper.GetRootRegisterKey(WRegisterRootKeyType.HKEY_LOCAL_MACHINE);
Console.WriteLine(Rjc.SubKeyCount);

</span><span style="color:#008000;">//</span><span style="color:#008000;">获取 HKEY_LOCAL_MACHINE 下的所有子项的名称</span>
<span style="color:#0000ff;">foreach</span> (<span style="color:#0000ff;">string</span> str <span style="color:#0000ff;">in</span><span style="color:#000000;"> Rjc.GetSubKeyNames())
{
    Console.WriteLine(str);
}

</span><span style="color:#008000;">//</span><span style="color:#008000;">指定要操作的注册表路径  HKEY_LOCAL_MACHINE\SOFTWARE</span>
RegistryKey fatherrjc = Microsoft.Win32.Registry.LocalMachine.OpenSubKey(<span style="color:#800000;">@"</span><span style="color:#800000;">Software</span><span style="color:#800000;">"</span>, <span style="color:#0000ff;">true</span><span style="color:#000000;">);

</span><span style="color:#008000;">//</span><span style="color:#008000;">创建一个注册表子项 - 在 HKEY_LOCAL_MACHINE\SOFTWARE 下创建 - 创建完记得刷新，否则看不到</span>
RegistryHelper.CreateRegistryKey(fatherrjc, <span style="color:#800000;">"</span><span style="color:#800000;">三肿专用注册表</span><span style="color:#800000;">"</span><span style="color:#000000;">);

</span><span style="color:#008000;">//</span><span style="color:#008000;">创建一个注册表子项，并写入一个键值 - 在 HKEY_LOCAL_MACHINE\SOFTWARE 下创建 - 创建完记得刷新，否则看不到</span>
RegistryHelper.CreateRegistryKey(fatherrjc, <span style="color:#800000;">"</span><span style="color:#800000;">三肿专用注册表2</span><span style="color:#800000;">"</span>, <span style="color:#800000;">"</span><span style="color:#800000;">测试键值</span><span style="color:#800000;">"</span>, <span style="color:#800000;">"</span><span style="color:#800000;">我是内容</span><span style="color:#800000;">"</span><span style="color:#000000;">);


</span><span style="color:#008000;">//</span><span style="color:#008000;">获取注册表项指定值</span>
<span style="color:#0000ff;">string</span> KeyValue = RegistryHelper.GetRegistryValue(WRegisterRootKeyType.HKEY_LOCAL_MACHINE, <span style="color:#800000;">@"</span><span style="color:#800000;">Software\三肿专用注册表2</span><span style="color:#800000;">"</span>, <span style="color:#800000;">"</span><span style="color:#800000;">测试键值</span><span style="color:#800000;">"</span><span style="color:#000000;">);

</span><span style="color:#008000;">//</span><span style="color:#008000;">删除注册表的一个键值
</span><span style="color:#008000;">//</span><span style="color:#008000;">指定要操作的注册表路径  HKEY_LOCAL_MACHINE\SOFTWARE\三肿专用注册表2</span>
RegistryKey deleterjc = Microsoft.Win32.Registry.LocalMachine.OpenSubKey(<span style="color:#800000;">@"</span><span style="color:#800000;">Software\三肿专用注册表2</span><span style="color:#800000;">"</span>, <span style="color:#0000ff;">true</span><span style="color:#000000;">);
RegistryHelper.DeleteRegistryValue(deleterjc, </span><span style="color:#800000;">"</span><span style="color:#800000;">测试键值</span><span style="color:#800000;">"</span><span style="color:#000000;">);

</span><span style="color:#008000;">//</span><span style="color:#008000;">删除注册表的一个子项</span>
RegistryHelper.DeleteRegistryKey(WRegisterRootKeyType.HKEY_LOCAL_MACHINE, <span style="color:#800000;">@"</span><span style="color:#800000;">Software</span><span style="color:#800000;">"</span>, <span style="color:#800000;">"</span><span style="color:#800000;">三肿专用注册表2</span><span style="color:#800000;">"</span>);</pre> 
 </div> 
 <p> </p> 
</div> 
<p>转载于:https://www.cnblogs.com/cxlater/p/8350311.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f83289a764b1305ebfafcb84ce78b619/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">spring boot之session的创建，销毁，超时，监听等等小结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b4a5e355d859b1c7f102dc736d2457a4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">单点登录CAS协议详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>