<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>服务器端文档组件 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="服务器端文档组件" />
<meta property="og:description" content="服务器端文档组件 项目中需要使用文档组件操作文档(导入，导出)操作文档的框架有如下几种 1.Apache POI 1.概述 1.Apache POI是用Java编写的免费开源的跨平台的 Java API2.Apache POI提供API给Java程序对Microsoft Office（Excel、WORD、PowerPoint、Visio等）格式文档读和写的功能3.POI为Poor Obfuscation Implementation的首字母缩写，意为：可怜的模糊实现 2.功能 1.操作Excel(向下兼容) 1.HSSF － 提供读写Microsoft Excel(1997~2003版本)格式档案的功能(.xls)(依赖-poi)2.XSSF － 提供读写Microsoft Excel(2007版本)格式档案的功能(.xlsx)(依赖-poi-ooxml)3.SXSSF - XSSF的升级版本(POI3.8版本及以上)，支持低内存占用(.xlsx)(依赖-poi-ooxml) //三种方式的接口及方法 HSSF：HSSFWorkbook、HSSFSheet、HSSFRow、HSSFCell…… XSSF：XSSFWorkbook、XSSFSheet、XSSFRow、XSSFCell…… SXSSF：SXSSFWorkbook、Sheet、Row、Cell…… //SXSSF之所以是一种低内存操作方式，是因为他的构造方法SXSSFWorkbook w3= new SXSSFWorkbook(100); //100可理解为POI操作时，内存中最多只有100行数据，当超过这个数据时，就将内存之前的数据删除，并且会在硬盘中生成临时文件，从而保证了低内存消耗。也可以将这个数字调大一点 2.操作Word 1.HWPF － 提供读写Microsoft Word DOC97格式档案的功能(.doc)(依赖-poi-scratchpad)2.XWPF － 提供读写Microsoft Word DOC2003格式档案的功能(.docx)(依赖-poi-ooxml) 3.操作PowerPoint HSLF － 提供读写Microsoft PowerPoint格式档案的功能(.ppt)(依赖-poi-scratchpad) 4.操作Visio HDGF － 提供读Microsoft Visio格式流程图的功能(.vsd)(依赖-poi-scratchpad) 5.操作Publisher HPBF － 提供读Microsoft Publisher格式排版设计的功能(.pub)(依赖-poi-scratchpad) 6.操作Outlook HSMF － 提供读Microsoft Outlook格式电子邮件的功能(.msg)(依赖-poi-scratchpad) 3.依赖 4.特点 5.不同文档操作步骤 1.操作Excel // HSSF(Horrible SpreadSheet Format)：通过HSSF可以用纯Java代码来读取、写入、修改Excel文件 // HSSF为读取操作提供了两类API：usermodel和eventusermodel。即“用户模型”和“事件-用户模型” 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e36e869e302b22191d1e0fd5ce555201/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-30T23:01:21+08:00" />
<meta property="article:modified_time" content="2022-11-30T23:01:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">服务器端文档组件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <h2><a id="_0"></a>服务器端文档组件</h2> 
 <ul><li>项目中需要使用文档组件操作文档(导入，导出)</li><li>操作文档的框架有如下几种</li></ul> 
</blockquote> 
<blockquote> 
 <h3><a id="1Apache_POI_5"></a>1.Apache POI</h3> 
</blockquote> 
<blockquote> 
 <h4><a id="1_7"></a>1.概述</h4> 
 <ul><li>1.Apache POI是用Java编写的免费开源的跨平台的 Java API</li><li>2.Apache POI提供API给Java程序对Microsoft Office（Excel、WORD、PowerPoint、Visio等）格式文档读和写的功能</li><li>3.POI为<code>Poor Obfuscation Implementation</code>的首字母缩写，意为：可怜的模糊实现</li></ul> 
</blockquote> 
<blockquote> 
 <h4><a id="2_12"></a>2.功能</h4> 
 <ul><li>1.操作Excel(向下兼容) 
   <ul><li>1.HSSF － 提供读写Microsoft Excel(1997~2003版本)格式档案的功能(.xls)(依赖-poi)</li><li>2.XSSF － 提供读写Microsoft Excel(2007版本)格式档案的功能(.xlsx)(依赖-poi-ooxml)</li><li>3.SXSSF - XSSF的升级版本(POI3.8版本及以上)，支持低内存占用(.xlsx)(依赖-poi-ooxml)</li></ul> <pre><code class="prism language-java"><span class="token comment">//三种方式的接口及方法</span>
<span class="token constant">HSSF</span>：<span class="token class-name">HSSFWorkbook</span>、<span class="token class-name">HSSFSheet</span>、<span class="token class-name">HSSFRow</span>、<span class="token class-name">HSSFCell</span>……

<span class="token constant">XSSF</span>：<span class="token class-name">XSSFWorkbook</span>、<span class="token class-name">XSSFSheet</span>、<span class="token class-name">XSSFRow</span>、<span class="token class-name">XSSFCell</span>……

<span class="token constant">SXSSF</span>：<span class="token class-name">SXSSFWorkbook</span>、<span class="token class-name">Sheet</span>、<span class="token class-name">Row</span>、<span class="token class-name">Cell</span>……
<span class="token comment">//SXSSF之所以是一种低内存操作方式，是因为他的构造方法SXSSFWorkbook w3= new SXSSFWorkbook(100);</span>
<span class="token comment">//100可理解为POI操作时，内存中最多只有100行数据，当超过这个数据时，就将内存之前的数据删除，并且会在硬盘中生成临时文件，从而保证了低内存消耗。也可以将这个数字调大一点</span>
</code></pre> </li><li>2.操作Word 
   <ul><li>1.HWPF － 提供读写Microsoft Word DOC97格式档案的功能(.doc)(依赖-poi-scratchpad)</li><li>2.XWPF － 提供读写Microsoft Word DOC2003格式档案的功能(.docx)(依赖-poi-ooxml)</li></ul> </li><li>3.操作PowerPoint 
   <ul><li>HSLF － 提供读写Microsoft PowerPoint格式档案的功能(.ppt)(依赖-poi-scratchpad)</li></ul> </li><li>4.操作Visio 
   <ul><li>HDGF － 提供读Microsoft Visio格式流程图的功能(.vsd)(依赖-poi-scratchpad)</li></ul> </li><li>5.操作Publisher 
   <ul><li>HPBF － 提供读Microsoft Publisher格式排版设计的功能(.pub)(依赖-poi-scratchpad)</li></ul> </li><li>6.操作Outlook 
   <ul><li>HSMF － 提供读Microsoft Outlook格式电子邮件的功能(.msg)(依赖-poi-scratchpad)</li></ul> </li></ul> 
</blockquote> 
<blockquote> 
 <h4><a id="3_39"></a>3.依赖</h4> 
 <p><img src="https://images2.imgbox.com/bc/31/P8BJ676G_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8b/57/HgPpgWEr_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<blockquote> 
 <h4><a id="4_43"></a>4.特点</h4> 
</blockquote> 
<blockquote> 
 <h4><a id="5_45"></a>5.不同文档操作步骤</h4> 
</blockquote> 
<blockquote> 
 <h5><a id="1Excel_47"></a>1.操作Excel</h5> 
 <pre><code class="prism language-java"><span class="token comment">// HSSF(Horrible SpreadSheet Format)：通过HSSF可以用纯Java代码来读取、写入、修改Excel文件 </span>
<span class="token comment">// HSSF为读取操作提供了两类API：usermodel和eventusermodel。即“用户模型”和“事件-用户模型”</span>

<span class="token number">1.</span>Excel中的表单、工作表、行、单元格的关系 
<span class="token comment">// 一个Excel文件对应于一个workbook(HSSFWorkbook)</span>
<span class="token comment">// 一个workbook可以有多个sheet（HSSFSheet）组成</span>
<span class="token comment">// 一个sheet是由多个row（HSSFRow）组成</span>
<span class="token comment">// 一个row是由多个cell（HSSFCell）组成</span>

<span class="token number">2.</span>常用的类和方法 
<span class="token comment">//1.HSSFWorkbook：表单(代表一个excel的整个文档) </span>
<span class="token class-name">HSSFWorkbook</span> hssfWorkbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HSSFWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建一个新的表单,一般用于导出 HSSFWorkbook</span>
hssfWorkbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HSSFWorkbook</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建一个关联输入流的表单，将一个excel文件封装成表单，一般用于导入 </span>
hssfWorkbook<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//关闭资源</span>

<span class="token comment">//2.HSSFSheet：工作表(同一个表单可以创建多个工作表) </span>
<span class="token class-name">HSSFSheet</span> hssfSheet <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建一个默认名称的Sheet，从sheet0开始 </span>
<span class="token class-name">HSSFSheet</span> sheetname<span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createSheet</span><span class="token punctuation">(</span><span class="token class-name">String</span> sheetname<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建一个指定名称的Sheet </span>
hssfWorkbook<span class="token punctuation">.</span><span class="token function">setActiveSheet</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置默认选中的工作表，索引从0开始</span>

<span class="token class-name">HSSFSheet</span> <span class="token function">getSheet</span><span class="token punctuation">(</span><span class="token class-name">String</span> sheetName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//通过名称获取指定Sheet HSSFSheet</span>
<span class="token function">getSheetAt</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//通过索引获取指定Sheet，索引从0开始 </span>
<span class="token keyword">int</span> <span class="token function">getNumberOfSheets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取当前表单的sheet总个数</span>

<span class="token comment">//3.HSSFRow：行 </span>
<span class="token class-name">HSSFRow</span> hssfRow <span class="token operator">=</span> hssfSheet<span class="token punctuation">.</span><span class="token function">createRow</span><span class="token punctuation">(</span><span class="token keyword">int</span> rownum<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//创建行，需要指定行号，行号从0开始 short height = 2000;</span>
hssfRow<span class="token punctuation">.</span><span class="token function">setHeight</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置行高，默认值为-1</span>
hssfRow<span class="token punctuation">.</span><span class="token function">setHeightInPoints</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//以点为单位设置行高，等同于*20，默认值为-1</span>
hssfRow<span class="token punctuation">.</span><span class="token function">setRowNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> rowIndex<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置行好，range 0-65535</span>
hssfRow<span class="token punctuation">.</span><span class="token function">setZeroHeight</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置是否显示高度为0的行</span>
hssfRow<span class="token punctuation">.</span><span class="token function">setRowStyle</span><span class="token punctuation">(</span>cellStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//设置行的样式，会被单元格覆盖掉 HSSFRow getRow(int index); //根据索引获取指定的行</span>
<span class="token function">getLastRowNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取最后的行的索引，没有行或者只有一行的时候返回0</span>

<span class="token comment">//4.Column：列 </span>
hssfSheet<span class="token punctuation">.</span><span class="token function">autoSizeColumn</span><span class="token punctuation">(</span><span class="token keyword">int</span> column<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//设置工作表指定列的长度随内容自动调整。注意：设置自适应长度需要在设置值之后才会生效</span>
hssfSheet<span class="token punctuation">.</span><span class="token function">setColumnWidth</span><span class="token punctuation">(</span><span class="token keyword">int</span> columnIndex<span class="token punctuation">,</span> <span class="token keyword">int</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//设置某一列的宽度，width=字符个数 * 256(例：20个字符的宽度就是20 * 256),最大不能超过255个字符,可以在自适应的情况下特别指定</span>

<span class="token comment">//5.HSSFCell：单元格 </span>
<span class="token class-name">HSSFCell</span> hssfCell <span class="token operator">=</span> hssfRow<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token keyword">int</span> column<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建新的单元格,并指定列 </span>
<span class="token class-name">HSSFCell</span> hssfCell <span class="token operator">=</span> hssfRow<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token keyword">int</span> column<span class="token punctuation">,</span><span class="token class-name">CellType</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建新的单元格,并指定列和类型</span>

hssfCell<span class="token punctuation">.</span><span class="token function">setCellStyle</span><span class="token punctuation">(</span><span class="token class-name">HSSFCellStyle</span> style<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置单元格样式，例如字体、加粗、格式化</span>
hssfCell<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token class-name">Date</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置单元格的内容，有多种类型</span>
hssfCell<span class="token punctuation">.</span><span class="token function">setAsActiveCell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置默认选中单元格 </span>
hssfCell<span class="token punctuation">.</span><span class="token function">setBlank</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置为空白单元格 </span>
hssfCell<span class="token punctuation">.</span><span class="token function">setCellFormula</span><span class="token punctuation">(</span><span class="token class-name">String</span> formula<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置计算公式，计算的结果作为单元格的值，也提供了异常常用的函数，如求和"sum(A1,C1)"、日期函数、字符串相关函数、CountIf和SumIf函数、随机数函数等</span>
hssfCell<span class="token punctuation">.</span><span class="token function">setCellType</span><span class="token punctuation">(</span><span class="token class-name">CellType</span> cellType<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置单元格类型，参数为CellType枚举类</span>

<span class="token class-name">HSSFCell</span> <span class="token function">getCell</span><span class="token punctuation">(</span>shot index<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token class-name">HSSFCell</span> <span class="token function">getCell</span><span class="token punctuation">(</span><span class="token class-name">CellReference</span><span class="token punctuation">.</span><span class="token function">convertColStringToIndex</span><span class="token punctuation">(</span>“<span class="token class-name">A</span>”<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 根据列名英文字母获取。 
<span class="token keyword">short</span> <span class="token function">getLastCellNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取最后的单元格号，如果单元格有第一个开始算，lastCellNum就是列的个数 </span>
<span class="token class-name">String</span> <span class="token function">getStringCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取单元格中的字符串值</span>

<span class="token comment">//6.HSSFCellStyle：单元格样式(可以为行设置样式，也可以为单元格设置样式，行样式会被单元格覆盖，所以一般设置单元格样式) </span>
<span class="token class-name">HSSFCellStyle</span> cellStyle <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建单元格样式 </span>
cellStyle<span class="token punctuation">.</span><span class="token function">setFillBackgroundColor</span><span class="token punctuation">(</span><span class="token keyword">short</span> bg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置背景色，.xls中该设置不生效</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setFillForegroundColor</span><span class="token punctuation">(</span><span class="token keyword">short</span> bg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置填充前景色，该设置生效，其中参数使用IndexedColors.RED.getIndex() </span>
cellStyle<span class="token punctuation">.</span><span class="token function">setFillPattern</span><span class="token punctuation">(</span><span class="token class-name">FillPatternType</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置填充样式，其中参数使用FillPatternType.FINE_DOTS</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span><span class="token class-name">HSSFFont</span> hf<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置字体样式 </span>
cellStyle<span class="token punctuation">.</span><span class="token function">setAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span> align<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置水平对齐方式 HorizontalAlignment.CENTER 居中对齐</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setVerticalAlignment</span><span class="token punctuation">(</span><span class="token class-name">VerticalAlignment</span> align<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置垂直对齐方式 VerticalAlignment.BOTTOM 设置底部对齐</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setVerticalAlignment</span><span class="token punctuation">(</span><span class="token class-name">VerticalAlignment</span> align<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置垂直对齐方式</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setBorderTop</span><span class="token punctuation">(</span><span class="token class-name">BorderStyle</span> border<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格顶部边框的边框类型</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setBorderBottom</span><span class="token punctuation">(</span><span class="token class-name">BorderStyle</span> border<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格底部边框的边框类型 BorderStyle.DOTTED 点类型</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setBorderLeft</span><span class="token punctuation">(</span><span class="token class-name">BorderStyle</span> border<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格左部边框的边框类型 </span>
cellStyle<span class="token punctuation">.</span><span class="token function">setBorderRight</span><span class="token punctuation">(</span><span class="token class-name">BorderStyle</span> border<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格右部边框的边框类型</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setTopBorderColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格顶部边框的边框颜色</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setBottomBorderColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span><span class="token constant">BLUE</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格底部边框的边框颜色</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setLeftBorderColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span><span class="token constant">PINK</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格左部边框的边框颜色</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setRightBorderColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span><span class="token constant">CORAL</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格右部边框的边框颜色</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setHidden</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//是否隐藏单元格，测试没出效果 short</span>
indention <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> cellStyle<span class="token punctuation">.</span><span class="token function">setIndention</span><span class="token punctuation">(</span>indention<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//缩进单元格文本空格数</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setLocked</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//锁定该单元格，测试没出效果 short rotation = 80;</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setRotation</span><span class="token punctuation">(</span>rotation<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置内容旋转度数 HSSF为-90~90，XHSSF为0~180</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setShrinkToFit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置单元格是否自动调整大小，以便内容过长时缩小以适应，测试没出效果</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setQuotePrefixed</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//是否打开样式前缀 short order = 2;</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setReadingOrder</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置文本的读取顺序，0为默认，1为从左到右，2为从右到左，测试没出效果</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setUserStyleName</span><span class="token punctuation">(</span><span class="token string">"测试"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置样式名称，测试没出效果</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setWrapText</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置文本是否换行，测试没出效果</span>

<span class="token class-name">HSSFDataFormat</span> hssfDataFormat <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createDataFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建表单数据格式 </span>
<span class="token keyword">short</span> format <span class="token operator">=</span> hssfDataFormat<span class="token punctuation">.</span><span class="token function">getFormat</span><span class="token punctuation">(</span><span class="token string">"@"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置数据格式为文本</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setDataFormat</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置数据格式</span>

<span class="token class-name">HSSFDataFormat</span> hssfDataFormat <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createDataFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建表单数据格式 </span>
<span class="token keyword">short</span> format <span class="token operator">=</span> hssfDataFormat<span class="token punctuation">.</span><span class="token function">getFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy年m月d日"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置数据格式为日期 </span>
cellStyle<span class="token punctuation">.</span><span class="token function">setDataFormat</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置数据格式</span>

<span class="token class-name">HSSFDataFormat</span> hssfDataFormat <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createDataFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建表单数据格式 </span>
<span class="token keyword">short</span> format <span class="token operator">=</span> <span class="token class-name">HSSFDataFormat</span><span class="token punctuation">.</span><span class="token function">getBuiltinFormat</span><span class="token punctuation">(</span><span class="token string">"0.00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置数据保留两位小数 其余设置可参考</span>
<span class="token class-name">BuiltinFormats</span> cellStyle<span class="token punctuation">.</span><span class="token function">setDataFormat</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置数据格式</span>

<span class="token class-name">HSSFDataFormat</span> hssfDataFormat <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createDataFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建表单数据格式 </span>
<span class="token keyword">short</span> format <span class="token operator">=</span> hssfDataFormat<span class="token punctuation">.</span><span class="token function">getFormat</span><span class="token punctuation">(</span><span class="token string">"¥#,##0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置货币模式 其余设置可参考BuiltinFormats </span>
cellStyle<span class="token punctuation">.</span><span class="token function">setDataFormat</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置数据格式</span>

<span class="token class-name">HSSFDataFormat</span> hssfDataFormat <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createDataFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建表单数据格式 </span>
<span class="token keyword">short</span> format <span class="token operator">=</span> hssfDataFormat<span class="token punctuation">.</span><span class="token function">getFormat</span><span class="token punctuation">(</span><span class="token string">"[DbNum2][$-804]0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置数字-中文大写格式</span>
cellStyle<span class="token punctuation">.</span><span class="token function">setDataFormat</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置数据格式</span>

<span class="token comment">//7.Merge：合并单元格 </span>
hssfSheet<span class="token punctuation">.</span><span class="token function">addMergedRegion</span><span class="token punctuation">(</span><span class="token class-name">CellRangeAddress</span> region<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//合并单元格</span>
<span class="token keyword">new</span> <span class="token class-name">CellRangeAddress</span><span class="token punctuation">(</span><span class="token keyword">int</span> firstRow<span class="token punctuation">,</span> <span class="token keyword">int</span> lastRow<span class="token punctuation">,</span> <span class="token keyword">int</span> firstCol<span class="token punctuation">,</span> <span class="token keyword">int</span> lastCol<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//单元格范围, 用于合并单元格，需要指定要合并的首行、最后一行、首列、最后一列</span>
<span class="token comment">//合并单元格</span>
<span class="token class-name">CellRangeAddress</span>创建新的单元格范围。索引从零开始（开始行，结束行，开始列，结束列）
hssfSheet<span class="token punctuation">.</span><span class="token function">addMergedRegion</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CellRangeAddress</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hssfSheet<span class="token punctuation">.</span><span class="token function">addMergedRegion</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CellRangeAddress</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//8.write：导出 </span>
<span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//java.lang.IllegalStateException: Newly created Document, cannot save in-place </span>
<span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">File</span> newFile<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//导出到一个文件中</span>
<span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">OutputStream</span> stream<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//导出到输入流中</span>

<span class="token comment">//9.HSSFFont：字体， </span>
<span class="token class-name">HSSFCellStyle</span> cellFontStyle <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//样式 </span>
<span class="token class-name">HSSFFont</span> hssfFont <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hssfFont<span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span><span class="token constant">BLUE</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//字体颜色</span>
hssfFont<span class="token punctuation">.</span><span class="token function">setBold</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//是否粗体 </span>
hssfFont<span class="token punctuation">.</span><span class="token function">setCharSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置字符集</span>
hssfFont<span class="token punctuation">.</span><span class="token function">setFontHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置字体高度 </span>
hssfFont<span class="token punctuation">.</span><span class="token function">setFontHeightInPoints</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置字体高度，标准值10, 12, 14 etc.. </span>
hssfFont<span class="token punctuation">.</span><span class="token function">setFontName</span><span class="token punctuation">(</span><span class="token string">"楷体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//根据名称设置字体类型</span>
hssfFont<span class="token punctuation">.</span><span class="token function">setItalic</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//是否斜体 </span>
hssfFont<span class="token punctuation">.</span><span class="token function">setStrikeout</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置是否在文本中使用消线水平线(会覆盖掉下划线) </span>
hssfFont<span class="token punctuation">.</span><span class="token function">setTypeOffset</span><span class="token punctuation">(</span><span class="token class-name">Font</span><span class="token punctuation">.</span><span class="token constant">SS_SUPER</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置字体类型，是上标或下标 </span>
hssfFont<span class="token punctuation">.</span><span class="token function">setUnderline</span><span class="token punctuation">(</span><span class="token class-name">Font</span><span class="token punctuation">.</span><span class="token constant">U_SINGLE_ACCOUNTING</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//下划线 U_SINGLE_ACCOUNTING单下划线</span>
</code></pre> 
</blockquote> 
<blockquote> 
 <h6><a id="2Excel_179"></a>2.从Excel读取数据</h6> 
 <ul><li>1.读取普通数据<pre><code class="prism language-java">	<span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">TestExcelRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//1.指定读取Excel的位置(绝对位置或相对位置)</span>
        <span class="token class-name">String</span> filePath <span class="token operator">=</span> <span class="token string">"E:\\Apache POI\\template.xls"</span><span class="token punctuation">;</span>

        <span class="token comment">//2.转换为文件输入流</span>
        <span class="token class-name">FileInputStream</span> fileInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//3.通过输入流创建表单</span>
        <span class="token class-name">HSSFWorkbook</span> hssfWorkbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HSSFWorkbook</span><span class="token punctuation">(</span>fileInputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//4.通过下标读取表单中的工作表</span>
        <span class="token class-name">HSSFSheet</span> hssfSheet <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">getSheetAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//5.获取表单的列数和行数</span>
        <span class="token keyword">int</span> lastRowNum <span class="token operator">=</span> hssfSheet<span class="token punctuation">.</span><span class="token function">getLastRowNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//最后一行</span>
        <span class="token keyword">short</span> lastCellNum <span class="token operator">=</span> hssfSheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLastCellNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//最后一列</span>

        <span class="token comment">//6.双层循环遍历获取单元格的值 或者 使用迭代器</span>
<span class="token comment">//        for (int r = 0; r &lt;= lastRowNum; r++) {<!-- --></span>
<span class="token comment">//            HSSFRow row = hssfSheet.getRow(r);</span>
<span class="token comment">//            for (int c = 0; c &lt; lastCellNum; c++) {<!-- --></span>
<span class="token comment">//                HSSFCell cell = row.getCell(c);</span>
<span class="token comment">//                switch (cell.getCellType()) {<!-- --></span>
<span class="token comment">//                    case STRING:</span>
<span class="token comment">//                        System.out.print(cell.getStringCellValue());</span>
<span class="token comment">//                        break;</span>
<span class="token comment">//                    case NUMERIC:</span>
<span class="token comment">//                        System.out.print(cell.getNumericCellValue());</span>
<span class="token comment">//                        break;</span>
<span class="token comment">//                    case BOOLEAN:</span>
<span class="token comment">//                        System.out.print(cell.getBooleanCellValue());</span>
<span class="token comment">//                        break;</span>
<span class="token comment">//                }</span>
<span class="token comment">//                System.out.print(" -- ");</span>
<span class="token comment">//            }</span>
<span class="token comment">//            System.out.println();</span>
<span class="token comment">//        }</span>

        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Row</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> hssfSheet<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
           <span class="token class-name">HSSFRow</span> row <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HSSFRow</span><span class="token punctuation">)</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Cell</span><span class="token punctuation">&gt;</span></span> cellIterator <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">cellIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>cellIterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">HSSFCell</span> cell <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HSSFCell</span><span class="token punctuation">)</span> cellIterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">switch</span> <span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getCellType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">case</span> <span class="token constant">STRING</span><span class="token operator">:</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getStringCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token constant">NUMERIC</span><span class="token operator">:</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getNumericCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token constant">BOOLEAN</span><span class="token operator">:</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getBooleanCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">" -- "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> </li><li>2.读取带有公式计算的数据<pre><code class="prism language-java"> <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">read2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">FileInputStream</span> fileInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">".\\datafiles\\readformula.xls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">HSSFWorkbook</span> hssfWorkbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HSSFWorkbook</span><span class="token punctuation">(</span>fileInputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">HSSFSheet</span> sheet <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">getSheetAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> rows <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getLastRowNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">short</span> cols <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLastCellNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> r<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">HSSFRow</span> row <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> c <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> c<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">HSSFCell</span> cell <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">switch</span> <span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getCellType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">case</span> <span class="token constant">STRING</span><span class="token operator">:</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getStringCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token constant">NUMERIC</span><span class="token operator">:</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getNumericCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token constant">BOOLEAN</span><span class="token operator">:</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getBooleanCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token constant">FORMULA</span><span class="token operator">:</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getNumericCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">" -- "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> </li><li>3.读取带有密码的Excel<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">read2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
     <span class="token class-name">FileInputStream</span> fileInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">".\\datafiles\\employee.xls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">String</span> password <span class="token operator">=</span> <span class="token string">"123456"</span><span class="token punctuation">;</span>

     <span class="token class-name">HSSFWorkbook</span> hssfWorkbook <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HSSFWorkbook</span><span class="token punctuation">)</span> <span class="token class-name">HSSFWorkbookFactory</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>fileInputStream<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">HSSFSheet</span> sheet <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">getSheetAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token keyword">int</span> rows <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getLastRowNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">short</span> cols <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLastCellNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> r<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         <span class="token class-name">HSSFRow</span> row <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> c <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> c<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
             <span class="token class-name">HSSFCell</span> cell <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>

             <span class="token keyword">switch</span> <span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getCellType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                 <span class="token keyword">case</span> <span class="token constant">STRING</span><span class="token operator">:</span>
                     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getStringCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                     <span class="token keyword">break</span><span class="token punctuation">;</span>
                 <span class="token keyword">case</span> <span class="token constant">NUMERIC</span><span class="token operator">:</span>
                     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getNumericCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                     <span class="token keyword">break</span><span class="token punctuation">;</span>
                 <span class="token keyword">case</span> <span class="token constant">BOOLEAN</span><span class="token operator">:</span>
                     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getBooleanCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                     <span class="token keyword">break</span><span class="token punctuation">;</span>
                 <span class="token keyword">case</span> <span class="token constant">FORMULA</span><span class="token operator">:</span>
                     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">getNumericCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                     <span class="token keyword">break</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
             <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">" -- "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
</code></pre> </li><li>4.将Excel数据读取到Map中<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">read3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
     <span class="token class-name">FileInputStream</span> fileInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">".\\datafiles\\student.xls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">HSSFWorkbook</span> hssfWorkbook <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HSSFWorkbook</span><span class="token punctuation">)</span> <span class="token class-name">HSSFWorkbookFactory</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>fileInputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">HSSFSheet</span> sheet <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">getSheetAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token keyword">int</span> rows <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getLastRowNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> r<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         <span class="token class-name">String</span> key <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStringCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">String</span> value <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStringCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         data<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">:</span> data<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre> </li></ul> 
</blockquote> 
<blockquote> 
 <h6><a id="3Excel_349"></a>3.向Excel写入数据</h6> 
 <ul><li>1.写入数据接口案例<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">TestExcelWrite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
     <span class="token comment">//1.设置文件名</span>
     <span class="token class-name">String</span> fileName <span class="token operator">=</span> <span class="token string">"TestExcelWrite"</span><span class="token punctuation">;</span>

   <span class="token comment">//2.设置导出目录</span>
     <span class="token class-name">String</span> filePath <span class="token operator">=</span> <span class="token string">"E:\\Apache POI\\"</span><span class="token operator">+</span> fileName <span class="token operator">+</span><span class="token string">".xls"</span><span class="token punctuation">;</span>

     <span class="token comment">//3.创建Excel表单</span>
     <span class="token class-name">HSSFWorkbook</span> hssfWorkbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HSSFWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">//4.设置单元格样式</span>
     <span class="token class-name">HSSFCellStyle</span> cellBGStyle <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//背景样式</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span><span class="token constant">CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置居中对齐</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setVerticalAlignment</span><span class="token punctuation">(</span><span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span><span class="token constant">BOTTOM</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置底部对齐</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setBorderTop</span><span class="token punctuation">(</span><span class="token class-name">BorderStyle</span><span class="token punctuation">.</span><span class="token constant">HAIR</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格顶部边框的边框类型</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setBorderBottom</span><span class="token punctuation">(</span><span class="token class-name">BorderStyle</span><span class="token punctuation">.</span><span class="token constant">DOTTED</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格底部边框的边框类型 BorderStyle.DOTTED 点类型</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setBorderLeft</span><span class="token punctuation">(</span><span class="token class-name">BorderStyle</span><span class="token punctuation">.</span><span class="token constant">DOUBLE</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格左部边框的边框类型</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setBorderRight</span><span class="token punctuation">(</span><span class="token class-name">BorderStyle</span><span class="token punctuation">.</span><span class="token constant">DASH_DOT</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格右部边框的边框类型</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setTopBorderColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格顶部边框的边框颜色</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setBottomBorderColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span><span class="token constant">BLUE</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格底部边框的边框颜色</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setLeftBorderColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span><span class="token constant">PINK</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格左部边框的边框颜色</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setRightBorderColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span><span class="token constant">CORAL</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置用于单元格右部边框的边框颜色</span>

     <span class="token class-name">HSSFDataFormat</span> hssfDataFormat <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createDataFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建表单数据格式 //       </span>
   hssfDataFormat<span class="token punctuation">.</span><span class="token function">getFormat</span><span class="token punctuation">(</span><span class="token string">"@"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置数据格式为文本 @是text的别名 //        </span>
   <span class="token keyword">short</span> format <span class="token operator">=</span> hssfDataFormat<span class="token punctuation">.</span><span class="token function">getFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy年m月d日"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置数据格式为日期      </span>
   <span class="token keyword">short</span> format <span class="token operator">=</span> <span class="token class-name">HSSFDataFormat</span><span class="token punctuation">.</span><span class="token function">getBuiltinFormat</span><span class="token punctuation">(</span><span class="token string">"0.00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置数据保留两位小数，其余设置可参考BuiltinFormats </span>
<span class="token comment">//      short format = hssfDataFormat.getFormat("¥#,##0"); //设置货币模式 其余设置可参考BuiltinFormats </span>
<span class="token comment">// 		short format = HSSFDataFormat.getBuiltinFormat("0.00%"); //设置百分比格式 </span>
<span class="token comment">// 		short format = hssfDataFormat.getFormat("[DbNum2][$-804]0"); //设置数字-中文大写格式</span>
     <span class="token keyword">short</span> format <span class="token operator">=</span> <span class="token class-name">HSSFDataFormat</span><span class="token punctuation">.</span><span class="token function">getBuiltinFormat</span><span class="token punctuation">(</span><span class="token string">"0.00E+00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置计数法</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setDataFormat</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置数据格式</span>

<span class="token comment">//      cellBGStyle.setHidden(false); //是否隐藏单元格，测试没出效果</span>
     <span class="token keyword">short</span> indention <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setIndention</span><span class="token punctuation">(</span>indention<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//缩进单元格文本空格数 </span>
<span class="token comment">//      cellBGStyle.setLocked(true); //锁定该单元格，测试没出效果</span>
     <span class="token keyword">short</span> rotation <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span> 
<span class="token comment">//      cellBGStyle.setRotation(rotation); //设置内容旋转度数 HSSF为-90~90，XHSSF为0~180 </span>
<span class="token comment">//      cellBGStyle.setShrinkToFit(false); //设置单元格是否自动调整大小，以便内容过长时缩小以适应，测试没出效果</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setQuotePrefixed</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//是否打开样式前缀</span>
     <span class="token keyword">short</span> order <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setReadingOrder</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置文本的读取顺序，0为默认，1为从左到右，2为从右到左，测试没出效果</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setUserStyleName</span><span class="token punctuation">(</span><span class="token string">"测试"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置样式名称，测试没出效果</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setWrapText</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置文本是否换行</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setFillForegroundColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置前景色</span>
     cellBGStyle<span class="token punctuation">.</span><span class="token function">setFillPattern</span><span class="token punctuation">(</span><span class="token class-name">FillPatternType</span><span class="token punctuation">.</span><span class="token constant">FINE_DOTS</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置颜色填充样式</span>

     <span class="token class-name">HSSFCellStyle</span> cellFontStyle <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//字体样式</span>
     <span class="token class-name">HSSFFont</span> hssfFont <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     hssfFont<span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span><span class="token constant">BLUE</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//字体颜色</span>
     hssfFont<span class="token punctuation">.</span><span class="token function">setBold</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//是否粗体 </span>
<span class="token comment">//      hssfFont.setCharSet(); 设置字符集 </span>
<span class="token comment">//      hssfFont.setFontHeight(); //设置字体高度 </span>
<span class="token comment">//      hssfFont.setFontHeightInPoints(); 设置字体高度，标准值10, 12,14 etc..</span>
     hssfFont<span class="token punctuation">.</span><span class="token function">setFontName</span><span class="token punctuation">(</span><span class="token string">"楷体"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//根据名称设置字体类型</span>
     hssfFont<span class="token punctuation">.</span><span class="token function">setItalic</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//是否斜体 </span>
<span class="token comment">//      hssfFont.setStrikeout(true); //设置是否在文本中使用消线水平线(会覆盖掉下划线) </span>
<span class="token comment">//      hssfFont.setTypeOffset(Font.SS_SUPER); 设置字体类型，是上标或下标</span>
     hssfFont<span class="token punctuation">.</span><span class="token function">setUnderline</span><span class="token punctuation">(</span><span class="token class-name">Font</span><span class="token punctuation">.</span><span class="token constant">U_SINGLE_ACCOUNTING</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//下划线 U_SINGLE_ACCOUNTING单下划线</span>
     cellFontStyle<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span>hssfFont<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">//5.创建Sheet工作表</span>
     <span class="token class-name">HSSFSheet</span> hssfSheet <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//创建工作表，默认从sheet0开始</span>
     <span class="token class-name">HSSFSheet</span> test <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createSheet</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建工作表，并指定表名</span>
     <span class="token class-name">HSSFHeader</span> header <span class="token operator">=</span> hssfSheet<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     header<span class="token punctuation">.</span><span class="token function">setCenter</span><span class="token punctuation">(</span><span class="token string">"人员权限信息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//测试没出效果</span>

   <span class="token comment">//合并单元格,CellRangeAddress创建新的单元格范围。索引从零开始（开始行，结束行，开始列，结束列）</span>
    hssfSheet<span class="token punctuation">.</span><span class="token function">addMergedRegion</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CellRangeAddress</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hssfSheet<span class="token punctuation">.</span><span class="token function">addMergedRegion</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CellRangeAddress</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">//6.设置默认选中工作表</span>
     hssfWorkbook<span class="token punctuation">.</span><span class="token function">setActiveSheet</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">//7.记录列数</span>
     <span class="token keyword">int</span> colNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">9</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         <span class="token comment">//8.创建行</span>
         <span class="token class-name">HSSFRow</span> hssfRow <span class="token operator">=</span> hssfSheet<span class="token punctuation">.</span><span class="token function">createRow</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">short</span> height <span class="token operator">=</span> <span class="token number">2000</span><span class="token punctuation">;</span>
         hssfRow<span class="token punctuation">.</span><span class="token function">setHeight</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置行高，默认值为-1 </span>
<span class="token comment">//          hssfRow.setHeightInPoints(height); //以点为单位设置行高，等同于*20，默认值为-1 //       </span>
<span class="token comment">//   		hssfRow.setRowNum(int rowIndex); //设置行好，range 0-65535          </span>
<span class="token comment">// 			hssfRow.setZeroHeight(false); //设置是否显示高度为0的行 //           </span>
<span class="token comment">// 			hssfRow.setRowStyle(cellStyle);  设置行的样式，会被单元格覆盖掉</span>
         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;=</span>i<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
             <span class="token comment">//9.创建单元格</span>
             <span class="token class-name">HSSFCell</span> hssfCell <span class="token operator">=</span> hssfRow<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                 hssfCell<span class="token punctuation">.</span><span class="token function">setCellStyle</span><span class="token punctuation">(</span>cellBGStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
                 hssfCell<span class="token punctuation">.</span><span class="token function">setAsActiveCell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置默认选中单元格</span>

             <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                 hssfCell<span class="token punctuation">.</span><span class="token function">setCellStyle</span><span class="token punctuation">(</span>cellFontStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>                     
<span class="token comment">//                  hssfCell.setBlank(); //设置为空白单元格 </span>
<span class="token comment">//                  hssfCell.setCellFormula(String formula); //设置单元格公式 </span>
<span class="token comment">//                  hssfCell.setCellType(); //设置单元格类型，参数位CellType枚举类</span>
             <span class="token punctuation">}</span>
             hssfCell<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             colNum <span class="token operator">=</span> j<span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>

     <span class="token comment">//10.设置工作表指定列的长度随内容自动调整</span>
     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> col<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> col<span class="token operator">&lt;=</span>colNum<span class="token punctuation">;</span> col<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
         hssfSheet<span class="token punctuation">.</span><span class="token function">autoSizeColumn</span><span class="token punctuation">(</span>col<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token comment">//11.导出文件</span>
     <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
         hssfWorkbook<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"路径错误{} {}"</span><span class="token punctuation">,</span>filePath<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token comment">//12.关闭</span>
     <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
         hssfWorkbook<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Excel表单关闭错误{}"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span> 
</code></pre> </li><li>2.写入数据标准模板<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">write3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">HSSFWorkbook</span> hssfWorkbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HSSFWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HSSFSheet</span> hssfSheet <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createSheet</span><span class="token punctuation">(</span><span class="token string">"Emp Info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">HSSFCellStyle</span> cellStyle <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cellStyle<span class="token punctuation">.</span><span class="token function">setAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span><span class="token constant">CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Object</span> empData<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
                                <span class="token punctuation">{<!-- --></span><span class="token string">"EmpID"</span><span class="token punctuation">,</span><span class="token string">"Name"</span><span class="token punctuation">,</span><span class="token string">"Job"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                                <span class="token punctuation">{<!-- --></span><span class="token number">101</span><span class="token punctuation">,</span><span class="token string">"David"</span><span class="token punctuation">,</span><span class="token string">"Java"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                                <span class="token punctuation">{<!-- --></span><span class="token number">102</span><span class="token punctuation">,</span><span class="token string">"Smith"</span><span class="token punctuation">,</span><span class="token string">"Manager"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                                <span class="token punctuation">{<!-- --></span><span class="token number">103</span><span class="token punctuation">,</span><span class="token string">"Son"</span><span class="token punctuation">,</span><span class="token string">"Analyst"</span><span class="token punctuation">}</span>
                             <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//        ArrayList&lt;Object&gt; empData = new ArrayList&lt;&gt;();</span>
<span class="token comment">//        empData.add(new Object[]{"EmpID","Name","Job"});</span>
<span class="token comment">//        empData.add(new Object[]{101,"David","Java"});</span>
<span class="token comment">//        empData.add(new Object[]{102,"Smith","Manager"});</span>
<span class="token comment">//        empData.add(new Object[]{103,"Son","Analyst"});</span>

<span class="token comment">//        int rows = empData.length;</span>
<span class="token comment">//        int clos = empData[0].length;</span>
<span class="token comment">//</span>
<span class="token comment">//        for (int r = 0; r &lt; rows; r++) {<!-- --></span>
<span class="token comment">//            HSSFRow row = hssfSheet.createRow(r);</span>
<span class="token comment">//</span>
<span class="token comment">//            for (int c = 0; c &lt; clos; c++) {<!-- --></span>
<span class="token comment">//                HSSFCell cell = row.createCell(c);</span>
<span class="token comment">//                cell.setCellStyle(cellStyle);</span>
<span class="token comment">//                Object value = empData[r][c];</span>
<span class="token comment">//</span>
<span class="token comment">//                if(value instanceof String)</span>
<span class="token comment">//                    cell.setCellValue((String)value);</span>
<span class="token comment">//                if(value instanceof Integer)</span>
<span class="token comment">//                    cell.setCellValue((Integer)value);</span>
<span class="token comment">//                if(value instanceof Boolean)</span>
<span class="token comment">//                    cell.setCellValue((Boolean)value);</span>
<span class="token comment">//            }</span>
<span class="token comment">//        }</span>

        <span class="token keyword">int</span> rowCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> emp<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">:</span>empData<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">HSSFRow</span> row <span class="token operator">=</span> hssfSheet<span class="token punctuation">.</span><span class="token function">createRow</span><span class="token punctuation">(</span>rowCount<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> colCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> value <span class="token operator">:</span> emp<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">HSSFCell</span> cell <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span>colCount<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">)</span>
                    cell<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">Integer</span><span class="token punctuation">)</span>
                    cell<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">Boolean</span><span class="token punctuation">)</span>
                    cell<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">)</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">String</span> filePath <span class="token operator">=</span> <span class="token string">".\\datafiles\\employee.xls"</span><span class="token punctuation">;</span>
        <span class="token class-name">FileOutputStream</span> fileOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        hssfWorkbook<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fileOutputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Employee.xls file written successfully"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> </li><li>3.向桌面写入数据<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">write1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
     <span class="token comment">// 获取桌面路径</span>
     <span class="token class-name">FileSystemView</span> fsv <span class="token operator">=</span> <span class="token class-name">FileSystemView</span><span class="token punctuation">.</span><span class="token function">getFileSystemView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">String</span> desktop <span class="token operator">=</span> fsv<span class="token punctuation">.</span><span class="token function">getHomeDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">String</span> filePath <span class="token operator">=</span> desktop <span class="token operator">+</span> <span class="token string">"/template.xls"</span><span class="token punctuation">;</span>

     <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">OutputStream</span> outputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">HSSFWorkbook</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HSSFWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">HSSFSheet</span> sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">createSheet</span><span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">HSSFRow</span> row <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">createRow</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string">"订单号"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string">"下单时间"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string">"个数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string">"单价"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string">"订单金额"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     row<span class="token punctuation">.</span><span class="token function">setHeightInPoints</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置行的高度</span>

     <span class="token class-name">HSSFRow</span> row1 <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">createRow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     row1<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     row1<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string">"NO00001"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">// 日期格式化</span>
     <span class="token class-name">HSSFCellStyle</span> cellStyle2 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">createCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">HSSFCreationHelper</span> creationHelper <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">getCreationHelper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     cellStyle2<span class="token punctuation">.</span><span class="token function">setDataFormat</span><span class="token punctuation">(</span>creationHelper<span class="token punctuation">.</span><span class="token function">createDataFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     sheet<span class="token punctuation">.</span><span class="token function">setColumnWidth</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">20</span> <span class="token operator">*</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置列的宽度</span>

     <span class="token class-name">HSSFCell</span> cell2 <span class="token operator">=</span> row1<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     cell2<span class="token punctuation">.</span><span class="token function">setCellStyle</span><span class="token punctuation">(</span>cellStyle2<span class="token punctuation">)</span><span class="token punctuation">;</span>
     cell2<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     row1<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">// 保留两位小数</span>
     <span class="token class-name">HSSFCellStyle</span> cellStyle3 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">createCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     cellStyle3<span class="token punctuation">.</span><span class="token function">setDataFormat</span><span class="token punctuation">(</span><span class="token class-name">HSSFDataFormat</span><span class="token punctuation">.</span><span class="token function">getBuiltinFormat</span><span class="token punctuation">(</span><span class="token string">"0.00"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">HSSFCell</span> cell4 <span class="token operator">=</span> row1<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     cell4<span class="token punctuation">.</span><span class="token function">setCellStyle</span><span class="token punctuation">(</span>cellStyle3<span class="token punctuation">)</span><span class="token punctuation">;</span>
     cell4<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token number">29.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">// 货币格式化</span>
     <span class="token class-name">HSSFCellStyle</span> cellStyle4 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">createCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">HSSFFont</span> font <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">createFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     font<span class="token punctuation">.</span><span class="token function">setFontName</span><span class="token punctuation">(</span><span class="token string">"华文行楷"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     font<span class="token punctuation">.</span><span class="token function">setFontHeightInPoints</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">short</span><span class="token punctuation">)</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     font<span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     cellStyle4<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span>font<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">HSSFCell</span> cell5 <span class="token operator">=</span> row1<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     cell5<span class="token punctuation">.</span><span class="token function">setCellFormula</span><span class="token punctuation">(</span><span class="token string">"D2*E2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 设置计算公式</span>

     <span class="token comment">// 获取计算公式的值</span>
     <span class="token class-name">HSSFFormulaEvaluator</span> e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HSSFFormulaEvaluator</span><span class="token punctuation">(</span>workbook<span class="token punctuation">)</span><span class="token punctuation">;</span>
     cell5 <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">evaluateInCell</span><span class="token punctuation">(</span>cell5<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cell5<span class="token punctuation">.</span><span class="token function">getNumericCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


     workbook<span class="token punctuation">.</span><span class="token function">setActiveSheet</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     workbook<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>outputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
     outputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre> </li><li>4.写入带有公式的表格<pre><code class="prism language-java"> <span class="token annotation punctuation">@Test</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">write3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
      <span class="token class-name">HSSFWorkbook</span> hssfWorkbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HSSFWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">HSSFSheet</span> sheet <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createSheet</span><span class="token punctuation">(</span><span class="token string">"Numbers"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token class-name">HSSFRow</span> row <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">createRow</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellFormula</span><span class="token punctuation">(</span><span class="token string">"A1*B1*C1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//     row.createCell(3).setCellFormula("SUM(C2:C6)"); 计算从C2一直到C6的和</span>

      <span class="token class-name">FileOutputStream</span> fileOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">".\\datafiles\\calc.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      hssfWorkbook<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fileOutputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

      fileOutputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      hssfWorkbook<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"calc.xlsx created with formula cell..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> 
</code></pre> </li><li>5.将Map中的数据写入表格<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">write4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
     <span class="token class-name">HSSFWorkbook</span> hssfWorkbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HSSFWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">HSSFSheet</span> sheet <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createSheet</span><span class="token punctuation">(</span><span class="token string">"Student data"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     data<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"101"</span><span class="token punctuation">,</span><span class="token string">"李四"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     data<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"102"</span><span class="token punctuation">,</span><span class="token string">"张三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     data<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"103"</span><span class="token punctuation">,</span><span class="token string">"赵六"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     data<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"104"</span><span class="token punctuation">,</span><span class="token string">"王五"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token keyword">int</span> rowCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">:</span> data<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         <span class="token class-name">HSSFRow</span> row <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">createRow</span><span class="token punctuation">(</span>rowCount<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token class-name">FileOutputStream</span> fileOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">".\\datafiles\\student.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     hssfWorkbook<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fileOutputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

     hssfWorkbook<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     fileOutputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"student.xlsx created..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre> </li><li>6.将数据库中的数据写入表单中<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">write5</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
     <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://localhost:3306/mybatis_plus"</span><span class="token punctuation">,</span><span class="token string">"root"</span><span class="token punctuation">,</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">Statement</span> statement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">ResultSet</span> resultSet <span class="token operator">=</span> statement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token string">"select * from t_user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">HSSFWorkbook</span> hssfWorkbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HSSFWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">HSSFSheet</span> sheet <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createSheet</span><span class="token punctuation">(</span><span class="token string">"User Data"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">HSSFCellStyle</span> cellStyle <span class="token operator">=</span> hssfWorkbook<span class="token punctuation">.</span><span class="token function">createCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     cellStyle<span class="token punctuation">.</span><span class="token function">setAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span><span class="token constant">CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token string">"id"</span><span class="token punctuation">,</span><span class="token string">"name"</span><span class="token punctuation">,</span><span class="token string">"age"</span><span class="token punctuation">,</span><span class="token string">"email"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
     
     <span class="token class-name">HSSFRow</span> row1 <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">createRow</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> c <span class="token operator">&lt;</span> str<span class="token punctuation">.</span>length<span class="token punctuation">;</span> c<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         <span class="token class-name">HSSFCell</span> cell <span class="token operator">=</span> row1<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
         cell<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         cell<span class="token punctuation">.</span><span class="token function">setCellStyle</span><span class="token punctuation">(</span>cellStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     <span class="token keyword">int</span> rowCount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
     <span class="token keyword">while</span> <span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         <span class="token keyword">int</span> id <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">String</span> name <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">int</span> age <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">String</span> email <span class="token operator">=</span> resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"email"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token class-name">HSSFRow</span> row <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">createRow</span><span class="token punctuation">(</span>rowCount<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">HSSFCell</span> cell <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">HSSFCell</span> cell1 <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">HSSFCell</span> cell2 <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">HSSFCell</span> cell3 <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         cell<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
         cell<span class="token punctuation">.</span><span class="token function">setCellStyle</span><span class="token punctuation">(</span>cellStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
         cell1<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
         cell1<span class="token punctuation">.</span><span class="token function">setCellStyle</span><span class="token punctuation">(</span>cellStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
         cell2<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
         cell2<span class="token punctuation">.</span><span class="token function">setCellStyle</span><span class="token punctuation">(</span>cellStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
         cell3<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>
         cell3<span class="token punctuation">.</span><span class="token function">setCellStyle</span><span class="token punctuation">(</span>cellStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>

     sheet<span class="token punctuation">.</span><span class="token function">autoSizeColumn</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//注意，设置自适应长度需要在设置值之后才会生效</span>

     <span class="token class-name">FileOutputStream</span> fileOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">".\\datafiles\\User.xls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     hssfWorkbook<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fileOutputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

     hssfWorkbook<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     fileOutputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre> </li></ul> 
</blockquote> 
<blockquote> 
 <h5><a id="2Word_729"></a>2.操作Word</h5> 
 <pre><code class="prism language-java"><span class="token number">1.</span>Word文档中范围，小节，段落，文本的关系<span class="token punctuation">(</span><span class="token class-name">HWPFDocument</span><span class="token punctuation">)</span>
<span class="token comment">//Range：它表示一个范围，这个范围可以是整个文档，也可以是里面的某一小节（Section），也可以是某一个段落（Paragraph），还可以是拥有共同属性的一段文本（CharacterRun）(以下属性都继承自Range)</span>
<span class="token comment">//Section：Word文档的一个小节，一个Word文档可以有多个小节构成(分页符是指将一页内容分成两页，但分离后的两页仍属于同一节；分节符则是将一节内容分成两节，分离后的两节可以在同一页，也可以不在同一页)</span>
<span class="token comment">//Paragraph：Word文档的一个段落，一个小节可以由多个段落构成</span>
<span class="token comment">//CharacterRun：具有相同属性的一段文本，一个段落可以由多个CharacterRun组成(同个段落可能有多种属性，例：加粗，斜体等)</span>
<span class="token comment">//Table：Word文档的一个表格</span>
<span class="token comment">//TableRow：表格对应的行</span>
<span class="token comment">//TableCell：表格对应的单元格</span>

<span class="token number">2.</span>常用类和方法
<span class="token comment">//HWPF支持 Word (97-2003)，支持读写Word文档，但是写功能目前只实现一部分</span>
<span class="token comment">//XWPF支持 Word 2007+ 的 Java组件，提供简单文件的读写功能</span>
<span class="token comment">//1.HWPFDocument: word文档(XWPFDocument不向下兼容)</span>
<span class="token class-name">HWPFDocument</span> doc <span class="token operator">=</span> <span class="token function">newHWPFDocument</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> istream<span class="token punctuation">)</span> <span class="token comment">//该方法必须需要参数，即必须先创建一个文件，XWPFDocument可以直接创建不需要参数</span>

<span class="token comment">//2.Range: 范围</span>
<span class="token class-name">Range</span> range <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回整个文档，但不包括任何页眉和页脚的范围，实际调用私有方法的getRange(SubdocumentType.MAIN)</span>
<span class="token class-name">Range</span> overallRange <span class="token operator">=</span> hwpfDocument<span class="token punctuation">.</span><span class="token function">getOverallRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取整体范围，实际调用构造方法new Range(0, _text.length(), this)</span>
<span class="token class-name">Range</span> headerStoryRange <span class="token operator">=</span> hwpfDocument<span class="token punctuation">.</span><span class="token function">getHeaderStoryRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回覆盖所有“Header Stories”的范围。Header Stories包含页眉、页脚、结束注释分隔符和脚注分隔符</span>
<span class="token class-name">Range</span> footnoteRange <span class="token operator">=</span> hwpfDocument<span class="token punctuation">.</span><span class="token function">getFootnoteRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回包含所有脚注的范围</span>
<span class="token class-name">Range</span> mainTextboxRange <span class="token operator">=</span> hwpfDocument<span class="token punctuation">.</span><span class="token function">getMainTextboxRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回包含所有文本框的范围</span>
<span class="token class-name">Range</span> commentsRange <span class="token operator">=</span> hwpfDocument<span class="token punctuation">.</span><span class="token function">getCommentsRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回包含所有注释的范围</span>
<span class="token class-name">Range</span> endnoteRange <span class="token operator">=</span> hwpfDocument<span class="token punctuation">.</span><span class="token function">getEndnoteRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回包含所有尾注的范围</span>
<span class="token class-name">String</span> text <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取对应范围的内容</span>


<span class="token comment">//3.Section：小节</span>
<span class="token class-name">Section</span> section <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getSection</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取对应范围的小节,对应Word文档中的分节符</span>
<span class="token keyword">int</span> sectionsNum <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">numSections</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取对应范围内一个有多少个小节</span>
<span class="token class-name">String</span> text <span class="token operator">=</span> <span class="token class-name">Section</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取对应小节的内容</span>

<span class="token comment">// 4.Paragraph: 段落</span>
<span class="token class-name">Paragraph</span> paragraph <span class="token operator">=</span> section<span class="token punctuation">.</span><span class="token function">getParagraph</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取对应小节的段落</span>
<span class="token keyword">int</span> paragraphsNum <span class="token operator">=</span> section<span class="token punctuation">.</span><span class="token function">numParagraphs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取对应小节内有多少个段落</span>
<span class="token class-name">String</span> text <span class="token operator">=</span> paragraph<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取对应段落的内容</span>

<span class="token comment">//5.CharacterRun: 具有相同属性的文本(粗体，斜体...)</span>
<span class="token class-name">CharacterRun</span> characterRun <span class="token operator">=</span> paragraph<span class="token punctuation">.</span><span class="token function">getCharacterRun</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取对应段落的相同属性的文本</span>
<span class="token keyword">int</span> characterRuns <span class="token operator">=</span> paragraph<span class="token punctuation">.</span><span class="token function">numCharacterRuns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取对应的段落有多少相同属性的文本</span>
<span class="token class-name">String</span> text <span class="token operator">=</span> characterRun<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取具有相同属性的的内容</span>
characterRun<span class="token punctuation">.</span><span class="token function">setBold</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将对应的文本设置为粗体</span>
characterRun<span class="token punctuation">.</span><span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//设置对应的文本字体大小</span>
characterRun<span class="token punctuation">.</span><span class="token function">setItalic</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将对应的文本设置为斜体</span>
</code></pre> 
 <pre><code class="prism language-java"><span class="token number">1.</span>Word文档中的段落，文本，表格关系<span class="token punctuation">(</span><span class="token class-name">XWPFDocument</span><span class="token punctuation">)</span>
<span class="token comment">//XWPFDocument: 表示一个Wrod文档</span>
<span class="token comment">//XWPFParagraph: 表示一个段落，一个文档包含多个段落</span>
<span class="token comment">//XWPFRun：表示一个文本/区域(具有相同属性的一段文本)，一个段落包含多个区域</span>
<span class="token comment">//XWPFFooter：表示页脚</span>
<span class="token comment">//XWPFFootnote: 表示脚注</span>
<span class="token comment">//XWPFHeader: 表示页眉</span>
<span class="token comment">//XWPFPictureData: 表示图片</span>
<span class="token comment">//XWPFStyles: 表示样式</span>
<span class="token comment">//XWPFTable：Word文档的一个表格，一个文档包含多个表格，一个表格包含多行</span>
<span class="token comment">//XWPFTableRow：表格对应的行，一行包含多格</span>
<span class="token comment">//XWPFTableCell：表格对应的单元格，每一格的内容相当于一个完整的文档</span>

<span class="token number">2.</span>常用类和方法
<span class="token comment">//HWPF支持 Word (97-2003)，支持读写Word文档，但是写功能目前只实现一部分</span>
<span class="token comment">//XWPF支持 Word 2007+ 的 Java组件，提供简单文件的读写功能</span>
<span class="token comment">//1.XWPFDocument : word文档</span>
<span class="token class-name">XWPFDocument</span> doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XWPFDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建word文档，可以直接直接创建，不传入参数</span>
<span class="token class-name">XWPFChart</span> chart <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createChart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建图表</span>
<span class="token class-name">XWPFEndnote</span> endnote <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createEndnote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建一个新的结束注释并将其添加到文档中</span>
<span class="token class-name">XWPFFooter</span> footer <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createFooter</span><span class="token punctuation">(</span><span class="token class-name">HeaderFooterType</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建给定类型的页脚，参数为HeaderFooterType</span>
<span class="token class-name">XWPFFootnote</span> footnote <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createFootnote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个新的脚注并将其添加到文档中</span>
<span class="token class-name">XWPFHeader</span> header <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createHeader</span><span class="token punctuation">(</span><span class="token class-name">HeaderFooterType</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建给定类型的标头</span>
<span class="token class-name">XWPFHeaderFooterPolicy</span> headerFooterPolicy <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createHeaderFooterPolicy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建页眉和页脚的策略，这也提供了获取它们的方法</span>
<span class="token class-name">XWPFNumbering</span> numbering <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createNumbering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建编号，如果编号不存在，则创建空编号，并设置编号成员</span>
<span class="token class-name">XWPFParagraph</span> paragraph <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createParagraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建新段落</span>
<span class="token class-name">XWPFStyles</span> styles <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createStyles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//如果文档不存在样式，则为文档创建空样式</span>

<span class="token comment">//2.XWPFParagraph：段落</span>
<span class="token class-name">XWPFParagraph</span> paragraph <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createParagraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建段落</span>

<span class="token comment">//3.XWPFRun: 文本/区域</span>
<span class="token class-name">XWPFRun</span> run <span class="token operator">=</span> paragraph<span class="token punctuation">.</span><span class="token function">createRun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建区域</span>

<span class="token comment">//4.XWPFTable: 表格</span>
<span class="token class-name">XWPFTable</span> table <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建表格</span>
</code></pre> 
</blockquote> 
<blockquote> 
 <h6><a id="1Word_814"></a>1.从Word读取数据</h6> 
 <ul><li>1.从Word文档中读取指定节点指定段落的内容<pre><code class="prism language-java"> <span class="token annotation punctuation">@Test</span>
 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">wordWrite3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
     <span class="token comment">//1.获取桌面文件路径</span>
     <span class="token class-name">FileSystemView</span> fsv <span class="token operator">=</span> <span class="token class-name">FileSystemView</span><span class="token punctuation">.</span><span class="token function">getFileSystemView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">String</span> desktop <span class="token operator">=</span> fsv<span class="token punctuation">.</span><span class="token function">getHomeDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">String</span> filePath <span class="token operator">=</span> desktop <span class="token operator">+</span> <span class="token string">"/readContext.doc"</span><span class="token punctuation">;</span>

     <span class="token comment">//2.将文件转换为输入流</span>
     <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">//3.通过输入流将Word文件转换为HWPFDocument</span>
     <span class="token class-name">HWPFDocument</span> doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HWPFDocument</span><span class="token punctuation">(</span>fis<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">//4.获取区域</span>
     <span class="token class-name">Range</span> range <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回整个文档，但不包括任何页眉和页脚的范围，实际调用私有方法的getRange(SubdocumentType.MAIN)</span>

     <span class="token keyword">int</span> sectionsNum <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">numSections</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"sectionsNum:"</span> <span class="token operator">+</span> sectionsNum<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sectionsNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         <span class="token comment">//5.获取对应范围的小节</span>
         <span class="token class-name">Section</span> section <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getSection</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token keyword">int</span> paragraphsNum <span class="token operator">=</span> section<span class="token punctuation">.</span><span class="token function">numParagraphs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"paragraphsNum:"</span> <span class="token operator">+</span> paragraphsNum<span class="token punctuation">)</span><span class="token punctuation">;</span>

         <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> paragraphsNum<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
             <span class="token comment">//6.获取对应小节的段落</span>
             <span class="token class-name">Paragraph</span> paragraph <span class="token operator">=</span> section<span class="token punctuation">.</span><span class="token function">getParagraph</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token comment">//7.获取段落内容</span>
             <span class="token class-name">String</span> text <span class="token operator">=</span> paragraph<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"小节:"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",段落:"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",内容:"</span> <span class="token operator">+</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>   
     
     <span class="token class-name">FileOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">".\\datafiles\\test.doc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     out<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     doc<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>

     fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     doc<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre> </li><li>2.从Word文档中读取图片并写入到指定位置<pre><code class="prism language-java"><span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PoiUtil</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">/**
     * 根据文件获取文件前缀(文件名)
     * @param file 文件
     * @return String 文件名
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getFilePrefix</span><span class="token punctuation">(</span><span class="token class-name">File</span> file<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//1.获取完整文件名</span>
        <span class="token class-name">String</span> wholeFileName <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.获取最后一个点的下标</span>
        <span class="token keyword">int</span> lastPointIndex <span class="token operator">=</span> wholeFileName<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3.截取字符串</span>
        <span class="token keyword">return</span> wholeFileName<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> lastPointIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 根据文件获取文件后缀/文件类型
     * @param file 文件
     * @return String 文件后缀
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getFileSuffix</span><span class="token punctuation">(</span><span class="token class-name">File</span> file<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//1.获取文件名</span>
        <span class="token class-name">String</span> fileName <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">getFileType</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 根据文件名获取文件类型
     * @param fileName 文件名
     * @return String 文件类型
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getFileType</span><span class="token punctuation">(</span><span class="token class-name">String</span> fileName<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//1.将文件名根据\\.切割</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> strArray <span class="token operator">=</span> fileName<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"\\."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.获取最后一个数组下标</span>
        <span class="token keyword">int</span> suffixIndex <span class="token operator">=</span> strArray<span class="token punctuation">.</span>length <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> strArray<span class="token punctuation">[</span>suffixIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 从Word文档中取出图片导入到目的路径
     * @param wordFile word文件
     * @param targetPath 目的路径
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">fetchPictureFromWord</span><span class="token punctuation">(</span><span class="token class-name">File</span> wordFile<span class="token punctuation">,</span> <span class="token class-name">String</span> targetPath<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//1.获取文件的绝对路径</span>
        <span class="token class-name">String</span> absolutePath <span class="token operator">=</span> wordFile<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.根据word完整路径获取文件类型</span>
        <span class="token class-name">String</span> fileType <span class="token operator">=</span> <span class="token class-name">POIUtil</span><span class="token punctuation">.</span><span class="token function">getFileType</span><span class="token punctuation">(</span>absolutePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3.获取文件名</span>
        <span class="token class-name">String</span> fileName <span class="token operator">=</span> <span class="token function">getFilePrefix</span><span class="token punctuation">(</span>wordFile<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//4.记录提取次数</span>
        <span class="token keyword">int</span> numberId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>

        <span class="token comment">//5.根据文件类型做不同的处理</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>fileType<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">case</span> <span class="token string">"doc"</span><span class="token operator">:</span>
                <span class="token keyword">try</span><span class="token punctuation">(</span><span class="token class-name">HWPFDocument</span> hwpfDocument <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HWPFDocument</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>absolutePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token comment">//1.从文档中提取所有图片</span>
                    <span class="token class-name">PicturesTable</span> picturesTable <span class="token operator">=</span> hwpfDocument<span class="token punctuation">.</span><span class="token function">getPicturesTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Picture</span><span class="token punctuation">&gt;</span></span> pictures <span class="token operator">=</span> picturesTable<span class="token punctuation">.</span><span class="token function">getAllPictures</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Picture</span> picture <span class="token operator">:</span> pictures<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">//2.输出图片到磁盘(目标路径+"/"+numberId+".后缀名")</span>
                        <span class="token class-name">String</span> pictureFiePath <span class="token operator">=</span> targetPath <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> fileName <span class="token operator">+</span> numberId <span class="token operator">+</span><span class="token string">"."</span><span class="token operator">+</span> picture<span class="token punctuation">.</span><span class="token function">suggestFileExtension</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"doc pictureFiePath:"</span> <span class="token operator">+</span> pictureFiePath<span class="token punctuation">)</span><span class="token punctuation">;</span>

                        <span class="token keyword">try</span><span class="token punctuation">(</span><span class="token class-name">OutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>pictureFiePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                            picture<span class="token punctuation">.</span><span class="token function">writeImageContent</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        numberId<span class="token operator">++</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"错误的文件:{}"</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"出错文件路径"</span><span class="token punctuation">,</span>absolutePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">"docx"</span><span class="token operator">:</span>
                <span class="token keyword">try</span><span class="token punctuation">(</span><span class="token class-name">XWPFDocument</span> xwpfDocument<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">XWPFDocument</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>absolutePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token comment">//1.获取所有图片</span>
                    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">XWPFPictureData</span><span class="token punctuation">&gt;</span></span> xwpfPictureDataList <span class="token operator">=</span> xwpfDocument<span class="token punctuation">.</span><span class="token function">getAllPictures</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">//2.如果存在图片</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token operator">!=</span>xwpfPictureDataList <span class="token operator">&amp;&amp;</span> xwpfPictureDataList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">XWPFPictureData</span> item<span class="token operator">:</span>xwpfPictureDataList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token comment">//3.获取图片的字节流</span>
                            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token class-name">String</span> pictureFiePath <span class="token operator">=</span> targetPath <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> fileName <span class="token operator">+</span> numberId <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> item<span class="token punctuation">.</span><span class="token function">suggestFileExtension</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"docx pictureFiePath:"</span> <span class="token operator">+</span> pictureFiePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token comment">//4.写入文件</span>
                            <span class="token class-name">File</span> file<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>pictureFiePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token keyword">if</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                file<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            <span class="token keyword">try</span><span class="token punctuation">(</span><span class="token class-name">FileOutputStream</span> fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>pictureFiePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                                fos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            numberId<span class="token operator">++</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"错误的文件:{}"</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"出错文件路径"</span><span class="token punctuation">,</span>absolutePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"{}无效的文件格式:{}"</span><span class="token punctuation">,</span>wordFile<span class="token punctuation">,</span>fileType<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
     <span class="token comment">//1.获取桌面路径+文件</span>
     <span class="token class-name">FileSystemView</span> fsv <span class="token operator">=</span> <span class="token class-name">FileSystemView</span><span class="token punctuation">.</span><span class="token function">getFileSystemView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">String</span> desktop <span class="token operator">=</span> fsv<span class="token punctuation">.</span><span class="token function">getHomeDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">String</span> filePath <span class="token operator">=</span> desktop <span class="token operator">+</span> <span class="token string">"/template.doc"</span><span class="token punctuation">;</span>

     <span class="token comment">//2.新建文件</span>
     <span class="token class-name">File</span> wordFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">//3.获取图片导入目录</span>
     <span class="token class-name">String</span> targetPath <span class="token operator">=</span> wordFile<span class="token punctuation">.</span><span class="token function">getParentFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">//4.从指定文件导出Word图片到目标目录中</span>
     <span class="token class-name">POIUtil</span><span class="token punctuation">.</span><span class="token function">fetchPictureFromWord</span><span class="token punctuation">(</span>wordFile<span class="token punctuation">,</span>targetPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre> </li></ul> 
</blockquote> 
<blockquote> 
 <h6><a id="2Word_995"></a>2.向Word写入数据</h6> 
 <ul><li>(XWPF支持读写功能，HWPF对于写功能只实现一部分)</li><li>1.向Word文档写入List数据<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">writeDataToWord</span><span class="token punctuation">(</span><span class="token class-name">String</span> fileName<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> data<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span><span class="token punctuation">(</span><span class="token class-name">FileOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//创建一个文档</span>
            <span class="token class-name">XWPFDocument</span> xwpfDocument<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">XWPFDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//创建一个段落</span>
            <span class="token class-name">XWPFParagraph</span> xwpfParagraph<span class="token punctuation">;</span>
            <span class="token comment">//创建一片区域</span>
            <span class="token class-name">XWPFRun</span> run<span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> lineData<span class="token operator">:</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                xwpfParagraph<span class="token operator">=</span> xwpfDocument<span class="token punctuation">.</span><span class="token function">createParagraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                run <span class="token operator">=</span> xwpfParagraph<span class="token punctuation">.</span><span class="token function">createRun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                run<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>lineData<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            xwpfDocument<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
            xwpfDocument<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
     <span class="token class-name">FileSystemView</span> fsv <span class="token operator">=</span> <span class="token class-name">FileSystemView</span><span class="token punctuation">.</span><span class="token function">getFileSystemView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">String</span> desktop <span class="token operator">=</span> fsv<span class="token punctuation">.</span><span class="token function">getHomeDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">String</span> filePath <span class="token operator">=</span> desktop <span class="token operator">+</span> <span class="token string">"/template.doc"</span><span class="token punctuation">;</span>

     <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"你是猪"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"you are pig"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"我是帅哥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     data<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"I am coolMan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token class-name">POIUtil</span><span class="token punctuation">.</span><span class="token function">writeDataToWord</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre> </li><li>2.向Word文档中写入简单表格<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">wordWrite4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
     <span class="token comment">//1.获取桌面文件路径</span>
     <span class="token class-name">FileSystemView</span> fsv <span class="token operator">=</span> <span class="token class-name">FileSystemView</span><span class="token punctuation">.</span><span class="token function">getFileSystemView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">String</span> desktop <span class="token operator">=</span> fsv<span class="token punctuation">.</span><span class="token function">getHomeDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token class-name">String</span> filePath <span class="token operator">=</span> desktop <span class="token operator">+</span> <span class="token string">"/write.doc"</span><span class="token punctuation">;</span>

     <span class="token comment">//2.创建一个文档</span>
     <span class="token class-name">XWPFDocument</span> doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XWPFDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">//3.创建一个表格</span>
     <span class="token class-name">XWPFTable</span> table <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">9</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         <span class="token comment">//4.创建行</span>
         <span class="token class-name">XWPFTableRow</span> row <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">createRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> i<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
             <span class="token comment">//4.创建单元格</span>
             <span class="token class-name">XWPFTableCell</span> cell <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             cell<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"*"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"="</span> <span class="token operator">+</span> <span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             cell<span class="token punctuation">.</span><span class="token function">setWidth</span><span class="token punctuation">(</span><span class="token string">"1024"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>

     <span class="token class-name">FileOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
     out<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     doc<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>

     out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     doc<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre> </li></ul> 
</blockquote> 
<blockquote> 
 <h4><a id="6Java_Web_1067"></a>6.Java Web文档操作</h4> 
</blockquote> 
<blockquote> 
 <h5><a id="1_1069"></a>1.导入</h5> 
</blockquote> 
<blockquote> 
 <h6><a id="1_1071"></a>1.依赖</h6> 
 <pre><code class="prism language-xml"><span class="token comment">&lt;!--Apache POI--&gt;</span> 
<span class="token comment">&lt;!-- excel2003 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.poi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>poi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- excel2007 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.poi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>poi-ooxml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--文件上传--&gt;</span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>commons-io<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-io<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>commons-fileupload<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-fileupload<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.3.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span> 
</code></pre> 
 <ul><li>没有导入commons依赖会报下列错误</li></ul> 
 <pre><code class="prism language-java"><span class="token class-name">Caused</span> by<span class="token operator">:</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span></span>BeanInstantiationException</span><span class="token operator">:</span> 
<span class="token class-name">Failed</span> <span class="token keyword">to</span> <span class="token namespace">instantiate</span> <span class="token punctuation">[</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>multipart<span class="token punctuation">.</span>commons<span class="token punctuation">.</span></span>CommonsMultipartResolver</span><span class="token punctuation">]</span><span class="token operator">:</span>
<span class="token class-name">Factory</span> method 'getCommonsMultipartResolver' threw exception<span class="token punctuation">;</span> nested
exception is <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>NoClassDefFoundError</span><span class="token operator">:</span> 
org<span class="token operator">/</span>apache<span class="token operator">/</span>commons<span class="token operator">/</span>fileupload<span class="token operator">/</span>disk<span class="token operator">/</span><span class="token class-name">DiskFileItemFactory</span>
</code></pre> 
</blockquote> 
<blockquote> 
 <h6><a id="2_1107"></a>2.配置类</h6> 
 <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wd<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span> <span class="token keyword">import</span>
<span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span> <span class="token keyword">import</span>
<span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>multipart<span class="token punctuation">.</span>commons<span class="token punctuation">.</span></span><span class="token class-name">CommonsMultipartResolver</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ImportConfig</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonsMultipartResolver</span> <span class="token function">getCommonsMultipartResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonsMultipartResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> 
</blockquote> 
<blockquote> 
 <h6><a id="3_1123"></a>3.导入接口</h6> 
 <pre><code class="prism language-java">	<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"resource"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/import"</span><span class="token punctuation">)</span>
    <span class="token comment">//注意此处需要@RestController(类)或者@RequestBody注解</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">importExcel</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">{<!-- --></span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BufferedInputStream</span> bufferedInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedInputStream</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">POIFSFileSystem</span> fileSystem <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">POIFSFileSystem</span><span class="token punctuation">(</span>bufferedInputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HSSFWorkbook</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HSSFWorkbook</span><span class="token punctuation">(</span>fileSystem<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//HSSFWorkbook workbook = new HSSFWorkbook(file.getInputStream());</span>
        <span class="token class-name">HSSFSheet</span> sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">getSheetAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sheet<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> lastRowNum <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getLastRowNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>lastRowNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> lastRowNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">HSSFRow</span> row <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getNumericCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> name <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStringCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getNumericCellValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>id <span class="token operator">+</span> <span class="token string">"-"</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">"-"</span> <span class="token operator">+</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
</blockquote> 
<blockquote> 
 <h5><a id="2_1152"></a>2.导出</h5> 
</blockquote> 
<blockquote> 
 <h6><a id="1_1154"></a>1.依赖</h6> 
 <pre><code class="prism language-xml"><span class="token comment">&lt;!--Apache POI--&gt;</span> 
<span class="token comment">&lt;!-- excel2003 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.poi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>poi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- excel2007 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.poi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>poi-ooxml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
</blockquote> 
<blockquote> 
 <h6><a id="2_1171"></a>2.接口</h6> 
 <pre><code class="prism language-java"><span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"resource"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/export"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">HttpSession</span> session<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>

        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> tableHeaders <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"姓名"</span><span class="token punctuation">,</span> <span class="token string">"年龄"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token class-name">HSSFWorkbook</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HSSFWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HSSFSheet</span> sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">createSheet</span><span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HSSFCellStyle</span> cellStyle <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">createCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cellStyle<span class="token punctuation">.</span><span class="token function">setAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span><span class="token constant">CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cellStyle<span class="token punctuation">.</span><span class="token function">setVerticalAlignment</span><span class="token punctuation">(</span><span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span><span class="token constant">CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Font</span> font <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">createFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        font<span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token class-name">IndexedColors</span><span class="token punctuation">.</span><span class="token constant">RED</span><span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        font<span class="token punctuation">.</span><span class="token function">setBold</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cellStyle<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span>font<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 将第一行的三个单元格给合并</span>
        sheet<span class="token punctuation">.</span><span class="token function">addMergedRegion</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CellRangeAddress</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HSSFRow</span> row <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">createRow</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HSSFCell</span> beginCell <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        beginCell<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string">"通讯录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        beginCell<span class="token punctuation">.</span><span class="token function">setCellStyle</span><span class="token punctuation">(</span>cellStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>

        row <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">createRow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 创建表头</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tableHeaders<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">HSSFCell</span> cell <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            cell<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span>tableHeaders<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cell<span class="token punctuation">.</span><span class="token function">setCellStyle</span><span class="token punctuation">(</span>cellStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> users<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            row <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">createRow</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">User</span> user <span class="token operator">=</span> users<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">OutputStream</span> outputStream <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"application/vnd.ms-excel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Content-disposition"</span><span class="token punctuation">,</span> <span class="token string">"attachment;filename=template.xls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        workbook<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>outputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        outputStream<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        outputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
</blockquote> 
<blockquote> 
 <h5><a id="3JSP_1230"></a>3.前端JSP</h5> 
 <pre><code class="prism language-typescript"><span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">--</span>
 Created by IntelliJ <span class="token constant">IDEA</span><span class="token punctuation">.</span>
 User<span class="token operator">:</span> <span class="token number">32929</span>
 Date<span class="token operator">:</span> <span class="token number">2022</span><span class="token operator">/</span><span class="token number">11</span><span class="token operator">/</span><span class="token number">26</span>
 Time<span class="token operator">:</span> <span class="token number">13</span><span class="token operator">:</span><span class="token number">09</span>
 To change <span class="token keyword">this</span> template use File <span class="token operator">|</span> Settings <span class="token operator">|</span> File Templates<span class="token punctuation">.</span>
<span class="token operator">--</span><span class="token operator">%</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">%</span>@ page contentType<span class="token operator">=</span><span class="token string">"text/html;charset=UTF-8"</span> language<span class="token operator">=</span><span class="token string">"java"</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>测试<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"http://localhost:8989/springboot_test/export"</span><span class="token operator">&gt;</span>导出<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">"http://localhost:8989/springboot_test/import"</span> enctype<span class="token operator">=</span><span class="token string">"multipart/form-data"</span> method<span class="token operator">=</span><span class="token string">"post"</span><span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"file"</span> name<span class="token operator">=</span><span class="token string">"file"</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"submit"</span> value<span class="token operator">=</span><span class="token string">"导入Excel"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre> 
</blockquote> 
<blockquote> 
 <h3><a id="2JXL_1256"></a>2.JXL</h3> 
 <ul><li>Java Excel是一开放源码项目，通过它Java开发人员可以读取Excel文件的内容、创建新的Excel文件、更新已经存在的Excel文件。jxl 由于其小巧 易用的特点, 逐渐已经取代了 POI-excel的地位, 成为了越来越多的java开发人员生成excel文件的首选。</li></ul> 
</blockquote> 
<blockquote> 
 <h3><a id="3excelPOI_1260"></a>3.excelPOI</h3> 
</blockquote> 
<blockquote> 
 <h3><a id="4easyExcel_1262"></a>4.easyExcel</h3> 
</blockquote> 
<blockquote> 
 <h3><a id="5GrapeCity_Documents_1264"></a>5.GrapeCity Documents</h3> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d3198d0fbeb1fed7fc3144ddcc9dae71/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">九联UNT413A_S905L3A__AI语音_默认打开ADB_完美线刷固件包【可救砖】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/333d232f82fb471b09a3226445d368d6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">docker搭建wordpress</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>