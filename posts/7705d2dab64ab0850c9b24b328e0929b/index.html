<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>整合Knife4j生成文档后端接口文档出现404无法找到doc.html - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="整合Knife4j生成文档后端接口文档出现404无法找到doc.html" />
<meta property="og:description" content="目录
1、使用场景
2、错误原因解析
3、Knife4jorSwaggerUI配置
4、呈现效果或者swagger-ui与knife4j可以切换
5、参考文章
1、使用场景 最近自己在总结搭建一个统一数据后端的基础框架，在整合knife4j的时候出现了无法找到doc.html页面的问题。其中目前网上解决方案都是统一的一种模式，
在应用启动里面实现(implements WebMvcConfigurer)。
2、错误原因解析 因为我使用的 继承(extends WebMvcConfigurationSupport),新旧版本SpringBoot配置文件 WebMvcConfigurationSupport类 和 WebMvcConfigurer接口之间有冲突。
因为我写了一个返回后端数据统一注解ResponseResult，需要在WebMvcConfigurer/WebMvcConfigurationSupport 注入拦截器。同时考虑到不破坏启动之中类干净
显示内容，于是想到自己定义一个@Configuration类WebAppMvcConfig,去实现WebMvcConfigurer，这样就能够解决我响应结果拦截器ResponseResultInterceptor的注入，
同时比较友好的加入Knife4j的doc.html，以及swagger-ui.html页面友好显示。同时也解决了Knife4j显示404的问题。具体类如下所示：
import cn.hutool.core.date.DatePattern; import com.whdcmap.common.response.ResponseResultInterceptor; import org.springframework.context.annotation.Configuration; import org.springframework.format.FormatterRegistry; import org.springframework.format.datetime.standard.DateTimeFormatterRegistrar; import org.springframework.web.servlet.config.annotation.InterceptorRegistry; import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry; import org.springframework.web.servlet.config.annotation.WebMvcConfigurer; import java.time.format.DateTimeFormatter; /** * @Description TODO * @Classname Knife4jWebMvcConfig * @Date 2021/3/2 15:27 * @Created by jianxiapc */ @Configuration public class WebAppMvcConfig implements WebMvcConfigurer { @Override public void addInterceptors(InterceptorRegistry registry) { /** * 注册自定义的显示 ResponseResult 注解的拦截器 */ registry." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/7705d2dab64ab0850c9b24b328e0929b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-02T17:04:45+08:00" />
<meta property="article:modified_time" content="2021-03-02T17:04:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">整合Knife4j生成文档后端接口文档出现404无法找到doc.html</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF" rel="nofollow">1、使用场景</a></p> 
<p id="2%E3%80%81%E9%94%99%E8%AF%AF%E5%8E%9F%E5%9B%A0%E8%A7%A3%E6%9E%90-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E9%94%99%E8%AF%AF%E5%8E%9F%E5%9B%A0%E8%A7%A3%E6%9E%90" rel="nofollow">2、错误原因解析</a></p> 
<p id="3%E3%80%81Knife4jorSwaggerUI%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px;"><a href="#3%E3%80%81Knife4jorSwaggerUI%E9%85%8D%E7%BD%AE" rel="nofollow">3、Knife4jorSwaggerUI配置</a></p> 
<p id="4%E3%80%81%E5%91%88%E7%8E%B0%E6%95%88%E6%9E%9C%E6%88%96%E8%80%85swagger-ui%E4%B8%8Eknife4j%E5%8F%AF%E4%BB%A5%E5%88%87%E6%8D%A2-toc" style="margin-left:40px;"><a href="#4%E3%80%81%E5%91%88%E7%8E%B0%E6%95%88%E6%9E%9C%E6%88%96%E8%80%85swagger-ui%E4%B8%8Eknife4j%E5%8F%AF%E4%BB%A5%E5%88%87%E6%8D%A2" rel="nofollow">4、呈现效果或者swagger-ui与knife4j可以切换</a></p> 
<p id="5%E3%80%81%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0-toc" style="margin-left:40px;"><a href="#5%E3%80%81%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0" rel="nofollow">5、参考文章</a></p> 
<hr id="hr-toc"> 
<h3 id="1%E3%80%81%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF">1、使用场景</h3> 
<p>        最近自己在总结搭建一个统一数据后端的基础框架，在整合knife4j的时候出现了无法找到doc.html页面的问题。其中目前网上解决方案都是统一的一种模式，</p> 
<p>在应用启动里面实现(<span style="color:#3399ea;"><strong>implements WebMvcConfigurer</strong></span>)。</p> 
<h3 id="2%E3%80%81%E9%94%99%E8%AF%AF%E5%8E%9F%E5%9B%A0%E8%A7%A3%E6%9E%90">2、错误原因解析</h3> 
<p>        因为我使用的 继承(<span style="color:#3399ea;"><strong>extends WebMvcConfigurationSupport</strong></span>),新旧版本SpringBoot配置文件 WebMvcConfigurationSupport类 和 WebMvcConfigurer接口之间有冲突。</p> 
<p>因为我写了一个返回后端数据统一注解<strong><span style="color:#3399ea;">ResponseResult</span></strong>，需要在<strong><span style="color:#3399ea;">WebMvcConfigurer/WebMvcConfigurationSupport</span></strong> 注入拦截器。同时考虑到不破坏启动之中类干净</p> 
<p>显示内容，于是想到自己定义一个@Configuration类<strong><span style="color:#3399ea;">WebAppMvcConfig</span></strong>,去实现<strong><span style="color:#f33b45;">WebMvcConfigurer</span></strong>，这样就能够解决我响应结果拦截器<strong><span style="color:#f33b45;">ResponseResultInterceptor</span></strong>的注入，</p> 
<p>同时比较友好的加入Knife4j的doc.html，以及swagger-ui.html页面友好显示。同时也解决了Knife4j显示404的问题。具体类如下所示：</p> 
<pre><code class="language-java">import cn.hutool.core.date.DatePattern;
import com.whdcmap.common.response.ResponseResultInterceptor;
import org.springframework.context.annotation.Configuration;
import org.springframework.format.FormatterRegistry;
import org.springframework.format.datetime.standard.DateTimeFormatterRegistrar;
import org.springframework.web.servlet.config.annotation.InterceptorRegistry;
import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

import java.time.format.DateTimeFormatter;

/**
 * @Description TODO
 * @Classname Knife4jWebMvcConfig
 * @Date 2021/3/2 15:27
 * @Created by jianxiapc
 */
@Configuration
public class WebAppMvcConfig implements WebMvcConfigurer {

    @Override
    public void addInterceptors(InterceptorRegistry registry) {
        /**
         * 注册自定义的显示 ResponseResult 注解的拦截器
         */
        registry.addInterceptor(new ResponseResultInterceptor())
                // 拦截配置
                .addPathPatterns("/**")
                // 排除配置
                .excludePathPatterns("/error", "/login**");
    }

    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry) {

        registry.addResourceHandler("/**").addResourceLocations("classpath:/static/");

        /** 配置knife4j 显示文档 */
        registry.addResourceHandler("doc.html")
                .addResourceLocations("classpath:/META-INF/resources/");

        /**
         * 配置swagger-ui显示文档
         */
        registry.addResourceHandler("swagger-ui.html")
                .addResourceLocations("classpath:/META-INF/resources/");
        /** 公共部分内容 */
        registry.addResourceHandler("/webjars/**")
                .addResourceLocations("classpath:/META-INF/resources/webjars/");
    }

}</code></pre> 
<h3 id="3%E3%80%81Knife4jorSwaggerUI%E9%85%8D%E7%BD%AE">3、Knife4jorSwaggerUI配置</h3> 
<p>   3.1、需要引入swagger和Knife4j基本jar包如下所示</p> 
<pre><code class="language-html">&lt;!--Swagger-UI API文档生产工具--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.springfox&lt;/groupId&gt;
            &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;
            &lt;version&gt;2.9.2&lt;/version&gt;
        &lt;/dependency&gt;
         &lt;dependency&gt;
             &lt;groupId&gt;io.springfox&lt;/groupId&gt;
             &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;
             &lt;version&gt;2.9.2&lt;/version&gt;
         &lt;/dependency&gt;
     &lt;!--swagger增强工具依赖包，方便生成接口文档。非必须导入--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt;
            &lt;artifactId&gt;knife4j-spring-boot-starter&lt;/artifactId&gt;
            &lt;version&gt;2.0.8&lt;/version&gt;
        &lt;/dependency&gt;</code></pre> 
<p>3.2、配置knife4j或者swaggerui基本配置信息</p> 
<p><span style="color:#f33b45;"><strong>注意事项：</strong></span>一下代码如果自己的简单功能直接书写相关controller扫描包即可，我这边主要扫描注解了RestController相关类</p> 
<pre><span style="color:#3399ea;">//这里指定Controller扫描包路径
.apis(RequestHandlerSelectors.withClassAnnotation(RestController.class))</span></pre> 
<p><span style="color:#3399ea;">示例：</span></p> 
<pre><span style="color:#3399ea;">//这里指定Controller扫描包路径(项目路径也行)
.apis(RequestHandlerSelectors.basePackage("com.example.knife4j.demo")</span></pre> 
<pre><code>import com.github.xiaoymin.knife4j.spring.annotations.EnableKnife4j;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.bind.annotation.RestController;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.ApiInfo;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2;


@EnableSwagger2
@EnableKnife4j
@Configuration
public class Knife4jOrSwagger2Config {

    @Bean(value = "defaultApi2")
    public Docket defaultApi2() {
        Docket docket=new Docket(DocumentationType.SWAGGER_2)
                .apiInfo(apiInfo())
                //分组名称
                .groupName("测试分组")
                .select()
                //这里指定Controller扫描包路径
                .apis(RequestHandlerSelectors.withClassAnnotation(RestController.class))
                .paths(PathSelectors.any())
                .build();
        return docket;
    }

    private ApiInfo apiInfo() {
        return new ApiInfoBuilder()
                .title("Spring Boot Knife4j or swagger-bootstrap-ui API V1.0")
                .description("swagger-bootstrap-ui-demo RESTful APIs")
                .version("1.0")
                .build();
    }
}</code></pre> 
<h3 id="4%E3%80%81%E5%91%88%E7%8E%B0%E6%95%88%E6%9E%9C%E6%88%96%E8%80%85swagger-ui%E4%B8%8Eknife4j%E5%8F%AF%E4%BB%A5%E5%88%87%E6%8D%A2">4、呈现效果或者swagger-ui与knife4j可以切换</h3> 
<p>4.1、Knife4j显示文档</p> 
<p><img alt="" height="390" src="https://images2.imgbox.com/ce/13/upm7v3Rj_o.png" width="1030"><br> 4.2、Swagger-ui显示文档</p> 
<p><img alt="" height="455" src="https://images2.imgbox.com/8b/c4/GA77Bvk4_o.png" width="1008"></p> 
<h3 id="5%E3%80%81%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0">5、参考文章</h3> 
<p><strong><a href="https://www.cnblogs.com/huanshilang/p/13725388.html" rel="nofollow" id="cb_post_title_url">SpringBoot配置knife4j版的Swagger打开doc.html页面404</a></strong></p> 
<p><span style="color:#3399ea;"><strong><a href="https://webkfz.com/rjjc/hsr1.html" rel="nofollow">Springboot集成knife4j实现风格化API文档</a></strong></span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/586819ebd22e4c3390a4cf17b18c7f58/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">esxi6.7的直通</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3d1b457934bd0394f4488e5229652300/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">LeetCode之二分查找之旋转数组系列题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>