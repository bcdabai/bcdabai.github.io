<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>æœ´ç´ è´å¶æ–¯åˆ†ç±»çš„pythonçš„å®ç° - ç¼–ç¨‹å¤§ç™½çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="æœ´ç´ è´å¶æ–¯åˆ†ç±»çš„pythonçš„å®ç°" />
<meta property="og:description" content="æ–‡ç« ç›®å½• ä»‹ç»GaussianNB()å‚æ•°ä»‹ç»å®ä¾‹ BernoulliNB()å‚æ•°ä»‹ç»å®ä¾‹ MultinomialNB()å‚æ•°ä»‹ç»å®ä¾‹ ä½œè€…ï¼šç‹ä¹ ä»‹ç» sklearn æ˜¯ scikitâ€“learn çš„ç®€ç§°,æ˜¯ä¸€ä¸ªåŸºäº Python çš„ç¬¬ä¸‰æ–¹æ¨¡å—ã€‚
sklearn åº“é›†æˆäº†ä¸€äº›å¸¸ç”¨çš„æœºå™¨å­¦ä¹ æ–¹æ³•,åœ¨è¿›è¡Œæœºå™¨å­¦ä¹ ä»»åŠ¡æ—¶,å¹¶ä¸éœ€è¦å®ç°ç®—æ³•,åªéœ€è¦ç®€å•çš„è°ƒç”¨ sklearn åº“ä¸­æä¾›çš„æ¨¡å—å°±èƒ½å®Œæˆå¤§å¤šæ•°çš„æœºå™¨å­¦ä¹ ä»»åŠ¡ã€‚
åœ¨sklearnä¸­ï¼Œä¸€å…±æœ‰3ä¸ªæœ´ç´ è´å¶æ–¯çš„åˆ†ç±»ç®—æ³•ç±»ï¼š
GaussianNBï¼ˆå…ˆéªŒæ˜¯é«˜æ–¯åˆ†å¸ƒçš„æœ´ç´ è´å¶æ–¯ï¼‰ï¼›
BernoulliNBï¼ˆå…ˆéªŒä¸ºä¼¯åŠªåˆ©åˆ†å¸ƒçš„æœ´ç´ è´å¶æ–¯ï¼‰ï¼›
MultinomialNBï¼ˆå…ˆéªŒæ˜¯å¤šé¡¹å¼åˆ†å¸ƒçš„æœ´ç´ è´å¶æ–¯ï¼‰ã€‚
é«˜æ–¯NBç”¨äºè¿ç»­å€¼ï¼›å¤šé¡¹å¼NBç”¨äºç¦»æ•£çš„å¤šå€¼ï¼›ä¼¯åŠªåˆ©NBç”¨äºç¦»æ•£çš„äºŒå€¼ã€‚
é«˜æ–¯æœ´ç´ è´å¶æ–¯åˆ™å¸¸ç”¨äºè¿ç»­ç‰¹å¾çš„æƒ…å†µä¸‹ã€‚é«˜æ–¯æœ´ç´ è´å¶æ–¯å‡è®¾ç‰¹å¾æ»¡è¶³é«˜æ–¯åˆ†å¸ƒï¼ˆæ­£æ€åˆ†å¸ƒï¼‰ã€‚ å¦‚ç‰¹å¾ä¸ºâ€œæŸåœ°é«˜ä¸­ç”Ÿçš„èº«é«˜â€æ—¶ï¼Œå°±ä½¿ç”¨é«˜æ–¯æœ´ç´ è´å¶æ–¯ã€‚
å®ä¾‹åŒ–æ¨¡å‹å¯¹è±¡çš„æ—¶å€™ï¼Œä¸éœ€è¦å¯¹é«˜æ–¯æœ´ç´ è´å¶æ–¯ç±»è¾“å…¥ä»»ä½•çš„å‚æ•°ï¼Œå¯ä»¥è¯´æ˜¯ä¸€ä¸ªéå¸¸è½»é‡çº§çš„ç±»ï¼Œæ“ä½œéå¸¸å®¹æ˜“ã€‚
ä½†è¿‡äºç®€å•ä¹Ÿæ„å‘³ç€è´å¶æ–¯æ²¡æœ‰å¤ªå¤šçš„å‚æ•°å¯ä»¥è°ƒæ•´ï¼Œå› æ­¤è´å¶æ–¯ç®—æ³•çš„æˆé•¿ç©ºé—´å¹¶ä¸æ˜¯å¤ªå¤§ï¼Œå¦‚æœè´å¶æ–¯ç®—æ³•çš„æ•ˆæœä¸æ˜¯å¤ªç†æƒ³ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šè€ƒè™‘æ¢æ¨¡å‹ã€‚
GaussianNB()å‚æ•°ä»‹ç» GaussianNB(*, priors=None, var_smoothing=1e-09) å‚æ•°:
priors : array-like of shape (n_classes,),Prior probabilities of the classes. If specified the priors are not adjusted according to the data.
å…ˆéªŒï¼šæ•°ç»„-ï¼ˆn_classes,ï¼‰æ¯ä¸€ç±»çš„å…ˆéªŒæ¦‚ç‡ã€‚å¦‚æœæŒ‡å®šå…ˆéªŒæ¦‚ç‡ï¼Œåˆ™ä¸ä¼šæ ¹æ®æ•°æ®è°ƒæ•´å…ˆéªŒæ¦‚ç‡ã€‚
var_smoothing : float, default=1e-9
æ–¹å·®å¹³æ»‘ï¼šæµ®ç‚¹æ•°ï¼Œé»˜è®¤=1e-9ï¼Œä¸ºäº†è®¡ç®—ç¨³å®šæ€§è€Œæ·»åŠ åˆ°æ–¹å·®ä¸­çš„æ‰€æœ‰ç‰¹å¾çš„æœ€å¤§æ–¹å·®éƒ¨åˆ†ã€‚
å±æ€§ï¼š
ç±»åˆ«æ•° class_count_ï¼šndarray of shape (n_classes,)ï¼Œåœ¨æ¯ä¸ªç±»ä¸­è§‚å¯Ÿåˆ°çš„è®­ç»ƒæ ·æœ¬æ•°ã€‚
ç±»åˆ«å…ˆéªŒæ¦‚ç‡ class_prior_ï¼šndarray of shape (n_classes,)ï¼Œæ¯ä¸ªç±»åˆ«çš„å…ˆéªŒæ¦‚ç‡ã€‚
ç±»æ ‡ç­¾ classes_ï¼šndarray of shape (n_classes,)ï¼Œåˆ†ç±»å™¨å·²çŸ¥çš„ç±»æ ‡ç­¾ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c9aeeb80d84e0b8344079cacdad4055a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-29T23:26:33+08:00" />
<meta property="article:modified_time" content="2022-12-29T23:26:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§ç™½çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§ç™½çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">æœ´ç´ è´å¶æ–¯åˆ†ç±»çš„pythonçš„å®ç°</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><a href="#_2" rel="nofollow">ä»‹ç»</a></li><li><a href="#GaussianNB_17" rel="nofollow">GaussianNB()å‚æ•°ä»‹ç»</a></li><li><ul><li><a href="#_45" rel="nofollow">å®ä¾‹</a></li></ul> 
  </li><li><a href="#BernoulliNB_81" rel="nofollow">BernoulliNB()å‚æ•°ä»‹ç»</a></li><li><ul><li><a href="#_126" rel="nofollow">å®ä¾‹</a></li></ul> 
  </li><li><a href="#MultinomialNB_169" rel="nofollow">MultinomialNB()å‚æ•°ä»‹ç»</a></li><li><ul><li><a href="#_212" rel="nofollow">å®ä¾‹</a></li></ul> 
 </li></ul> 
</div> 
<br> ä½œè€…ï¼šç‹ä¹ 
<p></p> 
<h2><a id="_2"></a>ä»‹ç»</h2> 
<p>sklearn æ˜¯ scikitâ€“learn çš„ç®€ç§°,æ˜¯ä¸€ä¸ªåŸºäº Python çš„ç¬¬ä¸‰æ–¹æ¨¡å—ã€‚<br> sklearn åº“é›†æˆäº†ä¸€äº›å¸¸ç”¨çš„æœºå™¨å­¦ä¹ æ–¹æ³•,åœ¨è¿›è¡Œæœºå™¨å­¦ä¹ ä»»åŠ¡æ—¶,å¹¶ä¸éœ€è¦å®ç°ç®—æ³•,åªéœ€è¦ç®€å•çš„è°ƒç”¨ sklearn åº“ä¸­æä¾›çš„æ¨¡å—å°±èƒ½å®Œæˆå¤§å¤šæ•°çš„æœºå™¨å­¦ä¹ ä»»åŠ¡ã€‚</p> 
<p>åœ¨sklearnä¸­ï¼Œä¸€å…±æœ‰3ä¸ªæœ´ç´ è´å¶æ–¯çš„åˆ†ç±»ç®—æ³•ç±»ï¼š<br> GaussianNBï¼ˆå…ˆéªŒæ˜¯é«˜æ–¯åˆ†å¸ƒçš„æœ´ç´ è´å¶æ–¯ï¼‰ï¼›<br> BernoulliNBï¼ˆå…ˆéªŒä¸ºä¼¯åŠªåˆ©åˆ†å¸ƒçš„æœ´ç´ è´å¶æ–¯ï¼‰ï¼›<br> MultinomialNBï¼ˆå…ˆéªŒæ˜¯å¤šé¡¹å¼åˆ†å¸ƒçš„æœ´ç´ è´å¶æ–¯ï¼‰ã€‚<br> é«˜æ–¯NBç”¨äºè¿ç»­å€¼ï¼›å¤šé¡¹å¼NBç”¨äºç¦»æ•£çš„å¤šå€¼ï¼›ä¼¯åŠªåˆ©NBç”¨äºç¦»æ•£çš„äºŒå€¼ã€‚</p> 
<p>é«˜æ–¯æœ´ç´ è´å¶æ–¯åˆ™å¸¸ç”¨äºè¿ç»­ç‰¹å¾çš„æƒ…å†µä¸‹ã€‚é«˜æ–¯æœ´ç´ è´å¶æ–¯å‡è®¾ç‰¹å¾æ»¡è¶³é«˜æ–¯åˆ†å¸ƒï¼ˆæ­£æ€åˆ†å¸ƒï¼‰ã€‚ å¦‚ç‰¹å¾ä¸ºâ€œæŸåœ°é«˜ä¸­ç”Ÿçš„èº«é«˜â€æ—¶ï¼Œå°±ä½¿ç”¨é«˜æ–¯æœ´ç´ è´å¶æ–¯ã€‚</p> 
<p>å®ä¾‹åŒ–æ¨¡å‹å¯¹è±¡çš„æ—¶å€™ï¼Œä¸éœ€è¦å¯¹é«˜æ–¯æœ´ç´ è´å¶æ–¯ç±»è¾“å…¥ä»»ä½•çš„å‚æ•°ï¼Œå¯ä»¥è¯´æ˜¯ä¸€ä¸ªéå¸¸è½»é‡çº§çš„ç±»ï¼Œæ“ä½œéå¸¸å®¹æ˜“ã€‚<br> ä½†è¿‡äºç®€å•ä¹Ÿæ„å‘³ç€è´å¶æ–¯æ²¡æœ‰å¤ªå¤šçš„å‚æ•°å¯ä»¥è°ƒæ•´ï¼Œå› æ­¤è´å¶æ–¯ç®—æ³•çš„æˆé•¿ç©ºé—´å¹¶ä¸æ˜¯å¤ªå¤§ï¼Œå¦‚æœè´å¶æ–¯ç®—æ³•çš„æ•ˆæœä¸æ˜¯å¤ªç†æƒ³ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šè€ƒè™‘æ¢æ¨¡å‹ã€‚</p> 
<h2><a id="GaussianNB_17"></a>GaussianNB()å‚æ•°ä»‹ç»</h2> 
<pre><code class="prism language-python">  GaussianNB<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span> priors<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> var_smoothing<span class="token operator">=</span><span class="token number">1e-09</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>å‚æ•°:</strong></p> 
<ul><li> <p>priors : array-like of shape (n_classes,),Prior probabilities of the classes. If specified the priors are not adjusted according to the data.<br> å…ˆéªŒï¼šæ•°ç»„-ï¼ˆn_classes,ï¼‰æ¯ä¸€ç±»çš„å…ˆéªŒæ¦‚ç‡ã€‚å¦‚æœæŒ‡å®šå…ˆéªŒæ¦‚ç‡ï¼Œåˆ™ä¸ä¼šæ ¹æ®æ•°æ®è°ƒæ•´å…ˆéªŒæ¦‚ç‡ã€‚</p> </li><li> <p>var_smoothing : float, default=1e-9<br> æ–¹å·®å¹³æ»‘ï¼šæµ®ç‚¹æ•°ï¼Œé»˜è®¤=1e-9ï¼Œä¸ºäº†è®¡ç®—ç¨³å®šæ€§è€Œæ·»åŠ åˆ°æ–¹å·®ä¸­çš„æ‰€æœ‰ç‰¹å¾çš„æœ€å¤§æ–¹å·®éƒ¨åˆ†ã€‚</p> </li></ul> 
<p><strong>å±æ€§ï¼š</strong></p> 
<ul><li> <p>ç±»åˆ«æ•° class_count_ï¼šndarray of shape (n_classes,)ï¼Œåœ¨æ¯ä¸ªç±»ä¸­è§‚å¯Ÿåˆ°çš„è®­ç»ƒæ ·æœ¬æ•°ã€‚</p> </li><li> <p>ç±»åˆ«å…ˆéªŒæ¦‚ç‡ class_prior_ï¼šndarray of shape (n_classes,)ï¼Œæ¯ä¸ªç±»åˆ«çš„å…ˆéªŒæ¦‚ç‡ã€‚</p> </li><li> <p>ç±»æ ‡ç­¾ classes_ï¼šndarray of shape (n_classes,)ï¼Œåˆ†ç±»å™¨å·²çŸ¥çš„ç±»æ ‡ç­¾ã€‚</p> </li><li> <p>epsilon_ï¼šæµ®ç‚¹æ•°ï¼Œæ–¹å·®çš„ç»å¯¹é™„åŠ å€¼ã€‚</p> </li><li> <p>sigma_ : ndarray of shape (n_classes, n_features)ï¼Œæ¯ç±»æ¯ä¸ªç‰¹å¾çš„æ–¹å·®</p> </li><li> <p>theta_ : ndarray of shape (n_classes, n_features)ï¼Œæ¯ç±»æ¯ä¸ªç‰¹å¾çš„å¹³å‡å€¼</p> </li></ul> 
<h3><a id="_45"></a>å®ä¾‹</h3> 
<pre><code class="prism language-python"><span class="token comment">#å¯¼å…¥é¸¢å°¾èŠ±æ•°æ®é›†</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris <span class="token comment">#sklearnå†…ç½®æ•°æ®é›†sklearn</span>
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> model_selection <span class="token comment">#æ‹†åˆ†æ•°æ®é›†ã€è®­ç»ƒé›†æµ‹è¯•é›†ã€‘</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> GaussianNB <span class="token comment">#å¯¼å…¥å…ˆéªŒæ˜¯é«˜æ–¯åˆ†å¸ƒçš„æœ´ç´ è´å¶æ–¯æ¨¡å‹</span>

iris<span class="token operator">=</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
x<span class="token operator">=</span>iris<span class="token punctuation">.</span>data
y<span class="token operator">=</span>iris<span class="token punctuation">.</span>target
x_train<span class="token punctuation">,</span>x_test<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>y_test<span class="token operator">=</span>model_selection<span class="token punctuation">.</span>train_test_split<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">123456</span><span class="token punctuation">)</span> <span class="token comment">#random_stateæ§åˆ¶éšæœºçŠ¶æ€ã€‚</span>


model<span class="token operator">=</span>GaussianNB<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#æ¨¡å‹ä¸ºå…ˆéªŒæ˜¯é«˜æ–¯åˆ†å¸ƒçš„æœ´ç´ è´å¶æ–¯</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span> <span class="token comment">#æ‹Ÿåˆè®­ç»ƒ</span>
predict<span class="token operator">=</span>model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span> <span class="token comment">#é¢„æµ‹</span>

<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report 
<span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>predict<span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span>metrics<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> predict<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#æ··æ·†çŸ©é˜µ</span>
model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span>

<span class="token comment"># æ··æ·†çŸ©é˜µè¦è¡¨è¾¾çš„å«ä¹‰ï¼š</span>

<span class="token comment"># 1ã€æ··æ·†çŸ©é˜µçš„æ¯ä¸€åˆ—ä»£è¡¨äº†é¢„æµ‹ç±»åˆ«ï¼Œæ¯ä¸€åˆ—çš„æ€»æ•°è¡¨ç¤ºé¢„æµ‹ä¸ºè¯¥ç±»åˆ«çš„æ•°æ®çš„æ•°ç›®ï¼›</span>
<span class="token comment"># 2ã€æ¯ä¸€è¡Œä»£è¡¨äº†æ•°æ®çš„çœŸå®å½’å±ç±»åˆ«ï¼Œæ¯ä¸€è¡Œçš„æ•°æ®æ€»æ•°è¡¨ç¤ºè¯¥ç±»åˆ«çš„æ•°æ®å®ä¾‹çš„æ•°ç›®ï¼›æ¯ä¸€åˆ—ä¸­çš„æ•°å€¼è¡¨ç¤ºçœŸå®æ•°æ®è¢«é¢„æµ‹ä¸ºè¯¥ç±»çš„æ•°ç›®ã€‚</span>
<span class="token comment"># True Positiveï¼ˆTPï¼‰ï¼šçœŸæ­£ç±»ã€‚æ ·æœ¬çš„çœŸå®ç±»åˆ«æ˜¯æ­£ç±»ï¼Œå¹¶ä¸”æ¨¡å‹è¯†åˆ«çš„ç»“æœä¹Ÿæ˜¯æ­£ç±»ã€‚</span>
<span class="token comment"># False Negativeï¼ˆFNï¼‰ï¼šå‡è´Ÿç±»ã€‚æ ·æœ¬çš„çœŸå®ç±»åˆ«æ˜¯æ­£ç±»ï¼Œä½†æ˜¯æ¨¡å‹å°†å…¶è¯†åˆ«ä¸ºè´Ÿç±»ã€‚</span>
<span class="token comment"># False Positiveï¼ˆFPï¼‰ï¼šå‡æ­£ç±»ã€‚æ ·æœ¬çš„çœŸå®ç±»åˆ«æ˜¯è´Ÿç±»ï¼Œä½†æ˜¯æ¨¡å‹å°†å…¶è¯†åˆ«ä¸ºæ­£ç±»ã€‚</span>
<span class="token comment"># True Negativeï¼ˆTNï¼‰ï¼šçœŸè´Ÿç±»ã€‚æ ·æœ¬çš„çœŸå®ç±»åˆ«æ˜¯è´Ÿç±»ï¼Œå¹¶ä¸”æ¨¡å‹å°†å…¶è¯†åˆ«ä¸ºè´Ÿç±»ã€‚</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9d/66/tPZqxcOP_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="BernoulliNB_81"></a>BernoulliNB()å‚æ•°ä»‹ç»</h2> 
<pre><code class="prism language-python">BernoulliNB<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> binarize<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> fit_prior<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> class_prior<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>å‚æ•°:</strong></p> 
<ul><li> <p>alpha : float, default=1.0<br> æµ®ç‚¹æ•°ï¼Œå¹³æ»‘å‚æ•°ï¼ˆ0è¡¨ç¤ºæ— å¹³æ»‘ï¼‰ã€‚</p> </li><li> <p>binarize : float or None, default=0.0<br> äºŒè¿›åˆ¶åŒ–ï¼šæµ®ç‚¹æˆ–æ— ï¼Œé»˜è®¤å€¼=0.0ï¼Œæ ·æœ¬ç‰¹å¾äºŒå€¼åŒ–ï¼ˆæ˜ å°„åˆ°å¸ƒå°”å€¼ï¼‰çš„é˜ˆå€¼ã€‚å¦‚æœä¸ºâ€œæ— â€ï¼Œåˆ™å‡å®šè¾“å…¥å·²ç”±äºŒè¿›åˆ¶çŸ¢é‡ç»„æˆã€‚</p> </li><li> <p>binarizeï¼šå°†æ•°æ®ç‰¹å¾äºŒå€¼åŒ–çš„é˜ˆå€¼ï¼Œå¤§äºæ­¤é˜ˆå€¼ä¸º1ï¼Œå°äºæ­¤é˜ˆå€¼ä¸º0ï¼Œï¼ˆå°±å¤šäº†ä¸€ä¸ªå‚æ•°ï¼Œå…¶ä»–å‚æ•°ä¸å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯ç›¸åŒï¼‰<br> BernoulliNBå®ç°äº†ç”¨äºå¤šå…ƒBernoulliåˆ†å¸ƒæ•°æ®çš„æœ´ç´ Bayesè®­ç»ƒå’Œåˆ†ç±»ç®—æ³•ï¼›å³ï¼Œå¯èƒ½æœ‰å¤šä¸ªç‰¹å¾ï¼Œä½†æ¯ä¸ªç‰¹å¾éƒ½å‡å®šä¸ºäºŒå€¼ï¼ˆBernoulliï¼Œbooleanï¼‰å˜é‡ã€‚å› æ­¤ï¼Œæ­¤ç±»ç®—æ³•è¦æ±‚æ ·æœ¬ä»¥äºŒå€¼ç‰¹å¾å‘é‡è¡¨ç¤ºï¼›å¦‚æœä¼ é€’ä»»ä½•å…¶ä»–ç±»å‹çš„æ•°æ®ï¼ŒBernoulliNBå®ä¾‹å¯ä»¥å¯¹å…¶è¾“å…¥è¿›è¡ŒäºŒå€¼åŒ–ï¼ˆå–å†³äºbinarize å‚æ•°ï¼‰ã€‚</p> </li><li> <p>fit_prior : bool, default=True<br> æ˜¯å¦å­¦ä¹ ç±»å…ˆéªŒæ¦‚ç‡ã€‚å¦‚æœä¸ºå‡ï¼Œå°†ä½¿ç”¨ç»Ÿä¸€çš„å…ˆéªŒã€‚</p> </li><li> <p>class_prior : array-like of shape (n_classes,), default=None<br> ç±»çš„å…ˆéªŒæ¦‚ç‡ã€‚å¦‚æœæŒ‡å®šï¼Œåˆ™ä¸æ ¹æ®æ•°æ®è°ƒæ•´å…ˆéªŒã€‚</p> </li></ul> 
<p><strong>å±æ€§:</strong></p> 
<ul><li> <p>class_count_ : ndarray of shape (n_classes)<br> æ‹Ÿåˆæ—¶æ¯ä¸ªç±»çš„æ ·æœ¬æ•°ã€‚è¯¥å€¼ç”±æ ·æœ¬æƒé‡ï¼ˆå½“æä¾›æ—¶ï¼‰åŠ æƒã€‚<br> è®­ç»ƒæ ·æœ¬ä¸­å„ç±»åˆ«å¯¹åº”çš„æ ·æœ¬æ•°ï¼ŒæŒ‰ç±»çš„é¡ºåºæ’åºè¾“å‡º</p> </li><li> <p>class_log_prior_ : ndarray of shape (n_classes)<br> æ¯ä¸ªç±»çš„å¯¹æ•°æ¦‚ç‡ï¼ˆå¹³æ»‘ï¼‰ å„ç±»æ ‡è®°çš„å¹³æ»‘å…ˆéªŒæ¦‚ç‡å¯¹æ•°å€¼ï¼Œå…¶å–å€¼ä¼šå—fit_priorå’Œclass_priorå‚æ•°çš„å½±å“</p> </li><li> <p>classes_ : ndarray of shape (n_classes,)<br> åˆ†ç±»å™¨å·²çŸ¥çš„ç±»æ ‡ç­¾</p> </li><li> <p>feature_count_ : ndarray of shape (n_classes, n_features)<br> æ‹Ÿåˆæ—¶æ¯ä¸ªï¼ˆç±»ã€ç‰¹å¾ï¼‰çš„æ ·æœ¬æ•°ã€‚è¯¥å€¼ç”±æ ·æœ¬æƒé‡ï¼ˆå½“æä¾›æ—¶ï¼‰åŠ æƒã€‚<br> å„ç±»åˆ«å„ä¸ªç‰¹å¾å‡ºç°çš„æ¬¡æ•°ï¼Œè¿”å›å½¢çŠ¶ä¸º(n_classes, n_features)æ•°ç»„</p> </li><li> <p>feature_log_prob_ : ndarray of shape (n_classes, n_features)<br> ç»™å®šç±»çš„ç‰¹å¾çš„ç»éªŒå¯¹æ•°æ¦‚ç‡<br> ç»™å‡ºä¸€ä¸ªç±»çš„ç‰¹å¾æ¡ä»¶æ¦‚ç‡P(xi | y)çš„å¯¹æ•°å€¼ï¼Œè¿”å›å½¢çŠ¶ä¸º(n_classes, n_features)æ•°ç»„</p> </li><li> <p>coef_ : ndarray of shape (n_classes, n_features) ç³»æ•°<br> intercept_ : ndarray of shape (n_classes,) æˆªè·</p> </li><li> <p>n_features_ : int<br> æ•´æ•° æ¯ä¸ªæ ·æœ¬çš„ç‰¹å¾æ•°é‡ã€‚</p> </li></ul> 
<h3><a id="_126"></a>å®ä¾‹</h3> 
<pre><code class="prism language-python"><span class="token comment">#ä¾‹å­</span>

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_blobs
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> MinMaxScaler
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> BernoulliNB  <span class="token comment"># ä¼¯åŠªåˆ©è´å¶æ–¯: ä¸“é—¨ç”¨äºå¤„ç†ï¼ˆå¤šå…ƒï¼‰äºŒé¡¹åˆ†å¸ƒ</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> brier_score_loss  <span class="token comment"># å¸ƒé‡Œå°”åˆ†æ•°</span>


class_1_samples <span class="token operator">=</span> <span class="token number">500</span>
class_2_samples <span class="token operator">=</span> <span class="token number">500</span>
centers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>  <span class="token comment"># (1000,2)  ==&gt;  centers = [[0.0, 0.0, 0.0], [2.0, 2.0, 2.0]] (1000, 3)</span>
cluster_std <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> make_blobs<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token punctuation">[</span>class_1_samples<span class="token punctuation">,</span> class_2_samples<span class="token punctuation">]</span><span class="token punctuation">,</span> centers<span class="token operator">=</span>centers<span class="token punctuation">,</span> cluster_std<span class="token operator">=</span>cluster_std<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>  <span class="token comment"># [1000, 2]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>unique<span class="token punctuation">)</span>  <span class="token comment"># array([0, 1])</span>

Xtrain<span class="token punctuation">,</span> Xtest<span class="token punctuation">,</span> ytrain<span class="token punctuation">,</span> ytest <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Xtrain<span class="token punctuation">)</span><span class="token comment">#éäºŒå€¼åŒ– å˜é‡ç‰¹å¾ä»¬</span>

mms <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>Xtrain<span class="token punctuation">)</span>
Xtrain <span class="token operator">=</span> mms<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>Xtrain<span class="token punctuation">)</span>
Xtest <span class="token operator">=</span> mms<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>Xtest<span class="token punctuation">)</span>

bnl_ <span class="token operator">=</span> BernoulliNB<span class="token punctuation">(</span><span class="token punctuation">)</span>
bnl_<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>Xtrain<span class="token punctuation">,</span> ytrain<span class="token punctuation">)</span>  <span class="token comment"># ä¸è®¾ç½®äºŒå€¼åŒ–</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ä¸è¿›è¡ŒäºŒå€¼åŒ–çš„æ¨¡å‹å¾—åˆ†ï¼š"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>bnl_<span class="token punctuation">.</span>score<span class="token punctuation">(</span>Xtest<span class="token punctuation">,</span> ytest<span class="token punctuation">)</span><span class="token punctuation">)</span>

bnl <span class="token operator">=</span> BernoulliNB<span class="token punctuation">(</span>binarize<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token comment"># è®¾ç½®äºŒå€¼åŒ–é˜ˆå€¼ä¸º0.5ï¼Œå°†ç‰¹å¾äºŒå€¼åŒ–ã€ç‰¹å¾å¤§äº0.5ï¼Œåˆ™ä¸º1ï¼›ç‰¹å¾å°äº0.5ï¼Œåˆ™ä¸º0  äºŒå€¼åŒ–å¤„ç†ç»“æŸã€‘</span>
bnl<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>Xtrain<span class="token punctuation">,</span> ytrain<span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"äºŒå€¼åŒ–åçš„æ¨¡å‹å¾—åˆ†ï¼š"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>bnl<span class="token punctuation">.</span>score<span class="token punctuation">(</span>Xtest<span class="token punctuation">,</span> ytest<span class="token punctuation">)</span><span class="token punctuation">)</span>

brier_score_loss<span class="token punctuation">(</span>ytest<span class="token punctuation">,</span> bnl<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>Xtest<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pos_label<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>


</code></pre> 
<p><img src="https://images2.imgbox.com/46/91/vhGn5ElY_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h2><a id="MultinomialNB_169"></a>MultinomialNB()å‚æ•°ä»‹ç»</h2> 
<pre><code class="prism language-python">MultinomialNB<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> fit_prior<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> class_prior<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>  
</code></pre> 
<p>å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨é€‚ç”¨äºå…·æœ‰ç¦»æ•£ç‰¹å¾çš„åˆ†ç±»ï¼ˆä¾‹å¦‚ï¼Œæ–‡æœ¬åˆ†ç±»ä¸­çš„å­—æ•°ï¼‰ã€‚<br> å¤šé¡¹å¼åˆ†å¸ƒé€šå¸¸éœ€è¦æ•´æ•°ç‰¹å¾è®¡æ•°ã€‚ç„¶è€Œï¼Œåœ¨å®è·µä¸­ï¼Œåˆ†æ•°è®¡æ•°ï¼ˆå¦‚tf-idfï¼‰ä¹Ÿå¯ä»¥ã€‚</p> 
<p><strong>å‚æ•°</strong></p> 
<ul><li> <p>alpha : float, default=1.0<br> æµ®ç‚¹æ•°ï¼Œå¹³æ»‘å‚æ•°ï¼ˆ0è¡¨ç¤ºæ— å¹³æ»‘ï¼‰</p> </li><li> <p>å¹³æ»‘å…ˆéªŒğ›¼â‰¥0,è®©å­¦ä¹ æ ·æœ¬ä¸­ä¸å­˜åœ¨çš„ç‰¹å¾å ä¸€å®šçš„æ¯”ä¾‹ï¼Œå¹¶é˜²æ­¢åœ¨è¿›ä¸€æ­¥çš„è®¡ç®—ä¸­å‡ºç°é›¶æ¦‚ç‡ã€‚ğ›¼=1 æ—¶ä¸ºæ‹‰æ™®æ‹‰æ–¯(Laplace)å¹³æ»‘ï¼Œğ›¼&lt;1æ—¶ä¸ºæå¾·æ–¯é€š(Lidstone)å¹³æ»‘ã€‚</p> </li><li> <p>fit_prior : bool, default=True<br> æ˜¯å¦å­¦ä¹ ç±»å…ˆéªŒæ¦‚ç‡ã€‚å¦‚æœä¸ºå‡ï¼Œå°†ä½¿ç”¨ç»Ÿä¸€çš„å…ˆéªŒã€‚</p> </li><li> <p>class_prior : array-like of shape (n_classes,), default=None<br> ç±»çš„å…ˆéªŒæ¦‚ç‡ã€‚å¦‚æœæŒ‡å®šï¼Œåˆ™ä¸æ ¹æ®æ•°æ®è°ƒæ•´å…ˆéªŒã€‚</p> </li></ul> 
<p><strong>å±æ€§</strong>ï¼ˆå’Œä¼¯åŠªåˆ©ä¸€æ ·çš„ï¼‰</p> 
<ul><li> <p>class_count_ : ndarray of shape (n_classes)<br> æ‹Ÿåˆæ—¶æ¯ä¸ªç±»çš„æ ·æœ¬æ•°ã€‚è¯¥å€¼ç”±æ ·æœ¬æƒé‡ï¼ˆå½“æä¾›æ—¶ï¼‰åŠ æƒã€‚</p> </li><li> <p>class_log_prior_ : ndarray of shape (n_classes)<br> æ¯ä¸ªç±»çš„å¯¹æ•°æ¦‚ç‡ï¼ˆå¹³æ»‘ï¼‰</p> </li><li> <p>classes_ : ndarray of shape (n_classes,)<br> åˆ†ç±»å™¨å·²çŸ¥çš„ç±»æ ‡ç­¾</p> </li><li> <p>coef_ : ndarray of shape (n_classes, n_features) ç³»æ•°</p> </li><li> <p>feature_count_ : ndarray of shape (n_classes, n_features)<br> æ‹Ÿåˆæ—¶æ¯ä¸ªï¼ˆç±»ã€ç‰¹å¾ï¼‰çš„æ ·æœ¬æ•°ã€‚è¯¥å€¼ç”±æ ·æœ¬æƒé‡ï¼ˆå½“æä¾›æ—¶ï¼‰åŠ æƒã€‚</p> </li><li> <p>feature_log_prob_ : ndarray of shape (n_classes, n_features)<br> ç»™å®šç±»çš„ç‰¹å¾çš„ç»éªŒå¯¹æ•°æ¦‚ç‡</p> </li><li> <p>intercept_ : ndarray of shape (n_classes,) æˆªè·</p> </li><li> <p>n_features_ : int<br> æ•´æ•° æ¯ä¸ªæ ·æœ¬çš„ç‰¹å¾æ•°é‡</p> </li></ul> 
<h3><a id="_212"></a>å®ä¾‹</h3> 
<pre><code class="prism language-python"><span class="token comment">#ç¦»æ•£æƒ…å†µ å¤šé¡¹å¼è´å¶æ–¯</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_blobs
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> KBinsDiscretizer  <span class="token comment"># ç¦»æ•£åŒ–</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> MultinomialNB
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> brier_score_loss  <span class="token comment"># å¸ƒé‡Œå°”åˆ†æ•° : for bin_class</span>


class_1_samples <span class="token operator">=</span> <span class="token number">400</span>
class_2_samples <span class="token operator">=</span> <span class="token number">400</span>
centers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>  <span class="token comment"># (800,2) </span>
cluster_std <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">]</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> make_blobs<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token punctuation">[</span>class_1_samples<span class="token punctuation">,</span> class_2_samples<span class="token punctuation">]</span><span class="token punctuation">,</span> centers<span class="token operator">=</span>centers<span class="token punctuation">,</span> cluster_std<span class="token operator">=</span>cluster_std<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>  <span class="token comment"># [800, 2]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>unique<span class="token punctuation">)</span>  <span class="token comment"># array([0, 1])</span>

Xtrain<span class="token punctuation">,</span> Xtest<span class="token punctuation">,</span> ytrain<span class="token punctuation">,</span> ytest <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>


<span class="token comment">###ä½¿ç”¨KBinsDiscretizerç¦»æ•£åŒ–è¿ç»­ç‰¹å¾</span>
kbs <span class="token operator">=</span> KBinsDiscretizer<span class="token punctuation">(</span>n_bins<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> encode<span class="token operator">=</span><span class="token string">"onehot"</span><span class="token punctuation">)</span>
kbs<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>Xtrain<span class="token punctuation">)</span>
Xtrain_ <span class="token operator">=</span> kbs<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>Xtrain<span class="token punctuation">)</span>
Xtest_ <span class="token operator">=</span> kbs<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>Xtest<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Xtrain_<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>  


mnb <span class="token operator">=</span> MultinomialNB<span class="token punctuation">(</span><span class="token punctuation">)</span>
mnb<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>Xtrain_<span class="token punctuation">,</span> ytrain<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Accuracy score:"</span><span class="token punctuation">,</span> mnb<span class="token punctuation">.</span>score<span class="token punctuation">(</span>Xtest_<span class="token punctuation">,</span> ytest<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Brier score:"</span><span class="token punctuation">,</span> brier_score_loss<span class="token punctuation">(</span>ytest<span class="token punctuation">,</span> mnb<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>Xtest_<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pos_label<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># è¶Šæ¥è¿‘ 0 è¶Šå¥½;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mnb<span class="token punctuation">.</span>feature_log_prob_<span class="token punctuation">,</span> mnb<span class="token punctuation">.</span>feature_log_prob_<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>mnb<span class="token punctuation">.</span>feature_log_prob_<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># ä¸€ä¸ªå›ºå®šæ ‡ç­¾ç±»åˆ«ä¸‹çš„æ¯ä¸ªç‰¹å¾çš„å¯¹æ•°æ¦‚ç‡</span>


</code></pre> 
<p><img src="https://images2.imgbox.com/a0/23/xUWHw8G9_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<pre><code class="prism language-python"><span class="token comment">#å¯¼å…¥é¸¢å°¾èŠ±æ•°æ®é›†</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris <span class="token comment">#sklearnå†…ç½®æ•°æ®é›†sklearn</span>
iris<span class="token operator">=</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
x<span class="token operator">=</span>iris<span class="token punctuation">.</span>data
y<span class="token operator">=</span>iris<span class="token punctuation">.</span>target
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> model_selection <span class="token comment">#æ‹†åˆ†æ•°æ®é›†ã€è®­ç»ƒé›†æµ‹è¯•é›†ã€‘</span>
x_train<span class="token punctuation">,</span>x_test<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>y_test<span class="token operator">=</span>model_selection<span class="token punctuation">.</span>train_test_split<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">123456</span><span class="token punctuation">)</span> 
model<span class="token operator">=</span>MultinomialNB<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#æ¨¡å‹ä¸ºå…ˆéªŒæ˜¯å¤šé¡¹å¼åˆ†å¸ƒçš„æœ´ç´ è´å¶æ–¯</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span> <span class="token comment">#æ‹Ÿåˆè®­ç»ƒ</span>
predict<span class="token operator">=</span>model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span> <span class="token comment">#é¢„æµ‹</span>

<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metrics
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report 
<span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>predict<span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span>metrics<span class="token punctuation">.</span>confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> predict<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/86/16/iN9vlew8_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9d90655de922cd548c4b13e242bd675a/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">é¡¹ç›®æ¥å£æ–‡æ¡£</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d4b2f9e0bf3f0a56be06fe7016895b3a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">æ¸…ç©ºGithubä»“åº“æ–¹æ³•</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§ç™½çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>