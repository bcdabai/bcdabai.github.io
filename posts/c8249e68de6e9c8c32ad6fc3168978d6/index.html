<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Delaunay三角剖分算法初探 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Delaunay三角剖分算法初探" />
<meta property="og:description" content="Delaunay三角网在空间邻近分析上是一种较好的支持模型, 广泛应用于空间聚类、多边形群的合并、人像关键点提取、形态分析中。
问题：一堆二维点中寻找一个与目标点最近(欧氏距离最小)的点。
1. 三角剖分与Delaunay剖分的定义 如何把一个散点集合剖分成不均匀的三角形网格，这就是散点集的三角剖分问题，散点集的三角剖分，对数值分析以及图形学来说，都是极为重要的一项预处理技术。该问题图示如下：
1.1. 三角剖分定义 【定义】三角剖分：假设V是二维实数域上的有限点集，边e是由点集中的点作为端点构成的封闭线段, E为e的集合。那么该点集V的一个三角剖分T=(V,E)是一个平面图G，该平面图满足条件：
除了端点，平面图中的边不包含点集中的任何点。没有相交边。平面图中所有的面都是三角面，且所有三角面的合集是散点集V的凸包。 1.2. Delaunay三角剖分的定义 在实际中运用的最多的三角剖分是Delaunay三角剖分，它是一种特殊的三角剖分。先从Delaunay边说起：
【定义】Delaunay边：假设E中的一条边e（两个端点为a,b），e若满足下列条件，则称之为Delaunay边：存在一个圆经过a,b两点，圆内(注意是圆内，圆上最多三点共圆)不含点集V中任何其他的点，这一特性又称空圆特性。
【定义】Delaunay三角剖分：如果点集V的一个三角剖分T只包含Delaunay边，那么该三角剖分称为Delaunay三角剖分。
1.3.Delaunay三角剖分的准则 要满足Delaunay三角剖分的定义，必须符合两个重要的准则：
空圆特性：Delaunay三角网是唯一的（任意四点不能共圆），在Delaunay三角形网中任一三角形的外接圆范围内不会有其它点存在。如下图所示：
最大化最小角特性：在散点集可能形成的三角剖分中，Delaunay三角剖分所形成的三角形的最小角最大。从这个意义上讲，Delaunay三角网是“最接近于规则化的“的三角网。具体的说是指在两个相邻的三角形构成凸四边形的对角线，在相互交换后，六个内角的最小角不再增大。如下图所示：
1.4.Delaunay三角剖分的特性 以下是Delaunay剖分所具备的优异特性：
最接近：以最近临的三点形成三角形，且各线段(三角形的边)皆不相交。唯一性：不论从区域何处开始构建，最终都将得到一致的结果。最优性：任意两个相邻三角形形成的凸四边形的对角线如果可以互换的话，那么两个三角形六个内角中最小的角度不会变大。最规则：如果将三角网中的每个三角形的最小角进行升序排列，则Delaunay三角网的排列得到的数值最大。区域性：新增、删除、移动某一个顶点时只会影响临近的三角形。具有凸多边形的外壳：三角网最外层的边界形成一个凸多边形的外壳。 1.5.局部最优化处理 理论上为了构造Delaunay三角网，Lawson提出的局部优化过程LOP(Local Optimization Procedure)，一般三角网经过LOP处理，即可确保成为Delaunay三角网，其基本做法如下所示：
将两个具有共同边的三角形合成一个多边形。以最大空圆准则作检查，看其第四个顶点是否在三角形的外接圆之内。如果在，修正对角线即将对角线对调，即完成局部优化过程的处理。
LOP处理过程如下图所示： 2.Delaunay剖分的算法 Delaunay剖分是一种三角剖分的标准，实现它有多种算法。
2.1.Lawson算法 逐点插入的Lawson算法是Lawson在1977年提出的，该算法思路简单，易于编程实现。基本原理为：首先建立一个大的三角形或多边形，把所有数据点包围起来，向其中插入一点，该点与包含它的三角形三个顶点相连，形成三个新的三角形，然后逐个对它们进行空外接圆检测，同时用Lawson设计的局部优化过程LOP进行优化，即通过交换对角线的方法来保证所形成的三角网为Delaunay三角网。
上述基于散点的构网算法理论严密、唯一性好，网格满足空圆特性，较为理想。由其逐点插入的构网过程可知，遇到非Delaunay边时，通过删除调整，可以构造形成新的Delaunay边。在完成构网后，增加新点时，无需对所有的点进行重新构网，只需对新点的影响三角形范围进行局部联网，且局部联网的方法简单易行。同样，点的删除、移动也可快速动态地进行。但在实际应用当中，这种构网算法当点集较大时构网速度也较慢，如果点集范围是非凸区域或者存在内环，则会产生非法三角形。
2.2.Bowyer-Watson算法 Lawson算法的基本步骤是：
1. 构造一个超级三角形，包含所有散点，放入三角形链表。
2. 将点集中的散点依次插入，在三角形链表中找出其外接圆包含插入点的三角形（称为该点的影响三角形），删除影响三角形的公共边，将插入点同影响三角形的全部顶点连接起来，从而完成一个点在Delaunay三角形链表中的插入。
3. 根据优化准则对局部新形成的三角形进行优化。将形成的三角形放入Delaunay三角形链表。
4. 循环执行上述第2步，直到所有散点插入完毕。
这一算法的关键的第2步图示如下：
Ref:
[图形算法]Delaunay三角剖分算法
https://zhuanlan.zhihu.com/p/42331420
scipy API - scipy.spatial.Delaunay
python示例： 用 Python 实现 Delaunay Triangulation。
how-to-set-a-maximum-distance-of-a-delaunay-triangle-side 最大边长
# # http://fangs.in/post/python/pythondelaunay/ # from scipy.spatial import Delaunay import numpy as np import matplotlib." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c8249e68de6e9c8c32ad6fc3168978d6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-28T18:56:12+08:00" />
<meta property="article:modified_time" content="2020-05-28T18:56:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Delaunay三角剖分算法初探</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>Delaunay三角网在空间邻近分析上是一种较好的支持模型, 广泛应用于空间聚类、多边形群的合并、人像关键点提取、形态分析中。</p> 
<p><img src="https://images2.imgbox.com/90/a5/xlr0XKb8_o.png" alt="在这里插入图片描述"></p> 
<p>问题：一堆二维点中寻找一个与目标点最近(欧氏距离最小)的点。</p> 
<h3><a id="1_Delaunay_6"></a>1. 三角剖分与Delaunay剖分的定义</h3> 
<p>   如何把一个散点集合剖分成不均匀的三角形网格，这就是散点集的三角剖分问题，散点集的三角剖分，对数值分析以及图形学来说，都是极为重要的一项预处理技术。该问题图示如下：<br>    <img src="https://images2.imgbox.com/fc/69/P3HIwSvc_o.gif" alt="在这里插入图片描述"></p> 
<h4><a id="11__10"></a>1.1. 三角剖分定义</h4> 
<p>  【定义】<strong>三角剖分</strong>：假设V是二维实数域上的有限点集，边e是由点集中的点作为端点构成的封闭线段, E为e的集合。那么该点集V的一个三角剖分T=(V,E)是一个平面图G，该平面图满足条件：</p> 
<ol><li>除了端点，平面图中的边不包含点集中的任何点。</li><li>没有相交边。</li><li>平面图中所有的面都是三角面，且所有三角面的合集是散点集V的凸包。</li></ol> 
<h4><a id="12_Delaunay_16"></a>1.2. Delaunay三角剖分的定义</h4> 
<p>  在实际中运用的最多的三角剖分是Delaunay三角剖分，它是一种特殊的三角剖分。先从Delaunay边说起：<br>   【定义】<strong>Delaunay边</strong>：假设E中的一条边e（两个端点为a,b），e若满足下列条件，则称之为Delaunay边：存在一个圆经过a,b两点，圆内(注意是圆内，圆上最多三点共圆)不含点集V中任何其他的点，这一特性又称空圆特性。<br>   【定义】<strong>Delaunay三角剖分</strong>：如果点集V的一个三角剖分T只包含Delaunay边，那么该三角剖分称为Delaunay三角剖分。</p> 
<h4><a id="13Delaunay_20"></a>1.3.Delaunay三角剖分的准则</h4> 
<p>  要满足Delaunay三角剖分的定义，必须符合两个重要的准则：</p> 
<ol><li> <p>空圆特性：Delaunay三角网是唯一的（任意四点不能共圆），在Delaunay三角形网中任一三角形的外接圆范围内不会有其它点存在。如下图所示：<br>    <img src="https://images2.imgbox.com/54/e6/WZV7Hk3q_o.gif" alt="在这里插入图片描述"></p> </li><li> <p>最大化最小角特性：在散点集可能形成的三角剖分中，Delaunay三角剖分所形成的三角形的最小角最大。从这个意义上讲，Delaunay三角网是“最接近于规则化的“的三角网。具体的说是指在两个相邻的三角形构成凸四边形的对角线，在相互交换后，六个内角的最小角不再增大。如下图所示：</p> </li></ol> 
<p>   <img src="https://images2.imgbox.com/2a/4e/GwXV2jIy_o.gif" alt="在这里插入图片描述"></p> 
<h4><a id="14Delaunay_29"></a>1.4.Delaunay三角剖分的特性</h4> 
<p>   以下是Delaunay剖分所具备的优异特性：</p> 
<ol><li>最接近：以最近临的三点形成三角形，且各线段(三角形的边)皆不相交。</li><li>唯一性：不论从区域何处开始构建，最终都将得到一致的结果。</li><li>最优性：任意两个相邻三角形形成的凸四边形的对角线如果可以互换的话，那么两个三角形六个内角中最小的角度不会变大。</li><li>最规则：如果将三角网中的每个三角形的最小角进行升序排列，则Delaunay三角网的排列得到的数值最大。</li><li>区域性：新增、删除、移动某一个顶点时只会影响临近的三角形。</li><li>具有凸多边形的外壳：三角网最外层的边界形成一个凸多边形的外壳。</li></ol> 
<h4><a id="15_37"></a>1.5.局部最优化处理</h4> 
<p>  理论上为了构造Delaunay三角网，Lawson提出的局部优化过程LOP(Local Optimization Procedure)，一般三角网经过LOP处理，即可确保成为Delaunay三角网，其基本做法如下所示：</p> 
<ol><li>将两个具有共同边的三角形合成一个多边形。</li><li>以最大空圆准则作检查，看其第四个顶点是否在三角形的外接圆之内。</li><li>如果在，修正对角线即将对角线对调，即完成局部优化过程的处理。<br>   LOP处理过程如下图所示：</li></ol> 
<p>   <img src="https://images2.imgbox.com/6b/84/2F4jzOAF_o.gif" alt="在这里插入图片描述"></p> 
<h3><a id="2Delaunay_46"></a>2.Delaunay剖分的算法</h3> 
<p>  Delaunay剖分是一种三角剖分的标准，实现它有多种算法。</p> 
<h4><a id="21Lawson_48"></a>2.1.Lawson算法</h4> 
<p>  逐点插入的Lawson算法是Lawson在1977年提出的，该算法思路简单，易于编程实现。基本原理为：首先建立一个大的三角形或多边形，把所有数据点包围起来，向其中插入一点，该点与包含它的三角形三个顶点相连，形成三个新的三角形，然后逐个对它们进行空外接圆检测，同时用Lawson设计的局部优化过程LOP进行优化，即通过交换对角线的方法来保证所形成的三角网为Delaunay三角网。<br>   上述基于散点的构网算法理论严密、唯一性好，网格满足空圆特性，较为理想。由其逐点插入的构网过程可知，遇到非Delaunay边时，通过删除调整，可以构造形成新的Delaunay边。在完成构网后，增加新点时，无需对所有的点进行重新构网，只需对新点的影响三角形范围进行局部联网，且局部联网的方法简单易行。同样，点的删除、移动也可快速动态地进行。但在实际应用当中，这种构网算法当点集较大时构网速度也较慢，如果点集范围是非凸区域或者存在内环，则会产生非法三角形。</p> 
<h4><a id="22BowyerWatson_51"></a>2.2.Bowyer-Watson算法</h4> 
<p>  Lawson算法的基本步骤是：<br>   1. 构造一个超级三角形，包含所有散点，放入三角形链表。<br>   2. 将点集中的散点依次插入，在三角形链表中找出其外接圆包含插入点的三角形（称为该点的影响三角形），删除影响三角形的公共边，将插入点同影响三角形的全部顶点连接起来，从而完成一个点在Delaunay三角形链表中的插入。<br>   3. 根据优化准则对局部新形成的三角形进行优化。将形成的三角形放入Delaunay三角形链表。<br>   4. 循环执行上述第2步，直到所有散点插入完毕。<br>   这一算法的关键的第2步图示如下：<br> <img src="https://images2.imgbox.com/9e/e0/r5FsQ2la_o.gif" alt="在这里插入图片描述"><br> <br></p> 
<p>Ref:<br> <a href="https://www.cnblogs.com/RenLiQQ/archive/2008/02/06/1065399.html" rel="nofollow">[图形算法]Delaunay三角剖分算法</a><br> https://zhuanlan.zhihu.com/p/42331420</p> 
<p><a href="https://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.spatial.Delaunay.html" rel="nofollow">scipy API - scipy.spatial.Delaunay</a><br> <br></p> 
<hr> 
<h4><a id="python_70"></a>python示例：</h4> 
<p>用 Python 实现 Delaunay Triangulation。<br> <a href="https://stackoverflow.com/questions/50496471/how-to-set-a-maximum-distance-of-a-delaunay-triangle-side-in-python" rel="nofollow">how-to-set-a-maximum-distance-of-a-delaunay-triangle-side 最大边长</a></p> 
<pre><code class="prism language-python"><span class="token comment"># </span>
<span class="token comment"># http://fangs.in/post/python/pythondelaunay/</span>
<span class="token comment">#</span>
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>spatial <span class="token keyword">import</span> Delaunay
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># Triangle Settings</span>
width <span class="token operator">=</span> <span class="token number">100</span>
height <span class="token operator">=</span> <span class="token number">60</span>
pointNumber <span class="token operator">=</span> <span class="token number">500</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">)</span>
points <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>pointNumber<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
points<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> pointNumber<span class="token punctuation">)</span>
points<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">,</span> pointNumber<span class="token punctuation">)</span>

<span class="token comment"># Use scipy.spatial.Delaunay for Triangulation</span>
tri <span class="token operator">=</span> Delaunay<span class="token punctuation">(</span>points<span class="token punctuation">)</span>

<span class="token comment"># Plot Delaunay triangle with color filled</span>
<span class="token comment"># 每个三角的中心点</span>
center <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>points<span class="token punctuation">[</span>tri<span class="token punctuation">.</span>simplices<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3.0</span>
<span class="token comment"># 1.设置color，使距离整个点集中心越近的，颜色越深</span>
<span class="token comment"># color = np.array([(x - width/2)**2 + (y - height/2)**2 for x, y in center])</span>
<span class="token comment"># 2.设置color，使点越密集的地方，颜色越深。</span>
color_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
thresh_color <span class="token operator">=</span> <span class="token number">12</span>
<span class="token keyword">for</span> index<span class="token punctuation">,</span> sim <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>points<span class="token punctuation">[</span>tri<span class="token punctuation">.</span>simplices<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    cx<span class="token punctuation">,</span> cy <span class="token operator">=</span> center<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> center<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    x1<span class="token punctuation">,</span> y1 <span class="token operator">=</span> sim<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sim<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    x2<span class="token punctuation">,</span> y2 <span class="token operator">=</span> sim<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sim<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    x3<span class="token punctuation">,</span> y3 <span class="token operator">=</span> sim<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sim<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token comment"># s是simplices的三个顶点到中心的距离的和</span>
    s <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x1<span class="token operator">-</span>cx<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span>y1<span class="token operator">-</span>cy<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">0.5</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>cx<span class="token operator">-</span>x3<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span>cy<span class="token operator">-</span>y3<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">0.5</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>cx<span class="token operator">-</span>x2<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span>cy<span class="token operator">-</span>y2<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">0.5</span>
    <span class="token keyword">if</span> s <span class="token operator">&lt;</span> thresh_color<span class="token punctuation">:</span>
        color_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        color_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>thresh_color<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
color <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>color_list<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'color-mean'</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 三角形边长</span>
side_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
thresh_len <span class="token operator">=</span> <span class="token number">7.5</span>
long_edges <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> tr <span class="token keyword">in</span> tri<span class="token punctuation">.</span>simplices<span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        edge0 <span class="token operator">=</span> tr<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        edge1 <span class="token operator">=</span> tr<span class="token punctuation">[</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">3</span><span class="token punctuation">]</span>
        p0 <span class="token operator">=</span> points<span class="token punctuation">[</span> edge0 <span class="token punctuation">]</span>
        p1 <span class="token operator">=</span> points<span class="token punctuation">[</span> edge1 <span class="token punctuation">]</span>
        side <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>p1 <span class="token operator">-</span> p0<span class="token punctuation">)</span> <span class="token comment"># 二范数求距离</span>
        side_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>side<span class="token punctuation">)</span>
        <span class="token keyword">if</span> side <span class="token operator">&gt;</span> thresh_len<span class="token punctuation">:</span>
            long_edges<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token punctuation">(</span>edge0<span class="token punctuation">,</span> edge1<span class="token punctuation">)</span><span class="token punctuation">)</span>
len_sides <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>side_list<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>len_sides<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>len_sides<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>len_sides<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 画出三角</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>tripcolor<span class="token punctuation">(</span>points<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> points<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tri<span class="token punctuation">.</span>simplices<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> facecolors<span class="token operator">=</span>color<span class="token punctuation">,</span> edgecolors<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">)</span>
<span class="token comment"># plt.scatter(points[:,0],points[:,1], color='r')</span>
<span class="token comment"># 画出边长较大的三角的顶点</span>
<span class="token keyword">for</span> a<span class="token punctuation">,</span>b <span class="token keyword">in</span> long_edges<span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>points<span class="token punctuation">[</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span>b<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> points<span class="token punctuation">[</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span>b<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">)</span>

<span class="token comment"># ======================================</span>
ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>gca<span class="token punctuation">(</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>spines<span class="token punctuation">[</span><span class="token string">'right'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_color<span class="token punctuation">(</span><span class="token string">'none'</span><span class="token punctuation">)</span>
<span class="token comment"># ax.spines['bottom'].set_color('none')</span>
<span class="token comment"># ax.spines['left'].set_color('none')</span>
ax<span class="token punctuation">.</span>spines<span class="token punctuation">[</span><span class="token string">'top'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_color<span class="token punctuation">(</span><span class="token string">'none'</span><span class="token punctuation">)</span>

<span class="token comment"># Save picture</span>
<span class="token comment"># plt.savefig('Delaunay1.png', transparent=True, dpi=600)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<p>输出图片：<br> <img src="https://images2.imgbox.com/b3/42/b2yV2X7k_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1946fd3069d3ef658b10fca2f88ffc2e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">R语言学习9-读取表格数据</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/27d2c0087979f4e691d8d88367492b7a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">shiro笔记之----SimpleAuthenticationInfo 验证password</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>