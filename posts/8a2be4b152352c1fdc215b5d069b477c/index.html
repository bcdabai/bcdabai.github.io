<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>代码在线编辑codemirror在React中使用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="代码在线编辑codemirror在React中使用" />
<meta property="og:description" content="初次学习codemirror笔记，下附完整代码
成果图
安装
yarn add codemirror 引入
import CodeMirror from &#39;codemirror&#39;; import &#39;codemirror/lib/codemirror.css&#39; options配置 1.行号 lineNumbers:true//是否显示左侧行号 firstLineNumber: 1//从哪个数字开始计数行。默认值为 1。 2.编码模式
模式可查看 https://codemirror.net/mode/
import &#34;codemirror/mode/python/python.js&#34;; mode: &#34;python&#34;, // 要使用的模式//https://codemirror.net/mode/ 3.滚动和换行
lineWrapping: true,//滚动或换行 scrollbarStyle: null,//滚动条样式，为null时隐藏滚动条 4.主题
//引入主题文件（可选择自己喜欢的） import &#39;codemirror/theme/material.css&#39;; import &#39;codemirror/theme/solarized.css&#39; //options中配置 theme: &#39;material&#39;,//主题 5.代码折叠
// 引入 import &#39;codemirror/addon/fold/foldgutter.css&#39;; import &#39;codemirror/addon/fold/foldcode.js&#39;; import &#39;codemirror/addon/fold/foldgutter.js&#39;; import &#39;codemirror/addon/fold/brace-fold.js&#39;; import &#39;codemirror/addon/fold/comment-fold.js&#39;; import &#39;codemirror/addon/fold/indent-fold.js&#39;; //options中配置 // 在行槽中添加行号显示器、折叠器、语法检测器 gutters: [&#34;CodeMirror-linenumbers&#34;, &#34;CodeMirror-foldgutter&#34;, &#34;CodeMirror-lint-markers&#34;], foldGutter: true, // 启用行槽中的代码折叠 6.缩进" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/8a2be4b152352c1fdc215b5d069b477c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-29T10:27:11+08:00" />
<meta property="article:modified_time" content="2021-09-29T10:27:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">代码在线编辑codemirror在React中使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>初次学习codemirror笔记，下附完整代码</strong></p> 
<p><strong>成果图</strong></p> 
<p style="text-align:center;"><strong><img alt="" height="640" src="https://images2.imgbox.com/b0/15/7ZFI3trm_o.png" width="1009"></strong></p> 
<p><strong>安装</strong></p> 
<pre><code class="language-javascript">yarn add codemirror</code></pre> 
<p><strong> 引入</strong></p> 
<pre><code>import CodeMirror from 'codemirror';
import 'codemirror/lib/codemirror.css'</code></pre> 
<p> </p> 
<h3><strong>options配置</strong></h3> 
<h4>1.行号</h4> 
<pre><code>lineNumbers:true//是否显示左侧行号
firstLineNumber: 1//从哪个数字开始计数行。默认值为 1。
</code></pre> 
<p><strong>2.编码模式</strong></p> 
<p>  模式可查看  https://codemirror.net/mode/</p> 
<pre><code>import "codemirror/mode/python/python.js";
 
mode: "python", // 要使用的模式//https://codemirror.net/mode/</code></pre> 
<p><strong>3.滚动和换行</strong></p> 
<pre><code> lineWrapping: true,//滚动或换行
 scrollbarStyle: null,//滚动条样式，为null时隐藏滚动条</code></pre> 
<p><strong>4.主题</strong></p> 
<pre><code>//引入主题文件（可选择自己喜欢的）
import 'codemirror/theme/material.css';
import 'codemirror/theme/solarized.css'

//options中配置
theme: 'material',//主题</code></pre> 
<p><strong> 5.代码折叠</strong></p> 
<pre><code>// 引入
import 'codemirror/addon/fold/foldgutter.css';
import 'codemirror/addon/fold/foldcode.js';
import 'codemirror/addon/fold/foldgutter.js';
import 'codemirror/addon/fold/brace-fold.js';
import 'codemirror/addon/fold/comment-fold.js';
import 'codemirror/addon/fold/indent-fold.js';

//options中配置
// 在行槽中添加行号显示器、折叠器、语法检测器
gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter", "CodeMirror-lint-markers"],
foldGutter: true, // 启用行槽中的代码折叠</code></pre> 
<p><strong>6.缩进</strong></p> 
<pre><code>tabSize: 2, //tab键缩进,默认4
smartIndent: true, // 智能缩进
indentUnit: 2, // 智能缩进单位为2个空格长度
indentWithTabs: true//Whether, when indenting, the first N*tabSize spaces should be replaced by N tabs. Default is false.没看明白😅</code></pre> 
<p><strong>7.选中行高亮</strong></p> 
<pre><code>//引入
import "codemirror/addon/selection/active-line.js";

options中配置
styleActiveLine: true, // 显示选中行的样式</code></pre> 
<p><strong>8.括号匹配以及自动补全</strong></p> 
<pre><code>// 括号匹配
import "codemirror/addon/edit/closebrackets.js";
import "codemirror/addon/edit/matchbrackets.js";

//options中配置
matchBrackets: true,	//括号匹配
autoCloseBrackets: true,//括号自动补全</code></pre> 
<p><strong> 9.代码提示级自动补全</strong></p> 
<pre><code>// 代码提示
import 'codemirror/addon/hint/show-hint.css'; //
import 'codemirror/addon/hint/show-hint.js';
import 'codemirror/addon/hint/anyword-hint.js'; // 简单提示，按需引入，spl可引入sql-hint.js

//代码提示自动补全功能
myCodeMirror.on("keypress", function () {//代码补全功能
   myCodeMirror.showHint();
});

//如果未选择提示代码，会默认选中第一个补全代码，emmmm.....
//可在options中配置以下代码，默认不补全，只提示
hintOptions: {
   completeSingle: false//代码自动补全功能不默认补充
},</code></pre> 
<hr> 
<p><strong>完整代码</strong></p> 
<pre><code>import React, { useEffect, useState } from 'react'
import axios from 'axios';

import CodeMirror from 'codemirror';
import 'codemirror/lib/codemirror.css'
//主题
import 'codemirror/theme/material.css';
import 'codemirror/theme/solarized.css'
// 折叠代码
import 'codemirror/addon/fold/foldgutter.css';
import 'codemirror/addon/fold/foldcode.js';
import 'codemirror/addon/fold/foldgutter.js';
import 'codemirror/addon/fold/brace-fold.js';
import 'codemirror/addon/fold/comment-fold.js';
import 'codemirror/addon/fold/indent-fold.js';

// 代码提示
import 'codemirror/addon/hint/show-hint.css'; //
import 'codemirror/addon/hint/show-hint.js';
import 'codemirror/addon/hint/anyword-hint.js'; // 简单提示，按需引入，spl可引入sql-hint.js

import "codemirror/addon/comment/comment.js";
// 高亮
import "codemirror/addon/selection/active-line.js";

// python语言
import "codemirror/mode/python/python.js";

// 括号匹配
import "codemirror/addon/edit/closebrackets.js";
import "codemirror/addon/edit/matchbrackets.js";

import 'codemirror/addon/lint/lint.js'
import 'codemirror/addon/lint/javascript-lint.js'

import Style from './OnlineEdit.module.css'
import { Button } from 'antd';

let myCodeMirror;
export default function OnlineEdit() {
    const [submitResult, setSubmitResult] = useState('')
    // 初始化编辑器
    useEffect(() =&gt; {
        const textArea = document.getElementById("editor");
        myCodeMirror = CodeMirror.fromTextArea(textArea, {
            theme: 'material',//主题
            lineNumbers: true,//显示行号
            firstLineNumber: 1,//行号从几开始，默认1
            lineWrapping: true,//滚动或换行
            scrollbarStyle: null,//隐藏滚动条样式
            tabSize: 2, //tab键缩进,默认4
            smartIndent: true, // 智能缩进
            indentUnit: 2, // 智能缩进单位为2个空格长度
            indentWithTabs: true, // 使用制表符进行智能缩进
            autofocus: true,//自动获取焦点
            // 在行槽中添加行号显示器、折叠器、语法检测器
            gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter", "CodeMirror-lint-markers"],
            foldGutter: true, // 启用行槽中的代码折叠
            mode: "python", // 要使用的模式//https://codemirror.net/mode/
            styleActiveLine: true, // 显示选中行的样式
            matchBrackets: true,	//括号匹配
            autoCloseBrackets: true,//括号自动补全，()[]{}''""
            hintOptions: {
                completeSingle: false//代码自动补全功能不默认补充
            },
        });
        myCodeMirror.setOption("value", 'print("hello word")');//初始值
        myCodeMirror.on("keypress", function () {//代码补全功能
            myCodeMirror.showHint();
        });
        myCodeMirror.setSize('40vw', '50vh');//编辑框大小(宽，高)
    }, [])

    // 将值传给后端，后端返回运行结果
    function runFunction() {
        axios({
            method: 'post',
            url: 'http://192.168.2.139:7000/edit_api/edit',
            params: {
                code: myCodeMirror.getValue()
            },
            // timeout: 5000,
        }).then(function (res) {
            console.log('3:', res)
            if (res.data.code === 0) {
                setSubmitResult(res.data.data.output)
            }
        }).catch(function (error) {
            console.log(error);
        })
    }

    return (
        &lt;div className={Style.mainWrapper}&gt;
            &lt;div className={Style.leftWrapper}&gt;
                &lt;div className={Style.codeTop}&gt;
                    &lt;Button onClick={runFunction} type='primary' &gt;运行&lt;/Button&gt;
                &lt;/div&gt;
                &lt;textarea id="editor"&gt;&lt;/textarea&gt;
            &lt;/div&gt;
            &lt;div className={Style.rightWrapper}&gt;
                &lt;div className={Style.codeTop}&gt;
                    &lt;p&gt;运行结果&lt;/p&gt;
                &lt;/div&gt;
                &lt;div className={Style.codeResult}&gt;
                    &lt;div&gt;{submitResult}&lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;

        &lt;/div&gt;
    )
}

</code></pre> 
<p>css样式</p> 
<pre><code>.mainWrapper {
    height: 100vh;
    width: 100vw;
    padding: 0px 10vw;
    display: flex;
    /* justify-content: center; */
    align-items: center;
}

.leftWrapper {
    width: 40vw;
    height: 55vh;
}

.rightWrapper {
    width: 40vw;
    height: 55vh;
}

.codeTop {
    height: 5vh;
}

.codeTop p {
    font-weight: 600;
    font-size: 2vh;
}

.codeResult {
    height: 50vh;
    background-color: #263238;
    border-left: 1px solid white;
    /* 识别\n换行 */
    white-space: pre-line;
    padding: 2vh 2vw;
    overflow-y: auto;
    color: white;
}</code></pre> 
<hr> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ba386a7e5e8fdb54051628f38e843f94/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Windows RPC 初体验</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4a0de5143d093b6b677dac0a9b383ffc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Verilog简介</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>