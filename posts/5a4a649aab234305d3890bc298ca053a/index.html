<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【深度学习】使用深度学习检测混凝土结构中的表面裂缝 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【深度学习】使用深度学习检测混凝土结构中的表面裂缝" />
<meta property="og:description" content="混凝土建筑裂缝
介绍
表面裂缝检测是监测混凝土结构健康的一项重要任务。如果裂纹发展并继续扩展，它们会减少有效承载表面积，并且随着时间的推移会导致结构失效。裂纹检测的人工过程费时费力，且受检验人员主观判断的影响。在高层建筑和桥梁的情况下，手动检查也可能难以执行。在这篇文章中，我们使用深度学习来构建一个简单但非常准确的裂缝检测模型。此外，我们在现实世界的数据上测试了模型，发现该模型在检测混凝土和非混凝土结构示例道路中的表面裂缝方面是准确的。该代码在Github上的链接上开源。
数据集
在这篇文章中，我们使用了公开可用的混凝土裂缝图像数据集，该数据集由 20,000 张有裂缝的混凝土结构图像和 20,000 张无裂缝的图像组成。该数据集由 458 张高分辨率图像（4032x3024 像素）生成。数据集中的每个图像都是 227 x 227 像素的 RGB 图像。部分有裂纹和无裂纹的示例图如下所示：
带有裂纹的示例图像
没有裂纹的示例图像
可以看出，数据集有各种各样的图像——不同颜色、不同强度和形状的裂缝。
建立模型
对于这个问题，让我们在 Pytorch 中构建一个卷积神经网络（CNN）。由于我们的图像数量有限，因此我们将使用预训练的网络作为起点，并使用图像增强功能来进一步提高准确性。图像增强使我们能够进行诸如垂直和水平翻转、旋转和亮度变化之类的转换，从而显着增加样本并帮助模型泛化。
对于以下步骤，请参考我在 Github 上的代码。
将输入数据混洗并拆分为 Train 和 Val
下载的数据将有 2 个文件夹，一个用于正样本文件夹，一个用于负样本文件夹，我们需要将其拆分为 train 和 val。下面的代码片段将为 train 和 val 创建新文件夹，并将 85% 的数据随机混洗到 train 中，并将其余数据随机放入 val 中。
拆分为 train 和 val
应用转换
Pytorch 可以轻松应用数据转换，这可以增强训练数据并帮助模型提高泛化性。我们选择的转换是随机旋转、随机水平和垂直翻转以及随机颜色抖动。此外，每个通道除以 255，然后归一化，这有助于神经网络训练。
转变
预训练模型
我们使用在 ImageNet 上经过预训练的 Resnet 50 模型来快速启动模型。如下所示，ResNet50 模型由 5 个阶段组成，每个阶段都有一个卷积和 Identity 块。每个卷积块有 3 个卷积层，每个标识块也有 3 个卷积层。ResNet-50 有超过 2300 万个可训练参数。我们将冻结所有这些权重和 2 个全连接的层——第一层在输出中有 128 个神经元，第二层在输出中有 2 个神经元，这是最终的预测。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/5a4a649aab234305d3890bc298ca053a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-27T12:00:00+08:00" />
<meta property="article:modified_time" content="2021-11-27T12:00:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【深度学习】使用深度学习检测混凝土结构中的表面裂缝</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/1c/0e/Gn2VVrF9_o.png" alt="c97bffbcda657e195fb1fc8163e16c14.png"></p> 
 <p style="text-align:center;">混凝土建筑裂缝</p> 
 <h2><br></h2> 
 <p><strong>介绍</strong></p> 
 <p>表面裂缝检测是监测混凝土结构健康的一项重要任务。如果裂纹发展并继续扩展，它们会减少有效承载表面积，并且随着时间的推移会导致结构失效。裂纹检测的人工过程费时费力，且受检验人员主观判断的影响。在高层建筑和桥梁的情况下，手动检查也可能难以执行。在这篇文章中，我们使用深度学习来构建一个简单但非常准确的裂缝检测模型。此外，我们在现实世界的数据上测试了模型，发现该模型在检测混凝土和非混凝土结构示例道路中的表面裂缝方面是准确的。该代码在Github上的链接上开源。</p> 
 <p><strong>数据集</strong></p> 
 <p>在这篇文章中，我们使用了公开可用的混凝土裂缝图像数据集，该数据集由 20,000 张有裂缝的混凝土结构图像和 20,000 张无裂缝的图像组成。该数据集由 458 张高分辨率图像（4032x3024 像素）生成。数据集中的每个图像都是 227 x 227 像素的 RGB 图像。部分有裂纹和无裂纹的示例图如下所示：</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/0b/aa/B9NGh1Rd_o.png" alt="2804b5c901c483b41aefda29ba69ca2c.png"></p> 
 <p style="text-align:center;">带有裂纹的示例图像</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/55/1a/DOXlgCBt_o.png" alt="9fc160cdf6211d50745436a9dbd85a13.png">没有裂纹的示例图像</p> 
 <p>可以看出，数据集有各种各样的图像——不同颜色、不同强度和形状的裂缝。</p> 
 <p><strong>建立模型</strong></p> 
 <p>对于这个问题，让我们在 Pytorch 中构建一个卷积神经网络（CNN）。由于我们的图像数量有限，因此我们将使用预训练的网络作为起点，并使用图像增强功能来进一步提高准确性。图像增强使我们能够进行诸如垂直和水平翻转、旋转和亮度变化之类的转换，从而显着增加样本并帮助模型泛化。</p> 
 <p>对于以下步骤，请参考我在 Github 上的代码。</p> 
 <p><strong>将输入数据混洗并拆分为 Train 和 Val</strong></p> 
 <p>下载的数据将有 2 个文件夹，一个用于正样本文件夹，一个用于负样本文件夹，我们需要将其拆分为 train 和 val。下面的代码片段将为 train 和 val 创建新文件夹，并将 85% 的数据随机混洗到 train 中，并将其余数据随机放入 val 中。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/2b/dc/OADLgG7p_o.png" alt="91b627d38cc392536c92dfece4d052c0.png"></p> 
 <p style="text-align:center;">拆分为 train 和 val<br></p> 
 <p><strong>应用转换</strong></p> 
 <p>Pytorch 可以轻松应用数据转换，这可以增强训练数据并帮助模型提高泛化性。我们选择的转换是随机旋转、随机水平和垂直翻转以及随机颜色抖动。此外，每个通道除以 255，然后归一化，这有助于神经网络训练。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/b7/21/NPeZRInV_o.png" alt="835e5e69d00a88a313f10fc4f3ca33d8.png"></p> 
 <p style="text-align:center;">转变</p> 
 <p><strong>预训练模型</strong></p> 
 <p>我们使用在 ImageNet 上经过预训练的 Resnet 50 模型来快速启动模型。如下所示，ResNet50 模型由 5 个阶段组成，每个阶段都有一个卷积和 Identity 块。每个卷积块有 3 个卷积层，每个标识块也有 3 个卷积层。ResNet-50 有超过 2300 万个可训练参数。我们将冻结所有这些权重和 2 个全连接的层——第一层在输出中有 128 个神经元，第二层在输出中有 2 个神经元，这是最终的预测。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/ab/b7/SSl2elzW_o.png" alt="261bb56430019ed259d85ef53c17e587.png">ResNet50 模型</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/b9/de/yrXHr6m1_o.png" alt="d7974d7c36b755e42b5ec2fd162d22ab.png"></p> 
 <p style="text-align:center;">ResNet 模型层</p> 
 <p>如模型摘要所示，该模型有 2300 万个不可训练参数和 262K 个可训练参数</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/19/13/xTuGrvU3_o.png" alt="82a6ca3587226d79a7c5b56070133c50.png"></p> 
 <p style="text-align:center;">模型参数</p> 
 <p>我们使用 Adam 作为优化程序并训练模型 6 个 epoch。</p> 
 <h2><br></h2> 
 <p><strong>真实图像上的模型训练和预测</strong></p> 
 <p>我们用迁移学习训练，然后在训练数据集模型，同时在验证集上测量损失和准确性。如下面的损失和准确率数字所示，模型训练的非常快。在第 1 个 epoch 之后，训练准确率为 87%，验证准确率为 97%！这就是迁移学习的力量，我们的最终模型的验证准确率为 98.4%。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/a3/fb/c8CPaQca_o.png" alt="dc42429db1b088d33a291a04a7c3d47c.png"></p> 
 <p style="text-align:center;">模型训练统计</p> 
 <p><strong>在真实图像上测试模型</strong></p> 
 <p>现在是最有趣的部分。是的，该模型适用于验证数据，但我们希望确保它也适用于互联网上看不见的数据。为了测试这一点，我们随机拍摄了混凝土开裂结构和路面裂缝的图像，这些图像比我们的训练图像大得多。请记住，该模型是在 227,227 像素的切片上训练的。我们现在将输入图像分成小块并对其进行预测。如果模型预测有裂纹，我们将补丁涂成红色（有裂纹），否则将补丁涂成绿色。以下代码片段将执行此操作。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/ad/a9/1HkBD0In_o.png" alt="9e6c3be19bf16638ea93457edc4976ca.png">切片预测</p> 
 <p>该模型在从未见过的图像上效果非常好。如下图所示，该模型能够通过处理图像上的 100 多个补丁来检测混凝土中很长的裂缝。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/31/f1/Mn5amba2_o.png" alt="77adf8c0b57f4f612509900237484b03.png">混凝土裂缝检测。左原图。右侧红色区域是有裂纹的预测，绿色区域是无裂纹的预测</p> 
 <p>此外，也在道路裂缝上测试了该模型。这个模型没有在路面数据集上训练过，但在识别道路裂缝方面也做得很好！</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/08/58/KDMcnsh5_o.png" alt="19cd832a1308714f91c94a5b81586d4c.png">道路裂缝检测。左原图。右侧红色区域是有裂纹的预测，绿色区域是无裂纹的预测</p> 
 <p>在此项目的 github 链接上共享了更多现实世界图像以及有关它们的模型预测。</p> 
 <h2><br></h2> 
 <p><strong>结论</strong></p> 
 <p>这篇文章展示了使用深度学习和开源数据构建现实世界的应用程序变得多么容易。整个工作花了半天时间，输出了一个实用的解决方案。我希望小伙伴们自己尝试这个代码，并在更多现实世界的图像上进行测试。</p> 
 <p><strong>参考</strong></p> 
 <ul><li><p>2018 — Özgenel, Ç.F., Gönenç Sorguç, A. “Performance Comparison of Pretrained Convolutional Neural Networks on Crack Detection in Buildings”, ISARC 2018, Berlin.</p></li><li><p>Good paper on importance of crack detection — https://www.hindawi.com/journals/ace/2018/3924120/</p></li><li><p>Good blog on Image Classification in Pytorch. Several of the code snippets used in the blog were from here.</p></li><li><p>Another good blog on Image Classification in Pytorch. Several of the code snippets used in the blog were from here.</p></li></ul> 
 <p>Github代码连接：<br></p> 
 <ol><li><p>https://github.com/priya-dwivedi/Deep-Learning/tree/master/crack_detection</p></li><li><p style="text-align:left;">https://github.com/priya-dwivedi/Deep-Learning/blob/master/crack_detection/Crack%20Detection%20Model.ipynb</p></li><li><p style="text-align:left;">https://github.com/priya-dwivedi/Deep-Learning/tree/master/crack_detection/real_images</p></li></ol> 
 <img src="https://images2.imgbox.com/5d/fe/e5CwyW7b_o.png" alt="cba8c1ac637a646615d30f00f0c5e2db.png"> 
 <pre></pre> 
 <pre></pre> 
 <pre></pre> 
 <pre></pre> 
 <pre class="has"><code class="language-go">往期精彩回顾




适合初学者入门人工智能的路线及资料下载机器学习及深度学习笔记等资料打印机器学习在线手册深度学习笔记专辑《统计学习方法》的代码复现专辑
AI基础下载黄海广老师《机器学习课程》视频课黄海广老师《机器学习课程》711页完整版课件</code></pre> 
 <p style="text-align:left;">本站qq群955171419，加入微信群请扫码：</p> 
 <p><img src="https://images2.imgbox.com/e6/5c/8lUi9Wj0_o.png" alt="acf6d2d3f9288da02ed67e12503a84af.png"></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6f99f47b2ca5bc6e417cd3454ff951c6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">03 完善shutil.move 和shutil.copytree</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4802948fb80364203bbf5352938fe710/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">GAMES101作业（05）- 光线与三角形相交（Moller Trumbore算法）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>