<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>华为云contos7系统部署ES集群--3个主节点 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="华为云contos7系统部署ES集群--3个主节点" />
<meta property="og:description" content="目录
前言：
Elasticsearch
Logstash
Kibana
Beats
一、集群部署
1.ES集群的基本核心概念
二、搭建步骤
1、基础环境配置
2、修改ES配置文件elasticsearch.yml
3. 其它配置文件
4.启动es
5.验证ES集群：
三、安装Kibana
1.获取到安装包
2.配置yum源：
3.修改配置文件kibana.yml：
4.开启端口5601:
5.启动kibana:
四、华为云使用问题总结：
1.怎样登录服务器Linux控制台
2.怎样上传文件：
五、参考文章：
前言： 首先要有一个全面的认识，什么是ELK？
Elastic Stack也就是ELK,ELK是三款软件的集合，分别是Elasticsearch，logstas，Kibana，在发展过程中，有了新的成员Beats加入,所以就形成了Elastic Starck.也是就是说ELK是旧的称呼，Elastic Stack是新的名字。
先通过Beats采集一切的数据如日志文件，网络流量，Win事件日志，服务指标，健康检查等，然后把数据发送给elasticsearch保存起来，也可以发送给logstas处理然后再发送给elasticsearch,最后通过kibana的组件将数据可视化的展示出来。
Elasticsearch Elasticsearch基于java,是个开源分布式手术引擎，它的特点有：分布式，零配置，自动发现，索引自动分片，索引副本机制，restful风格接口，多数据源，自动搜索负载等。
Logstash 也是基于java,是一个开源的用于收集，分析和存储日志的工具。
Kibana Kibana基于nodejs，也是开源和免费的工具，Kibana开源为logsash和Elasticsearch提供日志分析友好的web界面，可以汇总，分析和搜索重要的数据日志。
Beats Bests是elastic公司开源的一款采集系统监控数据的代理agent，是在被监控服务器上以客户端形式运行的数据收集器的统称，可以直接把数据发送给Elasticsearch或者通过Logstash发送给Elasticsearch,然后进行后续的数据分析活动
ELK官网：
直接从官网下载ELK的所有安装包
Free and Open Search: The Creators of Elasticsearch, ELK &amp; Kibana | Elastic
Note: 怎样部署ELK？
ELK需要使用单独的机器部署，为什么？ 因为ELK不涉及业务，而且日志量大 会占用业务的资源，所以需要单独部署。
一、集群部署 1.ES集群的基本核心概念 Cluster集群
一个ElasticSearch集群由一个或多个节点(Node)组成，每个集群都有一个共同的集群名称作为标识。
Node节点
一个ElasticSearch实例即一个Node，一台机器可以有多个实例，正常使用下每个实例应该会部署在不同机器上。ElasticSearch的配置文件中可以通过node.master、node.data来设置节点类型。
node.master参数：表示节点是否具有成为主节点的资格
true代表的是有资格竞选主节点false代表的是没有资格竞选主节点 node.data参数：表示节点是否存储数据" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c81522f1706fcae70dd1e2a926a272a0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-27T14:14:50+08:00" />
<meta property="article:modified_time" content="2022-01-27T14:14:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">华为云contos7系统部署ES集群--3个主节点</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%89%8D%E8%A8%80%EF%BC%9A-toc" style="margin-left:40px;"><a href="#%E5%89%8D%E8%A8%80%EF%BC%9A" rel="nofollow">前言：</a></p> 
<p id="Elasticsearch-toc" style="margin-left:80px;"><a href="#Elasticsearch" rel="nofollow">Elasticsearch</a></p> 
<p id="Logstash-toc" style="margin-left:80px;"><a href="#Logstash" rel="nofollow">Logstash</a></p> 
<p id="Kibana-toc" style="margin-left:80px;"><a href="#Kibana" rel="nofollow">Kibana</a></p> 
<p id="Beats-toc" style="margin-left:80px;"><a href="#Beats" rel="nofollow">Beats</a></p> 
<p id="%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2-toc" style="margin-left:40px;"><a href="#%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2" rel="nofollow">一、集群部署</a></p> 
<p id="1.ES%E9%9B%86%E7%BE%A4%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5-toc" style="margin-left:80px;"><a href="#1.ES%E9%9B%86%E7%BE%A4%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5" rel="nofollow">1.ES集群的基本核心概念</a></p> 
<p id="%E4%BA%8C%E3%80%81%E6%90%AD%E5%BB%BA%E6%AD%A5%E9%AA%A4-toc" style="margin-left:40px;"><a href="#%E4%BA%8C%E3%80%81%E6%90%AD%E5%BB%BA%E6%AD%A5%E9%AA%A4" rel="nofollow">二、搭建步骤</a></p> 
<p id="1%E3%80%81%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-toc" style="margin-left:80px;"><a href="#1%E3%80%81%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE" rel="nofollow">1、基础环境配置</a></p> 
<p id="2%E3%80%81%E4%BF%AE%E6%94%B9ES%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6elasticsearch.yml-toc" style="margin-left:80px;"><a href="#2%E3%80%81%E4%BF%AE%E6%94%B9ES%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6elasticsearch.yml" rel="nofollow">2、修改ES配置文件elasticsearch.yml</a></p> 
<p id="3.%20%E5%85%B6%E5%AE%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-toc" style="margin-left:80px;"><a href="#3.%20%E5%85%B6%E5%AE%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" rel="nofollow">3. 其它配置文件</a></p> 
<p id="4.%E5%90%AF%E5%8A%A8es-toc" style="margin-left:80px;"><a href="#4.%E5%90%AF%E5%8A%A8es" rel="nofollow">4.启动es</a></p> 
<p id="5.%E6%B5%8F%E8%A7%88%E5%99%A8%E8%AE%BF%E9%97%AEES%EF%BC%9A-toc" style="margin-left:80px;"><a href="#5.%E6%B5%8F%E8%A7%88%E5%99%A8%E8%AE%BF%E9%97%AEES%EF%BC%9A" rel="nofollow">5.验证ES集群：</a></p> 
<p id="%E4%B8%89%E3%80%81%E5%AE%89%E8%A3%85Kibana-toc" style="margin-left:40px;"><a href="#%E4%B8%89%E3%80%81%E5%AE%89%E8%A3%85Kibana" rel="nofollow">三、安装Kibana</a></p> 
<p id="1.%E8%8E%B7%E5%8F%96%E5%88%B0%E5%AE%89%E8%A3%85%E5%8C%85-toc" style="margin-left:80px;"><a href="#1.%E8%8E%B7%E5%8F%96%E5%88%B0%E5%AE%89%E8%A3%85%E5%8C%85" rel="nofollow">1.获取到安装包</a></p> 
<p id="2.%E9%85%8D%E7%BD%AEyum%E6%BA%90%EF%BC%9A-toc" style="margin-left:80px;"><a href="#2.%E9%85%8D%E7%BD%AEyum%E6%BA%90%EF%BC%9A" rel="nofollow">2.配置yum源：</a></p> 
<p id="3.%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6kibana.yml%EF%BC%9A-toc" style="margin-left:80px;"><a href="#3.%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6kibana.yml%EF%BC%9A" rel="nofollow">3.修改配置文件kibana.yml：</a></p> 
<p id="4.%E5%BC%80%E5%90%AF%E7%AB%AF%E5%8F%A35601%3A-toc" style="margin-left:80px;"><a href="#4.%E5%BC%80%E5%90%AF%E7%AB%AF%E5%8F%A35601%3A" rel="nofollow">4.开启端口5601:</a></p> 
<p id="5.%E5%90%AF%E5%8A%A8kibana%3A-toc" style="margin-left:80px;"><a href="#5.%E5%90%AF%E5%8A%A8kibana%3A" rel="nofollow">5.启动kibana:</a></p> 
<p id="%E5%9B%9B%E3%80%81%E5%8D%8E%E4%B8%BA%E4%BA%91%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93%EF%BC%9A-toc" style="margin-left:40px;"><a href="#%E5%9B%9B%E3%80%81%E5%8D%8E%E4%B8%BA%E4%BA%91%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93%EF%BC%9A" rel="nofollow">四、华为云使用问题总结：</a></p> 
<p id="1.%E6%80%8E%E6%A0%B7%E7%99%BB%E5%BD%95%E6%9C%8D%E5%8A%A1%E5%99%A8Linux%E6%8E%A7%E5%88%B6%E5%8F%B0-toc" style="margin-left:80px;"><a href="#1.%E6%80%8E%E6%A0%B7%E7%99%BB%E5%BD%95%E6%9C%8D%E5%8A%A1%E5%99%A8Linux%E6%8E%A7%E5%88%B6%E5%8F%B0" rel="nofollow">1.怎样登录服务器Linux控制台</a></p> 
<p id="%C2%A02.%E6%80%8E%E6%A0%B7%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%C2%A02.%E6%80%8E%E6%A0%B7%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%EF%BC%9A" rel="nofollow"> 2.怎样上传文件：</a></p> 
<p id="%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0%EF%BC%9A-toc" style="margin-left:40px;"><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0%EF%BC%9A" rel="nofollow">五、参考文章：</a></p> 
<hr id="hr-toc"> 
<h3 id="%E5%89%8D%E8%A8%80%EF%BC%9A">前言：</h3> 
<p><strong>首先要有一个全面的认识，什么是ELK？</strong></p> 
<p>Elastic Stack也就是ELK,ELK是三款软件的集合，分别是<span style="color:#fe2c24;"><strong>Elasticsearch</strong></span><span style="color:#0d0016;"><strong>，</strong></span>logstas，Kibana，在发展过程中，有了新的成员Beats加入,所以就形成了Elastic Starck.也是就是说ELK是旧的称呼，Elastic Stack是新的名字。</p> 
<p>先通过Beats采集一切的数据如日志文件，网络流量，Win事件日志，服务指标，健康检查等，然后把数据发送给elasticsearch保存起来，也可以发送给logstas处理然后再发送给elasticsearch,最后通过kibana的组件将数据可视化的展示出来。</p> 
<h4 id="Elasticsearch"><strong>Elasticsearch</strong></h4> 
<p>Elasticsearch基于java,是个开源分布式手术引擎，它的特点有：分布式，零配置，自动发现，索引自动分片，索引副本机制，restful风格接口，多数据源，自动搜索负载等。</p> 
<h4 id="Logstash"><strong>Logstash</strong></h4> 
<p>也是基于java,是一个开源的用于收集，分析和存储日志的工具。</p> 
<h4 id="Kibana"><strong>Kibana</strong></h4> 
<p>Kibana基于nodejs，也是开源和免费的工具，Kibana开源为logsash和Elasticsearch提供日志分析友好的web界面，可以汇总，分析和搜索重要的数据日志。</p> 
<h4 id="Beats"><strong>Beats</strong></h4> 
<p>Bests是elastic公司开源的一款采集系统监控数据的代理agent，是在被监控服务器上以客户端形式运行的数据收集器的统称，可以直接把数据发送给Elasticsearch或者通过Logstash发送给Elasticsearch,然后进行后续的数据分析活动</p> 
<p><strong>ELK官网：</strong></p> 
<p>直接从官网下载ELK的所有安装包</p> 
<p><a href="https://www.elastic.co/" rel="nofollow" title="Free and Open Search: The Creators of Elasticsearch, ELK &amp; Kibana | Elastic">Free and Open Search: The Creators of Elasticsearch, ELK &amp; Kibana | Elastic</a></p> 
<blockquote> 
 <p><span style="color:#fe2c24;"><strong>Note: 怎样部署ELK？</strong></span></p> 
 <p>ELK需要使用单独的机器部署，为什么？ 因为ELK不涉及业务，而且日志量大  会占用业务的资源，所以需要<span style="color:#fe2c24;">单独部署</span>。</p> 
</blockquote> 
<h3 id="%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2">一、集群部署</h3> 
<h4 id="1.ES%E9%9B%86%E7%BE%A4%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5">1.ES集群的基本核心概念</h4> 
<p><strong>Cluster集群</strong><br> 　　一个ElasticSearch集群由一个或多个节点(Node)组成，每个集群都有一个共同的集群名称作为标识。<br><strong>Node节点</strong><br> 　　一个ElasticSearch实例即一个Node，一台机器可以有多个实例，正常使用下每个实例应该会部署在不同机器上。ElasticSearch的配置文件中可以通过node.master、node.data来设置节点类型。<br> node.master参数：表示节点是否具有成为主节点的资格</p> 
<ul><li>true代表的是有资格竞选主节点</li><li>false代表的是没有资格竞选主节点</li></ul> 
<p>node.data参数：表示节点是否存储数据</p> 
<h3 id="%E4%BA%8C%E3%80%81%E6%90%AD%E5%BB%BA%E6%AD%A5%E9%AA%A4">二、搭建步骤</h3> 
<p><span style="color:#4da8ee;"><strong>本文所用ES版本，elasticsearch-7.8.1-linux-x86_64.tar </strong></span></p> 
<h4 id="1%E3%80%81%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE">1、基础环境配置</h4> 
<p><strong>添加用户</strong></p> 
<p>出于安全的考虑，elasticsearch不允许使用root用户来启动，所以需要创建一个新的用户，并为这个账户赋予相应的权限来启动elasticsearch集群（<strong>赋予权限的操作在后面启动ES的环节</strong>）。 </p> 
<blockquote> 
 <p>  #useradd es</p> 
</blockquote> 
<p><strong>修改服务打开文件数</strong></p> 
<blockquote> 
 <p>(1).vim /etc/security/limits.conf</p> 
 <p>root soft nofile 65535  (这个不需要修改成262144，无需改动)<br> root hard nofile 65535  (这个不需要修改成262144，无需改动)<br>   *  soft nofile 262144<br>   *  hard nofile 262144</p> 
 <p>#下面两句没加，但是看很多文章里加了</p> 
 <p>* soft memlock unlimited  <br> * hard memlock unlimited</p> 
</blockquote> 
<p><strong>防止进程虚拟内存不足: </strong></p> 
<blockquote> 
 <p>(2).vim /etc/sysctl.conf</p> 
 <p>   #文件尾部设置<br>     vm.max_map_count=262144</p> 
</blockquote> 
<p><strong>使上面的设置生效：</strong></p> 
<blockquote> 
 <p>sysctl -p</p> 
</blockquote> 
<h4 id="2%E3%80%81%E4%BF%AE%E6%94%B9ES%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6elasticsearch.yml">2、修改ES配置文件elasticsearch.yml</h4> 
<p>集群配置中最重要的两项是node.name与network.host，每个节点都必须不同。其中node.name是节点名称主要是在Elasticsearch自己的日志加以区分每一个节点信息。</p> 
<blockquote> 
 <p>#集群名称，<strong>三台集群，要配置相同的集群名称</strong>！！！<br> cluster.name: wit<br> #节点名称<br> node.name: node-1 #每个节点的名称<strong>不能相同</strong><br> node.master: true<br> #是否存储数据<br> node.data: true<br> network.host: 0.0.0.0<br> #端⼝<br> http.port: 9200<br> #<strong>内部节点</strong>之间沟通端⼝<br> transport.tcp.port: 9300<br> #写⼊候选主节点的设备地址，在开启服务后可以被选为主节点</p> 
 <p>#因为要配置三个主节点，所以这里写了三个，如果只需要一个主节点，则这里只写一个</p> 
 <p><span style="color:#fe2c24;"><strong>#这里不要写端口，只写IP，写端口的话，集群搭建不成功。</strong></span><br><span style="color:#fe2c24;">discovery.seed_hosts: ["es1 IP","es2 IP","es3 IP"]</span><br> #初始化⼀个新的集群时需要此配置来选举master，就是说可以被选为主节点的节点列表</p> 
 <p><span style="color:#fe2c24;"><strong>#这里填写的是节点的名字，不是节点的IP地址</strong></span><br> cluster.initial_master_nodes: ["node-1", "node-2","node-3"] <br> #数据和存储路径<br> path.data: /data/esdata （可以自己创建，可以设置在ES解压目录中）<br> path.logs: /data/eslogs （可以自己创建，可以设置在ES解压目录中）</p> 
 <p>#下面的几个配置还没使用，看情况吧 </p> 
 <p>http.cors.enabled: true<br> http.cors.allow-origin: "*"<br> http.cors.allow-headers: Authorization<br> xpack.security.enabled: true<br> xpack.security.transport.ssl.enabled: true</p> 
</blockquote> 
<p>问题：</p> 
<p>1. 每个节点都要按照上面的配置？还是说只有主节点这么配置？</p> 
<p><strong>都配置的一样 3个节点都作为master，不然master挂了。。集群就没了</strong><br><strong>后期加机器也只要加slave就行了，节点名称需要不一样</strong></p> 
<h4 id="3.%20%E5%85%B6%E5%AE%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">3. 其它配置文件</h4> 
<p><span style="color:#4da8ee;"><strong>关于ES与jdk版本关系，请参考文章</strong></span>：<a href="https://www.elastic.co/cn/support/matrix#matrix_jvm" rel="nofollow" title="支持矩阵 | Elastic">支持矩阵 | Elastic</a></p> 
<p>(1).ES自带java，所以不需要在系统中安装java，但是如果系统中已经有了java，那么ES会用哪一个？</p> 
<p>在ES解压目录中，/bin/elasticsearch-env文件中，有如下内容：</p> 
<p>意思是如果系统中安装了java，那么优先使用系统中安装的java，如果系统中没有安装java，那么使用ES自带的java。</p> 
<p><img alt="" height="279" src="https://images2.imgbox.com/9e/00/KiYyW0iB_o.png" width="1113"></p> 
<p></p> 
<p>(2).由于Elasticsearch是Java开发的，所以可以通过../elasticsearch/config/jvm.options配置文件来设定JVM的相关设定。如果没有特殊需求按默认即可。 不过其中还是有两项最重要的-Xmx1g 与</p> 
<p>-Xms1gJVM的最大最小Heap。如果太小会导致Elasticsearch刚刚启动就立刻停止。太大会拖慢</p> 
<p>系统本身。</p> 
<p><img alt="" height="137" src="https://images2.imgbox.com/c2/40/C5pMpe8T_o.png" width="824"></p> 
<p></p> 
<p></p> 
<h4 id="4.%E5%90%AF%E5%8A%A8es">4.启动es</h4> 
<p>1、给elasticsearch文件夹分配es权限</p> 
<blockquote> 
 <p>chown -R es:es elasticsearch文件路径</p> 
</blockquote> 
<p>2、切换至es用户su - es</p> 
<p>3、启动ES</p> 
<ul><li>bin/elasticsearch --前台启动 </li><li>bin/elasticsearch -d --后台启动 </li></ul> 
<h4 id="5.%E6%B5%8F%E8%A7%88%E5%99%A8%E8%AE%BF%E9%97%AEES%EF%BC%9A">5.验证ES集群：</h4> 
<p><strong>shell命令行访问 ：</strong></p> 
<blockquote> 
 <p> curl localhost:9200/_cluster/health?pretty</p> 
</blockquote> 
<p>命令输出信息：</p> 
<pre><code>[es@ecs-dev-0002 bin]$ curl localhost:9200/_cluster/health?pretty
{
  "cluster_name" : "wit",
  "status" : "green",
  "timed_out" : false,
  "number_of_nodes" : 3,
  "number_of_data_nodes" : 3,
  "active_primary_shards" : 0,
  "active_shards" : 0,
  "relocating_shards" : 0,
  "initializing_shards" : 0,
  "unassigned_shards" : 0,
  "delayed_unassigned_shards" : 0,
  "number_of_pending_tasks" : 0,
  "number_of_in_flight_fetch" : 0,
  "task_max_waiting_in_queue_millis" : 0,
  "active_shards_percent_as_number" : 100.0
}</code></pre> 
<p><strong>本地http访问：</strong></p> 
<blockquote> 
 <p>curl  <a href="http://localhost:9200" rel="nofollow" title="http://localhost:9200">http://localhost:9200</a></p> 
</blockquote> 
<p><strong>外部http访问：</strong></p> 
<p>开放防火墙端口：</p> 
<blockquote> 
 <ol><li> <p>firewall-cmd --zone=public --add-port=9200/tcp --permanent</p> </li><li> <p>firewall-cmd --reload</p> </li><li> <p>systemctl daemon-reload</p> </li></ol> 
</blockquote> 
<p><strong>导入数据到ES：</strong></p> 
<p>json数据文件data.json如下：</p> 
<p>它的第一行定义了_index，_type，_id等信息；第二行定义了字段的信息（<strong>关于ES数据格式问题，比如要有哪些字段，请自行研究</strong>）。 </p> 
<pre><code>{ "index" : { "_index" : "test", "_type" : "type1", "_id" : "1" } }
{ "field1" : "value1" }</code></pre> 
<blockquote> 
 <p>curl -H "Content-Type: application/json" -X POST localhost:9200/_bulk --data-binary @data.json</p> 
</blockquote> 
<p>执行结果如下：</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/18/67/i4T6rh9t_o.png"></p> 
<p></p> 
<h3 id="%E4%B8%89%E3%80%81%E5%AE%89%E8%A3%85Kibana">三、安装Kibana</h3> 
<p> Kibana是一个针对Elasticsearch的开源分析及可视化平台，使用Kibana可以查询、查看并与存储在ES索引的数据进行交互操作，使用Kibana能执行高级的数据分析，并能以图表、表格和地图的形式查看数据。</p> 
<h4 id="1.%E8%8E%B7%E5%8F%96%E5%88%B0%E5%AE%89%E8%A3%85%E5%8C%85">1.获取到安装包</h4> 
<p>获取kibana-7.8.1-linux-x86_64.tar（自己去官网下载，这里不提供），然后解压</p> 
<pre><code>tar xvf kibana-7.8.1-linux-x86_64.tar</code></pre> 
<h4 id="2.%E9%85%8D%E7%BD%AEyum%E6%BA%90%EF%BC%9A">2.配置yum源(由于不是yum安装，所以这里不需要，仅仅作为以后的参考)：</h4> 
<p>在/etc/yum.repos.d/ 下新建 kibana.repo 配置 yum 源地址：<br> 新建kibana.repo：</p> 
<blockquote> 
 <p>cat&gt;&gt;kibana.repo</p> 
</blockquote> 
<p>新建完成之后，在里面加上如下内容：</p> 
<blockquote> 
 <p>[kibana-7.x]<br> name=Kibana repository for 7.x packages<br> baseurl=https://artifacts.elastic.co/packages/7.x/yum<br> gpgcheck=1<br> gpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch<br> enabled=1<br> autorefresh=1<br> type=rpm-md</p> 
</blockquote> 
<h4 id="3.%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6kibana.yml%EF%BC%9A">3.修改配置文件kibana.yml：</h4> 
<p>修改config文件夹下的kibana.yml，添加信息：</p> 
<blockquote> 
 <p>server.port: 5601<br> server.host: “0.0.0.0”<br> server.name: tanklog<br> elasticsearch.hosts: [“http://127.0.0.0:9200/”]</p> 
</blockquote> 
<p>注意，里面的地址是你自己服务器的IP地址。</p> 
<h4 id="4.%E5%BC%80%E5%90%AF%E7%AB%AF%E5%8F%A35601%3A">4.开启端口5601:</h4> 
<p> 如果防火墙是关闭的，首先打开防火墙，否则没办法开启5601端口：</p> 
<p><strong>1.输入命令、开启防火墙：</strong></p> 
<blockquote> 
 <p>systemctl start firewalld.service</p> 
</blockquote> 
<p><strong>2.开启防火墙后，添加5601端口：</strong></p> 
<blockquote> 
 <p>firewall-cmd --permanent --zone=public --add-port=5601/tcp</p> 
</blockquote> 
<p>出现success，说明端口开启成功。</p> 
<p><strong>3.重启防火墙：</strong></p> 
<blockquote> 
 <p>firewall-cmd --reload</p> 
</blockquote> 
<h4 id="5.%E5%90%AF%E5%8A%A8kibana%3A">5.启动kibana:</h4> 
<p><strong>1.启动kibana之前，先启动ElasticSearch：</strong><br> 进入ES安装包下的bin目录，输入命令：</p> 
<blockquote> 
 <p>./elasticsearch -d(后代运行)</p> 
</blockquote> 
<p><strong>2.启动Kibana：</strong><br> 进入kibana安装目录下的bin目录，输入命令：</p> 
<p><strong>(1).新建kibana账户(推荐)：</strong></p> 
<blockquote> 
 <p>  #useradd kibana</p> 
</blockquote> 
<p>授权：</p> 
<blockquote> 
 <p> chown -R kibana:kibana kibana目录</p> 
</blockquote> 
<p>切换账户：</p> 
<blockquote> 
 <p>su - kibana </p> 
</blockquote> 
<p>启动kibana:</p> 
<blockquote> 
 <p>nohup ./kibana &amp; </p> 
</blockquote> 
<p><strong>(2).如果在root账户下启动kibana</strong></p> 
<p>需要加--allow-root参数。 </p> 
<blockquote> 
 <p>nohup ./kibana --allow-root &amp;  (--allow-root表示允许root用户去启动)</p> 
</blockquote> 
<p><strong>3.关闭防火墙：</strong></p> 
<p>kibana成功启动后，关闭防火墙：</p> 
<blockquote> 
 <p>systemctl stop firewalld.service</p> 
</blockquote> 
<p><strong>4.访问kibana：</strong></p> 
<p>浏览器中输入： http://IP:5601/app/kibana </p> 
<p></p> 
<h3 id="%E5%9B%9B%E3%80%81%E5%8D%8E%E4%B8%BA%E4%BA%91%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93%EF%BC%9A">四、华为云使用问题总结：</h3> 
<h4 id="1.%E6%80%8E%E6%A0%B7%E7%99%BB%E5%BD%95%E6%9C%8D%E5%8A%A1%E5%99%A8Linux%E6%8E%A7%E5%88%B6%E5%8F%B0">1.怎样登录服务器Linux控制台</h4> 
<p>访问华为云，没有开启ssh等功能的情况下，怎样在<strong>管理界面</strong>中访问华为云？</p> 
<p>点击某个服务器的<strong>远程登录</strong>按钮</p> 
<p><img alt="" height="747" src="https://images2.imgbox.com/67/7e/AzgROu1e_o.png" width="1200"></p> 
<p> 弹出对话框，选择"<strong>CloudShell登录</strong>"</p> 
<p><img alt="" height="801" src="https://images2.imgbox.com/31/48/SafEx1qt_o.png" width="837"></p> 
<p>输入密码，然后就可以进入centos7的控制台了。</p> 
<p><img alt="" height="668" src="https://images2.imgbox.com/64/83/zn70HPoC_o.png" width="1146"></p> 
<blockquote> 
 <p><span style="color:#fe2c24;"><strong> Note：</strong></span>如果服务器的名字与其它服务器重名，则可能进入其它相同名字服务器的控制台，所以要把服务器的名字改成唯一的。 </p> 
</blockquote> 
<p>但是在使用过程中出现了问题，什么问题呢？连接超时</p> 
<p><img alt="" height="757" src="https://images2.imgbox.com/a1/98/HIeZjYhT_o.png" width="1200"></p> 
<p>怎样解决？配置安全组，在安全组里加入三个地址，允许它们对云服务器的访问</p> 
<p><img alt="" height="450" src="https://images2.imgbox.com/b4/4b/dymWhC1B_o.png" width="1200"></p> 
<p> 将这三个地址加入安全组，问题解决，可以使用CloudShell的方式登录<img alt="" height="610" src="https://images2.imgbox.com/22/a3/X8y7PmWW_o.png" width="1200"></p> 
<h4 id="%C2%A02.%E6%80%8E%E6%A0%B7%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%EF%BC%9A"><strong> 2.怎样上传文件：</strong></h4> 
<p>在左侧的资源列表，在某个文件夹中右键，然后选择文件上传到这个文件夹。</p> 
<p><img alt="" height="746" src="https://images2.imgbox.com/c3/a5/bl5prd4G_o.png" width="1200"></p> 
<p></p> 
<h3 id="%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0%EF%BC%9A">五、参考文章：</h3> 
<p>这篇参考文章写得还可以</p> 
<p><a href="https://blog.csdn.net/dreamworld204/article/details/78559296" title="kibana几次崩溃问题引发的探索_墨的博客-CSDN博客_kibana崩溃">kibana几次崩溃问题引发的探索_墨的博客-CSDN博客_kibana崩溃</a></p> 
<p><a href="https://blog.csdn.net/pangfaheng/article/details/116690342" title="ELK笔记（一）：Centos7部署elasticsearch-7.8.0集群_pangfaheng的博客-CSDN博客">ELK笔记（一）：Centos7部署elasticsearch-7.8.0集群_pangfaheng的博客-CSDN博客</a></p> 
<p><a href="https://blog.csdn.net/qq_34182808/article/details/102678366" title="elasticsearch7 集群搭建（三个master节点）_天涯的博客-CSDN博客_es 多master">elasticsearch7 集群搭建（三个master节点）_天涯的博客-CSDN博客_es 多master</a></p> 
<p>ES与java版本关系：<a href="https://www.elastic.co/cn/support/matrix#matrix_jvm" rel="nofollow" title="支持矩阵 | Elastic">支持矩阵 | Elastic</a> </p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c0ea67e45bfed2652b9fa01c36d0a6ed/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">使用fastjson报错Exception in thread “main“ com.alibaba.fastjson.JSONException: syntax error, pos 1, line</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d175915edb8e64170559a05d2f3b384a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">使用Mosquitto软件测试mqtt功能</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>