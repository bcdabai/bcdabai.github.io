<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Web开发3：数据库使用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Web开发3：数据库使用" />
<meta property="og:description" content="欢迎来到Web开发系列的第三篇！今天我们将探讨如何在Web开发中使用数据库。数据库是存储和管理数据的重要工具，它在现代应用程序中起着至关重要的作用。无论是社交媒体应用、电子商务平台还是博客网站，数据库都是不可或缺的一部分。
什么是数据库？ 首先，让我们来了解一下数据库是什么。简单来说，数据库是一个存储数据的电子系统。它可以以结构化的方式组织和管理数据，使得我们可以方便地存储、检索和更新数据。数据库使用一种称为SQL（Structured Query Language）的语言来操作数据。
常见的数据库类型 在Web开发中，我们常见的数据库类型包括关系型数据库和非关系型数据库。关系型数据库使用表格来组织数据，例如MySQL和PostgreSQL。非关系型数据库则以不同的方式组织数据，例如MongoDB和Redis。选择适合你的应用程序需求的数据库类型非常重要，因为它将直接影响到你的应用程序的性能和扩展性。
数据库的基本操作 让我们来看看数据库的一些基本操作。
连接数据库 首先，我们需要连接到数据库。这可以通过在代码中使用数据库的连接字符串来实现。连接字符串包含数据库的位置、用户名、密码等信息。一旦连接成功，我们就可以开始操作数据库了。
import psycopg2 # 连接到 PostgreSQL 数据库 conn = psycopg2.connect( host=&#34;localhost&#34;, database=&#34;mydatabase&#34;, user=&#34;myuser&#34;, password=&#34;mypassword&#34; ) 创建表格 在数据库中，我们使用表格来组织数据。表格由列和行组成，每列代表一种数据类型，每行代表一个数据记录。我们可以使用SQL语句来创建表格。
import psycopg2 # 创建 users 表格 def create_users_table(): conn = psycopg2.connect( host=&#34;localhost&#34;, database=&#34;mydatabase&#34;, user=&#34;myuser&#34;, password=&#34;mypassword&#34; ) cur = conn.cursor() cur.execute(&#34;&#34;&#34; CREATE TABLE users ( id SERIAL PRIMARY KEY, username VARCHAR(50) NOT NULL, email VARCHAR(100) NOT NULL, password VARCHAR(100) NOT NULL ) &#34;&#34;&#34;) conn." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/4263d1d90847e5db386f41b8bba69139/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-22T20:01:31+08:00" />
<meta property="article:modified_time" content="2024-01-22T20:01:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Web开发3：数据库使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>欢迎来到Web开发系列的第三篇！今天我们将探讨如何在Web开发中使用数据库。数据库是存储和管理数据的重要工具，它在现代应用程序中起着至关重要的作用。无论是社交媒体应用、电子商务平台还是博客网站，数据库都是不可或缺的一部分。</p> 
<h3><a id="_4"></a>什么是数据库？</h3> 
<p>首先，让我们来了解一下数据库是什么。简单来说，数据库是一个存储数据的电子系统。它可以以结构化的方式组织和管理数据，使得我们可以方便地存储、检索和更新数据。数据库使用一种称为SQL（Structured Query Language）的语言来操作数据。</p> 
<h3><a id="_8"></a>常见的数据库类型</h3> 
<p>在Web开发中，我们常见的数据库类型包括关系型数据库和非关系型数据库。关系型数据库使用表格来组织数据，例如MySQL和PostgreSQL。非关系型数据库则以不同的方式组织数据，例如MongoDB和Redis。选择适合你的应用程序需求的数据库类型非常重要，因为它将直接影响到你的应用程序的性能和扩展性。</p> 
<h3><a id="_12"></a>数据库的基本操作</h3> 
<p>让我们来看看数据库的一些基本操作。</p> 
<h4><a id="_16"></a>连接数据库</h4> 
<p>首先，我们需要连接到数据库。这可以通过在代码中使用数据库的连接字符串来实现。连接字符串包含数据库的位置、用户名、密码等信息。一旦连接成功，我们就可以开始操作数据库了。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> psycopg2

<span class="token comment"># 连接到 PostgreSQL 数据库</span>
conn <span class="token operator">=</span> psycopg2<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
    host<span class="token operator">=</span><span class="token string">"localhost"</span><span class="token punctuation">,</span>
    database<span class="token operator">=</span><span class="token string">"mydatabase"</span><span class="token punctuation">,</span>
    user<span class="token operator">=</span><span class="token string">"myuser"</span><span class="token punctuation">,</span>
    password<span class="token operator">=</span><span class="token string">"mypassword"</span>
<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_32"></a>创建表格</h4> 
<p>在数据库中，我们使用表格来组织数据。表格由列和行组成，每列代表一种数据类型，每行代表一个数据记录。我们可以使用SQL语句来创建表格。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> psycopg2

<span class="token comment"># 创建 users 表格</span>
<span class="token keyword">def</span> <span class="token function">create_users_table</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    conn <span class="token operator">=</span> psycopg2<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
        host<span class="token operator">=</span><span class="token string">"localhost"</span><span class="token punctuation">,</span>
        database<span class="token operator">=</span><span class="token string">"mydatabase"</span><span class="token punctuation">,</span>
        user<span class="token operator">=</span><span class="token string">"myuser"</span><span class="token punctuation">,</span>
        password<span class="token operator">=</span><span class="token string">"mypassword"</span>
    <span class="token punctuation">)</span>
    cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token triple-quoted-string string">"""
        CREATE TABLE users (
            id SERIAL PRIMARY KEY,
            username VARCHAR(50) NOT NULL,
            email VARCHAR(100) NOT NULL,
            password VARCHAR(100) NOT NULL
        )
    """</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_60"></a>插入数据</h4> 
<p>一旦我们创建了表格，我们可以开始向数据库中插入数据。使用SQL的INSERT语句可以将数据插入到表格中。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> psycopg2

<span class="token comment"># 插入新用户数据</span>
<span class="token keyword">def</span> <span class="token function">insert_user</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> email<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span>
    conn <span class="token operator">=</span> psycopg2<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
        host<span class="token operator">=</span><span class="token string">"localhost"</span><span class="token punctuation">,</span>
        database<span class="token operator">=</span><span class="token string">"mydatabase"</span><span class="token punctuation">,</span>
        user<span class="token operator">=</span><span class="token string">"myuser"</span><span class="token punctuation">,</span>
        password<span class="token operator">=</span><span class="token string">"mypassword"</span>
    <span class="token punctuation">)</span>
    cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token triple-quoted-string string">"""
        INSERT INTO users (username, email, password)
        VALUES (%s, %s, %s)
    """</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>username<span class="token punctuation">,</span> email<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_84"></a>查询数据</h4> 
<p>查询是数据库中非常常见的操作之一。我们可以使用SQL的SELECT语句从表格中检索数据。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> psycopg2

<span class="token comment"># 查询所有用户数据</span>
<span class="token keyword">def</span> <span class="token function">get_all_users</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    conn <span class="token operator">=</span> psycopg2<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
        host<span class="token operator">=</span><span class="token string">"localhost"</span><span class="token punctuation">,</span>
        database<span class="token operator">=</span><span class="token string">"mydatabase"</span><span class="token punctuation">,</span>
        user<span class="token operator">=</span><span class="token string">"myuser"</span><span class="token punctuation">,</span>
        password<span class="token operator">=</span><span class="token string">"mypassword"</span>
    <span class="token punctuation">)</span>
    cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"SELECT * FROM users"</span><span class="token punctuation">)</span>
    rows <span class="token operator">=</span> cur<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> rows
</code></pre> 
<h3><a id="_106"></a>示例：</h3> 
<p>app.py</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token punctuation">,</span> redirect<span class="token punctuation">,</span> session
<span class="token keyword">from</span> flask_sqlalchemy <span class="token keyword">import</span> SQLAlchemy

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> <span class="token string">"your_secret_key"</span>

<span class="token comment"># 配置数据库连接</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SQLALCHEMY_DATABASE_URI'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'sqlite:///users.db'</span>
db <span class="token operator">=</span> SQLAlchemy<span class="token punctuation">(</span>app<span class="token punctuation">)</span>

<span class="token comment"># 定义用户模型</span>
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> db<span class="token punctuation">.</span>Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>Integer<span class="token punctuation">,</span> primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    username <span class="token operator">=</span> db<span class="token punctuation">.</span>Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> unique<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> db<span class="token punctuation">.</span>Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>String<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> unique<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> db<span class="token punctuation">.</span>Column<span class="token punctuation">(</span>db<span class="token punctuation">.</span>String<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token punctuation">,</span> email<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>username <span class="token operator">=</span> username
        self<span class="token punctuation">.</span>email <span class="token operator">=</span> email
        self<span class="token punctuation">.</span>password <span class="token operator">=</span> password

<span class="token comment"># 创建数据库表格</span>
<span class="token keyword">with</span> app<span class="token punctuation">.</span>app_context<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db<span class="token punctuation">.</span>create_all<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 注册路由</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">'user_id'</span> <span class="token keyword">in</span> session<span class="token punctuation">:</span>
        user <span class="token operator">=</span> User<span class="token punctuation">.</span>query<span class="token punctuation">.</span>get<span class="token punctuation">(</span>session<span class="token punctuation">[</span><span class="token string">'user_id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"Hello, </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>user<span class="token punctuation">.</span>username<span class="token punctuation">}</span></span><span class="token string">!"</span></span>
    <span class="token keyword">return</span> <span class="token string">"Welcome to the user management system!"</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/register'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span>
        email <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
        password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span>
        new_user <span class="token operator">=</span> User<span class="token punctuation">(</span>username<span class="token punctuation">,</span> email<span class="token punctuation">,</span> password<span class="token punctuation">)</span>
        db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>add<span class="token punctuation">(</span>new_user<span class="token punctuation">)</span>
        db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span>
        password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span>
        user <span class="token operator">=</span> User<span class="token punctuation">.</span>query<span class="token punctuation">.</span>filter_by<span class="token punctuation">(</span>username<span class="token operator">=</span>username<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> user <span class="token keyword">and</span> user<span class="token punctuation">.</span>password <span class="token operator">==</span> password<span class="token punctuation">:</span>
            session<span class="token punctuation">[</span><span class="token string">'user_id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token builtin">id</span>
            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">"Invalid username or password"</span>
    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'login.html'</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/logout'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    session<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'user_id'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="_178"></a>演示</h3> 
<p><img src="https://images2.imgbox.com/bc/00/2iUKopTn_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/57/f6/EYFsg6s5_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/aa/72/yD8e2iiT_o.png" alt="在这里插入图片描述"></p> 
<p><a href="https://github.com/tutu-jet/flaskProject_database">完整代码</a></p> 
<h3><a id="_188"></a>总结</h3> 
<p>在本篇文章中，我们介绍了数据库在Web开发中的基本概念和操作。我们了解了数据库的定义，学习了SQL语言的基础知识，并探讨了关系型数据库和非关系型数据库的区别。我们还学习了连接数据库、创建表格、插入数据和查询数据的基本操作。</p> 
<p>希望本篇文章对你理解数据库在Web开发中的作用和使用有所帮助。下一篇文章中，我们将继续探讨Web开发的其他主题。敬请期待！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a0a15128ee1c45f0fa511ae0ad902592/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">产品经理学习-用户生命周期管理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1d01be4ec0573745fdaddf0c250edbce/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">springboot/java/php/node/python儿童早教课程管理系统【计算机毕设】</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>