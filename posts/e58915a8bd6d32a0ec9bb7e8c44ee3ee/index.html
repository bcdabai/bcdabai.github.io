<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>数据采集与清洗基础习题（四）Pandas初体验，头歌参考答案 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="数据采集与清洗基础习题（四）Pandas初体验，头歌参考答案" />
<meta property="og:description" content="数据采集习题参考答案，会持续更新，点个关注防丢失。
创作不易，一键三连给博主一个支持呗。
为了方便查找，已按照头歌重新排版，朋友们按照头歌所属门类查找实训哦，该篇为Pandas。
文章目录
实训一：Pandas初体验
第一关：了解数据处理对象--Series
编程要求
Pandas中的数据结构
第一关答案
第二关：了解数据处理对象-DataFrame
编程要求
相关知识
第二关答案
第三关：读取CSV格式数据
编程要求
相关知识
第三关答案
第四关：数据的基本操作——排序
编程要求
相关知识
第四关答案
第五关：数据的基本操作——删除
编程要求
相关知识
第五关答案
第六关：数据的基本操作——算术运算
编程要求
相关知识
第六关答案
第七关：数据的基本操作——去重
编程要求
相关知识
第七关答案
第八关：层次化索引
编程要求
相关知识
第八关答案
实训一：Pandas初体验 第一关：了解数据处理对象--Series 编程要求 创建一个名为series_a的series数组，当中值为[1,2,5,7],对应的索引为[&#39;nu&#39;, &#39;li&#39;, &#39;xue&#39;, &#39;xi&#39;]；
创建一个名为dict_a的字典，字典中包含如下内容{&#39;ting&#39;:1, &#39;shuo&#39;:2, &#39;du&#39;:32, &#39;xie&#39;:44}；
将dict_a字典转化成名为series_b的series数组。
相关知识
Pandas是为了解决数据分析任务而创建的，纳入了大量的库和标准数据模型，提供了高效地操作大型数据集所需的工具。 对于Pandas包，在Python中常见的导入方法如下：
from pandas import Series,DataFrame
import pandas as pd
Pandas中的数据结构 Series: 一维数组，类似于Python中的基本数据结构list，区别是Series只允许存储相同的数据类型，这样可以更有效的使用内存，提高运算效率。就像数据库中的列数据；DataFrame: 二维的表格型数据结构。很多功能与R中的data.frame类似。可以将DataFrame理解为Series的容器；Panel：三维的数组，可以理解为DataFrame的容器。 了解Series
为了开始使用Pandas，我们必需熟悉它的两个重要的数据结构：Series 和DataFrame。虽然它们不是每一个问题的通用解决方案，但可以提供一个坚实的，易于使用的大多数应用程序的基础。 Series是一个一维的类似的数组对象，包含一个数组的数据（任何NumPy的数据类型）和一个与数组关联的数据标签，被叫做索引 。最简单的Series是由一个数组的数据构成：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e58915a8bd6d32a0ec9bb7e8c44ee3ee/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-16T20:11:47+08:00" />
<meta property="article:modified_time" content="2022-05-16T20:11:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">数据采集与清洗基础习题（四）Pandas初体验，头歌参考答案</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>数据采集习题参考答案，会持续更新，点个关注防丢失。</strong></p> 
<p><strong>创作不易，一键三连给博主一个支持呗。</strong></p> 
<p><strong>为了方便查找，已按照头歌重新排版，朋友们按照头歌所属门类查找实训哦，该篇为Pandas。</strong></p> 
<p id="main-toc" style="text-align:center;"><strong>文章目录</strong></p> 
<p id="%E5%AE%9E%E8%AE%AD%E4%B8%80%EF%BC%9APandas%E5%88%9D%E4%BD%93%E9%AA%8C-toc" style="margin-left:0px;"><a href="#%E5%AE%9E%E8%AE%AD%E4%B8%80%EF%BC%9APandas%E5%88%9D%E4%BD%93%E9%AA%8C" rel="nofollow">实训一：Pandas初体验</a></p> 
<p id="%E7%AC%AC%E4%B8%80%E5%85%B3%EF%BC%9A%E4%BA%86%E8%A7%A3%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%AF%B9%E8%B1%A1--Series-toc" style="margin-left:40px;"><a href="#%E7%AC%AC%E4%B8%80%E5%85%B3%EF%BC%9A%E4%BA%86%E8%A7%A3%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%AF%B9%E8%B1%A1--Series" rel="nofollow">第一关：了解数据处理对象--Series</a></p> 
<p id="%E7%BC%96%E7%A8%8B%E8%A6%81%E6%B1%82-toc" style="margin-left:80px;"><a href="#%E7%BC%96%E7%A8%8B%E8%A6%81%E6%B1%82" rel="nofollow">编程要求</a></p> 
<p id="Pandas%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-toc" style="margin-left:80px;"><a href="#Pandas%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84" rel="nofollow">Pandas中的数据结构</a></p> 
<p id="%E7%AC%AC%E4%B8%80%E5%85%B3%E7%AD%94%E6%A1%88-toc" style="margin-left:80px;"><a href="#%E7%AC%AC%E4%B8%80%E5%85%B3%E7%AD%94%E6%A1%88" rel="nofollow">第一关答案</a></p> 
<p id="%E7%AC%AC%E4%BA%8C%E5%85%B3%EF%BC%9A%E4%BA%86%E8%A7%A3%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%AF%B9%E8%B1%A1-DataFrame-toc" style="margin-left:40px;"><a href="#%E7%AC%AC%E4%BA%8C%E5%85%B3%EF%BC%9A%E4%BA%86%E8%A7%A3%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%AF%B9%E8%B1%A1-DataFrame" rel="nofollow">第二关：了解数据处理对象-DataFrame</a></p> 
<p style="margin-left:80px;"><a href="#%E7%BC%96%E7%A8%8B%E8%A6%81%E6%B1%82" rel="nofollow">编程要求</a></p> 
<p id="%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86-toc" style="margin-left:80px;"><a href="#%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86" rel="nofollow">相关知识</a></p> 
<p id="%E7%AC%AC%E4%BA%8C%E5%85%B3%E7%AD%94%E6%A1%88-toc" style="margin-left:80px;"><a href="#%E7%AC%AC%E4%BA%8C%E5%85%B3%E7%AD%94%E6%A1%88" rel="nofollow">第二关答案</a></p> 
<p id="%E7%AC%AC%E4%B8%89%E5%85%B3%EF%BC%9A%E8%AF%BB%E5%8F%96CSV%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#%E7%AC%AC%E4%B8%89%E5%85%B3%EF%BC%9A%E8%AF%BB%E5%8F%96CSV%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE" rel="nofollow">第三关：读取CSV格式数据</a></p> 
<p style="margin-left:80px;"><a href="#%E7%BC%96%E7%A8%8B%E8%A6%81%E6%B1%82" rel="nofollow">编程要求</a></p> 
<p style="margin-left:80px;"><a href="#%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86" rel="nofollow">相关知识</a></p> 
<p id="%E7%AC%AC%E4%B8%89%E5%85%B3%E7%AD%94%E6%A1%88-toc" style="margin-left:80px;"><a href="#%E7%AC%AC%E4%B8%89%E5%85%B3%E7%AD%94%E6%A1%88" rel="nofollow">第三关答案</a></p> 
<p id="%E7%AC%AC%E5%9B%9B%E5%85%B3%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94%E2%80%94%E6%8E%92%E5%BA%8F-toc" style="margin-left:40px;"><a href="#%E7%AC%AC%E5%9B%9B%E5%85%B3%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94%E2%80%94%E6%8E%92%E5%BA%8F" rel="nofollow">第四关：数据的基本操作——排序</a></p> 
<p style="margin-left:80px;"><a href="#%E7%BC%96%E7%A8%8B%E8%A6%81%E6%B1%82" rel="nofollow">编程要求</a></p> 
<p style="margin-left:80px;"><a href="#%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86" rel="nofollow">相关知识</a></p> 
<p id="%E7%AC%AC%E5%9B%9B%E5%85%B3%E7%AD%94%E6%A1%88-toc" style="margin-left:80px;"><a href="#%E7%AC%AC%E5%9B%9B%E5%85%B3%E7%AD%94%E6%A1%88" rel="nofollow">第四关答案</a></p> 
<p id="%E7%AC%AC%E4%BA%94%E5%85%B3%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94%E2%80%94%E5%88%A0%E9%99%A4-toc" style="margin-left:40px;"><a href="#%E7%AC%AC%E4%BA%94%E5%85%B3%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94%E2%80%94%E5%88%A0%E9%99%A4" rel="nofollow">第五关：数据的基本操作——删除</a></p> 
<p style="margin-left:80px;"><a href="#%E7%BC%96%E7%A8%8B%E8%A6%81%E6%B1%82" rel="nofollow">编程要求</a></p> 
<p style="margin-left:80px;"><a href="#%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86" rel="nofollow">相关知识</a></p> 
<p id="%E7%AC%AC%E4%BA%94%E5%85%B3%E7%AD%94%E6%A1%88-toc" style="margin-left:80px;"><a href="#%E7%AC%AC%E4%BA%94%E5%85%B3%E7%AD%94%E6%A1%88" rel="nofollow">第五关答案</a></p> 
<p id="%E7%AC%AC%E5%85%AD%E5%85%B3%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94%E2%80%94%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97-toc" style="margin-left:40px;"><a href="#%E7%AC%AC%E5%85%AD%E5%85%B3%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94%E2%80%94%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97" rel="nofollow">第六关：数据的基本操作——算术运算</a></p> 
<p style="margin-left:80px;"><a href="#%E7%BC%96%E7%A8%8B%E8%A6%81%E6%B1%82" rel="nofollow">编程要求</a></p> 
<p style="margin-left:80px;"><a href="#%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86" rel="nofollow">相关知识</a></p> 
<p id="%E7%AC%AC%E5%85%AD%E5%85%B3%E7%AD%94%E6%A1%88-toc" style="margin-left:80px;"><a href="#%E7%AC%AC%E5%85%AD%E5%85%B3%E7%AD%94%E6%A1%88" rel="nofollow">第六关答案</a></p> 
<p id="%E7%AC%AC%E4%B8%83%E5%85%B3%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94%E2%80%94%E5%8E%BB%E9%87%8D-toc" style="margin-left:40px;"><a href="#%E7%AC%AC%E4%B8%83%E5%85%B3%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94%E2%80%94%E5%8E%BB%E9%87%8D" rel="nofollow">第七关：数据的基本操作——去重</a></p> 
<p style="margin-left:80px;"><a href="#%E7%BC%96%E7%A8%8B%E8%A6%81%E6%B1%82" rel="nofollow">编程要求</a></p> 
<p style="margin-left:80px;"><a href="#%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86" rel="nofollow">相关知识</a></p> 
<p id="%E7%AC%AC%E4%B8%83%E5%85%B3%E7%AD%94%E6%A1%88-toc" style="margin-left:80px;"><a href="#%E7%AC%AC%E4%B8%83%E5%85%B3%E7%AD%94%E6%A1%88" rel="nofollow">第七关答案</a></p> 
<p id="%E7%AC%AC%E5%85%AB%E5%85%B3%EF%BC%9A%E5%B1%82%E6%AC%A1%E5%8C%96%E7%B4%A2%E5%BC%95-toc" style="margin-left:40px;"><a href="#%E7%AC%AC%E5%85%AB%E5%85%B3%EF%BC%9A%E5%B1%82%E6%AC%A1%E5%8C%96%E7%B4%A2%E5%BC%95" rel="nofollow">第八关：层次化索引</a></p> 
<p style="margin-left:80px;"><a href="#%E7%BC%96%E7%A8%8B%E8%A6%81%E6%B1%82" rel="nofollow">编程要求</a></p> 
<p style="margin-left:80px;"><a href="#%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86" rel="nofollow">相关知识</a></p> 
<p id="%E7%AC%AC%E5%85%AB%E5%85%B3%E7%AD%94%E6%A1%88-toc" style="margin-left:80px;"><a href="#%E7%AC%AC%E5%85%AB%E5%85%B3%E7%AD%94%E6%A1%88" rel="nofollow">第八关答案</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E5%AE%9E%E8%AE%AD%E4%B8%80%EF%BC%9APandas%E5%88%9D%E4%BD%93%E9%AA%8C">实训一：Pandas初体验</h2> 
<h3 id="%E7%AC%AC%E4%B8%80%E5%85%B3%EF%BC%9A%E4%BA%86%E8%A7%A3%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%AF%B9%E8%B1%A1--Series">第一关：了解数据处理对象--Series</h3> 
<h4 id="%E7%BC%96%E7%A8%8B%E8%A6%81%E6%B1%82"><strong>编程要求</strong></h4> 
<blockquote> 
 <ul><li> <p>创建一个名为<code>series_a</code>的<code>series</code>数组，当中值为<code>[1,2,5,7]</code>,对应的索引为<code>['nu', 'li', 'xue', 'xi']</code>；</p> </li><li> <p>创建一个名为<code>dict_a</code>的字典，字典中包含如下内容<code>{'ting':1, 'shuo':2, 'du':32, 'xie':44}</code>；</p> </li><li> <p>将<code>dict_a</code>字典转化成名为<code>series_b</code>的<code>series</code>数组。</p> </li></ul> 
</blockquote> 
<p><strong>相关知识</strong></p> 
<p><code>Pandas</code>是为了解决数据分析任务而创建的，纳入了大量的库和标准数据模型，提供了高效地操作大型数据集所需的工具。 对于<code>Pandas</code>包，在<code>Python</code>中常见的导入方法如下：</p> 
<blockquote> 
 <p><code>from pandas import Series,DataFrame</code></p> 
 <p><code>import pandas as pd</code></p> 
</blockquote> 
<h4 id="Pandas%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><strong>Pandas中的数据结构</strong></h4> 
<ul><li><code>Series</code>: 一维数组，类似于<code>Python</code>中的基本数据结构<code>list</code>，区别是<code>Series</code>只允许存储相同的数据类型，这样可以更有效的使用内存，提高运算效率。就像数据库中的列数据；</li><li><code>DataFrame</code>: 二维的表格型数据结构。很多功能与<code>R</code>中的<code>data.frame</code>类似。可以将<code>DataFrame</code>理解为<code>Series</code>的容器；</li><li><code>Panel</code>：三维的数组，可以理解为<code>DataFrame</code>的容器。</li></ul> 
<p><strong>了解Series</strong></p> 
<p>为了开始使用<code>Pandas</code>，我们必需熟悉它的两个重要的数据结构：<code>Series</code> 和<code>DataFrame</code>。虽然它们不是每一个问题的通用解决方案，但可以提供一个坚实的，易于使用的大多数应用程序的基础。 <code>Series</code>是一个一维的类似的数组对象，包含一个数组的数据（任何<code>NumPy</code>的数据类型）和一个与数组关联的数据标签，被叫做索引 。最简单的<code>Series</code>是由一个数组的数据构成：</p> 
<ol><li><code>In [1]:obj=Series([4,7,-5,3])</code></li><li><code>In [2]:obj</code></li><li><code>Out[2]:</code></li><li><code>0 4</code></li><li><code>1 7</code></li><li><code>2 -5</code></li><li><code>3 3</code></li></ol> 
<p><code>Series</code>的交互式显示的字符串表示形式是索引在左边，值在右边。因为我们没有给数据指定索引，一个包含整数<code>0</code>到<code>N-1</code>这里<code>N</code>是数据的长度）的默认索引被创建。你可以分别的通过它的<code>values</code>和<code>index</code>属性来获取 <code>Series</code>的数组表示和索引对象：</p> 
<ol><li><code>In [3]: obj.values</code></li><li><code>Out[3]:array([4,7,-5,3])</code></li><li><code>In [4]: obj.index</code></li><li><code>Out[4]:Int64Index([0,1,2,3])</code></li></ol> 
<p>通常，需要创建一个带有索引来确定每一个数据点的<code>Series</code>。</p> 
<ol><li><code>In [5]:obj2=Series([4,7,-5,3],index=['d','b','a','c'])</code></li><li><code>In [6]:obj2</code></li><li><code>Out[6]:</code></li><li><code>d 4</code></li><li><code>b 7</code></li><li><code>a -5</code></li><li><code>c 3</code></li></ol> 
<p>如果你有一些数据在一个<code>Python</code>字典中，你可以通过传递字典来从这些数据创建一个<code>Series</code>，只传递一个字典的时候，结果<code>Series</code>中的索引将是排序后的字典的键。</p> 
<h4 id="%E7%AC%AC%E4%B8%80%E5%85%B3%E7%AD%94%E6%A1%88">第一关答案</h4> 
<pre><code class="language-python"># -*- coding: utf-8 -*-
from pandas import Series,DataFrame
import  pandas as pd

def create_series():
    '''
    返回值:
    series_a: 一个Series类型数据
    series_b: 一个Series类型数据
    dict_a：  一个字典类型数据
    '''
    # 请在此添加代码 完成本关任务
    # ********** Begin *********#
    series_a=Series([1,2,5,7],index=['nu','li','xue','xi'])
    dict_a={'ting':1,'shuo':2,'du':32,'xie':44}
    series_b=Series(dict_a)
    # ********** End **********#

    # 返回series_a,dict_a,series_b
    return series_a,dict_a,series_b
</code></pre> 
<h3 id="%E7%AC%AC%E4%BA%8C%E5%85%B3%EF%BC%9A%E4%BA%86%E8%A7%A3%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%AF%B9%E8%B1%A1-DataFrame">第二关：了解数据处理对象-DataFrame</h3> 
<h4>编程要求</h4> 
<blockquote> 
 <ul><li> <p>创建一个五行三列的名为<code>df1</code>的<code>DataFrame</code>数组，列名为 <code>[states,years,pops]</code>，行名<code>['one','two','three','four','five']</code>；</p> </li><li> <p>给<code>df1</code>添加新列，列名为<code>new_add</code>，值为<code>[7,4,5,8,2]</code>。</p> </li></ul> 
</blockquote> 
<h4 id="%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86"><strong>相关知识</strong></h4> 
<p><code>DataFrame</code>是一个表格型的数据结构，是以一个或多个二维块存放的数据表格（层次化索引），<code>DataFrame</code>既有行索引还有列索引，它有一组有序的列，每列既可以是不同类型（数值、字符串、布尔型）的数据，或者可以看做由<code>Series</code>组成的字典。 <strong>DataFrame创建:</strong></p> 
<ol><li><code>dictionary = {'state':['0hio','0hio','0hio','Nevada','Nevada'],</code></li><li><code>'year':[2000,2001,2002,2001,2002],</code></li><li><code>'pop':[1.5,1.7,3.6,2.4,2.9]}</code></li><li><code>frame = DataFrame(dictionary)</code></li></ol> 
<p><strong>修改行名：</strong></p> 
<ol><li><code>frame=DataFrame(dictionary,index=['one','two','three','four','five'])</code></li></ol> 
<p><strong>添加修改：</strong></p> 
<ol><li><code>frame['add']=[0,0,0,0,0]</code></li></ol> 
<p><strong>添加Series类型：</strong></p> 
<ol><li><code>value = Series([1,3,1,4,6,8],index = [0,1,2,3,4,5])</code></li><li><code>frame['add1'] = value</code></li></ol> 
<h4 id="%E7%AC%AC%E4%BA%8C%E5%85%B3%E7%AD%94%E6%A1%88">第二关答案</h4> 
<pre><code class="language-python"># -*- coding: utf-8 -*-
from pandas import Series,DataFrame
import  pandas as pd

def create_dataframe():
    '''
    返回值:
    df1: 一个DataFrame类型数据
    '''
    # 请在此添加代码 完成本关任务
    # ********** Begin *********#
    data={'states':['Ohio','Ohio','Ohio','Nevada','Nevada'],'years':[2000,2001,2002,2001,2002],'pops':[1.5,1.7,3.6,2.4,2.9]}
    df1=DataFrame(data,index=['one','two','three','four','five'])
    df1['new_add'] = [7,4,5,8,2]

    # ********** End **********#

    #返回df1
    return df1</code></pre> 
<h3 id="%E7%AC%AC%E4%B8%89%E5%85%B3%EF%BC%9A%E8%AF%BB%E5%8F%96CSV%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE">第三关：读取CSV格式数据</h3> 
<h4>编程要求</h4> 
<blockquote> 
 <ul><li> <p>将<code>test3/uk_rain_2014.csv</code>中的数据导入到<code>df1</code>中；</p> </li><li> <p>将列名修改为<code>['water_year','rain_octsep','outflow_octsep','rain_decfeb', 'outflow_decfeb', 'rain_junaug', 'outflow_junaug']</code>；</p> </li><li> <p>计算<code>df1</code>的总行数并存储在<code>length1</code>中。</p> </li></ul> 
</blockquote> 
<h4>相关知识</h4> 
<p>在使用机器学习工具包对数据进行修改、探索和分析之前，我们必须先讲外部数据导入。使用<code>Pandas</code>导入数据比<code>Numpy</code>要容易。在这里我们将使用英国降雨数据，数据已下好并放在本实训的当前文件夹。</p> 
<p>读取CSV</p> 
<blockquote> 
 <p><code># Reading a csv into Pandas.</code></p> 
 <p><code># 如果数据集中有中文的话，最好在里面加上 encoding = 'gbk' ，以避免乱码问题。后面的导出数据的时候也一样。</code></p> 
 <p><code>df = pd.read_csv('uk_rain_2014.csv', header=0)</code></p> 
</blockquote> 
<p>这里我们从<code>csv</code>文件里导入了数据，并储存在<code>DataFrame</code>中。这一步非常简单，你只需要调用<code>read_csv</code>然后将文件的路径传进去就行了。<code>header</code> 关键字告诉<code>Pandas</code>哪些是数据的列名。如果没有列名的话就将它设定为 <code>None</code>。 数据导入<code>pandas</code>之后，我们该怎么查看数据呢？</p> 
<p><strong>查看前n行</strong></p> 
<ol><li><code># Getting first x rows.</code></li><li><code>df.head(5)</code></li></ol> 
<p><strong>查看后n行</strong></p> 
<ol><li><code># Getting last x rows.</code></li><li><code>df.tail(5)</code></li></ol> 
<p><strong>查看总行数</strong></p> 
<ol><li><code># Finding out how many rows dataset has.</code></li><li><code>len(df)</code></li></ol> 
<p><strong>修改列名</strong></p> 
<p>我们通常使用列的名字来在<code>Pandas</code>中查找列。这一点很好而且易于使用，但是有时列名太长，我们需要缩短列名。</p> 
<ol><li><code># Changing column labels.</code></li><li><code>df.columns = ['water_year','rain_octsep','outflow_octsep','rain_decfeb', 'outflow_decfeb', 'rain_junaug', 'outflow_junaug']</code></li></ol> 
<h4 id="%E7%AC%AC%E4%B8%89%E5%85%B3%E7%AD%94%E6%A1%88">第三关答案</h4> 
<pre><code class="language-python"># -*- coding: utf-8 -*-
from pandas import Series,DataFrame
import  pandas as pd
def read_csv_data():
    '''
    返回值:
    df1: 一个DataFrame类型数据
    length1: 一个int类型数据
    '''
    # 请在此添加代码 完成本关任务
    # ********** Begin *********#
    df1=pd.read_csv('test3/uk_rain_2014.csv', header=0,encoding = 'gbk')
    df1.columns = ['water_year','rain_octsep','outflow_octsep','rain_decfeb', 'outflow_decfeb', 'rain_junaug', 'outflow_junaug']
    length1=len(df1)
    # ********** End **********#
    #返回df1,length1
    return df1,length1</code></pre> 
<h3 id="%E7%AC%AC%E5%9B%9B%E5%85%B3%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94%E2%80%94%E6%8E%92%E5%BA%8F">第四关：数据的基本操作——排序</h3> 
<h4>编程要求</h4> 
<blockquote> 
 <ul><li> <p>对代码中<code>s1</code>进行按索引排序，并将结果存储到<code>s2</code>；</p> </li><li> <p>对代码中<code>d1</code>进行按值排序（<code>index</code>为<code>f</code>），并将结果存储到<code>d2</code>。</p> </li></ul> 
</blockquote> 
<h4>相关知识</h4> 
<p>本关我们将学习处理<code>Series</code>和<code>DataFrame</code>中的数据的基本手段，我们将会探讨<code>Pandas</code>最为重要的一些功能。</p> 
<p><strong>对索引进行排序</strong></p> 
<p><code>Series</code>用<code>sort_index()</code>按索引排序，<code>sort_values()</code>按值排序； <code>DataFrame</code>也是用<code>sort_index()</code>和<code>sort_values()</code>。</p> 
<ol><li><code>In[73]: obj = Series(range(4), index=['d','a','b','c'])</code></li><li><code>In[74]: obj.sort_index() </code></li><li><code>Out[74]: </code></li><li><code>a 1</code></li><li><code>b 2</code></li><li><code>c 3</code></li><li><code>d 0</code></li><li><code>dtype: int64</code></li><li><li><code>In[78]: frame = DataFrame(np.arange(8).reshape((2,4)),index=['three', 'one'],columns=['d','a','b','c'])</code></li><li><code>In[79]: frame</code></li><li><code>Out[79]: </code></li><li><code>d a b c</code></li><li><code>three 0 1 2 3</code></li><li><code>one 4 5 6 7</code></li><li><li><code>In[86]: frame.sort_index()</code></li><li><code>Out[86]: </code></li><li><code>d a b c</code></li><li><code>one 4 5 6 7</code></li><li><code>three 0 1 2 3</code></li></ol> 
<p><strong>按行排序</strong></p> 
<ol><li><code>In[89]: frame.sort_index(axis=1, ascending=False)</code></li><li><code>Out[89]: </code></li><li><code>d c b a</code></li><li><code>three 0 3 2 1</code></li><li><code>one 4 7 6 5</code></li></ol> 
<p><strong>按值排序</strong></p> 
<p><code>Series</code>:</p> 
<ol><li><code>In[92]: obj = Series([4, 7, -3, 2])</code></li><li><code>In[94]: obj.sort_values()</code></li><li><code>Out[94]: </code></li><li><code>2 -3</code></li><li><code>3 2</code></li><li><code>0 4</code></li><li><code>1 7</code></li><li><code>dtype: int64</code></li></ol> 
<p><code>DataFrame</code>:</p> 
<ol><li><code>In[95]: frame = DataFrame({'b':[4, 7, -3, 2], 'a':[0, 1, 0, 1]})</code></li><li><code>In[97]: frame.sort_values(by='b') #DataFrame必须传一个by参数表示要排序的列</code></li><li><code>Out[97]: </code></li><li><code>a b</code></li><li><code>2 0 -3</code></li><li><code>3 1 2</code></li><li><code>0 0 4</code></li><li><code>1 1 7</code></li></ol> 
<h4 id="%E7%AC%AC%E5%9B%9B%E5%85%B3%E7%AD%94%E6%A1%88">第四关答案</h4> 
<pre><code class="language-python"># -*- coding: utf-8 -*-
from pandas import Series,DataFrame
import  pandas as pd
def sort_gate():
    '''
    返回值:
    s2: 一个Series类型数据
    d2: 一个DataFrame类型数据
    '''

    # s1是Series类型数据，d1是DataFrame类型数据
    s1 = Series([4, 3, 7, 2, 8], index=['z', 'y', 'j', 'i', 'e'])
    d1 = DataFrame({'e': [4, 2, 6, 1], 'f': [0, 5, 4, 2]})

    # 请在此添加代码 完成本关任务
    # ********** Begin *********#
    s2=s1.sort_index()
    d2=d1.sort_values(by='f')
    # ********** End **********#



    #返回s2,d2
    return s2,d2
</code></pre> 
<h3 id="%E7%AC%AC%E4%BA%94%E5%85%B3%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94%E2%80%94%E5%88%A0%E9%99%A4">第五关：数据的基本操作——删除</h3> 
<h4>编程要求</h4> 
<blockquote> 
 <ul><li> <p>在<code>s1</code>中删除<code>z</code>行，并赋值到<code>s2</code>；</p> </li><li> <p><code>d1</code>中删除<code>yy</code>列，并赋值到<code>d2</code>。</p> </li></ul> 
</blockquote> 
<h4>相关知识</h4> 
<p>删除指定轴上的项</p> 
<p>即删除<code>Series</code>的元素或<code>DataFrame</code>的某一行（列）的意思，我们可以通过对象的<code>drop(labels, axis=0)</code>方法实现此功能。</p> 
<p>删除<code>Series</code>的一个元素：</p> 
<ol><li><code>In[11]: ser = Series([4.5,7.2,-5.3,3.6], index=['d','b','a','c'])</code></li><li><code>In[13]: ser.drop('c')</code></li><li><code>Out[13]: </code></li><li><code>d 4.5</code></li><li><code>b 7.2</code></li><li><code>a -5.3</code></li><li><code>dtype: float64</code></li></ol> 
<p>删除<code>DataFrame</code>的行或列：</p> 
<ol><li><code>In[17]: df = DataFrame(np.arange(9).reshape(3,3), index=['a','c','d'], columns=['oh','te','ca'])</code></li><li><code>In[18]: df</code></li><li><code>Out[18]: </code></li><li><code>oh te ca</code></li><li><code>a 0 1 2</code></li><li><code>c 3 4 5</code></li><li><code>d 6 7 8</code></li><li><li><code>In[19]: df.drop('a')</code></li><li><code>Out[19]: </code></li><li><code>oh te ca</code></li><li><code>c 3 4 5</code></li><li><code>d 6 7 8</code></li><li><li><code>In[20]: df.drop(['oh','te'],axis=1)</code></li><li><code>Out[20]: </code></li><li><code>ca</code></li><li><code>a 2</code></li><li><code>c 5</code></li><li><code>d 8</code></li></ol> 
<p>需要注意的是<code>drop()</code>返回的是一个新对象，原对象不会被改变。</p> 
<h4 id="%E7%AC%AC%E4%BA%94%E5%85%B3%E7%AD%94%E6%A1%88">第五关答案</h4> 
<pre><code class="language-python"># -*- coding: utf-8 -*-
from pandas import Series,DataFrame
import numpy as np
import  pandas as pd

def delete_data():
    '''
    返回值:
    s2: 一个Series类型数据
    d2: 一个DataFrame类型数据
    '''

    # s1是Series类型数据，d1是DataFrame类型数据
    s1 = Series([5, 2, 4, 1], index=['v', 'x', 'y', 'z'])
    d1=DataFrame(np.arange(9).reshape(3,3), columns=['xx','yy','zz'])
    # 请在此添加代码 完成本关任务
    # ********** Begin *********#
    s2=s1.drop('z')
    d2=d1.drop(['yy'],axis=1)
    # ********** End **********#

    # 返回s2,d2
    return s2, d2</code></pre> 
<h3 id="%E7%AC%AC%E5%85%AD%E5%85%B3%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94%E2%80%94%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97">第六关：数据的基本操作——算术运算</h3> 
<h4>编程要求</h4> 
<blockquote> 
 <ul><li>让<code>df1</code>与<code>df2</code>相加得到<code>df3</code>，并设置默认填充值为<code>4</code>。</li></ul> 
</blockquote> 
<h4>相关知识</h4> 
<p><strong>算术运算（+，-，*，/）</strong></p> 
<p><code>DataFrame</code>中的算术运算是<code>df</code>中对应位置的元素的算术运算，如果没有共同的元素，则用<code>NaN</code>代替。</p> 
<ol><li><code>In[5]: df1 = DataFrame(np.arange(12.).reshape((3,4)),columns=list('abcd'))</code></li><li><code>In[6]: df2 = DataFrame(np.arange(20.).reshape((4,5)),columns=list('abcde'))</code></li><li><code>In[9]: df1+df2</code></li><li><code>Out[9]: </code></li><li><code>a b c d e</code></li><li><code>0 0 2 4 6 NaN</code></li><li><code>1 9 11 13 15 NaN</code></li><li><code>2 18 20 22 24 NaN</code></li><li><code>3 NaN NaN NaN NaN NaN</code></li></ol> 
<p>此外，如果我们想设置默认的其他填充值，而非<code>NaN</code>的话，可以传入填充值。</p> 
<ol><li><code>In[11]: df1.add(df2, fill_value=0)</code></li><li><code>Out[11]: </code></li><li><code>a b c d e</code></li><li><code>0 0 2 4 6 4</code></li><li><code>1 9 11 13 15 9</code></li><li><code>2 18 20 22 24 14</code></li><li><code>3 15 16 17 18 19</code></li></ol> 
<h4 id="%E7%AC%AC%E5%85%AD%E5%85%B3%E7%AD%94%E6%A1%88">第六关答案</h4> 
<pre><code class="language-python"># -*- coding: utf-8 -*-
from pandas import Series,DataFrame
import numpy as np
import  pandas as pd

def add_way():
    '''
    返回值:
    df3: 一个DataFrame类型数据
    '''

    # df1,df2是DataFrame类型数据
    df1 = DataFrame(np.arange(12.).reshape((3, 4)), columns=list('abcd'))
    df2 = DataFrame(np.arange(20.).reshape((4, 5)), columns=list('abcde'))

    # 请在此添加代码 完成本关任务
    # ********** Begin *********#
    df3=df1.add(df2,fill_value=4)

    # ********** End **********#

    # 返回df3
    return df3</code></pre> 
<h3 id="%E7%AC%AC%E4%B8%83%E5%85%B3%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E2%80%94%E2%80%94%E5%8E%BB%E9%87%8D">第七关：数据的基本操作——去重</h3> 
<h4>编程要求</h4> 
<blockquote> 
 <ul><li>去除<code>df1</code>中重复的行，并把结果保存到<code>df2</code>中。</li></ul> 
</blockquote> 
<h4>相关知识</h4> 
<p>duplicated()</p> 
<p><code>DataFrame</code>的<code>duplicated</code>方法返回一个布尔型<code>Series</code>，表示各行是否是重复行。具体用法如下：</p> 
<ol><li><code>In[1]: df = DataFrame({'k1':['one']*3 + ['two']*4, 'k2':[1,1,2,3,3,4,4]})</code></li><li><li><code>In[2]: df</code></li><li><code>Out[2]: </code></li><li><code>k1 k2</code></li><li><code>0 one 1</code></li><li><code>1 one 1</code></li><li><code>2 one 2</code></li><li><code>3 two 3</code></li><li><code>4 two 3</code></li><li><code>5 two 4</code></li><li><code>6 two 4</code></li><li><li><code>In[3]: df.duplicated()</code></li><li><code>Out[3]: </code></li><li><code>0 False</code></li><li><code>1 True</code></li><li><code>2 False</code></li><li><code>3 False</code></li><li><code>4 True</code></li><li><code>5 False</code></li><li><code>6 True</code></li><li><code>dtype: bool</code></li></ol> 
<p>drop_duplicates()</p> 
<p><code>drop_duplicates()</code>用于去除重复的行数，具体用法如下：</p> 
<ol><li><code>In[4]: df.drop_duplicates()</code></li><li><code>Out[4]: </code></li><li><code>k1 k2</code></li><li><code>0 one 1</code></li><li><code>2 one 2</code></li><li><code>3 two 3</code></li><li><code>5 two 4</code></li></ol> 
<h4 id="%E7%AC%AC%E4%B8%83%E5%85%B3%E7%AD%94%E6%A1%88">第七关答案</h4> 
<pre><code class="language-python"># -*- coding: utf-8 -*-
from pandas import Series,DataFrame
import  pandas as pd

def delete_duplicated():
    '''
    返回值:
    df2: 一个DataFrame类型数据
    '''

    # df1是DataFrame类型数据
    df1 = DataFrame({'k1': ['one'] * 3 + ['two'] * 4, 'k2': [1, 1, 2, 3, 3, 4, 4]})
    # 请在此添加代码 完成本关任务
    # ********** Begin *********#
    df2=df1.drop_duplicates()

    # ********** End **********#

    # 返回df2
    return df2</code></pre> 
<h3 id="%E7%AC%AC%E5%85%AB%E5%85%B3%EF%BC%9A%E5%B1%82%E6%AC%A1%E5%8C%96%E7%B4%A2%E5%BC%95">第八关：层次化索引</h3> 
<h4>编程要求</h4> 
<blockquote> 
 <ul><li>对<code>s1</code>进行数据重塑，转化成<code>DataFrame</code>类型，并复制到<code>d1</code>。</li></ul> 
</blockquote> 
<h4>相关知识</h4> 
<p><strong>层次化索引</strong></p> 
<p>层次化索引(<code>hierarchical indexing</code>)是<code>pandas</code>的一项重要功能，它使我们能在一个轴上拥有多个（两个以上）索引级别。请看以下例子：</p> 
<ol><li><code>In[1]:data = Series(np.random.randn(10), index = [['a', 'a', 'a', 'b', 'b', 'b', 'c', 'c', 'd', 'd' ],[1,2,3,1,2,3,1,2,2,3]])</code></li><li><code>In[2]:data</code></li><li><code>Out[2]:</code></li><li><code>a 1 0.169239</code></li><li><code>2 0.689271</code></li><li><code>3 0.879309</code></li><li><code>b 1 -0.699176</code></li><li><code>2 0.260446</code></li><li><code>3 -0.321751</code></li><li><code>c 1 0.893105</code></li><li><code>2 0.757505</code></li><li><code>d 2 -1.223344</code></li><li><code>3 -0.802812</code></li><li><code>dtype: float64</code></li></ol> 
<p><strong>索引方式</strong></p> 
<ol><li><code>In[3]:data['b':'d']</code></li><li><code>Out[3]:</code></li><li><code>b 1 -0.699176</code></li><li><code>2 0.260446</code></li><li><code>3 -0.321751</code></li><li><code>c 1 0.893105</code></li><li><code>2 0.757505</code></li><li><code>d 2 -1.223344</code></li><li><code>3 -0.802812</code></li><li><code>dtype: float64</code></li></ol> 
<p><strong>内层选取</strong></p> 
<ol><li><code>In[4]:data[:, 2]</code></li><li><code>Out[4]:</code></li><li><code>a 0.689271</code></li><li><code>b 0.260446</code></li><li><code>c 0.757505</code></li><li><code>d -1.223344</code></li><li><code>dtype: float64</code></li></ol> 
<p><strong>数据重塑</strong></p> 
<p>将<code>Series</code>转化成<code>DataFrame</code>:</p> 
<ol><li><code>in[5]:data.unstack()</code></li><li><code>Out[5]:</code></li><li><code>1 2 3</code></li><li><code>a 0.169239 0.689271 0.879309</code></li><li><code>b -0.699176 0.260446 -0.321751</code></li><li><code>c 0.893105 0.757505 NaN</code></li><li><code>d NaN -1.223344 -0.802812</code></li></ol> 
<h4 id="%E7%AC%AC%E5%85%AB%E5%85%B3%E7%AD%94%E6%A1%88">第八关答案</h4> 
<pre><code class="language-python"># -*- coding: utf-8 -*-
from pandas import Series,DataFrame
import  pandas as pd
import numpy as np
def suoying():
    '''
    返回值:
    d1: 一个DataFrame类型数据
    '''
    #s1是Series类型数据
    s1=Series(np.random.randn(10),
           index=[['a', 'a', 'a', 'b', 'b', 'b', 'c', 'c', 'd', 'd'], [1, 2, 3, 1, 2, 3, 1, 2, 2, 3]])
    # 请在此添加代码 完成本关任务
    # ********** Begin *********#
    d1=s1.unstack()

    # ********** End **********#

    # 返回d1
    return d1



suoying()</code></pre> 
<p></p> 
<p><strong>数据采集习题参考答案，会持续更新，点个关注防丢失。</strong></p> 
<p><strong>创作不易，一键三连给博主一个支持呗。</strong></p> 
<p></p> 
<p style="text-align:center;"><img alt="" height="266" src="https://images2.imgbox.com/a6/a8/ukLc7y84_o.png" width="479"></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/01f55640d3fb29881b30c20b1c721860/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Windows 中使用 VS2019 开发 CMake 项目</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e2b135968330df04283f3fc4d21f9f74/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL 基本的SELECT语句</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>