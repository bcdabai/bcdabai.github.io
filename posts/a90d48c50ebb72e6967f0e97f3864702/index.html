<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>DMX512输出协议详解 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="DMX512输出协议详解" />
<meta property="og:description" content="目录
​编辑
1、DMX512协议简介
2、DMX512协议分析
DMX512指令帧介绍
DMX512信息包
3、DMX512接口电路
4、参考代码
1、DMX512协议简介 DMX512是一种用于舞台灯光控制的数字传输协议。它是由美国舞台灯光协会（USITT）于1990年发布的工业标准，全称为USITT DMX512(1990)。DMX512协议定义了灯光控制器与灯具设备之间进行数据传输的电气特性、数据协议和数据格式等方面的内容。通过DMX512协议，可以实现对舞台灯光设备的精确控制，包括调整亮度、颜色、运动等。DMX512协议常用于舞台演出、演唱会、剧院等场合，以及其他需要对灯光进行精确控制的应用领域。
DMX512是一种用于控制舞台灯光和特效设备的通信协议。它在物理层采用EIA-485差分信号，并结合可变尺寸和基于分组的通信协议。DMX512是单向的，意味着只能从控制器发送数据到灯光和特效设备，而不能反向传输数据。
DMX512协议不包含自动错误检查和纠正功能，因此不适用于一些危险应用，如烟火或舞台装置的移动。电磁干扰、静电放电、不正确的电缆端接、电缆过长或电缆质量等因素可能会导致虚假触发或通信错误。
2、DMX512协议分析 DMX512指令帧介绍 每一个DMX 控制字节叫做一个指令帧，称作一个控制通道，可以控制灯光设备的一个或几个功能。一个DMX 指令帧由1个开始位(S)、8个数据位(D0-D8)和2个结束位(E)共11位构成，采用单向异步串行传输，如图：
图1 中虚线内控制指令中的S为开始位，宽度为一个比特，是受控灯具准备接收并解码控制数据的开始标志;
E为结束位，宽度为两个比特，表示一个指令帧的结束;
D0～ D7为8 位控制数据，其电平组合从00000000一11111111 共有256个状态(对应十进制数的0～255)，控制灯光的亮度时，可产生256个亮度等级，0000~ (0)对应灯光最暗，11111111(255)对应灯光最亮。
DMX512指令的位宽(每比特宽度)是4 us，每一个指令帧11位，故指令帧宽度为44 us，传输速率为1/44us = 250 kbps。
DMX512信息包 一个完整的DMX512信息包(Packet)由一个MTBP位、一个Break 位、一个MAB位、一个SC 和512个数据帧构成。
MTBP(Mark TimeBetween Packets)标志着一个完整的信息包发送完毕，是下一个信息包即将开始的“空闲位”，高电平有效。
Break为中断位，对应一个信息包结束后的程序复位阶段，宽度不少于两个帧(22 比特)。程序复位结束后应发送控制数据，
MAB位，由于每一个数据帧的第一位(即开始位)为低电平，所以必须用一个高电平脉冲间隔前后两个低电平脉冲，这个起间隔、分离作用的高电平脉冲即MAB(Mark After Break)，此脉冲一到，意味着“新一轮”的控制又开始了。
SC(Start Code)意为开始代码帧(图1中的第0帧)，和此后到来的数据帧一样，也是由11 位构成，除最后的两个高电平的结束位之外，其他9位全部是低电平，通常将其叫做第0 帧或第0通道(Ch~nel No 0)，可理解为一个不存在的通道(Non一~istent Channe1)。
DMX512 信息包定时表：
表1 是DMX512 信息包的定时表，表中NS意为自己设定，宽度没有严格限制，由程序设计者自行决定，比如MTBP的宽度可以介于0～1秒之间，其他建议采用典型值。
调光控制台每发送一个信息包，可以对全部512个受控通道形成一次全面的控制。发送一个信息包的时间大约是23 ms，每秒钟将对所有512个受控通道完成44 次控制，即受控光路的刷新频率44 Hz，如果实际受控通道少于512个，那么刷新频率将相应提高。
3、DMX512接口电路 以下是使用RJ45连接器的接线及驱动电路 ：
(XLR-5和RJ45基本类似)
表2 DMX512 设备使用RJ45连接器的接线表
4、参考代码 #include &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a90d48c50ebb72e6967f0e97f3864702/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-06T11:29:04+08:00" />
<meta property="article:modified_time" content="2024-01-06T11:29:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">DMX512输出协议详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" height="243" src="https://images2.imgbox.com/d9/0c/YcaCPTsV_o.png" width="394"></h3> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E2%80%8B%E7%BC%96%E8%BE%91-toc" style="margin-left:40px;"><a href="#%E2%80%8B%E7%BC%96%E8%BE%91" rel="nofollow">​编辑</a></p> 
<p id="1%E3%80%81DMX512%E5%8D%8F%E8%AE%AE%E7%AE%80%E4%BB%8B-toc" style="margin-left:40px;"><a href="#1%E3%80%81DMX512%E5%8D%8F%E8%AE%AE%E7%AE%80%E4%BB%8B" rel="nofollow">1、DMX512协议简介</a></p> 
<p id="2%E3%80%81DMX512%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90-toc" style="margin-left:40px;"><a href="#2%E3%80%81DMX512%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90" rel="nofollow">2、DMX512协议分析</a></p> 
<p id="DMX512%E6%8C%87%E4%BB%A4%E5%B8%A7%E4%BB%8B%E7%BB%8D-toc" style="margin-left:120px;"><a href="#DMX512%E6%8C%87%E4%BB%A4%E5%B8%A7%E4%BB%8B%E7%BB%8D" rel="nofollow">DMX512指令帧介绍</a></p> 
<p id="DMX512%E4%BF%A1%E6%81%AF%E5%8C%85-toc" style="margin-left:120px;"><a href="#DMX512%E4%BF%A1%E6%81%AF%E5%8C%85" rel="nofollow">DMX512信息包</a></p> 
<p id="3%E3%80%81DMX512%E6%8E%A5%E5%8F%A3%E7%94%B5%E8%B7%AF-toc" style="margin-left:40px;"><a href="#3%E3%80%81DMX512%E6%8E%A5%E5%8F%A3%E7%94%B5%E8%B7%AF" rel="nofollow">3、DMX512接口电路</a></p> 
<p id="4%E3%80%81%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#4%E3%80%81%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81" rel="nofollow">4、参考代码</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h3 id="1%E3%80%81DMX512%E5%8D%8F%E8%AE%AE%E7%AE%80%E4%BB%8B">1、DMX512协议简介</h3> 
<p>DMX512是一种用于舞台灯光控制的数字传输协议。它是由美国舞台灯光协会（USITT）于1990年发布的工业标准，全称为USITT DMX512(1990)。DMX512协议定义了灯光控制器与灯具设备之间进行数据传输的电气特性、数据协议和数据格式等方面的内容。通过DMX512协议，可以实现对舞台灯光设备的精确控制，包括调整亮度、颜色、运动等。DMX512协议常用于舞台演出、演唱会、剧院等场合，以及其他需要对灯光进行精确控制的应用领域。</p> 
<p>DMX512是一种用于控制舞台灯光和特效设备的通信协议。它在物理层采用EIA-485差分信号，并结合可变尺寸和基于分组的通信协议。DMX512是单向的，意味着只能从控制器发送数据到灯光和特效设备，而不能反向传输数据。</p> 
<p>DMX512协议不包含自动错误检查和纠正功能，因此不适用于一些危险应用，如烟火或舞台装置的移动。电磁干扰、静电放电、不正确的电缆端接、电缆过长或电缆质量等因素可能会导致虚假触发或通信错误。</p> 
<hr> 
<h3 id="2%E3%80%81DMX512%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90">2、DMX512协议分析</h3> 
<h5 id="DMX512%E6%8C%87%E4%BB%A4%E5%B8%A7%E4%BB%8B%E7%BB%8D" style="background-color:transparent;">DMX512指令帧介绍</h5> 
<p>每一个DMX 控制字节叫做一个指令帧，称作一个控制通道，可以控制灯光设备的一个或几个功能。一个DMX 指令帧由1个开始位(S)、8个数据位(D0-D8)和2个结束位(E)共11位构成，采用单向异步串行传输，如图：</p> 
<p><img alt="" height="198" src="https://images2.imgbox.com/18/5a/a3LGpSp7_o.png" width="460"></p> 
<p>图1 中虚线内控制指令中的S为开始位，宽度为一个比特，是受控灯具准备接收并解码控制数据的开始标志;</p> 
<p>E为结束位，宽度为两个比特，表示一个指令帧的结束;</p> 
<p>D0～ D7为8 位控制数据，其电平组合从00000000一11111111 共有256个状态(对应十进制数的0～255)，控制灯光的亮度时，可产生256个亮度等级，0000~ (0)对应灯光最暗，11111111(255)对应灯光最亮。</p> 
<p>DMX512指令的位宽(每比特宽度)是4 us，每一个指令帧11位，故指令帧宽度为44 us，传输速率为1/44us = 250 kbps。</p> 
<h5 id="DMX512%E4%BF%A1%E6%81%AF%E5%8C%85" style="background-color:transparent;">DMX512信息包</h5> 
<p>一个完整的DMX512信息包(Packet)由一个MTBP位、一个Break 位、一个MAB位、一个SC 和512个数据帧构成。</p> 
<p><img alt="" height="165" src="https://images2.imgbox.com/34/21/ZCkO3Ibs_o.png" width="664"></p> 
<p>MTBP(Mark TimeBetween Packets)标志着一个完整的信息包发送完毕，是下一个信息包即将开始的“空闲位”，高电平有效。</p> 
<p>Break为中断位，对应一个信息包结束后的程序复位阶段，宽度不少于两个帧(22 比特)。程序复位结束后应发送控制数据，</p> 
<p>MAB位，由于每一个数据帧的第一位(即开始位)为低电平，所以必须用一个高电平脉冲间隔前后两个低电平脉冲，这个起间隔、分离作用的高电平脉冲即MAB(Mark After Break)，此脉冲一到，意味着“新一轮”的控制又开始了。</p> 
<p>SC(Start Code)意为开始代码帧(图1中的第0帧)，和此后到来的数据帧一样，也是由11 位构成，除最后的两个高电平的结束位之外，其他9位全部是低电平，通常将其叫做第0 帧或第0通道(Ch~nel No 0)，可理解为一个不存在的通道(Non一~istent Channe1)。</p> 
<p>DMX512 信息包定时表：</p> 
<p><img alt="" height="287" src="https://images2.imgbox.com/2d/d5/JVMkPU0f_o.png" width="576"></p> 
<p>表1 是DMX512 信息包的定时表，表中NS意为自己设定，宽度没有严格限制，由程序设计者自行决定，比如MTBP的宽度可以介于0～1秒之间，其他建议采用典型值。</p> 
<p>调光控制台每发送一个信息包，可以对全部512个受控通道形成一次全面的控制。发送一个信息包的时间大约是23 ms，每秒钟将对所有512个受控通道完成44 次控制，即受控光路的刷新频率44 Hz，如果实际受控通道少于512个，那么刷新频率将相应提高。</p> 
<h3 id="3%E3%80%81DMX512%E6%8E%A5%E5%8F%A3%E7%94%B5%E8%B7%AF">3、DMX512接口电路</h3> 
<p>以下是使用RJ45连接器的接线及驱动电路 ：</p> 
<p>(XLR-5和RJ45基本类似)</p> 
<p>表2 DMX512 设备使用RJ45连接器的接线表</p> 
<p><img alt="" height="326" src="https://images2.imgbox.com/cc/47/Bm2EUEfC_o.png" width="583"></p> 
<p><img alt="" height="336" src="https://images2.imgbox.com/1c/d4/fhbjORj2_o.png" width="607"></p> 
<h3 id="4%E3%80%81%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81">4、参考代码</h3> 
<pre><code class="language-cpp">#include "stm32f0xx.h"

// 定义DMX512数据包长度
#define DMX_PACKET_LENGTH 512

// 定义WS2812B LED串的数量
#define NUM_LEDS 8

// 定义WS2812B数据包长度
#define WS2812B_PACKET_LENGTH (NUM_LEDS * 24)

// 定义DMX512数据包缓冲区
uint8_t dmxPacket[DMX_PACKET_LENGTH];

// 定义WS2812B数据包缓冲区
uint8_t ws2812bPacket[WS2812B_PACKET_LENGTH];

// 初始化USART1
void USART1_Init(void) {
    // 启用USART1时钟
    RCC-&gt;APB2ENR |= RCC_APB2ENR_USART1EN;

    // 配置USART1引脚
    GPIOA-&gt;MODER |= GPIO_MODER_MODER9_1; // PA9作为USART1的TX引脚
    GPIOA-&gt;AFR[1] |= (1 &lt;&lt; (4 * (9 - 8))); // 将PA9配置为USART1的TX引脚

    // 配置USART1
    USART1-&gt;BRR = 48000000 / 250000; // 设置波特率为250000
    USART1-&gt;CR1 |= USART_CR1_TE; // 使能发送
    USART1-&gt;CR1 |= USART_CR1_UE; // 使能USART1
}

// 发送DMX512数据包
void DMX512_SendPacket(uint8_t *packet, uint16_t length) {
    for (uint16_t i = 0; i &lt; length; i++) {
        while (!(USART1-&gt;ISR &amp; USART_ISR_TXE)); // 等待发送缓冲区为空
        USART1-&gt;TDR = packet[i]; // 发送数据
    }
}

// 初始化WS2812B
void WS2812B_Init(void) {
    // 配置GPIOA引脚0-7为推挽输出
    GPIOA-&gt;MODER |= GPIO_MODER_MODER0_0 | GPIO_MODER_MODER1_0 | GPIO_MODER_MODER2_0 | GPIO_MODER_MODER3_0 |
                    GPIO_MODER_MODER4_0 | GPIO_MODER_MODER5_0 | GPIO_MODER_MODER6_0 | GPIO_MODER_MODER7_0;

    // 配置GPIOA引脚0-7的输出速度为高速
    GPIOA-&gt;OSPEEDR |= GPIO_OSPEEDER_OSPEEDR0 | GPIO_OSPEEDER_OSPEEDR1 | GPIO_OSPEEDER_OSPEEDR2 | GPIO_OSPEEDER_OSPEEDR3 |
                      GPIO_OSPEEDER_OSPEEDR4 | GPIO_OSPEEDER_OSPEEDR5 | GPIO_OSPEEDER_OSPEEDR6 | GPIO_OSPEEDER_OSPEEDR7;
}

// 发送WS2812B数据包
void WS2812B_SendPacket(uint8_t *packet, uint16_t length) {
    for (uint16_t i = 0; i &lt; length; i++) {
        uint8_t data = packet[i];
        for (uint8_t j = 0; j &lt; 8; j++) {
            if (data &amp; 0x80) {
                GPIOA-&gt;BSRR = GPIO_BSRR_BS_0; // 设置引脚为高电平
                __NOP(); // 空操作，延时约400ns
                GPIOA-&gt;BRR = GPIO_BRR_BR_0; // 设置引脚为低电平
                __NOP(); // 空操作，延时约850ns
            } else {
                GPIOA-&gt;BSRR = GPIO_BSRR_BS_0; // 设置引脚为高电平
                __NOP(); // 空操作，延时约850ns
                GPIOA-&gt;BRR = GPIO_BRR_BR_0; // 设置引脚为低电平
                __NOP(); // 空操作，延时约400ns
            }
            data &lt;&lt;= 1;
        }
    }
}

int main(void) {
    // 初始化USART1
    USART1_Init();

    // 初始化WS2812B
    WS2812B_Init();

    while (1) {
        // 发送DMX512数据包
        DMX512_SendPacket(dmxPacket, DMX_PACKET_LENGTH);

        // 发送WS2812B数据包
        WS2812B_SendPacket(ws2812bPacket, WS2812B_PACKET_LENGTH);
    }
}</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3c6174fe4871a8a4fc29fec94188b6c2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">互联网防反爬机制的六种反爬技术大解析</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6304476e0372efa1b869a5513816f1b4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">阿里云服务器Centos安装宝塔面板</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>