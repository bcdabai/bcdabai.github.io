<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习 之朴素贝叶斯 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习 之朴素贝叶斯" />
<meta property="og:description" content="朴素贝叶斯 朴素贝叶斯高斯朴素贝叶斯中的参数高斯朴素贝叶斯的使用模型评估指标布里尔分数对数似然 高斯朴素贝叶斯对不同数据集的效果不同样本量对于高斯朴素贝叶斯的影响 朴素贝叶斯 贝叶斯模型同样是流行的十大挖掘算法之一，属于有监督的学习算法，是专门用于解决分类问题的模型，该模型的数学理论并不复杂，只需要具备概率论和数理统计的部分知识，该分类器的实现思想非常简单，即通过已知类别的训练数据及计算样本先验概率，然后利用贝叶斯公式测算未知类别样本属于某个类别的后验概率，最终以最大的后验概率所对应的类别作为样本的预测值。
朴素贝叶斯模型，在对于未知类别的样本进行预测时，有几大优点：
首先算法在运算过程中简单而且高效其次算法拥有古典概型的理论支撑分类效率稳定最后算法对于缺失数据和异常数据不太敏感 同时缺点也是存在的：
模型的判断结果依赖于先验概率，所以分类结果存在一定的错误率对于输入的自变量X要求具有相同的特征模型的前提假设在实际应用中很难得满足。 由于该模型只用到数理统计中的朴素贝叶斯公式，所以在这里就不再赘述，相信大家也都有所了解朴素贝叶斯。
高斯朴素贝叶斯中的参数 GaussianNB(priors=None) # 没错，它的主要参数就这一个。 该参数用于指定因变量各类别的先验概率，默认以数据集中的类别频率作为先验概率 所以通常情况下，我们不对高斯普速被淹死，做任何参数的调整。 高斯朴素贝叶斯的使用 from sklearn.naive_bayes import GaussianNB from sklearn.model_selection import train_test_split from sklearn.metrics import confusion_matrix as CM from sklearn.datasets import load_digits digits=load_digits() x,y=digits.data,digits.target x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.3,random_state=10) gnb=GaussianNB().fit(x_train,y_train) gnb.score(x_train,y_train) gnb.predict_proba(x_test).sum(axis=1).shape y_pro=gnb.predict(x_test) CM(y_test,y_pro) 模型评估指标 布里尔分数 from sklearn.metrics import brier_score_loss brier_score_loss(y_true # 真实标签 , y_prob # 标签正概率 , pos_label=None # 填写正样本标签 ) 需要注意的是布里尔分数只能用于二分类，不能用于多分类。 他返回的是一个浮点类型的数据，表示的是模型丢失数据的比例。所以越小越好。 对数似然 from sklearn.metrics import log_loss log_loss(y_true# 真是标签结果 , y_prede # 预测结果，predict_proba返回的值，不是predict返回的值 ) 返回的是损失值，因此对数自然函数的取值越小，证明概率估计越准确。 高斯朴素贝叶斯对不同数据集的效果 from sklearn." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ee985aeec5758b59837422e90464909d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-17T19:20:39+08:00" />
<meta property="article:modified_time" content="2021-07-17T19:20:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习 之朴素贝叶斯</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>朴素贝叶斯</h4> 
 <ul><li><ul><li><ul><li><a href="#_2" rel="nofollow">朴素贝叶斯</a></li><li><a href="#_17" rel="nofollow">高斯朴素贝叶斯中的参数</a></li><li><a href="#_24" rel="nofollow">高斯朴素贝叶斯的使用</a></li><li><a href="#_40" rel="nofollow">模型评估指标</a></li><li><ul><li><a href="#_41" rel="nofollow">布里尔分数</a></li><li><a href="#_52" rel="nofollow">对数似然</a></li></ul> 
    </li><li><a href="#_62" rel="nofollow">高斯朴素贝叶斯对不同数据集的效果</a></li><li><a href="#_186" rel="nofollow">不同样本量对于高斯朴素贝叶斯的影响</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h4><a id="_2"></a>朴素贝叶斯</h4> 
<p>贝叶斯模型同样是流行的十大挖掘算法之一，属于有监督的学习算法，是专门用于解决分类问题的模型，该模型的数学理论并不复杂，只需要具备概率论和数理统计的部分知识，该分类器的实现思想非常简单，即通过已知类别的训练数据及计算样本先验概率，然后利用贝叶斯公式测算未知类别样本属于某个类别的后验概率，最终以最大的后验概率所对应的类别作为样本的预测值。</p> 
<p>朴素贝叶斯模型，在对于未知类别的样本进行预测时，有几大优点：</p> 
<ul><li>首先算法在运算过程中简单而且高效</li><li>其次算法拥有古典概型的理论支撑分类效率稳定</li><li>最后算法对于缺失数据和异常数据不太敏感</li></ul> 
<p>同时缺点也是存在的：</p> 
<ul><li>模型的判断结果依赖于先验概率，所以分类结果存在一定的错误率</li><li>对于输入的自变量X要求具有相同的特征</li><li>模型的前提假设在实际应用中很难得满足。</li></ul> 
<p>由于该模型只用到数理统计中的朴素贝叶斯公式，所以在这里就不再赘述，相信大家也都有所了解朴素贝叶斯。</p> 
<h4><a id="_17"></a>高斯朴素贝叶斯中的参数</h4> 
<pre><code class="prism language-python">GaussianNB<span class="token punctuation">(</span>priors<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token comment"># 没错，它的主要参数就这一个。</span>
该参数用于指定因变量各类别的先验概率，默认以数据集中的类别频率作为先验概率
所以通常情况下，我们不对高斯普速被淹死，做任何参数的调整。
</code></pre> 
<h4><a id="_24"></a>高斯朴素贝叶斯的使用</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> GaussianNB
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> confusion_matrix <span class="token keyword">as</span> CM
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_digits
digits<span class="token operator">=</span>load_digits<span class="token punctuation">(</span><span class="token punctuation">)</span>
x<span class="token punctuation">,</span>y<span class="token operator">=</span>digits<span class="token punctuation">.</span>data<span class="token punctuation">,</span>digits<span class="token punctuation">.</span>target
x_train<span class="token punctuation">,</span>x_test<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>y_test<span class="token operator">=</span>train_test_split<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
gnb<span class="token operator">=</span>GaussianNB<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>
gnb<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>
gnb<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>shape
y_pro<span class="token operator">=</span>gnb<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
CM<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pro<span class="token punctuation">)</span>

</code></pre> 
<h4><a id="_40"></a>模型评估指标</h4> 
<h5><a id="_41"></a>布里尔分数</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> brier_score_loss
brier_score_loss<span class="token punctuation">(</span>y_true <span class="token comment"># 真实标签</span>
				<span class="token punctuation">,</span> y_prob <span class="token comment"># 标签正概率</span>
				<span class="token punctuation">,</span> pos_label<span class="token operator">=</span><span class="token boolean">None</span> <span class="token comment"># 填写正样本标签</span>
				<span class="token punctuation">)</span>
需要注意的是布里尔分数只能用于二分类，不能用于多分类。
他返回的是一个浮点类型的数据，表示的是模型丢失数据的比例。所以越小越好。
</code></pre> 
<h5><a id="_52"></a>对数似然</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> log_loss
log_loss<span class="token punctuation">(</span>y_true<span class="token comment"># 真是标签结果</span>
		<span class="token punctuation">,</span> y_prede <span class="token comment"># 预测结果，predict_proba返回的值，不是predict返回的值  </span>
		<span class="token punctuation">)</span>
返回的是损失值，因此对数自然函数的取值越小，证明概率估计越准确。
</code></pre> 
<h4><a id="_62"></a>高斯朴素贝叶斯对不同数据集的效果</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> GaussianNB
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>colors <span class="token keyword">import</span> ListedColormap
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_moons<span class="token punctuation">,</span> make_circles<span class="token punctuation">,</span> make_classification

<span class="token comment">######生成三种数据集######</span>
<span class="token comment"># 二分类数据集</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> make_classification<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token comment">#生成100个样本</span>
 n_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token comment">#有两个特征</span>
 n_redundant<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">#添加冗余特征0个</span>
 n_informative<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">#包含信息的特征是2个</span>
 random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token comment">#随机模式1</span>
n_clusters_per_class<span class="token operator">=</span><span class="token number">1</span> <span class="token comment">#每个簇内包含的标签类别有1个</span>
 <span class="token punctuation">)</span>
rng <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>RandomState<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">#生成一种随机模式</span>
X <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">*</span> rng<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>size<span class="token operator">=</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span> <span class="token comment">#加减0~1之间的随机数</span>
linearly_separable <span class="token operator">=</span> <span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token comment">#生成了新的X，依然可以画散点图来观察一下特征的分布</span>
<span class="token comment">#plt.scatter(X[:,0],X[:,1])</span>

<span class="token comment">#用make_moons创建月亮型数据，make_circles创建环形数据，并将三组数据打包起来放在列表datasets中</span>
moons<span class="token operator">=</span>make_moons<span class="token punctuation">(</span>noise<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
circles<span class="token operator">=</span>make_circles<span class="token punctuation">(</span>noise<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> factor<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
datasets <span class="token operator">=</span> <span class="token punctuation">[</span>moons<span class="token punctuation">,</span>circles<span class="token punctuation">,</span>linearly_separable<span class="token punctuation">]</span>


figure <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
i<span class="token operator">=</span><span class="token number">1</span>
<span class="token comment">#设置用来安排图像显示位置的全局变量i i = 1</span>
<span class="token comment">#开始迭代数据，对datasets中的数据进行for循环</span>
<span class="token keyword">for</span> ds_index<span class="token punctuation">,</span> ds <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>datasets<span class="token punctuation">)</span><span class="token punctuation">:</span>
    X<span class="token punctuation">,</span> y <span class="token operator">=</span> ds
    <span class="token comment"># 对数据进行标准化处理</span>
    X <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    <span class="token comment">#划分数据集</span>
    X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">,</span>
random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

    <span class="token comment">#定数据范围，以便后续进行画图背景的确定</span>
    <span class="token comment">#注意X[:,0]指横坐标，X[：，1]指纵坐标</span>
    x1_min<span class="token punctuation">,</span> x1_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">.5</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">.5</span>
    x2_min<span class="token punctuation">,</span> x2_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">.5</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">.5</span>

    <span class="token comment">#使画板上每个点组成坐标的形式（没间隔0.2取一个），array1表示横坐标，array2表示纵坐标</span>
    array1<span class="token punctuation">,</span>array2 <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>x1_min<span class="token punctuation">,</span> x1_max<span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>x2_min<span class="token punctuation">,</span> x2_max<span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 颜色列表</span>
    cm_bright <span class="token operator">=</span> ListedColormap<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'#FF0000'</span><span class="token punctuation">,</span> <span class="token string">'#0000FF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">########## 原始数据的现实  #########</span>

    <span class="token comment"># 用画板上六个图片位置（3，2）的第i个</span>
    ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>datasets<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>

    <span class="token comment"># 便签添加</span>
    <span class="token keyword">if</span> ds_index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Input data"</span><span class="token punctuation">)</span>

    <span class="token comment">#画出训练数据集散点图</span>
    ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">#横坐标</span>
               X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">#纵坐标</span>
               c<span class="token operator">=</span>y_train<span class="token punctuation">,</span><span class="token comment">#意思是根据y_train标签从cm_bright颜色列表中取出对应的颜色，也就是说相同的标签有相同的颜色。</span>
               cmap <span class="token operator">=</span> cm_bright<span class="token punctuation">,</span> <span class="token comment">#颜色列表</span>
               edgecolors <span class="token operator">=</span> <span class="token string">'k'</span><span class="token comment">#生成散点图，每一个点边缘的颜色</span>
               <span class="token punctuation">)</span>
    <span class="token comment">#画出测试数据集的散点图，其中比训练集多出alpha = 0.4参数，以分辨训练测试集</span>
    ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_test<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X_test<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y_test<span class="token punctuation">,</span>cmap <span class="token operator">=</span> cm_bright<span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">0.4</span><span class="token punctuation">,</span> edgecolors <span class="token operator">=</span> <span class="token string">'k'</span><span class="token punctuation">)</span>
    <span class="token comment">#显示的坐标范围</span>
    ax<span class="token punctuation">.</span>set_xlim<span class="token punctuation">(</span>array1<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> array1<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span>array2<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> array2<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">#不显示坐标值</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment">#i+1显示在下一个子图版上画图</span>
    i <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token comment">####### 经过决策的数据显示 #######</span>
    ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>datasets<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token comment">#实例化训练模型</span>
    gnd <span class="token operator">=</span> GaussianNB<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
    score <span class="token operator">=</span> gnd<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>

    <span class="token comment"># np.c_是能够将两个数组组合起来的函数</span>
    <span class="token comment"># ravel()能够将一个多维数组转换成一维数组</span>
    <span class="token comment">#通过对画板上每一个点的预测值确定分类结果范围，并以此为依据通，通过不同的颜色展现出来范围</span>

    <span class="token comment"># 为了展示不同概率对应不同的颜色就不用这句代码作为contourf的z参数了Z = clf.predict(np.c_[array1.ravel(), array2.ravel()])</span>
    <span class="token comment"># 通过计算每一个结果对应的概率，并选出其中的最大值作为contourf参数</span>
    Z <span class="token operator">=</span> gnd<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>array1<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> array2<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Z <span class="token operator">=</span> Z<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>array1<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    cm <span class="token operator">=</span> plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>RdBu <span class="token comment"># 自动选取颜色的实例化模型。</span>
    ax<span class="token punctuation">.</span>contourf<span class="token punctuation">(</span>array1<span class="token comment">#画板横坐标。</span>
                <span class="token punctuation">,</span> array2<span class="token comment">#画板纵坐标</span>
                <span class="token punctuation">,</span> Z<span class="token comment"># 画板每个点对应的预测值m,并据此来确定底底板的颜色。</span>
                <span class="token punctuation">,</span> cmap<span class="token operator">=</span>cm<span class="token comment">#颜颜色选取的模型，由于Z的值只有两个，也可以写出一个颜色列表，指定相应颜色，不让其自动生成</span>
                <span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.8</span>
                <span class="token punctuation">)</span>
    <span class="token comment">#和原始数据集一样，画出每个训练集和测试集的散点图</span>
    ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X_train<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y_train<span class="token punctuation">,</span> cmap<span class="token operator">=</span>cm_bright<span class="token punctuation">,</span> edgecolors <span class="token operator">=</span> <span class="token string">'k'</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_test<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X_test<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y_test<span class="token punctuation">,</span> cmap<span class="token operator">=</span>cm_bright<span class="token punctuation">,</span> edgecolors <span class="token operator">=</span> <span class="token string">'k'</span><span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">0.4</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xlim<span class="token punctuation">(</span>array1<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> array1<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span>array2<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> array2<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> ds_index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"GaussianNB"</span><span class="token punctuation">)</span>

    <span class="token comment">#在右下角添加模型的分数</span>
    ax<span class="token punctuation">.</span>text<span class="token punctuation">(</span>array1<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">.3</span><span class="token punctuation">,</span> array2<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">.3</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'{:.1f}%'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>score <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    size <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">,</span> horizontalalignment <span class="token operator">=</span> <span class="token string">'right'</span><span class="token punctuation">)</span>
    i <span class="token operator">+=</span> <span class="token number">1</span>

<span class="token comment">#自动调整子画板与子画板之间的的距离</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9e/63/FgpiTdg0_o.png" alt="在这里插入图片描述" width="500"></p> 
<p>可以看出高斯朴素这些线性的数据有着非常好的效果，但是对于非线性的数据的结果并不是特别的理想</p> 
<h4><a id="_186"></a>不同样本量对于高斯朴素贝叶斯的影响</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_digits
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> GaussianNB
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVC
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression <span class="token keyword">as</span> LR
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> learning_curve
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> ShuffleSplit
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">plot_learning_curve</span><span class="token punctuation">(</span>estimator<span class="token punctuation">,</span>title<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>ax<span class="token punctuation">,</span>ylim<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>cv<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>n_jobs<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    train_size<span class="token punctuation">,</span>train_scores<span class="token punctuation">,</span>test_scores<span class="token operator">=</span>learning_curve<span class="token punctuation">(</span>estimator <span class="token comment"># 分类器</span>
                                                       <span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token comment"># 数据</span>
                                                       <span class="token punctuation">,</span>cv<span class="token operator">=</span>cv <span class="token comment"># 交叉验证的模式</span>
                                                       <span class="token punctuation">,</span>n_jobs<span class="token operator">=</span>n_jobs<span class="token punctuation">)</span>
    <span class="token comment"># train_size 为每次训练和测试集划分后，在训练集上的样本数量，会自动选取</span>
    <span class="token comment"># train_scores为(5,50)5表示划分了5次数据，50代表每次划分训练集50次交叉验证对应的分数，所以要取均值</span>
    <span class="token comment"># test_scores为(5,50)5表示划分了5次数据，50代表每次划分测试集50次交叉验证对应的分数，所以要取均值</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span>title<span class="token punctuation">)</span>
    <span class="token keyword">if</span> ylim <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        ax<span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span>ylim<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Training examples"</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"Score"</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>train_size<span class="token punctuation">,</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>train_scores<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"o-"</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">"Training scores"</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">"red"</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>train_size<span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>test_scores<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"o-"</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"Training scores"</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"green"</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"lower right"</span><span class="token punctuation">)</span>


title_list<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GaussianNB"</span><span class="token punctuation">,</span><span class="token string">"LR"</span><span class="token punctuation">,</span><span class="token string">"RandomForestClassifier"</span><span class="token punctuation">,</span><span class="token string">"SVC"</span><span class="token punctuation">]</span>
model_list<span class="token operator">=</span><span class="token punctuation">[</span>GaussianNB<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">,</span>LR<span class="token punctuation">(</span>C<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>solver<span class="token operator">=</span><span class="token string">"lbfgs"</span><span class="token punctuation">,</span>max_iter<span class="token operator">=</span><span class="token number">3000</span><span class="token punctuation">,</span>multi_class<span class="token operator">=</span><span class="token string">"auto"</span><span class="token punctuation">)</span>
    <span class="token punctuation">,</span>RandomForestClassifier<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token punctuation">,</span>SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">"rbf"</span><span class="token punctuation">,</span>gamma<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

cv<span class="token operator">=</span>ShuffleSplit<span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">50</span> <span class="token comment"># 将数据分成50份，验证次数</span>
                <span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.2</span> <span class="token comment"># 将20%作为测试集</span>
                <span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">10</span>
                <span class="token punctuation">)</span>

digits<span class="token operator">=</span>load_digits<span class="token punctuation">(</span><span class="token punctuation">)</span>
x<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>digits<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
y<span class="token operator">=</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>digits<span class="token punctuation">.</span>target<span class="token punctuation">)</span>

fig<span class="token operator">=</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    start<span class="token operator">=</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ax<span class="token operator">=</span>fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    plot_learning_curve<span class="token punctuation">(</span>model_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>title_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>ax<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0.7</span><span class="token punctuation">,</span><span class="token number">1.05</span><span class="token punctuation">]</span><span class="token punctuation">,</span>cv<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    end<span class="token operator">=</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>title_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>end<span class="token operator">-</span>start<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code>GaussianNB
2.445056200027466
LR
19.8220853805542
RandomForestClassifier
12.856705665588379
SVC
26.9399311542511
</code></pre> 
<p><img src="https://images2.imgbox.com/ce/9f/ytOv8OPF_o.png" alt="在这里插入图片描述" width="600"><br> 通过这段代码也能够非常明显的看出，高斯朴素贝叶斯和其他算法之间的优劣，对于其他算法来说，在模型过拟合的时候，可以通过大量的数据对通过对于模型的提升，使测试集的分数不断上升而达到比较好的效果，但是对于高斯朴素贝叶斯来说，随着样本数据的增大，虽然过拟合的程度降低，但是测试训练及的分数也随之降低，模型的效果也相对没有其他模型那么好。但是对于它的优点来说，我们可以直观的发现，它使用的时间是非常短的效率是非常高的。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e6139f506c007dea0c345e70fa4ba2e1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[2021-07-17]删除UNDO表空间提示ORA-01561</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/761cb847ed3a0fdc9e6c4c1abf60152b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">笔记本电脑计算机无法显示u盘,小编告诉你为什么笔记本电脑识别不了u盘</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>