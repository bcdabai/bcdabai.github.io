<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>RBM的理解 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="RBM的理解" />
<meta property="og:description" content="RBM 是基于能量函数的无向图模型。将图节点分为可见层节点v和隐藏层节点h，其联合概率分布p(h,v)可表示为
其中，能量函数。
利用RBM计算p(h|v)的概率，即在可见层已知时，计算隐藏层h的概率。要根据v推断h,可求argmax p(h|v)。先得通过训练样本来估计模型参数。
采用极大似然估计,由于训练数据只有可见节点，对数似然函数为：
N是样本数。
求p(v)可以由p(h,v)的边缘概率来计算:
对数似然梯度：
,其中，根据能量函数模型有：
故梯度的偏导数：
对求偏导：
前一项的v是样本的点，后一项的v是所有v的值。
前一项可以直接计算，后一项对所有v求均值（期望），是np问题，通过mcmc对p(v)采样近似计算。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/cb9f1ce5bda3b97b9e3c2401c5e6a1fc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-05T15:26:37+08:00" />
<meta property="article:modified_time" content="2021-01-05T15:26:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">RBM的理解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>RBM 是基于能量函数的无向图模型。将图节点分为可见层节点v和隐藏层节点h，其联合概率分布p(h,v)可表示为<img alt="p(h,v)= \frac{e^{-E(h,v)}}{z}" class="mathcode" src="https://images2.imgbox.com/b1/ec/HVIoM2M4_o.gif"></p> 
<p>其中，能量函数<img alt="E(h,v)= -(h^{T}\omega v+\alpha^{T} v+\beta ^{T}h)" class="mathcode" src="https://images2.imgbox.com/1d/f3/PyPqiEcy_o.gif">。</p> 
<p>利用RBM计算p(h|v)的概率，即在可见层已知时，计算隐藏层h的概率。要根据v推断h,可求argmax p(h|v)。先得通过训练样本来估计模型参数<img alt="\theta(\omega ,\alpha ,\beta )" class="mathcode" src="https://images2.imgbox.com/79/8f/0OkS8R8Y_o.gif">。</p> 
<p>采用极大似然估计,由于训练数据只有可见节点，对数似然函数为：</p> 
<p><img alt="\frac{1}{N}\sum logp(v^{i})" class="mathcode" src="https://images2.imgbox.com/17/ab/ONukbBFK_o.gif"> N是样本数。</p> 
<p>求p(v)可以由p(h,v)的边缘概率来计算:</p> 
<p><img alt="p(v)= \sum_{h}p(h,v)" class="mathcode" src="https://images2.imgbox.com/92/14/AecEJksx_o.gif"></p> 
<p>对数似然梯度：</p> 
<p><img alt="\frac{\partial\frac{1}{N}\sum logp(v^{i})}{\partial \theta }" class="mathcode" src="https://images2.imgbox.com/57/07/nfPDQ0Bz_o.gif">,其中，根据能量函数模型有：</p> 
<p><img alt="logp(v)=log\sum_{h}p(h,v)=log\sum_{h}\frac{1}{z}e^{-E(h,v)}" class="mathcode" src="https://images2.imgbox.com/cb/6e/LTfLpJYD_o.gif"></p> 
<p><img alt="=log\sum_{h}e^{-E(h,v)}-log\sum_{h,v}e^{-E(h,v)}" class="mathcode" src="https://images2.imgbox.com/f9/d5/KYz9Df3X_o.gif"></p> 
<p>故梯度的偏导数：</p> 
<p><img alt="\frac{\partial\ logp(v)}{\partial \theta } = \partial log\sum_{h}e^{-E(h,v)}/\partial \theta -\partial log\sum_{h,v}e^{-E(h,v)}/\partial \theta" class="mathcode" src="https://images2.imgbox.com/4b/b3/xR6K3ISk_o.gif"></p> 
<p><img alt="=-\sum _{h}p(h|v)\partial E(h,v)/\partial \theta+\sum _{h,v}p(h,v)\partial E(h,v)/\partial \theta" class="mathcode" src="https://images2.imgbox.com/ea/09/b7DtDWWw_o.gif"></p> 
<p>对<img alt="\omega" class="mathcode" src="https://images2.imgbox.com/2c/f4/BLX7IxqJ_o.gif">求偏导：</p> 
<p><img alt="\partial log p(v)/\partial \omega _{ij}=-\sum _{h}p(h|v)\partial E(h,v)/\partial \omega_{ij} +\sum _{h,v}p(h,v)\partial E(h,v)/\partial \omega_{ij}" class="mathcode" src="https://images2.imgbox.com/69/c8/EC0i2KtA_o.gif"></p> 
<p><img alt="=-\sum _{h}p(h|v)(-h_{i}v_{j})+\sum _{h,v}p(h,v)(-h_{i}v_{j})" class="mathcode" src="https://images2.imgbox.com/b5/10/h0Q8D6V1_o.gif"></p> 
<p><img alt="=-\sum _{h_{i}}\sum _{h_{-i}}p(h_{i},h_{-i}|v)(-h_{i}v_{j})+\sum _{v}p(v)\sum _{h_{i},h_{-i}}p(h_{i},h_{-i}|v)(-h_{i}v_{j})" class="mathcode" src="https://images2.imgbox.com/21/00/YE2jQ1hA_o.gif"></p> 
<p><img alt="=p(h_{i}=1|v)v_{j}-\sum _{v}p(v)p(h_{i}=1|v)v_{j}" class="mathcode" src="https://images2.imgbox.com/57/e2/4DlkhKMe_o.gif"></p> 
<p><span style="color:#f33b45;">前一项的v是样本的点，后一项的v是所有v的值。</span></p> 
<p>前一项可以直接计算，后一项对所有v求均值（期望），是np问题，通过mcmc对p(v)采样近似计算。</p> 
<p> </p> 
<p> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3ac685c4d50e4bdd4d8a87ac76e1d729/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">AndroidStudio安装APP调试出现Installation did not succeed报错原因分析</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1b7862008f622f94b5dd64fc9c1297c5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">shiro整合ehCache，清除认证缓存</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>