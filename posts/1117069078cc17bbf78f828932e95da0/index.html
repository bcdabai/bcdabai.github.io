<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#中动态修改ListBox的Item的颜色的方法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#中动态修改ListBox的Item的颜色的方法" />
<meta property="og:description" content="最近搞了C#需要在ListBox中显示不同类型的数据，为了让用户容易区分，增加了颜色区分的功能，就是需要不同的类型数据显示出不同的颜色。针对上述的要求我们需要使用控件的重绘方法，就是用重绘的方法激活重绘事件，在重绘事件内修改Item的字体颜色。方法如下（基于DrawItem事件）
一、新建一个C#的窗口应用程序，在form1内添加一个ListBox控件，一个TextBox控件，一个按钮控件；我们要求如下：按一次按钮将文本框内的内容添加到ListBox内，并且ListBox在显示的时候根据Item的内容显示不同的颜色，比如添加的Item内包含了&#34;你好&#34;，那么这个Item用绿色来显示；如果包含了&#34;你坏&#34;用红色来表示。界面如下图所示：
二、界面准备完成，我们需要对ListBox控件的属性进行修改，才能使ListBox控件支持DrawItem的事件，我们要在ListBox控件的【DrawMode】属性修改为下图中的任意一个，具体的区别还没有深入研究，我选择的是【OwnerDrawFixed】属性，如下图：
三、还是要选中ListBox控件，在【事件】属性栏内找到【DrawItem】事件，双击，便在CS文件添加了该控件的DrawItem事件的处理函数。如下图
四、添加相应的处理【一】中需求的方法，比如按钮事件，获取文本框的文本并显示在ListBox内；
五、详细源码
using System; using System.Collections.Generic; using System.ComponentModel; using System.Data; using System.Drawing; using System.Linq; using System.Text; using System.Windows.Forms; namespace TestListBoxColor { public partial class Form1 : Form { public Form1() { InitializeComponent(); } // ListBox DrawItem事件响应函数 private void listBox1_DrawItem(object sender, DrawItemEventArgs e) { if (e.Index &gt;= 0) { e.DrawBackground(); Brush mybsh = Brushes.Black; // 判断是什么类型的标签 if (listBox1.Items[e.Index].ToString().IndexOf(&#34;你好&#34;) != -1) { mybsh = Brushes.Green; } else if (listBox1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1117069078cc17bbf78f828932e95da0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-07-24T16:59:30+08:00" />
<meta property="article:modified_time" content="2014-07-24T16:59:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#中动态修改ListBox的Item的颜色的方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="white-space:pre"></span>最近搞了C#需要在ListBox中显示不同类型的数据，为了让用户容易区分，增加了颜色区分的功能，就是需要不同的类型数据显示出不同的颜色。针对上述的要求我们需要使用控件的重绘方法，就是用重绘的方法激活重绘事件，在重绘事件内修改Item的字体颜色。方法如下（基于DrawItem事件）</p> 
<p><span style="white-space:pre"></span>一、新建一个C#的窗口应用程序，在form1内添加一个ListBox控件，一个TextBox控件，一个按钮控件；我们要求如下：按一次按钮将文本框内的内容添加到ListBox内，并且ListBox在显示的时候根据Item的内容显示不同的颜色，比如添加的Item内包含了"你好"，那么这个Item用<span style="color:#009900"><strong>绿</strong></span>色来显示；如果包含了"你坏"用<span style="color:#ff0000"><strong>红</strong></span>色来表示。界面如下图所示：</p> 
<p><span style="white-space:pre"><img src="https://images2.imgbox.com/5c/67/YpcZfQC9_o.jpg" alt=""></span></p> 
<p><span style="white-space:pre"><span style="white-space:pre"></span>二</span>、界面准备完成，我们需要对ListBox控件的属性进行修改，才能使ListBox控件支持DrawItem的事件，我们要在ListBox控件的<span style="color:#ff0000">【</span><strong style="color:rgb(255,0,0)">DrawMode】</strong>属性修改为下图中的任意一个，具体的区别还没有深入研究，我选择的是<span style="color:#ff0000">【OwnerDrawFixed】</span>属性，如下图：</p> 
<p><span style="white-space:pre"><img src="https://images2.imgbox.com/ee/9f/ojc83YEu_o.jpg" alt=""></span></p> 
<p><span style="white-space:pre"><span style="white-space:pre"></span>三</span>、还是要选中ListBox控件，在【事件】属性栏内找到【DrawItem】事件，双击，便在CS文件添加了该控件的DrawItem事件的处理函数。如下图</p> 
<p><span style="white-space:pre"><img src="https://images2.imgbox.com/01/94/EQRKD7iL_o.jpg" alt=""><img src="https://images2.imgbox.com/c7/78/zWopgdFj_o.jpg" alt=""></span></p> 
<p><span style="white-space:pre"><span style="white-space:pre"></span>四</span>、添加相应的处理【一】中需求的方法，比如按钮事件，获取文本框的文本并显示在ListBox内；</p> 
<p><span style="white-space:pre"></span>五、详细源码</p> 
<p><span style="white-space:pre"></span></p> 
<pre><code class="language-csharp">using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace TestListBoxColor
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        // ListBox DrawItem事件响应函数
        private void listBox1_DrawItem(object sender, DrawItemEventArgs e)
        {            
            if (e.Index &gt;= 0)
            {
                e.DrawBackground();
                Brush mybsh = Brushes.Black;
                // 判断是什么类型的标签
                if (listBox1.Items[e.Index].ToString().IndexOf("你好") != -1)
                {
                    mybsh = Brushes.Green;
                }
                else if (listBox1.Items[e.Index].ToString().IndexOf("你坏") != -1)
                {
                    mybsh = Brushes.Red;
                }
                // 焦点框
                e.DrawFocusRectangle();
                //文本 
                e.Graphics.DrawString(listBox1.Items[e.Index].ToString(), e.Font, mybsh, e.Bounds, StringFormat.GenericDefault);
            }     
        }

        private void button1_Click(object sender, EventArgs e)
        {
            string str = this.textBox1.Text;

            this.listBox1.Items.Add(str);
        }
    }
}
</code></pre> 
<span style="white-space:pre"> </span>六、效果如下，当输入“你好”并按添加按钮的时候相应的ListBox的内容变为的绿色，输入“你坏”的时候变为了红色，达到了我们的要求目的： 
<p></p> 
<p><span style="white-space:pre"><img src="https://images2.imgbox.com/f4/2b/Yoi45yx5_o.jpg" alt=""></span></p> 
<p><span style="white-space:pre"></span>OK，到此结束，希望对有这种需求的人有帮助。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3af3e6669a8f232a1cbd22326c19879b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">互斥类(Cmutex)——MFC</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/918601b083f4002affcd3b3df046daf6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">iOS 完全复制UIView</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>