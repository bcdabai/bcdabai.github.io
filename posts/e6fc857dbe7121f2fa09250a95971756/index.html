<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>VPP端口镜像 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="VPP端口镜像" />
<meta property="og:description" content="什么是端口镜像 端口镜像（port Mirroring）功能通过在交换机或路由器上，将一个或多个源端口的数据流量转发到某一个指定端口来实现对网络的监听，指定端口称之为“镜像端口”或“目的端口”，在不严重影响源端口正常吞吐流量的情况下，可以通过镜像端口对网络的流量进行监控分析。在企业中用镜像功能，可以很好地对企业内部的网络数据进行监控管理，在网络出故障的时候，可以快速地定位故障。
目的 为了方便对一个或多个网络接口的流量进行分析（如IDS产品、网络分析仪等），可以通过配置交换机或路由器来把一个或多个端口（VLAN）的数据转发到某一个端口，即端口镜像，来实现对网络的监听。
端口镜像功能是对网络流量监控的一个有效的安全手段，对监控流量的分析可以进行安全性的检查，同时也能及时地在网络发生故障时进行准确的定位。
功能 镜像的功能简单地说就是将被监控流量镜像到监控端口，以便对被监控流量进行故障定位、流量分析、流量备份等，监控端口一般直接与监控主机等相连。
监视到进出网络的所有数据包，供安装了监控软件的管理服务器抓取数据，如网吧需提供此功能把数据发往公安部门审查。而企业出于信息安全、保护公司机密的需要，也迫切需要网络中有一个端口能提供这种实时监控功能。在企业中用端口镜像功能，可以很好的对企业内部的网络数据进行监控管理，在网络出现故障的时候，可以做到很好地故障定位。
备注：交换机把某一个端口接收或发送的数据帧完全相同的复制给另一个端口；其中被复制的端口称为镜像源端口，复制的端口称为镜像目的端口。
别名 端口镜像通常有以下几种别名：
Port Mirroring 通常指允许把一个端口的流量复制到另外一个端口，同时这个端口不能再传输数据。Monitoring Port 监控端口Spanning Port 通常指允许把所有端口的流量复制到另外一个端口，同时这个端口不能再传输数据。SPAN port 在 Cisco 产品中，SPAN 通常指 Switch Port ANalyzer。某些交换机的 SPAN 端口不支持传输数据。Link Mode port这样，这些流量就可以被一个特殊的设备监控。它对发现和修理故障有很大的帮助。 备注：vpp中的端口镜像为SPAN port。
分类 端口镜像根据不同的分类标准，镜像类型也不一样。
根据镜像作用的端口模式来划分，端口镜像分为以下三种类型：
入口镜像：只对从该端口进入的流量进行镜像。出口镜像：只对该端口的发出的流量进行镜像。双向镜像：支持对该端口收到和发出的双向流量进行镜像。 根据镜像功能划分，端口镜像分为两种类型：
流镜像：如果端口上配置了ACL并启用，则认为是流镜像。流镜像只采集经过ACL过滤后的数据包，否则认为是纯端口镜像。对于ACL流量采集方式，支持在端口的方向（出向、入向和双向三种）上绑定标准访问列表和扩展访问列表。纯端口镜像：对端口进出的流量进行镜像。 根据镜像工作的范围划分，端口镜像分为两种类型：
本地镜像：源端口和目的端口在同一个路由器上。远端镜像：源端口和目的端口分布在不同的路由器上，镜像流量经过某种封装，实现跨路由器传输。 vpp span 端口镜像用于网络交换机上，以将在一个交换机端口上看到的网络数据包的副本发送到另一交换机端口上的网络监视连接。
可供网络工程师或管理员用来衡量性能，分析和调试数据或诊断网络上的错误。
RX traffic node 有一个静态节点可以镜像传入的数据包。
span-input: 由于传入缓冲区可以在内部重用，因此创建传入缓冲区的副本。 传输链：dpdk-input -&gt; span-input -&gt;
原始缓冲区发送到ethernet-input进行处理缓冲区副本发送到interface-output 配置 支持两种配置方式：CLI和API
CLI配置 set interface span &lt;if-name&gt; [disable | destination &lt;if-name&gt;]
参数
&lt;if-name&gt;: 被镜像接口名destination &lt;if-name&gt;: 目的接口名disable: 删除镜像 API配置 添加镜像： sw_interface_span_enable_disable src GigabitEthernet0/8/0 dst GigabitEthernet0/9/0 sw_interface_span_enable_disable src_sw_if_index 1 dst_sw_if_index 2 参数" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e6fc857dbe7121f2fa09250a95971756/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-06-04T10:57:01+08:00" />
<meta property="article:modified_time" content="2020-06-04T10:57:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">VPP端口镜像</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>什么是端口镜像</h3> 
<p>端口镜像（port Mirroring）功能通过在交换机或路由器上，将一个或多个源端口的数据流量转发到某一个指定端口来实现对网络的监听，指定端口称之为“镜像端口”或“目的端口”，在不严重影响源端口正常吞吐流量的情况下，可以通过镜像端口对网络的流量进行监控分析。在企业中用镜像功能，可以很好地对企业内部的网络数据进行监控管理，在网络出故障的时候，可以快速地定位故障。</p> 
<h4><a id="_4"></a>目的</h4> 
<p>为了方便对一个或多个网络接口的流量进行分析（如IDS产品、网络分析仪等），可以通过配置交换机或路由器来把一个或多个端口（VLAN）的数据转发到某一个端口，即端口镜像，来实现对网络的监听。</p> 
<p>端口镜像功能是对网络流量监控的一个有效的安全手段，对监控流量的分析可以进行安全性的检查，同时也能及时地在网络发生故障时进行准确的定位。</p> 
<h4><a id="_10"></a>功能</h4> 
<p>镜像的功能简单地说就是将被监控流量镜像到监控端口，以便对被监控流量进行故障定位、流量分析、流量备份等，监控端口一般直接与监控主机等相连。</p> 
<p>监视到进出网络的所有数据包，供安装了监控软件的管理服务器抓取数据，如网吧需提供此功能把数据发往公安部门审查。而企业出于信息安全、保护公司机密的需要，也迫切需要网络中有一个端口能提供这种实时监控功能。在企业中用端口镜像功能，可以很好的对企业内部的网络数据进行监控管理，在网络出现故障的时候，可以做到很好地故障定位。</p> 
<p><strong>备注</strong>：交换机把某一个端口接收或发送的数据帧完全相同的复制给另一个端口；其中被复制的端口称为镜像源端口，复制的端口称为镜像目的端口。</p> 
<h4><a id="_18"></a>别名</h4> 
<p>端口镜像通常有以下几种别名：</p> 
<ul><li>Port Mirroring 通常指允许把一个端口的流量复制到另外一个端口，同时这个端口不能再传输数据。</li><li>Monitoring Port 监控端口</li><li>Spanning Port 通常指允许把所有端口的流量复制到另外一个端口，同时这个端口不能再传输数据。</li><li>SPAN port 在 Cisco 产品中，SPAN 通常指 Switch Port ANalyzer。某些交换机的 SPAN 端口不支持传输数据。</li><li>Link Mode port这样，这些流量就可以被一个特殊的设备监控。它对发现和修理故障有很大的帮助。</li></ul> 
<p><strong>备注</strong>：vpp中的端口镜像为SPAN port。</p> 
<h4><a id="_31"></a>分类</h4> 
<p>端口镜像根据不同的分类标准，镜像类型也不一样。</p> 
<p>根据镜像作用的端口模式来划分，端口镜像分为以下三种类型：</p> 
<ul><li>入口镜像：只对从该端口进入的流量进行镜像。</li><li>出口镜像：只对该端口的发出的流量进行镜像。</li><li>双向镜像：支持对该端口收到和发出的双向流量进行镜像。</li></ul> 
<p>根据镜像功能划分，端口镜像分为两种类型：</p> 
<ul><li>流镜像：如果端口上配置了ACL并启用，则认为是流镜像。流镜像只采集经过ACL过滤后的数据包，否则认为是纯端口镜像。对于ACL流量采集方式，支持在端口的方向（出向、入向和双向三种）上绑定标准访问列表和扩展访问列表。</li><li>纯端口镜像：对端口进出的流量进行镜像。</li></ul> 
<p>根据镜像工作的范围划分，端口镜像分为两种类型：</p> 
<ul><li>本地镜像：源端口和目的端口在同一个路由器上。</li><li>远端镜像：源端口和目的端口分布在不同的路由器上，镜像流量经过某种封装，实现跨路由器传输。</li></ul> 
<h3><a id="vpp_span_50"></a>vpp span</h3> 
<p>端口镜像用于网络交换机上，以将在一个交换机端口上看到的网络数据包的副本发送到另一交换机端口上的网络监视连接。<br> 可供网络工程师或管理员用来衡量性能，分析和调试数据或诊断网络上的错误。</p> 
<h4><a id="RX_traffic_node_55"></a>RX traffic node</h4> 
<p>有一个静态节点可以镜像传入的数据包。</p> 
<ul><li>span-input: 由于传入缓冲区可以在内部重用，因此创建传入缓冲区的副本。</li></ul> 
<p>传输链：dpdk-input -&gt; span-input -&gt;</p> 
<ul><li>原始缓冲区发送到ethernet-input进行处理</li><li>缓冲区副本发送到interface-output</li></ul> 
<h4><a id="_64"></a>配置</h4> 
<p>支持两种配置方式：CLI和API</p> 
<h5><a id="CLI_68"></a>CLI配置</h5> 
<p><code>set interface span &lt;if-name&gt; [disable | destination &lt;if-name&gt;]</code></p> 
<p><strong>参数</strong></p> 
<ul><li>&lt;if-name&gt;: 被镜像接口名</li><li>destination &lt;if-name&gt;: 目的接口名</li><li>disable: 删除镜像</li></ul> 
<h5><a id="API_77"></a>API配置</h5> 
<h6><a id="_79"></a>添加镜像：</h6> 
<pre><code>sw_interface_span_enable_disable src GigabitEthernet0/8/0 dst GigabitEthernet0/9/0
sw_interface_span_enable_disable src_sw_if_index 1 dst_sw_if_index 2
</code></pre> 
<p><strong>参数</strong></p> 
<ul><li>src/src_sw_if_index: 被镜像接口</li><li>dst/dst_sw_if_index: 镜像目标接口</li></ul> 
<h6><a id="_89"></a>删除镜像</h6> 
<pre><code>sw_interface_span_enable_disable src GigabitEthernet0/8/0 dst GigabitEthernet0/9/0 disable
sw_interface_span_enable_disable src_sw_if_index 1 dst_sw_if_index 2 disable
</code></pre> 
<p><strong>参数</strong></p> 
<ul><li>src/src_sw_if_index: 被镜像接口</li><li>dst/dst_sw_if_index: 镜像目标接口</li></ul> 
<h4><a id="_99"></a>查看数据</h4> 
<h5><a id="CLI_101"></a>CLI</h5> 
<p><code>show interfaces span</code></p> 
<h5><a id="API_104"></a>API</h5> 
<p><code>sw_interface_span_dump</code></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/afac85050d9b54f98d47e034aef7aa13/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MATLAB打开nc文件并读取nc文件数据</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/615737254e43d784ec8ea77980e0863c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">supervisor 状态state汇总</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>