<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CJSON库的学习 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CJSON库的学习" />
<meta property="og:description" content="目录
一、JSON简介
二、 JSON语法
​​​​​​三、 CJSON简介：
四、 CJSON数据结构
五、使用CJSON构造JSON
1. cJSON常用库函数介绍
2. CJSON构造JSON实例代码
（1）！！！编译过程中有两个注意的点：
3. 使用cJSON解析JSON实例代码
一、JSON简介 JSON（JavaScript object Notation），即JavaScript 对象符号，是一种轻量级的数据格式；【其本质就是字符串】 它采用完全独立于编程语言的文本格式来存储和表示数据，语法简洁，层次结构清晰，易于人阅读和编写，同时也易于机器解析和生成，有效的提升了网络传送效率。 因为它完全独立于编程语言所以支持跨平台开发； JSON 的名称中虽然带有JavaScript，但这是指其语法规则是参考JavaScript对象的，而不是指只能用于JavaScript 语言。 因为JSON本身就是参考JavaScript 对象的规则定义的，其语法与JavaScript定义对象的语法几乎完全相同。 二、 JSON语法 JSON可以将数据转换为字符串，接着在网络中或者程序里面传递这个字符串，最后可以还原成各个编程语言所支持的数据格式； JSON是一个无序的键值对（key / value）集合； JSON以&#34;{“开始，以”}&#34;结束，允许嵌套使用每个key(关键字)和value(值)成对出现，关键字和值之间使用&#34;:&#34;分隔键/值对之间用&#34;,&#34;分隔在这些字符前后允许存在无意义的空白符数组（Array）用方括号(“[]”)表示。对象（0bject）用大括号(“{}”)表示。名称/值对(name/value）组合成数组和对象。名称(name）置于双引号中，值（value）有字符串、数值、布尔值、null、对象和数组。并列的数据之间用逗号(“,”）分隔 在线的JSON解析网站如下：JSON解析
如下是一个实际的例子，来体会一下JSON：
{ &#34;name&#34;: &#34;JK&#34;, &#34;age&#34;: 18, &#34;height&#34;: 175, &#34;sex&#34;: false, &#34;address&#34;: { &#34;country&#34;: &#34;China&#34;, &#34;tel&#34;: 123456 }, &#34;subject&#34;: [&#34;语文&#34;, &#34;数学&#34;, &#34;英语&#34;], &#34;grade&#34;: [1, 2, 3], &#34;student&#34;: [{ &#34;name&#34;: &#34;wsf&#34;, &#34;age&#34;: 23, &#34;sex&#34;: true }, { &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/783542c71b7090be263b0e2f82b95b7d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-01T14:24:14+08:00" />
<meta property="article:modified_time" content="2022-09-01T14:24:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CJSON库的学习</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81JSON%E7%AE%80%E4%BB%8B-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81JSON%E7%AE%80%E4%BB%8B" rel="nofollow">一、JSON简介</a></p> 
<p id="%E4%BA%8C%E3%80%81%20JSON%E8%AF%AD%E6%B3%95-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%20JSON%E8%AF%AD%E6%B3%95" rel="nofollow">二、 JSON语法</a></p> 
<p id="%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E4%B8%89%E3%80%81%C2%A0CJSON%E7%AE%80%E4%BB%8B%EF%BC%9A-toc" style="margin-left:0px;"><a href="#%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E4%B8%89%E3%80%81%C2%A0CJSON%E7%AE%80%E4%BB%8B%EF%BC%9A" rel="nofollow">​​​​​​三、 CJSON简介：</a></p> 
<p id="%E5%9B%9B%E3%80%81%20CJSON%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81%20CJSON%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84" rel="nofollow">四、 CJSON数据结构</a></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<p id="%E4%BA%94%E3%80%81%E4%BD%BF%E7%94%A8CJSON%E6%9E%84%E9%80%A0JSON-toc" style="margin-left:0px;"><a href="#%E4%BA%94%E3%80%81%E4%BD%BF%E7%94%A8CJSON%E6%9E%84%E9%80%A0JSON" rel="nofollow">五、使用CJSON构造JSON</a></p> 
<p id="cJSON%E5%B8%B8%E7%94%A8%E5%BA%93%E5%87%BD%E6%95%B0%E4%BB%8B%E7%BB%8D-toc" style="margin-left:40px;"><a href="#cJSON%E5%B8%B8%E7%94%A8%E5%BA%93%E5%87%BD%E6%95%B0%E4%BB%8B%E7%BB%8D" rel="nofollow">1. cJSON常用库函数介绍</a></p> 
<p id="2.%20CJSON%E6%9E%84%E9%80%A0JSON%E5%AE%9E%E4%BE%8B%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#2.%20CJSON%E6%9E%84%E9%80%A0JSON%E5%AE%9E%E4%BE%8B%E4%BB%A3%E7%A0%81" rel="nofollow">2. CJSON构造JSON实例代码</a></p> 
<p id="%EF%BC%881%EF%BC%89%EF%BC%81%EF%BC%81%EF%BC%81%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E4%B8%AD%E6%9C%89%E4%B8%A4%E4%B8%AA%E6%B3%A8%E6%84%8F%E7%9A%84%E7%82%B9%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%EF%BC%881%EF%BC%89%EF%BC%81%EF%BC%81%EF%BC%81%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E4%B8%AD%E6%9C%89%E4%B8%A4%E4%B8%AA%E6%B3%A8%E6%84%8F%E7%9A%84%E7%82%B9%EF%BC%9A" rel="nofollow">（1）！！！编译过程中有两个注意的点：</a></p> 
<p id="3.%20%E4%BD%BF%E7%94%A8cJSON%E8%A7%A3%E6%9E%90JSON%E5%AE%9E%E4%BE%8B%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#3.%20%E4%BD%BF%E7%94%A8cJSON%E8%A7%A3%E6%9E%90JSON%E5%AE%9E%E4%BE%8B%E4%BB%A3%E7%A0%81" rel="nofollow">3. 使用cJSON解析JSON实例代码</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p></p> 
<p></p> 
<div> 
 <div> 
  <h2 id="%E4%B8%80%E3%80%81JSON%E7%AE%80%E4%BB%8B" style="text-align:left;"><strong><span style="color:#1a1a1a;">一、JSON简介</span></strong></h2> 
  <ol><li style="text-align:left;"><code><span style="color:#333333;"> JSON（JavaScript object Notation），即JavaScript 对象符号，是一种轻量级的数据格式；【其本质就是</span><strong><span style="color:#ff0000;">字符串</span></strong><span style="color:#333333;">】</span></code></li><li style="text-align:left;"><code><span style="color:#333333;"> 它采用完全独立于编程语言的文本格式来存储和表示数据，语法简洁，层次结构清晰，易于人阅读和编写，同时也易于机器解析和生成，有效的提升了网络传送效率。</span></code></li><li style="text-align:left;"><code><span style="color:#333333;"> 因为它完全独立于编程语言所以支持跨平台开发；</span></code></li><li style="text-align:left;"><code><span style="color:#333333;"> JSON 的名称中虽然带有JavaScript，但这是指其语法规则是参考JavaScript对象的，而不是指只能用于JavaScript 语言。</span></code></li><li style="text-align:left;"><code><span style="color:#333333;"> 因为JSON本身就是参考JavaScript 对象的规则定义的，其语法与JavaScript定义对象的语法几乎完全相同。</span></code></li></ol> 
  <p></p> 
  <h2 id="%E4%BA%8C%E3%80%81%20JSON%E8%AF%AD%E6%B3%95" style="text-align:left;"><strong><span style="color:#1a1a1a;">二、 JSON语法</span></strong></h2> 
  <ol><li style="text-align:left;"><code><span style="color:#333333;"> JSON可以将数据转换为字符串，接着在网络中或者程序里面传递这个字符串，最后可以还原成各个编程语言所支持的数据格式；</span></code></li><li style="text-align:left;"><code><span style="color:#333333;"> JSON是一个无序的键值对（key / value）集合；</span></code> 
    <ul><li style="text-align:left;"><code><span style="color:#333333;">JSON以"{“开始，以”}"结束，允许嵌套使用</span></code></li><li style="text-align:left;"><code><span style="color:#333333;">每个key(关键字)和value(值)成对出现，关键字和值之间使用":"分隔</span></code></li><li style="text-align:left;"><code><span style="color:#333333;">键/值对之间用","分隔</span></code></li><li style="text-align:left;"><code><span style="color:#333333;">在这些字符前后允许存在无意义的空白符</span></code></li><li style="text-align:left;"><code><span style="color:#333333;">数组（Array）用方括号(“[]”)表示。</span></code></li><li style="text-align:left;"><code><span style="color:#333333;">对象（0bject）用大括号(“{}”)表示。</span></code></li><li style="text-align:left;"><code><span style="color:#333333;">名称/值对(name/value）组合成数组和对象。</span></code></li><li style="text-align:left;"><code><span style="color:#333333;">名称(name）置于双引号中，值（value）有字符串、数值、布尔值、null、对象和数组。</span></code></li><li style="text-align:left;"><code><span style="color:#333333;">并列的数据之间用逗号(“,”）分隔</span></code></li></ul></li></ol> 
  <ul><li> <p style="text-align:left;"><span style="color:#333333;">在线的JSON解析网站如下：</span><u><span style="color:#175ceb;">JSON解析</span></u></p> </li><li> <p style="text-align:left;"><span style="color:#333333;">如下是一个实际的例子，来体会一下JSON：</span></p> </li></ul> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#999999;">{<!-- --></span>
	<span style="color:#990055;">"name"</span><span style="color:#9a6e3a;">:</span> <span style="color:#669900;">"JK"</span><span style="color:#999999;">,</span>
	<span style="color:#990055;">"age"</span><span style="color:#9a6e3a;">:</span> <span style="color:#990055;">18</span><span style="color:#999999;">,</span>
	<span style="color:#990055;">"height"</span><span style="color:#9a6e3a;">:</span> <span style="color:#990055;">175</span><span style="color:#999999;">,</span>
	<span style="color:#990055;">"sex"</span><span style="color:#9a6e3a;">:</span> <span style="color:#990055;">false</span><span style="color:#999999;">,</span>


	<span style="color:#990055;">"address"</span><span style="color:#9a6e3a;">:</span> <span style="color:#999999;">{<!-- --></span>
		<span style="color:#990055;">"country"</span><span style="color:#9a6e3a;">:</span> <span style="color:#669900;">"China"</span><span style="color:#999999;">,</span>
		<span style="color:#990055;">"tel"</span><span style="color:#9a6e3a;">:</span> <span style="color:#990055;">123456</span>
	<span style="color:#999999;">},</span>


	<span style="color:#990055;">"subject"</span><span style="color:#9a6e3a;">:</span> <span style="color:#999999;">[</span><span style="color:#669900;">"语文"</span><span style="color:#999999;">,</span> <span style="color:#669900;">"数学"</span><span style="color:#999999;">,</span> <span style="color:#669900;">"英语"</span><span style="color:#999999;">],</span>
	<span style="color:#990055;">"grade"</span><span style="color:#9a6e3a;">:</span> <span style="color:#999999;">[</span><span style="color:#990055;">1</span><span style="color:#999999;">,</span> <span style="color:#990055;">2</span><span style="color:#999999;">,</span> <span style="color:#990055;">3</span><span style="color:#999999;">],</span>


	<span style="color:#990055;">"student"</span><span style="color:#9a6e3a;">:</span> <span style="color:#999999;">[{<!-- --></span>
			<span style="color:#990055;">"name"</span><span style="color:#9a6e3a;">:</span> <span style="color:#669900;">"wsf"</span><span style="color:#999999;">,</span>
			<span style="color:#990055;">"age"</span><span style="color:#9a6e3a;">:</span> <span style="color:#990055;">23</span><span style="color:#999999;">,</span>
			<span style="color:#990055;">"sex"</span><span style="color:#9a6e3a;">:</span> <span style="color:#990055;">true</span>
		<span style="color:#999999;">},</span>
		<span style="color:#999999;">{<!-- --></span>
			<span style="color:#990055;">"name"</span><span style="color:#9a6e3a;">:</span> <span style="color:#669900;">"rs"</span><span style="color:#999999;">,</span>
			<span style="color:#990055;">"age"</span><span style="color:#9a6e3a;">:</span> <span style="color:#990055;">25</span><span style="color:#999999;">,</span>
			<span style="color:#990055;">"sex"</span><span style="color:#9a6e3a;">:</span> <span style="color:#990055;">true</span>
		<span style="color:#999999;">}</span>
	<span style="color:#999999;">]</span>
<span style="color:#999999;">}</span>
</code></span>
</pre> 
  <ul><li> <p style="text-align:left;"><span style="color:#333333;">JSON树可视化</span></p> </li></ul> 
  <p class="img-center"><img alt="" src="https://images2.imgbox.com/a2/34/9T1wYuV7_o.png"></p> 
  <h2 id="%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E2%80%8B%E4%B8%89%E3%80%81%C2%A0CJSON%E7%AE%80%E4%BB%8B%EF%BC%9A" style="text-align:left;">​​​​​​三、 <strong><span style="color:#1a1a1a;">CJSON简介：</span></strong></h2> 
  <p style="text-align:left;"></p> 
  <ol><li> <p style="text-align:left;"><span style="color:#333333;">CJSON对象的实现采用了树形结构，每一个对象就是树的一个节点，</span><span style="color:#333333;">每个节点由cJSON这个结构体组成，对象中的元素也由cJSON这个结构体组成。同一层的对象和元素是双向链表结构，由next和prev指针链接。不同层的对象或元素由child指针链接起来。type表示对象或元素类型，string表示对象或节点的名称。元素的值存储在valuestring, valueint和valuedouble中；</span></p> </li><li> <p style="text-align:left;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">cJSON是一个使用C语言编写的JSON数据解析器，具有超轻便，可移植，单文件的特点，使用MIT开源协议。</span></span></p> </li><li> <p style="text-align:left;"><span style="color:#333333;">要使用CJSON，直接把项目从Github上clone下来，接着把CJSON.h，CJSON.c这两个源文件加入到工程中就行，使用时include CJSON.h头文件就行；</span></p> </li></ol> 
  <h2 id="%E5%9B%9B%E3%80%81%20CJSON%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84" style="text-align:left;"><strong><span style="color:#1a1a1a;">四、 CJSON数据结构</span></strong></h2> 
  <ul><li> <p style="text-align:left;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">cJSON使用cJSON结构体来表示</span></span><span style="background-color:#ffffff;"><strong><span style="color:#4d4d4d;">一个JSON数据</span></strong></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">，定义在</span></span><span style="background-color:#f9f2f4;"><span style="color:#c7254e;">cJSON.h</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">中，源码如下：</span></span></p> </li></ul> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#708090;">//逻辑值的宏定义</span>
<span style="color:#000000;">#define cJSON_Invalid (0)</span>
<span style="color:#000000;">#define cJSON_False  (1 &lt;&lt; 0)</span>
<span style="color:#000000;">#define cJSON_True   (1 &lt;&lt; 1)</span>
<span style="color:#000000;">#define cJSON_NULL   (1 &lt;&lt; 2)</span>
<span style="color:#000000;">#define cJSON_Number (1 &lt;&lt; 3)</span>
<span style="color:#000000;">#define cJSON_String (1 &lt;&lt; 4)</span>
<span style="color:#000000;">#define cJSON_Array  (1 &lt;&lt; 5)</span>
<span style="color:#000000;">#define cJSON_Object (1 &lt;&lt; 6)</span>
<span style="color:#000000;">#define cJSON_Raw    (1 &lt;&lt; 7) /* raw json */</span>


<span style="color:#000000;">#define cJSON_IsReference 256</span>
<span style="color:#000000;">#define cJSON_StringIsConst 512</span>


<span style="color:#708090;">/* The cJSON structure: */</span>
<span style="color:#0077aa;">typedef</span> <span style="color:#0077aa;">struct</span> <span style="color:#dd4a68;">cJSON</span>
<span style="color:#999999;">{<!-- --></span>
    <span style="color:#708090;">/* next/prev allow you to walk array/object chains. Alternatively, use GetArraySize/GetArrayItem/GetObjectItem */</span>
    <span style="color:#0077aa;">struct</span> <span style="color:#dd4a68;">cJSON</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;">next</span><span style="color:#999999;">;</span>
    <span style="color:#0077aa;">struct</span> <span style="color:#dd4a68;">cJSON</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;">prev</span><span style="color:#999999;">;</span>
    <span style="color:#708090;">/* An array or object item will have a child pointer pointing to a chain of the items in the array/object. */</span>
    <span style="color:#0077aa;">struct</span> <span style="color:#dd4a68;">cJSON</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;">child</span><span style="color:#999999;">;</span>


    <span style="color:#708090;">/* The type of the item, as above. */</span>
    <span style="color:#0077aa;">int</span><span style="color:#000000;"> type</span><span style="color:#999999;">;</span>


    <span style="color:#708090;">/* The item's string, if type==cJSON_String  and type == cJSON_Raw */</span>
    <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;">valuestring</span><span style="color:#999999;">;</span>
    <span style="color:#708090;">/* writing to valueint is DEPRECATED, use cJSON_SetNumberValue instead */</span>
    <span style="color:#0077aa;">int</span><span style="color:#000000;"> valueint</span><span style="color:#999999;">;</span>
    <span style="color:#708090;">/* The item's number, if type==cJSON_Number */</span>
    <span style="color:#0077aa;">double</span><span style="color:#000000;"> valuedouble</span><span style="color:#999999;">;</span>


    <span style="color:#708090;">/* The item's name string, if this item is the child of, or is in the list of subitems of an object. */</span>
    <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;">string</span><span style="color:#999999;">;</span>
<span style="color:#999999;">}</span><span style="color:#000000;"> cJSON</span><span style="color:#999999;">;</span>


</code></span></pre> 
  <p></p> 
  <p style="text-align:left;"></p> 
  <pre></pre> 
  <ol><li style="text-align:left;"><code><span style="color:#333333;"> 首先，CJSON不是将一整段JSON数据全抽象出来，而是将其中的一条JSON数据抽象出来，也就是一个键值对，用上面的结构体 </span><strong><span style="color:#ff0000;">strcut cJSON </span></strong><span style="color:#333333;">来表示，其中用来存放值的成员列表如下：</span></code> 
    <ol><li style="text-align:left;"><code><span style="color:#333333;">String：</span><span style="color:#333333;">用于表示该键值对的名称；</span></code></li><li style="text-align:left;"><code><span style="color:#333333;">type：用于表示该键值对中值的类型；</span></code></li><li style="text-align:left;"><code><span style="color:#333333;">valuestring：如果键值类型(type)是字符串，则将该指针指向键值；</span></code></li><li style="text-align:left;"><code><span style="color:#333333;">valueint：如果键值类型(type)是整数，则将该指针指向键值；</span></code></li><li style="text-align:left;"><code><span style="color:#333333;">valuedouble：如果键值类型(type)是浮点数，则将该指针指向键值；</span></code></li></ol></li><li style="text-align:left;"><code><span style="color:#333333;"> 一段完整的JSON数据中由很多键值对组成，并且涉及到键值对的查找、删除、添加，所以使用链表来存储整段JSON数据，如上面的代码所示：</span></code> 
    <ol><li style="text-align:left;"><code><span style="background-color:#f9f2f4;"><span style="color:#c7254e;">next</span></span><span style="background-color:#ffffff;"><span style="color:#000000;">指针：指向下一个键值对</span></span></code></li><li style="text-align:left;"><code><span style="background-color:#f9f2f4;"><span style="color:#c7254e;">prev</span></span><span style="background-color:#ffffff;"><span style="color:#000000;">指针指向上一个键值对</span></span></code></li></ol></li><li style="text-align:left;"><code><span style="color:#333333;"> 因为JSON数据支持嵌套，所以一个键值对的值会是一个新的JSON数据对象（一条新的链表），也有可能是一个数组，方便起见，在cJSON中，数组也表示为一个数组对象，用链表存储，所以：在键值对结构体中，当该键值对的值是一个嵌套的JSON数据或者一个数组时，由child指针指向该条新链表;</span></code></li><li style="text-align:left;"><code><span style="color:#333333;"> 链表中的一些概念：</span></code> 
    <ol><li style="text-align:left;"><code><span style="background-color:#ffffff;"><span style="color:#000000;">头指针：指向链表头结点的指针；</span></span></code></li><li style="text-align:left;"><code><span style="background-color:#ffffff;"><span style="color:#000000;">头结点：不存放有效数据，方便链表操作；</span></span></code></li><li style="text-align:left;"><code><span style="background-color:#ffffff;"><span style="color:#000000;">首节点：第一个存放有效数据的节点；</span></span></code></li><li style="text-align:left;"><code><span style="background-color:#ffffff;"><span style="color:#000000;">尾节点：最后一个存放有效数据的节点；</span></span></code></li></ol></li></ol> 
  <p class="img-center"><img alt="" src="https://images2.imgbox.com/38/36/dLiCJlA0_o.png"></p> 
  <p></p> 
  <h2 id="%E4%BA%94%E3%80%81%E4%BD%BF%E7%94%A8CJSON%E6%9E%84%E9%80%A0JSON" style="text-align:left;">五、<strong><span style="color:#1a1a1a;">使用CJSON构造JSON</span></strong></h2> 
  <h3 id="cJSON%E5%B8%B8%E7%94%A8%E5%BA%93%E5%87%BD%E6%95%B0%E4%BB%8B%E7%BB%8D" style="text-align:left;"><strong><span style="color:#1a1a1a;">1. cJSON常用库函数介绍</span></strong></h3> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#0077aa;">extern</span> <span style="color:#000000;">cJSON </span><span style="color:#9a6e3a;">*</span>  <span style="color:#dd4a68;">cJSON_CreateObject</span><span style="color:#999999;">(</span><span style="color:#0077aa;">void</span><span style="color:#999999;">);</span>	<span style="color:#708090;">//创建对象</span>


<span style="color:#0077aa;">extern</span> <span style="color:#000000;">cJSON </span><span style="color:#9a6e3a;">*</span>  <span style="color:#dd4a68;">cJSON_CreateArray</span><span style="color:#999999;">(</span><span style="color:#0077aa;">void</span><span style="color:#999999;">);</span>	<span style="color:#708090;">//创建数组</span>


<span style="color:#0077aa;">extern</span><span style="color:#000000;"> cJSON </span><span style="color:#9a6e3a;">*</span>  <span style="color:#dd4a68;">cJSON_CreateIntArray</span><span style="color:#999999;">(</span><span style="color:#0077aa;">const</span> <span style="color:#0077aa;">int</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;">numbers</span><span style="color:#999999;">,</span> <span style="color:#0077aa;">int</span><span style="color:#000000;"> count</span><span style="color:#999999;">);</span><span style="color:#708090;">//创建整型数组</span>


<span style="color:#0077aa;">extern</span> <span style="color:#000000;">cJSON </span><span style="color:#9a6e3a;">*</span>  <span style="color:#dd4a68;">cJSON_CreateDoubleArray</span><span style="color:#999999;">(</span><span style="color:#0077aa;">const</span> <span style="color:#0077aa;">double</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;">numbers</span><span style="color:#999999;">,</span> <span style="color:#0077aa;">int</span><span style="color:#000000;"> count</span><span style="color:#999999;">);</span><span style="color:#708090;">//创建双浮点型数组</span>


<span style="color:#0077aa;">extern</span><span style="color:#000000;"> cJSON</span><span style="color:#9a6e3a;">*</span>  <span style="color:#dd4a68;">cJSON_AddNullToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">cJSON </span><span style="color:#9a6e3a;">*</span> <span style="color:#0077aa;">const</span><span style="color:#000000;"> object</span><span style="color:#999999;">,</span> <span style="color:#0077aa;">const</span> <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span> <span style="color:#0077aa;">const</span><span style="color:#000000;"> name</span><span style="color:#999999;">);</span><span style="color:#708090;">//在对象中添加null</span>


<span style="color:#0077aa;">extern</span><span style="color:#000000;"> cJSON</span><span style="color:#9a6e3a;">*</span>  <span style="color:#dd4a68;">cJSON_AddTrueToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">cJSON </span><span style="color:#9a6e3a;">*</span> <span style="color:#0077aa;">const</span><span style="color:#000000;"> object</span><span style="color:#999999;">,</span> <span style="color:#0077aa;">const</span> <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span> <span style="color:#0077aa;">const</span><span style="color:#000000;"> name</span><span style="color:#999999;">);</span><span style="color:#708090;">//在对象中添加true</span>


<span style="color:#0077aa;">extern</span><span style="color:#000000;"> cJSON</span><span style="color:#9a6e3a;">*</span>  <span style="color:#dd4a68;">cJSON_AddFalseToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">cJSON </span><span style="color:#9a6e3a;">*</span> <span style="color:#0077aa;">const</span><span style="color:#000000;"> object</span><span style="color:#999999;">,</span> <span style="color:#0077aa;">const</span> <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span> <span style="color:#0077aa;">const</span><span style="color:#000000;"> name</span><span style="color:#999999;">);</span><span style="color:#708090;">//在对象中添加false</span>


<span style="color:#0077aa;">extern</span><span style="color:#000000;"> cJSON</span><span style="color:#9a6e3a;">*</span>  <span style="color:#dd4a68;">cJSON_AddNumberToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">cJSON </span><span style="color:#9a6e3a;">*</span> <span style="color:#0077aa;">const</span><span style="color:#000000;"> object</span><span style="color:#999999;">,</span> <span style="color:#0077aa;">const</span> <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span> <span style="color:#0077aa;">const</span><span style="color:#000000;"> name</span><span style="color:#999999;">,</span> <span style="color:#0077aa;">const</span> <span style="color:#0077aa;">double</span><span style="color:#000000;"> number</span><span style="color:#999999;">);</span><span style="color:#708090;">//在对象中添加数字</span>


<span style="color:#0077aa;">extern</span><span style="color:#000000;"> cJSON</span><span style="color:#9a6e3a;">*</span>  <span style="color:#dd4a68;">cJSON_AddStringToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">cJSON </span><span style="color:#9a6e3a;">*</span> <span style="color:#0077aa;">const</span><span style="color:#000000;"> object</span><span style="color:#999999;">,</span> <span style="color:#0077aa;">const</span> <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span> <span style="color:#0077aa;">const</span><span style="color:#000000;"> name</span><span style="color:#999999;">,</span> <span style="color:#0077aa;">const</span> <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span> <span style="color:#0077aa;">const</span><span style="color:#000000;"> string</span><span style="color:#999999;">);</span><span style="color:#708090;">//在对象中添加字符串</span>


<span style="color:#0077aa;">extern</span><span style="color:#000000;"> cJSON_bool  </span><span style="color:#dd4a68;">cJSON_AddItemToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">cJSON </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">object</span><span style="color:#999999;">,</span> <span style="color:#0077aa;">const</span> <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;">string</span><span style="color:#999999;">,</span><span style="color:#000000;"> cJSON </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">item</span><span style="color:#999999;">);</span>	<span style="color:#708090;">//在对象中添加项目</span>


<span style="color:#0077aa;">extern</span><span style="color:#000000;"> cJSON_bool  </span><span style="color:#dd4a68;">cJSON_AddItemToArray</span><span style="color:#999999;">(</span><span style="color:#000000;">cJSON </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">array</span><span style="color:#999999;">,</span><span style="color:#000000;"> cJSON </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">item</span><span style="color:#999999;">);</span><span style="color:#708090;">//在数组中添加项目</span>


<span style="color:#0077aa;">extern</span> <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span>  <span style="color:#dd4a68;">cJSON_Print</span><span style="color:#999999;">(</span><span style="color:#0077aa;">const</span><span style="color:#000000;"> cJSON </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">item</span><span style="color:#999999;">);</span><span style="color:#708090;">//JSON数据结构转换为JSON字符串---有格式</span>
<span style="color:#0077aa;">extern</span> <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span>  <span style="color:#dd4a68;">cJSON_PrintUnformatted</span><span style="color:#999999;">(</span><span style="color:#0077aa;">const</span><span style="color:#000000;"> cJSON </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">item</span><span style="color:#999999;">);</span>	<span style="color:#708090;">//JSON数据结构转换为JSON字符串---无格式</span>


<span style="color:#0077aa;">extern</span> <span style="color:#0077aa;">void</span>  <span style="color:#dd4a68;">cJSON_Delete</span><span style="color:#999999;">(</span><span style="color:#000000;">cJSON </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">item</span><span style="color:#999999;">);</span> <span style="color:#708090;">//清除结构体</span>


</code></span></pre> 
  <p></p> 
  <h3 id="2.%20CJSON%E6%9E%84%E9%80%A0JSON%E5%AE%9E%E4%BE%8B%E4%BB%A3%E7%A0%81" style="text-align:left;"><strong><span style="color:#1a1a1a;">2. CJSON构造JSON实例代码</span></strong></h3> 
  <p style="text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#include "string.h"</span>
<span style="color:#000000;">#include "cJSON.h"</span>
<span style="color:#000000;">#include "stdio.h"</span>






<span style="color:#0077aa;">int</span> <span style="color:#dd4a68;">main</span><span style="color:#999999;">()</span>
<span style="color:#999999;">{<!-- --></span>
    <span style="color:#708090;">// 创建头指针</span>
<span style="color:#000000;">    cJSON </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">JSON_Root </span><span style="color:#9a6e3a;">=</span> <span style="color:#990055;">NULL</span><span style="color:#999999;">;</span>


    <span style="color:#708090;">// 创建头结点，并将头指针指向头结点（可以看做是一个树的根root）</span>
<span style="color:#000000;">    JSON_Root </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">cJSON_CreateObject</span><span style="color:#999999;">();</span>


    <span style="color:#708090;">// 添加一条字符串类型的JSON数据</span>
    <span style="color:#dd4a68;">cJSON_AddStringToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">JSON_Root</span><span style="color:#999999;">,</span> <span style="color:#669900;">"name"</span><span style="color:#999999;">,</span> <span style="color:#669900;">"zhuhua"</span><span style="color:#999999;">);</span>


    <span style="color:#708090;">// 添加一条浮点类型的JSON数据（添加一个链表结点）到root下</span>
    <span style="color:#dd4a68;">cJSON_AddNumberToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">JSON_Root</span><span style="color:#999999;">,</span> <span style="color:#669900;">"height"</span><span style="color:#999999;">,</span> <span style="color:#990055;">66.6666</span><span style="color:#999999;">);</span>


    <span style="color:#708090;">// 添加一条整数型的JSON数据（链表结点）</span>
    <span style="color:#dd4a68;">cJSON_AddNumberToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">JSON_Root</span><span style="color:#999999;">,</span> <span style="color:#669900;">"grade"</span><span style="color:#999999;">,</span> <span style="color:#990055;">100</span><span style="color:#999999;">);</span>


    <span style="color:#708090;">// 添加一个嵌套的JSON数据（添加一个链表节点， 又一个《对象》）</span>
<span style="color:#000000;">    cJSON </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">timeCode </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">cJSON_CreateObject</span><span style="color:#999999;">();</span>


    <span style="color:#708090;">// true</span>
    <span style="color:#dd4a68;">cJSON_AddTrueToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">timeCode</span><span style="color:#999999;">,</span> <span style="color:#669900;">"Sex"</span><span style="color:#999999;">);</span>


    <span style="color:#dd4a68;">cJSON_AddStringToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">timeCode</span><span style="color:#999999;">,</span> <span style="color:#669900;">"datatime"</span><span style="color:#999999;">,</span> <span style="color:#669900;">"20220811"</span><span style="color:#999999;">);</span>


    <span style="color:#dd4a68;">cJSON_AddFalseToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">timeCode</span><span style="color:#999999;">,</span> <span style="color:#669900;">"Judge"</span><span style="color:#999999;">);</span>


    <span style="color:#708090;">// 最后把这个对象加入到root下</span>
    <span style="color:#dd4a68;">cJSON_AddItemToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">JSON_Root</span><span style="color:#999999;">,</span> <span style="color:#669900;">"TIMECODE"</span><span style="color:#999999;">,</span><span style="color:#000000;"> timeCode</span><span style="color:#999999;">);</span>


    <span style="color:#708090;">// 再次嵌套，加入一个数组类型的JSON数据，在timecode结点之下（添加一个链表结点）</span>
<span style="color:#000000;">    cJSON </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">dataCode </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">cJSON_CreateArray</span><span style="color:#999999;">();</span>
    <span style="color:#708090;">// 两种方式添加</span>
    <span style="color:#dd4a68;">cJSON_AddStringToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">dataCode</span><span style="color:#999999;">,</span> <span style="color:#669900;">""</span><span style="color:#999999;">,</span> <span style="color:#669900;">"English"</span><span style="color:#999999;">);</span>


    <span style="color:#dd4a68;">cJSON_AddItemToArray</span><span style="color:#999999;">(</span><span style="color:#000000;">dataCode</span><span style="color:#999999;">,</span> <span style="color:#dd4a68;">cJSON_CreateString</span><span style="color:#999999;">(</span><span style="color:#669900;">"zhuzhuzhu"</span><span style="color:#999999;">));</span>


    <span style="color:#dd4a68;">cJSON_AddStringToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">dataCode</span><span style="color:#999999;">,</span> <span style="color:#669900;">""</span><span style="color:#999999;">,</span> <span style="color:#669900;">"huahuahua"</span><span style="color:#999999;">);</span>


    <span style="color:#dd4a68;">cJSON_AddNumberToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">dataCode</span><span style="color:#999999;">,</span> <span style="color:#669900;">"number"</span><span style="color:#999999;">,</span> <span style="color:#990055;">300</span><span style="color:#999999;">);</span>
    <span style="color:#708090;">// 将datacode  （array）结点添加到timecode 对象结点下（同样数组也可以有对象数据， 甚至数组中数据类型也可以不一样，但这样理解上不太好）</span>
    <span style="color:#dd4a68;">cJSON_AddItemToObject</span><span style="color:#999999;">(</span><span style="color:#000000;">timeCode</span><span style="color:#999999;">,</span> <span style="color:#669900;">"DATACODE"</span><span style="color:#999999;">,</span><span style="color:#000000;"> dataCode</span><span style="color:#999999;">);</span>


    <span style="color:#708090;">// 最后将JSON数据结构转换为字符串， 并且输出</span>
    <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;">strForJson </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">cJSON_Print</span><span style="color:#999999;">(</span><span style="color:#000000;">JSON_Root</span><span style="color:#999999;">);</span>
    <span style="color:#dd4a68;">printf</span><span style="color:#999999;">(</span><span style="color:#669900;">"json字符串：%s\n"</span><span style="color:#999999;">,</span><span style="color:#000000;"> strForJson</span><span style="color:#999999;">);</span>


    <span style="color:#708090;">// 将字符串存入到文件中</span>
<span style="color:#000000;">    FILE </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">FCJ </span><span style="color:#9a6e3a;">=</span> <span style="color:#990055;">NULL</span><span style="color:#999999;">;</span>
<span style="color:#000000;">    FILE </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">FCJ1 </span><span style="color:#9a6e3a;">=</span> <span style="color:#990055;">NULL</span><span style="color:#999999;">;</span>


<span style="color:#000000;">    FCJ </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">fopen</span><span style="color:#999999;">(</span><span style="color:#669900;">"data.txt"</span><span style="color:#999999;">,</span> <span style="color:#669900;">"w"</span><span style="color:#999999;">);</span>
<span style="color:#000000;">    FCJ1 </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">fopen</span><span style="color:#999999;">(</span><span style="color:#669900;">"data1.txt"</span><span style="color:#999999;">,</span> <span style="color:#669900;">"w"</span><span style="color:#999999;">);</span>


    <span style="color:#0077aa;">int</span><span style="color:#000000;"> i </span><span style="color:#9a6e3a;">=</span> <span style="color:#990055;">0</span><span style="color:#999999;">;</span>
   
    <span style="color:#0077aa;">for</span> <span style="color:#999999;">(</span><span style="color:#000000;">i </span><span style="color:#9a6e3a;">=</span> <span style="color:#990055;">0</span><span style="color:#999999;">;</span><span style="color:#000000;"> i </span><span style="color:#9a6e3a;">&lt;</span> <span style="color:#dd4a68;">strlen</span><span style="color:#999999;">(</span><span style="color:#000000;">strForJson</span><span style="color:#999999;">);</span> <span style="color:#9a6e3a;">++</span><span style="color:#000000;">i</span><span style="color:#999999;">)</span>
    <span style="color:#999999;">{<!-- --></span>
        <span style="color:#dd4a68;">fprintf</span><span style="color:#999999;">(</span><span style="color:#000000;">FCJ</span><span style="color:#999999;">,</span> <span style="color:#669900;">"%c"</span><span style="color:#999999;">,</span><span style="color:#000000;"> strForJson</span><span style="color:#999999;">[</span><span style="color:#000000;">i</span><span style="color:#999999;">]);</span>
        <span style="color:#dd4a68;">fputc</span><span style="color:#999999;">(</span><span style="color:#000000;">strForJson</span><span style="color:#999999;">[</span><span style="color:#000000;">i</span><span style="color:#999999;">],</span><span style="color:#000000;"> FCJ1</span><span style="color:#999999;">);</span>
    <span style="color:#999999;">}</span>


    <span style="color:#dd4a68;">fclose</span><span style="color:#999999;">(</span><span style="color:#000000;">FCJ</span><span style="color:#999999;">);</span>
    <span style="color:#dd4a68;">fclose</span><span style="color:#999999;">(</span><span style="color:#000000;">FCJ1</span><span style="color:#999999;">);</span>


    <span style="color:#708090;">// 清除结构体</span>
    <span style="color:#dd4a68;">cJSON_Delete</span><span style="color:#999999;">(</span><span style="color:#000000;">JSON_Root</span><span style="color:#999999;">);</span>


    <span style="color:#0077aa;">return</span> <span style="color:#990055;">0</span><span style="color:#999999;">;</span>
<span style="color:#999999;">}</span>


</code></span></pre> 
  <p></p> 
  <ul><li> <p style="text-align:left;"><span style="color:#333333;">输出结果如下：</span></p> 
    <ul><li> <p class="img-center"><img alt="" src="https://images2.imgbox.com/56/f9/bTxGD9ps_o.png"></p> </li></ul></li></ul> 
  <p style="text-align:left;"></p> 
  <h4 id="%EF%BC%881%EF%BC%89%EF%BC%81%EF%BC%81%EF%BC%81%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E4%B8%AD%E6%9C%89%E4%B8%A4%E4%B8%AA%E6%B3%A8%E6%84%8F%E7%9A%84%E7%82%B9%EF%BC%9A"><strong><span style="color:#1a1a1a;">（1）！！！编译过程中有两个注意的点：</span></strong></h4> 
  <ol><li> <p style="text-align:left;"><span style="color:#333333;">提示头文件中报unknown type name ‘size_t’错误：</span></p> 
    <ol><li> <p class="img-center"><img alt="" src="https://images2.imgbox.com/ac/f3/XxhJZ3zP_o.png"></p> </li><li> <p style="text-align:left;"><span style="color:#333333;">原因及解决方案：</span></p> 
      <ol><li> <p style="text-align:left;"><span style="color:#333333;">原因在测试c文件中加入了string.h的头文件，并且放在了cJSON.h的后面；</span></p> </li><li> <p style="text-align:left;"><span style="color:#333333;">解决：一定要把string.h放在cJSON头文件的前面；</span></p> </li></ol></li></ol></li><li> <p style="text-align:left;"><span style="color:#333333;">提示找不到pow和floor函数：</span></p> 
    <ol><li> <p class="img-center"><img alt="" src="https://images2.imgbox.com/1b/d9/tLjlZKFI_o.png"></p> </li><li> <p style="text-align:left;"><span style="color:#333333;">解决方案：需要链接math库libm（可以查一下libc相关）</span></p> </li></ol></li><li> <p style="text-align:left;"><span style="color:#333333;">编译语句</span></p> </li></ol> 
  <p style="text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">gcc cJson</span><span style="color:#999999;">.</span><span style="color:#000000;">c CJSONTest</span><span style="color:#999999;">.</span><span style="color:#000000;">c </span><span style="color:#9a6e3a;">-</span><span style="color:#000000;">o uim </span><span style="color:#9a6e3a;">-</span><span style="color:#000000;">lm</span>
<span style="color:#000000;">最后</span><span style="color:#999999;">.</span><span style="color:#9a6e3a;">/</span><span style="color:#000000;">uim执行即可；</span>
</code></span></pre> 
  <p></p> 
  <p style="text-align:left;"></p> 
  <h3 id="3.%20%E4%BD%BF%E7%94%A8cJSON%E8%A7%A3%E6%9E%90JSON%E5%AE%9E%E4%BE%8B%E4%BB%A3%E7%A0%81" style="text-align:left;"><strong><span style="color:#1a1a1a;">3. 使用cJSON解析JSON实例代码</span></strong></h3> 
  <p style="text-align:left;"></p> 
  <pre><span style="background-color:#fafafa;"><code><span style="color:#000000;">#include &lt;stdio.h&gt;</span>
<span style="color:#000000;">#include "cJSON.h"</span>




<span style="color:#0077aa;">int</span> <span style="color:#dd4a68;">main</span><span style="color:#999999;">()</span>
<span style="color:#999999;">{<!-- --></span>


    <span style="color:#708090;">// 定义JSON字符串</span>
    <span style="color:#0077aa;">char</span><span style="color:#000000;"> json_string</span><span style="color:#999999;">[]</span><span style="color:#9a6e3a;">=</span><span style="color:#669900;">"{\"name\":\"zhuhua\",\</span>
<span style="color:#669900;">            \"height\":66.666600,\"grade\":100,\"TIMECODE\":{\"Sex\":true,\"datatime\":\"20220811\",\"Judge\":false,\"DATACODE\":[\"English\",\"zhuzhuzhu\",\"huahuahua\",300]}}"</span><span style="color:#999999;">;</span><span style="color:#708090;">//定义JSON字符串	</span>
    
    <span style="color:#708090;">// 将JSON字符串转换成JSON结构体</span>
<span style="color:#000000;">    cJSON </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">JSON_ROOT </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">cJSON_Parse</span><span style="color:#999999;">(</span><span style="color:#000000;">json_string</span><span style="color:#999999;">);</span>


    <span style="color:#708090;">// 判断转换是否成功</span>
    <span style="color:#0077aa;">if</span> <span style="color:#999999;">(</span><span style="color:#000000;">JSON_ROOT </span><span style="color:#9a6e3a;">==</span> <span style="color:#990055;">NULL</span><span style="color:#999999;">)</span>
    <span style="color:#999999;">{<!-- --></span>
        <span style="color:#dd4a68;">printf</span><span style="color:#999999;">(</span><span style="color:#669900;">"cjson error.......\n"</span><span style="color:#999999;">);</span>
    <span style="color:#999999;">}</span>
    <span style="color:#0077aa;">else</span>
    <span style="color:#999999;">{<!-- --></span>
        <span style="color:#dd4a68;">printf</span><span style="color:#999999;">(</span><span style="color:#669900;">"%s\n"</span><span style="color:#999999;">,</span> <span style="color:#dd4a68;">cJSON_Print</span><span style="color:#999999;">(</span><span style="color:#000000;">JSON_ROOT</span><span style="color:#999999;">));</span>
    <span style="color:#999999;">}</span>


    <span style="color:#dd4a68;">printf</span><span style="color:#999999;">(</span><span style="color:#669900;">"提取数据\n"</span><span style="color:#999999;">);</span>


    <span style="color:#708090;">// 解析字符串 找key 得value</span>
    <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;">name </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">cJSON_GetObjectItem</span><span style="color:#999999;">(</span><span style="color:#000000;">JSON_ROOT</span><span style="color:#999999;">,</span> <span style="color:#669900;">"name"</span><span style="color:#999999;">)</span><span style="color:#9a6e3a;">-&gt;</span><span style="color:#000000;">valuestring</span><span style="color:#999999;">;</span>
    <span style="color:#708090;">// 打印看一下效果</span>
    <span style="color:#dd4a68;">printf</span><span style="color:#999999;">(</span><span style="color:#669900;">"%s\n"</span><span style="color:#999999;">,</span><span style="color:#000000;"> name</span><span style="color:#999999;">);</span>


    <span style="color:#0077aa;">double</span><span style="color:#000000;"> height </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">cJSON_GetObjectItem</span><span style="color:#999999;">(</span><span style="color:#000000;">JSON_ROOT</span><span style="color:#999999;">,</span> <span style="color:#669900;">"height"</span><span style="color:#999999;">)</span><span style="color:#9a6e3a;">-&gt;</span><span style="color:#000000;">valuedouble</span><span style="color:#999999;">;</span>
    <span style="color:#dd4a68;">printf</span><span style="color:#999999;">(</span><span style="color:#669900;">"%lf\n"</span><span style="color:#999999;">,</span><span style="color:#000000;"> height</span><span style="color:#999999;">);</span>


    <span style="color:#0077aa;">int</span><span style="color:#000000;"> grade </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">cJSON_GetObjectItem</span><span style="color:#999999;">(</span><span style="color:#000000;">JSON_ROOT</span><span style="color:#999999;">,</span> <span style="color:#669900;">"grade"</span><span style="color:#999999;">)</span><span style="color:#9a6e3a;">-&gt;</span><span style="color:#000000;">valueint</span><span style="color:#999999;">;</span>
    <span style="color:#dd4a68;">printf</span><span style="color:#999999;">(</span><span style="color:#669900;">"%d\n"</span><span style="color:#999999;">,</span><span style="color:#000000;"> grade</span><span style="color:#999999;">);</span>


    <span style="color:#708090;">// 对象和数组的接收</span>
<span style="color:#000000;">    cJSON </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">obj_timeCode </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">cJSON_GetObjectItem</span><span style="color:#999999;">(</span><span style="color:#000000;">JSON_ROOT</span><span style="color:#999999;">,</span> <span style="color:#669900;">"TIMECODE"</span><span style="color:#999999;">);</span>   <span style="color:#708090;">// 解析对象</span>


<span style="color:#000000;">    cJSON </span><span style="color:#9a6e3a;">*</span><span style="color:#000000;">arr_dataCode </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">cJSON_GetObjectItem</span><span style="color:#999999;">(</span><span style="color:#000000;">obj_timeCode</span><span style="color:#999999;">,</span> <span style="color:#669900;">"DATACODE"</span><span style="color:#999999;">);</span>   <span style="color:#708090;">// 解析数组      一层一层来</span>


    <span style="color:#0077aa;">int</span><span style="color:#000000;"> sex </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">cJSON_GetObjectItem</span><span style="color:#999999;">(</span><span style="color:#000000;">obj_timeCode</span><span style="color:#999999;">,</span> <span style="color:#669900;">"Sex"</span><span style="color:#999999;">)</span><span style="color:#9a6e3a;">-&gt;</span><span style="color:#000000;">type</span><span style="color:#999999;">;</span>   <span style="color:#708090;">// 解析逻辑值————输出逻辑值对应的宏定义数值</span>
    <span style="color:#dd4a68;">printf</span><span style="color:#999999;">(</span><span style="color:#669900;">"%d\n"</span><span style="color:#999999;">,</span><span style="color:#000000;"> sex</span><span style="color:#999999;">);</span>


    <span style="color:#0077aa;">char</span> <span style="color:#9a6e3a;">*</span><span style="color:#000000;">datatime </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">cJSON_GetObjectItem</span><span style="color:#999999;">(</span><span style="color:#000000;">obj_timeCode</span><span style="color:#999999;">,</span> <span style="color:#669900;">"datatime"</span><span style="color:#999999;">)</span><span style="color:#9a6e3a;">-&gt;</span><span style="color:#000000;">valuestring</span><span style="color:#999999;">;</span>
    <span style="color:#dd4a68;">printf</span><span style="color:#999999;">(</span><span style="color:#669900;">"%s\n"</span><span style="color:#999999;">,</span><span style="color:#000000;"> datatime</span><span style="color:#999999;">);</span>


    <span style="color:#0077aa;">int</span><span style="color:#000000;"> judge </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">cJSON_GetObjectItem</span><span style="color:#999999;">(</span><span style="color:#000000;">obj_timeCode</span><span style="color:#999999;">,</span> <span style="color:#669900;">"Judge"</span><span style="color:#999999;">)</span><span style="color:#9a6e3a;">-&gt;</span><span style="color:#000000;">type</span><span style="color:#999999;">;</span>   <span style="color:#708090;">// 解析逻辑值————输出逻辑值对应的宏定义数值</span>
    <span style="color:#dd4a68;">printf</span><span style="color:#999999;">(</span><span style="color:#669900;">"%d\n"</span><span style="color:#999999;">,</span><span style="color:#000000;"> judge</span><span style="color:#999999;">);</span>


    <span style="color:#708090;">// 数组的处理 先获取数组的成员个数</span>
    <span style="color:#0077aa;">int</span><span style="color:#000000;"> arr_size </span><span style="color:#9a6e3a;">=</span> <span style="color:#dd4a68;">cJSON_GetArraySize</span><span style="color:#999999;">(</span><span style="color:#000000;">arr_dataCode</span><span style="color:#999999;">);</span>
    <span style="color:#dd4a68;">printf</span><span style="color:#999999;">(</span><span style="color:#669900;">"arrsize: %d\n"</span><span style="color:#999999;">,</span><span style="color:#000000;"> arr_size</span><span style="color:#999999;">);</span>
    <span style="color:#0077aa;">int</span><span style="color:#000000;"> i </span><span style="color:#9a6e3a;">=</span> <span style="color:#990055;">0</span><span style="color:#999999;">;</span>
    <span style="color:#0077aa;">for</span> <span style="color:#999999;">(</span><span style="color:#000000;">i </span><span style="color:#9a6e3a;">=</span> <span style="color:#990055;">0</span><span style="color:#999999;">;</span><span style="color:#000000;"> i </span><span style="color:#9a6e3a;">&lt;</span><span style="color:#000000;"> arr_size </span><span style="color:#9a6e3a;">-</span> <span style="color:#990055;">1</span><span style="color:#999999;">;</span> <span style="color:#9a6e3a;">++</span><span style="color:#000000;">i</span><span style="color:#999999;">)</span>
    <span style="color:#999999;">{<!-- --></span>
        <span style="color:#dd4a68;">printf</span><span style="color:#999999;">(</span><span style="color:#669900;">"%s\n"</span><span style="color:#999999;">,</span> <span style="color:#dd4a68;">cJSON_GetArrayItem</span><span style="color:#999999;">(</span><span style="color:#000000;">arr_dataCode</span><span style="color:#999999;">,</span><span style="color:#000000;"> i</span><span style="color:#999999;">)</span><span style="color:#9a6e3a;">-&gt;</span><span style="color:#000000;">valuestring</span><span style="color:#999999;">);</span>
    <span style="color:#999999;">}</span>
    <span style="color:#dd4a68;">printf</span><span style="color:#999999;">(</span><span style="color:#669900;">"%d\n"</span><span style="color:#999999;">,</span> <span style="color:#dd4a68;">cJSON_GetArrayItem</span><span style="color:#999999;">(</span><span style="color:#000000;">arr_dataCode</span><span style="color:#999999;">,</span><span style="color:#000000;"> arr_size </span><span style="color:#9a6e3a;">-</span> <span style="color:#990055;">1</span><span style="color:#999999;">)</span><span style="color:#9a6e3a;">-&gt;</span><span style="color:#000000;">valueint</span><span style="color:#999999;">);</span>


    <span style="color:#708090;">// 清除结构体</span>
    <span style="color:#dd4a68;">cJSON_Delete</span><span style="color:#999999;">(</span><span style="color:#000000;">JSON_ROOT</span><span style="color:#999999;">);</span>
    <span style="color:#0077aa;">return</span> <span style="color:#990055;">0</span><span style="color:#999999;">;</span>
<span style="color:#999999;">}</span>
</code></span></pre> 
  <p></p> 
  <ul><li> <p style="text-align:left;"><span style="color:#333333;">运行结果如下</span></p> </li></ul> 
  <p class="img-center"><img alt="" src="https://images2.imgbox.com/d6/99/VaEIH88w_o.png"></p> 
 </div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8ac05ffaba65b72f577cd024461d5f16/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">快速排序（三种方法实现）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/92253229e8e16bc85370a247019c321f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Unsupported platform for fsevents@1.2.13: wanted {“name“:“fsevents“,“version“:“1.2.13“,“engines“:</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>