<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用 RKE 方式搭建 K8s 集群并部署 NebulaGraph - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用 RKE 方式搭建 K8s 集群并部署 NebulaGraph" />
<meta property="og:description" content="本文由社区用户 Albert 贡献，首发于 NebulaGraph 论坛，旨在提供多一种的部署方式使用 NebulaGraph。
在本文，我将会详细地记录下我用 K8s 部署分布式图数据库 NebulaGraph 的过程。下面是本次实践的内容规划：
一到十章节为 K8s 集群搭建过程；十一到十五章节为参考 NebulaGraph 官方文档安装部署 NebulaGraph的过程； 本文所有实践是在本地虚拟机 3 台 CentOS 实例上完成
一、集群环境准备 本文所有集群都遵循以下的部署，仅供参考。
首先，集群规划 方面：
#把 xxx 替换为对应的主机名 192.168.222.141 node1 192.168.222.142 node2 192.168.222.143 node3 配置静态 IP
# vi /etc/sysconfig/network-scripts/ifcfg-enss3 IPADDR=&#34;192.168.222.XXX&#34; # XXX 是自己规划的 IP PREFIX=&#34;24&#34; # 掩码 4 个 255 GATEWAY=&#34;192.168.222.XXX&#34; # 网关需要自己指定 DNS1=&#34;114.114.114.114&#34; # DNS 也可以设置为其他，能用即可 配置主机名
hostnamectl set-hostname xxx 192.168.222.141 node1 192.168.222.142 node2 192.168.222.143 node3 配置 ip_forward 及过滤机制" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/8697782d6064ffbbd17bbe0d14616178/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-07T18:19:50+08:00" />
<meta property="article:modified_time" content="2023-08-07T18:19:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用 RKE 方式搭建 K8s 集群并部署 NebulaGraph</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/59/3e/AhOCQKp9_o.jpg" alt=""></p> 
<blockquote> 
 <p>本文由社区用户 Albert 贡献，首发于 NebulaGraph 论坛，旨在提供多一种的部署方式使用 NebulaGraph。</p> 
</blockquote> 
<p>在本文，我将会详细地记录下我用 K8s 部署分布式图数据库 NebulaGraph 的过程。下面是本次实践的内容规划：</p> 
<ol><li>一到十章节为 K8s 集群搭建过程；</li><li>十一到十五章节为参考 NebulaGraph 官方文档安装部署 NebulaGraph的过程；</li></ol> 
<p>本文所有实践是在本地虚拟机 3 台 CentOS 实例上完成</p> 
<h3><a id="_11"></a>一、集群环境准备</h3> 
<p>本文所有集群都遵循以下的部署，仅供参考。</p> 
<p>首先，<strong>集群规划</strong> 方面：</p> 
<pre><code class="prism language-shell"><span class="token comment">#把 xxx 替换为对应的主机名</span>
<span class="token number">192.168</span>.222.141 node1
<span class="token number">192.168</span>.222.142 node2
<span class="token number">192.168</span>.222.143 node3
</code></pre> 
<p><strong>配置静态 IP</strong></p> 
<pre><code class="prism language-shell"><span class="token comment"># vi /etc/sysconfig/network-scripts/ifcfg-enss3</span>

<span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token string">"192.168.222.XXX"</span> <span class="token comment"># XXX 是自己规划的 IP</span>
<span class="token assign-left variable">PREFIX</span><span class="token operator">=</span><span class="token string">"24"</span>  <span class="token comment"># 掩码 4 个 255</span>
<span class="token assign-left variable">GATEWAY</span><span class="token operator">=</span><span class="token string">"192.168.222.XXX"</span> <span class="token comment"># 网关需要自己指定</span>
<span class="token assign-left variable">DNS1</span><span class="token operator">=</span><span class="token string">"114.114.114.114"</span> <span class="token comment"># DNS 也可以设置为其他，能用即可</span>
</code></pre> 
<p><strong>配置主机名</strong></p> 
<pre><code class="prism language-shell">hostnamectl set-hostname xxx
<span class="token number">192.168</span>.222.141 node1
<span class="token number">192.168</span>.222.142 node2
<span class="token number">192.168</span>.222.143 node3
</code></pre> 
<p><strong>配置 ip_forward 及过滤机制</strong></p> 
<pre><code class="prism language-shell"><span class="token comment"># vim /etc/sysctl.conf</span>
net.ipv4.ip_forward <span class="token operator">=</span> <span class="token number">1</span>
net.bridge.bridge-nf-call-ip6tables <span class="token operator">=</span> <span class="token number">1</span>
net.bridge.bridge-nf-call-iptables <span class="token operator">=</span> <span class="token number">1</span>
modprobe br_netfilter
<span class="token function">sysctl</span> <span class="token parameter variable">-p</span> /etc/sysctl.conf
</code></pre> 
<p><strong>防火墙设置</strong></p> 
<pre><code class="prism language-shell"><span class="token comment"># systemctl stop firewalld</span>
<span class="token comment"># systemctl disable firewalld</span>
</code></pre> 
<p><strong>SELinux 设置</strong></p> 
<pre><code class="prism language-shell"><span class="token comment">#永久关闭，一定要重启操作系统后生效。</span>
<span class="token function">sed</span> <span class="token parameter variable">-ri</span> <span class="token string">'s/SELINUX=enforcing/SELINUX=disabled/'</span> /etc/selinux/config
</code></pre> 
<p><strong>主机 Swap 分区设置</strong></p> 
<pre><code class="prism language-shell"><span class="token function">sed</span> <span class="token parameter variable">-ri</span> <span class="token string">'s/.*swap.*/#&amp;/'</span> /etc/fstab
</code></pre> 
<p><strong>集群时间同步设置</strong></p> 
<pre><code class="prism language-shell"><span class="token comment"># yum -y install ntpdate</span>
<span class="token comment"># crontab -e</span>
<span class="token number">0</span> */1 * * *  ntpdate time1.aliyun.com
</code></pre> 
<h3><a id="Docker__82"></a>二、Docker 部署</h3> 
<p>⚠️ 所有主机均要按照下面方法进行配置。</p> 
<h4><a id="_Docker_YUM__86"></a>配置 Docker YUM 源</h4> 
<pre><code class="prism language-shell"><span class="token comment"># wget -O /etc/yum.repos.d/docker-ce.repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span>
</code></pre> 
<h4><a id="_Docker_CE_92"></a>安装 Docker CE</h4> 
<p>通过下面命令安装 Docker 社区版本：</p> 
<pre><code class="prism language-shell"><span class="token comment">#  yum install docker-ce-18.09.8-3.el7.x86_64 -y</span>
</code></pre> 
<p>⚠️ 这里需要指定 Docker 版本，否则后面 RKE 安装会报 Docker 版本不兼容问题。</p> 
<h4><a id="_Docker__101"></a>启动 Docker 服务</h4> 
<pre><code class="prism language-shell"><span class="token comment"># systemctl enable docker</span>
<span class="token comment"># systemctl start docker</span>
</code></pre> 
<h4><a id="_Docker__108"></a>配置 Docker 容器镜像加速器</h4> 
<p>登录个人阿里云账号，在镜像加速中查看配置，将 xxxxx 替换为自己的 ID：</p> 
<pre><code class="prism language-shell"><span class="token comment"># vim /etc/docker/daemon.json</span>
<span class="token comment"># cat /etc/docker/daemon.json</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token string">"registry-mirrors"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">"https://xxxxx.mirror.aliyuncs.com"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="Docker_Compose__120"></a>三、Docker Compose 安装</h3> 
<p>通过以下方式安装 Docker Compose：</p> 
<pre><code class="prism language-shell"><span class="token comment"># curl -L "https://github.com/docker/compose/releases/download/1.28.5/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose</span>
<span class="token comment"># chmod +x /usr/local/bin/docker-compose</span>
<span class="token comment"># ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose</span>
<span class="token comment"># docker-compose --version</span>
</code></pre> 
<h3><a id="_Rancher__131"></a>四、添加 Rancher 用户</h3> 
<p>在使用 CentOS 时，不能使用 root 账号，因此我们要添加专用的账号进行 Docker 相关操作。同之前一样，下面操作需要在所有机器上执行：</p> 
<pre><code class="prism language-shell"><span class="token comment"># useradd rancher</span>
<span class="token comment"># usermod -aG docker rancher</span>
<span class="token comment"># echo 123 | passwd --stdin rancher</span>
</code></pre> 
<h3><a id="_SSH__141"></a>五、生成 SSH 证书用于部署集群</h3> 
<p>RKE 二进制文件安装主机上创建密钥，即为 control 主机，用于部署集群。</p> 
<h4><a id="_SSH__145"></a>生成 SSH 证书</h4> 
<pre><code class="prism language-shell"><span class="token comment"># ssh-keygen</span>
</code></pre> 
<h4><a id="_151"></a>复制证书到集群中所有主机</h4> 
<pre><code class="prism language-shell"><span class="token comment"># 修改文件夹所属用户及所属组</span>
<span class="token function">chown</span> <span class="token parameter variable">-R</span> rancher:rancher /home/rancher
<span class="token comment"># ssh-copy-id rancher@node1</span>
<span class="token comment"># ssh-copy-id rancher@node2</span>
<span class="token comment"># ssh-copy-id rancher@node3</span>
</code></pre> 
<h4><a id="_SSH__161"></a>验证 SSH 证书是否可用</h4> 
<p>本次实践主要在 node1 上部署 RKE 二进制文件，并在 RKE 二进制文件安装主机机测试连接其它集群主机，可通过 Docker 的命令 <code>docker ps</code> 来查看服务是否可用。</p> 
<pre><code class="prism language-shell"><span class="token comment"># ssh rancher@主机名</span>
远程主机<span class="token comment"># docker ps</span>
</code></pre> 
<h3><a id="RKE__170"></a>六、RKE 工具下载</h3> 
<p>依旧是在 node1 上部署 RKE 二进制文件。</p> 
<pre><code class="prism language-shell"><span class="token comment"># wget https://github.com/rancher/rke/releases/download/v1.3.7/rke_linux-amd64</span>
<span class="token comment"># mv rke_linux-amd64 /usr/local/bin/rke</span>
<span class="token comment"># chmod +x /usr/local/bin/rke</span>
<span class="token comment"># rke --version</span>
rke version v1.3.7
</code></pre> 
<h3><a id="_RKE__182"></a>七、初始化 RKE 配置文件</h3> 
<pre><code class="prism language-shell"><span class="token comment"># mkdir -p /app/rancher</span>
<span class="token comment"># cd /app/rancher</span>
<span class="token comment"># rke config --name cluster.yml</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Cluster Level SSH Private Key Path <span class="token punctuation">[</span>~/.ssh/id_rsa<span class="token punctuation">]</span>: 集群私钥路径
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Number of Hosts <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: <span class="token number">3</span> 集群中有 <span class="token number">3</span> 个节点
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> SSH Address of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>none<span class="token punctuation">]</span>: <span class="token number">192.168</span>.10.10 第一个节点 IP 地址
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> SSH Port of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span>: <span class="token number">22</span> 第一个节点 SSH 访问端口
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> SSH Private Key Path of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.10<span class="token punctuation">)</span> <span class="token punctuation">[</span>none<span class="token punctuation">]</span>: ~/.ssh/id_rsa 第一个节点私钥路径
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> SSH User of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.10<span class="token punctuation">)</span> <span class="token punctuation">[</span>ubuntu<span class="token punctuation">]</span>: rancher 远程用户名
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Is <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.10<span class="token punctuation">)</span> a Control Plane <span class="token function">host</span> <span class="token punctuation">(</span>y/n<span class="token punctuation">)</span>? <span class="token punctuation">[</span>y<span class="token punctuation">]</span>: y 是否为 K8s 集群控制节点
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Is <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.10<span class="token punctuation">)</span> a Worker <span class="token function">host</span> <span class="token punctuation">(</span>y/n<span class="token punctuation">)</span>? <span class="token punctuation">[</span>n<span class="token punctuation">]</span>: n 不是 worker 节点
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Is <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.10<span class="token punctuation">)</span> an etcd <span class="token function">host</span> <span class="token punctuation">(</span>y/n<span class="token punctuation">)</span>? <span class="token punctuation">[</span>n<span class="token punctuation">]</span>: n 不是 etcd 节点
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Override Hostname of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.10<span class="token punctuation">)</span> <span class="token punctuation">[</span>none<span class="token punctuation">]</span>: 不覆盖现有主机名
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Internal IP of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.10<span class="token punctuation">)</span> <span class="token punctuation">[</span>none<span class="token punctuation">]</span>: 主机局域网 IP 地址
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Docker socket path on <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.10<span class="token punctuation">)</span> <span class="token punctuation">[</span>/var/run/docker.sock<span class="token punctuation">]</span>: 主机上 docker.sock 路径
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> SSH Address of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>none<span class="token punctuation">]</span>: <span class="token number">192.168</span>.10.12 第二个节点
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> SSH Port of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span>: <span class="token number">22</span> 远程端口
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> SSH Private Key Path of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.12<span class="token punctuation">)</span> <span class="token punctuation">[</span>none<span class="token punctuation">]</span>: ~/.ssh/id_rsa 私钥路径
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> SSH User of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.12<span class="token punctuation">)</span> <span class="token punctuation">[</span>ubuntu<span class="token punctuation">]</span>: rancher 远程访问用户
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Is <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.12<span class="token punctuation">)</span> a Control Plane <span class="token function">host</span> <span class="token punctuation">(</span>y/n<span class="token punctuation">)</span>? <span class="token punctuation">[</span>y<span class="token punctuation">]</span>: n 不是控制节点
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Is <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.12<span class="token punctuation">)</span> a Worker <span class="token function">host</span> <span class="token punctuation">(</span>y/n<span class="token punctuation">)</span>? <span class="token punctuation">[</span>n<span class="token punctuation">]</span>: y 是 worker 节点
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Is <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.12<span class="token punctuation">)</span> an etcd <span class="token function">host</span> <span class="token punctuation">(</span>y/n<span class="token punctuation">)</span>? <span class="token punctuation">[</span>n<span class="token punctuation">]</span>: n 不是 etcd 节点
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Override Hostname of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.12<span class="token punctuation">)</span> <span class="token punctuation">[</span>none<span class="token punctuation">]</span>: 不覆盖现有主机名
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Internal IP of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.12<span class="token punctuation">)</span> <span class="token punctuation">[</span>none<span class="token punctuation">]</span>: 主机局域网 IP 地址
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Docker socket path on <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.12<span class="token punctuation">)</span> <span class="token punctuation">[</span>/var/run/docker.sock<span class="token punctuation">]</span>: 主机上 docker.sock 路径
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> SSH Address of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>none<span class="token punctuation">]</span>: <span class="token number">192.168</span>.10.14 第三个节点
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> SSH Port of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span>: <span class="token number">22</span> 远程端口
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> SSH Private Key Path of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.14<span class="token punctuation">)</span> <span class="token punctuation">[</span>none<span class="token punctuation">]</span>: ~/.ssh/id_rsa 私钥路径
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> SSH User of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.14<span class="token punctuation">)</span> <span class="token punctuation">[</span>ubuntu<span class="token punctuation">]</span>: rancher 远程访问用户
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Is <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.14<span class="token punctuation">)</span> a Control Plane <span class="token function">host</span> <span class="token punctuation">(</span>y/n<span class="token punctuation">)</span>? <span class="token punctuation">[</span>y<span class="token punctuation">]</span>: n 不是控制节点
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Is <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.14<span class="token punctuation">)</span> a Worker <span class="token function">host</span> <span class="token punctuation">(</span>y/n<span class="token punctuation">)</span>? <span class="token punctuation">[</span>n<span class="token punctuation">]</span>: n 不是 worker 节点
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Is <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.14<span class="token punctuation">)</span> an etcd <span class="token function">host</span> <span class="token punctuation">(</span>y/n<span class="token punctuation">)</span>? <span class="token punctuation">[</span>n<span class="token punctuation">]</span>: y 是 etcd 节点
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Override Hostname of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.14<span class="token punctuation">)</span> <span class="token punctuation">[</span>none<span class="token punctuation">]</span>: 不覆盖现有主机名
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Internal IP of <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.14<span class="token punctuation">)</span> <span class="token punctuation">[</span>none<span class="token punctuation">]</span>: 主机局域网 IP 地址
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Docker socket path on <span class="token function">host</span> <span class="token punctuation">(</span><span class="token number">192.168</span>.10.14<span class="token punctuation">)</span> <span class="token punctuation">[</span>/var/run/docker.sock<span class="token punctuation">]</span>: 主机上 docker.sock 路径
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Network Plugin Type <span class="token punctuation">(</span>flannel, calico, weave, canal, aci<span class="token punctuation">)</span> <span class="token punctuation">[</span>canal<span class="token punctuation">]</span>: 使用的网络插件
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Authentication Strategy <span class="token punctuation">[</span>x509<span class="token punctuation">]</span>: 认证策略
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Authorization Mode <span class="token punctuation">(</span>rbac, none<span class="token punctuation">)</span> <span class="token punctuation">[</span>rbac<span class="token punctuation">]</span>: 认证模式
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Kubernetes Docker image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span>: 集群容器镜像
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Cluster domain <span class="token punctuation">[</span>cluster.local<span class="token punctuation">]</span>: 集群域名
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Service Cluster IP Range <span class="token punctuation">[</span><span class="token number">10.43</span>.0.0/16<span class="token punctuation">]</span>: 集群中 Servic IP 地址范围
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Enable PodSecurityPolicy <span class="token punctuation">[</span>n<span class="token punctuation">]</span>: 是否开启 Pod 安装策略
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Cluster Network CIDR <span class="token punctuation">[</span><span class="token number">10.42</span>.0.0/16<span class="token punctuation">]</span>: 集群 Pod 网络
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Cluster DNS Service IP <span class="token punctuation">[</span><span class="token number">10.43</span>.0.10<span class="token punctuation">]</span>: 集群 DNS Service IP 地址
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Add addon manifest URLs or YAML files <span class="token punctuation">[</span>no<span class="token punctuation">]</span>: 是否增加插件 manifest URL 或配置文件
</code></pre> 
<p>在部署过程中，需要注意 37 行版本的设置，这里设置为：<code>rancher/hyperkube:v1.21.9-rancher1</code></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@node1 rancher<span class="token punctuation">]</span><span class="token comment"># ls</span>
cluster.yml
</code></pre> 
<p>此外，在 cluster.yaml 文件中修改以下配置：</p> 
<pre><code class="prism language-shell">kube-controller:
image: <span class="token string">""</span>
extra_args:
<span class="token comment"># 如果后面需要部署 kubeflow 或 istio 则一定要配置以下参数</span>
cluster-signing-cert-file: <span class="token string">"/etc/kubernetes/ssl/kube-ca.pem"</span>
cluster-signing-key-file: <span class="token string">"/etc/kubernetes/ssl/kube-ca-key.pem"</span>
</code></pre> 
<h3><a id="_250"></a>八、集群部署</h3> 
<pre><code class="prism language-shell"><span class="token comment"># pwd</span>
/app/rancher
<span class="token comment"># rke up</span>
输出：
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> Running RKE version: v1.3.7
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> Initiating Kubernetes cluster
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> <span class="token punctuation">[</span>dialer<span class="token punctuation">]</span> Setup tunnel <span class="token keyword">for</span> <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> <span class="token punctuation">[</span>dialer<span class="token punctuation">]</span> Setup tunnel <span class="token keyword">for</span> <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> <span class="token punctuation">[</span>dialer<span class="token punctuation">]</span> Setup tunnel <span class="token keyword">for</span> <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>cluster-state-deployer<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>cluster-state-deployer<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>cluster-state-deployer<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> Generating CA kubernetes certificates
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> Generating Kubernetes API server aggregation layer requestheader client CA certificates
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> GenerateServingCertificate is disabled, checking <span class="token keyword">if</span> there are unused kubelet certificates
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> Generating Kubernetes API server certificates
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> Generating Service account token key
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> Generating Kube Controller certificates
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> Generating Kube Scheduler certificates
INFO<span class="token punctuation">[</span>0000<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> Generating Kube Proxy certificates
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> Generating Node certificate
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> Generating admin certificates and kubeconfig
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> Generating Kubernetes API server proxy client certificates
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> Generating kube-etcd-192-168-10-14 certificate and key
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> Successfully Deployed state <span class="token function">file</span> at <span class="token punctuation">[</span>./cluster.rkestate<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> Building Kubernetes cluster
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> <span class="token punctuation">[</span>dialer<span class="token punctuation">]</span> Setup tunnel <span class="token keyword">for</span> <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> <span class="token punctuation">[</span>dialer<span class="token punctuation">]</span> Setup tunnel <span class="token keyword">for</span> <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> <span class="token punctuation">[</span>dialer<span class="token punctuation">]</span> Setup tunnel <span class="token keyword">for</span> <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Deploying port listener containers
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-etcd-port-listener<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-etcd-port-listener<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0001<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-cp-port-listener<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-cp-port-listener<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-worker-port-listener<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-worker-port-listener<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Port listener containers deployed successfully
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Running control plane -<span class="token operator">&gt;</span> etcd port checks
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span> can connect to host<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span> on port<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">2379</span><span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-port-checker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-port-checker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-port-checker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Running control plane -<span class="token operator">&gt;</span> worker port checks
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span> can connect to host<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span> on port<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">10250</span><span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-port-checker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-port-checker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-port-checker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Running workers -<span class="token operator">&gt;</span> control plane port checks
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span> can connect to host<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span> on port<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">6443</span><span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-port-checker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-port-checker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-port-checker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Checking KubeAPI port Control Plane hosts
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Removing port listener containers
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-etcd-port-listener<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-etcd-port-listener<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-cp-port-listener<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-cp-port-listener<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-worker-port-listener<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-worker-port-listener<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Port listener containers removed successfully
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> Deploying kubernetes certificates to Cluster nodes
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0003<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0004<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0004<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0004<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0004<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0004<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0004<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>cert-deployer<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> <span class="token punctuation">[</span>reconcile<span class="token punctuation">]</span> Rebuilding and updating <span class="token builtin class-name">local</span> kube config
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> Successfully Deployed <span class="token builtin class-name">local</span> admin kubeconfig at <span class="token punctuation">[</span>./kube_config_cluster.yml<span class="token punctuation">]</span>
WARN<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> <span class="token punctuation">[</span>reconcile<span class="token punctuation">]</span> <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span> is a control plane <span class="token function">node</span> without reachable Kubernetes API endpoint <span class="token keyword">in</span> the cluster
WARN<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> <span class="token punctuation">[</span>reconcile<span class="token punctuation">]</span> no control plane <span class="token function">node</span> with reachable Kubernetes API endpoint <span class="token keyword">in</span> the cluster found
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> Successfully deployed kubernetes certificates to Cluster nodes
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> <span class="token punctuation">[</span>file-deploy<span class="token punctuation">]</span> Deploying <span class="token function">file</span> <span class="token punctuation">[</span>/etc/kubernetes/audit-policy.yaml<span class="token punctuation">]</span> to <span class="token function">node</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>file-deployer<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>file-deployer<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> Waiting <span class="token keyword">for</span> <span class="token punctuation">[</span>file-deployer<span class="token punctuation">]</span> container to <span class="token builtin class-name">exit</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> Waiting <span class="token keyword">for</span> <span class="token punctuation">[</span>file-deployer<span class="token punctuation">]</span> container to <span class="token builtin class-name">exit</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0009<span class="token punctuation">]</span> Container <span class="token punctuation">[</span>file-deployer<span class="token punctuation">]</span> is still running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>: stderr: <span class="token punctuation">[</span><span class="token punctuation">]</span>, stdout: <span class="token punctuation">[</span><span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0010<span class="token punctuation">]</span> Waiting <span class="token keyword">for</span> <span class="token punctuation">[</span>file-deployer<span class="token punctuation">]</span> container to <span class="token builtin class-name">exit</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0010<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>file-deployer<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0010<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/file-deployer<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0010<span class="token punctuation">]</span> <span class="token punctuation">[</span>/etc/kubernetes/audit-policy.yaml<span class="token punctuation">]</span> Successfully deployed audit policy <span class="token function">file</span> to Cluster control nodes
INFO<span class="token punctuation">[</span>0010<span class="token punctuation">]</span> <span class="token punctuation">[</span>reconcile<span class="token punctuation">]</span> Reconciling cluster state
INFO<span class="token punctuation">[</span>0010<span class="token punctuation">]</span> <span class="token punctuation">[</span>reconcile<span class="token punctuation">]</span> This is newly generated cluster
INFO<span class="token punctuation">[</span>0010<span class="token punctuation">]</span> Pre-pulling kubernetes images
INFO<span class="token punctuation">[</span>0010<span class="token punctuation">]</span> Pulling image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0010<span class="token punctuation">]</span> Pulling image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0010<span class="token punctuation">]</span> Pulling image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0087<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0090<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0092<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0092<span class="token punctuation">]</span> Kubernetes images pulled successfully
INFO<span class="token punctuation">[</span>0092<span class="token punctuation">]</span> <span class="token punctuation">[</span>etcd<span class="token punctuation">]</span> Building up etcd plane<span class="token punctuation">..</span>
INFO<span class="token punctuation">[</span>0092<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0092<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>etcd-fix-perm<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0092<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>etcd-fix-perm<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0092<span class="token punctuation">]</span> Waiting <span class="token keyword">for</span> <span class="token punctuation">[</span>etcd-fix-perm<span class="token punctuation">]</span> container to <span class="token builtin class-name">exit</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0092<span class="token punctuation">]</span> Waiting <span class="token keyword">for</span> <span class="token punctuation">[</span>etcd-fix-perm<span class="token punctuation">]</span> container to <span class="token builtin class-name">exit</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0092<span class="token punctuation">]</span> Container <span class="token punctuation">[</span>etcd-fix-perm<span class="token punctuation">]</span> is still running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>: stderr: <span class="token punctuation">[</span><span class="token punctuation">]</span>, stdout: <span class="token punctuation">[</span><span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0093<span class="token punctuation">]</span> Waiting <span class="token keyword">for</span> <span class="token punctuation">[</span>etcd-fix-perm<span class="token punctuation">]</span> container to <span class="token builtin class-name">exit</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0093<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>etcd-fix-perm<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0093<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/etcd-fix-perm<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0093<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/mirrored-coreos-etcd:v3.5.0<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0093<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>etcd<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0093<span class="token punctuation">]</span> <span class="token punctuation">[</span>etcd<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>etcd<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0093<span class="token punctuation">]</span> <span class="token punctuation">[</span>etcd<span class="token punctuation">]</span> Running rolling snapshot container <span class="token punctuation">[</span>etcd-snapshot-once<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0093<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0094<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>etcd-rolling-snapshots<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0094<span class="token punctuation">]</span> <span class="token punctuation">[</span>etcd<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>etcd-rolling-snapshots<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0099<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0099<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-bundle-cert<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0099<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-bundle-cert<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0099<span class="token punctuation">]</span> Waiting <span class="token keyword">for</span> <span class="token punctuation">[</span>rke-bundle-cert<span class="token punctuation">]</span> container to <span class="token builtin class-name">exit</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0099<span class="token punctuation">]</span> Container <span class="token punctuation">[</span>rke-bundle-cert<span class="token punctuation">]</span> is still running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>: stderr: <span class="token punctuation">[</span><span class="token punctuation">]</span>, stdout: <span class="token punctuation">[</span><span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0100<span class="token punctuation">]</span> Waiting <span class="token keyword">for</span> <span class="token punctuation">[</span>rke-bundle-cert<span class="token punctuation">]</span> container to <span class="token builtin class-name">exit</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0100<span class="token punctuation">]</span> <span class="token punctuation">[</span>certificates<span class="token punctuation">]</span> successfully saved certificate bundle <span class="token punctuation">[</span>/opt/rke/etcd-snapshots//pki.bundle.tar.gz<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0100<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-bundle-cert<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0100<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0100<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0100<span class="token punctuation">]</span> <span class="token punctuation">[</span>etcd<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0100<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0100<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-linker<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0100<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0101<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0101<span class="token punctuation">]</span> <span class="token punctuation">[</span>etcd<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0101<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0101<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-linker<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0101<span class="token punctuation">]</span> <span class="token punctuation">[</span>etcd<span class="token punctuation">]</span> Successfully started etcd plane<span class="token punctuation">..</span> Checking etcd cluster health
INFO<span class="token punctuation">[</span>0101<span class="token punctuation">]</span> <span class="token punctuation">[</span>etcd<span class="token punctuation">]</span> etcd <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span> reported <span class="token assign-left variable">healthy</span><span class="token operator">=</span>true
INFO<span class="token punctuation">[</span>0101<span class="token punctuation">]</span> <span class="token punctuation">[</span>controlplane<span class="token punctuation">]</span> Building up Controller Plane<span class="token punctuation">..</span>
INFO<span class="token punctuation">[</span>0101<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>service-sidekick<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0101<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0101<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0101<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>kube-apiserver<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0101<span class="token punctuation">]</span> <span class="token punctuation">[</span>controlplane<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>kube-apiserver<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0101<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> Start Healthcheck on <span class="token function">service</span> <span class="token punctuation">[</span>kube-apiserver<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0106<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> <span class="token function">service</span> <span class="token punctuation">[</span>kube-apiserver<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span> is healthy
INFO<span class="token punctuation">[</span>0106<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0107<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0107<span class="token punctuation">]</span> <span class="token punctuation">[</span>controlplane<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0107<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0107<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-linker<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0107<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0107<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>kube-controller-manager<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0107<span class="token punctuation">]</span> <span class="token punctuation">[</span>controlplane<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>kube-controller-manager<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0107<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> Start Healthcheck on <span class="token function">service</span> <span class="token punctuation">[</span>kube-controller-manager<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0112<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> <span class="token function">service</span> <span class="token punctuation">[</span>kube-controller-manager<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span> is healthy
INFO<span class="token punctuation">[</span>0112<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0113<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0113<span class="token punctuation">]</span> <span class="token punctuation">[</span>controlplane<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0113<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0113<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-linker<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0113<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0113<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>kube-scheduler<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0113<span class="token punctuation">]</span> <span class="token punctuation">[</span>controlplane<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>kube-scheduler<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0113<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> Start Healthcheck on <span class="token function">service</span> <span class="token punctuation">[</span>kube-scheduler<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0118<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> <span class="token function">service</span> <span class="token punctuation">[</span>kube-scheduler<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span> is healthy
INFO<span class="token punctuation">[</span>0118<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>controlplane<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-linker<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>controlplane<span class="token punctuation">]</span> Successfully started Controller Plane<span class="token punctuation">..</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>authz<span class="token punctuation">]</span> Creating rke-job-deployer ServiceAccount
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>authz<span class="token punctuation">]</span> rke-job-deployer ServiceAccount created successfully
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>authz<span class="token punctuation">]</span> Creating system:node ClusterRoleBinding
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>authz<span class="token punctuation">]</span> system:node ClusterRoleBinding created successfully
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>authz<span class="token punctuation">]</span> Creating kube-apiserver proxy ClusterRole and ClusterRoleBinding
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>authz<span class="token punctuation">]</span> kube-apiserver proxy ClusterRole and ClusterRoleBinding created successfully
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> Successfully Deployed state <span class="token function">file</span> at <span class="token punctuation">[</span>./cluster.rkestate<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>state<span class="token punctuation">]</span> Saving full cluster state to Kubernetes
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>state<span class="token punctuation">]</span> Successfully Saved full cluster state to Kubernetes ConfigMap: full-cluster-state
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Building up Worker Plane<span class="token punctuation">..</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>service-sidekick<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>sidekick<span class="token punctuation">]</span> Sidekick container already created on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>kubelet<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>kubelet<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> Start Healthcheck on <span class="token function">service</span> <span class="token punctuation">[</span>kubelet<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>nginx-proxy<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>nginx-proxy<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>nginx-proxy<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>nginx-proxy<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0119<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-linker<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>service-sidekick<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-linker<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> container <span class="token punctuation">[</span>service-sidekick<span class="token punctuation">]</span> is running on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>kubelet<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>kubelet<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> Start Healthcheck on <span class="token function">service</span> <span class="token punctuation">[</span>kubelet<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>kubelet<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>kubelet<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0120<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> Start Healthcheck on <span class="token function">service</span> <span class="token punctuation">[</span>kubelet<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0124<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> <span class="token function">service</span> <span class="token punctuation">[</span>kubelet<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span> is healthy
INFO<span class="token punctuation">[</span>0124<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0124<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-linker<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>kube-proxy<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>kube-proxy<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> Start Healthcheck on <span class="token function">service</span> <span class="token punctuation">[</span>kube-proxy<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> <span class="token function">service</span> <span class="token punctuation">[</span>kubelet<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span> is healthy
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> <span class="token function">service</span> <span class="token punctuation">[</span>kubelet<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span> is healthy
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0125<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0126<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-linker<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0126<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0126<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>kube-proxy<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0126<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0126<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0126<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>kube-proxy<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0126<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> Start Healthcheck on <span class="token function">service</span> <span class="token punctuation">[</span>kube-proxy<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0126<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-linker<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0126<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/hyperkube:v1.21.9-rancher1<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0126<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>kube-proxy<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0126<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>kube-proxy<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0126<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> Start Healthcheck on <span class="token function">service</span> <span class="token punctuation">[</span>kube-proxy<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0130<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> <span class="token function">service</span> <span class="token punctuation">[</span>kube-proxy<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span> is healthy
INFO<span class="token punctuation">[</span>0130<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0130<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0130<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0130<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0130<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-linker<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> <span class="token function">service</span> <span class="token punctuation">[</span>kube-proxy<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span> is healthy
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> <span class="token punctuation">[</span>healthcheck<span class="token punctuation">]</span> <span class="token function">service</span> <span class="token punctuation">[</span>kube-proxy<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span> is healthy
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-linker<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-linker<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-linker<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> <span class="token punctuation">[</span>worker<span class="token punctuation">]</span> Successfully started Worker Plane<span class="token punctuation">..</span>
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0131<span class="token punctuation">]</span> Image <span class="token punctuation">[</span>rancher/rke-tools:v0.1.78<span class="token punctuation">]</span> exists on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-cleaner<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-cleaner<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> Starting container <span class="token punctuation">[</span>rke-log-cleaner<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> <span class="token punctuation">[</span>cleanup<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-cleaner<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-cleaner<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> <span class="token punctuation">[</span>cleanup<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-cleaner<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-cleaner<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> <span class="token punctuation">[</span>cleanup<span class="token punctuation">]</span> Successfully started <span class="token punctuation">[</span>rke-log-cleaner<span class="token punctuation">]</span> container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> Removing container <span class="token punctuation">[</span>rke-log-cleaner<span class="token punctuation">]</span> on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>, try <span class="token comment">#1</span>
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-cleaner<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.14<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-cleaner<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.12<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> <span class="token punctuation">[</span>remove/rke-log-cleaner<span class="token punctuation">]</span> Successfully removed container on <span class="token function">host</span> <span class="token punctuation">[</span><span class="token number">192.168</span>.10.10<span class="token punctuation">]</span>
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> <span class="token punctuation">[</span>sync<span class="token punctuation">]</span> Syncing nodes Labels and Taints
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> <span class="token punctuation">[</span>sync<span class="token punctuation">]</span> Successfully synced nodes Labels and Taints
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> <span class="token punctuation">[</span>network<span class="token punctuation">]</span> Setting up network plugin: canal
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Saving ConfigMap <span class="token keyword">for</span> addon rke-network-plugin to Kubernetes
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Successfully saved ConfigMap <span class="token keyword">for</span> addon rke-network-plugin to Kubernetes
INFO<span class="token punctuation">[</span>0132<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Executing deploy job rke-network-plugin
INFO<span class="token punctuation">[</span>0137<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Setting up coredns
INFO<span class="token punctuation">[</span>0137<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Saving ConfigMap <span class="token keyword">for</span> addon rke-coredns-addon to Kubernetes
INFO<span class="token punctuation">[</span>0137<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Successfully saved ConfigMap <span class="token keyword">for</span> addon rke-coredns-addon to Kubernetes
INFO<span class="token punctuation">[</span>0137<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Executing deploy job rke-coredns-addon
INFO<span class="token punctuation">[</span>0142<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> CoreDNS deployed successfully
INFO<span class="token punctuation">[</span>0142<span class="token punctuation">]</span> <span class="token punctuation">[</span>dns<span class="token punctuation">]</span> DNS provider coredns deployed successfully
INFO<span class="token punctuation">[</span>0142<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Setting up Metrics Server
INFO<span class="token punctuation">[</span>0142<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Saving ConfigMap <span class="token keyword">for</span> addon rke-metrics-addon to Kubernetes
INFO<span class="token punctuation">[</span>0142<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Successfully saved ConfigMap <span class="token keyword">for</span> addon rke-metrics-addon to Kubernetes
INFO<span class="token punctuation">[</span>0142<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Executing deploy job rke-metrics-addon
INFO<span class="token punctuation">[</span>0147<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Metrics Server deployed successfully
INFO<span class="token punctuation">[</span>0147<span class="token punctuation">]</span> <span class="token punctuation">[</span>ingress<span class="token punctuation">]</span> Setting up nginx ingress controller
INFO<span class="token punctuation">[</span>0147<span class="token punctuation">]</span> <span class="token punctuation">[</span>ingress<span class="token punctuation">]</span> removing admission batch <span class="token function">jobs</span> <span class="token keyword">if</span> they exist
INFO<span class="token punctuation">[</span>0147<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Saving ConfigMap <span class="token keyword">for</span> addon rke-ingress-controller to Kubernetes
INFO<span class="token punctuation">[</span>0147<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Successfully saved ConfigMap <span class="token keyword">for</span> addon rke-ingress-controller to Kubernetes
INFO<span class="token punctuation">[</span>0147<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Executing deploy job rke-ingress-controller
INFO<span class="token punctuation">[</span>0152<span class="token punctuation">]</span> <span class="token punctuation">[</span>ingress<span class="token punctuation">]</span> removing default backend <span class="token function">service</span> and deployment <span class="token keyword">if</span> they exist
INFO<span class="token punctuation">[</span>0152<span class="token punctuation">]</span> <span class="token punctuation">[</span>ingress<span class="token punctuation">]</span> ingress controller nginx deployed successfully
INFO<span class="token punctuation">[</span>0152<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> Setting up user addons
INFO<span class="token punctuation">[</span>0152<span class="token punctuation">]</span> <span class="token punctuation">[</span>addons<span class="token punctuation">]</span> no user addons defined
INFO<span class="token punctuation">[</span>0152<span class="token punctuation">]</span> Finished building Kubernetes cluster successfully
</code></pre> 
<p>假如你遇到部署失败，报错：</p> 
<pre><code class="prism language-shell">WARN<span class="token punctuation">[</span>0114<span class="token punctuation">]</span> <span class="token punctuation">[</span>etcd<span class="token punctuation">]</span> <span class="token function">host</span> <span class="token punctuation">[</span>xxxxxxx<span class="token punctuation">]</span> failed to check etcd health: failed to get /health <span class="token keyword">for</span> <span class="token function">host</span> <span class="token punctuation">[</span>xxxxxxx<span class="token punctuation">]</span>: Get <span class="token string">"https://xxxxxxxx:2379/health"</span><span class="token builtin class-name">:</span> remote error: tls: bad certificate
FATA<span class="token punctuation">[</span>0114<span class="token punctuation">]</span> <span class="token punctuation">[</span>etcd<span class="token punctuation">]</span> Failed to bring up Etcd Plane: etcd cluster is unhealthy: hosts <span class="token punctuation">[</span>xxxxxxxx<span class="token punctuation">]</span> failed to report healthy. Check etcd container logs on each <span class="token function">host</span> <span class="token keyword">for</span> <span class="token function">more</span> information
</code></pre> 
<p>可以对所有节点执行（无法删除就重启机器）：<code>rm -rf /etc/kubernetes/ /var/lib/kubelet/ /var/lib/etcd/</code>。</p> 
<h3><a id="_kubectl__582"></a>九、安装 kubectl 客户端</h3> 
<p>还是在 node1（控制节点）主机上操作。</p> 
<h4><a id="kubectl__586"></a>kubectl 客户端安装</h4> 
<pre><code class="prism language-shell"><span class="token comment"># wget https://storage.googleapis.com/kubernetes-release/release/v1.21.9/bin/linux/amd64/kubectl</span>
<span class="token comment"># chmod +x kubectl </span>
<span class="token comment"># mv kubectl /usr/local/bin/kubectl</span>
<span class="token comment"># kubectl version --client</span>
Client Version: version.Info<span class="token punctuation">{<!-- --></span>Major:<span class="token string">"1"</span>, Minor:<span class="token string">"21"</span>, GitVersion:<span class="token string">"v1.21.9"</span>, GitCommit:<span class="token string">"f59f5c2fda36e4036b49ec027e556a15456108f0"</span>, GitTreeState:<span class="token string">"clean"</span>, BuildDate:<span class="token string">"2022-01-19T17:33:06Z"</span>, GoVersion:<span class="token string">"go1.16.12"</span>, Compiler:<span class="token string">"gc"</span>, Platform:<span class="token string">"linux/amd64"</span><span class="token punctuation">}</span>
</code></pre> 
<h4><a id="kubectl__596"></a>kubectl 客户端配置集群管理文件及应用验证</h4> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># ls /app/rancher/</span>
cluster.rkestate  cluster.yml  kube_config_cluster.yml
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># mkdir ./.kube</span>
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># cp /app/rancher/kube_config_cluster.yml /root/.kube/config</span>
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get nodes</span>
NAME            STATUS   ROLES          AGE     VERSION
<span class="token number">192.168</span>.10.10   Ready    controlplane   9m13s   v1.21.9
<span class="token number">192.168</span>.10.12   Ready    worker         9m12s   v1.21.9
<span class="token number">192.168</span>.10.14   Ready    etcd           9m12s   v1.21.9
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -n kube-system</span>
NAME                                         READY   STATUS      RESTARTS   AGE
calico-kube-controllers-5685fbd9f7-gcwj7     <span class="token number">1</span>/1     Running     <span class="token number">0</span>          9m36s
canal-fz2bg                                  <span class="token number">2</span>/2     Running     <span class="token number">0</span>          9m36s
canal-qzw4n                                  <span class="token number">2</span>/2     Running     <span class="token number">0</span>          9m36s
canal-sstjn                                  <span class="token number">2</span>/2     Running     <span class="token number">0</span>          9m36s
coredns-8578b6dbdd-ftnf6                     <span class="token number">1</span>/1     Running     <span class="token number">0</span>          9m30s
coredns-autoscaler-f7b68ccb7-fzdgc           <span class="token number">1</span>/1     Running     <span class="token number">0</span>          9m30s
metrics-server-6bc7854fb5-kwppz              <span class="token number">1</span>/1     Running     <span class="token number">0</span>          9m25s
rke-coredns-addon-deploy-job--1-x56w2        <span class="token number">0</span>/1     Completed   <span class="token number">0</span>          9m31s
rke-ingress-controller-deploy-job--1-wzp2b   <span class="token number">0</span>/1     Completed   <span class="token number">0</span>          9m21s
rke-metrics-addon-deploy-job--1-ltlgn        <span class="token number">0</span>/1     Completed   <span class="token number">0</span>          9m26s
rke-network-plugin-deploy-job--1-nsbfn       <span class="token number">0</span>/1     Completed   <span class="token number">0</span>          9m41s
</code></pre> 
<h3><a id="_Web__Rancher_623"></a>十、集群 Web 管理 Rancher</h3> 
<p>Rancher 控制面板主要方便用于控制 K8s 集群，查看集群状态，编辑集群等操作。</p> 
<p>依旧在（控制节点）node1 运行以下命令：</p> 
<h4><a id="_docker_run__rancher_629"></a>使用 docker run 启动一个 rancher</h4> 
<pre><code class="prism language-shell"><span class="token comment"># 注意映射端口改了</span>
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># docker run -d --restart=unless-stopped --privileged --name rancher -p 1080:80 -p 1443:443 rancher/rancher:v2.5.9</span>
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>
CONTAINER ID   IMAGE                                COMMAND                  CREATED          STATUS          PORTS                                                                      NAMES
0fd46ee77655   rancher/rancher:v2.5.9               <span class="token string">"entrypoint.sh"</span>          <span class="token number">5</span> seconds ago    Up <span class="token number">3</span> seconds    <span class="token number">0.0</span>.0.0:80-<span class="token operator">&gt;</span><span class="token number">80</span>/tcp, :::80-<span class="token operator">&gt;</span><span class="token number">80</span>/tcp, <span class="token number">0.0</span>.0.0:443-<span class="token operator">&gt;</span><span class="token number">443</span>/tcp, :::443-<span class="token operator">&gt;</span><span class="token number">443</span>/tcp   rancher
</code></pre> 
<h4><a id="_Rancher_10801443_639"></a>访问 Rancher【这里映射端口 1080，1443】</h4> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># ss -anput | grep ":1080"</span>
tcp    LISTEN     <span class="token number">0</span>      <span class="token number">128</span>       *:1080                    *:*                   users:<span class="token variable"><span class="token punctuation">((</span>"docker<span class="token operator">-</span>proxy"<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">29564</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">))</span></span>
tcp    LISTEN     <span class="token number">0</span>      <span class="token number">128</span>    <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:1080                 <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:*                   users:<span class="token variable"><span class="token punctuation">((</span>"docker<span class="token operator">-</span>proxy"<span class="token punctuation">,</span>pid<span class="token operator">=</span><span class="token number">29570</span><span class="token punctuation">,</span>fd<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">))</span></span>
</code></pre> 
<p>以上便是 RKE 方式搭建 K8s 集群。</p> 
<hr> 
<p>下面来讲讲，如何搞定 NebulaGraph 部署。</p> 
<h3><a id="_NFS__652"></a>十一、搭建 NFS 服务器</h3> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@nfsserver ~<span class="token punctuation">]</span><span class="token comment"># mkdir -p /data/nfs</span>
<span class="token punctuation">[</span>root@nfsserver ~<span class="token punctuation">]</span><span class="token comment"># vim /etc/exports</span>
/data/nfs       *<span class="token punctuation">(</span>rw,no_root_squash,sync<span class="token punctuation">)</span>
</code></pre> 
<p>在所有节点中安装 NFS 客户端：</p> 
<pre><code class="prism language-shell">yum <span class="token function">install</span> nfs-utils <span class="token parameter variable">-y</span>
</code></pre> 
<p>下面在工作节点中验证是否服务可用：</p> 
<pre><code class="prism language-shell">showmount <span class="token parameter variable">-e</span> <span class="token number">192.168</span>.222.143 <span class="token comment">#NFS 服务器的地址</span>
</code></pre> 
<h3><a id="_NFS_Storage_Class__672"></a>十二、使用 NFS 文件系统创建存储动态供给（Storage Class 安装）</h3> 
<p>PV 对存储系统的支持可通过其插件来实现，目前，Kubernetes 支持如下类型的插件。</p> 
<p>官方地址：<a href="https://kubernetes.io/docs/concepts/storage/storage-classes/" rel="nofollow">https://kubernetes.io/docs/concepts/storage/storage-classes/</a>；</p> 
<p>但是，官方插件是不支持 NFS 动态供给的，我们可以用第三方的插件来实现，第三方插件地址：<a href="https://github.com/kubernetes-retired/external-storage">https://github.com/kubernetes-retired/external-storage</a>。</p> 
<h4><a id="_Storage_Class_680"></a>下载并创建 Storage Class</h4> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@k8s-master1 ~<span class="token punctuation">]</span><span class="token comment"># wget https://raw.githubusercontent.com/kubernetes-sigs/nfs-subdir-external-provisioner/master/deploy/class.yaml</span>

<span class="token punctuation">[</span>root@k8s-master1 ~<span class="token punctuation">]</span><span class="token comment"># mv class.yaml storageclass-nfs.yml</span>
<span class="token punctuation">[</span>root@k8s-master1 ~<span class="token punctuation">]</span><span class="token comment"># cat storageclass-nfs.yml</span>
apiVersion: storage.k8s.io/v1
kind: StorageClass                                <span class="token comment"># 类型</span>
metadata:
  name: nfs-client                <span class="token comment"># 名称，要使用就需要调用此名称</span>
provisioner: k8s-sigs.io/nfs-subdir-external-provisioner         <span class="token comment"># 动态供给插件</span>
parameters:
  archiveOnDelete: <span class="token string">"false"</span>                <span class="token comment"># 删除数据时是否存档，false 表示不存档，true 表示存档</span>
<span class="token punctuation">[</span>root@k8s-master1 ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f storageclass-nfs.yml</span>
storageclass.storage.k8s.io/managed-nfs-storage created
<span class="token punctuation">[</span>root@k8s-master1 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get storageclass</span>
NAME         PROVISIONER                                   RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE
nfs-client   k8s-sigs.io/nfs-subdir-external-provisioner   Delete          Immediate           <span class="token boolean">false</span>                  10s

<span class="token comment"># RECLAIMPOLICY PV 回收策略，Pod 或 PVC 被删除后，PV 是否删除还是保留。</span>
<span class="token comment"># VOLUMEBINDINGMODE Immediate 模式下 PVC 与 PV 立即绑定，主要是不等待相关 Pod 调度完成，不关心其运行节点，直接完成绑定。相反的 WaitForFirstConsumer 模式下需要等待 Pod 调度完成后进行 PV 绑定。</span>
<span class="token comment"># ALLOWVOLUMEEXPANSION PVC 扩容</span>
</code></pre> 
<h4><a id="_RBAC_705"></a>下载并创建 RBAC</h4> 
<p>因为 Storage 自动创建 PV 需要经过 kube-apiserver，所以需要授权。</p> 
<pre><code class="prism language-yaml"><span class="token punctuation">[</span>root@k8s<span class="token punctuation">-</span>master1 ~<span class="token punctuation">]</span><span class="token comment"># wget https://raw.githubusercontent.com/kubernetes-sigs/nfs-subdir-external-provisioner/master/deploy/rbac.yaml</span>

<span class="token punctuation">[</span>root@k8s<span class="token punctuation">-</span>master1 ~<span class="token punctuation">]</span><span class="token comment"># mv rbac.yaml storageclass-nfs-rbac.yaml</span>
<span class="token punctuation">[</span>root@k8s<span class="token punctuation">-</span>master1 ~<span class="token punctuation">]</span><span class="token comment"># cat storageclass-nfs-rbac.yaml</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ServiceAccount
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner
  <span class="token comment"># replace with namespace where provisioner is deployed</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token punctuation">---</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterRole
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner<span class="token punctuation">-</span>runner
<span class="token key atrule">rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">apiGroups</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span>
    <span class="token key atrule">resources</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"persistentvolumes"</span><span class="token punctuation">]</span>
    <span class="token key atrule">verbs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"get"</span><span class="token punctuation">,</span> <span class="token string">"list"</span><span class="token punctuation">,</span> <span class="token string">"watch"</span><span class="token punctuation">,</span> <span class="token string">"create"</span><span class="token punctuation">,</span> <span class="token string">"delete"</span><span class="token punctuation">]</span>
  <span class="token punctuation">-</span> <span class="token key atrule">apiGroups</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span>
    <span class="token key atrule">resources</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"persistentvolumeclaims"</span><span class="token punctuation">]</span>
    <span class="token key atrule">verbs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"get"</span><span class="token punctuation">,</span> <span class="token string">"list"</span><span class="token punctuation">,</span> <span class="token string">"watch"</span><span class="token punctuation">,</span> <span class="token string">"update"</span><span class="token punctuation">]</span>
  <span class="token punctuation">-</span> <span class="token key atrule">apiGroups</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"storage.k8s.io"</span><span class="token punctuation">]</span>
    <span class="token key atrule">resources</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"storageclasses"</span><span class="token punctuation">]</span>
    <span class="token key atrule">verbs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"get"</span><span class="token punctuation">,</span> <span class="token string">"list"</span><span class="token punctuation">,</span> <span class="token string">"watch"</span><span class="token punctuation">]</span>
  <span class="token punctuation">-</span> <span class="token key atrule">apiGroups</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span>
    <span class="token key atrule">resources</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"events"</span><span class="token punctuation">]</span>
    <span class="token key atrule">verbs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"create"</span><span class="token punctuation">,</span> <span class="token string">"update"</span><span class="token punctuation">,</span> <span class="token string">"patch"</span><span class="token punctuation">]</span>
<span class="token punctuation">---</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterRoleBinding
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> run<span class="token punctuation">-</span>nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner
<span class="token key atrule">subjects</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">kind</span><span class="token punctuation">:</span> ServiceAccount
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner
    <span class="token comment"># replace with namespace where provisioner is deployed</span>
    <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">roleRef</span><span class="token punctuation">:</span>
  <span class="token key atrule">kind</span><span class="token punctuation">:</span> ClusterRole
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner<span class="token punctuation">-</span>runner
  <span class="token key atrule">apiGroup</span><span class="token punctuation">:</span> rbac.authorization.k8s.io
<span class="token punctuation">---</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Role
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> leader<span class="token punctuation">-</span>locking<span class="token punctuation">-</span>nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner
  <span class="token comment"># replace with namespace where provisioner is deployed</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">apiGroups</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span>
    <span class="token key atrule">resources</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"endpoints"</span><span class="token punctuation">]</span>
    <span class="token key atrule">verbs</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"get"</span><span class="token punctuation">,</span> <span class="token string">"list"</span><span class="token punctuation">,</span> <span class="token string">"watch"</span><span class="token punctuation">,</span> <span class="token string">"create"</span><span class="token punctuation">,</span> <span class="token string">"update"</span><span class="token punctuation">,</span> <span class="token string">"patch"</span><span class="token punctuation">]</span>
<span class="token punctuation">---</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> RoleBinding
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> rbac.authorization.k8s.io/v1
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> leader<span class="token punctuation">-</span>locking<span class="token punctuation">-</span>nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner
  <span class="token comment"># replace with namespace where provisioner is deployed</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">subjects</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">kind</span><span class="token punctuation">:</span> ServiceAccount
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner
    <span class="token comment"># replace with namespace where provisioner is deployed</span>
    <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">roleRef</span><span class="token punctuation">:</span>
  <span class="token key atrule">kind</span><span class="token punctuation">:</span> Role
  <span class="token key atrule">name</span><span class="token punctuation">:</span> leader<span class="token punctuation">-</span>locking<span class="token punctuation">-</span>nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner
  <span class="token key atrule">apiGroup</span><span class="token punctuation">:</span> rbac.authorization.k8s.io
<span class="token punctuation">[</span>root@k8s<span class="token punctuation">-</span>master1 ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f rbac.yaml</span>
serviceaccount/nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner created
clusterrole.rbac.authorization.k8s.io/nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner<span class="token punctuation">-</span>runner created
clusterrolebinding.rbac.authorization.k8s.io/run<span class="token punctuation">-</span>nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner created
role.rbac.authorization.k8s.io/leader<span class="token punctuation">-</span>locking<span class="token punctuation">-</span>nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner created
rolebinding.rbac.authorization.k8s.io/leader<span class="token punctuation">-</span>locking<span class="token punctuation">-</span>nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner created
</code></pre> 
<h4><a id="_deployment_787"></a>创建动态供给的 deployment</h4> 
<p>这里需要一个 deployment 来专门实现 PV 与 PVC 的自动创建：</p> 
<pre><code class="prism language-yaml"><span class="token punctuation">[</span>root@k8s<span class="token punctuation">-</span>master1 ~<span class="token punctuation">]</span><span class="token comment"># vim deploy-nfs-client-provisioner.yml</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token key atrule">strategy</span><span class="token punctuation">:</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> Recreate
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">serviceAccount</span><span class="token punctuation">:</span> nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner
          <span class="token key atrule">image</span><span class="token punctuation">:</span> registry.cn<span class="token punctuation">-</span>beijing.aliyuncs.com/pylixm/nfs<span class="token punctuation">-</span>subdir<span class="token punctuation">-</span>external<span class="token punctuation">-</span>provisioner<span class="token punctuation">:</span>v4.0.0
          <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>root
              <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /persistentvolumes
          <span class="token key atrule">env</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> PROVISIONER_NAME
              <span class="token key atrule">value</span><span class="token punctuation">:</span> k8s<span class="token punctuation">-</span>sigs.io/nfs<span class="token punctuation">-</span>subdir<span class="token punctuation">-</span>external<span class="token punctuation">-</span>provisioner
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> NFS_SERVER
              <span class="token key atrule">value</span><span class="token punctuation">:</span> 192.168.10.129
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> NFS_PATH
              <span class="token key atrule">value</span><span class="token punctuation">:</span> /data/nfs
      <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>root
          <span class="token key atrule">nfs</span><span class="token punctuation">:</span>
            <span class="token key atrule">server</span><span class="token punctuation">:</span> 192.168.10.129
            <span class="token key atrule">path</span><span class="token punctuation">:</span> /data/nfs
<span class="token punctuation">[</span>root@k8s<span class="token punctuation">-</span>master1 ~<span class="token punctuation">]</span><span class="token comment"># kubectl apply -f deploy-nfs-client-provisioner.yml</span>
deployment.apps/nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner created
<span class="token punctuation">[</span>root@k8s<span class="token punctuation">-</span>master1 ~<span class="token punctuation">]</span><span class="token comment"># kubectl get pods |grep nfs-client-provisioner</span>
nfs<span class="token punctuation">-</span>client<span class="token punctuation">-</span>provisioner<span class="token punctuation">-</span>5b5ddcd6c8<span class="token punctuation">-</span>b6zbq   1/1     Running   0          34s
</code></pre> 
<h3><a id="NebulaGraph_Operator__834"></a>十三、NebulaGraph Operator 安装部署</h3> 
<p>这里参考官方文档来安装 NebulaGraph Operator 前，用户需要安装以下软件并确保安装版本的正确性（NebulaGraph Operator 不负责处理安装这些软件过程中出现的问题）。</p> 
<table><thead><tr><th align="left">软件</th><th align="left">版本要求</th></tr></thead><tbody><tr><td align="left"><a href="https://kubernetes.io/" rel="nofollow">Kubernetes</a></td><td align="left">&gt;= 1.16</td></tr><tr><td align="left"><a href="https://helm.sh/" rel="nofollow">Helm</a></td><td align="left">&gt;= 3.2.0</td></tr><tr><td align="left"><a href="https://github.com/coredns/coredns">CoreDNS</a></td><td align="left">&gt;= 1.6.0</td></tr></tbody></table> 
<p>这里需要安装下 Helm：</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@a ~<span class="token punctuation">]</span><span class="token comment"># curl https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 | bash</span>
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                Dload  Upload   Total   Spent    Left  Speed
<span class="token number">100</span> <span class="token number">11345</span>  <span class="token number">100</span> <span class="token number">11345</span>    <span class="token number">0</span>     <span class="token number">0</span>  <span class="token number">18830</span>      <span class="token number">0</span> --:--:-- --:--:-- --:--:-- <span class="token number">18845</span>
<span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> Could not <span class="token function">find</span> git. It is required <span class="token keyword">for</span> plugin installation.
Downloading https://get.helm.sh/helm-v3.12.1-linux-amd64.tar.gz
Verifying checksum<span class="token punctuation">..</span>. Done.
Preparing to <span class="token function">install</span> helm into /usr/local/bin
helm installed into /usr/local/bin/helm
</code></pre> 
<p>而 CoreDNS 的安装，可以网上查阅资料，其实上面 RKE 安装过程中已经安装了 CoreDNS。<br> 再来一遍安装 NebulaGraph Operator 的具体流程：</p> 
<p>第一步，添加 NebulaGraph Operator Helm 仓库。</p> 
<pre><code class="prism language-shell">helm repo <span class="token function">add</span> nebula-operator https://vesoft-inc.github.io/nebula-operator/charts
</code></pre> 
<p>第二步，拉取最新的 Operator Helm 仓库。</p> 
<pre><code class="prism language-shell">helm repo update
</code></pre> 
<p>参考 <a href="https://helm.sh/docs/helm/helm_repo/" rel="nofollow">Helm 仓库</a> 以获取更多 <code>helm repo</code> 相关信息。</p> 
<p>第三步，创建命名空间用于安装 NebulaGraph Operator。</p> 
<pre><code class="prism language-shell">kubectl create namespace <span class="token operator">&lt;</span>namespace_name<span class="token operator">&gt;</span>
</code></pre> 
<p>例如，创建 operator 命名空间。</p> 
<pre><code class="prism language-shell">kubectl create namespace operator
</code></pre> 
<ul><li>nebula-operator Chart 中的所有资源都会安装在该命名空间下。</li><li>用户也可自行创建其他命名空间。</li></ul> 
<p>第四步，安装 NebulaGraph Operator。</p> 
<pre><code class="prism language-shell">helm <span class="token function">install</span> nebula-operator nebula-operator/nebula-operator <span class="token parameter variable">--namespace</span><span class="token operator">=</span><span class="token operator">&lt;</span>namespace_name<span class="token operator">&gt;</span> <span class="token parameter variable">--version</span><span class="token operator">=</span><span class="token variable">${chart_version}</span>
</code></pre> 
<p>目前 1.5.0 无法安装，可以不指定版本，默认安装最新版本。由于 gcr.io 无法下载镜像使用 <code>kubesphere/kube-rbac-proxy:v0.8.0</code> 代替。</p> 
<pre><code class="prism language-shell">helm <span class="token function">install</span> nebula-operator nebula-operator/nebula-operator <span class="token parameter variable">--namespace</span><span class="token operator">=</span>nebula-operator-system <span class="token parameter variable">--set</span> <span class="token assign-left variable">image.kubeRBACProxy.image</span><span class="token operator">=</span>kubesphere/kube-rbac-proxy:v0.8.0
</code></pre> 
<h4><a id="_NebulaGraph_Operator_902"></a>卸载 NebulaGraph Operator（如果需要卸载重新安装）</h4> 
<ol><li>卸载 NebulaGraph Operator chart</li></ol> 
<pre><code class="prism language-shell">helm uninstall nebula-operator <span class="token parameter variable">--namespace</span><span class="token operator">=</span>operator
</code></pre> 
<ol><li>删除 CRD</li></ol> 
<pre><code class="prism language-shell">kubectl delete crd nebulaclusters.apps.nebula-graph.io
</code></pre> 
<h3><a id="_NebulaGraphkubectl_916"></a>十四、部署 NebulaGraph（kubectl）</h3> 
<p>创建集群配置文件：创建名为 <code>apps_v1alpha1_nebulacluster.yaml</code> 的文件。官网提供了模板可以直接下载：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps.nebula<span class="token punctuation">-</span>graph.io/v1alpha1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> NebulaCluster
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nebula
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">graphd</span><span class="token punctuation">:</span>
    <span class="token key atrule">resources</span><span class="token punctuation">:</span>
      <span class="token key atrule">requests</span><span class="token punctuation">:</span>
        <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">"500m"</span>
        <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">"500Mi"</span>
      <span class="token key atrule">limits</span><span class="token punctuation">:</span>
        <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">"1"</span>
        <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">"1Gi"</span>
    <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> vesoft/nebula<span class="token punctuation">-</span>graphd
    <span class="token key atrule">version</span><span class="token punctuation">:</span> v3.5.0
    <span class="token key atrule">service</span><span class="token punctuation">:</span>
      <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort
      <span class="token key atrule">externalTrafficPolicy</span><span class="token punctuation">:</span> Local
    <span class="token key atrule">logVolumeClaim</span><span class="token punctuation">:</span>
      <span class="token key atrule">resources</span><span class="token punctuation">:</span>
        <span class="token key atrule">requests</span><span class="token punctuation">:</span>
          <span class="token key atrule">storage</span><span class="token punctuation">:</span> 1Gi
      <span class="token key atrule">storageClassName</span><span class="token punctuation">:</span> managed<span class="token punctuation">-</span>nfs<span class="token punctuation">-</span>storage
 <span class="token key atrule">metad</span><span class="token punctuation">:</span>
  <span class="token comment">#    license:</span>
   <span class="token comment">#      secretName: "nebula-license"</span>
<span class="token comment">#      licenseKey: "nebula.license"</span>
    <span class="token key atrule">resources</span><span class="token punctuation">:</span>
      <span class="token key atrule">requests</span><span class="token punctuation">:</span>
        <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">"500m"</span>
        <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">"500Mi"</span>
      <span class="token key atrule">limits</span><span class="token punctuation">:</span>
        <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">"1"</span>
        <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">"1Gi"</span>
    <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> vesoft/nebula<span class="token punctuation">-</span>metad
    <span class="token key atrule">version</span><span class="token punctuation">:</span> v3.5.0
    <span class="token key atrule">dataVolumeClaim</span><span class="token punctuation">:</span>
      <span class="token key atrule">resources</span><span class="token punctuation">:</span>
        <span class="token key atrule">requests</span><span class="token punctuation">:</span>
          <span class="token key atrule">storage</span><span class="token punctuation">:</span> 5Gi
      <span class="token key atrule">storageClassName</span><span class="token punctuation">:</span>  managed<span class="token punctuation">-</span>nfs<span class="token punctuation">-</span>storage
    <span class="token key atrule">logVolumeClaim</span><span class="token punctuation">:</span>
      <span class="token key atrule">resources</span><span class="token punctuation">:</span>
        <span class="token key atrule">requests</span><span class="token punctuation">:</span>
          <span class="token key atrule">storage</span><span class="token punctuation">:</span> 1Gi
      <span class="token key atrule">storageClassName</span><span class="token punctuation">:</span>  managed<span class="token punctuation">-</span>nfs<span class="token punctuation">-</span>storage
  <span class="token key atrule">storaged</span><span class="token punctuation">:</span>
    <span class="token key atrule">resources</span><span class="token punctuation">:</span>
      <span class="token key atrule">requests</span><span class="token punctuation">:</span>
        <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">"500m"</span>
        <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">"500Mi"</span>
      <span class="token key atrule">limits</span><span class="token punctuation">:</span>
        <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">"1"</span>
</code></pre> 
<p>注意：所有的 storageClassName 需要和上面安装 storageclass 时名称相同。即，<code>storageclass-nfs.yml</code> 中的 metadata.name: nfs-client。</p> 
<p>来查看下服务状态：</p> 
<pre><code class="prism language-shell">nebula-exporter-66457984-w6zpn            <span class="token number">1</span>/1     Running   <span class="token number">0</span>          31m
nebula-graphd-0                           <span class="token number">2</span>/2     Running   <span class="token number">0</span>          31m
nebula-metad-0                            <span class="token number">2</span>/2     Running   <span class="token number">0</span>          35m
nebula-storaged-0                         <span class="token number">2</span>/2     Running   <span class="token number">0</span>          35m
nebula-storaged-1                         <span class="token number">0</span>/2     Pending   <span class="token number">0</span>          35m
nebula-storaged-2                         <span class="token number">0</span>/2     Pending   <span class="token number">0</span>          35m
nfs-client-provisioner-6bd7f48698-m4v94   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          57m
</code></pre> 
<h3><a id="_NebulaGraph_992"></a>十五、连接 NebulaGraph</h3> 
<p>按照官网提供的模板修改：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token comment"># modify the cluster name</span>
    <span class="token key atrule">app.kubernetes.io/cluster</span><span class="token punctuation">:</span> <span class="token string">"nebula"</span>
    <span class="token key atrule">app.kubernetes.io/component</span><span class="token punctuation">:</span> graphd
    <span class="token key atrule">app.kubernetes.io/managed-by</span><span class="token punctuation">:</span> nebula<span class="token punctuation">-</span>operator
    <span class="token key atrule">app.kubernetes.io/name</span><span class="token punctuation">:</span> nebula<span class="token punctuation">-</span>graph
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nebula<span class="token punctuation">-</span>graphd<span class="token punctuation">-</span>nodeport<span class="token punctuation">-</span>svc
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">externalTrafficPolicy</span><span class="token punctuation">:</span> Cluster <span class="token comment">#改为local，无法连接到数据库，这里改为Cluster</span>
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> thrift
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9669</span>
    <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">9669</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> http
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">19669</span>
    <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">19669</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token comment"># modify the cluster name</span>
    <span class="token key atrule">app.kubernetes.io/cluster</span><span class="token punctuation">:</span> <span class="token string">"nebula"</span>
    <span class="token key atrule">app.kubernetes.io/component</span><span class="token punctuation">:</span> graphd
    <span class="token key atrule">app.kubernetes.io/managed-by</span><span class="token punctuation">:</span> nebula<span class="token punctuation">-</span>operator
    <span class="token key atrule">app.kubernetes.io/name</span><span class="token punctuation">:</span> nebula<span class="token punctuation">-</span>graph
  <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort
</code></pre> 
<p>执行以下命令使 Service 服务在集群中生效。</p> 
<pre><code class="prism language-shell">kubectl create <span class="token parameter variable">-f</span> graphd-nodeport-service.yaml
</code></pre> 
<p>查看 Service 中 NebulaGraph 映射至集群节点的端口。</p> 
<pre><code class="prism language-shell">kubectl get services <span class="token parameter variable">-l</span> app.kubernetes.io/cluster<span class="token operator">=</span><span class="token operator">&lt;</span>nebula<span class="token operator">&gt;</span>  <span class="token comment">#&lt;nebula&gt;为变量值，请用实际集群名称替换。</span>
</code></pre> 
<p>返回：</p> 
<pre><code class="prism language-shell">NAME                           TYPE        CLUSTER-IP     EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>                                          AGE
nebula-graphd-svc-nodeport     NodePort    <span class="token number">10.107</span>.153.129 <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">9669</span>:32236/TCP,19669:31674/TCP,19670:31057/TCP   24h
<span class="token punctuation">..</span>.
</code></pre> 
<p><code>NodePort</code> 类型的 Service 中，映射至集群节点的端口为 <code>32236</code>。</p> 
<p>使用节点 IP 和上述映射的节点端口连接 NebulaGraph。</p> 
<pre><code class="prism language-shell">kubectl run <span class="token parameter variable">-ti</span> <span class="token parameter variable">--image</span> vesoft/nebula-console:v3.5.0 <span class="token parameter variable">--restart</span><span class="token operator">=</span>Never -- <span class="token operator">&lt;</span>nebula_console_name<span class="token operator">&gt;</span> <span class="token parameter variable">-addr</span> <span class="token operator">&lt;</span>node_ip<span class="token operator">&gt;</span> <span class="token parameter variable">-port</span> <span class="token operator">&lt;</span>node_port<span class="token operator">&gt;</span> <span class="token parameter variable">-u</span> <span class="token operator">&lt;</span>username<span class="token operator">&gt;</span> <span class="token parameter variable">-p</span> <span class="token operator">&lt;</span>password<span class="token operator">&gt;</span>
</code></pre> 
<p>示例如下：</p> 
<pre><code class="prism language-shell">kubectl run <span class="token parameter variable">-ti</span> <span class="token parameter variable">--image</span> vesoft/nebula-console:v3.5.0 <span class="token parameter variable">--restart</span><span class="token operator">=</span>Never -- nebula-console <span class="token parameter variable">-addr</span> <span class="token number">192.168</span>.8.24 <span class="token parameter variable">-port</span> <span class="token number">32236</span> <span class="token parameter variable">-u</span> root <span class="token parameter variable">-p</span> vesoft
If you don't see a <span class="token builtin class-name">command</span> prompt, try pressing enter.

<span class="token punctuation">(</span>root@nebula<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">&gt;</span>
</code></pre> 
<ul><li><code>--image</code>：为连接 NebulaGraph 的工具 NebulaGraph Console 的镜像。</li><li><code>&lt;nebula-console&gt;</code>：自定义的 Pod 名称，本示例为 <code>nebula-console</code>。</li><li><code>-addr</code>：NebulaGraph 集群中任一节点 IP 地址，本示例为 <code>192.168.8.24</code>。</li><li><code>-port</code>：NebulaGraph 映射至节点的端口，本示例为 <code>32236</code>。</li><li><code>-u</code>：NebulaGraph 账号的用户名。未启用身份认证时，可以使用任意已存在的用户名（默认为 root）。</li><li><code>-p</code>：用户名对应的密码。未启用身份认证时，密码可以填写任意字符。<br> 以上为本次实践，有任何问题欢迎论坛留言交流。</li></ul> 
<h3><a id="_1073"></a>参考资料：</h3> 
<ul><li><a href="https://www.bilibili.com/video/BV1LB4y1e7x7/?spm_id_from=333.999.0.0&amp;vd_source=49167ed1626db3f8a49f7650e7b6ccc5" rel="nofollow">https://www.bilibili.com/video/BV1LB4y1e7x7/?spm_id_from=333.999.0.0&amp;vd_source=49167ed1626db3f8a49f7650e7b6ccc5</a></li><li><a href="https://www.aliyue.net/13214.html" rel="nofollow">https://www.aliyue.net/13214.html</a></li></ul> 
<hr> 
<p><strong>谢谢你读完本文</strong> (///▽///)</p> 
<p>如果你想尝鲜图数据库 NebulaGraph，记得去 GitHub 下载、使用、(<sup>з</sup>)-☆ star 它 -&gt; <a href="https://github.com/vesoft-inc/nebula">GitHub</a>；和其他的 NebulaGraph 用户一起交流图数据库技术和应用技能，留下<a href="https://wj.qq.com/s2/8321168/8e2f/" rel="nofollow">「你的名片」</a>一起玩耍呀~</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9bd8513b109af3feecfec3ece0a28d75/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【转载】腾讯音乐技术团队：QQ音乐Android编译提速之路</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e0dc4cce81c9396155685a3f2ac2de1b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">在Linux中安装lrzsz（yum命令使用）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>