<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu交叉编译Arm Linux环境下的身份证读卡器so库操作步骤 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu交叉编译Arm Linux环境下的身份证读卡器so库操作步骤" />
<meta property="og:description" content="1、配置环境变量
①将gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu.tar解压至/home/eastcoms/
sudo或者root运行命令 ：sudo tar -xvf gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu.tar -C /home/eastcoms
.tar用 -xvf
.gz用 -zxvf
.bz2用 -jxvf
.xz用 -Jxvf
②修改环境变量 命令：sudo gedit /etc/profile
在最后面加上：
export PATH=$PATH:&#34;/home/eastcoms/gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu/bin&#34;
或者：
export PATH=&#34;/home/eastcoms/gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu/bin:$PATH&#34;
③使环境变量生效（相当于重启）命令：source /etc/profile
查看编译器是否存在，以及版本是否和交叉编译链7.5.0一致
命令：aarch64-linux-gnu-gcc -v 或者 aarch64-linux-gnu-g&#43;&#43; -v
如果一致，则表示配置成功，可以用交叉编译工具进行编译文件了
2、交叉编译libusb
①下载libusb 然后解压 链接：https://libusb.info/ downloads-&gt;latest soruce
②配置交叉编译环境和输出目录：
首先进入libusb文件夹打开终端：
sudo ./configure --host=aarch64-linux --prefix=/home/eastcoms/libusb --disable-udev CC=/home/eastcoms/gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu/bin/aarch64-linux-gnu-gcc CXX=/home/eastcoms/gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu/bin/aarch64-linux-gnu-g&#43;&#43;
其中：
--host=aarch64-linux表示该软件编译完成后在aarch64-linux平台上运行，其他的还有arm-linux、x86_64-linux等
--prefix后面为libusb库安装目录/home/eastcoms/libusb
--disable表示禁用功能
CC表示指定gcc交叉编译器
CXX表示指定g&#43;&#43;交叉编译器
③编译、安装libusb
命令：make
命令：make install
进入/home/eastcoms/libusb查看是否生成include和lib文件夹，进入lib文件夹查看文件 file libusb-1.0.so.0.3.0，可以看到是ARM aarch64的即表示编译成功。
3、编译读卡代码
aarch64-linux-gnu-gcc donsee.c dllMain.c utf." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/00c86178d54398c880f7ce75f07e85b4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-05T17:04:40+08:00" />
<meta property="article:modified_time" content="2022-12-05T17:04:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu交叉编译Arm Linux环境下的身份证读卡器so库操作步骤</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:.0001pt;text-align:left;">1、配置环境变量</p> 
<p style="margin-left:.0001pt;text-align:left;">①将gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu.tar解压至/home/eastcoms/</p> 
<p style="margin-left:.0001pt;text-align:left;">sudo或者root运行命令 ：sudo tar -xvf gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu.tar -C /home/eastcoms</p> 
<p style="margin-left:.0001pt;text-align:left;">.tar用 -xvf</p> 
<p style="margin-left:.0001pt;text-align:left;">.gz用 -zxvf</p> 
<p style="margin-left:.0001pt;text-align:left;">.bz2用 -jxvf</p> 
<p style="margin-left:.0001pt;text-align:left;">.xz用 -Jxvf</p> 
<p style="margin-left:.0001pt;text-align:left;">②修改环境变量 <img alt="" src="https://images2.imgbox.com/fe/06/lkO4abBg_o.png"></p> 
<p> 命令：sudo gedit /etc/profile</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">在最后面加上：</p> 
<p style="margin-left:.0001pt;text-align:left;">export PATH=$PATH:"/home/eastcoms/gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu/bin"</p> 
<p style="margin-left:.0001pt;text-align:left;">或者：</p> 
<p style="margin-left:.0001pt;text-align:left;">export PATH="/home/eastcoms/gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu/bin:$PATH"</p> 
<p style="margin-left:.0001pt;text-align:left;">③使环境变量生效（相当于重启）命令：source /etc/profile</p> 
<p style="margin-left:.0001pt;text-align:left;">查看编译器是否存在，以及版本是否和交叉编译链7.5.0一致</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p><img alt="" src="https://images2.imgbox.com/ce/b1/PB9Zlac2_o.png"></p> 
<p style="margin-left:.0001pt;text-align:left;">命令：aarch64-linux-gnu-gcc -v  或者 aarch64-linux-gnu-g++ -v</p> 
<p style="margin-left:.0001pt;text-align:left;">如果一致，则表示配置成功，可以用交叉编译工具进行编译文件了</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">2、交叉编译libusb</p> 
<p style="margin-left:.0001pt;text-align:left;">①下载libusb 然后解压 链接：https://libusb.info/  downloads-&gt;latest soruce</p> 
<p style="margin-left:.0001pt;text-align:left;">②配置交叉编译环境和输出目录：</p> 
<p style="margin-left:.0001pt;text-align:left;">首先进入libusb文件夹打开终端：</p> 
<p style="margin-left:.0001pt;text-align:left;">sudo ./configure --host=aarch64-linux --prefix=/home/eastcoms/libusb --disable-udev CC=/home/eastcoms/gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu/bin/aarch64-linux-gnu-gcc CXX=/home/eastcoms/gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu/bin/aarch64-linux-gnu-g++</p> 
<p style="margin-left:.0001pt;text-align:left;">其中：</p> 
<p style="margin-left:.0001pt;text-align:left;">--host=aarch64-linux表示该软件编译完成后在aarch64-linux平台上运行，其他的还有arm-linux、x86_64-linux等</p> 
<p style="margin-left:.0001pt;text-align:left;">--prefix后面为libusb库安装目录/home/eastcoms/libusb</p> 
<p style="margin-left:.0001pt;text-align:left;">--disable表示禁用功能</p> 
<p style="margin-left:.0001pt;text-align:left;">CC表示指定gcc交叉编译器</p> 
<p style="margin-left:.0001pt;text-align:left;">CXX表示指定g++交叉编译器</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">③编译、安装libusb</p> 
<p style="margin-left:.0001pt;text-align:left;">命令：make</p> 
<p style="margin-left:.0001pt;text-align:left;">命令：make install</p> 
<p style="margin-left:.0001pt;text-align:left;">进入/home/eastcoms/libusb查看是否生成include和lib文件夹，进入lib文件夹查看文件 file libusb-1.0.so.0.3.0，可以看到是ARM aarch64的即表示编译成功。</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">3、编译读卡代码</p> 
<p style="margin-left:.0001pt;text-align:left;">aarch64-linux-gnu-gcc donsee.c dllMain.c utf.c -shared -fPIC -o libdonsee.so -lusb-1.0 -ldl</p> 
<p style="margin-left:.0001pt;text-align:left;">aarch64-linux-gnu-gcc donseeTest.c -o output ./libdonsee.so</p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" src="https://images2.imgbox.com/df/0d/igBy1Zt9_o.png"></p> 
<p style="margin-left:.0001pt;text-align:left;">如果编译报错，提示找不到libusb库，则需要把编译好的libusb-1.0（含里面的libusb.h）文件夹拷贝到交叉编译器include文件夹里面，拷贝文件夹加上 -r</p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" src="https://images2.imgbox.com/e1/82/WW38MSg3_o.png"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:left;">cp -r /home/eastcoms/libusb/include/libusb-1.0 /home/eastcoms/gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu/aarch64-linux-gnu/libc/usr/include</p> 
<p style="margin-left:.0001pt;text-align:left;">cp -r /home/eastcoms/libusb/include/libusb-1.0 . （.表示当前目录）</p> 
<p style="margin-left:.0001pt;text-align:left;">拷贝libusb-1.0.a 到lib文件夹</p> 
<p style="margin-left:.0001pt;text-align:left;">cp /home/eastcoms/libusb/lib/libusb-1.0.* /home/eastcoms/gcc-linaro-7.5.0-2019.12-x86_64_aarch64-linux-gnu/aarch64-linux-gnu/libc/usr/lib</p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" src="https://images2.imgbox.com/da/31/H4ZgQd6T_o.png"></p> 
<p>编译完成，file命令可以查看文件类型是 arm aarch64是我们使用的交叉编译链。</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;">删除文件夹和里面所有文件指令：rm -rf  /home/eastcoms/libusb   删除libusb文件夹和里面文件</p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"></p> 
<p style="margin-left:.0001pt;text-align:left;"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7f95717761a1e5251aecaa1309c343b5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Node.js学习笔记</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b89f26e586a372b25508def15c18e188/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">复杂度——时间复杂度</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>