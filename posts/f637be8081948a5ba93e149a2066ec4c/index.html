<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C语言系列-浮点数在内存中的存储 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C语言系列-浮点数在内存中的存储" />
<meta property="og:description" content="🌈个人主页: 会编程的果子君
​💫个人格言:“成为自己未来的主人~” 目录
浮点数在内存中的存储
浮点数的存储
浮点数存的过程
浮点数取的过程
题目解析
浮点数在内存中的存储 常见的浮点数：3.14159.1E10等，浮点数家族包括：float double long double等，浮点数表示的范围：float.h中定义
浮点数的存储 首先，我们先来看一段代码：
#include&lt;stdio.h&gt; int main() { int n = 9; float* pFloat = (float*)&amp;n; printf(&#34;n的值为：%d\n&#34;, n); printf(&#34;*pFloat的值为：%f\n&#34;, *pFloat); *pFloat = 9.0; printf(&#34;num的值为：%d\n&#34;, n); printf(&#34;*pFloat的值为：%f\n&#34;, *pFloat); return 0; } 大家想一下，在这段代码中，输出的结果是什么？
上面的代码中，num和*pFloat在内存中明明是同一个数，为什么浮点数和整数打印出的结果会相差这么大。
要理解这个结果，一定要搞懂浮点数在计算机内部的表示方法
根据国际标准IEEE（电气和电子工程协会）754，任意一个二进制浮点数V可以表示成下面的形式：
V = (−1) ^S* M * 2^E
• (−1)S 表⽰符号位，当S=0，V为正数；当S=1，V为负数
• M 表⽰有效数字，M是⼤于等于1，⼩于2的
• 2 E 表⽰指数位
举例来说：
十进制的5.0，写成二进制是101.0，相当于1.01*2^2
那么，按照上面的格式，可以得出s=0,m=1.01,e=2
十进制的-5.0，写成二进制是-101.0，相当于-1*1.01*2^2，那么，s=1,m=1.01,e=2
IEEE 754规定：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f637be8081948a5ba93e149a2066ec4c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-28T11:04:53+08:00" />
<meta property="article:modified_time" content="2024-01-28T11:04:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C语言系列-浮点数在内存中的存储</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p class="img-center"><img alt="" height="204" src="https://images2.imgbox.com/d3/dc/ccYjs8JV_o.png" width="136"></p> 
<p><strong> 🌈个人主页: <strong><strong><strong><strong><strong><strong><strong><a href="https://blog.csdn.net/in_seattle?spm=1010.2135.3001.5343" title="会编程的果子君">会编程的果子君</a></strong></strong></strong></strong></strong></strong></strong></strong><br> ​<strong>💫个人格言:“成为自己未来的主人~”</strong> </p> 
<p> <strong><img alt="" src="https://images2.imgbox.com/cd/02/eusKVoa3_o.gif"></strong></p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<p id="%E6%B5%AE%E7%82%B9%E6%95%B0%E5%9C%A8%E5%86%85%E5%AD%98%E4%B8%AD%E7%9A%84%E5%AD%98%E5%82%A8-toc" style="margin-left:0px;"><a href="#%E6%B5%AE%E7%82%B9%E6%95%B0%E5%9C%A8%E5%86%85%E5%AD%98%E4%B8%AD%E7%9A%84%E5%AD%98%E5%82%A8" rel="nofollow">浮点数在内存中的存储</a></p> 
<p id="%E6%B5%AE%E7%82%B9%E6%95%B0%E7%9A%84%E5%AD%98%E5%82%A8-toc" style="margin-left:0px;"><a href="#%E6%B5%AE%E7%82%B9%E6%95%B0%E7%9A%84%E5%AD%98%E5%82%A8" rel="nofollow">浮点数的存储</a></p> 
<p id="%E6%B5%AE%E7%82%B9%E6%95%B0%E5%AD%98%E7%9A%84%E8%BF%87%E7%A8%8B-toc" style="margin-left:40px;"><a href="#%E6%B5%AE%E7%82%B9%E6%95%B0%E5%AD%98%E7%9A%84%E8%BF%87%E7%A8%8B" rel="nofollow">浮点数存的过程</a></p> 
<p id="%E6%B5%AE%E7%82%B9%E6%95%B0%E5%8F%96%E7%9A%84%E8%BF%87%E7%A8%8B-toc" style="margin-left:40px;"><a href="#%E6%B5%AE%E7%82%B9%E6%95%B0%E5%8F%96%E7%9A%84%E8%BF%87%E7%A8%8B" rel="nofollow">浮点数取的过程</a></p> 
<p id="%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90-toc" style="margin-left:40px;"><a href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90" rel="nofollow">题目解析</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E6%B5%AE%E7%82%B9%E6%95%B0%E5%9C%A8%E5%86%85%E5%AD%98%E4%B8%AD%E7%9A%84%E5%AD%98%E5%82%A8">浮点数在内存中的存储</h2> 
<p>常见的浮点数：3.14159.1E10等，浮点数家族包括：float double  long double等，浮点数表示的范围：float.h中定义</p> 
<h2 id="%E6%B5%AE%E7%82%B9%E6%95%B0%E7%9A%84%E5%AD%98%E5%82%A8">浮点数的存储</h2> 
<p>首先，我们先来看一段代码：</p> 
<pre><code class="language-cpp">#include&lt;stdio.h&gt;
int main()
{
	int n = 9;
	float* pFloat = (float*)&amp;n;
	printf("n的值为：%d\n", n);
	printf("*pFloat的值为：%f\n", *pFloat);
	*pFloat = 9.0;
	printf("num的值为：%d\n", n);
	printf("*pFloat的值为：%f\n", *pFloat);
	return 0;
}
</code></pre> 
<p>大家想一下，在这段代码中，输出的结果是什么？</p> 
<p><img alt="" height="187" src="https://images2.imgbox.com/6d/bf/LHpNEhkN_o.png" width="893"> </p> 
<p> 上面的代码中，num和*pFloat在内存中明明是同一个数，为什么浮点数和整数打印出的结果会相差这么大。</p> 
<p>要理解这个结果，一定要搞懂浮点数在计算机内部的表示方法</p> 
<p>根据国际标准IEEE（电气和电子工程协会）754，任意一个二进制浮点数V可以表示成下面的形式：</p> 
<p>V   =  (−1) ^S* M * 2^E</p> 
<p>• (−1)S 表⽰符号位，当S=0，V为正数；当S=1，V为负数</p> 
<p>• M 表⽰有效数字，M是⼤于等于1，⼩于2的</p> 
<p>• 2 E 表⽰指数位</p> 
<p>举例来说：</p> 
<p>十进制的5.0，写成二进制是101.0，相当于1.01*2^2</p> 
<p>那么，按照上面的格式，可以得出s=0,m=1.01,e=2</p> 
<p>十进制的-5.0，写成二进制是-101.0，相当于-1*1.01*2^2，那么，s=1,m=1.01,e=2</p> 
<p>IEEE 754规定：</p> 
<p>对于32位的浮点数，最高的1位存储符号位S，接着的8位存储指数E，剩下的23位存储有效数字M</p> 
<p>对于64位的浮点数，最高的一位存储符号位S，接着的11位存储指数E，剩下的52位存储有效数字M</p> 
<h3 id="%E6%B5%AE%E7%82%B9%E6%95%B0%E5%AD%98%E7%9A%84%E8%BF%87%E7%A8%8B">浮点数存的过程</h3> 
<p><strong>IEEE 754 对有效数字M和指数E，还有一些特别规定</strong></p> 
<p>前面说过，1&lt;=M&lt;2，也就是说，M可以写成1.xxxxxx的形式，其中的xxxxxx表示小数部分。</p> 
<p>IEEE 754规定，在计算机内部保存M时，默认这个数的第一位是1，因此可以被舍去，只保存后面的xxxxxx部分，比如保存1.01的时候，只保存01，等到读取的时候，再把第一位的1加上去，这样做的目的是节省一位有效数字，一32位浮点数为例，留给M的只有23位，将第一位省略后，等于可以保存24位有效数字。</p> 
<p><strong>至于指数E，情况即比较复杂</strong></p> 
<p><strong>首先 E为一个无符号整数</strong></p> 
<p>这意味着，如果E为8位，它的取值范围0-225；如果E为11位，它的取值范围0-2047，但是，我们 知道，科学计数法中的E是可以出现负数的，所以IEEE 754规定，存入内存时E的真实值必须再加上一个中间数，对于8位的E，这个中间数是127；对于11位的E，这个中间数是 1023。</p> 
<h3 id="%E6%B5%AE%E7%82%B9%E6%95%B0%E5%8F%96%E7%9A%84%E8%BF%87%E7%A8%8B">浮点数取的过程</h3> 
<p>指数E从内存中取出还可以再分成三种情况：</p> 
<p><strong>E不全为0或不全为1 </strong></p> 
<p>这时，浮点数就采用下面的规则表示，即指数E的计算值减去127（或1023），得到真实值，再将有效数字M前加上第一位的1.</p> 
<p>比如：0.5的二进制形式是0.1，由于规定整数部分必须为1，即将小数点右移一位，则为1.0^2^（-1），其阶码为-1+127（中间值）=126，表示为01111110，而尾数1.0去掉整数部分为0，不起0到23位00000000000000000000000，则其二进制表示形式为</p> 
<p>0 01111110 00000000000000000000000</p> 
<p><strong>E全为0</strong></p> 
<p>这时，浮点数的E等于1-127（或者1-1023）即为真实值，有效数字M不再加上第一位的1，而是还原为0.xxxxxxx的小数，这样做是为了表示+-0，以及接近0的很小的数字</p> 
<p><strong>E全为1</strong></p> 
<p>这时，如果有效数字M全为0，表示无穷大</p> 
<h3 id="%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90">题目解析</h3> 
<p>让我们回到一开始的练习：先看第一环节</p> 
<p>为什么9还原成浮点数，就成了0.000000？</p> 
<p>9以整型的形式存储在内存中，得到如下二进制序列：</p> 
<blockquote> 
 <p>0 00000000 00000000000000000001001</p> 
</blockquote> 
<p>首先，将9的二进制序列按照浮点数的形式拆分，得到第一位符号位是0 ，后面8位的指数E=00000000</p> 
<p>最后23位有效数字是M=00000000000000000001001</p> 
<p>由于指数E全为0，所以符合E为全0的情况，因此，浮点数V就写成：</p> 
<p>V=（-1）^0*0.00000000000000000001001*2^(-126)</p> 
<p>显然，V是一个很小的接近于0的正数，所以用十进制的小数表示就是0.000000。</p> 
<p>再看第二环节：</p> 
<p>浮点数9.0 为什么整数打印是1091567616</p> 
<p>首先，浮点数9.0相当于二进制的1001.0，即换算成科学计数法是：1.001*2^3</p> 
<p>所以：9.0 = （-1）^0*(1.001)*2^3</p> 
<blockquote> 
 <p>0 10000010 001 0000 0000 0000 0000 0000</p> 
</blockquote> 
<p>这个当成整数打印，就是1091567616</p> 
<p class="img-center"><img alt="" height="383" src="https://images2.imgbox.com/cc/dc/hJ38VIMH_o.gif" width="650"></p> 
<p> <img alt="" src="https://images2.imgbox.com/58/be/VCsPKhlf_o.gif"></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0d7ba4c7ae33fd5e17170bbd23ab26fa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">RocketMQ</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/94b4259422be1ed20dcfa28d145ffd44/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">可视化 | 【d3】力导向关系图优化（搜索&#43;刷新）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>