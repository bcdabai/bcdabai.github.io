<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android抽象布局——include、merge 、ViewStub - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android抽象布局——include、merge 、ViewStub" />
<meta property="og:description" content="在布局优化中，Androi的官方提到了这三种布局&lt;include /&gt;、&lt;merge /&gt;、&lt;ViewStub /&gt;，并介绍了这三种布局各有的优势，下面也是简单说一下他们的优势，以及怎么使用，记下来权当做笔记。
1、布局重用&lt;include /&gt; &lt;include /&gt;标签能够重用布局文件，简单的使用如下：
&lt;LinearLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34; android:orientation=&#34;vertical&#34; android:layout_width=”match_parent” android:layout_height=”match_parent” android:background=&#34;@color/app_bg&#34; android:gravity=&#34;center_horizontal&#34;&gt; &lt;include layout=&#34;@layout/titlebar&#34;/&gt; &lt;TextView android:layout_width=”match_parent” android:layout_height=&#34;wrap_content&#34; android:text=&#34;@string/hello&#34; android:padding=&#34;10dp&#34; /&gt; ... &lt;/LinearLayout&gt; 1)&lt;include /&gt;标签可以使用单独的layout属性，这个也是必须使用的。
2)可以使用其他属性。&lt;include /&gt;标签若指定了ID属性，而你的layout也定义了ID，则你的layout的ID会被覆盖，解决方案。
3)在include标签中所有的android:layout_*都是有效的，前提是必须要写layout_width和layout_height两个属性。
4)布局中可以包含两个相同的include标签，引用时可以使用如下方法解决（参考）:
View bookmarks_container_2 = findViewById(R.id.bookmarks_favourite); bookmarks_container_2.findViewById(R.id.bookmarks_list); 2、减少视图层级&lt;merge /&gt; &lt;merge/&gt;标签在UI的结构优化中起着非常重要的作用，它可以删减多余的层级，优化UI。&lt;merge/&gt;多用于替换FrameLayout或者当一个布局包含另一个时，&lt;merge/&gt;标签消除视图层次结构中多余的视图组。例如你的主布局文件是垂直布局，引入了一个垂直布局的include，这是如果include布局使用的LinearLayout就没意义了，使用的话反而减慢你的UI表现。这时可以使用&lt;merge/&gt;标签优化。
&lt;merge xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;&gt; &lt;Button android:layout_width=&#34;fill_parent&#34; android:layout_height=&#34;wrap_content&#34; android:text=&#34;@string/add&#34;/&gt; &lt;Button android:layout_width=&#34;fill_parent&#34; android:layout_height=&#34;wrap_content&#34; android:text=&#34;@string/delete&#34;/&gt; &lt;/merge&gt; 现在，当你添加该布局文件时(使用&lt;include /&gt;标签)，系统忽略&lt;merge /&gt;节点并且直接添加两个Button。更多&lt;merge /&gt;介绍可以参考《Android Layout Tricks #3: Optimize by merging》
3、需要时使用&lt;ViewStub /&gt; &lt;ViewStub /&gt;标签最大的优点是当你需要时才会加载，使用他并不会影响UI初始化时的性能。各种不常用的布局想进度条、显示错误消息等可以使用&lt;ViewStub /&gt;标签，以减少内存使用量，加快渲染速度。&lt;ViewStub /&gt;是一个不可见的，大小为0的View。&lt;ViewStub /&gt;标签使用如下：
&lt;ViewStub android:id=&#34;@&#43;id/stub_import&#34; android:inflatedId=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/00de47cae1ea3335848c54c0c203dc41/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2013-11-11T17:18:35+08:00" />
<meta property="article:modified_time" content="2013-11-11T17:18:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android抽象布局——include、merge 、ViewStub</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><br></p> 
<p><span style="font-size:18px;">      在布局优化中，Androi的官方提到了这三种布局&lt;include /&gt;、&lt;merge /&gt;、&lt;ViewStub /&gt;，并介绍了这三种布局各有的优势，下面也是简单说一下他们的优势，以及怎么使用，记下来权当做笔记。</span></p> 
<p><br></p> 
<h3><span style="font-size:18px;">1、布局重用&lt;include /&gt;</span></h3> 
<p><span style="font-family:SimSun;font-size:18px;">&lt;include /&gt;标签能够重用布局文件，简单的使用如下：</span></p> 
<p><span style="font-family:SimSun;font-size:18px;"><br></span></p> 
<p></p> 
<pre><code class="language-html">&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" 
    android:layout_width=”match_parent”
    android:layout_height=”match_parent”
    android:background="@color/app_bg"
    android:gravity="center_horizontal"&gt;

    &lt;include layout="@layout/titlebar"/&gt;

    &lt;TextView android:layout_width=”match_parent”
              android:layout_height="wrap_content"
              android:text="@string/hello"
              android:padding="10dp" /&gt;

    ...

&lt;/LinearLayout&gt;</code></pre> 
<br> 
<p></p> 
<p><span style="font-family:SimSun;font-size:18px;background-color: rgb(255, 255, 255);">    1)&lt;include /&gt;标签可以使用单独的layout属性，这个也是必须使用的。</span></p> 
<p><span style="font-family:SimSun;font-size:18px;background-color: rgb(255, 255, 255);">    2)可以使用其他属性。<span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">&lt;include /&gt;</span><span style="padding: 0px; margin: 0px; line-height: 28px;">标签若指定了</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">ID</span><span style="padding: 0px; margin: 0px; line-height: 28px;">属性，而你的</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">layout</span><span style="padding: 0px; margin: 0px; line-height: 28px;">也定义了</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">ID</span><span style="padding: 0px; margin: 0px; line-height: 28px;">，则你的</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">layout</span><span style="padding: 0px; margin: 0px; line-height: 28px;">的</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">ID</span><span style="padding: 0px; margin: 0px; line-height: 28px;">会被覆盖，<a target="_blank" href="http://my.eoe.cn/814017/archive/3415.html" rel="nofollow noopener noreferrer">解决方案</a>。</span></span></p> 
<p><span style="font-family:SimSun;font-size:18px;background-color: rgb(255, 255, 255);"><span style="padding: 0px; margin: 0px; line-height: 28px;"><span style="padding: 0px; margin: 0px; line-height: 28px;">    3)在</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">include</span><span style="padding: 0px; margin: 0px; line-height: 28px;">标签中所有的</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">android:layout_*</span><span style="padding: 0px; margin: 0px; line-height: 28px;">都是有效的，前提是必须要写</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">layout_width</span><span style="padding: 0px; margin: 0px; line-height: 28px;">和</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">layout_height</span><span style="padding: 0px; margin: 0px; line-height: 28px;">两个属性</span><span style="padding: 0px; margin: 0px; line-height: 28px;">。</span></span></span></p> 
<p><span style="font-family:SimSun;font-size:18px;background-color: rgb(255, 255, 255);"><span style="padding: 0px; margin: 0px; line-height: 28px;"><span style="padding: 0px; margin: 0px; line-height: 28px;">    4)布局中可以包含两个相同的include标签，引用时可以使用如下方法解决（<a target="_blank" href="http://www.coboltforge.com/2012/05/tech-stuff-layout/" rel="nofollow noopener noreferrer">参考</a>）:</span></span></span></p> 
<p></p> 
<pre><code class="language-html">View bookmarks_container_2 = findViewById(R.id.bookmarks_favourite); 

bookmarks_container_2.findViewById(R.id.bookmarks_list);</code></pre> 
<br> 
<br> 
<p></p> 
<h3>2、减少视图层级&lt;merge /&gt;</h3> 
<p><span style="line-height: 25px;"><span style="font-family:SimSun;font-size:18px;"><span style="line-height: 21.59375px;">    &lt;merge/&gt;标签在UI的结构优化中起着非常重要的作用，它可以删减多余的层级，优化UI。<span style="line-height: 21.59375px;">&lt;merge/&gt;多用于替换FrameLay</span><span style="line-height: 21.59375px;">out或者<span style="line-height: 26px;">当一个布局包含另一个时，<span style="line-height: 21.59375px;">&lt;merge/&gt;</span></span><span style="line-height: 26px;">标签消除视图层次结构中多余的视图组。例如你的主布局文件是垂直布局，引入了一个垂直布局的include，这是如果include布局使用的LinearLayout就没意义了，使用的话反而<span style="color: rgb(51, 51, 51); line-height: 26px;">减慢你的UI表现。这时可以使用<span style="font-family: SimSun;font-size:18px; line-height: 21.59375px;">&lt;merge/&gt;标签优化。</span></span></span></span></span></span></span><br></p> 
<p><span style="line-height: 25px;"><span style="font-family:SimSun;font-size:18px;"><span style="line-height: 21.59375px;"><span style="line-height: 21.59375px;"><span style="line-height: 26px;"><span style="line-height: 26px;"><span style="line-height: 21.59375px;"></span></span></span></span></span></span></span></p> 
<pre><code class="language-html">&lt;merge xmlns:android="http://schemas.android.com/apk/res/android"&gt;

    &lt;Button
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content"
        android:text="@string/add"/&gt;

    &lt;Button
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content"
        android:text="@string/delete"/&gt;

&lt;/merge&gt;</code></pre> 
<br> 
<p></p> 
<p><span style="font-family:SimSun;font-size:18px;"><span style="font-weight: normal;"><span style="color:#333333;">     现在，当你添加该布局文件时(使用&lt;include /&gt;标签)，系统忽略&lt;merge /&gt;节点并且直接添加两个Button。更多</span><span style="line-height: 21.59375px;"><span style="color: rgb(51, 51, 51);">&lt;merge /&gt;介绍可以参考</span><span style="background-color: rgb(255, 255, 255);">《</span></span></span><span style="background-color: rgb(255, 255, 255);"><a target="_blank" href="http://android-developers.blogspot.com/2009/03/android-layout-tricks-3-optimize-by.html" rel="nofollow noopener noreferrer">Android Layout Tricks #3: Optimize by merging</a></span><span style="font-weight: normal;"><span style="background-color: rgb(255, 255, 255);">》</span></span></span></p> 
<p><br></p> 
<h3>3、需要时使用&lt;ViewStub /&gt;</h3> 
<p><span style="font-family:SimSun;font-size:18px;">    &lt;ViewStub /&gt;标签最大的优点是当你需要时才会加载，使用他并不会影响UI初始化时的性能。各种不常用的布局想进度条、显示错误消息等可以使用&lt;ViewStub /&gt;标签，以减少内存使用量，加快渲染速度。&lt;ViewStub /&gt;<span style="padding: 0px; margin: 0px; line-height: 28px;">是一个不可见的，大小为</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">0</span><span style="padding: 0px; margin: 0px; line-height: 28px;">的</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">View。<span style="font-family: SimSun;font-size:18px;">&lt;ViewStub /&gt;标签使用如下：</span></span></span></p> 
<p><br></p> 
<p></p> 
<pre><code class="language-html">&lt;ViewStub
    android:id="@+id/stub_import"
    android:inflatedId="@+id/panel_import"
    android:layout="@layout/progress_overlay"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="bottom" /&gt;</code></pre> 
<p></p> 
<p><span style="font-family:SimSun;font-size:18px;"><br></span></p> 
<p><span style="font-family:SimSun;font-size:18px;">当你想加载布局时，可以使用下面其中一种方法：</span></p> 
<p><br></p> 
<pre><code class="language-java">((ViewStub) findViewById(R.id.stub_import)).setVisibility(View.VISIBLE);
// or
View importPanel = ((ViewStub) findViewById(R.id.stub_import)).inflate();</code></pre> 
<p><br></p> 
<p><span style="font-family:SimSun;font-size:18px;background-color: rgb(255, 255, 255);"><span style="padding: 0px; margin: 0px; line-height: 28px;">当调用</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">inflate()</span><span style="padding: 0px; margin: 0px; line-height: 28px;">函数的时候，</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">ViewStub</span><span style="padding: 0px; margin: 0px; line-height: 28px;">被引用的资源替代，并且返回引用的</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">view</span><span style="padding: 0px; margin: 0px; line-height: 28px;">。</span><span style="padding: 0px; margin: 0px; line-height: 28px;"> </span><span style="padding: 0px; margin: 0px; line-height: 28px;">这样程序可以直接得到引用的</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">view</span><span style="padding: 0px; margin: 0px; line-height: 28px;">而不用再次调用函数</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">findViewById()</span><span style="padding: 0px; margin: 0px; line-height: 28px;">来查找了。<br></span><span style="padding: 0px; margin: 0px; line-height: 28px;">注</span><span style="padding: 0px; margin: 0px; line-height: 28px;">：</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;">ViewStub</span><span style="padding: 0px; margin: 0px; line-height: 28px;">目前有个缺陷就是还不支持</span><span lang="EN-US" style="padding: 0px; margin: 0px; line-height: 28px;"> &lt;merge /&gt; </span><span style="padding: 0px; margin: 0px; line-height: 28px;">标签。</span></span></p> 
<p><span style="font-family:SimSun;font-size:18px;background-color: rgb(255, 255, 255);"><br>更多&lt;ViewStub /&gt;标签介绍可以参考《<a target="_blank" href="http://android-developers.blogspot.com/2009/03/android-layout-tricks-3-optimize-with.html" rel="nofollow noopener noreferrer" style="text-decoration: none; color: rgb(51, 181, 229);">Android Layout Tricks #3: Optimize with stubs</a>》</span></p> 
<p><br></p> 
<p></p> 
<div style="font-family: Arial; font-size: 14px; line-height: 26px;"> 
 <div> 
  <span style="color: rgb(51, 51, 51);"><span style="font-family: SimSun;">/**</span></span> 
 </div> 
 <span style="font-family: SimSun;"><span style="color: rgb(51, 51, 51);"></span></span> 
 <div> 
  <span style="font-family: SimSun;">* @author 张兴业</span> 
 </div> 
</div> 
<div style="font-family: Arial; font-size: 14px; line-height: 26px;"> 
 <div> 
  <span style="font-family: SimSun;">*  <a target="_blank" href="http://blog.csdn.net/xyz_lmn" style="color: rgb(255, 153, 0); text-decoration: none;" rel="noopener noreferrer">http://blog.csdn.net/xyz_lmn</a></span> 
 </div> 
 <span style="font-family: SimSun;"><span style="color: rgb(51, 51, 51);"></span></span> 
 <div> 
  <span style="font-family: SimSun;">*  我的新浪微博：<span style="font-size: 18px; color: rgb(255, 102, 102);"><strong><a target="_blank" href="http://weibo.com/xyzlmn" rel="nofollow noopener noreferrer" style="color: rgb(202, 0, 0); text-decoration: none;">@张兴业TBOW</a></strong></span></span> 
 </div> 
 <div> 
  <span style="font-family: SimSun;">*/</span> 
 </div> 
</div> 
<br> 
<p></p> 
<p><br></p> 
<p><span style="font-size:18px;">参考：</span></p> 
<p>http://developer.android.com/training/improving-layouts/reusing-layouts.html<br></p> 
<p>http://android-developers.blogspot.com/2009/03/android-layout-tricks-3-optimize-by.html<br></p> 
<p>http://developer.android.com/training/improving-layouts/optimizing-layout.html#Lint<br></p> 
<p>http://android-developers.blogspot.com/2009/02/android-layout-tricks-1.html<br></p> 
<p>http://developer.android.com/training/improving-layouts/loading-ondemand.html<br></p> 
<p><br></p> 
<p><br></p> 
<p><br></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8a1908cd027c83ee1e02b560f2922429/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">c#播放wav/mp3格式的声音</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c9a546768958c5fd304ec350532025de/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C&#43;&#43; 简单实现HTTP GET/POST 请求</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>