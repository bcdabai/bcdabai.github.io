<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在Win10平台上搭建AI训练（英伟达GPU加速）环境 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="在Win10平台上搭建AI训练（英伟达GPU加速）环境" />
<meta property="og:description" content="1.环境
版本 Windows 10 企业版
版本号 21H2
安装日期 ‎2022/‎3/‎13
操作系统内部版本 19044.1826
体验 Windows Feature Experience Pack 120.2212.4180.0
2.搭建GPU加速环境
a.确定主机显卡驱动版本：在“NVIDIA控制面板”→“系统属性”查看显卡驱动版本
b.确定显卡驱动支持CUDA版本（网上有人说显卡驱动中给出的CUDA版本是此版本显卡驱动能支持的最高CUDA版本）
c. 通过nvidia官网（Release Notes :: CUDA Toolkit Documentation ）确定系统所安装显卡驱动支持最高CUDA版本
Table 2. CUDA Toolkit and Minimum Required Driver Version for CUDA Minor Version Compatibility
CUDA ToolkitMinimum Required Driver Version for CUDA Minor Version Compatibility*Linux x86_64 Driver VersionLinux AArch64 Driver VersionWindows x86_64 Driver VersionCUDA 11.7.x &gt;=450.80.02 &gt;=452.39CUDA 11.6.xCUDA 11.5.xCUDA 11.4.xCUDA 11.3.xCUDA 11.2.xCUDA 11." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/247674a5b290ebe94b486ff631f7223a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-29T11:06:51+08:00" />
<meta property="article:modified_time" content="2022-07-29T11:06:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在Win10平台上搭建AI训练（英伟达GPU加速）环境</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>1.环境</p> 
<p>版本 Windows 10 企业版<br> 版本号 21H2<br> 安装日期 ‎2022/‎3/‎13<br> 操作系统内部版本 19044.1826<br> 体验 Windows Feature Experience Pack 120.2212.4180.0</p> 
<p></p> 
<p>2.搭建GPU加速环境</p> 
<p>a.确定主机显卡驱动版本：在“NVIDIA控制面板”→“系统属性”查看显卡驱动版本</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/f6/9b/9cdoX82U_o.png" width="1059"></p> 
<p></p> 
<p>b.确定显卡驱动支持CUDA版本（网上有人说显卡驱动中给出的CUDA版本是此版本显卡驱动能支持的最高CUDA版本）</p> 
<p> <img alt="" height="1200" src="https://images2.imgbox.com/09/51/01Oz7hEh_o.png" width="1039"></p> 
<p> </p> 
<p></p> 
<p></p> 
<p>c. 通过nvidia官网（<a href="https://docs.nvidia.com/cuda/cuda-toolkit-release-notes/index.html" rel="nofollow" title="Release Notes :: CUDA Toolkit Documentation">Release Notes :: CUDA Toolkit Documentation</a> ）确定系统所安装显卡驱动支持最高CUDA版本</p> 
<p></p> 
<p>Table 2. CUDA Toolkit and Minimum Required Driver Version for CUDA Minor Version Compatibility</p> 
<table><thead><tr><th colspan="1" rowspan="2">CUDA Toolkit</th><th colspan="3" rowspan="1">Minimum Required Driver Version for CUDA Minor Version Compatibility*</th></tr><tr><th colspan="1" rowspan="1">Linux x86_64 Driver Version</th><th colspan="1" rowspan="1">Linux AArch64 Driver Version</th><th colspan="1" rowspan="1">Windows x86_64 Driver Version</th></tr></thead><tbody><tr><td colspan="1" rowspan="1">CUDA 11.7.x</td><td colspan="2" rowspan="7"> <p></p> <p></p> &gt;=450.80.02</td><td colspan="1" rowspan="7"> <p></p> <p></p> &gt;=452.39</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.6.x</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.5.x</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.4.x</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.3.x</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.2.x</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.1 (11.1.0)</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.0 (11.0.3)</td><td colspan="1" rowspan="1">&gt;=450.36.06**</td><td colspan="1" rowspan="1">&gt;=450.28.01**</td><td colspan="1" rowspan="1">&gt;=451.22**</td></tr></tbody></table> 
<p>* Using a Minimum Required Version that is <strong>different</strong> from Toolkit Driver Version could be allowed in compatibility mode -- please read the CUDA Compatibility Guide for details.</p> 
<p>** CUDA 11.0 was released with an earlier driver version, but by upgrading to Tesla Recommended Drivers 450.80.02 (Linux) / 452.39 (Windows), minor version compatibility is possible across the CUDA 11.x family of toolkits.</p> 
<p>The version of the development NVIDIA GPU Driver packaged in each CUDA Toolkit release is shown below.</p> 
<p>Table 3. CUDA Toolkit and Corresponding Driver Versions</p> 
<table><thead><tr><th colspan="1" rowspan="2">CUDA Toolkit</th><th colspan="2" rowspan="1">Toolkit Driver Version</th></tr><tr><th colspan="1" rowspan="1">Linux x86_64 Driver Version</th><th colspan="1" rowspan="1">Windows x86_64 Driver Version</th></tr></thead><tbody><tr><td colspan="1" rowspan="1">CUDA 11.7 GA</td><td colspan="1" rowspan="1">&gt;=515.43.04</td><td colspan="1" rowspan="1">&gt;=516.01</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.6 Update 2</td><td colspan="1" rowspan="1">&gt;=510.47.03</td><td colspan="1" rowspan="1">&gt;=511.65</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.6 Update 1</td><td colspan="1" rowspan="1">&gt;=510.47.03</td><td colspan="1" rowspan="1">&gt;=511.65</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.6 GA</td><td colspan="1" rowspan="1">&gt;=510.39.01</td><td colspan="1" rowspan="1">&gt;=511.23</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.5 Update 2</td><td colspan="1" rowspan="1">&gt;=495.29.05</td><td colspan="1" rowspan="1">&gt;=496.13</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.5 Update 1</td><td colspan="1" rowspan="1">&gt;=495.29.05</td><td colspan="1" rowspan="1">&gt;=496.13</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.5 GA</td><td colspan="1" rowspan="1">&gt;=495.29.05</td><td colspan="1" rowspan="1">&gt;=496.04</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.4 Update 4</td><td colspan="1" rowspan="1">&gt;=470.82.01</td><td colspan="1" rowspan="1">&gt;=472.50</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.4 Update 3</td><td colspan="1" rowspan="1">&gt;=470.82.01</td><td colspan="1" rowspan="1">&gt;=472.50</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.4 Update 2</td><td colspan="1" rowspan="1">&gt;=470.57.02</td><td colspan="1" rowspan="1">&gt;=471.41</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.4 Update 1</td><td colspan="1" rowspan="1">&gt;=470.57.02</td><td colspan="1" rowspan="1">&gt;=471.41</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.4.0 GA</td><td colspan="1" rowspan="1">&gt;=470.42.01</td><td colspan="1" rowspan="1">&gt;=471.11</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.3.1 Update 1</td><td colspan="1" rowspan="1">&gt;=465.19.01</td><td colspan="1" rowspan="1">&gt;=465.89</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.3.0 GA</td><td colspan="1" rowspan="1">&gt;=465.19.01</td><td colspan="1" rowspan="1">&gt;=465.89</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.2.2 Update 2</td><td colspan="1" rowspan="1">&gt;=460.32.03</td><td colspan="1" rowspan="1">&gt;=461.33</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.2.1 Update 1</td><td colspan="1" rowspan="1">&gt;=460.32.03</td><td colspan="1" rowspan="1">&gt;=461.09</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.2.0 GA</td><td colspan="1" rowspan="1">&gt;=460.27.03</td><td colspan="1" rowspan="1">&gt;=460.82</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.1.1 Update 1</td><td colspan="1" rowspan="1">&gt;=455.32</td><td colspan="1" rowspan="1">&gt;=456.81</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.1 GA</td><td colspan="1" rowspan="1">&gt;=455.23</td><td colspan="1" rowspan="1">&gt;=456.38</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.0.3 Update 1</td><td colspan="1" rowspan="1">&gt;= 450.51.06</td><td colspan="1" rowspan="1">&gt;= 451.82</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.0.2 GA</td><td colspan="1" rowspan="1">&gt;= 450.51.05</td><td colspan="1" rowspan="1">&gt;= 451.48</td></tr><tr><td colspan="1" rowspan="1">CUDA 11.0.1 RC</td><td colspan="1" rowspan="1">&gt;= 450.36.06</td><td colspan="1" rowspan="1">&gt;= 451.22</td></tr><tr><td colspan="1" rowspan="1">CUDA 10.2.89</td><td colspan="1" rowspan="1">&gt;= 440.33</td><td colspan="1" rowspan="1">&gt;= 441.22</td></tr><tr><td colspan="1" rowspan="1">CUDA 10.1 (10.1.105 general release, and updates)</td><td colspan="1" rowspan="1">&gt;= 418.39</td><td colspan="1" rowspan="1">&gt;= 418.96</td></tr><tr><td colspan="1" rowspan="1">CUDA 10.0.130</td><td colspan="1" rowspan="1">&gt;= 410.48</td><td colspan="1" rowspan="1">&gt;= 411.31</td></tr><tr><td colspan="1" rowspan="1">CUDA 9.2 (9.2.148 Update 1)</td><td colspan="1" rowspan="1">&gt;= 396.37</td><td colspan="1" rowspan="1">&gt;= 398.26</td></tr><tr><td colspan="1" rowspan="1">CUDA 9.2 (9.2.88)</td><td colspan="1" rowspan="1">&gt;= 396.26</td><td colspan="1" rowspan="1">&gt;= 397.44</td></tr><tr><td colspan="1" rowspan="1">CUDA 9.1 (9.1.85)</td><td colspan="1" rowspan="1">&gt;= 390.46</td><td colspan="1" rowspan="1">&gt;= 391.29</td></tr><tr><td colspan="1" rowspan="1">CUDA 9.0 (9.0.76)</td><td colspan="1" rowspan="1">&gt;= 384.81</td><td colspan="1" rowspan="1">&gt;= 385.54</td></tr><tr><td colspan="1" rowspan="1">CUDA 8.0 (8.0.61 GA2)</td><td colspan="1" rowspan="1">&gt;= 375.26</td><td colspan="1" rowspan="1">&gt;= 376.51</td></tr><tr><td colspan="1" rowspan="1">CUDA 8.0 (8.0.44)</td><td colspan="1" rowspan="1">&gt;= 367.48</td><td colspan="1" rowspan="1">&gt;= 369.30</td></tr><tr><td colspan="1" rowspan="1">CUDA 7.5 (7.5.16)</td><td colspan="1" rowspan="1">&gt;= 352.31</td><td colspan="1" rowspan="1">&gt;= 353.66</td></tr><tr><td colspan="1" rowspan="1">CUDA 7.0 (7.0.28)</td><td colspan="1" rowspan="1">&gt;= 346.46</td><td colspan="1" rowspan="1">&gt;= 347.62</td></tr></tbody></table> 
<p></p> 
<p>For convenience, the NVIDIA driver is installed as part of the CUDA Toolkit installation. Note that this driver is for development purposes and is not recommended for use in production with Tesla GPUs.</p> 
<p>For running CUDA applications in production with Tesla GPUs, it is recommended to download the latest driver for Tesla GPUs from the NVIDIA driver downloads site at <a href="https://www.nvidia.com/drivers" rel="nofollow" title="Official Drivers | NVIDIA">Official Drivers | NVIDIA</a>.</p> 
<p>During the installation of the CUDA Toolkit, the installation of the NVIDIA driver may be skipped on Windows (when using the interactive or silent installation) or on Linux (by using meta packages).</p> 
<p>For more information on customizing the install process on Windows, see <a href="https://docs.nvidia.com/cuda/cuda-installation-guide-microsoft-windows/index.html#install-cuda-software" rel="nofollow" title="Installation Guide Windows :: CUDA Toolkit Documentation">Installation Guide Windows :: CUDA Toolkit Documentation</a>.</p> 
<p>For meta packages on Linux, see <a href="https://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html#package-manager-metas" rel="nofollow" title="Installation Guide Linux :: CUDA Toolkit Documentation">Installation Guide Linux :: CUDA Toolkit Documentation</a></p> 
<p></p> 
<p></p> 
<p>d.从nvidia官网(<a href="https://developer.nvidia.com/cuda-toolkit-archive" rel="nofollow" title="CUDA Toolkit Archive | NVIDIA Developer">CUDA Toolkit Archive | NVIDIA Developer</a> )下载对应版本cuda（需要注册官方账号才能下载）</p> 
<p></p> 
<p>e.从nvidia官网(<a href="https://developer.nvidia.com/rdp/cudnn-archive" rel="nofollow" title="cuDNN Archive | NVIDIA Developer">cuDNN Archive | NVIDIA Developer</a>)下载cuda对应版本cudnn，解压cuDNN的安装压缩包，得到三个文件夹和一个txt，全部复制粘贴到cuda安装目录(C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\V11.6)</p> 
<p></p> 
<p>f.安装Anaconda3-2022.05-Windows-x86_64</p> 
<p></p> 
<p>g.从官网（<a href="https://pytorch.org/get-started/locally/" rel="nofollow" title="Start Locally | PyTorch">Start Locally | PyTorch</a>）安装Pytorch</p> 
<p> </p> 
<p><img alt="" height="416" src="https://images2.imgbox.com/a7/15/Q4kpwpKL_o.png" width="831"></p> 
<p></p> 
<p>cd D:\SF\03.Win\01.Env\02.Python\Anaconda3-2022.05-Windows-x86_64-ai\Scripts</p> 
<p>pip3.exe install torch torchvision torchaudio --extra-index-url <a href="https://download.pytorch.org/whl/cu116" rel="nofollow" title="https://download.pytorch.org/whl/cu116">https://download.pytorch.org/whl/cu116</a></p> 
<p>在cmd中执行上一个命令时可能出现"Defaulting to user installation because normal site-packages is not writeable",是因为安装Anaconda3时是指定安装给所有用户使用（安装时提示获取管理员权限），而调用pip3时打开cmd是使用的当前非管理员账户。改用管理员账户打开cmd可以解决此问题。</p> 
<p>在cmd中执行上一个命令时可能出现"Can't connect to HTTPS URL because the SSL module is not available"错误提示，是因为Anaconda3的lib没有被加入到系统path环境中，在cmd中执行 set PATH=%PATH%;D:\SF\03.Win\01.Env\02.Python\Anaconda3-2022.05-Windows-x86_64-ai\Library\bin</p> 
<p>在cmd中执行上一个命令时可能出现网速慢的情况，可以给cmd设置代理，</p> 
<p>set http_proxy=<a href="http://127.0.0.1:1189/" rel="nofollow" title="http://127.0.0.1:1189">http://127.0.0.1:1189</a><br> set https_proxy=<a href="http://127.0.0.1:1189/" rel="nofollow" title="http://127.0.0.1:1189">http://127.0.0.1:1189</a></p> 
<p></p> 
<p>测试安装是否成功，进入python：</p> 
<p>import torch<br> print(torch.__version__)<br> 不报错且输出版本号即正确。</p> 
<p>torch.cuda.is_available()<br> 这可以测试cuda是否可用</p> 
<p><img alt="" height="259" src="https://images2.imgbox.com/fb/a4/7Tt9mE2R_o.png" width="795"></p> 
<p> </p> 
<p></p> 
<p></p> 
<p></p> 
<p>h.安装tensorflow    pip3.exe install tensorflow-gpu==2.9.0</p> 
<p><img alt="" height="273" src="https://images2.imgbox.com/bb/e9/ohMDkpF2_o.png" width="922"></p> 
<p> </p> 
<p></p> 
<p>测试安装是否成功</p> 
<p>&gt;&gt;&gt; import tensorflow as tf<br> &gt;&gt;&gt; print(tf.test.is_gpu_available())</p> 
<p></p> 
<p></p> 
<p><img alt="" height="466" src="https://images2.imgbox.com/4e/80/D8ZyoA2k_o.png" width="972"></p> 
<p> </p> 
<p></p> 
<p>3.FQA</p> 
<p>3.1.conda环境中通过pip安装包时提示文件名过长</p> 
<p>Enable Long Paths in Windows 10</p> 
<p>Windows Registry Editor Version 5.00</p> 
<p>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem]<br> "LongPathsEnabled"=dword:00000001</p> 
<p></p> 
<p>3.2.在conda环境中通过conda安装包失败</p> 
<p>     可以尝试使用pip安装</p> 
<p>3.3.conda环境中通过pip安装包时提示“ClobberError: This transaction has incompatible packages due to a shared path”，</p> 
<p>      pip安装tensorflow-gpu后提示"cudart64_101.dll not found"</p> 
<p>    修改用户目录中的文件C:\Users\yu\.condarc，</p> 
<p>channels:<br> - defaults</p> 
<p>将channels修改如下</p> 
<p>channels:<br> - conda-forge</p> 
<p></p> 
<p>3.4.Anaconda3安装时，可以指定“给当前用户”；否则使用Anaconda3的软件必须以管理员身份运行</p> 
<p></p> 
<p>3.5.cmd设置或修改环境变量</p> 
<p>set PATH=%PATH%;D:\SF\03.Win\01.Env\02.Python\Anaconda3-2022.05-Windows-x86_64-3.9.12\envs\conda-py-3.7\Library\bin</p> 
<p></p> 
<p>set PATH=%PATH%;D:\SF\03.Win\01.Env\02.Python\Anaconda3-2022.05-Windows-x86_64-3.9.12\Library\bin<br> set PATH=%PATH%;D:\SF\03.Win\01.Env\02.Python\Anaconda3-2022.05-Windows-x86_64-3.9.12-jm\Library\bin</p> 
<p></p> 
<p>3.6.cmd设置proxy</p> 
<p>set https_proxy=<a href="http://127.0.0.1:8002/" rel="nofollow" title="http://127.0.0.1:8002">http://127.0.0.1:8002</a><br> set http_proxy=<a href="http://127.0.0.1:8002/" rel="nofollow" title="http://127.0.0.1:8002">http://127.0.0.1:8002</a></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/16e3610b4563ae143b9caa38ae08f6f0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">gee引擎修改UI界面图文教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ec1ab0e2c2bb3e73ee2faf91ace50990/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ESXI中安装windows2019&#43;NVIDIA-GRID-VGPU后VmwareWorkstation访问该虚拟机黑屏问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>