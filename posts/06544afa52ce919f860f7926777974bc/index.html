<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Mysql 高阶自定义排序 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Mysql 高阶自定义排序" />
<meta property="og:description" content="（一）FIELD函数实现 FIELD()函数返回值列表中值的索引位置，语法：FIELD(value, val1, val2, val3, ...)，简单的说：改函数就是返回value在集合(val1,val2,val3，...)中对应的索引位置，结合上面的需求,是不是可以这样来使用，学生表stage值就映射函数的value,(初中、高总、大学)就映射函数的值列表集合，如果学生.stage=初中，返回值不是就是1；学生.stage=高中，返回值不是就是2；学生.stage=大学，返回值不是就是3，在对结果值排一个序，不就满足要求了嘛，话不多说上代码：
SELECT id,name,stage FROM `user` ORDER BY FIELD(stage,&#34;初中&#34;,&#34;高中&#34;,&#34;大学&#34;) asc; （二）LOCATE函数实现 FIELD(substr,str,pos)函数返回字符串substr在str中第一次出现的位置，pos可空，表示开始坐标，例如：
SELECT LOCATE(&#34;初中&#34;,&#34;初中,高中,大学&#34;);--返回1 SELECT LOCATE(&#34;高中&#34;,&#34;初中,高中,大学&#34;);--返回2 SELECT LOCATE(&#34;大学&#34;,&#34;初中,高中,大学&#34;);--返回3 这不就正好满足上述需求嘛，话不多说上代码：
SELECT id,name,stage FROM `user` ORDER BY LOCATE(stage,&#34;初中,高中,大学&#34;) asc; （三）INSTR函数实现 INSTR(str,substr)函数返回字符串str中substr第一次出现的位置，例如：
SELECT INSTR(&#34;初中,高中,大学&#34;,&#34;初中&#34;);-- 返回1 SELECT INSTR(&#34;初中,高中,大学&#34;,&#34;高中&#34;);-- 返回2 SELECT INSTR(&#34;初中,高中,大学&#34;,&#34;大学&#34;);-- 返回3 这不就正好满足上述需求嘛，话不多说上代码：
SELECT id,name,stage FROM `user` ORDER BY INSTR(&#34;初中,高中,大学&#34;,stage) asc; （四）CASE WHEN语句实现 CASE WHEN简单的说就是根据不同的条件将其转换为指定的值，比如：根据stage 的不同值转换为对应的数字，在对结果排序满足要求了，话不多说上代码：
SELECT id,name,stage FROM `user` ORDER BY CASE stage WHEN &#34;初中&#34; THEN 1 WHEN &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/06544afa52ce919f860f7926777974bc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-10T22:06:44+08:00" />
<meta property="article:modified_time" content="2023-11-10T22:06:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Mysql 高阶自定义排序</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>（一）<strong>FIELD函数实现</strong></h4> 
<p><span style="color:#ff9900;"><strong>FIELD()函数返回值列表中值的索引位置，语法：FIELD(value, val1, val2, val3, ...)，简单的说：改函数就是返回value在集合(val1,val2,val3，...)中对应的索引位置，结合上面的需求,是不是可以这样来使用，学生表stage值就映射函数的value,(初中、高总、大学)就映射函数的值列表集合，如果学生.stage=初中，返回值不是就是1；学生.stage=高中，返回值不是就是2；学生.stage=大学，返回值不是就是3，在对结果值排一个序，不就满足要求了嘛，话不多说上代码：</strong></span></p> 
<pre><code class="language-sql">SELECT id,name,stage FROM `user` ORDER BY FIELD(stage,"初中","高中","大学") asc;</code></pre> 
<p><img alt="" height="488" src="https://images2.imgbox.com/54/1a/9VEVJVdQ_o.png" width="296"></p> 
<h4>（二）<strong>LOCATE函数实现</strong></h4> 
<p><span style="color:#ff9900;"><strong>FIELD(substr,str,pos)函数返回字符串substr在str中第一次出现的位置，pos可空，表示开始坐标，例如：</strong></span></p> 
<pre><code class="language-sql">SELECT LOCATE("初中","初中,高中,大学");--返回1
SELECT LOCATE("高中","初中,高中,大学");--返回2
SELECT LOCATE("大学","初中,高中,大学");--返回3</code></pre> 
<p>这不就正好满足上述需求嘛，话不多说上代码：</p> 
<pre><code class="language-sql">SELECT id,name,stage FROM `user` ORDER BY LOCATE(stage,"初中,高中,大学") asc;</code></pre> 
<p><img alt="" height="505" src="https://images2.imgbox.com/5a/e5/aoFn2TXj_o.png" width="831"></p> 
<h4>（三）<strong>INSTR函数实现</strong></h4> 
<p><span style="color:#ff9900;"><strong>INSTR(str,substr)函数返回字符串str中substr第一次出现的位置，例如：</strong></span></p> 
<pre><code class="language-sql">SELECT INSTR("初中,高中,大学","初中");-- 返回1
SELECT INSTR("初中,高中,大学","高中");-- 返回2
SELECT INSTR("初中,高中,大学","大学");-- 返回3</code></pre> 
<p>这不就正好满足上述需求嘛，话不多说上代码：</p> 
<pre><code class="language-sql">SELECT id,name,stage FROM `user` ORDER BY INSTR("初中,高中,大学",stage) asc;</code></pre> 
<p><img alt="" height="499" src="https://images2.imgbox.com/14/58/cg87IxJv_o.png" width="830"></p> 
<h4>（四）<strong>CASE WHEN语句实现</strong></h4> 
<p><span style="color:#ff9900;"><strong>CASE WHEN简单的说就是根据不同的条件将其转换为指定的值，比如：根据stage 的不同值转换为对应的数字，在对结果排序满足要求了，话不多说上代码：</strong></span></p> 
<pre><code class="language-sql">SELECT id,name,stage FROM `user` ORDER BY
 
CASE stage
 
   WHEN "初中" THEN 1
 
WHEN "高中" THEN 2
 
WHEN "大学" THEN 3
 
   ELSE 4 END  asc;</code></pre> 
<p><img alt="" height="851" src="https://images2.imgbox.com/06/de/loFBFwZk_o.png" width="608"></p> 
<h4>（五）<strong>数据表字典实现</strong></h4> 
<p><span style="color:#ff9900;"><strong>数据表字典思路就是需要单独建立一个stage 的值映射对应关系表，最后通过关联查询，并对根据映射值排序，正好能够满足上述要求，话不多说上代码：</strong></span></p> 
<pre><code class="language-sql">SELECT u.id,u.name,u.stage FROM `user` as u 
 
JOIN stage_dic as sd on u.stage = sd.stage
 
ORDER BY sd.code asc;</code></pre> 
<p><img alt="" height="653" src="https://images2.imgbox.com/c9/12/LuZmL6Ni_o.png" width="689"></p> 
<p><span style="color:#fe2c24;"><strong>通过上面的5种排序，都能够解决问题引入提到的自定义排序需求。这5种排序，既有相同的应用场景，也有各自不同的应用场景，在实际使用中还需要根据实际情况选择不同的排序方式，下面对其做一个简单的总结：</strong></span></p> 
<ol><li><span style="color:#fe2c24;"><strong>针对简单枚举值皆可实现，数字表字典更灵活</strong></span></li><li><span style="color:#fe2c24;"><strong>LOCATE与INSTR最终效果一致，参数颠倒，INSTR区分大小写，LOCATE不区分大小写</strong></span></li><li><span style="color:#fe2c24;"><strong>函数虽好，使用需要谨慎，能够在存储时就处理好数据，就不要在查询时通过函数计算来解</strong></span></li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1312f5a3674e7ab8f341d76dd71f2fec/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">通过usb接口串口发送接收数据的android程序</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5fb5fe0c0fe7f5d10df5b1cefd366c7b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Rust】十分钟睡前开发 —— URL Shortener by Shuttle</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>