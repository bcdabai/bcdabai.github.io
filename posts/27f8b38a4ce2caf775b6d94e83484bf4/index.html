<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>unity3d 开发笔记 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="unity3d 开发笔记" />
<meta property="og:description" content="unity Unity是一个游戏引擎(类似于软件开发的框架)，它包含渲染引擎，物理引擎，碰撞检测，音效，动画效果，场景管理等功能，可以开发2d游戏，一般是用来开发3d游戏。它的开发效率高、脚本使用C#开发、简单易用、跨平台（可以导出各个平台的程序）。当然还有别的游戏引擎比如虚幻引擎俗称UE (Unreal Engine），使用C&#43;&#43;开发脚本，3A大作首选，好多游戏公司都有自己的游戏引擎，下边放一个Unity软件的大图。本人感觉，这个软件还是比较好学习的，比单纯的软件开发有意思的多。
介绍 project面板放游戏资源，hierarcy放游戏对象，inspector显示当前游戏对象和属性信息component组件代表游戏对象的某个功能，所有游戏对象都有transform组件目录下的Assets是最重要的，别的可以不要直接安装unity就可以，也可以不用安装 unity hub（此软件用来管理多个unity editor）ProjectSettings\ProjectVersion.txt 查看项目的unity版本unity package file， unity可以直接导入，类似zip文件，可以右键export package生成，主要使用的unity版本尽量一致 操作 最右上角，面板 layout，选择 2 by 3project面板 右键 one column layoutQ &#43; 鼠标左键（按鼠标滚轮），可以移动scenealt &#43; 右键，缩放视图alt &#43; 左（同只按右键），旋转视图右键 &#43; w a s d q e，场景漫游(不同方向)选择物体，然后按F，视图以物体为中心来居中，或者在hierarcy双击游戏对象也可以选择游戏对象，ctrl &#43; d 可以快速复制一个z轴是正对人的放心，x轴是水平方向，y轴是垂直方向游戏运行时改的值，可以copy component，然后结束调试paste值即可。 视图模式 视图有两种模式，ISO正交模式（2d效果）和 Pers透视模式（近大远小效果）。
坐标系 世界坐标，全局不变的坐标（只有唯一的原点）本地坐标，物体自身坐标，随着旋转而变化
unit使用左手坐标系（左手做成数字8，中指指向自己即可）
场景 场景 scene，是相关联的一组游戏对象的集合，比如一个地图或者游戏的某一关，在scenes文件下，后缀名是 .unity 双击此文件可打开项目。新建的游戏对象，默认在当前视图的场景中间。场景默认自带Main Camera，和Directional Light两个东西。
GameObject 游戏对象，hierachy中的每个对象都是GameObject的子类，都有transform属性。Plane只有正面没有反面，quad相似，只不过是竖着的。任何物体都是三角形拼出来的。
PreFab 预制件 如果在Hierachy面板中，要把一个游戏对象变成模板，直接拖到 Project面板即可，修改PreFab的属性就会影响所有的游戏对象。如果要批量创建模型，最好放到预制件里。
复制参数 如图，如果要复制这些参数给别的组件使用，可以点这里，选择 copy componnet，
然后在新的组件再点这里，选择 Paste Component Values。
保存参数 比如，如果要保存这个transform的参数，给别的项目使用或者给别的组价使用，可以点这里" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/27f8b38a4ce2caf775b6d94e83484bf4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-19T09:30:25+08:00" />
<meta property="article:modified_time" content="2023-12-19T09:30:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">unity3d 开发笔记</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="unity_1"></a>unity</h2> 
<p>Unity是一个游戏引擎(类似于软件开发的框架)，它包含渲染引擎，物理引擎，碰撞检测，音效，动画效果，场景管理等功能，可以开发2d游戏，一般是用来开发3d游戏。它的开发效率高、脚本使用C#开发、简单易用、跨平台（可以导出各个平台的程序）。当然还有别的游戏引擎比如<strong>虚幻引擎</strong>俗称UE (<code>Unreal Engine</code>），使用C++开发脚本，3A大作首选，好多游戏公司都有自己的游戏引擎，下边放一个Unity软件的大图。本人感觉，这个软件还是比较好学习的，比单纯的软件开发有意思的多。</p> 
<p><img src="https://images2.imgbox.com/ec/fd/RpLbq4zs_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_6"></a>介绍</h3> 
<ul><li>project面板放游戏资源，hierarcy放游戏对象，inspector显示当前游戏对象和属性信息</li><li>component组件代表游戏对象的某个功能，所有游戏对象都有<code>transform</code>组件</li><li>目录下的<code>Assets</code>是最重要的，别的可以不要</li><li>直接安装unity就可以，也可以不用安装 <code>unity hub</code>（此软件用来管理多个unity editor）</li><li><code>ProjectSettings\ProjectVersion.txt</code> 查看项目的unity版本</li><li>unity package file， unity可以直接导入，类似zip文件，可以右键export package生成，主要使用的unity版本尽量一致</li></ul> 
<h3><a id="_14"></a>操作</h3> 
<ul><li><strong>最右上角，面板 layout，选择 2 by 3</strong></li><li><strong>project面板 右键 one column layout</strong></li><li>Q + 鼠标左键（按鼠标滚轮），可以移动scene</li><li>alt + 右键，缩放视图</li><li>alt + 左（同只按右键），旋转视图</li><li>右键 + w a s d q e，场景漫游(不同方向)</li><li>选择物体，然后按F，视图以物体为中心来居中，或者在hierarcy双击游戏对象也可以</li><li>选择游戏对象，ctrl + d 可以快速复制一个</li><li>z轴是正对人的放心，x轴是水平方向，y轴是垂直方向</li><li>游戏运行时改的值，可以copy component，然后结束调试paste值即可。</li></ul> 
<h3><a id="_25"></a>视图模式</h3> 
<p><img src="https://images2.imgbox.com/37/95/4K18ZFiT_o.png" alt="在这里插入图片描述"></p> 
<p>视图有两种模式，ISO正交模式（2d效果）和 Pers透视模式（近大远小效果）。</p> 
<h3><a id="_30"></a>坐标系</h3> 
<ul><li>世界坐标，全局不变的坐标（只有唯一的原点）</li><li>本地坐标，物体自身坐标，随着旋转而变化<br> unit使用左手坐标系（左手做成数字8，中指指向自己即可）<br> <img src="https://images2.imgbox.com/83/b2/AQMmvpRt_o.png" alt="在这里插入图片描述"></li></ul> 
<h3><a id="_37"></a>场景</h3> 
<p>场景 scene，是相关联的一组游戏对象的集合，比如一个地图或者游戏的某一关，在scenes文件下，后缀名是 <code>.unity</code> 双击此文件可打开项目。新建的游戏对象，默认在当前视图的场景中间。场景默认自带<code>Main Camera</code>，和<code>Directional Light</code>两个东西。</p> 
<h3><a id="GameObject_40"></a>GameObject</h3> 
<p>游戏对象，hierachy中的每个对象都是GameObject的子类，都有transform属性。Plane只有正面没有反面，quad相似，只不过是竖着的。任何物体都是三角形拼出来的。</p> 
<h3><a id="PreFab__43"></a>PreFab 预制件</h3> 
<p>如果在Hierachy面板中，要把一个游戏对象变成模板，直接拖到 Project面板即可，修改PreFab的属性就会影响所有的游戏对象。如果要批量创建模型，最好放到预制件里。<br> <img src="https://images2.imgbox.com/72/88/kxgKhUQ8_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_46"></a>复制参数</h3> 
<p><img src="https://images2.imgbox.com/8e/6e/5kh0BK19_o.png" alt="在这里插入图片描述"><br> 如图，如果要复制这些参数给别的组件使用，可以点这里，选择 copy componnet，<br> 然后在新的组件再点这里，选择 Paste Component Values。</p> 
<h3><a id="_52"></a>保存参数</h3> 
<p><img src="https://images2.imgbox.com/fc/e5/eA9M4agD_o.png" alt="在这里插入图片描述"><br> 比如，如果要保存这个transform的参数，给别的项目使用或者给别的组价使用，可以点这里</p> 
<p><img src="https://images2.imgbox.com/5f/47/aiW4kaYB_o.png" alt="在这里插入图片描述"><br> 点save，会保存为一个文件</p> 
<p><img src="https://images2.imgbox.com/62/23/bBYDpve6_o.png" alt="在这里插入图片描述"><br> 可以在别的组件直接使用这个transform的参数，而不用手动输入了。</p> 
<h3><a id="Scripts_62"></a>Scripts</h3> 
<p>创建脚本，不用的方法，最好删除。<br> 每个脚本的执行没有顺序的，脚本可以设置执行优先级，选中脚本，然后点击右侧按钮。<br> <img src="https://images2.imgbox.com/66/c7/wFJr8fRD_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/77/86/zHJFagVa_o.png" alt="在这里插入图片描述"><br> 可以选择一个脚本作为主控脚本。<br> 脚本的参数,要 public才行，也可以添加 tooltip<br> <img src="https://images2.imgbox.com/e0/4c/ZYMHyLlx_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Planet</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
  <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Tooltip</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"帧数"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
  <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> frame <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span>

  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
    Application<span class="token punctuation">.</span>targetFrameRate <span class="token operator">=</span> frame<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">Rotate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">30</span> <span class="token operator">*</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>参数设置优先级， 默认 &lt; 编辑器 &lt; Awake &lt; start</p> 
<h3><a id="mesh_90"></a>mesh</h3> 
<p>网格，<code>mesh filter</code>可以改变物体的形状。<br> <img src="https://images2.imgbox.com/21/62/cV1x1Cy9_o.png" alt="在这里插入图片描述"><br> <code>Mesh Renderer</code> 渲染物体，可以改变材质，两个组合在一起才能显示物体。可以创建空物体，自行添加，这两个组件，让物体显示。<br> <img src="https://images2.imgbox.com/21/1f/fO537Tky_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_97"></a>群组父子结构</h3> 
<p>如果要组合两个对象，在<code>hierachy</code>面板，一个拖到另一个就可以。也可以创建几个空模型作为父对象，其他的拖进来。这时候子模型的坐标就是相对坐标了，相对父模型的坐标，可以使用<code>transform</code>组件的<code>reset</code>功能重置，会更好。如果后续模型更新，如果把组件都挂在模型上，就要重新替换，所以建议新建一个空物体作为父模型，把所有行为都给父模型即可。</p> 
<h3><a id="_material_100"></a>材质 material</h3> 
<p>物体的质地，比如色彩、纹理、透明度等，实际就是shader的实例。<br> 纹理（texture）就是附加到物体表面的贴图。材质要给到 <code>Mesh Renderer</code>。<br> 在Assets目录下新建Textures目录，放置贴图图片，可以直接拖到game object上，unity会自动生成一个材质。<br> <img src="https://images2.imgbox.com/6d/ef/pW64zvbh_o.png" alt="在这里插入图片描述"><br> <strong>Albedo</strong><br> 基础贴图，决定物体纹理和颜色</p> 
<p><strong>Rendering mode</strong></p> 
<p>材质的渲染模式 ( <code>Rendering mode</code> ) 默认是 opaque（不透明的），fade（渐变，淡入淡出）</p> 
<p>cutput （镂空，透明通道去掉，只剩下不透明的）<br> <img src="https://images2.imgbox.com/fd/2e/n9iuRq3s_o.png" alt="在这里插入图片描述"></p> 
<p>transparent（透明的，需要设置albedo的颜色的a值）<br> <img src="https://images2.imgbox.com/96/95/r1BN7DP2_o.png" alt="在这里插入图片描述"></p> 
<p><strong>Metallic</strong><br> 使用金属模拟外观</p> 
<p><strong>Specular</strong><br> 镜面反射</p> 
<p><strong>Smothless</strong><br> 光滑度，设置物体表面光滑程度</p> 
<p><strong>Normal Map</strong><br> 法线贴图，物体表面凹凸程度</p> 
<p><strong>Emission</strong><br> 自发光，控制物体表面自发光颜色和贴图。</p> 
<h3><a id="shader_135"></a>shader</h3> 
<p>材质的本质是shader的实例，shader是专门用来渲染3d图形的技术，可以使纹理以某种方式展现，就是一种嵌入到渲染管线的程序，控制GPU运行效果的算法。材质的属性和设置，是由shader决定的。</p> 
<p><img src="https://images2.imgbox.com/0a/46/qO8PfS2E_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_141"></a>场景下的绘图模式</h3> 
<p>Shaded着色模式（默认模式）所有游戏对象的贴图都正常显示<br> Wireframe网格线框显示模式以网格线框形式显示所有对象<br> Shaded Wireframe着色模式线框以贴图加网格线框形式显示对象<br> Shadow Cascades阴影级联以阴影方式显示对象<br> Render Paths渲染路径显示模式以渲染路径的形式显示<br> Alpha ChannelAlpha通道显示以灰度图的方式显示所有对象<br> Overdraw以半透明方式显示以半透明的方式显示所有对象<br> MipmapsMIP映射图显示以MIP映射图方式显示所有对象</p> 
<h3><a id="_151"></a>光照</h3> 
<p>平行光，像太阳，从一个方向过来照亮全景<br> 点光，一个点发射光线，并减弱<br> 聚光，某个方向照射，有范围限制<br> 范围光，一个区域内的光，没有方向<br> 实时光照和烘焙光照，后者就是开发时把光照计算好，在游戏运行时，直接使用图片产物，提升性能。<br> 一般场景为了真实，会有几个光源，因为有漫反射的存在，没有绝对黑的物体的面。<br> 很多游戏没有阴影，因为实时渲染影响非常消耗资源。<br> 比如范围灯光，看不出效果，可以烘焙看一下，windows -&gt; rendering -&gt; lighting<br> <img src="https://images2.imgbox.com/10/db/B477hBLa_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_163"></a>粒子系统</h3> 
<p>可以实现硝烟，火焰，雪花，水汽，爆炸效果。右键Effects -&gt; Particle System来创建。也可以从网上下载现成的使用。</p> 
<h3><a id="_166"></a>渲染管线</h3> 
<p><strong>渲染管线执行一系列操作来获取场景的内容，并将这些内容显示在屏幕上。</strong></p> 
<p>在 Unity 中，可以选择不同的渲染管线。Unity 提供了三个具有不同功能和性能特征的预构建渲染管线，您也可以创建自己的渲染管线。</p> 
<p>渲染3D物体需要考虑物体着色、光照计算、环境光、阴影计算,、传递哪些数据、 自定义的Shader等，渲染管线，就是定义了处理这些的原理原则,在这些原则下渲染游戏场景中的物体。</p> 
<p>Unity的渲染管线分为3大类渲染管线: 1是向前渲染管线，2是延时渲染管线，3是可编程渲染管线; 1和2是Unity引擎内置的渲染管线，来处理整个场景的绘制和渲染相关机制，3允许开发者自己定义，这样能获得更好的灵活性和效率。</p> 
<p>比如向前渲染管线，每个重要光源，都要经过一次Pass,来渲染一次物体,不重要的光源，在ForwardBase里面计算等，而延时渲染就是先把所有的光照计算出来，最后再渲染(“延时”)。不同的渲染管线，对应的技术处理的策略不一样。</p> 
<p>1、默认渲染管线。默认渲染管线就是你不装LWRP、UPR、HDRP这些管线，Unity本来就内置的管线。这个管线只是Unity对底层渲染API(如OpenGL等)做了简单封装搞出来的，并且当时Unity并没有去考虑这个管线的可定制性。尽管可以用CommandBuffer和一些渲染时的回调来对这个管线的渲染流程做一些修改，但个人感觉都是些比较骚的操作，搞出来的东西稳定性不是很好。所以默认渲染管线的问题就是死板。</p> 
<p>2、SRP。即可编程渲染管线。这玩意相当于是对默认渲染管线又做了层封装，并暴露给用户。这大大提高了渲染管线的可定制性。SRP把渲染管线细分成一个个模块和过程，你只需要按照自己的需求去组装和重写即可。比如我用SRP可以先渲染出场景中一部分物体，然后做个后处理，再渲染剩下的物体，在做其它后处理等等。</p> 
<p>2、LWRP。这玩意就是Unity用SRP给你写的一个渲染管线。如果用户觉得自己没有太多的渲染管线定制需求，也不想花很多时间在管线的编写上的用户，那直接就可以用这个LWRP来替代默认渲染管线。并且LWRP也具有一定的可定制性。</p> 
<p>3、URP。就是LWRP的升级版。给LWRP改改BUG、优化些体验、用些底层新特性、提高渲染质量这样。</p> 
<h2><a id="_184"></a>脚本开发</h2> 
<ul><li>Unity是一个Component-Based的引擎，所有物体都是GameObject。</li><li>Time，Input，Physics都是Unity中的全局变量。</li><li>MonoBehaviour 是 Unity 中所有脚本的基类。</li></ul> 
<h3><a id="_189"></a>基础和总结</h3> 
<ul><li>window -&gt; general 显示 console 控制台</li><li>关于注释， <code>///</code> 会被编译，<code>//</code> 不会。所以使用<code>///</code>会减慢编译的速度（但不会影响执行速度）且在其它的人调用你的代码时提供智能感知。</li><li>#region 是 C# 预处理器指令。就是将复杂的代码块折叠，是界面看起来整洁一些。</li><li>一般使用一个空物体，标记一个坐标，或者挂载一个功能脚本。</li></ul> 
<h3><a id="_194"></a>向量</h3> 
<p>定义，有方向和长度的量，叫做向量（数学学的）。Unity里有Vector2和Vector3等。<br> 一般使用Vector3，两个向量可以直接相加减。</p> 
<pre><code class="prism language-csharp"><span class="token class-name">Vector3</span> v <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 向量长度</span>
v<span class="token punctuation">.</span>magnitude<span class="token punctuation">;</span>
</code></pre> 
<p>单位向量，长度为1的向量。</p> 
<pre><code class="prism language-csharp"><span class="token comment">// 标准化v,返回v1是单位向量</span>
<span class="token class-name"><span class="token keyword">var</span></span> v1 <span class="token operator">=</span> v<span class="token punctuation">.</span>normalized<span class="token punctuation">;</span>
</code></pre> 
<p>常用的常量比如 <code>vector3.forward</code> 代表 （0,0,1）等<br> 求两个向量的距离<code>vector3.Distance</code></p> 
<h3><a id="GameObjectComponent_210"></a>GameObject和Component</h3> 
<p>GameObject是游戏场景中真实存在的，而且有位置的一个物件。Component附属于GameObject，控制GameObject的各种属性。GameObject是由Component组合成的，Component的生命周期和GameObject息息相关。调用此GameObject的Destroy方法，它的子对象和对应的所有Component都会被销毁，但也可以一次只销毁一个Component。常用的组件如下表所示</p> 
<table><thead><tr><th>Component</th><th>作用</th></tr></thead><tbody><tr><td>RigidBody 刚体</td><td>使物体能在物理控制下运动</td></tr><tr><td>Collider 碰撞器</td><td>和RigidBody刚体一起使碰撞发生，没有Collider，两个碰撞的刚体会相互穿透</td></tr><tr><td>Renderer 渲染器</td><td>使物体显示在屏幕上</td></tr><tr><td>AudioSource 音频源</td><td>使物体在scence场景播放音频</td></tr><tr><td>Animation 动画</td><td></td></tr><tr><td>Animator 动画控制器</td><td></td></tr></tbody></table> 
<p>脚本也是组件，因此能附到游戏对象上。常用的组件可以通过简单的成员变量获取，附在游戏对象上的组件或脚本可以通过GetComponent获取。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">example</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span> <span class="token punctuation">{<!-- --></span>
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        transform<span class="token punctuation">.</span><span class="token function">Translate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Transform<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Translate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>获取某个组件，可以直接把引用给脚本即可</strong>。</p> 
<h3><a id="_235"></a>语法结构</h3> 
<ul><li>文件名必须和类型相同，建议首字母大写</li><li>脚本必须附加到物体上才可以执行</li><li>附加到物体上的类必须继承 <code>MonoBehaviour</code></li><li>删除类中没用的空方法</li></ul> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WeatherParticle</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>

</code></pre> 
<p>下边是一个脚本的demo</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Ball</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 游戏开始运行的时候执行，适合做初始化</span>
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"组件执行开始！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        transform<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2.5f</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">// 每帧都会执行，不同设备的频率不一样</span>
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"当前游戏进行时间："</span> <span class="token operator">+</span> Time<span class="token punctuation">.</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 每次帧移动 1.5 </span>
        transform<span class="token punctuation">.</span><span class="token function">Translate</span><span class="token punctuation">(</span><span class="token number">1.5f</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token comment">// 如果要保证每秒移动距离相同,Time.deltaTime是两个帧的间隔</span>
   		transform<span class="token punctuation">.</span><span class="token function">Translate</span><span class="token punctuation">(</span><span class="token number">1.5</span> <span class="token operator">*</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>获取位置</p> 
<pre><code class="prism language-csharp"><span class="token comment">// 获取纵轴输入和横轴输入</span>
<span class="token comment">// wsad和上下左右键的输入</span>
<span class="token class-name"><span class="token keyword">float</span></span> v <span class="token operator">=</span> Input<span class="token punctuation">.</span><span class="token function">GetAxis</span><span class="token punctuation">(</span><span class="token string">"Vertical"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">float</span></span> h <span class="token operator">=</span> Input<span class="token punctuation">.</span><span class="token function">GetAxis</span><span class="token punctuation">(</span><span class="token string">"Horizontal"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"纵轴输入"</span><span class="token operator">+</span>v<span class="token operator">+</span><span class="token string">"横轴输入"</span> <span class="token operator">+</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>
transform<span class="token punctuation">.</span><span class="token function">Translate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> h <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">*</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">,</span>  v <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">*</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>触发和碰撞</p> 
<pre><code class="prism language-csharp"><span class="token comment">// 1. 增加一个立方体，在 box collider上勾选 is trigger</span>
<span class="token comment">// 2. 给球体增加一个刚体组件,（add component -&gt; pyhsicis -&gt; rigidbody）勾选 </span>
<span class="token comment">// 3. 使用前边的小球撞立方体，给立方体挂一个脚本</span>

<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Coin</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//触发开始事件OnTriggerEnter</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnTriggerEnter</span><span class="token punctuation">(</span><span class="token class-name">Collider</span> other<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"碰到了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnTriggerStay</span><span class="token punctuation">(</span><span class="token class-name">Collider</span> other<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"碰撞持续中"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnTriggerExit</span><span class="token punctuation">(</span><span class="token class-name">Collider</span> other<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"碰撞结束"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_307"></a>编译过程</h3> 
<p>源代码 - CLS - 中间语言 - Mono Runtime - 机器码</p> 
<h3><a id="cs_310"></a>修改默认cs模板</h3> 
<p>打开编辑器的目录，比如我的是<br> <code>D:\apps\unity-editor\2021.3.29f1c1\Editor\Data\Resources\ScriptTemplates</code><br> 打开 <code>81-C# Script-NewBehaviourScript.cs.txt</code> 修改即可</p> 
<h3><a id="_315"></a>脚本生命周期（消息方法）</h3> 
<p>也叫必然事件/消息，脚本从唤醒到销毁的过程。附加到游戏对象上，控制游戏行为。<br> 在class中声明的可见的成员变量（private不可见），在unity软件中可见也可以修改，并且这个优先级高，以为在unitu中这是一个对象。<strong>不要在脚本中写构造函数</strong>。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo1</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span> 
	<span class="token comment">// 加上这个，虽然是public在unity也不可见</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HideInInspector</span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> speed <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 虽然私有，但是在unity可见</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">SerializeField</span></span><span class="token punctuation">]</span>
    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> speed1 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

	<span class="token comment">// 字段定义数值范围 </span>
	<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Range</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> speed2 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

  	<span class="token comment">// 执行时机，渲染帧执行，每次渲染时执行，执行间隔不固定和设备性能和渲染量有关</span>
    <span class="token comment">// 适用性: 处理游戏逻辑</span>
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">float</span></span> v <span class="token operator">=</span> Input<span class="token punctuation">.</span><span class="token function">GetAxis</span><span class="token punctuation">(</span><span class="token string">"Vertical"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">float</span></span> h <span class="token operator">=</span> Input<span class="token punctuation">.</span><span class="token function">GetAxis</span><span class="token punctuation">(</span><span class="token string">"Horizontal"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        transform<span class="token punctuation">.</span><span class="token function">Translate</span><span class="token punctuation">(</span>h <span class="token operator">*</span> speed <span class="token operator">*</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> v <span class="token operator">*</span> speed <span class="token operator">*</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">// 固定时间更新，</span>
    <span class="token comment">// 适用性：适用游戏对象做物理操作，比如移动等，默认为0.02s,不会受到渲染影响</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">FixedUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>


    <span class="token punctuation">}</span>

    <span class="token comment">// 延迟更新，适用于跟随逻辑</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LateUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span>



    <span class="token comment">// 开始时被调用</span>
    <span class="token comment">// 创建游戏物体，立即执行</span>
    <span class="token comment">// 在脚本被禁言仍然可以执行</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"awake"</span> <span class="token operator">+</span> Time<span class="token punctuation">.</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"lll"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Awake之后执行</span>
    <span class="token comment">// 创建游戏物体，脚本启用才执行</span>
    <span class="token comment">// 如果此脚本被挂在多个游戏对象上，先执行所有的awake，再执行所有的start</span>
    <span class="token comment">// this.name 游戏对象的名字</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>

        <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        speed <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"Start"</span> <span class="token operator">+</span> Time<span class="token punctuation">.</span>time <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// unity内置随机数</span>
        <span class="token class-name"><span class="token keyword">int</span></span> b <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name"><span class="token keyword">int</span></span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span><span class="token punctuation">(</span>a <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//我们将obj1初始化为一个Cube立方体，当然我们也可以初始化为其他的形状</span>
            <span class="token class-name">GameObject</span> obj1 <span class="token operator">=</span> GameObject<span class="token punctuation">.</span><span class="token function">CreatePrimitive</span><span class="token punctuation">(</span>PrimitiveType<span class="token punctuation">.</span>Cube<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//设置物体的位置Vector3三个参数分别代表x,y,z的坐标数</span>
            obj1<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span>  a <span class="token operator">*</span> <span class="token number">1.3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//给这个创建出来的对象起个名字</span>
            obj1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"dujia"</span> <span class="token operator">+</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
            a<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


		<span class="token comment">//设置物体的tag值，在赋值之前要在Inspector面板中注册一个tag值</span>
		<span class="token comment">//注册tag值得方法，用鼠标选中摄像机对象在Inspector面板中找到tag，选addtag</span>
		<span class="token comment">// obj1.tag = "shui";</span>
		<span class="token comment">//设置物体贴图要图片文件放在(Resources）文件夹下，没有自己创建</span>
		<span class="token comment">// obj1.renderer.material.mainTexture = (Texture)Resources.Load("psb20");</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnMouseEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"OnMouseEnter"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnMouseExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"OnMouseExit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnMouseDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// print(this.activeSelf);</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"OnMouseDown"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnMouseUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"OnMouseUp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 当物体在相机不可见时</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnBecameInvisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        
    <span class="token punctuation">}</span>

    <span class="token comment">// 当物体在相机可见时</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnBecameVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        
    <span class="token punctuation">}</span>

    <span class="token comment">// 销毁时</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        
    <span class="token punctuation">}</span>

    <span class="token comment">// 程序结束时</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnApplicationQuit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/19/09/bKkSFNhw_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_444"></a>消息调用</h3> 
<p>比如点击屏幕，让cube移动，cube上有个脚本 <code>cube.cs</code>，上面有<code>move1</code>的方法，另外一个脚本 <code>control.ts</code> 有cube这个游戏对象的引用，那么就可以直接这么写</p> 
<pre><code>cube.sendMessage("move1");
</code></pre> 
<p>如果没有这个方法名会报错。</p> 
<h3><a id="debug_451"></a>debug</h3> 
<ul><li>这两种log是等价的，在继承monohavior的情况下，测试环境可以加，生产环境需要删除。</li></ul> 
<pre><code class="prism language-csharp">  <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{<!-- --></span>
       Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"awake"</span> <span class="token operator">+</span> Time<span class="token punctuation">.</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
</code></pre> 
<ul><li>使用类的成员变量，在inspector面板可以实时看到这个数据的变化。</li></ul> 
<h3><a id="_464"></a>重要的类</h3> 
<p><img src="https://images2.imgbox.com/76/40/zZl08tMU_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="Component_467"></a>Component</h3> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ComDemo</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// OnGUI是Unity中通过代码驱动的GUI系统</span>
    <span class="token comment">// 主要用来创建调试工具、创建自定义属性面板、创建新的Editor窗口和工具达到扩展编辑器效果</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 左上角创建一个按钮</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>GUILayout<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 点击按钮的行为</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ok"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MeshRenderer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>material<span class="token punctuation">.</span>color <span class="token operator">=</span> Color<span class="token punctuation">.</span>blue<span class="token punctuation">;</span>
            <span class="token comment">// 自定义颜色</span>
            <span class="token comment">// this.GetComponent&lt;MeshRenderer&gt;().material.color = new Color(0.3f, 0.4f, 0.6f, 0.3f);</span>

            <span class="token comment">// 获取所有的组件</span>
            <span class="token class-name"><span class="token keyword">var</span></span> all <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponents</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Component<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> item <span class="token keyword">in</span> all<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">print</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// 深度优先搜索所有的子组件</span>
            <span class="token comment">// var allAndChildren = this.GetComponentsInChildren&lt;MeshRenderer&gt;();</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="_499"></a>物体移动</h3> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Move1</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 建议unity一个固定的帧率，不一定有效</span>
        Application<span class="token punctuation">.</span>targetFrameRate <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    	<span class="token comment">// 直接给一个新的位置</span>
        <span class="token class-name"><span class="token keyword">var</span></span> ps <span class="token operator">=</span> transform<span class="token punctuation">.</span>localPosition<span class="token punctuation">;</span>
        ps<span class="token punctuation">.</span>x <span class="token operator">+=</span> <span class="token number">1.2f</span> <span class="token operator">*</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">;</span>
        transform<span class="token punctuation">.</span>localPosition <span class="token operator">=</span> ps<span class="token punctuation">;</span>
        <span class="token function">print</span><span class="token punctuation">(</span>Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
   		<span class="token comment">/**
         相对移动，传入位移增量
        */</span>
        <span class="token comment">// 自身坐标系z轴每次移动1米</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">Translate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 世界坐标系</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">Translate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Space<span class="token punctuation">.</span>World<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_526"></a>物体旋转</h3> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RotateDemo</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        Application<span class="token punctuation">.</span>targetFrameRate <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span>
        <span class="token comment">// 官方推荐，使用欧拉角设置旋转</span>
        <span class="token comment">// transform.localEulerAngles = new Vector3(0, 45f, 0);</span>
        <span class="token comment">// transform.rotation = Quaternion.Euler(3.0f, 1.2f, 1.0f);</span>
        
    <span class="token punctuation">}</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 使用欧拉角设置</span>
        <span class="token comment">// var angle = transform.localEulerAngles;</span>
        <span class="token comment">// angle.y += 30 * Time.deltaTime;</span>
        <span class="token comment">// transform.localEulerAngles = angle;</span>
        
        <span class="token comment">// 自身坐标系的y轴旋转10度</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">Rotate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">30</span> <span class="token operator">*</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// this.transform.Rotate(0, 10, 0, Space.World);</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="Transform_554"></a>Transform</h3> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TransformDemo</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>GUILayout<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">"transform"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 每个子物体的变化组件</span>
             <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">Transform</span> c <span class="token keyword">in</span> transform<span class="token punctuation">)</span>
             <span class="token punctuation">{<!-- --></span>
                 <span class="token function">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>


            <span class="token comment">// 世界坐标系坐标位置</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 相对于父轴心点的位置</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>localPosition<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 相对于父的缩放</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>localScale<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 围绕世界坐标点旋转,y轴，1度</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">RotateAround</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span>zero<span class="token punctuation">,</span> Vector3<span class="token punctuation">.</span>up<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 获取父物体变换组件</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>parent
            <span class="token comment">// 是最高层级的transform</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>root
			
            <span class="token comment">// 设置父物体变换组件</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>transfrom<span class="token punctuation">.</span><span class="token function">setParent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>root<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>

            <span class="token comment">// 根据名称查找子物体的transform对象</span>
            <span class="token class-name">Transform</span> tf1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token string">"trans1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 查找孙子路径</span>
            <span class="token class-name">Transform</span> tf11 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token string">"trans1/transf2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name"><span class="token keyword">int</span></span> count <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>childCount<span class="token punctuation">;</span>
            <span class="token function">print</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token function">print</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="gameObject_605"></a>gameObject的激活状态</h3> 
<p><img src="https://images2.imgbox.com/44/75/cOFOl72N_o.png" alt="在这里插入图片描述"><br> 勾上就是激活，不勾上就是不激活状态，可以用setActivate来设置，不激活就是不在场景显示了。<code>this.activeSelf</code>是自己的激活状态，但是如果父物体不是，那也不是。所以使用 <code>activeInHierarchy</code>来判断最终状态。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GameObject1</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>GUILayout<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">"GameObject1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>activeSelf<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>activeInHierarchy<span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">// this.gameObject.SetActive(false);</span>

            <span class="token comment">// 所有的组件不能new</span>
            <span class="token class-name">Light</span> light <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Light<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            light<span class="token punctuation">.</span>color <span class="token operator">=</span> Color<span class="token punctuation">.</span>red<span class="token punctuation">;</span>
            light<span class="token punctuation">.</span>type <span class="token operator">=</span> LightType<span class="token punctuation">.</span>Point<span class="token punctuation">;</span>

            <span class="token comment">// 使用标签或者游戏物体列表</span>
            <span class="token class-name">GameObject<span class="token punctuation">[</span><span class="token punctuation">]</span></span> gbs <span class="token operator">=</span> GameObject<span class="token punctuation">.</span><span class="token function">FindGameObjectsWithTag</span><span class="token punctuation">(</span><span class="token string">"Player"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">GameObject</span> gb <span class="token operator">=</span> GameObject<span class="token punctuation">.</span><span class="token function">FindWithTag</span><span class="token punctuation">(</span><span class="token string">"Player"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">// 5s后销毁游戏对象</span>
			<span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="InputManager_641"></a>InputManager（旧输入系统）</h3> 
<p>可以获取用户的输入事件</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token comment">// 这个就会在 add component下显示一个Demo2222的文件夹，名字是input111</span>
<span class="token comment">// 用于定义在unity中的别名</span>
<span class="token comment">// 这种写法是C#的特性</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">AddComponentMenu</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Demo2222/input111"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InputDemo</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span> <span class="token punctuation">{<!-- --></span>
  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    
  <span class="token punctuation">}</span>

  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKey</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Pressed A."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     
    <span class="token punctuation">}</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKeyDown</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Pressed Down w."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 鼠标被按下，不停的出发</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButton</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Pressed left click."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 用户按下了左键，只触发一次</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButtonDown</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Pressed left down."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 用户抬起了左键，只触发一次</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButtonUp</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Pressed left Up."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButton</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Pressed right click."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButton</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Pressed middle click."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Fire1的定义如下所示</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetButton</span><span class="token punctuation">(</span><span class="token string">"Fire1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
       <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"fire1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 这种down的执行的次数少</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetButtonDown</span><span class="token punctuation">(</span><span class="token string">"Fire1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"fire1 down"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 参数值也是标准输入选的，在setting里</span>
    <span class="token comment">// print(Input.GetAxis("Horizontal"));</span>
    <span class="token comment">// 没有中间过程的值，比如按下 w使得 0 - 1 上边方法可能有小数，这个要么0要么1</span>
    <span class="token comment">// print(Input.GetAxisRaw("Horizontal"));</span>
    
    <span class="token comment">// 1 </span>
    <span class="token function">print</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetAxis</span><span class="token punctuation">(</span><span class="token string">"Fire1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>Edit -&gt; Project Settings -&gt; Input Manager 有一些输入的自定义设置，<br> <img src="https://images2.imgbox.com/7d/85/9nNBMSg3_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/e4/4f/khQTaWVh_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="InputSystem_709"></a>InputSystem（新输入系统）</h3> 
<p>2019年推出的系统，设备和动作分离，比老板复杂，分为Input Action、input signal bindings、Devices。<br> <img src="https://images2.imgbox.com/4f/5f/1R4K2o1L_o.png" alt="在这里插入图片描述"><br> 这里设置为新输入系统。<br> 在assets目录新建settings目录，再新建 Input Actions<br> <img src="https://images2.imgbox.com/46/83/4HoFeG4S_o.png" alt="在这里插入图片描述"><br> 点击 edit asset<br> <img src="https://images2.imgbox.com/aa/12/2skNDPtd_o.png" alt="在这里插入图片描述"><br> 创建一个移动的action，配置 action type是value，control type是 vector2，并添加WASD的键盘绑定。<br> <img src="https://images2.imgbox.com/67/35/yoPd6G7U_o.png" alt="在这里插入图片描述"></p> 
<p>创建 control schema<br> <img src="https://images2.imgbox.com/cc/6c/LuQA3b3F_o.png" alt="在这里插入图片描述"><br> 并在这里勾选<br> <img src="https://images2.imgbox.com/3c/96/sz29nceE_o.png" alt="在这里插入图片描述"><br> 也可以让unity自动生成配置，在add component的列表中<br> <img src="https://images2.imgbox.com/6c/68/sdJGRKJC_o.png" alt="在这里插入图片描述"><br> 这里Behavior可以选择 Invoke Unity Events，可以绑定脚本事件<br> <img src="https://images2.imgbox.com/da/23/PDusjFsh_o.png" alt="在这里插入图片描述"><br> 也可以输入代码方式，调用 PlayerInput<br> <img src="https://images2.imgbox.com/0f/c9/GwTzUYAJ_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>InputSystem</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InputDemo</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span> <span class="token punctuation">{<!-- --></span>
  
  <span class="token comment">// PlayerControl 是自动生成的脚本的名字</span>
  <span class="token keyword">public</span> <span class="token class-name">PlayerControl</span> inputControl<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">Vector2</span> dir<span class="token punctuation">;</span>
  
  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    inputControl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PlayerControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnEnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    inputControl<span class="token punctuation">.</span><span class="token function">Enable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnDisable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    inputControl<span class="token punctuation">.</span><span class="token function">Disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    dir <span class="token operator">=</span> inputControl<span class="token punctuation">.</span>Player<span class="token punctuation">.</span>Move<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">ReadValue</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Vector2<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print</span><span class="token punctuation">(</span>dir<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>


  <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Move1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"moving...."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="_766"></a>时间</h3> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token comment">// Time.deltaTime -&gt; Time.unscaledDeltaTime </span>
<span class="token comment">// Time.time -&gt; Time.unscaledTime === Time.realtimeSinceStartup (游戏真实运行时间)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TimeDemo</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>

    <span class="token comment">// Update不受timeScale影响，但是加上了Time.deltaTime就被影响了</span>
    <span class="token comment">// unscaledDeltaTime不受缩放影响的每帧间隔</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
       <span class="token comment">// this.transform.Rotate(0, 100 * Time.deltaTime, 0);</span>
       <span class="token comment">// this.transform.Rotate(0, 100 * Time.unscaledDeltaTime, 0);</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">FixedUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// this.transform.Rotate(0, 100, 1);</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>GUILayout<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">"Time"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 游戏开始的秒数</span>
            <span class="token function">print</span><span class="token punctuation">(</span>Time<span class="token punctuation">.</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 每帧的间隔时间  0.004</span>
            <span class="token function">print</span><span class="token punctuation">(</span>Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 可以保证在机器性能不一样的情况下，保存转速恒定</span>
            <span class="token comment">// 机器好的情况下，渲染速度快 Time.deltaTime小，反之，渲染速度慢，Time.deltaTime大</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">Rotate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token operator">*</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>GUILayout<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">"暂停游戏"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            Time<span class="token punctuation">.</span>timeScale <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>GUILayout<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">"继续游戏"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            Time<span class="token punctuation">.</span>timeScale <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre> 
<h3><a id="_820"></a>资源加载</h3> 
<p>资源要放到Assets/Resources目录, 使用 <code>Resources.Load</code> 方法加载，如果是加载FBX模型是GameObject对象，但是不会再Hierachy面板出现，需要<code>Instantiate</code>复制一个实例才能显示出来。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ResourcesLoad</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 按下w播放音乐</span>
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKeyDown</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// ，不需要写扩展名</span>
            <span class="token class-name"><span class="token keyword">var</span></span> music <span class="token operator">=</span> Resources<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token string">"Audios/bg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            AudioSource<span class="token punctuation">.</span><span class="token function">PlayClipAtPoint</span><span class="token punctuation">(</span>music <span class="token keyword">as</span> <span class="token class-name">AudioClip</span><span class="token punctuation">,</span> Camera<span class="token punctuation">.</span>main<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="_839"></a>场景切换</h3> 
<p>新建两个场景 Scene1 和 Scene2，拖拽到BuildSetting面板中，注意，这个顺序就显示的顺序<br> <img src="https://images2.imgbox.com/61/84/SRnvQh7S_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>SceneManagement</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ToggleScene</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Scene1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 新版切换场景方法</span>
        SceneManager<span class="token punctuation">.</span><span class="token function">LoadScene</span><span class="token punctuation">(</span><span class="token string">"Scene1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 老版切换场景方法，已废弃</span>
        Application<span class="token punctuation">.</span><span class="token function">LoadLevel</span><span class="token punctuation">(</span><span class="token string">"Scene1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Scene2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        SceneManager<span class="token punctuation">.</span><span class="token function">LoadScene</span><span class="token punctuation">(</span><span class="token string">"Scene2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_865"></a>音频</h3> 
<p>一般都是 MP3和WAV文件，<code>AudioSource</code>播放组件，<code>AudioListener</code>收听音乐，摄像机默认都有一个<code>AudioListener</code>。<br> 在Camera新增一个<code>AudioSource</code>，并添加音乐到 AudioClip中。<br> <img src="https://images2.imgbox.com/cd/64/8xnEuu7v_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-csharp">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AudioControl</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">AudioSource</span> a<span class="token punctuation">;</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>AudioSource<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKeyDown</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// this.a.Play();</span>
            <span class="token comment">// 剪辑，位置，音量</span>
            AudioSource<span class="token punctuation">.</span><span class="token function">PlayClipAtPoint</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">.</span>clip<span class="token punctuation">,</span> Camera<span class="token punctuation">.</span>main<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span> <span class="token number">0.1f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_Animation_893"></a>动画 Animation</h3> 
<ul><li>unity的老版本只有Animation组件，在4.6版本以后则增添了Animator。</li><li>只是控制一个动画的播放则用Animaton组件，如果是很多动画之间相互转换则使用Animator组件，两者的区别就是Animator有一个动画控制器（俗称动画状态机），使用它来进行动画切换是非常方便的，但缺点是占用内存比Animaton组件大。</li><li><strong>动画结束后，可以添加事件（挂载的游戏对象的脚本），可以通过这个特性，使得很多动画循环播放</strong>。</li></ul> 
<p>动画的使用方式如下。</p> 
<ol><li>新建一个游戏物体</li><li>在游戏物体添加Animation组件<br> <img src="https://images2.imgbox.com/e7/6b/jfrB5JfO_o.png" alt="在这里插入图片描述"></li><li>打开Animation面板 window - Animation</li><li>选中游戏对象，在游戏面板中，点击add property，0:10代表1秒10帧（60帧为1秒）。<br> <img src="https://images2.imgbox.com/30/13/BEjvBOzU_o.png" alt="在这里插入图片描述"><br> 点击红点，红点背景是红色而且右边有红条，代表录制中<br> <img src="https://images2.imgbox.com/72/25/zOapIZRP_o.png" alt="在这里插入图片描述"></li></ol> 
<p>也可以点击curves，直接操作曲线<br> <img src="https://images2.imgbox.com/53/5d/fi4STFQA_o.png" alt="在这里插入图片描述"></p> 
<p>选中右侧的点，录制开始和结束状态，就可以播放动画了，左键+alt可以拖动动画面板</p> 
<p><img src="https://images2.imgbox.com/7b/01/3fVq32YE_o.png" alt="在这里插入图片描述"><br> 录制好之后，在inspector面板 Animation组件的Animation属性，选中这个动画就可以播放了。<br> <img src="https://images2.imgbox.com/53/48/GKsq8BV4_o.png" alt="在这里插入图片描述"><br> 新建脚本</p> 
<pre><code class="prism language-csharp">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DoorControl</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">bool</span></span> open <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Animation</span> animation1<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">string</span></span> animationName <span class="token operator">=</span> <span class="token string">"Door"</span><span class="token punctuation">;</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>animation1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animation<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnMouseDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>animation1<span class="token punctuation">.</span>isPlaying<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>open<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 倒着播放</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>animation1<span class="token punctuation">[</span>animationName<span class="token punctuation">]</span><span class="token punctuation">.</span>speed <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token comment">// 没有这句话，就是 0 - 0了，门瞬间关闭了，从最后开始播放</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>animation1<span class="token punctuation">[</span>animationName<span class="token punctuation">]</span><span class="token punctuation">.</span>time <span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>animation1<span class="token punctuation">[</span>animationName<span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
         <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>animation1<span class="token punctuation">[</span>animationName<span class="token punctuation">]</span><span class="token punctuation">.</span>speed <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">this</span><span class="token punctuation">.</span>animation1<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span>animationName<span class="token punctuation">)</span><span class="token punctuation">;</span>
         open <span class="token operator">=</span> <span class="token operator">!</span>open<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>动画播放模式</p> 
<p>loop就是循环播放，once一次，pingpang就是来回回来播放，clapforver固定播放到最后一帧（一直播放中）<br> <img src="https://images2.imgbox.com/2c/79/B0S7mAhP_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_Animator_957"></a>动画 Animator</h3> 
<p>动画机含有多个动画的片段,并使用controller通过parameter控制。可以在Project面板右键Animator Controller来创建。<br> 右键 Make transition可以连到下一个动画，点击线可以添加切换的条件，连线可以选中点击delete删除，条件的值可以在脚本设置。</p> 
<ul><li>选中游戏对象，添加组件，添加Animation，会自动创建 Animator的</li><li>选中游戏对象，菜单window，Animation，会自动打开，这个游戏对象上的动画<br> <img src="https://images2.imgbox.com/5f/19/b4NV1lXO_o.png" alt="在这里插入图片描述"></li></ul> 
<pre><code class="prism language-csharp">
   

</code></pre> 
<h3><a id="PlayerPrefs_970"></a>PlayerPrefs本地存储</h3> 
<p>类似浏览器的LocalStorage，但是不存在文件系统，只有游戏卸载了才不存在。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PlayerPrefsTest</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKeyDown</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>Z<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            PlayerPrefs<span class="token punctuation">.</span><span class="token function">SetInt</span><span class="token punctuation">(</span><span class="token string">"level"</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            PlayerPrefs<span class="token punctuation">.</span><span class="token function">SetFloat</span><span class="token punctuation">(</span><span class="token string">"level1"</span><span class="token punctuation">,</span> <span class="token number">11f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            PlayerPrefs<span class="token punctuation">.</span><span class="token function">SetString</span><span class="token punctuation">(</span><span class="token string">"level11"</span><span class="token punctuation">,</span> <span class="token string">"11"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnMouseDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">print</span><span class="token punctuation">(</span>PlayerPrefs<span class="token punctuation">.</span><span class="token function">GetInt</span><span class="token punctuation">(</span><span class="token string">"level"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre> 
<h3><a id="_Coroutine_994"></a>协同 Coroutine</h3> 
<p>当前代码，在等待某些资源条件好的时候，在未来执行。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CoRoutineTest</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKeyDown</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
           <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">play1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
	
	<span class="token comment">// 2秒后再print(2)</span>
    <span class="token return-type class-name">IEnumerator</span> <span class="token function">play1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">WaitForSeconds</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre> 
<h3><a id="www_1017"></a>www类</h3> 
<p>基于HTTP的网络传输功能，需要结合协同使用。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WWWDemo</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">Texture2D</span> pic<span class="token punctuation">;</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        
    <span class="token punctuation">}</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKeyDown</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>O<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
         <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">DrawPic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>pic <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
          GUI<span class="token punctuation">.</span><span class="token function">DrawTexture</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pic<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token return-type class-name">IEnumerator</span> <span class="token function">DrawPic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token class-name">WWW</span> w3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">WWW</span><span class="token punctuation">(</span><span class="token string">"https://img0.baidu.com/it/u=3111329697,2164934529&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=313"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">yield</span> <span class="token keyword">return</span> w3<span class="token punctuation">;</span>
      pic <span class="token operator">=</span> w3<span class="token punctuation">.</span>texture<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre> 
<h3><a id="UnityWebRequest_1051"></a>UnityWebRequest</h3> 
<p>可以用WWW或者HttpWebRequest来实现文件的下载。因为WWW不存在设置timeout属性，因此当我们网络不好请求超时的时候，无法简单的做出判断。当网络极差的时候，游戏下载将会停止（即一直在等待yield return www）当时间较长时网络恢复将无法继续下载，也没有提示，需要重启才能重新下载。Unity早在5.4版本的时候就出了新的API UnityWebRequest用于替代WWW。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>Networking</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HttpTest</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
  <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">string</span></span> jsonUrl <span class="token operator">=</span> <span class="token string">"http://localhost:8888/demo.json"</span><span class="token punctuation">;</span>

  <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token return-type class-name">IEnumerator</span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">UnityWebRequest</span> request <span class="token operator">=</span> UnityWebRequest<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>jsonUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span> <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token function">SendWebRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>isHttpError <span class="token operator">||</span> request<span class="token punctuation">.</span>isNetworkError<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
      Debug<span class="token punctuation">.</span><span class="token function">LogError</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
      <span class="token class-name"><span class="token keyword">string</span></span> receiveContent <span class="token operator">=</span> request<span class="token punctuation">.</span>downloadHandler<span class="token punctuation">.</span>text<span class="token punctuation">;</span>
      Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>receiveContent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_1084"></a>人称设置</h3> 
<p>第一人称，把camera直接拖到物体内部并且position一致。<br> 第三人称，把camera直接拖到物体内部而且位置不一样，可以看到自己。<br> 如下，实现了前后左右移动的效果</p> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CubeMove</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> speed<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> angleSpeed<span class="token punctuation">;</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        speed <span class="token operator">=</span> <span class="token number">1f</span><span class="token punctuation">;</span>
        angleSpeed <span class="token operator">=</span> <span class="token number">5f</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        transform<span class="token punctuation">.</span><span class="token function">Translate</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span>forward <span class="token operator">*</span> speed <span class="token operator">*</span> Time<span class="token punctuation">.</span>deltaTime <span class="token operator">*</span> Input<span class="token punctuation">.</span><span class="token function">GetAxisRaw</span><span class="token punctuation">(</span><span class="token string">"Vertical"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        transform<span class="token punctuation">.</span><span class="token function">Rotate</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span>up<span class="token punctuation">,</span> Input<span class="token punctuation">.</span><span class="token function">GetAxisRaw</span><span class="token punctuation">(</span><span class="token string">"Horizontal"</span><span class="token punctuation">)</span> <span class="token operator">*</span> angleSpeed <span class="token operator">*</span> Time<span class="token punctuation">.</span>deltaTime <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="_1109"></a>项目路径</h3> 
<ul><li><code>Streaming Assets</code>，就是项目中的<code>streamingAssets</code>目录，可以使用<code>Application.streamingAssetsPath</code>得到，Unity 中的大多数资源在构建时都会合并到项目中。但是，将文件放入目标计算机上的普通文件系统以使其可通过路径名访问有时会很有用。</li><li><code>Application.dataPath</code>就是项目的Assets目录。</li></ul> 
<h3><a id="json_1114"></a>使用json</h3> 
<p>UnityEngine自带JsonUtility来处理json数据。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEditor</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">demo11</span>  <span class="token punctuation">{<!-- --></span>

  <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Excel/Json"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
  <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Data</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Data"</span><span class="token punctuation">;</span>
    data<span class="token punctuation">.</span>subData<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">SubData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> intValue <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> boolValue <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> floatValue <span class="token operator">=</span>
      <span class="token number">0.1f</span><span class="token punctuation">,</span> stringValue <span class="token operator">=</span> <span class="token string">"one"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    data<span class="token punctuation">.</span>subData<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">SubData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> intValue <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> boolValue <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> floatValue <span class="token operator">=</span>
      <span class="token number">0.1f</span><span class="token punctuation">,</span> stringValue <span class="token operator">=</span> <span class="token string">"two"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name"><span class="token keyword">string</span></span> json <span class="token operator">=</span>  JsonUtility<span class="token punctuation">.</span><span class="token function">ToJson</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
    data <span class="token operator">=</span> JsonUtility<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">FromJson</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Data<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Debug<span class="token punctuation">.</span><span class="token function">LogFormat</span><span class="token punctuation">(</span><span class="token string">"name = {0}"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> item <span class="token keyword">in</span> data<span class="token punctuation">.</span>subData<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      Debug<span class="token punctuation">.</span><span class="token function">LogFormat</span><span class="token punctuation">(</span><span class="token string">"intValue = {0} boolValue = {0} floatValue = {0}stringValue = {0}"</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>intValue<span class="token punctuation">,</span> item<span class="token punctuation">.</span>boolValue<span class="token punctuation">,</span> item<span class="token punctuation">.</span>floatValue<span class="token punctuation">,</span> item<span class="token punctuation">.</span>stringValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Serializable</span></span><span class="token punctuation">]</span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Data</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>SubData<span class="token punctuation">&gt;</span></span> subData <span class="token operator">=</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>SubData<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Serializable</span></span><span class="token punctuation">]</span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SubData</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> intValue<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">bool</span></span> boolValue<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> floatValue<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">string</span></span> stringValue<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>Unity的JSON是不支持字典的，不过可以继承ISerializationCallbackReceiver接口，间接地实现字典序列化。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEditor</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Script_08_04</span>
<span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Excel/Load Dictionary"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SerializableDictionary</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>

        <span class="token class-name">SerializableDictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> serializableDictionary <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SerializableDictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        serializableDictionary <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"demo1"</span><span class="token punctuation">;</span>
        serializableDictionary <span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"200"</span><span class="token punctuation">;</span>
        serializableDictionary <span class="token punctuation">[</span><span class="token number">300</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"3000"</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">string</span></span> json <span class="token operator">=</span> JsonUtility<span class="token punctuation">.</span><span class="token function">ToJson</span><span class="token punctuation">(</span>serializableDictionary<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>

        serializableDictionary <span class="token operator">=</span> JsonUtility<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">FromJson</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>SerializableDictionary<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>
            <span class="token keyword">string</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>serializableDictionary <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SerializableDictionary<span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">&gt;</span></span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ISerializationCallbackReceiver</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">SerializeField</span></span><span class="token punctuation">]</span>
    <span class="token keyword">private</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>K<span class="token punctuation">&gt;</span></span> m_keys<span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">SerializeField</span></span><span class="token punctuation">]</span>
    <span class="token keyword">private</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>V<span class="token punctuation">&gt;</span></span> m_values<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Dictionary<span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">&gt;</span></span> m_Dictionary <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token return-type class-name">V</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token class-name">K</span> key<span class="token punctuation">]</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">get</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>m_Dictionary<span class="token punctuation">.</span><span class="token function">ContainsKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token keyword">default</span><span class="token punctuation">(</span><span class="token type-expression class-name">V</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> m_Dictionary<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">set</span><span class="token punctuation">{<!-- --></span>
            m_Dictionary <span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnAfterDeserialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">int</span></span> length <span class="token operator">=</span> m_keys<span class="token punctuation">.</span>Count<span class="token punctuation">;</span>
        m_Dictionary <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span>K<span class="token punctuation">,</span> V<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            m_Dictionary<span class="token punctuation">[</span>m_keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> m_values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        m_keys <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        m_values <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnBeforeSerialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        m_keys <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>K<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        m_values <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>V<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> item <span class="token keyword">in</span> m_Dictionary<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            m_keys<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>Key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            m_values<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="TextAsset_1242"></a>TextAsset</h3> 
<p>TextAsset是Unity 提供的一个文本对象，它可以通过Resources.Load 或者 AssetBundle 来读取数据，其中数据是string格式的。例如在resources目录下有demo.txt和 demo1.json两个文件。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEditor</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoadTextAsset</span> <span class="token punctuation">{<!-- --></span>
  
  <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"MyTextAsset/LoadTextAsset"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
  <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadMyTextAsset</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">string</span></span> mystr <span class="token operator">=</span> Resources<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Load</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TextAsset<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"demo"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">string</span></span> mystr1 <span class="token operator">=</span> Resources<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Load</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TextAsset<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"demo1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">;</span>
    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>mystr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>mystr1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="_1263"></a>读写文本</h3> 
<p>使用C# 的File类来读写某个目录的文本，注意编辑器模式下读写文本是可以的，但是一旦打包发布，Assets/目录都不存在了，运行时是无法读取它目录下的文本的。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEditor</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>IO</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Text</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo11</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Tool/File"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">string</span></span> path <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span>dataPath<span class="token punctuation">,</span> <span class="token string">"test.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//如果文件存在，就删除它</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>File<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            File<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//写入文件</span>
        <span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sb<span class="token punctuation">.</span>AppendFormat <span class="token punctuation">(</span><span class="token string">"第一行:{0}"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">AppendLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sb<span class="token punctuation">.</span>AppendFormat <span class="token punctuation">(</span><span class="token string">"第二行:{0}"</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">AppendLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        File<span class="token punctuation">.</span><span class="token function">WriteAllText</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span>sb<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//读取文件</span>
        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>File<span class="token punctuation">.</span><span class="token function">ReadAllText</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_1296"></a>运行期读写文本</h3> 
<ul><li><code>Resources</code>目录用来读取游戏资源，在编辑器模式下可见，打包后运行不可见。</li><li><code>StreamingAssets</code>目录可使用File类来读取文件（除了个别平台外），但都是只读的并不能写，StreamingAssets在打包后整个目录后保存的在本项目中。</li><li><code>persistentDataPath</code>目录是<strong>可读可写</strong>的，这个目录存在计算机上不在项目中，不同的系统在的位置不一样。</li></ul> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>IO</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEditor</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">demo1</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">{<!-- --></span>
    
    <span class="token comment">//可读不可写</span>
    <span class="token class-name"><span class="token keyword">string</span></span> streamingAssetsTxt <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">;</span>
    
    <span class="token comment">//可读可写</span>
    <span class="token class-name"><span class="token keyword">string</span></span> m_PersistentDataTxt <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">;</span>
    
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">string</span></span> mystr1 <span class="token operator">=</span> Resources<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Load</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TextAsset<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"demo1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">;</span>
        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>mystr1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        streamingAssetsTxt <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">ReadAllText</span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span>streamingAssetsPath<span class="token punctuation">,</span> <span class="token string">"test.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">print</span><span class="token punctuation">(</span>streamingAssetsTxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 打开 PersistentDataPath的目录
     */</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Assets/Open PersistentDataPath"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        EditorUtility<span class="token punctuation">.</span><span class="token function">RevealInFinder</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span>persistentDataPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>GUILayout<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">"&lt;size=50&gt;写入并读取时间&lt;/size&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">string</span></span> path <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span>persistentDataPath<span class="token punctuation">,</span> <span class="token string">"test.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            File<span class="token punctuation">.</span><span class="token function">WriteAllText</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span>DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            m_PersistentDataTxt <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">ReadAllText</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">print</span><span class="token punctuation">(</span>m_PersistentDataTxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="_1342"></a>封装游戏存档方法</h3> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>IO</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Text</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RecordUtil</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">//游戏存档保存的根目录</span>
  <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> RecordRootPath <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">get</span> <span class="token punctuation">{<!-- --></span>
<span class="token preprocessor property">#<span class="token directive keyword">if</span>(UNITY_EDITOR || UNITY_STANDALONE)</span>
      <span class="token keyword">return</span> Application<span class="token punctuation">.</span>dataPath <span class="token operator">+</span> <span class="token string">"/../Record/"</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
      <span class="token keyword">return</span> Application<span class="token punctuation">.</span>persistentDataPath <span class="token operator">+</span> <span class="token string">"/Record/"</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">//游戏存档</span>
  <span class="token keyword">static</span> <span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> recordDic <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//标记某个游戏存档是否需要重新写入</span>
  <span class="token keyword">static</span> <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> recordDirty <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//标记某个游戏存档是否需要删除</span>
  <span class="token keyword">static</span> <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> deleteDirty <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//表示某个游戏存档读取时需要重新从文件中读取</span>
  <span class="token keyword">static</span> <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> readDirty <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">static</span> <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">UTF8Encoding</span> UTF8 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">UTF8Encoding</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">static</span> <span class="token function">RecordUtil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    readDirty<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Directory<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>RecordRootPath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> file <span class="token keyword">in</span> Directory<span class="token punctuation">.</span><span class="token function">GetFiles</span><span class="token punctuation">(</span>RecordRootPath<span class="token punctuation">,</span> <span class="token string">"*.record"</span><span class="token punctuation">,</span>
        SearchOption<span class="token punctuation">.</span>TopDirectoryOnly<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">string</span></span> name <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">GetFileNameWithoutExtension</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>readDirty<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          readDirty<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">Get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>


  <span class="token comment">//强制写入文件</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"save"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> key <span class="token keyword">in</span> deleteDirty<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">string</span></span> path <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>RecordRootPath<span class="token punctuation">,</span> key <span class="token operator">+</span> <span class="token string">".record"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>recordDirty<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          recordDirty<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>File<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          File<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        Debug<span class="token punctuation">.</span><span class="token function">LogError</span><span class="token punctuation">(</span>ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    deleteDirty<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> key <span class="token keyword">in</span> recordDirty<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token class-name"><span class="token keyword">string</span></span> <span class="token keyword">value</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>recordDic<span class="token punctuation">.</span><span class="token function">TryGetValue</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>readDirty<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          readDirty<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name"><span class="token keyword">string</span></span> path <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>RecordRootPath<span class="token punctuation">,</span> key <span class="token operator">+</span> <span class="token string">".record"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        recordDic<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
          Directory<span class="token punctuation">.</span><span class="token function">CreateDirectory</span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span><span class="token function">GetDirectoryName</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          File<span class="token punctuation">.</span><span class="token function">WriteAllText</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token keyword">value</span><span class="token punctuation">,</span> UTF8<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          Debug<span class="token punctuation">.</span><span class="token function">LogError</span><span class="token punctuation">(</span>ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    recordDirty<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>


  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Set</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    recordDic<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>recordDirty<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      recordDirty<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_EDITOR || </span><span class="token return-type class-name">UNITY_STANDALONE</span>
    <span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token function">Get</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> defaultValue<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>readDirty<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token class-name"><span class="token keyword">string</span></span> path <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>RecordRootPath<span class="token punctuation">,</span> key <span class="token operator">+</span> <span class="token string">".record"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">string</span></span> readStr <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">ReadAllText</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> UTF8<span class="token punctuation">)</span><span class="token punctuation">;</span>
        recordDic<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> readStr<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        Debug<span class="token punctuation">.</span><span class="token function">LogError</span><span class="token punctuation">(</span>ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      readDirty<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name"><span class="token keyword">string</span></span> <span class="token keyword">value</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>recordDic<span class="token punctuation">.</span><span class="token function">TryGetValue</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">out</span> <span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token keyword">value</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> defaultValue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>


  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>recordDic<span class="token punctuation">.</span><span class="token function">ContainsKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      recordDic<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>deleteDirty<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      deleteDirty<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_EDITOR || </span><span class="token return-type class-name">UNITY_STANDALONE</span>
    <span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>测试使用</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEditor</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test1</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span> <span class="token punctuation">{<!-- --></span>
  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Setting</span> setting <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Setting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    setting<span class="token punctuation">.</span>stringValue <span class="token operator">=</span> <span class="token string">"测试字符串"</span><span class="token punctuation">;</span>
    setting<span class="token punctuation">.</span>intValue <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span>
    RecordUtil<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"setting"</span><span class="token punctuation">,</span> JsonUtility<span class="token punctuation">.</span><span class="token function">ToJson</span><span class="token punctuation">(</span>setting<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token class-name">Setting</span> m_Setting <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>GUILayout<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">"&lt;size=50&gt;获取存档&lt;/size&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      m_Setting <span class="token operator">=</span> JsonUtility<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">FromJson</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Setting<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>RecordUtil<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"setting"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>m_Setting <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      GUILayout<span class="token punctuation">.</span><span class="token function">Label</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"&lt;size=50&gt; {0},{1} &lt;/size&gt;"</span><span class="token punctuation">,</span> m_Setting<span class="token punctuation">.</span>intValue<span class="token punctuation">,</span> m_Setting<span class="token punctuation">.</span>stringValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>


  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnApplicationPause</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">bool</span></span> pauseStatus<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//当游戏即将进入后台时，保存存档</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pauseStatus<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      RecordUtil<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>


  <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">System<span class="token punctuation">.</span>Serializable</span></span><span class="token punctuation">]</span>
  <span class="token keyword">class</span> <span class="token class-name">Setting</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">string</span></span> stringValue<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> intValue<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="XML_1533"></a>XML操作</h3> 
<p>操作XML时，需要用到 <code>System.Xml</code> 命名空间。</p> 
<h3><a id="_1536"></a>物理引擎</h3> 
<p>模拟真实事件的物体碰撞，跌落，使用了 nvida 的physX。新建cube，add component，选择 Physics给cube添加一个刚体，<br> <code>Rigidbody</code>刚体表示受力的作用，<code>Collider</code>表示使用碰撞检测。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">Scene4</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RigidControl</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span> <span class="token punctuation">{<!-- --></span>


    <span class="token keyword">private</span> <span class="token class-name">Rigidbody</span> obj<span class="token punctuation">;</span>
    
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      obj <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rigidbody<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKeyDown</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 给物体添加一个右上方的力， Impulse是冲击力，瞬间爆发</span>
        obj<span class="token punctuation">.</span><span class="token function">AddForce</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">,</span> ForceMode<span class="token punctuation">.</span>Impulse<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKeyDown</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 给物体添加一个右上方的力， 牵引力，不停的按下才可以</span>
        obj<span class="token punctuation">.</span><span class="token function">AddForce</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span> ForceMode<span class="token punctuation">.</span>Acceleration<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKeyDown</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 直接给物体一个速度</span>
        obj<span class="token punctuation">.</span>velocity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre> 
<p><strong>碰撞检测</strong></p> 
<p>地板Plane都有默认的 <code>Mesh Collider</code>，发生碰撞的条件是两个物体之间都有Collider并且至少一方有刚体。<code>Box Collider</code>也有材质但是和<code>MeshRenderer</code>的材质（渲染材质）不一样，这个叫做物理材质（不同的物理属性）。可以使用右键 <code>Physics Material</code> 创建物理材质。</p> 
<p><img src="https://images2.imgbox.com/12/42/I6b2ilOo_o.png" alt="在这里插入图片描述"><br> 面板中的属性依次是动摩擦系数、静摩擦系数、弹性（物体落下弹起的效果）、摩擦系数合并（比如取最大值）</p> 
<p><img src="https://images2.imgbox.com/70/d0/1LmlKFdy_o.png" alt="在这里插入图片描述"><br> 可以调整碰撞体的大小(不接触物体但是能碰到的效果)。</p> 
<p>is Trigger 勾选了就是trigger触发器，没有力的作用（比如小球和地面，勾选了直接就穿过了地面）。</p> 
<p>碰撞有2种消息（trigger的和非trigger的），3种状态（Enter、Stay、Exit）。</p> 
<pre><code class="prism language-csharp">
<span class="token comment">// 被碰到的物体的名字</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnCollisionEnter</span><span class="token punctuation">(</span><span class="token class-name">Collision</span> c<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"OnCollisionEnter"</span> <span class="token operator">+</span> c<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnCollisionStay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"OnCollisionStay"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnCollisionExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"OnCollisionExit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnTriggerEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"OnTriggerEnter"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
    
</code></pre> 
<h3><a id="_1609"></a>射线</h3> 
<p>射线是一个点向另一个点发射一条线，一旦和其他的模型发生碰撞，就停止发射。射线是摄像机发出的。<br> 鼠标点击一个点，摄像机和这个点连线，之后和哪个物体发生了碰撞就是点击了哪个物体。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RayTest</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span> <span class="token punctuation">{<!-- --></span>
    
    <span class="token comment">// 游戏对象 添加组件 LineRenderer</span>
    <span class="token keyword">private</span> <span class="token class-name">LineRenderer</span> line<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        line <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>LineRenderer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButtonDown</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>Camera<span class="token punctuation">.</span>main<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">print</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span>mousePosition<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Ray</span> r <span class="token operator">=</span> Camera<span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">ScreenPointToRay</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span>mousePosition<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">RaycastHit</span> hit<span class="token punctuation">;</span>
                <span class="token comment">// 如果和某物体发生了碰撞, 100内，第4个参数是layer，默认所有层，这个层是二进制 1 &lt;&lt; 8 代表第8层</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>Physics<span class="token punctuation">.</span><span class="token function">Raycast</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token keyword">out</span> hit<span class="token punctuation">,</span> <span class="token number">100f</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 碰撞的点</span>
                    <span class="token function">print</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 碰到的物体</span>
                    <span class="token function">print</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span>collider<span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    line<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                    line<span class="token punctuation">.</span><span class="token function">SetPosition</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> hit<span class="token punctuation">.</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 销毁碰到的物体</span>
                    <span class="token function">Destroy</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span>collider<span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    line<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"没碰撞"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



</code></pre> 
<h3><a id="_1654"></a>角色控制器</h3> 
<p>主要应用到会动的游戏物体上，不会动的就用刚体就好了，也不需要Collider来碰撞检测了。<br> <img src="https://images2.imgbox.com/06/2c/E9EFCeo7_o.png" alt="在这里插入图片描述"><br> 前两项是坡度（超过这个度数爬不了）和最小位移，角色控制器默认给加胶囊体。</p> 
<pre><code class="prism language-csharp">
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MoveMove</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">CharacterController</span> controller<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Camera</span> main<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> speed<span class="token punctuation">;</span>
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        controller <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterController<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        speed <span class="token operator">=</span> <span class="token number">10000f</span><span class="token punctuation">;</span>
        main <span class="token operator">=</span> Camera<span class="token punctuation">.</span>main<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// SimpleMove 有重力的作用,move没有</span>
        <span class="token comment">// controller.SimpleMove()</span>
   
        <span class="token comment">// 这个是世界坐标系</span>
        <span class="token comment">// controller.SimpleMove(Vector3.forward * speed *  Time.deltaTime * Input.GetAxisRaw("Horizontal"));</span>
        
        <span class="token comment">// 推荐使用本地坐标系，往自己的前方走</span>
        controller<span class="token punctuation">.</span><span class="token function">SimpleMove</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>forward <span class="token operator">*</span> speed <span class="token operator">*</span>  Time<span class="token punctuation">.</span>deltaTime <span class="token operator">*</span> Input<span class="token punctuation">.</span><span class="token function">GetAxisRaw</span><span class="token punctuation">(</span><span class="token string">"Horizontal"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LateUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 摄像机跟随</span>
        <span class="token comment">// main.transform.position = transform.position + new Vector3(0, 0, -1f);</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="Layer_1693"></a>Layer层</h3> 
<p><img src="https://images2.imgbox.com/ec/10/Le84Sbzv_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/fd/4b/ukc5yCQb_o.png" alt="在这里插入图片描述"><br> 最多32个层，内置0-7改不了，是二进制表示 1 &lt;&lt; 8代表第8层。</p> 
<h3><a id="_1697"></a>地形</h3> 
<p>GameObject Terrain，可以创建一些自定义的山啊什么的，一般不使用，一般使用自定义地形。</p> 
<h3><a id="Gizmos__1700"></a>Gizmos 辅助线框类</h3> 
<p><img src="https://images2.imgbox.com/1a/12/2d8hHAxH_o.png" alt="在这里插入图片描述"><br> 点击可以切换是否显示，点箭头可以展开更多选项<br> <img src="https://images2.imgbox.com/f6/ae/Z4ob0Qso_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_navigation_1705"></a>导航 navigation</h3> 
<p>导航就是任务行走路线，也可以自动避开一些障碍物。菜单windows -&gt; AI -&gt; navigation打开面板。<br> <img src="https://images2.imgbox.com/00/8e/BTpIqCyS_o.png" alt="在这里插入图片描述"><br> 创建一个这样的地形，选中所有的物体，然后<br> <img src="https://images2.imgbox.com/02/b5/tpNDRDAr_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/36/1d/FKLPm9sO_o.png" alt="在这里插入图片描述"><br> 给运动的物体，添加一个导航组件<br> <img src="https://images2.imgbox.com/5c/b9/P3sgYclZ_o.png" alt="在这里插入图片描述"><br> 给物体绑定脚本</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>AI</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NavController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">NavMeshAgent</span> a<span class="token punctuation">;</span>
    
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      a <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButtonDown</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">var</span></span> r <span class="token operator">=</span> Camera<span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">ScreenPointToRay</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span>mousePosition<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RaycastHit</span> hit<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Physics<span class="token punctuation">.</span><span class="token function">Raycast</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token keyword">out</span> hit<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token class-name"><span class="token keyword">var</span></span> p <span class="token operator">=</span> hit<span class="token punctuation">.</span>point<span class="token punctuation">;</span>
          a<span class="token punctuation">.</span><span class="token function">SetDestination</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
          
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre> 
<p>动态障碍物</p> 
<p>给中间的门去掉 static navigation，并且添加 <code>Nav Mesh Obstacle</code>组件<br> <img src="https://images2.imgbox.com/8e/57/aigp8OBJ_o.png" alt="在这里插入图片描述"></p> 
<p>网格链接（就是导航区域可链接起来）<br> 比如可以从高台跳下去<br> 首先，选中可以跳的物体勾选上<br> <img src="https://images2.imgbox.com/31/b1/QNs0XYYm_o.png" alt="在这里插入图片描述"><br> 然后设置高度（下边选项是跳跃距离），并重新烘焙即可<br> <img src="https://images2.imgbox.com/ce/46/0aOKmZAM_o.png" alt="在这里插入图片描述"></p> 
<p>如果有两个特定地方，需要链接，首先在场景创建两个地点cube。然后添加 <code>Off Mesh Link</code> 组件</p> 
<p><img src="https://images2.imgbox.com/3e/f2/9NMC7PGe_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_1760"></a>拓展菜单</h3> 
<p>编辑器使用的代码应该仅限于编辑模式下，也就是说正式的游戏包不应该包含这些代码。Unity提供了一个规则：如果属于编辑模式下的代码，需要放在Editor文件夹下；如果属于运行时执行的代码，放在任意非Editor文件夹下即可。<br> <img src="https://images2.imgbox.com/d3/a3/dqn5zcuM_o.png" alt="在这里插入图片描述"><br> 如图，在editor目录下新建脚本。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEditor</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestMenu</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Assets/My Tools/Tools 1"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MyTools1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>Selection<span class="token punctuation">.</span>activeObject<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Assets/My Tools/Tools 2"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MyTools2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>Selection<span class="token punctuation">.</span>activeObject<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>效果如下</p> 
<p><img src="https://images2.imgbox.com/57/d0/UfkZhmyJ_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="GUI_1788"></a>GUI</h3> 
<p>GUI不可视化，做测试比较方便，Unity4.6出现的新的UI技术称之为UGUI。</p> 
<pre><code class="prism language-csharp">    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 手动布局 GUI</span>
        GUI<span class="token punctuation">.</span><span class="token function">Label</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"halo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>GUI<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Get BTC"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"you get 10000 BitCoin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        input <span class="token operator">=</span> GUI<span class="token punctuation">.</span><span class="token function">TextField</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>input <span class="token operator">==</span> <span class="token string">"666"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ok"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 自动布局</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>GUILayout<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">"btn1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"btn1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

</code></pre> 
<h3><a id="UGUI_1813"></a>UGUI</h3> 
<p>UI必须作为canvas的子对象存在，创建的时候，自动创建Event System。</p> 
<h3><a id="_demo_1816"></a>练习 demo</h3> 
<h4><a id="_1818"></a>物体朝着另一个物体移动，到达就停止</h4> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Move1</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">GameObject</span> target<span class="token punctuation">;</span>
    
    <span class="token comment">// 选中物体，Edit-&gt; lock view to selected就可以运行游戏时，随着物体的视角</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 建议unity一个固定的帧率，不一定有效</span>
        Application<span class="token punctuation">.</span>targetFrameRate <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span>
        target <span class="token operator">=</span> GameObject<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token string">"Cube1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"初始距离是</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp"><span class="token function">getDistance</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token return-type class-name"><span class="token keyword">float</span></span> <span class="token function">getDistance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>transform<span class="token punctuation">.</span>position <span class="token operator">-</span> target<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">.</span>magnitude<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getDistance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.1f</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"已经到达目标"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"moving"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">Translate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.2f</span> <span class="token operator">*</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="Cube_1851"></a>循环创建几个Cube</h4> 
<pre><code class="prism language-csharp"><span class="token class-name"><span class="token keyword">int</span></span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">while</span><span class="token punctuation">(</span>a <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
   <span class="token comment">//我们将obj1初始化为一个Cube立方体，当然我们也可以初始化为其他的形状</span>
   <span class="token class-name">GameObject</span> obj1 <span class="token operator">=</span> GameObject<span class="token punctuation">.</span><span class="token function">CreatePrimitive</span><span class="token punctuation">(</span>PrimitiveType<span class="token punctuation">.</span>Cube<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//设置物体的位置Vector3三个参数分别代表x,y,z的坐标数</span>
   obj1<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span>  a <span class="token operator">*</span> <span class="token number">1.3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token comment">//给这个创建出来的对象起个名字</span>
   obj1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"dujia"</span> <span class="token operator">+</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
   a<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_1866"></a>获取其他游戏对象脚本变量的值</h4> 
<pre><code class="prism language-csharp">  
<span class="token class-name">GameObject</span> gb <span class="token operator">=</span> GameObject<span class="token punctuation">.</span><span class="token function">FindWithTag</span><span class="token punctuation">(</span><span class="token string">"Enemy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span>gb<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span>gb<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Enemy<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<h4><a id="_1875"></a>查找所有敌人的血量</h4> 
<p>Enemy .cs</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Enemy</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> money <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


</code></pre> 
<p>新建两个 Enemy0和Enemy1的游戏对象，并绑定上述脚本</p> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GameObject1</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>GUILayout<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">"GameObject1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>

            <span class="token comment">// 单个敌人</span>
            <span class="token class-name">GameObject</span> gb <span class="token operator">=</span> GameObject<span class="token punctuation">.</span><span class="token function">FindWithTag</span><span class="token punctuation">(</span><span class="token string">"Enemy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">print</span><span class="token punctuation">(</span>gb<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
            <span class="token function">print</span><span class="token punctuation">(</span>gb<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Enemy<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 如果有多个</span>
            <span class="token class-name">GameObject<span class="token punctuation">[</span><span class="token punctuation">]</span></span> gbs <span class="token operator">=</span> GameObject<span class="token punctuation">.</span><span class="token function">FindGameObjectsWithTag</span><span class="token punctuation">(</span><span class="token string">"Enemy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> gbs<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">print</span><span class="token punctuation">(</span>gbs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Enemy<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token class-name">Enemy<span class="token punctuation">[</span><span class="token punctuation">]</span></span> all <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">FindObjectsOfType</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Enemy<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> all<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
               <span class="token keyword">if</span><span class="token punctuation">(</span>all<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>money <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                  all<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MeshRenderer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>material<span class="token punctuation">.</span>color <span class="token operator">=</span> Color<span class="token punctuation">.</span>red<span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_1922"></a>层级未知查找子物体</h4> 
<pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TransFormHelper</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 层级未知查找子物体</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">Transform</span> <span class="token function">Getchild</span><span class="token punctuation">(</span><span class="token class-name">Transform</span> parent<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> kidName<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Transform</span> childTransForm <span class="token operator">=</span> parent<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span>kidName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>childTransForm <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> childTransForm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name"><span class="token keyword">int</span></span> count <span class="token operator">=</span> parent<span class="token punctuation">.</span>childCount<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Transform</span> ct <span class="token operator">=</span> <span class="token function">Getchild</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> kidName<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>ct <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> ct<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token comment">// 使用</span>
<span class="token class-name">Transform</span> tf <span class="token operator">=</span> TransFormHelper<span class="token punctuation">.</span><span class="token function">Getchild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">,</span> <span class="token string">"trans1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
tf<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>MeshRenderer<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>material<span class="token punctuation">.</span>color <span class="token operator">=</span> Color<span class="token punctuation">.</span>red<span class="token punctuation">;</span>

<span class="token comment">// 判断两个物体的距离</span>
<span class="token function">print</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span> tf<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_1957"></a>实现倒计时</h4> 
<p>在Hierachy面板，右键UI选择Text，新建文本。注意，<code>TextMeshPro</code> 是 Unity 的最终文本解决方案。它是 Unity UI Text 和旧版 Text Mesh 的完美替代方案。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">{<!-- --></span>

  <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> second <span class="token operator">=</span> <span class="token number">120</span><span class="token punctuation">;</span>

  <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> nextTime <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

  <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> totalTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">private</span> <span class="token class-name">TMPro<span class="token punctuation">.</span>TextMeshProUGUI</span> text1<span class="token punctuation">;</span>

  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>text1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TMPro<span class="token punctuation">.</span>TextMeshProUGUI<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 从1s开始重复调用,间隔也是1s</span>
    <span class="token function">InvokeRepeating</span><span class="token punctuation">(</span><span class="token string">"TimerFn3"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 3s后执行</span>
    <span class="token comment">// Invoke("TimerFn3", 3);</span>
  <span class="token punctuation">}</span>


  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TimerFn3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>second <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        second<span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">var</span></span> res <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:d2}:{1:d2}"</span><span class="token punctuation">,</span> second <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">,</span> second <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>text1<span class="token punctuation">.</span>text <span class="token operator">=</span> res<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>second <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>text1<span class="token punctuation">.</span>color <span class="token operator">=</span> Color<span class="token punctuation">.</span>red<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">CancelInvoke</span><span class="token punctuation">(</span><span class="token string">"TimerFn3"</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

	<span class="token comment">// 适合发射子弹</span>
  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TimerFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Time<span class="token punctuation">.</span>time <span class="token operator">&gt;</span> nextTime<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>second <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        second<span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">var</span></span> res <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:d2}:{1:d2}"</span><span class="token punctuation">,</span> second <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">,</span> second <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>text1<span class="token punctuation">.</span>text <span class="token operator">=</span> res<span class="token punctuation">;</span>
        nextTime <span class="token operator">=</span> Time<span class="token punctuation">.</span>time <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>second <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>text1<span class="token punctuation">.</span>color <span class="token operator">=</span> Color<span class="token punctuation">.</span>red<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TimerFn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    totalTime <span class="token operator">+=</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>totalTime <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      totalTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>second <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        second<span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">var</span></span> res <span class="token operator">=</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"{0:d2}:{1:d2}"</span><span class="token punctuation">,</span> second <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">,</span> second <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>text1<span class="token punctuation">.</span>text <span class="token operator">=</span> res<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>second <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>text1<span class="token punctuation">.</span>color <span class="token operator">=</span> Color<span class="token punctuation">.</span>red<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// this.TimerFn2();</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="_2033"></a>打箱子游戏</h4> 
<p>新建9个箱子，1个子弹，都做成预制体</p> 
<p>新建一个空的游戏对象，加下面的脚本</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HitBox</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">// 定义为public，可以在软件中看到，并且可以直接预制体拖过去就可以</span>
    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> Box<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> Bullet<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Texture2D</span> pointer<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> FireTime1<span class="token punctuation">,</span> FireTime2<span class="token punctuation">;</span>
    
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">var</span></span> box <span class="token operator">=</span> <span class="token function">Instantiate</span><span class="token punctuation">(</span>Box<span class="token punctuation">)</span><span class="token punctuation">;</span>
                box<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">+</span>i<span class="token punctuation">,</span> <span class="token number">0.5f</span><span class="token operator">+</span>j<span class="token punctuation">,</span> <span class="token number">4.5f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        FireTime1 <span class="token operator">=</span> <span class="token number">0.5f</span><span class="token punctuation">;</span>
        FireTime2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        Cursor<span class="token punctuation">.</span><span class="token function">SetCursor</span><span class="token punctuation">(</span>pointer<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span>pointer<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>pointer<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> CursorMode<span class="token punctuation">.</span>Auto<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetButton</span><span class="token punctuation">(</span><span class="token string">"Fire1"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> Camera<span class="token punctuation">.</span>main<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            FireTime2 <span class="token operator">+=</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>FireTime2 <span class="token operator">&gt;=</span> FireTime1<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                FireTime2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">var</span></span> bullet <span class="token operator">=</span> <span class="token function">Instantiate</span><span class="token punctuation">(</span>Bullet<span class="token punctuation">)</span><span class="token punctuation">;</span>
                bullet<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position <span class="token operator">=</span> Camera<span class="token punctuation">.</span>main<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">var</span></span> r <span class="token operator">=</span> Camera<span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">ScreenPointToRay</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span>mousePosition<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">RaycastHit</span> hit<span class="token punctuation">;</span>
                <span class="token comment">// 这样会出来很多小球</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>Physics<span class="token punctuation">.</span><span class="token function">Raycast</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token keyword">out</span> hit<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    bullet<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rigidbody<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>velocity <span class="token operator">=</span> <span class="token punctuation">(</span>hit<span class="token punctuation">.</span>point <span class="token operator">-</span> bullet<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"没碰撞"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre> 
<p>当子弹和箱子不可见时，需要销毁，所以给它们附加如下的脚本</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DistroyOBj</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnBecameInvisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>可以设置摄像机的远方距离，做一下优化<br> <img src="https://images2.imgbox.com/b8/ef/Z96K3D63_o.png" alt="在这里插入图片描述"><br> 下载一个瞄准的图片素材，变成cursor<br> <img src="https://images2.imgbox.com/45/0b/bk9sZ2Gv_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_2107"></a>参考资料</h3> 
<ul><li><a href="https://blog.csdn.net/m0_64128218/article/details/128477115"><strong>【Unity自制手册】unity常用API大全——一篇文章足以（万字详解）</strong></a></li><li><a href="https://zhuanlan.zhihu.com/p/82653934" rel="nofollow">Unity 引擎渲染技术学习极简路线图</a></li><li><a href="https://www.bilibili.com/video/BV12s411g7gU?p=11" rel="nofollow">视频教程</a></li><li><a href="https://www.jb51.net/article/213752.htm" rel="nofollow">详解Unity入门之GameObject</a></li><li><a href="https://www.jb51.net/article/216421.htm" rel="nofollow">详解Unity中的ShaderGraph入门使用教程</a></li><li><a href="https://www.jb51.net/article/215774.htm" rel="nofollow">Unity3D开发教程:愤怒的小鸟</a></li><li><a href="https://blog.csdn.net/qq_33808037/article/details/129730080">Unity性能优化 - 脚本篇</a></li><li><a href="https://blog.csdn.net/qq_51701007/article/details/123504383">第一天 初识Unity脚本</a></li><li><a href="https://blog.csdn.net/Monkey_Xuan/article/details/122002175">unity 发送消息与web前端交互</a></li><li><a href="https://docs.unity.cn/cn/2019.4/Manual/PlatformDependentCompilation.html" rel="nofollow">unity预处理器指令</a></li><li><a href="https://zhuanlan.zhihu.com/p/106396562" rel="nofollow">Unity Input System 新输入系统的功能及用法介绍</a></li><li><a href="https://blog.csdn.net/qq_35030499/article/details/88658452">Unity神奇的Gizmos 辅助线框</a></li><li><a href="https://blog.csdn.net/Fly_fish1/article/details/108958053">通过Mixamo生成人物动画并导入Unity实现资源可用的方法</a></li><li><a href="https://blog.csdn.net/qq_20179331/article/details/130069155">transform.LookAt参数详解</a></li><li><a href="https://blog.csdn.net/Vitens/article/details/104597757">Unity随记(一)LookAt和LookRotation的使用</a></li><li><a href="https://blog.csdn.net/czhenya/article/details/76581118">Unity 基础 之 Vector3介绍</a></li><li><a href="https://blog.csdn.net/linuxheik/article/details/78846299">Transform.Forward和Vector3.Forward的正确使用方法</a></li><li><a href="https://www.jb51.net/article/215811.htm" rel="nofollow">unity与vue交互(无第三方插件)</a></li><li><a href="https://www.jianshu.com/p/9213443a5158" rel="nofollow">Unity动画 朝向约束 LookAtConstraint</a></li><li><a href="https://mp.weixin.qq.com/s/4_EHM783-VnS3PgRVJ8XEQ" rel="nofollow">Unity新手教程之选择你的输入方式</a></li><li><a href="https://zhuanlan.zhihu.com/p/615860475?utm_id=0" rel="nofollow">Unity110个常用组件总结笔记</a></li><li><a href="https://zhuanlan.zhihu.com/p/37710715" rel="nofollow">Unity UI之GUI使用<br> </a></li><li><a href="https://blog.csdn.net/weixin_46472622/article/details/129583483">【Unity】数据持久化路径Application.persistentDataPath</a></li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a96dd7e513f97de9ae0e023823fb7cf4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">深度学习常用数学知识</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/af6227d981709aa948437d0522c5594c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">故障排除: Vcenter Root user password expires in 0 days.</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>