<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mongodb 的常用数据操作 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mongodb 的常用数据操作" />
<meta property="og:description" content="摘要： 主要记录一些常见 的mongodb 的操作，方便以后查阅。
1.增 基本格式：
db.test_doc.insert({}) 或 db.test_doc.save({}) 样例：
db.test_doc.insert({ &#34;name&#34;:&#34;w&#34;, &#34;age&#34;:25, &#34;pretty&#34;:true }) db.test_doc.save({ &#34;name&#34;:&#34;ww&#34;, &#34;age&#34;:255, &#34;pretty&#34;:false }) 插入的文档是一个 json 格式的 object，支持嵌套。
2.查 基本格式：
db.test_doc.find({}) .projection({}) .sort({}) .skip() .limit() find：查询条件 projection：返回的文档中包含或排除哪些字段 sort：排序 skip：跳过数据量，与limit连用可以达到翻页的效果 limit：返回数量限制 findOne 是查询一条数据。
样例：
db.test_doc.find({&#34;name&#34;:&#39;s&#39;}) .projection({}) .sort({_id:-1}) .limit(100) 查询 name=s 数据，按照 _id 字段倒序排序，只返回前 100 条数据。
1）AND条件 条件并列即可，没有特殊的操作字符。
样例：
db.test_doc.find({&#34;name&#34;:&#39;s&#39;,&#34;age&#34;:18}) 2）OR条件 or 里面需要是个数组，数组里面是个object。
样例：
db.test_doc.find({$or:[{&#34;age&#34;:25},{&#34;name&#34;:&#34;w&#34;}]}) 查询 age=25 或者 name=w 的数据。
3）其他条件语句： 条件操作符中文$gt大于$gte大于等于$lt小于$lte小于等于$ne不等于//包含 db.test_doc.find({&#34;age&#34;:{$lt:90,$gt:18},&#34;name&#34;:/ww/}) 查询 25&lt;age&lt;90 且 name 包含 ww 的数据。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/5f60e9f06148692bfd59f8b68df26ea5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-18T14:38:30+08:00" />
<meta property="article:modified_time" content="2024-01-18T14:38:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mongodb 的常用数据操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>摘要：</h2> 
<p>        主要记录一些常见 的mongodb 的操作，方便以后查阅。</p> 
<p></p> 
<h2>1.增</h2> 
<p><strong>基本格式：</strong></p> 
<pre><code class="language-html">db.test_doc.insert({}) 或 db.test_doc.save({})
</code></pre> 
<p><strong>样例：</strong></p> 
<pre><code class="language-html">db.test_doc.insert({
    "name":"w",
    "age":25,
    "pretty":true
})
db.test_doc.save({
    "name":"ww",
    "age":255,
    "pretty":false
})</code></pre> 
<p>插入的文档是一个 json 格式的 object，支持嵌套。</p> 
<h2>2.查</h2> 
<p><strong>基本格式：</strong></p> 
<pre><code class="language-html">db.test_doc.find({})
   .projection({})
   .sort({})
   .skip()
   .limit()

find：查询条件
projection：返回的文档中包含或排除哪些字段
sort：排序
skip：跳过数据量，与limit连用可以达到翻页的效果
limit：返回数量限制
</code></pre> 
<p>findOne 是查询一条数据。</p> 
<p><strong>样例：</strong></p> 
<pre><code class="language-html">db.test_doc.find({"name":'s'})
   .projection({})
   .sort({_id:-1})
   .limit(100)</code></pre> 
<p>查询 name=s 数据，按照 _id 字段倒序排序，只返回前 100 条数据。</p> 
<h3><strong>1）AND条件</strong></h3> 
<p>条件并列即可，没有特殊的操作字符。</p> 
<p>样例：</p> 
<pre><code class="language-html">db.test_doc.find({"name":'s',"age":18})</code></pre> 
<h3>2）OR条件</h3> 
<p>or 里面需要是个数组，数组里面是个object。</p> 
<p>样例：</p> 
<pre><code class="language-html">db.test_doc.find({$or:[{"age":25},{"name":"w"}]})</code></pre> 
<p>查询 age=25 或者 name=w 的数据。</p> 
<h3>3）其他条件语句：</h3> 
<table><thead><tr><th>条件操作符</th><th>中文</th></tr></thead><tbody><tr><td>$gt</td><td>大于</td></tr><tr><td>$gte</td><td>大于等于</td></tr><tr><td>$lt</td><td>小于</td></tr><tr><td>$lte</td><td>小于等于</td></tr><tr><td>$ne</td><td>不等于</td></tr><tr><td>//</td><td>包含</td></tr></tbody></table> 
<pre><code class="language-html">db.test_doc.find({"age":{$lt:90,$gt:18},"name":/ww/})</code></pre> 
<p>查询 25&lt;age&lt;90 且 name 包含 ww 的数据。</p> 
<h3>4）查总数</h3> 
<pre><code class="language-html">db.test_doc.count()</code></pre> 
<h3> 5）翻页查询</h3> 
<pre><code class="language-html">db.test_doc.find({"name":'s'})
   .projection({})
   .sort({_id:-1})
   .skip(10)
   .limit(10)</code></pre> 
<p>skip =10，limit=10，即每页10个数据，这是第二页。</p> 
<h2>3.删</h2> 
<p><strong>基本格式：</strong></p> 
<pre><code class="language-html">db.test_doc.remove(
    {query},
    {justOne:&lt;bool&gt;}
)

- query:删除的文档的条件(不写时会删除全部文档)。
- justOne:如果设为 true 或 1，则只删除一个文档（不写时删除所有满足条件的文档）。

</code></pre> 
<p><strong>样例：</strong></p> 
<pre><code class="language-html">删除 name=w 的文档
db.test_doc.remove({
    "name":"w"}
)


删除 name 值包含 w 的文档
db.test_doc.remove({
    "name":/w/}
)
</code></pre> 
<h2>4.改</h2> 
<p><strong>基本格式：</strong></p> 
<pre><code class="language-html">db.col_name.update(
   {},
   {},
   {
     upsert: &lt;bool&gt;,
     multi: &lt;bool&gt;
   }
)

第一个{}：查询条件
第二个{}：修改数据
upsert : 可选，如果不存在记录，是否插入；true 为插入，默认是 false，不插入
multi : 可选，默认false,只更新找到的第一条记录；true 更新全部记录
</code></pre> 
<p><strong>样例：</strong></p> 
<pre><code class="language-html">db.test_doc.update({"name":/w/},{$set:{"age":18},$unset:"pretty"},{multi:true})</code></pre> 
<p>name 包含 w 的数据，把 age 设置为 18，并删除数据的 pretty 字段，对所有命中的数据生效。</p> 
<h2>5.数据导入/出</h2> 
<pre><code class="language-bash">#文档导入
./mongoimport -h ip:port -u user -p pwd -d db* -c c* --file filePath

#文档导出
./mongoexport -h ip:port -u user -p pwd -d db* -c c* --type=json -o filePath</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/360535a02302ba7c68d6fe61503eafd1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">sonarqube的多分支检查</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/03d61dd4e748d8037b0ddaf72400011e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">提取微信聊天记录详细教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>