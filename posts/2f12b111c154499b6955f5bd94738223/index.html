<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>统计学-R语言-8.2 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="统计学-R语言-8.2" />
<meta property="og:description" content="文章目录 前言双因子方差分析数学模型主效应分析交互效应分析正态性检验 绘制3个品种产量数据合并后的正态Q-Q图（数据：example8_2）练习 前言 本篇将继续介绍方差分析的知识。
双因子方差分析 考虑两个类别自变量对数值因变量影响的方差分析称为双因子方差分析（two-way analysis of variance）（分析两个因子(因子A和因子B)对实验结果的影响） 分析时有两种情形：
只考虑两个因子对因变量的单独影响，即主效应（main effect）（如果两个因子对实验结果的影响是相互独立的，分别判断因子A和因子B对实验数据的单独影响），这时的双因子方差分析称为只考虑主效应的双因子方差分析或无重复双因子方差分析(Two-factor without replication)
除了两个因子的主效应外，还考虑两个因子的搭配对因变量产生的交互效应（interaction effect）（如果除了因子A和因子B对实验数据的单独影响外，两个因子的搭配还会对结果产生一种新的影响），这时的双因子方差分析称为考虑交互效应的双因子方差分析或可重复双因子方差分析 (Two-factor with replication)
数学模型 如果只考虑主效应而不考虑交互效应，两个因子的每种组合可以只测得一个观察值，即K=1。但要考虑交互效应时，每种组合就必须重复测量多个观察值，一般要求每种处理的重复次数K不小于2。
为便于表述，我们引进下列记号：
就是只考虑主效应时双因子方差分析的数学模型，显然它是考虑交互效应的方差分析模型的一个特例。
主效应分析 效应检验：
提出假设
对于因子A的I个处理和因子B的J个处理，要检验因子A和因子B对因变量的影响效应，也就是检验下面的假设：
检验因子A的假设：
𝐻_0:𝛼_𝑖=0（𝑖=1,2,⋯,𝐼）（因子A的处理效应不显著）
𝐻_1:𝛼_𝑖至少有一个不等于0 （因子A的处理效应显著）
检验因子B的假设：
𝐻_0:𝛽_𝑗=0（𝑗=1,2,⋯,𝐽）（因子B的处理效应不显著）
𝐻_1:𝛽_𝑗至少有一个不等于0 （因子B的处理效应显著）
各因子的效应用误差来表示。检验上述假设时，与线性模型对应的误差分解过程如下图所示：
将各平方和（SS）除以相应的自由度df，得到各均方（MS），再将各处理均方（MSA和MSB）分别除以误差均方（MSE），即得到用于检验因子A和因子B主效应的统计量FA和FB。只考虑主效应的双因子方差分析表如下表所示：
如果两个因子的每种处理组合只测得一个观察值，即k=1，则误差平方和SSE的自由度为：df=IJ-I-J&#43;1=（I-1)(J-1）。
总平方和SST的自由度为IJ-1。
例题：
(数据：example8_5.Rdata)假定在例8-1中，除了考虑品种对产量的影响外，还考虑施肥方式对产量的影响。假定有甲、乙两种施肥方式，这样3个小麦品种和两种施肥方式的搭配共有3×2=6种组合。如果选择30个地块进行实验，每一种搭配可以做5次实验，也就是每个品种（处理）的样本量为5，即相当于每个品种（处理）重复做了5次实验。实验取得的数据如下表所示。检验小麦品种和施肥方式对产量的影响是否显著(a=0.05）
解：设品种（因子A）对产量的附加效应分别为α1（品种1）、α2（品种2）和α3(品种3)；施肥方式（因子B）对产量的附加效应分别为β1（施肥方式甲）、β2（施肥方式乙）。
检验品种效应的假设为：
H0：α1=α2=α3=0（品种对产量的影响不显著）
H1：α1，α2，α3至少有一个不等于0（品种对产量的影响显著）
检验施肥方式效应的假设为：
H0：β1=β2=0（施肥方式对产量的影响不显著）
H1：β1，β2至少有一个不等于0（施肥方式对产量的影响显著）
首先，绘制按不同品种和不同施肥方式分组的箱线图，并计算按品种和施肥方式交叉分类的均值和标准差，描述品种和施肥方式对产量的影响。R代码和结果如下所示：
# 加载数据，将表8-4的短格式数据(table8_4)转为长格式数据,并另存为example8_5 table8_4&lt;-read.csv(&#34;c:/example/ch8/table8_4.csv&#34;) table8_4&lt;-cbind(table8_4,id=c(factor(1:10))) table8_4 library(reshape) example8_5&lt;-melt(table8_4,id.vars=c(&#34;id&#34;,&#34;施肥方式&#34;)) example8_5&lt;-rename(example8_5,c(variable=&#34;品种&#34;,value=&#34;产量&#34;)) save(example8_5,file=&#34;C:/example/ch8/example8_5.RData&#34;) load(&#34;C:/example/ch8/example8_5.RData&#34;) example8_5 # 绘制品种和施肥方式的箱线图 attach(example8_5) boxplot(产量~品种&#43;施肥方式,col=c(&#34;gold&#34;,&#34;green&#34;,&#34;red&#34;),ylab=&#34;产量&#34;,xlab=&#34;品种与施肥方式&#34;,data=example8_5) # 按品种和施肥方式交叉分类计算均值和标准差 library(reshape) library(agricolae) mystats&lt;-function(x)(c(n=length(x),mean=mean(x),sd=sd(x))) dfm&lt;-melt(example8_5,measure." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/2f12b111c154499b6955f5bd94738223/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-27T09:40:06+08:00" />
<meta property="article:modified_time" content="2024-01-27T09:40:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">统计学-R语言-8.2</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_6" rel="nofollow">前言</a></li><li><a href="#_13" rel="nofollow">双因子方差分析</a></li><li><ul><li><a href="#_18" rel="nofollow">数学模型</a></li><li><a href="#_28" rel="nofollow">主效应分析</a></li><li><a href="#_121" rel="nofollow">交互效应分析</a></li><li><a href="#_205" rel="nofollow">正态性检验</a></li></ul> 
  </li><li><a href="#3QQexample8_2_234" rel="nofollow">绘制3个品种产量数据合并后的正态Q-Q图（数据：example8_2）</a></li><li><a href="#_327" rel="nofollow">练习</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_6"></a>前言</h2> 
<p>本篇将继续介绍方差分析的知识。</p> 
<hr> 
<h2><a id="_13"></a>双因子方差分析</h2> 
<p>考虑两个类别自变量对数值因变量影响的方差分析称为双因子方差分析（two-way analysis of variance）（分析两个因子(因子A和因子B)对实验结果的影响） 分析时有两种情形：<br> 只考虑两个因子对因变量的单独影响，即主效应（main effect）（如果两个因子对实验结果的影响是相互独立的，分别判断因子A和因子B对实验数据的单独影响），这时的双因子方差分析称为只考虑主效应的双因子方差分析或无重复双因子方差分析(Two-factor without replication)<br> 除了两个因子的主效应外，还考虑两个因子的搭配对因变量产生的交互效应（interaction effect）（如果除了因子A和因子B对实验数据的单独影响外，两个因子的搭配还会对结果产生一种新的影响），这时的双因子方差分析称为考虑交互效应的双因子方差分析或可重复双因子方差分析 (Two-factor with replication)</p> 
<h3><a id="_18"></a>数学模型</h3> 
<p>如果只考虑主效应而不考虑交互效应，两个因子的每种组合可以只测得一个观察值，即K=1。但要考虑交互效应时，每种组合就必须重复测量多个观察值，一般要求每种处理的重复次数K不小于2。<br> 为便于表述，我们引进下列记号：<br> <img src="https://images2.imgbox.com/ae/3f/RpXfLgHx_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/48/cd/fHGI24Vg_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c8/24/KIfwv6q3_o.png" alt="在这里插入图片描述"><br> 就是只考虑主效应时双因子方差分析的数学模型，显然它是考虑交互效应的方差分析模型的一个特例。<br> <img src="https://images2.imgbox.com/d1/da/1FBNg9MG_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_28"></a>主效应分析</h3> 
<p>效应检验：<br> 提出假设<br> 对于因子A的I个处理和因子B的J个处理，要检验因子A和因子B对因变量的影响效应，也就是检验下面的假设：<br> 检验因子A的假设：<br> 𝐻_0:𝛼_𝑖=0（𝑖=1,2,⋯,𝐼）（因子A的处理效应不显著）<br> 𝐻_1:𝛼_𝑖至少有一个不等于0 （因子A的处理效应显著）<br> 检验因子B的假设：<br> 𝐻_0:𝛽_𝑗=0（𝑗=1,2,⋯,𝐽）（因子B的处理效应不显著）<br> 𝐻_1:𝛽_𝑗至少有一个不等于0 （因子B的处理效应显著）<br> 各因子的效应用误差来表示。检验上述假设时，与线性模型对应的误差分解过程如下图所示：<br> <img src="https://images2.imgbox.com/af/73/w2oXnRWQ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b4/20/k54GxvMn_o.png" alt="在这里插入图片描述"></p> 
<p>将各平方和（SS）除以相应的自由度df，得到各均方（MS），再将各处理均方（MSA和MSB）分别除以误差均方（MSE），即得到用于检验因子A和因子B主效应的统计量FA和FB。只考虑主效应的双因子方差分析表如下表所示：<br> <img src="https://images2.imgbox.com/bd/12/KkyVpcqd_o.png" alt="在这里插入图片描述"><br> 如果两个因子的每种处理组合只测得一个观察值，即k=1，则误差平方和SSE的自由度为：df=IJ-I-J+1=（I-1)(J-1）。<br> 总平方和SST的自由度为IJ-1。</p> 
<p>例题：<br> (数据：example8_5.Rdata)假定在例8-1中，除了考虑品种对产量的影响外，还考虑施肥方式对产量的影响。假定有甲、乙两种施肥方式，这样3个小麦品种和两种施肥方式的搭配共有3×2=6种组合。如果选择30个地块进行实验，每一种搭配可以做5次实验，也就是每个品种（处理）的样本量为5，即相当于每个品种（处理）重复做了5次实验。实验取得的数据如下表所示。检验小麦品种和施肥方式对产量的影响是否显著(a=0.05）<br> <img src="https://images2.imgbox.com/74/58/SvUkAmgw_o.png" alt="在这里插入图片描述"><br> 解：设品种（因子A）对产量的附加效应分别为α1（品种1）、α2（品种2）和α3(品种3)；施肥方式（因子B）对产量的附加效应分别为β1（施肥方式甲）、β2（施肥方式乙）。<br> 检验品种效应的假设为：<br> H0：α1=α2=α3=0（品种对产量的影响不显著）<br> H1：α1，α2，α3至少有一个不等于0（品种对产量的影响显著）<br> 检验施肥方式效应的假设为：<br> H0：β1=β2=0（施肥方式对产量的影响不显著）<br> H1：β1，β2至少有一个不等于0（施肥方式对产量的影响显著）<br> 首先，绘制按不同品种和不同施肥方式分组的箱线图，并计算按品种和施肥方式交叉分类的均值和标准差，描述品种和施肥方式对产量的影响。R代码和结果如下所示：</p> 
<pre><code class="prism language-r"><span class="token comment">#  加载数据，将表8-4的短格式数据(table8_4)转为长格式数据,并另存为example8_5</span>

table8_4<span class="token operator">&lt;-</span>read.csv<span class="token punctuation">(</span><span class="token string">"c:/example/ch8/table8_4.csv"</span><span class="token punctuation">)</span>
table8_4<span class="token operator">&lt;-</span>cbind<span class="token punctuation">(</span>table8_4<span class="token punctuation">,</span>id<span class="token operator">=</span>c<span class="token punctuation">(</span>factor<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
table8_4

library<span class="token punctuation">(</span>reshape<span class="token punctuation">)</span>
example8_5<span class="token operator">&lt;-</span>melt<span class="token punctuation">(</span>table8_4<span class="token punctuation">,</span>id.vars<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span><span class="token string">"施肥方式"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
example8_5<span class="token operator">&lt;-</span>rename<span class="token punctuation">(</span>example8_5<span class="token punctuation">,</span>c<span class="token punctuation">(</span>variable<span class="token operator">=</span><span class="token string">"品种"</span><span class="token punctuation">,</span>value<span class="token operator">=</span><span class="token string">"产量"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

save<span class="token punctuation">(</span>example8_5<span class="token punctuation">,</span>file<span class="token operator">=</span><span class="token string">"C:/example/ch8/example8_5.RData"</span><span class="token punctuation">)</span>
load<span class="token punctuation">(</span><span class="token string">"C:/example/ch8/example8_5.RData"</span><span class="token punctuation">)</span>
example8_5
</code></pre> 
<p><img src="https://images2.imgbox.com/b5/8a/O3dlaety_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-r"><span class="token comment">#  绘制品种和施肥方式的箱线图</span>

attach<span class="token punctuation">(</span>example8_5<span class="token punctuation">)</span>
boxplot<span class="token punctuation">(</span>产量<span class="token operator">~</span>品种<span class="token operator">+</span>施肥方式<span class="token punctuation">,</span>col<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"gold"</span><span class="token punctuation">,</span><span class="token string">"green"</span><span class="token punctuation">,</span><span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ylab<span class="token operator">=</span><span class="token string">"产量"</span><span class="token punctuation">,</span>xlab<span class="token operator">=</span><span class="token string">"品种与施肥方式"</span><span class="token punctuation">,</span>data<span class="token operator">=</span>example8_5<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/70/2c/b3hFsbIq_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-r"><span class="token comment">#  按品种和施肥方式交叉分类计算均值和标准差</span>

library<span class="token punctuation">(</span>reshape<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>agricolae<span class="token punctuation">)</span>
mystats<span class="token operator">&lt;-</span><span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">(</span>c<span class="token punctuation">(</span>n<span class="token operator">=</span>length<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>mean<span class="token operator">=</span>mean<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>sd<span class="token operator">=</span>sd<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
dfm<span class="token operator">&lt;-</span>melt<span class="token punctuation">(</span>example8_5<span class="token punctuation">,</span>measure.vars<span class="token operator">=</span><span class="token string">"产量"</span><span class="token punctuation">,</span>id.vars<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token string">"品种"</span><span class="token punctuation">,</span><span class="token string">"施肥方式"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
cast<span class="token punctuation">(</span>dfm<span class="token punctuation">,</span>品种<span class="token operator">+</span>施肥方式<span class="token operator">+</span>variable<span class="token operator">~</span>.<span class="token punctuation">,</span>mystats<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/79/3a/W2wtuJe2_o.png" alt="在这里插入图片描述"><br> 从图中可以看出，无论采用哪种施肥方式，品种2的产量都较低，品种1和品种3的产量差异不大；<br> 施肥方式甲的产量比施肥方式乙低。从分组计算的均值也可以得到与箱线图相同的结论。但它们对产量的影响是否显著还需要进一步做方差分析。R代码和结果如下所示：</p> 
<pre><code class="prism language-r"><span class="token comment">#  主效应方差分析结果</span>

model_2wm<span class="token operator">&lt;-</span>aov<span class="token punctuation">(</span>产量<span class="token operator">~</span>品种<span class="token operator">+</span>施肥方式<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>model_2wm<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/80/99/TXQIuUt2_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-r"><span class="token comment">#  主效应方差分析模型的参数估计</span>

model_2wm<span class="token operator">$</span>coefficients
</code></pre> 
<p><img src="https://images2.imgbox.com/4f/16/Uuuu1JRq_o.png" alt="在这里插入图片描述"><br> 由方差分析表可知，检验品种和施肥方式两个因子的P值（Pr(&gt;F))均接近于0，表示两个因子对产量均有显著影响。</p> 
<p>上图中的截距（Intercept）是模型 <img src="https://images2.imgbox.com/d7/71/XFNKlXTM_o.png" alt="在这里插入图片描述">中的常数项μ，它表示不考虑品种和施肥方式影响时产量的均值为80kg。接下来是对品种的影响效应 <img src="https://images2.imgbox.com/e7/68/HzfUKSGe_o.png" alt="在这里插入图片描述">和施肥方式的影响效应 <img src="https://images2.imgbox.com/75/36/WqZUXdh3_o.png" alt="在这里插入图片描述">的估计。由于3个品种共有3个参数，在估计模型的参数时，将第一个水平（本例为品种1）作为参照水平，这相当于强迫α1=0，而另外两个参数（品种2和品种3）的估计值实际上就是与参照水平相比较的结果。比如，品种2的参数α2=-10，表示品种2对产量的附加效应；施肥方式的参数β1=8，表示施肥方式为乙时对产量的附加效应（施肥方式甲作为参照水平）等等。</p> 
<h3><a id="_121"></a>交互效应分析</h3> 
<p>1、效应检验：<br> 如果除了考虑品种和施肥方式两个因子的主效应外，还考虑两个因子搭配对产量的交互作用，则方差分析的模型为：<br> <img src="https://images2.imgbox.com/88/a7/ekU5hApy_o.png" alt="在这里插入图片描述"></p> 
<p>对于因子A的I个处理和因子B的J个处理，要检验因子A的效应、因子B的效应、两个因子的交互效应，也就是检验如下假设：</p> 
<p>检验因子A的假设：<br> 𝐻_0:𝛼_𝑖=0（𝑖=1,2,⋯,𝐼）（因子A的处理效应不显著）<br> 𝐻_1:𝛼_𝑖至少有一个不等于0 （因子A的处理效应显著）<br> 检验因子B的假设：<br> 𝐻_0:𝛽_𝑗=0（𝑗=1,2,⋯,𝐽）（因子B的处理效应不显著）<br> 𝐻_1:𝛽_𝑗至少有一个不等于0 （因子B的处理效应显著）<br> 检验交互效应的假设：<br> 𝐻_0:𝛾_𝑖𝑗=0（交互效应不显著）<br> 𝐻_1:𝛾_𝑖𝑗至少有一个不等于0（交互效应显著）</p> 
<p>1、效应检验：<br> 检验上述假设时，与方差分析模型对应的总误差分解过程可用下面的图表示<br> <img src="https://images2.imgbox.com/99/3d/2rSVrTjP_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d7/ac/nUtYzTp3_o.png" alt="在这里插入图片描述"><br> 根据上述误差分解原理，可以构建用于检验的统计量FA，FB，FAB。其原理与只考虑主效应的双因子方差分析类似，其方差分析表如下表所示：</p> 
<p><img src="https://images2.imgbox.com/99/95/b18BdUDT_o.png" alt="在这里插入图片描述"></p> 
<p>例题：<br> （数据： example8_5. RData）沿用8-5。检验品种、施肥方式及其交互效应对产量的影响是否显著(α=0.05）<br> 解：设品种对产量的附加效应分别为α1（种1）、α2（品种2）和α3（品种3）；施肥方式对产量的附加效应分别为β1（方式甲）、β2（方式乙）；交互效应为<br> 检验品种效应的假设为：<br> H0：α1=α2=α3=0（品种对产量的影响不显著）<br> H1：α1，α2，α3至少有一个不等于0（品种对产量的影响显著）<br> 检验施肥方式效应的假设为：<br> H0：β1=β2=0（施肥方式对产量的影响不显著）<br> H1：β1，β2至少有一个不等于0（施肥方式对产量的影响显著）<br> <img src="https://images2.imgbox.com/95/38/JjG4YtTh_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-r"><span class="token comment">#  交互效应方差分析表</span>

attach<span class="token punctuation">(</span>example8_5<span class="token punctuation">)</span>
fit<span class="token operator">&lt;-</span> aov<span class="token punctuation">(</span>产量<span class="token operator">~</span>品种 <span class="token operator">+</span> 施肥方式 <span class="token operator">+</span> 品种<span class="token operator">:</span>施肥方式<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fit<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5a/76/k8lzmSjZ_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-r"><span class="token comment">#  交互效应方差分析模型的参数估计</span>

fit<span class="token operator">$</span>coefficients
</code></pre> 
<p><img src="https://images2.imgbox.com/8d/df/z8gSFZME_o.png" alt="在这里插入图片描述"><br> 方差分析表显示，检验品种和施肥方式的P均小于0.05，表示两个因子对产量的影响均显著，而检验交互效应的P=0.379，大于0.05，表示交互效应对产量的影响不显著。</p> 
<pre><code class="prism language-r"><span class="token comment">#  绘制品种和施肥方式的主效应和交互效应图</span>

library<span class="token punctuation">(</span>HH<span class="token punctuation">)</span>
interaction2wt<span class="token punctuation">(</span>产量<span class="token operator">~</span>施肥方式<span class="token operator">+</span>品种<span class="token punctuation">,</span>data<span class="token operator">=</span>example8_5<span class="token punctuation">)</span>
</code></pre> 
<p>注：函数 interaction2wt（x，…）用于绘制多因子设计的主效应和交互效应，x为方差分析的对象</p> 
<p>图中的箱线图反映了每个因子的主效应，可观察品种和施肥方式对产量是否有影响;<br> 折线图反映了两个因子的交互效应。由于图中的各条折线基本上是平行的表示两个因子间无明显的交互效应（无交互效应时，一个因子各处理间均值的差异不会随另一个因子处理的变化而变化，各条折线是平行的。如果各条线明显不平行或之间有交叉，则意味着两个因子的各处理间存在交互效应）。</p> 
<p><img src="https://images2.imgbox.com/8d/72/I6Kgi77G_o.png" alt="在这里插入图片描述"></p> 
<p>为比较主效应方差分析模型和交互效应方差分析模型是否有显著差异，可采用R中的 anova函数比较两个模型。比较主效应模型（ model_2wm）和交互效应模型（ model_2vi）的R代码和结果如下所示：</p> 
<pre><code class="prism language-r">model_2wm<span class="token operator">&lt;-</span>lm<span class="token punctuation">(</span>产量<span class="token operator">~</span>品种<span class="token operator">+</span>施肥方式<span class="token punctuation">,</span>data<span class="token operator">=</span>example8_5<span class="token punctuation">)</span>
model_2wi<span class="token operator">&lt;-</span>lm<span class="token punctuation">(</span>产量<span class="token operator">~</span>品种<span class="token operator">+</span>施肥方式<span class="token operator">+</span>品种<span class="token operator">:</span>施肥方式<span class="token punctuation">,</span>data<span class="token operator">=</span>example8_5<span class="token punctuation">)</span>
anova<span class="token punctuation">(</span>model_2wm<span class="token punctuation">,</span>model_2wi<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/1e/68/x3QO5ObO_o.png" alt="在这里插入图片描述"></p> 
<p>注：函数anova（object，…）用于计算方差分析表。用 anova比较模型时，一个模型必须包含在另一个模型中，也就是说，较小的模型中的所有项必须出现在较大的模型中。比如在本例中， Model1：产量<sub>品种+施肥方式，Mode2：产量</sub>品种+施肥方式+品种：施肥方式。Model1中的所有项 都包含在Model2中。</p> 
<p>该检验的原假设是两个模型无显著差异。图中显示了两个模型的残差平方和（RSS）、交互效应平方和（Sum of Sq）、检验统计量（F）及其相应的P值。由于P=0.3793，不拒绝原假设，没有证据显示两个模型有显著差异，这也从另一个角度佐证了交互效应不显著。从简化分析的角度看，就本例而言，采用主效应模型比较合适。</p> 
<p>需要注意的是，有两个实验因子时，考虑交互效应的方差分析与分别对两个因子做单因子方差分析是不同的。对两个因子分别做单因子方差分析实际上是假定两个因子间不存在交互效应，当两个因子间存在交互效应时可能会得出错误结论。因此，当有两个因子时，应首先考虑使用交互效应方差分析模型，当交互效应不显著时，再考虑使用主效应方差分析模型，或者考虑使用两个因子的单因子方差分析模型。</p> 
<h3><a id="_205"></a>正态性检验</h3> 
<p>方差分析的基本假定：<br> 在方差分析模型中，假定误差项是期望值为0、方差相等的正态独立随机变量，在做方差分析之前，应首先对这些假定进行检验，考察数据是否适合做方差分析。<br> 正态性(normality)。每个总体都应服从正态分布，即对于因子的每一个水平，其观测值是来自正态分布总体的简单随机样本<br> 在例8-1中，要求每个品种的产量必须服从正态分布<br> 检验总体是否服从正态分布的方法有很多，包括对样本数据作直方图、茎叶图、箱线图、正态概率图做描述性判断，也可以进行非参数检验等<br> 正态性检验(图示法)<br> 绘制因变量的正态概率图<br> 当每个处理的样本量足够大时，可以对每个样本绘制正态概率图来检查每个处理对应的总体是否服从正态分布<br> 当每个处理的样本量比较小时，正态概率图中的点很少，提供的正态性信息很有限。这时，可以将每个处理的样本数据合并绘制一个正态概率图来检验正态性</p> 
<p>例：沿用例8-2。分别用Q-Q图和检验方法，检验各品种小麦产量是否服从正态分布（α=0.05）<br> 解：首先，绘制Q-Q图来检验小麦产量是否服从正态分布。当每个处理的样本量足够大时，可以对每个样本绘制Q-Q图来检查每个处理对应的总体是否服从正态分布。但是，当每个处理的样本量比较小时，正态概率图中的点很少，提供的正态性信息有限。这时，可以将每个处理的样本数据合并绘制一幅正态概率图来检验正态性。R代码和结果如下所示</p> 
<pre><code class="prism language-r">load<span class="token punctuation">(</span><span class="token string">"C:/example/ch8/example8_1.RData"</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>mfrow<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
qqnorm<span class="token punctuation">(</span>example8_1<span class="token operator">$</span>品种<span class="token number">1</span><span class="token punctuation">,</span>xlab<span class="token operator">=</span><span class="token string">"期望正态值"</span><span class="token punctuation">,</span>ylab<span class="token operator">=</span><span class="token string">"观察值"</span><span class="token punctuation">,</span>datax<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span>main<span class="token operator">=</span><span class="token string">"品种1的Q-Q图"</span><span class="token punctuation">)</span>
qqline<span class="token punctuation">(</span>example8_1<span class="token operator">$</span>品种<span class="token number">1</span><span class="token punctuation">,</span>datax<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
qqnorm<span class="token punctuation">(</span>example8_1<span class="token operator">$</span>品种<span class="token number">2</span><span class="token punctuation">,</span>xlab<span class="token operator">=</span><span class="token string">"期望正态值"</span><span class="token punctuation">,</span>ylab<span class="token operator">=</span><span class="token string">"观察值"</span><span class="token punctuation">,</span>datax<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span>main<span class="token operator">=</span><span class="token string">"品种2的Q-Q图"</span><span class="token punctuation">)</span>
qqline<span class="token punctuation">(</span>example8_1<span class="token operator">$</span>品种<span class="token number">2</span><span class="token punctuation">,</span>datax<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
qqnorm<span class="token punctuation">(</span>example8_1<span class="token operator">$</span>品种<span class="token number">3</span><span class="token punctuation">,</span>xlab<span class="token operator">=</span><span class="token string">"期望正态值"</span><span class="token punctuation">,</span>ylab<span class="token operator">=</span><span class="token string">"观察值"</span><span class="token punctuation">,</span>datax<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span>main<span class="token operator">=</span><span class="token string">"品种3的Q-Q图"</span><span class="token punctuation">)</span>
qqline<span class="token punctuation">(</span>example8_1<span class="token operator">$</span>品种<span class="token number">3</span><span class="token punctuation">,</span>datax<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4a/fb/ykpjyleW_o.png" alt="在这里插入图片描述"><br> 由于图中对每个品种绘制的正态概率图只有10个数据点，很难提供正态性的证据。但从3个品种的产量数据合并后绘制的Q-Q图（下页图）可以看出，产量基本上服从正态分布。<br> 其次，分别采用 Shapiro-Wilk检验和KS检验来判断产量是否服从正态分布。R代码和结果如下所示</p> 
<h2><a id="3QQexample8_2_234"></a>绘制3个品种产量数据合并后的正态Q-Q图（数据：example8_2）</h2> 
<pre><code class="prism language-r">load<span class="token punctuation">(</span><span class="token string">"C:/example/ch8/example8_2.RData"</span><span class="token punctuation">)</span>
par<span class="token punctuation">(</span>cex<span class="token operator">=</span><span class="token number">.8</span><span class="token punctuation">,</span>mai<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">.7</span><span class="token punctuation">,</span><span class="token number">.7</span><span class="token punctuation">,</span><span class="token number">.1</span><span class="token punctuation">,</span><span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
qqnorm<span class="token punctuation">(</span>example8_2<span class="token operator">$</span>产量<span class="token punctuation">,</span>xlab<span class="token operator">=</span><span class="token string">"期望正态值"</span><span class="token punctuation">,</span>ylab<span class="token operator">=</span><span class="token string">"观察值"</span><span class="token punctuation">,</span>data<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span>main<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
qqline<span class="token punctuation">(</span>example8_2<span class="token operator">$</span>产量<span class="token punctuation">,</span>datax<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">,</span>col<span class="token operator">=</span><span class="token string">"red"</span><span class="token punctuation">,</span>lwd<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
op<span class="token operator">&lt;-</span>par<span class="token punctuation">(</span>fig<span class="token operator">=</span>c<span class="token punctuation">(</span><span class="token number">.08</span><span class="token punctuation">,</span><span class="token number">.5</span><span class="token punctuation">,</span><span class="token number">.5</span><span class="token punctuation">,</span><span class="token number">.98</span><span class="token punctuation">)</span><span class="token punctuation">,</span>new<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
hist<span class="token punctuation">(</span>example8_2<span class="token operator">$</span>产量<span class="token punctuation">,</span>xlab<span class="token operator">=</span><span class="token string">"产量"</span><span class="token punctuation">,</span>ylab<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span>freq<span class="token operator">=</span><span class="token boolean">FALSE</span><span class="token punctuation">,</span>col<span class="token operator">=</span><span class="token string">"lightblue"</span><span class="token punctuation">,</span> cex.axis<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>cex.lab<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>main<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
lines<span class="token punctuation">(</span>density<span class="token punctuation">(</span>example8_2<span class="token operator">$</span>产量<span class="token punctuation">)</span><span class="token punctuation">,</span>col<span class="token operator">=</span><span class="token string">"red"</span><span class="token punctuation">,</span>lwd<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span> 
box<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/90/be/VCf0eIZa_o.png" alt="在这里插入图片描述"><br> 正态性检验(检验法)<br> 当样本量较小时，正态概率图的应用就会受到很大限制，这时可以使用标准的统计检验<br> 如Shapiro-Wilk检验、Kolmogorov-Smirnov检验等，均可以做正态性检验。这些检验的原假设是因变量服从正态分布<br> 如果检验获得的P值小于指定的显著性水平，则拒绝原假设，表明总体不服从正态分布，如果P值较大不能拒绝原假设时，可以认为总体满足正态分布<br> 这些检验对正态性的轻微偏离是敏感的，检验往往导致拒绝原假设。而方差分析对正态性的要求则相对比较宽松，当正态性略微不满足时，对分析结果的影响不是很大。因此，实际中应谨慎使用这些检验。</p> 
<p>##每个品种产量的正态性检验</p> 
<pre><code class="prism language-r"><span class="token comment"># 品种1 的正态性检验：</span>

load<span class="token punctuation">(</span><span class="token string">"C:/example/ch8/example8_2.RData"</span><span class="token punctuation">)</span>
 attach<span class="token punctuation">(</span>example8_2<span class="token punctuation">)</span>
 shapiro.test<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>品种<span class="token operator">==</span><span class="token string">'品种1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
 ks.test<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>品种<span class="token operator">==</span><span class="token string">'品种1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"pnorm"</span><span class="token punctuation">,</span>mean<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>品种<span class="token operator">==</span><span class="token string">'品种1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sd<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>品种<span class="token operator">==</span><span class="token string">'品种1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2c/d7/SO6knaMr_o.png" alt="在这里插入图片描述"></p> 
<p>##每个品种产量的正态性检验</p> 
<pre><code class="prism language-r"><span class="token comment"># 品种2 的正态性检验：</span>

shapiro.test<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>品种<span class="token operator">==</span><span class="token string">'品种2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ks.test<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>品种<span class="token operator">==</span><span class="token string">'品种2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"pnorm"</span><span class="token punctuation">,</span>mean<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>品种<span class="token operator">==</span><span class="token string">'品种2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sd<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>品种<span class="token operator">==</span><span class="token string">'品种2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/60/3d/ig1oUfHv_o.png" alt="在这里插入图片描述"></p> 
<p>##每个品种产量的正态性检验</p> 
<pre><code class="prism language-r"><span class="token comment"># 品种3 的正态性检验：</span>

shapiro.test<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>品种<span class="token operator">==</span><span class="token string">'品种3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ks.test<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>品种<span class="token operator">==</span><span class="token string">'品种3'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"pnorm"</span><span class="token punctuation">,</span>mean<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>品种<span class="token operator">==</span><span class="token string">'品种3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sd<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>品种<span class="token operator">==</span><span class="token string">'品种3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/7a/a8/fbSRYIeo_o.png" alt="在这里插入图片描述"><br> ##三个品种产量数据合并后的检验</p> 
<pre><code class="prism language-r"><span class="token comment"># shapiro正态性检验</span>

load<span class="token punctuation">(</span><span class="token string">"C:/example/ch8/example8_2.RData"</span><span class="token punctuation">)</span>
attach<span class="token punctuation">(</span>example8_2<span class="token punctuation">)</span>
shapiro.test<span class="token punctuation">(</span>产量<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/bc/6b/w5dY78De_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-r"><span class="token comment"># K-S正态性检验</span>

ks.test<span class="token punctuation">(</span>产量<span class="token punctuation">,</span><span class="token string">"pnorm"</span><span class="token punctuation">,</span>mean<span class="token punctuation">(</span>产量<span class="token punctuation">)</span><span class="token punctuation">,</span>sd<span class="token punctuation">(</span>产量<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/13/b2/X9qZ9gzX_o.png" alt="在这里插入图片描述"><br> ##双因子方差分析：Shapiro-Wilk正态性检验和k-s检验（数据：example8_5）</p> 
<pre><code class="prism language-r"><span class="token comment"># 施肥方式甲 的产量正态性检验：</span>

load<span class="token punctuation">(</span><span class="token string">"C:/example/ch8/example8_5.RData"</span><span class="token punctuation">)</span>
attach<span class="token punctuation">(</span>example8_5<span class="token punctuation">)</span>
shapiro.test<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>施肥方式<span class="token operator">==</span><span class="token string">'甲'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ks.test<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>施肥方式<span class="token operator">==</span><span class="token string">'甲'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"pnorm"</span><span class="token punctuation">,</span>mean<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>施肥方式<span class="token operator">==</span><span class="token string">'甲'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sd<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>施肥方式<span class="token operator">==</span><span class="token string">'甲'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/6d/e6/2uB39ZTt_o.png" alt="在这里插入图片描述"><br> ##双因子方差分析：Shapiro-Wilk正态性检验和k-s检验（数据：example8_5）</p> 
<pre><code class="prism language-r"><span class="token comment"># 施肥方式乙的产量正态性检验：</span>

shapiro.test<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>施肥方式<span class="token operator">==</span><span class="token string">'乙'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ks.test<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>施肥方式<span class="token operator">==</span><span class="token string">'乙'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"pnorm"</span><span class="token punctuation">,</span>mean<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>施肥方式<span class="token operator">==</span><span class="token string">'乙'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>sd<span class="token punctuation">(</span>产量<span class="token punctuation">[</span>施肥方式<span class="token operator">==</span><span class="token string">'乙'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/76/a8/5ta97Nnh_o.png" alt="在这里插入图片描述"><br> 上述两种检验方法几乎P&gt;0.05，不拒绝H0，可以认为产量服从正态分布。</p> 
<hr> 
<h2><a id="_327"></a>练习</h2> 
<p>1、一家牛奶公司有4台机器装填牛奶，每桶的容量为4L。下面是从4台机器中抽取的装填量样本数据。<br> 检验装填量是否满足正态性质？<br> <img src="https://images2.imgbox.com/94/72/RTfIOESa_o.png" alt="在这里插入图片描述"><br> 解：提出假设：<br> H0: 机器对装填量的影响不显著<br> H1：机器对装填量的影响显著</p> 
<pre><code class="prism language-r"><span class="token comment">#绘制出箱线图</span>

load<span class="token punctuation">(</span><span class="token string">"C:/example/ch8/exercise8_1.RData"</span><span class="token punctuation">)</span>
exercise8_1
attach<span class="token punctuation">(</span>exercise8_1<span class="token punctuation">)</span>
boxplot<span class="token punctuation">(</span>填装量<span class="token operator">~</span>机器<span class="token punctuation">,</span>data<span class="token operator">=</span>exercise8_1<span class="token punctuation">,</span>col<span class="token operator">=</span><span class="token string">"gold"</span><span class="token punctuation">,</span>main<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span>ylab<span class="token operator">=</span><span class="token string">"填装量"</span><span class="token punctuation">,</span> xlab<span class="token operator">=</span><span class="token string">"机器"</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/26/35/hYcEAspg_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-r"> <span class="token comment">#  方差分析表</span>
 
attach<span class="token punctuation">(</span>example8_2<span class="token punctuation">)</span>
model_1w<span class="token operator">&lt;-</span>aov<span class="token punctuation">(</span>填装量<span class="token operator">~</span>机器<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>model_1w<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e8/c7/dQU5IgE5_o.png" alt="在这里插入图片描述"><br> 方差分析表显示了机器效应和随机效应的平方和（Sum Sq）、自由度（Df）、均方（Mean Sq）、检验统计量值（F value）、检验的P值（Pr（&gt;F））。由于P=0.0135&lt;0.05,拒绝原假设，机器对填装量的影响效应显著。</p> 
<pre><code class="prism language-r"><span class="token comment">#  方差分析模型的参数估计</span>

model_1w<span class="token operator">$</span>coefficients
</code></pre> 
<p><img src="https://images2.imgbox.com/22/c5/da2s0x3O_o.png" alt="在这里插入图片描述"></p> 
<p>2、（exercise8_4）有5个不同品种的种子和4个不同的施肥方案，在20块同样面积的土地上分别采用5种种子和4个施肥方案搭配进行实验，取得的产量数据如下：<br> 检验不同品种和施肥方案对产量的影响是否显著(α=0.05)<br> <img src="https://images2.imgbox.com/76/e2/rCFGxAeT_o.png" alt="在这里插入图片描述"><br> 解：<br> 检验路段效应的假设为：<br> H0：α1=α2=α3=0（路段对行车时间的影响不显著）<br> H1：α1，α2，α3至少有一个不等于0（路段对行车时间的影响显著）<br> 检验时段效应的假设为：<br> H0：β1=β2=0（时段对行车时间的影响不显著）<br> H1：β1，β2至少有一个不等于0（时段对行车时间的影响显著）</p> 
<p><img src="https://images2.imgbox.com/bc/f4/TJtE845R_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-r">load<span class="token punctuation">(</span><span class="token string">"C:/example/ch8/exercise8_5.RData"</span><span class="token punctuation">)</span>
exercise8_5
<span class="token comment">#  交互效应方差分析表</span>
attach<span class="token punctuation">(</span>exercise8_5<span class="token punctuation">)</span>
fit<span class="token operator">&lt;-</span> aov<span class="token punctuation">(</span>行车时间<span class="token operator">~</span>时段 <span class="token operator">+</span> 路段 <span class="token operator">+</span> 时段<span class="token operator">:</span>路段<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>fit<span class="token punctuation">)</span>
</code></pre> 
<p>方差分析表显示，检验时段和路段的P值均小于0.05，表示两个因子对行车时间的影响均显著，而检验交互效应的P=0.997，大于0.05，表示交互效应对行车时间的影响不显著。<br> <img src="https://images2.imgbox.com/35/9b/9VT9Rxcq_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f312a453bd4f27689a8b9c2faf0366e4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android 基础技术——RecyclerView</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/569a5872dbf9e2c9a2b0668d29a79949/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C语言通过IXMLHttpRequest以get或post方式发送http请求获取服务器文本或xml数据</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>