<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>粒子群算法及C&#43;&#43;实现 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="粒子群算法及C&#43;&#43;实现" />
<meta property="og:description" content="参考博客 https://www.cnblogs.com/alan666/p/8311804.html
https://blog.csdn.net/weixin_39059031/article/details/103723843
https://blog.csdn.net/weixin_40679412/article/details/80571854
https://blog.csdn.net/daaikuaichuan/article/details/81382794
https://blog.csdn.net/luotuo44/article/details/33690179
https://www.cnblogs.com/esCharacter/p/9564660.html
https://blog.csdn.net/weixin_39059031/article/details/103723843
一、原理 1. 鸟群捕食行为 一个鸟群在某区域寻找食物，且这一区域仅有一份食物。鸟群不知道这份食物在哪里，但知道食物距离他们多远以及同伴的位置。鸟群怎样尽快找到食物？搜索目前离食物最近的鸟所在区域，并向这片区域靠拢。
把食物所在位置当做最优点，鸟离食物的距离作为函数适应度，则可以把鸟群寻找食物的过程看做函数寻优的过程。由此受到启发，提出了粒子群算法。
2. 粒子群算法 粒子群算法，又称粒子群优化算法（Partical Swarm Optimization），是近年发展起来的一种新的进化算法（Evolutionary Algorithm - EA），由Eberhart 博士和kennedy 博士于1995年提出，其源于对鸟群捕食的行为研究。 这种算法模拟了人类的社会行为。个体在学习自身经验的同时相互交换信息，由此，种群成员可以逐渐移到问题空间中较好的区域。
2.1 抽象 粒子：把每只鸟抽象成一个无质量无体积的微粒，优化寻找最优解的过程相当于鸟群寻找食物的过程。速度：粒子在问题的搜索空间中以一定的速度飞行，这个速度决定它的飞行方向和距离，速度根据粒子本身的飞行经验和同伴的飞行经验来动态调整。适应值：粒子需要一个由目标函数所确定的适应值，来评价粒子的“好坏”程度。 PSO算法先将一群粒子初始化（位置随机），然后通过迭代寻找最优解。每次迭代中，粒子通过跟踪两个“极值”来更新自身位置。这两个极值一个是粒子本身找到的最优解，称为个体极值pBest，另一个是整个种群目前找到的最优解，称为全局极值gBest。 2.2 算法流程 初始化每个粒子群：群体规模N，每个粒子的位置xi 和速度Vi 。计算每个粒子的适应度值F[i]。对每个粒子，用它的适应度值F[i] 和个体极值Pbest(i) 比较，如果F[i] &gt; Pbest(i)，则用F[i]替换Pbest(i)。对每个粒子，用它的适应度值F[i] 和全局极值gbest(i) 比较，如果F[i] &gt; gbest(i)，则用F[i]替换gbest(i)。根据公式 2.3 中公式更新粒子位置x与速度Vi 。如果满足结束条件（误差达到要求或达到最大循环次数）则退出，否则返回步骤 2。
2.3 相关公式 将粒子延伸到N维空间，则N维空间中粒子的位置、飞行速度为矢量，粒子根据如下公式更新速度与位置：
其中w是惯性权重（加权系数），代表粒子上一轮速度对本轮的影响程度；
c1和c2是学习因子（加速度系数），代表粒子向自身最优（自我总结）和群体最优学习的能力。
rand()为0~1的随机数。
2.4 参数设置 粒子数量：一般取1~40. 其实对于大部分的问题10个粒子已经足够可以取得好的结果；粒子的维度：由优化问题决定，如本次实验为二元函数的优化问题，所以维度为2；粒子的范围:：即粒子的移动区间范围，由优化问题决定，每一维可以设定不同的范围；W：一般取值在0.1~0.9之间，对优化影响较大，w取值较大时，有利于跳出局部最优点，w取值较小时有利于算法收敛；学习因子：通常设c1 = c2 = 2，范围为0~4；粒子的速度：表示粒子在一次迭代中可移动的最大距离，通常根据函数自变量取值范围来设定，例如x 属于 [-10, 10], 那么 Vmax 的大小就是 20； 二、例子 1. 题目 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/3693de3b5f5a683a061879abc0a7afb2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-12T11:38:07+08:00" />
<meta property="article:modified_time" content="2021-01-12T11:38:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">粒子群算法及C&#43;&#43;实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="_0"></a>参考博客</h4> 
<p><a href="https://www.cnblogs.com/alan666/p/8311804.html" rel="nofollow">https://www.cnblogs.com/alan666/p/8311804.html</a><br> <a href="https://blog.csdn.net/weixin_39059031/article/details/103723843">https://blog.csdn.net/weixin_39059031/article/details/103723843</a><br> <a href="https://blog.csdn.net/weixin_40679412/article/details/80571854">https://blog.csdn.net/weixin_40679412/article/details/80571854</a><br> <a href="https://blog.csdn.net/daaikuaichuan/article/details/81382794">https://blog.csdn.net/daaikuaichuan/article/details/81382794</a><br> <a href="https://blog.csdn.net/luotuo44/article/details/33690179">https://blog.csdn.net/luotuo44/article/details/33690179</a><br> <a href="https://www.cnblogs.com/esCharacter/p/9564660.html" rel="nofollow">https://www.cnblogs.com/esCharacter/p/9564660.html</a><br> <a href="https://blog.csdn.net/weixin_39059031/article/details/103723843">https://blog.csdn.net/weixin_39059031/article/details/103723843</a></p> 
<h2><a id="_8"></a>一、原理</h2> 
<h3><a id="1__9"></a>1. 鸟群捕食行为</h3> 
<p>一个鸟群在某区域寻找食物，且这一区域仅有一份食物。鸟群不知道这份食物在哪里，但知道食物距离他们多远以及同伴的位置。鸟群怎样尽快找到食物？搜索目前离食物最近的鸟所在区域，并向这片区域靠拢。<br> 把食物所在位置当做最优点，鸟离食物的距离作为函数适应度，则可以把鸟群寻找食物的过程看做函数寻优的过程。由此受到启发，提出了粒子群算法。</p> 
<h3><a id="2__12"></a>2. 粒子群算法</h3> 
<p>粒子群算法，又称粒子群优化算法（Partical Swarm Optimization），是近年发展起来的一种新的进化算法（Evolutionary Algorithm - EA），由Eberhart 博士和kennedy 博士于1995年提出，其源于对鸟群捕食的行为研究。 这种算法模拟了人类的社会行为。<strong>个体在学习自身经验的同时相互交换信息</strong>，由此，种群成员可以逐渐移到问题空间中较好的区域。</p> 
<h4><a id="21__14"></a>2.1 抽象</h4> 
<ol><li><strong>粒子</strong>：把每只鸟抽象成一个无质量无体积的微粒，优化寻找最优解的过程相当于鸟群寻找食物的过程。</li><li><strong>速度</strong>：粒子在问题的搜索空间中以一定的速度飞行，这个速度决定它的飞行方向和距离，速度根据粒子本身的飞行经验和同伴的飞行经验来动态调整。</li><li><strong>适应值</strong>：粒子需要一个由目标函数所确定的适应值，来评价粒子的“好坏”程度。 PSO算法先将一群粒子初始化（位置随机），然后通过迭代寻找最优解。每次迭代中，粒子通过跟踪两个“极值”来更新自身位置。这两个极值一个是粒子本身找到的最优解，称为<strong>个体极值pBest</strong>，另一个是整个种群目前找到的最优解，称为<strong>全局极值gBest</strong>。</li></ol> 
<h4><a id="22__18"></a>2.2 算法流程</h4> 
<ol><li>初始化每个粒子群：群体规模N，每个粒子的位置xi 和速度Vi 。</li><li>计算每个粒子的适应度值F[i]。</li><li>对每个粒子，用它的适应度值F[i] 和个体极值Pbest(i) 比较，如果F[i] &gt; Pbest(i)，则用F[i]替换Pbest(i)。</li><li>对每个粒子，用它的适应度值F[i] 和全局极值gbest(i) 比较，如果F[i] &gt; gbest(i)，则用F[i]替换gbest(i)。</li><li>根据公式 2.3 中公式更新粒子位置x与速度Vi 。如果满足结束条件（误差达到要求或达到最大循环次数）则退出，否则返回步骤 2。<br> <img src="https://images2.imgbox.com/08/e6/H414YejX_o.png" alt="在这里插入图片描述"></li></ol> 
<h4><a id="23__25"></a>2.3 相关公式</h4> 
<p>将粒子延伸到N维空间，则N维空间中粒子的位置、飞行速度为矢量，粒子根据如下公式更新速度与位置：<br> <img src="https://images2.imgbox.com/10/c2/cVlRlyoE_o.png" alt="在这里插入图片描述"><br> 其中w是惯性权重（加权系数），代表粒子上一轮速度对本轮的影响程度；<br> c1和c2是学习因子（加速度系数），代表粒子向自身最优（自我总结）和群体最优学习的能力。<br> rand()为0~1的随机数。</p> 
<h4><a id="24__31"></a>2.4 参数设置</h4> 
<ol><li>粒子数量：一般取1~40. 其实对于大部分的问题10个粒子已经足够可以取得好的结果；</li><li>粒子的维度：由优化问题决定，如本次实验为二元函数的优化问题，所以维度为2；</li><li>粒子的范围:：即粒子的移动区间范围，由优化问题决定，每一维可以设定不同的范围；</li><li>W：一般取值在0.1~0.9之间，对优化影响较大，w取值较大时，有利于跳出局部最优点，w取值较小时有利于算法收敛；</li><li>学习因子：通常设c1 = c2 = 2，范围为0~4；</li><li>粒子的速度：表示粒子在一次迭代中可移动的最大距离，通常根据函数自变量取值范围来设定，例如x 属于 [-10, 10], 那么 Vmax 的大小就是 20；</li></ol> 
<h2><a id="_39"></a>二、例子</h2> 
<h3><a id="1__40"></a>1. 题目</h3> 
<p><img src="https://images2.imgbox.com/7d/d3/JqnAoGos_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2__42"></a>2. 关键代码</h3> 
<h4><a id="21__43"></a>2.1 数据结构</h4> 
<p>本次实验数据结构设置较为简单，粒子的位置、速度和最优位置均设置为二维数组，行为粒子数量，列为函数维度。除此之外粒子群对应的适应度设为一维数组，粒子群整体最优位置设为长度为维度的数组，具体代码片如下：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">double</span> P<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">[</span>dim<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token comment">//粒子位置</span>
<span class="token keyword">double</span> V<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">[</span>dim<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token comment">//粒子速度</span>
<span class="token keyword">double</span> fitness<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token comment">//粒子适应度</span>
<span class="token keyword">double</span> pbest<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">[</span>dim<span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">//粒子最优位置</span>

<span class="token keyword">double</span> gbest<span class="token punctuation">[</span>dim<span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token comment">//粒子群最优位置</span>
</code></pre> 
<h4><a id="22__54"></a>2.2 粒子速度与位置的更新</h4> 
<p>使用2.3中公式对粒子位置与状态进行更新。本次实验中粒子维度为2，所以需要对每个粒子的位置与速度的两个分量分别进行更新。然后更新粒子适应值，若新的适应值大于粒子的个体最优位置，则更新粒子的个体最优位置，最后再比较是否获得更优的群体最优位置，若更优则更新群体最优位置，具体代码片如下：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token comment">//更新速度</span>
				V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> w <span class="token operator">*</span> V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">rand</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>pbest<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
					<span class="token operator">+</span> <span class="token function">rand</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>gbest<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> vmin<span class="token punctuation">)</span>
					V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> vmin<span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&gt;</span> vmax<span class="token punctuation">)</span>
					V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> vmax<span class="token punctuation">;</span>

				<span class="token comment">//更新位置</span>
				P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> pmin<span class="token punctuation">)</span>
					P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> pmin<span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&gt;</span> pmax<span class="token punctuation">)</span>
					P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> pmax<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			fitness<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">(</span>P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//更新适应度</span>

			<span class="token comment">//更新个体最优</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>fitness<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token function">func</span><span class="token punctuation">(</span>pbest<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				
pbest<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				pbest<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

		<span class="token punctuation">}</span>

		<span class="token comment">//更新整体最优</span>
		index <span class="token operator">=</span> <span class="token function">getGbestIndex</span><span class="token punctuation">(</span>fitness<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">func</span><span class="token punctuation">(</span>P<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">func</span><span class="token punctuation">(</span>gbest<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			gbest<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> P<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			gbest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> P<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			gbestGen <span class="token operator">=</span> g <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="23__100"></a>2.3 随机数生成（新接触）</h4> 
<p><strong>C++11 : default_random_engine</strong><br> 是C++11提供了新的随机数生成器，随机数引擎default_random_engine，使用时包含头文件#include&lt;<strong>random</strong>&gt;；默认情况下，default_random_engine的生成范围是一个unsigned，可以通过方法min()和max()获取生成范围；与rand()类似，default_random_engine也需要通过随机数种子改变生成的序列，设置方法可以通过调用方法seed()；随机数引擎可以通过分布对象设置生成范围，uniform_int_distribution&lt;<strong>unsigned</strong>&gt;或uniform_real_distribution&lt;<strong>double</strong>&gt;；相对rand()，可以使用uniform_real_distribution&lt;&gt;生成随机浮点数，并且不用担心精度问题，使用方法如下：</p> 
<pre><code class="prism language-cpp">    default_random_engine e<span class="token punctuation">;</span><span class="token comment">//定义随机数引擎</span>
    uniform_int_distribution<span class="token operator">&lt;</span><span class="token keyword">unsigned</span><span class="token operator">&gt;</span> <span class="token function">id</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//整型分布</span>
    uniform_real_distribution<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token function">dd</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//浮点型分布</span>
     e<span class="token punctuation">.</span><span class="token function">seed</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置随机数种子</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token function">id</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" ; "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">dd</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="3__114"></a>3. 结果</h3> 
<ol><li> <p>当w设为0.6时，算法收敛较快，经过多次运行，大约在80代左右收敛。<br> <img src="https://images2.imgbox.com/de/4e/LHOxMBLN_o.png" alt="在这里插入图片描述"></p> </li><li> <p>当w设为0.9时，收敛较慢，大于要到280代左右才可收敛：<br> <img src="https://images2.imgbox.com/93/3d/XKAgdQ9m_o.png" alt="在这里插入图片描述"></p> </li><li> <p>分析<br> 在代码实现的具体过程中，遇到的问题主要是参数设置的问题。其中粒子速度与位置范围的设定一直不合适，导致粒子群在第二轮迭代时，大多数粒子会超过设定的边界，虽然将超出边界的粒子速度与位置设为边界值，但因为是大数粒子越界，所以后面的迭代也就没有了意义。通过在网络上查询相关博客，得到的解决办法是粒子速度与位置边界设定与函数的自变量和值域相关，经过分析，大概得出本次实验要优化的函数，在（0,0）位置时取得最优解，所以将粒子速度范围设为（-0.5,0.5），最终得到了较好的效果，不会再出现大量粒子越界的情况。<br> 回想此次实验，应该还是不对，如果提前知道收敛点大概在哪，再设置参数，算法还有意义吗？</p> </li></ol> 
<h3><a id="4__124"></a>4. 源代码</h3> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;random&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//使用c++实现粒子群算法</span>
<span class="token comment">//需要寻优的非线性函数为：</span>
<span class="token comment">//f(x,y) = sin(sqrt(x^2+y^2))/(sqrt(x^2+y^2)) + exp((cos(2*PI*x)+cos(2*PI*y))/2) - 2.71289</span>
<span class="token comment">//该函数有很多局部极大值点，而极限位置为(0,0),在(0,0)附近取得极大值</span>

<span class="token comment">// Author: yuzewei</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>             <span class="token comment">//粒子群数量</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> dim <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token comment">//粒子群维度</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> gen <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span><span class="token comment">//100;    //迭代次数</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> PI <span class="token operator">=</span> <span class="token number">3.1415926</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> w <span class="token operator">=</span> <span class="token number">0.9</span><span class="token punctuation">;</span><span class="token comment">//0.6;   //惯性权重</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> c1 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">// 1.49445;     //自学习，学习因子</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> c2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// 1.49445;    //群体最优学习，学习因子</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> pmin <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">;</span>     <span class="token comment">//粒子的移动区间范围</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> pmax <span class="token operator">=</span> <span class="token number">2.0</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> vmin <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0.8</span><span class="token punctuation">;</span><span class="token comment">// -0.5;   //粒子的移动速度范围</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> vmax <span class="token operator">=</span> <span class="token number">0.8</span><span class="token punctuation">;</span><span class="token comment">// 0.5;</span>

<span class="token keyword">double</span> P<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">[</span>dim<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token comment">//粒子位置</span>
<span class="token keyword">double</span> V<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">[</span>dim<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token comment">//粒子速度</span>
<span class="token keyword">double</span> fitness<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token comment">//粒子适应度</span>
<span class="token keyword">double</span> pbest<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">[</span>dim<span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">//粒子最优位置</span>

<span class="token keyword">double</span> gbest<span class="token punctuation">[</span>dim<span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token comment">//粒子群最优位置</span>
<span class="token keyword">int</span> gbestGen <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>      <span class="token comment">//记录达到最优位置时的迭代次数</span>

<span class="token keyword">double</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>p<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>
	<span class="token keyword">double</span> y <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> result <span class="token operator">=</span> <span class="token function">sin</span><span class="token punctuation">(</span><span class="token function">sqrt</span><span class="token punctuation">(</span>x <span class="token operator">*</span> x <span class="token operator">+</span> y <span class="token operator">*</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token function">sqrt</span><span class="token punctuation">(</span>x <span class="token operator">*</span> x <span class="token operator">+</span> y <span class="token operator">*</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span> 
		            <span class="token operator">+</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> PI <span class="token operator">*</span> x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">cos</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> PI <span class="token operator">*</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2.71289</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">getGbestIndex</span><span class="token punctuation">(</span><span class="token keyword">double</span> <span class="token operator">*</span>fit<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> max <span class="token operator">=</span> <span class="token operator">*</span>fit<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>fit <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">&gt;</span> max<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			max <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>fit <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
			index <span class="token operator">=</span> i<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> index<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//记录位置最佳的粒子编号</span>

	default_random_engine e<span class="token punctuation">;</span>
	uniform_real_distribution<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token function">rand1</span><span class="token punctuation">(</span>pmin<span class="token punctuation">,</span> pmax<span class="token punctuation">)</span><span class="token punctuation">;</span>
	uniform_real_distribution<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token function">rand2</span><span class="token punctuation">(</span>vmin<span class="token punctuation">,</span> vmax<span class="token punctuation">)</span><span class="token punctuation">;</span>
	e<span class="token punctuation">.</span><span class="token function">seed</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">rand1</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
			V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">rand2</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
			pbest<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		fitness<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">(</span>P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	index <span class="token operator">=</span> <span class="token function">getGbestIndex</span><span class="token punctuation">(</span>fitness<span class="token punctuation">)</span><span class="token punctuation">;</span>
	gbest<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> pbest<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	gbest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> pbest<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	gbestGen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">printParticles</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">/*for (int i = 0; i &lt; N; i++)
	{
		cout &lt;&lt; "第" &lt;&lt; i &lt;&lt; "个粒子" &lt;&lt; endl;
		cout &lt;&lt; "  位置：(" &lt;&lt; P[i][0] &lt;&lt; "," &lt;&lt; P[i][1] &lt;&lt; ")" &lt;&lt; endl;
		cout &lt;&lt; "  速度：(" &lt;&lt; V[i][0] &lt;&lt; "," &lt;&lt; V[i][1] &lt;&lt; ")" &lt;&lt; endl;
		cout &lt;&lt; "  适应度：" &lt;&lt; fitness[i] &lt;&lt; endl;
		cout &lt;&lt; "  个体最优：(" &lt;&lt; pbest[i][0] &lt;&lt; "," &lt;&lt; pbest[i][1] &lt;&lt; ")" &lt;&lt; endl;
	}*/</span>
	<span class="token comment">//cout &lt;&lt; endl;</span>
	cout<span class="token operator">&lt;&lt;</span><span class="token string">"群体最优：("</span> <span class="token operator">&lt;&lt;</span> gbest<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">","</span> <span class="token operator">&lt;&lt;</span> gbest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">")"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"适应度为："</span> <span class="token operator">&lt;&lt;</span> <span class="token function">func</span><span class="token punctuation">(</span>gbest<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">PSOiterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"开始迭代！"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"第1代粒子群："</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token function">printParticles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> g <span class="token operator">&lt;</span> gen <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> g<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"第"</span> <span class="token operator">&lt;&lt;</span> g <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"代粒子群："</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

		<span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//记录最优粒子个体编号</span>

		default_random_engine e<span class="token punctuation">;</span>
		uniform_real_distribution<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		e<span class="token punctuation">.</span><span class="token function">seed</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token comment">//更新速度</span>
				V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> w <span class="token operator">*</span> V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">rand</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>pbest<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
					<span class="token operator">+</span> <span class="token function">rand</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>gbest<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> vmin<span class="token punctuation">)</span>
					V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> vmin<span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&gt;</span> vmax<span class="token punctuation">)</span>
					V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> vmax<span class="token punctuation">;</span>

				<span class="token comment">//更新位置</span>
				P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> V<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> pmin<span class="token punctuation">)</span>
					P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> pmin<span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&gt;</span> pmax<span class="token punctuation">)</span>
					P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> pmax<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			fitness<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">(</span>P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//更新适应度</span>

			<span class="token comment">//更新个体最优</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>fitness<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token function">func</span><span class="token punctuation">(</span>pbest<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				pbest<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				pbest<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

		<span class="token punctuation">}</span>

		<span class="token comment">//更新整体最优</span>
		index <span class="token operator">=</span> <span class="token function">getGbestIndex</span><span class="token punctuation">(</span>fitness<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">func</span><span class="token punctuation">(</span>P<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">func</span><span class="token punctuation">(</span>gbest<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			gbest<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> P<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			gbest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> P<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			gbestGen <span class="token operator">=</span> g <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token function">printParticles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">printResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"迭代结束！"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"总共进行了"</span> <span class="token operator">&lt;&lt;</span> gen <span class="token operator">&lt;&lt;</span> <span class="token string">"次迭代，"</span><span class="token punctuation">;</span>
	cout<span class="token operator">&lt;&lt;</span><span class="token string">"第"</span><span class="token operator">&lt;&lt;</span>gbestGen<span class="token operator">&lt;&lt;</span><span class="token string">"代得到最优位置:("</span> <span class="token operator">&lt;&lt;</span> gbest<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">","</span> <span class="token operator">&lt;&lt;</span> gbest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">")"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"此位置对应的函数值为："</span> <span class="token operator">&lt;&lt;</span> <span class="token function">func</span><span class="token punctuation">(</span>gbest<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">PSOiterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8178e10a0c6f8dfb6a64786c3ca4ad80/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">错误码_显示Finder无法完成此项作业(错误码-36)解决方法来了</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cdfb013c5599a3464561e2cea1639ff9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">如何设画面大小_投影仪怎么调节画面大小？如何将投影仪铺满全屏？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>