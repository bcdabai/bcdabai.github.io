<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【MySQL 第19章_数据库备份与恢复】 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【MySQL 第19章_数据库备份与恢复】" />
<meta property="og:description" content="第19章_数据库备份与恢复 1. 物理备份与逻辑备份2. mysqldump实现逻辑备份 2.1 备份一个数据库2.2 备份全部数据库2.3 备份部分数据库2.4 备份部分表2.5 备份单表的部分数据2.6 排除某些表的备份2.7 只备份结构或只备份数据2.8 备份中包含存储过程、函数、事件2.9 mysqldump常用选项 3. mysql命令恢复数据 3.1 单库备份中恢复单库3.2 全量备份恢复3.3 从全量备份中恢复单库3.4 从单库备份中恢复单表 4. 物理备份：直接复制整个数据库5.物理恢复：直接复制到数据库目录6. 表的导出与导入 6.1 表的导出6.2 表的导入 7. 数据库迁移 7.1 概述7.2 迁移方案 物理迁移逻辑迁移 7.3 迁移注意点 1. 相同版本的数据库之间迁移注意点2. 不同版本的数据库之间迁移注意点3. 不同数据库之间迁移注意点 7.4 迁移小结 8. 删库了不敢跑，能干点啥？ 8.1 delete：误删行8.2 truncate/drop ：误删库/表8.3 延迟复制备库8.4 预防误删库/表的方法8.5 rm：误删MySQL实例 9.附录：MySQL常用命令 9.1 mysql 1. 连接选项2. 执行选项 9.2 mysqladmin9.3 mysqlbinlog9.4 mysqldump 1. 连接选项2. 输出内容选项 9.5 mysqlimport/source9.6 mysqlshow 说明：本内容整理自尚硅谷B站MySQL视频&gt;&gt;尚硅谷B站MySQL视频
在任何数据库环境中，总会有不确定的意外情况发生，比如例外的停电、计算机系统中的各种软硬件故障、人为破坏、管理员误操作等是不可避免的，这些情况可能会导致数据的丢失、服务器瘫痪等严重的后果。存在多个服务器时，会出现主从服务器之间的数据同步问题。
为了有效防止数据丢失，并将损失降到最低，应定期对MySQL数据库服务器做备份。如果数据库中的数据丢失或者出现错误，可以使用备份的数据进行恢复。主从服务器之间的数据同步问题可以通过复制功能实现。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b430aa2dd7fd4e879558e2784a0be3b0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-28T20:58:17+08:00" />
<meta property="article:modified_time" content="2022-09-28T20:58:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【MySQL 第19章_数据库备份与恢复】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="19__0"></a>第19章_数据库备份与恢复</h4> 
<ul><li> 
  <ul><li><a href="#1_09_10" rel="nofollow">1. 物理备份与逻辑备份</a></li><li><a href="#2_mysqldump_15" rel="nofollow">2. mysqldump实现逻辑备份</a></li><li> 
    <ul><li> 
      <ul><li><a href="#21__17" rel="nofollow">2.1 备份一个数据库</a></li><li><a href="#22__118" rel="nofollow">2.2 备份全部数据库</a></li><li><a href="#23__124" rel="nofollow">2.3 备份部分数据库</a></li><li><a href="#24__139" rel="nofollow">2.4 备份部分表</a></li><li><a href="#25__259" rel="nofollow">2.5 备份单表的部分数据</a></li><li><a href="#26__277" rel="nofollow">2.6 排除某些表的备份</a></li><li><a href="#27__290" rel="nofollow">2.7 只备份结构或只备份数据</a></li><li><a href="#28__311" rel="nofollow">2.8 备份中包含存储过程、函数、事件</a></li><li><a href="#29_mysqldump_418" rel="nofollow">2.9 mysqldump常用选项</a></li></ul> </li></ul> </li><li><a href="#3_09mysql_487" rel="nofollow">3. mysql命令恢复数据</a></li><li> 
    <ul><li> 
      <ul><li><a href="#31__494" rel="nofollow">3.1 单库备份中恢复单库</a></li><li><a href="#32__509" rel="nofollow">3.2 全量备份恢复</a></li><li><a href="#33__517" rel="nofollow">3.3 从全量备份中恢复单库</a></li><li><a href="#34__527" rel="nofollow">3.4 从单库备份中恢复单表</a></li></ul> </li></ul> </li><li><a href="#4_09_551" rel="nofollow">4. 物理备份：直接复制整个数据库</a></li><li><a href="#5_578" rel="nofollow">5.物理恢复：直接复制到数据库目录</a></li><li><a href="#6_09_598" rel="nofollow">6. 表的导出与导入</a></li><li> 
    <ul><li> 
      <ul><li><a href="#61__599" rel="nofollow">6.1 表的导出</a></li><li><a href="#62__865" rel="nofollow">6.2 表的导入</a></li></ul> </li></ul> </li><li><a href="#7_09_968" rel="nofollow">7. 数据库迁移</a></li><li> 
    <ul><li> 
      <ul><li><a href="#71__969" rel="nofollow">7.1 概述</a></li><li><a href="#72__976" rel="nofollow">7.2 迁移方案</a></li><li> 
        <ul><li><a href="#_977" rel="nofollow">物理迁移</a></li><li><a href="#_983" rel="nofollow">逻辑迁移</a></li></ul> </li><li><a href="#73__986" rel="nofollow">7.3 迁移注意点</a></li><li> 
        <ul><li><a href="#1_09_987" rel="nofollow">1. 相同版本的数据库之间迁移注意点</a></li><li><a href="#2_09_1004" rel="nofollow">2. 不同版本的数据库之间迁移注意点</a></li><li><a href="#3_09_1013" rel="nofollow">3. 不同数据库之间迁移注意点</a></li></ul> </li><li><a href="#74__1024" rel="nofollow">7.4 迁移小结</a></li></ul> </li></ul> </li><li><a href="#8_09_1027" rel="nofollow">8. 删库了不敢跑，能干点啥？</a></li><li> 
    <ul><li> 
      <ul><li><a href="#81_delete_1028" rel="nofollow">8.1 delete：误删行</a></li><li><a href="#82_truncatedrop__1038" rel="nofollow">8.2 truncate/drop ：误删库/表</a></li><li><a href="#83__1052" rel="nofollow">8.3 延迟复制备库</a></li><li><a href="#84__1058" rel="nofollow">8.4 预防误删库/表的方法</a></li><li><a href="#85_rmMySQL_1068" rel="nofollow">8.5 rm：误删MySQL实例</a></li></ul> </li></ul> </li><li><a href="#9MySQL_1071" rel="nofollow">9.附录：MySQL常用命令</a></li><li> 
    <ul><li> 
      <ul><li><a href="#91_mysql_1072" rel="nofollow">9.1 mysql</a></li><li> 
        <ul><li><a href="#1_09_1080" rel="nofollow">1. 连接选项</a></li><li><a href="#2_09_1092" rel="nofollow">2. 执行选项</a></li></ul> </li><li><a href="#92_mysqladmin_1104" rel="nofollow">9.2 mysqladmin</a></li><li><a href="#93_mysqlbinlog_1117" rel="nofollow">9.3 mysqlbinlog</a></li><li><a href="#94_mysqldump_1132" rel="nofollow">9.4 mysqldump</a></li><li> 
        <ul><li><a href="#1_09_1142" rel="nofollow">1. 连接选项</a></li><li><a href="#2_09_1151" rel="nofollow">2. 输出内容选项</a></li></ul> </li><li><a href="#95_mysqlimportsource_1169" rel="nofollow">9.5 mysqlimport/source</a></li><li><a href="#96_mysqlshow_1186" rel="nofollow">9.6 mysqlshow</a></li></ul> </li></ul> </li></ul> </li></ul> 
<hr> 
<p>说明：本内容整理自尚硅谷B站MySQL视频<a href="https://www.bilibili.com/video/BV1iq4y1u7vj?p=195" rel="nofollow">&gt;&gt;尚硅谷B站MySQL视频</a></p> 
<hr> 
<p>在任何数据库环境中，总会有不确定的意外情况发生，比如例外的停电、计算机系统中的各种软硬件故障、人为破坏、管理员误操作等是不可避免的，这些情况可能会导致数据的丢失、服务器瘫痪等严重的后果。存在多个服务器时，会出现主从服务器之间的数据同步问题。</p> 
<p>为了有效防止数据丢失，并将损失降到最低，应定期对MySQL数据库服务器做备份。如果数据库中的数据丢失或者出现错误，可以使用备份的数据进行恢复。主从服务器之间的数据同步问题可以通过复制功能实现。</p> 
<h3><a id="1__63"></a>1. 物理备份与逻辑备份</h3> 
<p><code>**物理备份：**</code>备份数据文件，转储数据库物理文件到某一目录。物理备份恢复速度比较快，但占用空间比较大，MySQL中可以用 xtrabackup 工具来进行物理备份。</p> 
<p><code>**逻辑备份**：</code>对数据库对象利用工具进行导出工作，汇总入备份文件内。逻辑备份恢复速度慢，但占用空间小，更灵活。MySQL 中常用的逻辑备份工具为 mysqldump 。逻辑备份就是 备份sql语句 ，在恢复的时候执行备份的sql语句实现数据库数据的重现。</p> 
<h3><a id="2_mysqldump_69"></a>2. mysqldump实现逻辑备份</h3> 
<p>mysqldump是MySQL提供的一个非常有用的数据库备份工具</p> 
<h5><a id="21__73"></a>2.1 备份一个数据库</h5> 
<p>mysqldump命令执行时，可以将数据库备份成一个文本文件，该文件中实际上包含多个CREATE和INSERT语句，使用这些语句可以重新创建表和插入数据。</p> 
<ul><li>查出需要备份的表的结构，在文本文件中生成一个CREATE语句</li><li>将表中的所有记录转换成一条INSERT语句。</li></ul> 
<pre><code>**基本语法：**
mysqldump –u 用户名称 –h 主机名称 –p密码 待备份的数据库名称[tbname, [tbname...]]&gt; 备份文件名称.sql
</code></pre> 
<blockquote> 
 <p>说明： 备份的文件并非一定要求后缀名为.sql，例如后缀名为.txt的文件也是可以的。</p> 
</blockquote> 
<p>举例：使用root用户备份atguigu数据库：</p> 
<pre><code class="prism language-sql">mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p atguigu<span class="token operator">&gt;</span>atguigu<span class="token punctuation">.</span><span class="token keyword">sql</span>	<span class="token comment">#备份文件存储在当前目录下</span>
mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p atguigudb1 <span class="token operator">&gt;</span> <span class="token operator">/</span>var<span class="token operator">/</span>lib<span class="token operator">/</span>mysql<span class="token operator">/</span>atguigu<span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre> 
<p>备份文件剖析：</p> 
<pre><code class="prism language-sql"><span class="token comment">--	MySQL dump 10.13  Distrib 8.0.26, for Linux (x86_64)</span>

<span class="token comment">--	</span>

<span class="token comment">-- Host: localhost	Database: atguigu</span>

<span class="token comment">-- ------------------------------------------------------ -- Server version 8.0.26</span>


<span class="token comment">/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */</span><span class="token punctuation">;</span> <span class="token comment">/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */</span><span class="token punctuation">;</span> <span class="token comment">/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */</span><span class="token punctuation">;</span> <span class="token comment">/*!50503 SET NAMES utf8mb4 */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40103 SET TIME_ZONE='+00:00' */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */</span><span class="token punctuation">;</span> <span class="token comment">/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */</span><span class="token punctuation">;</span>
 
<span class="token comment">/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */</span><span class="token punctuation">;</span>

<span class="token comment">--</span>

<span class="token comment">--	Current Database: `atguigu`</span>

<span class="token comment">--	</span>

<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token comment">/*!32312 IF NOT EXISTS*/</span> <span class="token identifier"><span class="token punctuation">`</span>atguigu<span class="token punctuation">`</span></span> <span class="token comment">/*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci */</span> <span class="token comment">/*!80016 DEFAULT ENCRYPTION='N' */</span><span class="token punctuation">;</span>

<span class="token keyword">USE</span> <span class="token identifier"><span class="token punctuation">`</span>atguigu<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment">--</span>

<span class="token comment">-- Table structure for table `student`</span>

<span class="token comment">--</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span><span class="token punctuation">;</span>		
<span class="token comment">/*!40101	SET	@saved_cs_client	=	@@character_set_client */</span><span class="token punctuation">;</span>
<span class="token comment">/*!50503	SET	character_set_client =	utf8mb4 */</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>

<span class="token identifier"><span class="token punctuation">`</span>studentno<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

<span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

<span class="token identifier"><span class="token punctuation">`</span>class<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>studentno<span class="token punctuation">`</span></span><span class="token punctuation">)</span>

<span class="token punctuation">)</span>	<span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8mb3<span class="token punctuation">;</span>

<span class="token comment">/*!40101 SET character_set_client = @saved_cs_client */</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'张三_back'</span><span class="token punctuation">,</span><span class="token string">'一班'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token string">'一班'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'王五'</span><span class="token punctuation">,</span><span class="token string">'二班'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token string">'赵六'</span><span class="token punctuation">,</span><span class="token string">'二班'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token string">'钱七'</span><span class="token punctuation">,</span><span class="token string">'&gt;三班'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token string">'zhang3_update'</span><span class="token punctuation">,</span><span class="token string">'1ban'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">'wang5'</span><span class="token punctuation">,</span><span class="token string">'2ban'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*!40000 ALTER TABLE `student` ENABLE KEYS */</span><span class="token punctuation">;</span>

<span class="token keyword">UNLOCK</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span>

<span class="token punctuation">.</span>

<span class="token punctuation">.</span>

<span class="token punctuation">.</span>

<span class="token punctuation">.</span>

<span class="token comment">/*!40101 SET SQL_MODE=@OLD_SQL_MODE */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */</span><span class="token punctuation">;</span> <span class="token comment">/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */</span><span class="token punctuation">;</span> <span class="token comment">/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */</span><span class="token punctuation">;</span> <span class="token comment">/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */</span><span class="token punctuation">;</span> <span class="token comment">-- Dump completed on 2022-01-07 9:58:23</span>
</code></pre> 
<h5><a id="22__173"></a>2.2 备份全部数据库</h5> 
<p>若想用mysqldump备份整个实例，可以使用 --all-databases 或 -A 参数：</p> 
<pre><code class="prism language-sql">mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>pxxxxxx <span class="token comment">--all-databases &gt; all_database.sql mysqldump -uroot -pxxxxxx -A &gt; all_database.sql</span>
</code></pre> 
<h5><a id="23__181"></a>2.3 备份部分数据库</h5> 
<p>使用 --databases 或 -B 参数了，该参数后面跟数据库名称，多个数据库间用空格隔开。如果指定databases参数，备份文件中会存在创建数据库的语句，如果不指定参数，则不存在。语法如下：</p> 
<pre><code class="prism language-sql">mysqldump –u <span class="token keyword">user</span> –h host –p <span class="token comment">--databases [数据库的名称1 [数据库的名称2...]] &gt; 备份文件名称.sql</span>
</code></pre> 
<p>举例：</p> 
<pre><code class="prism language-sql">mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p <span class="token comment">--databases atguigu atguigu12 &gt;two_database.sql</span>
</code></pre> 
<p>或</p> 
<pre><code class="prism language-sql">mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p <span class="token operator">-</span>B atguigu atguigu12 <span class="token operator">&gt;</span> two_database<span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre> 
<h5><a id="24__201"></a>2.4 备份部分表</h5> 
<p>比如，在表变更前做个备份。语法如下：</p> 
<pre><code class="prism language-sql">mysqldump	–u <span class="token keyword">user</span> –h host –p 数据库的名称	<span class="token punctuation">[</span>表名<span class="token number">1</span> <span class="token punctuation">[</span>表名<span class="token number">2.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> 备份文件名称<span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre> 
<p>举例：备份atguigu数据库下的book表</p> 
<pre><code class="prism language-sql">mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p atguigu book<span class="token operator">&gt;</span> book<span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre> 
<p>book.sql文件内容如下</p> 
<pre><code class="prism language-sql">mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p atguigu book<span class="token operator">&gt;</span> book<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token operator">^</span>C
<span class="token punctuation">[</span>root<span class="token variable">@node1</span> <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># ls</span>
kk	kubekey kubekey<span class="token operator">-</span>v1<span class="token punctuation">.</span><span class="token number">1.1</span><span class="token operator">-</span>linux<span class="token operator">-</span>amd64<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz README<span class="token punctuation">.</span>md test1<span class="token punctuation">.</span><span class="token keyword">sql</span> two_database<span class="token punctuation">.</span><span class="token keyword">sql</span> <span class="token punctuation">[</span>root<span class="token variable">@node1</span> <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># mysqldump -uroot -p atguigu book&gt; book.sql</span>
Enter password: <span class="token punctuation">[</span>root<span class="token variable">@node1</span> <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># ls</span>
book<span class="token punctuation">.</span><span class="token keyword">sql</span> kk kubekey kubekey<span class="token operator">-</span>v1<span class="token punctuation">.</span><span class="token number">1.1</span><span class="token operator">-</span>linux<span class="token operator">-</span>amd64<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz README<span class="token punctuation">.</span>md test1<span class="token punctuation">.</span><span class="token keyword">sql</span> two_database<span class="token punctuation">.</span><span class="token keyword">sql</span>
<span class="token punctuation">[</span>root<span class="token variable">@node1</span> <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># vi book.sql</span>
<span class="token comment">-- MySQL dump 10.13  Distrib 8.0.26, for Linux (x86_64)</span>

<span class="token comment">--</span>
<span class="token comment">-- Host: localhost	Database: atguigu</span>

<span class="token comment">-- ------------------------------------------------------ -- Server version 8.0.26</span>



<span class="token comment">/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */</span><span class="token punctuation">;</span> <span class="token comment">/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */</span><span class="token punctuation">;</span> <span class="token comment">/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */</span><span class="token punctuation">;</span> <span class="token comment">/*!50503 SET NAMES utf8mb4 */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40103 SET TIME_ZONE='+00:00' */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */</span><span class="token punctuation">;</span> <span class="token comment">/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */</span><span class="token punctuation">;</span> <span class="token comment">/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */</span><span class="token punctuation">;</span>

<span class="token comment">--</span>

<span class="token comment">--	Table structure for table `book`</span>

<span class="token comment">--	</span>
 
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>book<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token comment">/*!40101 SET @saved_cs_client	= @@character_set_client */</span><span class="token punctuation">;</span>

<span class="token comment">/*!50503 SET character_set_client = utf8mb4 */</span><span class="token punctuation">;</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>book<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>

<span class="token identifier"><span class="token punctuation">`</span>bookid<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>card<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token keyword">unsigned</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

<span class="token identifier"><span class="token punctuation">`</span>test<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">COLLATE</span> utf8_bin <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>bookid<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>Y<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>card<span class="token punctuation">`</span></span><span class="token punctuation">)</span>

<span class="token punctuation">)</span>	<span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">101</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8mb3 <span class="token keyword">COLLATE</span><span class="token operator">=</span>utf8_bin<span class="token punctuation">;</span> <span class="token comment">/*!40101 SET character_set_client = @saved_cs_client */</span><span class="token punctuation">;</span>


<span class="token comment">--</span>

<span class="token comment">--	Dumping data for table `book`</span>

<span class="token comment">--	</span>

<span class="token keyword">LOCK</span> <span class="token keyword">TABLES</span> <span class="token identifier"><span class="token punctuation">`</span>book<span class="token punctuation">`</span></span> <span class="token keyword">WRITE</span><span class="token punctuation">;</span>

<span class="token comment">/*!40000 ALTER TABLE `book` DISABLE KEYS */</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>book<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">29</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">41</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">44</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">59</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">68</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">69</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">71</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">72</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">74</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">75</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">76</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">78</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">79</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">81</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">82</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">83</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">87</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">91</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">92</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">93</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">94</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">96</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">98</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*!40000 ALTER TABLE `book` ENABLE KEYS */</span><span class="token punctuation">;</span>

<span class="token keyword">UNLOCK</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span>

<span class="token comment">/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */</span><span class="token punctuation">;</span>
</code></pre> 
<p>可以看到，book文件和备份的库文件类似。不同的是，book文件只包含book表的DROP、CREATE和INSERT语句。</p> 
<p>备份多张表使用下面的命令，比如备份book和account表：</p> 
<pre><code class="prism language-sql"><span class="token comment">#备份多张表</span>
mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p atguigu book account	<span class="token operator">&gt;</span> <span class="token number">2</span>_tables_bak<span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre> 
<h5><a id="25__324"></a>2.5 备份单表的部分数据</h5> 
<p>有些时候一张表的数据量很大，我们只需要部分数据。这时就可以使用 --where 选项了。where后面附带需要满足的条件。<br> 举例：备份student表中id小于10的数据：</p> 
<pre><code class="prism language-sql">mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p atguigu student <span class="token comment">--where="id &lt; 10 " &gt; student_part_id10_low_bak.sql</span>
</code></pre> 
<p>内容如下所示，insert语句只有id小于10的部分</p> 
<pre><code class="prism language-sql"><span class="token keyword">LOCK</span> <span class="token keyword">TABLES</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">WRITE</span><span class="token punctuation">;</span>

<span class="token comment">/*!40000 ALTER TABLE `student` DISABLE KEYS */</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>student<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100002</span><span class="token punctuation">,</span><span class="token string">'JugxTY'</span><span class="token punctuation">,</span><span class="token number">157</span><span class="token punctuation">,</span><span class="token number">280</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">100003</span><span class="token punctuation">,</span><span class="token string">'QyUcCJ'</span><span class="token punctuation">,</span><span class="token number">251</span><span class="token punctuation">,</span><span class="token number">277</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">100004</span><span class="token punctuation">,</span><span class="token string">'lATUPp'</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">100005</span><span class="token punctuation">,</span><span class="token string">'BmFsXI'</span><span class="token punctuation">,</span><span class="token number">240</span><span class="token punctuation">,</span><span class="token number">171</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">100006</span><span class="token punctuation">,</span><span class="token string">'mkpSwJ'</span><span class="token punctuation">,</span><span class="token number">388</span><span class="token punctuation">,</span><span class="token number">476</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">100007</span><span class="token punctuation">,</span><span class="token string">'ujMgwN'</span><span class="token punctuation">,</span><span class="token number">259</span><span class="token punctuation">,</span><span class="token number">124</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">100008</span><span class="token punctuation">,</span><span class="token string">'HBJTqX'</span><span class="token punctuation">,</span><span class="token number">429</span><span class="token punctuation">,</span><span class="token number">168</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">100009</span><span class="token punctuation">,</span><span class="token string">'dvQSQA'</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">504</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">100010</span><span class="token punctuation">,</span><span class="token string">'HljpVJ'</span><span class="token punctuation">,</span><span class="token number">234</span><span class="token punctuation">,</span><span class="token number">185</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="26__343"></a>2.6 排除某些表的备份</h5> 
<p>如果我们想备份某个库，但是某些表数据量很大或者与业务关联不大，这个时候可以考虑排除掉这些表，同样的，选项 --ignore-table 可以完成这个功能。</p> 
<pre><code class="prism language-sql">mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p atguigu <span class="token comment">--ignore-table=atguigu.student &gt; no_stu_bak.sql</span>
</code></pre> 
<p>通过如下指定判定文件中没有student表结构：</p> 
<pre><code class="prism language-sql">grep <span class="token string">"student"</span>	no_stu_bak<span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre> 
<h5><a id="27__357"></a>2.7 只备份结构或只备份数据</h5> 
<p>只备份结构的话可以使用 --no-data 简写为 -d 选项；只备份数据可以使用 --no-create-info 简写为 -t 选项。</p> 
<ul><li>只备份结构</li></ul> 
<pre><code class="prism language-sql">mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p atguigu <span class="token comment">--no-data &gt; atguigu_no_data_bak.sql</span>
<span class="token comment">#使用grep命令，没有找到insert相关语句，表示没有数据备份。</span>
<span class="token punctuation">[</span>root<span class="token variable">@node1</span> <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># grep "INSERT" atguigu_no_data_bak.sql [root@node1 ~]#</span>
</code></pre> 
<ul><li>只备份数据</li></ul> 
<pre><code class="prism language-sql">mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p atguigu <span class="token comment">--no-create-info &gt; atguigu_no_create_info_bak.sql</span>

<span class="token comment">#使用grep命令，没有找到create相关语句，表示没有数据结构。</span>

<span class="token punctuation">[</span>root<span class="token variable">@node1</span> <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># grep "CREATE" atguigu_no_create_info_bak.sql [root@node1 ~]#</span>
</code></pre> 
<h5><a id="28_httpssocsdnnetsosearchqspm1001210130017020_379"></a>2.8 备份中包含<a href="https://so.csdn.net/so/search?q=%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B&amp;spm=1001.2101.3001.7020">存储过程</a>、函数、事件</h5> 
<p>mysqldump备份默认是不包含存储过程，自定义函数及事件的。可以使用 --routines 或 -R 选项来备份存储过程及函数，使用 --events 或 -E 参数来备份事件。</p> 
<p>举例：备份整个atguigu库，包含存储过程及事件：</p> 
<ul><li>使用下面的SQL可以查看当前库有哪些存储过程或者函数</li></ul> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SPECIFIC_NAME<span class="token punctuation">,</span>ROUTINE_TYPE <span class="token punctuation">,</span>ROUTINE_SCHEMA <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>Routines <span class="token keyword">WHERE</span> ROUTINE_SCHEMA<span class="token operator">=</span><span class="token string">"atguigu"</span><span class="token punctuation">;</span>
<span class="token comment">/*
+---------------	+--------------	+----------------	+
| SPECIFIC_NAME	| ROUTINE_TYPE	| ROUTINE_SCHEMA |
+---------------	+--------------	+----------------	+
| rand_num	| FUNCTION	| atguigu	|
| rand_string	| FUNCTION	| atguigu	|
| BatchInsert	| PROCEDURE	| atguigu	|
| insert_class	| PROCEDURE	| atguigu	|
| insert_order	| PROCEDURE	| atguigu	|
 

| insert_stu	| PROCEDURE	| atguigu	|
| insert_user	| PROCEDURE	| atguigu	|
| ts_insert	| PROCEDURE	| atguigu	|
+---------------	+--------------	+----------------	+
9 rows in set (0.02 sec)
*/</span>
</code></pre> 
<p>下面备份atguigu库的数据，函数以及存储过程。</p> 
<pre><code class="prism language-sql">mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p <span class="token operator">-</span>R <span class="token operator">-</span>E <span class="token comment">--databases atguigu &gt; fun_atguigu_bak.sql </span>
<span class="token number">1</span>
</code></pre> 
<p>查询备份文件中是否存在函数，如下所示，可以看到确实包含了函数。</p> 
<pre><code class="prism language-sql">grep <span class="token operator">-</span>C <span class="token number">5</span> <span class="token string">"rand_num"</span> fun_atguigu_bak<span class="token punctuation">.</span><span class="token keyword">sql</span>

<span class="token comment">--</span>

<span class="token comment">--</span>

<span class="token comment">--	Dumping routines for database 'atguigu'</span>

<span class="token comment">--	</span>

<span class="token comment">/*!50003 DROP FUNCTION IF EXISTS `rand_num` */</span><span class="token punctuation">;</span>

<span class="token comment">/*!50003 SET @saved_cs_client = @@character_set_client */</span> <span class="token punctuation">;</span> <span class="token comment">/*!50003 SET @saved_cs_results = @@character_set_results */</span> <span class="token punctuation">;</span> <span class="token comment">/*!50003 SET @saved_col_connection = @@collation_connection */</span> <span class="token punctuation">;</span> <span class="token comment">/*!50003 SET character_set_client = utf8mb3 */</span> <span class="token punctuation">;</span> <span class="token comment">/*!50003 SET character_set_results = utf8mb3 */</span> <span class="token punctuation">;</span> <span class="token comment">/*!50003 SET collation_connection = utf8_general_ci */</span> <span class="token punctuation">;</span> <span class="token comment">/*!50003 SET @saved_sql_mode = @@sql_mode */</span> <span class="token punctuation">;</span> <span class="token comment">/*!50003 SET sql_mode =


'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISIO N_BY_ZERO,NO_ENGINE_SUBSTITUTION' */</span> <span class="token punctuation">;</span>
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DEFINER</span><span class="token operator">=</span><span class="token identifier"><span class="token punctuation">`</span>root<span class="token punctuation">`</span></span><span class="token variable">@`%`</span> <span class="token keyword">FUNCTION</span> <span class="token identifier"><span class="token punctuation">`</span>rand_num<span class="token punctuation">`</span></span><span class="token punctuation">(</span>from_num <span class="token keyword">BIGINT</span> <span class="token punctuation">,</span>to_num <span class="token keyword">BIGINT</span><span class="token punctuation">)</span> <span class="token keyword">RETURNS</span> <span class="token keyword">bigint</span>
<span class="token keyword">BEGIN</span>
<span class="token keyword">DECLARE</span> i <span class="token keyword">BIGINT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> i <span class="token operator">=</span> FLOOR<span class="token punctuation">(</span>from_num <span class="token operator">+</span>RAND<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>to_num <span class="token operator">-</span> from_num<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>	<span class="token punctuation">;</span>
<span class="token keyword">RETURN</span> i<span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token comment">--</span>
<span class="token keyword">BEGIN</span>
<span class="token keyword">DECLARE</span> i <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> autocommit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">REPEAT</span>
<span class="token keyword">SET</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> class <span class="token punctuation">(</span> classname<span class="token punctuation">,</span>address<span class="token punctuation">,</span>monitor <span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>rand_string<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>rand_string<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>rand_num<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
UNTIL i <span class="token operator">=</span> max_num
<span class="token keyword">END</span> <span class="token keyword">REPEAT</span><span class="token punctuation">;</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
<span class="token comment">--</span>
<span class="token keyword">BEGIN</span>
<span class="token keyword">DECLARE</span> i <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> autocommit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>	<span class="token comment">#设置手动提交事务</span>
<span class="token keyword">REPEAT</span>	<span class="token comment">#循环</span>
<span class="token keyword">SET</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>	<span class="token comment">#赋值</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> order_test <span class="token punctuation">(</span>order_id<span class="token punctuation">,</span> trans_id <span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span>rand_num<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7000000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>rand_num<span class="token punctuation">(</span><span class="token number">100000000000000000</span><span class="token punctuation">,</span><span class="token number">700000000000000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
UNTIL i <span class="token operator">=</span> max_num
<span class="token keyword">END</span> <span class="token keyword">REPEAT</span><span class="token punctuation">;</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>	<span class="token comment">#提交事务</span>
<span class="token keyword">END</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
<span class="token comment">--</span>
<span class="token keyword">BEGIN</span>
<span class="token keyword">DECLARE</span> i <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> autocommit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>	<span class="token comment">#设置手动提交事务</span>
<span class="token keyword">REPEAT</span>	<span class="token comment">#循环</span>
<span class="token keyword">SET</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>	<span class="token comment">#赋值</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token punctuation">(</span>stuno<span class="token punctuation">,</span> name <span class="token punctuation">,</span>age <span class="token punctuation">,</span>classId <span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">START</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>rand_string<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>rand_num<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>rand_num<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> UNTIL i <span class="token operator">=</span> max_num
<span class="token keyword">END</span> <span class="token keyword">REPEAT</span><span class="token punctuation">;</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>	<span class="token comment">#提交事务</span>
<span class="token keyword">END</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
<span class="token comment">--</span>
<span class="token keyword">BEGIN</span>
<span class="token keyword">DECLARE</span> i <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> autocommit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">REPEAT</span>
<span class="token keyword">SET</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> <span class="token punctuation">(</span> name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>sex <span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">"atguigu"</span><span class="token punctuation">,</span>rand_num<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"male"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> UNTIL i <span class="token operator">=</span> max_num
<span class="token keyword">END</span> <span class="token keyword">REPEAT</span><span class="token punctuation">;</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
</code></pre> 
<h5><a id="29_mysqldump_490"></a>2.9 mysqldump常用选项</h5> 
<p>mysqldump其他常用选项如下：</p> 
<pre><code class="prism language-sql"><span class="token comment">--add-drop-database：在每个CREATE DATABASE语句前添加DROP DATABASE语句。</span>

<span class="token comment">--add-drop-tables：在每个CREATE TABLE语句前添加DROP TABLE语句。</span>

<span class="token comment">--add-locking：用LOCK TABLES和UNLOCK TABLES语句引用每个表转储。重载转储文件时插入得更快。</span>

<span class="token comment">--all-database, -A：转储所有数据库中的所有表。与使用--database选项相同，在命令行中命名所有数据库。</span>

<span class="token comment">--comment[=0|1]：如果设置为0，禁止转储文件中的其他信息，例如程序版本、服务器版本和主机。--skip-comments与--comments=0的结果相同。默认值为1，即包括额外信息。</span>

<span class="token comment">--compact：产生少量输出。该选项禁用注释并启用--skip-add-drop-tables、--no-set-names、--skip-disable-keys和--skip-add-locking选项。</span>

<span class="token comment">--compatible=name：产生与其他数据库系统或旧的MySQL服务器更兼容的输出，值可以为ansi、MySQL323、MySQL40、postgresql、oracle、mssql、db2、maxdb、no_key_options、no_table_options或者no_field_options。</span>

<span class="token comment">--complete_insert, -c：使用包括列名的完整的INSERT语句。</span>

<span class="token comment">--debug[=debug_options], -#[debug_options]：写调试日志。</span>
 
<span class="token comment">--delete，-D：导入文本文件前清空表。</span>

<span class="token comment">--default-character-set=charset：使用charsets默认字符集。如果没有指定，就使用utf8。</span>

<span class="token comment">--delete--master-logs：在主复制服务器上，完成转储操作后删除二进制日志。该选项自动启用-master-data。</span>


<span class="token comment">--extended-insert，-e：使用包括几个VALUES列表的多行INSERT语法。这样使得转储文件更小，重载文件时可以加速插入。</span>

<span class="token comment">--flush-logs，-F：开始转储前刷新MySQL服务器日志文件。该选项要求RELOAD权限。</span>

<span class="token comment">--force，-f：在表转储过程中，即使出现SQL错误也继续。</span>

<span class="token comment">--lock-all-tables，-x：对所有数据库中的所有表加锁。在整体转储过程中通过全局锁定来实现。该选项自动关闭--single-transaction和--lock-tables。</span>

<span class="token comment">--lock-tables，-l：开始转储前锁定所有表。用READ LOCAL锁定表以允许并行插入MyISAM表。对于事务表（例如InnoDB和BDB），--single-transaction是一个更好的选项，因为它根本不需要锁定表。</span>

<span class="token comment">--no-create-db，-n：该选项禁用CREATE DATABASE /*!32312 IF NOT EXIST*/db_name语句，如果给出--database或--all-database选项，就包含到输出中。</span>

<span class="token comment">--no-create-info，-t：只导出数据，而不添加CREATE TABLE语句。</span>

<span class="token comment">--no-data，-d：不写表的任何行信息，只转储表的结构。</span>

<span class="token comment">--opt：该选项是速记，它可以快速进行转储操作并产生一个能很快装入MySQL服务器的转储文件。该选项默认开启，但可以用--skip-opt禁用。</span>

<span class="token comment">--password[=password]，-p[password]：当连接服务器时使用的密码。</span>

<span class="token operator">-</span>port<span class="token operator">=</span>port_num，<span class="token operator">-</span>P port_num：用于连接的TCP<span class="token operator">/</span>IP端口号。

<span class="token comment">--protocol={TCP|SOCKET|PIPE|MEMORY}：使用的连接协议。</span>

<span class="token comment">--replace，-r –replace和--ignore：控制替换或复制唯一键值已有记录的输入记录的处理。如果指定-- replace，新行替换有相同的唯一键值的已有行；如果指定--ignore，复制已有的唯一键值的输入行被跳过。如果不指定这两个选项，当发现一个复制键值时会出现一个错误，并且忽视文本文件的剩余部分。</span>

<span class="token comment">--silent，-s：沉默模式。只有出现错误时才输出。</span>

<span class="token comment">--socket=path，-S path：当连接localhost时使用的套接字文件（为默认主机）。</span>

<span class="token comment">--user=user_name，-u user_name：当连接服务器时MySQL使用的用户名。</span>

<span class="token comment">--verbose，-v：冗长模式，打印出程序操作的详细信息。</span>

<span class="token comment">--xml，-X：产生XML输出。</span>
</code></pre> 
<p>运行帮助命令 mysqldump --help ，可以获得特定版本的完整选项列表。</p> 
<blockquote> 
 <p>提示 如果运行mysqldump没有–quick或–opt选项，mysqldump在转储结果前将整个结果集装入内存。如果转储大数据库可能会出现问题，该选项默认启用，但可以用–skip-opt禁用。如果使用最新版本的mysqldump程序备份数据，并用于恢复到比较旧版本的MySQL服务器中，则不要使用–opt或-e选项。</p> 
</blockquote> 
<h3><a id="3_mysql_561"></a>3. mysql命令恢复数据</h3> 
<p>基本语法：</p> 
<pre><code class="prism language-sql">mysql –u root –p <span class="token punctuation">[</span>dbname<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token keyword">backup</span><span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre> 
<h5><a id="31__569"></a>3.1 单库备份中恢复单库</h5> 
<p>使用root用户，将之前练习中备份的atguigu.sql文件中的备份导入数据库中，命令如下：</p> 
<p>如果备份文件中包含了创建数据库的语句，则恢复的时候不需要指定数据库名称，如下所示</p> 
<pre><code class="prism language-sql">mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>p <span class="token operator">&lt;</span> atguigu<span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre> 
<p>否则需要指定数据库名称，如下所示</p> 
<pre><code class="prism language-sql">mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>p atguigu4<span class="token operator">&lt;</span> atguigu<span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre> 
<h5><a id="32__585"></a>3.2 全量备份恢复</h5> 
<p>如果我们现在有昨天的全量备份，现在想整个恢复，则可以这样操作：</p> 
<pre><code class="prism language-sql">mysql –u root –p <span class="token operator">&lt;</span> <span class="token keyword">all</span><span class="token punctuation">.</span><span class="token keyword">sql</span>
mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>pxxxxxx <span class="token operator">&lt;</span> <span class="token keyword">all</span><span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre> 
<p>执行完后，MySQL数据库中就已经恢复了all.sql文件中的所有数据库。</p> 
<h5><a id="33__596"></a>3.3 从全量备份中恢复单库</h5> 
<p>可能有这样的需求，比如说我们只想恢复某一个库，但是我们有的是整个实例的备份，这个时候我们可以从全量备份中分离出单个库的备份。</p> 
<p>举例：</p> 
<pre><code class="prism language-sql">sed <span class="token operator">-</span>n <span class="token string">'/^-- Current Database: `atguigu`/,/^-- Current Database: `/p'</span> all_database<span class="token punctuation">.</span><span class="token keyword">sql</span> <span class="token operator">&gt;</span> atguigu<span class="token punctuation">.</span><span class="token keyword">sql</span>
<span class="token comment">#分离完成后我们再导入atguigu.sql即可恢复单个库</span>
</code></pre> 
<h5><a id="34__607"></a>3.4 从单库备份中恢复单表</h5> 
<p>这个需求还是比较常见的。比如说知道哪个表误操作了，那么就可以用单表恢复的方式来恢复。</p> 
<p>举例：有atguigu整库的备份，但是由于class表误操作，需要单独恢复出这张表。</p> 
<pre><code class="prism language-sql">cat atguigu<span class="token punctuation">.</span><span class="token keyword">sql</span> <span class="token operator">|</span> sed <span class="token operator">-</span>e <span class="token string">'/./{H;$!d;}'</span> <span class="token operator">-</span>e <span class="token string">'x;/CREATE TABLE `class`/!d;q'</span> <span class="token operator">&gt;</span> class_structure<span class="token punctuation">.</span><span class="token keyword">sql</span>

cat atguigu<span class="token punctuation">.</span><span class="token keyword">sql</span> <span class="token operator">|</span> grep <span class="token comment">--ignore-case	'insert into `class`' &gt; class_data.sql</span>

<span class="token comment">#用shell语法分离出创建表的语句及插入数据的语句后 再依次导出即可完成恢复</span>

<span class="token keyword">use</span> atguigu<span class="token punctuation">;</span>

mysql<span class="token operator">&gt;</span> source class_structure<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">;</span>

Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected<span class="token punctuation">,</span> <span class="token number">1</span> warning <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> source class_data<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">;</span>

Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="4__631"></a>4. 物理备份：直接复制整个数据库</h3> 
<p>直接将MySQL中的数据库文件复制出来。这种方法最简单，速度也最快。MySQL的数据库目录位置不一定相同：</p> 
<ul><li>在Windows平台下，MySQL 8.0存放数据库的目录通常默认为 “ C:\ProgramData\MySQL\MySQL<br> Server 8.0\Data ”或者其他用户自定义目录；</li><li>在Linux平台下，数据库目录位置通常为/var/lib/mysql/；</li><li>在MAC OSX平台下，数据库目录位置通常为“/usr/local/mysql/data”</li></ul> 
<p>但为了保证备份的一致性。需要保证：</p> 
<ul><li>方式1：备份前，将服务器停止。</li><li>方式2：备份前，对相关表执行 FLUSH TABLES WITH READ LOCK操作。这样当复制数据库目录中的文件时，允许其他客户继续查询表。同时，FLUSH TABLES语句来确保开始备份前将所有激活的索引页写入硬盘。</li></ul> 
<p>这种方式方便、快速，但不是最好的备份方法，因为实际情况可能 不允许停止MySQL服务器 或者 锁住表 ，而且这种方法 对InnoDB存储引擎 的表不适用。对于MyISAM存储引擎的表，这样备份和还原很方便，但是还原时最好是相同版本的MySQL数据库，否则可能会存在文件类型不同的情况。</p> 
<p>注意，物理备份完毕后，执行 UNLOCK TABLES 来结算其他客户对表的修改行为。</p> 
<p>说明： 在MySQL版本号中，第一个数字表示主版本号，主版本号相同的MySQL数据库文件格式相同。</p> 
<p>此外，还可以考虑使用相关工具实现备份。比如， MySQLhotcopy 工具。MySQLhotcopy是一个Perl脚本，它使用LOCK TABLES、FLUSH TABLES和cp或scp来快速备份数据库。它是备份数据库或单个表最快的途径，但它只能运行在数据库目录所在的机器上，并且只能备份MyISAM类型的表。多用于mysql5.5之前。</p> 
<h3><a id="5_653"></a>5.物理恢复：直接复制到数据库目录</h3> 
<p>步骤：<br> 1）演示删除备份的数据库中指定表的数据<br> 2）将备份的数据库数据拷贝到数据目录下，并重启MySQL服务器<br> 3）查询相关表的数据是否恢复。需要使用下面的 chown 操作。<br> <strong>要求：</strong></p> 
<ul><li>必须确保备份数据的数据库和待恢复的数据库服务器的主版本号相同。<br> 因为只有MySQL数据库主版本号相同时，才能保证这两个MySQL数据库文件类型是相同的。</li><li>这种方式对 MyISAM类型的表比较有效 ，对于InnoDB类型的表则不可用。<br> 因为InnoDB表的表空间不能直接复制。</li><li>在Linux操作系统下，复制到数据库目录后，一定要将数据库的用户和组变成mysql，命令如下：</li></ul> 
<pre><code class="prism language-sql">chown <span class="token operator">-</span>R mysql<span class="token punctuation">.</span>mysql <span class="token operator">/</span>var<span class="token operator">/</span>lib<span class="token operator">/</span>mysql<span class="token operator">/</span>dbname
</code></pre> 
<p>其中，两个mysql分别表示组和用户；“-R”参数可以改变文件夹下的所有子文件的用户和组；“dbname”参数表示数据库目录。</p> 
<blockquote> 
 <p><strong>提示</strong><br> Linux操作系统下的权限设置非常严格。通常情况下，MySQL数据库只有root用户和mysql用户组下的mysql用户才可以访问，因此将数据库目录复制到指定文件夹后，一定要使用chown命令将文件夹的用户组变为mysql，将用户变为mysql。</p> 
</blockquote> 
<h3><a id="6__676"></a>6. 表的导出与导入</h3> 
<h5><a id="61__678"></a>6.1 表的导出</h5> 
<p><strong>1. 使用SELECT…INTO OUTFILE导出文本文件</strong><br> 在MySQL中，可以使用SELECT…INTO OUTFILE语句将表的内容导出成一个文本文件。</p> 
<p>举例：使用SELECT…INTO OUTFILE将atguigu数据库中account表中的记录导出到文本文件。 （1）选择数据库atguigu，并查询account表，执行结果如下所示。</p> 
<pre><code class="prism language-sql"><span class="token keyword">use</span> atguigu<span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token comment">/*
mysql&gt; select * from account;

+	----	+--------	+---------	+
| id |	name	| balance |
+	----	+--------	+---------	+
|	1	|	张三	|	90	|
|	2	|	李四	|	100	|
|	3	|	王五	|	0	|
+	----	+--------	+---------	+
3	rows	in set (0.01 sec)
*/</span>
</code></pre> 
<p>（2）mysql默认对导出的目录有权限限制，也就是说使用命令行进行导出的时候，需要指定目录进行操作。</p> 
<p>查询secure_file_priv值：</p> 
<pre><code class="prism language-sql"> <span class="token keyword">SHOW</span> <span class="token keyword">GLOBAL</span> VARIABLES	<span class="token operator">LIKE</span> <span class="token string">'%secure%'</span><span class="token punctuation">;</span>
 <span class="token comment">/*	
+	--------------------------	+	-----------------------	+
| Variable_name	|	Value	|
+	--------------------------	+	-----------------------	+
| require_secure_transport	|	OFF	|
| secure_file_priv	|	/var/lib/mysql-files/ |
+	--------------------------	+	-----------------------	+
2	rows in set (0.02 sec)			
*/</span>				
</code></pre> 
<p>（3）上面结果中显示，secure_file_priv变量的值为/var/lib/mysql-files/，导出目录设置为该目录，SQL语句如下。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> account <span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span> <span class="token string">"/var/lib/mysql-files/account.txt"</span><span class="token punctuation">;</span>
</code></pre> 
<p>（4）查看 /var/lib/mysql-files/account.txt`文件。</p> 
<pre><code class="prism language-sql"><span class="token number">1</span>	张三  <span class="token number">90</span>
<span class="token number">2</span>	李四	 <span class="token number">100</span>
<span class="token number">3</span>	王五  <span class="token number">0</span>
</code></pre> 
<p><strong>2. 使用mysqldump命令导出文本文件</strong></p> 
<p>举例1：使用mysqldump命令将将atguigu数据库中account表中的记录导出到文本文件：</p> 
<pre><code class="prism language-sql">mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p <span class="token operator">-</span>T <span class="token string">"/var/lib/mysql-files/"</span> atguigu account
</code></pre> 
<p>mysqldump命令执行完毕后，在指定的目录/var/lib/mysql-files/下生成了account.sql和account.txt文件。</p> 
<p>打开account.sql文件，其内容包含创建account表的CREATE语句。</p> 
<pre><code class="prism language-sql"><span class="token punctuation">[</span>root<span class="token variable">@node1</span> mysql<span class="token operator">-</span>files<span class="token punctuation">]</span><span class="token comment"># cat account.sql</span>

<span class="token comment">--	MySQL dump 10.13  Distrib 8.0.26, for Linux (x86_64)</span>

<span class="token comment">--	</span>

<span class="token comment">-- Host: localhost	Database: atguigu</span>
<span class="token comment">-- ------------------------------------------------------</span>
<span class="token comment">-- Server version	8.0.26</span>
<span class="token comment">/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */</span><span class="token punctuation">;</span>
<span class="token comment">/*!50503 SET NAMES utf8mb4 */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40103 SET TIME_ZONE='+00:00' */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='' */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */</span><span class="token punctuation">;</span>

<span class="token comment">--</span>

<span class="token comment">-- Table structure for table `account`</span>

<span class="token comment">--</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>account<span class="token punctuation">`</span></span><span class="token punctuation">;</span>		
<span class="token comment">/*!40101	SET	@saved_cs_client	=	@@character_set_client */</span><span class="token punctuation">;</span>
<span class="token comment">/*!50503	SET	character_set_client =	utf8mb4 */</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>account<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>

<span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>

<span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

<span class="token identifier"><span class="token punctuation">`</span>balance<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
 
<span class="token punctuation">)</span>	<span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">4</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8mb3<span class="token punctuation">;</span> <span class="token comment">/*!40101 SET character_set_client = @saved_cs_client */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40101 SET SQL_MODE=@OLD_SQL_MODE */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */</span><span class="token punctuation">;</span> <span class="token comment">/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */</span><span class="token punctuation">;</span> <span class="token comment">/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */</span><span class="token punctuation">;</span> <span class="token comment">/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */</span><span class="token punctuation">;</span>

<span class="token comment">-- Dump completed on 2022-01-07 23:19:27</span>
</code></pre> 
<p>打开account.txt文件，其内容只包含account表中的数据。</p> 
<pre><code class="prism language-sql"><span class="token punctuation">[</span>root<span class="token variable">@node1</span> mysql<span class="token operator">-</span>files<span class="token punctuation">]</span><span class="token comment"># cat account.txt</span>
<span class="token number">1</span>	张三	 <span class="token number">90</span>
<span class="token number">2</span>	李四	 <span class="token number">100</span>
<span class="token number">3</span>	王五 <span class="token number">0</span>
</code></pre> 
<p>举例2：使用mysqldump将atguigu数据库中的account表导出到文本文件，使用FIELDS选项，要求字段之间使用逗号“，”间隔，所有字符类型字段值用双引号括起来：</p> 
<pre><code class="prism language-sql">mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p <span class="token operator">-</span>T <span class="token string">"/var/lib/mysql-files/"</span> atguigu account <span class="token comment">--fields-terminated-by=',' --fields-optionally-enclosed-by='\"'</span>
</code></pre> 
<p>语句mysqldump语句执行成功之后，指定目录下会出现两个文件account.sql和account.txt。</p> 
<p>打开account.sql文件，其内容包含创建account表的CREATE语句。</p> 
<pre><code class="prism language-sql"><span class="token punctuation">[</span>root<span class="token variable">@node1</span> mysql<span class="token operator">-</span>files<span class="token punctuation">]</span><span class="token comment"># cat account.sql</span>

<span class="token comment">--	MySQL dump 10.13  Distrib 8.0.26, for Linux (x86_64)</span>

<span class="token comment">--	</span>

<span class="token comment">-- Host: localhost	Database: atguigu</span>
<span class="token comment">-- ------------------------------------------------------</span>
<span class="token comment">-- Server version	8.0.26</span>
<span class="token comment">/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */</span><span class="token punctuation">;</span>
<span class="token comment">/*!50503 SET NAMES utf8mb4 */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40103 SET TIME_ZONE='+00:00' */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='' */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */</span><span class="token punctuation">;</span>

<span class="token comment">--</span>

<span class="token comment">-- Table structure for table `account`</span>

<span class="token comment">--</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>account<span class="token punctuation">`</span></span><span class="token punctuation">;</span>		
<span class="token comment">/*!40101	SET	@saved_cs_client	=	@@character_set_client */</span><span class="token punctuation">;</span>
<span class="token comment">/*!50503	SET	character_set_client =	utf8mb4 */</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>account<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>

<span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>

<span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

<span class="token identifier"><span class="token punctuation">`</span>balance<span class="token punctuation">`</span></span> <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>

<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
 
<span class="token punctuation">)</span>	<span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">4</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8mb3<span class="token punctuation">;</span> <span class="token comment">/*!40101 SET character_set_client = @saved_cs_client */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40101 SET SQL_MODE=@OLD_SQL_MODE */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */</span><span class="token punctuation">;</span> <span class="token comment">/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */</span><span class="token punctuation">;</span> <span class="token comment">/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */</span><span class="token punctuation">;</span> <span class="token comment">/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */</span><span class="token punctuation">;</span>

<span class="token comment">-- Dump completed on 2022-01-07 23:36:39</span>
</code></pre> 
<p>打开account.txt文件，其内容包含创建account表的数据。从文件中可以看出，字段之间用逗号隔开，字符类型的值被双引号括起来。</p> 
<pre><code class="prism language-sql"><span class="token punctuation">[</span>root<span class="token variable">@node1</span> mysql<span class="token operator">-</span>files<span class="token punctuation">]</span><span class="token comment"># cat account.txt</span>
<span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"张三"</span><span class="token punctuation">,</span><span class="token number">90</span>
<span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"李四"</span><span class="token punctuation">,</span><span class="token number">100</span>
<span class="token number">3</span><span class="token punctuation">,</span><span class="token string">"王五"</span><span class="token punctuation">,</span><span class="token number">0</span>
</code></pre> 
<p><strong>3. 使用mysql命令导出文本文件</strong></p> 
<p>举例1：使用mysql语句导出atguigu数据中account表中的记录到文本文件：</p> 
<pre><code class="prism language-sql">mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>p <span class="token comment">--execute="SELECT * FROM account;" atguigu&gt; "/var/lib/mysql-files/account.txt"</span>
</code></pre> 
<p>打开account.txt文件，其内容包含创建account表的数据。</p> 
<pre><code class="prism language-sql"><span class="token punctuation">[</span>root<span class="token variable">@node1</span> mysql<span class="token operator">-</span>files<span class="token punctuation">]</span><span class="token comment"># cat account.txt</span>
id	name	balance
<span class="token number">1</span>	张三	<span class="token number">90</span>
<span class="token number">2</span>	李四	<span class="token number">100</span>
<span class="token number">3</span>	王五 <span class="token number">0</span>
</code></pre> 
<p>举例2：将atguigu数据库account表中的记录导出到文本文件，使用–veritcal参数将该条件记录分为多行显示：</p> 
<pre><code class="prism language-sql">mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>p <span class="token comment">--vertical --execute="SELECT * FROM account;" atguigu &gt; "/var/lib/mysql-files/account_1.txt"</span>
</code></pre> 
<p>打开account_1.txt文件，其内容包含创建account表的数据。</p> 
<pre><code class="prism language-sql"><span class="token punctuation">[</span>root<span class="token variable">@node1</span> mysql<span class="token operator">-</span>files<span class="token punctuation">]</span><span class="token comment"># cat account_1.txt *************************** 1. row ***************************</span>

id: <span class="token number">1</span>

name: 张三

balance: <span class="token number">90</span>

<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> <span class="token number">2.</span> <span class="token keyword">row</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>

id: <span class="token number">2</span>

name: 李四

balance: <span class="token number">100</span>

<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> <span class="token number">3.</span> <span class="token keyword">row</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>

id: <span class="token number">3</span>

name: 王五

balance: <span class="token number">0</span>
</code></pre> 
<p>举例3：将atguigu数据库account表中的记录导出到xml文件，使用–xml参数，具体语句如下。</p> 
<pre><code class="prism language-sql">mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>p <span class="token comment">--xml --execute="SELECT * FROM account;" atguigu&gt;"/var/lib/mysql-files/account_3.xml"</span>
<span class="token punctuation">[</span>root<span class="token variable">@node1</span> mysql<span class="token operator">-</span>files<span class="token punctuation">]</span><span class="token comment"># cat account_3.xml</span>
<span class="token operator">&lt;</span>?xml version<span class="token operator">=</span><span class="token string">"1.0"</span>?<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>resultset statement<span class="token operator">=</span><span class="token string">"SELECT * FROM account"</span> xmlns:xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token keyword">row</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>field name<span class="token operator">=</span><span class="token string">"id"</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>field<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>field name<span class="token operator">=</span><span class="token string">"name"</span><span class="token operator">&gt;</span>张三<span class="token operator">&lt;</span><span class="token operator">/</span>field<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>field name<span class="token operator">=</span><span class="token string">"balance"</span><span class="token operator">&gt;</span><span class="token number">90</span><span class="token operator">&lt;</span><span class="token operator">/</span>field<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">row</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token keyword">row</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>field name<span class="token operator">=</span><span class="token string">"id"</span><span class="token operator">&gt;</span><span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>field<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>field name<span class="token operator">=</span><span class="token string">"name"</span><span class="token operator">&gt;</span>李四<span class="token operator">&lt;</span><span class="token operator">/</span>field<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>field name<span class="token operator">=</span><span class="token string">"balance"</span><span class="token operator">&gt;</span><span class="token number">100</span><span class="token operator">&lt;</span><span class="token operator">/</span>field<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">row</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token keyword">row</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>field name<span class="token operator">=</span><span class="token string">"id"</span><span class="token operator">&gt;</span><span class="token number">3</span><span class="token operator">&lt;</span><span class="token operator">/</span>field<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>field name<span class="token operator">=</span><span class="token string">"name"</span><span class="token operator">&gt;</span>王五<span class="token operator">&lt;</span><span class="token operator">/</span>field<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>field name<span class="token operator">=</span><span class="token string">"balance"</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token operator">&lt;</span><span class="token operator">/</span>field<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">row</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>resultset<span class="token operator">&gt;</span>
</code></pre> 
<p>说明：如果要将表数据导出到html文件中，可以使用 --html 选项。然后可以使用浏览器打开。</p> 
<h5><a id="62__953"></a>6.2 表的导入</h5> 
<p><strong>1. 使用LOAD DATA INFILE方式导入文本文件</strong><br> 举例1：<br> 使用SELECT…INTO OUTFILE将atguigu数据库中account表的记录导出到文本文件</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> atguigu<span class="token punctuation">.</span>account <span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span> <span class="token string">'/var/lib/mysql-files/account_0.txt'</span><span class="token punctuation">;</span>
</code></pre> 
<p>删除account表中的数据：</p> 
<pre><code class="prism language-sql"><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> atguigu<span class="token punctuation">.</span>account<span class="token punctuation">;</span>
</code></pre> 
<p>从文本文件account.txt中恢复数据：</p> 
<pre><code class="prism language-sql"><span class="token keyword">LOAD</span> <span class="token keyword">DATA</span> <span class="token keyword">INFILE</span> <span class="token string">'/var/lib/mysql-files/account_0.txt'</span> <span class="token keyword">INTO</span> <span class="token keyword">TABLE</span> atguigu<span class="token punctuation">.</span>account<span class="token punctuation">;</span>
</code></pre> 
<p>查询account表中的数据：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>	<span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token comment">/*
+	----	+--------	+---------	+
| id |	name	|	balance |
+	----	+--------	+---------	+
|	1	|	张三	|	90	|
|	2	|	李四	|	100	|
|	3	|	王五	|	0	|
+	----	+--------	+---------	+
3	rows	in set (0.00 sec)
*/</span>
</code></pre> 
<p>举例2： 选择数据库atguigu，使用SELECT…INTO OUTFILE将atguigu数据库account表中的记录导出到文本文件，使用FIELDS选项和LINES选项，要求字段之间使用逗号"，"间隔，所有字段值用双引号括起来：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> atguigu<span class="token punctuation">.</span>account <span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span> <span class="token string">'/var/lib/mysql-files/account_1.txt'</span> <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">','</span> <span class="token keyword">ENCLOSED</span> <span class="token keyword">BY</span> <span class="token string">'\"'</span><span class="token punctuation">;</span>
</code></pre> 
<p>删除account表中的数据：</p> 
<pre><code class="prism language-sql"><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> atguigu<span class="token punctuation">.</span>account<span class="token punctuation">;</span>
</code></pre> 
<p>从/var/lib/mysql-files/account.txt中导入数据到account表中：</p> 
<pre><code class="prism language-sql"><span class="token keyword">LOAD</span> <span class="token keyword">DATA</span> <span class="token keyword">INFILE</span> <span class="token string">'/var/lib/mysql-files/account_1.txt'</span> <span class="token keyword">INTO</span> <span class="token keyword">TABLE</span> atguigu<span class="token punctuation">.</span>account <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">','</span> <span class="token keyword">ENCLOSED</span> <span class="token keyword">BY</span> <span class="token string">'\"'</span><span class="token punctuation">;</span>
</code></pre> 
<p>查询account表中的数据，具体SQL如下：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>	<span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>	
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token comment">/*
+	----	+--------	+---------	+
| id |	name	| balance |
+	----	+--------	+---------	+
|	1	|	张三	|	90	|
|	2	|	李四	|	100	|
|	3	|	王五	|	0	|
+	----	+--------	+---------	+
3	rows	in set (0.00 sec)
*/</span>
</code></pre> 
<p><strong>2. 使用mysqlimport方式导入文本文件</strong></p> 
<p>举例：<br> 导出文件account.txt，字段之间使用逗号"，"间隔，字段值用双引号括起来：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> atguigu<span class="token punctuation">.</span>account <span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span> <span class="token string">'/var/lib/mysql-files/account.txt'</span> <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">','</span> <span class="token keyword">ENCLOSED</span> <span class="token keyword">BY</span> <span class="token string">'\"'</span><span class="token punctuation">;</span>
</code></pre> 
<p>删除account表中的数据：</p> 
<pre><code class="prism language-sql"><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> atguigu<span class="token punctuation">.</span>account<span class="token punctuation">;</span>
</code></pre> 
<p>使用mysqlimport命令将account.txt文件内容导入到数据库atguigu的account表中：</p> 
<pre><code class="prism language-sql">mysqlimport <span class="token operator">-</span>uroot <span class="token operator">-</span>p atguigu <span class="token string">'/var/lib/mysql-files/account.txt'</span> <span class="token comment">--fields-terminated-by=',' --fields-optionally-enclosed-by='\"'</span>
</code></pre> 
<p>查询account表中的数据：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span>	<span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>	
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token comment">/*
+	----	+--------	+---------	+
| id |	name	| balance |
+	----	+--------	+---------	+
|	1	|	张三	|	90	|
|	2	|	李四	|	100	|
|	3	|	王五	|	0	|
+	----	+--------	+---------	+
3	rows	in set (0.00 sec)
*/</span>
</code></pre> 
<h3><a id="7__1064"></a>7. 数据库迁移</h3> 
<h5><a id="71__1066"></a>7.1 概述</h5> 
<p>数据迁移（data migration）是指选择、准备、提取和转换数据，并将数据从一个计算机存储系统永久地传输到另一个计算机存储系统的过程。此外， 验证迁移数据的完整性 和 退役原来旧的数据存储 ，也被认为是整个数据迁移过程的一部分。</p> 
<p>数据库迁移的原因是多样的，包括服务器或存储设备更换、维护或升级，应用程序迁移，网站集成，灾难恢复和数据中心迁移。</p> 
<p>根据不同的需求可能要采取不同的迁移方案，但总体来讲，MySQL 数据迁移方案大致可以分为 物理迁移和逻辑迁移 两类。通常以尽可能自动化 的方式执行，从而将人力资源从繁琐的任务中解放出来。</p> 
<h5><a id="72__1074"></a>7.2 迁移方案</h5> 
<h6><a id="_1076"></a>物理迁移</h6> 
<p>物理迁移适用于大数据量下的整体迁移。使用物理迁移方案的优点是比较快速，但需要停机迁移并且要求MySQL版本及配置必须和原服务器相同，也可能引起未知问题。物理迁移包括拷贝数据文件和使用 XtraBackup 备份工具两种。</p> 
<p>不同服务器之间可以采用物理迁移，我们可以在新的服务器上安装好同版本的数据库软件，创建好相同目录，建议配置文件也要和原数据库相同，然后从原数据库方拷贝来数据文件及日志文件，配置好文件组权限，之后在新服务器这边使用 mysqld 命令启动数据库。</p> 
<h6><a id="_1082"></a>逻辑迁移</h6> 
<p>逻辑迁移适用范围更广，无论是部分迁移 还是全量迁移 ，都可以使用逻辑迁移。逻辑迁移中使用最多的就是通过 mysqldump 等备份工具。</p> 
<h5><a id="73__1086"></a>7.3 迁移注意点</h5> 
<h6><a id="1__1088"></a>1. 相同版本的数据库之间迁移注意点</h6> 
<p>指的是在主版本号相同的MySQL数据库之间进行数据库移动。</p> 
<p>方式1： 因为迁移前后MySQL数据库的 主版本号相同 ，所以可以通过复制数据库目录来实现数据库迁移，但是物理迁移方式只适用于MyISAM引擎的表。对于InnoDB表，不能用直接复制文件的方式备份数据库。</p> 
<p>方式2： 最常见和最安全的方式是使用 mysqldump命令 导出数据，然后在目标数据库服务器中使用MySQL命令导入。</p> 
<p>举例：<br> #host1的机器中备份所有数据库,并将数据库迁移到名为host2的机器上</p> 
<pre><code class="prism language-sql">mysqldump –h host1 –uroot –p –<span class="token operator">-</span><span class="token keyword">all</span><span class="token operator">-</span><span class="token keyword">databases</span><span class="token operator">|</span>
mysql –h host2 –uroot –p
</code></pre> 
<p>在上述语句中，“|”符号表示管道，其作用是将mysqldump备份的文件给mysql命令；“–all-databases”表示要迁移所有的数据库。通过这种方式可以直接实现迁移。</p> 
<h6><a id="2__1106"></a>2. 不同版本的数据库之间迁移注意点</h6> 
<p>例如，原来很多服务器使用5.7版本的MySQL数据库，在8.0版本推出来以后，改进了5.7版本的很多缺陷，因此需要把数据库升级到8.0版本</p> 
<p>旧版本与新版本的MySQL可能使用不同的默认字符集，例如有的旧版本中使用latin1作为默认字符集，而最新版本的MySQL默认字符集为utf8mb4。如果数据库中有中文数据，那么迁移过程中需要对 默认字符集进行修改，不然可能无法正常显示数据。</p> 
<p>高版本的MySQL数据库通常都会 兼容低版本 ，因此可以从低版本的MySQL数据库迁移到高版本的MySQL数据库。</p> 
<h6><a id="3__1114"></a>3. 不同数据库之间迁移注意点</h6> 
<p>不同数据库之间迁移是指从其他类型的数据库迁移到MySQL数据库，或者从MySQL数据库迁移到其他类型的数据库。这种迁移没有普适的解决方法。</p> 
<p>迁移之前，需要了解不同数据库的架构，比较它们之间的差异 。不同数据库中定义相同类型的数据的 关键字可能会不同 。例如，MySQL中日期字段分为DATE和TIME两种，而ORACLE日期字段只有DATE；SQL Server数据库中有ntext、Image等数据类型，MySQL数据库没有这些数据类型；MySQL支持的ENUM和SET类型，这些SQL Server数据库不支持。</p> 
<p>另外，数据库厂商并没有完全按照SQL标准来设计数据库系统，导致不同的数据库系统的 SQL语句 有差别。例如，微软的SQL Server软件使用的是T-SQL语句，T-SQL中包含了非标准的SQL语句，不能和MySQL的SQL语句兼容。</p> 
<p>不同类型数据库之间的差异造成了互相迁移的困难 ，这些差异其实是商业公司故意造成的技术壁垒。但是不同类型的数据库之间的迁移并 不是完全不可能 。例如，可以使用 MyODBC 实现MySQL和SQL Server之间的迁移。MySQL官方提供的工具 MySQL Migration Toolkit 也可以在不同数据之间进行数据迁移。MySQL迁移到Oracle时，需要使用mysqldump命令导出sql文件，然后， 手动更改 sql文件中的CREATE语句。</p> 
<h5><a id="74__1124"></a>7.4 迁移小结</h5> 
<p><img src="https://images2.imgbox.com/21/9d/WnLDpyI9_o.png" alt="请添加图片描述"></p> 
<h3><a id="8__1128"></a>8. 删库了不敢跑，能干点啥？</h3> 
<h5><a id="81_delete_1130"></a>8.1 delete：误删行</h5> 
<p>经验之谈：</p> 
<ol><li>恢复数据比较安全的做法，是恢复出一个备份 ，或者找一个从库作为临时库 ，在这个临时库上执行这些操作，然后再将确认过的临时库的数据，恢复回主库。如果直接修改主库，可能导致对数据的二次破坏 。</li><li>当然，针对预防误删数据的问题，建议如下：<br> 把 sql_safe_updates 参数设置为 on 。这样一来，如果我们忘记在delete或者update语句中写where条件，或者where条件里面没有包含索引字段的话，这条语句的执行就会报错。<br> 代码上线前，必须经过 SQL审计 。</li></ol> 
<blockquote> 
 <p>如果确定要把一个小表的数据全部删掉，在设置了sql_safe_updates=on情况下，可以在delete语句中加上where条件，比如where id&gt;=0。</p> 
</blockquote> 
<h5><a id="82_truncatedrop__1141"></a>8.2 truncate/drop ：误删库/表</h5> 
<p>方案：<br> 这种情况下，要想恢复数据，就需要使用全量备份 ，加增量日志 的方式了。这个方案要求线上有定期的全量备份，并且实时备份binlog。</p> 
<p>在这两个条件都具备的情况下，假如有人中午12点误删了一个库，恢复数据的流程如下：</p> 
<ol><li>取最近一次 全量备份 ，假设这个库是一天一备，上次备份是当天 凌晨2点 ；</li><li>用备份恢复出一个临时库 ；</li><li>从日志备份里面，取出凌晨2点之后的日志；</li><li>把这些日志，除了误删除数据的语句外，全部应用到临时库。</li></ol> 
<h5><a id="83__1153"></a>8.3 延迟复制备库</h5> 
<p>如果有非常核心 的业务，不允许太长的恢复时间，可以考虑搭建延迟复制的备库。一般的主备复制结构存在的问题是，如果主库上有个表被误删了，这个命令很快也会被发给所有从库，进而导致所有从库的数据表也都一起被误删了。</p> 
<p>延迟复制的备库是一种特殊的备库，通过 CHANGE MASTER TO MASTER_DELAY = N 命令，可以指定这个备库持续保持跟主库有 N秒的延迟 。比如你把N设置为3600，这就代表了如果主库上有数据被误删了，并且在1小时内发现了这个误操作命令，这个命令就还没有在这个延迟复制的备库执行。这时候到这个备库上执行stop slave，再通过之前介绍的方法，跳过误操作命令，就可以恢复出需要的数据。</p> 
<h5><a id="84__1159"></a>8.4 预防误删库/表的方法</h5> 
<ul><li>账号分离。这样做的目的是，避免写错命令。比如：<br> 1)只给业务开发同学DML权限，而不给truncate/drop权限。而如果业务开发人员有DDL需求的话，可以通过开发管理系统得到支持。</li></ul> 
<p>2)即使是DBA团队成员，日常也都规定只使用只读账号 ，必要的时候才使用有更新权限的账号。</p> 
<ul><li>制定操作规范。比如：<br> 在删除数据表之前，必须先对表做改名 操作。然后，观察一段时间，确保对业务无影响以后再删除这张表。<br> 改表名的时候，要求给表名加固定的后缀（比如加 _to_be_deleted )，然后删除表的动作必须通过管理系统执行。并且，管理系统删除表的时候，只能删除固定后缀的表。</li></ul> 
<h5><a id="85_rmMySQL_1170"></a>8.5 rm：误删MySQL实例</h5> 
<p>对于一个有高可用机制的MySQL集群来说，不用担心 rm删除数据 了。只是删掉了其中某一个节点的数据的话，HA系统就会开始工作，选出一个新的主库，从而保证整个集群的正常工作。我们要做的就是在这个节点上把数据恢复回来，再接入整个集群。</p> 
<h3><a id="9MySQL_1174"></a>9.附录：MySQL常用命令</h3> 
<h5><a id="91_mysql_1176"></a>9.1 mysql</h5> 
<p>该mysql不是指mysql服务，而是指mysql的客户端工具。</p> 
<p>语法 ：</p> 
<pre><code class="prism language-sql">mysql <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">database</span><span class="token punctuation">]</span>
</code></pre> 
<h6><a id="1__1186"></a>1. 连接选项</h6> 
<p>#参数 ：<br> -u, --user=name 指定用户名<br> -p, --password[=name] 指定密码<br> -h, --host=name 指定服务器IP或域名<br> -P, --port=# 指定连接端口</p> 
<pre><code class="prism language-sql"><span class="token comment">#示例 ：</span>
mysql <span class="token operator">-</span>h <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token operator">-</span>P <span class="token number">3306</span> <span class="token operator">-</span>u root <span class="token operator">-</span>p
mysql <span class="token operator">-</span>h127<span class="token punctuation">.</span><span class="token number">0.0</span><span class="token number">.1</span> <span class="token operator">-</span>P3306 <span class="token operator">-</span>uroot <span class="token operator">-</span>p密码
</code></pre> 
<h6><a id="2__1200"></a>2. 执行选项</h6> 
<pre><code class="prism language-sql"><span class="token operator">-</span>e<span class="token punctuation">,</span> <span class="token comment">--execute=name	执行SQL语句并退出</span>
</code></pre> 
<p>此选项可以在Mysql客户端执行SQL语句，而不用连接到MySQL数据库再执行，对于一些批处理脚本，这种方式尤其方便。</p> 
<pre><code class="prism language-sql"><span class="token comment">#示例：</span>
mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>p db01 <span class="token operator">-</span>e <span class="token string">"select * from tb_book"</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="92_mysqladmin_1213"></a>9.2 mysqladmin</h5> 
<p>mysqladmin 是一个执行管理操作的客户端程序。可以用它来检查服务器的配置和当前状态、创建并删除数据库等。</p> 
<p>可以通过 ： mysqladmin --help 指令查看帮助文档</p> 
<pre><code class="prism language-sql"><span class="token comment">#示例 ：</span>
mysqladmin <span class="token operator">-</span>uroot <span class="token operator">-</span>p <span class="token keyword">create</span> <span class="token string">'test01'</span><span class="token punctuation">;</span>
mysqladmin <span class="token operator">-</span>uroot <span class="token operator">-</span>p <span class="token keyword">drop</span> <span class="token string">'test01'</span><span class="token punctuation">;</span>
mysqladmin <span class="token operator">-</span>uroot <span class="token operator">-</span>p version<span class="token punctuation">;</span>
</code></pre> 
<h5><a id="93_mysqlbinlog_1226"></a>9.3 mysqlbinlog</h5> 
<p>由于服务器生成的二进制日志文件以二进制格式保存，所以如果想要检查这些文本的文本格式，就会使用到mysqlbinlog 日志管理工具。</p> 
<p>语法 ：</p> 
<pre><code class="prism language-sql">mysqlbinlog <span class="token punctuation">[</span>options<span class="token punctuation">]</span>	log<span class="token operator">-</span>files1 log<span class="token operator">-</span>files2 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token comment">#选项：</span>
<span class="token operator">-</span>d<span class="token punctuation">,</span> <span class="token comment">--database=name : 指定数据库名称，只列出指定的数据库相关操作。</span>
<span class="token operator">-</span>o<span class="token punctuation">,</span> <span class="token comment">--offset=# : 忽略掉日志中的前n行命令。</span>
<span class="token operator">-</span>r<span class="token punctuation">,</span><span class="token comment">--result-file=name : 将输出的文本格式日志输出到指定文件。</span>
<span class="token operator">-</span>s<span class="token punctuation">,</span> <span class="token comment">--short-form : 显示简单格式， 省略掉一些信息。</span>
<span class="token comment">--start-datatime=date1	--stop-datetime=date2 : 指定日期间隔内的所有日志。</span>
<span class="token comment">--start-position=pos1 --stop-position=pos2 : 指定位置间隔内的所有日志。</span>
</code></pre> 
<h5><a id="94_mysqldump_1243"></a>9.4 mysqldump</h5> 
<p>mysqldump 客户端工具用来备份数据库或在不同数据库之间进行数据迁移。备份内容包含创建表，及插入表的SQL语句。</p> 
<p>语法 ：</p> 
<pre><code class="prism language-sql">mysqldump <span class="token punctuation">[</span>options<span class="token punctuation">]</span> db_name <span class="token punctuation">[</span><span class="token keyword">tables</span><span class="token punctuation">]</span>
mysqldump <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token comment">--database/-B db1 [db2 db3...] mysqldump [options] --all-databases/-A</span>
</code></pre> 
<h6><a id="1__1254"></a>1. 连接选项</h6> 
<pre><code class="prism language-sql"><span class="token comment">#参数 ：		</span>
<span class="token operator">-</span>u<span class="token punctuation">,</span>	<span class="token comment">--user=name	指定用户名</span>
<span class="token operator">-</span>p<span class="token punctuation">,</span>	<span class="token comment">--password[=name]	指定密码</span>
<span class="token operator">-</span>h<span class="token punctuation">,</span>	<span class="token comment">--host=name	指定服务器IP或域名</span>
<span class="token operator">-</span>P<span class="token punctuation">,</span>	<span class="token comment">--port=#	指定连接端口</span>
</code></pre> 
<h6><a id="2__1264"></a>2. 输出内容选项</h6> 
<pre><code class="prism language-sql"><span class="token comment">#参数：</span>
<span class="token comment">--add-drop-database 在每个数据库创建语句前加上 Drop database 语句</span>
<span class="token comment">--add-drop-table 在每个表创建语句前加上 Drop table 语句 , 默认开启 ; 不开启 (--</span>
skip<span class="token operator">-</span><span class="token keyword">add</span><span class="token operator">-</span><span class="token keyword">drop</span><span class="token operator">-</span><span class="token keyword">table</span><span class="token punctuation">)</span>
<span class="token operator">-</span>n<span class="token punctuation">,</span> <span class="token comment">--no-create-db -t, --no-create-info  不包含数据表的创建语句</span>
<span class="token operator">-</span>d <span class="token comment">--no-data 不包含数据</span>
<span class="token operator">-</span>T<span class="token punctuation">,</span> <span class="token comment">--tab=name  自动生成两个文件：一个.sql文件，创建表结构的语句；</span>
一个<span class="token punctuation">.</span>txt文件，数据文件，相当于<span class="token keyword">select</span> <span class="token keyword">into</span> <span class="token keyword">outfile</span>
<span class="token number">12345678</span>
<span class="token comment">#示例 ：</span>
mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p db01 tb_book <span class="token comment">--add-drop-database --add-drop-table &gt; a</span>
mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p <span class="token operator">-</span>T <span class="token operator">/</span>tmp test city
</code></pre> 
<h5><a id="95_mysqlimportsource_1281"></a>9.5 mysqlimport/source</h5> 
<p>mysqlimport 是客户端数据导入工具，用来导入mysqldump 加 -T 参数后导出的文本文件。<br> 语法：</p> 
<pre><code class="prism language-sql">mysqlimport <span class="token punctuation">[</span>options<span class="token punctuation">]</span>	db_name	textfile1	<span class="token punctuation">[</span>textfile2<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
</code></pre> 
<p>示例：</p> 
<pre><code class="prism language-sql">mysqlimport <span class="token operator">-</span>uroot <span class="token operator">-</span>p test <span class="token operator">/</span>tmp<span class="token operator">/</span>city<span class="token punctuation">.</span>txt
</code></pre> 
<p>如果需要导入sql文件,可以使用mysql中的source 指令 :</p> 
<pre><code class="prism language-sql">source <span class="token operator">/</span>root<span class="token operator">/</span>tb_book<span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre> 
<h5><a id="96_mysqlshow_1302"></a>9.6 mysqlshow</h5> 
<p>mysqlshow 客户端对象查找工具，用来很快地查找存在哪些数据库、数据库中的表、表中的列或者索引。<br> 语法：</p> 
<pre><code class="prism language-sql">mysqlshow <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>db_name <span class="token punctuation">[</span>table_name <span class="token punctuation">[</span>col_name<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<p>参数：</p> 
<pre><code class="prism language-sql"><span class="token comment">--count	显示数据库及表的统计信息（数据库，表 均可以不指定）</span>
<span class="token operator">-</span>i	显示指定数据库或者指定表的状态信息
</code></pre> 
<p>示例：</p> 
<pre><code class="prism language-sql"><span class="token comment">#查询每个数据库的表的数量及表中记录的数量	</span>
mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p	<span class="token comment">--count			</span>
<span class="token punctuation">[</span>root<span class="token variable">@node1</span> atguigu2<span class="token punctuation">]</span><span class="token comment">#	mysqlshow -uroot -p --	count</span>
Enter password:					
<span class="token operator">+</span><span class="token comment">--------------------	+	--------	+	--------------	+</span>
<span class="token operator">|</span>	<span class="token keyword">Databases</span>	<span class="token operator">|</span>	<span class="token keyword">Tables</span> <span class="token operator">|</span>	Total <span class="token keyword">Rows</span>	<span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------	+	--------	+	--------------	+</span>
<span class="token operator">|</span> atguigu	<span class="token operator">|</span>	<span class="token number">24</span>	<span class="token operator">|</span>	<span class="token number">30107483</span>	<span class="token operator">|</span>
<span class="token operator">|</span> atguigu12	<span class="token operator">|</span>	<span class="token number">1</span>	<span class="token operator">|</span>	<span class="token number">1</span>	<span class="token operator">|</span>
<span class="token operator">|</span> atguigu14	<span class="token operator">|</span>	<span class="token number">6</span>	<span class="token operator">|</span>	<span class="token number">14</span>	<span class="token operator">|</span>
<span class="token operator">|</span> atguigu17	<span class="token operator">|</span>	<span class="token number">1</span>	<span class="token operator">|</span>	<span class="token number">1</span>	<span class="token operator">|</span>
<span class="token operator">|</span> atguigu18	<span class="token operator">|</span>	<span class="token number">0</span>	<span class="token operator">|</span>	<span class="token number">0</span>	<span class="token operator">|</span>
<span class="token operator">|</span> atguigu2	<span class="token operator">|</span>	<span class="token number">1</span>	<span class="token operator">|</span>	<span class="token number">3</span>	<span class="token operator">|</span>
<span class="token operator">|</span> atguigu_myisam	<span class="token operator">|</span>	<span class="token number">1</span>	<span class="token operator">|</span>	<span class="token number">4</span>	<span class="token operator">|</span>
<span class="token operator">|</span> information_schema	<span class="token operator">|</span>	<span class="token number">79</span>	<span class="token operator">|</span>	<span class="token number">34034</span>	<span class="token operator">|</span>
<span class="token operator">|</span> mysql	<span class="token operator">|</span>	<span class="token number">38</span>	<span class="token operator">|</span>	<span class="token number">4029</span>	<span class="token operator">|</span>
<span class="token operator">|</span> performance_schema	<span class="token operator">|</span>	<span class="token number">110</span>	<span class="token operator">|</span>	<span class="token number">399957</span>	<span class="token operator">|</span>
<span class="token operator">|</span> sys		<span class="token operator">|</span>	<span class="token number">101</span>	<span class="token operator">|</span>	<span class="token number">7028</span>	<span class="token operator">|</span>
						
 

<span class="token operator">+</span><span class="token comment">--------------------			+--------			+--------------			+			</span>
<span class="token number">11</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span><span class="token punctuation">.</span>										
<span class="token comment">#查询test库中每个表中的字段书，及行数						</span>
mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p atguigu <span class="token comment">--	count						</span>
<span class="token punctuation">[</span>root<span class="token variable">@node1</span> atguigu2<span class="token punctuation">]</span><span class="token comment"># mysqlshow -uroot -p atguigu --	count		</span>
Enter password:										
<span class="token keyword">Database</span>: atguigu										
<span class="token operator">+</span><span class="token comment">------------	+----------	+------------		+					</span>
<span class="token operator">|</span>   <span class="token keyword">Tables</span>	<span class="token operator">|</span> <span class="token keyword">Columns</span>	<span class="token operator">|</span>	Total <span class="token keyword">Rows</span> <span class="token operator">|</span>					
<span class="token operator">+</span><span class="token comment">------------	+----------	+------------		+					</span>
<span class="token operator">|</span> account		<span class="token operator">|</span>	<span class="token number">3</span>	<span class="token operator">|</span>		<span class="token number">3</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> book		<span class="token operator">|</span>	<span class="token number">3</span>	<span class="token operator">|</span>		<span class="token number">100</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> dept		<span class="token operator">|</span>	<span class="token number">3</span>	<span class="token operator">|</span>		<span class="token number">3</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> emp		<span class="token operator">|</span>	<span class="token number">8</span>	<span class="token operator">|</span>		<span class="token number">10</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> order1		<span class="token operator">|</span>	<span class="token number">2</span>	<span class="token operator">|</span>	<span class="token number">5715448</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> order2		<span class="token operator">|</span>	<span class="token number">2</span>	<span class="token operator">|</span>	<span class="token number">8000327</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> order_test	<span class="token operator">|</span>	<span class="token number">2</span>	<span class="token operator">|</span>	<span class="token number">8000327</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> salgrade	<span class="token operator">|</span>	<span class="token number">3</span>	<span class="token operator">|</span>		<span class="token number">0</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> stu2		<span class="token operator">|</span>	<span class="token number">6</span>	<span class="token operator">|</span>		<span class="token number">5</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> student		<span class="token operator">|</span>	<span class="token number">5</span>	<span class="token operator">|</span>	<span class="token number">8100010</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> t1		<span class="token operator">|</span>	<span class="token number">3</span>	<span class="token operator">|</span>		<span class="token number">210000</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> t_class		<span class="token operator">|</span>	<span class="token number">3</span>	<span class="token operator">|</span>		<span class="token number">0</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> test		<span class="token operator">|</span>	<span class="token number">2</span>	<span class="token operator">|</span>		<span class="token number">0</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> test_frm	<span class="token operator">|</span>	<span class="token number">2</span>	<span class="token operator">|</span>		<span class="token number">0</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> test_paper	<span class="token operator">|</span>	<span class="token number">1</span>	<span class="token operator">|</span>		<span class="token number">0</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> ts1		<span class="token operator">|</span>	<span class="token number">2</span>	<span class="token operator">|</span>		<span class="token number">79999</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> <span class="token keyword">type</span>		<span class="token operator">|</span>	<span class="token number">2</span>	<span class="token operator">|</span>		<span class="token number">240</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> undo_demo	<span class="token operator">|</span>	<span class="token number">3</span>	<span class="token operator">|</span>		<span class="token number">1</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> <span class="token keyword">user</span>		<span class="token operator">|</span>	<span class="token number">1</span>	<span class="token operator">|</span>		<span class="token number">1</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> user1		<span class="token operator">|</span>	<span class="token number">4</span>	<span class="token operator">|</span>		<span class="token number">1000</span>	<span class="token operator">|</span>					
<span class="token operator">+</span><span class="token comment">------------	+----------	+------------		+					</span>
<span class="token number">20</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span><span class="token punctuation">.</span>										
<span class="token comment">#查询test库中book表的详细情况								</span>
mysqlshow <span class="token operator">-</span>uroot <span class="token operator">-</span>p atguigu book   count<span class="token comment">--					</span>
<span class="token punctuation">[</span>root<span class="token variable">@node1</span> atguigu2<span class="token punctuation">]</span><span class="token comment"># mysqlshow -uroot -p atguigu book --	count	</span>
Enter password:										
<span class="token keyword">Database</span>: atguigu	<span class="token keyword">Table</span>: book	<span class="token keyword">Rows</span>: <span class="token number">100</span>					
<span class="token operator">+</span><span class="token comment">--------	+--------------		+-----------		+------	+-----	+---------	+----------------	+---------</span>
<span class="token comment">------------------------			+---------	+						</span>
<span class="token operator">|</span> Field	<span class="token operator">|</span> <span class="token keyword">Type</span>		<span class="token operator">|</span>	Collation <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> <span class="token keyword">Key</span> <span class="token operator">|</span> <span class="token keyword">Default</span> <span class="token operator">|</span> Extra	<span class="token operator">|</span>
<span class="token keyword">Privileges</span>					<span class="token operator">|</span> <span class="token keyword">Comment</span> <span class="token operator">|</span>					
<span class="token operator">+</span><span class="token comment">--------	+--------------		+-----------		+------	+-----	+---------	+----------------	+---------</span>
<span class="token comment">------------------------			+---------	+						</span>
<span class="token operator">|</span> bookid <span class="token operator">|</span> <span class="token keyword">int</span> <span class="token keyword">unsigned</span>	<span class="token operator">|</span>			<span class="token operator">|</span> <span class="token keyword">NO</span>	<span class="token operator">|</span> PRI <span class="token operator">|</span>		<span class="token operator">|</span> <span class="token keyword">auto_increment</span> <span class="token operator">|</span>
<span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">insert</span><span class="token punctuation">,</span><span class="token keyword">update</span><span class="token punctuation">,</span><span class="token keyword">references</span> <span class="token operator">|</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> card	<span class="token operator">|</span> <span class="token keyword">int</span> <span class="token keyword">unsigned</span>	<span class="token operator">|</span>			<span class="token operator">|</span> <span class="token keyword">NO</span>	<span class="token operator">|</span> MUL <span class="token operator">|</span>		<span class="token operator">|</span>	<span class="token operator">|</span>
<span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">insert</span><span class="token punctuation">,</span><span class="token keyword">update</span><span class="token punctuation">,</span><span class="token keyword">references</span> <span class="token operator">|</span>	<span class="token operator">|</span>					
<span class="token operator">|</span> test	<span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span> utf8_bin	<span class="token operator">|</span> YES	<span class="token operator">|</span>	<span class="token operator">|</span>		<span class="token operator">|</span>	<span class="token operator">|</span>
<span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">insert</span><span class="token punctuation">,</span><span class="token keyword">update</span><span class="token punctuation">,</span><span class="token keyword">references</span> <span class="token operator">|</span>	<span class="token operator">|</span>					
<span class="token operator">+</span><span class="token comment">--------	+--------------		+-----------		+------	+-----	+---------	+----------------	+---------</span>
<span class="token comment">------------------------			+---------	+						</span>
</code></pre> 
<hr> 
<p>说明：本内容整理自尚硅谷B站MySQL视频<a href="https://www.bilibili.com/video/BV1iq4y1u7vj?p=195" rel="nofollow">&gt;&gt;尚硅谷B站MySQL视频</a></p> 
<hr>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7a5ee8bc35b3cf8c94b2b7b71d42c86c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【MySQL 第18章_主从复制】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/52740fc51fed407cb8b90972cfa3af2d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Spring Boot】DataSource数据源的自动配置解析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>