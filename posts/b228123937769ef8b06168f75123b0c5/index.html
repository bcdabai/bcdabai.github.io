<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>zabbix6.0.5在lamp中部署教程 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="zabbix6.0.5在lamp中部署教程" />
<meta property="og:description" content="理论部分： Zabbix 介绍： Zabbix 由 Alexei Vladishev 创建，目前由其成立的公司—— Zabbix SIA 积极的持续开发更新维护， 并为用户提供技术支持服务。
Zabbix 支持主动轮询（polling）和被动捕获（trapping）。Zabbix所有的报表、统计数据和配置参数都可以通过基于 Web 的前端页面进行访问。基于 Web 的前端页面确保您可以在任何地方访问您监控的网络状态和服务器健康状况。适当的配置后，Zabbix 可以在监控 IT 基础设施方面发挥重要作用。无论是对于有少量服务器的小型组织，还是拥有大量服务器的大企业而言，同样适用。
zabbix两大模式： zabbix主动模式和被动模式配置在于agent客户端配置不同
主动模式：zabbix agent客户端主动发送信息给zabbix server端
被动模式：zabbix server定时的通过连接zabbix agent客户端的10050端口进行通信，获取agent客户端信息
在配置文件里修改:
StartAgents=1 #开启被动模式
StartAgents=0 # 关闭被动模式，开启主动模式，此时agent客户端不会监听10050端口
ServerActive=10.0.0.64 #zabbix server端的ip
注意：zabbix6.0必须要MySQL8.0或更高版本和PHP7.2.5或更高版本，不能超过PHP8.0
实验部分： 准备环境 两台centos7，zabbix6.0.5.tar.gz，lnmp
实验步骤 先上传必要的包百度网盘 提取码8wqu
搭建本地时间服务器
#下载ntp yum install -y ntp #修改配置文件 sed -i &#39;/^server/ s/^/#/g&#39; /etc/ntp.conf cat &lt;&lt;END&gt;&gt; /etc/ntp.conf restrict 192.168.100.0 mask 255.255.255.0 nomodify notrap server 192.168.100.1 server 127." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b228123937769ef8b06168f75123b0c5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-08T19:33:58+08:00" />
<meta property="article:modified_time" content="2023-03-08T19:33:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">zabbix6.0.5在lamp中部署教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>理论部分：</h2> 
<h3><strong>Zabbix 介绍：</strong></h3> 
<p>Zabbix 由 Alexei Vladishev 创建，目前由其成立的公司—— Zabbix SIA 积极的持续开发更新维护， 并为用户提供技术支持服务。</p> 
<p>Zabbix 支持主动轮询（polling）和被动捕获（trapping）。Zabbix所有的报表、统计数据和配置参数都可以通过基于 Web 的前端页面进行访问。基于 Web 的前端页面确保您可以在任何地方访问您监控的网络状态和服务器健康状况。适当的配置后，Zabbix 可以在监控 IT 基础设施方面发挥重要作用。无论是对于有少量服务器的小型组织，还是拥有大量服务器的大企业而言，同样适用。</p> 
<h3>zabbix两大模式：</h3> 
<p style="text-align:left;">zabbix主动模式和被动模式配置在于agent客户端配置不同</p> 
<p style="text-align:left;">主动模式：zabbix agent客户端主动发送信息给zabbix server端</p> 
<p style="text-align:left;">被动模式：zabbix server定时的通过连接zabbix agent客户端的10050端口进行通信，获取agent客户端信息</p> 
<p style="text-align:left;"></p> 
<p>在配置文件里修改:</p> 
<p style="margin-left:.0001pt;text-align:left;">StartAgents=1  #开启被动模式</p> 
<p style="margin-left:.0001pt;text-align:left;">StartAgents=0 # 关闭被动模式，开启主动模式，此时agent客户端不会监听10050端口</p> 
<p style="margin-left:.0001pt;text-align:left;">ServerActive=10.0.0.64  #zabbix server端的ip</p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"><img alt="" height="504" src="https://images2.imgbox.com/a8/8f/2GHf9dq3_o.png" width="1148"></p> 
<p style="text-align:left;">注意：zabbix6.0必须要MySQL8.0或更高版本和PHP7.2.5或更高版本，不能超过PHP8.0</p> 
<p style="text-align:left;"><img alt="" height="804" src="https://images2.imgbox.com/ec/72/FB1HMz94_o.png" width="1200"></p> 
<p><img alt="" height="931" src="https://images2.imgbox.com/3b/fc/0tajokTE_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<h2 style="text-align:left;">实验部分：</h2> 
<h3 style="text-align:left;">准备环境</h3> 
<p style="text-align:left;">两台centos7，zabbix6.0.5.tar.gz，lnmp</p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<h3 style="text-align:left;">实验步骤</h3> 
<p style="text-align:left;">先上传必要的包<a class="link-info" href="https://pan.baidu.com/s/1YYP4voV10omWFX1KyZ-K3Q" rel="nofollow" title="百度网盘">百度网盘</a>                提取码8wqu</p> 
<p style="text-align:left;"><img alt="" height="44" src="https://images2.imgbox.com/95/47/QmWiKkxA_o.png" width="742"></p> 
<p> 搭建本地时间服务器</p> 
<pre><code class="language-bash">#下载ntp
yum install -y ntp

#修改配置文件
sed -i '/^server/ s/^/#/g' /etc/ntp.conf



cat &lt;&lt;END&gt;&gt; /etc/ntp.conf
restrict 192.168.100.0 mask 255.255.255.0 nomodify notrap
server 192.168.100.1
server 127.127.1.0 
fudge 127.127.1.0 stratum 5 
END



#重启ntp
systemctl restart ntpd
systemctl enable ntpd
</code></pre> 
<p style="text-align:left;">安装依赖包</p> 
<blockquote> 
 <p style="text-align:left;">yum -y install libxml2 libxml2-devel</p> 
</blockquote> 
<p style="text-align:left;">将zabbix依赖包移动到/mnt/</p> 
<p style="text-align:left;"><img alt="" height="173" src="https://images2.imgbox.com/b0/d0/A161ZiIr_o.png" width="1132"></p> 
<p> 修改yum仓库，注释掉原有的，添加zabbix</p> 
<p><img alt="" height="488" src="https://images2.imgbox.com/a2/96/vSPZhuTq_o.png" width="1080"></p> 
<p> 清除缓存</p> 
<pre><code class="language-bash">yum clean all</code></pre> 
<p>再次安装依赖</p> 
<pre><code class="language-bash">yum -y install net-snmp net-snmp-devel  libcurl-devel libevent libevent libevent-devel curl curl-devel mysql-devel perl-DBI  httpd  gcc* net-snmp libssh2 libssh2-devel mysql-community-server mysql  php72w-cli php72w-common php72w-gd php72w-ldap php72w-mbstring php72w-mysqlnd php72w-xml php72w-bcmath mod_php72w</code></pre> 
<p style="text-align:left;">查看各个l版本</p> 
<p style="text-align:left;"><img alt="" height="120" src="https://images2.imgbox.com/e9/b2/vNtfuyXS_o.png" width="709"></p> 
<p style="text-align:left;"><img alt="" height="89" src="https://images2.imgbox.com/51/db/WAY7PnQ6_o.png" width="1200"></p> 
<p><img alt="" height="165" src="https://images2.imgbox.com/25/3c/09AcSijH_o.png" width="1106"></p> 
<p style="text-align:left;">开启MySQL和httpd</p> 
<pre><code class="language-bash">#开启并设置开机自启
systemctl enable mysqld --now
systemctl enable httpd --now</code></pre> 
<p style="text-align:left;">MySQL8.0以上版本有初始密码，他的密码在/var/log/mysqld.log </p> 
<p style="text-align:left;"><img alt="" height="771" src="https://images2.imgbox.com/75/2d/pvHvsu6J_o.png" width="1200"></p> 
<p>登录mysql并修改密码</p> 
<p><img alt="" height="241" src="https://images2.imgbox.com/04/4c/zRMSrvbK_o.png" width="1200"></p> 
<p>Enter输入初始密码</p> 
<p>New 输入新的密码，mysql8.0的密码必须有字母大小写，数字，字符，这里我写的是Nihao123!</p> 
<p>confirm是确认密码</p> 
<pre><code class="language-bash">mysql -u root -p 
#输入密码
Nihao123!
</code></pre> 
<p>查一下数据库内容</p> 
<p><img alt="" height="914" src="https://images2.imgbox.com/05/a2/ADw1yYOS_o.png" width="1200"></p> 
<p>解压zabbix-6.0.5.tar.gz</p> 
<pre><code class="language-bash">#解包
tar xf zabbix-6.0.5.tar.gz 

#进入zabbix6.0.5
cd zabbix-6.0.5

#配置
./configure --prefix=/usr/local/zabbix --enable-server --enable-agent --with-mysql --enable-ipv6 --with-net-snmp --with-libcurl --with-libxml2

#编译安装
make &amp;&amp;make install

</code></pre> 
<p><img alt="" height="147" src="https://images2.imgbox.com/ad/0f/4YGdluEI_o.png" width="1047"></p> 
<p>创建用户</p> 
<pre><code class="language-bash">#创建组账号
groupadd zabbix

#创建用户
useradd -r -g zabbix zabbix
</code></pre> 
<p>进入mysql进行授权</p> 
<pre><code class="language-bash">#进入mysql
mysql -uroot -pNihao123!	

#创建zabbix库
create database zabbix character set utf8 collate utf8_bin;

#进入zabbix
use zabbix

#设置来源路径，可以理解为导入数据库
source /root/zabbix-6.0.5/database/mysql/schema.sql;
source /root/zabbix-6.0.5/database/mysql/images.sql;
source /root/zabbix-6.0.5/database/mysql/data.sql;

#创建zabbix用户
create user zabbix@'192.168.100.%' identified by "Nihao123!";

#授权
grant all on zabbix.* to zabbix@'192.168.100.%' with grant option;

#刷新
flush privileges;
</code></pre> 
<p>zabbix-server配置</p> 
<pre><code class="language-bash">#创建日志文件
mkdir /usr/local/zabbix/logs

#修改属主和属组
chown zabbix:zabbix /usr/local/zabbix/ -R </code></pre> 
<pre><code class="language-bash">#编辑zabbix-server的配置文件
vim /usr/local/zabbix/etc/zabbix_server.conf

#删除注释行和空行
:%g/^#/d
:%g/^$/d

#修改
LogFile=/usr/local/zabbix/logs/zabbix_server.log
PidFile=/tmp/zabbix_server.pid
DBHost=192.168.100.6  
DBName=zabbix
DBUser=zabbix
DBPassword=Nihao123!
DBSocket=/var/lib/mysql/mysql.sock
Include=/usr/local/zabbix/etc/zabbix_server.conf.d/*.conf
LogSlowQueries=3000
StatsAllowedIP=127.0.0.1,192.168.100.6</code></pre> 
<p><img alt="" height="416" src="https://images2.imgbox.com/95/c8/7hcqH9jp_o.png" width="1093"></p> 
<p>zabbix-agent配置</p> 
<pre><code class="language-bash">#编辑agent配置文件
vim /usr/local/zabbix/etc/zabbix_agentd.conf

:%g/^#/d
:%g/^$/d


#修改
#运行的PID文件
PidFile=/tmp/zabbix_agentd.pid

#输入zabbix_server主机的ip地址
Server=192.168.100.6

#输入本机的主机名
Hostname=server.zabbix.com

#指定日志文件
LogFile=/usr/local/zabbix/logs/zabbix_agentd.log

#开启附加配置文件目录
Include=/usr/local/zabbix/etc/zabbix_agentd.conf.d/*.conf</code></pre> 
<p><img alt="" height="227" src="https://images2.imgbox.com/76/34/MZLXGyy7_o.png" width="1066"></p> 
<p>启动查看</p> 
<pre><code class="language-bash">/usr/local/zabbix/sbin/zabbix_server
/usr/local/zabbix/sbin/zabbix_agentd
netstat -utpln |grep 10051
netstat -utpln |grep 10050</code></pre> 
<p><img alt="" height="521" src="https://images2.imgbox.com/2f/57/fbJ6Ir6c_o.png" width="1200"></p> 
<p> 设置web</p> 
<pre><code class="language-bash">#将UI页面移动到/var/www/html/zabbix
mv /root/zabbix-6.0.5/ui /var/www/html/zabbix

#设置属主和属组
chown -R apache:apache /var/www/html/zabbix/
chown -R apache:apache /var/lib/php/session

#编辑PHP配置文件
vim /etc/php.ini

#878行添加
date.timezone = Asia/Shanghai

#656行修改
post_max_size = 16M

#368行修改
max_execution_time = 300

#378行修改
max_input_time = 300</code></pre> 
<p> 重启httpd服务</p> 
<pre><code class="language-bash">systemctl restart httpd</code></pre> 
<p> 浏览器访问（注意防火墙）：</p> 
<p>在浏览器访问192.168.100.6/zabbix</p> 
<hr> 
<p>这里选择中文</p> 
<p><img alt="" height="910" src="https://images2.imgbox.com/a5/5b/eutehNgW_o.png" width="1200"></p> 
<p> 全是OK就下一步，如果有不是OK的如没有达到最低要求的，到/etv/php.int中修改相应的参数</p> 
<p><img alt="" height="927" src="https://images2.imgbox.com/5f/37/Fp6a5Su0_o.png" width="1200"></p> 
<p> 数据库主机写本机ip，密码写在数据库授权的密码<img alt="" height="950" src="https://images2.imgbox.com/17/09/sR6FGKR5_o.png" width="1200"></p> 
<p> 如果连不上，如下图：</p> 
<p><img alt="" height="966" src="https://images2.imgbox.com/51/84/QTCEsIFn_o.png" width="1200"></p> 
<pre><code class="language-bash">#修改配置文件
vi /etc/my.cnf

#在mysqld中插入一行
[mysqld]
default-authentication-plugin=mysql_native_password

#重启mysqld
systemctl restart mysqld

#进入mysql
mysql -u root -pNihao123!

#进入mysql库
use mysql

#修改授权
ALTER USER 'zabbix'@'192.168.100.%' IDENTIFIED WITH mysql_native_password BY 'Nihao123!';

#刷新权限
flush privileges;



</code></pre> 
<p>做完以上配置，刷新页面即可</p> 
<p></p> 
<p>主机名称随便写</p> 
<p><img alt="" height="1004" src="https://images2.imgbox.com/76/ec/ZDQysfqK_o.png" width="1200"></p> 
<p>下一步</p> 
<p><img alt="" height="1003" src="https://images2.imgbox.com/92/cb/Mi7zHucj_o.png" width="1200"></p> 
<p><img alt="" height="993" src="https://images2.imgbox.com/45/d1/6uMYeQgD_o.png" width="1200"></p> 
<hr> 
<p>默认账号是Admin</p> 
<p>密码是zabbix</p> 
<p><img alt="" height="779" src="https://images2.imgbox.com/47/79/xyB3bTLU_o.png" width="859"></p> 
<p> <img alt="" height="1200" src="https://images2.imgbox.com/07/1b/GvaRphbh_o.png" width="1200"></p> 
<p>到这里就安装完成了</p> 
<p>想修改语言的话，在 User settings下的profile中</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/d7/8d/FNYwtKIz_o.png" width="1200"></p> 
<p>还有一个小bug，就是图形里有乱码，解决方法 </p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/89/a5/kQb61bVd_o.png" width="1200"></p> 
<p>在/var/www/html/zabbix/assets/fonts中，将原有的.ttf文件改名，再将自己准备的.ttf文件上传到此目录，并把名称改为原有.ttf的名称</p> 
<p><img alt="" height="248" src="https://images2.imgbox.com/21/79/r1U4zM1C_o.png" width="852"></p> 
<p><img alt="" height="326" src="https://images2.imgbox.com/5f/a9/Yy3R6UbJ_o.png" width="969"></p> 
<p> 授权<img alt="" height="207" src="https://images2.imgbox.com/fc/3d/B1hv1XSF_o.png" width="1105"></p> 
<p> 刷新浏览器页面，就已经不乱码了 </p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/9e/bd/drvzE2jF_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p style="text-align:left;"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7801b2e51ade8848023b683958349654/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">zabbix6.0.5在lnmp环境上安装</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7e7086d0764d943bf232fd1388986c98/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">el-table用法总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>