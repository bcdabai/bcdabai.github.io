<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>docker仓库harbor安装与使用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="docker仓库harbor安装与使用" />
<meta property="og:description" content="docker最重要的三个概念：docker镜像，docker容器，以及docker仓库。docker镜像是是docker虚拟化中最基础的部分，通过docker镜像来启动一个docker容器，docker 容器是docker虚拟化的产物。
而docker仓库是用来存储docker镜像的地方，分为公有仓库和私用仓库。默认的公共仓库，对外开放、免费或者付费使用，企业测试环境和生产环境推荐自建私有仓库。私有仓库的特点：安全、可靠、稳定、高效，可以根据自身的业务体系进行灵活升级和管理。
使用harbor做为docker仓库的优点有：
安全，可靠，性能稳定。
一、部署harbo
#安装Docker-Compose [root@localhost src]# yum install epel-release -y [root@localhost src]# yum install python-pip -y [root@localhost src]# pip install --upgrade pip [root@localhost src]# curl -L https://github.com/docker/compose/releases/download/1.18.0/run.sh &gt; /usr/local/bin/docker-compose % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 643 100 643 0 0 1267 0 --:--:-- --:--:-- --:--:-- 1268 [root@localhost src]# chmod &#43;x /usr/local/bin/docker-compose [root@localhost src]# ls /usr/local/bin/docker-compose /usr/local/bin/docker-compose #下载harbor 安装harbor [root@localhost src]# cd /usr/src [root@localhost src] wget -c https://storage." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/4026a73d0e262c313862e841cb7cb1d1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-11T09:55:23+08:00" />
<meta property="article:modified_time" content="2023-12-11T09:55:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">docker仓库harbor安装与使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>docker最重要的三个概念：docker镜像，docker容器，以及docker仓库。docker镜像是是docker虚拟化中最基础的部分，通过docker镜像来启动一个docker容器，docker 容器是docker虚拟化的产物。</p> 
<p>而docker仓库是用来存储docker镜像的地方，分为公有仓库和私用仓库。默认的公共仓库，对外开放、免费或者付费使用，企业测试环境和生产环境推荐自建私有仓库。私有仓库的特点：安全、可靠、稳定、高效，可以根据自身的业务体系进行灵活升级和管理。</p> 
<p>使用harbor做为docker仓库的优点有：</p> 
<p>安全，可靠，性能稳定。</p> 
<p>一、部署harbo</p> 
<pre><code>#安装Docker-Compose
[root@localhost src]# yum install epel-release -y
[root@localhost src]# yum install python-pip -y
[root@localhost src]# pip install --upgrade pip
[root@localhost src]# curl -L https://github.com/docker/compose/releases/download/1.18.0/run.sh &gt; /usr/local/bin/docker-compose 
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   643  100   643    0     0   1267      0 --:--:-- --:--:-- --:--:--  1268

[root@localhost src]# chmod +x /usr/local/bin/docker-compose
[root@localhost src]# ls /usr/local/bin/docker-compose       
/usr/local/bin/docker-compose

#下载harbor 安装harbor
[root@localhost src]# cd /usr/src

[root@localhost src] wget -c https://storage.googleapis.com/harbor-releases/release-1.7.0/harbor-offline-installer-v1.7.0.tgz

[root@localhost src]# ls
debug  harbor  harbor-offline-installer-v1.7.0.tgz  kernels

[root@localhost src]# tar -zxvf harbor-offline-installer-v1.7.0.tgz
[root@localhost /]# cd /usr/src/harbor
[root@localhost harbor]# ./install.sh
</code></pre> 
<p> 执行harbor安装脚本，会自动下载harbor与harbor相关docker镜像，配置，启动harbor容器</p> 
<p><img alt="" height="564" src="https://images2.imgbox.com/52/73/w9QRk24W_o.png" width="677"></p> 
<p> <img alt="" height="608" src="https://images2.imgbox.com/f4/91/x288Fyir_o.png" width="1200"></p> 
<p>浏览器输入主机地址，即可打开harbor登录窗口</p> 
<p><img alt="" height="588" src="https://images2.imgbox.com/06/93/YXhoRg81_o.png" width="795"></p> 
<p></p> 
<p>默认账号：admin 默认密码：Harbor12345，完成登录<img alt="" height="461" src="https://images2.imgbox.com/12/ed/dv7b87ad_o.png" width="892"></p> 
<p> 二、使用Harbor</p> 
<p>1、创建私有仓库用户名，并且设置密码，</p> 
<p>用户管理-创建用户</p> 
<p><img alt="" height="412" src="https://images2.imgbox.com/4c/04/duTcbaRI_o.png" width="662"></p> 
<p><img alt="" height="409" src="https://images2.imgbox.com/ee/c7/2DAWBhJD_o.png" width="946"></p> 
<p>2、把创建用户绑定library仓库</p> 
<p>项目-library-成员，添加刚才创建的用户</p> 
<p><img alt="" height="429" src="https://images2.imgbox.com/ca/7a/XCs4C37U_o.png" width="762"></p> 
<p> <img alt="" height="496" src="https://images2.imgbox.com/0f/5e/hhOhUz76_o.png" width="958"></p> 
<p></p> 
<p> docker login，确认使用创建用户登录</p> 
<pre><code>[root@localhost src]# docker login 192.168.139.132
Username: caixin
Password: 
WARNING! Your password will be stored unencrypted in /root/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

Login Succeeded
[root@localhost src]# </code></pre> 
<p>最后，通过push，把镜像上传到harbor仓库</p> 
<pre><code>[root@localhost src]# docker images
REPOSITORY                      TAG             IMAGE ID       CREATED         SIZE
nginx                           1.18.0          c2c45d506085   12 months ago   133MB
mysql                           5.7.32          cc8775c0fe94   15 months ago   449MB
php                             5.6-fpm         3458979c7744   3 years ago     344MB
goharbor/chartmuseum-photon     v0.7.1-v1.7.0   666d74cc236a   3 years ago     111MB
goharbor/harbor-migrator        v1.7.0          482699d98927   3 years ago     799MB
goharbor/redis-photon           v1.7.0          8adff755797f   3 years ago     96.1MB
goharbor/clair-photon           v2.0.7-v1.7.0   7e72f6ba05bd   3 years ago     165MB
goharbor/notary-server-photon   v0.6.1-v1.7.0   b4a22960dfce   3 years ago     102MB
goharbor/notary-signer-photon   v0.6.1-v1.7.0   bb0db7ebd1de   3 years ago     99.6MB
goharbor/harbor-registryctl     v1.7.0          1906a8b84fa5   3 years ago     101MB
goharbor/registry-photon        v2.6.2-v1.7.0   677f21b09362   3 years ago     86.4MB
goharbor/nginx-photon           v1.7.0          6ed96fc73f83   3 years ago     35.5MB
goharbor/harbor-log             v1.7.0          722fa4a77846   3 years ago     81MB
goharbor/harbor-jobservice      v1.7.0          effd390c0cd4   3 years ago     83.8MB
goharbor/harbor-core            v1.7.0          2ebd58ce5638   3 years ago     95.2MB
goharbor/harbor-portal          v1.7.0          72a291f86bab   3 years ago     40.2MB
goharbor/harbor-adminserver     v1.7.0          9f850341a571   3 years ago     72MB
goharbor/harbor-db              v1.7.0          45d94fe5fee5   3 years ago     133MB
docker/compose                  1.18.0          8a01ec091f90   4 years ago     19.2MB
[root@localhost src]#</code></pre> 
<p>例如，把上面nginx,mysql,php三个镜像上传到harbor仓库</p> 
<p>上传之前，仓库内容为空，啥也没有</p> 
<p><img alt="" height="408" src="https://images2.imgbox.com/26/13/TWHvLVOl_o.png" width="801"></p> 
<p> 首先，修改TAG，tag号修改为如下格式：</p> 
<p>192.168.139.132<code>/</code>library/nginx:</p> 
<p>192.168.139.132<code>/</code>library/mysql:</p> 
<p>192.168.139.132<code>/</code>library/php:</p> 
<pre><code>[root@localhost src]# docker tag nginx:1.18.0 192.168.139.132/library/nginx:1.18.0
[root@localhost src]# docker tag mysql:5.7.32  192.168.139.132/library/mysql:5.7.32
[root@localhost src]# docker tag php:5.6-fpm   192.168.139.132/library/php:5.6-fpm

[root@localhost src]# docker images
REPOSITORY                      TAG             IMAGE ID       CREATED         SIZE
192.168.139.132/library/nginx   1.18.0          c2c45d506085   12 months ago   133MB
nginx                           1.18.0          c2c45d506085   12 months ago   133MB
192.168.139.132/library/mysql   5.7.32          cc8775c0fe94   15 months ago   449MB
mysql                           5.7.32          cc8775c0fe94   15 months ago   449MB
192.168.139.132/library/php     5.6-fpm         3458979c7744   3 years ago     344MB
php                             5.6-fpm         3458979c7744   3 years ago     344MB
goharbor/chartmuseum-photon     v0.7.1-v1.7.0   666d74cc236a   3 years ago     111MB
goharbor/harbor-migrator        v1.7.0          482699d98927   3 years ago     799MB
goharbor/redis-photon           v1.7.0          8adff755797f   3 years ago     96.1MB
goharbor/clair-photon           v2.0.7-v1.7.0   7e72f6ba05bd   3 years ago     165MB
goharbor/notary-server-photon   v0.6.1-v1.7.0   b4a22960dfce   3 years ago     102MB
goharbor/notary-signer-photon   v0.6.1-v1.7.0   bb0db7ebd1de   3 years ago     99.6MB
goharbor/harbor-registryctl     v1.7.0          1906a8b84fa5   3 years ago     101MB
goharbor/registry-photon        v2.6.2-v1.7.0   677f21b09362   3 years ago     86.4MB
goharbor/nginx-photon           v1.7.0          6ed96fc73f83   3 years ago     35.5MB
goharbor/harbor-log             v1.7.0          722fa4a77846   3 years ago     81MB
goharbor/harbor-jobservice      v1.7.0          effd390c0cd4   3 years ago     83.8MB
goharbor/harbor-core            v1.7.0          2ebd58ce5638   3 years ago     95.2MB
goharbor/harbor-portal          v1.7.0          72a291f86bab   3 years ago     40.2MB
goharbor/harbor-adminserver     v1.7.0          9f850341a571   3 years ago     72MB
goharbor/harbor-db              v1.7.0          45d94fe5fee5   3 years ago     133MB
docker/compose                  1.18.0          8a01ec091f90   4 years ago     19.2MB
[root@localhost src]# </code></pre> 
<p>PUSH上传镜像<br>  </p> 
<pre><code>[root@localhost src]# docker push 192.168.139.132/library/nginx:1.18.0
[root@localhost src]# docker push 192.168.139.132/library/mysql:5.7.32
The push refers to repository [192.168.139.132/library/mysql]
df1ee06a30c4: Pushed 
902dedce4cb4: Pushed 
569a2d6e5302: Pushed 
8bdb6ee41f57: Pushed 
98d98806c8ac: Pushed 
0394a41efa73: Pushed 
c484a3b6d841: Pushed 
6d23902c2a54: Pushed 
74c86dffd46f: Pushed 
ef4a33cee7a0: Pushed 
cb42413394c4: Pushed 
5.7.32: digest: sha256:860f4bcc18607de9f40a7453c7dc160313ecc3a5a46be3b060569b6216d348f6 size: 2621
[root@localhost src]#
[root@localhost src]# docker push 192.168.139.132/library/php:5.6-fpm
The push refers to repository [192.168.139.132/library/php]
bf97b47da88d: Pushed 
56d6009fbc8b: Pushed 
b6d5993da6a4: Pushed 
c9e57440aae2: Pushed 
5e2afcdec12b: Pushed 
6e4f2e72b0d9: Pushed 
6eb3cfd4ad9e: Pushed 
82bded2c3a7c: Pushed 
b87a266e6a9c: Pushed 
3c816b4ead84: Pushed 
5.6-fpm: digest: sha256:7cfd6ccb875ff314b2c672b62aa3169fe79d54bf3422b7b0017955b3457ca1a7 size: 2410
[root@localhost src]# </code></pre> 
<p>最后查看镜像上传情况，是否上传到Harbor仓库</p> 
<p><img alt="" height="514" src="https://images2.imgbox.com/b8/57/cXuxDGDH_o.png" width="1071"></p> 
<p>如果要使用harbor仓库里面的镜像，只需要到登录到仓库，打开对应镜像，复制pull命令到linux里执行即可。</p> 
<p><img alt="" height="461" src="https://images2.imgbox.com/10/7e/8GuOX4Mj_o.png" width="815"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d13f3622fde654df13e1d355f92679ca/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于Android(安卓)&#43;MySQL&#43;Tomcat开发的吃货点餐平台</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9e1c447521963dc275104e8d6ecff4e3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Windows下查看删除某一个端口号</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>