<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>VS2019-C&#43;&#43;创建和调用DLL动态链接库（傻瓜式教程） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="VS2019-C&#43;&#43;创建和调用DLL动态链接库（傻瓜式教程）" />
<meta property="og:description" content="前言：查了好久好久网上的资料C&#43;&#43;调用动态链接库，试了好多方法（直接创建DLL、空项目创建的）都多多少少有些问题，最后自己不断摸索着成功了，还是很开心的，接下来把最清晰的步骤分享给大家（C&#43;&#43;新人，有什么说的不清楚的还请大佬们见谅）
第一步：创建C&#43;&#43;空项目 第二步：创建头文件(.h)以及源文件(.cpp) 第三步：编写头文件（重点） 图片显示部分是模板，名称可以自己起最重要的就是__declspec(dllexport)以及__declspec(dllimport)。一个是导出，一个是导入。
为像我一样懒人们提供代码粘贴
#pragma once #ifndef BHDLL_d #define BHDLL_d //宏定义导出 #ifdef BHDLL__//如果没有定义DLLH 就定义 DLLH __declspec(dllexport) #define BHDLL __declspec(dllexport)//导出 #else #define BHDLL __declspec(dllimport)//导入 #endif // DLLH__//如果没有定义DLLH 就定义 DLLH //编写代码区域 //导出函数 BHDLL int add(int a, int b); BHDLL int sub(int a, int b); //导出类 class BHDLL dllH { public: int mul(int a, int b); int div(int a, int b); }; //以C语言方式导出函数： extern &#34;C&#34; { BHDLL int Cadd(int a, int b); BHDLL int Csub(int a, int b); } #endif 第四步：源文件实现头文件里面的方法 为像我一样懒人们提供代码粘贴" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1b33d7026e4dd56f5a82123c672f67f4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-26T11:44:32+08:00" />
<meta property="article:modified_time" content="2022-04-26T11:44:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">VS2019-C&#43;&#43;创建和调用DLL动态链接库（傻瓜式教程）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="color:#79c6cd;"><strong>前言：查了好久好久网上的资料C++调用动态链接库，试了好多方法（直接创建DLL、空项目创建的）都多多少少有些问题，最后自己不断摸索着成功了，还是很开心的，接下来把最清晰的步骤分享给大家（C++新人，有什么说的不清楚的还请大佬们见谅）</strong></span></p> 
<h4><strong>第一步：创建C++空项目</strong></h4> 
<p><img alt="" height="788" src="https://images2.imgbox.com/33/37/WWzgWlDC_o.png" width="1125"></p> 
<p><img alt="" height="788" src="https://images2.imgbox.com/37/70/LiJUxwtT_o.png" width="1125"></p> 
<h4><strong>第二步：创建头文件(.h)以及源文件(.cpp)</strong></h4> 
<p> <img alt="" height="846" src="https://images2.imgbox.com/41/71/7ONrP4Hj_o.png" width="1200"></p> 
<h2><span style="color:#fe2c24;">第三步：编写头文件（重点）</span></h2> 
<p> 图片显示部分是模板，名称可以自己起最重要的就是__declspec(dllexport)以及__declspec(dllimport)。一个是导出，一个是导入。<img alt="" height="1059" src="https://images2.imgbox.com/bd/4b/8DSLKGuS_o.png" width="1200"></p> 
<p> 为像我一样懒人们提供代码粘贴</p> 
<pre><code class="language-cpp">#pragma once

#ifndef BHDLL_d
#define BHDLL_d

//宏定义导出
#ifdef BHDLL__//如果没有定义DLLH 就定义 DLLH __declspec(dllexport)
#define BHDLL __declspec(dllexport)//导出
#else
#define BHDLL __declspec(dllimport)//导入
#endif // DLLH__//如果没有定义DLLH 就定义 DLLH 

//编写代码区域

//导出函数

BHDLL int add(int a, int b);
BHDLL int sub(int a, int b);

//导出类

class BHDLL dllH
{
public:
  int mul(int a, int b);
  int div(int a, int b);
};

//以C语言方式导出函数：
extern "C"
{
  BHDLL int Cadd(int a, int b);
  BHDLL int Csub(int a, int b);
}



#endif</code></pre> 
<h4>第四步：源文件实现头文件里面的方法</h4> 
<p> 为像我一样懒人们提供代码粘贴</p> 
<pre><code class="language-cpp">#include "BH_dll.h"
#include &lt;iostream&gt;

using namespace std;

int add(int a, int b)
{
  return a + b;
}
int sub(int a, int b)
{
  return a - b;
}

int dllH::mul(int a, int b)
{
  return a * b;
}
int dllH::div(int a, int b)
{
  return a / b;
}

int Cadd(int a, int b)
{
  return a + b;
}
int Csub(int a, int b)
{
  return a - b;
}</code></pre> 
<h4>第五步：配置解决平台X86/X64都可以，但是这个导出的DLL，用户引用的时候尽量和导出时的DLL平台一致</h4> 
<p class="img-center"><img alt="" height="53" src="https://images2.imgbox.com/de/d4/gz6JnbOw_o.png" width="455"></p> 
<h4> 第六步：配置类型-属性</h4> 
<p><img alt="" height="930" src="https://images2.imgbox.com/50/a4/DXBmofHT_o.png" width="556"></p> 
<p> <img alt="" height="684" src="https://images2.imgbox.com/e1/21/Bg6kut6f_o.png" width="984"></p> 
<p> 把配置类型变成动态库-应用-确定-生成解决方案。 </p> 
<p><img alt="" height="453" src="https://images2.imgbox.com/37/77/3J3BBBb9_o.png" width="493"></p> 
<h4>  第七步：完成动态链接库创建</h4> 
<p>在项目文件中可以找到dll,lib,,h文件，我们要的就是这三个</p> 
<p><img alt="" height="335" src="https://images2.imgbox.com/3e/02/QHbrkPkc_o.png" width="1017"></p> 
<p> <img alt="" height="309" src="https://images2.imgbox.com/33/2f/7RhvxSzf_o.png" width="940"></p> 
<h4>   第八步：创建新项目引用动态链接库</h4> 
<p><img alt="" height="788" src="https://images2.imgbox.com/71/69/HgzLwi6l_o.png" width="1125"></p> 
<p><img alt="" height="788" src="https://images2.imgbox.com/61/58/Tj8qqtxn_o.png" width="1125"></p> 
<p>添加main函数</p> 
<p><img alt="" height="902" src="https://images2.imgbox.com/e7/d2/nGGm1Jwf_o.png" width="1200"></p> 
<h2><span style="color:#fe2c24;"><strong>第九步：引用DLL</strong></span></h2> 
<p> 在项目文件下创建两个文件夹，后续往里添加三个文件<img alt="" height="843" src="https://images2.imgbox.com/e4/1a/rdzrVG6x_o.png" width="1189"></p> 
<p> <span style="color:#fe2c24;">在include文件中添加刚才BH_DLL文件生成的.h文件</span></p> 
<p><span style="color:#fe2c24;">在lib文件中添加刚才BH_DLL文件生成的dll和lib文件</span></p> 
<p><span style="color:#fe2c24;">在项目文件夹下再次添加刚才BH_DLL文件生成的dll文件</span></p> 
<p>如图所示</p> 
<p><img alt="" height="446" src="https://images2.imgbox.com/7e/e1/9JPy92Pc_o.png" width="1048"></p> 
<p><img alt="" height="189" src="https://images2.imgbox.com/40/6f/bT5kktz8_o.png" width="896"></p> 
<p> <img alt="" height="271" src="https://images2.imgbox.com/3c/0b/0bg1hqtP_o.png" width="1000"></p> 
<p> 配置新建项目的目录</p> 
<h2><span style="color:#fe2c24;">配置之前一定要检查平台，一定要和生成DLL的平台一致然后再配置接下来的文件</span></h2> 
<p class="img-center"><img alt="" height="59" src="https://images2.imgbox.com/08/39/ImisqsKs_o.png" width="344"></p> 
<p><img alt="" height="988" src="https://images2.imgbox.com/90/36/5o5SuavZ_o.png" width="579"></p> 
<p> 包含目录包含include<img alt="" height="356" src="https://images2.imgbox.com/85/fd/ePZh08DR_o.png" width="977"></p> 
<p> <img alt="" height="164" src="https://images2.imgbox.com/6f/49/z8LLGcXz_o.png" width="942"></p> 
<p> 库目录包含lib</p> 
<p><img alt="" height="310" src="https://images2.imgbox.com/58/b2/bYqmjQ8m_o.png" width="959"><img alt="" height="266" src="https://images2.imgbox.com/f3/2f/KcG7JLD3_o.png" width="994"></p> 
<p> 链接器-输入-附加依赖项包含lib文件名称</p> 
<p><img alt="" height="366" src="https://images2.imgbox.com/58/71/ObGni0IT_o.png" width="989"></p> 
<p> <img alt="" height="296" src="https://images2.imgbox.com/5a/b1/25koO1ne_o.png" width="892"></p> 
<p> <img alt="" height="288" src="https://images2.imgbox.com/fd/b0/9QsRh62c_o.png" width="996"></p> 
<p> 应用-确认。</p> 
<h3><span style="color:#4da8ee;"><strong>至此配置全部完成，接下来在main函数中引用</strong></span></h3> 
<p><img alt="" height="927" src="https://images2.imgbox.com/24/1a/7wAlK3PD_o.png" width="1200"></p> 
<pre><code class="language-cpp">#include &lt;iostream&gt;

using namespace std;
#include &lt;BH_dll.h&gt;

int main()
{
  cout &lt;&lt; add(1, 0) &lt;&lt; endl;
  cout &lt;&lt; sub(1, 0) &lt;&lt; endl;

  dllH DH;
  cout &lt;&lt; DH.div(4, 2) &lt;&lt; endl;
  cout &lt;&lt; DH.mul(4, 2) &lt;&lt; endl;

  cout &lt;&lt; Cadd(1, 0) &lt;&lt; endl;
  cout &lt;&lt; Csub(1, 0) &lt;&lt; endl;
  getchar();
  return 0;
}</code></pre> 
<p><img alt="" height="639" src="https://images2.imgbox.com/1e/ab/HPj0S6kF_o.png" width="1200"></p> 
<p> 完成！</p> 
<p><span style="color:#ad720d;">有什么说的不对的地方还请大佬们在评论区留言，我看到了会改正，谢谢各位。</span></p> 
<p><span style="color:#ad720d;">接下来会学习Qt调用C++DLL，学会了还会更新一期，如果哪位大佬知道捷径的话麻烦放个传送门在评论区呗，谢谢啦。</span></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0415326b325a3ac58537ae1902c20cb9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python 线程池map()方法传递多参数list</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2005ddaeb829061c7ecd00c527706a90/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">spring中cglib动态代理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>