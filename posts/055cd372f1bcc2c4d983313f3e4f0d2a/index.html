<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>rootfs根文件系统镜像制作 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="rootfs根文件系统镜像制作" />
<meta property="og:description" content="http://t.csdnimg.cn/2xKLM
在嵌入式linux平台中，大部分工作则是填充根文件系统，在开发中，根文件系统一般都是以目录的方式放在开发宿主机上。
当根文件系统填充完成后，我们需要将其打包成xxx.img或者其他的镜像格式。本文以xxx.img镜像格式为例，描述如何将根文件系统打包成img的镜像文件。
本文打包的根文件系统目录结构和文件如下图所示：
（文件和目录有点乱，不影响）
这些目录和文件都存放在rootfs目录下。
我们在rootfs目录的同级目录下打开linux终端，输入如下命令：
dd if=/dev/zero of=rk3568.img bs=1M count=2000
1
如下图所示：
上图中：
dd ：是linux命令，用于读取、转换并输出数据。
if ：表示输入文件。
of ：表示输出文件。
bs ： 表示块大小。
count ：表示被复制的块数。
上述命令的意思则是创建一个2000M（约2G）的文件，内容全部填充为0。
运行上述命令后，则会创建一个rk3568.img的文件，接下来就创建一个ext4的文件系统镜像。
在终端输入：
sudo mkfs.ext4 -F -L linuxroot rk3568.img
1
如下图所示：
sudo mkfs.ext4 ：为linux命令，用于对磁盘设备进行Ext4格式化的操作。
-F ：表示强制格式化。
-L ：设置卷标。这里则是linuxroot
rk356.img : 则是设备。
然后在终端输入下列命令：
mkdir tmpfs
1
创建一个tmpfs文件。其中mkdir为linux命令，用于创建一个目录；tmpfs为名录名称（可自定义）。
接着使用下列命令：
sudo mount rk3568.img tempfs/
1
将rk3568.img文件系统挂载到tmpfs。
使用下列命令，将rootfs目录下的目录和文件拷贝到tmpfs目录：
sudo cp -rfp rootfs/* tmpfs/
1
完成后，使用下列命令卸载文件系统：
sudo umount tmpfs/" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/055cd372f1bcc2c4d983313f3e4f0d2a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-15T10:41:32+08:00" />
<meta property="article:modified_time" content="2023-12-15T10:41:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">rootfs根文件系统镜像制作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><a href="http://t.csdnimg.cn/2xKLM" rel="nofollow" title="http://t.csdnimg.cn/2xKLM">http://t.csdnimg.cn/2xKLM</a></p> 
<p>在嵌入式linux平台中，大部分工作则是填充根文件系统，在开发中，根文件系统一般都是以目录的方式放在开发宿主机上。</p> 
<p>当根文件系统填充完成后，我们需要将其打包成xxx.img或者其他的镜像格式。本文以xxx.img镜像格式为例，描述如何将根文件系统打包成img的镜像文件。</p> 
<p>本文打包的根文件系统目录结构和文件如下图所示：</p> 
<p><br> （文件和目录有点乱，不影响）</p> 
<p>这些目录和文件都存放在rootfs目录下。</p> 
<p>我们在rootfs目录的同级目录下打开linux终端，输入如下命令：</p> 
<p>dd if=/dev/zero of=rk3568.img bs=1M count=2000<br> 1<br> 如下图所示：</p> 
<p>上图中：</p> 
<p>dd ：是linux命令，用于读取、转换并输出数据。<br> if ：表示输入文件。<br> of ：表示输出文件。<br> bs ： 表示块大小。<br> count ：表示被复制的块数。<br> 上述命令的意思则是创建一个2000M（约2G）的文件，内容全部填充为0。</p> 
<p>运行上述命令后，则会创建一个rk3568.img的文件，接下来就创建一个ext4的文件系统镜像。</p> 
<p>在终端输入：</p> 
<p>sudo mkfs.ext4 -F -L linuxroot rk3568.img<br> 1<br> 如下图所示：</p> 
<p>sudo mkfs.ext4 ：为linux命令，用于对磁盘设备进行Ext4格式化的操作。<br> -F ：表示强制格式化。<br> -L ：设置卷标。这里则是linuxroot<br> rk356.img : 则是设备。<br> 然后在终端输入下列命令：</p> 
<p>mkdir tmpfs<br> 1<br> 创建一个tmpfs文件。其中mkdir为linux命令，用于创建一个目录；tmpfs为名录名称（可自定义）。</p> 
<p>接着使用下列命令：</p> 
<p>sudo mount rk3568.img tempfs/<br> 1<br> 将rk3568.img文件系统挂载到tmpfs。</p> 
<p>使用下列命令，将rootfs目录下的目录和文件拷贝到tmpfs目录：</p> 
<p>sudo cp -rfp rootfs/* tmpfs/<br> 1<br> 完成后，使用下列命令卸载文件系统：</p> 
<p>sudo umount tmpfs/<br> 1<br> 接下来使用：</p> 
<p>sudo e2fsck -p -f rk3568.img<br> 1<br> 检查ext4文件系统的正确性。上述命令中：</p> 
<p>-f：表示即使文件系统没有错误迹象，仍强制地检查正确性。<br> -p：表示不询问使用者意见，便自动修复文件系统。</p> 
<p><br> 然后使用：</p> 
<p>sudo resize2fs -M rk3568.img<br> 1<br> 调整文件系统的大小，如下图所示：</p> 
<p>通过上述步骤，就将根文件系统完全打包成img镜像文件了。<br> ————————————————<br> 版权声明：本文为CSDN博主「iriczhao」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br> 原文链接：https://blog.csdn.net/iriczhao/article/details/127078414</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/546bd573ac7361e030103b4238973963/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">端口占用Identify and stop the process that‘s listening on port 8083 or configure this application to lis</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/58280415ac5a14802dcf3b6d248434a5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Qt 自定义类时，手动添加 Q_OBJECT 出现错误</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>