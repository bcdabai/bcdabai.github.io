<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于STM32从零写操作系统系列---基于寄存器写串口驱动 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="基于STM32从零写操作系统系列---基于寄存器写串口驱动" />
<meta property="og:description" content="如有不详细的描述、错误或疑问，欢迎留言！！！ 基于STM32从零写操作系统系列---前言与目录 目的 尝试基于寄存器层面，编写串口的驱动。用这种方式编写串口驱动，有点类似于使用汇编语言。面向的是每一个单独的寄存器，通过读、改、写的手段，配置寄存器。但是这种方式能够更接近硬件，用硬件的思维编程。
相对于《基于STM32从零写操作系统系列---使用C语言》，这章重新调整了文件结构，让项目文件更好管理和维护。主要使用了makefile的嵌套编译方法来编译多目录下的代码文件。
分析 1.Makefile嵌套编译
首先简单来看一下文件结构：
再看一下顶层Makefile，主要差异如下：
各子目录下的Makefile比较简单
其中需要注意的是：
在windows的cmd命令行中for命令用于查找文件，@echo用于输出找到的文件路径。这与linux系统中的find命令类似。OBJS变量中的多个.o文件用于链接生成.out文件。
2.寄存器与串口驱动编写
设置某个功能，本质就是向寄存器某个位或字段写入相关数据。所以必须看清楚你要写入的寄存器的地址是否准确，修改的位或字段是否准确。 3.在led.c中调用串口1初始化函数
4.编译下载调试
由于USART1.c使用了&lt;&gt;尖括号的头文件，还有编译选项中使用了 -nostdinc -nostdlib（即不用标准头文件和标准库），所以确保编译选项中有-I（大写i）并路径正确。
小结 源代码在这里 源代码里有更详细的注释。我在stm32f103zet6平台上测试过，是可以用的。如果不行，可以自己调试以下，找出错误或平台的差异。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1be565b5a565b3d254ab1234b144d658/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-02-19T17:24:04+08:00" />
<meta property="article:modified_time" content="2019-02-19T17:24:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于STM32从零写操作系统系列---基于寄存器写串口驱动</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>如有不详细的描述、错误或疑问，欢迎留言！！！</h4> 
<h4><a href="https://blog.csdn.net/drsonxu/article/details/86649030">基于STM32从零写操作系统系列---前言与目录</a></h4> 
<h4>目的 </h4> 
<p>尝试基于寄存器层面，编写串口的驱动。用这种方式编写串口驱动，有点类似于使用汇编语言。面向的是每一个单独的寄存器，通过读、改、写的手段，配置寄存器。但是这种方式能够更接近硬件，用硬件的思维编程。</p> 
<p>相对于《<a href="https://blog.csdn.net/drsonxu/article/details/87275564">基于STM32从零写操作系统系列---使用C语言</a>》，这章重新调整了文件结构，让项目文件更好管理和维护。主要使用了makefile的嵌套编译方法来编译多目录下的代码文件。</p> 
<h4>分析</h4> 
<p>1.Makefile嵌套编译</p> 
<p>首先简单来看一下文件结构：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/5e/82/6UaybD3l_o.png"></p> 
<p>再看一下顶层Makefile，主要差异如下：</p> 
<p><img alt="" class="has" height="105" src="https://images2.imgbox.com/cf/21/ywVCi22p_o.png" width="272"></p> 
<p> 各子目录下的Makefile比较简单</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/c5/ab/x2s2nhnS_o.png"></p> 
<p><img alt="" class="has" height="173" src="https://images2.imgbox.com/04/60/BGd7IMWY_o.png" width="458"> </p> 
<p>其中需要注意的是：</p> 
<p><img alt="" class="has" height="43" src="https://images2.imgbox.com/a5/96/VjMgrzxi_o.png" width="859"></p> 
<p>在windows的cmd命令行中for命令用于查找文件，@echo用于输出找到的文件路径。这与linux系统中的find命令类似。OBJS变量中的多个.o文件用于链接生成.out文件。</p> 
<p>2.寄存器与串口驱动编写</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/58/69/wxWNV7YY_o.png"></p> 
<p>设置某个功能，本质就是向寄存器某个位或字段写入相关数据。所以必须看清楚你要写入的寄存器的地址是否准确，修改的位或字段是否准确。 </p> 
<p>3.在led.c中调用串口1初始化函数</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/45/b7/kUuzqBMJ_o.png"></p> 
<p>4.编译下载调试</p> 
<p>由于USART1.c使用了&lt;&gt;尖括号的头文件，还有编译选项中使用了 -nostdinc -nostdlib（即不用标准头文件和标准库），所以确保编译选项中有-I（大写i）并路径正确。</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/2a/78/7V5c2v4r_o.png"></p> 
<h4>小结</h4> 
<h4><a href="https://gitee.com/drson/STM32_kernel_dev/tree/master/example/chapter7" rel="nofollow">源代码在这里</a></h4> 
<p> 源代码里有更详细的注释。我在stm32f103zet6平台上测试过，是可以用的。如果不行，可以自己调试以下，找出错误或平台的差异。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d8fee45006f8dd148672d80d0061806b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">苹果电脑安装Windows系统完整教程，新手快速解决装系统问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f653145555f4a609bcf11f53e8797945/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">WFP(二）——环境搭建 vs2017&#43;WDK</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>