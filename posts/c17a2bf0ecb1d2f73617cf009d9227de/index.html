<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Navigation网站收藏和导航平台 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Navigation网站收藏和导航平台" />
<meta property="og:description" content="初衷 估计很多人和小编一样，一开始将浏览过的觉得不错的网站收藏到浏览器的收藏夹中。日积月累，网站越来越多，在收藏夹里找所需网站越来越麻烦。后来浏览器从火狐转到Chrome，收藏的网站却不能同步过来。浏览器需要登录才能同步收藏夹的内容，这很痛苦……鉴于种种原因，有这样一个收藏、搜索和分类导航平台真的是棒极了，小编就自己做了一个开源项目——Navigation网站收藏和导航平台。
实现功能 网站CRUD 搜索 登录登出 网站截图 网站导航块瀑布流 网站嵌套iframe和搜索模块 网站提交页 在线Demo 预览
简单的实现思路 本地构建 &lt;!-- 下载项目 --&gt; git clone https://github.com/qiufeihong2018/navigation-server.git &lt;!-- 安装依赖 --&gt; npm install &lt;!-- 爬取数据 --&gt; node ./creeper/index.js &lt;!-- 启动程序 --&gt; npm run dev 之后访问http://localhost:1600即可
后端 navigation-server后端代码仓库
基于express框架
express搭建web应用 特征 强大的路由专注于高性能超高的测试覆盖率HTTP助手（重定向，缓存等）查看支持14&#43;模板引擎的系统内容协商可快速生成应用程序的可执行文件 解析 启动express服务
const express = require(&#39;express&#39;); const app = express(); const config = require(&#39;../config&#39;)(); // start server // Set http port app.set(&#39;port&#39;, config.expressHttpPort); app.listen(config.expressHttpPort, () =&gt; { // 开启端口打印日志 log." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c17a2bf0ecb1d2f73617cf009d9227de/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-09-04T11:50:46+08:00" />
<meta property="article:modified_time" content="2019-09-04T11:50:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Navigation网站收藏和导航平台</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/18/6f/gAELEAE2_o.png" alt="avatar"></p> 
<h3><a id="_3"></a>初衷</h3> 
<p>估计很多人和小编一样，一开始将浏览过的觉得不错的网站收藏到浏览器的收藏夹中。日积月累，网站越来越多，在收藏夹里找所需网站越来越麻烦。后来浏览器从火狐转到Chrome，收藏的网站却不能同步过来。浏览器需要登录才能同步收藏夹的内容，这很痛苦……鉴于种种原因，有这样一个收藏、搜索和分类导航平台真的是棒极了，小编就自己做了一个开源项目——Navigation网站收藏和导航平台。</p> 
<h3><a id="_6"></a>实现功能</h3> 
<h4><a id="CRUDhttpsimagesqiufeihongtopnAddwebm_8"></a><a href="https://images.qiufeihong.top/nAdd.webm" rel="nofollow">网站CRUD</a></h4> 
<h4><a id="httpsimagesqiufeihongtopnSearchwebm_10"></a><a href="https://images.qiufeihong.top/nSearch.webm" rel="nofollow">搜索</a></h4> 
<h4><a id="httpsimagesqiufeihongtopnLoginwebm_12"></a><a href="https://images.qiufeihong.top/nLogin.webm" rel="nofollow">登录登出</a></h4> 
<h3><a id="_14"></a>网站截图</h3> 
<h4><a id="_15"></a>网站导航块瀑布流</h4> 
<p><img src="https://images2.imgbox.com/3e/0c/lSxSUNjs_o.png" alt="网站导航块瀑布流"></p> 
<h4><a id="iframe_19"></a>网站嵌套iframe和搜索模块</h4> 
<p><img src="https://images2.imgbox.com/ed/8b/S3f2ObuH_o.png" alt="网站嵌套iframe"></p> 
<h4><a id="_23"></a>网站提交页</h4> 
<p><img src="https://images2.imgbox.com/7d/06/u8scRn3t_o.png" alt="网站提交"></p> 
<h3><a id="Demo_27"></a>在线Demo</h3> 
<p><a href="http://navigation.qiufeihong.top" rel="nofollow">预览</a></p> 
<h3><a id="_31"></a>简单的实现思路</h3> 
<p><img src="https://images2.imgbox.com/97/1b/Q59E1x38_o.png" alt="avatar"></p> 
<h3><a id="_35"></a>本地构建</h3> 
<pre><code class="prism language-bash"><span class="token operator">&lt;</span><span class="token operator">!</span>-- 下载项目 --<span class="token operator">&gt;</span>
<span class="token function">git</span> clone https://github.com/qiufeihong2018/navigation-server.git

<span class="token operator">&lt;</span><span class="token operator">!</span>-- 安装依赖 --<span class="token operator">&gt;</span>
<span class="token function">npm</span> <span class="token function">install</span>

<span class="token operator">&lt;</span><span class="token operator">!</span>-- 爬取数据 --<span class="token operator">&gt;</span>
node ./creeper/index.js

<span class="token operator">&lt;</span><span class="token operator">!</span>-- 启动程序 --<span class="token operator">&gt;</span>
<span class="token function">npm</span> run dev

</code></pre> 
<p>之后访问<code>http://localhost:1600</code>即可</p> 
<h3><a id="_53"></a>后端</h3> 
<p><a href="https://github.com/qiufeihong2018/navigation-server">navigation-server后端代码仓库</a></p> 
<p>基于express框架</p> 
<h4><a id="expresshttpsgithubcomexpressjsexpressweb_59"></a><a href="https://github.com/expressjs/express">express</a>搭建web应用</h4> 
<h5><a id="_61"></a>特征</h5> 
<ul><li>强大的路由</li><li>专注于高性能</li><li>超高的测试覆盖率</li><li>HTTP助手（重定向，缓存等）</li><li>查看支持14+模板引擎的系统</li><li>内容协商</li><li>可快速生成应用程序的可执行文件</li></ul> 
<h5><a id="_71"></a>解析</h5> 
<p>启动express服务</p> 
<pre><code class="prism language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../config'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// start server</span>
  <span class="token comment">// Set http port</span>
  app<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'port'</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>expressHttpPort<span class="token punctuation">)</span><span class="token punctuation">;</span> 

  app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>expressHttpPort<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 开启端口打印日志</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`express running on </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>config<span class="token punctuation">.</span>expressHttpPort<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> port`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>在config文件中动态配置端口</p> 
<p>里面的方法主要是去掉各种模式</p> 
<pre><code class="prism language-js"><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> config <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  development<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// mongodb</span>
    database<span class="token punctuation">:</span> <span class="token string">'mongodb://localhost/map'</span><span class="token punctuation">,</span>
    expressHttpPort<span class="token punctuation">:</span> <span class="token number">1600</span><span class="token punctuation">,</span>
    logFile<span class="token punctuation">:</span> <span class="token string">'./log/express.log'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  local<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// mongodb</span>
    database<span class="token punctuation">:</span> <span class="token string">'mongodb://127.0.0.1/map'</span><span class="token punctuation">,</span>
    expressHttpPort<span class="token punctuation">:</span> <span class="token number">1600</span><span class="token punctuation">,</span>
    logFile<span class="token punctuation">:</span> <span class="token string">'./log/express.log'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  production<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// mongodb</span>
    database<span class="token punctuation">:</span> <span class="token string">'mongodb://127.0.0.1/map'</span><span class="token punctuation">,</span>
    expressHttpPort<span class="token punctuation">:</span> <span class="token number">1600</span><span class="token punctuation">,</span>
    logFile<span class="token punctuation">:</span> <span class="token string">'./log/express.log'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>mode<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">var</span> env<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>mode<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    env <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">||</span> <span class="token string">'development'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>mode <span class="token operator">===</span> <span class="token string">'development'</span> <span class="token operator">||</span> <span class="token string">'local'</span> <span class="token operator">||</span> <span class="token string">'production'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    env <span class="token operator">=</span> mode<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`config can only be 'development' || 'local' || 'production', 
    but you give </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>mode<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> returnVal <span class="token operator">=</span> config<span class="token punctuation">[</span>env<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> returnVal<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="expresssessionhttpsgithubcomexpressjssessionexpresssession_131"></a><a href="https://github.com/expressjs/session">express-session</a>之express简单的session中间件</h4> 
<h5><a id="_133"></a>特征</h5> 
<ul><li><strong><code>resave</code></strong>：即使在请求期间会话从未被修改，也会强制将会话保存回会话存储区。取决于你的store这可能是必要的,但它也可以创建竞态条件,客户让两个并行请求您的服务器,在一个请求中更改会话可能会覆盖另一个请求结束时,即使它没有改变。默认值为true。</li><li><strong><code>saveUninitialized</code></strong>：强制将“未初始化”的会话保存到存储区。当会话是新的但没有修改时，它是未初始化的。选择false对于实现登录会话、减少服务器存储使用或遵守在设置cookie之前需要获得许可的法律非常有用。选择false还可以帮助解决客户端在没有会话的情况下发出多个并行请求的竞态条件。默认值为true，但是不建议使用默认值，因为默认值将在将来更改。</li><li><strong><code>secret</code></strong>:这是用于对会话<code>ID cookie</code>签名的密码。这可以是单个秘密的字符串，也可以是多个秘密的数组。如果提供了一个秘密数组，则只使用第一个元素对会话<code>ID cookie</code>进行签名，而在验证请求中的签名时将考虑所有元素。</li><li><strong><code>cookie</code></strong>：每个会话都有一个惟一的cookie对象。这允许您更改每个访问者的会话cookie。 
  <ul><li><strong><code>maxAge</code></strong>：maxAge将返回剩余的时间(以毫秒为单位)，小编们还可以重新分配一个新值来适当调整<code>.expires</code>属性。此时表示1天后过期。</li></ul> </li></ul> 
<h5><a id="_140"></a>解析</h5> 
<pre><code class="prism language-js"><span class="token keyword">const</span> session <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-session'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


  <span class="token comment">// Session configuration</span>
  <span class="token keyword">const</span> sess <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    resave<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    saveUninitialized<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    secret<span class="token punctuation">:</span> <span class="token string">'I am hungry'</span><span class="token punctuation">,</span>
    cookie<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      maxAge<span class="token punctuation">:</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>


  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span>sess<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Set session middleware</span>

</code></pre> 
<p>想知道更多的配置，请见小编之前翻译的<a href="https://www.qiufeihong.top/technical-summary/express/#express-session" rel="nofollow">express-session</a></p> 
<h4><a id="bodyparserhttpsgithubcomexpressjsbodyparser_162"></a><a href="https://github.com/expressjs/body-parser">body-parser</a>正文解析</h4> 
<h5><a id="_163"></a>特征</h5> 
<ul><li>是一个Node.js正文解析中间件。</li></ul> 
<h5><a id="_165"></a>解析</h5> 
<p>在处理程序之前，利用中间件解析传入的请求主体，在<code>req.body</code>属性下可用。</p> 
<p>注意由于<code>req.body</code>形状基于用户控制的输入，因此该对象中的所有属性和值都是不可信的，应在信任之前进行验证。例如，<code>req.body.foo.toString()</code>可能以多种方式失败，例如foo属性可能不存在或者可能不是字符串，并且<code>toString</code>可能不是函数，而是字符串或其他用户输入。</p> 
<ul><li><strong><code>urlenencoded</code></strong>: ([options])返回中间件，该中间件只解析<code>urlencoded body</code>，并且只查看内容类型头部与类型选项匹配的请求。该解析器只接受正文的UTF-8编码，并支持gzip和deflate编码的自动膨胀。在中间件(即req.body)之后，在请求对象上填充一个包含已解析数据的新body对象。这个对象将包含键值对，其中的值可以是字符串或数组(当扩展为false时)，也可以是任何类型(当扩展为true时)。 
  <ul><li><strong><code>extended</code></strong>: 选项允许在使用<code>querystring</code>库解析url编码的数据(当为false时)和使用qs库(当为true时)之间进行选择。<code>extended</code>语法允许将丰富的对象和数组编码为url编码格式，允许使用类似json的url编码体验。</li></ul> </li></ul> 
<pre><code class="prism language-js"><span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

……

  <span class="token comment">// parse application/x-www-form-urlencoded</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    extended<span class="token punctuation">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// parse application/json</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


</code></pre> 
<h4><a id="mongoosehttpsgithubcomAutomatticmongoose_190"></a><a href="https://github.com/Automattic/mongoose">mongoose</a>连接数据库</h4> 
<p>Mongoose是一个MongoDB对象建模工具，旨在在异步环境中工作。</p> 
<h5><a id="_192"></a>特征</h5> 
<ul><li>堆栈溢出</li><li>bug报告</li><li>mongoose Slack Channel</li><li>帮助论坛</li><li>MongoDB支持</li></ul> 
<h5><a id="_200"></a>解析</h5> 
<p>连接数据库，处理连接的成功和失败的信息。</p> 
<pre><code class="prism language-js"><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../config'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [koa警告DeprecationWarning: Mongoose: `findOneAndUpdate()` and `findOneAndDelete()` without the `use...](https://www.jianshu.com/p/f3128e7ae3c5)</span>
mongoose<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'useFindAndModify'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> reconnectTimes <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// Mongodb reconnect times</span>
<span class="token keyword">let</span> reconnectInterval <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">;</span><span class="token comment">// The interval seconecd time between two reconnection;</span>
<span class="token keyword">const</span> maxReconnectInterval <span class="token operator">=</span> <span class="token number">120</span><span class="token punctuation">;</span><span class="token comment">// The max interval time between two reconnection;</span>

<span class="token comment">// Connect to mongodb</span>
<span class="token keyword">function</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    socketTimeoutMS<span class="token punctuation">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>
    keepAlive<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    reconnectTries<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    useNewUrlParser<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>database<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Mongoose error handler</span>
mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Mongoose reconnect when closed</span>
mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'disconnected'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  reconnectTimes<span class="token operator">++</span><span class="token punctuation">;</span>
  reconnectInterval <span class="token operator">=</span> reconnectInterval <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>reconnectInterval <span class="token operator">&gt;</span> maxReconnectInterval<span class="token punctuation">)</span> reconnectInterval <span class="token operator">=</span> maxReconnectInterval<span class="token punctuation">;</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> reconnectInterval <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connected'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  reconnectTimes <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  reconnectInterval <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span>connect <span class="token operator">=</span> connect<span class="token punctuation">;</span>

</code></pre> 
<p>创建数据库集合<code>AdminMap</code></p> 
<pre><code class="prism language-js"><span class="token string">'use strict'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Schema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">;</span>

<span class="token keyword">const</span> AdminMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  category<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> trim<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  name<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> trim<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  website<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> trim<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  describe<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> trim<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  logo<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> trim<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  way<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> type<span class="token punctuation">:</span> String<span class="token punctuation">,</span> trim<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
  timestamps<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> createdAt<span class="token punctuation">:</span> <span class="token string">'created_at'</span><span class="token punctuation">,</span> updatedAt<span class="token punctuation">:</span> <span class="token string">'updated_at'</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


module<span class="token punctuation">.</span>exports <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'AdminMap'</span><span class="token punctuation">,</span> AdminMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="eslinthttpsgithubcomeslinteslint_270"></a><a href="https://github.com/eslint/eslint">eslint</a>规范代码</h4> 
<h5><a id="_271"></a>特征</h5> 
<ul><li> <p>ESLint是一种用于识别和报告ECMAScript / JavaScript代码中的模式的工具。在许多方面，它类似于JSLint和JSHint，但有一些例外：</p> </li><li> <p>ESLint使用Espree进行JavaScript解析。</p> </li><li> <p>ESLint使用AST来评估代码中的模式。</p> </li><li> <p>ESLint是完全可插拔的，每个规则都是一个插件，可以在运行时添加更多。</p> </li></ul> 
<p>想知道更多的配置，请见小编之前翻译的<a href="https://www.qiufeihong.top/technical-summary/eslint/" rel="nofollow">《eslint在express中的配置》</a></p> 
<h4><a id="cheerio_282"></a>cheerio爬取数据</h4> 
<h5><a id="cheeriohttpsgithubcomcheeriojscheerio_284"></a><a href="https://github.com/cheeriojs/cheerio">cheerio</a>爬虫</h5> 
<p>快速，灵活和精简的核心jQuery实现，专为服务器而设计。</p> 
<h5><a id="requesthttpsgithubcomrequestrequest_287"></a><a href="https://github.com/request/request">request</a></h5> 
<p>简单的http请求客户端</p> 
<p>详细用法请见小编之前的文章<a href="https://www.qiufeihong.top/technical-summary/node-reptile/" rel="nofollow">《node爬取某图片网站的桌面壁纸》</a></p> 
<h4><a id="pm2_293"></a>pm2守护项目</h4> 
<pre><code class="prism language-js"><span class="token string">"pm2"</span><span class="token punctuation">:</span> <span class="token string">"pm2 start index.js --name='navigation'"</span>
</code></pre> 
<p>详细介绍请见小编之前的文章<a href="https://www.qiufeihong.top/technical-summary/pm2/#pm2-command-not-found" rel="nofollow">《pm2》</a></p> 
<h4><a id="mocha_300"></a>mocha测试</h4> 
<h5><a id="mochahttpsgithubcommochajsmocha_302"></a><a href="https://github.com/mochajs/mocha">mocha</a></h5> 
<p>node.js和浏览器的简单，灵活，有趣的javascript测试框架</p> 
<h5><a id="mochawesomehttpsgithubcomadamgrubermochawesome_305"></a><a href="https://github.com/adamgruber/mochawesome">mochawesome</a></h5> 
<p>Mochawesome是一个用于Javascript测试框架mocha的自定义报告器。它在Node.js上运行，并与mochawesome-report-generator结合使用，生成独立的HTML / CSS报告，以帮助可视化您的测试运行。</p> 
<h5><a id="shouldhttpsgithubcomshouldjsshouldjs_308"></a><a href="https://github.com/shouldjs/should.js">should</a></h5> 
<p>node.js的BDD样式断言</p> 
<p>是一个富有表现力，可读，与框架无关的断言库。这个图书馆的主要目标是表达和帮助。它可以使您的测试代码保持干净，并且您的错误消息很有用</p> 
<h5><a id="supertesthttpsgithubcomvisionmediasupertest_312"></a><a href="https://github.com/visionmedia/supertest">supertest</a></h5> 
<p>用于使用流畅的API测试node.js HTTP服务器。</p> 
<p>详细介绍请见小编之前的文章<a href="https://www.qiufeihong.top/technical-summary/mocha/" rel="nofollow">《express项目集成mocha测试框架》</a></p> 
<h4><a id="passport_317"></a>passport用户名和密码验证</h4> 
<p>这三者有这密切的联系，前两者都可以归<code>passport-local-mongoose</code>管理，主要解析就放在<code>passport-local-mongoose</code>这个依赖包中</p> 
<h5><a id="passporthttpsgithubcomjaredhansonpassport_319"></a><a href="https://github.com/jaredhanson/passport">passport</a></h5> 
<h6><a id="_321"></a>特征</h6> 
<p>Passport是Node.js的Express兼容认证中间件。</p> 
<p>Passport的唯一目的是验证请求，它通过一组称为策略的可扩展插件来完成。Passport不会挂载路由或假设任何特定的数据库架构，这可以最大限度地提高灵活性，并允许开发人员做出应用程序级别的决策。Passport提供了用于控制身份验证成功或失败时的钩子。</p> 
<ul><li> <p><strong><code>session</code></strong>：Passport将维护持久的登录会话。为了使持久会话工作，必须将经过身份验证的用户序列化到会话，并在发出后续请求时反序列化。Passport对用户记录的存储方式没有任何限制。相反，您为Passport提供了一些函数，这些函数实现了必要的序列化和反序列化逻辑。在典型的应用程序中，这与序列化用户ID以及反序列化时按ID查找用户一样简单。</p> </li><li> <p><strong><code>initialize</code></strong>：要在基于Express或连接的应用程序中使用Passport，请使用所需的<code>passport.initialize()</code>中间件对其进行配置。如果您的应用程序使用持久性登录会话(推荐使用，但不是必需的)，还必须使用<code>passport.session()</code>中间件。</p> </li></ul> 
<h5><a id="passportlocalhttpsgithubcomjaredhansonpassportlocal_331"></a><a href="https://github.com/jaredhanson/passport-local">passport-local</a></h5> 
<h6><a id="_333"></a>特征</h6> 
<p>用于使用用户名和密码进行身份验证的Passport策略。</p> 
<p>此模块允许您使用Node.js应用程序中的用户名和密码进行身份验证。通过插入Passport，可以轻松且不显眼地将本地身份验证集成到支持Connect风格中间件（包括 Express）的任何应用程序或框架中 。</p> 
<p>做验证之前，首先需要对策略进行配置</p> 
<pre><code class="prism language-js">passport<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LocalStrategy</span><span class="token punctuation">(</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> done<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    User<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> username<span class="token punctuation">:</span> username <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> user<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> <span class="token function">done</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> <span class="token function">done</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">.</span><span class="token function">verifyPassword</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> <span class="token function">done</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token function">done</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="passportlocalmongoosehttpsgithubcomsaintedlamapassportlocalmongoose_354"></a><a href="https://github.com/saintedlama/passport-local-mongoose">passport-local-mongoose</a></h5> 
<h5><a id="_356"></a>特征</h5> 
<p><code>passport-local-mongoose</code>是一个Mongoose插件，它简化了使用Passport构建用户名和密码的权限</p> 
<h6><a id="_359"></a>解析</h6> 
<ol><li>首先需要将依赖包导入schema中。</li></ol> 
<pre><code class="prism language-js"><span class="token keyword">const</span> passportLocalMongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'passport-local-mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  interval<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  maxInterval<span class="token punctuation">:</span> <span class="token number">6</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">,</span>
  maxAttempts<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
  limitAttempts<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
User<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span>passportLocalMongoose<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="2"><li>配置Passport和Passport-Local</li></ol> 
<p>可以简化两者的配置</p> 
<p><code>passport-local-mongoose</code>可以通过设置<code>LocalStrategy</code>、<code>serializeUser</code>和<code>deserializeUser</code>来配置来这两者</p> 
<p>具体参数解析见<a href="https://www.qiufeihong.top/technical-summary/mongo/#mongoose%E4%B9%8Bpassport-local-mongoose" rel="nofollow">《mongoose之passport-local-mongoose》</a></p> 
<pre><code class="prism language-js">  <span class="token comment">// requires the model with Passport-Local Mongoose plugged in</span>
  <span class="token keyword">var</span> User <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../collections/user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>passport<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>passport<span class="token punctuation">.</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// use static authenticate method of model in LocalStrategy</span>
  passport<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LocalStrategy</span><span class="token punctuation">(</span>User<span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// use static serialize and deserialize of model for passport session support</span>
  passport<span class="token punctuation">.</span><span class="token function">serializeUser</span><span class="token punctuation">(</span>User<span class="token punctuation">.</span><span class="token function">serializeUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  passport<span class="token punctuation">.</span><span class="token function">deserializeUser</span><span class="token punctuation">(</span>User<span class="token punctuation">.</span><span class="token function">deserializeUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="winston_391"></a>winston记录日志</h4> 
<h5><a id="winstonhttpsgithubcomwinstonjswinston_393"></a><a href="https://github.com/winstonjs/winston">winston</a>记录日志</h5> 
<ul><li>winston被设计为一个简单和通用的日志记录库，支持多个传输。传输本质上是日志的存储设备。每个winston记录器可以具有在不同级别配置的多个传输。例如，可能希望将错误日志存储在持久远程位置（如数据库）中，但所有日志都输出到控制台或本地文件。</li><li>winston旨在将部分日志记录过程分离，使其更加灵活和可扩展。注意支持日志格式和级别的灵活性，并确保这些API与传输日志记录的实现分离</li></ul> 
<p>想知道更多的配置，请见小编之前翻译的<a href="https://www.qiufeihong.top/technical-summary/express/#winston" rel="nofollow">《winston》</a></p> 
<h5><a id="winstondailyrotatefilehttpsgithubcomwinstonjswinstondailyrotatefile_399"></a><a href="https://github.com/winstonjs/winston-daily-rotate-file">winston-daily-rotate-file</a></h5> 
<p>winston的传输，记录到旋转文件。可以根据日期，大小限制轮换日志，并且可以根据计数或经过的天数删除旧日志。</p> 
<p>想知道更多的配置，请见小编之前翻译的<a href="https://www.qiufeihong.top/technical-summary/express/#winston-daily-rotate-file" rel="nofollow">《winston-daily-rotate-file》</a></p> 
<p>封装winston日志，当在开发模式时，产生的日志存在<code>express.log</code>中，并且日志级别为<code>debug</code>;当在生产模式时，存在时间戳日志中，日志级别是<code>info</code>,可以存7天的文件,最大文件不得超过20兆；其他模式日志级别也是<code>info</code></p> 
<pre><code class="prism language-js"><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Logger is to custom winston to provide different log pattern in 'development',
 * 'production' and other mode.
 * 'development' will use Console and File output with 'debug' level
 * 'production' will use DailyRotateFile output with 'info' level,
 *  and the maxFiles is 7d.
 *  other mode will use File output with 'info' level.
 */</span>
<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>
  createLogger<span class="token punctuation">,</span>
  format<span class="token punctuation">,</span>
  transports
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'winston'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>
  combine<span class="token punctuation">,</span>
  timestamp<span class="token punctuation">,</span>
  label<span class="token punctuation">,</span>
  printf
<span class="token punctuation">}</span> <span class="token operator">=</span> format<span class="token punctuation">;</span>

<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'winston-daily-rotate-file'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../config'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">MODE</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../constant/system'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token constant">MODE</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> mode <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>mode<span class="token punctuation">)</span> mode <span class="token operator">=</span> <span class="token constant">MODE</span><span class="token punctuation">.</span><span class="token constant">DEVE</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> logFile <span class="token operator">=</span> config<span class="token punctuation">.</span>logFile<span class="token punctuation">;</span>

logFile <span class="token operator">=</span> logFile<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'.log'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// remove '.log' from the logFile</span>

<span class="token keyword">const</span> trans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ts <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">transports<span class="token punctuation">.</span>Console</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    level<span class="token punctuation">:</span> <span class="token string">'debug'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  file<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">transports<span class="token punctuation">.</span>File</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    filename<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>logFile<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.log`</span></span><span class="token punctuation">,</span>
    level<span class="token punctuation">:</span> <span class="token string">'info'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// daily rotate file transport config</span>
<span class="token keyword">const</span> dailyRotateFileTrans <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">(</span>transports<span class="token punctuation">.</span>DailyRotateFile<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  filename<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>logFile<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-%DATE%.log`</span></span><span class="token punctuation">,</span>
  datePattern<span class="token punctuation">:</span> <span class="token string">'YYYY-MM-DD-HH'</span><span class="token punctuation">,</span>
  zippedArchive<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  maxSize<span class="token punctuation">:</span> <span class="token string">'20m'</span><span class="token punctuation">,</span>
  maxFiles<span class="token punctuation">:</span> <span class="token string">'7d'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Dynamically change the log level of the transfer</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">===</span> <span class="token constant">MODE</span><span class="token punctuation">.</span><span class="token constant">DEVE</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  trans<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>ts<span class="token punctuation">.</span>console<span class="token punctuation">)</span><span class="token punctuation">;</span>
  ts<span class="token punctuation">.</span>file<span class="token punctuation">.</span>level <span class="token operator">=</span> <span class="token string">'debug'</span><span class="token punctuation">;</span>
  trans<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>ts<span class="token punctuation">.</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">===</span> <span class="token constant">MODE</span><span class="token punctuation">.</span><span class="token constant">PROD</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  trans<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>dailyRotateFileTrans<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
  trans<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>ts<span class="token punctuation">.</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">createLogger</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> myFormat <span class="token operator">=</span> <span class="token function">combine</span><span class="token punctuation">(</span>
    <span class="token function">label</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      label<span class="token punctuation">:</span> source
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">timestamp</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      format<span class="token punctuation">:</span> <span class="token string">'YYYY-MM-DD HH:mm:ss'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      level<span class="token punctuation">,</span>
      message<span class="token punctuation">,</span>
      label<span class="token punctuation">,</span>
      timestamp
    <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>timestamp<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> [</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>label<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">][</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>level<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token punctuation">(</span>createLogger<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    format<span class="token punctuation">:</span> myFormat<span class="token punctuation">,</span>
    transports<span class="token punctuation">:</span> trans
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> 
<h4><a id="CRUD_492"></a>CRUD</h4> 
<p>增删改查的业务逻辑没什么好讲的，代码在仓库里</p> 
<p>就是注意一点：</p> 
<p>小编这里是get请求要做的是去想数据库请求某个类别的网站的某页的数据，<code>limit</code>等关键词小编是从<code>req._parsedOriginalUrl.query</code>中分割的。</p> 
<p>要获取总长度，所以此处查找了两次。</p> 
<pre><code class="prism language-js">router<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> req<span class="token punctuation">.</span>_parsedOriginalUrl<span class="token punctuation">.</span>query<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> limit <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> offset <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> cate <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  SuperAdminMap<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> category<span class="token punctuation">:</span> cate <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    total <span class="token operator">=</span> data<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    SuperAdminMap<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> category<span class="token punctuation">:</span> cate <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span>limit<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Get </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>cate<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> data`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        data<span class="token punctuation">,</span>
        total
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="apidoc_523"></a>apidoc文档神器</h4> 
<p>为了方便查看api，所以用上apidoc是绝对要的</p> 
<p>想知道更多的配置，请见小编之前翻译的<a href="https://www.qiufeihong.top/technical-summary/apiDoc/" rel="nofollow">《apiDoc生成接口文档,不费吹灰之力》</a></p> 
<p>此处是后端查找superAdmin数据库的get请求的注释</p> 
<pre><code class="prism language-js">
<span class="token comment">/**
 * @api {get} /superAdmin/ SuperAdmin getMap
 * @apiName SuperAdminGet
 * @apiGroup superAdminOperation
 *
 * @apiParam {String} limit  Number of pages per page.
 * @apiParam {String} offset  Number of skips.
 * @apiParam {String} category  New website's category.
 *
 *
 * @apiSuccessExample Success-Response:
 *     HTTP/1.1 200 OK
 *{
 *    "data": [
 *        {
 *            "_id": "5d5e4206443bdd63d0f82327",
 *            "category": "recommendationFront-end",
 *            "name": "test1",
 *            "website": "test4",
 *            "describe": "test",
 *            "logo": "test",
 *            "created_at": "2019-08-22T07:19:34.924Z",
 *            "updated_at": "2019-08-22T07:19:34.924Z",
 *            "__v": 0
 *        },
 *        {
 *            "_id": "5d5e4209443bdd63d0f82328",
 *            "category": "recommendationFront-end",
 *            "name": "test1",
 *            "website": "test5",
 *            "describe": "test",
 *            "logo": "test",
 *            "created_at": "2019-08-22T07:19:37.430Z",
 *            "updated_at": "2019-08-22T07:19:37.430Z",
 *            "__v": 0
 *        }
 *    ],
 *    "total": 655
 *}
 * @apiError NOT_LOGIN The current User was not logon.
 *
 * @apiErrorExample Error-Response:
 *     HTTP/1.1 401 Unauthorized
 *     {
 *       "err": "NOT_LOGIN",
 *       "message": "User has not logon in!"
 *     }
 */</span>
</code></pre> 
<p>执行<code>npm run apidoc</code>命令后生成api文档</p> 
<p><img src="https://images2.imgbox.com/c4/4f/5oSkFfIT_o.png" alt="avatar"></p> 
<h3><a id="_585"></a>前端</h3> 
<p><a href="https://github.com/qiufeihong2018/navigation-web">navigation-web前端代码仓库</a></p> 
<p>是基于花裤衩的<a href="https://github.com/PanJiaChen/vue-admin-template">vue-admin-template</a>的简单版的后台管理模板，这一款基于vue2.0的后台管理平台深受大众喜爱。</p> 
<h4><a id="Vuexhttpsgithubcomvuejsvuex_591"></a><a href="https://github.com/vuejs/vuex">Vuex</a>存储状态</h4> 
<h5><a id="_593"></a>特征</h5> 
<p>Vuex是一个专为Vue.js应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化.</p> 
<h5><a id="_597"></a>解析</h5> 
<p>自动从modules文件夹中导入文件</p> 
<p>推荐一本老姚的正则手册<a href="https://images.qiufeihong.top/JavaScript%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BF%B7%E4%BD%A0%E4%B9%A6%EF%BC%881.1%E7%89%88%EF%BC%89.pdf" rel="nofollow">《JavaScript正则表达式迷你书（1.1版）.pdf》</a></p> 
<ul><li> <p>^(脱字符)匹配开头，在多行匹配中匹配行开头。</p> </li><li> <p>$(美元符号)匹配结尾,在多行匹配中匹配行结尾。</p> </li><li> <p>^、$、.、*、+、?、|、\、/、(、)、[、]、{、}、=、!、:、- ,</p> </li></ul> 
<p>当匹配上面的字符本身时，可以一律转义：</p> 
<ul><li>\w 表示 [0-9a-zA-Z_]。表示数字、大小写字母和下划线。</li></ul> 
<p>记忆方式：w 是 word 的简写，也称单词字符。</p> 
<ul><li>+等价于 {1,}，表示出现至少一次。</li></ul> 
<p>记忆方式：加号是追加的意思，得先有一个，然后才考虑追加。</p> 
<ul><li><a href="https://webpack.js.org/guides/dependency-management/" rel="nofollow">require.context</a></li></ul> 
<p>根据正则（在modules文件夹中找到结尾是js的文件）匹配所有的文件</p> 
<ul><li>replace一个新的字符串</li></ul> 
<pre><code class="prism language-js">
<span class="token comment">// https://webpack.js.org/guides/dependency-management/#requirecontext</span>
<span class="token keyword">const</span> modulesFiles <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'./modules'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex">/\.js$/</span><span class="token punctuation">)</span>

<span class="token comment">// you do not need `import app from './modules/app'`</span>
<span class="token comment">// it will auto require all vuex module from modules file</span>
<span class="token keyword">const</span> modules <span class="token operator">=</span> modulesFiles<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>modules<span class="token punctuation">,</span> modulePath<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// set './app.js' =&gt; 'app'</span>
  <span class="token keyword">const</span> moduleName <span class="token operator">=</span> modulePath<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/^\.\/(.*)\.\w+$/</span><span class="token punctuation">,</span> <span class="token string">'$1'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token function">modulesFiles</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">)</span>
  modules<span class="token punctuation">[</span>moduleName<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token keyword">default</span>
  <span class="token keyword">return</span> modules
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  modules<span class="token punctuation">,</span>
  getters
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="axioshttpsgithubcomaxiosaxios_647"></a><a href="https://github.com/axios/axios">axios</a>进行前后端数据通信</h4> 
<h5><a id="_649"></a>特征</h5> 
<p>支持http数据通信。Axios 是一个基于 promise 的 HTTP 库，可以用在浏览器和 node.js 中。</p> 
<p>尤大推荐用Axios，让Axios进入了很多人的目光中。Axios本质上也是对原生XHR的封装，只不过它是Promise的实现版本，符合最新的ES规范。</p> 
<ul><li> <p>客户端支持防止CSRF，每个请求都带一个从cookie中拿到的key, 根据浏览器同源策略，假冒的网站是拿不到cookie中的key，这样，后台就可以轻松辨别出这个请求是否是用户在假冒网站上的误导输入，从而采取正确的策略。</p> </li><li> <p>登录完成后，将用户的token通过cookie存在本地，然后在页面跳转前拦截读取token，如果token存在则说明已经登录过，刷新vuex中的token状态。每次发送请求时都会携带token。后端会通过携带的token判断是否登录或过期。</p> </li></ul> 
<h5><a id="_659"></a>解析</h5> 
<p>在其封装Axios对象的request文件中，response响应中去掉了自定义状态码的设置。</p> 
<pre><code class="prism language-js"><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>
  Message
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'element-ui'</span>
<span class="token comment">// production</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'@/store'</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>
  getToken
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/utils/auth'</span>

<span class="token comment">// create an axios instance</span>
<span class="token keyword">const</span> service <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  baseURL<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_BASE_API</span><span class="token punctuation">,</span> <span class="token comment">// url = base url + request url</span>
  <span class="token comment">// withCredentials: true, // send cookies when cross-domain requests</span>
  timeout<span class="token punctuation">:</span> <span class="token number">5000</span> <span class="token comment">// request timeout</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// request interceptor</span>
service<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  config <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span> <span class="token operator">&amp;&amp;</span> store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// do something before request is sent</span>
      <span class="token comment">// let each request carry token</span>
      <span class="token comment">// ['X-Token'] is a custom headers key</span>
      <span class="token comment">// please modify it according to the actual situation</span>
      config<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'X-Token'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> config
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  error <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// do something with request error</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token comment">// for debug</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment">// response interceptor</span>
service<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token comment">/**
   * If you want to get http information such as headers or status
   * Please return  response =&gt; response
   */</span>

  <span class="token comment">/**
   * Determine the request status by custom code
   * Here is just an example
   * You can also judge the status by HTTP Status Code
   */</span>
  response <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> response<span class="token punctuation">.</span>data
    <span class="token keyword">return</span> res
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  error <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'err'</span> <span class="token operator">+</span> error<span class="token punctuation">)</span> <span class="token comment">// for debug</span>
    <span class="token function">Message</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      message<span class="token punctuation">:</span> error<span class="token punctuation">.</span>message<span class="token punctuation">,</span>
      type<span class="token punctuation">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>
      duration<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">1000</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> service


</code></pre> 
<h4><a id="elementuihttpsgithubcomElemeFEelement_731"></a><a href="https://github.com/ElemeFE/element">element-ui</a>快速搭建后台</h4> 
<h5><a id="_732"></a>特征</h5> 
<p>饿了吗的web平台UI库</p> 
<p>Element，一套为开发者、设计师和产品经理准备的基于 Vue 2.0 的桌面端组件库</p> 
<h5><a id="_737"></a>解析</h5> 
<p>在main.js中全局导入element-ui</p> 
<pre><code class="prism language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> ElementUI <span class="token keyword">from</span> <span class="token string">'element-ui'</span>
<span class="token keyword">import</span> <span class="token string">'element-ui/lib/theme-chalk/index.css'</span>
<span class="token comment">// import enLocale from 'element-ui/lib/locale/lang/en'</span>
<span class="token keyword">import</span> zhLocale <span class="token keyword">from</span> <span class="token string">'element-ui/lib/locale/lang/zh-CN'</span>
<span class="token comment">// set ElementUI lang to EN</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementUI<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
  zhLocale
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="elbreadcrumb__752"></a>el-breadcrumb 面包屑</h5> 
<h6><a id="_753"></a>特征</h6> 
<p>显示当前页面的路径，快速返回之前的任意页面。</p> 
<h5><a id="_757"></a>解析</h5> 
<pre><code class="prism language-html">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-breadcrumb</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>app-breadcrumb<span class="token punctuation">"</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>&gt;<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition-group</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>breadcrumb<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-breadcrumb-item</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(item,index) in levelList<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item.path<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item.redirect===<span class="token punctuation">'</span>noRedirect<span class="token punctuation">'</span>||index==levelList.length-1<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no-redirect<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{ item.meta.title }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">v-else</span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleLink(item)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{ item.meta.title }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-breadcrumb-item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition-group</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-breadcrumb</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="eldrawer_769"></a>el-drawer抽屉组件弹出搜索信息</h5> 
<h6><a id="_770"></a>解析</h6> 
<p>搜索栏通过改变vuex中的<code>openDrawer</code>状态来控制底层抽屉组件。在弹出的抽屉中可以通过关键词搜索mongo数据库中的导航网站的title和描述，点击iframe和外链查看收藏的网站。</p> 
<pre><code class="prism language-html">   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-drawer</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>搜索网站<span class="token punctuation">"</span></span> <span class="token attr-name">:visible.sync</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>openDrawer<span class="token punctuation">"</span></span> <span class="token attr-name">:before-close</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>closeDrawer<span class="token punctuation">"</span></span> <span class="token attr-name">direction</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btt<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50%<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>search-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>prepend<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>queryData.query<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>请输入，例如：ppt<span class="token punctuation">"</span></span> <span class="token attr-name">@keyup.enter.native</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>getSuperSearch<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>append<span class="token punctuation">"</span></span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>el-icon-search<span class="token punctuation">"</span></span> <span class="token attr-name">@click.stop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>getSuperSearch<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table</span> <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tableData<span class="token punctuation">"</span></span> <span class="token attr-name">stripe</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> 100%</span><span class="token punctuation">"</span></span> <span class="token attr-name">highlight-current-row</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>名字<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">show-overflow-tooltip</span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>website<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>网站链接<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">show-overflow-tooltip</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>slot<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>font-website<span class="token punctuation">"</span></span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{ path: <span class="token punctuation">'</span>iframeNav<span class="token punctuation">'</span>, query: { website: slot.row.website }}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
              {<!-- -->{ slot.row.website }}
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>describe<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>描述<span class="token punctuation">"</span></span> <span class="token attr-name">show-overflow-tooltip</span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>created_at<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>创建时间<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">show-overflow-tooltip</span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">prop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>category<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>分类<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">show-overflow-tooltip</span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span> <span class="token attr-name">fixed</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>操作<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scope<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>font-website<span class="token punctuation">"</span></span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{ path: <span class="token punctuation">'</span>iframeNav<span class="token punctuation">'</span>, query: { website: scope.row.website }}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
              iframe链接
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>font-website<span class="token punctuation">"</span></span> <span class="token attr-name">:href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scope.row.website<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>新窗口链接<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pagination-container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-pagination</span> <span class="token attr-name">small</span> <span class="token attr-name">background</span> <span class="token attr-name">layout</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>prev, pager, next<span class="token punctuation">"</span></span> <span class="token attr-name">:total</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>total<span class="token punctuation">"</span></span> <span class="token attr-name">:page-size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">@current-change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleCurrentChange<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-drawer</span><span class="token punctuation">&gt;</span></span>

</code></pre> 
<h4><a id="jscookiehttpsgithubcomjscookiejscookiecookie_808"></a><a href="https://github.com/js-cookie/js-cookie">js-cookie</a>处理浏览器cookie</h4> 
<h5><a id="_809"></a>特征</h5> 
<p>一个简单，轻量级的JavaScript API，用于处理浏览器cookie</p> 
<ul><li>适用于所有浏览器</li><li>接受任何角色</li><li>经过严格测试</li><li>没有依赖</li><li>不显眼的 JSON支持</li><li>支持AMD / CommonJS</li><li>符合RFC 6265</li><li>启用自定义编码/解码</li></ul> 
<p>对cookie进行CRUD</p> 
<pre><code class="prism language-js"><span class="token keyword">import</span> Cookies <span class="token keyword">from</span> <span class="token string">'js-cookie'</span>

<span class="token keyword">const</span> TokenKey <span class="token operator">=</span> <span class="token string">'navigation_token'</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> Cookies<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>TokenKey<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">setToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> Cookies<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>TokenKey<span class="token punctuation">,</span> token<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">removeToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> Cookies<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>TokenKey<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/de/6c/XTvT7ecc_o.png" alt="avatar"></p> 
<h4><a id="normalizecsshttpsgithubcomnecolasnormalizecss_843"></a><a href="https://github.com/necolas/normalize.css">normalize.css</a></h4> 
<h5><a id="_844"></a>特征</h5> 
<p>在默认的HTML元素样式上提供了跨浏览器的高度一致性。相比于传统的css reset，Normalize.css是一种现代的，为HTML5准备的优质替代方案。</p> 
<ul><li>与许多CSS重置不同，保留有用的默认值，而不是删除他们。</li><li>规范化各种元素的样式。</li><li>更正了错误和常见的浏览器不一致性。</li><li>通过微妙的修改提高可用性。</li><li>使用详细注释说明代码的作用。</li></ul> 
<p>推荐阅读<a href="https://www.zhihu.com/question/20094066" rel="nofollow">Normalize.css 与传统的 CSS Reset 有哪些区别？</a></p> 
<h4><a id="nprogresshttpsgithubcomrstacruznprogress_855"></a><a href="https://github.com/rstacruz/nprogress">nprogress</a>进度条</h4> 
<h5><a id="_856"></a>特征</h5> 
<p>超薄进度条</p> 
<h5><a id="_858"></a>解析</h5> 
<p>通过调用start()和done()来控制进度条。</p> 
<p>用在permission页面跳转时候</p> 
<pre><code class="prism language-js"><span class="token keyword">import</span> NProgress <span class="token keyword">from</span> <span class="token string">'nprogress'</span> <span class="token comment">// progress bar</span>
<span class="token keyword">import</span> <span class="token string">'nprogress/nprogress.css'</span> <span class="token comment">// progress bar style</span>
NProgress<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  showSpinner<span class="token punctuation">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// NProgress Configuration</span>

NProgress<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

NProgress<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>还可以调整速度</p> 
<pre><code class="prism language-js">NProgress<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> easing<span class="token punctuation">:</span> <span class="token string">'ease'</span><span class="token punctuation">,</span> speed<span class="token punctuation">:</span> <span class="token number">500</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>关闭加载微调器。（默认值：true）</p> 
<pre><code class="prism language-js">NProgress<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  showSpinner<span class="token punctuation">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// NProgress Configuration</span>
</code></pre> 
<p>更改其父容器</p> 
<pre><code class="prism language-js">NProgress<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> parent<span class="token punctuation">:</span> <span class="token string">'#container'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="pathtoregexphttpsgithubcompillarjspathtoregexp_url__894"></a><a href="https://github.com/pillarjs/path-to-regexp">path-to-regexp</a>处理 url 中地址与参数</h4> 
<h5><a id="_895"></a>特征</h5> 
<p>该工具库用来处理 url 中地址与参数，能够很方便得到小编们想要的数据。</p> 
<p>js 中有 RegExp 方法做正则表达式校验，而 path-to-regexp 可以看成是 url 字符串的正则表达式。</p> 
<h5><a id="_900"></a>解析</h5> 
<p>应用于面包屑组件<code>components/Breadcrumb/index.vue</code>中，</p> 
<p>分析下这个组件的原理：</p> 
<ul><li>拿到并且过滤当前路由中的matched属性，找到需要展示的meta属性</li><li>触发点击时，获得当前路由，判断redirect属性，如果值存在，塞进路由;否则有携带params的话，将路由补充完整。</li></ul> 
<pre><code class="prism language-js"><span class="token keyword">import</span> pathToRegexp <span class="token keyword">from</span> <span class="token string">'path-to-regexp'</span>


   <span class="token function">pathCompile</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// To solve this problem https://github.com/PanJiaChen/vue-element-admin/issues/561</span>
      <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> params <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route
      <span class="token keyword">var</span> toPath <span class="token operator">=</span> pathToRegexp<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token function">toPath</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<h4><a id="vuerouterhttpsgithubcomvuejsvuerouter_921"></a><a href="https://github.com/vuejs/vue-router">vue-router</a>管理路由</h4> 
<p><code>Vue Router</code>是 <code>Vue.js</code> 官方的路由管理器。它和 <code>Vue.js</code> 的核心深度集成，让构建单页面应用变得易如反掌。</p> 
<h5><a id="_924"></a>特征</h5> 
<ul><li>嵌套的路由/视图表</li><li>模块化的、基于组件的路由配置</li><li>路由参数、查询、通配符</li><li>基于 Vue.js 过渡系统的视图过渡效果</li><li>细粒度的导航控制</li><li>带有自动激活的 CSS class 的链接</li><li>HTML5 历史模式或 hash 模式，在 IE9 中自动降级</li><li>自定义的滚动条行为</li></ul> 
<h5><a id="_935"></a>解析</h5> 
<p>集成vue-router</p> 
<pre><code class="prism language-js">
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> Router <span class="token keyword">from</span> <span class="token string">'vue-router'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Router<span class="token punctuation">)</span>

<span class="token comment">/* Layout */</span>
<span class="token keyword">import</span> Layout <span class="token keyword">from</span> <span class="token string">'@/layout'</span>

</code></pre> 
<p>往路由中心<code>router/index.js</code>导入页面,下面是截取路由-页面映射的一部分。</p> 
<p>其中<code>getNav</code>是获取模板<code>/page/NavPage/index</code>路径的方法。</p> 
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">getNav</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/page/NavPage/index'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-js">
……

<span class="token punctuation">{<!-- --></span>
  path<span class="token punctuation">:</span> <span class="token string">'/jobs'</span><span class="token punctuation">,</span>
  component<span class="token punctuation">:</span> Layout<span class="token punctuation">,</span>
  redirect<span class="token punctuation">:</span> <span class="token string">'/jobs/recruitmentPlatform'</span><span class="token punctuation">,</span>
  name<span class="token punctuation">:</span> <span class="token string">'Jobs'</span><span class="token punctuation">,</span>
  meta<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    title<span class="token punctuation">:</span> <span class="token string">'工作'</span><span class="token punctuation">,</span>
    icon<span class="token punctuation">:</span> <span class="token string">'jobs'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  children<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>
    path<span class="token punctuation">:</span> <span class="token string">'recruitmentPlatform'</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token string">'RecruitmentPlatform'</span><span class="token punctuation">,</span>
    component<span class="token punctuation">:</span> <span class="token function">getNav</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    meta<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      title<span class="token punctuation">:</span> <span class="token string">'工作-招聘平台'</span><span class="token punctuation">,</span>
      icon<span class="token punctuation">:</span> <span class="token string">'recruitmentPlatform'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    path<span class="token punctuation">:</span> <span class="token string">'partTimeProgram'</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token string">'PartTimeProgram'</span><span class="token punctuation">,</span>
    component<span class="token punctuation">:</span> <span class="token function">getNav</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    meta<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      title<span class="token punctuation">:</span> <span class="token string">'工作-程序兼职'</span><span class="token punctuation">,</span>
      icon<span class="token punctuation">:</span> <span class="token string">'partTimeProgram'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    path<span class="token punctuation">:</span> <span class="token string">'partTimeDesign'</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token string">'PartTimeDesign'</span><span class="token punctuation">,</span>
    component<span class="token punctuation">:</span> <span class="token function">getNav</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    meta<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      title<span class="token punctuation">:</span> <span class="token string">'工作-设计兼职'</span><span class="token punctuation">,</span>
      icon<span class="token punctuation">:</span> <span class="token string">'partTimeDesign'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    path<span class="token punctuation">:</span> <span class="token string">'/jobs/iframeNav'</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token string">'jobsIframeNav'</span><span class="token punctuation">,</span>
    hidden<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/page/iframeNav/index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    meta<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      title<span class="token punctuation">:</span> <span class="token string">'网站'</span><span class="token punctuation">,</span>
      icon<span class="token punctuation">:</span> <span class="token string">'iframeNav'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>


……

</code></pre> 
<p>使用<code>router</code>生成页面</p> 
<pre><code class="prism language-js"><span class="token keyword">const</span> <span class="token function-variable function">createRouter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// mode: 'history', // require service support</span>
  scrollBehavior<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    y<span class="token punctuation">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes<span class="token punctuation">:</span> constantRoutes
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// Detail see: https://github.com/vuejs/vue-router/issues/1234#issuecomment-357941465</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">resetRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> newRouter <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  router<span class="token punctuation">.</span>matcher <span class="token operator">=</span> newRouter<span class="token punctuation">.</span>matcher <span class="token comment">// reset router</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router

</code></pre> 
<p>模板<code>NavPage/index.vue</code>代码见<a href="https://github.com/qiufeihong2018/navigation-web/tree/master/src/page/NavPage/index.vue">github仓库</a></p> 
<h4><a id="screenfullhttpsgithubcomsindresorhusscreenfulljs_1041"></a><a href="https://github.com/sindresorhus/screenfull.js">screenfull</a></h4> 
<p>用于跨浏览器使用<code>JavaScript Fullscreen API</code>的简单包装器，可让页面或任何元素全屏显示。</p> 
<h4><a id="vuewaterfall2httpsgithubcomAwesomeDevinvuewaterfall2_1045"></a><a href="https://github.com/AwesomeDevin/vue-waterfall2">vue-waterfall2</a>构建瀑布流布局</h4> 
<p>适用于vue和支持延迟加载的瀑布自适应插件，非常简单！</p> 
<pre><code class="prism language-js"><span class="token keyword">import</span> waterfall <span class="token keyword">from</span> <span class="token string">'vue-waterfall2'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>waterfall<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-html"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>waterfall</span>
        <span class="token attr-name">:col</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>col<span class="token punctuation">"</span></span>
        <span class="token attr-name">:width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>itemWidth<span class="token punctuation">"</span></span>
        <span class="token attr-name">:gutter-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gutterWidth<span class="token punctuation">"</span></span>
        <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>navArr<span class="token punctuation">"</span></span>
        <span class="token attr-name">@loadmore</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>loadmore<span class="token punctuation">"</span></span>
        <span class="token attr-name">@scroll</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scroll<span class="token punctuation">"</span></span>
      <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(nav,key) in navArr<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>key<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">margin-top</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-card</span> <span class="token attr-name">:body-</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token punctuation">{<!-- --></span> <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token string">'10px'</span> <span class="token punctuation">}</span></span><span class="token punctuation">"</span></span> <span class="token attr-name">shadow</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hover<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>nav.logo<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>image<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>加载错误<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form</span> <span class="token attr-name">label-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100px<span class="token punctuation">"</span></span> <span class="token attr-name">label-position</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>网站名称<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                  {<!-- -->{ nav.name }}
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>iframe链接<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>font-website<span class="token punctuation">"</span></span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{ path: <span class="token punctuation">'</span>iframeNav<span class="token punctuation">'</span>, query: { website: nav.website }}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    {<!-- -->{ nav.website }}
                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>新窗口链接<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>font-website<span class="token punctuation">"</span></span> <span class="token attr-name">:href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>nav.website<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{ nav.website }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>网站描述<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{<!-- -->{ nav.describe || '需要您添加网站描述' }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bottom clearfix<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>time</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>time<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>创建时间：{<!-- -->{ nav.created_at|timeTrans }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>time</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>openDialog(nav)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>编辑<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>deleteMap(nav)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>删除<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-card</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>waterfall</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="commitizenhttpsgithubcomcommitizenczcligit_1093"></a><a href="https://github.com/commitizen/cz-cli">commitizen</a>提交git规范化</h4> 
<p><code>commitizen</code>命令行实用程序。</p> 
<p>在<code>Commitizen</code>友好存储库中工作时，系统将提示填写必填字段，并且将提交消息根据项目维护人员定义的标准进行格式化。</p> 
<pre><code class="prism language-js">
<span class="token comment">// 全局安装commitizen node模块</span>
npm install commitizen <span class="token operator">-</span>g 
<span class="token comment">// 通过键入以下命令初始化您的项目，以使用cz-convention -change - elog适配器</span>
commitizen init cz<span class="token operator">-</span>conventional<span class="token operator">-</span>changelog <span class="token operator">--</span>save<span class="token operator">-</span>dev <span class="token operator">--</span>save<span class="token operator">-</span>exact
</code></pre> 
<h6><a id="type_commit_7_1107"></a>type用于说明 commit 的类别，只允许使用下面7个标识</h6> 
<ul><li>feat：新功能（feature）</li><li>fix：修补bug</li><li>docs：文档（documentation）</li><li>style： 格式（不影响代码运行的变动）</li><li>refactor：重构（即不是新增功能，也不是修改bug的代码变动）</li><li>test：增加测试</li><li>chore：构建过程或辅助工具的变动</li></ul> 
<h5><a id="scope_Commit_1117"></a>scope 用来说明本次Commit影响的范围，即简要说明修改会涉及的部分,比如数据层、控制层、视图层等</h5> 
<h5><a id="subject_comment_1119"></a>subject comment所在的位置,这次提交的简短描述</h5> 
<p>[外链图片转存失败(img-eEAiJ5V9-1567568945125)(https://raw.githubusercontent.com/commitizen/cz-cli/master/meta/screenshots/add-commit.png)]</p> 
<h4><a id="iframe_1123"></a>iframe嵌套网站</h4> 
<pre><code class="prism language-html">                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>iframe链接<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>font-website<span class="token punctuation">"</span></span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{ path: <span class="token punctuation">'</span>iframeNav<span class="token punctuation">'</span>, query: { website: nav.website }}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                    {<!-- -->{ nav.website }}
                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>新窗口链接<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>font-website<span class="token punctuation">"</span></span> <span class="token attr-name">:href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>nav.website<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{ nav.website }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>页面中的<code>iframe链接</code>添加<code>router-link</code>指向<code>iframe</code>页面，但是跳转过去的链接都加上了每一个分类的路由，所以在路由文件的每一个分类的路由中都添加<code>iframe</code>路由。</p> 
<pre><code class="prism language-js">
  <span class="token punctuation">{<!-- --></span>
    path<span class="token punctuation">:</span> <span class="token string">'/iframeNav'</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token string">'frontIframeNav'</span><span class="token punctuation">,</span>
    hidden<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/iframeNav/index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    meta<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      title<span class="token punctuation">:</span> <span class="token string">'网站'</span><span class="token punctuation">,</span>
      icon<span class="token punctuation">:</span> <span class="token string">'iframeNav'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">{<!-- --></span>
    path<span class="token punctuation">:</span> <span class="token string">'/back-end/iframeNav'</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token string">'backIframeNav'</span><span class="token punctuation">,</span>
    hidden<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/iframeNav/index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    meta<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      title<span class="token punctuation">:</span> <span class="token string">'网站'</span><span class="token punctuation">,</span>
      icon<span class="token punctuation">:</span> <span class="token string">'iframeNav'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  ……

</code></pre> 
<p>所有从<code>iframe</code>链接点击的都跳到这个页面</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>inlineFrameExample<span class="token punctuation">"</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Inline Frame Example<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>898px<span class="token punctuation">"</span></span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>iframeSrc<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      iframeSrc<span class="token punctuation">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>iframeSrc <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>website
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="_1184"></a>适配</h4> 
<p>根据<code>vue-waterfall2</code>的不响应的特性，适配功能只能靠小编自己解决。</p> 
<p>移动端，给他设置1列，侧边栏打开设置3列，其余设置4列。</p> 
<p>每个卡片的宽度根据屏幕的宽度和列数计算</p> 
<p>卡片间的距离，给它一个定值。注意的是，当在移动端时，必须要设为0,否则后面几列都会向右偏移。</p> 
<pre><code class="prism language-js">computed<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">col</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>device <span class="token operator">===</span> <span class="token string">'mobile'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token number">1</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sidebar<span class="token punctuation">.</span>opened <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token number">3</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token number">4</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">itemWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>device <span class="token operator">===</span> <span class="token string">'mobile'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0.885</span> <span class="token operator">*</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientWidth <span class="token operator">/</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sidebar<span class="token punctuation">.</span>opened <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0.8</span> <span class="token operator">*</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientWidth <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0.9</span> <span class="token operator">*</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientWidth <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">gutterWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>device <span class="token operator">===</span> <span class="token string">'mobile'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token number">0</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">9</span> <span class="token operator">*</span> <span class="token number">0.5</span> <span class="token operator">*</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientWidth <span class="token operator">/</span> <span class="token number">375</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token string">'sidebar'</span><span class="token punctuation">,</span>
      <span class="token string">'device'</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

</code></pre> 
<h4><a id="_1227"></a>网站分类</h4> 
<p>网站分类的数据是从<code>router</code>来的，但是<code>router</code>的数据必须要过滤才能得到分类的结果。</p> 
<p><code>categoryOptions</code>数组中的最后三者不属于分类项，所以要去掉。</p> 
<pre><code class="prism language-js"><span class="token comment">/**
 * get categoryOptions from routes
 * @param {HTMLElement} routes
 * @param {HTMLElement} tag: text/label
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getOption</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> routes<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> categoryOptions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> routes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>routes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>path <span class="token operator">!==</span> <span class="token string">'/redirect'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> children <span class="token operator">=</span> routes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>children
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> j <span class="token keyword">in</span> children<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
          value<span class="token punctuation">:</span> <span class="token string">''</span>
        <span class="token punctuation">}</span>
        obj<span class="token punctuation">.</span>value <span class="token operator">=</span> children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>path
        obj<span class="token punctuation">[</span>tag<span class="token punctuation">]</span> <span class="token operator">=</span> children<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>title
        categoryOptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  categoryOptions <span class="token operator">=</span> categoryOptions<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> item<span class="token punctuation">.</span>label <span class="token operator">!==</span> <span class="token string">'网站'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// Delete the last three elements</span>
  <span class="token keyword">return</span> categoryOptions<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>然后模板页调用该方法</p> 
<pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>
  getOption
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/utils/index'</span>

<span class="token keyword">this</span><span class="token punctuation">.</span>categoryOptions <span class="token operator">=</span> <span class="token function">getOption</span><span class="token punctuation">(</span><span class="token string">'label'</span><span class="token punctuation">,</span> routes<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_1269"></a>展望</h3> 
<p>下一篇《chrome开发之Navigation提交工具》</p> 
<p>目前这个项目的基本已经完成，但是还是有很多扩展的余地。比如提交网站比较麻烦，这个时候有一个chrome提交工具，所有的问题就迎刃而解。</p> 
<p>还有，这个项目小编会长期来维护，希望大家能踊跃提pr，提issue，将这个项目打造的更加完美，能够帮助到更多的人学习到vue除了官方demo之外的实际应用，避开更多的坑。</p> 
<p>最后，别忘了给这个项目点一个star哦，谢谢支持。</p> 
<p><a href="https://github.com/qiufeihong2018/navigation-web">navigation-web前端代码仓库</a></p> 
<p><a href="https://github.com/qiufeihong2018/navigation-server">navigation-server后端代码仓库</a></p> 
<p>下面是小编的公众号</p> 
<p><img src="https://images2.imgbox.com/82/ba/xduak6On_o.png" alt=""></p> 
<p>一个学习编程技术的公众号。每天推送高质量的优秀博文、开源项目、实用工具、面试技巧、编程学习资源等等。目标是做到个人技术与公众号一起成长。欢迎大家关注，一起进步，走向全栈大佬的修炼之路</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/10d31caf7af80abf4a8157cee8f8eccc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue.js点击判断是否已经登录</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/437206e245b69d5202073f99466ea586/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">maven_配置多个仓库</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>