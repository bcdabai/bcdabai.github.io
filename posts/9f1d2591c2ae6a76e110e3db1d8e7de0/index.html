<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>批量读取文件名和批量改写文件名 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="批量读取文件名和批量改写文件名" />
<meta property="og:description" content="bat命令批量获取和修改文件名 如图所示：
1、批量提取
（1）新建文本文档在文本文档里输入：
dir /a-d /b *.mp4&gt;src.txt
echo 收集文件名成功！
pause
（2）保存为“createsrc.bat”。
文件名字被提取到当前文件夹的 src.txt 里面了！也可以提取某类型的文件比如*.mp3 或者a*.mp3。
（3）运行 createsrc.bat 程序，
生成 src.txt ，其内容如下：
第四季01_真相只有一个.mp4
第四季02_谁说我有病.mp4
第四季03_以父之名.mp4
第四季04_翻滚吧！展博.mp4
第四季05_盗梦空间.mp4
第四季06_壮志凌云.mp4
第四季07_一条大河.mp4
第四季08_非诚勿扰.mp4
第四季09_冷战风云.mp4
第四季10_我是励志师.mp4
第四季11_土豪我们做朋友.mp4
第四季12_闪婚行动.mp4
第四季13_兄弟守则.mp4
第四季14_疯狂话剧（上）.mp4
第四季15_疯狂话剧（下）.mp4
第四季16_超级英雄.mp4
第四季17_放飞吧单身周末-上.mp4
第四季18_放飞吧单身周末-下.mp4
第四季19_女神的圣诞士.mp4
第四季20_当幸福来撬门（上）.mp4
第四季21_当幸福来撬门（下）.mp4
第四季22_曙光女神的宽恕.mp4
第四季23_回首又见他（上）.mp4
第四季24_回首又见他（下）.mp4
2、批量重命名
（1）新建文本文档在文本文档里输入：
@for /f %%s in (src.txt) do ( if exist %%s for /f %%d in (dest.txt) do ( ren %%s %%d.mp4) ) echo 操作成功！ pause （2）保存为“rename." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/9f1d2591c2ae6a76e110e3db1d8e7de0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-09-25T23:10:32+08:00" />
<meta property="article:modified_time" content="2018-09-25T23:10:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">批量读取文件名和批量改写文件名</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>bat命令批量获取和修改文件名</h2> 
<p> </p> 
<p>如图所示：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/1b/71/YlHyVwi2_o.png"></p> 
<p>1、批量提取</p> 
<p>（1）新建文本文档在文本文档里输入：</p> 
<p>dir /a-d /b *.mp4&gt;src.txt<br> echo 收集文件名成功！<br> pause</p> 
<p>（2）保存为“createsrc.bat”。</p> 
<p>文件名字被提取到当前文件夹的 src.txt 里面了！也可以提取某类型的文件比如*.mp3 或者a*.mp3。</p> 
<p>（3）运行 createsrc.bat 程序，</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/ca/2d/wJTdDJiL_o.png"></p> 
<p>生成 src.txt ，其内容如下：</p> 
<pre> </pre> 
<ol><li> <p><code>第四季01_真相只有一个.mp4</code></p> </li><li> <p><code>第四季02_谁说我有病.mp4</code></p> </li><li> <p><code>第四季03_以父之名.mp4</code></p> </li><li> <p><code>第四季04_翻滚吧！展博.mp4</code></p> </li><li> <p><code>第四季05_盗梦空间.mp4</code></p> </li><li> <p><code>第四季06_壮志凌云.mp4</code></p> </li><li> <p><code>第四季07_一条大河.mp4</code></p> </li><li> <p><code>第四季08_非诚勿扰.mp4</code></p> </li><li> <p><code>第四季09_冷战风云.mp4</code></p> </li><li> <p><code>第四季10_我是励志师.mp4</code></p> </li><li> <p><code>第四季11_土豪我们做朋友.mp4</code></p> </li><li> <p><code>第四季12_闪婚行动.mp4</code></p> </li><li> <p><code>第四季13_兄弟守则.mp4</code></p> </li><li> <p><code>第四季14_疯狂话剧（上）.mp4</code></p> </li><li> <p><code>第四季15_疯狂话剧（下）.mp4</code></p> </li><li> <p><code>第四季16_超级英雄.mp4</code></p> </li><li> <p><code>第四季17_放飞吧单身周末-上.mp4</code></p> </li><li> <p><code>第四季18_放飞吧单身周末-下.mp4</code></p> </li><li> <p><code>第四季19_女神的圣诞士.mp4</code></p> </li><li> <p><code>第四季20_当幸福来撬门（上）.mp4</code></p> </li><li> <p><code>第四季21_当幸福来撬门（下）.mp4</code></p> </li><li> <p><code>第四季22_曙光女神的宽恕.mp4</code></p> </li><li> <p><code>第四季23_回首又见他（上）.mp4</code></p> </li><li> <p><code>第四季24_回首又见他（下）.mp4</code></p> </li></ol> 
<p> </p> 
<p>2、批量重命名</p> 
<p>（1）新建文本文档在文本文档里输入：</p> 
<pre>@for /f %%s in (src.txt) do (
if exist %%s for /f %%d in (dest.txt) do (
ren %%s %%d.mp4)
)
echo 操作成功！
pause

（2）保存为“rename.bat”。
</pre> 
<p>src.txt   原来的文件名</p> 
<p>dest.txt  修改后的文件名</p> 
<p>（3）一行对应一个名字不能有空格同时注意文件属性：</p> 
<p>src.txt 内容：</p> 
<pre> </pre> 
<ol><li> <p><code>第四季01_真相只有一个.mp4</code></p> </li><li> <p><code>第四季02_谁说我有病.mp4</code></p> </li><li> <p><code>第四季03_以父之名.mp4</code></p> </li><li> <p><code>第四季04_翻滚吧！展博.mp4</code></p> </li><li> <p><code>第四季05_盗梦空间.mp4</code></p> </li><li> <p><code>第四季06_壮志凌云.mp4</code></p> </li><li> <p><code>第四季07_一条大河.mp4</code></p> </li><li> <p><code>第四季08_非诚勿扰.mp4</code></p> </li><li> <p><code>第四季09_冷战风云.mp4</code></p> </li><li> <p><code>第四季10_我是励志师.mp4</code></p> </li><li> <p><code>第四季11_土豪我们做朋友.mp4</code></p> </li><li> <p><code>第四季12_闪婚行动.mp4</code></p> </li><li> <p><code>第四季13_兄弟守则.mp4</code></p> </li><li> <p><code>第四季14_疯狂话剧（上）.mp4</code></p> </li><li> <p><code>第四季15_疯狂话剧（下）.mp4</code></p> </li><li> <p><code>第四季16_超级英雄.mp4</code></p> </li><li> <p><code>第四季17_放飞吧单身周末-上.mp4</code></p> </li><li> <p><code>第四季18_放飞吧单身周末-下.mp4</code></p> </li><li> <p><code>第四季19_女神的圣诞士.mp4</code></p> </li><li> <p><code>第四季20_当幸福来撬门（上）.mp4</code></p> </li><li> <p><code>第四季21_当幸福来撬门（下）.mp4</code></p> </li><li> <p><code>第四季22_曙光女神的宽恕.mp4</code></p> </li><li> <p><code>第四季23_回首又见他（上）.mp4</code></p> </li><li> <p><code>第四季24_回首又见他（下）.mp4</code></p> </li></ol> 
<p>dest.txt 内容：</p> 
<pre> </pre> 
<ol><li> <p><code>爱情公寓.第四季.Ipartment.S04.E01.真相只有一个</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E02.谁说我有病 </code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E03.以父之名</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E04.翻滚吧！展博</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E05.盗梦空间</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E06.壮志凌云</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E07.一条大河</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E08.非诚勿扰</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E09.冷战风云</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E10.我是励志师</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E11.土豪我们做朋友</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E12.闪婚行动</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E13.兄弟守则</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E14.疯狂话剧（上）</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E15.疯狂话剧（下）</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E16.超级英雄</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E17.放飞吧单身周末（上）</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E18.放飞吧单身周末（下）</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E19.女神的圣诞士</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E20.当幸福来撬门（上）</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E21.当幸福来撬门（下）</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E22.曙光女神的宽恕</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E23.回首又见他（上）</code></p> </li><li> <p><code>爱情公寓.第四季.Ipartment.S04.E24.回首又见他（下）</code></p> </li></ol> 
<p>（4）运行 rename.bat </p> 
<p>dos 运行示意图：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/be/99/TsEjmfKd_o.png"></p> 
<p>重名后文件名：</p> 
<p><img alt="" class="has" src="https://images2.imgbox.com/e7/ec/o9jDPHyW_o.png"></p> 
<p> </p> 
<p><strong>参数：</strong></p> 
<p>-1 每列仅显示一个文件或目录名称。</p> 
<p>-a或--all 下所有文件和目录。</p> 
<p>-A或--almost-all 显示所有文件和目录，但不显示现行目录和上层目录。</p> 
<p>-b或--escape 显示脱离字符。</p> 
<p>-B或--ignore-backups 忽略备份文件和目录。</p> 
<p>-c 以更改时间排序，显示文件和目录。</p> 
<p>-C 以又上至下，从左到右的直行方式显示文件和目录名称。</p> 
<p>-d或--directory 显示目录名称而非其内容。</p> 
<p>-D或--dired 用Emacs的模式产生文件和目录列表。</p> 
<p>-f 此参数的效果和同时指定"aU"参数相同，并关闭"lst"参数的效果。</p> 
<p>-F或--classify 在执行文件，目录，Socket，符号连接，管道名称后面，各自加上"*","/","=","@","|"号。</p> 
<p>-g 次参数将忽略不予处理。</p> 
<p>-G或--no-group 不显示群组名称。</p> 
<p>-h或--human-readable 用"K","M","G"来显示文件和目录的大小。</p> 
<p>-H或--si 此参数的效果和指定"-h"参数类似，但计算单位是1000Bytes而非1024Bytes。</p> 
<p>-i或--inode 显示文件和目录的inode编号。</p> 
<p>-I&lt;范本样式&gt;或--ignore=&lt;范本样式&gt; 不显示符合范本样式的文件或目录名称。</p> 
<p>-k或--kilobytes 此参数的效果和指定"block-size=1024"参数相同。</p> 
<p>-l 使用详细格式列表。</p> 
<p>-L或--dereference 如遇到性质为符号连接的文件或目录，直接列出该连接所指向的原始文件或目录。</p> 
<p>-m 用","号区隔每个文件和目录的名称。</p> 
<p>-n或--numeric-uid-gid 以用户识别码和群组识别码替代其名称。</p> 
<p>-N或--literal 直接列出文件和目录名称，包括控制字符。</p> 
<p>-o 此参数的效果和指定"-l" 参数类似，但不列出群组名称或识别码。</p> 
<p>-p或--file-type 此参数的效果和指定"-F"参数类似，但不会在执行文件名称后面加上"*"号。</p> 
<p>-q或--hide-control-chars 用"?"号取代控制字符，列出文件和目录名称。</p> 
<p>-Q或--quote-name 把文件和目录名称以""号标示起来。</p> 
<p>-r或--reverse 反向排序。</p> 
<p>-R或--recursive 递归处理，将指定目录下的所有文件及子目录一并处理。</p> 
<p>-s或--size 显示文件和目录的大小，以区块为单位。</p> 
<p>-S 用文件和目录的大小排序。</p> 
<p>-t 用文件和目录的更改时间排序。</p> 
<p>-T&lt;跳格字符&gt;或--tabsize=&lt;跳格字数&gt; 设置跳格字符所对应的空白字符数。</p> 
<p>-u 以最后存取时间排序，显示文件和目录。</p> 
<p>-U 列出文件和目录名称时不予排序。</p> 
<p>-v 文件和目录的名称列表以版本进行排序。</p> 
<p>-w&lt;每列字符数&gt;或--width=&lt;每列字符数&gt; 设置每列的最大字符数。</p> 
<p>-x 以从左到右，由上至下的横列方式显示文件和目录名称。</p> 
<p>-X 以文件和目录的最后一个扩展名排序。</p> 
<p>--block-size=&lt;区块大小&gt; 指定存放文件的区块大小。</p> 
<p>--color=&lt;列表格式&gt; 培植文件和目录的列表格式。</p> 
<p>--full-time 列出完整的日期与时间。</p> 
<p>--help 在线帮助。</p> 
<p>--indicator-style=&lt;标注样式&gt; 在文件和目录等名称后面加上标注，易于辨识该名称所属的类型。</p> 
<p>--quoting-syte=&lt;引号样式&gt; 把文件和目录名称以指定的引号样式标示起来。</p> 
<p>--show-control-chars 在文件和目录列表时，使用控制字符。</p> 
<p>--sort=&lt;排序方式&gt; 配置文件和目录列表的排序方式。</p> 
<p>--time=&lt;时间戳记&gt; 用指定的时间戳记取代更改时间。</p> 
<p>--version 显示版本信息。</p> 
<p> </p> 
<p> </p> 
<h2>windows如何批量修改文件名</h2> 
<p>2016年12月08日 10:54:37 <a href="https://me.csdn.net/xinganshenguang" rel="nofollow">AI_skynet</a> 阅读数：2496 标签： <a href="http://so.csdn.net/so/search/s.do?q=windows&amp;t=blog">windows</a><a href="http://so.csdn.net/so/search/s.do?q=%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E5%90%8D&amp;t=blog">批量修改文件名</a><a href="http://so.csdn.net/so/search/s.do?q=dos&amp;t=blog">dos</a> 更多</p> 
<p>个人分类： <a href="https://blog.csdn.net/xinganshenguang/article/category/6563073">windows</a></p> 
<p>版权声明：本文为博主原创文章，未经博主允许不得转载。 https://blog.csdn.net/xinganshenguang/article/details/53514946</p> 
<p>因为工作需要 有时候需要批量修改excel文件 故将方法分享出来</p> 
<p>1.在F盘建立一个文件夹，将批量生成的excel放置于该文件夹中，如下图所示</p> 
<p><img alt="这里写图片描述" class="has" src="https://images2.imgbox.com/28/64/oZ8kZNDd_o.jpg"></p> 
<p>2 鼠标左键点击，开始-》运行-》在对话框中输入字母“cmd”，进入dos模式 ，如下图所示。 <br><img alt="这里写图片描述" class="has" src="https://images2.imgbox.com/79/5b/mrEzReL2_o.jpg"></p> 
<p>3 在dos模式输入命令行“F:”然后回车，输入命令行“cd workspace”然后回车,再输入命令行“dir /b&gt;rename.xlsx”，如下图所示，可将文件夹中的文件名在rename.xlsx文件中列出。</p> 
<p><img alt="这里写图片描述" class="has" src="https://images2.imgbox.com/6c/2d/TTV5imZI_o.jpg"></p> 
<p>4 随后用excel打开F:\workspace文件夹中的rename.xlsx，你会发现文件名以全部罗列在A列中（你也可以用鼠标来调整文件名的顺序），你可以在B1列中输入1.xlsx作为第一个文件文件名。</p> 
<p><img alt="这里写图片描述" class="has" src="https://images2.imgbox.com/7c/69/z3jET2mj_o.jpg"></p> 
<p>5 鼠标选中B1单元格，并在B1列的右下方，使鼠标光标变为+号时，拖动使所有jpg文件的右侧B列中都有文件名。再将A8单元格中没有用的文件名删除，如下图示。</p> 
<p><img alt="这里写图片描述" class="has" src="https://images2.imgbox.com/0d/80/wbHs7ajF_o.jpg"></p> 
<p>6 鼠标选中C1单元格，并在编辑框中输入公式=”ren “&amp;A1&amp;” “&amp;B1，如下图所示。</p> 
<p><img alt="这里写图片描述" class="has" src="https://images2.imgbox.com/aa/cb/dQjgtD3V_o.jpg"></p> 
<p>7 继续用鼠标拖动C1单元格右下方的句柄，使剩余的C2-C7单元格填充如下图所示。 <br><img alt="这里写图片描述" class="has" src="https://images2.imgbox.com/31/7b/sZ0g8rOV_o.jpg"><br> 8 然后，鼠标选中C列，鼠标右键复制，如下图示。 <br><img alt="这里写图片描述" class="has" src="https://images2.imgbox.com/21/e5/tzbaYbsN_o.jpg"><br> 9 用notepad++中，粘贴刚才的命令行，如下图示。 <br><img alt="这里写图片描述" class="has" src="https://images2.imgbox.com/ea/c6/nygb1HXX_o.jpg"><br> 10 鼠标点击菜单“文件”——“另存为”，输入文件名ren.bat，要注意下图所示红圈中的路径及扩展名选项。 <br><img alt="这里写图片描述" class="has" src="https://images2.imgbox.com/2f/af/HMZLNSwV_o.jpg"><br> 11 打开F盘workspace文件夹，鼠标双击renname.bat这个批处理文件，即可将该文件夹下的jpg图片，按照刚才rename.xls中的顺序和文件名批量修改文件名，如下图示。 <br><img alt="这里写图片描述" class="has" src="https://images2.imgbox.com/71/2e/jOvDaKnv_o.jpg"></p> 
<p>注意如果文件是中文名字的 bat文件 要用ANSI编码 否则有中文乱码 <br><img alt="这里写图片描述" class="has" src="https://images2.imgbox.com/39/50/KW2LldCR_o.png"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fa5634292a19230cab221fcdb0539dbd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">求1 &#43; 2！ &#43; 3！ &#43; 4！ &#43; 5！&#43;.....的阶乘</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a64263789d46b783f6905257b52c7ff7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">初等行变换不改变列向量组的线性关系</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>