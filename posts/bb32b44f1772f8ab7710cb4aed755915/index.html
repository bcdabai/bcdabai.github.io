<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Apache-iotdb物联网数据库的安装及使用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Apache-iotdb物联网数据库的安装及使用" />
<meta property="og:description" content="一、简介 &gt;Apache IoTDB (Database for Internet of Things) is an IoT native database with high performance for data management and analysis, deployable on the edge and the cloud. Due to its light-weight architecture, high performance and rich feature set together with its deep integration with Apache Hadoop, Spark and Flink, Apache IoTDB can meet the requirements of massive data storage, high-speed data ingestion and complex data analysis in the IoT industrial fields." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/bb32b44f1772f8ab7710cb4aed755915/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-18T18:12:16+08:00" />
<meta property="article:modified_time" content="2024-01-18T18:12:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Apache-iotdb物联网数据库的安装及使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>一、简介</h2> 
<p>&gt;Apache IoTDB (Database for Internet of Things) is an IoT native database with high performance for data management and analysis, deployable on the edge and the cloud. Due to its light-weight architecture, high performance and rich feature set together with its deep integration with Apache Hadoop, Spark and Flink, Apache IoTDB can meet the requirements of massive data storage, high-speed data ingestion and complex data analysis in the IoT industrial fields.</p> 
<p>&gt;Apache IoTDB（物联网数据库）是一款专为物联网设计的高性能数据库，适用于数据管理和分析，既可在边缘部署，也可在云端部署。由于其轻量级架构、高性能以及丰富的功能集，加上与Apache Hadoop、Spark和Flink的深度集成，Apache IoTDB可以满足物联网工业领域对海量数据存储、高速数据摄取和复杂数据分析的需求。</p> 
<p>官网：<a href="https://iotdb.apache.org/" rel="nofollow">https://iotdb.apache.org/</a></p> 
<h2><a id="_8"></a>二、安装（单机版）</h2> 
<p>官方文档参考：<a href="https://iotdb.apache.org/UserGuide/latest/QuickStart/QuickStart.html" rel="nofollow">https://iotdb.apache.org/UserGuide/latest/QuickStart/QuickStart.html</a></p> 
<h3><a id="1_12"></a>1.安装前置条件</h3> 
<p>Java &gt;= 1.8 (Please make sure the environment path has been set)<br> Set the max open files num as 65535 to avoid “too many open files” problem。</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">jdk</span> <span class="token expression">安装<span class="token number">1.8</span>或以上，略</span></span>

#修改文件句柄数量
##临时设置
sudo sysctl <span class="token operator">-</span>w net<span class="token punctuation">.</span>core<span class="token punctuation">.</span>somaxconn<span class="token operator">=</span><span class="token number">65535</span>
##永久设置
vi <span class="token operator">/</span>etc<span class="token operator">/</span>sysctl<span class="token punctuation">.</span>conf 后加入参数
net<span class="token punctuation">.</span>core<span class="token punctuation">.</span>somaxconn<span class="token operator">=</span><span class="token number">65535</span>
然后执行
sysctl <span class="token operator">-</span>p
</code></pre> 
<p><code>下面的这些我为了保险也设置了一下</code></p> 
<pre><code class="prism language-c">####
cat <span class="token operator">&gt;&gt;</span> <span class="token operator">/</span>etc<span class="token operator">/</span>security<span class="token operator">/</span>limits<span class="token punctuation">.</span>conf <span class="token operator">&lt;&lt;</span> <span class="token constant">EOF</span>
<span class="token operator">*</span> soft nofile <span class="token number">65536</span>
<span class="token operator">*</span> hard nofile <span class="token number">65536</span>
<span class="token operator">*</span> soft nproc <span class="token number">65536</span>
<span class="token operator">*</span> hard nproc <span class="token number">65536</span>
<span class="token constant">EOF</span>

####
sed <span class="token operator">-</span>i 's<span class="token operator">/</span><span class="token operator">^</span><span class="token operator">*</span>          soft    nproc     <span class="token number">65536</span>$<span class="token comment">/*          soft    nproc     65536/' /etc/security/limits.d/20-nproc.conf

####
cat &gt;&gt; /etc/sysctl.conf &lt;&lt; EOF
vm.max_map_count=655360
EOF

sysctl -p 
</span></code></pre> 
<h3><a id="1_51"></a>1.下载及解压到安装目录</h3> 
<p><code>下载：</code></p> 
<p>&gt;wget https://www.apache.org/dyn/closer.cgi/iotdb/1.3.0/apache-iotdb-1.3.0-all-bin.zip</p> 
<p><code>解压：</code></p> 
<pre><code class="prism language-c">#解压到<span class="token operator">/</span>home<span class="token operator">/</span>testuser目录下
unzip apache<span class="token operator">-</span>iotdb<span class="token operator">-</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">-</span>all<span class="token operator">-</span>bin<span class="token punctuation">.</span>zip <span class="token operator">-</span>d <span class="token operator">/</span>home<span class="token operator">/</span>testuser
</code></pre> 
<h3><a id="2_65"></a>2.启动</h3> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Unix<span class="token operator">/</span>OS X</span></span>
<span class="token operator">&gt;</span> cd <span class="token operator">/</span>home<span class="token operator">/</span>testuser<span class="token operator">/</span>apache<span class="token operator">-</span>iotdb<span class="token operator">-</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">-</span>all<span class="token operator">-</span>bin
<span class="token operator">&gt;</span> bash sbin<span class="token operator">/</span>start<span class="token operator">-</span>standalone<span class="token punctuation">.</span>sh

<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Windows</span></span>
<span class="token operator">&gt;</span> sbin\start<span class="token operator">-</span>standalone<span class="token punctuation">.</span>bat
</code></pre> 
<h3><a id="3_76"></a>3.停止</h3> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Unix<span class="token operator">/</span>OS X</span></span>
<span class="token operator">&gt;</span> bash sbin<span class="token operator">/</span>stop<span class="token operator">-</span>standalone<span class="token punctuation">.</span>sh

<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Windows</span></span>
<span class="token operator">&gt;</span> sbin\stop<span class="token operator">-</span>standalone<span class="token punctuation">.</span>bat
</code></pre> 
<h2><a id="_86"></a>二、安装（集群版）</h2> 
<p>官网文档：https://iotdb.apache.org/UserGuide/latest/QuickStart/ClusterQuickStart.html</p> 
<h3><a id="1_90"></a>1.集群安装规划</h3> 
<p><code>服务安装规划</code></p> 
<table><thead><tr><th>IP</th><th>Role</th></tr></thead><tbody><tr><td>192.168.56.101</td><td>ConfigNode,DataNode</td></tr><tr><td>192.168.56.102</td><td>ConfigNode,DataNode</td></tr><tr><td>192.168.56.103</td><td>ConfigNode,DataNode</td></tr></tbody></table> 
<p><code>端口规划</code></p> 
<table><thead><tr><th>Service</th><th>ConfigNode</th><th>DataNode</th></tr></thead><tbody><tr><td>Port</td><td>10710,10720</td><td>6667,10730,10740,10750,10760</td></tr></tbody></table> 
<h3><a id="2_106"></a>2.前置条件(所有机器上执行)</h3> 
<p>Java &gt;= 1.8 (Please make sure the environment path has been set)<br> Set the max open files num as 65535 to avoid “too many open files” problem。</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">jdk</span> <span class="token expression">安装<span class="token number">1.8</span>或以上，略</span></span>

#修改文件句柄数量
##临时设置
sudo sysctl <span class="token operator">-</span>w net<span class="token punctuation">.</span>core<span class="token punctuation">.</span>somaxconn<span class="token operator">=</span><span class="token number">65535</span>
##永久设置
vi <span class="token operator">/</span>etc<span class="token operator">/</span>sysctl<span class="token punctuation">.</span>conf 后加入参数
net<span class="token punctuation">.</span>core<span class="token punctuation">.</span>somaxconn<span class="token operator">=</span><span class="token number">65535</span>
然后执行
sysctl <span class="token operator">-</span>p
</code></pre> 
<p><code>下面的这些我为了保险也设置了一下</code></p> 
<pre><code class="prism language-c">####
cat <span class="token operator">&gt;&gt;</span> <span class="token operator">/</span>etc<span class="token operator">/</span>security<span class="token operator">/</span>limits<span class="token punctuation">.</span>conf <span class="token operator">&lt;&lt;</span> <span class="token constant">EOF</span>
<span class="token operator">*</span> soft nofile <span class="token number">65536</span>
<span class="token operator">*</span> hard nofile <span class="token number">65536</span>
<span class="token operator">*</span> soft nproc <span class="token number">65536</span>
<span class="token operator">*</span> hard nproc <span class="token number">65536</span>
<span class="token constant">EOF</span>

####
sed <span class="token operator">-</span>i 's<span class="token operator">/</span><span class="token operator">^</span><span class="token operator">*</span>          soft    nproc     <span class="token number">65536</span>$<span class="token comment">/*          soft    nproc     65536/' /etc/security/limits.d/20-nproc.conf

####
cat &gt;&gt; /etc/sysctl.conf &lt;&lt; EOF
vm.max_map_count=655360
EOF

sysctl -p 
</span></code></pre> 
<h3><a id="3_146"></a>3.下载及解压(所有机器上执行)</h3> 
<p><code>下载：</code></p> 
<p>&gt;wget https://www.apache.org/dyn/closer.cgi/iotdb/1.3.0/apache-iotdb-1.3.0-all-bin.zip</p> 
<p><code>解压：</code></p> 
<pre><code class="prism language-c">#解压到<span class="token operator">/</span>home<span class="token operator">/</span>testuser目录下
unzip apache<span class="token operator">-</span>iotdb<span class="token operator">-</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">-</span>all<span class="token operator">-</span>bin<span class="token punctuation">.</span>zip <span class="token operator">-</span>d <span class="token operator">/</span>home<span class="token operator">/</span>testuser
</code></pre> 
<h3><a id="4_159"></a>4.配置</h3> 
<p>(1)192.168.56.101</p> 
<p><code>iotdb-confignode.properties:</code></p> 
<pre><code class="prism language-c">cn_internal_address<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span>
cn_seed_config_node<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token operator">:</span><span class="token number">10710</span>
</code></pre> 
<p><code>iotdb-datanode.properties:</code></p> 
<pre><code class="prism language-c">dn_rpc_address<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span>
dn_internal_address<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span>
dn_seed_config_node<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token operator">:</span><span class="token number">10710</span>
</code></pre> 
<p>(2)192.168.56.102</p> 
<p><code>iotdb-confignode.properties:</code></p> 
<pre><code class="prism language-c">cn_internal_address<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span>
cn_seed_config_node<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token operator">:</span><span class="token number">10710</span>
</code></pre> 
<p><code>iotdb-datanode.properties:</code></p> 
<pre><code class="prism language-c">dn_rpc_address<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span>
dn_internal_address<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span>
dn_seed_config_node<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token operator">:</span><span class="token number">10710</span>
</code></pre> 
<p>(3)192.168.56.103</p> 
<p><code>iotdb-confignode.properties:</code></p> 
<pre><code class="prism language-c">cn_internal_address<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span>
cn_seed_config_node<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token operator">:</span><span class="token number">10710</span>
</code></pre> 
<p><code>iotdb-datanode.properties:</code></p> 
<pre><code class="prism language-c">dn_rpc_address<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span>
dn_internal_address<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span>

dn_seed_config_node<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token operator">:</span><span class="token number">10710</span>
</code></pre> 
<p><code>注意：上面的配置cn_target_config_node_list,cn_seed_config_node,三台上使用的都是种子节点的IP：192.168.56.101</code></p> 
<h3><a id="5_215"></a>5.启动集群</h3> 
<h4><a id="1_217"></a>(1)防火墙开放</h4> 
<p><code>需要开放6667,10710,10720,10730,10740,10750,10760 这些端口的访问权限,我这里使用的是firewalld,你也可以使用iptables</code></p> 
<pre><code class="prism language-c">firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">6667</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10710</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10720</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10730</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10740</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10750</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10760</span><span class="token string">" accept"</span>

firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">6667</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10710</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10720</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10730</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10740</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10750</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10760</span><span class="token string">" accept"</span>

firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">6667</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10710</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10720</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10730</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10740</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10750</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10760</span><span class="token string">" accept"</span>

firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>reload
</code></pre> 
<h4><a id="2_249"></a>(2)启动集群</h4> 
<p><code>启动第一个节点（start the first node,192.168.56.101）:</code></p> 
<pre><code class="prism language-c">#<span class="token number">1.</span>启动第一个节点（start the first node<span class="token punctuation">,</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span>）
cd <span class="token operator">/</span>home<span class="token operator">/</span>testuser<span class="token operator">/</span>apache<span class="token operator">-</span>iotdb<span class="token operator">-</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">-</span>all<span class="token operator">-</span>bin
sbin<span class="token operator">/</span>start<span class="token operator">-</span>standalone<span class="token punctuation">.</span>sh
tail <span class="token operator">-</span>f logs<span class="token operator">/</span>log_datanode_all<span class="token punctuation">.</span>log
</code></pre> 
<p><code>启动其他节点start service ConfigNode and DataNode in other nodes,192.168.56.101,192.168.56.103</code></p> 
<pre><code class="prism language-c">cd <span class="token operator">/</span>home<span class="token operator">/</span>testuser<span class="token operator">/</span>apache<span class="token operator">-</span>iotdb<span class="token operator">-</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">-</span>all<span class="token operator">-</span>bin
sbin<span class="token operator">/</span>start<span class="token operator">-</span>standalone<span class="token punctuation">.</span>sh
tail <span class="token operator">-</span>f logs<span class="token operator">/</span>log_datanode_all<span class="token punctuation">.</span>log
</code></pre> 
<h4><a id="3_268"></a>(3)检查集群</h4> 
<pre><code class="prism language-c">#随便找哪一台集群机器，执行命令，下面的 <span class="token operator">-</span>h 后的ip可以是集群中的任何一个ip
cd <span class="token operator">/</span>home<span class="token operator">/</span>testuser<span class="token operator">/</span>apache<span class="token operator">-</span>iotdb<span class="token operator">-</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">-</span>all<span class="token operator">-</span>bin
<span class="token punctuation">.</span><span class="token operator">/</span>sbin<span class="token operator">/</span>start<span class="token operator">-</span>cli<span class="token punctuation">.</span>sh <span class="token operator">-</span>h <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span>

#查看集群状态
show cluster<span class="token punctuation">;</span>

IoTDB<span class="token operator">&gt;</span> show cluster<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span>NodeID<span class="token operator">|</span>  NodeType<span class="token operator">|</span> Status<span class="token operator">|</span>InternalAddress<span class="token operator">|</span>InternalPort<span class="token operator">|</span>Version<span class="token operator">|</span>BuildInfo<span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span>     <span class="token number">0</span><span class="token operator">|</span>ConfigNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token operator">|</span>       <span class="token number">10710</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">2</span><span class="token operator">|</span>ConfigNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span><span class="token operator">|</span>       <span class="token number">10710</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">4</span><span class="token operator">|</span>ConfigNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span><span class="token operator">|</span>       <span class="token number">10710</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span><span class="token operator">|</span>  DataNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token operator">|</span>       <span class="token number">10730</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">3</span><span class="token operator">|</span>  DataNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span><span class="token operator">|</span>       <span class="token number">10730</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">5</span><span class="token operator">|</span>  DataNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span><span class="token operator">|</span>       <span class="token number">10730</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
Total line number <span class="token operator">=</span> <span class="token number">6</span>
It costs <span class="token number">0.317</span>s
</code></pre> 
<h3><a id="6_293"></a>6.扩容</h3> 
<p>Expand means add services of ConfigNode or DataNode into an existing IoTDB cluster.</p> 
<h4><a id="1_297"></a>1.配置</h4> 
<p><code>iotdb-confignode.properties:</code></p> 
<pre><code class="prism language-c">cn_internal_address<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.104</span>
cn_seed_config_node<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token operator">:</span><span class="token number">10710</span>
</code></pre> 
<p><code>iotdb-datanode.properties:</code></p> 
<pre><code class="prism language-c">dn_rpc_address<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.104</span>
dn_internal_address<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.104</span>

dn_seed_config_node<span class="token operator">=</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token operator">:</span><span class="token number">10710</span>
</code></pre> 
<h4><a id="2_315"></a>2.防火墙加入</h4> 
<p><code>在原来的集群的三台机上执行</code></p> 
<pre><code class="prism language-c">firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.104</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">6667</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.104</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10710</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.104</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10720</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.104</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10730</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.104</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10740</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.104</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10750</span><span class="token string">" accept"</span>
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>permanent <span class="token operator">--</span>add<span class="token operator">-</span>rich<span class="token operator">-</span>rule<span class="token operator">=</span><span class="token string">"rule family="</span>ipv4<span class="token string">" source address="</span><span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.104</span><span class="token string">" port protocol="</span>tcp<span class="token string">" port="</span><span class="token number">10760</span><span class="token string">" accept"</span>

firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>reload
</code></pre> 
<p><code>同时，新加的那台机器也需要执行启动集群步骤中的防火墙开放操作，让几台机器之间的端口能互通</code></p> 
<h4><a id="3_333"></a>3.启动</h4> 
<pre><code class="prism language-c">cd <span class="token operator">/</span>home<span class="token operator">/</span>testuser<span class="token operator">/</span>apache<span class="token operator">-</span>iotdb<span class="token operator">-</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">-</span>all<span class="token operator">-</span>bin
sbin<span class="token operator">/</span>start<span class="token operator">-</span>standalone<span class="token punctuation">.</span>sh
tail <span class="token operator">-</span>f logs<span class="token operator">/</span>log_datanode_all<span class="token punctuation">.</span>log
</code></pre> 
<p><code>查看启动后是否已加入集群</code></p> 
<pre><code class="prism language-c">IoTDB<span class="token operator">&gt;</span> show cluster<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span>NodeID<span class="token operator">|</span>  NodeType<span class="token operator">|</span> Status<span class="token operator">|</span>InternalAddress<span class="token operator">|</span>InternalPort<span class="token operator">|</span>Version<span class="token operator">|</span>BuildInfo<span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span>     <span class="token number">0</span><span class="token operator">|</span>ConfigNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token operator">|</span>       <span class="token number">10710</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">2</span><span class="token operator">|</span>ConfigNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span><span class="token operator">|</span>       <span class="token number">10710</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">4</span><span class="token operator">|</span>ConfigNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span><span class="token operator">|</span>       <span class="token number">10710</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">6</span><span class="token operator">|</span>ConfigNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.104</span><span class="token operator">|</span>       <span class="token number">10710</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span><span class="token operator">|</span>  DataNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token operator">|</span>       <span class="token number">10730</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">3</span><span class="token operator">|</span>  DataNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span><span class="token operator">|</span>       <span class="token number">10730</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">5</span><span class="token operator">|</span>  DataNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span><span class="token operator">|</span>       <span class="token number">10730</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">7</span><span class="token operator">|</span>  DataNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.104</span><span class="token operator">|</span>       <span class="token number">10730</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
Total line number <span class="token operator">=</span> <span class="token number">8</span>
It costs <span class="token number">0.013</span>s
</code></pre> 
<h3><a id="7_361"></a>7.缩容</h3> 
<p>Shrink means removing a service from the IoTDB cluster.<br> 以对192.168.56.102进行移除为例：</p> 
<h4><a id="1ConfigNodeshrink_service_ConfigNode_366"></a>(1)移除ConfigNode，shrink service ConfigNode</h4> 
<pre><code class="prism language-c">cd <span class="token operator">/</span>home<span class="token operator">/</span>testuser<span class="token operator">/</span>apache<span class="token operator">-</span>iotdb<span class="token operator">-</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">-</span>all<span class="token operator">-</span>bin
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">way</span> <span class="token expression"><span class="token number">1</span><span class="token operator">:</span> shrink with ip<span class="token operator">:</span>port</span></span>
sbin<span class="token operator">/</span>remove<span class="token operator">-</span>confignode<span class="token punctuation">.</span>sh <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span><span class="token operator">:</span><span class="token number">10710</span>

<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">way</span> <span class="token expression"><span class="token number">2</span><span class="token operator">:</span> shrink with NodeID of `show cluster`</span></span>
sbin<span class="token operator">/</span>remove<span class="token operator">-</span>confignode<span class="token punctuation">.</span>sh <span class="token number">6</span>
</code></pre> 
<h4><a id="2DataNodeshrink_service_DataNode_377"></a>(2)移除DataNode，shrink service DataNode</h4> 
<pre><code class="prism language-c">cd <span class="token operator">/</span>home<span class="token operator">/</span>testuser<span class="token operator">/</span>apache<span class="token operator">-</span>iotdb<span class="token operator">-</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">-</span>all<span class="token operator">-</span>bin
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">way</span> <span class="token expression"><span class="token number">1</span><span class="token operator">:</span> shrink with ip<span class="token operator">:</span>port</span></span>
sbin<span class="token operator">/</span>remove<span class="token operator">-</span>datanode<span class="token punctuation">.</span>sh <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.102</span><span class="token operator">:</span><span class="token number">6667</span>

<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">way</span> <span class="token expression"><span class="token number">2</span><span class="token operator">:</span> shrink with NodeID of `show cluster`</span></span>
sbin<span class="token operator">/</span>remove<span class="token operator">-</span>confignode<span class="token punctuation">.</span>sh <span class="token number">7</span>
</code></pre> 
<h4><a id="3check_the_result_388"></a>(3)检查，check the result</h4> 
<pre><code class="prism language-c">IoTDB<span class="token operator">&gt;</span> show cluster
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span>NodeID<span class="token operator">|</span>  NodeType<span class="token operator">|</span> Status<span class="token operator">|</span>InternalAddress<span class="token operator">|</span>InternalPort<span class="token operator">|</span>Version<span class="token operator">|</span>BuildInfo<span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span>     <span class="token number">0</span><span class="token operator">|</span>ConfigNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token operator">|</span>       <span class="token number">10710</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">2</span><span class="token operator">|</span>ConfigNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span><span class="token operator">|</span>       <span class="token number">10710</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">6</span><span class="token operator">|</span>ConfigNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.104</span><span class="token operator">|</span>       <span class="token number">10710</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">1</span><span class="token operator">|</span>  DataNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.101</span><span class="token operator">|</span>       <span class="token number">10730</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">3</span><span class="token operator">|</span>  DataNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.103</span><span class="token operator">|</span>       <span class="token number">10730</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">|</span>     <span class="token number">7</span><span class="token operator">|</span>  DataNode<span class="token operator">|</span>Running<span class="token operator">|</span> <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.104</span><span class="token operator">|</span>       <span class="token number">10730</span><span class="token operator">|</span>  <span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">|</span>  fe787ca<span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
Total line number <span class="token operator">=</span> <span class="token number">6</span>
</code></pre> 
<h3><a id="8referenceCleanup_405"></a>8.<code>【reference】Cleanup，如果想清除集群数据重新初始化</code></h3> 
<p>如果想重新初始化集群，结束所有进程，然后删除data和logs目录，并重新启动即可。</p> 
<h4><a id="1_409"></a>(1).结束进程</h4> 
<p>End processes of ConfigNode and DataNode</p> 
<pre><code class="prism language-c"># <span class="token number">1.</span> Stop services ConfigNode and DataNode
sbin<span class="token operator">/</span>stop<span class="token operator">-</span>standalone<span class="token punctuation">.</span>sh

# <span class="token number">2.</span> Check whether there are IoTDB processes left or not
jps
# 或者
ps <span class="token operator">-</span>ef<span class="token operator">|</span>grep iotdb

# <span class="token number">3.</span> If there is any IoTDB process left<span class="token punctuation">,</span> kill it
kill <span class="token operator">-</span><span class="token number">9</span> <span class="token operator">&lt;</span>pid<span class="token operator">&gt;</span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">If there is only <span class="token number">1</span> IoTDB instance<span class="token punctuation">,</span> execue command below to remove all IoTDB process</span></span>
ps <span class="token operator">-</span>ef<span class="token operator">|</span>grep iotdb<span class="token operator">|</span>grep <span class="token operator">-</span>v grep<span class="token operator">|</span>tr <span class="token operator">-</span>s <span class="token char">'  '</span> <span class="token char">' '</span> <span class="token operator">|</span>cut <span class="token operator">-</span>d <span class="token char">' '</span> <span class="token operator">-</span>f2<span class="token operator">|</span>xargs kill <span class="token operator">-</span><span class="token number">9</span>
</code></pre> 
<h4><a id="2_428"></a>(2).清除数据</h4> 
<p>Remove directories of data and logs</p> 
<pre><code class="prism language-c">cd <span class="token operator">/</span>home<span class="token operator">/</span>testuser<span class="token operator">/</span>apache<span class="token operator">-</span>iotdb<span class="token operator">-</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">-</span>all<span class="token operator">-</span>bin
rm <span class="token operator">-</span>rf data logs
</code></pre> 
<h2><a id="_438"></a>三、简单使用</h2> 
<h3><a id="1_440"></a>1.简单命令</h3> 
<pre><code class="prism language-c">#连接登录：
<span class="token operator">&gt;</span> bash sbin<span class="token operator">/</span>start<span class="token operator">-</span>cli<span class="token punctuation">.</span>sh <span class="token operator">-</span>h <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token operator">-</span>p <span class="token number">6667</span> <span class="token operator">-</span>u root <span class="token operator">-</span>pw root

#创建数据库
IoTDB<span class="token operator">&gt;</span> create database root<span class="token punctuation">.</span>ln

#查看数据库
IoTDB<span class="token operator">&gt;</span> SHOW DATABASES

#创建timeseries
IoTDB<span class="token operator">&gt;</span> CREATE TIMESERIES root<span class="token punctuation">.</span>ln<span class="token punctuation">.</span>wf01<span class="token punctuation">.</span>wt01<span class="token punctuation">.</span>status WITH DATATYPE<span class="token operator">=</span>BOOLEAN<span class="token punctuation">,</span> ENCODING<span class="token operator">=</span>PLAIN
IoTDB<span class="token operator">&gt;</span> CREATE TIMESERIES root<span class="token punctuation">.</span>ln<span class="token punctuation">.</span>wf01<span class="token punctuation">.</span>wt01<span class="token punctuation">.</span>temperature WITH DATATYPE<span class="token operator">=</span>FLOAT<span class="token punctuation">,</span> ENCODING<span class="token operator">=</span>RLE

#查看timeseries
IoTDB<span class="token operator">&gt;</span> SHOW TIMESERIES
IoTDB<span class="token operator">&gt;</span> SHOW TIMESERIES root<span class="token punctuation">.</span>ln<span class="token punctuation">.</span>wf01<span class="token punctuation">.</span>wt01<span class="token punctuation">.</span>status

#插入数据
IoTDB<span class="token operator">&gt;</span> INSERT INTO root<span class="token punctuation">.</span>ln<span class="token punctuation">.</span>wf01<span class="token punctuation">.</span><span class="token function">wt01</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">,</span>status<span class="token punctuation">)</span> <span class="token function">values</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span>true<span class="token punctuation">)</span><span class="token punctuation">;</span>
IoTDB<span class="token operator">&gt;</span> INSERT INTO root<span class="token punctuation">.</span>ln<span class="token punctuation">.</span>wf01<span class="token punctuation">.</span><span class="token function">wt01</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">,</span>status<span class="token punctuation">,</span>temperature<span class="token punctuation">)</span> <span class="token function">values</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span>false<span class="token punctuation">,</span><span class="token number">20.71</span><span class="token punctuation">)</span>

#查询数据
IoTDB<span class="token operator">&gt;</span> SELECT <span class="token operator">*</span> FROM root<span class="token punctuation">.</span>ln<span class="token punctuation">.</span>wf01<span class="token punctuation">.</span>wt01

#退出登录
IoTDB<span class="token operator">&gt;</span> quit
IoTDB<span class="token operator">&gt;</span> exit
</code></pre> 
<h3><a id="2root_472"></a>2.修改root密码</h3> 
<pre><code class="prism language-c">IoTDB <span class="token operator">&gt;</span> ALTER USER root SET PASSWORD <span class="token char">'newpwd'</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="API_478"></a>四、API调用</h2> 
<h3><a id="1Java_Native_482"></a>（1）Java Native</h3> 
<p>https://iotdb.apache.org/UserGuide/latest/API/Programming-Java-Native-API.html#session-pool-for-native-api</p> 
<h4><a id="maven_486"></a>引入maven</h4> 
<pre><code class="prism language-c"><span class="token operator">&lt;</span>dependencies<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>dependency<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>groupId<span class="token operator">&gt;</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>iotdb<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>artifactId<span class="token operator">&gt;</span>iotdb<span class="token operator">-</span>session<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>version<span class="token operator">&gt;</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependencies<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="Session_498"></a>Session初始化测试</h4> 
<p><code>一般不使用，采用本机localhost和6667端口及默认账号密码root/root初始化Session</code></p> 
<pre><code class="prism language-c">		<span class="token comment">// use default configuration </span>
		Session session <span class="token operator">=</span> new Session<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><code>通过Session.Builder构造器初始化Session,采用默认的账号root和默认密码root,指定IP和端口</code></p> 
<pre><code class="prism language-c">		<span class="token comment">// initialize with a single node</span>
		Session session <span class="token operator">=</span> 
		    new Session<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		        <span class="token punctuation">.</span><span class="token function">host</span><span class="token punctuation">(</span>host<span class="token punctuation">)</span>
		        <span class="token punctuation">.</span><span class="token function">port</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span>
		        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		session<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><code>采用自定义的账号和密码码初始化Session</code></p> 
<pre><code class="prism language-c">		Session session <span class="token operator">=</span> 
			    new Session<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			        <span class="token punctuation">.</span><span class="token function">host</span><span class="token punctuation">(</span>host<span class="token punctuation">)</span>
			        <span class="token punctuation">.</span><span class="token function">port</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span>
			        <span class="token punctuation">.</span><span class="token function">username</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span>
			        <span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span>
			        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><code>有多个节点的情况下，通过Session.Builder构造器初始化Session</code></p> 
<pre><code class="prism language-c">		<span class="token comment">// initialize with multiple nodes</span>
		List<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> nodeUrls <span class="token operator">=</span> new ArrayList<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		nodeUrls<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"192.168.56.101:6667"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		nodeUrls<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"192.168.56.102:6667"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		nodeUrls<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"192.168.56.103:6667"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		Session session <span class="token operator">=</span> 
		    new Session<span class="token punctuation">.</span><span class="token function">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		    	<span class="token punctuation">.</span><span class="token function">nodeUrls</span><span class="token punctuation">(</span>nodeUrls<span class="token punctuation">)</span>
		        <span class="token punctuation">.</span><span class="token function">username</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span>
		        <span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span>
		        <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_554"></a>数据库管理测试</h4> 
<p><code>创建数据库</code></p> 
<pre><code class="prism language-c">		String storageGroupId <span class="token operator">=</span> <span class="token string">"root.group1"</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">setStorageGroup</span><span class="token punctuation">(</span>storageGroupId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><code>删除数据库</code></p> 
<pre><code class="prism language-c">		String storageGroupId <span class="token operator">=</span> <span class="token string">"root.group1"</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">deleteStorageGroup</span><span class="token punctuation">(</span>storageGroupId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><code>删除多个</code></p> 
<pre><code class="prism language-c">		List<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> storageGroupIds <span class="token operator">=</span> new ArrayList<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		storageGroupIds<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"root.group1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		storageGroupIds<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"root.group2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">deleteStorageGroups</span><span class="token punctuation">(</span>storageGroupIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="Timeseries_Test_579"></a>Timeseries Test</h4> 
<p><code>创建Timeseries</code></p> 
<pre><code class="prism language-c">			session<span class="token punctuation">.</span><span class="token function">createTimeseries</span><span class="token punctuation">(</span><span class="token string">"root.sestest.wf01.wt01.s0"</span><span class="token punctuation">,</span> TSDataType<span class="token punctuation">.</span>INT32<span class="token punctuation">,</span> TSEncoding<span class="token punctuation">.</span>RLE<span class="token punctuation">,</span> CompressionType<span class="token punctuation">.</span>SNAPPY<span class="token punctuation">)</span><span class="token punctuation">;</span>
	    session<span class="token punctuation">.</span><span class="token function">createTimeseries</span><span class="token punctuation">(</span><span class="token string">"root.sestest.wf01.wt01.s1"</span><span class="token punctuation">,</span> TSDataType<span class="token punctuation">.</span>INT32<span class="token punctuation">,</span> TSEncoding<span class="token punctuation">.</span>RLE<span class="token punctuation">,</span> CompressionType<span class="token punctuation">.</span>SNAPPY<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><code>删除Timeseries</code></p> 
<pre><code class="prism language-c">
			<span class="token comment">//可以传一个timeseries</span>
			<span class="token comment">//session.deleteTimeseries("root.sestest.wf01.wt01.s0");</span>
			<span class="token comment">//session.deleteTimeseries("root.sestest.wf01.wt01.s1");</span>
			
			<span class="token comment">//也可以传多个timeseries</span>
			List<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> timeseries <span class="token operator">=</span> new ArrayList<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			timeseries<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"root.sestest.wf01.wt01.s0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			timeseries<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"root.sestest.wf01.wt01.s1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			session<span class="token punctuation">.</span><span class="token function">deleteTimeseries</span><span class="token punctuation">(</span>timeseries<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><code>检查是否存在</code></p> 
<pre><code class="prism language-c">		String timeseries <span class="token operator">=</span> <span class="token string">"root.sestest.wf01.wt01.s0"</span><span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span><span class="token function">checkTimeseriesExists</span><span class="token punctuation">(</span>timeseries<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="Tablet_Insert_610"></a>Tablet Insert</h4> 
<pre><code class="prism language-c">	<span class="token comment">/**
	 * 插入Tablet
	 * @throws StatementExecutionException
	 * @throws IoTDBConnectionException
	 */</span>
	@Test
	public <span class="token keyword">void</span> <span class="token function">insertTabletTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> throws StatementExecutionException<span class="token punctuation">,</span> IoTDBConnectionException <span class="token punctuation">{<!-- --></span>
		
	    <span class="token keyword">int</span> BATCH_INSERT_SIZE <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span>
	    <span class="token keyword">long</span> TOTAL_INSERT_ROW_COUNT <span class="token operator">=</span> <span class="token number">20003L</span><span class="token punctuation">;</span>
		
		session<span class="token punctuation">.</span><span class="token function">setFetchSize</span><span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>false<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">/*
		 * 一个Tablet例子:
		 * deviceID: root.ln.wf01.wt01
		 * time status, temperature, speed
		 * 1    true        1.0       1
		 * 2    false       2.0       2
		 * 3    true        3.0       3
		 */</span>
		<span class="token comment">// 设置设备名字，设备下面的传感器名字，各个传感器的类型</span>
		List<span class="token operator">&lt;</span>MeasurementSchema<span class="token operator">&gt;</span> schemaList <span class="token operator">=</span> new ArrayList<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		schemaList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>new <span class="token function">MeasurementSchema</span><span class="token punctuation">(</span><span class="token string">"status"</span><span class="token punctuation">,</span> TSDataType<span class="token punctuation">.</span>BOOLEAN<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		schemaList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>new <span class="token function">MeasurementSchema</span><span class="token punctuation">(</span><span class="token string">"temperature"</span><span class="token punctuation">,</span> TSDataType<span class="token punctuation">.</span>DOUBLE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		schemaList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>new <span class="token function">MeasurementSchema</span><span class="token punctuation">(</span><span class="token string">"speed"</span><span class="token punctuation">,</span> TSDataType<span class="token punctuation">.</span>INT64<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		Tablet tablet <span class="token operator">=</span> new <span class="token function">Tablet</span><span class="token punctuation">(</span><span class="token string">"root.ln.wf01.wt02"</span><span class="token punctuation">,</span> schemaList<span class="token punctuation">,</span> BATCH_INSERT_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>


		<span class="token comment">// 以当前时间戳作为插入的起始时间戳</span>
		<span class="token keyword">long</span> timestamp <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">long</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> row <span class="token operator">&lt;</span> TOTAL_INSERT_ROW_COUNT<span class="token punctuation">;</span> row<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		    <span class="token keyword">int</span> rowIndex <span class="token operator">=</span> tablet<span class="token punctuation">.</span>rowSize<span class="token operator">++</span><span class="token punctuation">;</span>
		    tablet<span class="token punctuation">.</span><span class="token function">addTimestamp</span><span class="token punctuation">(</span>rowIndex<span class="token punctuation">,</span> timestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		    <span class="token comment">// 随机生成数据</span>
		    tablet<span class="token punctuation">.</span><span class="token function">addValue</span><span class="token punctuation">(</span><span class="token string">"status"</span><span class="token punctuation">,</span> rowIndex<span class="token punctuation">,</span> <span class="token punctuation">(</span>row <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		    tablet<span class="token punctuation">.</span><span class="token function">addValue</span><span class="token punctuation">(</span><span class="token string">"temperature"</span><span class="token punctuation">,</span> rowIndex<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> row<span class="token punctuation">)</span><span class="token punctuation">;</span>
		    tablet<span class="token punctuation">.</span><span class="token function">addValue</span><span class="token punctuation">(</span><span class="token string">"speed"</span><span class="token punctuation">,</span> rowIndex<span class="token punctuation">,</span> row<span class="token punctuation">)</span><span class="token punctuation">;</span>

		    <span class="token keyword">if</span> <span class="token punctuation">(</span>tablet<span class="token punctuation">.</span>rowSize <span class="token operator">==</span> tablet<span class="token punctuation">.</span><span class="token function">getMaxRowNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		        session<span class="token punctuation">.</span><span class="token function">insertTablet</span><span class="token punctuation">(</span>tablet<span class="token punctuation">)</span><span class="token punctuation">;</span>
		        tablet<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"已经插入了："</span> <span class="token operator">+</span> <span class="token punctuation">(</span>row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"行数据"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		    <span class="token punctuation">}</span>
		    timestamp<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 插入剩余不足 BATCH_INSERT_SIZE的数据</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>tablet<span class="token punctuation">.</span>rowSize <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		    session<span class="token punctuation">.</span><span class="token function">insertTablet</span><span class="token punctuation">(</span>tablet<span class="token punctuation">)</span><span class="token punctuation">;</span>
		    tablet<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"已经插入了："</span> <span class="token operator">+</span> <span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"行数据"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="Record_Insert_Test_673"></a>Record Insert Test</h4> 
<pre><code class="prism language-c">	@Test
	public <span class="token keyword">void</span> <span class="token function">insertRecordTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> throws IoTDBConnectionException<span class="token punctuation">,</span> StatementExecutionException <span class="token punctuation">{<!-- --></span>

		<span class="token comment">//session.setStorageGroup("root.group1");</span>
		String deviceId <span class="token operator">=</span> <span class="token string">"root.group1.device1"</span><span class="token punctuation">;</span>
		List<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> measurements <span class="token operator">=</span> new ArrayList<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		measurements<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"s0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		measurements<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"s1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		measurements<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"s2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		List<span class="token operator">&lt;</span>TSDataType<span class="token operator">&gt;</span> types <span class="token operator">=</span> new ArrayList<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		types<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>TSDataType<span class="token punctuation">.</span>INT32<span class="token punctuation">)</span><span class="token punctuation">;</span>
		types<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>TSDataType<span class="token punctuation">.</span>INT32<span class="token punctuation">)</span><span class="token punctuation">;</span>
		types<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>TSDataType<span class="token punctuation">.</span>INT32<span class="token punctuation">)</span><span class="token punctuation">;</span>
		List<span class="token operator">&lt;</span>Object<span class="token operator">&gt;</span> values <span class="token operator">=</span> new ArrayList<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		values<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		values<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		values<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">long</span> timestamp <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">insertRecord</span><span class="token punctuation">(</span>deviceId<span class="token punctuation">,</span> timestamp<span class="token punctuation">,</span> measurements<span class="token punctuation">,</span> types<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="DeleteData_Test_699"></a>DeleteData Test</h4> 
<p><code>删除数据测试</code></p> 
<pre><code class="prism language-c">	<span class="token comment">/**
	 * 删除数据测试,
	 * 参数timestamp为long类型，表示要删除的数据的时间，在这时间或这时间之前的数据将删除
	 * Delete data before or equal to a timestamp of one or several timeseries
	 * @throws StatementExecutionException 
	 */</span>
	@Test
	public <span class="token keyword">void</span> <span class="token function">deleteDataTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> throws StatementExecutionException <span class="token punctuation">{<!-- --></span>
		
		String deviceId <span class="token operator">=</span> <span class="token string">"root.group1.device2.s0"</span><span class="token punctuation">;</span>
		<span class="token keyword">long</span> timestamp <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		try <span class="token punctuation">{<!-- --></span>
			session<span class="token punctuation">.</span><span class="token function">deleteData</span><span class="token punctuation">(</span>deviceId<span class="token punctuation">,</span> timestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token function">catch</span> <span class="token punctuation">(</span>IoTDBConnectionException e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre> 
<p><code>批量删除数据测试</code></p> 
<pre><code class="prism language-c">	<span class="token comment">/**
	 * 批量删除数据测试,
	 * 参数timestamp为long类型，表示要删除的数据的时间，在这时间或这时间之前的数据将删除
	 * Delete data before or equal to a timestamp of one or several timeseries
	 * @throws StatementExecutionException
	 */</span>
	@Test
	public <span class="token keyword">void</span> <span class="token function">deleteDatasTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> throws StatementExecutionException <span class="token punctuation">{<!-- --></span>
		
		List<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> paths <span class="token operator">=</span> new ArrayList<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		paths<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"root.group1.device2.s0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		paths<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"root.group1.device2.s1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		paths<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"root.group1.device2.s2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment">//删除当前时间以前的数据</span>
		<span class="token keyword">long</span> timestamp <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		try <span class="token punctuation">{<!-- --></span>
			session<span class="token punctuation">.</span><span class="token function">deleteData</span><span class="token punctuation">(</span>paths<span class="token punctuation">,</span> timestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token function">catch</span> <span class="token punctuation">(</span>IoTDBConnectionException e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="QueryTest_753"></a>查询测试QueryTest</h4> 
<p><code>查询数据</code></p> 
<p>使用session.executeRawDataQuery方法</p> 
<pre><code class="prism language-c">	<span class="token comment">/**
	 * 查询数据
	 */</span>
	@Test
	public <span class="token keyword">void</span> <span class="token function">executeRawDataQueryTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> throws StatementExecutionException<span class="token punctuation">,</span> IoTDBConnectionException <span class="token punctuation">{<!-- --></span>
		
		List<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> paths <span class="token operator">=</span> new ArrayList<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		paths<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"root.ln.wf01.wt01.temperature"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		paths<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"root.ln.wf01.wt01.speed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		paths<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"root.ln.wf01.wt01.status"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		String startDateTimeStr <span class="token operator">=</span> <span class="token string">"2024-01-01 00:00:00"</span><span class="token punctuation">;</span>  
		LocalDateTime ldt <span class="token operator">=</span> LocalDateTime<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>startDateTimeStr<span class="token punctuation">,</span>DateTimeFormatter<span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Date date <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>ldt<span class="token punctuation">.</span><span class="token function">atZone</span><span class="token punctuation">(</span> ZoneId<span class="token punctuation">.</span><span class="token function">systemDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">long</span> startTime <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment">//当前时间</span>
		<span class="token keyword">long</span> endTime <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		SessionDataSet sessionDataSet <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">executeRawDataQuery</span><span class="token punctuation">(</span>paths<span class="token punctuation">,</span> startTime<span class="token punctuation">,</span> endTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token keyword">while</span><span class="token punctuation">(</span>sessionDataSet<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			
			RowRecord rowRecord <span class="token operator">=</span> sessionDataSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rowRecord<span class="token punctuation">)</span><span class="token punctuation">;</span>
			
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span>
</code></pre> 
<p><code>查询最新数据</code></p> 
<p>使用session.executeLastDataQuery方法</p> 
<pre><code class="prism language-c">	<span class="token comment">/**
	 * 查询最新数据
	 * 查询指定时间以后的最新数据
	 * @throws StatementExecutionException
	 * @throws IoTDBConnectionException
	 */</span>
	@Test
	public <span class="token keyword">void</span> <span class="token function">executeLastDataQueryTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> throws StatementExecutionException<span class="token punctuation">,</span> IoTDBConnectionException <span class="token punctuation">{<!-- --></span>
		
		List<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span> paths <span class="token operator">=</span> new ArrayList<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		paths<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"root.ln.wf01.wt01.temperature"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		paths<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"root.ln.wf01.wt01.speed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		paths<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"root.ln.wf01.wt01.status"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment">//查询指定时间以后的最新数据，这里指定时间为"2024-01-01 00:00:00";</span>
		String startDateTimeStr <span class="token operator">=</span> <span class="token string">"2024-01-01 00:00:00"</span><span class="token punctuation">;</span>  
		LocalDateTime ldt <span class="token operator">=</span> LocalDateTime<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>startDateTimeStr<span class="token punctuation">,</span>DateTimeFormatter<span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Date date <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>ldt<span class="token punctuation">.</span><span class="token function">atZone</span><span class="token punctuation">(</span> ZoneId<span class="token punctuation">.</span><span class="token function">systemDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">long</span> startTime <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		SessionDataSet sessionDataSet <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">executeLastDataQuery</span><span class="token punctuation">(</span>paths<span class="token punctuation">,</span> startTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token keyword">while</span><span class="token punctuation">(</span>sessionDataSet<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			RowRecord rowRecord <span class="token operator">=</span> sessionDataSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rowRecord<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="IoTDBSQL_Interfacesql_826"></a>IoTDB-SQL Interface(根据sql查询数据)</h4> 
<p>使用session.executeQueryStatement方法</p> 
<pre><code class="prism language-c">	<span class="token comment">/**
	 * IoTDB-SQL Interface
	 * Sql语句接口，
	 * @throws StatementExecutionException
	 * @throws IoTDBConnectionException
	 */</span>
	@Test
	public <span class="token keyword">void</span> <span class="token function">executeQueryStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> throws StatementExecutionException<span class="token punctuation">,</span> IoTDBConnectionException <span class="token punctuation">{<!-- --></span>
		
		SessionDataSet sessionDataSet <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">executeQueryStatement</span><span class="token punctuation">(</span><span class="token string">"select * from root.ln.wf01.wt03"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>sessionDataSet<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			RowRecord rowRecord <span class="token operator">=</span> sessionDataSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rowRecord<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="IoTDBSQL_Interfacesql_848"></a>IoTDB-SQL Interface(根据sql更新数据)</h4> 
<p>使用session.executeNonQueryStatement方法</p> 
<pre><code class="prism language-c">	@Test
	public <span class="token keyword">void</span> <span class="token function">executeNonQueryStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> throws StatementExecutionException<span class="token punctuation">,</span> IoTDBConnectionException <span class="token punctuation">{<!-- --></span>
		session<span class="token punctuation">.</span><span class="token function">executeNonQueryStatement</span><span class="token punctuation">(</span><span class="token string">"INSERT INTO root.ln.wf01.wt03(timestamp,status) values(200,true);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_859"></a>五、源码下载</h2> 
<p>github: <a href="https://github.com/jxlhljh/iotdbTest.git">https://github.com/jxlhljh/iotdbTest.git</a><br> gitee: <a href="https://gitee.com/jxlhljh/iotdbTest.git" rel="nofollow">https://gitee.com/jxlhljh/iotdbTest.git</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/965ed6b70ab5a6c6179d171a00cf55a3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">shell编程-4</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b98c146632647c27a312c67412824fa3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Apache安全及优化</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>