<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>UI自动化测试（一） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="UI自动化测试（一）" />
<meta property="og:description" content="一、安装 1. selenium其实虽然称之为工具，但是实际是python中一个库 pip install selenium==3.14 2.安装浏览器 谷歌、火狐、edge
3.下载浏览器驱动 根据浏览器版本下载
详情看下文链接：
https://blog.csdn.net/qq_37515374/article/details/128651883
二、八大元素定位方式 1、id定位 如果某个元素的有id属性，那么如果id属性的值唯一，则可以利用该属性的值定位
如果id属性的值是一串无序的字母或者数字，则不能使用，有可能是动态id
driver.find_element_by_id(&#34;id属性的值&#34;) 2、name定位 根据name属性的值来定位，但是如果name属性的值在当前页面不唯一，则是无法定位的
driver.find_element_by_name(&#34;keyWord&#34;) 3、class name class属性的值，不唯一的可能性很大
driver.find_element_by_class_name(&#39;s_ipt&#39;) 4、tag name （通过标签名本身选择，一般无法使用，不推荐） driver.find_element_by_tag_name(&#34;标签名&#34;) 5、link text （一般不要使用） driver.find_element_by_link_text(&#34;搜索&#34;) 6、partial link text（一般不要使用） driver.find_element_by_partial_link_text(&#34;搜&#34;) 7、xpath //标签名[@属性名=‘属性值’]，其中// 表示全局搜索；标签名 表示要查找的元素的标签名；@属性名 表示该元素的某个属性名；‘属性值’ 表示该属性的值。/父元素/子元素，用 / 来表示层级关系，可以选取某个父元素下的直接子元素。//*[@属性名=‘属性值’]，用 * 表示匹配所有的元素，并加上 [@属性名=‘属性值’] 来选择符合条件的元素。//*[contains(text(),‘文本内容’)]，用 contains() 函数来匹配元素时，文本内容必须保持一致。使用逻辑运算符、通配符、使用轴 driver.find_element_by_xpath(&#34;//div[@class=&#39;source&#39;]//*[text()=&#39;删除&#39;]&#34;).click() 8、css selector 根据标签以及标签的属性进行定位
driver.find_element_by_css_selector(&#39;input[name=&#34;keyWord&#34;]&#39;) # 如果class属性的值唯一，也可以将其写成css的语法.s_iptdriver.find_element_by_css_selector(&#39;.s_ipt&#39;) 三、webdriver常用方法 1、浏览器的操作 from selenium import webdriver import time # 打开浏览器 driver = webdriver." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/fbee92156fab2b4239b7a74516aafa6f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-02T09:23:03+08:00" />
<meta property="article:modified_time" content="2023-06-02T09:23:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">UI自动化测试（一）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>一、安装</h3> 
<h4><a id="1_seleniumpython_2"></a>1. selenium其实虽然称之为工具，但是实际是python中一个库</h4> 
<pre><code class="prism language-python">pip install selenium<span class="token operator">==</span><span class="token number">3.14</span>
</code></pre> 
<h4><a id="2_8"></a>2.安装浏览器</h4> 
<p>谷歌、火狐、edge</p> 
<h4><a id="3_12"></a>3.下载浏览器驱动</h4> 
<p>根据浏览器版本下载<br> 详情看下文链接：<br> <a href="https://blog.csdn.net/qq_37515374/article/details/128651883">https://blog.csdn.net/qq_37515374/article/details/128651883</a></p> 
<h3><a id="_18"></a>二、八大元素定位方式</h3> 
<h4><a id="1id_19"></a>1、id定位</h4> 
<p>如果某个元素的有id属性，那么如果id属性的值唯一，则可以利用该属性的值定位<br> 如果id属性的值是一串无序的字母或者数字，则不能使用，有可能是动态id</p> 
<pre><code class="prism language-python">driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"id属性的值"</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="2name_25"></a>2、name定位</h4> 
<p>根据name属性的值来定位，但是如果name属性的值在当前页面不唯一，则是无法定位的</p> 
<pre><code class="prism language-python">driver<span class="token punctuation">.</span>find_element_by_name<span class="token punctuation">(</span><span class="token string">"keyWord"</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="3class_name_32"></a>3、class name</h4> 
<p>class属性的值，不唯一的可能性很大</p> 
<pre><code class="prism language-python">driver<span class="token punctuation">.</span>find_element_by_class_name<span class="token punctuation">(</span><span class="token string">'s_ipt'</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="4tag_name__40"></a>4、tag name （通过标签名本身选择，一般无法使用，不推荐）</h4> 
<pre><code class="prism language-python">driver<span class="token punctuation">.</span>find_element_by_tag_name<span class="token punctuation">(</span><span class="token string">"标签名"</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="5link_text__46"></a>5、link text （一般不要使用）</h4> 
<pre><code class="prism language-python">driver<span class="token punctuation">.</span>find_element_by_link_text<span class="token punctuation">(</span><span class="token string">"搜索"</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="6partial_link_text_52"></a>6、partial link text（一般不要使用）</h4> 
<pre><code class="prism language-python">driver<span class="token punctuation">.</span>find_element_by_partial_link_text<span class="token punctuation">(</span><span class="token string">"搜"</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="7xpath_58"></a>7、xpath</h4> 
<ul><li>//标签名[@属性名=‘属性值’]，其中// 表示全局搜索；标签名 表示要查找的元素的标签名；@属性名 表示该元素的某个属性名；‘属性值’ 表示该属性的值。</li><li>/父元素/子元素，用 / 来表示层级关系，可以选取某个父元素下的直接子元素。</li><li>//*[@属性名=‘属性值’]，用 * 表示匹配所有的元素，并加上 [@属性名=‘属性值’] 来选择符合条件的元素。</li><li>//*[contains(text(),‘文本内容’)]，用 contains() 函数来匹配元素时，文本内容必须保持一致。</li><li>使用逻辑运算符、通配符、使用轴</li></ul> 
<pre><code class="prism language-python">driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">"//div[@class='source']//*[text()='删除']"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="8css_selector_70"></a>8、css selector</h4> 
<p>根据标签以及标签的属性进行定位</p> 
<pre><code class="prism language-python">driver<span class="token punctuation">.</span>find_element_by_css_selector<span class="token punctuation">(</span><span class="token string">'input[name="keyWord"]'</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># 如果class属性的值唯一，也可以将其写成css的语法.s_iptdriver.find_element_by_css_selector('.s_ipt')</span>
</code></pre> 
<h3><a id="webdriver_82"></a>三、webdriver常用方法</h3> 
<h4><a id="1_83"></a>1、浏览器的操作</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">import</span> time
<span class="token comment"># 打开浏览器</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 设置浏览器最大化</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 设置隐式等待</span>
driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment"># 打开网页</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 设置宽和高</span>
driver<span class="token punctuation">.</span>set_window_size<span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span>
<span class="token comment"># 后退</span>
driver<span class="token punctuation">.</span>back<span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># 前进</span>
driver<span class="token punctuation">.</span>forward<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 刷新当前页面</span>
driver<span class="token punctuation">.</span>refresh<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 关闭当前窗口</span>
driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 关闭浏览器</span>
driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="2_112"></a>2、元素操作</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">import</span> time
<span class="token comment"># 打开浏览器</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 设置浏览器最大化</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 设置隐式等待</span>
driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment"># 打开网页</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">)</span>
<span class="token comment"># 定位搜素框</span>
search_element<span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'kw'</span><span class="token punctuation">)</span>
<span class="token comment"># 输入内容</span>
search_element<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"乔丹"</span><span class="token punctuation">)</span>
<span class="token comment"># 直接使用submit进行提交</span>
search_element<span class="token punctuation">.</span>submit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 其他操作</span>
<span class="token comment"># 清空输入的值</span>
clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 元素尺寸</span>
size
<span class="token comment"># 元素文本</span>
text
<span class="token comment"># 获取元素的属性值</span>
get_attribute<span class="token punctuation">(</span><span class="token string">'属性值'</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">-</span>如<span class="token builtin">id</span>，<span class="token keyword">class</span>
</code></pre> 
<h4><a id="3_142"></a>3、设置等待时间</h4> 
<ul><li>设置隐式等待</li></ul> 
<pre><code class="prism language-python">driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>显式等待，一般适用于单个元素加载较慢、或者需要等待特定状态的情况。</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> WebDriverWait
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support <span class="token keyword">import</span> expected_conditions <span class="token keyword">as</span> EC

<span class="token comment"># 创建浏览器对象</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 访问网址并进行后续操作</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://www.baidu.com'</span><span class="token punctuation">)</span>
element <span class="token operator">=</span> WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>
    EC<span class="token punctuation">.</span>presence_of_element_located<span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">'kw'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
element<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'搜索关键字'</span><span class="token punctuation">)</span>

</code></pre> 
<h4><a id="4_168"></a>4、鼠标事件</h4> 
<p>在 WebDriver 中， 将这些关于鼠标操作的方法封装在 ActionChains 类提供。ActionChains 类提供了鼠标操作的常用方法：</p> 
<ul><li>perform()： 执行所有 ActionChains 中存储的行为；</li><li>context_click()： 右击；</li><li>double_click()： 双击；</li><li>drag_and_drop()： 拖动；</li><li>move_to_element()： 鼠标悬停。</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token comment"># 导入ActionChains这个类</span>
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>action_chains <span class="token keyword">import</span> ActionChains
<span class="token keyword">import</span> time
<span class="token comment"># 打开浏览器</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 设置浏览器最大化</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 设置隐式等待</span>
driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment"># 打开网页</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 定位到设置</span>
st_button <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'s-usersetting-top'</span><span class="token punctuation">)</span>
<span class="token comment"># 设置鼠标悬停</span>
<span class="token comment"># perform()执行前面的操作</span>
<span class="token comment"># ActionChains(打开的浏览器对象，driver).move_to_element(悬停的元素).perform()</span>
ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">.</span>move_to_element<span class="token punctuation">(</span>st_button<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="5_198"></a>5、键盘事件</h4> 
<ul><li>send_keys(Keys.BACK_SPACE) 删除键（BackSpace）</li><li>send_keys(Keys.SPACE) 空格键(Space)</li><li>send_keys(Keys.TAB) 制表键(Tab)</li><li>send_keys(Keys.ESCAPE) 回退键（Esc）</li><li>send_keys(Keys.ENTER) 回车键（Enter）</li><li>send_keys(Keys.CONTROL,’a’) 全选（Ctrl+A）</li><li>send_keys(Keys.CONTROL,’c’) 复制（Ctrl+C）</li><li>send_keys(Keys.CONTROL,’x’) 剪切（Ctrl+X）</li><li>send_keys(Keys.CONTROL,’v’) 粘贴（Ctrl+V）</li><li>send_keys(Keys.F1) 键盘 F1</li><li>……</li><li>send_keys(Keys.F12) 键盘 F12</li></ul> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token comment"># Keys类才能调用键盘</span>
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys
<span class="token keyword">import</span> time
<span class="token comment"># 打开浏览器</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment"># 打开网页</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">)</span>
<span class="token comment"># 定位输入框</span>
serach_box <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'kw'</span><span class="token punctuation">)</span>
<span class="token comment"># 输入内容</span>
serach_box<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"seleniummABC"</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># 删除多余的m   调用的删除键</span>
<span class="token comment"># Keys.BACK_SPACE只能删除一个字母，要删除多个字母，则需要乘积</span>
serach_box<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span>Keys<span class="token punctuation">.</span>BACK_SPACE<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="6_232"></a>6、多窗口切换</h4> 
<p>浏览器打开的窗口其实会有一个叫句柄的概念。句柄就类似于每一个标签页的id一样，是唯一的</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys
<span class="token keyword">import</span> time
<span class="token comment"># 打开浏览器</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 隐式等待</span>
driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment"># 打开网页</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">)</span>
<span class="token comment"># 搜索</span>
obj <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'kw'</span><span class="token punctuation">)</span>
obj<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"马蓉"</span><span class="token punctuation">)</span>
<span class="token comment"># 回车</span>
obj<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>ENTER<span class="token punctuation">)</span>
<span class="token comment"># 点击 马蓉百度百科</span>
driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//div[@id="content_left"]/div[1]//h3/a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 强制等待</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># 获取当前浏览器的所有窗口的句柄,获取回来的窗口句柄放在了一个列表中</span>
headles <span class="token operator">=</span> driver<span class="token punctuation">.</span>window_handles
<span class="token keyword">print</span><span class="token punctuation">(</span>headles<span class="token punctuation">)</span>
<span class="token comment"># 根据下标进行句柄切换，获取回来的时候，窗口的句柄是一个列表，列表下标为-1的元素则是最新打开的窗口句柄，下标为0的是第一个</span>
driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>window<span class="token punctuation">(</span>headles<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 点击 编辑 按钮</span>
driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//dd[@data-pid="0"]/a[2]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="7_262"></a>7、表单切换</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">import</span> time
<span class="token comment"># 打开浏览器</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 隐式等待</span>
driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment"># 打开网页</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://mail.163.com/"</span><span class="token punctuation">)</span>
<span class="token comment"># iframe表单切换</span>
<span class="token triple-quoted-string string">'''
switch_to.frame() 中默认可以写 该iframe标签的id和name属性的值，但是id和name要唯一
还可以通过其他的定位方式，定位到该iframe标签，然后将定位到iframe标签对象传入给switch_to.frame()
'''</span>
<span class="token comment"># 通过xpath的方式定位iframe标签</span>
iframe_element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//div[@id="loginDiv"]/iframe'</span><span class="token punctuation">)</span>
<span class="token comment"># 切换</span>
driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>frame<span class="token punctuation">(</span>iframe_element<span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># 定位邮箱输入框            </span>
driver<span class="token punctuation">.</span>find_element_by_css_selector<span class="token punctuation">(</span><span class="token string">'input[name="email"]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">)</span>
<span class="token comment"># 密码</span>
driver<span class="token punctuation">.</span>find_element_by_css_selector<span class="token punctuation">(</span><span class="token string">'input[name="password"]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">)</span>
<span class="token comment"># 选择框勾选</span>
driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"un-login"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 点击 登录 按钮</span>
driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'dologin'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 由于上面登录的时候邮箱和密码，是在内存子页面中，所以通过iframe已经切换进去了，而 vip 又在最外层页面，所以要切换到最外层</span>
driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>default_content<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 点击 vip</span>
driver<span class="token punctuation">.</span>find_element_by_css_selector<span class="token punctuation">(</span><span class="token string">'a[href="https://vipmail.163.com/?from=fmail"]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="8_297"></a>8、弹框处理</h4> 
<ul><li>点击确定：driver.switch_to.alert.accept()</li><li>点击取消：driver.switch_to.alert.dismiss()</li><li>弹框中输入文本：driver.switch_to.alert.send_keys()</li><li>获取弹框中的文本内容：driver.switch_to.alert.text</li></ul> 
<h4><a id="9_303"></a>9、下拉框处理</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> Select

<span class="token comment"># 打开浏览器</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 浏览器最大化</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 隐式等待</span>
driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment"># 打开网页</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"file:///D:/Pycharm/study/UI自动化/new_file.html"</span><span class="token punctuation">)</span>
<span class="token comment"># 先进行类的实例化，传入下拉选择框的对象</span>
select_obj <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_name<span class="token punctuation">(</span><span class="token string">'myselect'</span><span class="token punctuation">)</span>
s1 <span class="token operator">=</span> Select<span class="token punctuation">(</span>select_obj<span class="token punctuation">)</span>
<span class="token comment"># 选择具体的选项：有三种方式</span>
<span class="token comment"># 方式一：通过索引选择：索引是从0开始的 每一个option都有索引</span>
s1<span class="token punctuation">.</span>select_by_index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># 方式二：通过value属性的值</span>
<span class="token comment"># s1.select_by_value('o4')</span>
<span class="token comment"># 方式三：通过文本选择</span>
<span class="token comment"># s1.select_by_visible_text("搜狗搜索")</span>
</code></pre> 
<h4><a id="10_328"></a>10、文件上传</h4> 
<ul><li>使用 send_keys 方法上传文件：使用 send_keys 方法可以模拟用户通过输入框选择文件上传的操作。具体代码如下：</li></ul> 
<pre><code class="prism language-python"><span class="token comment"># 定位文件上传输入框</span>
file_input <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">"//input[@type='file']"</span><span class="token punctuation">)</span>

<span class="token comment"># 发送文件路径到文件上传输入框</span>
file_input<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"C:/path/to/your/file"</span><span class="token punctuation">)</span>

</code></pre> 
<ul><li>使用 AutoIT 工具上传文件：AutoIT 是一个针对 Windows操作系统的脚本语言，可以使用它来实现上传文件操作。具体步骤如下：<br> 下载安装 AutoIT 工具，并编写上传文件脚本。<br> 在 Python 中通过 subprocess 模块调用 AutoIT 脚本，实现上传文件操作。</li></ul> 
<p>AutoIT 脚本示例（上传一个名为 “file.txt” 的文件）：</p> 
<pre><code class="prism language-python">WinWaitActive<span class="token punctuation">(</span><span class="token string">"打开"</span><span class="token punctuation">)</span>
Send<span class="token punctuation">(</span><span class="token string">"C:\path\to\your\file\file.txt"</span><span class="token punctuation">)</span>
Send<span class="token punctuation">(</span><span class="token string">"{ENTER}"</span><span class="token punctuation">)</span>

</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">import</span> subprocess

<span class="token comment"># 调用 AutoIT 脚本上传文件</span>
subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token string">"upload_file.exe"</span><span class="token punctuation">)</span>

</code></pre> 
<h3><a id="_362"></a>四、断言信息</h3> 
<p>断言是一种非常重要的验证方法，通常用于检查测试结果是否符合预期。通过断言，可以将测试用例的预期结果和实际结果进行比较，并在测试失败时立即报告错误，以便快速定位问题和修复缺陷。</p> 
<h4><a id="1_364"></a>1、通过文本信息</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys
<span class="token keyword">import</span> time
<span class="token comment"># 打开浏览器</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment"># 打开网页</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">)</span>
<span class="token comment"># 定位搜索框</span>
serach_box <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'kw'</span><span class="token punctuation">)</span>
<span class="token comment"># 输入内容</span>
serach_box<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"python"</span><span class="token punctuation">)</span>
<span class="token comment"># 调用回车键</span>
serach_box<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>ENTER<span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># 回去搜索出来的第一页的所有内容标题</span>
<span class="token comment"># find_elements_by_xpath 如果定位元素的方法显示的是elements,多个元素存在一个列表中</span>
titles <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_elements_by_xpath<span class="token punctuation">(</span><span class="token string">'//div[@id="content_left"]//h3'</span><span class="token punctuation">)</span>
<span class="token comment"># 由于获取的结果是一个列表，要获取内容，则必须遍历列表，一个一个获取</span>
<span class="token keyword">for</span> t <span class="token keyword">in</span> titles<span class="token punctuation">:</span>
    <span class="token comment"># 获取文本信息</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="2title_391"></a>2、根据title信息做断言</h4> 
<pre><code class="prism language-python"><span class="token comment"># 获取网页标题  python_百度搜索</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span>driver<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="3url_397"></a>3、根据url判断</h4> 
<pre><code class="prism language-python"><span class="token comment"># 获取当前网页的url</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span>driver<span class="token punctuation">.</span>current_url<span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/add1843c0888dfd9d3273cd2ab246c9c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">NFS（网络文件系统）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dae5724d63ce2c42f8a3a60d96dc1c93/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">uni-app之Cover-View组件详细使用教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>