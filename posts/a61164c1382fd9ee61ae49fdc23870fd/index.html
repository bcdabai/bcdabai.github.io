<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【头歌】大数据从入门到实战 - 第2章 分布式文件系统HDFS - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【头歌】大数据从入门到实战 - 第2章 分布式文件系统HDFS" />
<meta property="og:description" content="第1关：HDFS的基本操作 任务描述 本关任务：使用 Hadoop 命令来操作分布式文件系统。
编程要求 在右侧命令行中启动 Hadoop ，进行如下操作。
在 HDFS 中创建 /usr/output/ 文件夹；在本地创建 hello.txt 文件并添加内容：“ HDFS 的块比磁盘的块大，其目的是为了最小化寻址开销。”；将 hello.txt 上传至 HDFS 的 /usr/output/ 目录下；删除 HDFS 的 /user/hadoop 目录；将 Hadoop 上的文件 hello.txt 从 HDFS 复制到本地 /usr/local 目录。 测试说明 平台会查看你本地的文件和 HDFS 的文件是否存在，如果存在，则会将其内容输出到控制台。
预期输出： HDFS的块比磁盘的块大，其目的是为了最小化寻址开销。 HDFS的块比磁盘的块大，其目的是为了最小化寻址开销。 代码如下 start-dfs.sh hadoop fs -mkdir /usr hadoop fs -mkdir /usr/output vim hello.txt hadoop fs -put hello.txt /usr/output hadoop fs -rm -r /user/hadoop hadoop fs -copyToLocal /usr/output/hello.txt /usr/local 第2关：HDFS-JAVA接口之读取文件 任务描述 本关任务：使用 HDFS 的 Java 接口进行文件的读写，文件 uri 地址为 hdfs://localhost:9000/user/hadoop/task." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a61164c1382fd9ee61ae49fdc23870fd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-21T11:57:49+08:00" />
<meta property="article:modified_time" content="2023-04-21T11:57:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【头歌】大数据从入门到实战 - 第2章 分布式文件系统HDFS</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="1HDFS_0"></a>第1关：HDFS的基本操作</h3> 
<h4><a id="_2"></a>任务描述</h4> 
<p>本关任务：使用 <code>Hadoop</code> 命令来操作分布式文件系统。</p> 
<h4><a id="_6"></a>编程要求</h4> 
<p>在右侧命令行中启动 <code>Hadoop</code> ，进行如下操作。</p> 
<ul><li>在 <code>HDFS</code> 中创建 <code>/usr/output/</code> 文件夹；</li><li>在本地创建 <code>hello.txt</code> 文件并添加内容：“ <code>HDFS</code> 的块比磁盘的块大，其目的是为了最小化寻址开销。”；</li><li>将 <code>hello.txt</code> 上传至 <code>HDFS</code> 的 <code>/usr/output/</code> 目录下；</li><li>删除 <code>HDFS</code> 的 <code>/user/hadoop</code> 目录；</li><li>将 <code>Hadoop</code> 上的文件 <code>hello.txt</code> 从 <code>HDFS</code> 复制到本地 <code>/usr/local</code> 目录。</li></ul> 
<h4><a id="_15"></a>测试说明</h4> 
<p>平台会查看你本地的文件和 <code>HDFS</code> 的文件是否存在，如果存在，则会将其内容输出到控制台。</p> 
<h4><a id="_18"></a>预期输出：</h4> 
<pre><code>HDFS的块比磁盘的块大，其目的是为了最小化寻址开销。

HDFS的块比磁盘的块大，其目的是为了最小化寻址开销。
</code></pre> 
<h4><a id="_25"></a>代码如下</h4> 
<pre><code>start-dfs.sh
hadoop fs -mkdir /usr
hadoop fs -mkdir /usr/output
vim hello.txt
hadoop fs -put hello.txt /usr/output
hadoop fs -rm -r /user/hadoop
hadoop fs -copyToLocal /usr/output/hello.txt /usr/local
</code></pre> 
<h3><a id="2HDFSJAVA_38"></a>第2关：HDFS-JAVA接口之读取文件</h3> 
<h4><a id="_40"></a>任务描述</h4> 
<p>本关任务：使用 <code>HDFS</code> 的 <code>Java</code> 接口进行文件的读写，文件 <code>uri</code> 地址为 <code>hdfs://localhost:9000/user/hadoop/task.txt</code> 。</p> 
<h4><a id="_44"></a>编程要求</h4> 
<p>在右侧代码编辑区中编写代码实现如下功能：</p> 
<ul><li>使用 <code>FSDataInputStream</code> 获取 <code>HDFS</code> 的 <code>/user/hadoop/</code> 目录下的 <code>task.txt</code> 的文件内容，并输出，其中 <code>uri</code> 为 <code>hdfs://localhost:9000/user/hadoop/task.txt</code> 。</li></ul> 
<h4><a id="_49"></a>测试说明</h4> 
<p>点击评测，平台会通过脚本创建 <code>/user/hadoop/task.txt</code> 文件并添加相应内容，无需你自己创建，开启 <code>hadoop</code> ，编写代码点击评测即可。因为 <code>Hadoop</code> 环境非常消耗资源，所以你如果一段时间不在线，后台会销毁你的镜像，之前的数据会丢失（你的代码不会丢失），这个时候需要你重新启动 <code>Hadoop</code> 。</p> 
<h4><a id="_52"></a>预期输出：</h4> 
<pre><code> WARN [main] - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable 怕什么真理无穷，进一寸有一寸的欢喜。
</code></pre> 
<blockquote> 
 <p>第一行打印出来的是 <code>log4j</code> 的日志警告，可以忽略。</p> 
</blockquote> 
<h4><a id="_60"></a>代码如下</h4> 
<pre><code>//先再命令行输入如下代码，然后再去代码文件粘贴java代码
start-dfs.sh
vim test.txt
i
//按i进入修改模式后，把下列中文粘贴进去  ctl+shift+v
独坐池塘如虎踞，绿荫树下养精神。

春来我不先开口，哪个虫儿敢作声。
//按Esc键推出修改模式
Esc
//输入:wq推出命令行模式
:wq
</code></pre> 
<pre><code>package step2;

import java.io.IOException;
import java.io.InputStream;
import java.net.URI;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.IOUtils;


public class FileSystemCat {
	
	public static void main(String[] args) throws IOException {
		//请在Begin-End之间添加你的代码，完成任务要求。
        //请按照左侧的编程要求进行编写代码
		//文件地址为 "hdfs://localhost:9000/user/hadoop/task.txt"
        /********* Begin *********/
		URI uri = URI.create("hdfs://localhost:9000/user/hadoop/task.txt");
        Configuration config = new Configuration();
        FileSystem fs = FileSystem.get(uri,config);
        InputStream in = null;
        try{
            in = fs.open(new Path(uri));
            IOUtils.copyBytes(in, System.out,2048,false);
        }catch (Exception e){
            IOUtils.closeStream(in);
        }
		/********* End *********/
	}
}

</code></pre> 
<h3><a id="3HDFSJAVA_117"></a>第3关：HDFS-JAVA接口之上传文件</h3> 
<h4><a id="_119"></a>任务描述</h4> 
<p>本关任务：使用 <code>HDFSAPI</code> 上传文件至集群。</p> 
<h4><a id="_123"></a>编程要求</h4> 
<p>在右侧代码编辑区和命令行中，编写代码与脚本实现如下功能：</p> 
<ul><li> <p>在 <code>/develop/input/</code> 目录下创建 <code>hello.txt</code> 文件，并输入如下数据： 迢迢牵牛星，皎皎河汉女。 纤纤擢素手，札札弄机杼。 终日不成章，泣涕零如雨。 河汉清且浅，相去复几许？ 盈盈一水间，脉脉不得语。 《迢迢牵牛星》</p> </li><li> <p>使用 <code>FSDataOutputStream</code> 对象将文件上传至 <code>HDFS</code> 的 <code>/user/tmp/</code> 目录下，并打印进度。</p> </li></ul> 
<h4><a id="_131"></a>测试说明</h4> 
<p>平台会运行你的 <code>java</code> 程序，并查看集群的文件将文件信息输出到控制台，第一行属于警告信息可以忽略。</p> 
<h4><a id="_135"></a>代码如下</h4> 
<pre><code>//先再命令行输入如下代码，然后再去代码文件粘贴java代码
start-dfs.sh
mkdir -p /develop/input
cd /develop/input
vim hello.txt
i
//输入i进入修改模式后把下面诗句粘贴进去 ctl+shift+v
迢迢牵牛星，皎皎河汉女。
纤纤擢素手，札札弄机杼。
终日不成章，泣涕零如雨。
河汉清且浅，相去复几许？
盈盈一水间，脉脉不得语。
《迢迢牵牛星》
//按Esc键退出修改模式
Esc
//输入:wq退出命令行模式
:wq  
</code></pre> 
<pre><code>package step3;


import java.io.BufferedInputStream;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStream;
import java.net.URI;
import java.io.File;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.FSDataOutputStream;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.IOUtils;
import org.apache.hadoop.util.Progressable;


public class FileSystemUpload {
	
	public static void main(String[] args) throws IOException {
		//请在 Begin-End 之间添加代码，完成任务要求。
        /********* Begin *********/
		File localPath = new File("/develop/input/hello.txt");
        String hdfsPath = "hdfs://localhost:9000/user/tmp/hello.txt";
        InputStream in = new BufferedInputStream(new FileInputStream(localPath));
        Configuration config = new Configuration();
        FileSystem fs = FileSystem.get(URI.create(hdfsPath), config);
        long fileSize = localPath.length() &gt; 65536 ? localPath.length() / 65536 : 1; 
        FSDataOutputStream out = fs.create(new Path(hdfsPath), new Progressable() {
            long fileCount = 0;
            public void progress() {
                System.out.println("总进度" + (fileCount / fileSize) * 100 + "%");
                fileCount++;
            }
        });
        IOUtils.copyBytes(in, out, 2048, true);
		
		/********* End *********/
	}
}

</code></pre> 
<h3><a id="4HDFSJAVA_204"></a>第4关：HDFS-JAVA接口之删除文件</h3> 
<h4><a id="_206"></a>任务描述</h4> 
<p>本关任务：删除 <code>HDFS</code> 中的文件和文件夹。</p> 
<h4><a id="_210"></a>编程要求</h4> 
<p>在右侧代码区填充代码，实现如下功能：</p> 
<ul><li>删除 <code>HDFS</code> 的 <code>/user/hadoop/</code> 目录（空目录）；</li><li>删除 <code>HDFS</code> 的 <code>/tmp/test/</code> 目录（非空目录）；</li><li>列出 <code>HDFS</code> 根目录下所有的文件和文件夹；</li><li>列出 <code>HDFS</code> 下 <code>/tmp/</code> 的所有文件和文件夹。</li></ul> 
<h4><a id="_218"></a>测试说明</h4> 
<p><code>HDFS</code> 的文件夹在你点击评测是会通过脚本自动创建，不需要你自己创建哦，依照题意编写代码点击评测即可。</p> 
<h4><a id="_223"></a>代码如下</h4> 
<pre><code>//先再命令行输入如下代码，然后再去代码文件粘贴java代码
start-dfs.sh
</code></pre> 
<pre><code>package step4;


import java.io.IOException;
import java.net.URI;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.FileStatus;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.FileUtil;
import org.apache.hadoop.fs.Path;



public class FileSystemDelete {
	
	public static void main(String[] args) throws IOException {
		//请在 Begin-End 之间添加代码，完成本关任务。
        /********* Begin *********/
		
		String root = "hdfs://localhost:9000/";
        String path = "hdfs://localhost:9000/tmp";
        String del1 = "hdfs://localhost:9000/user/hadoop";
        String del2 = "hdfs://localhost:9000/tmp/test";
        Configuration config = new Configuration();
        FileSystem fs = FileSystem.get(URI.create(root),config);
        fs.delete(new Path(del1),true);
        fs.delete(new Path(del2),true);
        Path[] paths = {new Path(root),new Path(path)};
        FileStatus[] status = fs.listStatus(paths);
        Path[] listPaths = FileUtil.stat2Paths(status);
 
        for (Path path1 : listPaths){
  System.out.println(path1);
        }

		
		
		/********* End *********/
	}
}

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c9af4d305bd4e8ec500b16c9011b6c31/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">命令行隐藏文件夹</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7ceb2d5dcc3d8a55661b1cc290c36e5e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【头歌】MongoDB 数据库基本操作</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>