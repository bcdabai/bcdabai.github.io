<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>腾讯云 Finops Crane 集训营 &amp; 知识基础普及 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="腾讯云 Finops Crane 集训营 &amp; 知识基础普及" />
<meta property="og:description" content="目录
一、云上资源效能挑战
云上资源浪费现状
云原生时代的成本管理挑战
成本优化思路与常用手段
​编辑FinOps概念
成本构成
节点成本
工作负载成本
资源利用率优化模型
横向伸缩和纵向伸缩
kubernetes原生能力的不足​编辑
二、云原生场景下的成本优化挑战
成本分析
场景一：成本可视化
场景二：规格推荐
场景三：智能预测与自动扩缩容
三、Crane智能调度助力成本优化
负载感知调度
拓扑感知调度
支持模拟调度的重调度器
混部内核确保高优业务稳定性 Crane 项目介绍
内部大规模落地的成效
外部优化成效
软件清单
一、云上资源效能挑战 云上资源浪费现状 Flexera 2022云计算市场发展状态报告：32%的云支出被浪费
云原生时代的成本管理挑战 去中心化 随着kubernetes为核心的云原生应用的蓬勃发展，传统的集中式财务预算和IT管理模式在向以业务为导向的分布式决策转型不断上涨 CNCF调查显示，随着业务的快速发展，企业的云费用以24%的年增长快速增加动态变化 与原生的动态环境和弹性能力导致云费用随业务负载不断变化浪费严重 业务上云以后缺乏资源优化意识，依然以传统资源配置思维管理资源，浪费严重 由于存在此类问题所以得出FinOps概念来解决此类问题
成本优化思路与常用手段 成本优化思路 最大化资源利用率限制资源清理厂商折扣以单位经济学驱动成本优化费率优化 统一采购，销售费率折扣预留实例，包年包月，享受承诺使用费率折扣自动扩缩容，按需付费竞价实例，牺牲SLA使用廉价闲置资源用量优化 业务侧 规格优化实时、自动扩缩容平台侧 利用率优化 调度优化提升混部闲置资源识别与清理 闲置节点降配非活跃存储降配、清理非活跃CLB，EIP网络资源清理 FinOps概念 FinOps是一种将财务管理(Finance)与云操作(Ops)相结合的模式，旨在优化云计算支出并提高业务绩效。
云计算是一种流量密集型的技术，意味着云成本管理在很大程度上取决于如何优化云资源消耗，并根据需要提高或降低开支。FinOps通过建立流程、原则和工具来实现这一目标，可以帮助企业更好地理解和控制云成本，同时保持效率和创新。
FinOps的关键原则是建，立透明度并将云成本降低到最小水平。为了实现这一点，需要结合使用财务、技术和业务信息，以确定最佳的资源使用方式。同时，需要确定哪些资源实际上为贡献产生了价值，并分配成本以实现真正的透明度和可控性。
总之，FinOps作为一种模式结合了财务和技术的因素，可以帮助企业实现优化云支出和提高业务绩效的目标。
FinOps定义了一系列云财务管理规则和最佳实践，通过助力工程和财务团队、技术和业务团队彼此合作，进行数据驱动的成本决策，使组织能够获得最大收益。
成本构成 节点成本 CPU成本=CPU单价*节点CPU核数*节点使用时长内存成本=内存单价*节点内存内容*节点使用时长其他，如GPU卡成本，储存成本节点成本=CPU成本&#43;内存成本&#43;其他 工作负载成本 工作负载通常按资源分配量或使用量独立计价 分配成本=分配量*使用时长*单价使用时间=使用量*使用时长*单价工作负载需要分摊的成本 限制成本=闲置资源量*闲置时长*单价公开开销成本=集群管理组件公共服务的资源成本 资源利用率优化模型 横向伸缩和纵向伸缩 应用扩容市值在应用接收到的并发请求已经处于其处理请求极限便捷的情形下，扩展处理能力而确保应用高可用的技术手段 horizontal scaling 所谓横向伸缩市值听过增加实用案例数量分担负载的方式来提升应用整体处理能力的方式 vertical scaling 所谓纵向伸缩是指通过增加单个应用实例资源以提升单个实例处理能力，进而提升应用整体处理能力的方法 kubernetes原生能力的不足 开源地址 https://github." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/330b1778dc96995e821d76ac8f521bc5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-31T01:34:08+08:00" />
<meta property="article:modified_time" content="2023-05-31T01:34:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">腾讯云 Finops Crane 集训营 &amp; 知识基础普及</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%E4%BA%91%E4%B8%8A%E8%B5%84%E6%BA%90%E6%95%88%E8%83%BD%E6%8C%91%E6%88%98-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E4%BA%91%E4%B8%8A%E8%B5%84%E6%BA%90%E6%95%88%E8%83%BD%E6%8C%91%E6%88%98" rel="nofollow">一、云上资源效能挑战</a></p> 
<p id="%E4%BA%91%E4%B8%8A%E8%B5%84%E6%BA%90%E6%B5%AA%E8%B4%B9%E7%8E%B0%E7%8A%B6-toc" style="margin-left:40px;"><a href="#%E4%BA%91%E4%B8%8A%E8%B5%84%E6%BA%90%E6%B5%AA%E8%B4%B9%E7%8E%B0%E7%8A%B6" rel="nofollow">云上资源浪费现状</a></p> 
<p id="%E4%BA%91%E5%8E%9F%E7%94%9F%E6%97%B6%E4%BB%A3%E7%9A%84%E6%88%90%E6%9C%AC%E7%AE%A1%E7%90%86%E6%8C%91%E6%88%98-toc" style="margin-left:40px;"><a href="#%E4%BA%91%E5%8E%9F%E7%94%9F%E6%97%B6%E4%BB%A3%E7%9A%84%E6%88%90%E6%9C%AC%E7%AE%A1%E7%90%86%E6%8C%91%E6%88%98" rel="nofollow">云原生时代的成本管理挑战</a></p> 
<p id="%E6%88%90%E6%9C%AC%E4%BC%98%E5%8C%96%E6%80%9D%E8%B7%AF%E4%B8%8E%E5%B8%B8%E7%94%A8%E6%89%8B%E6%AE%B5-toc" style="margin-left:40px;"><a href="#%E6%88%90%E6%9C%AC%E4%BC%98%E5%8C%96%E6%80%9D%E8%B7%AF%E4%B8%8E%E5%B8%B8%E7%94%A8%E6%89%8B%E6%AE%B5" rel="nofollow">成本优化思路与常用手段</a></p> 
<p id="%E2%80%8B%E7%BC%96%E8%BE%91%E2%80%8B%E7%BC%96%E8%BE%91%E2%80%8B%E7%BC%96%E8%BE%91FinOps%E6%A6%82%E5%BF%B5-toc" style="margin-left:40px;"><a href="#%E2%80%8B%E7%BC%96%E8%BE%91%E2%80%8B%E7%BC%96%E8%BE%91%E2%80%8B%E7%BC%96%E8%BE%91FinOps%E6%A6%82%E5%BF%B5" rel="nofollow">​编辑FinOps概念</a></p> 
<p id="%C2%A0%E6%88%90%E6%9C%AC%E6%9E%84%E6%88%90-toc" style="margin-left:40px;"><a href="#%C2%A0%E6%88%90%E6%9C%AC%E6%9E%84%E6%88%90" rel="nofollow"> 成本构成</a></p> 
<p id="%E8%8A%82%E7%82%B9%E6%88%90%E6%9C%AC-toc" style="margin-left:80px;"><a href="#%E8%8A%82%E7%82%B9%E6%88%90%E6%9C%AC" rel="nofollow">节点成本</a></p> 
<p id="%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD%E6%88%90%E6%9C%AC-toc" style="margin-left:80px;"><a href="#%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD%E6%88%90%E6%9C%AC" rel="nofollow">工作负载成本</a></p> 
<p id="%E8%B5%84%E6%BA%90%E5%88%A9%E7%94%A8%E7%8E%87%E4%BC%98%E5%8C%96%E6%A8%A1%E5%9E%8B-toc" style="margin-left:40px;"><a href="#%E8%B5%84%E6%BA%90%E5%88%A9%E7%94%A8%E7%8E%87%E4%BC%98%E5%8C%96%E6%A8%A1%E5%9E%8B" rel="nofollow">资源利用率优化模型</a></p> 
<p id="%E6%A8%AA%E5%90%91%E4%BC%B8%E7%BC%A9%E5%92%8C%E7%BA%B5%E5%90%91%E4%BC%B8%E7%BC%A9-toc" style="margin-left:40px;"><a href="#%E6%A8%AA%E5%90%91%E4%BC%B8%E7%BC%A9%E5%92%8C%E7%BA%B5%E5%90%91%E4%BC%B8%E7%BC%A9" rel="nofollow">横向伸缩和纵向伸缩</a></p> 
<p id="%C2%A0kubernetes%E5%8E%9F%E7%94%9F%E8%83%BD%E5%8A%9B%E7%9A%84%E4%B8%8D%E8%B6%B3%E2%80%8B%E7%BC%96%E8%BE%91-toc" style="margin-left:40px;"><a href="#%C2%A0kubernetes%E5%8E%9F%E7%94%9F%E8%83%BD%E5%8A%9B%E7%9A%84%E4%B8%8D%E8%B6%B3%E2%80%8B%E7%BC%96%E8%BE%91" rel="nofollow"> kubernetes原生能力的不足​编辑</a></p> 
<p id="%E4%BA%8C%E3%80%81%E4%BA%91%E5%8E%9F%E7%94%9F%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84%E6%88%90%E6%9C%AC%E4%BC%98%E5%8C%96%E6%8C%91%E6%88%98-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E4%BA%91%E5%8E%9F%E7%94%9F%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84%E6%88%90%E6%9C%AC%E4%BC%98%E5%8C%96%E6%8C%91%E6%88%98" rel="nofollow">二、云原生场景下的成本优化挑战</a></p> 
<p id="%E6%88%90%E6%9C%AC%E5%88%86%E6%9E%90-toc" style="margin-left:40px;"><a href="#%E6%88%90%E6%9C%AC%E5%88%86%E6%9E%90" rel="nofollow">成本分析</a></p> 
<p id="%E5%9C%BA%E6%99%AF%E4%B8%80%EF%BC%9A%E6%88%90%E6%9C%AC%E5%8F%AF%E8%A7%86%E5%8C%96-toc" style="margin-left:40px;"><a href="#%E5%9C%BA%E6%99%AF%E4%B8%80%EF%BC%9A%E6%88%90%E6%9C%AC%E5%8F%AF%E8%A7%86%E5%8C%96" rel="nofollow">场景一：成本可视化</a></p> 
<p id="%E5%9C%BA%E6%99%AF%E4%BA%8C%EF%BC%9A%E8%A7%84%E6%A0%BC%E6%8E%A8%E8%8D%90-toc" style="margin-left:40px;"><a href="#%E5%9C%BA%E6%99%AF%E4%BA%8C%EF%BC%9A%E8%A7%84%E6%A0%BC%E6%8E%A8%E8%8D%90" rel="nofollow">场景二：规格推荐</a></p> 
<p id="%E5%9C%BA%E6%99%AF%E4%B8%89%EF%BC%9A%E6%99%BA%E8%83%BD%E9%A2%84%E6%B5%8B%E4%B8%8E%E8%87%AA%E5%8A%A8%E6%89%A9%E7%BC%A9%E5%AE%B9-toc" style="margin-left:40px;"><a href="#%E5%9C%BA%E6%99%AF%E4%B8%89%EF%BC%9A%E6%99%BA%E8%83%BD%E9%A2%84%E6%B5%8B%E4%B8%8E%E8%87%AA%E5%8A%A8%E6%89%A9%E7%BC%A9%E5%AE%B9" rel="nofollow">场景三：智能预测与自动扩缩容</a></p> 
<p id="%E4%B8%89%E3%80%81Crane%E6%99%BA%E8%83%BD%E8%B0%83%E5%BA%A6%E5%8A%A9%E5%8A%9B%E6%88%90%E6%9C%AC%E4%BC%98%E5%8C%96-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81Crane%E6%99%BA%E8%83%BD%E8%B0%83%E5%BA%A6%E5%8A%A9%E5%8A%9B%E6%88%90%E6%9C%AC%E4%BC%98%E5%8C%96" rel="nofollow">三、Crane智能调度助力成本优化</a></p> 
<p id="%E8%B4%9F%E8%BD%BD%E6%84%9F%E7%9F%A5%E8%B0%83%E5%BA%A6-toc" style="margin-left:40px;"><a href="#%E8%B4%9F%E8%BD%BD%E6%84%9F%E7%9F%A5%E8%B0%83%E5%BA%A6" rel="nofollow">负载感知调度</a></p> 
<p id="%E6%8B%93%E6%89%91%E6%84%9F%E7%9F%A5%E8%B0%83%E5%BA%A6-toc" style="margin-left:40px;"><a href="#%E6%8B%93%E6%89%91%E6%84%9F%E7%9F%A5%E8%B0%83%E5%BA%A6" rel="nofollow">拓扑感知调度</a></p> 
<p id="%E6%94%AF%E6%8C%81%E6%A8%A1%E6%8B%9F%E8%B0%83%E5%BA%A6%E7%9A%84%E9%87%8D%E8%B0%83%E5%BA%A6%E5%99%A8-toc" style="margin-left:40px;"><a href="#%E6%94%AF%E6%8C%81%E6%A8%A1%E6%8B%9F%E8%B0%83%E5%BA%A6%E7%9A%84%E9%87%8D%E8%B0%83%E5%BA%A6%E5%99%A8" rel="nofollow">支持模拟调度的重调度器</a></p> 
<p id="%E6%B7%B7%E9%83%A8%E5%86%85%E6%A0%B8%E7%A1%AE%E4%BF%9D%E9%AB%98%E4%BC%98%E4%B8%9A%E5%8A%A1%E7%A8%B3%E5%AE%9A%E6%80%A7%C2%A0-toc" style="margin-left:40px;"><a href="#%E6%B7%B7%E9%83%A8%E5%86%85%E6%A0%B8%E7%A1%AE%E4%BF%9D%E9%AB%98%E4%BC%98%E4%B8%9A%E5%8A%A1%E7%A8%B3%E5%AE%9A%E6%80%A7%C2%A0" rel="nofollow">混部内核确保高优业务稳定性 </a></p> 
<p id="Crane%20%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D-toc" style="margin-left:40px;"><a href="#Crane%20%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D" rel="nofollow">Crane 项目介绍</a></p> 
<p id="%E5%86%85%E9%83%A8%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%90%BD%E5%9C%B0%E7%9A%84%E6%88%90%E6%95%88-toc" style="margin-left:80px;"><a href="#%E5%86%85%E9%83%A8%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%90%BD%E5%9C%B0%E7%9A%84%E6%88%90%E6%95%88" rel="nofollow">内部大规模落地的成效</a></p> 
<p id="%E5%A4%96%E9%83%A8%E4%BC%98%E5%8C%96%E6%88%90%E6%95%88-toc" style="margin-left:80px;"><a href="#%E5%A4%96%E9%83%A8%E4%BC%98%E5%8C%96%E6%88%90%E6%95%88" rel="nofollow">外部优化成效</a></p> 
<p id="%E8%BD%AF%E4%BB%B6%E6%B8%85%E5%8D%95-toc" style="margin-left:40px;"><a href="#%E8%BD%AF%E4%BB%B6%E6%B8%85%E5%8D%95" rel="nofollow">软件清单</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p></p> 
<p></p> 
<h2 id="%E4%B8%80%E3%80%81%E4%BA%91%E4%B8%8A%E8%B5%84%E6%BA%90%E6%95%88%E8%83%BD%E6%8C%91%E6%88%98">一、云上资源效能挑战</h2> 
<h3 id="%E4%BA%91%E4%B8%8A%E8%B5%84%E6%BA%90%E6%B5%AA%E8%B4%B9%E7%8E%B0%E7%8A%B6">云上资源浪费现状</h3> 
<p>Flexera 2022云计算市场发展状态报告：<strong>32%</strong>的云支出被浪费</p> 
<h3 id="%E4%BA%91%E5%8E%9F%E7%94%9F%E6%97%B6%E4%BB%A3%E7%9A%84%E6%88%90%E6%9C%AC%E7%AE%A1%E7%90%86%E6%8C%91%E6%88%98">云原生时代的成本管理挑战</h3> 
<ul><li><strong>去中心化</strong>          
  <ul><li>   随着<strong>kubernetes</strong>为核心的云原生应用的蓬勃发展，传统的集中式财务预算和IT管理模式在向以业务为导向的分布式决策转型</li></ul></li><li><strong>不断上涨  </strong> 
  <ul><li><strong>CNCF</strong>调查显示，随着业务的快速发展，企业的云费用以24%的年增长快速增加</li></ul></li><li><strong>动态变化  </strong> 
  <ul><li>与原生的动态环境和弹性能力导致云费用随业务负载不断变化</li></ul></li><li><strong>浪费严重</strong> 
  <ul><li>业务上云以后缺乏资源优化意识，依然以传统资源配置思维管理资源，浪费严重</li></ul></li></ul> 
<p>由于存在此类问题所以得出FinOps概念来解决此类问题</p> 
<h3 id="%E6%88%90%E6%9C%AC%E4%BC%98%E5%8C%96%E6%80%9D%E8%B7%AF%E4%B8%8E%E5%B8%B8%E7%94%A8%E6%89%8B%E6%AE%B5">成本优化思路与常用手段</h3> 
<ul><li>成本优化思路 
  <ul><li>最大化资源利用率</li><li>限制资源清理</li><li>厂商折扣</li><li>以单位经济学驱动成本优化</li></ul></li><li>费率优化 
  <ul><li>统一采购，销售费率折扣</li><li>预留实例，包年包月，享受承诺使用费率折扣</li><li>自动扩缩容，按需付费</li><li>竞价实例，牺牲SLA使用廉价闲置资源</li></ul></li><li>用量优化 
  <ul><li>业务侧 
    <ul><li>规格优化</li><li>实时、自动扩缩容</li></ul></li><li>平台侧 
    <ul><li>利用率优化 
      <ul><li>调度优化提升</li><li>混部</li></ul></li><li>闲置资源识别与清理 
      <ul><li>闲置节点降配</li><li>非活跃存储降配、清理</li><li>非活跃CLB，EIP网络资源清理</li></ul></li></ul></li></ul></li></ul> 
<hr> 
<h3 id="%E2%80%8B%E7%BC%96%E8%BE%91%E2%80%8B%E7%BC%96%E8%BE%91%E2%80%8B%E7%BC%96%E8%BE%91FinOps%E6%A6%82%E5%BF%B5"><img alt="在这里插入图片描述" src="https://images2.imgbox.com/e9/09/COfKKjsx_o.png"><span style="color:#0d0016;">FinOps概念</span></h3> 
<p><span style="color:#0d0016;">FinOps是一种将财务管理(Finance)与云操作(Ops)相结合的模式，旨在优化云计算支出并提高业务绩效。</span></p> 
<p><span style="color:#0d0016;">云计算是一种流量密集型的技术，意味着云成本管理在很大程度上取决于如何优化云资源消耗，并根据需要提高或降低开支。FinOps通过建立流程、原则和工具来实现这一目标，可以帮助企业更好地理解和控制云成本，同时保持效率和创新。</span></p> 
<p><span style="color:#0d0016;">FinOps的关键原则是建，立透明度并将云成本降低到最小水平。为了实现这一点，需要结合使用财务、技术和业务信息，以确定最佳的资源使用方式。同时，需要确定哪些资源实际上为贡献产生了价值，并分配成本以实现真正的透明度和可控性。<br> 总之，FinOps作为一种模式结合了财务和技术的因素，可以帮助企业实现优化云支出和提高业务绩效的目标。</span></p> 
<p><span style="color:#0d0016;">FinOps定义了一系列云财务管理规则和最佳实践，通过助力工程和财务团队、技术和业务团队彼此合作，进行数据驱动的成本决策，使组织能够获得最大收益。</span></p> 
<h3 id="%C2%A0%E6%88%90%E6%9C%AC%E6%9E%84%E6%88%90"><span style="color:#0d0016;"> 成本构成</span></h3> 
<h4 id="%E8%8A%82%E7%82%B9%E6%88%90%E6%9C%AC"><span style="color:#0d0016;">节点成本</span></h4> 
<ul><li><span style="color:#0d0016;">CPU成本=CPU单价*节点CPU核数*节点使用时长</span></li><li><span style="color:#0d0016;">内存成本=内存单价*节点内存内容*节点使用时长</span></li><li><span style="color:#0d0016;">其他，如GPU卡成本，储存成本</span></li><li><span style="color:#0d0016;">节点成本=CPU成本+内存成本+其他</span> </li></ul> 
<h4 id="%E5%B7%A5%E4%BD%9C%E8%B4%9F%E8%BD%BD%E6%88%90%E6%9C%AC">工作负载成本</h4> 
<ul><li>工作负载通常按资源分配量或使用量独立计价 
  <ul><li>分配成本=分配量*使用时长*单价</li><li>使用时间=使用量*使用时长*单价</li></ul></li><li>工作负载需要分摊的成本 
  <ul><li>限制成本=闲置资源量*闲置时长*单价</li><li>公开开销成本=集群管理组件公共服务的资源成本</li></ul></li></ul> 
<h3 id="%E8%B5%84%E6%BA%90%E5%88%A9%E7%94%A8%E7%8E%87%E4%BC%98%E5%8C%96%E6%A8%A1%E5%9E%8B"><span style="color:#0d0016;"><strong>资源利用率优化模型</strong></span></h3> 
<p><img alt="" height="920" src="https://images2.imgbox.com/6a/d9/2QcgSmiZ_o.jpg" width="1200"></p> 
<h3 id="%E6%A8%AA%E5%90%91%E4%BC%B8%E7%BC%A9%E5%92%8C%E7%BA%B5%E5%90%91%E4%BC%B8%E7%BC%A9">横向伸缩和纵向伸缩</h3> 
<ul><li>应用扩容市值在应用接收到的并发请求已经处于其处理请求极限便捷的情形下，扩展处理能力而确保应用高可用的技术手段 
  <ul><li>horizontal scaling         
    <ul><li>所谓横向伸缩市值听过增加实用案例数量分担负载的方式来提升应用整体处理能力的方式 </li></ul></li><li>vertical scaling 
    <ul><li>所谓纵向伸缩是指通过增加单个应用实例资源以提升单个实例处理能力，进而提升应用整体处理能力的方法 </li></ul></li></ul></li></ul> 
<p><img alt="" height="500" src="https://images2.imgbox.com/fe/c3/36adeZ1k_o.jpg" width="669"></p> 
<h3 id="%C2%A0kubernetes%E5%8E%9F%E7%94%9F%E8%83%BD%E5%8A%9B%E7%9A%84%E4%B8%8D%E8%B6%B3%E2%80%8B%E7%BC%96%E8%BE%91"> kubernetes原生能力的不足<img alt="" height="892" src="https://images2.imgbox.com/29/c2/yti21GcX_o.jpg" width="1200"></h3> 
<p><strong>开源地址  https://github.com/gocrane/crane</strong></p> 
<p><img alt="" height="864" src="https://images2.imgbox.com/a0/c3/expTX9OJ_o.jpg" width="1200"></p> 
<p> </p> 
<h2 id="%E4%BA%8C%E3%80%81%E4%BA%91%E5%8E%9F%E7%94%9F%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84%E6%88%90%E6%9C%AC%E4%BC%98%E5%8C%96%E6%8C%91%E6%88%98">二、云原生场景下的成本优化挑战</h2> 
<h3 id="%E6%88%90%E6%9C%AC%E5%88%86%E6%9E%90">成本分析</h3> 
<p><strong><span style="color:#4da8ee;">开启降本 </span></strong></p> 
<ul><li><span style="color:#0d0016;">从监控系统拉取用量数据</span></li><li><span style="color:#0d0016;">从kubernetes平台拉取作业配置信息</span></li><li><span style="color:#0d0016;">从云厂商计费API拉取资源单价</span></li><li><span style="color:#0d0016;">通过多种算法分析成本组成并给出优化建议</span></li></ul> 
<p><img alt="" height="717" src="https://images2.imgbox.com/69/7d/5BLeJOBM_o.jpg" width="940"></p> 
<p> </p> 
<h3 id="%E5%9C%BA%E6%99%AF%E4%B8%80%EF%BC%9A%E6%88%90%E6%9C%AC%E5%8F%AF%E8%A7%86%E5%8C%96">场景一：成本可视化</h3> 
<p><span style="color:#4da8ee;">成本展示与预测</span></p> 
<ul><li>成本历史</li><li>基于预测的趋势分析</li></ul> 
<p><span style="color:#4da8ee;">成本与浪费识别</span></p> 
<ul><li>与计费API整合的费用展示</li></ul> 
<p><span style="color:#4da8ee;">国内首个云原生碳排放计算器</span></p> 
<ul><li>能耗看板</li><li>碳排放看板</li></ul> 
<p><span style="color:#4da8ee;">灵活的汇聚维度</span></p> 
<ul><li>按部门</li><li>按项目</li><li>按应用类型</li><li>按自定义标签 </li></ul> 
<h3 id="%E5%9C%BA%E6%99%AF%E4%BA%8C%EF%BC%9A%E8%A7%84%E6%A0%BC%E6%8E%A8%E8%8D%90">场景二：规格推荐</h3> 
<p><span style="color:#4da8ee;">可声明</span></p> 
<ul><li>为指定命名空间，工作负载类型给出推荐值</li></ul> 
<p><span style="color:#4da8ee;">基于可配置的算法</span></p> 
<ul><li>需要动态挑战场景：指数桶+半衰期</li><li>静态推荐场景：均衡桶+无半衰期</li><li>余量Margin或目标利用率</li></ul> 
<p><img alt="" height="866" src="https://images2.imgbox.com/fc/05/cATys1lS_o.jpg" width="1031"></p> 
<h3 id="%E5%9C%BA%E6%99%AF%E4%B8%89%EF%BC%9A%E6%99%BA%E8%83%BD%E9%A2%84%E6%B5%8B%E4%B8%8E%E8%87%AA%E5%8A%A8%E6%89%A9%E7%BC%A9%E5%AE%B9">场景三：智能预测与自动扩缩容</h3> 
<p><span style="color:#4da8ee;">提前扩容</span></p> 
<ul><li>时间序列算法：FFT快速博里叶变换</li><li>取预测窗口最大值：提前扩容</li><li>基于custom metric</li><li>metric 兜底保护</li></ul> 
<p><span style="color:#4da8ee;">减少无效缩容</span></p> 
<ul><li>预测未来可以减少不必要的缩容</li></ul> 
<p><span style="color:#4da8ee;">支持cron配置</span></p> 
<ul><li>应对大促节假日等有规律的流量洪峰</li></ul> 
<p><span style="color:#4da8ee;">易于使用</span></p> 
<ul><li>完全兼容社区HPA</li><li>支持Dryrun观测</li><li>指标支持prometheus metric</li></ul> 
<p><img alt="" height="760" src="https://images2.imgbox.com/0c/f1/OshhXkQq_o.jpg" width="1070"></p> 
<h2 id="%E4%B8%89%E3%80%81Crane%E6%99%BA%E8%83%BD%E8%B0%83%E5%BA%A6%E5%8A%A9%E5%8A%9B%E6%88%90%E6%9C%AC%E4%BC%98%E5%8C%96">三、Crane智能调度助力成本优化</h2> 
<h3 id="%E8%B4%9F%E8%BD%BD%E6%84%9F%E7%9F%A5%E8%B0%83%E5%BA%A6">负载感知调度</h3> 
<p><span style="color:#4da8ee;">基于真实负载的调速器</span></p> 
<ul><li>底层依赖prometheus采集真实负载，代替request值</li><li>引入节点历史负载指标（1h内最大利用率，1天内最大利用率）感知业务波峰</li></ul> 
<h3 id="%E6%8B%93%E6%89%91%E6%84%9F%E7%9F%A5%E8%B0%83%E5%BA%A6">拓扑感知调度</h3> 
<p><span style="color:#4da8ee;">性能优先</span></p> 
<ul><li>有限选择pod能绑定在单NUMA Node内的节点</li><li>优先选择在同一个NUMA socket内的NUMA Node</li></ul> 
<p><span style="color:#4da8ee;">负载均衡</span></p> 
<ul><li>有限选择空闲资源更多的NUMA Node</li></ul> 
<p><span style="color:#4da8ee;">更灵活的策略</span></p> 
<ul><li>解决原生CPU Manager 导致集群负载过低的问题</li></ul> 
<h3 id="%E6%94%AF%E6%8C%81%E6%A8%A1%E6%8B%9F%E8%B0%83%E5%BA%A6%E7%9A%84%E9%87%8D%E8%B0%83%E5%BA%A6%E5%99%A8">支持模拟调度的重调度器</h3> 
<p>优雅驱逐能力</p> 
<ul><li>有全局视图，在多workload并行，同一workload内串行驱逐</li><li>支持模拟调度，集群资源不足时可停止驱逐</li><li>可以通过先扩容后缩容的方式实现无区驱逐</li></ul> 
<p>支持场景</p> 
<ul><li>驱逐负载过高的节点上得低优pod</li><li>支持固定时间窗口腾空节点</li><li>支持基于特定标签批量驱逐pid</li></ul> 
<p><img alt="" height="548" src="https://images2.imgbox.com/ad/25/PR33FYVf_o.jpg" width="1200"></p> 
<p></p> 
<h3 id="%E6%B7%B7%E9%83%A8%E5%86%85%E6%A0%B8%E7%A1%AE%E4%BF%9D%E9%AB%98%E4%BC%98%E4%B8%9A%E5%8A%A1%E7%A8%B3%E5%AE%9A%E6%80%A7%C2%A0">混部内核确保高优业务稳定性 </h3> 
<p><img alt="" height="908" src="https://images2.imgbox.com/d1/84/iBQcOi8M_o.jpg" width="1200"></p> 
<p> </p> 
<h3 id="Crane%20%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D">Crane 项目介绍</h3> 
<p><br> 基于以上 FinOps的原则和能力标准，腾讯云推出了Crane开源项目，主打智能调度，助力成本优化。是一个基于 FinOps 的云资源分析与成本优化平台。它的愿景是在保证客户应用运行质量的前提下实现极致的降本。</p> 
<p></p> 
<ul><li>Craned</li></ul> 
<p><span style="color:#0d0016;">Craned 是 Crane 的最核心组件，它管理了 CRDs 的生命周期以及API。Craned 通过 Deployment 方式部署且由两个容器组成：Craned与Dashboard</span></p> 
<ul><li><span style="color:#0d0016;">Fadvisor</span></li></ul> 
<p><span style="color:#0d0016;">Fadvisor 提供一组 Exporter 计算集群云资源的计费和账单数据并存储到你的监控系统，比如 Prometheus。Fadvisor 通过 Cloud Provider 支持了多云计费的 API。</span></p> 
<ul><li><span style="color:#0d0016;">Metric Adapter</span></li></ul> 
<p><span style="color:#0d0016;">Metric Adapter 实现了一个 Custom Metric Apiserver. Metric Adapter 读取 CRDs 信息并提供基于 Custom/External Metric API 的 HPA Metric 的数据。</span></p> 
<ul><li><span style="color:#0d0016;">Crane Agent</span></li></ul> 
<p><span style="color:#0d0016;">Crane Agent 通过 DaemonSet 部署在集群的节点上。</span></p> 
<ul><li><span style="color:#0d0016;">在监控方面使用了Prometheus与Grafana。Crane的一些图表就是直接使用的Grafana配置的。</span></li><li><span style="color:#0d0016;">在成本的可视化和优化评估</span></li></ul> 
<h4 id="%E5%86%85%E9%83%A8%E5%A4%A7%E8%A7%84%E6%A8%A1%E8%90%BD%E5%9C%B0%E7%9A%84%E6%88%90%E6%95%88"><span style="color:#0d0016;">内部大规模落地的成效</span></h4> 
<ul><li><span style="color:#0d0016;">腾讯内部自研业务大规模落地</span></li><li><span style="color:#0d0016;">部署至数百个kubernetes集群</span></li><li><span style="color:#0d0016;">管控数百万CPU核</span></li><li><span style="color:#0d0016;">全面上线两个月内，大盘总核数缩减25%</span></li></ul> 
<h4 id="%E5%A4%96%E9%83%A8%E4%BC%98%E5%8C%96%E6%88%90%E6%95%88">外部优化成效</h4> 
<ul><li>在网易新闻落地</li><li>管控数wcpu核</li><li>全面上线2个月内，大盘总核数缩减11%</li><li>下线30台56C物理机，每月节约10w</li></ul> 
<h3 id="%E8%BD%AF%E4%BB%B6%E6%B8%85%E5%8D%95">软件清单</h3> 
<ul><li><a href="https://kubernetes.io/zh-cn/docs/tasks/tools/" rel="nofollow" title="安装 kubectl">安装 kubectl</a></li><li><a href="https://helm.sh/zh/docs/intro/install/" rel="nofollow" title="安装 Helm">安装 Helm</a></li><li><a href="https://kind.sigs.k8s.io/docs/user/quick-start/#installation" rel="nofollow" title="安装 kind">安装 kind</a></li><li><a href="https://docs.docker.com/get-docker/" rel="nofollow" title="安装 Docker">安装 Docker</a></li></ul> 
<h2>总结</h2> 
<h2></h2> 
<p>使更多开发者通过活动对 Finops Crane 开源项目有深入了解，同时也能帮助广大开发者在云原生技能上有实质性收获。</p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/58938efe8561ebb3311d4c072bfc11d9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">logback日志脱敏</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ebac461684478a407fe99cb5336f9c67/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C语言实现守护进程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>