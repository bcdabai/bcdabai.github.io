<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SecureCRT脚本-python - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SecureCRT脚本-python" />
<meta property="og:description" content="SecureCRT脚本-python 1.这里写两个小脚本一、SecureCrt脚本（一）顶级对象之Crt1、引言2、关于脚本表头3、顶级对象&#39;crt&#39;的子属性和方法3.1、属性3.1.1、Dialog3.1.2、Screen3.1.3、ScriptFullName3.1.4、Session3.1.5、Version3.1.6、Window 3.2、方法3.2.1、GetActiveTab()3.2.2、GetScriptTab()3.2.3、GetTabCount()3.2.4、GetTab(Index)3.2.5、Sleep(millisecond)3.2.6、Quit() 二、 SecureCrt脚本（二）二级对象之Dialog1、引言2、Dialog属性和方法2.1、属性2.2、方法2.2.1、FileOpenDialog2.2.2、MessageBox2.2.3、Prompt 3、总结 三、SecureCrt脚本（三）二级对象之Screen详解1、引言2、Screen属性和方法2.1、属性2.1.1、CurrentColumn2.1.2、CurrentRow2.1.3、Columns2.1.4、Rows2.1.5、IgnoreEscape2.1.6、MatchIndex2.1.7、Synchronous 2.2、方法2.2.1、Clear()2.2.2、get()2.2.3、get2()2.2.4、IgnoreCase()2.2.5、Send()2.2.6、SendKeys()2.2.7、SendSpecial()2.2.8、WaitForCursor()2.2.9、WaitForKey()2.2.10、WaitForString()2.2.11、WaitForStrings()2.2.12、ReadString() 3、总结 1.这里写两个小脚本 # $language = &#34;python&#34; # $interface = &#34;1.0&#34; #官方的实例可以在未连接任何服务器的情况下进行ssh连接 #你要连接的ssh服务器ip host = &#39;139.196.53.1**&#39; #ssh用户名 user = &#39;root&#39; #ssh密码 passwd = &#39;Jinx0007&#39; def main(): #进行cmd操作连接创建新的session连接 cmd = &#34;/SSH2 /L %s /PASSWORD %s /C 3DES /M MD5 %s&#34; % (user, passwd, host) crt.Session.Connect(cmd) #使用默认弹窗提示信息 crt.Dialog.MessageBox(&#39;登录成功!&#39;) main() 2.另外一个：
# $language = &#34;python&#34; # $interface = &#34;1.0&#34; #此方法表示你必须先登录一台ssh服务器然后再去ssh到另外一台服务器 #ssh主机的ip host = &#39;192.168.0.111&#39; #ssh主机的用户名 user = &#39;root&#39; #ssh主机的密码 passwd = &#39;Jinx0007&#39; def main(): #向屏幕光标后发送以下文字内容，\r表示回车执行 crt." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a63e7b5b7fb667033183897250b209d2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-04T14:36:56+08:00" />
<meta property="article:modified_time" content="2021-06-04T14:36:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SecureCRT脚本-python</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>SecureCRT脚本-python</h4> 
 <ul><li><a href="#1_1" rel="nofollow">1.这里写两个小脚本</a></li><li><a href="#SecureCrtCrt_206" rel="nofollow">一、SecureCrt脚本（一）顶级对象之Crt</a></li><li><ul><li><a href="#1_207" rel="nofollow">1、引言</a></li><li><a href="#2_209" rel="nofollow">2、关于脚本表头</a></li><li><a href="#3crt_224" rel="nofollow">3、顶级对象'crt'的子属性和方法</a></li><li><ul><li><a href="#31_236" rel="nofollow">3.1、属性</a></li><li><ul><li><a href="#311Dialog_237" rel="nofollow">3.1.1、Dialog</a></li><li><a href="#312Screen_248" rel="nofollow">3.1.2、Screen</a></li><li><a href="#313ScriptFullName_257" rel="nofollow">3.1.3、ScriptFullName</a></li><li><a href="#314Session_266" rel="nofollow">3.1.4、Session</a></li><li><a href="#315Version_275" rel="nofollow">3.1.5、Version</a></li><li><a href="#316Window_288" rel="nofollow">3.1.6、Window</a></li></ul> 
    </li><li><a href="#32_297" rel="nofollow">3.2、方法</a></li><li><ul><li><a href="#321GetActiveTab_298" rel="nofollow">3.2.1、GetActiveTab()</a></li><li><a href="#322GetScriptTab_307" rel="nofollow">3.2.2、GetScriptTab()</a></li><li><a href="#323GetTabCount_320" rel="nofollow">3.2.3、GetTabCount()</a></li><li><a href="#324GetTabIndex_330" rel="nofollow">3.2.4、GetTab(Index)</a></li><li><a href="#325Sleepmillisecond_348" rel="nofollow">3.2.5、Sleep(millisecond)</a></li><li><a href="#326Quit_368" rel="nofollow">3.2.6、Quit()</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#_SecureCrtDialog_401" rel="nofollow">二、 SecureCrt脚本（二）二级对象之Dialog</a></li><li><ul><li><a href="#1_402" rel="nofollow">1、引言</a></li><li><a href="#2Dialog_405" rel="nofollow">2、Dialog属性和方法</a></li><li><ul><li><a href="#21_411" rel="nofollow">2.1、属性</a></li><li><a href="#22_414" rel="nofollow">2.2、方法</a></li><li><ul><li><a href="#221FileOpenDialog_415" rel="nofollow">2.2.1、FileOpenDialog</a></li><li><a href="#222MessageBox_435" rel="nofollow">2.2.2、MessageBox</a></li><li><a href="#223Prompt_491" rel="nofollow">2.2.3、Prompt</a></li></ul> 
   </li></ul> 
   </li><li><a href="#3_511" rel="nofollow">3、总结</a></li></ul> 
  </li><li><a href="#SecureCrtScreen_514" rel="nofollow">三、SecureCrt脚本（三）二级对象之Screen详解</a></li><li><ul><li><a href="#1_515" rel="nofollow">1、引言</a></li><li><a href="#2Screen_518" rel="nofollow">2、Screen属性和方法</a></li><li><ul><li><a href="#21_533" rel="nofollow">2.1、属性</a></li><li><ul><li><a href="#211CurrentColumn_534" rel="nofollow">2.1.1、CurrentColumn</a></li><li><a href="#212CurrentRow_551" rel="nofollow">2.1.2、CurrentRow</a></li><li><a href="#213Columns_569" rel="nofollow">2.1.3、Columns</a></li><li><a href="#214Rows_585" rel="nofollow">2.1.4、Rows</a></li><li><a href="#215IgnoreEscape_601" rel="nofollow">2.1.5、IgnoreEscape</a></li><li><a href="#216MatchIndex_628" rel="nofollow">2.1.6、MatchIndex</a></li><li><a href="#217Synchronous_659" rel="nofollow">2.1.7、Synchronous</a></li></ul> 
    </li><li><a href="#22_686" rel="nofollow">2.2、方法</a></li><li><ul><li><a href="#221Clear_687" rel="nofollow">2.2.1、Clear()</a></li><li><a href="#222get_712" rel="nofollow">2.2.2、get()</a></li><li><a href="#223get2_731" rel="nofollow">2.2.3、get2()</a></li><li><a href="#224IgnoreCase_751" rel="nofollow">2.2.4、IgnoreCase()</a></li><li><a href="#225Send_775" rel="nofollow">2.2.5、Send()</a></li><li><a href="#226SendKeys_800" rel="nofollow">2.2.6、SendKeys()</a></li><li><a href="#227SendSpecial_991" rel="nofollow">2.2.7、SendSpecial()</a></li><li><a href="#228WaitForCursor_1020" rel="nofollow">2.2.8、WaitForCursor()</a></li><li><a href="#229WaitForKey_1042" rel="nofollow">2.2.9、WaitForKey()</a></li><li><a href="#2210WaitForString_1064" rel="nofollow">2.2.10、WaitForString()</a></li><li><a href="#2211WaitForStrings_1101" rel="nofollow">2.2.11、WaitForStrings()</a></li><li><a href="#2212ReadString_1153" rel="nofollow">2.2.12、ReadString()</a></li></ul> 
   </li></ul> 
   </li><li><a href="#3_1208" rel="nofollow">3、总结</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1_1"></a>1.这里写两个小脚本</h2> 
<pre><code class="prism language-python"><span class="token comment"># $language = "python"</span>
<span class="token comment"># $interface = "1.0"</span>
 
<span class="token comment">#官方的实例可以在未连接任何服务器的情况下进行ssh连接</span>
 
<span class="token comment">#你要连接的ssh服务器ip</span>
host <span class="token operator">=</span> <span class="token string">'139.196.53.1**'</span>
<span class="token comment">#ssh用户名</span>
user <span class="token operator">=</span> <span class="token string">'root'</span>
<span class="token comment">#ssh密码</span>
passwd <span class="token operator">=</span> <span class="token string">'Jinx0007'</span>
 
<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
 
    <span class="token comment">#进行cmd操作连接创建新的session连接</span>
    cmd <span class="token operator">=</span> <span class="token string">"/SSH2 /L %s /PASSWORD %s /C 3DES /M MD5 %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>user<span class="token punctuation">,</span> passwd<span class="token punctuation">,</span> host<span class="token punctuation">)</span>
    crt<span class="token punctuation">.</span>Session<span class="token punctuation">.</span>Connect<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
    <span class="token comment">#使用默认弹窗提示信息</span>
    crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'登录成功!'</span><span class="token punctuation">)</span>
 
main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>2.另外一个：</p> 
<pre><code class="prism language-python"><span class="token comment"># $language = "python"</span>
<span class="token comment"># $interface = "1.0"</span>
<span class="token comment">#此方法表示你必须先登录一台ssh服务器然后再去ssh到另外一台服务器</span>
<span class="token comment">#ssh主机的ip</span>
host <span class="token operator">=</span> <span class="token string">'192.168.0.111'</span>
<span class="token comment">#ssh主机的用户名</span>
user <span class="token operator">=</span> <span class="token string">'root'</span>
<span class="token comment">#ssh主机的密码</span>
passwd <span class="token operator">=</span> <span class="token string">'Jinx0007'</span>
 
<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#向屏幕光标后发送以下文字内容，\r表示回车执行</span>
    crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">'ssh '</span><span class="token operator">+</span>user<span class="token operator">+</span><span class="token string">'@'</span><span class="token operator">+</span>host<span class="token operator">+</span><span class="token string">'  \r'</span><span class="token punctuation">)</span>
    <span class="token comment">#在5秒内等待屏幕出现password:或者yes/no文字进行下方操作，超过5秒表示超时</span>
    result <span class="token operator">=</span> crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>WaitForStrings<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'password:'</span><span class="token punctuation">,</span><span class="token string">'(yes/no)'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token comment">#当屏幕出现password:字符</span>
    <span class="token keyword">if</span> result <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span>passwd<span class="token operator">+</span><span class="token string">"\r"</span><span class="token punctuation">)</span>
    <span class="token comment">#屏幕出现(yes/no)等相关字符</span>
    <span class="token keyword">if</span> result <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
        crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">'yes \r'</span><span class="token punctuation">)</span>
        crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>WaitForString<span class="token punctuation">(</span><span class="token string">'password:'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span>passwd<span class="token operator">+</span><span class="token string">"\r"</span><span class="token punctuation">)</span>
    <span class="token comment">#等待屏幕出现']$'字符</span>
    crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>WaitForString<span class="token punctuation">(</span><span class="token string">']$'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token comment">#使用默认弹窗提示信息</span>
    crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'登录成功!'</span><span class="token punctuation">)</span>
 
main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>内容<br> （1）使用python语言实现SecureCRT中的Dialog功能</p> 
<pre><code class="prism language-python"><span class="token comment"># $language = "Python"</span>
<span class="token comment"># $interface = "1.0"</span>
 
<span class="token comment">#crt.Dialog.FileOpenDialog([title,[buttonLabel,[defaultFilename,[filter]]]])</span>
<span class="token comment">#弹出一个对话框，用于选择单个文件;如果选择了具体文件则返回该文件的绝对路径，如果选择了弹窗的“取消”，则返回空。</span>
filePath <span class="token operator">=</span>  crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>FileOpenDialog<span class="token punctuation">(</span><span class="token string">"please open a file"</span><span class="token punctuation">,</span><span class="token string">"open"</span><span class="token punctuation">,</span><span class="token string">"a.log"</span><span class="token punctuation">,</span><span class="token string">"(*.log)|*.log"</span><span class="token punctuation">)</span>
<span class="token comment">#filePath =  crt.Dialog.FileOpenDialog("","","a.log","")</span>
<span class="token comment">#crt.Dialog.MessageBox(message, [title, [icon|buttons]]) 警告、按钮类型弹出一个消息框，可以定义按钮，使用按钮和文本消息来实现和用户的简单对话；</span>
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span>filePath<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token operator">|</span><span class="token number">0</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"会话已断开"</span><span class="token punctuation">,</span><span class="token string">"session"</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token operator">|</span><span class="token number">2</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"确认是否退出"</span><span class="token punctuation">,</span><span class="token string">"session"</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token operator">|</span><span class="token number">1</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"确认是否退出"</span><span class="token punctuation">,</span><span class="token string">"session"</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token operator">|</span><span class="token number">3</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"是否继续安装"</span><span class="token punctuation">,</span><span class="token string">"session"</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token operator">|</span><span class="token number">4</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"此会话已打开"</span><span class="token punctuation">,</span><span class="token string">"session"</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token operator">|</span><span class="token number">5</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"无法连接此窗口"</span><span class="token punctuation">,</span><span class="token string">"session"</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token operator">|</span><span class="token number">6</span><span class="token punctuation">)</span>
 
<span class="token comment">#crt.Dialog.Prompt(message [, title [,default [,isPassword ]]])</span>
<span class="token comment">#弹出一个输入框，用户可以填写文字，比如填写文件名，填写路径，填写IP地址等,运行结果如果点击'ok'，返回输入的字符串，否则返回"" </span>
password <span class="token operator">=</span> crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>Prompt<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">,</span><span class="token string">"session"</span><span class="token punctuation">,</span><span class="token string">"admin"</span><span class="token punctuation">,</span><span class="token boolean">False</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span>password<span class="token punctuation">,</span><span class="token string">"password"</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token operator">|</span><span class="token number">0</span><span class="token punctuation">)</span>
password <span class="token operator">=</span> crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>Prompt<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">,</span><span class="token string">"session"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span>password<span class="token punctuation">,</span><span class="token string">"password"</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token operator">|</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<p>（2） 使用python语言实现SecureCRT中的Screen功能</p> 
<pre><code class="prism language-python"><span class="token comment"># $language = "Python"</span>
<span class="token comment"># $interface = "1.0"</span>
 
<span class="token comment"># CurrentColumn返回当前光标的列坐标。</span>
curCol <span class="token operator">=</span>  crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>CurrentColumn
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>curCol<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># CurrentRow返回当前光标的行坐标。</span>
curRow <span class="token operator">=</span> crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>CurrentRow
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>curRow<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># Columns 返回当前屏幕的最大列宽</span>
cols <span class="token operator">=</span> crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Columns
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>cols<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># Rows 返回当前屏幕的最大行宽</span>
rows <span class="token operator">=</span> crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Rows
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment">#IgnoreEscape 定义当使用WaitForString、WaitForStrings和ReadString这三个方法时是否获取Escape字符（特殊字符如回车）默认是会获取的</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>IgnoreEscape <span class="token operator">=</span> <span class="token boolean">False</span>
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span>crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>ReadString<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"\03"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#获取ctrl+c</span>
 
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>IgnoreEscape <span class="token operator">=</span> <span class="token boolean">True</span>
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span>crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>ReadString<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"\03"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#不获取ctrl+c</span>
 
<span class="token comment"># MatchIndex 定义当使用WaitForStrings和ReadString这三个方法时会根据参数的位置 获取返回值，从1开始计算，如果没有一个匹配则返回0.</span>
outPut <span class="token operator">=</span> crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>ReadString<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"error"</span><span class="token punctuation">,</span><span class="token string">"warning"</span><span class="token punctuation">,</span><span class="token string">"#"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
index <span class="token operator">=</span> crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>MatchIndex
<span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"Timed out!"</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"Found 'error'"</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"Found 'warning'"</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"Found '#'"</span><span class="token punctuation">)</span>
    
 
<span class="token comment"># Synchronous 设置屏幕的同步属性。若设置为false，则在脚本中使用WaitForString、WaitForStrings、ReadString函数时可能存在丢失一部分数据的现象，设置为true后可能会存在屏幕卡顿的情况，默认为false</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Synchronous <span class="token operator">=</span> <span class="token boolean">True</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">"\r\n"</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>ReadString<span class="token punctuation">(</span><span class="token string">"#"</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">"\r\n"</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>WaitForString<span class="token punctuation">(</span><span class="token string">"#"</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">"\r\n"</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>WaitForStrings<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"#"</span><span class="token punctuation">,</span><span class="token string">"&gt;"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">"conf t\r\n"</span><span class="token punctuation">)</span> 
  
<span class="token comment"># 方法</span>
<span class="token comment"># Clear()清屏功能</span>
<span class="token comment"># crt.Screen.Clear()</span>
 
<span class="token comment"># get()按照坐标取出一个矩形框内的屏幕上的字符(即从某行某列开始到其它行其它列)，不包含字符串中的回车换行符，所以这个多用于获取无格式的光标处字符串或某小段特定区域字符串。</span>
out <span class="token operator">=</span> crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Get<span class="token punctuation">(</span>row1<span class="token punctuation">,</span> col1<span class="token punctuation">,</span> row2<span class="token punctuation">,</span> col2<span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span>out<span class="token punctuation">)</span>
 
<span class="token comment"># get2()解释按照坐标取出一个矩形框内的屏幕上的字符(即从某行某列开始到其它行其它列)，包含字符串中的回车换行符，所以这个多用于获取大段带格式的字符串。</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Get2<span class="token punctuation">(</span>row1<span class="token punctuation">,</span> col1<span class="token punctuation">,</span> row2<span class="token punctuation">,</span> col2<span class="token punctuation">)</span>
 
<span class="token comment"># IgnoreCase 使用全局参数设置控制在使用WaitForString、WaitForStrings和ReadString这三个函数时是否对大小写敏感，默认为false大小写字符串都会检查，设置为true时则不会检测大小写。</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>IgnoreCase <span class="token operator">=</span> <span class="token boolean">True</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">"show memory\r\n"</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>WaitForString<span class="token punctuation">(</span><span class="token string">"more"</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">"\r\n"</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>WaitForStrings<span class="token punctuation">(</span><span class="token string">"more"</span><span class="token punctuation">,</span><span class="token string">"#"</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">"\r\n"</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>ReadString<span class="token punctuation">(</span><span class="token string">"more"</span><span class="token punctuation">,</span><span class="token string">"#"</span><span class="token punctuation">)</span>
 
<span class="token comment"># Send() 向远端设备或者屏幕发送字符串，当向屏幕发送字符串时需要指定第二个参数为Ture</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">"show version\r\n"</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">"\r\nhello,world!\r\n"</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>IgnoreCase <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>WaitForString<span class="token punctuation">(</span><span class="token string">"more"</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    
    crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">"\r\n"</span><span class="token punctuation">)</span>
 
<span class="token comment"># SendKeys()向当前窗口发送按键，包含组合按键，比如可以发送类似"CTRL+ALT+C"等这样的组合键，这样写即可：crt.screen.sendkeys("^%c");这个功能需要语言本身支持，目前只有VBS和JS脚本可以使用。</span>
 
<span class="token comment"># SendSpecial()可以发送特殊控制码，这个控制码是Crt内置的功能，具体可以包含的有Menu、Telnet、VT functions功能列表中提供的所有功能，</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>SendSpecial<span class="token punctuation">(</span><span class="token string">"vT_HOLD_SCREEN"</span><span class="token punctuation">)</span>
 
<span class="token comment"># WaitForCursor()等待光标移动，当移动时返回值为true，当有超时时间参数且超时时返回false，否则会一直等待光标移动。利用这个功能可以用来判断一个命令的输出是否结束，</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>WaitForCursor<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">"\r\nhello,world!\r\n"</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>WaitForCursor<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">"show version\r\n"</span><span class="token punctuation">)</span>
 
<span class="token comment"># WaitForKey()检测有键盘按键时返回true，当有超时时间参数且超时时返回false，否则会一直等待按键</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>WaitForKey<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>Send<span class="token punctuation">(</span><span class="token string">"show version\r\n"</span><span class="token punctuation">)</span>
 
<span class="token comment"># WaitForString()一般用于发送命令后等待某字符串</span>
<span class="token comment"># crt.Screen.WaitForString(string,[timeout],[bCaseInsensitive])</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>WaitForString<span class="token punctuation">(</span><span class="token string">"#"</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
 
<span class="token comment"># WaitForStrings()与WaitForString是同样的功能，可以等待多个字符串</span>
outPut <span class="token operator">=</span> crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>WaitForStrings<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"error"</span><span class="token punctuation">,</span><span class="token string">"warning"</span><span class="token punctuation">,</span><span class="token string">"#"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
index <span class="token operator">=</span> crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>MatchIndex
<span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"Timed out!"</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"Found 'error'"</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"Found 'warning'"</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    crt<span class="token punctuation">.</span>Dialog<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"Found '#'"</span><span class="token punctuation">)</span>
    
<span class="token comment"># ReadString()与WaitForStrings功能类似，都是等待某几个字符出现，不同的是它还会读取字符串之前出现的所有字符。</span>
crt<span class="token punctuation">.</span>Screen<span class="token punctuation">.</span>ReadString<span class="token punctuation">(</span><span class="token punctuation">[</span>string1<span class="token punctuation">,</span>string2<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>timeout<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>bCaseInsensitive<span class="token punctuation">]</span><span class="token punctuation">)</span>        
<span class="token number">1</span>、string，必选参数，等待的字符串，最少有一个，可以是特殊字符比如<span class="token punctuation">:</span>\r\n；
<span class="token number">2</span>、timeout，可选参数，超时时间，当检测不到对应字符串时会返回false，没有此参数时会一直等待；
<span class="token number">3</span>、bCaseInsensitive，可选参数，大小写不敏感，默认值是false，表示将检测字符串的大小写，当为true时不检测大小写。
</code></pre> 
<h2><a id="SecureCrtCrt_206"></a>一、SecureCrt脚本（一）顶级对象之Crt</h2> 
<h3><a id="1_207"></a>1、引言</h3> 
<p>Crt脚本的实现需要使用Crt定义好的各个对象的属性和方法来实现，脚本函数系列将逐一介绍Crt脚本中最常使用的对象，对这些对象以层级关系画出，本篇首先介绍顶级对象。crt的属性和方法。属性是一个静态的对象，方法是具体执行的动作。属性和方法底下还可以有子属性和子方法，这个其实就和面向对象的编程方式很像，有些基础的人应该会很快掌握。</p> 
<h3><a id="2_209"></a>2、关于脚本表头</h3> 
<p>解释<br> 在学习脚本函数前，先说说在脚本中头两行(必须写在头两行，且最好不要有空格回车之类的字符)所必须添加的标识，这两行标识告诉Crt当前执行的脚本需要使用什么解释器进行解释。其中language为语言，现支持Jscript、VBScript、Python、Perl,interface为接口，现在都是1.0，以下为示例，修改对应的语言即可</p> 
<p>代码</p> 
<pre><code class="prism language-python">JS
<span class="token number">1</span> <span class="token comment"># $language = "JScript" </span>
<span class="token number">2</span> <span class="token comment"># $interface = "1.0"</span>
python
<span class="token number">1</span> <span class="token comment"># $language = "Python" </span>
<span class="token number">2</span> <span class="token comment"># $interface = "1.0"</span>
</code></pre> 
<h3><a id="3crt_224"></a>3、顶级对象’crt’的子属性和方法</h3> 
<pre><code class="prism language-python">属性	          方法
Dialog	        GetActiveTab
Screen	        GetScriptTab
ScriptFullName	GetTabCount
Session	  		GetTab
Version			Quit
Window			Sleep
</code></pre> 
<h4><a id="31_236"></a>3.1、属性</h4> 
<h5><a id="311Dialog_237"></a>3.1.1、Dialog</h5> 
<p>解释<br> 定义了一个Dialog(对话框),通过这个对象，可以通过调用该对象的子属性和方法实现对话框的相关功能。</p> 
<p>代码</p> 
<p>JS<br> 1 var diaObj = crt.Dialog;</p> 
<h5><a id="312Screen_248"></a>3.1.2、Screen</h5> 
<p>解释<br> 定义Screen(屏幕)对象，该对象是整个脚本中的灵魂，包含数据抓取、数据发送、等待数据等等重要功能都是有该对象的子属性和方法实现的。</p> 
<p>代码</p> 
<p>JS<br> var scrObj = crt.Screen;</p> 
<h5><a id="313ScriptFullName_257"></a>3.1.3、ScriptFullName</h5> 
<p>解释<br> 该对象返回当前执行脚本的全名，其中包含脚本路径和脚本名,可以使用中文路径和文件名。</p> 
<p>代码</p> 
<p>JS<br> var scrName = crt.ScriptFullName;</p> 
<h5><a id="314Session_266"></a>3.1.4、Session</h5> 
<p>解释<br> 定义当前会话属性，该属性有许多很实用的属性和方法可以使用。同样作为后重点关注</p> 
<p>代码</p> 
<p>JS<br> var sessionObj = crt.Session;</p> 
<h5><a id="315Version_275"></a>3.1.5、Version</h5> 
<p>解释<br> 返回当前Crt的软件版本，通常该属性用于比较版本新旧，以处理在不同版本上不能兼容的问题。</p> 
<p>代码</p> 
<p>JS<br> 1 // 检查Crt版本，如果低于7.3，则退出Crt。<br> 2 crtVer = crt.Version;<br> 3 if ( crtVer &lt; 7.3 ) {<!-- --><br> 4 crt.Quit();<br> 5 }</p> 
<h5><a id="316Window_288"></a>3.1.6、Window</h5> 
<p>解释<br> 返回当前程序的窗口对象，该对象下有子对象，可以实现诸如隐藏当前窗口等的功能。</p> 
<p>代码</p> 
<p>JS<br> 1 var crtWin = crt.Window;</p> 
<h4><a id="32_297"></a>3.2、方法</h4> 
<h5><a id="321GetActiveTab_298"></a>3.2.1、GetActiveTab()</h5> 
<p>解释<br> Crt软件的管理是多Tab的，该方法返回当前活跃状态的Tab界面,该界面作为一个新的Tab属性使用，而Tab属性本身又有许多子属性和方法，因此该方法也是比较实用的一个函数。</p> 
<p>代码</p> 
<p>JS<br> 1 var actTab = crt.GetActiveTab();</p> 
<h5><a id="322GetScriptTab_307"></a>3.2.2、GetScriptTab()</h5> 
<p>解释<br> 获取当前脚本执行的Tab对象，该对象有一些子对象和方法，通过获取Tab页面，可以轻松的实现在多个Tab中同时发送数据的功能。</p> 
<p>代码</p> 
<p>JS<br> 1 // 获取当前脚本执行的Tab，并获取编号(Index从1开始)<br> 2 var scriptTab = crt.GetScriptTab();<br> 3 var tabNum = scriptTab.Index;<br> 4 // 在当前Tab上发送数据<br> 5 scriptTab.Screen.Send(“脚本执行的Tab是：”+tabNum);</p> 
<h5><a id="323GetTabCount_320"></a>3.2.3、GetTabCount()</h5> 
<p>解释<br> 获取当前总Tab数目，是一个数值类型返回值。</p> 
<p>代码</p> 
<p>JS<br> 1 // 获取总Tab数目<br> 2 var tabCount = crt.GetTabCount();</p> 
<h5><a id="324GetTabIndex_330"></a>3.2.4、GetTab(Index)</h5> 
<p>解释<br> 获取某个位置的Tab对象，该位置即为tab的Index，从1开始，即从当前Crt窗口的最左侧Tab数起。</p> 
<p>代码</p> 
<p>JS<br> 复制代码<br> // 获取指定编号的Tab对象<br> var tabCount = crt.GetTabCount();<br> var gTab = “”;<br> // 从Tab1到所有Tab依次发送数据<br> for ( var i = 1 ; i &lt;= tabCount; i++ ) {<!-- --><br> gTab = crt.GetTab(i);<br> gTab.Screen.Send(“当前Tab为:”+i);<br> }<br> 复制代码</p> 
<h5><a id="325Sleepmillisecond_348"></a>3.2.5、Sleep(millisecond)</h5> 
<p>解释<br> 脚本暂停运行时间，millisecond：毫秒 该功能是极为常用的功能</p> 
<p>代码</p> 
<p>JS<br> 复制代码<br> 1 // 获取指定编号的Tab对象<br> 2 var tabCount = crt.GetTabCount();<br> 3 var gTab = “”;<br> 4 // 从Tab1到所有Tab依次发送数据<br> 5 for ( var i = 1 ; i &lt;= tabCount; i++ ) {<!-- --><br> 6 gTab = crt.GetTab(i);<br> 7 // 暂停5秒再发送数据<br> 8 crt.Sleep(5000);<br> 9 gTab.Screen.Send(“当前Tab为:”+i);<br> 10 }<br> 复制代码</p> 
<h5><a id="326Quit_368"></a>3.2.6、Quit()</h5> 
<p>解释<br> 退出Crt软件。（不是退出脚本，是直接退出软件。）</p> 
<p>代码</p> 
<p>JS</p> 
<p>复制代码<br> 1 // 如果直接使用crt.Quit的话只要有会话是激活的，那么就会有弹窗出来，因此，可以使用for循环，先将所有Tab断连，再退出。<br> 2<br> 3 // 断连所有Tab<br> 4 var tabCount = crt.GetTabCount();<br> 5 var gTab = “”;<br> 6 for ( var i = 1 ; i &lt;= tabCount; i++ ) {<!-- --><br> 7 gTab = crt.GetTab(i);<br> 8 gTab.Session.Disconnect();<br> 9 }<br> 10 // 此时可以直接退出Crt<br> 11 crt.Quit()<br> 复制代码</p> 
<p>总结</p> 
<ol><li> <p>在写脚本时一定要添加前言所述的脚本头部两行，且注意最好不要有空格和回车等。</p> </li><li> <p>crt的最常用最基本的二级属性和方法上面都已经介绍完了，总的一个应用原则是属性是静态的，在使用时不需要加()，而方法是动态的(实际上就是函数),因此在调用时需要用()，有些方法是有参数，有些是没有的，在使用时也要注意。</p> </li><li> <p>希望通过本篇对二级属性和方法做一个全面的讲解，可以更清楚的知道crt函数中都有哪些具体的函数，哪些可能是重点，哪些可能最常用，以及如何使用这些函数，都可以根据上面的解释和脚本实现中获取相关信息。</p> </li></ol> 
<p>4.但凡有子属性或子方法的二级属性和方法，都可以通过后面教程中的写法直接引入，不需要每次都赋值给一个对象使用。</p> 
<p>5.希望各位看官可以从中学到些东西，本篇抛砖引玉就到此结束了。下一篇将会就二级属性’Dialog’做详细说明，敬请期待…</p> 
<h2><a id="_SecureCrtDialog_401"></a>二、 SecureCrt脚本（二）二级对象之Dialog</h2> 
<h3><a id="1_402"></a>1、引言</h3> 
<p>上篇"SecureCrt 脚本函数（一）"中详细介绍了顶级对象’crt’中的子属性和子方法，本篇中将详细介绍’crt’的子属性’Dialog’的方法。'Dialog’主要是用于Crt构建自己的和用户能够交互的简单界面，比如输入字符，弹出对话框，输出提示框等。</p> 
<h3><a id="2Dialog_405"></a>2、Dialog属性和方法</h3> 
<p>属性 方法<br> FileOpenDialog<br> MessageBox<br> Prompt</p> 
<h4><a id="21_411"></a>2.1、属性</h4> 
<p>Dialog暂无属性</p> 
<h4><a id="22_414"></a>2.2、方法</h4> 
<h5><a id="221FileOpenDialog_415"></a>2.2.1、FileOpenDialog</h5> 
<p>解释<br> 定义了一个Dialog(对话框),通过这个对象，可以通过调用该对象的子属性和方法实现对话框的相关功能。</p> 
<p>语法<br> crt.Dialog.Method([arglist])</p> 
<p>参数：<br> （1）title:弹窗最上面的标题文字，见运行结果中窗口最上面的"请选择一个文件"。<br> （2）buttonLabel:见下图中的"Open"按钮，即打开文件用的，至于名称可以使用"Open"或者"打开"均可。<br> （3）defaultFilename:默认文件名，如下，在弹窗的"文件名"中默认有"a.log"。注意：当有默认文件名时即使当前文件夹中没有该文件，在点击"打开"按钮后，结果依然会返回该文件的当前目录的绝对路径。<br> （4）filter:用于过滤文件类型,见脚本举例中的格式，"Log Files (<em>.log)|</em>.log，| 的前半部分是一串提示符，会显示在运行结果中的"文件类型"中，后半部分是正则表达式，用于过滤以.log结尾的所有文件。<br> 代码<br> JS<br> 1 filePath = crt.Dialog.FileOpenDialog(“请选择一个文件”, “Open”, “a.log”, “Log Files (<em>.log)|</em>.log”)<br> 运行结果</p> 
<h5><a id="222MessageBox_435"></a>2.2.2、MessageBox</h5> 
<p>解释<br> 弹出一个消息框，可以定义按钮，使用按钮和文本消息来实现和用户的简单对话。</p> 
<p>语法<br> crt.Dialog.MessageBox(message [, title [icon|buttons]])</p> 
<p>参数:<br> （1）message:消息文字,必选参数，见运行结果中的消息正文。<br> （2）title:弹窗的标题描述，见运行结果中的标题处。<br> （3）icon:警示图标，见结果中的图1到图4。icon的取值有：16(叉号，表示错误)，32(问号，表示确认)，48(叹号，表示警告)，64(提示，表示信息提示)<br> （4）buttons:按钮类型，定义不同的类型，可以有不同的选项，同时鼠标点击不同的选项时也有不同的返回值。button取值范围为0到6,<br> –0：见图5，点击后返回值为1；<br> –1：见图6，点击’确定’时，返回1，点击’取消’时返回2；<br> –2：见图7，点击’终止’时，返回3，点击’重试’时返回4，点击’忽略’时返回5；<br> –3：见图8，点击’是’时，返回6，点击’否’时，返回7，点击’取消’时返回2；<br> –4：见图9，点击’是’时，返回6，点击’否’时，返回7；<br> –5：见图10，点击’重试’时，返回4，点击’取消’时返回2；<br> –6：见图11，点击’取消’时，返回2，点击’重试’时，返回10，点击’继续’，返回11；<br> 代码<br> JS<br> 1 crt.Dialog.MessageBox(“这里是消息框正文”,“这里是标题”,16|0)<br> 运行结果：图1：icon=16</p> 
<p>运行结果：图2：icon=32</p> 
<p>运行结果：图3：icon=48</p> 
<p>运行结果：图4：icon=64</p> 
<p>运行结果：图5：button=0</p> 
<p>运行结果：图6：button=1</p> 
<p>运行结果：图7：button=2</p> 
<p>运行结果：图8：button=3</p> 
<p>运行结果：图9：button=4</p> 
<p>运行结果：图10：button=5</p> 
<p>运行结果：图11：button=6</p> 
<h5><a id="223Prompt_491"></a>2.2.3、Prompt</h5> 
<p>解释<br> 弹出一个输入框，用户可以填写文字，比如填写文件名，填写路径，填写IP地址等。</p> 
<p>语法<br> crt.Dialog.Prompt(message [, title [, default [, isPassword ]]])</p> 
<p>参数:<br> （1）message:消息文字,必选参数，见运行结果中的消息正文。<br> （2）title:弹窗的标题描述，见运行结果中的标题处。<br> （3）default:输入框中的默认值，如果为""，则没有默认值。<br> （4）isPassword:是否要隐藏输入的文字，类似于日常输入密码时显示****<br> (5) 运行结果如下图1，如果点击’ok’，返回输入的字符串，否则返回""<br> 代码<br> JS<br> 1 password = crt.Dialog.Prompt(“这里是正文”,“这里是弹窗标题”,“这是默认值”,true)<br> 运行结果</p> 
<h3><a id="3_511"></a>3、总结</h3> 
<p>以上就是Dialog这个二级属性的所有方法了，对于有和用户有交互需求的地方就可以使用以上几个方法，不过也要注意，虽然这个方法很炫很好看，但是如果过多的使用这些方法，只会适得其反。最后祝大家都能够学会这些方法，其实Dialog这个方法也可以更多的用于调试代码，就和JS中的console.log的功能是一样的，工具很好，学会了运用就能产生很好的效果。</p> 
<h2><a id="SecureCrtScreen_514"></a>三、SecureCrt脚本（三）二级对象之Screen详解</h2> 
<h3><a id="1_515"></a>1、引言</h3> 
<p>本节开始讲解Crt脚本中最常用，也是功能最强大的二级对象Screen的属性和方法，凡是需要和远程设备进行交互的部分都是需要使用Screen对象的属性或方法的，因此本节将是重点。</p> 
<h3><a id="2Screen_518"></a>2、Screen属性和方法</h3> 
<p>属性 方法<br> CurrentColumn Clear<br> CurrentRow Get<br> Columns Get2<br> Rows IgnoreCase<br> IgnoreEscape Send<br> MatchIndex SendKeys<br> Synchronous SendSpecial<br> WaitForCursor<br> WaitForKey<br> WaitForString<br> WaitForStrings<br> ReadString</p> 
<h4><a id="21_533"></a>2.1、属性</h4> 
<h5><a id="211CurrentColumn_534"></a>2.1.1、CurrentColumn</h5> 
<p>解释<br> 返回当前光标处的列坐标，如下图所示的下面显示的数字"9"就是当前光标位于第9列。</p> 
<p>语法<br> crt.Screen.CurrentColumn</p> 
<p>代码<br> JS<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 var curCol = crt.Screen.CurrentColumn;<br> 5 crt.Dialog.MessageBox(curCol);</p> 
<h5><a id="212CurrentRow_551"></a>2.1.2、CurrentRow</h5> 
<p>解释<br> 返回当前光标处的行坐标，如下图所示的下面显示的数字"35"就是当前光标位于第35行。但这个功能有个问题就是当满屏输出后这个值一直表示最大值，等同于底下要讲的子属性四：Rows的值。</p> 
<p>语法<br> crt.Screen.CurrentRow</p> 
<p>代码</p> 
<p>JS<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 var curRow = crt.Screen.CurrentRow;<br> 5 crt.Dialog.MessageBox(curRow);</p> 
<h5><a id="213Columns_569"></a>2.1.3、Columns</h5> 
<p>解释<br> 返回当前屏幕的最大列宽。</p> 
<p>语法<br> crt.Screen.Columns</p> 
<p>代码</p> 
<p>JS<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 var cols = crt.Screen.Columns;<br> 5 crt.Dialog.MessageBox(cols);</p> 
<h5><a id="214Rows_585"></a>2.1.4、Rows</h5> 
<p>解释<br> 返回当前屏幕的最大行宽，这个行宽指的是可见区的，并不是指缓冲区的行宽</p> 
<p>语法<br> crt.Screen.Rows</p> 
<p>代码</p> 
<p>JS<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 var rows = crt.Screen.Rows;<br> 5 crt.Dialog.MessageBox(rows);</p> 
<h5><a id="215IgnoreEscape_601"></a>2.1.5、IgnoreEscape</h5> 
<p>解释<br> 定义当使用WaitForString、WaitForStrings 和 ReadString这三个方法时是否获取Escape字符(也就是特殊控制字符，如"\n")，默认是会获取的。</p> 
<p>语法<br> crt.Screen.IgnoreEscape [ = True | False ]</p> 
<p>参数：</p> 
<p>true|false：当设置为true时不会获取特殊字符，为false时会获取，默认为false。</p> 
<p>代码</p> 
<p>JS<br> 复制代码<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 // 设置false，获取ctrl+c<br> 5 crt.Screen.IgnoreEscape = false;<br> 6 crt.Dialog.MessageBox(crt.Screen.ReadString("\03"));<br> 7<br> 8 // 设置true，不获取ctrl+c<br> 9 crt.Screen.IgnoreEscape = true;<br> 10 crt.Dialog.MessageBox(crt.Screen.ReadString("\03"));<br> 复制代码</p> 
<h5><a id="216MatchIndex_628"></a>2.1.6、MatchIndex</h5> 
<p>解释<br> 当使用WaitForStrings 和 ReadString这两个方法获取字符串时，会根据参数的位置获取返回值，而MatchIndex就是这个位置，从1开始计算，如果没有一个匹配到则返回0，可以根据下面的例子来看。</p> 
<p>语法<br> crt.Screen.MatchIndex</p> 
<p>代码</p> 
<p>JS<br> 复制代码<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 var outPut = crt.Screen.ReadString(“error”, “warning”, “#”, 10);<br> 5 switch (crt.Screen.MatchIndex) {<!-- --><br> 6 case 0:<br> 7 crt.Dialog.MessageBox(“Timed out!”)<br> 8 break;<br> 9 case 1:<br> 10 crt.Dialog.MessageBox(“Found ‘error’”)<br> 11 break;<br> 12 case 2:<br> 13 crt.Dialog.MessageBox(“Found ‘warning’”)<br> 14 break;<br> 15 case 3:<br> 16 crt.Dialog.MessageBox(“Found ‘#’”)<br> 17 break;<br> 18 }<br> 复制代码</p> 
<h5><a id="217Synchronous_659"></a>2.1.7、Synchronous</h5> 
<p>解释<br> 设置屏幕的同步属性，关于该属性需要谨慎对待，若设置为false，则在脚本中使用WaitForString、WaitForStrings或ReadString函数时可能存在丢失一部分数据的现象，而设置为true时不会，但是设置为true后可能会存在屏幕卡顿的情况，出现这两种现象的原因应该是和这几个函数以及打印字符到Screen的机制有关系，具体内部原因不明，就具体使用而言，如果是跑脚本的话最好还是不要设置为true，大量的卡顿看着就会蛋疼了，还可能会造成CRT卡死。</p> 
<p>语法<br> crt.Screen.Synchronous [ = True | False ]</p> 
<p>参数：</p> 
<p>true|false ：默认为false</p> 
<p>代码</p> 
<p>JS<br> 复制代码<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 crt.screen.Synchronous = true;<br> 5 crt.screen.Send("\r\n");<br> 6 crt.screen.ReadString("#");<br> 7 crt.screen.Send("\r\n");<br> 8 crt.screen.WaitForString("#");<br> 9 crt.screen.Send("\r\n");<br> 10 crt.screen.WaitForStrings("#","&gt;");<br> 复制代码</p> 
<h4><a id="22_686"></a>2.2、方法</h4> 
<h5><a id="221Clear_687"></a>2.2.1、Clear()</h5> 
<p>解释<br> 清屏功能</p> 
<p>效果类似下面这个屏幕：</p> 
<p>语法<br> crt.Screen.Clear()</p> 
<p>代码</p> 
<p>JS<br> 复制代码<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 crt.Screen.Send("\r\n");<br> 5 crt.Screen.Send("\r\n");<br> 6 crt.Screen.Send("\r\n");<br> 7 crt.Screen.Send("\r\n");<br> 8 crt.Screen.Clear();<br> 复制代码</p> 
<h5><a id="222get_712"></a>2.2.2、get()</h5> 
<p>解释<br> 按照坐标取出一个矩形框内的屏幕上的字符(即从某行某列开始到其它行其它列)，不包含字符串中的回车换行符，所以这个多用于获取无格式的光标处字符串或某小段特定区域字符串。</p> 
<p>语法<br> crt.Screen.Get(row1, col1, row2, col2)</p> 
<p>代码</p> 
<p>JS<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 var getScr = crt.Screen.Get(31,50,31,56);<br> 5 crt.Dialog.MessageBox(getScr);</p> 
<p>这段代码获取的是(31,50,31,56)这个矩阵内的字符串，即下图中红色框中所示的7483052。</p> 
<h5><a id="223get2_731"></a>2.2.3、get2()</h5> 
<p>解释<br> 按照坐标取出一个矩形框内的屏幕上的字符(即从某行某列开始到其它行其它列)，包含字符串中的回车换行符，所以这个多用于获取大段带格式的字符串。</p> 
<p>语法<br> crt.Screen.Get2(row1, col1, row2, col2)</p> 
<p>代码</p> 
<p>JS<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 var getScr = crt.Screen.Get2(29,1,35,20);<br> 5 crt.Dialog.MessageBox(getScr);</p> 
<p>这段代码获取的是(29,1,35,20)这个矩阵内的所有带回车换行的字符串，即下图中红色框中文字。</p> 
<h5><a id="224IgnoreCase_751"></a>2.2.4、IgnoreCase()</h5> 
<p>解释<br> 使用全局参数设置控制在使用WaitForString、WaitForStrings和ReadString这三个函数时是否对大小写敏感，默认为false指大小写敏感即大小写字符串都会检查，设置为true时则不会检测大小写。</p> 
<p>语法<br> crt.Screen.IgnoreCase</p> 
<p>请注意，语法中并没有带()，根据语法来看，这个不像是方法，但是在CRT的使用说明中标注为了方法而不是属性，且在python的脚本中是当做方法使用的，因此这里先归类为方法，但是在JS脚本中是不带()使用的。<br> 代码</p> 
<p>JS<br> 复制代码<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 crt.Screen.IgnoreCase = true;<br> 5 crt.Screen.Send(“show memory\r\n”);<br> 6 crt.Screen.WaitForString(“more”);<br> 7 crt.Screen.Send("\r\n");<br> 8 crt.Screen.WaitForStrings(“more”,"#");<br> 9 crt.Screen.Send("\r\n");<br> 10 crt.Screen.ReadString(“more”,"#");<br> 复制代码</p> 
<h5><a id="225Send_775"></a>2.2.5、Send()</h5> 
<p>解释<br> 向远端设备或者向屏幕(向屏幕发送的功能是CRT7.2以后版本才提供的)发送字符串。如语法中所表示的，string是待发送的字符串，这个字符串可以包含转码字符比如"\r","\n","\03"(ctrl+c)，当向屏幕上发送字符串时需要指定第二个参数为true。有了向屏幕发送字符串的功能，我们就可以很方便的和用户进行交互了。可以打印出一些我们需要的报错信息之类的。</p> 
<p>语法<br> crt.Screen.Send(string, [, bSendToScreenOnly])</p> 
<p>代码</p> 
<p>JS<br> 复制代码<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 // 向远程设备发送英文命令"show memory"<br> 5 crt.Screen.Send(“show memory\r\n”);<br> 6<br> 7 // 向屏幕上发送字符串<br> 8 crt.Screen.Send(“hello,world!\r\n”,true);<br> 复制代码<br> 可是运行了这段代码后很可能会发现，底下的向屏幕发送的字符串先打印到屏幕上了，效果如下，原因是Crt发送到屏幕的字符串可能先于远程设备返回的字符串，因此会先打印下面的。解决办法就是可以在发送屏幕的这一段前面加一个延时，这样就不会先打印下面的了。</p> 
<h5><a id="226SendKeys_800"></a>2.2.6、SendKeys()</h5> 
<p>解释<br> 向当前窗口发送按键，包含组合按键，比如可以发送类似"CTRL+ALT+C"等这样的组合键，这样写即可：</p> 
<p>crt.screen.sendkeys("^%c");<br> 这个功能需要语言本身支持，目前只有VBS和JS脚本可以使用，Python和Perl都不可以。</p> 
<p>语法<br> crt.Screen.SendKeys(string)</p> 
<p>代码</p> 
<p>JS<br> 复制代码<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 crt.Screen.Clear();<br> 5 crt.screen.sendkeys(“mc~”);<br> 6 crt.Sleep(2000);<br> 7 crt.screen.sendkeys("{f1}");<br> 8 crt.Sleep(2000);<br> 9 crt.screen.sendkeys("{esc}0");<br> 10 crt.Sleep(2000);<br> 11 crt.screen.sendkeys("{esc}0");<br> 12 crt.Sleep(2000);<br> 13 crt.screen.sendkeys(“y”);<br> 复制代码<br> 具体可以有哪些按键，参照下表，修改对应参数即可，可以根据需要自由组合：</p> 
<p>Key(按键)</p> 
<p>Argument(参数)</p> 
<p>SHIFT</p> 
<ul><li></ul> 
<p>CTRL</p> 
<p>^</p> 
<p>ALT</p> 
<p>%</p> 
<p>BACKSPACE</p> 
<p>{BACKSPACE}, {BS}, or {BKSP}</p> 
<p>BREAK</p> 
<p>{BREAK}</p> 
<p>CAPS LOCK</p> 
<p>{CAPSLOCK}</p> 
<p>DEL or DELETE</p> 
<p>{DELETE} or {DEL}</p> 
<p>DOWN ARROW</p> 
<p>{DOWN}</p> 
<p>END</p> 
<p>{END}</p> 
<p>ENTER</p> 
<p>{ENTER} or ~</p> 
<p>ESC</p> 
<p>{ESC}</p> 
<p>HELP</p> 
<p>{HELP}</p> 
<p>HOME</p> 
<p>{HOME}</p> 
<p>INS or INSERT</p> 
<p>{INSERT} or {INS}</p> 
<p>LEFT ARROW</p> 
<p>{LEFT}</p> 
<p>NUM LOCK</p> 
<p>{NUMLOCK}</p> 
<p>PAGE DOWN</p> 
<p>{PGDN}</p> 
<p>PAGE UP</p> 
<p>{PGUP}</p> 
<p>PRINT SCREEN</p> 
<p>{PRTSC}</p> 
<p>RIGHT ARROW</p> 
<p>{RIGHT}</p> 
<p>SCROLL LOCK</p> 
<p>{SCROLLLOCK}</p> 
<p>TAB</p> 
<p>{TAB}</p> 
<p>UP ARROW</p> 
<p>{UP}</p> 
<p>F1, F2, … F16</p> 
<p>{F1}, {F2}, … {F16}</p> 
<p>0, 1, … 9 on number pad</p> 
<p>{NUM_0}, {NUM_1}, … {NUM_9}</p> 
<p>. on number pad</p> 
<p>{NUM_.}</p> 
<p>/ on number pad</p> 
<p>{NUM_/}</p> 
<ul><li>on number pad</li></ul> 
<p>{NUM_*}</p> 
<ul><li>on number pad</li></ul> 
<p>{NUM_-}</p> 
<ul><li>on number pad</li></ul> 
<p>{NUM_+}</p> 
<p>ENTER on number pad</p> 
<p>{NUM_ENTER}</p> 
<p>HOME on number pad</p> 
<p>{NUM_HOME}</p> 
<p>PAGE UP on number pad</p> 
<p>{NUM_PGUP}</p> 
<p>END on number pad</p> 
<p>{NUM_END}</p> 
<p>PAGE DOWN on number pad</p> 
<p>{NUM_PGDN}</p> 
<p>UP ARROW on number pad</p> 
<p>{NUM_UP}</p> 
<p>DOWN ARROW on number pad</p> 
<p>{NUM_DOWN}</p> 
<p>LEFT ARROW on number pad</p> 
<p>{NUM_LEFT}</p> 
<p>RIGHT ARROW on number pad</p> 
<p>{NUM_RIGHT}</p> 
<h5><a id="227SendSpecial_991"></a>2.2.7、SendSpecial()</h5> 
<p>解释<br> 可以发送特殊控制码，这个控制码是Crt内置的功能，具体可以包含的有Menu、Telnet、VT functions功能列表中提供的所有功能，即下图中的这些，有兴趣可以调出new button后看到这些:</p> 
<p>Menu Function:</p> 
<p>Telnet:</p> 
<p>VT functions:</p> 
<p>语法<br> crt.Screen.SendSpecial(string)</p> 
<p>代码</p> 
<p>JS<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3 // 以下是Crt文档中举的例子，具体还有什么我也没有试过，各位可以自己试试<br> 4 crt.screen.SendSpecial(“MENU_PASTE”);<br> 5 crt.screen.SendSpecial(“TN_BREAK”);<br> 6 crt.screen.SendSpecial(“VT_PF1”);</p> 
<h5><a id="228WaitForCursor_1020"></a>2.2.8、WaitForCursor()</h5> 
<p>解释<br> 等待光标移动，当移动时返回值为true，当有超时时间参数且超时时返回false，否则会一直等待光标移动。利用这个功能可以用来判断一个命令的输出是否结束，只不过超时时间是以秒为单位的，对于脚本当中，这个时间还是略显久了。</p> 
<p>语法<br> crt.Screen.WaitForCursor([timeout])</p> 
<p>代码</p> 
<p>JS<br> 复制代码<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 // 每5秒内光标有移动时即发送一个命令<br> 5 while (1) {<!-- --><br> 6 if ( crt.Screen.WaitForCursor(5) ) {<!-- --><br> 7 crt.Screen.Send(“show version\r\n”);<br> 8 }<br> 9 }<br> 复制代码</p> 
<h5><a id="229WaitForKey_1042"></a>2.2.9、WaitForKey()</h5> 
<p>解释<br> 检测有键盘按键时返回true，当有超时时间参数且超时时返回false，否则会一直等待按键。只可惜这个函数不知道输入的键是什么，否则就可以针对性的判断了，它只能检测到有输入而已。</p> 
<p>语法<br> crt.Screen.WaitForKey([timeout])</p> 
<p>代码</p> 
<p>JS<br> 复制代码<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 // 每5秒内有输入时发送一个命令<br> 5 while (1) {<!-- --><br> 6 if ( crt.Screen.WaitForKey(5) ) {<!-- --><br> 7 crt.Screen.Send(“show version\r\n”);<br> 8 }<br> 9 }<br> 复制代码</p> 
<h5><a id="2210WaitForString_1064"></a>2.2.10、WaitForString()</h5> 
<p>解释<br> 一般用于发送命令后等待某字符串，这个字符串只要是屏幕上出现的即可，哪怕是粘贴上去的命令也会同样被检测到，也可以用于等待屏幕的输出打印，不需要先发送命令。不过一般我们使用它来检测的都是发送命令后出现的标识符。</p> 
<p>语法<br> crt.Screen.WaitForString(string,[timeout],[bCaseInsensitive])</p> 
<p>参数：</p> 
<p>1、string，必选参数，等待的字符串，可以是特殊字符比如:\r\n；</p> 
<p>2、timeout，可选参数，超时时间，当检测不到对应字符串时会返回false，没有此参数时会一直等待；</p> 
<p>3、bCaseInsensitive，可选参数，大小写不敏感，默认值是false，表示将检测字符串的大小写，当为true时不检测大小写。</p> 
<p>代码</p> 
<p>JS<br> 复制代码<br> 1 # $language = “JScript”<br> 2 # <span class="katex--inline">KaTeX parse error: Can't use function '\r' in math mode at position 76: …t.Screen.Send("\̲r̲\n"); 6 if ( c…</span>",5) ) {<!-- --><br> 15 crt.Screen.Send(“ls -l\r\n”);<br> 16 }<br> 复制代码</p> 
<h5><a id="2211WaitForStrings_1101"></a>2.2.11、WaitForStrings()</h5> 
<p>解释<br> 和WaitForString是同样的功能，只不过可以等待多个字符串，如果有匹配到某个字符串，则返回值该字符串在这些字符串中的位置，位置值从1开始。若在超时时间内没有匹配到则返回false，没有超时时间时会一直等待。</p> 
<p>语法<br> crt.Screen.WaitForStrings([string1,string2…],[timeout],[bCaseInsensitive])</p> 
<p>参数：</p> 
<p>1、string，必选参数，等待的字符串，最少有一个，可以是特殊字符比如:\r\n；</p> 
<p>2、timeout，可选参数，超时时间，当检测不到对应字符串时会返回false，没有此参数时会一直等待；</p> 
<p>3、bCaseInsensitive，可选参数，大小写不敏感，默认值是false，表示将检测字符串的大小写，当为true时不检测大小写。</p> 
<p>代码</p> 
<p>JS<br> 复制代码<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 var outPut = crt.Screen.WaitForStrings(“error”, “warning”, “#”, 10);<br> 5 var waitIndex = crt.Screen.MatchIndex<br> 6 switch (waitIndex) {<!-- --><br> 7 case 0:<br> 8 crt.Dialog.MessageBox(“Timed out!”)<br> 9 break;<br> 10 case 1:<br> 11 crt.Dialog.MessageBox(“Found ‘error’”)<br> 12 break;<br> 13 case 2:<br> 14 crt.Dialog.MessageBox(“Found ‘warning’”)<br> 15 break;<br> 16 case 3:<br> 17 crt.Dialog.MessageBox(“Found ‘#’”)<br> 18 break;<br> 19 }<br> 复制代码<br> 上面也用到了crt.Screen.MatchIndex功能，具体可以见上面的2.1.6节。</p> 
<h5><a id="2212ReadString_1153"></a>2.2.12、ReadString()</h5> 
<p>解释<br> 这个功能和上面的WaitForStrings函数有些类似，都是等待某几个字符串出现，不过不同的是，ReadString函数还会读取字符串之前的所有出现的字符，这个功能可以很方便的用于发送一个命令后获取这个命令的输出结果，不过这个函数也不是特别稳定，因为很可能存在命令的输出结果很快，而屏幕又没有捕捉到时，要么会由于超时而返回false，要么会一直等待，最终返回的都是空值，因此完全依靠该函数获取命令的输出的话并不是很把稳(如果程序对于稳定性要求很高的话，那么最好还是不要依赖这个函数。)</p> 
<p>语法<br> crt.Screen.ReadString([string1,string2…],[timeout],[bCaseInsensitive])</p> 
<p>参数：</p> 
<p>1、string，必选参数，等待的字符串，最少有一个，可以是特殊字符比如:\r\n；</p> 
<p>2、timeout，可选参数，超时时间，当检测不到对应字符串时会返回false，没有此参数时会一直等待；</p> 
<p>3、bCaseInsensitive，可选参数，大小写不敏感，默认值是false，表示将检测字符串的大小写，当为true时不检测大小写。</p> 
<p>代码</p> 
<p>JS<br> 复制代码<br> 1 # $language = “JScript”<br> 2 # $interface = “1.0”<br> 3<br> 4 // 发送命令并根据提示符获取命令的输出。<br> 5 crt.Screen.Send(“show version\r\n”);<br> 6 crt.Screen.WaitForString(“show version”,2);<br> 7 var outPut = crt.Screen.ReadString(“error”, “warning”, “#”, 10);<br> 8 var waitIndex = crt.Screen.MatchIndex<br> 9 switch (waitIndex) {<!-- --><br> 10 case 0:<br> 11 crt.Dialog.MessageBox(“Timed out!”)<br> 12 break;<br> 13 case 1:<br> 14 crt.Dialog.MessageBox(“Found ‘error’”)<br> 15 break;<br> 16 case 2:<br> 17 crt.Dialog.MessageBox(“Found ‘warning’”)<br> 18 break;<br> 19 case 3:<br> 20 crt.Dialog.MessageBox(“命令的输出时:”+outPut);<br> 21 break;<br> 22 }<br> 复制代码<br> 在这个举例中的第6行可以看到还使用了WaitForString，为什么要使用这个，有两个方面原因，一是确定命令已经被发送到了远端设备，二是确保命令的输出结果中没有改命令，而仅仅是该命令的输出结果。</p> 
<h3><a id="3_1208"></a>3、总结</h3> 
<p>以上就是Screen这个二级属性的所有子属性和子方法了，这里面的功能都是CRT系列中最最重要的功能，也是最常用的功能，大家可以平时在写脚本时多琢磨这些函数的用法和奇妙之处。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fef0ad776b5534811297b5701c5f6454/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">HTML无法访问https图片,终极解决本地https域名访问ERR_SSL_PROTOCOL_ERROR</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ecfca858110fda7471745ca177ab6a7f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">html获取QQ头像接口,JS获得QQ号码的昵称,头像,生日的简单实例</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>