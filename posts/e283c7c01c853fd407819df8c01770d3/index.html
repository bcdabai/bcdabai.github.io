<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ZYNQ系列（十一）ZYNQ 使用RS9900 USB转网口 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ZYNQ系列（十一）ZYNQ 使用RS9900 USB转网口" />
<meta property="og:description" content="ZYNQ系列（十一）ZYNQ 使用RS9900 USB转网口 第一章 Petalinux创建工程
第二章 Petalinux-config配置说明
第三章 QSPI自启动工程
第四章 将文件打包进文件系统
第五章 将文件打包进文件系统
第六章 ZYNQ下使用CMAKE创建APP工程
第七章 ZYNQ下使用CMAKE创建QT工程
第八章 ZYNQ下使用BOA
第九章 ZYNQ开机的一些配置
第十章 ZYNQ使用linux自带的按键驱动程序
第十一章 ZYNQ 使用RS9900 USB转网口
文章目录 ZYNQ系列（十一）ZYNQ 使用RS9900 USB转网口前言USB中CDC-ECM的了解和配置Ethernet Networking Control Model实现验证 前言 SR9900是一个高集成度、超低功耗、单芯片USB2.0转10/100M以太网控制电路。为各类应用增加低成本、小型封装、即插即用的快速以太网功能，可用于台式电脑、笔计本电脑、超便携式电脑、平板电脑、托架/端口复制器/扩展坞、游戏机、智能家居及任何有USB接口的嵌入式设备。
USB中CDC-ECM的了解和配置 USB中典型类及子类：
Ethernet Networking Control Model 以太网控制模型是用在主从设备间的以太网帧数据的交换。通信类接口用于配置和管理以太网程序，程序中包括的“以太网控制模型”子类码是通信类接口描写叙述定义。
数据接口则用于在USB总线上交换USB数据包。这些USB数以的包封装了完整的以太网包。CRC校验和不能包括在以太网收发数据包中。
检验失败的帧数据不能再发送到主机。这意味着设备必须可以缓冲至少一个完整的以太网帧数据。
实现 在vivado工程中使能usb0.
Linux内核配置支持CDC-ECM：
Device Drivers ---&gt; [*] Network device support ---&gt; USB Network Adapters ---&gt; &lt;*&gt; Multi-purpose USB Networking Framework -*- CDC Ethernet support (smart devices such as cable modems) 在设备树中使能usb的驱动。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e283c7c01c853fd407819df8c01770d3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-30T16:31:49+08:00" />
<meta property="article:modified_time" content="2021-04-30T16:31:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ZYNQ系列（十一）ZYNQ 使用RS9900 USB转网口</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="ZYNQZYNQ_RS9900_USB_1"></a>ZYNQ系列（十一）ZYNQ 使用RS9900 USB转网口</h2> 
<p><font color="#999AAA">第一章 Petalinux创建工程<br> <font color="#999AAA">第二章 Petalinux-config配置说明<br> <font color="#999AAA">第三章 QSPI自启动工程<br> <font color="#999AAA">第四章 将文件打包进文件系统<br> <font color="#999AAA">第五章 将文件打包进文件系统<br> <font color="#999AAA">第六章 ZYNQ下使用CMAKE创建APP工程<br> <font color="#999AAA">第七章 ZYNQ下使用CMAKE创建QT工程<br> <font color="#999AAA">第八章 ZYNQ下使用BOA<br> <font color="#999AAA">第九章 ZYNQ开机的一些配置<br> <font color="#999AAA">第十章 ZYNQ使用linux自带的按键驱动程序<br> <font color="#999AAA">第十一章 ZYNQ 使用RS9900 USB转网口</font></font></font></font></font></font></font></font></font></font></font></p> 
<hr size='1"' color="#000000"> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#ZYNQZYNQ_RS9900_USB_1" rel="nofollow">ZYNQ系列（十一）ZYNQ 使用RS9900 USB转网口</a></li><li><a href="#_20" rel="nofollow">前言</a></li><li><ul><li><a href="#USBCDCECM_22" rel="nofollow">USB中CDC-ECM的了解和配置</a></li><li><a href="#Ethernet_Networking_Control_Model_25" rel="nofollow">Ethernet Networking Control Model</a></li><li><a href="#_32" rel="nofollow">实现</a></li><li><a href="#_61" rel="nofollow">验证</a></li></ul> 
 </li></ul> 
</div> 
<br> 
<p></p> 
<hr size='1"' color="#000000"> 
<h2><a id="_20"></a>前言</h2> 
<p>SR9900是一个高集成度、超低功耗、单芯片USB2.0转10/100M以太网控制电路。为各类应用增加低成本、小型封装、即插即用的快速以太网功能，可用于台式电脑、笔计本电脑、超便携式电脑、平板电脑、托架/端口复制器/扩展坞、游戏机、智能家居及任何有USB接口的嵌入式设备。</p> 
<h3><a id="USBCDCECM_22"></a>USB中CDC-ECM的了解和配置</h3> 
<p>USB中典型类及子类：<br> <img src="https://images2.imgbox.com/88/50/JCeVTZ9g_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="Ethernet_Networking_Control_Model_25"></a>Ethernet Networking Control Model</h3> 
<p>以太网控制模型是用在主从设备间的以太网帧数据的交换。通信类接口用于配置和管理以太网程序，程序中包括的“以太网控制模型”子类码是通信类接口描写叙述定义。</p> 
<p>数据接口则用于在USB总线上交换USB数据包。这些USB数以的包封装了完整的以太网包。CRC校验和不能包括在以太网收发数据包中。</p> 
<p>检验失败的帧数据不能再发送到主机。这意味着设备必须可以缓冲至少一个完整的以太网帧数据。</p> 
<h3><a id="_32"></a>实现</h3> 
<ol><li> <p>在vivado工程中使能usb0.</p> </li><li> <p>Linux内核配置支持CDC-ECM：</p> <pre><code> Device Drivers  ---&gt;
 	[*] Network device support  ---&gt;
 		USB Network Adapters  ---&gt;
 			&lt;*&gt; Multi-purpose USB Networking Framework
 			 -*-   CDC Ethernet support (smart devices such as cable modems)
</code></pre> </li><li> <p>在设备树中使能usb的驱动。</p> <pre><code> / {
 	model = "Zynq ALINX Development Board";
 	compatible = "alinx,zynq-an0701", "xlnx,zynq-7000";

 	usb_phy0: usb_phy@0 {
 	compatible = "ulpi-phy";
 	#phy-cells = &lt;0&gt;;
 	reg = &lt;0xe0002000 0x1000&gt;;
 	view-port = &lt;0x0170&gt;;
 	drv-vbus;
 	};
 };
 &amp;usb0 {	
 dr_mode = "host";
 usb-phy = &lt;&amp;usb_phy0&gt;;
 };
</code></pre> </li></ol> 
<h3><a id="_61"></a>验证</h3> 
<p>将重新生成的内核下入开发板，当接入usb转网口设备时，linux打印</p> 
<pre><code>	usb 1-1: new high-speed USB device number 3 using ci_hdrc
	cdc_ether 1-1:2.0 eth1: register 'cdc_ether' at usb-ci_hdrc.0-1, CDC Ethernet Device, 00:e0:99:00:05:af
</code></pre> 
<p>证明完成，下一步</p> 
<pre><code>	ifconfig eth1 192.168.x.xxx
</code></pre> 
<p>配置网关，则在ifconfig中就可以看到eth1这个网口了。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/12435b32e2a181c058c94f0069cdbf52/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C&#43;&#43;：信号与槽</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7dd88c1dc6308e7aab1af86d3e08cf88/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Unity(5)-UGUI(1)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>