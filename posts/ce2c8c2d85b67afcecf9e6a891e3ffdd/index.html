<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>《机器学习实战》第二章，KNN算法在jupyter中实验 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="《机器学习实战》第二章，KNN算法在jupyter中实验" />
<meta property="og:description" content="1、首先在jupyter中New一个Untitle.ipynb，然后将它重命名为kNN.py，接着在kNN.py中输入一下代码(课本代码)：
注：以下代码中，存在我自己的测试数据文件的路径，你们要改为自己测试数据文件的路径
from numpy import * import operator def createDataSet(): group = array([[1.0,1.1],[1.0,1.0],[0,0],[0,0.1]]) labels = [&#39;A&#39;,&#39;A&#39;,&#39;B&#39;,&#39;B&#39;] return group, labels def classify0(inX, dataSet, labels, k): dataSetSize = dataSet.shape[0] diffMat = tile(inX, (dataSetSize, 1)) - dataSet sqdiffMat = diffMat**2 sqdistance = sqdiffMat.sum(axis=1) #print(sqdistance) distance = sqdistance**0.5 sortedDistIndex = distance.argsort() classCount = {} for i in range(k): voteIlabel = labels[sortedDistIndex[i]] classCount[voteIlabel] = classCount.get(voteIlabel, 0) &#43; 1 sortedClassCount = sorted(classCount.items(), key=operator.itemgetter(1), reverse=True) return sortedClassCount[0][0] def file2matrix(filename): fr = open(filename) arrayOLines = fr." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ce2c8c2d85b67afcecf9e6a891e3ffdd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-04-22T00:21:40+08:00" />
<meta property="article:modified_time" content="2018-04-22T00:21:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">《机器学习实战》第二章，KNN算法在jupyter中实验</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p align="center"></p> 
<p><span style="font-family:'宋体';">1、首先在</span>jupyter中New一个Untitle.ipynb，然后将它重命名为kNN.py，接着在kNN.py中输入一下代码(课本代码)：</p> 
<p style="text-align:center;"><img src="https://images2.imgbox.com/76/cf/3bZG2O2u_o.png" alt=""><br></p> 
<p><span style="color:rgb(255,0,0);">注：以下代码中，存在我自己的测试数据文件的路径，你们要改为自己测试数据文件的路径</span></p> 
<br> 
<pre><code class="language-python">from numpy import *

import operator


def createDataSet():

    group = array([[1.0,1.1],[1.0,1.0],[0,0],[0,0.1]])

    labels = ['A','A','B','B']

    return group, labels



def classify0(inX, dataSet, labels, k):  
    dataSetSize = dataSet.shape[0]  
    diffMat = tile(inX, (dataSetSize, 1)) - dataSet   
    sqdiffMat = diffMat**2  
    sqdistance = sqdiffMat.sum(axis=1)  
    #print(sqdistance)  
    distance = sqdistance**0.5  
    sortedDistIndex = distance.argsort()  
    classCount = {}  
    for i in range(k):  
        voteIlabel = labels[sortedDistIndex[i]]  
        classCount[voteIlabel] = classCount.get(voteIlabel, 0) + 1  
    sortedClassCount = sorted(classCount.items(), key=operator.itemgetter(1), reverse=True)  
    return sortedClassCount[0][0]

def file2matrix(filename):
    fr = open(filename)
    arrayOLines = fr.readlines()
    numberOfLines = len(arrayOLines)
    returnMat = zeros((numberOfLines,3))
    classLabelVector = []
    index = 0 
    for line in arrayOLines:
        line = line.strip()
        listFromLine = line.split('\t')
        returnMat[index,:] = listFromLine[0:3]
        classLabelVector.append(int(listFromLine[-1]))
        index += 1
    return returnMat,classLabelVector

def autoNorm(dataSet):
    minVals = dataSet.min(0)
    maxVals = dataSet.max(0)
    ranges = maxVals - minVals
    normDataSet = zeros(shape(dataSet))
    m = dataSet.shape[0]
    normDataSet = dataSet - tile(minVals, (m,1))
    normDataSet = normDataSet/tile(ranges, (m,1))
    return normDataSet, ranges, minVals

def datingClassTest():

    hoRatio = 0.1
    datingDataMat,datingLabels = file2matrix('F:\Softwares\Python\datingTestSet2.txt')
    normMat, ranges, minVals = autoNorm(datingDataMat)
    m = normMat.shape[0]
    numTestVecs = int(m*hoRatio)
    errorCount = 0.0
    for i in range(numTestVecs):
        classifierResult = classify0(normMat[i,:],normMat[numTestVecs:m,:],datingLabels[numTestVecs:m],3)
        print ("the classifier came back with: %d,the real answer is: %d"%(classifierResult, datingLabels[i]))
        if (classifierResult != datingLabels[i]): errorCount += 1.0
    print ("the total error rate is: %f" % (errorCount/float(numTestVecs)))

def classifyPerson():  
    resultList = ["not at all","in small does","in large does"]  
    percentTats = float(input("percentage of time spent playing video games?"))  
    ffMiles = float(input("frequent flier miles earned per year?"))  
    iceCream = float(input("liters of ice cream consumes per year?"))  
    datingDataMat,datingLabels = file2matrix('F:\Softwares\Python\datingTestSet2.txt')  
    normMat,ranges,minVals = autoNorm(datingDataMat)  
    inArr = array([ffMiles,percentTats,iceCream])  
    classifierResult = classify0(((inArr-minVals)/ranges),datingDataMat,datingLabels,3)  
    print("You will probably like this person:",resultList[classifierResult - 1])

def img2vector(filename):

    returnVect = zeros((1,1024))

    fr = open(filename)

    for i in range(32):

        lineStr = fr.readline()

        for j in range(32):

            returnVect[0,32*i+j] = int(lineStr[j])

    return returnVect

from os import listdir
def handwritingClassTest():
    hwLabels = []
    trainingFileList = listdir('F:/Softwares/Python/trainingDigits')
    m = len(trainingFileList)
    trainingMat = zeros((m,1024))
    for i in range(m):
        fileNameStr = trainingFileList[i]
        fileStr = fileNameStr.split('.')[0]
        classNumStr = int(fileStr.split('_')[0])
        hwLabels.append(classNumStr)
        trainingMat[i,:] = img2vector('F:/Softwares/Python/trainingDigits/%s' % fileNameStr)
    testFileList = listdir('F:/Softwares/Python/testDigits')
    errorCount = 0.0
    mTest = len(testFileList)
    for i in range(mTest):
        fileNameStr = testFileList[i]
        fileStr = fileNameStr.split('.')[0]
        classNumStr = int(fileStr.split('_')[0])
        vectorUnderTest = img2vector('F:/Softwares/Python/testDigits/%s' % fileNameStr)
        classifierResult = classify0(vectorUnderTest, trainingMat, hwLabels, 3)
        print ("the classifier came back with: %d, the real answer is: %d" % (classifierResult, classNumStr))
        if (classifierResult != classNumStr):errorCount += 1.0
    print ("\nthe total number of errors is: %d" % errorCount)
    print ("\nthe total error rate is: %f" % (errorCount/float(mTest)))</code></pre> 
<div style="text-align:center;"> 
 <img src="https://images2.imgbox.com/db/db/Hv61USjq_o.png" alt=""> 
</div> 
<div style="text-align:center;"> 
 <p>2、<span style="font-family:'宋体';">将测试数据文件放在和</span>kNN.py同一个目录下。或者像我一样，直接在代码中修改成自己的测试文件路径</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/ed/65/Ulb9gBHm_o.png" alt=""><br></p> 
 <p style="text-align:center;"></p> 
 <p align="justify"><span style="color:rgb(255,0,0);">注：还有几处，自己注意修改</span></p> 
 <p align="justify"><span style="color:rgb(255,0,0);"> </span></p> 
 <p>3、<span style="font-family:'宋体';">现在可以开始测试数据，在</span>jupyter中再创建一个文件，命名为testKNN.ipynb</p> 
 <p align="center"></p> 
 <p align="center"><img src="https://images2.imgbox.com/60/5f/0I2UOrqq_o.png" alt=""> </p> 
 <p align="center"><br></p> 
 <p align="center"><img src="https://images2.imgbox.com/a8/16/81CdVvLb_o.png" alt=""></p> 
 <p align="center"><br></p> 
 <p align="center"><img src="https://images2.imgbox.com/f8/a0/JWCBKdOM_o.png" alt=""></p> 
 <p align="center"><br></p> 
 <p align="center"><img src="https://images2.imgbox.com/af/c6/Sk4R24UG_o.png" alt=""></p> 
 <p align="center"><br></p> 
 <p align="center"><img src="https://images2.imgbox.com/8a/62/qwFtwmWk_o.png" alt=""></p> 
 <p align="center"><br></p> 
 <p align="center"><img src="https://images2.imgbox.com/3f/4c/hpPBlBD8_o.png" alt=""></p> 
 <p align="center"><br></p> 
 <p align="center"><img src="https://images2.imgbox.com/20/ac/g3JHbCLC_o.png" alt=""></p> 
 <p align="center"><br></p> 
 <p align="center"><img src="https://images2.imgbox.com/6e/3b/jvwEK9N9_o.png" alt=""></p> 
 <p align="center"><br></p> 
 <p align="center"><img src="https://images2.imgbox.com/3f/e5/ZmSzI4gP_o.png" alt=""></p> 
 <p align="center"><br></p> 
</div> 
<div style="text-align:center;"> 
 <br> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/692afeebb235a1f1c2705ecb3b7dfcfd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">《机器学习实战》第二章，之K-邻近算法-实验</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c2f7fbe7318e989f20fb1111ddb76d44/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">python偏函数</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>