<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Springboot输出PDF文件 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Springboot输出PDF文件" />
<meta property="og:description" content="前言 有个人（死需求）跑过来跟你说，这些都给我输出成报告，pdf格式的，所以就有了下面这个，做一下笔记，以后有用直接过来拿。在网上找了一下，发现大家都是在用itext。
iText是著名的开放项目，是用于生成PDF文档的一个java类库。通过iText不仅可以生成PDF或rtf的文档，而且可以将XML、Html文件转化为PDF文件。
http://itextpdf.com/
maven依赖 &lt;dependency&gt; &lt;groupId&gt;com.itextpdf&lt;/groupId&gt; &lt;artifactId&gt;itextpdf&lt;/artifactId&gt; &lt;version&gt;5.5.10&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.itextpdf&lt;/groupId&gt; &lt;artifactId&gt;itext-asian&lt;/artifactId&gt; &lt;version&gt;5.2.0&lt;/version&gt; &lt;/dependency&gt; 基础操作 itext有很多功能，这里先说基本的操作。其他更多高级的操作，可以继续看下面的。
基本处理步骤如下伪代码：
//Step 1—Create a Document. Document document = new Document(); //Step 2—Get a PdfWriter instance. PdfWriter.getInstance(document, new FileOutputStream(FILE_DIR &#43; &#34;createSamplePDF.pdf&#34;)); //Step 3—Open the Document. document.open(); //Step 4—Add content. document.add(new Paragraph(&#34;Hello World&#34;)); //Step 5—Close the Document. document.close(); 1、直接输出数据到pdf文件 这里有个特别注意的是，中文必须要指定字体，即是BaseFont
public class PDFReport { private final static String REPORT_PATH = &#34;C:/air-navi-monitor/report&#34;; private static void exportReport() { BaseFont bf; Font font = null; Font font2 = null; try { bf = BaseFont." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/556d7349c30e3b97f4db2c264d82ed8a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-09-25T20:29:16+08:00" />
<meta property="article:modified_time" content="2019-09-25T20:29:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Springboot输出PDF文件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/0b/fb/IdbL1IvR_o.png" alt=""></p> 
<h4><a id="_3"></a>前言</h4> 
<p>有个人（死需求）跑过来跟你说，这些都给我输出成报告，pdf格式的，所以就有了下面这个，做一下笔记，以后有用直接过来拿。在网上找了一下，发现大家都是在用itext。<br> iText是著名的开放项目，是用于生成PDF文档的一个java类库。通过iText不仅可以生成PDF或rtf的文档，而且可以将XML、Html文件转化为PDF文件。</p> 
<p><a href="http://itextpdf.com/" rel="nofollow">http://itextpdf.com/</a></p> 
<h4><a id="maven_10"></a>maven依赖</h4> 
<pre><code>        &lt;dependency&gt;
            &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
            &lt;artifactId&gt;itextpdf&lt;/artifactId&gt;
            &lt;version&gt;5.5.10&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
            &lt;artifactId&gt;itext-asian&lt;/artifactId&gt;
            &lt;version&gt;5.2.0&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre> 
<h4><a id="_27"></a>基础操作</h4> 
<p>itext有很多功能，这里先说基本的操作。其他更多高级的操作，可以继续看下面的。<br> 基本处理步骤如下伪代码：</p> 
<pre><code>//Step 1—Create a Document.  
Document document = new Document();  
//Step 2—Get a PdfWriter instance.  
PdfWriter.getInstance(document, new FileOutputStream(FILE_DIR + "createSamplePDF.pdf"));  
//Step 3—Open the Document.  
document.open();  
//Step 4—Add content.  
document.add(new Paragraph("Hello World"));  
//Step 5—Close the Document.  
document.close();  
</code></pre> 
<h5><a id="1pdf_44"></a>1、直接输出数据到pdf文件</h5> 
<p>这里有个特别注意的是，中文必须要指定字体，即是BaseFont</p> 
<pre><code>public class PDFReport {

    private final static String REPORT_PATH = "C:/air-navi-monitor/report";

    private static void exportReport() {
        BaseFont bf;
        Font font = null;
        Font font2 = null;
        try {
          
            bf = BaseFont.createFont("STSong-Light", "UniGB-UCS2-H",
                    BaseFont.NOT_EMBEDDED);//创建字体
            font = new Font(bf, 12);//使用字体
            font2 = new Font(bf, 12, Font.BOLD);//使用字体
        } catch (Exception e) {
            e.printStackTrace();
        }
        Document document = new Document();
        try {
            PdfWriter.getInstance(document, new FileOutputStream("E:/2.pdf"));
            document.open();
            Paragraph elements = new Paragraph("常州武进1区飞行报告", font2);
            elements.setAlignment(Paragraph.ALIGN_CENTER);
            document.add(elements);
            Image png = Image.getInstance("E:\\test.png");
            png.setAlignment(Image.ALIGN_CENTER);
            document.add(png);
            document.add(new Paragraph("任务编号：20190701        开始日期：20190701", font));
            document.add(new Paragraph("任务名称：常州武进1区     结束日期：20190701", font));
            document.add(new Paragraph("平均飞行高度：100m        平均飞行速度：100km/h", font));
            document.add(new Paragraph("任务面积：1000㎡      结束日期：20190701", font));
            document.add(new Paragraph("飞行总时长：1000㎡", font));
            document.addCreationDate();

            document.close();
        } catch (Exception e) {
            System.out.println("file create exception");
        }
    }

    /**
     * 生成pdf文件
     *
     * @param missionReport
     * @return
     */
    public static String exportReport(MissionReportTb missionReport) throws AirNaviException {
        String pdfPath = null;
        String imgPath = Shape2Image.getImgPath(missionReport.getMissionID());
//        String imgPath = "E:\\test.png";
        String finalReportStr = missionReport.getMissionReport();
        MissionReport finalReport = JSONObject.parseObject(finalReportStr, MissionReport.class);
        BaseFont bf;
        Font font = null;
        Font font2 = null;
        try {
            bf = BaseFont.createFont("STSong-Light", "UniGB-UCS2-H",
                    BaseFont.NOT_EMBEDDED);//创建字体
            font = new Font(bf, 12);//使用字体
            font2 = new Font(bf, 12, Font.BOLD);//使用字体
        } catch (Exception e) {
            e.printStackTrace();
        }
        Document document = new Document();
        try {
            File dir = new File(REPORT_PATH);
            if (!dir.exists()) {
                dir.mkdirs();
            }
            File file = new File(REPORT_PATH + File.separator + missionReport.getMissionID() + ".pdf");
            if (!file.exists()) {
                file.createNewFile();
            }
            PdfWriter.getInstance(document, new FileOutputStream(REPORT_PATH + File.separator + missionReport.getMissionID() + ".pdf"));
            document.open();
            Paragraph elements = new Paragraph(missionReport.getMissionName() + "飞行报告", font2);
            elements.setAlignment(Paragraph.ALIGN_CENTER);
            document.add(elements);
            Image png = Image.getInstance(imgPath);
//            https://blog.csdn.net/lingbo89/article/details/76177825
            float documentWidth = document.getPageSize().getWidth() - document.leftMargin() - document.rightMargin();
            float documentHeight = documentWidth / 580 * 320;//重新设置宽高
            png.scaleAbsolute(documentWidth, documentHeight);//重新设置宽高
            png.scalePercent(50);
            // 根据域的大小缩放图片
//            image.scaleToFit(signRect.getWidth(), signRect.getHeight());
            png.setAlignment(Image.ALIGN_CENTER);
            document.add(png);
            document.add(new Paragraph("任务编号：" + missionReport.getMissionCode() + ",开始日期：" + finalReport.getStartTime(), font));
            document.add(new Paragraph("任务名称：" + missionReport.getMissionName() + ",结束日期：" + finalReport.getEndTime(), font));
            document.add(new Paragraph("平均飞行高度：" + finalReport.getAvgFlightHeight() + "m" + ",平均飞行速度：" + finalReport.getAvgFlightSpeed() + "km/h", font));
            document.add(new Paragraph("任务面积：" + finalReport.getMissionArea() + "㎡" + ",飞行总时长：" + finalReport.getFlightDuration() + "min", font));
            document.addCreationDate();
            document.close();
            pdfPath = file.getAbsolutePath();
        } catch (Exception e) {
            e.printStackTrace();
            log.error(e.getMessage());
            System.out.println("file create exception");
            throw new AirNaviException("生成PDF失败：" + e.getMessage());
        }

        return pdfPath;
    }

    public static void main(String[] args) throws AirNaviException {
        String report = "{\"detailMissionReport\":[{\"avgFlightHeight\":119.7,\"avgFlightSpeed\":71.1,\"endPoint\":\"113.27484,22.86843\",\"endTime\":\"2019-09-17 17:47:07\",\"flightDuration\":9,\"reportID\":1,\"startPoint\":\"113.31429,22.78240\",\"startTime\":\"2019-09-17 17:38:03\",\"statisticsTimes\":505}],\"missionReport\":{\"avgFlightHeight\":119.7,\"avgFlightSpeed\":71.1,\"endPoint\":\"113.31429,22.78240\",\"endTime\":\"2019-09-17 17:47:07\",\"flightDuration\":9,\"reportID\":1,\"startPoint\":\"113.31429,22.78240\",\"startTime\":\"2019-09-17 17:38:03\",\"statisticsTimes\":0},\"missionArea\":0.0,\"missionCode\":\"M001\",\"missionID\":\"888813ddef6646cd9bfaba5abb748a43\",\"missionName\":\"德胜航点M008\",\"missionStatus\":1,\"missionType\":0,\"plannedFlightTime\":\"20190909\"}";
        MissionReportTb missionReportTb = JSONObject.parseObject(report, MissionReportTb.class);
        exportReport(missionReportTb);
    }

}
</code></pre> 
<h5><a id="2pdf_164"></a>2、根据模板生成pdf文件并导出</h5> 
<p>首先你的制作一个pdf模板：</p> 
<p>1.先用word做出模板界面</p> 
<p><img src="https://images2.imgbox.com/85/d0/X1OZt6rR_o.png" alt=""></p> 
<p>2.文件另存为pdf格式文件</p> 
<p><img src="https://images2.imgbox.com/e9/36/6nZhFsFM_o.png" alt=""></p> 
<p>3.通过Adobe Acrobat pro软件打开刚刚用word转换成的pdf文件（注：如果没有这个软件可以通过我的百度云下载，链接：http://pan.baidu.com/s/1pL2klzt）如果无法下载可以Google一下。</p> 
<p><img src="https://images2.imgbox.com/05/7e/f0yeZ0sC_o.png" alt=""></p> 
<p>4.点击右边的"准备表单"按钮，选择"测试.pdf"选择开始</p> 
<p>进去到编辑页面，打开后它会自动侦测并命名表单域，右键表单域，点击属性，出现文本域属性对话框（其实无需任何操作，一般情况下不需要修改什么东西，至少我没有修改哦。如果你想修改fill1等信息，可以进行修改）</p> 
<p><img src="https://images2.imgbox.com/27/06/tDj3cvdb_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/3a/9f/83FHfj34_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/aa/32/Lvxau0FY_o.png" alt=""></p> 
<p>5.做完上面的工作后，直接"另存为"将pdf存储就可以</p> 
<p><img src="https://images2.imgbox.com/5c/73/fRYm2Ds2_o.png" alt=""></p> 
<p>以上部分是制作pdf模板操作，上述完成后，就开始通过程序来根据pdf模板生成pdf文件了，上java程序：</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Snippet</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">// 利用模板生成pdf</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">fillTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">// 模板路径</span>
        String templatePath <span class="token operator">=</span> <span class="token string">"E:/测试3.pdf"</span><span class="token punctuation">;</span>
<span class="token comment">// 生成的新文件路径</span>
        String newPDFPath <span class="token operator">=</span> <span class="token string">"E:/ceshi.pdf"</span><span class="token punctuation">;</span>
        PdfReader reader<span class="token punctuation">;</span>
        FileOutputStream out<span class="token punctuation">;</span>
        ByteArrayOutputStream bos<span class="token punctuation">;</span>
        PdfStamper stamper<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>newPDFPath<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 输出流</span>
            reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfReader</span><span class="token punctuation">(</span>templatePath<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 读取pdf模板</span>
            bos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            stamper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfStamper</span><span class="token punctuation">(</span>reader<span class="token punctuation">,</span> bos<span class="token punctuation">)</span><span class="token punctuation">;</span>
            AcroFields form <span class="token operator">=</span> stamper<span class="token punctuation">.</span><span class="token function">getAcroFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            String<span class="token punctuation">[</span><span class="token punctuation">]</span> str <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"123456789"</span><span class="token punctuation">,</span> <span class="token string">"TOP__ONE"</span><span class="token punctuation">,</span> <span class="token string">"男"</span><span class="token punctuation">,</span> <span class="token string">"1991-01-01"</span><span class="token punctuation">,</span> <span class="token string">"130222111133338888"</span><span class="token punctuation">,</span> <span class="token string">"河北省保定市"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Iterator<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> it <span class="token operator">=</span> form<span class="token punctuation">.</span><span class="token function">getFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                String name <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                form<span class="token punctuation">.</span><span class="token function">setField</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> str<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            stamper<span class="token punctuation">.</span><span class="token function">setFormFlattening</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 如果为false那么生成的PDF文件还能编辑，一定要设为true</span>
            stamper<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Document doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            PdfCopy copy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfCopy</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
            doc<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            PdfImportedPage importPage <span class="token operator">=</span> copy<span class="token punctuation">.</span><span class="token function">getImportedPage</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PdfReader</span><span class="token punctuation">(</span>bos<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            copy<span class="token punctuation">.</span><span class="token function">addPage</span><span class="token punctuation">(</span>importPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
            doc<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">DocumentException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">fillTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>运行结果如下</p> 
<p><img src="https://images2.imgbox.com/f9/87/g7DDI85Q_o.png" alt=""></p> 
<h4><a id="_252"></a>更多操作</h4> 
<p>1、页面大小,页面背景色,页边空白,Title,Author,Subject,Keywords</p> 
<p>核心代码：</p> 
<pre><code class="prism language-java"><span class="token comment">//页面大小  </span>
Rectangle rect <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span>PageSize<span class="token punctuation">.</span>B5<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token comment">//页面背景色  </span>
rect<span class="token punctuation">.</span><span class="token function">setBackgroundColor</span><span class="token punctuation">(</span>BaseColor<span class="token punctuation">.</span>ORANGE<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
Document doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span>rect<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
PdfWriter writer <span class="token operator">=</span> PdfWriter<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token comment">//PDF版本(默认1.4)  </span>
writer<span class="token punctuation">.</span><span class="token function">setPdfVersion</span><span class="token punctuation">(</span>PdfWriter<span class="token punctuation">.</span>PDF_VERSION_1_2<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token comment">//文档属性  </span>
doc<span class="token punctuation">.</span><span class="token function">addTitle</span><span class="token punctuation">(</span><span class="token string">"Title@sample"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
doc<span class="token punctuation">.</span><span class="token function">addAuthor</span><span class="token punctuation">(</span><span class="token string">"Author@rensanning"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
doc<span class="token punctuation">.</span><span class="token function">addSubject</span><span class="token punctuation">(</span><span class="token string">"Subject@iText sample"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
doc<span class="token punctuation">.</span><span class="token function">addKeywords</span><span class="token punctuation">(</span><span class="token string">"Keywords@iText"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
doc<span class="token punctuation">.</span><span class="token function">addCreator</span><span class="token punctuation">(</span><span class="token string">"Creator@iText"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token comment">//页边空白  </span>
doc<span class="token punctuation">.</span><span class="token function">setMargins</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
doc<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
doc<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Paragraph</span><span class="token punctuation">(</span><span class="token string">"Hello World"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> 
<p>输出结果：</p> 
<p><img src="https://images2.imgbox.com/91/f9/2VDqzAeQ_o.png" alt=""></p> 
<p>2、设置密码</p> 
<p>核心代码：</p> 
<pre><code class="prism language-java">PdfWriter writer <span class="token operator">=</span> PdfWriter<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token comment">// 设置密码为："World"  </span>
writer<span class="token punctuation">.</span><span class="token function">setEncryption</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"World"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        PdfWriter<span class="token punctuation">.</span>ALLOW_SCREENREADERS<span class="token punctuation">,</span>  
        PdfWriter<span class="token punctuation">.</span>STANDARD_ENCRYPTION_128<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
doc<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
doc<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Paragraph</span><span class="token punctuation">(</span><span class="token string">"Hello World"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre> 
<p>输出结果：</p> 
<p><img src="https://images2.imgbox.com/0f/31/8PJ9hKC4_o.png" alt=""></p> 
<p>3、添加Page<br> 核心代码：</p> 
<pre><code class="prism language-java">document<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Paragraph</span><span class="token punctuation">(</span><span class="token string">"First page"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Paragraph</span><span class="token punctuation">(</span>Document<span class="token punctuation">.</span><span class="token function">getVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
document<span class="token punctuation">.</span><span class="token function">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
writer<span class="token punctuation">.</span><span class="token function">setPageEmpty</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
document<span class="token punctuation">.</span><span class="token function">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Paragraph</span><span class="token punctuation">(</span><span class="token string">"New page"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre> 
<p>4、添加水印(背景图)</p> 
<pre><code class="prism language-java"><span class="token comment">//图片水印  </span>
PdfReader reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfReader</span><span class="token punctuation">(</span>FILE_DIR <span class="token operator">+</span> <span class="token string">"setWatermark.pdf"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
PdfStamper stamp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfStamper</span><span class="token punctuation">(</span>reader<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>FILE_DIR  
        <span class="token operator">+</span> <span class="token string">"setWatermark2.pdf"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
Image img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"resource/watermark.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
img<span class="token punctuation">.</span><span class="token function">setAbsolutePosition</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
PdfContentByte under <span class="token operator">=</span> stamp<span class="token punctuation">.</span><span class="token function">getUnderContent</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
under<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token comment">//文字水印  </span>
PdfContentByte over <span class="token operator">=</span> stamp<span class="token punctuation">.</span><span class="token function">getOverContent</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
over<span class="token punctuation">.</span><span class="token function">beginText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
BaseFont bf <span class="token operator">=</span> BaseFont<span class="token punctuation">.</span><span class="token function">createFont</span><span class="token punctuation">(</span>BaseFont<span class="token punctuation">.</span>HELVETICA<span class="token punctuation">,</span> BaseFont<span class="token punctuation">.</span>WINANSI<span class="token punctuation">,</span>  
        BaseFont<span class="token punctuation">.</span>EMBEDDED<span class="token punctuation">)</span><span class="token punctuation">;</span>  
over<span class="token punctuation">.</span><span class="token function">setFontAndSize</span><span class="token punctuation">(</span>bf<span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
over<span class="token punctuation">.</span><span class="token function">setTextMatrix</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
over<span class="token punctuation">.</span><span class="token function">showTextAligned</span><span class="token punctuation">(</span>Element<span class="token punctuation">.</span>ALIGN_LEFT<span class="token punctuation">,</span> <span class="token string">"DUPLICATE"</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">,</span> <span class="token number">430</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
over<span class="token punctuation">.</span><span class="token function">endText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token comment">//背景图  </span>
Image img2 <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"resource/test.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
img2<span class="token punctuation">.</span><span class="token function">setAbsolutePosition</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
PdfContentByte under2 <span class="token operator">=</span> stamp<span class="token punctuation">.</span><span class="token function">getUnderContent</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
under2<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span>img2<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
stamp<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
reader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre> 
<p>5、插入Chunk, Phrase, Paragraph, List<br> 核心代码</p> 
<pre><code class="prism language-java"><span class="token comment">//Chunk对象: a String, a Font, and some attributes  </span>
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">"China"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
Font font <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Font</span><span class="token punctuation">(</span>Font<span class="token punctuation">.</span>FontFamily<span class="token punctuation">.</span>HELVETICA<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> Font<span class="token punctuation">.</span>BOLD<span class="token punctuation">,</span> BaseColor<span class="token punctuation">.</span>WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>  
Chunk id <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">"chinese"</span><span class="token punctuation">,</span> font<span class="token punctuation">)</span><span class="token punctuation">;</span>  
id<span class="token punctuation">.</span><span class="token function">setBackground</span><span class="token punctuation">(</span>BaseColor<span class="token punctuation">.</span>BLACK<span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">,</span> <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">,</span> <span class="token number">1.5f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
id<span class="token punctuation">.</span><span class="token function">setTextRise</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Chunk<span class="token punctuation">.</span>NEWLINE<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">"Japan"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
Font font2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Font</span><span class="token punctuation">(</span>Font<span class="token punctuation">.</span>FontFamily<span class="token punctuation">.</span>HELVETICA<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> Font<span class="token punctuation">.</span>BOLD<span class="token punctuation">,</span> BaseColor<span class="token punctuation">.</span>WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>  
Chunk id2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">"japanese"</span><span class="token punctuation">,</span> font2<span class="token punctuation">)</span><span class="token punctuation">;</span>  
id2<span class="token punctuation">.</span><span class="token function">setBackground</span><span class="token punctuation">(</span>BaseColor<span class="token punctuation">.</span>BLACK<span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">,</span> <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token number">1f</span><span class="token punctuation">,</span> <span class="token number">1.5f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
id2<span class="token punctuation">.</span><span class="token function">setTextRise</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
id2<span class="token punctuation">.</span><span class="token function">setUnderline</span><span class="token punctuation">(</span><span class="token number">0.2f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>id2<span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Chunk<span class="token punctuation">.</span>NEWLINE<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token comment">//Phrase对象: a List of Chunks with leading  </span>
document<span class="token punctuation">.</span><span class="token function">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Phrase</span><span class="token punctuation">(</span><span class="token string">"Phrase page"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
Phrase director <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phrase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
Chunk name <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">"China"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
name<span class="token punctuation">.</span><span class="token function">setUnderline</span><span class="token punctuation">(</span><span class="token number">0.2f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
director<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  
director<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
director<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
director<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">"chinese"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
director<span class="token punctuation">.</span><span class="token function">setLeading</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>director<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
Phrase director2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phrase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
Chunk name2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">"Japan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
name2<span class="token punctuation">.</span><span class="token function">setUnderline</span><span class="token punctuation">(</span><span class="token number">0.2f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
director2<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>name2<span class="token punctuation">)</span><span class="token punctuation">;</span>  
director2<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
director2<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
director2<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">"japanese"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
director2<span class="token punctuation">.</span><span class="token function">setLeading</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>director2<span class="token punctuation">)</span><span class="token punctuation">;</span>  
          
<span class="token comment">//Paragraph对象: a Phrase with extra properties and a newline  </span>
document<span class="token punctuation">.</span><span class="token function">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Paragraph</span><span class="token punctuation">(</span><span class="token string">"Paragraph page"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
Paragraph info <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Paragraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
info<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">"China "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
info<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Chunk</span><span class="token punctuation">(</span><span class="token string">"chinese"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
info<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Chunk<span class="token punctuation">.</span>NEWLINE<span class="token punctuation">)</span><span class="token punctuation">;</span>  
info<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Phrase</span><span class="token punctuation">(</span><span class="token string">"Japan "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
info<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Phrase</span><span class="token punctuation">(</span><span class="token string">"japanese"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token comment">//List对象: a sequence of Paragraphs called ListItem  </span>
document<span class="token punctuation">.</span><span class="token function">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
List list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token punctuation">(</span>List<span class="token punctuation">.</span>ORDERED<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
    ListItem item <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListItem</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%s: %d movies"</span><span class="token punctuation">,</span>  
            <span class="token string">"country"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Font</span><span class="token punctuation">(</span>  
            Font<span class="token punctuation">.</span>FontFamily<span class="token punctuation">.</span>HELVETICA<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> Font<span class="token punctuation">.</span>BOLD<span class="token punctuation">,</span> BaseColor<span class="token punctuation">.</span>WHITE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    List movielist <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token punctuation">(</span>List<span class="token punctuation">.</span>ORDERED<span class="token punctuation">,</span> List<span class="token punctuation">.</span>ALPHABETICAL<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    movielist<span class="token punctuation">.</span><span class="token function">setLowercase</span><span class="token punctuation">(</span>List<span class="token punctuation">.</span>LOWERCASE<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
        ListItem movieitem <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListItem</span><span class="token punctuation">(</span><span class="token string">"Title"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        List directorlist <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token punctuation">(</span>List<span class="token punctuation">.</span>UNORDERED<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
            directorlist<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"%s, %s"</span><span class="token punctuation">,</span> <span class="token string">"Name1"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
                    <span class="token string">"Name2"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
        movieitem<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>directorlist<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        movielist<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>movieitem<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
    item<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>movielist<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre> 
<p>6、插入表格</p> 
<pre><code class="prism language-java">PdfPTable table <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfPTable</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
PdfPCell cell<span class="token punctuation">;</span>  
cell <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfPCell</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Phrase</span><span class="token punctuation">(</span><span class="token string">"Cell with colspan 3"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
cell<span class="token punctuation">.</span><span class="token function">setColspan</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
table<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">;</span>  
cell <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfPCell</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Phrase</span><span class="token punctuation">(</span><span class="token string">"Cell with rowspan 2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
cell<span class="token punctuation">.</span><span class="token function">setRowspan</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
table<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">;</span>  
table<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span><span class="token string">"row 1; cell 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
table<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span><span class="token string">"row 1; cell 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
table<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span><span class="token string">"row 2; cell 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
table<span class="token punctuation">.</span><span class="token function">addCell</span><span class="token punctuation">(</span><span class="token string">"row 2; cell 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>  

</code></pre> 
<p>7、表格嵌套</p> 
<pre><code>PdfPTable table = new PdfPTable(4);  
  
//1行2列  
PdfPTable nested1 = new PdfPTable(2);  
nested1.addCell("1.1");  
nested1.addCell("1.2");  
  
//2行1列  
PdfPTable nested2 = new PdfPTable(1);  
nested2.addCell("2.1");  
nested2.addCell("2.2");  
  
//将表格插入到指定位置  
for (int k = 0; k &lt; 24; ++k) {  
    if (k == 1) {  
        table.addCell(nested1);  
    } else if (k == 20) {  
        table.addCell(nested2);  
    } else {  
        table.addCell("cell " + k);  
    }  
}  
  
document.add(table);  
</code></pre> 
<p>8、设置表头</p> 
<pre><code>String[] bogusData = { "M0065920", "SL", "FR86000P", "PCGOLD",  
        "119000", "96 06", "2001-08-13", "4350", "6011648299",  
        "FLFLMTGP", "153", "119000.00" };  
int NumColumns = 12;  
// 12  
PdfPTable datatable = new PdfPTable(NumColumns);  
int headerwidths[] = { 9, 4, 8, 10, 8, 11, 9, 7, 9, 10, 4, 10 }; // percentage  
datatable.setWidths(headerwidths);  
datatable.setWidthPercentage(100);  
datatable.getDefaultCell().setPadding(3);  
datatable.getDefaultCell().setBorderWidth(2);  
datatable.getDefaultCell().setHorizontalAlignment(Element.ALIGN_CENTER);  
  
datatable.addCell("Clock #");  
datatable.addCell("Trans Type");  
datatable.addCell("Cusip");  
datatable.addCell("Long Name");  
datatable.addCell("Quantity");  
datatable.addCell("Fraction Price");  
datatable.addCell("Settle Date");  
datatable.addCell("Portfolio");  
datatable.addCell("ADP Number");  
datatable.addCell("Account ID");  
datatable.addCell("Reg Rep ID");  
datatable.addCell("Amt To Go ");  
  
datatable.setHeaderRows(1);  
  
//边框  
datatable.getDefaultCell().setBorderWidth(1);  
  
//背景色  
for (int i = 1; i &lt; 1000; i++) {  
    for (int x = 0; x &lt; NumColumns; x++) {  
        datatable.addCell(bogusData[x]);  
    }  
}  
  
document.add(datatable);
</code></pre> 
<p>篇幅有限，如果你需要更多操作，可以参考文章：<br> <a href="https://www.cnblogs.com/liaojie970/p/7132475.html" rel="nofollow">https://www.cnblogs.com/liaojie970/p/7132475.html</a></p> 
<h4><a id="_537"></a>最后</h4> 
<p>如果对 Java、大数据感兴趣请长按二维码关注一波，我会努力带给你们价值。觉得对你哪怕有一丁点帮助的请帮忙点个赞或者转发哦。<br> 关注公众号**【爱编码】<strong>，回复</strong>2019**有相关资料哦。</p> 
<p><img src="https://images2.imgbox.com/50/b7/vlsnM0dp_o.png" alt=""></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fd138f22575f57d6ab1284eda2bbe732/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Activiti】使用学习</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3b8102a38aa5af3162be3189405c3d73/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【2019.9.25】Za</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>