<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Linux 下 N 卡 GPU 测试 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Linux 下 N 卡 GPU 测试" />
<meta property="og:description" content="在win系统下测试工具比较多，现在 N 卡多用于深度学习，有时候会在 Linux下进行 N 卡测试。
测试工具 gpu-burn: Multi-GPU CUDA stress test，github地址：https://github.com/wilicc/gpu-burn
动手能力强的同学可以直接看 README.md 文档。我来说下我的测试过程。
补充一点，现在各种信息鱼龙混杂，遇到问题先找官网资料！
主要原理：利用Nvidia发布的Cuda镜像，在容器里编译后测试。用到的软件：
CentOS/Ubuntu 等发行版系统；N卡驱动，尽量用最新的驱动；Docker-ce 和 nvidia-container-runtimeNvidia 发布的Cuda镜像gpu-burn 步骤：
1、安装系统和nvidia驱动 系统下载可以到阿里云和国内镜像源，安装可以自行搜索；
驱动安装可以到Nvidia官网下载 Linux 驱动，安装过程也很简单。
驱动地址给个官方路径：Official Drivers | NVIDIA
安装完成，可以通过 nvidia-smi 进行验证，能看到显卡信息即正常。
2、安装 docker 和 nvidia-container-runtime docker的安装可以参考阿里云的步骤，或者直接看官方资料。
安装 nvidia-container-runtime，参考文档，安装也比较简单：
https://github.com/NVIDIA/nvidia-container-runtime
nvidia-container-runtime 是帮助docker在容器里调用到宿主机GPU。
3、nvidia发布的docker镜像 cuda镜像的Docker Hub地址：nvidia/cuda Tags | Docker Hub
比如：docker pull nvidia/cuda:11.2.0-cudnn8-devel-ubuntu18.04
在选镜像的时候注意，一般下载devel版本，不要选在runtime版本，devel版本，开发用的包比较完整，一般选cudnn装好的版本，开发cuda，cudnn一般是必备的，最最重要的是cuda版本不要太高，不能高于刚刚安装的驱动支持的cuda版本，其他的根据你的爱好去选就好了。
这个过程比较考验你的网速了，现在的cuda的镜像都要2G&#43;了
4、下载gpu burn开始测试 从github下载最新版本：GitHub - wilicc/gpu-burn: Multi-GPU CUDA stress test
https://github.com/NVIDIA/nvidia-container-runtime/archive/refs/heads/main.zip
下载好，上传到服务器上，比如放在 gputest 目录下，开始启动容器测试。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/4aac95f6038ccf62ffb25dd7967564c8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-16T21:43:21+08:00" />
<meta property="article:modified_time" content="2022-11-16T21:43:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Linux 下 N 卡 GPU 测试</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在win系统下测试工具比较多，现在 N 卡多用于深度学习，有时候会在 Linux下进行 N 卡测试。</p> 
<p>测试工具 gpu-burn: Multi-GPU CUDA stress test，github地址：<a href="https://github.com/wilicc/gpu-burn" title="https://github.com/wilicc/gpu-burn">https://github.com/wilicc/gpu-burn</a></p> 
<p>动手能力强的同学可以直接看 <a href="https://github.com/wilicc/gpu-burn/blob/master/README.md" title="README.md">README.md</a> 文档。我来说下我的测试过程。</p> 
<p>补充一点，现在各种信息鱼龙混杂，遇到问题先找官网资料！</p> 
<p>主要原理：利用Nvidia发布的Cuda镜像，在容器里编译后测试。用到的软件：</p> 
<ul><li>CentOS/Ubuntu 等发行版系统；</li><li>N卡驱动，尽量用最新的驱动；</li><li>Docker-ce 和 nvidia-container-runtime</li><li>Nvidia 发布的Cuda镜像</li><li>gpu-burn</li></ul> 
<p>步骤：</p> 
<h2>1、安装系统和nvidia驱动</h2> 
<p>系统下载可以到阿里云和国内镜像源，安装可以自行搜索；</p> 
<p>驱动安装可以到Nvidia官网下载 Linux 驱动，安装过程也很简单。</p> 
<p>驱动地址给个官方路径：<a href="https://www.nvidia.cn/Download/index.aspx" rel="nofollow" title="Official Drivers | NVIDIA">Official Drivers | NVIDIA</a></p> 
<p>安装完成，可以通过 nvidia-smi 进行验证，能看到显卡信息即正常。</p> 
<h2>2、安装 docker 和 nvidia-container-runtime</h2> 
<p>docker的安装可以参考阿里云的步骤，或者直接看官方资料。</p> 
<p>安装 nvidia-container-runtime，参考文档，安装也比较简单：</p> 
<p><a href="https://github.com/NVIDIA/nvidia-container-runtime" title="https://github.com/NVIDIA/nvidia-container-runtime">https://github.com/NVIDIA/nvidia-container-runtime</a></p> 
<p>nvidia-container-runtime 是帮助docker在容器里调用到宿主机GPU。</p> 
<h2>3、nvidia发布的docker镜像</h2> 
<p>cuda镜像的Docker Hub地址：<a href="https://hub.docker.com/r/nvidia/cuda/tags" rel="nofollow" title="nvidia/cuda Tags | Docker Hub">nvidia/cuda Tags | Docker Hub</a></p> 
<p>比如：docker pull nvidia/cuda:11.2.0-cudnn8-devel-ubuntu18.04</p> 
<p>在选镜像的时候注意，一般下载devel版本，不要选在runtime版本，devel版本，开发用的包比较完整，一般选cudnn装好的版本，开发cuda，cudnn一般是必备的，最最重要的是cuda版本不要太高，不能高于刚刚安装的驱动支持的cuda版本，其他的根据你的爱好去选就好了。</p> 
<p>这个过程比较考验你的网速了，现在的cuda的镜像都要2G+了</p> 
<h2>4、下载gpu burn开始测试</h2> 
<p>从github下载最新版本：<a href="https://github.com/wilicc/gpu-burn" title="GitHub - wilicc/gpu-burn: Multi-GPU CUDA stress test">GitHub - wilicc/gpu-burn: Multi-GPU CUDA stress test</a></p> 
<p><a href="https://github.com/NVIDIA/nvidia-container-runtime/archive/refs/heads/main.zip" title="https://github.com/NVIDIA/nvidia-container-runtime/archive/refs/heads/main.zip">https://github.com/NVIDIA/nvidia-container-runtime/archive/refs/heads/main.zip</a></p> 
<p>下载好，上传到服务器上，比如放在 gputest 目录下，开始启动容器测试。</p> 
<p>先解压：unzip main.zip</p> 
<p>docker run -it --rm -v /gputest:/gputest nvidia/cuda:11.2.0-cudnn8-devel-ubuntu18.04 bash</p> 
<p>自动进入容器，进入 /gputest 目录，可以看到帮助文件  cat README.md</p> 
<p>开始测试：</p> 
<pre><code class="hljs"># To build GPU Burn，需要指定 cuda 路径
make CUDAPATH=/usr/local/cuda-&lt;version&gt;

# 先查看帮助
./gpu_burn -h
GPU Burn
Usage: gpu_burn [OPTIONS] [TIME]

-m X	Use X MB of memory.
-m N%	Use N% of the available GPU memory.  Default is 90%
-d	Use doubles
-tc	Try to use Tensor cores
-l	Lists all GPUs in the system
-i N	Execute only on GPU N
-h	Show this help message

Examples:
  gpu-burn -d 3600 # burns all GPUs with doubles for an hour
  gpu-burn -m 50% # burns using 5017651154300f the available GPU memory
  gpu-burn -l # list GPUs
  gpu-burn -i 2 # burns only GPU of index 2
root@3f6c1167dd43:/gputest/gpu-burn-master# 

# 根据帮助进行测试
gpu-burn -d 3600  # 测试所有 GPU 一小时</code></pre> 
<p>nvidia-smi -l 查看 gpu利用率</p> 
<p>或者通过gpustat，gpustat 通过pip安装。</p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5591d8b48878a6fc7889cac5296afeae/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">三子棋游戏（超级详解，附加电脑下棋优化）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/24a0b80b42ae4f9aa5fd508e2ee1a576/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Android Studio】常用布局 --- 滚动视图ScrollView</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>