<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ubuntu 关闭开机启动服务 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ubuntu 关闭开机启动服务" />
<meta property="og:description" content="当用户使用sudo apt-get install安装完apache和mysql之后，这些服务默认是开机启动的，但是有的时候需要关闭这些服务的开机启动。 首先普及一个概念，以下转自维基百科： 运行级别（Runlevel）指的是Unix或者Linux等类Unix操作系统下不同的运行模式。运行级别通常分为7等，分别是从0到6，但如果必要的话也可以更多。
例如在大多数linux操作系统下一共有如下6个典型的运行级别：
0 停机 1 单用户，Does not configure network interfaces, start daemons, or allow non-root logins 2 多用户，无网络连接 Does not configure network interfaces or start daemons 3 多用户，启动网络连接 Starts the system normally. 4 用户自定义 5 多用户带图形界面 6 重启 在Debian Linux中2－5这四个运行级别都集中在级别2上。这个级别也是系统预设的正常运行级别。
（注：对于这些运行级别我们不必太过纠结与到底什么意思，只需要知道在Debian/Ubuntu（Ubuntu是Debian的分支）Linux中默认都是在级别(Runlevel)2启动的）
在Debian Linux中，下列路径对应不同的运行级别。当系统启动时，通过其中的脚本文件来启动相应的服务。 /etc/rc0.d Run level 0 /etc/rc1.d Run level 1 /etc/rc2.d Run level 2 /etc/rc3.d Run level 3 /etc/rc4.d Run level 4 /etc/rc5.d Run level 5 /etc/rc6." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e08b849c26cb472c02d7a546974d1483/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-12-03T20:16:59+08:00" />
<meta property="article:modified_time" content="2017-12-03T20:16:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ubuntu 关闭开机启动服务</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre><code>    当用户使用sudo apt-get install安装完apache和mysql之后，这些服务默认是开机启动的，但是有的时候需要关闭这些服务的开机启动。
    首先普及一个概念，以下转自维基百科：
</code></pre> 
<p>运行级别（Runlevel）指的是Unix或者Linux等类Unix操作系统下不同的运行模式。运行级别通常分为7等，分别是从0到6，但如果必要的话也可以更多。</p> 
<p>例如在大多数linux操作系统下一共有如下6个典型的运行级别：</p> 
<p>0 停机 <br> 1 单用户，Does not configure network interfaces, start daemons, or allow non-root logins <br> 2 多用户，无网络连接 Does not configure network interfaces or start daemons <br> 3 多用户，启动网络连接 Starts the system normally. <br> 4 用户自定义 <br> 5 多用户带图形界面 <br> 6 重启 <br> 在Debian Linux中2－5这四个运行级别都集中在级别2上。这个级别也是系统预设的正常运行级别。</p> 
<p>（注：对于这些运行级别我们不必太过纠结与到底什么意思，只需要知道在Debian/Ubuntu（Ubuntu是Debian的分支）Linux中默认都是在级别(Runlevel)2启动的）</p> 
<p>在Debian Linux中，下列路径对应不同的运行级别。当系统启动时，通过其中的脚本文件来启动相应的服务。 <br> /etc/rc0.d Run level 0 <br> /etc/rc1.d Run level 1 <br> /etc/rc2.d Run level 2 <br> /etc/rc3.d Run level 3 <br> /etc/rc4.d Run level 4 <br> /etc/rc5.d Run level 5 <br> /etc/rc6.d Run level 6 <br> 下面我们去/etc/目录下寻找这些目录，在终端中输入：</p> 
<p>hp@hp-Compaq-Presario-CQ45-Notebook-PC:~$ ls /etc/rc* <br> /etc/rc.local</p> 
<p>/etc/rc0.d: <br> K09apache2 K20winbind S30urandom S40umountfs <br> K10unattended-upgrades README S31umountnfs.sh S60umountroot <br> K20speech-dispatcher S20sendsigs S35networking S90halt</p> 
<p>/etc/rc1.d: <br> K09apache2 K20kerneloops K20winbind S70dns-clean <br> K15pulseaudio K20saned README S70pppd-dns <br> K20acpi-support K20speech-dispatcher S30killprocs S90single</p> 
<p>/etc/rc2.d: <br> README S50pulseaudio S70pppd-dns S99grub-common <br> S20kerneloops S50rsync S75sudo S99ondemand <br> S20speech-dispatcher S50saned S91apache2 S99rc.local <br> S20winbind S70dns-clean S99acpi-support</p> 
<p>/etc/rc3.d: <br> README S50pulseaudio S70pppd-dns S99grub-common <br> S20kerneloops S50rsync S75sudo S99ondemand <br> S20speech-dispatcher S50saned S91apache2 S99rc.local <br> S20winbind S70dns-clean S99acpi-support</p> 
<p>/etc/rc4.d: <br> README S50pulseaudio S70pppd-dns S99grub-common <br> S20kerneloops S50rsync S75sudo S99ondemand <br> S20speech-dispatcher S50saned S91apache2 S99rc.local <br> S20winbind S70dns-clean S99acpi-support</p> 
<p>/etc/rc5.d: <br> README S50pulseaudio S70pppd-dns S99grub-common <br> S20kerneloops S50rsync S75sudo S99ondemand <br> S20speech-dispatcher S50saned S91apache2 S99rc.local <br> S20winbind S70dns-clean S99acpi-support</p> 
<p>/etc/rc6.d: <br> K09apache2 K20winbind S30urandom S40umountfs <br> K10unattended-upgrades README S31umountnfs.sh S60umountroot <br> K20speech-dispatcher S20sendsigs S35networking S90reboot</p> 
<p>/etc/rcS.d: <br> README S25brltty S37apparmor S55urandom S70x11-common</p> 
<pre><code>    代码中带色彩并用下划线标注的内容是与apache服务有关的文件，可以看到在rc1.d rc6.d中为K09apache2，在rc2.d rc3.d rc4.d rc5.d中为S91apache2，下面简单介绍一下K09apache2与S91apache2的意思：
</code></pre> 
<p>对于以K开头的文件，系统将终止对应的服务；</p> 
<p>对于以S开头的文件，系统将启动对应的服务；</p> 
<pre><code>    现在对于Debian/Ubuntu Linux的启动过程大家应该有所了解，总结一下：

    在/etc/rc0.d~rc6.d目录下存放的分别是运行在0~6个运行级时要启动的服务有关的文件，由于Ubuntu默认是在runlevel 2启动的，那么我们之需要修改rc2.d中的文件，从而禁止apache服务启动。回顾刚才/etc/rc2.d目录下的文件可以发现与apache2有关的文件是S91apache2，而之前简单介绍过以S开头的文件，系统将启动对应的服务。所以我们要做的是把S91apache2修改成以K******，但是我们并不知道应该修改成多少，这里我们需要借助一个管理工具进行管理，即sysv-rc-conf。
</code></pre> 
<p>在Ubuntu下用apt-get安装，非常简单</p> 
<p>hp@hp-Compaq-Presario-CQ45-Notebook-PC:/etc$ sudo apt-get install sysv-rc-conf <br> 接下来打开sysv-rc-conf</p> 
<p>hp@hp-Compaq-Presario-CQ45-Notebook-PC:/etc$ sudo sysv-rc-conf <br> （注意：由于这里需要修改系统有关的内容，所以需要使用sudo，即root权限打开）</p> 
<p>配置界面简洁明了：</p> 
<p><img src="https://images2.imgbox.com/6d/13/TmYsFORy_o.png" alt="这里写图片描述" title=""></p> 
<p>第一行service后面是运行级别，有1，2，3，4，5，0，6，S，与之前介绍的运行级别基本符合，最后一项这里不做介绍</p> 
<p>图中打X的即表示运行在对应Runlevel时开机启动的服务，这里我们可以看到apache2在Runlevel2，3，4，5均为开机启动，对应到之前/etc/rc2.d~/etc/rc5.d目录下均为S91apache2文件，再次验证了之前的内容，将光标移动到apache2那行的第2列，按空格进行将启动项反选</p> 
<p>按q退出之后配置即完成。现在我们再来看一下/etc/rc2.d/目录下的内容：</p> 
<p>hp@hp-Compaq-Presario-CQ45-Notebook-PC:/etc$ ls /etc/rc2.d/ <br> K09apache2 S20winbind S70dns-clean S99grub-common <br> README S50pulseaudio S70pppd-dns S99ondemand <br> S20kerneloops S50rsync S75sudo S99rc.local <br> S20speech-dispatcher S50saned S99acpi-support <br> 现在已经出现了K09apache2文件，而之前的S91apache2文件不在了，到这里配置成功。</p> 
<p>重启之后查看apache服务运行状态：</p> 
<p><img src="https://images2.imgbox.com/2c/29/vsqQUiMm_o.png" alt="这里写图片描述" title=""></p> 
<p>下面关于mysql的启动配置有所区别：</p> 
<p>10.04以后把MySql的启动连接到了/lib/init/upstart-job，而后者是调用了/etc/init/mysql.conf文件里面关于开机的定义，这是新的框架，所以以前的方法不管用，我们需要修改mysql.conf文件，首先查看该文件：</p> 
<p>hp@hp-Compaq-Presario-CQ45-Notebook-PC:/etc$ sudo vi /etc/init/mysql.conf </p> 
<h2 id="mysql-service">MySQL Service</h2> 
<p>description “MySQL Server” <br> author “Mario Limonciello <a href="mailto:superm1@ubuntu.com" rel="nofollow noopener noreferrer" target="_blank">superm1@ubuntu.com</a>”</p> 
<p>start on runlevel [2345] <br> stop on starting rc RUNLEVEL=[016]</p> 
<p>respawn <br> respawn limit 2 5 <br> 这里用红色粗体字标注出了运行级别，我们只需把该行修改成start on runlevel [345]（注意这里需要sudo权限）, 也就是删除了runlevel 2。</p> 
<p>重启后查看mysql服务运行状态：</p> 
<p>转自：<a href="http://blog.163.com/thinki_cao/blog/static/839448752012112694037995/" rel="nofollow noopener noreferrer" target="_blank">http://blog.163.com/thinki_cao/blog/static/839448752012112694037995/</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c513d2a3871a684a9e97f4a527ffbb4e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VTK读取DICOM医学图片进行体绘制的几种方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d935df3ce87700f498086b2a03c47d91/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">11-Thrift_JavaScript的使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>