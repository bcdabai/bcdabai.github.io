<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>2021-11-26【数据结构/严蔚敏】【关键路径】【代码实现算法7.13-7.14】 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="2021-11-26【数据结构/严蔚敏】【关键路径】【代码实现算法7.13-7.14】" />
<meta property="og:description" content="知识点 与AOV—网相对应的是AOE—网（Activity On Edge）即边表示活动的网。AOE—网是一个带权的有向无环图，其中，顶点表示事件（Event），弧表示活动，权表示活动持续的时间。通常，AOE—网可用来估算工程的完成时间。
例如，图7.29是一个假想的有11项活动的AOE—网。其中有9个事件 v 1 v_1 v1​， v 2 v_2 v2​， v 3 v_3 v3​， v 4 v_4 v4​， ⋯ \cdots ⋯， v 9 v_9 v9​，每个事件表示在它之前的活动已经完成，在它之后的活动可以开始。如 v 1 v_1 v1​表示整个工程开始， v 9 v_9 v9​表示整个工程结束， v 5 v_5 v5​表示 a 4 a_4 a4​和 a 5 a_5 a5​已经完成， a 7 a_7 a7​和 a 8 a_8 a8​可以开始。与每个活动相联系的数是执行该活动所需的时间。比如，活动 a 1 a_1 a1​需要6天， a 2 a_2 a2​需要4天等.
由于整个工程只有一个开始点和一个完成点
故在正常的情况（无环）下，网中只有一个人度为零的点（称做源点）和一个出度为零的点（叫做汇点）。
和 AOV-网 不同，对AOE—网有待研究的问题是：（1）完成整项工程至少需要多少时间？（2）哪些活动是影响工程进度的关键？" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/813af9ceea7602cdec738de2a03b5a3e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-26T01:14:32+08:00" />
<meta property="article:modified_time" content="2021-11-26T01:14:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2021-11-26【数据结构/严蔚敏】【关键路径】【代码实现算法7.13-7.14】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>知识点</h3> 
<p>与AOV—网相对应的是AOE—网（Activity On Edge）即边表示活动的网。AOE—网是一个带权的有向无环图，其中，顶点表示事件（Event），弧表示活动，权表示活动持续的时间。通常，AOE—网可用来估算工程的完成时间。</p> 
<p>例如，图7.29是一个假想的有11项活动的AOE—网。其中有9个事件<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          1 
         
        
       
      
        v_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          2 
         
        
       
      
        v_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          3 
         
        
       
      
        v_3 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          4 
         
        
       
      
        v_4 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ⋯ 
        
       
      
        \cdots 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.31em; vertical-align: 0em;"></span><span class="minner">⋯</span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          9 
         
        
       
      
        v_9 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，每个事件表示在它之前的活动已经完成，在它之后的活动可以开始。如<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          1 
         
        
       
      
        v_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示整个工程开始，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          9 
         
        
       
      
        v_9 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示整个工程结束，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          5 
         
        
       
      
        v_5 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          4 
         
        
       
      
        a_4 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          5 
         
        
       
      
        a_5 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>已经完成，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          7 
         
        
       
      
        a_7 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          8 
         
        
       
      
        a_8 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>可以开始。与每个活动相联系的数是执行该活动所需的时间。比如，活动<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          1 
         
        
       
      
        a_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>需要6天，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          2 
         
        
       
      
        a_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>需要4天等.<br> <img src="https://images2.imgbox.com/c1/a0/TBuHnQXR_o.png" alt="在这里插入图片描述"></p> 
<p>由于整个工程只有一个开始点和一个完成点</p> 
<p>故在正常的情况（无环）下，网中只有一个人度为零的点（称做源点）和一个出度为零的点（叫做汇点）。</p> 
<p>和 AOV-网 不同，对AOE—网有待研究的问题是：（1）完成整项工程至少需要多少时间？（2）哪些活动是影响工程进度的关键？</p> 
<p>由于在 AOE-网 中有些活动可以并行地进行，所以完成工程的最短时间是从开始点到完成点的最长路径的长度（这里所说的路径长度是指路径上各活动持续时间之和，不是路径上弧的数目）。路径长度最长的路径叫做<strong>关键路径（Critical Path）</strong>。假设开始点是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          1 
         
        
       
      
        v_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，从<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          1 
         
        
       
      
        v_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>到<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          i 
         
        
       
      
        v_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的最长路径长度叫做事件<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          i 
         
        
       
      
        v_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的最早发生时间。这个时间决定了所有以<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          i 
         
        
       
      
        v_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>；为尾的弧所表示的活动的最早开始时间。我们用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         e 
        
       
         ( 
        
       
         i 
        
       
         ) 
        
       
      
        e(i) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></span>表示活动<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          i 
         
        
       
      
        a_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的最早开始时间。还可以定义一个活动的最迟开始时间<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         l 
        
       
         ( 
        
       
         i 
        
       
         ) 
        
       
      
        l(i) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></span>，这是在不推迟整个工程完成的前提下，活动<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          i 
         
        
       
      
        a_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>最迟必须开始进行的时间。两者之差<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         l 
        
       
         ( 
        
       
         i 
        
       
         ) 
        
       
         − 
        
       
         e 
        
       
         ( 
        
       
         i 
        
       
         ) 
        
       
      
        l(i)-e(i) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></span>意味着完成活动<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          i 
         
        
       
      
        a_i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的时间余量。我们把<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         l 
        
       
         ( 
        
       
         i 
        
       
         ) 
        
       
         = 
        
       
         e 
        
       
         ( 
        
       
         i 
        
       
         ) 
        
       
      
        l(i)=e(i) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></span>的活动叫做<strong>关键活动</strong>。</p> 
<p>显然，关键路径上的所有活动都是关键活动，因此提前完成非关键活动并不能加快工程的进度。例如图7.29中的网，从<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          1 
         
        
       
      
        v_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>到<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          9 
         
        
       
      
        v_9 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，的最长路径是（<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          1 
         
        
       
      
        v_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          2 
         
        
       
      
        v_2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          5 
         
        
       
      
        v_5 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          8 
         
        
       
      
        v_8 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          9 
         
        
       
      
        v_9 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>），路径长度是18，即<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          9 
         
        
       
      
        v_9 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的最早发生时间是18。而活动<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          6 
         
        
       
      
        a_6 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的最早开始时间是5，最迟开始时间是8，这意味着：如果<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          a 
         
        
          6 
         
        
       
      
        a_6 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>推迟3天开始或者延迟3天完成，都不会影响整个工程的完成。因此，分析关键路径的目的是辨别哪些是关键活动，以便争取提高关键活动的工效, 缩短整个工期。</p> 
<h3><a id="_18"></a>算法实现</h3> 
<p>由此得到如下所述求关键路径的算法:</p> 
<p>(1)输入 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         e 
        
       
      
        e 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">e</span></span></span></span></span> 条弧 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ( 
        
       
         j 
        
       
         , 
        
       
         k 
        
       
         ) 
        
       
      
        (j,k) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span></span></span></span></span> 建立 AOE-网 的存储结构;</p> 
<p>(2)从源点 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          0 
         
        
       
      
        v_0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 出发，令 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         v 
        
       
         e 
        
       
         [ 
        
       
         0 
        
       
         ] 
        
       
         = 
        
       
         0 
        
       
      
        ve[0]=0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span> 按拓扑有序求其余各顶点的最早发生时间 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         v 
        
       
         e 
        
       
         [ 
        
       
         i 
        
       
         ] 
        
       
         ( 
        
       
         1 
        
       
         ≤ 
        
       
         i 
        
       
         ≤ 
        
       
         n 
        
       
         − 
        
       
         1 
        
       
         ) 
        
       
      
        ve[i](1≤i≤n-1) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.79549em; vertical-align: -0.13597em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>。如果得到的拓扑有序序列中顶点个数小于网中顶点数n则说明网中存在环，不能求关键路径,算法终止;否则执行步骤(3)。</p> 
<p>(3)从汇点 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          n 
         
        
       
      
        v_n 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> 出发,令<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         v 
        
       
         l 
        
       
         [ 
        
       
         n 
        
       
         − 
        
       
         1 
        
       
         ] 
        
       
         = 
        
       
         v 
        
       
         e 
        
       
         [ 
        
       
         n 
        
       
         − 
        
       
         1 
        
       
         ] 
        
       
      
        vl[n-1]=ve[n-1] 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mopen">[</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span>,按逆拓扑有序求其余各顶点的最迟发生时间<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         v 
        
       
         l 
        
       
         [ 
        
       
         i 
        
       
         ] 
        
       
         ( 
        
       
         n 
        
       
         − 
        
       
         2 
        
       
         ≥ 
        
       
         i 
        
       
         ≥ 
        
       
         2 
        
       
         ) 
        
       
      
        vl[i](n-2≥i≥2) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.78041em; vertical-align: -0.13597em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.79549em; vertical-align: -0.13597em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span>;</p> 
<p>(4)根据各顶点的 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         v 
        
       
         e 
        
       
      
        ve 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">e</span></span></span></span></span> 和 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         v 
        
       
         l 
        
       
      
        vl 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span></span></span></span></span> 值,求每条弧 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         s 
        
       
      
        s 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span></span></span></span></span> 的最早开始时间 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         e 
        
       
         ( 
        
       
         s 
        
       
         ) 
        
       
      
        e(s) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span></span> 和最迟开始时间 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         l 
        
       
         ( 
        
       
         s 
        
       
         ) 
        
       
      
        l(s) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span></span> 。若某条弧满足条件 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         e 
        
       
         ( 
        
       
         s 
        
       
         ) 
        
       
         = 
        
       
         l 
        
       
         ( 
        
       
         s 
        
       
         ) 
        
       
      
        e(s)=l(s) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span></span> 则为关键活动。</p> 
<pre><code class="prism language-cpp"><span class="token comment">//算法7.13</span>
<span class="token keyword">int</span> ve<span class="token punctuation">[</span>MAX_VERTEX_NUM<span class="token punctuation">]</span><span class="token punctuation">;</span>
Status <span class="token function">TopologicalOrder</span><span class="token punctuation">(</span>ALGraph G<span class="token punctuation">,</span> SqStack <span class="token operator">&amp;</span>T<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> 
	<span class="token keyword">int</span> j<span class="token punctuation">,</span> k<span class="token punctuation">,</span> count<span class="token punctuation">,</span> indegree<span class="token punctuation">[</span>MAX_VERTEX_NUM<span class="token punctuation">]</span><span class="token punctuation">;</span>
	SqStack S<span class="token punctuation">;</span>
	ArcNode <span class="token operator">*</span>p<span class="token punctuation">;</span>
	<span class="token function">FindInDegree</span><span class="token punctuation">(</span>G<span class="token punctuation">,</span> indegree<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">InitStack</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> 
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>indegree<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token function">Push</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token function">InitStack</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span> 
	count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
	<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> 
		ve<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">StackEmpty</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token function">Pop</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">Push</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token operator">++</span>count<span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc<span class="token punctuation">;</span> p<span class="token punctuation">;</span> p <span class="token operator">=</span> p<span class="token operator">-&gt;</span>nextarc<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> 
			k <span class="token operator">=</span> p<span class="token operator">-&gt;</span>adjvex<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span>indegree<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> 
				<span class="token function">Push</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ve<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>info<span class="token punctuation">)</span> <span class="token operator">&gt;</span> ve<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span>
				ve<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> ve<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"此有向网有回路\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> ERROR<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
		<span class="token keyword">return</span> OK<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//算法7.14</span>
Status <span class="token function">CriticalPath</span><span class="token punctuation">(</span>ALGraph G<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> vl<span class="token punctuation">[</span>MAX_VERTEX_NUM<span class="token punctuation">]</span><span class="token punctuation">;</span>
	SqStack T<span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">,</span> ee<span class="token punctuation">,</span> el<span class="token punctuation">;</span>
	ArcNode <span class="token operator">*</span>p<span class="token punctuation">;</span>
	<span class="token keyword">char</span> dut<span class="token punctuation">,</span> tag<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">TopologicalOrder</span><span class="token punctuation">(</span>G<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 产生有向环 </span>
		<span class="token keyword">return</span> ERROR<span class="token punctuation">;</span>
	j <span class="token operator">=</span> ve<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">//j=Max(ve[]) 完成点的值 </span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ve<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> j<span class="token punctuation">)</span>
			j <span class="token operator">=</span> ve<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">// 初始化顶点事件的最迟发生时间(最大值) </span>
		vl<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span> <span class="token comment">// 完成点的最早发生时间 </span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">StackEmpty</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 按拓扑逆序求各顶点的vl值 </span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token function">Pop</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">,</span> p <span class="token operator">=</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc<span class="token punctuation">;</span> p<span class="token punctuation">;</span> p <span class="token operator">=</span> p<span class="token operator">-&gt;</span>nextarc<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			k <span class="token operator">=</span> p<span class="token operator">-&gt;</span>adjvex<span class="token punctuation">;</span>
			dut <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// dut&lt;j,k&gt; </span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>vl<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">-</span> dut <span class="token operator">&lt;</span> vl<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
				vl<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> vl<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">-</span> dut<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" j  k  dut  ee  el  tag\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token comment">//求ee,el和关键活动 </span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc<span class="token punctuation">;</span> p<span class="token punctuation">;</span> p <span class="token operator">=</span> p<span class="token operator">-&gt;</span>nextarc<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			k <span class="token operator">=</span> p<span class="token operator">-&gt;</span>adjvex<span class="token punctuation">;</span>
			dut <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
			ee <span class="token operator">=</span> ve<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
			el <span class="token operator">=</span> vl<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">-</span> dut<span class="token punctuation">;</span>
			tag <span class="token operator">=</span> <span class="token punctuation">(</span>ee <span class="token operator">==</span> el<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">'*'</span> <span class="token operator">:</span> <span class="token string">' '</span><span class="token punctuation">;</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%2d %2d %3d %3d %3d    %c\n"</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">,</span> dut<span class="token punctuation">,</span> ee<span class="token punctuation">,</span> el<span class="token punctuation">,</span> tag<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出关键活动 </span>
		<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"关键活动为:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> 
		<span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc<span class="token punctuation">;</span> p<span class="token punctuation">;</span> p <span class="token operator">=</span> p<span class="token operator">-&gt;</span>nextarc<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			k <span class="token operator">=</span> p<span class="token operator">-&gt;</span>adjvex<span class="token punctuation">;</span>
			dut <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ve<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> vl<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">-</span> dut<span class="token punctuation">)</span>
				<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s→%s\n"</span><span class="token punctuation">,</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">,</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出关键活动 </span>
		<span class="token punctuation">}</span>
	<span class="token keyword">return</span> OK<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_110"></a>完整代码</h3> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">int</span> Status<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">int</span> Boolean<span class="token punctuation">;</span> 
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TRUE</span> <span class="token expression"><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FALSE</span> <span class="token expression"><span class="token number">0</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">OK</span> <span class="token expression"><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ERROR</span> <span class="token expression"><span class="token number">0</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">INFEASIBLE</span> <span class="token expression"><span class="token operator">-</span><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">OVERFLOW</span> <span class="token expression"><span class="token operator">-</span><span class="token number">2</span> </span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_NAME</span> <span class="token expression"><span class="token number">5</span> </span></span>
<span class="token keyword">typedef</span> <span class="token keyword">int</span> InfoType<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">char</span> VertexType<span class="token punctuation">[</span>MAX_NAME<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">/* ---------------------------------  图的邻接表存储表示    --------------------------------*/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAX_VERTEX_NUM</span> <span class="token expression"><span class="token number">20</span></span></span>
<span class="token keyword">typedef</span> <span class="token keyword">enum</span> <span class="token punctuation">{<!-- --></span> DG<span class="token punctuation">,</span> DN<span class="token punctuation">,</span> AG<span class="token punctuation">,</span> AN <span class="token punctuation">}</span>GraphKind<span class="token punctuation">;</span> 
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">ArcNode</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> adjvex<span class="token punctuation">;</span>
	<span class="token keyword">struct</span> <span class="token class-name">ArcNode</span> <span class="token operator">*</span>nextarc<span class="token punctuation">;</span> 
	InfoType <span class="token operator">*</span>info<span class="token punctuation">;</span>
<span class="token punctuation">}</span>ArcNode<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{<!-- --></span>
	VertexType data<span class="token punctuation">;</span> 
	ArcNode <span class="token operator">*</span>firstarc<span class="token punctuation">;</span>
<span class="token punctuation">}</span>VNode<span class="token punctuation">,</span> AdjList<span class="token punctuation">[</span>MAX_VERTEX_NUM<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{<!-- --></span>
	AdjList vertices<span class="token punctuation">;</span>
	<span class="token keyword">int</span> vexnum<span class="token punctuation">,</span> arcnum<span class="token punctuation">;</span>
	<span class="token keyword">int</span> kind<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>ALGraph<span class="token punctuation">;</span>
<span class="token comment">/* -----------------------------   需要用的图的邻接表存储的基本操作  --------------------------*/</span> 
<span class="token keyword">int</span> <span class="token function">LocateVex</span><span class="token punctuation">(</span>ALGraph G<span class="token punctuation">,</span> VertexType u<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span> <span class="token comment">/* 初始条件: 图G存在,u和G中顶点有相同特征 */</span>
  <span class="token comment">/* 操作结果: 若G中存在顶点u,则返回该顶点在图中位置;否则返回-1 */</span>
	<span class="token keyword">int</span> i<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span> i<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Status <span class="token function">CreateGraph</span><span class="token punctuation">(</span>ALGraph <span class="token operator">&amp;</span>G<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">;</span>
	<span class="token keyword">int</span> w<span class="token punctuation">;</span> <span class="token comment">/* 权值 */</span>
	VertexType va<span class="token punctuation">,</span> vb<span class="token punctuation">;</span>
	ArcNode <span class="token operator">*</span>p<span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入图的类型(有向图:0,有向网:1,无向图:2,无向网:3): "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>G<span class="token punctuation">.</span>kind<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入图的顶点数和边数(空格隔开): "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>G<span class="token punctuation">.</span>vexnum<span class="token punctuation">,</span> <span class="token operator">&amp;</span>G<span class="token punctuation">.</span>arcnum<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入%d个顶点的值(&lt;%d个字符):\n"</span><span class="token punctuation">,</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">,</span> MAX_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> 
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
		G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>G<span class="token punctuation">.</span>kind <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> G<span class="token punctuation">.</span>kind <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> 
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请顺序输入每条弧(边)的权值、弧尾和弧头(以空格作为间隔):\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span> 
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请顺序输入每条弧(边)的弧尾和弧头(以空格作为间隔):\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>arcnum<span class="token punctuation">;</span> <span class="token operator">++</span>k<span class="token punctuation">)</span> 
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>G<span class="token punctuation">.</span>kind <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> G<span class="token punctuation">.</span>kind <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// 网 </span>
			<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%s%s"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>w<span class="token punctuation">,</span> va<span class="token punctuation">,</span> vb<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token comment">// 图</span>
			<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s%s"</span><span class="token punctuation">,</span> va<span class="token punctuation">,</span> vb<span class="token punctuation">)</span><span class="token punctuation">;</span>
		i <span class="token operator">=</span> <span class="token function">LocateVex</span><span class="token punctuation">(</span>G<span class="token punctuation">,</span> va<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 弧尾 </span>
		j <span class="token operator">=</span> <span class="token function">LocateVex</span><span class="token punctuation">(</span>G<span class="token punctuation">,</span> vb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 弧头 </span>
		p <span class="token operator">=</span> <span class="token punctuation">(</span>ArcNode<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>ArcNode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		p<span class="token operator">-&gt;</span>adjvex <span class="token operator">=</span> j<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>G<span class="token punctuation">.</span>kind <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> G<span class="token punctuation">.</span>kind <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>	<span class="token punctuation">{<!-- --></span> <span class="token comment">// 网 </span>
			p<span class="token operator">-&gt;</span>info <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>info<span class="token punctuation">)</span> <span class="token operator">=</span> w<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
			p<span class="token operator">-&gt;</span>info <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment">// 图 </span>
		p<span class="token operator">-&gt;</span>nextarc <span class="token operator">=</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc<span class="token punctuation">;</span> <span class="token comment">// 插在表头 </span>
		G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc <span class="token operator">=</span> p<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>G<span class="token punctuation">.</span>kind <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token comment">// 无向图或网,产生第二个表结点</span>
			p <span class="token operator">=</span> <span class="token punctuation">(</span>ArcNode<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>ArcNode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			p<span class="token operator">-&gt;</span>adjvex <span class="token operator">=</span> i<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>G<span class="token punctuation">.</span>kind <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token comment">// 无向网 </span>
				p<span class="token operator">-&gt;</span>info <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>info<span class="token punctuation">)</span> <span class="token operator">=</span> w<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span>
				p<span class="token operator">-&gt;</span>info <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment">// 无向图 </span>
			p<span class="token operator">-&gt;</span>nextarc <span class="token operator">=</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc<span class="token punctuation">;</span> <span class="token comment">// 插在表头 </span>
			G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc <span class="token operator">=</span> p<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> OK<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Boolean visited<span class="token punctuation">[</span>MAX_VERTEX_NUM<span class="token punctuation">]</span><span class="token punctuation">;</span> 
<span class="token keyword">void</span><span class="token punctuation">(</span><span class="token operator">*</span>VisitFunc<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span> 
 
 
<span class="token keyword">void</span> <span class="token function">Display</span><span class="token punctuation">(</span>ALGraph G<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token comment">// 输出图的邻接表G </span>
	<span class="token keyword">int</span> i<span class="token punctuation">;</span>
	ArcNode <span class="token operator">*</span>p<span class="token punctuation">;</span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>G<span class="token punctuation">.</span>kind<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> DG<span class="token operator">:</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"有向图\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> DN<span class="token operator">:</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"有向网\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> AG<span class="token operator">:</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"无向图\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> AN<span class="token operator">:</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"无向网\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d个顶点：\n"</span><span class="token punctuation">,</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s "</span><span class="token punctuation">,</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n%d条弧(边):\n"</span><span class="token punctuation">,</span> G<span class="token punctuation">.</span>arcnum<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		p <span class="token operator">=</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc<span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>G<span class="token punctuation">.</span>kind <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">// 有向 </span>
				<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s→%s "</span><span class="token punctuation">,</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">,</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>p<span class="token operator">-&gt;</span>adjvex<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>G<span class="token punctuation">.</span>kind <span class="token operator">==</span> DN<span class="token punctuation">)</span> <span class="token comment">// 网 </span>
					<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">":%d "</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>info<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span><span class="token punctuation">{<!-- --></span> <span class="token comment">// 无向(避免输出两次) </span>
			
				<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> p<span class="token operator">-&gt;</span>adjvex<span class="token punctuation">)</span>	<span class="token punctuation">{<!-- --></span>
					<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s－%s "</span><span class="token punctuation">,</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">,</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>p<span class="token operator">-&gt;</span>adjvex<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>G<span class="token punctuation">.</span>kind <span class="token operator">==</span> AN<span class="token punctuation">)</span> <span class="token comment">/* 网 */</span>
						<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">":%d "</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>info<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			p <span class="token operator">=</span> p<span class="token operator">-&gt;</span>nextarc<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">FindInDegree</span><span class="token punctuation">(</span>ALGraph G<span class="token punctuation">,</span> <span class="token keyword">int</span> indegree<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span> <span class="token comment">/* 求顶点的入度，算法7.13调用 */</span>
	<span class="token keyword">int</span> i<span class="token punctuation">;</span>
	ArcNode <span class="token operator">*</span>p<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		indegree<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* 赋初值 */</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		p <span class="token operator">=</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc<span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			indegree<span class="token punctuation">[</span>p<span class="token operator">-&gt;</span>adjvex<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
			p <span class="token operator">=</span> p<span class="token operator">-&gt;</span>nextarc<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">typedef</span> <span class="token keyword">int</span> SElemType<span class="token punctuation">;</span> 
<span class="token comment">/* -----------------------------------   栈的顺序存储表示   -----------------------------------*/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STACK_INIT_SIZE</span> <span class="token expression"><span class="token number">10</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STACKINCREMENT</span> <span class="token expression"><span class="token number">2</span> </span></span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">SqStack</span><span class="token punctuation">{<!-- --></span>
	SElemType <span class="token operator">*</span>base<span class="token punctuation">;</span> 
	SElemType <span class="token operator">*</span>top<span class="token punctuation">;</span>
	<span class="token keyword">int</span> stacksize<span class="token punctuation">;</span>
<span class="token punctuation">}</span>SqStack<span class="token punctuation">;</span>
Status <span class="token function">InitStack</span><span class="token punctuation">(</span>SqStack <span class="token operator">&amp;</span>S<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> 
	S<span class="token punctuation">.</span>base <span class="token operator">=</span> <span class="token punctuation">(</span>SElemType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>STACK_INIT_SIZE <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>SElemType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>S<span class="token punctuation">.</span>base<span class="token punctuation">)</span>
		<span class="token function">exit</span><span class="token punctuation">(</span>OVERFLOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
	S<span class="token punctuation">.</span>top <span class="token operator">=</span> S<span class="token punctuation">.</span>base<span class="token punctuation">;</span>
	S<span class="token punctuation">.</span>stacksize <span class="token operator">=</span> STACK_INIT_SIZE<span class="token punctuation">;</span>
	<span class="token keyword">return</span> OK<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
Status <span class="token function">StackEmpty</span><span class="token punctuation">(</span>SqStack S<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>S<span class="token punctuation">.</span>top <span class="token operator">==</span> S<span class="token punctuation">.</span>base<span class="token punctuation">)</span>
		<span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
Status <span class="token function">Push</span><span class="token punctuation">(</span>SqStack <span class="token operator">&amp;</span>S<span class="token punctuation">,</span> SElemType e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> 
	<span class="token keyword">if</span> <span class="token punctuation">(</span>S<span class="token punctuation">.</span>top <span class="token operator">-</span> S<span class="token punctuation">.</span>base <span class="token operator">&gt;=</span> S<span class="token punctuation">.</span>stacksize<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		S<span class="token punctuation">.</span>base <span class="token operator">=</span> <span class="token punctuation">(</span>SElemType <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">realloc</span><span class="token punctuation">(</span>S<span class="token punctuation">.</span>base<span class="token punctuation">,</span> <span class="token punctuation">(</span>S<span class="token punctuation">.</span>stacksize <span class="token operator">+</span> STACKINCREMENT<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>SElemType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>S<span class="token punctuation">.</span>base<span class="token punctuation">)</span>
			<span class="token function">exit</span><span class="token punctuation">(</span>OVERFLOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
		S<span class="token punctuation">.</span>top <span class="token operator">=</span> S<span class="token punctuation">.</span>base <span class="token operator">+</span> S<span class="token punctuation">.</span>stacksize<span class="token punctuation">;</span>
		S<span class="token punctuation">.</span>stacksize <span class="token operator">+=</span> STACKINCREMENT<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">*</span><span class="token punctuation">(</span>S<span class="token punctuation">.</span>top<span class="token punctuation">)</span><span class="token operator">++</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
	<span class="token keyword">return</span> OK<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
Status <span class="token function">Pop</span><span class="token punctuation">(</span>SqStack <span class="token operator">&amp;</span>S<span class="token punctuation">,</span> SElemType <span class="token operator">&amp;</span>e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token comment">/* 若栈不空，则删除S的栈顶元素，用e返回其值，并返回OK；否则返回ERROR */</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>S<span class="token punctuation">.</span>top <span class="token operator">==</span> S<span class="token punctuation">.</span>base<span class="token punctuation">)</span>
		<span class="token keyword">return</span> ERROR<span class="token punctuation">;</span>
	e <span class="token operator">=</span> <span class="token operator">*</span><span class="token operator">--</span>S<span class="token punctuation">.</span>top<span class="token punctuation">;</span>
	<span class="token keyword">return</span> OK<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//算法7.13</span>
<span class="token keyword">int</span> ve<span class="token punctuation">[</span>MAX_VERTEX_NUM<span class="token punctuation">]</span><span class="token punctuation">;</span>
Status <span class="token function">TopologicalOrder</span><span class="token punctuation">(</span>ALGraph G<span class="token punctuation">,</span> SqStack <span class="token operator">&amp;</span>T<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> 
	<span class="token keyword">int</span> j<span class="token punctuation">,</span> k<span class="token punctuation">,</span> count<span class="token punctuation">,</span> indegree<span class="token punctuation">[</span>MAX_VERTEX_NUM<span class="token punctuation">]</span><span class="token punctuation">;</span>
	SqStack S<span class="token punctuation">;</span>
	ArcNode <span class="token operator">*</span>p<span class="token punctuation">;</span>
	<span class="token function">FindInDegree</span><span class="token punctuation">(</span>G<span class="token punctuation">,</span> indegree<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">InitStack</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> 
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>indegree<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token function">Push</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token function">InitStack</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">;</span> 
	count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
	<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> 
		ve<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">StackEmpty</span><span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token function">Pop</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">Push</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token operator">++</span>count<span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc<span class="token punctuation">;</span> p<span class="token punctuation">;</span> p <span class="token operator">=</span> p<span class="token operator">-&gt;</span>nextarc<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> 
			k <span class="token operator">=</span> p<span class="token operator">-&gt;</span>adjvex<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">--</span>indegree<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> 
				<span class="token function">Push</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ve<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>info<span class="token punctuation">)</span> <span class="token operator">&gt;</span> ve<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span>
				ve<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> ve<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"此有向网有回路\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> ERROR<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
		<span class="token keyword">return</span> OK<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//算法7.14</span>
Status <span class="token function">CriticalPath</span><span class="token punctuation">(</span>ALGraph G<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> vl<span class="token punctuation">[</span>MAX_VERTEX_NUM<span class="token punctuation">]</span><span class="token punctuation">;</span>
	SqStack T<span class="token punctuation">;</span>
	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">,</span> ee<span class="token punctuation">,</span> el<span class="token punctuation">;</span>
	ArcNode <span class="token operator">*</span>p<span class="token punctuation">;</span>
	<span class="token keyword">char</span> dut<span class="token punctuation">,</span> tag<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">TopologicalOrder</span><span class="token punctuation">(</span>G<span class="token punctuation">,</span> T<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 产生有向环 </span>
		<span class="token keyword">return</span> ERROR<span class="token punctuation">;</span>
	j <span class="token operator">=</span> ve<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">//j=Max(ve[]) 完成点的值 </span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ve<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> j<span class="token punctuation">)</span>
			j <span class="token operator">=</span> ve<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">// 初始化顶点事件的最迟发生时间(最大值) </span>
		vl<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span> <span class="token comment">// 完成点的最早发生时间 </span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">StackEmpty</span><span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 按拓扑逆序求各顶点的vl值 </span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token function">Pop</span><span class="token punctuation">(</span>T<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">,</span> p <span class="token operator">=</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc<span class="token punctuation">;</span> p<span class="token punctuation">;</span> p <span class="token operator">=</span> p<span class="token operator">-&gt;</span>nextarc<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			k <span class="token operator">=</span> p<span class="token operator">-&gt;</span>adjvex<span class="token punctuation">;</span>
			dut <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// dut&lt;j,k&gt; </span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>vl<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">-</span> dut <span class="token operator">&lt;</span> vl<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
				vl<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> vl<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">-</span> dut<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" j  k  dut  ee  el  tag\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token comment">//求ee,el和关键活动 </span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc<span class="token punctuation">;</span> p<span class="token punctuation">;</span> p <span class="token operator">=</span> p<span class="token operator">-&gt;</span>nextarc<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			k <span class="token operator">=</span> p<span class="token operator">-&gt;</span>adjvex<span class="token punctuation">;</span>
			dut <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
			ee <span class="token operator">=</span> ve<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
			el <span class="token operator">=</span> vl<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">-</span> dut<span class="token punctuation">;</span>
			tag <span class="token operator">=</span> <span class="token punctuation">(</span>ee <span class="token operator">==</span> el<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">'*'</span> <span class="token operator">:</span> <span class="token string">' '</span><span class="token punctuation">;</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%2d %2d %3d %3d %3d    %c\n"</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">,</span> dut<span class="token punctuation">,</span> ee<span class="token punctuation">,</span> el<span class="token punctuation">,</span> tag<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出关键活动 </span>
		<span class="token punctuation">}</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"关键活动为:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> G<span class="token punctuation">.</span>vexnum<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> 
		<span class="token keyword">for</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>firstarc<span class="token punctuation">;</span> p<span class="token punctuation">;</span> p <span class="token operator">=</span> p<span class="token operator">-&gt;</span>nextarc<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			k <span class="token operator">=</span> p<span class="token operator">-&gt;</span>adjvex<span class="token punctuation">;</span>
			dut <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-&gt;</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ve<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> vl<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">-</span> dut<span class="token punctuation">)</span>
				<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s→%s\n"</span><span class="token punctuation">,</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">,</span> G<span class="token punctuation">.</span>vertices<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出关键活动 </span>
		<span class="token punctuation">}</span>
	<span class="token keyword">return</span> OK<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	ALGraph h<span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请选择有向网\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">CreateGraph</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Display</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">CriticalPath</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="_400"></a>测试样例</h4> 
<pre><code class="prism language-cpp">请选择有向网
请输入图的类型<span class="token punctuation">(</span>有向图<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>有向网<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>无向图<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span>无向网<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">1</span>
请输入图的顶点数和边数<span class="token punctuation">(</span>空格隔开<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">6</span> <span class="token number">8</span>
请输入<span class="token number">6</span>个顶点的值<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token number">5</span>个字符<span class="token punctuation">)</span><span class="token operator">:</span>
v1 v2 v3 v4 v5 v6
请顺序输入每条弧<span class="token punctuation">(</span>边<span class="token punctuation">)</span>的权值、弧尾和弧头<span class="token punctuation">(</span>以空格作为间隔<span class="token punctuation">)</span><span class="token operator">:</span>
<span class="token number">2</span> v1 v3
<span class="token number">3</span> v1 v2
<span class="token number">2</span> v2 v4
<span class="token number">3</span> v2 v5
<span class="token number">1</span> v5 v6
<span class="token number">2</span> v4 v6
<span class="token number">4</span> v3 v4
<span class="token number">3</span> v3 v6
</code></pre> 
<h4><a id="_417"></a>运行结果</h4> 
<pre><code class="prism language-cpp">有向网
<span class="token number">6</span>个顶点：
v1 v2 v3 v4 v5 v6
<span class="token number">8</span>条弧<span class="token punctuation">(</span>边<span class="token punctuation">)</span><span class="token operator">:</span>
v1→v2 <span class="token operator">:</span><span class="token number">3</span> v1→v3 <span class="token operator">:</span><span class="token number">2</span>
v2→v5 <span class="token operator">:</span><span class="token number">3</span> v2→v4 <span class="token operator">:</span><span class="token number">2</span>
v3→v6 <span class="token operator">:</span><span class="token number">3</span> v3→v4 <span class="token operator">:</span><span class="token number">4</span>
v4→v6 <span class="token operator">:</span><span class="token number">2</span>
v5→v6 <span class="token operator">:</span><span class="token number">1</span>

 j  k  dut  ee  el  tag
 <span class="token number">0</span>  <span class="token number">1</span>   <span class="token number">3</span>   <span class="token number">0</span>   <span class="token number">1</span>
 <span class="token number">0</span>  <span class="token number">2</span>   <span class="token number">2</span>   <span class="token number">0</span>   <span class="token number">0</span>    <span class="token operator">*</span>
 <span class="token number">1</span>  <span class="token number">4</span>   <span class="token number">3</span>   <span class="token number">3</span>   <span class="token number">4</span>
 <span class="token number">1</span>  <span class="token number">3</span>   <span class="token number">2</span>   <span class="token number">3</span>   <span class="token number">4</span>
 <span class="token number">2</span>  <span class="token number">5</span>   <span class="token number">3</span>   <span class="token number">2</span>   <span class="token number">5</span>
 <span class="token number">2</span>  <span class="token number">3</span>   <span class="token number">4</span>   <span class="token number">2</span>   <span class="token number">2</span>    <span class="token operator">*</span>
 <span class="token number">3</span>  <span class="token number">5</span>   <span class="token number">2</span>   <span class="token number">6</span>   <span class="token number">6</span>    <span class="token operator">*</span>
 <span class="token number">4</span>  <span class="token number">5</span>   <span class="token number">1</span>   <span class="token number">6</span>   <span class="token number">7</span>
关键活动为<span class="token operator">:</span>
v1→v3
v3→v4
v4→v6
</code></pre> 
<p><img src="https://images2.imgbox.com/e3/09/yGI5Rktr_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="httpsblogcsdnneteternity_memorycategory_11359637htmlspm1001201430015482_446"></a>更多数据结构代码实现请关注我的专栏<a href="https://blog.csdn.net/eternity_memory/category_11359637.html?spm=1001.2014.3001.5482">数据结构</a></h2> 
<h2><a id="20211016chttpsblogcsdnneteternity_memoryarticledetails120793140_447"></a>或者进入<a href="https://blog.csdn.net/eternity_memory/article/details/120793140">2021-10-16【严蔚敏数据结构代码实现合集】【c语言学习必备】</a>学习</h2>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8cfd34c07e73038bf3977ff705afd843/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">去除字符串中重复字符（C语言）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/781ce00550ee5b7e141f7af09e9f22fe/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">移动端H5文件下载（ios、isAndroid)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>