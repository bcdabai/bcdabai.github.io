<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>sklearn实现SVR回归(支持向量机) - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="sklearn实现SVR回归(支持向量机)" />
<meta property="og:description" content="💥 项目专栏：sklearn实现经典机器学习算法(附代码&#43;原理介绍)
文章目录 前言一、算法背景二、算法原理三、算法实现3.1 导包3.2 加载数据集3.3 划分训练集、测试集3.4 定义模型3.5 网格搜索3.6 可视化拟合曲线 完整源码 前言 🌟 哈喽，亲爱的小伙伴们，你们知道吗？最近我们的粉丝群里有好多小可爱私信问我一些关于决策树、逻辑回归等机器学习的超级有趣的问题呢！🌈 为了让大家更轻松地理解，我决定开一个超可爱的专栏，叫做 用sklearn玩转机器学习，特别适合机器学习的小新手哦！
🍬 在这个专栏里，我们会用sklearn这个超级强大的魔法工具来实现各种闪闪发光的机器学习算法！不用担心难度哦，我会用最简单、最可爱的方式，带领大家一起探索算法的神秘世界！✨
🎈 适合哪些小伙伴加入呢？当然是对机器学习感兴趣的小新手们，还有那些刚开始接触sklearn的可爱宝宝们！我们会一起学习如何用sklearn轻松实现那些看起来好厉害的机器学习算法，让新手小白也能快快乐乐地理解它们哦！
🌸 在这个专栏里，大家可以看到用sklearn实现的机器学习算法，我们不仅仅是理论学习哦，每一篇文章都会附带 完整的代码&#43;超级可爱的原理讲解，让大家在轻松愉快的氛围中一起学习成长呢！🌼 快来加入我们的学习大冒险吧！
🚨 我的项目环境：
平台：Windows11语言环境：Python 3.10编译器：Jupyter Lab、PyCharmscikit-learn：1.2.1Pandas：1.3.5Numpy：1.19.3Scipy：1.7.3Matplotlib：3.1.3 💥 项目专栏：sklearn实现经典机器学习算法(附代码&#43;原理介绍)
一、算法背景 支持向量回归（Support Vector Regression，SVR）是一种用于回归分析的机器学习算法，它借鉴了支持向量机（SVM）分类算法的思想。SVR的算法背景如下：
支持向量机（SVM）：
支持向量机是一种用于二元分类的强大机器学习算法。它的核心思想是找到一个能够将两个不同类别的数据分隔开的最优超平面（决策边界），并使得两侧离超平面最近的数据点（支持向量）到超平面的距离最大化。这个距离被称为间隔（margin）。SVM通过优化一个凸二次规划问题来找到最佳超平面，这个问题的目标是最大化间隔，同时限制支持向量的误分类错误。支持向量机还引入了核函数的概念，使其能够处理非线性可分的数据。 SVR的引入：
SVR是基于SVM的思想，专门用于回归问题。与分类不同，回归任务的目标是预测连续数值输出，而不是离散的类别标签。SVR通过在训练数据中找到一个回归函数，以尽量拟合数据点并保持较大的间隔来解决回归问题。与SVM类似，SVR引入了核函数来处理非线性关系。SVR的目标是找到一个最优超平面，使得在这个超平面上的预测值与真实值之间的误差尽可能小，同时限制误差不超过一个用户定义的容忍度。 工作原理：
SVR的工作原理是在训练集上寻找一个超平面，使得所有训练样本点都位于这个超平面的ε-tube（一个带宽为ε的管道）内。ε-tube内的数据点对回归函数的拟合没有影响，而位于ε-tube之外的点会被视为异常值。SVR的目标是最小化误差项，同时限制误差项不超过ε。可以通过调整超参数（如C、ε、核函数等）来控制模型的复杂性和泛化能力。 总之，支持向量回归（SVR）是一种用于回归分析的机器学习算法，它通过在训练数据上找到一个最优超平面来拟合数据，同时限制误差项，从而实现对连续数值输出的预测。SVR借鉴了支持向量机（SVM）的思想，通过核函数处理非线性关系，是回归问题中的有力工具。
二、算法原理 支持向量回归（Support Vector Regression，SVR）是一种用于解决回归问题的机器学习算法，它基于支持向量机（SVM）的思想，并通过最小化带宽为 ε 的管道内的训练数据点与模型预测之间的误差来建立回归模型。以下是SVR的算法原理的详细介绍：
数据表示：
SVR处理的数据集包括一组输入特征（通常表示为X）和对应的连续目标值或标签（通常表示为y）。这些目标值是实数，而不是离散的类别标签。 目标函数：
SVR的目标是建立一个回归函数f(X)，该函数能够预测目标值y。SVR通过最小化目标函数的误差来拟合数据。目标函数通常表示为：min 0.5 * ||f(X) - y||^2 其中，||f(X) - y||^2 表示欧几里得范数（L2范数）的平方，用于测量预测值与真实值之间的距离。 带宽 ε-tube：
SVR引入了一个带宽为 ε 的管道（ε-tube），它是一个容忍度范围，在这个管道内的误差被认为是可以接受的。管道的宽度 ε 是一个超参数，控制了模型的容忍度。SVR的目标是最小化误差项，同时确保大部分训练数据点都位于 ε-tube 内，只有一小部分数据点位于管道外。这些位于管道外的数据点称为&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/275553b54b32aa11e266c1d0104933e9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-12T11:14:56+08:00" />
<meta property="article:modified_time" content="2024-01-12T11:14:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">sklearn实现SVR回归(支持向量机)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/81/b4/7cRhXTH9_o.jpg" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>💥 项目专栏：<a href="https://weibaohang.blog.csdn.net/article/details/135440007" rel="nofollow">sklearn实现经典机器学习算法(附代码+原理介绍)</a></p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_8" rel="nofollow">前言</a></li><li><a href="#_41" rel="nofollow">一、算法背景</a></li><li><a href="#_61" rel="nofollow">二、算法原理</a></li><li><a href="#_101" rel="nofollow">三、算法实现</a></li><li><ul><li><a href="#31__103" rel="nofollow">3.1 导包</a></li><li><a href="#32__115" rel="nofollow">3.2 加载数据集</a></li><li><a href="#33__141" rel="nofollow">3.3 划分训练集、测试集</a></li><li><a href="#34__159" rel="nofollow">3.4 定义模型</a></li><li><a href="#35__208" rel="nofollow">3.5 网格搜索</a></li><li><a href="#36__246" rel="nofollow">3.6 可视化拟合曲线</a></li></ul> 
  </li><li><a href="#_311" rel="nofollow">完整源码</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_8"></a>前言</h2> 
<p>🌟 哈喽，亲爱的小伙伴们，你们知道吗？最近我们的粉丝群里有好多小可爱私信问我一些关于决策树、逻辑回归等机器学习的超级有趣的问题呢！🌈 为了让大家更轻松地理解，我决定开一个超可爱的专栏，叫做 <code>用sklearn玩转机器学习</code>，特别适合机器学习的小新手哦！</p> 
<p>🍬 在这个专栏里，我们会用sklearn这个超级强大的魔法工具来实现各种闪闪发光的机器学习算法！不用担心难度哦，我会用最简单、最可爱的方式，带领大家一起探索算法的神秘世界！✨</p> 
<p>🎈 适合哪些小伙伴加入呢？当然是对机器学习感兴趣的小新手们，还有那些刚开始接触sklearn的可爱宝宝们！我们会一起学习如何用sklearn轻松实现那些看起来好厉害的机器学习算法，让新手小白也能快快乐乐地理解它们哦！</p> 
<p>🌸 在这个专栏里，大家可以看到用sklearn实现的机器学习算法，我们不仅仅是理论学习哦，每一篇文章都会附带 <code>完整的代码+超级可爱的原理讲解</code>，让大家在轻松愉快的氛围中一起学习成长呢！🌼 快来加入我们的学习大冒险吧！</p> 
<hr> 
<p><img src="https://images2.imgbox.com/fc/ef/o1AOlc4l_o.jpg" alt="在这里插入图片描述"></p> 
<p>🚨 我的项目环境：</p> 
<ul><li>平台：Windows11</li><li>语言环境：Python 3.10</li><li>编译器：Jupyter Lab、PyCharm</li><li>scikit-learn：1.2.1</li><li>Pandas：1.3.5</li><li>Numpy：1.19.3</li><li>Scipy：1.7.3</li><li>Matplotlib：3.1.3</li></ul> 
<p>💥 项目专栏：<a href="https://weibaohang.blog.csdn.net/article/details/135440007" rel="nofollow">sklearn实现经典机器学习算法(附代码+原理介绍)</a></p> 
<hr> 
<h2><a id="_41"></a>一、算法背景</h2> 
<p>支持向量回归（Support Vector Regression，SVR）是一种用于回归分析的机器学习算法，它借鉴了支持向量机（SVM）分类算法的思想。SVR的算法背景如下：</p> 
<ol><li> <p>支持向量机（SVM）：</p> 
  <ul><li>支持向量机是一种用于二元分类的强大机器学习算法。它的核心思想是找到一个能够将两个不同类别的数据分隔开的最优超平面（决策边界），并使得两侧离超平面最近的数据点（支持向量）到超平面的距离最大化。这个距离被称为间隔（margin）。</li><li>SVM通过优化一个凸二次规划问题来找到最佳超平面，这个问题的目标是最大化间隔，同时限制支持向量的误分类错误。支持向量机还引入了核函数的概念，使其能够处理非线性可分的数据。</li></ul> </li><li> <p>SVR的引入：</p> 
  <ul><li>SVR是基于SVM的思想，专门用于回归问题。与分类不同，回归任务的目标是预测连续数值输出，而不是离散的类别标签。SVR通过在训练数据中找到一个回归函数，以尽量拟合数据点并保持较大的间隔来解决回归问题。</li><li>与SVM类似，SVR引入了核函数来处理非线性关系。SVR的目标是找到一个最优超平面，使得在这个超平面上的预测值与真实值之间的误差尽可能小，同时限制误差不超过一个用户定义的容忍度。</li></ul> </li><li> <p>工作原理：</p> 
  <ul><li>SVR的工作原理是在训练集上寻找一个超平面，使得所有训练样本点都位于这个超平面的ε-tube（一个带宽为ε的管道）内。ε-tube内的数据点对回归函数的拟合没有影响，而位于ε-tube之外的点会被视为异常值。</li><li>SVR的目标是最小化误差项，同时限制误差项不超过ε。可以通过调整超参数（如C、ε、核函数等）来控制模型的复杂性和泛化能力。</li></ul> </li></ol> 
<p>总之，支持向量回归（SVR）是一种用于回归分析的机器学习算法，它通过在训练数据上找到一个最优超平面来拟合数据，同时限制误差项，从而实现对连续数值输出的预测。SVR借鉴了支持向量机（SVM）的思想，通过核函数处理非线性关系，是回归问题中的有力工具。</p> 
<h2><a id="_61"></a>二、算法原理</h2> 
<p>支持向量回归（Support Vector Regression，SVR）是一种用于解决回归问题的机器学习算法，它基于支持向量机（SVM）的思想，并通过最小化带宽为 ε 的管道内的训练数据点与模型预测之间的误差来建立回归模型。以下是SVR的算法原理的详细介绍：</p> 
<ol><li> <p>数据表示：</p> 
  <ul><li>SVR处理的数据集包括一组输入特征（通常表示为X）和对应的连续目标值或标签（通常表示为y）。这些目标值是实数，而不是离散的类别标签。</li></ul> </li><li> <p>目标函数：</p> 
  <ul><li>SVR的目标是建立一个回归函数f(X)，该函数能够预测目标值y。SVR通过最小化目标函数的误差来拟合数据。目标函数通常表示为：<pre><code>min  0.5 * ||f(X) - y||^2
</code></pre> 其中，||f(X) - y||^2 表示欧几里得范数（L2范数）的平方，用于测量预测值与真实值之间的距离。</li></ul> </li><li> <p>带宽 ε-tube：</p> 
  <ul><li>SVR引入了一个带宽为 ε 的管道（ε-tube），它是一个容忍度范围，在这个管道内的误差被认为是可以接受的。管道的宽度 ε 是一个超参数，控制了模型的容忍度。</li><li>SVR的目标是最小化误差项，同时确保大部分训练数据点都位于 ε-tube 内，只有一小部分数据点位于管道外。这些位于管道外的数据点称为"支持向量"。</li></ul> </li><li> <p>支持向量：</p> 
  <ul><li>在SVR中，支持向量是指那些位于 ε-tube 边界上或管道外的训练数据点。这些数据点对于模型的拟合起着关键作用，它们影响着管道的位置和宽度，从而影响了回归函数的形状。</li><li>支持向量的数目通常较少，因为它们是在训练数据中与模型预测相差较大的样本点。</li></ul> </li><li> <p>超参数调整：</p> 
  <ul><li>SVR有一些关键的超参数需要调整，例如 ε（带宽）、C（正则化参数）、核函数的类型等。这些超参数的选择可以影响模型的性能和复杂性。</li><li>超参数 C 控制了模型的复杂性，较小的 C 值将产生更平滑的回归函数，而较大的 C 值将允许更多的数据点位于 ε-tube 外。</li></ul> </li><li> <p>核函数：</p> 
  <ul><li>类似于支持向量机，SVR也可以使用不同类型的核函数，如线性核、多项式核、RBF（径向基函数）核等，来处理非线性关系。选择适当的核函数对于拟合复杂的数据模式非常重要。</li></ul> </li><li> <p>求解问题：</p> 
  <ul><li>SVR的优化问题可以通过凸二次规划来求解。这个问题的目标是最小化目标函数，并满足约束条件，包括管道内的误差不超过 ε 和支持向量上的误差等于 ε。</li></ul> </li><li> <p>预测：</p> 
  <ul><li>一旦模型训练完成，可以使用它来进行预测。给定一个新的输入样本，SVR会计算出相应的目标值，这个值可以用于回归任务的预测。</li></ul> </li></ol> 
<p>总之，支持向量回归（SVR）是一种用于回归分析的强大算法，它通过最小化带宽为 ε 的管道内的误差来建立回归模型，同时限制了模型的复杂性。SVR的核心思想是通过选择支持向量来捕获数据中的关键信息，从而建立一个能够适应数据分布的回归函数。通过调整超参数和选择合适的核函数，SVR可以处理各种不同类型的回归问题。</p> 
<h2><a id="_101"></a>三、算法实现</h2> 
<h3><a id="31__103"></a>3.1 导包</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error<span class="token punctuation">,</span> r2_score
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token punctuation">,</span> GridSearchCV
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVR
</code></pre> 
<h3><a id="32__115"></a>3.2 加载数据集</h3> 
<p><img src="https://images2.imgbox.com/32/52/OJf4e9gx_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 生成样本数据</span>
X <span class="token operator">=</span> np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 向目标值添加噪声</span>
y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0.5</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>这部分代码用于生成样本数据，并向目标值添加一些噪声。让我为您详细解释每一部分的功能：</p> 
<ol><li> <p><code>X = np.sort(5 * np.random.rand(40, 1), axis=0)</code>：</p> 
  <ul><li>这行代码生成了一个包含40个样本的输入特征 <code>X</code>，这些样本是在0到5之间均匀分布的随机数。<code>np.random.rand(40, 1)</code> 用于生成一个形状为(40, 1)的随机数矩阵，其中每个元素都在0到1之间。然后，通过乘以5，将这些随机数扩展到0到5之间。最后，<code>np.sort</code> 函数对生成的数据进行排序，以确保输入特征按升序排列。</li></ul> </li><li> <p><code>y = np.sin(X).ravel()</code>：</p> 
  <ul><li>这行代码生成了目标值 <code>y</code>，它是输入特征 <code>X</code> 的正弦函数。<code>np.sin(X)</code> 计算了每个输入特征对应的正弦值，并将结果存储在 <code>y</code> 中。<code>.ravel()</code> 函数用于将 <code>y</code> 转换为一维数组，以匹配 <code>X</code> 的形状。</li></ul> </li><li> <p><code>y[::5] += 3 * (0.5 - np.random.rand(8))</code>：</p> 
  <ul><li>这行代码向目标值 <code>y</code> 的每个第5个元素（每隔5个元素）添加一些噪声。具体地说，它在这些位置上添加了从-1.5到1.5之间的随机噪声，这是通过计算 <code>3 * (0.5 - np.random.rand(8))</code> 得到的。这个步骤模拟了实际数据中的随机噪声，使数据更加现实并具有一定的噪声性质。</li></ul> </li></ol> 
<p>最终，您生成了一个具有一些噪声的正弦函数数据集，这样可以用于训练和测试支持向量回归（SVR）模型。这个数据集包含输入特征 <code>X</code> 和对应的目标值 <code>y</code>，用于建立回归模型并评估其性能。</p> 
<h3><a id="33__141"></a>3.3 划分训练集、测试集</h3> 
<p>在机器学习中，将数据集分为训练集和测试集是为了评估模型的性能。训练集用于训练模型，而测试集用于评估模型在未见过的数据上的表现。您已经正确地将数据分为训练集和测试集。以下是您的代码和解释：</p> 
<ul><li><code>train_test_split</code> 函数是Scikit-Learn中用于将数据集分割成训练集和测试集的函数。</li><li><code>X</code> 是输入特征的数据，<code>y</code> 是目标值（标签）的数据。</li><li><code>test_size=0.2</code> 指定了测试集的大小，这里设置为20%。这意味着80%的数据将用于训练模型，而20%的数据将用于测试模型。</li><li><code>random_state=42</code> 是一个随机种子，它确保每次运行代码时分割的方式都是相同的，以便结果的可重复性。</li></ul> 
<p>分割数据集是一个重要的步骤，它允许您在训练模型之后评估其性能，并检查模型在未见过的数据上的泛化能力。训练集用于拟合模型，而测试集用于评估模型的预测能力。</p> 
<pre><code class="prism language-python"><span class="token comment"># 将数据分为训练集和测试集</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="34__159"></a>3.4 定义模型</h3> 
<p>已经创建了三个不同核函数的支持向量回归（SVR）模型，包括RBF核、线性核和多项式核。以下是每个模型的说明：</p> 
<ol><li> <p>RBF核模型 (<code>svr_rbf</code>)：</p> 
  <ul><li>使用径向基函数（Radial Basis Function，RBF）核。RBF核是一种常用的非线性核函数，适用于处理复杂的非线性关系。</li><li><code>C=100</code> 是正则化参数，控制了模型的复杂性。较大的C值允许模型更好地拟合训练数据，但可能导致过拟合。</li><li><code>gamma=0.1</code> 是RBF核的一个超参数，控制了核函数的形状。较小的gamma值会产生较大的核函数半径，从而使模型更平滑。</li><li><code>epsilon=0.1</code> 是SVR中带宽 ε-tube 的带宽参数，它控制了对训练误差的容忍度。</li></ul> </li><li> <p>线性核模型 (<code>svr_lin</code>)：</p> 
  <ul><li>使用线性核。线性核适用于处理线性关系的问题，它在数据线性可分时表现良好。</li><li><code>C=100</code> 是正则化参数，与RBF核相同，它控制了模型的复杂性。</li></ul> </li><li> <p>多项式核模型 (<code>svr_poly</code>)：</p> 
  <ul><li>使用多项式核。多项式核适用于处理多项式关系的问题，通过增加多项式的次数来建模数据。</li><li><code>C=100</code> 是正则化参数，与其他核相同。</li><li><code>degree=3</code> 是多项式核的次数，指定了多项式的阶数，这里是3次多项式。</li></ul> </li></ol> 
<p>这些不同核函数的选择允许您在回归问题中尝试不同的函数形式，以找到最适合数据的模型。接下来，您可以使用这些模型进行训练和测试，然后评估它们在您的数据集上的性能。</p> 
<pre><code class="prism language-python"><span class="token comment"># 创建SVR模型，包括RBF、线性和多项式核函数</span>
svr_rbf <span class="token operator">=</span> SVR<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">"rbf"</span><span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> epsilon<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>
svr_lin <span class="token operator">=</span> SVR<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">"linear"</span><span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
svr_poly <span class="token operator">=</span> SVR<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">"poly"</span><span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> degree<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre> 
<p>以下是以表格形式展示Scikit-Learn中支持向量回归（SVR）类的常用参数，包括参数名称、描述以及可选的值或类型：</p> 
<table><thead><tr><th>参数</th><th>描述</th><th>可选的值/类型</th></tr></thead><tbody><tr><td><code>kernel</code></td><td>用于指定核函数的类型。</td><td>‘linear’, ‘poly’, ‘rbf’, ‘sigmoid’, ‘precomputed’</td></tr><tr><td><code>C</code></td><td>正则化强度的倒数，较小的值表示更强的正则化。</td><td>正浮点数</td></tr><tr><td><code>epsilon</code></td><td>ε-tube的宽度，用于控制对训练误差的容忍度。</td><td>正浮点数</td></tr><tr><td><code>gamma</code></td><td>RBF、多项式、Sigmoid核函数的系数。</td><td>正浮点数、‘scale’、‘auto’</td></tr><tr><td><code>degree</code></td><td>多项式核的次数（仅对多项式核有效）。</td><td>正整数</td></tr><tr><td><code>coef0</code></td><td>核函数的独立系数（仅对多项式和Sigmoid核有效）。</td><td>浮点数</td></tr><tr><td><code>shrinking</code></td><td>是否启用收缩启发式算法，可以加速训练。</td><td>布尔值</td></tr><tr><td><code>tol</code></td><td>求解器的收敛容忍度。</td><td>正浮点数</td></tr><tr><td><code>max_iter</code></td><td>求解器的最大迭代次数。</td><td>正整数</td></tr><tr><td><code>cache_size</code></td><td>内核缓存大小（以MB为单位）。</td><td>正整数</td></tr><tr><td><code>verbose</code></td><td>控制详细程度的日志输出级别。</td><td>正整数</td></tr><tr><td><code>coef0</code></td><td>核函数的独立系数（仅对多项式和Sigmoid核有效）。</td><td>浮点数</td></tr><tr><td><code>random_state</code></td><td>随机数生成器的种子。</td><td>整数或 None</td></tr><tr><td><code>decision_function_shape</code></td><td>决策函数的形状，用于多类分类问题。</td><td>‘ovo’（一对一）、‘ovr’（一对其余）或 None</td></tr></tbody></table> 
<p>这些参数允许您在构建支持向量回归模型时进行精细的调整，以满足您特定的数据和任务需求。不同的核函数和超参数选择可以影响模型的性能和拟合能力。理解这些参数及其影响有助于优化SVR模型以获得最佳的回归结果。</p> 
<h3><a id="35__208"></a>3.5 网格搜索</h3> 
<p>这段代码用于使用网格搜索（Grid Search）来寻找支持向量回归（SVR）模型的最佳超参数组合。以下是代码的详细说明：</p> 
<ol><li> <p><code>param_grid</code> 字典定义了需要搜索的超参数和其候选值：</p> 
  <ul><li><code>'C'</code>: 正则化参数C的候选值，包括1、10和100。</li><li><code>'kernel'</code>: 核函数的候选类型，包括’rbf’（径向基函数核）、‘linear’（线性核）和’poly’（多项式核）。</li><li><code>'gamma'</code>: RBF和多项式核的系数γ的候选值，包括0.1和1。</li></ul> </li><li> <p><code>GridSearchCV(SVR(), param_grid, cv=5)</code>：</p> 
  <ul><li><code>GridSearchCV</code> 是Scikit-Learn中的网格搜索交叉验证工具，用于在指定参数范围内搜索最佳超参数组合。</li><li><code>SVR()</code> 创建了一个支持向量回归模型的实例，<code>param_grid</code> 指定了需要搜索的超参数范围。</li><li><code>cv=5</code> 指定了交叉验证的折数，这里设置为5折交叉验证，以评估不同参数组合的性能。</li></ul> </li><li> <p><code>grid_search.fit(X_train, y_train)</code>：</p> 
  <ul><li><code>fit</code> 方法执行了网格搜索过程，它将在训练集 <code>X_train</code> 和 <code>y_train</code> 上寻找最佳超参数组合。</li><li>网格搜索会尝试所有可能的参数组合，并使用交叉验证来评估每个组合的性能。</li></ul> </li><li> <p><code>best_svr = grid_search.best_estimator_</code>：</p> 
  <ul><li>一旦网格搜索完成，<code>best_estimator_</code> 属性会返回具有最佳性能的SVR模型。</li><li>这个最佳模型包含了最佳超参数组合下训练得到的SVR。</li></ul> </li></ol> 
<p>通过执行这段代码，您可以找到在指定的超参数范围内性能最佳的SVR模型，以便用于回归任务。这有助于提高模型的性能并获得更好的预测结果。</p> 
<pre><code class="prism language-python"><span class="token comment"># 使用网格搜索来寻找最佳超参数</span>
param_grid <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'kernel'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'rbf'</span><span class="token punctuation">,</span> <span class="token string">'linear'</span><span class="token punctuation">,</span> <span class="token string">'poly'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'gamma'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
grid_search <span class="token operator">=</span> GridSearchCV<span class="token punctuation">(</span>SVR<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> param_grid<span class="token punctuation">,</span> cv<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
grid_search<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

<span class="token comment"># 获取最佳模型</span>
best_svr <span class="token operator">=</span> grid_search<span class="token punctuation">.</span>best_estimator_
</code></pre> 
<h3><a id="36__246"></a>3.6 可视化拟合曲线</h3> 
<p><img src="https://images2.imgbox.com/ea/bf/FQCJy9rq_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 用于可视化的设置</span>
lw <span class="token operator">=</span> <span class="token number">2</span>
svrs <span class="token operator">=</span> <span class="token punctuation">[</span>svr_rbf<span class="token punctuation">,</span> svr_lin<span class="token punctuation">,</span> svr_poly<span class="token punctuation">]</span>
kernel_label <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"RBF"</span><span class="token punctuation">,</span> <span class="token string">"Linear"</span><span class="token punctuation">,</span> <span class="token string">"Polynomial"</span><span class="token punctuation">]</span>
model_color <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"m"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"g"</span><span class="token punctuation">]</span>

<span class="token comment"># 创建子图</span>
fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>nrows<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> ncols<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sharey<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 训练模型并绘制结果</span>
<span class="token keyword">for</span> ix<span class="token punctuation">,</span> svr <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>svrs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y_pred <span class="token operator">=</span> svr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> color<span class="token operator">=</span>model_color<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">,</span> lw<span class="token operator">=</span>lw<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"{} model"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>kernel_label<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">"none"</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">"k"</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"training data"</span><span class="token punctuation">)</span>
    axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">"none"</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">"r"</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"testing data"</span><span class="token punctuation">)</span>
    axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
    axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"SVR with {} kernel"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>kernel_label<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">0.02</span><span class="token punctuation">,</span> <span class="token number">0.85</span><span class="token punctuation">,</span> <span class="token string">"MSE: {:.2f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mean_squared_error<span class="token punctuation">(</span>y<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> transform<span class="token operator">=</span>axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>transAxes<span class="token punctuation">)</span>
    axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">0.02</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token string">"R2: {:.2f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>r2_score<span class="token punctuation">(</span>y<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> transform<span class="token operator">=</span>axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>transAxes<span class="token punctuation">)</span>

fig<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.04</span><span class="token punctuation">,</span> <span class="token string">"data"</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">0.06</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token string">"target"</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token string">"vertical"</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>suptitle<span class="token punctuation">(</span><span class="token string">"Support Vector Regression"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>这段代码用于可视化不同核函数的支持向量回归（SVR）模型的训练和预测结果，并展示了模型性能的评估指标。以下是代码的详细说明：</p> 
<ol><li> <p><code>lw = 2</code>：</p> 
  <ul><li><code>lw</code> 是线宽（linewidth）参数，用于指定线条的宽度。</li></ul> </li><li> <p><code>svrs = [svr_rbf, svr_lin, svr_poly]</code>：</p> 
  <ul><li><code>svrs</code> 是一个包含了三种不同核函数的SVR模型的列表。这些模型分别是RBF核、线性核和多项式核，之前已经创建。</li></ul> </li><li> <p><code>kernel_label = ["RBF", "Linear", "Polynomial"]</code>：</p> 
  <ul><li><code>kernel_label</code> 是一个包含核函数类型名称的列表，用于标识每个模型的核函数类型。</li></ul> </li><li> <p><code>model_color = ["m", "c", "g"]</code>：</p> 
  <ul><li><code>model_color</code> 是一个包含模型图形颜色的列表，用于为每个模型选择不同的颜色。</li></ul> </li><li> <p>创建子图：</p> 
  <ul><li><code>fig, axes = plt.subplots(nrows=1, ncols=3, figsize=(15, 5), sharey=True)</code> 创建了一个包含3个子图的图形，每个子图对应一个不同核函数的SVR模型的结果可视化。</li><li><code>nrows=1</code> 和 <code>ncols=3</code> 指定了子图的行数和列数，<code>figsize</code> 指定了图形的尺寸，<code>sharey=True</code> 表示所有子图共享y轴刻度。</li></ul> </li><li> <p>训练模型并绘制结果：</p> 
  <ul><li>使用一个循环遍历每个SVR模型（RBF、线性、多项式）： 
    <ul><li><code>y_pred = svr.fit(X_train, y_train).predict(X)</code> 训练模型并对所有数据点进行预测，将结果存储在 <code>y_pred</code> 中。</li><li><code>axes[ix].plot(X, y_pred, color=model_color[ix], lw=lw, label="{} model".format(kernel_label[ix]))</code> 绘制模型的预测结果曲线。</li><li><code>axes[ix].scatter(X_train, y_train, facecolor="none", edgecolor="k", s=50, label="training data")</code> 绘制训练数据点。</li><li><code>axes[ix].scatter(X_test, y_test, facecolor="none", edgecolor="r", s=50, label="testing data")</code> 绘制测试数据点。</li><li><code>axes[ix].legend()</code> 添加图例。</li><li><code>axes[ix].set_title("SVR with {} kernel".format(kernel_label[ix]))</code> 设置子图的标题。</li><li>使用 <code>axes[ix].text</code> 在子图中添加MSE和R2评估指标的文本标签。</li></ul> </li></ul> </li><li> <p>最后的一些代码用于设置图形的标签、标题和显示。</p> </li></ol> 
<p>通过执行这段代码，您可以可视化不同核函数下SVR模型的拟合情况，以及模型性能的评估指标（均方误差和R²分数）。这有助于您比较不同核函数的模型性能并选择最合适的SVR模型。</p> 
<h2><a id="_311"></a>完整源码</h2> 
<pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error<span class="token punctuation">,</span> r2_score
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token punctuation">,</span> GridSearchCV
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVR

<span class="token comment"># 生成样本数据</span>
X <span class="token operator">=</span> np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 向目标值添加噪声</span>
y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0.5</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 将数据分为训练集和测试集</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># 创建SVR模型，包括RBF、线性和多项式核函数</span>
svr_rbf <span class="token operator">=</span> SVR<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">"rbf"</span><span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> epsilon<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>
svr_lin <span class="token operator">=</span> SVR<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">"linear"</span><span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
svr_poly <span class="token operator">=</span> SVR<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">"poly"</span><span class="token punctuation">,</span> C<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> degree<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment"># 使用网格搜索来寻找最佳超参数</span>
param_grid <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'kernel'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'rbf'</span><span class="token punctuation">,</span> <span class="token string">'linear'</span><span class="token punctuation">,</span> <span class="token string">'poly'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'gamma'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
grid_search <span class="token operator">=</span> GridSearchCV<span class="token punctuation">(</span>SVR<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> param_grid<span class="token punctuation">,</span> cv<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
grid_search<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>

<span class="token comment"># 获取最佳模型</span>
best_svr <span class="token operator">=</span> grid_search<span class="token punctuation">.</span>best_estimator_

<span class="token comment"># 用于可视化的设置</span>
lw <span class="token operator">=</span> <span class="token number">2</span>
svrs <span class="token operator">=</span> <span class="token punctuation">[</span>svr_rbf<span class="token punctuation">,</span> svr_lin<span class="token punctuation">,</span> svr_poly<span class="token punctuation">]</span>
kernel_label <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"RBF"</span><span class="token punctuation">,</span> <span class="token string">"Linear"</span><span class="token punctuation">,</span> <span class="token string">"Polynomial"</span><span class="token punctuation">]</span>
model_color <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"m"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"g"</span><span class="token punctuation">]</span>

<span class="token comment"># 创建子图</span>
fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>nrows<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> ncols<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sharey<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 训练模型并绘制结果</span>
<span class="token keyword">for</span> ix<span class="token punctuation">,</span> svr <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>svrs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y_pred <span class="token operator">=</span> svr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
    axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> color<span class="token operator">=</span>model_color<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">,</span> lw<span class="token operator">=</span>lw<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"{} model"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>kernel_label<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">"none"</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">"k"</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"training data"</span><span class="token punctuation">)</span>
    axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">"none"</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">"r"</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"testing data"</span><span class="token punctuation">)</span>
    axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
    axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"SVR with {} kernel"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>kernel_label<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">0.02</span><span class="token punctuation">,</span> <span class="token number">0.85</span><span class="token punctuation">,</span> <span class="token string">"MSE: {:.2f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>mean_squared_error<span class="token punctuation">(</span>y<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> transform<span class="token operator">=</span>axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>transAxes<span class="token punctuation">)</span>
    axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">0.02</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token string">"R2: {:.2f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>r2_score<span class="token punctuation">(</span>y<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> transform<span class="token operator">=</span>axes<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">.</span>transAxes<span class="token punctuation">)</span>

fig<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.04</span><span class="token punctuation">,</span> <span class="token string">"data"</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">0.06</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token string">"target"</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">,</span> va<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token string">"vertical"</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>suptitle<span class="token punctuation">(</span><span class="token string">"Support Vector Regression"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 打印最佳超参数和评估指标</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"最佳超参数:"</span><span class="token punctuation">,</span> grid_search<span class="token punctuation">.</span>best_params_<span class="token punctuation">)</span>
y_pred_train <span class="token operator">=</span> best_svr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
y_pred_test <span class="token operator">=</span> best_svr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"训练集MSE:"</span><span class="token punctuation">,</span> mean_squared_error<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> y_pred_train<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"训练集R2:"</span><span class="token punctuation">,</span> r2_score<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> y_pred_train<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"测试集MSE:"</span><span class="token punctuation">,</span> mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred_test<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"测试集R2:"</span><span class="token punctuation">,</span> r2_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred_test<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0e82976e9f059d9e9e424f628c56427b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">关于三目运算符的一些理解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7899ea8c899ffa16824432ca0ddd8064/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【Vue3/Vue2】判断设备是移动端还是pc端跳转不同路由router</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>