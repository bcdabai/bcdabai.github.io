<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android list 泛型 用Gson 转json字符串 出现 java.lang.StackOverflowError异常解决 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android list 泛型 用Gson 转json字符串 出现 java.lang.StackOverflowError异常解决" />
<meta property="og:description" content="不废话 第一次写博客，不知道怎么写， 直接进入主题
我来这最熟悉的代码
@Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); initUI(); } private void initUI() { save = (Button) findViewById(R.id.save); read = (Button) findViewById(R.id.read); textView = (TextView) findViewById(R.id.textview); save.setOnClickListener(this); read.setOnClickListener(this); } @Override public void onClick(View v) { switch (v.getId()) { case R.id.save: initData(); break; case R.id.read: break; } } private void initData() { // TODO Auto-generated method stub LinkedList&lt;MyTrafficDetailsBin&gt; detailsBins=new LinkedList&lt;MyTrafficDetailsBin&gt;(); for (int i = 0; i &lt; 20; i&#43;&#43;) { MyTrafficDetailsBin bin=new MyTrafficDetailsBin(i, &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/9499427fe3d5c1ffc98d4d67577e9d75/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-09-16T12:12:04+08:00" />
<meta property="article:modified_time" content="2015-09-16T12:12:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android list 泛型 用Gson 转json字符串 出现 java.lang.StackOverflowError异常解决</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p> 不废话 第一次写博客，不知道怎么写，  直接进入主题</p> 
<p>我来这最熟悉的代码</p> 
<pre><code class="language-html">	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_main);
		initUI();
	}
	private void initUI() {
		save = (Button) findViewById(R.id.save);
		read = (Button) findViewById(R.id.read);
		textView = (TextView) findViewById(R.id.textview);
		save.setOnClickListener(this);
		read.setOnClickListener(this);
	}
	@Override
	public void onClick(View v) {
		switch (v.getId()) {
		case R.id.save:
			initData();
			break;
		case R.id.read:
			break;
		}
	}
	private void initData() {
		// TODO Auto-generated method stub
		LinkedList&lt;MyTrafficDetailsBin&gt; detailsBins=new LinkedList&lt;MyTrafficDetailsBin&gt;();
		for (int i = 0; i &lt; 20; i++) {
			MyTrafficDetailsBin bin=new MyTrafficDetailsBin(i, "名称:"+i, "时间:"+i, "appname:"+i);
			detailsBins.add(bin);
		}
		Gson gson=new Gson();
		String json = gson.toJson(detailsBins);
		Log.e("保存数据：", json);
	}</code></pre> 
<p><br> 这样直接转的话会出现异常java.lang.StackOverflowError 堆栈溢出</p> 
<p><img alt="" src="https://images2.imgbox.com/bc/f4/jeP3oggd_o.png"></p> 
<p> </p> 
<p>于是我在网上找了很多答案也没有找到明确的处理方法，也查询了导致这个错误的真正原因，这里就不贴出来了，</p> 
<p>后来查看了一些写博客比较火的人他们写的文章，还是不适合废话直接上解决方案吧</p> 
<p> </p> 
<pre><code class="language-html">private void initData() {
		// TODO Auto-generated method stub
		LinkedList&lt;MyTrafficDetailsBin&gt; detailsBins=new LinkedList&lt;MyTrafficDetailsBin&gt;();
		for (int i = 0; i &lt; 20; i++) {
			MyTrafficDetailsBin bin=new MyTrafficDetailsBin(i, "名称:"+i, "时间:"+i, "appname:"+i);
			detailsBins.add(bin);
		}
		Gson gson = new GsonBuilder()
		 .excludeFieldsWithoutExposeAnnotation() //不导出实体中没有用@Expose注解的属性  
		       .enableComplexMapKeySerialization() //
		        .serializeNulls().setDateFormat("yyyy-MM-dd HH:mm:ss:SSS")//   
		        .setFieldNamingPolicy(FieldNamingPolicy.UPPER_CAMEL_CASE)//		   </code></pre> 
<pre><code class="language-html">    			.setPrettyPrinting() //对json结果格式化.  
		        .setVersion(1.0).  
		create();
		String json = gson.toJson(detailsBins);
		Log.e("保存数据：", json);
	}</code></pre> 
<p> </p> 
<p>请求注意了   你的 list里面的对象类 一定要@Expose注解属性，不然你的字段全都为null，  当然你不需要的字段就不要注解了，</p> 
<p><img alt="" src="https://images2.imgbox.com/15/5e/J1CCXxpg_o.png"><br> </p> 
<p> </p> 
<p>读取保存的数据也是这样</p> 
<p> </p> 
<pre><code class="language-html">private void initData() {
		// TODO Auto-generated method stub
		LinkedList&lt;MyTrafficDetailsBin&gt; detailsBins=new LinkedList&lt;MyTrafficDetailsBin&gt;();
		for (int i = 0; i &lt; 20; i++) {
			MyTrafficDetailsBin bin=new MyTrafficDetailsBin(i, "名称:"+i, "时间:"+i, "appname:"+i);
			detailsBins.add(bin);
		}
		Gson gson = new GsonBuilder()
		 .excludeFieldsWithoutExposeAnnotation() //不导出实体中没有用@Expose注解的属性  
		       .enableComplexMapKeySerialization() //	</code></pre> 
<pre><code class="language-html">	        .serializeNulls().setDateFormat("yyyy-MM-dd HH:mm:ss:SSS")		  </code></pre> 
<pre><code class="language-html">      		.setFieldNamingPolicy(FieldNamingPolicy.UPPER_CAMEL_CASE)//  
		       .setPrettyPrinting() //对json结果格式化.  
		        .setVersion(1.0).  
		create();
		String json = gson.toJson(detailsBins);
		Log.e("保存数据：", json);
		
		Type typeOfT=new TypeToken&lt;LinkedList&lt;MyTrafficDetailsBin&gt;&gt;(){}.getType();
		LinkedList&lt;MyTrafficDetailsBin&gt; bins=gson.fromJson(json, typeOfT);
		for (int i = 0; i &lt; bins.size(); i++) {
			Log.e("显示数据appname：", bins.get(i).getAppname());
		}
	}</code></pre> 
<p><img alt="" src="https://images2.imgbox.com/7e/cd/Elj8F1Ci_o.png"></p> 
<p> </p> 
<p>好吧就写到这里，  希望遇到这个问题能看懂我这篇文章，写的实在不好。</p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c142924184f05a367db5471f7d1996bc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">css input[type=file] 样式美化，input上传按钮美化</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ff621296119d8829476fb75f9b6ee4ad/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">LSD-SLAM 编译过程（Ubuntu 14.04 &#43; ROS Indigo）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>