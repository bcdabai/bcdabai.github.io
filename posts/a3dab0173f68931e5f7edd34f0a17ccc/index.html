<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>mysql5.7实践之路 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="mysql5.7实践之路" />
<meta property="og:description" content="mysql5.7实践之路 1 mysql linux版安装1.1 下载地址2.2 检查当前系统是否安装过mysql2.3 安装mysql服务端2.4 查看mysql安装时创建的mysql用户和mysql组2.5 mysql服务的启动&#43;停止 3 mysql服务启动后，连接3.1 连接报错3.2 查看默认密码3.3 使用默认密码登录3.4 修改密码3.5 设置root可远程登录4 自启动mysql服务2.8 修改配置文件位置2.9 修改字符集和数据存储路径 3、mysql配置文件3.1 二进制日志log-bin3.2 错误日志log-error3.3 查询日志log3.4 数据文件3.4.1 frm文件3.4.1 myd文件3.4.1 myi文件 3.5 如何配置 4、mysql逻辑架构介绍4.1 连接层4.2 服务层4.3 引擎层4.4 存储层 5、mysql存储引擎mysql配置文件 1 mysql linux版安装 二级制源码安装、rpm包本地安装、yum安装。
本次采用rpm安装
1.1 下载地址 https://dev.mysql.com/downloads/
beta版
release版
ga版（稳定发布版）generally available release
mysql-community-common-5.7.27-1.el6.x86_64.rpm
mysql-community-libs-5.7.27-1.el6.x86_64.rpm
mysql-community-client-5.7.27-1.el6.x86_64.rpm
mysql-community-server-5.7.27-1.el6.x86_64.rpm
2.2 检查当前系统是否安装过mysql # 查询当前系统是否安装过mariadb或mysql rpm -qa | grep -i &#39;mariadb\|mysql&#39; # 删除卸载安装过的package rpm -e xxxx rpm -e --nodeps yyyy 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a3dab0173f68931e5f7edd34f0a17ccc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-27T13:51:55+08:00" />
<meta property="article:modified_time" content="2023-02-27T13:51:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">mysql5.7实践之路</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>mysql5.7实践之路</h4> 
 <ul><li><a href="#1_mysql_linux_2" rel="nofollow">1 mysql linux版安装</a></li><li><ul><li><a href="#11__6" rel="nofollow">1.1 下载地址</a></li><li><a href="#22_mysql_18" rel="nofollow">2.2 检查当前系统是否安装过mysql</a></li><li><a href="#23_mysql_26" rel="nofollow">2.3 安装mysql服务端</a></li><li><a href="#24_mysqlmysqlmysql_35" rel="nofollow">2.4 查看mysql安装时创建的mysql用户和mysql组</a></li><li><a href="#25_mysql_40" rel="nofollow">2.5 mysql服务的启动+停止</a></li></ul> 
  </li><li><a href="#3_mysql_76" rel="nofollow">3 mysql服务启动后，连接</a></li><li><ul><li><a href="#31__77" rel="nofollow">3.1 连接报错</a></li><li><a href="#32__83" rel="nofollow">3.2 查看默认密码</a></li><li><a href="#33__89" rel="nofollow">3.3 使用默认密码登录</a></li><li><a href="#34__94" rel="nofollow">3.4 修改密码</a></li><li><a href="#35_root_103" rel="nofollow">3.5 设置root可远程登录</a></li><li><a href="#4_mysql_119" rel="nofollow">4 自启动mysql服务</a></li><li><ul><li><a href="#28__129" rel="nofollow">2.8 修改配置文件位置</a></li><li><a href="#29__144" rel="nofollow">2.9 修改字符集和数据存储路径</a></li></ul> 
  </li></ul> 
  </li><li><a href="#3mysql_223" rel="nofollow">3、mysql配置文件</a></li><li><ul><li><ul><li><a href="#31_logbin_224" rel="nofollow">3.1 二进制日志log-bin</a></li><li><a href="#32_logerror_232" rel="nofollow">3.2 错误日志log-error</a></li><li><a href="#33_log_234" rel="nofollow">3.3 查询日志log</a></li><li><a href="#34__237" rel="nofollow">3.4 数据文件</a></li><li><ul><li><ul><li><a href="#341_frm_241" rel="nofollow">3.4.1 frm文件</a></li><li><a href="#341_myd_243" rel="nofollow">3.4.1 myd文件</a></li><li><a href="#341_myi_245" rel="nofollow">3.4.1 myi文件</a></li></ul> 
    </li></ul> 
    </li><li><a href="#35__248" rel="nofollow">3.5 如何配置</a></li></ul> 
  </li></ul> 
  </li><li><a href="#4mysql_259" rel="nofollow">4、mysql逻辑架构介绍</a></li><li><ul><li><ul><li><ul><li><a href="#41__263" rel="nofollow">4.1 连接层</a></li><li><a href="#42__265" rel="nofollow">4.2 服务层</a></li><li><a href="#43__267" rel="nofollow">4.3 引擎层</a></li><li><a href="#44__269" rel="nofollow">4.4 存储层</a></li></ul> 
   </li></ul> 
  </li></ul> 
  </li><li><a href="#5mysql_274" rel="nofollow">5、mysql存储引擎</a></li><li><a href="#mysql_727" rel="nofollow">mysql配置文件</a></li></ul> 
</div> 
<p></p> 
<h2><a id="1_mysql_linux_2"></a>1 mysql linux版安装</h2> 
<p>二级制源码安装、rpm包本地安装、yum安装。<br> 本次采用rpm安装</p> 
<h3><a id="11__6"></a>1.1 下载地址</h3> 
<p>https://dev.mysql.com/downloads/<br> beta版<br> release版<br> ga版（稳定发布版）generally available release</p> 
<blockquote> 
 <p>mysql-community-common-5.7.27-1.el6.x86_64.rpm<br> mysql-community-libs-5.7.27-1.el6.x86_64.rpm<br> mysql-community-client-5.7.27-1.el6.x86_64.rpm<br> mysql-community-server-5.7.27-1.el6.x86_64.rpm</p> 
</blockquote> 
<h3><a id="22_mysql_18"></a>2.2 检查当前系统是否安装过mysql</h3> 
<pre><code class="prism language-shell"><span class="token comment"># 查询当前系统是否安装过mariadb或mysql</span>
<span class="token function">rpm</span> <span class="token parameter variable">-qa</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-i</span> <span class="token string">'mariadb\|mysql'</span>
<span class="token comment"># 删除卸载安装过的package</span>
<span class="token function">rpm</span> <span class="token parameter variable">-e</span> xxxx
<span class="token function">rpm</span> <span class="token parameter variable">-e</span> <span class="token parameter variable">--nodeps</span> yyyy
</code></pre> 
<h3><a id="23_mysql_26"></a>2.3 安装mysql服务端</h3> 
<pre><code class="prism language-shell"><span class="token comment"># rpm包有依赖顺序</span>
<span class="token function">rpm</span> <span class="token parameter variable">-ivh</span> mysql-community-common-5.7.27-1.el6.x86_64.rpm 
<span class="token function">rpm</span> <span class="token parameter variable">-ivh</span> mysql-community-libs-5.7.27-1.el6.x86_64.rpm 
<span class="token function">rpm</span> <span class="token parameter variable">-ivh</span> mysql-community-client-5.7.27-1.el6.x86_64.rpm 
<span class="token function">rpm</span> <span class="token parameter variable">-ivh</span> mysql-community-server-5.7.27-1.el6.x86_64.rpm 
</code></pre> 
<h3><a id="24_mysqlmysqlmysql_35"></a>2.4 查看mysql安装时创建的mysql用户和mysql组</h3> 
<pre><code class="prism language-shell"><span class="token function">cat</span> /etc/passwd <span class="token operator">|</span> <span class="token function">grep</span> mysql
<span class="token function">cat</span> /etc/group <span class="token operator">|</span> <span class="token function">grep</span> mysql
</code></pre> 
<h3><a id="25_mysql_40"></a>2.5 mysql服务的启动+停止</h3> 
<pre><code class="prism language-shell"><span class="token comment">#启动mysql</span>
<span class="token function">service</span> mysqld start
<span class="token comment">#关闭mysql</span>
<span class="token function">service</span> mysqld stop
</code></pre> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@michael ~<span class="token punctuation">]</span><span class="token comment"># ps -ef | grep mysql | grep -v grep</span>
root       <span class="token number">3065</span>      <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">23</span>:05 pts/0    00:00:00 /bin/sh /usr/bin/mysqld_safe <span class="token parameter variable">--datadir</span><span class="token operator">=</span>/var/lib/mysql <span class="token parameter variable">--socket</span><span class="token operator">=</span>/var/lib/mysql/mysql.sock --pid-file<span class="token operator">=</span>/var/run/mysqld/mysqld.pid <span class="token parameter variable">--basedir</span><span class="token operator">=</span>/usr <span class="token parameter variable">--user</span><span class="token operator">=</span>mysql
mysql      <span class="token number">3259</span>   <span class="token number">3065</span>  <span class="token number">0</span> <span class="token number">23</span>:05 pts/0    00:00:00 /usr/sbin/mysqld <span class="token parameter variable">--basedir</span><span class="token operator">=</span>/usr <span class="token parameter variable">--datadir</span><span class="token operator">=</span>/var/lib/mysql --plugin-dir<span class="token operator">=</span>/usr/lib64/mysql/plugin <span class="token parameter variable">--user</span><span class="token operator">=</span>mysql --log-error<span class="token operator">=</span>/var/log/mysqld.log --pid-file<span class="token operator">=</span>/var/run/mysqld/mysqld.pid <span class="token parameter variable">--socket</span><span class="token operator">=</span>/var/lib/mysql/mysql.sock
</code></pre> 
<p>针对上面的参数简单记录</p> 
<pre><code class="prism language-bash">/bin/sh /usr/bin/mysqld_safe 			使用bash运行的具体脚本
<span class="token parameter variable">--datadir</span><span class="token operator">=</span>/var/lib/mysql 				数据库文件保存目录
<span class="token parameter variable">--socket</span><span class="token operator">=</span>/var/lib/mysql/mysql.sock 		sock文件位置,3306
--pid-file<span class="token operator">=</span>/var/run/mysqld/mysqld.pid 	进程标识文件位置
<span class="token parameter variable">--basedir</span><span class="token operator">=</span>/usr 							mysql管理软件安装位置
<span class="token parameter variable">--user</span><span class="token operator">=</span>mysql							运行用户				
</code></pre> 
<pre><code class="prism language-bash">/usr/sbin/mysqld 								mysqld数据库管理系统运行程序
<span class="token parameter variable">--basedir</span><span class="token operator">=</span>/usr 									mysql管理软件安装位置
<span class="token parameter variable">--datadir</span><span class="token operator">=</span>/var/lib/mysql 						数据库文件保存目录
--plugin-dir<span class="token operator">=</span>/usr/lib64/mysql/plugin 			插件
<span class="token parameter variable">--user</span><span class="token operator">=</span>mysql 									mysqld服务的启动用户
--log-error<span class="token operator">=</span>/var/log/mysqld.log 				错误日志位置
--pid-file<span class="token operator">=</span>/var/run/mysqld/mysqld.pid 			进程标识文件位置
<span class="token parameter variable">--socket</span><span class="token operator">=</span>/var/lib/mysql/mysql.sock				sock文件位置,3306

</code></pre> 
<h2><a id="3_mysql_76"></a>3 mysql服务启动后，连接</h2> 
<h3><a id="31__77"></a>3.1 连接报错</h3> 
<pre><code>[root@michael ~]# mysql
ERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: NO)
</code></pre> 
<h3><a id="32__83"></a>3.2 查看默认密码</h3> 
<pre><code class="prism language-bash"><span class="token function">cat</span> /var/log/mysqld.log <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'temporary password'</span>

<span class="token number">2020</span>-03-16T22:19:40.820924Z <span class="token number">1</span> <span class="token punctuation">[</span>Note<span class="token punctuation">]</span> A temporary password is generated <span class="token keyword">for</span> root@localhost: m:Lsfpi6SpRe
</code></pre> 
<h3><a id="33__89"></a>3.3 使用默认密码登录</h3> 
<pre><code class="prism language-bash">mysql <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-pm:Lsfpi6SpRe</span>
</code></pre> 
<h3><a id="34__94"></a>3.4 修改密码</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- dsfgs </span>
<span class="token keyword">alter</span> <span class="token keyword">user</span> <span class="token string">'root'</span><span class="token variable">@'localhost'</span> identified <span class="token keyword">by</span> <span class="token string">'root'</span><span class="token punctuation">;</span>

flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="35_root_103"></a>3.5 设置root可远程登录</h3> 
<pre><code class="prism language-sql"><span class="token comment">-- 切换数据库</span>
<span class="token keyword">use</span> mysql<span class="token punctuation">;</span>
<span class="token comment">-- 查看user表中的用户</span>
<span class="token keyword">select</span> host<span class="token punctuation">,</span><span class="token keyword">user</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
<span class="token comment">-- 授权远程登录</span>
<span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> 
<span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> 
<span class="token keyword">TO</span> <span class="token string">'root'</span><span class="token variable">@'%'</span> 
IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'root'</span> 
<span class="token keyword">WITH</span> <span class="token keyword">GRANT</span> <span class="token keyword">OPTION</span><span class="token punctuation">;</span>
<span class="token comment">-- 刷新权限</span>
flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>  
</code></pre> 
<h3><a id="4_mysql_119"></a>4 自启动mysql服务</h3> 
<pre><code class="prism language-bash"><span class="token function">chkconfig</span> mysqld off
<span class="token function">chkconfig</span> <span class="token parameter variable">--list</span> <span class="token operator">|</span> <span class="token function">grep</span> mysql
<span class="token comment">#mysqld         	0:off	1:off	2:off	3:off	4:off	5:off	6:off</span>

<span class="token function">chkconfig</span> mysqld on
<span class="token function">chkconfig</span> <span class="token parameter variable">--list</span> <span class="token operator">|</span> <span class="token function">grep</span> mysql
<span class="token comment">#mysqld         	0:off	1:off	2:on	3:on	4:on	5:on	6:off</span>
</code></pre> 
<h4><a id="28__129"></a>2.8 修改配置文件位置</h4> 
<p>mysql默认使用的配置文件位置</p> 
<pre><code>[root@michael ~]# mysql --help | grep 'Default options' -A 1
Default options are read from the following files in the given order:
/etc/my.cnf /etc/mysql/my.cnf /usr/etc/my.cnf ~/.my.cnf
</code></pre> 
<table><thead><tr><th align="left">path</th><th align="left">desc</th><th align="left">note</th></tr></thead><tbody><tr><td align="left">/var/lib/mysql/</td><td align="left">mysql数据库文件的存放路径</td><td align="left">/var/lib/mysql/michael.pid</td></tr><tr><td align="left">/usr/share/mysql/</td><td align="left">配置文件目录</td><td align="left">mysql.server命令及配置文件</td></tr><tr><td align="left">/usr/bin/</td><td align="left">相关命令目录</td><td align="left">mysqladmin mysqldump等命令</td></tr><tr><td align="left">/etc/init.d/mysqld</td><td align="left">启动停止脚本</td><td align="left"></td></tr></tbody></table> 
<h4><a id="29__144"></a>2.9 修改字符集和数据存储路径</h4> 
<pre><code class="prism language-sql"><span class="token comment">-- 创建数据库</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> mydb001<span class="token punctuation">;</span>
<span class="token comment">-- 切换数据库</span>
<span class="token keyword">use</span> mydb001<span class="token punctuation">;</span>
<span class="token comment">-- 查看库中的表</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token comment">-- 创建一张测试用表</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> my_table01<span class="token punctuation">(</span>id <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 插入数据</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> my_table01 <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token string">'LiBai'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 查看表中的的数据</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> my_table01<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----+-------+</span>
<span class="token operator">|</span> id  <span class="token operator">|</span> name  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+</span>
<span class="token operator">|</span> <span class="token number">101</span> <span class="token operator">|</span> LiBai <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----+-------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

<span class="token comment">-- 插入包含中文的数据</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">insert</span> <span class="token keyword">into</span> my_table01 <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token string">'白居易'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ERROR <span class="token number">1366</span> <span class="token punctuation">(</span>HY000<span class="token punctuation">)</span>: Incorrect string <span class="token keyword">value</span>: <span class="token string">'\xE7\x99\xBD\xE5\xB1\x85...'</span> <span class="token keyword">for</span> <span class="token keyword">column</span> <span class="token string">'name'</span> at <span class="token keyword">row</span> <span class="token number">1</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'character%'</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%char%'</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">--------------------------+----------------------------+</span>
<span class="token operator">|</span> Variable_name            <span class="token operator">|</span> <span class="token keyword">Value</span>                      <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------+----------------------------+</span>
<span class="token operator">|</span> character_set_client     <span class="token operator">|</span> utf8                       <span class="token operator">|</span>
<span class="token operator">|</span> character_set_connection <span class="token operator">|</span> utf8                       <span class="token operator">|</span>
<span class="token operator">|</span> character_set_database   <span class="token operator">|</span> latin1                     <span class="token operator">|</span>
<span class="token operator">|</span> character_set_filesystem <span class="token operator">|</span> <span class="token keyword">binary</span>                     <span class="token operator">|</span>
<span class="token operator">|</span> character_set_results    <span class="token operator">|</span> utf8                       <span class="token operator">|</span>
<span class="token operator">|</span> character_set_server     <span class="token operator">|</span> latin1                     <span class="token operator">|</span>
<span class="token operator">|</span> character_set_system     <span class="token operator">|</span> utf8                       <span class="token operator">|</span>
<span class="token operator">|</span> character_sets_dir       <span class="token operator">|</span> <span class="token operator">/</span>usr<span class="token operator">/</span><span class="token keyword">share</span><span class="token operator">/</span>mysql<span class="token operator">/</span>charsets<span class="token operator">/</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------+----------------------------+</span>
<span class="token number">8</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

默认的character_set_database和character_set_server都用了latin1，所以会插入数据报错。
</code></pre> 
<pre><code>[root@michael ~]# vim /etc/my.cnf

# For advice on how to change settings please see
# http://dev.mysql.com/doc/refman/5.7/en/server-configuration-defaults.html
[client]

[mysqld]
character_set_server=utf8
character_set_client=utf8
collation-server=utf8_general_ci
# Linux下mysql安装完成后默认：表名区分大小写；列名不区分大小写
# 0：区分大小写； 1：不区分大小写
lower_case_table_names=1
# 设置最大连接数，默认为151，Mysql服务器允许的最大连接数16384
max_connections=100

datadir=/var/lib/mysql
socket=/var/lib/mysql/mysql.sock

# Disabling symbolic-links is recommended to prevent assorted security risks
symbolic-links=0

log-error=/var/log/mysqld.log
pid-file=/var/run/mysqld/mysqld.pid

[mysql]
default-character-set=utf8
</code></pre> 
<hr> 
<h2><a id="3mysql_223"></a>3、mysql配置文件</h2> 
<h4><a id="31_logbin_224"></a>3.1 二进制日志log-bin</h4> 
<p>用于主从复制</p> 
<pre><code># Relication Master Server (default)
# binary logging is required for repalication
log-bin=mysql-bin
</code></pre> 
<h4><a id="32_logerror_232"></a>3.2 错误日志log-error</h4> 
<p>默认关闭，记录严重的警告和错误信息，每次启动和关闭的详细信息等。</p> 
<h4><a id="33_log_234"></a>3.3 查询日志log</h4> 
<p>默认关闭，记录查询的sql语句。<br> 如果开启会降低mysql的整体性能，因为记录日志也是需要消耗系统资源。</p> 
<h4><a id="34__237"></a>3.4 数据文件</h4> 
<p>ls -1F | grep ^d<br> 默认路径：/usr/lib/mysql</p> 
<h6><a id="341_frm_241"></a>3.4.1 frm文件</h6> 
<p>存放表结构</p> 
<h6><a id="341_myd_243"></a>3.4.1 myd文件</h6> 
<p>存放表数据</p> 
<h6><a id="341_myi_245"></a>3.4.1 myi文件</h6> 
<p>存放表索引</p> 
<h4><a id="35__248"></a>3.5 如何配置</h4> 
<p>windows：my.ini文件</p> 
<pre><code>log-bin=D:/xx/yyy-log-bin
log-err=D:/xx/yyy-log-err
</code></pre> 
<p>linux：/etc/my.cnf文件</p> 
<hr> 
<h2><a id="4mysql_259"></a>4、mysql逻辑架构介绍</h2> 
<p>MySQL采用插件式的存储引擎架构将查询处理和其他的系统任务以及数据的存储提取相分离。这种架构可以根据业务的需要和实际需要选择合适的存储引擎。<br> <img src="https://images2.imgbox.com/52/20/Vfw3LYKz_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="41__263"></a>4.1 连接层</h5> 
<p>最上层是一些客户端和连接服务，包含本地sock通信和大多数基于客户端/服务端工具实现的类似于TCP/IP的通信。主要完成一些类似于连接处理、授权认证、及相关的安全方案。在该层上引入了线程池的概念，为通过认证安全接入的客户端提供线程。同样在该层上可以实现基于SSL的安全链接。服务器也会为安全接入的每个客户端验证它所具有的操作权限。</p> 
<h5><a id="42__265"></a>4.2 服务层</h5> 
<p>第二层架构主要完成大多数的核心功能，如SQL接口，并完成缓存的查询，SQL的分析和优化及部分内置函数的执行。所有跨存储引擎的功能也在这一层实现，如过程、函数等。在该层，服务器会解析查询并创建相应的内部解析树，并对其完成相应的优化如确定查询表的顺序，是否利用索引等，最后生成相应的执行操作。如果是select语句，服务器还会查询内部的缓存。如果缓存空间足够大，这样在解决大量读操作的环境中能够很好的提升系统的性能。</p> 
<h5><a id="43__267"></a>4.3 引擎层</h5> 
<p>存储引擎真正的负责了MySQL中数据的存储和提取，服务器通过API与存储引擎进行通信。不同的存储引擎具有的功能不同，我们可根据实际需要进行选取。</p> 
<h5><a id="44__269"></a>4.4 存储层</h5> 
<p>数据存储层，主要是将数据存储在运行于裸设备的文件系统之上，并完成与存储引擎的交互。</p> 
<hr> 
<h2><a id="5mysql_274"></a>5、mysql存储引擎</h2> 
<pre><code class="prism language-sql"><span class="token comment">-- 查看当前mysql提供了哪些存储引擎</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">show</span> engines<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e4/01/Pk2pYNxj_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">-- 查看当前mysql默认使用的存储引擎</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%storage_engine%'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/31/24/VtzLV95t_o.png" alt="在这里插入图片描述"></p> 
<table><thead><tr><th align="left">对比项</th><th align="left">MyISAM</th><th align="left">InnoDB</th></tr></thead><tbody><tr><td align="left">主外键</td><td align="left">不支持</td><td align="left">支持</td></tr><tr><td align="left">事务</td><td align="left">不支持</td><td align="left">支持</td></tr><tr><td align="left">行表锁</td><td align="left">表锁，即使操作一条记录也会锁住整个表，<br><code>不适合高并发的操作</code></td><td align="left">行锁，操作时只锁某一行，不对其他行影响，<br><code>适合高并发操作</code></td></tr><tr><td align="left">缓存</td><td align="left">只缓存索引，不缓存真是数据</td><td align="left">不仅缓存索引还要缓存真实数据，对内存要求较高，<br>而且内存大小对性能有决定性的影响</td></tr><tr><td align="left">表空间</td><td align="left">小</td><td align="left">大</td></tr><tr><td align="left">关注点</td><td align="left">性能</td><td align="left">事务</td></tr><tr><td align="left">默认安装</td><td align="left">YES</td><td align="left">YES</td></tr></tbody></table> 
<hr> 
<p>percona为mysql数据库服务器进行了改进，在功能和性能上较mysql有着很显著的提升。<br> perconna新建了一款存储引擎xtradb完全可以替代innodb，并且在性能和并发上做的更好。</p> 
<hr> 
<hr> 
<p>注：忘记密码时修改密码.</p> 
<pre><code class="prism language-shell">/usr/sbin/mysqld --skip-grant-tables <span class="token parameter variable">--basedir</span><span class="token operator">=</span>/usr <span class="token parameter variable">--datadir</span><span class="token operator">=</span>/var/lib/mysql --plugin-dir<span class="token operator">=</span>/usr/lib64/mysql/plugin <span class="token parameter variable">--user</span><span class="token operator">=</span>mysql --log-error<span class="token operator">=</span>/var/log/mysqld.log --pid-file<span class="token operator">=</span>/var/run/mysqld/mysqld.pid <span class="token parameter variable">--socket</span><span class="token operator">=</span>/var/lib/mysql/mysql.sock
</code></pre> 
<pre><code class="prism language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">update</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span> <span class="token keyword">set</span> authentication_string<span class="token operator">=</span>password<span class="token punctuation">(</span><span class="token string">'123456'</span><span class="token punctuation">)</span> <span class="token keyword">where</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span> <span class="token operator">and</span> Host <span class="token operator">=</span> <span class="token string">'localhost'</span><span class="token punctuation">;</span> 
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected<span class="token punctuation">,</span> <span class="token number">1</span> warning <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
<span class="token keyword">Rows</span> <span class="token keyword">matched</span>: <span class="token number">1</span>  Changed: <span class="token number">1</span>  <span class="token keyword">Warnings</span>: <span class="token number">1</span>

mysql<span class="token operator">&gt;</span> flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

</code></pre> 
<hr> 
<p>注：<br> 法一：</p> 
<pre><code class="prism language-sql"><span class="token keyword">alter</span> 
<span class="token keyword">user</span> <span class="token string">'root'</span><span class="token variable">@'localhost'</span> 
identified <span class="token keyword">by</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
</code></pre> 
<p>法二：</p> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> password <span class="token keyword">for</span> <span class="token string">'root'</span><span class="token variable">@'localhost'</span><span class="token operator">=</span>password<span class="token punctuation">(</span><span class="token string">'123456'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>法三：</p> 
<pre><code class="prism language-sql"><span class="token keyword">update</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span> 
<span class="token keyword">set</span> authentication_string<span class="token operator">=</span>password<span class="token punctuation">(</span><span class="token string">'123456'</span><span class="token punctuation">)</span> 
<span class="token keyword">where</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span> <span class="token operator">and</span> Host <span class="token operator">=</span> <span class="token string">'localhost'</span><span class="token punctuation">;</span>
</code></pre> 
<p>最后刷新权限</p> 
<pre><code class="prism language-sql">mysql<span class="token operator">&gt;</span> flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>
</code></pre> 
<hr> 
<p>主<br> server-id=1<br> log-bin=自己本地的路径/mysqlbin<br> 从<br> server-id=2</p> 
<p>grant replication slave on . to ‘xxx’@’%’ identified by ‘123456’;</p> 
<p>change master to<br> master_host=‘192.168.21.193’,<br> master_user=‘zhangsan’,<br> master_password=‘123456’,<br> master_log_file=‘mysqlbin.具体数字’,<br> master_log_pos=‘具体值’;</p> 
<p>=========================================<br> 备份<br> mysqldump -uroot --all-databases --lock-all-tables &gt; ~/my_master_db.sql<br> mysqldump -uroot -proot 数据库名 &gt; /opt/my_master_db.sql<br> 恢复<br> 连接数据库，创建数据库<br> 退出连接，执行如下命令<br> mysql -uroot -proot &lt; ~/my_master_db.sql<br> mysql -uroot -proot 新数据库名 &lt; ~/my_master_db.sql</p> 
<p>=====================================================<br> set global validate_password_policy=0;<br> set global validate_password_length=1;</p> 
<p>1，master 设置server-id<br> 2，开启二进制日志<br> server-id=1<br> log_bin=/var/log/mysql/mysql-bin.log</p> 
<p>grant replication slave<br> on .<br> to ‘xxxx’@’%’<br> identified by ‘yyyy’;</p> 
<p>flush privileges;</p> 
<p>show master status;</p> 
<p>1，slave设置server-id<br> 2,去哪里什么位置复制<br> server-id=2</p> 
<p>change master to<br> master_host=‘192.168.168.168’,<br> master_user=‘xxxx’,<br> master_password=‘yyyy’,<br> master_log_file=‘mysqlbin.000001’,<br> master_log_pos=589;</p> 
<p>start slave;</p> 
<p>show slave status \G;</p> 
<p>slave_IO_running:yes<br> slave_sql_running:yes</p> 
<p>CREATE TABLE Persons11<br> (<br> Id_P int,<br> LastName varchar(255),<br> FirstName varchar(255),<br> Address varchar(255),<br> City varchar(255)<br> )</p> 
<hr> 
<p>mysql8.0 修改密码：</p> 
<pre><code>mysql&gt; SHOW VARIABLES LIKE 'validate_password%';
+--------------------------------------+--------+
| Variable_name                        | Value  |
+--------------------------------------+--------+
| validate_password.check_user_name    | ON     |
| validate_password.dictionary_file    |        |
| validate_password.length             | 8      |
| validate_password.mixed_case_count   | 1      |
| validate_password.number_count       | 1      |
| validate_password.policy             | MEDIUM |
| validate_password.special_char_count | 1      |
+--------------------------------------+--------+
7 rows in set (0.11 sec)
</code></pre> 
<p>设置“123456”等简单密码需修改密码规则：</p> 
<pre><code class="prism language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> <span class="token keyword">global</span> validate_password<span class="token punctuation">.</span>policy<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> <span class="token keyword">global</span> validate_password<span class="token punctuation">.</span>length<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<p>设置密码为：</p> 
<pre><code class="prism language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">alter</span> <span class="token keyword">user</span><span class="token string">'root'</span><span class="token variable">@'localhost'</span> identified <span class="token keyword">by</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p>注：</p> 
<blockquote> 
 <p>validate_password_policy取值有0、1、2。<br> 默认是1，即MEDIUM，所以设置的密码必须符合长度，且必须含有数字，小写或大写字母，特殊字符<br> 取值0：只限制密码长度，大于validate_password.length参数即可。</p> 
</blockquote> 
<hr> 
<p>mysql5.7 修改密码：</p> 
<pre><code class="prism language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">use</span> mysql<span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">update</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span> <span class="token keyword">set</span> authentication_string<span class="token operator">=</span>password<span class="token punctuation">(</span><span class="token string">'Mysql123$'</span><span class="token punctuation">)</span> <span class="token keyword">where</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span> <span class="token operator">and</span> host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">;</span>    <span class="token comment"># and host='localhost'部分可以不加</span>
mysql<span class="token operator">&gt;</span> flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>    <span class="token comment"># 刷新权限</span>
</code></pre> 
<p>mysql5.6 修改密码：</p> 
<pre><code class="prism language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">use</span> mysql<span class="token punctuation">;</span> 
mysql<span class="token operator">&gt;</span> <span class="token keyword">update</span> <span class="token keyword">user</span> <span class="token keyword">set</span> password<span class="token operator">=</span>password<span class="token punctuation">(</span><span class="token string">'Mysql123@'</span><span class="token punctuation">)</span> <span class="token keyword">where</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span> <span class="token operator">and</span> host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">;</span> 
mysql<span class="token operator">&gt;</span> flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>    <span class="token comment"># 刷新权限</span>
</code></pre> 
<hr> 
<p>– sdfdsf<br> SHOW VARIABLES LIKE ‘validate_password%’;<br> set global validate_password_policy=0;<br> set global validate_password_length=1;<br> select @@validate_password_policy;<br> select @@validate_password_length;<br> select @@validate_password_mixed_case_count;</p> 
<p>– 或者<br> set password=password(“root”);</p> 
<p>select user,host,password from user;</p> 
<p>update user<br> set password=password(‘root’)<br> where user=‘root’ and host=‘localhost’;</p> 
<pre><code>[root@michael ~]# mysql --help
mysql  Ver 14.14 Distrib 5.7.27, for Linux (x86_64) using  EditLine wrapper
Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Usage: mysql [OPTIONS] [database]
  -?, --help          Display this help and exit.
  -I, --help          Synonym for -?
  --auto-rehash       Enable automatic rehashing. One doesn't need to use
                      'rehash' to get table and field completion, but startup
                      and reconnecting may take a longer time. Disable with
                      --disable-auto-rehash.
                      (Defaults to on; use --skip-auto-rehash to disable.)
  -A, --no-auto-rehash 
                      No automatic rehashing. One has to use 'rehash' to get
                      table and field completion. This gives a quicker start of
                      mysql and disables rehashing on reconnect.
  --auto-vertical-output 
                      Automatically switch to vertical output mode if the
                      result is wider than the terminal width.
  -B, --batch         Don't use history file. Disable interactive behavior.
                      (Enables --silent.)
  --bind-address=name IP address to bind to.
  --binary-as-hex     Print binary data as hex
  --character-sets-dir=name 
                      Directory for character set files.
  --column-type-info  Display column type information.
  -c, --comments      Preserve comments. Send comments to the server. The
                      default is --skip-comments (discard comments), enable
                      with --comments.
  -C, --compress      Use compression in server/client protocol.
  -#, --debug[=#]     This is a non-debug version. Catch this and exit.
  --debug-check       This is a non-debug version. Catch this and exit.
  -T, --debug-info    This is a non-debug version. Catch this and exit.
  -D, --database=name Database to use.
  --default-character-set=name 
                      Set the default character set.
  --delimiter=name    Delimiter to be used.
  --enable-cleartext-plugin 
                      Enable/disable the clear text authentication plugin.
  -e, --execute=name  Execute command and quit. (Disables --force and history
                      file.)
  -E, --vertical      Print the output of a query (rows) vertically.
  -f, --force         Continue even if we get an SQL error.
  --histignore=name   A colon-separated list of patterns to keep statements
                      from getting logged into syslog and mysql history.
  -G, --named-commands 
                      Enable named commands. Named commands mean this program's
                      internal commands; see mysql&gt; help . When enabled, the
                      named commands can be used from any line of the query,
                      otherwise only from the first line, before an enter.
                      Disable with --disable-named-commands. This option is
                      disabled by default.
  -i, --ignore-spaces Ignore space after function names.
  --init-command=name SQL Command to execute when connecting to MySQL server.
                      Will automatically be re-executed when reconnecting.
  --local-infile      Enable/disable LOAD DATA LOCAL INFILE.
  -b, --no-beep       Turn off beep on error.
  -h, --host=name     Connect to host.
  -H, --html          Produce HTML output.
  -X, --xml           Produce XML output.
  --line-numbers      Write line numbers for errors.
                      (Defaults to on; use --skip-line-numbers to disable.)
  -L, --skip-line-numbers 
                      Don't write line number for errors.
  -n, --unbuffered    Flush buffer after each query.
  --column-names      Write column names in results.
                      (Defaults to on; use --skip-column-names to disable.)
  -N, --skip-column-names 
                      Don't write column names in results.
  --sigint-ignore     Ignore SIGINT (CTRL-C).
  -o, --one-database  Ignore statements except those that occur while the
                      default database is the one named at the command line.
  --pager[=name]      Pager to use to display results. If you don't supply an
                      option, the default pager is taken from your ENV variable
                      PAGER. Valid pagers are less, more, cat [&gt; filename],
                      etc. See interactive help (\h) also. This option does not
                      work in batch mode. Disable with --disable-pager. This
                      option is disabled by default.
  -p, --password[=name] 
                      Password to use when connecting to server. If password is
                      not given it's asked from the tty.
  -P, --port=#        Port number to use for connection or 0 for default to, in
                      order of preference, my.cnf, $MYSQL_TCP_PORT,
                      /etc/services, built-in default (3306).
  --prompt=name       Set the mysql prompt to this value.
  --protocol=name     The protocol to use for connection (tcp, socket, pipe,
                      memory).
  -q, --quick         Don't cache result, print it row by row. This may slow
                      down the server if the output is suspended. Doesn't use
                      history file.
  -r, --raw           Write fields without conversion. Used with --batch.
  --reconnect         Reconnect if the connection is lost. Disable with
                      --disable-reconnect. This option is enabled by default.
                      (Defaults to on; use --skip-reconnect to disable.)
  -s, --silent        Be more silent. Print results with a tab as separator,
                      each row on new line.
  -S, --socket=name   The socket file to use for connection.
  --ssl-mode=name     SSL connection mode.
  --ssl               Deprecated. Use --ssl-mode instead.
                      (Defaults to on; use --skip-ssl to disable.)
  --ssl-verify-server-cert 
                      Deprecated. Use --ssl-mode=VERIFY_IDENTITY instead.
  --ssl-ca=name       CA file in PEM format.
  --ssl-capath=name   CA directory.
  --ssl-cert=name     X509 cert in PEM format.
  --ssl-cipher=name   SSL cipher to use.
  --ssl-key=name      X509 key in PEM format.
  --ssl-crl=name      Certificate revocation list.
  --ssl-crlpath=name  Certificate revocation list path.
  --tls-version=name  TLS version to use, permitted values are: TLSv1, TLSv1.1
  -t, --table         Output in table format.
  --tee=name          Append everything into outfile. See interactive help (\h)
                      also. Does not work in batch mode. Disable with
                      --disable-tee. This option is disabled by default.
  -u, --user=name     User for login if not current user.
  -U, --safe-updates  Only allow UPDATE and DELETE that uses keys.
  -U, --i-am-a-dummy  Synonym for option --safe-updates, -U.
  -v, --verbose       Write more. (-v -v -v gives the table output format).
  -V, --version       Output version information and exit.
  -w, --wait          Wait and retry if connection is down.
  --connect-timeout=# Number of seconds before connection timeout.
  --max-allowed-packet=# 
                      The maximum packet length to send to or receive from
                      server.
  --net-buffer-length=# 
                      The buffer size for TCP/IP and socket communication.
  --select-limit=#    Automatic limit for SELECT when using --safe-updates.
  --max-join-size=#   Automatic limit for rows in a join when using
                      --safe-updates.
  --secure-auth       Refuse client connecting to server if it uses old
                      (pre-4.1.1) protocol. Deprecated. Always TRUE
  --server-arg=name   Send embedded server this as a parameter.
  --show-warnings     Show warnings after every statement.
  -j, --syslog        Log filtered interactive commands to syslog. Filtering of
                      commands depends on the patterns supplied via histignore
                      option besides the default patterns.
  --plugin-dir=name   Directory for client-side plugins.
  --default-auth=name Default authentication client-side plugin to use.
  --binary-mode       By default, ASCII '\0' is disallowed and '\r\n' is
                      translated to '\n'. This switch turns off both features,
                      and also turns off parsing of all clientcommands except
                      \C and DELIMITER, in non-interactive mode (for input
                      piped to mysql or loaded using the 'source' command).
                      This is necessary when processing output from mysqlbinlog
                      that may contain blobs.
  --connect-expired-password 
                      Notify the server that this client is prepared to handle
                      expired password sandbox mode.

Default options are read from the following files in the given order:
/etc/my.cnf /etc/mysql/my.cnf /usr/etc/my.cnf ~/.my.cnf 
The following groups are read: mysql client
The following options may be given as the first argument:
--print-defaults        Print the program argument list and exit.
--no-defaults           Don't read default options from any option file,
                        except for login file.
--defaults-file=#       Only read default options from the given file #.
--defaults-extra-file=# Read this file after the global files are read.
--defaults-group-suffix=#
                        Also read groups with concat(group, suffix)
--login-path=#          Read this path from the login file.

Variables (--variable-name=value)
and boolean options {FALSE|TRUE}  Value (after reading options)
--------------------------------- ----------------------------------------
auto-rehash                       TRUE
auto-vertical-output              FALSE
bind-address                      (No default value)
binary-as-hex                     FALSE
character-sets-dir                (No default value)
column-type-info                  FALSE
comments                          FALSE
compress                          FALSE
database                          (No default value)
default-character-set             auto
delimiter                         ;
enable-cleartext-plugin           FALSE
vertical                          FALSE
force                             FALSE
histignore                        (No default value)
named-commands                    FALSE
ignore-spaces                     FALSE
init-command                      (No default value)
local-infile                      FALSE
no-beep                           FALSE
host                              (No default value)
html                              FALSE
xml                               FALSE
line-numbers                      TRUE
unbuffered                        FALSE
column-names                      TRUE
sigint-ignore                     FALSE
port                              0
prompt                            mysql&gt; 
quick                             FALSE
raw                               FALSE
reconnect                         TRUE
socket                            (No default value)
ssl                               TRUE
ssl-verify-server-cert            FALSE
ssl-ca                            (No default value)
ssl-capath                        (No default value)
ssl-cert                          (No default value)
ssl-cipher                        (No default value)
ssl-key                           (No default value)
ssl-crl                           (No default value)
ssl-crlpath                       (No default value)
tls-version                       (No default value)
table                             FALSE
user                              (No default value)
safe-updates                      FALSE
i-am-a-dummy                      FALSE
connect-timeout                   0
max-allowed-packet                16777216
net-buffer-length                 16384
select-limit                      1000
max-join-size                     1000000
secure-auth                       TRUE
show-warnings                     FALSE
plugin-dir                        (No default value)
default-auth                      (No default value)
binary-mode                       FALSE
connect-expired-password          FALSE
[root@michael ~]# 

</code></pre> 
<h2><a id="mysql_727"></a>mysql配置文件</h2> 
<pre><code class="prism language-conf">二、配置文件参数详解

[client]
port = 3306
socket = /tmp/mysql.sock

[mysqld]
port = 3306
socket = /tmp/mysql.sock

basedir = /usr/local/mysql
datadir = /data/mysql
pid-file = /data/mysql/mysql.pid
user = mysql
bind-address = 0.0.0.0
server-id = 1 #表示是本机的序号为1,一般来讲就是master的意思

skip-name-resolve
# 禁止MySQL对外部连接进行DNS解析，使用这一选项可以消除MySQL进行DNS解析的时间。但需要注意，如果开启该选项，
# 则所有远程主机连接授权都要使用IP地址方式，否则MySQL将无法正常处理连接请求

#skip-networking

back_log = 600
# MySQL能有的连接数量。当主要MySQL线程在一个很短时间内得到非常多的连接请求，这就起作用，
# 然后主线程花些时间(尽管很短)检查连接并且启动一个新线程。back_log值指出在MySQL暂时停止回答新请求之前的短时间内多少个请求可以被存在堆栈中。
# 如果期望在一个短时间内有很多连接，你需要增加它。也就是说，如果MySQL的连接数据达到max_connections时，新来的请求将会被存在堆栈中，
# 以等待某一连接释放资源，该堆栈的数量即back_log，如果等待连接的数量超过back_log，将不被授予连接资源。
# 另外，这值（back_log）限于您的操作系统对到来的TCP/IP连接的侦听队列的大小。
# 你的操作系统在这个队列大小上有它自己的限制（可以检查你的OS文档找出这个变量的最大值），试图设定back_log高于你的操作系统的限制将是无效的。

max_connections = 1000
# MySQL的最大连接数，如果服务器的并发连接请求量比较大，建议调高此值，以增加并行连接数量，当然这建立在机器能支撑的情况下，因为如果连接数越多，介于MySQL会为每个连接提供连接缓冲区，就会开销越多的内存，所以要适当调整该值，不能盲目提高设值。可以过'conn%'通配符查看当前状态的连接数量，以定夺该值的大小。

max_connect_errors = 6000
# 对于同一主机，如果有超出该参数值个数的中断错误连接，则该主机将被禁止连接。如需对该主机进行解禁，执行：FLUSH HOST。

open_files_limit = 65535
# MySQL打开的文件描述符限制，默认最小1024;当open_files_limit没有被配置的时候，比较max_connections*5和ulimit -n的值，哪个大用哪个，
# 当open_file_limit被配置的时候，比较open_files_limit和max_connections*5的值，哪个大用哪个。

table_open_cache = 128
# MySQL每打开一个表，都会读入一些数据到table_open_cache缓存中，当MySQL在这个缓存中找不到相应信息时，才会去磁盘上读取。默认值64
# 假定系统有200个并发连接，则需将此参数设置为200*N(N为每个连接所需的文件描述符数目)；
# 当把table_open_cache设置为很大时，如果系统处理不了那么多文件描述符，那么就会出现客户端失效，连接不上

max_allowed_packet = 4M
# 接受的数据包大小；增加该变量的值十分安全，这是因为仅当需要时才会分配额外内存。例如，仅当你发出长查询或MySQLd必须返回大的结果行时MySQLd才会分配更多内存。
# 该变量之所以取较小默认值是一种预防措施，以捕获客户端和服务器之间的错误信息包，并确保不会因偶然使用大的信息包而导致内存溢出。

binlog_cache_size = 1M
# 一个事务，在没有提交的时候，产生的日志，记录到Cache中；等到事务提交需要提交的时候，则把日志持久化到磁盘。默认binlog_cache_size大小32K

max_heap_table_size = 8M
# 定义了用户可以创建的内存表(memory table)的大小。这个值用来计算内存表的最大行数值。这个变量支持动态改变

tmp_table_size = 16M
# MySQL的heap（堆积）表缓冲大小。所有联合在一个DML指令内完成，并且大多数联合甚至可以不用临时表即可以完成。
# 大多数临时表是基于内存的(HEAP)表。具有大的记录长度的临时表 (所有列的长度的和)或包含BLOB列的表存储在硬盘上。
# 如果某个内部heap（堆积）表大小超过tmp_table_size，MySQL可以根据需要自动将内存中的heap表改为基于硬盘的MyISAM表。还可以通过设置tmp_table_size选项来增加临时表的大小。也就是说，如果调高该值，MySQL同时将增加heap表的大小，可达到提高联接查询速度的效果

read_buffer_size = 2M
# MySQL读入缓冲区大小。对表进行顺序扫描的请求将分配一个读入缓冲区，MySQL会为它分配一段内存缓冲区。read_buffer_size变量控制这一缓冲区的大小。
# 如果对表的顺序扫描请求非常频繁，并且你认为频繁扫描进行得太慢，可以通过增加该变量值以及内存缓冲区大小提高其性能

read_rnd_buffer_size = 8M
# MySQL的随机读缓冲区大小。当按任意顺序读取行时(例如，按照排序顺序)，将分配一个随机读缓存区。进行排序查询时，
# MySQL会首先扫描一遍该缓冲，以避免磁盘搜索，提高查询速度，如果需要排序大量数据，可适当调高该值。但MySQL会为每个客户连接发放该缓冲空间，所以应尽量适当设置该值，以避免内存开销过大

sort_buffer_size = 8M
# MySQL执行排序使用的缓冲大小。如果想要增加ORDER BY的速度，首先看是否可以让MySQL使用索引而不是额外的排序阶段。
# 如果不能，可以尝试增加sort_buffer_size变量的大小

join_buffer_size = 8M
# 联合查询操作所能使用的缓冲区大小，和sort_buffer_size一样，该参数对应的分配内存也是每连接独享

thread_cache_size = 8
# 这个值（默认8）表示可以重新利用保存在缓存中线程的数量，当断开连接时如果缓存中还有空间，那么客户端的线程将被放到缓存中，
# 如果线程重新被请求，那么请求将从缓存中读取,如果缓存中是空的或者是新的请求，那么这个线程将被重新创建,如果有很多新的线程，
# 增加这个值可以改善系统性能.通过比较Connections和Threads_created状态的变量，可以看到这个变量的作用。(–&gt;表示要调整的值)
# 根据物理内存设置规则如下：
# 1G  —&gt; 8
# 2G  —&gt; 16
# 3G  —&gt; 32
# 大于3G  —&gt; 64

query_cache_size = 8M
#MySQL的查询缓冲大小（从4.0.1开始，MySQL提供了查询缓冲机制）使用查询缓冲，MySQL将SELECT语句和查询结果存放在缓冲区中，
# 今后对于同样的SELECT语句（区分大小写），将直接从缓冲区中读取结果。根据MySQL用户手册，使用查询缓冲最多可以达到238%的效率。
# 通过检查状态值'Qcache_%'，可以知道query_cache_size设置是否合理：如果Qcache_lowmem_prunes的值非常大，则表明经常出现缓冲不够的情况，
# 如果Qcache_hits的值也非常大，则表明查询缓冲使用非常频繁，此时需要增加缓冲大小；如果Qcache_hits的值不大，则表明你的查询重复率很低，
# 这种情况下使用查询缓冲反而会影响效率，那么可以考虑不用查询缓冲。此外，在SELECT语句中加入SQL_NO_CACHE可以明确表示不使用查询缓冲

query_cache_limit = 2M
#指定单个查询能够使用的缓冲区大小，默认1M

key_buffer_size = 4M
#指定用于索引的缓冲区大小，增加它可得到更好处理的索引(对所有读和多重写)，到你能负担得起那样多。如果你使它太大，
# 系统将开始换页并且真的变慢了。对于内存在4GB左右的服务器该参数可设置为384M或512M。通过检查状态值Key_read_requests和Key_reads，
# 可以知道key_buffer_size设置是否合理。比例key_reads/key_read_requests应该尽可能的低，
# 至少是1:100，1:1000更好(上述状态值可以使用SHOW STATUS LIKE 'key_read%'获得)。注意：该参数值设置的过大反而会是服务器整体效率降低

ft_min_word_len = 4
# 分词词汇最小长度，默认4

transaction_isolation = REPEATABLE-READ
# MySQL支持4种事务隔离级别，他们分别是：
# READ-UNCOMMITTED, READ-COMMITTED, REPEATABLE-READ, SERIALIZABLE.
# 如没有指定，MySQL默认采用的是REPEATABLE-READ，ORACLE默认的是READ-COMMITTED

log_bin = mysql-bin
binlog_format = mixed
expire_logs_days = 30 #超过30天的binlog删除

log_error = /data/mysql/mysql-error.log #错误日志路径
slow_query_log = 1
long_query_time = 1 #慢查询时间 超过1秒则为慢查询
slow_query_log_file = /data/mysql/mysql-slow.log

performance_schema = 0
explicit_defaults_for_timestamp

#lower_case_table_names = 1 #不区分大小写

skip-external-locking #MySQL选项以避免外部锁定。该选项默认开启

default-storage-engine = InnoDB #默认存储引擎

innodb_file_per_table = 1
# InnoDB为独立表空间模式，每个数据库的每个表都会生成一个数据空间
# 独立表空间优点：
# 1．每个表都有自已独立的表空间。
# 2．每个表的数据和索引都会存在自已的表空间中。
# 3．可以实现单表在不同的数据库中移动。
# 4．空间可以回收（除drop table操作处，表空不能自已回收）
# 缺点：
# 单表增加过大，如超过100G
# 结论：
# 共享表空间在Insert操作上少有优势。其它都没独立表空间表现好。当启用独立表空间时，请合理调整：innodb_open_files

innodb_open_files = 500
# 限制Innodb能打开的表的数据，如果库里的表特别多的情况，请增加这个。这个值默认是300

innodb_buffer_pool_size = 64M
# InnoDB使用一个缓冲池来保存索引和原始数据, 不像MyISAM.
# 这里你设置越大,你在存取表里面数据时所需要的磁盘I/O越少.
# 在一个独立使用的数据库服务器上,你可以设置这个变量到服务器物理内存大小的80%
# 不要设置过大,否则,由于物理内存的竞争可能导致操作系统的换页颠簸.
# 注意在32位系统上你每个进程可能被限制在 2-3.5G 用户层面内存限制,
# 所以不要设置的太高.

innodb_write_io_threads = 4
innodb_read_io_threads = 4
# innodb使用后台线程处理数据页上的读写 I/O(输入输出)请求,根据你的 CPU 核数来更改,默认是4
# 注:这两个参数不支持动态改变,需要把该参数加入到my.cnf里，修改完后重启MySQL服务,允许值的范围从 1-64

innodb_thread_concurrency = 0
# 默认设置为 0,表示不限制并发数，这里推荐设置为0，更好去发挥CPU多核处理能力，提高并发量

innodb_purge_threads = 1
# InnoDB中的清除操作是一类定期回收无用数据的操作。在之前的几个版本中，清除操作是主线程的一部分，这意味着运行时它可能会堵塞其它的数据库操作。
# 从MySQL5.5.X版本开始，该操作运行于独立的线程中,并支持更多的并发数。用户可通过设置innodb_purge_threads配置参数来选择清除操作是否使用单
# 独线程,默认情况下参数设置为0(不使用单独线程),设置为 1 时表示使用单独的清除线程。建议为1

innodb_flush_log_at_trx_commit = 2
# 0：如果innodb_flush_log_at_trx_commit的值为0,log buffer每秒就会被刷写日志文件到磁盘，提交事务的时候不做任何操作（执行是由mysql的master thread线程来执行的。
# 主线程中每秒会将重做日志缓冲写入磁盘的重做日志文件(REDO LOG)中。不论事务是否已经提交）默认的日志文件是ib_logfile0,ib_logfile1
# 1：当设为默认值1的时候，每次提交事务的时候，都会将log buffer刷写到日志。
# 2：如果设为2,每次提交事务都会写日志，但并不会执行刷的操作。每秒定时会刷到日志文件。要注意的是，并不能保证100%每秒一定都会刷到磁盘，这要取决于进程的调度。
# 每次事务提交的时候将数据写入事务日志，而这里的写入仅是调用了文件系统的写入操作，而文件系统是有 缓存的，所以这个写入并不能保证数据已经写入到物理磁盘
# 默认值1是为了保证完整的ACID。当然，你可以将这个配置项设为1以外的值来换取更高的性能，但是在系统崩溃的时候，你将会丢失1秒的数据。
# 设为0的话，mysqld进程崩溃的时候，就会丢失最后1秒的事务。设为2,只有在操作系统崩溃或者断电的时候才会丢失最后1秒的数据。InnoDB在做恢复的时候会忽略这个值。
# 总结
# 设为1当然是最安全的，但性能页是最差的（相对其他两个参数而言，但不是不能接受）。如果对数据一致性和完整性要求不高，完全可以设为2，如果只最求性能，例如高并发写的日志服务器，设为0来获得更高性能

innodb_log_buffer_size = 2M
# 此参数确定些日志文件所用的内存大小，以M为单位。缓冲区更大能提高性能，但意外的故障将会丢失数据。MySQL开发人员建议设置为1－8M之间

innodb_log_file_size = 32M
# 此参数确定数据日志文件的大小，更大的设置可以提高性能，但也会增加恢复故障数据库所需的时间

innodb_log_files_in_group = 3
# 为提高性能，MySQL可以以循环方式将日志文件写到多个文件。推荐设置为3

innodb_max_dirty_pages_pct = 90
# innodb主线程刷新缓存池中的数据，使脏数据比例小于90%

innodb_lock_wait_timeout = 120 
# InnoDB事务在被回滚之前可以等待一个锁定的超时秒数。InnoDB在它自己的锁定表中自动检测事务死锁并且回滚事务。InnoDB用LOCK TABLES语句注意到锁定设置。默认值是50秒

bulk_insert_buffer_size = 8M
# 批量插入缓存大小， 这个参数是针对MyISAM存储引擎来说的。适用于在一次性插入100-1000+条记录时， 提高效率。默认值是8M。可以针对数据量的大小，翻倍增加。

myisam_sort_buffer_size = 8M
# MyISAM设置恢复表之时使用的缓冲区的尺寸，当在REPAIR TABLE或用CREATE INDEX创建索引或ALTER TABLE过程中排序 MyISAM索引分配的缓冲区

myisam_max_sort_file_size = 10G
# 如果临时文件会变得超过索引，不要使用快速排序索引方法来创建一个索引。注释：这个参数以字节的形式给出

myisam_repair_threads = 1
# 如果该值大于1，在Repair by sorting过程中并行创建MyISAM表索引(每个索引在自己的线程内) 

interactive_timeout = 28800
# 服务器关闭交互式连接前等待活动的秒数。交互式客户端定义为在mysql_real_connect()中使用CLIENT_INTERACTIVE选项的客户端。默认值：28800秒（8小时）

wait_timeout = 28800
# 服务器关闭非交互连接之前等待活动的秒数。在线程启动时，根据全局wait_timeout值或全局interactive_timeout值初始化会话wait_timeout值，
# 取决于客户端类型(由mysql_real_connect()的连接选项CLIENT_INTERACTIVE定义)。参数默认值：28800秒（8小时）
# MySQL服务器所支持的最大连接数是有上限的，因为每个连接的建立都会消耗内存，因此我们希望客户端在连接到MySQL Server处理完相应的操作后，
# 应该断开连接并释放占用的内存。如果你的MySQL Server有大量的闲置连接，他们不仅会白白消耗内存，而且如果连接一直在累加而不断开，
# 最终肯定会达到MySQL Server的连接上限数，这会报'too many connections'的错误。对于wait_timeout的值设定，应该根据系统的运行情况来判断。
# 在系统运行一段时间后，可以通过show processlist命令查看当前系统的连接状态，如果发现有大量的sleep状态的连接进程，则说明该参数设置的过大，
# 可以进行适当的调整小些。要同时设置interactive_timeout和wait_timeout才会生效。

[mysqldump]
quick
max_allowed_packet = 16M #服务器发送和接受的最大包长度

[myisamchk]
key_buffer_size = 8M
sort_buffer_size = 8M
read_buffer = 4M
write_buffer = 4M
</code></pre> 
<p>你知道的越多，知道你不知道的就越多！<br> 你来，我们一起精进！你不来，我和你的竞争对手一起精进！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bcb18b20cb5aa1e2f5af041e2cb652a7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">ffmpeg的日志系统</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c0626dc9b65fc3579d3806162527943f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue3 在线编辑预览 选用 CodeMirror</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>