<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【CMake保姆级教程】搜索文件和包含头文件 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【CMake保姆级教程】搜索文件和包含头文件" />
<meta property="og:description" content="文章目录 前言一、搜索文件1.1 为什么需要他1.2 搜索方式11.3 搜索方法2 二、包含头文件2.1 为什么需要他？2.2 包含头文件本质include_directories: 总结 前言 CMake是一个跨平台的开源构建系统，它通过简化和自动化项目的构建过程，使软件开发变得更加容易。在CMake中，搜索文件和包含头文件是项目中必不可少的一部分。这一过程涉及到设置源文件、查找依赖项以及正确包含头文件，这对于确保项目的可维护性和可扩展性至关重要。
在这份CMake保姆级教程中，我们将深入研究如何使用CMake搜索文件和包含头文件，使你能够更有效地管理和组织你的项目。
一、搜索文件 1.1 为什么需要他 如果一个项目里边的源文件很多，在编写CMakeLists.txt文件的时候不可能将项目目录的各个文件一一罗列出来，这样太麻烦也不现实。所以，在CMake中为我们提供了搜索文件的命令，可以使用aux_source_directory命令或者file命令。
1.2 搜索方式1 例如现在的文件夹层级如下，src分为一个文件夹，那我们如果要去写源文件的路径就很麻烦，那怎么办呢：
ubuntu@ubuntu-2204:~/C/csdn-cmake$ tree -L 2 . ├── bin │ └── app ├── build │ ├── app │ ├── CMakeCache.txt │ ├── CMakeFiles │ ├── cmake_install.cmake │ └── Makefile ├── CMakeLists.txt └── src ├── func.cpp ├── func.h └── main.cpp 4 directories, 9 files 在 CMake 中使用aux_source_directory 命令可以查找某个路径下的所有源文件，命令格式为：
aux_source_directory(&lt; dir &gt; &lt; variable &gt;) dir：要搜索的目录" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e41fca6901747649df0d03ada107e505/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-22T19:33:35+08:00" />
<meta property="article:modified_time" content="2023-12-22T19:33:35+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【CMake保姆级教程】搜索文件和包含头文件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_6" rel="nofollow">前言</a></li><li><a href="#_13" rel="nofollow">一、搜索文件</a></li><li><ul><li><a href="#11__14" rel="nofollow">1.1 为什么需要他</a></li><li><a href="#12_1_17" rel="nofollow">1.2 搜索方式1</a></li><li><a href="#13_2_76" rel="nofollow">1.3 搜索方法2</a></li></ul> 
  </li><li><a href="#_115" rel="nofollow">二、包含头文件</a></li><li><ul><li><a href="#21__116" rel="nofollow">2.1 为什么需要他？</a></li><li><a href="#22__143" rel="nofollow">2.2 包含头文件</a></li><li><ul><li><a href="#_144" rel="nofollow">本质</a></li><li><a href="#include_directories_153" rel="nofollow">include_directories:</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_192" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_6"></a>前言</h2> 
<p>CMake是一个跨平台的开源构建系统，它通过简化和自动化项目的构建过程，使软件开发变得更加容易。在CMake中，搜索文件和包含头文件是项目中必不可少的一部分。这一过程涉及到设置源文件、查找依赖项以及正确包含头文件，这对于确保项目的可维护性和可扩展性至关重要。</p> 
<p>在这份CMake保姆级教程中，我们将深入研究如何使用CMake搜索文件和包含头文件，使你能够更有效地管理和组织你的项目。</p> 
<hr> 
<h2><a id="_13"></a>一、搜索文件</h2> 
<h3><a id="11__14"></a>1.1 为什么需要他</h3> 
<p>如果一个项目里边的源文件很多，在编写CMakeLists.txt文件的时候不可能将项目目录的各个文件一一罗列出来，这样太麻烦也不现实。所以，在CMake中为我们提供了搜索文件的命令，可以使用aux_source_directory命令或者file命令。</p> 
<h3><a id="12_1_17"></a>1.2 搜索方式1</h3> 
<p>例如现在的文件夹层级如下，src分为一个文件夹，那我们如果要去写源文件的路径就很麻烦，那怎么办呢：</p> 
<pre><code class="prism language-bash">ubuntu@ubuntu-2204:~/C/csdn-cmake$ tree <span class="token parameter variable">-L</span> <span class="token number">2</span>
<span class="token builtin class-name">.</span>
├── bin
│   └── app
├── build
│   ├── app
│   ├── CMakeCache.txt
│   ├── CMakeFiles
│   ├── cmake_install.cmake
│   └── Makefile
├── CMakeLists.txt
└── src
    ├── func.cpp
    ├── func.h
    └── main.cpp

<span class="token number">4</span> directories, <span class="token number">9</span> files
</code></pre> 
<p>在 CMake 中使用aux_source_directory 命令可以查找某个路径下的所有源文件，命令格式为：</p> 
<pre><code class="prism language-bash">aux_source_directory<span class="token punctuation">(</span><span class="token operator">&lt;</span> <span class="token function">dir</span> <span class="token operator">&gt;</span> <span class="token operator">&lt;</span> variable <span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre> 
<p>dir：要搜索的目录<br> variable：将从dir目录下搜索到的源文件列表存储到该变量中</p> 
<p>那么上面这个文件夹层级我们就可以像下面这样写：</p> 
<pre><code class="prism language-bash">cmake_minimum_required<span class="token punctuation">(</span>VERSION <span class="token number">3.0</span>.0<span class="token punctuation">)</span>
project<span class="token punctuation">(</span>test<span class="token punctuation">)</span>

set<span class="token punctuation">(</span>SRC_LIST<span class="token punctuation">)</span>
aux_source_directory<span class="token punctuation">(</span><span class="token variable">${CMAKE_CURRENT_SOURCE_DIR}</span>/src SRC_LIST<span class="token punctuation">)</span>

add_executable<span class="token punctuation">(</span>app <span class="token variable">${SRC_LIST}</span><span class="token punctuation">)</span>
</code></pre> 
<p>其中CMAKE_CURRENT_SOURCE_DIR路径为CMakeLists.txt所在的路径<br> 接下来使用cmake和make即可</p> 
<pre><code class="prism language-bash">ubuntu@ubuntu-2204:~/C/csdn-cmake/build$ cmake <span class="token punctuation">..</span>
-- Configuring <span class="token keyword">done</span>
-- Generating <span class="token keyword">done</span>
-- Build files have been written to: /home/ubuntu/C/csdn-cmake/build
ubuntu@ubuntu-2204:~/C/csdn-cmake/build$ <span class="token function">make</span>
<span class="token punctuation">[</span> <span class="token number">33</span>%<span class="token punctuation">]</span> Building CXX object CMakeFiles/app.dir/src/func.cpp.o
<span class="token punctuation">[</span> <span class="token number">66</span>%<span class="token punctuation">]</span> Building CXX object CMakeFiles/app.dir/src/main.cpp.o
<span class="token punctuation">[</span><span class="token number">100</span>%<span class="token punctuation">]</span> Linking CXX executable app
<span class="token punctuation">[</span><span class="token number">100</span>%<span class="token punctuation">]</span> Built target app
ubuntu@ubuntu-2204:~/C/csdn-cmake/build$ 
</code></pre> 
<h3><a id="13_2_76"></a>1.3 搜索方法2</h3> 
<p>如果一个项目里边的源文件很多，在编写CMakeLists.txt文件的时候不可能将项目目录的各个文件一一罗列出来，这样太麻烦了。所以，在CMake中为我们提供了搜索文件的命令，他就是file（当然，除了搜索以外通过 file 还可以做其他事情）。</p> 
<pre><code class="prism language-bash">file<span class="token punctuation">(</span>GLOB/GLOB_RECURSE 变量名 要搜索的文件路径和文件类型<span class="token punctuation">)</span>
</code></pre> 
<p>GLOB: 将指定目录下搜索到的满足条件的所有文件名生成一个列表，并将其存储到变量中。<br> GLOB_RECURSE：递归搜索指定目录，将搜索到的满足条件的文件名生成一个列表，并将其存储到变量中。</p> 
<p>注意：我们的aux_source_directory是搜索整个路径，而file需要指定文件后缀，即是文件类型</p> 
<p>他的文件名称支持通配符</p> 
<pre><code class="prism language-bash">cmake_minimum_required<span class="token punctuation">(</span>VERSION <span class="token number">3.0</span>.0<span class="token punctuation">)</span>
project<span class="token punctuation">(</span>test<span class="token punctuation">)</span>

set<span class="token punctuation">(</span>SRC_LIST<span class="token punctuation">)</span>
file<span class="token punctuation">(</span>GLOB SRC_LIST <span class="token variable">${CMAKE_CURRENT_SOURCE_DIR}</span>/src/*.cpp<span class="token punctuation">)</span>

add_executable<span class="token punctuation">(</span>app <span class="token variable">${SRC_LIST}</span><span class="token punctuation">)</span>
</code></pre> 
<p>接下来cmake和make即可：</p> 
<pre><code class="prism language-bash">ubuntu@ubuntu-2204:~/C/csdn-cmake/build$ cmake <span class="token punctuation">..</span>
-- Configuring <span class="token keyword">done</span>
-- Generating <span class="token keyword">done</span>
-- Build files have been written to: /home/ubuntu/C/csdn-cmake/build
ubuntu@ubuntu-2204:~/C/csdn-cmake/build$ <span class="token function">make</span>
Consolidate compiler generated dependencies of target app
<span class="token punctuation">[</span> <span class="token number">33</span>%<span class="token punctuation">]</span> Building CXX object CMakeFiles/app.dir/src/func.cpp.o
<span class="token punctuation">[</span> <span class="token number">66</span>%<span class="token punctuation">]</span> Building CXX object CMakeFiles/app.dir/src/main.cpp.o
<span class="token punctuation">[</span><span class="token number">100</span>%<span class="token punctuation">]</span> Linking CXX executable app
<span class="token punctuation">[</span><span class="token number">100</span>%<span class="token punctuation">]</span> Built target app
</code></pre> 
<h2><a id="_115"></a>二、包含头文件</h2> 
<h3><a id="21__116"></a>2.1 为什么需要他？</h3> 
<p>如果在这样的一个文件层级结构中：</p> 
<pre><code class="prism language-bash">ubuntu@ubuntu-2204:~/C/csdn-cmake$ tree <span class="token parameter variable">-L</span> <span class="token number">2</span>
<span class="token builtin class-name">.</span>
├── bin
│   └── app
├── build
│   ├── app
│   ├── CMakeCache.txt
│   ├── CMakeFiles
│   ├── cmake_install.cmake
│   └── Makefile
├── CMakeLists.txt
├── include
│   └── func.h
└── src
    ├── func.cpp
    └── main.cpp

<span class="token number">5</span> directories, <span class="token number">9</span> files
</code></pre> 
<p>我们的func.cpp如下图：<br> <img src="https://images2.imgbox.com/75/58/XEq5P7bA_o.png" alt="在这里插入图片描述"><br> 那么我们的头文件都放在include文件里面了，我们如果要让他不报错只能使用相对/绝对路径<br> 但是如果文件夹一层包一层呢？那就非常的麻烦，所以我们需要包含头文件</p> 
<h3><a id="22__143"></a>2.2 包含头文件</h3> 
<h4><a id="_144"></a>本质</h4> 
<p>当我们说CMake包含头文件时，实际上是在告诉编译器在哪里可以找到项目中使用的头文件（头文件通常包含函数声明、类定义等信息）。头文件的本质含义是为编译器提供关于代码结构和接口的信息，以便在编译源文件时正确理解和处理代码。</p> 
<p>用通俗易懂的话来解释，可以想象头文件就像是一份使用说明书，告诉编译器在哪里可以找到一些特定的功能。当你在代码中使用某个函数或类时，编译器需要知道这个函数或类的定义是什么样的，以便正确地生成代码。头文件就是这个说明书，告诉编译器在哪里能找到这些定义。</p> 
<p>CMake帮助你指定这份说明书的位置。通过配置CMake，你告诉它哪些文件是头文件，然后编译器就能够按照这份说明书正确地处理你的代码，确保所有的函数和类都被正确识别和使用。</p> 
<p>简而言之，CMake包含头文件的本质含义就是告诉编译器在哪里找到代码的说明书，以便编译器能够顺利地理解和处理你的代码。</p> 
<h4><a id="include_directories_153"></a>include_directories:</h4> 
<pre><code class="prism language-bash">include_directories<span class="token punctuation">(</span>headpath<span class="token punctuation">)</span>
</code></pre> 
<p>使用上面这个cmake即可包含一个头文件的路径了</p> 
<pre><code class="prism language-bash">cmake_minimum_required<span class="token punctuation">(</span>VERSION <span class="token number">3.0</span>.0<span class="token punctuation">)</span>
project<span class="token punctuation">(</span>test<span class="token punctuation">)</span>

set<span class="token punctuation">(</span>SRC_LIST<span class="token punctuation">)</span>
file<span class="token punctuation">(</span>GLOB SRC_LIST <span class="token variable">${CMAKE_CURRENT_SOURCE_DIR}</span>/src/*.cpp<span class="token punctuation">)</span>

include_directories<span class="token punctuation">(</span><span class="token variable">${CMAKE_CURRENT_SOURCE_DIR}</span>/include<span class="token punctuation">)</span>

add_executable<span class="token punctuation">(</span>app <span class="token variable">${SRC_LIST}</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-bash">ubuntu@ubuntu-2204:~/C/csdn-cmake/build$ cmake <span class="token punctuation">..</span>
-- Configuring <span class="token keyword">done</span>
-- Generating <span class="token keyword">done</span>
-- Build files have been written to: /home/ubuntu/C/csdn-cmake/build
ubuntu@ubuntu-2204:~/C/csdn-cmake/build$ <span class="token function">make</span>
Consolidate compiler generated dependencies of target app
<span class="token punctuation">[</span> <span class="token number">33</span>%<span class="token punctuation">]</span> Building CXX object CMakeFiles/app.dir/src/func.cpp.o
<span class="token punctuation">[</span> <span class="token number">66</span>%<span class="token punctuation">]</span> Building CXX object CMakeFiles/app.dir/src/main.cpp.o
<span class="token punctuation">[</span><span class="token number">100</span>%<span class="token punctuation">]</span> Linking CXX executable app
<span class="token punctuation">[</span><span class="token number">100</span>%<span class="token punctuation">]</span> Built target app
ubuntu@ubuntu-2204:~/C/csdn-cmake/build$ ./app
Hello CMake
</code></pre> 
<p>现在我们就已经学完了！</p> 
<hr> 
<h2><a id="_192"></a>总结</h2> 
<p>通过本教程，我们深入了解了CMake中搜索文件和包含头文件的关键概念和技巧。学会配置源文件、查找依赖项以及正确设置头文件路径，将为你的项目提供一个坚实的基础。</p> 
<p>CMake的强大之处在于其灵活性和可定制性。通过遵循本教程中提供的指南，你可以更加自信地配置你的项目，确保它在不同平台和环境中都能够正确地构建。</p> 
<p>希望这份保姆级教程能够帮助你更好地利用CMake，使你的项目管理变得更加轻松和高效。继续深入学习CMake的各项功能，发掘更多构建和管理项目的技巧，提升你的开发体验。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dd42425360edf8976407afe1d2a501d3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【CMake保姆级教程】定义变量、指定C&#43;&#43;标准、指定输出路径</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c35026cecb943d4355ce2c8a0839f45e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Git的基本命令操作超详细解析教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>