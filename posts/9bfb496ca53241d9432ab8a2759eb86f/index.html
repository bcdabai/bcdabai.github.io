<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>linux shell 屏幕显示stdout stderr的同时 分别重定向到文件 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="linux shell 屏幕显示stdout stderr的同时 分别重定向到文件" />
<meta property="og:description" content="I&#39;m assuming you want to still see STDERR and STDOUT on the terminal. You could go for Josh Kelley&#39;s answer, but I find keeping a tail around in the background which outputs your log file very hackish and cludgy. Notice how you need to keep an exra FD and do cleanup afterward by killing it and technically should be doing that in a trap &#39;...&#39; EXIT.
There is a better way to do this, and you&#39;ve already discovered it: tee." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/9bfb496ca53241d9432ab8a2759eb86f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2013-12-04T22:40:50+08:00" />
<meta property="article:modified_time" content="2013-12-04T22:40:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">linux shell 屏幕显示stdout stderr的同时 分别重定向到文件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-top:0px; margin-bottom:1em; padding-top:0px; padding-bottom:0px; border:0px; font-size:14px; vertical-align:baseline; clear:both; font-family:Arial,'Liberation Sans','DejaVu Sans',sans-serif; line-height:18px"> </p> 
<p style="margin-top:0px; margin-bottom:1em; padding-top:0px; padding-bottom:0px; border:0px; font-size:14px; vertical-align:baseline; clear:both; font-family:Arial,'Liberation Sans','DejaVu Sans',sans-serif; line-height:18px"> I'm assuming you want to still see STDERR and STDOUT on the terminal. You could go for Josh Kelley's answer, but I find keeping a <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">tail</code> around in the background which outputs your log file very hackish and cludgy. Notice how you need to keep an exra FD and do cleanup afterward by killing it and technically should be doing that in a <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">trap '...' EXIT</code>.</p> 
<p style="margin-top:0px; margin-bottom:1em; padding-top:0px; padding-bottom:0px; border:0px; font-size:14px; vertical-align:baseline; clear:both; font-family:Arial,'Liberation Sans','DejaVu Sans',sans-serif; line-height:18px"> There is a better way to do this, and you've already discovered it: <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">tee</code>.</p> 
<p style="margin-top:0px; margin-bottom:1em; padding-top:0px; padding-bottom:0px; border:0px; font-size:14px; vertical-align:baseline; clear:both; font-family:Arial,'Liberation Sans','DejaVu Sans',sans-serif; line-height:18px"> Only, instead of just using it for your stdout, have a tee for stdout and one for stderr. How will you accomplish this? Process substitution and file redirection:</p> 
<pre class="lang-bsh prettyprint prettyprinted" style="margin-top:0px; margin-bottom:10px; padding:5px; border:0px; font-size:14px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif; overflow:auto; width:auto; max-height:600px; word-wrap:normal; line-height:18px"><code style="margin:0px; padding:0px; border:0px; vertical-align:baseline; font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif"><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">command </span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&gt;</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent"> </span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&gt;(</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">tee stdout</span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">.</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">log</span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">)</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent"> </span><span class="lit" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">2</span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&gt;</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent"> </span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&gt;(</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">tee stderr</span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">.</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">log </span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&gt;&amp;</span><span class="lit" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">2</span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">)</span></code></pre> 
<p style="margin-top:0px; margin-bottom:1em; padding-top:0px; padding-bottom:0px; border:0px; font-size:14px; vertical-align:baseline; clear:both; font-family:Arial,'Liberation Sans','DejaVu Sans',sans-serif; line-height:18px"> Let's split it up and explain:</p> 
<pre class="lang-bsh prettyprint prettyprinted" style="margin-top:0px; margin-bottom:10px; padding:5px; border:0px; font-size:14px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif; overflow:auto; width:auto; max-height:600px; word-wrap:normal; line-height:18px"><code style="margin:0px; padding:0px; border:0px; vertical-align:baseline; font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif"><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&gt;</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent"> </span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&gt;(..)</span></code></pre> 
<p style="margin-top:0px; margin-bottom:1em; padding-top:0px; padding-bottom:0px; border:0px; font-size:14px; vertical-align:baseline; clear:both; font-family:Arial,'Liberation Sans','DejaVu Sans',sans-serif; line-height:18px"> <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">&gt;(...)</code> (process substitution) creates a FIFO and lets <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">tee</code> listen on it. Then, it uses <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">&gt;</code> (file redirection) to redirect the STDOUT of <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">command</code> to the FIFO that your first <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">tee</code> is listening on.</p> 
<p style="margin-top:0px; margin-bottom:1em; padding-top:0px; padding-bottom:0px; border:0px; font-size:14px; vertical-align:baseline; clear:both; font-family:Arial,'Liberation Sans','DejaVu Sans',sans-serif; line-height:18px"> Same thing for the second:</p> 
<pre class="lang-bsh prettyprint prettyprinted" style="margin-top:0px; margin-bottom:10px; padding:5px; border:0px; font-size:14px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif; overflow:auto; width:auto; max-height:600px; word-wrap:normal; line-height:18px"><code style="margin:0px; padding:0px; border:0px; vertical-align:baseline; font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif"><span class="lit" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">2</span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&gt;</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent"> </span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&gt;(</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">tee stderr</span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">.</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">log </span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&gt;&amp;</span><span class="lit" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">2</span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">)</span></code></pre> 
<p style="margin-top:0px; margin-bottom:1em; padding-top:0px; padding-bottom:0px; border:0px; font-size:14px; vertical-align:baseline; clear:both; font-family:Arial,'Liberation Sans','DejaVu Sans',sans-serif; line-height:18px"> We use process substitution again to make a <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">tee</code> process that reads from STDIN and dumps it into<code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">stderr.log</code>. <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">tee</code> outputs its input back on STDOUT, but since its input is our STDERR, we want to redirect <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">tee</code>'s STDOUT to our STDERR again. Then we use file redirection to redirect <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">command</code>'s STDERR to the FIFO's input (<code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">tee</code>'s STDIN).</p> 
<p style="margin-top:0px; margin-bottom:1em; padding-top:0px; padding-bottom:0px; border:0px; font-size:14px; vertical-align:baseline; clear:both; font-family:Arial,'Liberation Sans','DejaVu Sans',sans-serif; line-height:18px"> See <a target="_blank" href="http://mywiki.wooledge.org/BashGuide/InputAndOutput" rel="nofollow noopener noreferrer" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(74,107,130); text-decoration:none"></a><a target="_blank" href="http://mywiki.wooledge.org/BashGuide/InputAndOutput" rel="nofollow noopener noreferrer" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(74,107,130); text-decoration:none">http://mywiki.wooledge.org/BashGuide/InputAndOutput</a></p> 
<p style="margin-top:0px; margin-bottom:1em; padding-top:0px; padding-bottom:0px; border:0px; font-size:14px; vertical-align:baseline; clear:both; font-family:Arial,'Liberation Sans','DejaVu Sans',sans-serif; line-height:18px"> Process substitution is one of those really lovely things you get as a bonus of choosing <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">bash</code> as your shell as opposed to <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">sh</code> (POSIX or Bourne).</p> 
<hr style="border:0px; color:rgb(221,221,221); background-color:rgb(221,221,221); height:1px; margin-bottom:20px; font-family:Arial,'Liberation Sans','DejaVu Sans',sans-serif; font-size:14px; line-height:18px"> 
<p style="margin-top:0px; margin-bottom:1em; padding-top:0px; padding-bottom:0px; border:0px; font-size:14px; vertical-align:baseline; clear:both; font-family:Arial,'Liberation Sans','DejaVu Sans',sans-serif; line-height:18px"> In <code style="margin:0px; padding:1px 5px; border:0px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif">sh</code>, you'd have to do things manually:</p> 
<pre class="lang-bsh prettyprint prettyprinted" style="margin-top:0px; margin-bottom:10px; padding:5px; border:0px; font-size:14px; vertical-align:baseline; background-color:rgb(238,238,238); font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif; overflow:auto; width:auto; max-height:600px; word-wrap:normal; line-height:18px"><code style="margin:0px; padding:0px; border:0px; vertical-align:baseline; font-family:Consolas,Menlo,Monaco,'Lucida Console','Liberation Mono','DejaVu Sans Mono','Bitstream Vera Sans Mono','Courier New',monospace,serif"><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">out</span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">=</span><span class="str" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">"${TMPDIR:-/tmp}/out.$$"</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent"> err</span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">=</span><span class="str" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">"${TMPDIR:-/tmp}/err.$$"</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">
mkfifo </span><span class="str" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">"$out"</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent"> </span><span class="str" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">"$err"</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">
trap </span><span class="str" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">'rm "$out" "$err"'</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent"> EXIT
tee stdout</span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">.</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">log </span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&lt;</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent"> </span><span class="str" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">"$out"</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent"> </span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&amp;</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">
tee stderr</span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">.</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">log </span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&lt;</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent"> </span><span class="str" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">"$err"</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent"> </span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&gt;&amp;</span><span class="lit" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">2</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent"> </span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&amp;</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">
command </span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&gt;</span><span class="str" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">"$out"</span><span class="pln" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent"> </span><span class="lit" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">2</span><span class="pun" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent">&gt;</span><span class="str" style="margin:0px; padding:0px; border:0px; vertical-align:baseline; background-color:transparent; color:rgb(128,0,0)">"$err"</span></code></pre> 
<h3 id="Miscellaneous_Operators-1" style="font-family:sans-serif">6. Miscellaneous Operators</h3> 
<span class="anchor" id="line-524" style="font-family:sans-serif; font-size:16px"></span> 
<span class="anchor" id="line-525" style="font-family:sans-serif; font-size:16px"></span> 
<p></p> 
<p class="line874" style="font-family:sans-serif; font-size:16px">Aside from the standard I/O operators, bash also provides a few more advanced operators that make life on the shell that much nicer.<span class="anchor" id="line-526"></span><span class="anchor" id="line-527"></span><span class="anchor" id="line-528"></span></p> 
<p class="line867" style="font-family:sans-serif; font-size:16px"></p> 
<h4 id="Process_Substitution" style="font-family:sans-serif">6.1. Process Substitution</h4> 
<span class="anchor" id="line-529" style="font-family:sans-serif; font-size:16px"></span> 
<span class="anchor" id="line-530" style="font-family:sans-serif; font-size:16px"></span> 
<p class="line862" style="font-family:sans-serif; font-size:16px">A cousin of the pipe is the process substitution operator, which comes in two forms: <tt class="backtick">&lt;()</tt> and <tt class="backtick">&gt;()</tt>. It's a convenient way to use named pipes without having to create temporary files. Whenever you think you need a temporary file to do something, process substitution might be a better way to handle things.<span class="anchor" id="line-531"></span><span class="anchor" id="line-532"></span></p> 
<p class="line862" style="font-family:sans-serif; font-size:16px">What it does, is basically run the command inside the parentheses. With the <tt class="backtick">&lt;()</tt> operator, the command's output is put in a named pipe (or something similar) that's created by bash. The operator itself in your command is replaced by the filename of that file. After your whole command finishes, the file is cleaned up.<span class="anchor" id="line-533"></span><span class="anchor" id="line-534"></span></p> 
<p class="line862" style="font-family:sans-serif; font-size:16px">Here's how we can put that into action: Imagine a situation where you want to see the difference between the output of two commands. Ordinarily, you'd have to put the two outputs in two files and <tt class="backtick">diff</tt> those:<span class="anchor" id="line-535"></span><span class="anchor" id="line-536"></span></p> 
<p class="line867" style="font-family:sans-serif; font-size:16px"><span class="anchor" id="line-537"></span><span class="anchor" id="line-538"></span><span class="anchor" id="line-539"></span><span class="anchor" id="line-540"></span><span class="anchor" id="line-541"></span><span class="anchor" id="line-542"></span></p> 
<pre style="border:1pt solid rgb(174,189,204); background-color:rgb(243,245,247); padding:5pt; font-family:courier,monospace; white-space:pre-wrap; word-wrap:break-word; font-size:16px"><span class="anchor" id="line-1-36"></span>$ head -n 1 .dictionary &gt; file1
<span class="anchor" id="line-2-29"></span>$ tail -n 1 .dictionary &gt; file2
<span class="anchor" id="line-3-22"></span>$ diff -y file1 file2
<span class="anchor" id="line-4-14"></span>Aachen                                                        | zymurgy
<span class="anchor" id="line-5-9"></span>$ rm file1 file2</pre> 
<span class="anchor" id="line-543" style="font-family:sans-serif; font-size:16px"></span> 
<span class="anchor" id="line-544" style="font-family:sans-serif; font-size:16px"></span> 
<p class="line862" style="font-family:sans-serif; font-size:16px">Using the <em>Process Substitution</em> operator, we can do all that with a one-liner and no need for manual cleanup:<span class="anchor" id="line-545"></span><span class="anchor" id="line-546"></span></p> 
<p class="line867" style="font-family:sans-serif; font-size:16px"><span class="anchor" id="line-547"></span><span class="anchor" id="line-548"></span><span class="anchor" id="line-549"></span></p> 
<pre style="border:1pt solid rgb(174,189,204); background-color:rgb(243,245,247); padding:5pt; font-family:courier,monospace; white-space:pre-wrap; word-wrap:break-word; font-size:16px"><span class="anchor" id="line-1-37"></span>$ diff -y &lt;(head -n 1 .dictionary) &lt;(tail -n 1 .dictionary)
<span class="anchor" id="line-2-30"></span>Aachen                                                        | zymurgy</pre> 
<span class="anchor" id="line-550" style="font-family:sans-serif; font-size:16px"></span> 
<span class="anchor" id="line-551" style="font-family:sans-serif; font-size:16px"></span> 
<p class="line862" style="font-family:sans-serif; font-size:16px">The <tt class="backtick">&lt;(..)</tt> part is replaced by the temporary FIFO created by bash, so <tt class="backtick">diff</tt> actually sees something like this:<span class="anchor" id="line-552"></span><span class="anchor" id="line-553"></span></p> 
<p class="line867" style="font-family:sans-serif; font-size:16px"><span class="anchor" id="line-554"></span><span class="anchor" id="line-555"></span></p> 
<pre style="border:1pt solid rgb(174,189,204); background-color:rgb(243,245,247); padding:5pt; font-family:courier,monospace; white-space:pre-wrap; word-wrap:break-word; font-size:16px"><span class="anchor" id="line-1-38"></span>$ diff -y /dev/fd/63 /dev/fd/62</pre> 
<span class="anchor" id="line-556" style="font-family:sans-serif; font-size:16px"></span> 
<span class="anchor" id="line-557" style="font-family:sans-serif; font-size:16px"></span> 
<p class="line862" style="font-family:sans-serif; font-size:16px">Here we see how bash runs <tt class="backtick">diff</tt> when we use process substitution. It runs our <tt class="backtick">head</tt> and <tt class="backtick">tail</tt> commands, redirecting their respective outputs to the "files"<tt class="backtick">/dev/fd/63</tt> and <tt class="backtick">/dev/fd/62</tt>. Then it runs the <tt class="backtick">diff</tt> command, passing those filenames where originally we had put the process substitution operators.<span class="anchor" id="line-558"></span><span class="anchor" id="line-559"></span></p> 
<p class="line862" style="font-family:sans-serif; font-size:16px">The actual implementation of the temporary files differs from system to system. In fact, you can see what the above would actually look like to <tt class="backtick">diff</tt> on your box by putting an <tt class="backtick">echo</tt> in front of our command:<span class="anchor" id="line-560"></span><span class="anchor" id="line-561"></span></p> 
<p class="line867" style="font-family:sans-serif; font-size:16px"><span class="anchor" id="line-562"></span><span class="anchor" id="line-563"></span><span class="anchor" id="line-564"></span></p> 
<pre style="border:1pt solid rgb(174,189,204); background-color:rgb(243,245,247); padding:5pt; font-family:courier,monospace; white-space:pre-wrap; word-wrap:break-word; font-size:16px"><span class="anchor" id="line-1-39"></span>$ echo diff -y &lt;(head -n 1 .dictionary) &lt;(tail -n 1 .dictionary)
<span class="anchor" id="line-2-31"></span>diff -y /dev/fd/63 /dev/fd/62</pre> 
<span class="anchor" id="line-565" style="font-family:sans-serif; font-size:16px"></span> 
<span class="anchor" id="line-566" style="font-family:sans-serif; font-size:16px"></span> 
<p class="line862" style="font-family:sans-serif; font-size:16px">The <tt class="backtick">&gt;(..)</tt> operator is much like the <tt class="backtick">&lt;(..)</tt> operator, but instead of redirecting the command's output to a file, we redirect the file to the command's input. It's used for cases where you're running a command that writes to a file, but you want it to write to another command instead:<span class="anchor" id="line-567"></span><span class="anchor" id="line-568"></span></p> 
<p class="line867" style="font-family:sans-serif; font-size:16px"><span class="anchor" id="line-569"></span><span class="anchor" id="line-570"></span></p> 
<pre style="border:1pt solid rgb(174,189,204); background-color:rgb(243,245,247); padding:5pt; font-family:courier,monospace; white-space:pre-wrap; word-wrap:break-word; font-size:16px"><span class="anchor" id="line-1-40"></span>$ tar -cf &gt;(ssh host tar xf -) .</pre> 
<p><br> </p> 
<p style="margin-top:0px; margin-bottom:1em; padding-top:0px; padding-bottom:0px; border:0px; font-size:14px; vertical-align:baseline; clear:both; font-family:Arial,'Liberation Sans','DejaVu Sans',sans-serif; line-height:18px"> zz：http://stackoverflow.com/questions/692000/how-do-i-write-stderr-to-a-file-while-using-tee-with-a-pipe</p> 
<p style="margin-top:0px; margin-bottom:1em; padding-top:0px; padding-bottom:0px; border:0px; font-size:14px; vertical-align:baseline; clear:both; font-family:Arial,'Liberation Sans','DejaVu Sans',sans-serif; line-height:18px"> <br> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bd4645a8c8d264bb5f145688edfdc5eb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">yum 命令 update 与 upgrade 的区别</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/580369bc47c7d68c48628098cb383fa0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Delphi7中的函数与过程（Function and Procedure）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>