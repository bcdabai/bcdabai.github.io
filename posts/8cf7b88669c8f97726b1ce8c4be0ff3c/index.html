<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>NWERC 2017(Connect the Dots-几何&#43;搜索) - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="NWERC 2017(Connect the Dots-几何&#43;搜索)" />
<meta property="og:description" content="题意：4*4个格点，要求一笔从小到大依次经过这16个点。求使用的最小线段数。
暴搜。 考虑任意一条线段一定满足 1.斜率为2个不超过20的整数的比值；2.至少经过1个点。 搜索状态为（当前画到了第几个点，当前所在射线的方向） 转移为： 在这个点转一下方向， 直接画到下一个点。 画到下一个点，中间转一次方向。
#include&lt;bits/stdc&#43;&#43;.h&gt; using namespace std; #define For(i,n) for(int i=1;i&lt;=n;i&#43;&#43;) #define Fork(i,k,n) for(int i=k;i&lt;=n;i&#43;&#43;) #define Rep(i,n) for(int i=0;i&lt;n;i&#43;&#43;) #define ForD(i,n) for(int i=n;i;i--) #define ForkD(i,k,n) for(int i=n;i&gt;=k;i--) #define RepD(i,n) for(int i=n;i&gt;=0;i--) #define Forp(x) for(int p=Pre[x];p;p=Next[p]) #define Forpiter(x) for(int &amp;p=iter[x];p;p=Next[p]) #define Lson (o&lt;&lt;1) #define Rson ((o&lt;&lt;1)&#43;1) #define MEM(a) memset(a,0,sizeof(a)); #define MEMI(a) memset(a,127,sizeof(a)); #define MEMi(a) memset(a,128,sizeof(a)); #define INF (2139062143) #define F (100000007) #define pb push_back #define mp make_pair #define fi first #define se second #define vi vector&lt;int&gt; #define pi pair&lt;int,int&gt; #define SI(a) ((a)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/8cf7b88669c8f97726b1ce8c4be0ff3c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-12-13T16:28:12+08:00" />
<meta property="article:modified_time" content="2017-12-13T16:28:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">NWERC 2017(Connect the Dots-几何&#43;搜索)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>题意：4*4个格点，要求一笔从小到大依次经过这16个点。求使用的最小线段数。</p> 
<p><img src="https://images2.imgbox.com/b5/22/36N18DrS_o.png" alt="" title=""></p> 
<p>暴搜。 <br> 考虑任意一条线段一定满足 <br> 1.斜率为2个不超过20的整数的比值；2.至少经过1个点。 <br> 搜索状态为（当前画到了第几个点，当前所在射线的方向） <br> 转移为： <br> 在这个点转一下方向， <br> 直接画到下一个点。 <br> 画到下一个点，中间转一次方向。</p> 
<pre class="prettyprint"><code class=" hljs cpp"><span class="hljs-preprocessor">#include&lt;bits/stdc++.h&gt;</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-preprocessor">#define For(i,n) for(int i=1;i&lt;=n;i++)</span>
<span class="hljs-preprocessor">#define Fork(i,k,n) for(int i=k;i&lt;=n;i++)</span>
<span class="hljs-preprocessor">#define Rep(i,n) for(int i=0;i&lt;n;i++)</span>
<span class="hljs-preprocessor">#define ForD(i,n) for(int i=n;i;i--)</span>
<span class="hljs-preprocessor">#define ForkD(i,k,n) for(int i=n;i&gt;=k;i--)</span>
<span class="hljs-preprocessor">#define RepD(i,n) for(int i=n;i&gt;=0;i--)</span>
<span class="hljs-preprocessor">#define Forp(x) for(int p=Pre[x];p;p=Next[p])</span>
<span class="hljs-preprocessor">#define Forpiter(x) for(int &amp;p=iter[x];p;p=Next[p])  </span>
<span class="hljs-preprocessor">#define Lson (o&lt;&lt;1)</span>
<span class="hljs-preprocessor">#define Rson ((o&lt;&lt;1)+1)</span>
<span class="hljs-preprocessor">#define MEM(a) memset(a,0,sizeof(a));</span>
<span class="hljs-preprocessor">#define MEMI(a) memset(a,127,sizeof(a));</span>
<span class="hljs-preprocessor">#define MEMi(a) memset(a,128,sizeof(a));</span>
<span class="hljs-preprocessor">#define INF (2139062143)</span>
<span class="hljs-preprocessor">#define F (100000007)</span>
<span class="hljs-preprocessor">#define pb push_back</span>
<span class="hljs-preprocessor">#define mp make_pair </span>
<span class="hljs-preprocessor">#define fi first</span>
<span class="hljs-preprocessor">#define se second</span>
<span class="hljs-preprocessor">#define vi vector&lt;int&gt; </span>
<span class="hljs-preprocessor">#define pi pair&lt;int,int&gt;</span>
<span class="hljs-preprocessor">#define SI(a) ((a).size())</span>
<span class="hljs-preprocessor">#define ALL(x) (x).begin(),(x).end()</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">double</span> ld;
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ull;
ll mul(ll a,ll b){<!-- --><span class="hljs-keyword">return</span> (a*b)%F;}
ll add(ll a,ll b){<!-- --><span class="hljs-keyword">return</span> (a+b)%F;}
ll sub(ll a,ll b){<!-- --><span class="hljs-keyword">return</span> (a-b+llabs(a-b)/F*F+F)%F;}
<span class="hljs-keyword">void</span> upd(ll &amp;a,ll b){a=(a%F+b%F)%F;}
<span class="hljs-keyword">int</span> read()
{
    <span class="hljs-keyword">int</span> x=<span class="hljs-number">0</span>,f=<span class="hljs-number">1</span>; <span class="hljs-keyword">char</span> ch=getchar();
    <span class="hljs-keyword">while</span>(!<span class="hljs-built_in">isdigit</span>(ch)) {<!-- --><span class="hljs-keyword">if</span> (ch==<span class="hljs-string">'-'</span>) f=-<span class="hljs-number">1</span>; ch=getchar();}
    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">isdigit</span>(ch)) { x=x*<span class="hljs-number">10</span>+ch-<span class="hljs-string">'0'</span>; ch=getchar();}
    <span class="hljs-keyword">return</span> x*f;
} 
ll sqr(ll a){<!-- --><span class="hljs-keyword">return</span> a*a;}
ld sqr(ld a){<!-- --><span class="hljs-keyword">return</span> a*a;}
<span class="hljs-keyword">double</span> sqr(<span class="hljs-keyword">double</span> a){<!-- --><span class="hljs-keyword">return</span> a*a;}
<span class="hljs-keyword">const</span> <span class="hljs-keyword">double</span> eps=<span class="hljs-number">1e-10</span>;
<span class="hljs-keyword">int</span> dcmp(<span class="hljs-keyword">double</span> x) {
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">fabs</span>(x)&lt;eps) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> x&lt;<span class="hljs-number">0</span> ? -<span class="hljs-number">1</span> : <span class="hljs-number">1</span>; 
}
ld PI = <span class="hljs-number">3.141592653589793238462643383</span>;
<span class="hljs-keyword">class</span> P{
<span class="hljs-keyword">public</span>:
    ll x,y;
    P(ll x=<span class="hljs-number">0</span>,ll y=<span class="hljs-number">0</span>):x(x),y(y){}
    <span class="hljs-keyword">friend</span> ll Dot(P A,P B) {<!-- --><span class="hljs-keyword">return</span> A.x*B.x+A.y*B.y; }
    <span class="hljs-keyword">friend</span> P <span class="hljs-keyword">operator</span>- (P A,P B) { <span class="hljs-keyword">return</span> P(A.x-B.x,A.y-B.y); }
    <span class="hljs-keyword">friend</span> P <span class="hljs-keyword">operator</span>+ (P A,P B) { <span class="hljs-keyword">return</span> P(A.x+B.x,A.y+B.y); }
    <span class="hljs-keyword">friend</span> P <span class="hljs-keyword">operator</span>* (P A,<span class="hljs-keyword">double</span> p) { <span class="hljs-keyword">return</span> P(A.x*p,A.y*p); }
    <span class="hljs-keyword">friend</span> P <span class="hljs-keyword">operator</span>/ (P A,<span class="hljs-keyword">double</span> p) { <span class="hljs-keyword">return</span> P(A.x/p,A.y/p); }
    <span class="hljs-keyword">friend</span> <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span>&lt; (<span class="hljs-keyword">const</span> P&amp; a,<span class="hljs-keyword">const</span> P&amp; b) {<!-- --><span class="hljs-keyword">return</span> dcmp(a.x-b.x)&lt;<span class="hljs-number">0</span> ||(dcmp(a.x-b.x)==<span class="hljs-number">0</span>&amp;&amp; dcmp(a.y-b.y)&lt;<span class="hljs-number">0</span> );}
    P <span class="hljs-keyword">operator</span>-()<span class="hljs-keyword">const</span> {<!-- --><span class="hljs-keyword">return</span> P(-x,-y);}
}; 
P read_point() {
    P a;
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%lld%lld"</span>,&amp;a.x,&amp;a.y);
    <span class="hljs-keyword">return</span> a;   
} 
<span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span>==(<span class="hljs-keyword">const</span> P&amp; a,<span class="hljs-keyword">const</span> P&amp; b) {
    <span class="hljs-keyword">return</span> a.x==b.x&amp;&amp;a.y==b.y;
} 
<span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span>!=(<span class="hljs-keyword">const</span> P&amp; a,<span class="hljs-keyword">const</span> P&amp; b) {
    <span class="hljs-keyword">return</span> a.x!=b.x||a.y!=b.y;
} 

<span class="hljs-keyword">typedef</span> P V;
ll Cross(V A,V B) {<!-- --><span class="hljs-keyword">return</span> A.x*B.y - A.y*B.x;}

<span class="hljs-keyword">int</span> n=<span class="hljs-number">4</span>,a[<span class="hljs-number">1000</span>][<span class="hljs-number">100</span>];
P p[<span class="hljs-number">1000</span>];
<span class="hljs-keyword">bool</span> OnRay(P a,V v,P b){
    <span class="hljs-keyword">return</span>  (dcmp(Cross(b-a,v))==<span class="hljs-number">0</span> &amp;&amp; dcmp(Dot(b-a,v))&gt;=<span class="hljs-number">0</span>) ; 
}
<span class="hljs-keyword">double</span> x_max=<span class="hljs-number">10000</span>;
P c;
<span class="hljs-keyword">bool</span> RayIntesection(P a,V v,P b,V w){
    <span class="hljs-keyword">int</span> det=Cross(v,w);
    <span class="hljs-keyword">if</span>(dcmp(det)==<span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span> (!OnRay(a,v,b) &amp;&amp; !OnRay(b,w,a)) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">int</span> s = Cross(b-a,w), t = Cross(b-a,v);
        <span class="hljs-keyword">if</span> (s*det &lt; <span class="hljs-number">0</span> || t*det &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
        <span class="hljs-keyword">double</span> ss = <span class="hljs-keyword">double</span>(s)/det;
        <span class="hljs-keyword">double</span> cx = a.x+ss*v.x,cy = a.y+ss*v.y;
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">abs</span>(cx) &gt; x_max || <span class="hljs-built_in">abs</span>(cy) &gt; x_max) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
} 
<span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-keyword">int</span>,P&gt; state;

<span class="hljs-keyword">int</span> dist[<span class="hljs-number">100</span>][<span class="hljs-number">100</span>][<span class="hljs-number">100</span>];

<span class="hljs-keyword">int</span> main()
{
    <span class="hljs-built_in">memset</span>(dist,<span class="hljs-number">0x3f3f3f3f</span>,<span class="hljs-keyword">sizeof</span>(dist));
<span class="hljs-comment">//  freopen("c.in","r",stdin);</span>
<span class="hljs-comment">//  freopen("c.out","w",stdout);</span>
    For(i,<span class="hljs-number">4</span>) {
        For(j,<span class="hljs-number">4</span>) {
            a[i][j]=read();
            p[a[i][j]-<span class="hljs-number">1</span>]=P(j,-i+<span class="hljs-number">5</span>);
        }
    }
    <span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;P&gt;</span> vs;
    Fork(x,-<span class="hljs-number">30</span>,<span class="hljs-number">30</span>) Fork(y,-<span class="hljs-number">30</span>,<span class="hljs-number">30</span>) <span class="hljs-keyword">if</span>(<span class="hljs-built_in">abs</span>(__gcd(x,y))==<span class="hljs-number">1</span>) {
        vs.pb(P(x,y));
    } 
    <span class="hljs-stl_container"><span class="hljs-built_in">deque</span>&lt;state&gt;</span> q;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> v:vs) {
        dist[v.x+<span class="hljs-number">50</span>][v.y+<span class="hljs-number">50</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;
        q.emplace_back(<span class="hljs-number">0</span>,v);
    }
    <span class="hljs-keyword">auto</span> relax = [&amp;] (state s,state t,<span class="hljs-keyword">int</span> len){
        <span class="hljs-keyword">if</span>(dist[t.se.x+<span class="hljs-number">50</span>][t.se.y+<span class="hljs-number">50</span>][t.fi]&gt;dist[s.se.x+<span class="hljs-number">50</span>][s.se.y+<span class="hljs-number">50</span>][s.fi]+len) {
            dist[t.se.x+<span class="hljs-number">50</span>][t.se.y+<span class="hljs-number">50</span>][t.fi]=dist[s.se.x+<span class="hljs-number">50</span>][s.se.y+<span class="hljs-number">50</span>][s.fi]+len;
            <span class="hljs-keyword">if</span>(!len) q.push_front(t);
            <span class="hljs-keyword">else</span> q.push_back(t);
        }
    };
    <span class="hljs-keyword">int</span> ans=<span class="hljs-number">1e9</span>+<span class="hljs-number">7</span>;
    <span class="hljs-keyword">int</span> an[<span class="hljs-number">16</span>];
    Rep(i,<span class="hljs-number">16</span>) an[i]=INF;
    <span class="hljs-keyword">while</span>(!q.empty()){
        <span class="hljs-keyword">int</span> i; P v;
        tie(i,v) = q.front();
        q.pop_front();
        an[i]=min(an[i],dist[v.x+<span class="hljs-number">50</span>][v.y+<span class="hljs-number">50</span>][i]);
        <span class="hljs-keyword">if</span> (i==<span class="hljs-number">15</span>) {
            ans=min(ans,dist[v.x+<span class="hljs-number">50</span>][v.y+<span class="hljs-number">50</span>][i])    ;
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> w:vs) {
            <span class="hljs-keyword">if</span> (v!=w) {
                relax({i,v},{i,w},<span class="hljs-number">1</span>); <span class="hljs-comment">//正好在点i改变方向 </span>
            }
        }
        <span class="hljs-keyword">if</span>(OnRay(p[i],v,p[i+<span class="hljs-number">1</span>])) {
            relax({i,v},{i+<span class="hljs-number">1</span>,v},<span class="hljs-number">0</span>); <span class="hljs-comment">//不改变方向 </span>
<span class="hljs-comment">//          cerr&lt;&lt;i&lt;&lt;' '&lt;&lt;dist[v.x+50][v.y+50][i+1]&lt;&lt;endl;</span>
        }
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> w:vs) {
            <span class="hljs-keyword">if</span> (v!=w) {
                <span class="hljs-keyword">if</span> (!RayIntesection(p[i],v,p[i+<span class="hljs-number">1</span>],-w)) <span class="hljs-keyword">continue</span>;
                relax({i,v},{i+<span class="hljs-number">1</span>,w},<span class="hljs-number">1</span>); <span class="hljs-comment">//在i点延长出去某点改变方向</span>
            }
        }
    }
<span class="hljs-comment">//  Rep(i,16) cerr&lt;&lt;an[i]&lt;&lt;' ';puts("");</span>
    <span class="hljs-built_in">cout</span>&lt;&lt;ans&lt;&lt;endl;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/66d9330f38ac2d0992bba71d5d9debb2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">numpy 数组维度操作总汇</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2a6b43a1ab65d57e2a8d8807a3d48627/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue中实现先请求数据再渲染dom</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>