<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>用c语言写的base64编码解码函数！ - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="用c语言写的base64编码解码函数！" />
<meta property="og:description" content="/* *****************************************************************************
* Description : BASE64 encoding and decoding
* Date : 06-08-21 21:00 * Author : aishen944
* Copryright : ********************************************************************************/
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;errno.h&gt;
#define BASE64_PAD64 &#39;=&#39;
char base64_alphabet[] = {&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;, &#39;G&#39;, &#39;H&#39;, &#39;I&#39;,
&#39;J&#39;, &#39;K&#39;, &#39;L&#39;, &#39;M&#39;, &#39;N&#39;, &#39;O&#39;, &#39;P&#39;, &#39;Q&#39;, &#39;R&#39;,
&#39;S&#39;, &#39;T&#39;, &#39;U&#39;, &#39;V&#39;, &#39;W&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;, &#39;a&#39;,
&#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;," />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e6d9e7d589e04ed2928ba1a3baeb0ccc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2006-08-22T13:22:00+08:00" />
<meta property="article:modified_time" content="2006-08-22T13:22:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">用c语言写的base64编码解码函数！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>/* *****************************************************************************</p> 
<p> * Description : BASE64 encoding and decoding</p> 
<p> * Date             : 06-08-21 21:00 </p> 
<p> * Author          :  aishen944</p> 
<p> * Copryright   :  </p> 
<p>********************************************************************************/</p> 
<p>#include &lt;string.h&gt;<br>#include &lt;stdlib.h&gt;<br>#include &lt;errno.h&gt;</p> 
<p>#define BASE64_PAD64 '='</p> 
<p>char base64_alphabet[] = {'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I',<br>                          'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R',<br>                          'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a',<br>                          'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j',<br>                          'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's',<br>                          't', 'u', 'v', 'w', 'x', 'y', 'z', '0', '1',<br>                          '2', '3', '4', '5', '6', '7', '8', '9', '+',<br>                          '/'};</p> 
<p>char base64_suffix_map[256] = {<!-- --><br>     255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,<br>     255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,<br>     255, 255, 255,  62, 255, 255, 255,  63,  52,  53,  54,  55,  56,  57,  58,  59,  60,  61, 255, 255,<br>     255, 255, 255, 255, 255,  0,   1,    2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,<br>     15,   16,  17,  18,  19,  20,  21,  22,  23,  24,  25, 255, 255, 255, 255, 255, 255,  26,  27,  28,<br>     29,   30,  31,  32,  33,  34,  35,  36,  37,  38,  39,  40,  41,  42,  43,  44,  45,  46,  47,  48,<br>     49,   50,  51, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,<br>     255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,<br>     255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,<br>     255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,<br>     255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,<br>     255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,<br>     255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255};</p> 
<p>static char cmove_bits(unsigned char src, unsigned lnum, unsigned rnum) {<!-- --><br>   src &lt;&lt;= lnum;<br>   src &gt;&gt;= rnum;<br>   return src;<br>}</p> 
<p>char* base64_encode(const char *data) {<!-- --><br>   char *ret, *retpos;<br>   int n, m, padnum = 0, retsize, dlen = strlen(data);</p> 
<p>   if(dlen == 0) return NULL;</p> 
<p>   /* Account the result buffer size and alloc the memory for it. */<br>   if((dlen % 3) != 0)<br>    padnum = 3 - dlen % 3;<br>   retsize = (dlen + padnum) + ((dlen + padnum) * 1/3) + 1;<br>   if((ret = malloc(retsize)) == NULL) <br>      return NULL;<br>   retpos = ret;</p> 
<p>   /* Starting to convert the originality characters to BASE64 chracaters. <br>      Converting process keep to 4-&gt;6 principle. */<br>   for(m = 0; m &lt; (dlen + padnum); m += 3) {<!-- --><br>      /* When data is not suffice 24 bits then pad 0 and the empty place pad '='. */<br>      *(retpos) = base64_alphabet[cmove_bits(*data, 0, 2)];<br>      if(m == dlen + padnum - 3 &amp;&amp; padnum != 0) {  /* Whether the last bits-group suffice 24 bits. */<br>          if(padnum == 1) {   /* 16bit need pad one '='. */<br>              *(retpos + 1) = base64_alphabet[cmove_bits(*data, 6, 2) + cmove_bits(*(data + 1), 0, 4)];<br>              *(retpos + 2) = base64_alphabet[cmove_bits(*(data + 1), 4, 2)];<br>              *(retpos + 3) = BASE64_PAD64;<br>          } else if(padnum == 2) { /* 8bit need pad two'='. */<br>              *(retpos + 1) = base64_alphabet[cmove_bits(*data, 6, 2)];<br>              *(retpos + 2) = BASE64_PAD64;<br>              *(retpos + 3) = BASE64_PAD64;<br>          }<br>      } else {  /* 24bit normal. */<br>         *(retpos + 1) = base64_alphabet[cmove_bits(*data, 6, 2) + cmove_bits(*(data + 1), 0, 4)];<br>         *(retpos + 2) = base64_alphabet[cmove_bits(*(data + 1), 4, 2) + cmove_bits(*(data + 2), 0, 6)];<br>         *(retpos + 3) = base64_alphabet[*(data + 2) &amp; 0x3f];<br>      }</p> 
<p>      retpos += 4;<br>      data += 3;<br>   }</p> 
<p>   ret[retsize - 1] =0;</p> 
<p>   return ret;<br>}</p> 
<p>char* base64_decode(const char *bdata) {<!-- --><br>   char *ret = NULL, *retpos;<br>   int n, m, padnum = 0, retsize, bdlen = strlen(bdata);</p> 
<p>   if(bdlen == 0) return NULL;<br>   if(bdlen % 4 != 0) return NULL;</p> 
<p>   /* Whether the data have invalid base-64 characters? */<br>   for(m = 0; m &lt; bdlen; ++m) {<!-- --><br>      if(bdata[m] != BASE64_PAD64 &amp;&amp; base64_suffix_map[bdata[m]] == 255)<br>         goto LEND;<br>   }</p> 
<p>   /* Account the output size. */<br>   if(bdata[bdlen - 1] ==  '=')  padnum = 1;<br>   if(bdata[bdlen - 1] == '=' &amp;&amp; bdata[bdlen - 2] ==  '=') padnum = 2;<br>   retsize = (bdlen - 4) - (bdlen - 4) / 4 + (3 - padnum) + 1;<br>   ret = malloc(retsize);<br>   if(ret == NULL) <br>         return NULL;<br>   retpos = ret; </p> 
<p>   /* Begging to decode. */<br>   for(m = 0; m &lt; bdlen; m += 4) {<!-- --><br>      *retpos = cmove_bits(base64_suffix_map[*bdata], 2, 0) + cmove_bits(base64_suffix_map[*(bdata + 1)], 0, 4);<br>      if(m == bdlen - 4 &amp;&amp; padnum != 0) {  /* Only deal with last four bits. */<br>         if(padnum == 1)   /* Have one pad characters, only two availability characters. */<br>            *(retpos + 1) = cmove_bits(base64_suffix_map[*(bdata + 1)], 4, 0) + cmove_bits(base64_suffix_map[*(bdata + 2)], 0, 2);<br>         /*<br>         Have two pad characters, only two availability characters.<br>         if(padnum == 2) { <br>         }<br>         */<br>         retpos += 3 - padnum;<br>      } else {<!-- --><br>         *(retpos + 1) = cmove_bits(base64_suffix_map[*(bdata + 1)], 4, 0) + cmove_bits(base64_suffix_map[*(bdata + 2)], 0, 2);<br>         *(retpos + 2) = cmove_bits(base64_suffix_map[*(bdata + 2)], 6, 0) + base64_suffix_map[*(bdata + 3)];<br>         retpos += 3;<br>      }<br>      bdata += 4;<br>   }</p> 
<p>   ret[retsize - 1] = 0;</p> 
<p>   LEND: return ret;<br>}<br></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/462a94a59066eb081f2ee6152d1fdb4b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java中的类反射机制</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d6cd9879f787ddc7f33864f09c306b89/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">就算不偷盗，也让你看看计算机里常用的有那些软件--常用软件序列号</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>