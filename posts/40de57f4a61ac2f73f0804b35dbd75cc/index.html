<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python中requests库使用方法详解 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python中requests库使用方法详解" />
<meta property="og:description" content="python中requests库使用方法详解 前言：一、什么是Requests二、安装Requests库三、各种请求方式1. 基本的GET请求2. 带参数的GET请求3. 解析json4. 获取二进制数据5. 添加headers6. 基本POST请求 三、响应四、高级操作1. 文件上传2. 获取cookie3. 会话维持、模拟登陆4. 代理设置5. 异常处理 前言： 开发环境：Windows10专业版
开发软件：Pycharm Community 2022.3
一、什么是Requests Requests 是⽤Python语⾔编写，基于urllib，采⽤Apache2 Licensed开源协议的 HTTP 库。它⽐ urllib 更加⽅便，可以节约我们⼤量的⼯作，完全满⾜HTTP测试需求。
二、安装Requests库 在前面的Python基础中我们已经在电脑中配置好了Python环境
如果你还没有安装Python环境可以参考我的这篇文章Python基础——0.Python环境的安装___H2__的博客-CSDN博客
进入命令行win&#43;R执行命令提示符
输入：pip install requests 即可开始安装requests库
项目导入requests：import requests
三、各种请求方式 各种请求方式的使用方法是：
import requests requests.post(&#39;http://httpbin.org/post&#39;) requests.put(&#39;http://httpbin.org/put&#39;) requests.delete(&#39;http://httpbin.org/delete&#39;) requests.head(&#39;http://httpbin.org/get&#39;) requests.options(&#39;http://httpbin.org/get&#39;) 这五种请求的意义分别是：
GET： 请求指定的页面信息，并返回实体主体。
HEAD： 只请求页面的首部。
POST： 请求服务器接受所指定的文档作为对所标识的URI的新的从属实体。
PUT： 从客户端向服务器传送的数据取代指定的文档的内容。
DELETE： 请求服务器删除指定的页面。
**get 和 post比较常见 **
GET:请求将提交的数据放置在HTTP请求协议头中；
POST:提交的数据则放在实体数据中
1. 基本的GET请求 import requests response = requests." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/40de57f4a61ac2f73f0804b35dbd75cc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-02T20:51:40+08:00" />
<meta property="article:modified_time" content="2023-02-02T20:51:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python中requests库使用方法详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>python中requests库使用方法详解</h4> 
 <ul><li><a href="#_8" rel="nofollow">前言：</a></li><li><ul><li><a href="#Requests_13" rel="nofollow">一、什么是Requests</a></li><li><a href="#Requests_17" rel="nofollow">二、安装Requests库</a></li><li><a href="#_29" rel="nofollow">三、各种请求方式</a></li><li><ul><li><a href="#1_GET_61" rel="nofollow">1. 基本的GET请求</a></li><li><a href="#2_GET_81" rel="nofollow">2. 带参数的GET请求</a></li><li><a href="#3_json_139" rel="nofollow">3. 解析json</a></li><li><a href="#4__167" rel="nofollow">4. 获取二进制数据</a></li><li><a href="#5_headers_182" rel="nofollow">5. 添加headers</a></li><li><a href="#6__POST_202" rel="nofollow">6. 基本POST请求</a></li></ul> 
   </li><li><a href="#_238" rel="nofollow">三、响应</a></li><li><a href="#_341" rel="nofollow">四、高级操作</a></li><li><ul><li><a href="#1__343" rel="nofollow">1. 文件上传</a></li><li><a href="#2_cookie_384" rel="nofollow">2. 获取cookie</a></li><li><a href="#3__405" rel="nofollow">3. 会话维持、模拟登陆</a></li><li><a href="#4__437" rel="nofollow">4. 代理设置</a></li><li><a href="#5__472" rel="nofollow">5. 异常处理</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_8"></a>前言：</h2> 
<p>开发环境：Windows10专业版<br> 开发软件：Pycharm Community 2022.3</p> 
<h3><a id="Requests_13"></a>一、什么是Requests</h3> 
<p>Requests 是⽤Python语⾔编写，基于urllib，采⽤Apache2 Licensed开源协议的 HTTP 库。它⽐ urllib 更加⽅便，可以节约我们⼤量的⼯作，完全满⾜HTTP测试需求。</p> 
<h3><a id="Requests_17"></a>二、安装Requests库</h3> 
<p>在前面的Python基础中我们已经在电脑中配置好了Python环境</p> 
<p>如果你还没有安装Python环境可以参考我的这篇文章<a href="https://blog.csdn.net/qq_53381910/article/details/128821705">Python基础——0.Python环境的安装___H2__的博客-CSDN博客</a></p> 
<p>进入命令行win+R执行命令提示符</p> 
<p>输入：pip install requests 即可开始安装requests库</p> 
<p>项目导入requests：import requests</p> 
<h3><a id="_29"></a>三、各种请求方式</h3> 
<p>各种请求方式的使用方法是：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'http://httpbin.org/post'</span><span class="token punctuation">)</span>
requests<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token string">'http://httpbin.org/put'</span><span class="token punctuation">)</span>
requests<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token string">'http://httpbin.org/delete'</span><span class="token punctuation">)</span>
requests<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token string">'http://httpbin.org/get'</span><span class="token punctuation">)</span>
requests<span class="token punctuation">.</span>options<span class="token punctuation">(</span><span class="token string">'http://httpbin.org/get'</span><span class="token punctuation">)</span>
</code></pre> 
<p>这五种请求的意义分别是：</p> 
<ul><li> <p><strong>GET： 请求指定的页面信息，并返回实体主体。</strong></p> </li><li> <p><strong>HEAD： 只请求页面的首部。</strong></p> </li><li> <p><strong>POST： 请求服务器接受所指定的文档作为对所标识的URI的新的从属实体。</strong></p> </li><li> <p><strong>PUT： 从客户端向服务器传送的数据取代指定的文档的内容。</strong></p> </li><li> <p><strong>DELETE： 请求服务器删除指定的页面。</strong></p> </li></ul> 
<p>**get 和 post比较常见 **</p> 
<p><strong>GET:请求将提交的数据放置在HTTP请求协议头中；</strong></p> 
<p><strong>POST:提交的数据则放在实体数据中</strong></p> 
<h4><a id="1_GET_61"></a>1. 基本的GET请求</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
 
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://httpbin.org/get'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</code></pre> 
<p>返回结果：</p> 
<pre><code>&lt;!DOCTYPE html&gt;
&lt;!--STATUS OK--&gt;&lt;html&gt; &lt;head&gt;&lt;meta http-equiv=content-type content=text/html;charset=utf-8&gt;&lt;meta http-equiv=X-UA-Compatible content=IE=Edge&gt;&lt;meta content=always name=referrer&gt;&lt;link rel=stylesheet type=text/css href=http://s1.bdstatic.com/r/www/cache/bdorz/baidu.min.css&gt;&lt;title&gt;ç™¾åº¦ä¸€ä¸‹ï¼Œä½ å°±çŸ¥é“&lt;/title&gt;&lt;/head&gt; &lt;body link=#0000cc&gt; &lt;div id=wrapper&gt; &lt;div id=head&gt; &lt;div class=head_wrapper&gt; &lt;div class=s_form&gt; &lt;div class=s_form_wrapper&gt; &lt;div id=lg&gt; &lt;img hidefocus=true src=//www.baidu.com/img/bd_logo1.png width=270 height=129&gt; &lt;/div&gt; &lt;form id=form name=f action=//www.baidu.com/s class=fm&gt; &lt;input type=hidden name=bdorz_come value=1&gt; &lt;input type=hidden name=ie value=utf-8&gt; &lt;input type=hidden name=f value=8&gt; &lt;input type=hidden name=rsv_bp value=1&gt; &lt;input type=hidden name=rsv_idx value=1&gt; &lt;input type=hidden name=tn value=baidu&gt;&lt;span class="bg s_ipt_wr"&gt;&lt;input id=kw name=wd class=s_ipt value maxlength=255 autocomplete=off autofocus&gt;&lt;/span&gt;&lt;span class="bg s_btn_wr"&gt;&lt;input type=submit id=su value=ç™¾åº¦ä¸€ä¸‹ class="bg s_btn"&gt;&lt;/span&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt; &lt;div id=u1&gt; &lt;a href=http://news.baidu.com name=tj_trnews class=mnav&gt;æ–°é—»&lt;/a&gt; &lt;a href=http://www.hao123.com name=tj_trhao123 class=mnav&gt;hao123&lt;/a&gt; &lt;a href=http://map.baidu.com name=tj_trmap class=mnav&gt;åœ°å›¾&lt;/a&gt; &lt;a href=http://v.baidu.com name=tj_trvideo class=mnav&gt;è§†é¢‘&lt;/a&gt; &lt;a href=http://tieba.baidu.com name=tj_trtieba class=mnav&gt;è´´å§&lt;/a&gt; &lt;noscript&gt; &lt;a href=http://www.baidu.com/bdorz/login.gif?login&amp;amp;tpl=mn&amp;amp;u=http%3A%2F%2Fwww.baidu.com%2f%3fbdorz_come%3d1 name=tj_login class=lb&gt;ç™»å½•&lt;/a&gt; &lt;/noscript&gt; &lt;script&gt;document.write('&lt;a href="http://www.baidu.com/bdorz/login.gif?login&amp;tpl=mn&amp;u='+ encodeURIComponent(window.location.href+ (window.location.search === "" ? "?" : "&amp;")+ "bdorz_come=1")+ '" name="tj_login" class="lb"&gt;ç™»å½•&lt;/a&gt;');&lt;/script&gt; &lt;a href=//www.baidu.com/more/ name=tj_briicon class=bri style="display: block;"&gt;æ›´å¤šäº§å“&lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div id=ftCon&gt; &lt;div id=ftConw&gt; &lt;p id=lh&gt; &lt;a href=http://home.baidu.com&gt;å
³äºŽç™¾åº¦&lt;/a&gt; &lt;a href=http://ir.baidu.com&gt;About Baidu&lt;/a&gt; &lt;/p&gt; &lt;p id=cp&gt;&amp;copy;2017&amp;nbsp;Baidu&amp;nbsp;&lt;a href=http://www.baidu.com/duty/&gt;ä½¿ç”¨ç™¾åº¦å‰å¿
è¯»&lt;/a&gt;&amp;nbsp; &lt;a href=http://jianyi.baidu.com/ class=cp-feedback&gt;æ„è§åé¦ˆ&lt;/a&gt;&amp;nbsp;äº¬ICPè¯030173å·&amp;nbsp; &lt;img src=//www.baidu.com/img/gs.gif&gt; &lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt;
</code></pre> 
<h4><a id="2_GET_81"></a>2. 带参数的GET请求</h4> 
<p>将name和age传进去</p> 
<pre><code>import requests
response = requests.get("http://httpbin.org/get?name=germey&amp;age=22")
print(response.text)
{
  "args": {
    "age": "22", 
    "name": "germey"
  }, 
  "headers": {
    "Accept": "*/*", 
    "Accept-Encoding": "gzip, deflate", 
    "Connection": "close", 
    "Host": "httpbin.org", 
    "User-Agent": "python-requests/2.18.4"
  }, 
  "origin": "183.64.61.29", 
  "url": "http://httpbin.org/get?name=germey&amp;age=22"
}
</code></pre> 
<p>或者使用params的方法：</p> 
<pre><code>import requests
 
data = {
 'name': 'germey',
 'age': 22
}
response = requests.get("http://httpbin.org/get", params=data)
print(response.text)
</code></pre> 
<p>输出结果：</p> 
<pre><code>{
  "args": {
    "age": "22", 
    "name": "germey"
  }, 
  "headers": {
    "Accept": "*/*", 
    "Accept-Encoding": "gzip, deflate", 
    "Host": "httpbin.org", 
    "User-Agent": "python-requests/2.28.2", 
    "X-Amzn-Trace-Id": "Root=1-63dbab1e-10a0b6a747231aa8069318fb"
  }, 
  "origin": "117.44.70.180", 
  "url": "http://httpbin.org/get?name=germey&amp;age=22"
}
</code></pre> 
<h4><a id="3_json_139"></a>3. 解析json</h4> 
<p>将返回值以json的形式展示：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> json
 
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/get"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>运行结果：</p> 
<pre><code>&lt;class 'str'&gt;

{'args': {}, 'headers': {'Accept': '*/*', 'Accept-Encoding': 'gzip, deflate', 'Connection': 'close', 'Host': 'httpbin.org', 'User-Agent': 'python-requests/2.18.4'}, 'origin': '183.64.61.29', 'url': 'http://httpbin.org/get'}

{'args': {}, 'headers': {'Accept': '*/*', 'Accept-Encoding': 'gzip, deflate', 'Connection': 'close', 'Host': 'httpbin.org', 'User-Agent': 'python-requests/2.18.4'}, 'origin': '183.64.61.29', 'url': 'http://httpbin.org/get'}

&lt;class 'dict'&gt;
</code></pre> 
<h4><a id="4__167"></a>4. 获取二进制数据</h4> 
<p>记住返回值.content就ok了</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
 
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://github.com/favicon.ico"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">)</span>
</code></pre> 
<p>返回值是非常长的01二进制字符串所以在此不做演示。</p> 
<h4><a id="5_headers_182"></a>5. 添加headers</h4> 
<p>在访问次数过多被服务器认定为爬虫攻击时，短时间内可能会将你的IP封禁，这代表你两个小时内将无法使用继续你的爬虫代码调试</p> 
<p>，所以我们一般会添加hearder参数。</p> 
<p>当传入headers时：</p> 
<pre><code>import requests
 
headers = {
 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36'
}
response = requests.get("https://www.csdn.net/", headers=headers)
print(response.text)
</code></pre> 
<p>输出结果是csdn首页的html页面源代码</p> 
<h4><a id="6__POST_202"></a>6. 基本POST请求</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
 
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'germey'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token string">'22'</span><span class="token punctuation">}</span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/post"</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</code></pre> 
<p>运行结果：</p> 
<pre><code>{
  "args": {}, 
  "data": "", 
  "files": {}, 
  "form": {
    "age": "22", 
    "name": "germey"
  }, 
  "headers": {
    "Accept": "*/*", 
    "Accept-Encoding": "gzip, deflate", 
    "Content-Length": "18", 
    "Content-Type": "application/x-www-form-urlencoded", 
    "Host": "httpbin.org", 
    "User-Agent": "python-requests/2.28.2", 
    "X-Amzn-Trace-Id": "Root=1-63dbac35-180f5a89233e7d6b4fe75688"
  }, 
  "json": null, 
  "origin": "117.44.70.180", 
  "url": "http://httpbin.org/post"
}
</code></pre> 
<h3><a id="_238"></a>三、响应</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://www.jianshu.com/'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>headers<span class="token punctuation">)</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>history<span class="token punctuation">)</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>history<span class="token punctuation">)</span>
</code></pre> 
<p>运行结果：</p> 
<pre><code>&lt;class 'int'&gt; 403
&lt;class 'requests.structures.CaseInsensitiveDict'&gt; {'Server': 'Tengine', 'Date': 'Thu, 02 Feb 2023 12:28:21 GMT', 'Content-Type': 'text/html', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Vary': 'Accept-Encoding', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'Content-Encoding': 'gzip'}
&lt;class 'requests.cookies.RequestsCookieJar'&gt; &lt;RequestsCookieJar[]&gt;
&lt;class 'str'&gt; https://www.jianshu.com/
&lt;class 'list'&gt; []
</code></pre> 
<p>状态码判断：常见的网页状态码：</p> 
<pre><code>100: ('continue',),
101: ('switching_protocols',),
102: ('processing',),
103: ('checkpoint',),
122: ('uri_too_long', 'request_uri_too_long'),
200: ('ok', 'okay', 'all_ok', 'all_okay', 'all_good', '\\o/', '✓'),
201: ('created',),
202: ('accepted',),
203: ('non_authoritative_info', 'non_authoritative_information'),
204: ('no_content',),
205: ('reset_content', 'reset'),
206: ('partial_content', 'partial'),
207: ('multi_status', 'multiple_status', 'multi_stati', 'multiple_stati'),
208: ('already_reported',),
226: ('im_used',),
 
# Redirection.
300: ('multiple_choices',),
301: ('moved_permanently', 'moved', '\\o-'),
302: ('found',),
303: ('see_other', 'other'),
304: ('not_modified',),
305: ('use_proxy',),
306: ('switch_proxy',),
307: ('temporary_redirect', 'temporary_moved', 'temporary'),
308: ('permanent_redirect',
 'resume_incomplete', 'resume',), # These 2 to be removed in 3.0
 
# Client Error.
400: ('bad_request', 'bad'),
401: ('unauthorized',),
402: ('payment_required', 'payment'),
403: ('forbidden',),
404: ('not_found', '-o-'),
405: ('method_not_allowed', 'not_allowed'),
406: ('not_acceptable',),
407: ('proxy_authentication_required', 'proxy_auth', 'proxy_authentication'),
408: ('request_timeout', 'timeout'),
409: ('conflict',),
410: ('gone',),
411: ('length_required',),
412: ('precondition_failed', 'precondition'),
413: ('request_entity_too_large',),
414: ('request_uri_too_large',),
415: ('unsupported_media_type', 'unsupported_media', 'media_type'),
416: ('requested_range_not_satisfiable', 'requested_range', 'range_not_satisfiable'),
417: ('expectation_failed',),
418: ('im_a_teapot', 'teapot', 'i_am_a_teapot'),
421: ('misdirected_request',),
422: ('unprocessable_entity', 'unprocessable'),
423: ('locked',),
424: ('failed_dependency', 'dependency'),
425: ('unordered_collection', 'unordered'),
426: ('upgrade_required', 'upgrade'),
428: ('precondition_required', 'precondition'),
429: ('too_many_requests', 'too_many'),
431: ('header_fields_too_large', 'fields_too_large'),
444: ('no_response', 'none'),
449: ('retry_with', 'retry'),
450: ('blocked_by_windows_parental_controls', 'parental_controls'),
451: ('unavailable_for_legal_reasons', 'legal_reasons'),
499: ('client_closed_request',),
 
# Server Error.
500: ('internal_server_error', 'server_error', '/o\\', '✗'),
501: ('not_implemented',),
502: ('bad_gateway',),
503: ('service_unavailable', 'unavailable'),
504: ('gateway_timeout',),
505: ('http_version_not_supported', 'http_version'),
506: ('variant_also_negotiates',),
507: ('insufficient_storage',),
509: ('bandwidth_limit_exceeded', 'bandwidth'),
510: ('not_extended',),
511: ('network_authentication_required', 'network_auth', 'network_authentication'),
</code></pre> 
<h3><a id="_341"></a>四、高级操作</h3> 
<h4><a id="1__343"></a>1. 文件上传</h4> 
<p>使用 Requests 模块，上传文件也是如此简单的，文件的类型会自动进行处理：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
 
files <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'file'</span><span class="token punctuation">:</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'cookie.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/post"</span><span class="token punctuation">,</span> files<span class="token operator">=</span>files<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</code></pre> 
<p>通过测试网站做的一个测试</p> 
<p>我们先在当前Python文件的目录下建一个名为<strong>hello.txt</strong>的文本文档，在里面输入<strong>helloworld！</strong></p> 
<p>保存此文件后运行以上代码，输出结果如下:</p> 
<pre><code>{
  "args": {}, 
  "data": "", 
  "files": {
    "file": "helloworld!"
  }, 
  "form": {}, 
  "headers": {
    "Accept": "*/*", 
    "Accept-Encoding": "gzip, deflate", 
    "Content-Length": "156", 
    "Content-Type": "multipart/form-data; boundary=2954083cd56e685e1b45f9840426b548", 
    "Host": "httpbin.org", 
    "User-Agent": "python-requests/2.28.2", 
    "X-Amzn-Trace-Id": "Root=1-63dbad05-039a79aa0adbc2733eab773b"
  }, 
  "json": null, 
  "origin": "117.44.70.180", 
  "url": "http://httpbin.org/post"
}
</code></pre> 
<h4><a id="2_cookie_384"></a>2. 获取cookie</h4> 
<p>当需要cookie时，直接调用response.cookie:(response为请求后的返回值)</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://www.baidu.com/"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span>

<span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> response<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">'='</span> <span class="token operator">+</span> value<span class="token punctuation">)</span>
</code></pre> 
<p>输出结果：</p> 
<pre><code>&lt;RequestsCookieJar[&lt;Cookie BDORZ=27315 for .baidu.com/&gt;]&gt;
BDORZ=27315
</code></pre> 
<h4><a id="3__405"></a>3. 会话维持、模拟登陆</h4> 
<p>如果某个响应中包含一些Cookie，你可以快速访问它们：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
 
r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://www.google.com.hk/'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>cookies<span class="token punctuation">[</span><span class="token string">'NID'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">tuple</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>cookies<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>要想发送你的cookies到服务器，可以使用 cookies 参数：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests

headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_4) AppleWebKit/"</span>
                  <span class="token string">"537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36"</span>
<span class="token punctuation">}</span>

<span class="token comment"># 在Cookie Version 0中规定空格、方括号、圆括号、等于号、逗号、双引号、斜杠、问号、@，冒号，分号等特殊符号都不能作为Cookie的内容。</span>

cookies <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"cookie_name"</span><span class="token punctuation">:</span> <span class="token string">"cookie_value"</span><span class="token punctuation">,</span> <span class="token punctuation">}</span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>

</code></pre> 
<p>输出结果是网页的html代码</p> 
<h4><a id="4__437"></a>4. 代理设置</h4> 
<p>在进行爬虫爬取时，有时候爬虫会被服务器给屏蔽掉，这时采用的方法主要有降低访问时间，通过代理ip访问，如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
 
proxies <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
 <span class="token string">"http"</span><span class="token punctuation">:</span> <span class="token string">"http://127.0.0.1:9743"</span><span class="token punctuation">,</span>
 <span class="token string">"https"</span><span class="token punctuation">:</span> <span class="token string">"https://127.0.0.1:9743"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
 
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://www.taobao.com"</span><span class="token punctuation">,</span> proxies<span class="token operator">=</span>proxies<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>
</code></pre> 
<p>ip可以从网上抓取，或者某宝购买</p> 
<p><strong>超时设置</strong></p> 
<p>访问有些网站时可能会超时，这时设置好timeout就可以解决这个问题</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> requests<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> ReadTimeout

<span class="token keyword">try</span><span class="token punctuation">:</span>
     response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/get"</span><span class="token punctuation">,</span> timeout <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>
<span class="token keyword">except</span> ReadTimeout<span class="token punctuation">:</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Timeout'</span><span class="token punctuation">)</span>
</code></pre> 
<p>正常访问，状态码将返回200，超时则会输出Timeout</p> 
<h4><a id="5__472"></a>5. 异常处理</h4> 
<p>遇到网络问题（如：DNS查询失败、拒绝连接等）时，Requests会抛出一个ConnectionError 异常。</p> 
<p>遇到罕见的无效HTTP响应时，Requests则会抛出一个 HTTPError 异常。</p> 
<p>若请求超时，则抛出一个 Timeout 异常。</p> 
<p>若请求超过了设定的最大重定向次数，则会抛出一个 TooManyRedirects 异常。</p> 
<p>所有Requests显式抛出的异常都继承自 requests.exceptions.RequestException 。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9cf633acc78633777aca36d068e05456/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">字节跳动青训营--前端day5</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/bb92352a331f6c92a0c01a8577552e19/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">PCIE物理层、数据链路层与物理层、Zynq的优势及应用小结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>