<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQL中EXISTS的用法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SQL中EXISTS的用法" />
<meta property="og:description" content="EXISTS 指定一个子查询，检测行的存在。 语法 EXISTS subquery 参数 subquery 是一个受限的 SELECT 语句 (不允许有 COMPUTE 子句和 INTO 关键字)。有关更多信息，请参见 SELECT 中有关子查询的讨论。 结果类型 Boolean 结果值 如果子查询包含行，则返回 TRUE。 示例 A. 在子查询中使用 NULL 仍然返回结果集 这个例子在子查询中指定 NULL，并返回结果集，通过使用 EXISTS 仍取值为 TRUE。 USE Northwind
GO
SELECT CategoryName
FROM Categories
WHERE EXISTS (SELECT NULL)
ORDER BY CategoryName ASC
GO
B. 比较使用 EXISTS 和 IN 的查询 这个例子比较了两个语义类似的查询。第一个查询使用 EXISTS 而第二个查询使用 IN。注意两个查询返回相同的信息。 USE pubs
GO
SELECT DISTINCT pub_name
FROM publishers
WHERE EXISTS
(SELECT *" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/86576d5fa778c09d2f12285cb4fb9621/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2005-07-13T15:43:00+08:00" />
<meta property="article:modified_time" content="2005-07-13T15:43:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQL中EXISTS的用法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <h2><a name="_exists"></a>EXISTS</h2> 
 <br>指定一个子查询，检测行的存在。 
 <br> 
 <h6>语法</h6> 
 <br>EXISTS 
 <i>subquery</i> 
 <br> 
 <h6>参数</h6> 
 <i>subquery</i> 
 <br> 
 <p class="indent">是一个受限的 SELECT 语句 (不允许有 COMPUTE 子句和 INTO 关键字)。有关更多信息，请参见 <a class="POPUP"><u>SELECT</u></a> 中有关子查询的讨论。 <br></p> 
 <h6>结果类型</h6> 
 <br>Boolean 
 <br> 
 <h6>结果值</h6> 
 <br>如果子查询包含行，则返回 TRUE。 
 <br> 
 <h6>示例</h6> 
 <h6><span style="font-size:10pt;">A. 在子查询中使用 NULL 仍然返回结果集</span></h6> 
 <br>这个例子在子查询中指定 NULL，并返回结果集，通过使用 EXISTS 仍取值为 TRUE。 
 <pre><code>USE Northwind<br>GO<br>SELECT CategoryName<br>FROM Categories<br>WHERE EXISTS (SELECT NULL)<br>ORDER BY CategoryName ASC<br>GO<br></code></pre> 
 <h6><span style="font-size:10pt;">B. 比较使用 EXISTS 和 IN 的查询</span></h6> 
 <br>这个例子比较了两个语义类似的查询。第一个查询使用 EXISTS 而第二个查询使用 IN。注意两个查询返回相同的信息。 
 <pre><code>USE pubs<br>GO<br>SELECT DISTINCT pub_name<br>FROM publishers<br>WHERE EXISTS<br>   (SELECT *<br>   FROM titles<br>   WHERE pub_id = publishers.pub_id<br>   AND type = \'business\')<br>GO<br><br>-- Or, using the IN clause:<br><br>USE pubs<br>GO<br>SELECT distinct pub_name<br>FROM publishers<br>WHERE pub_id IN<br>   (SELECT pub_id<br>   FROM titles<br>   WHERE type = \'business\')<br>GO<br></code></pre> 
 <br>下面是任一查询的结果集： 
 <pre><code>pub_name                                 <br>---------------------------------------- <br>Algodata Infosystems                     <br>New Moon Books                           <br><br>(2 row(s) affected)<br></code></pre> 
 <h6><span style="font-size:10pt;">C.比较使用 EXISTS 和 = ANY 的查询</span></h6> 
 <br>本示例显示查找与出版商住在同一城市中的作者的两种查询方法：第一种方法使用 = ANY，第二种方法使用 EXISTS。注意这两种方法返回相同的信息。 
 <pre><code>USE pubs<br>GO<br>SELECT au_lname, au_fname<br>FROM authors<br>WHERE exists<br>   (SELECT *<br>   FROM publishers<br>   WHERE authors.city = publishers.city)<br>GO<br><br>-- Or, using = ANY<br><br>USE pubs<br>GO<br>SELECT au_lname, au_fname<br>FROM authors<br>WHERE city = ANY<br>   (SELECT city<br>   FROM publishers)<br>GO<br></code></pre> 
 <br>下面是任一查询的结果集： 
 <pre><code>au_lname                                 au_fname             <br>---------------------------------------- -------------------- <br>Carson                                   Cheryl               <br>Bennet                                   Abraham              <br><br>(2 row(s) affected)<br></code></pre> 
 <h6><span style="font-size:10pt;">D.比较使用 EXISTS 和 IN 的查询</span></h6> 
 <br>本示例所示查询查找由位于以字母 B 开头的城市中的任一出版商出版的书名： 
 <pre><code>USE pubs<br>GO<br>SELECT title<br>FROM titles<br>WHERE EXISTS<br>   (SELECT *<br>   FROM publishers<br>   WHERE pub_id = titles.pub_id<br>   AND city LIKE \'B%\')<br>GO<br><br>-- Or, using IN:<br><br>USE pubs<br>GO<br>SELECT title<br>FROM titles<br>WHERE pub_id IN<br>   (SELECT pub_id<br>   FROM publishers<br>   WHERE city LIKE \'B%\')<br>GO<br></code></pre> 
 <br>下面是任一查询的结果集： 
 <pre><code>title                                                                            <br>------------------------------------------------------------------------ <br>The Busy Executive\'s Database Guide                                              <br>Cooking with Computers: Surreptitious Balance Sheets                             <br>You Can Combat Computer Stress!                                                  <br>Straight Talk About Computers                                                    <br>But Is It User Friendly?                                                         <br>Secrets of Silicon Valley                                                        <br>Net Etiquette                                                                    <br>Is Anger the Enemy?                                                              <br>Life Without Fear                                                                <br>Prolonged Data Deprivation: Four Case Studies                                    <br>Emotional Security: A New Algorithm                                              <br><br>(11 row(s) affected)<br></code></pre> 
 <h6><span style="font-size:10pt;">E. 使用 NOT EXISTS</span></h6> 
 <br>NOT EXISTS 的作用与 EXISTS 正相反。如果子查询没有返回行，则满足 NOT EXISTS 中的 WHERE 子句。本示例查找不出版商业书籍的出版商的名称： 
 <pre><code>USE pubs<br>GO<br>SELECT pub_name<br>FROM publishers<br>WHERE NOT EXISTS<br>   (SELECT *<br>   FROM titles<br>   WHERE pub_id = publishers.pub_id<br>   AND type = \'business\')<br>ORDER BY pub_name<br>GO<br></code></pre> 
 <br>下面是结果集： 
 <pre><code>pub_name                                 <br>---------------------------------------- <br>Binnet &amp; Hardley                         <br>Five Lakes Publishing                    <br>GGG&amp;G                                    <br>Lucerne Publishing                       <br>Ramona Publishers                        <br>Scootney Books                           <br><br>(6 row(s) affected)<br></code></pre> 
</div> 
<p>转载于:https://www.cnblogs.com/ghost527/archive/2005/07/13/192169.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c8253ba724455961cd3bc2fa7165a51a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">从SQL Server中读写大数据列。</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d945c75ff819ffebeb1d2557de259754/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">磁盘碎片原理分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>