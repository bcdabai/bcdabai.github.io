<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python机器学习：一元回归 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python机器学习：一元回归" />
<meta property="og:description" content="→ \rightarrow →回归效果评价
🌕 一元回归 一元回归主要研究一个自变量和一个因变量之间的关系，而这个自变量和因变量之间的关系又可分为线性回归和非线性回归。
⭐️ 一元线性回归分析两个变量之间的线性关系，如 y = k x &#43; b y=kx&#43;b y=kx&#43;b中 x x x和 y y y就是线性关系。
⭐️ 一元非线性回归分析两个变量之间的非线性关系，如指数关系、对数关系等。
🌗 一元线性回归 下面用Iris数据集中的PetalLengthCm和PetalWidthCm两个变量来建立一元线性回归模型。
在建立模型前，我们要先知道一元线性回归分析法的预测模型： y = a x &#43; b y=ax&#43;b y=ax&#43;b，我们要求的就是参数a和b，可以由下列公式求得：
a = n ∑ x i y i − ∑ x i ∑ y i n ∑ x i 2 − ( ∑ x i ) 2 a = \frac{n\sum x_iy_i-\sum x_i\sum y_i}{n\sum x_i^2-(\sum x_i)^2} a=n∑xi2​−(∑xi​)2n∑xi​yi​−∑xi​∑yi​​" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e266da9bd2ca128634fc768377891a74/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-26T23:22:08+08:00" />
<meta property="article:modified_time" content="2023-01-26T23:22:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python机器学习：一元回归</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          → 
         
        
       
         \rightarrow 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.3669em;"></span><span class="mrel">→</span></span></span></span></span><a href="http://t.csdn.cn/DkdyR" rel="nofollow">回归效果评价</a></p> 
</blockquote> 
<h2><a id="full_moon__1"></a>🌕 一元回归</h2> 
<p>一元回归主要研究一个自变量和一个因变量之间的关系，而这个自变量和因变量之间的关系又可分为<font color="red">线性回归</font>和<font color="red">非线性回归</font>。</p> 
<p>⭐️ 一元线性回归分析两个变量之间的线性关系，如<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         y 
        
       
         = 
        
       
         k 
        
       
         x 
        
       
         + 
        
       
         b 
        
       
      
        y=kx+b 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></span>中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         x 
        
       
      
        x 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         y 
        
       
      
        y 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span></span></span></span>就是线性关系。<br> ⭐️ 一元非线性回归分析两个变量之间的非线性关系，如指数关系、对数关系等。</p> 
<h3><a id="last_quarter_moon__7"></a>🌗 一元线性回归</h3> 
<p>下面用<a href="https://download.csdn.net/download/weixin_62917800/87390387?spm=1001.2014.3001.5503">Iris数据集</a>中的PetalLengthCm和PetalWidthCm两个变量来建立一元线性回归模型。</p> 
<p>在建立模型前，我们要先知道一元线性回归分析法的预测模型：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         y 
        
       
         = 
        
       
         a 
        
       
         x 
        
       
         + 
        
       
         b 
        
       
      
        y=ax+b 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></span>，我们要求的就是参数a和b，可以由下列公式求得：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          a 
         
        
          = 
         
         
          
          
            n 
           
          
            ∑ 
           
           
           
             x 
            
           
             i 
            
           
           
           
             y 
            
           
             i 
            
           
          
            − 
           
          
            ∑ 
           
           
           
             x 
            
           
             i 
            
           
          
            ∑ 
           
           
           
             y 
            
           
             i 
            
           
          
          
          
            n 
           
          
            ∑ 
           
           
           
             x 
            
           
             i 
            
           
             2 
            
           
          
            − 
           
          
            ( 
           
          
            ∑ 
           
           
           
             x 
            
           
             i 
            
           
           
           
             ) 
            
           
             2 
            
           
          
         
        
       
         a = \frac{n\sum x_iy_i-\sum x_i\sum y_i}{n\sum x_i^2-(\sum x_i)^2} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.3899em; vertical-align: -0.9629em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.7959em;"><span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span class="" style="top: -3.0448em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2769em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mopen">(</span><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.9629em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span><br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          b 
         
        
          = 
         
         
          
          
            ∑ 
           
           
           
             y 
            
           
             i 
            
           
          
         
           n 
          
         
        
          − 
         
        
          a 
         
         
          
          
            ∑ 
           
           
           
             x 
            
           
             i 
            
           
          
         
           n 
          
         
        
       
         b = \frac{\sum y_i}{n}-a\frac{\sum x_i}{n} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.113em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 2.113em; vertical-align: -0.686em;"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.427em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></p> 
<h4><a id="new_moon__13"></a>🌑 第一种</h4> 
<blockquote> 
 <p>原谅我只在这里自己实现求回归方程，因为其它的太难了0.0</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
<span class="token comment"># 中文显示问题</span>
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> matplotlib
matplotlib<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>
sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>font<span class="token operator">=</span><span class="token string">"Kaiti"</span><span class="token punctuation">,</span>style<span class="token operator">=</span><span class="token string">"ticks"</span><span class="token punctuation">,</span>font_scale<span class="token operator">=</span><span class="token number">1.4</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">add_up</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>               <span class="token comment"># 累加函数</span>
    <span class="token builtin">sum</span> <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">sum</span> <span class="token operator">+=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token builtin">sum</span>

<span class="token keyword">def</span> <span class="token function">cal_a</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>                 <span class="token comment"># 求a</span>
    a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">*</span> add_up<span class="token punctuation">(</span>x <span class="token operator">*</span> y<span class="token punctuation">)</span> <span class="token operator">-</span> add_up<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">*</span> add_up<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">*</span> add_up<span class="token punctuation">(</span>x <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> add_up<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> a

<span class="token keyword">def</span> <span class="token function">cal_b</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>               <span class="token comment"># 求b</span>
    b <span class="token operator">=</span> add_up<span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">-</span> a <span class="token operator">*</span> add_up<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token keyword">return</span> b

a <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"D:/Pycharm/MachineLearning/program/data/chap2/Iris.csv"</span><span class="token punctuation">)</span>	<span class="token comment"># 读取数据</span>
x <span class="token operator">=</span> a<span class="token punctuation">.</span>PetalLengthCm		<span class="token comment"># 读取x的数据</span>
y <span class="token operator">=</span> a<span class="token punctuation">.</span>PetalWidthCm		<span class="token comment"># 读取y的数据</span>
a <span class="token operator">=</span> cal_a<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>			<span class="token comment"># 计算a</span>
b <span class="token operator">=</span> cal_b<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>a<span class="token punctuation">)</span>		<span class="token comment"># 计算b</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">)</span>		<span class="token comment"># 原始数据的点</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>a <span class="token operator">*</span> x <span class="token operator">+</span> b<span class="token punctuation">,</span><span class="token string">"r-"</span><span class="token punctuation">,</span>linewidth <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>	<span class="token comment"># 预测的模型</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"PetalWidthCm"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"PetalLengthCm"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"一元线性回归模拟拟合曲线"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c3/27/CjdLUiHB_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/6d/8d/vjTmGJTj_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="new_moon__57"></a>🌑 第二种</h4> 
<p>现在我们再来使用python花里胡哨的包来实现一下：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> statsmodels<span class="token punctuation">.</span>formula<span class="token punctuation">.</span>api <span class="token keyword">as</span> smf

<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> matplotlib
matplotlib<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>
sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>font<span class="token operator">=</span><span class="token string">"Kaiti"</span><span class="token punctuation">,</span>style<span class="token operator">=</span><span class="token string">"ticks"</span><span class="token punctuation">,</span>font_scale<span class="token operator">=</span><span class="token number">1.4</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"D:/Pycharm/MachineLearning/program/data/chap2/Iris.csv"</span><span class="token punctuation">)</span>
model <span class="token operator">=</span> smf<span class="token punctuation">.</span>ols<span class="token punctuation">(</span><span class="token string">"PetalWidthCm~PetalLengthCm"</span><span class="token punctuation">,</span>data <span class="token operator">=</span> data<span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/99/e6/g3Zm4RuX_o.png" alt="在这里插入图片描述"><br> 图中红圈部分就是我们之前求的a和b。</p> 
<p>针对于回归模型的残差，可以使用Q-Q图来检验是否服从正态分布（关于Q-Q图是什么，可以看一下我这篇博客<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         → 
        
       
      
        \rightarrow 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.3669em;"></span><span class="mrel">→</span></span></span></span></span><a href="http://t.csdn.cn/mgAbF" rel="nofollow">假设检验</a>）。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> statsmodels<span class="token punctuation">.</span>formula<span class="token punctuation">.</span>api <span class="token keyword">as</span> smf
<span class="token keyword">import</span> statsmodels<span class="token punctuation">.</span>api <span class="token keyword">as</span> sm

<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> matplotlib
matplotlib<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>
sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>font<span class="token operator">=</span><span class="token string">"Kaiti"</span><span class="token punctuation">,</span>style<span class="token operator">=</span><span class="token string">"ticks"</span><span class="token punctuation">,</span>font_scale<span class="token operator">=</span><span class="token number">1.4</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"D:/Pycharm/MachineLearning/program/data/chap2/Iris.csv"</span><span class="token punctuation">)</span>
model <span class="token operator">=</span> smf<span class="token punctuation">.</span>ols<span class="token punctuation">(</span><span class="token string">"PetalWidthCm~PetalLengthCm"</span><span class="token punctuation">,</span>data <span class="token operator">=</span> data<span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>                      <span class="token comment"># 将画布分为一行两列，现在对从上到下从左到右第一部分进行绘图</span>
plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>model<span class="token punctuation">.</span>resid<span class="token punctuation">,</span>bins <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">)</span>         <span class="token comment"># 绘制直方图</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"回归残差分布直方图"</span><span class="token punctuation">)</span>
ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>             <span class="token comment"># 现在对第二部分进行绘图</span>
sm<span class="token punctuation">.</span>qqplot<span class="token punctuation">(</span>model<span class="token punctuation">.</span>resid<span class="token punctuation">,</span>line <span class="token operator">=</span> <span class="token string">"q"</span><span class="token punctuation">,</span>ax <span class="token operator">=</span> ax<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"回归残差Q-Q图"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ea/4e/h8gQSwSN_o.png" alt="在这里插入图片描述"><br> 从上图可知，回归模型的拟合残差值符合正态分布。</p> 
<p>针对获得的回归模型，可以使用<font color="red">predict()函数</font>对新的数据进行预测：</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> statsmodels<span class="token punctuation">.</span>formula<span class="token punctuation">.</span>api <span class="token keyword">as</span> smf
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> matplotlib
matplotlib<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>
sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>font<span class="token operator">=</span><span class="token string">"Kaiti"</span><span class="token punctuation">,</span>style<span class="token operator">=</span><span class="token string">"ticks"</span><span class="token punctuation">,</span>font_scale<span class="token operator">=</span><span class="token number">1.4</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"D:/Pycharm/MachineLearning/program/data/chap2/Iris.csv"</span><span class="token punctuation">)</span>
model <span class="token operator">=</span> smf<span class="token punctuation">.</span>ols<span class="token punctuation">(</span><span class="token string">"PetalWidthCm~PetalLengthCm"</span><span class="token punctuation">,</span>data <span class="token operator">=</span> data<span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span>

X <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span>step <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"PetalLengthCm"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Y <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
data<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind <span class="token operator">=</span> <span class="token string">"scatter"</span><span class="token punctuation">,</span>x <span class="token operator">=</span> <span class="token string">"PetalLengthCm"</span><span class="token punctuation">,</span>y <span class="token operator">=</span> <span class="token string">"PetalWidthCm"</span><span class="token punctuation">,</span>c <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">,</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>	<span class="token comment"># 绘制原始数据</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span><span class="token string">"r-"</span><span class="token punctuation">,</span>linewidth <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>	<span class="token comment"># 绘制回归模型</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"一元线性回归模型拟合曲线"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/1a/db/glL8pjb3_o.png" alt="在这里插入图片描述"><br> 可以看到，上图跟第一种方法绘制出来的图是一样的，只是横纵坐标的区间不一样。</p> 
<h3><a id="last_quarter_moon__128"></a>🌗 一元非线性回归</h3> 
<p>下面读取一组<a href="https://download.csdn.net/download/weixin_62917800/87395810">非线性数据</a>，来进行操作。<br> 这个数据部分内容如下：<br> <img src="https://images2.imgbox.com/2e/6c/TyK84heA_o.png" alt="在这里插入图片描述"><br> 因为它是非线性的，所以我们先绘制一个散点图，看看它比较符合哪种非线性的形式。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt

<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> matplotlib
matplotlib<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>
sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>font<span class="token operator">=</span><span class="token string">"Kaiti"</span><span class="token punctuation">,</span>style<span class="token operator">=</span><span class="token string">"ticks"</span><span class="token punctuation">,</span>font_scale<span class="token operator">=</span><span class="token number">1.4</span><span class="token punctuation">)</span>

data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"D:/Pycharm/MachineLearning/program/data/chap5/xydata.csv"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>data<span class="token punctuation">.</span>x<span class="token punctuation">,</span>data<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token string">"ro"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/30/c3/PjwV1MZc_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="new_moon__149"></a>🌑 第一种分析</h4> 
<p>仔细一看，好像还挺符合指数关系的，那么我们还是先给出它的非线性预测模型：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         y 
        
       
         = 
        
       
         a 
        
        
        
          e 
         
         
         
           − 
          
         
           b 
          
         
           x 
          
         
        
       
         + 
        
       
         c 
        
       
      
        y=ae^{-bx}+c 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9324em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8491em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span>。因为这个模型的参数比较多且难以计算，在这我们可以通过<font color="red">curve_fit()函数</font>利用数据对其进行<font color="red">参数估计</font>来获取预测模型的参数值。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>optimize <span class="token keyword">import</span> curve_fit

<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> matplotlib
matplotlib<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>
sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>font<span class="token operator">=</span><span class="token string">"Kaiti"</span><span class="token punctuation">,</span>style<span class="token operator">=</span><span class="token string">"ticks"</span><span class="token punctuation">,</span>font_scale<span class="token operator">=</span><span class="token number">1.4</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">func</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> a <span class="token operator">*</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>b <span class="token operator">*</span> x<span class="token punctuation">)</span> <span class="token operator">+</span> c

data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"D:/Pycharm/MachineLearning/program/data/chap5/xydata.csv"</span><span class="token punctuation">)</span>

popt<span class="token punctuation">,</span>pcov <span class="token operator">=</span> curve_fit<span class="token punctuation">(</span>func<span class="token punctuation">,</span>data<span class="token punctuation">.</span>x<span class="token punctuation">,</span>data<span class="token punctuation">.</span>y<span class="token punctuation">)</span>	<span class="token comment"># 将预测模型的函数传给curve_fit</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"a,b,c的估计值值为："</span><span class="token punctuation">,</span>popt<span class="token punctuation">)</span>
</code></pre> 
<p>⭐️ popt：是一个数组，存有参数的最佳值，以使得平方残差之和最小。<br> ⭐️ pcov：是一个二维阵列，popt的估计协方差。<br> <img src="https://images2.imgbox.com/24/17/qWMl3DHz_o.png" alt="在这里插入图片描述"><br> 于是我们可以得到这个曲线的回归方程：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          y 
         
        
          = 
         
        
          − 
         
        
          0.1947 
         
         
         
           e 
          
          
          
            − 
           
          
            0.1779 
           
          
            x 
           
          
         
        
          + 
         
        
          0.6524 
         
        
       
         y=-0.1947e^{-0.1779x}+0.6524 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9474em; vertical-align: -0.0833em;"></span><span class="mord">−</span><span class="mord">0.1947</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">0.1779</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0.6524</span></span></span></span></span></span><br> 得到回归方程后，我们就可以将其可视化，分析拟合曲线与原始数据之间的关系。<br> ⭐️ plt.hlines()：画一条水平线，<font color="red">参数y</font>是控制水平线的位置，<font color="red">参数xmin</font>是水平线的起始位置，<font color="red">参数xmax</font>是水平线的结束位置。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>optimize <span class="token keyword">import</span> curve_fit
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt

<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> matplotlib
matplotlib<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">False</span>
sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>font<span class="token operator">=</span><span class="token string">"Kaiti"</span><span class="token punctuation">,</span>style<span class="token operator">=</span><span class="token string">"ticks"</span><span class="token punctuation">,</span>font_scale<span class="token operator">=</span><span class="token number">1.4</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">func</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> a <span class="token operator">*</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>b <span class="token operator">*</span> x<span class="token punctuation">)</span> <span class="token operator">+</span> c

data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"D:/Pycharm/MachineLearning/program/data/chap5/xydata.csv"</span><span class="token punctuation">)</span>
popt<span class="token punctuation">,</span>pcov <span class="token operator">=</span> curve_fit<span class="token punctuation">(</span>func<span class="token punctuation">,</span>data<span class="token punctuation">.</span>x<span class="token punctuation">,</span>data<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
a <span class="token operator">=</span> popt<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
b <span class="token operator">=</span> popt<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
c <span class="token operator">=</span> popt<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
fit_y <span class="token operator">=</span> func<span class="token punctuation">(</span>data<span class="token punctuation">.</span>x<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span>        <span class="token comment"># 求得回归方程中的y</span>
res <span class="token operator">=</span> fit_y <span class="token operator">-</span> data<span class="token punctuation">.</span>y              <span class="token comment"># 回归方程中的y减去原始数据的y为残差</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token comment"># 开始画第一个图</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>data<span class="token punctuation">.</span>x<span class="token punctuation">,</span>data<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token string">"ro"</span><span class="token punctuation">,</span>label <span class="token operator">=</span> <span class="token string">"原始数据"</span><span class="token punctuation">)</span>     <span class="token comment"># 画原始数据</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>data<span class="token punctuation">.</span>x<span class="token punctuation">,</span>fit_y<span class="token punctuation">,</span><span class="token string">"b-"</span><span class="token punctuation">,</span>linewidth <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>label <span class="token operator">=</span> <span class="token string">"指数函数"</span><span class="token punctuation">)</span>      <span class="token comment"># 画回归方程</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment"># 一个小格子，表明圆点代表原始数据，线条代表指数函数</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"拟合效果"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>      <span class="token comment"># 开始画第二个图</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>res<span class="token punctuation">,</span><span class="token string">"ro"</span><span class="token punctuation">)</span>      <span class="token comment"># 绘制残差点</span>
plt<span class="token punctuation">.</span>hlines<span class="token punctuation">(</span>y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>xmin <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>xmax <span class="token operator">=</span> <span class="token number">41</span><span class="token punctuation">,</span>linewidth <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># 画一条水平线</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"拟合残差大小"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4d/e1/rITi50Nw_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="new_moon__211"></a>🌑 第二种分析</h4> 
<p>同样，针对前面的非线性数据，它的可视化图像如下；<br> <img src="https://images2.imgbox.com/57/de/5MgWhVIt_o.png" alt="在这里插入图片描述"><br> 有没有这样一种可能，它的变化趋势接近于<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         y 
        
       
         = 
        
       
         a 
        
        
        
          x 
         
        
          2 
         
        
       
         + 
        
       
         b 
        
       
         x 
        
       
         + 
        
       
         c 
        
       
      
        y=ax^2+bx+c 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8974em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span>呢？现在我们就来试一下看。</p> 
<blockquote> 
 <p>因为只需改一下func中的内容即可，这里就不放全部代码了。</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">func</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">return</span> a <span class="token operator">*</span> x <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">+</span> b <span class="token operator">*</span> x <span class="token operator">+</span> c
</code></pre> 
<p><img src="https://images2.imgbox.com/a1/f6/Bk6TXgRj_o.png" alt="在这里插入图片描述"><br> 得到的回归方程为：<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          y 
         
        
          = 
         
        
          − 
         
        
          0 
         
        
          , 
         
        
          000978 
         
         
         
           x 
          
         
           2 
          
         
        
          + 
         
        
          0.02748 
         
        
          x 
         
        
          + 
         
        
          0.45396 
         
        
       
         y=-0,000978x^2+0.02748x+0.45396 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0585em; vertical-align: -0.1944em;"></span><span class="mord">−</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">000978</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">0.02748</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0.45396</span></span></span></span></span></span><br> 下面我们再将其可视化来分析拟合曲线与原始数据之间的关系。<br> <img src="https://images2.imgbox.com/b2/36/09MTKADw_o.png" alt="在这里插入图片描述"><br> 对比两次的可视化图可以发现，使用二次函数的拟合效果没有使用指数函数的拟合效果好。</p> 
<p>所以对于一元回归来说，要得到它的回归方程，我们可以先定义一个方程，然后利用<font color="red">curve_fit()函数</font>进行方程的拟合，求得参数的值，最后再带入我们预先考虑好的模型里就能得到回归方程了，这是最简单的一种。当然也可以自己用代码去实现这个功能0.0，不过对于我来说难度就很大了，还需多多努力！！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b6f16e23f7272105f8027325da0e8ed4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于Windows客户端渗透</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fde270c2aaee2b1ffcc2cbe2b104d18c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C语言进阶——文件管理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>