<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#中keybd_event 用法 模拟键盘鼠标按键 打印 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#中keybd_event 用法 模拟键盘鼠标按键 打印" />
<meta property="og:description" content="Windows提供了一个模拟键盘API函数Keybd_event（），使用该函数可以相应的屏蔽键盘的动作。Keybd_event（）函数能触发一个按键事件，也就是说会产生一个WM_KEYDOWN或WM_KEYUP消息。该函数原型如下： VOID keybd_event(
BYTE bVk, // virtual-key code
BYTE bScan, // hardware scan code
DWORD dwFlags, // flags specifying various function options
DWORD dwExtraInfo // additional data associated with keystroke
);　从上述原型可以看出，Keybd_event（）共有四个参数。 第一个为按键的虚拟键值，如回车键为vk_return,tab键为vk_tab。 第二个参数为扫描码，一般不用设置，用0代替就行。 第三个参数为选项标志，如果为keydown则置0即可，如果为keyup则设成&#34;KEYEVENTF_KEYUP&#34; 或是 &#34;0x2&#34;。 第四个参数一般也是置0即可。&#39;A&#39;的虚拟键值为65，所以可以用如下代码实现模拟按下&#39;A&#39;键， keybd_event(65,0,0,0); keybd_event(65,0,KEYEVENTF_KEYUP,0); Windows还提供了一个API函数mouse_event，可以模拟一次鼠标事件，比如左键单击、双击和右键单击等。 mouse_event函数原型如下： VOID mouse_event(
DWORD dwFlags, // flags specifying various motion/click variants
DWORD dx, // horizontal mouse position or position change
DWORD dy, // vertical mouse position or position change" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1837448530ac5112233ec6145666d6f8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-03-10T10:07:38+08:00" />
<meta property="article:modified_time" content="2016-03-10T10:07:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#中keybd_event 用法 模拟键盘鼠标按键 打印</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    Windows提供了一个模拟键盘API函数Keybd_event（），使用该函数可以相应的屏蔽键盘的动作。Keybd_event（）函数能触发一个按键事件，也就是说会产生一个WM_KEYDOWN或WM_KEYUP消息。该函数原型如下： 
<br>　　 
<pre><code class="language-c#">VOID keybd_event(<br>　　    BYTE bVk, // virtual-key code<br>　　    BYTE bScan, // hardware scan code<br>　　    DWORD dwFlags, // flags specifying various function options<br>　　    DWORD dwExtraInfo // additional data associated with keystroke<br>　　);</code></pre>　　 
<br>从上述原型可以看出，Keybd_event（）共有四个参数。 
<br>第一个为按键的虚拟键值，如回车键为vk_return,tab键为vk_tab。 
<br>第二个参数为扫描码，一般不用设置，用0代替就行。 
<br>第三个参数为选项标志，如果为keydown则置0即可，如果为keyup则设成"KEYEVENTF_KEYUP" 或是 "0x2"。 
<br>第四个参数一般也是置0即可。'A'的虚拟键值为65，所以可以用如下代码实现模拟按下'A'键， 
<br>　　keybd_event(65,0,0,0); 
<br>　　keybd_event(65,0,KEYEVENTF_KEYUP,0); 
<br> 
<br>Windows还提供了一个API函数mouse_event，可以模拟一次鼠标事件，比如左键单击、双击和右键单击等。 mouse_event函数原型如下： 
<br> 
<pre><code class="language-c#">　　VOID mouse_event(<br>　　    DWORD dwFlags, // flags specifying various motion/click variants<br>　　    DWORD dx, // horizontal mouse position or position change<br>　　    DWORD dy, // vertical mouse position or position change<br>　　    DWORD dwData, // amount of wheel movement<br>　　    DWORD dwExtraInfo<br>　　// 32 bits of application-defined information<br>　　);</code></pre>　　 
<br>第一个参数为代表所要模拟的鼠标消息，为MOUSEEVENTF_LEFTDOWN时表示左键按下，为 MOUSEEVENTF_LEFTUP表示左键松开。一般情况下，dwFlags取值如下： 
<br>　　MOUSEEVENTF_MOVE 移动鼠标 
<br>　　MOUSEEVENTF_LEFTDOWN 模拟鼠标左键按下 
<br>　　MOUSEEVENTF_LEFTUP 模拟鼠标左键抬起 
<br>　　MOUSEEVENTF_RIGHTDOWN 模拟鼠标右键按下 
<br>　　MOUSEEVENTF_RIGHTUP 模拟鼠标右键抬起 
<br>　　MOUSEEVENTF_MIDDLEDOWN 模拟鼠标中键按下 
<br>　　MOUSEEVENTF_MIDDLEUP 模拟鼠标中键抬起 
<br>　　MOUSEEVENTF_ABSOLUTE 标示是否采用绝对坐标 
<br>　　第二三个参数分别表示鼠标的位置坐标x,y，根据MOUSEEVENTF_ABSOLUTE标志，指定x，y方向的绝对位置或相对位置。第四五个参数并不重要，一般也可设为0,0。 
<br> 
<br>调用方法： 
<br> 
<pre><code class="language-c#">keybd_event((byte)Keys.LWin, 0, 0, 0);   //按下LWIN<br>     keybd_event((byte)Keys.D, 0, 0, 0);         //按下D<br>     keybd_event((byte)Keys.LWin, 0, 0x2, 0);   //释放LWIN<br>     keybd_event((byte)Keys.D, 0, 0x2, 0);        //释放D</code></pre> 
<br> 
<br>若在C#中改成这样： 
<br> 
<pre><code class="language-c#">[DllImport("user32.dll", EntryPoint = "keybd_event")]<br>        public static extern void keybd_event(<br>            byte bVk,    <br>            byte bScan,<br>            int dwFlags,  //这里是整数类型  0 为按下，2为释放<br>            int dwExtraInfo  //这里是整数类型 一般情况下设成为 0<br>        );</code></pre> 
<br>调用方法： 
<br> 
<pre><code class="language-c#">keybd_event((byte)Keys.LWin, 0, 0, 0);   //按下LWIN<br>    keybd_event((byte)Keys.D, 0, 0, 0);         //按下D<br>    keybd_event((byte)Keys.LWin, 0, 2, 0);   //释放LWIN<br>    keybd_event((byte)Keys.D, 0, 2, 0);        //释放D</code></pre> 
<br> 
<br> 
<br>附一个模拟浏览器上按Ctrl+P的c#代码 
<br> 
<pre><code class="language-c#">[DllImport("user32.dll", EntryPoint = "keybd_event")]<br>    public static extern void keybd_event(<br>        byte bVk,<br>        byte bScan,<br>        int dwFlags,  //这里是整数类型  0 为按下，2为释放<br>        int dwExtraInfo  //这里是整数类型 一般情况下设成为 0<br>    );<br><br>    protected void btn_dayin_Click(object sender, EventArgs e)<br>    {<!-- --><br>        keybd_event(17, 0, 0, 0);   //按下<br>        keybd_event(80, 0, 0, 0);   //按下<br>        keybd_event(17, 0, 2, 0);   //释放<br>        keybd_event(80, 0, 2, 0);   //释放<br>    }</code></pre> 
<br> 
<br>黑色头发：http://heisetoufa.iteye.com
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f86bfd4f191a5530b7b64194c6e12bf2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Logistic Regression 之基础知识准备</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cbb2988701dfd7a382a7268b3e68e95f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">实习生刚入职 两周总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>