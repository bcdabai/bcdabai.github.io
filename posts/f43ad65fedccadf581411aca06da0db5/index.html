<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MySQL数据库之多表查询 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MySQL数据库之多表查询" />
<meta property="og:description" content="文章目录 前言一、表的关联关系二、多表查询案例2.1 案例演示2.2 错误分析2.3 笛卡尔积 三、多表查询分类3.1 等值连接 vs 非等值连接3.2 自连接 vs 非自连接3.3 内连接 vs 外连接3.4 UNION的使用 四、左外连接和右外连接的区别4.1 数据集合不同4.2 运算方式不同4.3 语法不同(outer可省略) 五、SQL99 实现7中join操作5.1 7种SQL JOINS的实现5.2 NATURAL JOIN连接5.3 USING连接5.4 多表查询练习题 前言 记录B站尚硅谷康师傅MySQL数据库教学视频的多表查询部分学习笔记。
一、表的关联关系 1.1 表与表之间的数据记录有关系，现实世界中的各种实体以及实体之间的各种联系均用关系模型来表示。
1.2 四种关联关系：一对一关联、一对多关联、多对多关联、自我引用。
1.2.1 一对一关联
在实际的开发中应用不多，因为一对一可以创建成一张表。
举例：设计学生表 ：学号、姓名、手机号码、班级、系别、身份证号码、家庭住址、籍贯、紧急联系人、… 可以将学生表拆分为两个表，两个表的记录是一一对应关系，如下图所示。
基础信息表(常用信息)：学号、姓名、手机号码、班级、系别。
档案信息表(不常用信息)：学号、身份证号码、家庭住址、籍贯、紧急联系人、…
两种建表原则：
(1)外键唯一：主表的主键和从表的外键(唯一)，形成主外键关系，外键唯一。
(2)外键是主键：主表的主键和从表的主键，形成主外键关系。
1.2.2 一对多关系
常见实例场景： 客户表和订单表， 分类表和商品表， 部门表和员工表。
举例：
员工表：编号、姓名、…、所属部门
部门表：编号、名称、简介
一对多建表原则：在从表(多方)创建一个字段，字段作为外键指向主表(一方)的主键。如下图：一方(部门表主表)的部门 id 为 x1 对应多方(员工表从表) id 为 y1 与 y2 的员工，而两表之间通过从表oid相关联。
1.2.3 多对多关联
要表示多对多关系必须创建第三个表该表通常称为联接表，它将多对多关系划分为两个一对多关系。将这两个表的主键都插入到第三个表中。如下图：左表与中间表形成一对多的关系，右表与中间表也形成一对多的关系，整体形成多对多的关系。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f43ad65fedccadf581411aca06da0db5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-09T22:04:56+08:00" />
<meta property="article:modified_time" content="2022-09-09T22:04:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MySQL数据库之多表查询</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">前言</a></li><li><a href="#_5" rel="nofollow">一、表的关联关系</a></li><li><a href="#_52" rel="nofollow">二、多表查询案例</a></li><li><ul><li><a href="#21__55" rel="nofollow">2.1 案例演示</a></li><li><a href="#22__86" rel="nofollow">2.2 错误分析</a></li><li><a href="#23__102" rel="nofollow">2.3 笛卡尔积</a></li></ul> 
  </li><li><a href="#_125" rel="nofollow">三、多表查询分类</a></li><li><ul><li><a href="#31__vs__126" rel="nofollow">3.1 等值连接 vs 非等值连接</a></li><li><a href="#32__vs__145" rel="nofollow">3.2 自连接 vs 非自连接</a></li><li><a href="#33__vs__155" rel="nofollow">3.3 内连接 vs 外连接</a></li><li><a href="#34_UNION_211" rel="nofollow">3.4 UNION的使用</a></li></ul> 
  </li><li><a href="#_239" rel="nofollow">四、左外连接和右外连接的区别</a></li><li><ul><li><a href="#41__240" rel="nofollow">4.1 数据集合不同</a></li><li><a href="#42__243" rel="nofollow">4.2 运算方式不同</a></li><li><a href="#43_outer_248" rel="nofollow">4.3 语法不同(outer可省略)</a></li></ul> 
  </li><li><a href="#SQL99_7join_256" rel="nofollow">五、SQL99 实现7中join操作</a></li><li><ul><li><a href="#51__7SQL_JOINS_257" rel="nofollow">5.1 7种SQL JOINS的实现</a></li><li><a href="#52_NATURAL_JOIN_329" rel="nofollow">5.2 NATURAL JOIN连接</a></li><li><a href="#53_USING_347" rel="nofollow">5.3 USING连接</a></li><li><a href="#54__362" rel="nofollow">5.4 多表查询练习题</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>前言</h2> 
<p>记录B站尚硅谷康师傅MySQL数据库教学视频的多表查询部分学习笔记。</p> 
<h2><a id="_5"></a>一、表的关联关系</h2> 
<p>1.1 表与表之间的数据记录有关系，现实世界中的各种实体以及实体之间的各种联系均用关系模型来表示。</p> 
<p>1.2 四种关联关系：一对一关联、一对多关联、多对多关联、自我引用。<br> <strong>1.2.1 一对一关联</strong><br> 在实际的开发中应用不多，因为一对一可以创建成一张表。<br> 举例：设计学生表 ：学号、姓名、手机号码、班级、系别、身份证号码、家庭住址、籍贯、紧急联系人、… 可以将学生表拆分为两个表，两个表的记录是一一对应关系，如下图所示。<br> 基础信息表(常用信息)：学号、姓名、手机号码、班级、系别。<br> 档案信息表(不常用信息)：学号、身份证号码、家庭住址、籍贯、紧急联系人、…<br> <img src="https://images2.imgbox.com/ed/70/HPnmeHVk_o.png" alt="在这里插入图片描述"><br> 两种建表原则：<br> (1)外键唯一：主表的主键和从表的外键(唯一)，形成主外键关系，外键唯一。<br> (2)外键是主键：主表的主键和从表的主键，形成主外键关系。</p> 
<p><strong>1.2.2 一对多关系</strong><br> 常见实例场景： 客户表和订单表， 分类表和商品表， 部门表和员工表。<br> 举例：<br> 员工表：编号、姓名、…、所属部门<br> 部门表：编号、名称、简介<br> 一对多建表原则：在从表(多方)创建一个字段，字段作为外键指向主表(一方)的主键。如下图：一方(部门表主表)的部门 id 为 x1 对应多方(员工表从表) id 为 y1 与 y2 的员工，而两表之间通过从表oid相关联。<br> <img src="https://images2.imgbox.com/fd/97/5LQCQghS_o.png" alt="在这里插入图片描述"><br> <strong>1.2.3 多对多关联</strong><br> 要表示多对多关系必须创建第三个表该表通常称为联接表，它将多对多关系划分为两个一对多关系。将这两个表的主键都插入到第三个表中。如下图：左表与中间表形成一对多的关系，右表与中间表也形成一对多的关系，整体形成多对多的关系。<br> <img src="https://images2.imgbox.com/27/da/bRFjYJPo_o.png" alt="在这里插入图片描述"><br> <strong>举例1：学生 - 课程</strong><br> 学生信息表 ：一行代表一个学生的信息（学号、姓名、手机号码、班级、系别…）<br> 课程信息表 ：一行代表一个课程的信息（课程编号、授课老师、简介…）<br> 选课信息表 ：一样代表一个学生学号和课程编号，一个学生可以选多门课，一门课可以被多个学生选择。</p> 
<table><thead><tr><th>学号</th><th>课程编号</th></tr></thead><tbody><tr><td>1</td><td>1001</td></tr><tr><td>2</td><td>1001</td></tr><tr><td>1</td><td>1002</td></tr></tbody></table> 
<p><strong>举例2：产品 - 订单</strong><br> “订单”表和“产品”表有一种多对多的关系，这种关系是通过与“订单明细”表建立两个一对多关系来定义的。一个订单可以有多个产品，每个产品可以出现在多个订单中。<br> 产品表：产品表中的每条记录表示一个产品。<br> 订单表：订单表中的每条记录表示一个订单。<br> 订单明细表：每个产品可以与“订单”表中的多条记录对应，即出现在多个订单中。一个订单可以与产品表中的多条记录对应，即包含多个产品。<br> <img src="https://images2.imgbox.com/06/07/a2uWk6ic_o.png" alt="在这里插入图片描述"><br> <strong>举例3：用户 - 角色</strong><br> 多对多关系建表原则：需要创建第三张表，中间表中至少两个字段，这两个字段分别作为外键指向各自一方的主键。<br> <img src="https://images2.imgbox.com/d6/a7/W5LvzCKa_o.png" alt="在这里插入图片描述"><br> <strong>1.2.4 自我引用</strong><br> <img src="https://images2.imgbox.com/86/03/PKwAup59_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_52"></a>二、多表查询案例</h2> 
<p>多表查询：也称为关联查询指两个或更多个表一起完成查询操作。<br> 前提条件：这些一起查询的表之间是有关系的(一对一、一对多)，它们之间一定是有关联字段，这个关联字段可能建立了外键，也可能没有建立外键。比如：员工表和部门表，这两个表依靠部门编号进行关联。</p> 
<h3><a id="21__55"></a>2.1 案例演示</h3> 
<p><strong>2.1.1 案例1：</strong><br> <img src="https://images2.imgbox.com/d2/32/ydqEfcyw_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>从多个表中获取数据：查询员工名为 Abel 的人在哪个城市工作？</p> 
</blockquote> 
<p><strong>员工表 employees</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'Abel'</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/99/ef/R9nX5cQJ_o.png" alt="在这里插入图片描述"><br> <strong>部门表 departments</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> departments <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/cc/b5/g5uoX2ZY_o.png" alt="在这里插入图片描述"><br> <strong>位置表 locations</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> locations <span class="token keyword">WHERE</span> location_id <span class="token operator">=</span> <span class="token number">2500</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/37/66/ARpxW39o_o.png" alt="在这里插入图片描述"><br> 虽然最终查出来了名为 Abel 的员工的工作城市，但是用了三次 SQL 查询，考虑到查询性能及服务器性能此做法不是最优解，此时需要通过多表查询来达到目的。</p> 
<blockquote> 
 <p>反思：员工表，部门表，位置表连合成一张表查询更快，是否可行？</p> 
</blockquote> 
<pre><code class="prism language-java"> 答案是：可行但是不规范。
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>假设员工表里有<span class="token number">500</span>名员工，都是同个部门的那么员工表里存储的部门字段过于冗余。
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>假设有员工部门id为空则部门信息全为<span class="token keyword">null</span>，浪费表空间。
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>假设部门现在没有员工，虽有部门信息但是员工表字段全部为<span class="token keyword">null</span>，过于冗余。
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>表字段过多内存加载到磁盘数据交互次增多，IO次数增多影响查询性能。
</code></pre> 
<h3><a id="22__86"></a>2.2 错误分析</h3> 
<blockquote> 
 <p>案例：查询员工的id，姓名及其部门名称</p> 
</blockquote> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> department_name <span class="token keyword">FROM</span> employees<span class="token punctuation">,</span> departments<span class="token punctuation">;</span><span class="token number">2889</span>条记录
</code></pre> 
<p>查询结果：<br> <img src="https://images2.imgbox.com/f4/89/7kmnkSKL_o.png" alt="在这里插入图片描述"><br> 原因：两表连接查询未添加连接条件，产生笛卡尔积现象(拿着一表的某些字段去匹配另一张表所有记录)。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span> <span class="token comment">#输出107行 </span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>department_id<span class="token punctuation">)</span><span class="token keyword">FROM</span> departments<span class="token punctuation">;</span> <span class="token comment">#输出27行 </span>
<span class="token keyword">SELECT</span> <span class="token number">107</span><span class="token operator">*</span><span class="token number">27</span> <span class="token keyword">FROM</span> dual<span class="token punctuation">;</span><span class="token number">2889</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8f/5c/Uj159pwc_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="23__102"></a>2.3 笛卡尔积</h3> 
<p>笛卡尔乘积是一个数学运算。假设我有两个集合 X 和 Y，那么 X 和 Y 的笛卡尔积就是 X 和 Y 的所有可能组合，也就是第一个对象来自于 X，第二个对象来自于 Y 的所有可能。组合的个数即为两个集合中元素个数的乘积数。<br> <img src="https://images2.imgbox.com/9f/08/VpfOkC92_o.png" alt="在这里插入图片描述"><br> SQL92中，笛卡尔积也称为 交叉连接 ，英文是 CROSS JOIN 。在 SQL99 中也是使用 CROSS JOIN表示交叉连接。它的作用就是可以把任意表进行连接，即使这两张表不相关。</p> 
<p><strong><code>笛卡尔积的错误会在下面条件下产生：</code></strong></p> 
<blockquote> 
 <p>1.省略多个表的连接条件（或关联条件）<br> 2.连接条件（或关联条件）无效<br> 3.所有表中的所有行互相连接</p> 
</blockquote> 
<p>为了避免笛卡尔积， 可以在 WHERE 加入有效的连接条件。加入连接条件后，查询语法：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> table1<span class="token punctuation">.</span><span class="token keyword">column</span><span class="token punctuation">,</span> table2<span class="token punctuation">.</span><span class="token keyword">column</span> <span class="token keyword">FROM</span> table1<span class="token punctuation">,</span> table2 <span class="token keyword">WHERE</span> table1<span class="token punctuation">.</span>column1 <span class="token operator">=</span> table2<span class="token punctuation">.</span>column2<span class="token punctuation">;</span> <span class="token comment">#连接条件</span>
</code></pre> 
<p><strong>#案例：查询员工的id，姓名及其部门名称</strong></p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> department_name <span class="token keyword">FROM</span> employees<span class="token punctuation">,</span> departments <span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e7/af/9lsAoxT6_o.png" alt="在这里插入图片描述"><br> <strong>多表连接查询时，如果查询语句中出现了多个表都存在的字段，则必须指明此字段来源于哪张表。建议：从SQL优化的角度分析，建议多表查询时，每个字段都指明其所在的表及给表取别名</strong></p> 
<hr> 
<h2><a id="_125"></a>三、多表查询分类</h2> 
<h3><a id="31__vs__126"></a>3.1 等值连接 vs 非等值连接</h3> 
<p><strong>等值连接</strong>：多表查询语句中的连接条件使用的是等号。</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 等值连接：查询员工id部门id及位置id</span>
<span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>location_id 
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span> departments d 
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/7c/09/kCsfQZWM_o.png" alt="在这里插入图片描述"></p> 
<p><strong>非等值连接</strong>：多表查询语句中的连接条件使用的区间范围。</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 非等值连接：查询员工名员工薪资及薪资等级</span>
<span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>salary<span class="token punctuation">,</span>j<span class="token punctuation">.</span>grade_level
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>job_grades j
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>salary <span class="token operator">BETWEEN</span> j<span class="token punctuation">.</span>lowest_sal <span class="token operator">AND</span> j<span class="token punctuation">.</span>highest_sal<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d2/7d/9wp2IzdR_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="32__vs__145"></a>3.2 自连接 vs 非自连接</h3> 
<p><strong>自连接</strong>：b表自己与自己相连接。例子：查询员工id,员工姓名及其管理者的id和姓名。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> emp<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>emp<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>last_name
<span class="token keyword">FROM</span> employees emp <span class="token punctuation">,</span>employees mgr
<span class="token keyword">WHERE</span> emp<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> mgr<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/30/e0/HkwHG1ME_o.png" alt="在这里插入图片描述"><br> <strong>非自连接</strong>：a表与b表相连接，除了上面自连接的情况，本文使用的都是非自连接。</p> 
<h3><a id="33__vs__155"></a>3.3 内连接 vs 外连接</h3> 
<p>除了查询满足条件的记录以外，外连接还可以查询某一方不满足条件的记录。<br> <strong>内连接</strong>: 合并具有同一列的两个以上的表的行, 结果集中不包含一个表与另一个表不匹配的行(只查出匹配的数据)。如下SQL92语法例子：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>departments d
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>  <span class="token comment">#只有106条记录,员工id为178的未查询出来</span>
</code></pre> 
<p><strong>外连接</strong>: 两个表在连接过程中除了返回满足连接条件的行以外还返回左(或右)表中不满足条件的行，这种连接称为左(或右)外连接。没有匹配的行时, 结果表中相应的列为空(NULL)。<br> <strong>外连接的分类：左外连接、右外连接、满外连接。</strong><br> 如果是左外连接，则连接条件中左边的表也称为主表，右边的表称为从表。<br> 如果是右外连接，则连接条件中右边的表也称为主表，左边的表称为从表。<br> SQL92语法实现外连接：使用 + ----------MySQL不支持SQL92语法中外连接的写法！</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>departments d
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>#SQL99语法中使用 JOIN …ON 的方式实现多表的查询。这种方式也能解决外连接的问题。MySQL是支持此种方式的。SQL99语法如何实现多表的查询。<br> <strong>SQL99语法实现内连接：</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">#查询员工名和部门名</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">#查询员工名部门名和员工所在城市</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name<span class="token punctuation">,</span>city
<span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">JOIN</span> locations l
<span class="token keyword">ON</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>SQL99语法实现外连接：</strong></p> 
<pre><code class="prism language-sql"><span class="token comment">#左外连接：查询所有的员工的id,last_name,department_name信息</span>
<span class="token keyword">SELECT</span> employee<span class="token punctuation">.</span>id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> 
<p>查询到107条记录，不符合条件的员工也查询出来了，即使其部门id为null<br> <img src="https://images2.imgbox.com/dc/ca/haQXwFuy_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">#右外连接：查询员工名和部门名</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/53/12/Z306KQOu_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">#满外连接：mysql不支持FULL OUTER JOIN</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">FROM</span> employees e <span class="token keyword">FULL</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="34_UNION_211"></a>3.4 UNION的使用</h3> 
<p>合并查询结果 利用UNION关键字，可以给出多条SELECT语句，并将它们的结果组合成单个结果集。合并时两个表对应的列数和数据类型必须相同，并且相互对应。各个SELECT语句之间使用UNION或UNION ALL关键字分隔。</p> 
<pre><code class="prism language-sql">语法格式:
<span class="token keyword">SELECT</span> <span class="token keyword">column</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">FROM</span> table1 
<span class="token keyword">UNION</span> <span class="token punctuation">[</span><span class="token keyword">ALL</span><span class="token punctuation">]</span> 
<span class="token keyword">SELECT</span> <span class="token keyword">column</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">FROM</span> table2
</code></pre> 
<p>UNION操作符：返回两个查询的结果集的并集，去除重复记录。<br> <img src="https://images2.imgbox.com/36/8e/6JnZdJq2_o.png" alt="在这里插入图片描述"><br> UNION ALL操作符：返回两个查询的结果集的并集。对于两个结果集的重复部分，不去重。<br> <img src="https://images2.imgbox.com/3e/9a/K580H768_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>注意：执行UNION ALL语句时所需要的资源比UNION语句少。如果明确知道合并数据后的结果数据不存在重复数据，或者不需要去除重复的数据，则尽量使用UNION ALL语句，以提高数据查询的效率。</p> 
</blockquote> 
<p>举例：查询部门编号&gt;90或邮箱包含a的员工信息</p> 
<pre><code class="prism language-sql"><span class="token comment">#方式1 </span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> email <span class="token operator">LIKE</span> <span class="token string">'%a%'</span> <span class="token operator">OR</span> department_id<span class="token operator">&gt;</span><span class="token number">90</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">#方式2 </span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> email <span class="token operator">LIKE</span> <span class="token string">'%a%'</span>
<span class="token keyword">UNION</span> 
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> department_id<span class="token operator">&gt;</span><span class="token number">90</span><span class="token punctuation">;</span>
</code></pre> 
<h2><a id="_239"></a>四、左外连接和右外连接的区别</h2> 
<h3><a id="41__240"></a>4.1 数据集合不同</h3> 
<p>1.左外连接：是A和B的交集再并上A的所有数据。<br> 2.右外连接：是A和B的交集再并上B的所有数据。</p> 
<h3><a id="42__243"></a>4.2 运算方式不同</h3> 
<p><img src="https://images2.imgbox.com/e0/8c/wn8YEBfi_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>1.左外连接：其运算方式A左连接B的记录 = 图3公共部分记录集C＋表A记录集A1<br> 2.右外连接：其运算方式A右连接B的记录 = 图3公共部分记录集C＋表B记录集B1</p> 
</blockquote> 
<h3><a id="43_outer_248"></a>4.3 语法不同(outer可省略)</h3> 
<pre><code class="prism language-sql"><span class="token number">1.</span>左外连接：
<span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>column1<span class="token punctuation">,</span>a<span class="token punctuation">.</span>column2<span class="token punctuation">,</span>b<span class="token punctuation">.</span>column1 <span class="token keyword">FROM</span> a <span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>column3 <span class="token operator">=</span> b<span class="token punctuation">.</span>column3<span class="token punctuation">;</span>
<span class="token number">2.</span>右外连接：
<span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>column1<span class="token punctuation">,</span>a<span class="token punctuation">.</span>column2<span class="token punctuation">,</span>b<span class="token punctuation">.</span>column1 <span class="token keyword">FROM</span> a <span class="token keyword">right</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>column3 <span class="token operator">=</span> b<span class="token punctuation">.</span>column3<span class="token punctuation">;</span>
</code></pre> 
<h2><a id="SQL99_7join_256"></a>五、SQL99 实现7中join操作</h2> 
<h3><a id="51__7SQL_JOINS_257"></a>5.1 7种SQL JOINS的实现</h3> 
<p><img src="https://images2.imgbox.com/1d/e3/cTLD5SyA_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-sql"><span class="token comment">#中图：内连接 A∩B </span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">#左上图：左外连接 </span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">#右上图：右外连接 </span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">#左中图：A - A∩B </span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> 
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">#右中图：B-A∩B </span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> 
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">#左下图：满外连接 # 左中图 + 右上图 A∪B </span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> 
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span> 
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span> <span class="token comment">#没有去重操作，效率高 </span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql"><span class="token comment">#右下图 #左中图 + 右中图 A ∪B- A∩B 或者 (A - A∩B) ∪ （B - A∩B）</span>
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> 
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span> 
<span class="token keyword">UNION</span> <span class="token keyword">ALL</span> 
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> 
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span>
</code></pre> 
<h3><a id="52_NATURAL_JOIN_329"></a>5.2 NATURAL JOIN连接</h3> 
<p><strong>5.2.2 自然连接</strong><br> SQL99 在 SQL92 的基础上提供了一些特殊语法，比如 NATURAL JOIN 用来表示自然连接。我们可以把自然连接理解为 SQL92 中的等值连接。它会帮你自动查询两张连接表中所有相同的字段，然后进行等值连接 。</p> 
<pre><code class="prism language-sql">在SQL92标准中：
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> 
<span class="token operator">AND</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-sql">在 SQL99 中你可以写成：
<span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">NATURAL</span> <span class="token keyword">JOIN</span> departments d<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="53_USING_347"></a>5.3 USING连接</h3> 
<p>当我们进行连接的时候，SQL99还支持使用 USING 指定数据表里的同名字段进行等值连接。但是只能配合JOIN一起使用。比如：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">JOIN</span> departments d 
<span class="token keyword">USING</span> <span class="token punctuation">(</span>department_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>你能看出与自然连接 NATURAL JOIN 不同的是，USING 指定了具体的相同的字段名称，你需要在 USING的括号()中填入要指定的同名字段。同时使用 JOIN…USING 可以简化 JOIN ON 的等值连接。它与下面的 SQL 查询结果是相同的：</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees e <span class="token punctuation">,</span>departments d 
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="54__362"></a>5.4 多表查询练习题</h3> 
<p>(1)显示所有员工的姓名，部门号和部门名称。</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> department_name 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>
</code></pre> 
<p>(2)查询90号部门员工的job_id和90号部门的location_id</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> job_id<span class="token punctuation">,</span> location_id 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> 
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span>
</code></pre> 
<p>(3)选择所有有奖金的员工last_name, department_name, location_id, city</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>location_id<span class="token punctuation">,</span>l<span class="token punctuation">.</span>city 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> 
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> locations l 
<span class="token keyword">ON</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> 
<span class="token keyword">WHERE</span> commission_pct <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre> 
<p>(4)选择city在Toronto工作的员工last_name, job_id, department_id, department_name</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>department_name 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> 
<span class="token keyword">JOIN</span> locations l 
<span class="token keyword">ON</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> 
<span class="token keyword">WHERE</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>city<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token string">'Toronto'</span><span class="token punctuation">;</span>
</code></pre> 
<p>(5)查询员工所在的部门名称、部门地址、姓名、工作、工资其中员工所在部门的部门名为’Executive’</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span> l<span class="token punctuation">.</span>street_address<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>salary 
<span class="token keyword">FROM</span> employees e 
<span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id 
<span class="token keyword">JOIN</span> locations l 
<span class="token keyword">ON</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> 
<span class="token keyword">WHERE</span> department_name <span class="token operator">=</span> <span class="token string">'Executive'</span>
</code></pre> 
<p>(6)选择指定员工的姓名，员工号，以及他的管理者的姓名和员工号，结果类似于下面的格式:</p> 
<table><thead><tr><th>employees</th><th>Emp#</th><th>manager</th><th>Mgr#</th></tr></thead><tbody><tr><td>kochhar</td><td>101</td><td>king</td><td>100</td></tr></tbody></table> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> emp<span class="token punctuation">.</span>last_name employees<span class="token punctuation">,</span> emp<span class="token punctuation">.</span>employee_id <span class="token string">"Emp#"</span><span class="token punctuation">,</span> mgr<span class="token punctuation">.</span>last_name manager<span class="token punctuation">,</span> mgr<span class="token punctuation">.</span>employee_id <span class="token string">"Mgr#"</span> 
<span class="token keyword">FROM</span> employees emp 
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> employees mgr 
<span class="token keyword">ON</span> emp<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> mgr<span class="token punctuation">.</span>employee_id<span class="token punctuation">;</span>
</code></pre> 
<p>(7)查询哪些部门没有员工</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> department_id 
<span class="token keyword">FROM</span> departments d 
<span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span> 
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees e 
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> 
<span class="token punctuation">)</span>
</code></pre> 
<p>(8)查询哪个城市没有部门</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> l<span class="token punctuation">.</span>location_id<span class="token punctuation">,</span>l<span class="token punctuation">.</span>city 
<span class="token keyword">FROM</span> locations l 
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d 
<span class="token keyword">ON</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> 
<span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span>
</code></pre> 
<p>(9)查询部门名为 Sales 或 IT 的员工信息</p> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name 
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>departments d 
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> 
<span class="token operator">AND</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_name<span class="token punctuation">`</span></span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'Sales'</span><span class="token punctuation">,</span><span class="token string">'IT'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8f509d36e6b8a13dbea87979e2a90fe9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">rangenet_lib &amp;&amp; tensorRT8.** &amp;&amp; ubuntu20.04 &amp;&amp; suma&#43;&#43;</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ebca93d726fbffd09f6a9e6c1b9f983a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">android 串口通信</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>