<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>jmap使用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="jmap使用" />
<meta property="og:description" content="jmap 是 Java 虚拟机 (JVM) 中的一个命令行工具，用于生成堆转储。这个工具对于诊断内存问题、分析内存占用情况等非常有用。
jmap 官方文档 bash: jmap: command not found 命令找不到
# jmap -dump &lt;pid&gt; jmap -dump 137886 安装一下java-devel yum -y install java-devel 查看jmap jmap 官网截图
参数 &lt;no option&gt; 如果不使用任何选项，jmap命令将打印共享对象映射。对于目标JVM中加载的每个共享对象，将打印共享对象文件的起始地址、映射大小和完整路径。此行为类似于Oracle Solaris pmap实用程序。
-dump:[live,] format=b, file=filename 将hprof二进制格式的Java堆转储为filename。live子选项是可选的，但如果指定，则只转储堆中的活动对象。要浏览堆转储，可以使用jhat（1）命令读取生成的文件。
-finalizerinfo 打印有关等待完成的对象的信息。
-heap 打印所使用的垃圾收集、头配置和逐代堆使用情况的堆摘要。此外，还会打印出插入字符串的数量和大小。
-histo[:live] 打印堆的直方图。对于每个Java类，都会打印对象的数量、以字节为单位的内存大小和完全限定的类名。JVM内部类名以星号（*）前缀打印。如果指定了活动子选项，则只计算活动对象。
-clstats 打印Java堆的类加载程序统计信息。对于每个类加载器，都会打印其名称、活动程度、地址、父类加载器以及已加载的类的数量和大小。
-F 武力当pid没有响应时，将此选项与jmap-dump或jmap-histo选项一起使用。此模式不支持实时子选项。
-h 打印帮助消息。
-help 打印帮助消息。
-Jflag 将标志传递给运行jmap命令的Java虚拟机。
查看堆积在finalizer队列中的对象 jmap -histo 137886 jmap -clstats 137886 运行GC.class_stats命令时遇到了“requires -XX:&#43;UnlockDiagnosticVMOptions”的错误，那么你需要确保在启动Java应用程序时加入了-XX:&#43;UnlockDiagnosticVMOptions选项。
jmap -dump:format=b,file=tn1.hprof 137886 file=tn1.hprof 是保存文件" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c2b5eabcb4d3daf0586d144d98d6c1f8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-13T17:42:59+08:00" />
<meta property="article:modified_time" content="2024-01-13T17:42:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">jmap使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong><code>jmap</code> </strong>是 Java 虚拟机 (JVM) 中的一个命令行工具，用于生成堆转储。这个工具对于诊断内存问题、分析内存占用情况等非常有用。</p> 
<p></p> 
<h4><a class="link-info" href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/jmap.html" rel="nofollow" title="jmap 官方文档">jmap 官方文档</a></h4> 
<p></p> 
<h4>bash: jmap: command not found</h4> 
<p>命令找不到</p> 
<pre><code class="language-bash"># jmap -dump &lt;pid&gt;

 jmap -dump  137886</code></pre> 
<p><img alt="" height="88" src="https://images2.imgbox.com/c2/1e/Kt1L7bgx_o.png" width="900"></p> 
<p></p> 
<p></p> 
<h4>安装一下java-devel</h4> 
<pre><code> yum -y  install java-devel</code></pre> 
<p><img alt="" height="369" src="https://images2.imgbox.com/bb/95/kALmd0Vm_o.png" width="900"></p> 
<h4>查看jmap</h4> 
<pre><code> jmap</code></pre> 
<p><img alt="" height="488" src="https://images2.imgbox.com/92/c8/aDHvLQw6_o.png" width="900"></p> 
<p>官网截图</p> 
<p><img alt="" height="400" src="https://images2.imgbox.com/96/0d/f2RsS81C_o.png" width="900"></p> 
<h4>参数</h4> 
<p></p> 
<ul><li>&lt;no option&gt; </li></ul> 
<p>如果不使用任何选项，jmap命令将打印共享对象映射。对于目标JVM中加载的每个共享对象，将打印共享对象文件的起始地址、映射大小和完整路径。此行为类似于Oracle Solaris pmap实用程序。</p> 
<ul><li>-dump:[live,] format=b, file=filename</li></ul> 
<p>将hprof二进制格式的Java堆转储为filename。live子选项是可选的，但如果指定，则只转储堆中的活动对象。要浏览堆转储，可以使用jhat（1）命令读取生成的文件。</p> 
<ul><li>-finalizerinfo</li></ul> 
<p>打印有关等待完成的对象的信息。</p> 
<ul><li>-heap</li></ul> 
<p>打印所使用的垃圾收集、头配置和逐代堆使用情况的堆摘要。此外，还会打印出插入字符串的数量和大小。</p> 
<ul><li>-histo[:live]</li></ul> 
<p>打印堆的直方图。对于每个Java类，都会打印对象的数量、以字节为单位的内存大小和完全限定的类名。JVM内部类名以星号（*）前缀打印。如果指定了活动子选项，则只计算活动对象。</p> 
<ul><li>-clstats</li></ul> 
<p>打印Java堆的类加载程序统计信息。对于每个类加载器，都会打印其名称、活动程度、地址、父类加载器以及已加载的类的数量和大小。</p> 
<ul><li>-F</li></ul> 
<p>武力当pid没有响应时，将此选项与jmap-dump或jmap-histo选项一起使用。此模式不支持实时子选项。</p> 
<ul><li>-h</li></ul> 
<p>打印帮助消息。</p> 
<ul><li>-help</li></ul> 
<p>打印帮助消息。</p> 
<ul><li>-Jflag</li></ul> 
<p>将标志传递给运行jmap命令的Java虚拟机。</p> 
<p></p> 
<h4>查看堆积在finalizer队列中的对象</h4> 
<pre><code class="language-bash"> jmap -histo  137886</code></pre> 
<p><img alt="" height="479" src="https://images2.imgbox.com/d3/ba/89vCm6n3_o.png" width="900"></p> 
<p></p> 
<pre><code class="language-bash">jmap -clstats  137886</code></pre> 
<p><img alt="" height="86" src="https://images2.imgbox.com/e1/df/H0kKh5TB_o.png" width="900"></p> 
<p>运行<code>GC.class_stats</code>命令时遇到了“requires -XX:+UnlockDiagnosticVMOptions”的错误，那么你需要确保在启动Java应用程序时加入了<span style="color:#fe2c24;"><code>-XX:+UnlockDiagnosticVMOptions</code></span>选项。</p> 
<p></p> 
<pre><code class="language-bash"> jmap -dump:format=b,file=tn1.hprof  137886</code></pre> 
<p>file=tn1.hprof 是保存文件</p> 
<p><code>format=b</code>表示使用二进制格式输出堆转储。</p> 
<p>使用二进制格式的优点是，你可以将输出保存到一个文件中，并且稍后可以使用<code>jhat</code>工具来分析这个文件。这对于大型堆转储特别有用，因为文本格式可能会非常大并且难以处理。</p> 
<p><img alt="" height="448" src="https://images2.imgbox.com/9b/13/eca9BTXk_o.png" width="900"></p> 
<p><strong>打印堆的内存映射</strong></p> 
<pre><code class="language-bash"># jmap -histo:live &lt;pid&gt;

jmap -histo:live 137886</code></pre> 
<p><img alt="" height="479" src="https://images2.imgbox.com/f7/26/XTTuKjwC_o.png" width="900"></p> 
<p></p> 
<p></p> 
<hr> 
<hr> 
<hr> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/c0/68/gv0pJYFQ_o.jpg"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/55c707ac315510659ca1b174939b88e3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java应用CPU过高查找原因</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/36462211f649db3ef054612f34c95dcc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C# IOC 容器实战：KeyedService和生命周期</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>