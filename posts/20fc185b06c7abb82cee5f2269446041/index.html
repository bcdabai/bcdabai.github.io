<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>android Textview 使用之一：伸缩效果 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="android Textview 使用之一：伸缩效果" />
<meta property="og:description" content="android开发过程中，经常遇到Textview展示不完全的情况。 遇到此情况，通常的处理是： 方案一，Textview添加android:ellipsize属性，让展示不完的部分使用省略号代替。然后给Textview设置点击事件跳转到另一个Activity让其显示完全。 方案二，我们在很多应用中都能看到有向下的箭头或者“查看详情”的字样，点击后他会自动撑开，让TextView显示完整。
原来我们的项目里都是用的第一种方法，很显然，太不高大上了。今天找到了一种既简单又高大上的方法。
下面来看下Demo例子的收起效果，文本内容没有展示完全，使用省略号代替，提示“更多”和向下箭头标识，截图如下： 对于以上效果，实现思路如下：
1、设置Textview默认展示固定行，比如3行，内容展示不完全，在Textview尾部使用省略号代替。
xml文件内容为： &lt;LinearLayout android:layout_width=&#34;match_parent&#34; android:layout_height=&#34;wrap_content&#34; android:layout_marginLeft=&#34;15dp&#34; android:layout_marginRight=&#34;15dp&#34; android:layout_marginTop=&#34;15dp&#34;&gt; &lt;ImageView android:layout_width=&#34;20dp&#34; android:layout_height=&#34;20dp&#34; android:layout_gravity=&#34;left&#34; android:background=&#34;@drawable/ico_jianjie&#34;/&gt; &lt;TextView android:id=&#34;@&#43;id/tv_teamdetail_introduce&#34; android:layout_width=&#34;match_parent&#34; android:layout_height=&#34;wrap_content&#34; android:layout_marginLeft=&#34;10dp&#34; android:ellipsize=&#34;end&#34; android:maxLines=&#34;2&#34; android:singleLine=&#34;false&#34; android:textColor=&#34;@color/dark_grey&#34; android:textSize=&#34;@dimen/text_size_small&#34;/&gt; &lt;/LinearLayout&gt; &lt;LinearLayout android:id=&#34;@&#43;id/ll_teamdetail_good&#34; android:layout_width=&#34;match_parent&#34; android:layout_height=&#34;wrap_content&#34; android:layout_marginBottom=&#34;15dp&#34; android:layout_marginLeft=&#34;15dp&#34; android:layout_marginRight=&#34;15dp&#34; android:layout_marginTop=&#34;15dp&#34; android:orientation=&#34;horizontal&#34;&gt; &lt;ImageView android:layout_width=&#34;20dp&#34; android:layout_height=&#34;20dp&#34; android:layout_gravity=&#34;left&#34; android:background=&#34;@drawable/ico_shanchang&#34;/&gt; &lt;TextView android:id=&#34;@&#43;id/tv_teamdetail_good&#34; android:layout_width=&#34;match_parent&#34; android:layout_height=&#34;wrap_content&#34; android:layout_gravity=&#34;center&#34; android:layout_marginLeft=&#34;10dp&#34; android:ellipsize=&#34;end&#34; android:maxLines=&#34;2&#34; android:singleLine=&#34;false&#34; android:textColor=&#34;@color/dark_grey&#34; android:textSize=&#34;@dimen/text_size_small&#34;/&gt; &lt;/LinearLayout&gt; &lt;/LinearLayout&gt; &lt;LinearLayout android:id=&#34;@&#43;id/ll_teamdetail_all&#34; android:layout_width=&#34;match_parent&#34; android:layout_height=&#34;35dp&#34; android:layout_marginTop=&#34;1dp&#34; android:background=&#34;@color/btn_white_selector&#34; android:gravity=&#34;center&#34; android:orientation=&#34;horizontal&#34;&gt; &lt;TextView android:id=&#34;@&#43;id/tv_all_detail&#34; android:layout_width=&#34;wrap_content&#34; android:layout_height=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/20fc185b06c7abb82cee5f2269446041/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-12-01T17:26:04+08:00" />
<meta property="article:modified_time" content="2015-12-01T17:26:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">android Textview 使用之一：伸缩效果</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3><span style="font-weight:normal"><span style="font-size:14px">android开发过程中，经常遇到Textview展示不完全的情况。</span></span></h3> 
<p></p> 
<h3><span style="font-weight:normal"><span style="font-size:14px">遇到此情况，通常的处理是：</span></span></h3> 
<p></p> 
<p></p> 
<h3><span style="font-weight:normal"><span style="font-size:14px">方案一，Textview添加android:ellipsize属性，让展示不完的部分使用省略号代替。然后给</span></span><span style="font-weight:normal"><span style="font-size:14px">Textview设置点击事件跳转到另一个Activity让其显示完全。</span></span><span style="font-weight:normal"><span style="font-size:14px"></span></span> </h3><p>方案二，我们在很多应用中都能看到有向下的箭头或者“<span style="font-weight:normal"><span style="font-size:14px">查看详情</span></span>”的字样，点击后他会自动撑开，让TextView显示完整。</p> <p>原来我们的项目里都是用的第一种方法，很显然，太不高大上了。今天找到了一种既简单又高大上的方法。</p> <p></p>  
<h3><span style="font-weight:normal"><span style="font-size:14px">下面来看下Demo例子的收起效果，<span style="color:#ff00">文本内容没有展示完全，使用省略号代替，</span><span style="color:#ff00">提示“更多”和向下箭头标识，截图如下</span>：</span></span></h3> 
<img src="https://images2.imgbox.com/92/bc/nKzj9hBh_o.png" alt=""> 
<img src="https://images2.imgbox.com/ad/41/X0ChALWi_o.png" alt=""> 
<br> 
<p></p> 
<p></p> 
<p></p> 
<h3><span style="font-weight:normal"><span style="font-size:14px">对于以上效果，实现思路如下：<br> 1、设置Textview默认展示固定行，比如3行，内容展示不完全，在Textview尾部使用省略号代替。<br> xml文件内容为：</span></span></h3> 
<pre style="background-color:#cce8cf; color:#000000; font-family:'Consolas'; font-size:12.0pt"> &lt;<span style="color:#000080; font-weight:bold">LinearLayout
</span><span style="color:#000080; font-weight:bold">        </span>android:layout_width=<span style="color:#008000; font-weight:bold">"match_parent"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_height=<span style="color:#008000; font-weight:bold">"wrap_content"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_marginLeft=<span style="color:#008000; font-weight:bold">"15dp"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_marginRight=<span style="color:#008000; font-weight:bold">"15dp"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_marginTop=<span style="color:#008000; font-weight:bold">"15dp"</span>&gt;

        &lt;<span style="color:#000080; font-weight:bold">ImageView
</span><span style="color:#000080; font-weight:bold">            </span>android:layout_width=<span style="color:#008000; font-weight:bold">"20dp"
</span><span style="color:#008000; font-weight:bold">            </span>android:layout_height=<span style="color:#008000; font-weight:bold">"20dp"
</span><span style="color:#008000; font-weight:bold">            </span>android:layout_gravity=<span style="color:#008000; font-weight:bold">"left"
</span><span style="color:#008000; font-weight:bold">            </span>android:background=<span style="color:#008000; font-weight:bold">"@drawable/ico_jianjie"</span>/&gt;

        &lt;<span style="color:#000080; font-weight:bold">TextView
</span><span style="color:#000080; font-weight:bold">            </span>android:id=<span style="color:#008000; font-weight:bold">"@+id/tv_teamdetail_introduce"
</span><span style="color:#008000; font-weight:bold">            </span>android:layout_width=<span style="color:#008000; font-weight:bold">"match_parent"
</span><span style="color:#008000; font-weight:bold">            </span>android:layout_height=<span style="color:#008000; font-weight:bold">"wrap_content"
</span><span style="color:#008000; font-weight:bold">            </span>android:layout_marginLeft=<span style="color:#008000; font-weight:bold">"10dp"
</span><span style="color:#008000; font-weight:bold">            </span>android:ellipsize=<span style="color:#008000; font-weight:bold">"end"
</span><span style="color:#008000; font-weight:bold">            </span>android:maxLines=<span style="color:#008000; font-weight:bold">"2"
</span><span style="color:#008000; font-weight:bold">            </span>android:singleLine=<span style="color:#008000; font-weight:bold">"false"
</span><span style="color:#008000; font-weight:bold">            </span>android:textColor=<span style="color:#008000; font-weight:bold">"@color/dark_grey"
</span><span style="color:#008000; font-weight:bold">            </span>android:textSize=<span style="color:#008000; font-weight:bold">"@dimen/text_size_small"</span>/&gt;

    &lt;/<span style="color:#000080; font-weight:bold">LinearLayout</span>&gt;

    &lt;<span style="color:#000080; font-weight:bold">LinearLayout
</span><span style="color:#000080; font-weight:bold">        </span>android:id=<span style="color:#008000; font-weight:bold">"@+id/ll_teamdetail_good"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_width=<span style="color:#008000; font-weight:bold">"match_parent"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_height=<span style="color:#008000; font-weight:bold">"wrap_content"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_marginBottom=<span style="color:#008000; font-weight:bold">"15dp"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_marginLeft=<span style="color:#008000; font-weight:bold">"15dp"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_marginRight=<span style="color:#008000; font-weight:bold">"15dp"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_marginTop=<span style="color:#008000; font-weight:bold">"15dp"
</span><span style="color:#008000; font-weight:bold">        </span>android:orientation=<span style="color:#008000; font-weight:bold">"horizontal"</span>&gt;

        &lt;<span style="color:#000080; font-weight:bold">ImageView
</span><span style="color:#000080; font-weight:bold">            </span>android:layout_width=<span style="color:#008000; font-weight:bold">"20dp"
</span><span style="color:#008000; font-weight:bold">            </span>android:layout_height=<span style="color:#008000; font-weight:bold">"20dp"
</span><span style="color:#008000; font-weight:bold">            </span>android:layout_gravity=<span style="color:#008000; font-weight:bold">"left"
</span><span style="color:#008000; font-weight:bold">            </span>android:background=<span style="color:#008000; font-weight:bold">"@drawable/ico_shanchang"</span>/&gt;

        &lt;<span style="color:#000080; font-weight:bold">TextView
</span><span style="color:#000080; font-weight:bold">            </span>android:id=<span style="color:#008000; font-weight:bold">"@+id/tv_teamdetail_good"
</span><span style="color:#008000; font-weight:bold">            </span>android:layout_width=<span style="color:#008000; font-weight:bold">"match_parent"
</span><span style="color:#008000; font-weight:bold">            </span>android:layout_height=<span style="color:#008000; font-weight:bold">"wrap_content"
</span><span style="color:#008000; font-weight:bold">            </span>android:layout_gravity=<span style="color:#008000; font-weight:bold">"center"
</span><span style="color:#008000; font-weight:bold">            </span>android:layout_marginLeft=<span style="color:#008000; font-weight:bold">"10dp"
</span><span style="color:#008000; font-weight:bold">            </span>android:ellipsize=<span style="color:#008000; font-weight:bold">"end"
</span><span style="color:#008000; font-weight:bold">            </span>android:maxLines=<span style="color:#008000; font-weight:bold">"2"
</span><span style="color:#008000; font-weight:bold">            </span>android:singleLine=<span style="color:#008000; font-weight:bold">"false"
</span><span style="color:#008000; font-weight:bold">            </span>android:textColor=<span style="color:#008000; font-weight:bold">"@color/dark_grey"
</span><span style="color:#008000; font-weight:bold">            </span>android:textSize=<span style="color:#008000; font-weight:bold">"@dimen/text_size_small"</span>/&gt;


    &lt;/<span style="color:#000080; font-weight:bold">LinearLayout</span>&gt;

&lt;/<span style="color:#000080; font-weight:bold">LinearLayout</span>&gt;

&lt;<span style="color:#000080; font-weight:bold">LinearLayout
</span><span style="color:#000080; font-weight:bold">    </span>android:id=<span style="color:#008000; font-weight:bold">"@+id/ll_teamdetail_all"
</span><span style="color:#008000; font-weight:bold">    </span>android:layout_width=<span style="color:#008000; font-weight:bold">"match_parent"
</span><span style="color:#008000; font-weight:bold">    </span>android:layout_height=<span style="color:#008000; font-weight:bold">"35dp"
</span><span style="color:#008000; font-weight:bold">    </span>android:layout_marginTop=<span style="color:#008000; font-weight:bold">"1dp"
</span><span style="color:#008000; font-weight:bold">    </span>android:background=<span style="color:#008000; font-weight:bold">"@color/btn_white_selector"
</span><span style="color:#008000; font-weight:bold">    </span>android:gravity=<span style="color:#008000; font-weight:bold">"center"
</span><span style="color:#008000; font-weight:bold">    </span>android:orientation=<span style="color:#008000; font-weight:bold">"horizontal"</span>&gt;

    &lt;<span style="color:#000080; font-weight:bold">TextView
</span><span style="color:#000080; font-weight:bold">        </span>android:id=<span style="color:#008000; font-weight:bold">"@+id/tv_all_detail"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_width=<span style="color:#008000; font-weight:bold">"wrap_content"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_height=<span style="color:#008000; font-weight:bold">"wrap_content"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_gravity=<span style="color:#008000; font-weight:bold">"center_vertical"
</span><span style="color:#008000; font-weight:bold">        </span>android:text=<span style="color:#008000; font-weight:bold">"</span><span style="font-family:'宋体'; color:#008000; font-weight:bold">查看详情</span><span style="color:#008000; font-weight:bold">"
</span><span style="color:#008000; font-weight:bold">        </span>android:textColor=<span style="color:#008000; font-weight:bold">"@color/dark_grey"
</span><span style="color:#008000; font-weight:bold">        </span>android:textSize=<span style="color:#008000; font-weight:bold">"@dimen/text_size_minor"</span>/&gt;

    &lt;<span style="color:#000080; font-weight:bold">ImageView
</span><span style="color:#000080; font-weight:bold">        </span>android:id=<span style="color:#008000; font-weight:bold">"@+id/iv_teamdetail_all"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_width=<span style="color:#008000; font-weight:bold">"wrap_content"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_height=<span style="color:#008000; font-weight:bold">"wrap_content"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_alignParentRight=<span style="color:#008000; font-weight:bold">"true"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_gravity=<span style="color:#008000; font-weight:bold">"center"
</span><span style="color:#008000; font-weight:bold">        </span>android:layout_marginLeft=<span style="color:#008000; font-weight:bold">"5dp"
</span><span style="color:#008000; font-weight:bold">        </span>android:rotation=<span style="color:#008000; font-weight:bold">"90"
</span><span style="color:#008000; font-weight:bold">        </span>android:src=<span style="color:#008000; font-weight:bold">"@drawable/ico_jiantou"</span>/&gt;
&lt;/<span style="color:#000080; font-weight:bold">LinearLayout</span>&gt;
</pre> 
<h3><span style="font-weight:normal"><span style="font-size:14px">2、点击“查看详情”和向下箭头时，通过Textview的setMaxLines()方法改变Textview的最大行数。即可实现上述效果。</span></span></h3> 
<div> 
 <span style="font-weight:normal"><span style="font-size:14px">Java代码为：<br> </span></span> 
 <pre style="background-color:#cce8cf; color:#000000; font-family:'Consolas'; font-size:12.0pt"><span style="color:#000080; font-weight:bold">private static final int </span><span style="color:#660e7a; font-weight:bold; font-style:italic">CONTENT_MAX_LINE </span>= <span style="color:#0000ff">2</span>;<span style="color:#808080; font-style:italic">// </span><span style="font-family:'宋体'; color:#808080; font-style:italic">默认展示最大行数</span><span style="color:#808080; font-style:italic">3</span><span style="font-family:'宋体'; color:#808080; font-style:italic">行</span></pre> 
</div> 
<pre style="background-color:#cce8cf; color:#000000; font-family:'Consolas'; font-size:12.0pt"><span style="color:#660e7a; font-weight:bold">ll_teamdetail_all</span>.setOnClickListener(<span style="color:#000080; font-weight:bold">new </span>View.OnClickListener() {
    Boolean <span style="color:#660e7a; font-weight:bold">flag </span>= <span style="color:#000080; font-weight:bold">true</span>;<span style="color:#808080; font-style:italic">//textview</span><span style="font-family:'宋体'; color:#808080; font-style:italic">是否展开
</span><span style="font-family:'宋体'; color:#808080; font-style:italic">    </span><span style="color:#808000">@Override
</span><span style="color:#808000">    </span><span style="color:#000080; font-weight:bold">public void </span>onClick(View view) {
        <span style="color:#000080; font-weight:bold">if </span>(<span style="color:#660e7a; font-weight:bold">flag</span>) {
            <span style="color:#660e7a; font-weight:bold">flag </span>= <span style="color:#000080; font-weight:bold">false</span>;
            <span style="color:#660e7a; font-weight:bold">tv_teamdetail_introduce</span>.setMaxLines(Integer.<span style="color:#660e7a; font-weight:bold; font-style:italic">MAX_VALUE</span>);
            <span style="color:#660e7a; font-weight:bold">tv_teamdetail_introduce</span>.requestLayout();
            <span style="color:#660e7a; font-weight:bold">tv_teamdetail_introduce</span>.setEllipsize(<span style="color:#000080; font-weight:bold">null</span>); <span style="color:#808080; font-style:italic">// </span><span style="font-family:'宋体'; color:#808080; font-style:italic">展开
</span><span style="font-family:'宋体'; color:#808080; font-style:italic">            </span><span style="color:#660e7a; font-weight:bold">tv_teamdetail_good</span>.setMaxLines(Integer.<span style="color:#660e7a; font-weight:bold; font-style:italic">MAX_VALUE</span>);
            <span style="color:#660e7a; font-weight:bold">tv_teamdetail_good</span>.requestLayout();
            <span style="color:#660e7a; font-weight:bold">tv_teamdetail_good</span>.setEllipsize(<span style="color:#000080; font-weight:bold">null</span>); <span style="color:#808080; font-style:italic">// </span><span style="font-family:'宋体'; color:#808080; font-style:italic">展开
</span><span style="font-family:'宋体'; color:#808080; font-style:italic">            </span><span style="color:#660e7a; font-weight:bold">iv_teamdetail_all</span>.setRotation(-<span style="color:#0000ff">90</span>);
        } <span style="color:#000080; font-weight:bold">else </span>{
            <span style="color:#660e7a; font-weight:bold">flag </span>= <span style="color:#000080; font-weight:bold">true</span>;
            <span style="color:#660e7a; font-weight:bold">tv_teamdetail_introduce</span>.setMaxLines(<span style="color:#660e7a; font-weight:bold; font-style:italic">CONTENT_MAX_LINE</span>);
            <span style="color:#660e7a; font-weight:bold">tv_teamdetail_introduce</span>.requestLayout();
            <span style="color:#660e7a; font-weight:bold">tv_teamdetail_introduce</span>.setEllipsize(TextUtils.TruncateAt.<span style="color:#660e7a; font-weight:bold; font-style:italic">END</span>); <span style="color:#808080; font-style:italic">// </span><span style="font-family:'宋体'; color:#808080; font-style:italic">收缩
</span><span style="font-family:'宋体'; color:#808080; font-style:italic">            </span><span style="color:#660e7a; font-weight:bold">tv_teamdetail_good</span>.setMaxLines(<span style="color:#660e7a; font-weight:bold; font-style:italic">CONTENT_MAX_LINE</span>);
            <span style="color:#660e7a; font-weight:bold">tv_teamdetail_good</span>.requestLayout();
            <span style="color:#660e7a; font-weight:bold">tv_teamdetail_good</span>.setEllipsize(TextUtils.TruncateAt.<span style="color:#660e7a; font-weight:bold; font-style:italic">END</span>); <span style="color:#808080; font-style:italic">// </span><span style="font-family:'宋体'; color:#808080; font-style:italic">收缩
</span><span style="font-family:'宋体'; color:#808080; font-style:italic">            </span><span style="color:#660e7a; font-weight:bold">iv_teamdetail_all</span>.setRotation(<span style="color:#0000ff">90</span>);
        }
    }
});</pre> 
<span style="font-size:14px">3.值得注意的一点就是箭头的处理，当展开或者收缩时，箭头的方向也是跟着改变的，并且它改变的度数是以最原始的位置计算的。</span> 
<br> 
<p></p> 
<h3><span style="font-size:14px">Textview的伸缩就探讨到这里。有问题，大家可以留言。由于特别简单，就不附全码了。</span></h3> 
<br>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2a93f708fca676ea6547a115fcd1646b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">20个jquery地图插件-上（基于Google Maps API）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6818ffe61b398927c522edbb405a08e0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">STM32F407的ADC单次转换</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>