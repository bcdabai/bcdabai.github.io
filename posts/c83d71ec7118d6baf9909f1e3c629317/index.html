<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>uni-app下SQLite应用初探备忘录 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="uni-app下SQLite应用初探备忘录" />
<meta property="og:description" content="uni-app是什么东东，这里就不是多讲了，大家可以看下官网：https://uniapp.dcloud.net.cn/。总之以后，但有实体程序，大多用它来书写。SQLite是什么东西？我认为就是一个本地数据库，可以用SQL语句来完成数据库的操作。写本文是为了备忘，也是为积累知识。
一、创建uni-app项目 打开HBuilder，新建一个支持SQLite的项目。具体操作如下：
1、新建一个空项目
选默认模板，就可以了。也就是空的，不要选其他。
2、自动生成项目之后，在左侧找开项目，找到个manifest.json，如图：
这个文件就是项目的配置文件，一定要看好
3、如果你生成的项目，没有AppID，则点“生新获取&#34;。如果有AppID，则直接略过：
操作之后结果，如下图所示，但是注意你生成的AppID可能不一样：
4、在App模块配置之中，选中SQLite，操作如图所示：
这个文件通常是自动保存的，也可以手工保存一下。理论上讲，我们现在已经可以操作SQLite了，但是我们还要先了解一下操作的API；看一下，系统为我们提供那些接口，来操作SQLite
二、操作SQLite的API SQLite，是一款轻型的数据库，是遵守ACID的关系型数据库管理系统，它包含在一个相对小的C库中。它是D.RichardHipp建立的公有领域项目。它的设计目标是嵌入式的，而且已经在很多嵌入式产品中使用了它，它占用资源非常的低，在嵌入式设备中，可能只需要几百K的内存就够了。它能够支持Windows/Linux/Unix等等主流的操作系统，同时能够跟很多程序语言相结合，比如 Tcl、C#、PHP、Java等，还有ODBC接口，同样比起Mysql、PostgreSQL这两款开源的世界著名数据库管理系统来讲，它的处理速度比他们都快。SQLite第一个Alpha版本诞生于2000年5月。 至2023年已经接近有23个年头，SQLite也迎来了一个版本 SQLite 3已经发布。
我们的API，还要记得一个网址：https://www.html5plus.org/doc/zh_cn/sqlite.html，打后之后如图所示：
下面我们先来了解一下这个文档
1、打开数据库
void plus.sqlite.openDatabase(options); 说明： \color{red}说明： 说明：
如果数据库存在则打开，不存在则创建。
参数： \color{red}参数： 参数：
options参数为json类型，包含以下属性：
name: ( String ) 必选 数据库名称 如chatpath: ( String ) 必选 数据库路径 如_doc/chat.dbsuccess: ( SQLiteSuccessCallback ) 可选 打开数据库成功回调函数,回调函数无返回参数。fail: ( SQLiteFailCallback ) 可选 打开数据库失败回调函数 例子：
// 打开数据库 function openDB(){ plus.sqlite.openDatabase({ name: &#39;first&#39;, path: &#39;_doc/test.db&#39;, success: function(e){ console.log(&#39;openDatabase success!&#39;); }, fail: function(e){ console." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c83d71ec7118d6baf9909f1e3c629317/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-13T16:30:44+08:00" />
<meta property="article:modified_time" content="2023-08-13T16:30:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">uni-app下SQLite应用初探备忘录</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>uni-app是什么东东，这里就不是多讲了，大家可以看下官网：https://uniapp.dcloud.net.cn/。总之以后，但有实体程序，大多用它来书写。SQLite是什么东西？我认为就是一个本地数据库，可以用SQL语句来完成数据库的操作。写本文是为了备忘，也是为积累知识。</p> 
<h3><a id="uniapp_2"></a>一、创建uni-app项目</h3> 
<p>打开HBuilder，新建一个支持SQLite的项目。具体操作如下：<br> 1、新建一个空项目</p> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/f1/71/D7DL8XnA_o.jpg" alt="在这里插入图片描述"><br> 选默认模板，就可以了。也就是空的，不要选其他。</p> 
</blockquote> 
<p>2、自动生成项目之后，在左侧找开项目，找到个manifest.json，如图：</p> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/83/b5/55jd1x6g_o.jpg" alt="在这里插入图片描述"><br> 这个文件就是项目的配置文件，一定要看好</p> 
</blockquote> 
<p>3、如果你生成的项目，没有AppID，则点“生新获取"。如果有AppID，则直接略过：</p> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/ce/fb/BWZgX2rS_o.jpg" alt="在这里插入图片描述"><br> 操作之后结果，如下图所示，但是注意你生成的AppID可能不一样：<br> <img src="https://images2.imgbox.com/aa/bd/NR4zDaq9_o.jpg" alt="在这里插入图片描述"></p> 
</blockquote> 
<p>4、在App模块配置之中，选中SQLite，操作如图所示：</p> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/37/41/EvX0Nf9e_o.jpg" alt="在这里插入图片描述"><br> 这个文件通常是自动保存的，也可以手工保存一下。理论上讲，我们现在已经可以操作SQLite了，但是我们还要先了解一下操作的API；看一下，系统为我们提供那些接口，来操作SQLite</p> 
</blockquote> 
<h3><a id="SQLiteAPI_22"></a>二、操作SQLite的API</h3> 
<p>SQLite，是一款轻型的数据库，是遵守ACID的关系型数据库管理系统，它包含在一个相对小的C库中。它是D.RichardHipp建立的公有领域项目。它的设计目标是嵌入式的，而且已经在很多嵌入式产品中使用了它，它占用资源非常的低，在嵌入式设备中，可能只需要几百K的内存就够了。它能够支持Windows/Linux/Unix等等主流的操作系统，同时能够跟很多程序语言相结合，比如 Tcl、C#、PHP、Java等，还有ODBC接口，同样比起Mysql、PostgreSQL这两款开源的世界著名数据库管理系统来讲，它的处理速度比他们都快。SQLite第一个Alpha版本诞生于2000年5月。 至2023年已经接近有23个年头，SQLite也迎来了一个版本 SQLite 3已经发布。</p> 
<p>我们的API，还要记得一个网址：https://www.html5plus.org/doc/zh_cn/sqlite.html，打后之后如图所示：</p> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/ed/32/iOhENc5y_o.jpg" alt="在这里插入图片描述"><br> 下面我们先来了解一下这个文档</p> 
</blockquote> 
<p>1、打开数据库</p> 
<pre><code class="prism language-bash">void plus.sqlite.openDatabase<span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           说明： 
          
         
        
       
         \color{red}说明： 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: red;">说明：</span></span></span></span></span><br> 如果数据库存在则打开，不存在则创建。</p> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           参数： 
          
         
        
       
         \color{red}参数： 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: red;">参数：</span></span></span></span></span><br> options参数为json类型，包含以下属性：</p> 
 <ul><li>name: ( String ) 必选 数据库名称 如chat</li><li>path: ( String ) 必选 数据库路径 如_doc/chat.db</li><li>success: ( SQLiteSuccessCallback ) 可选 打开数据库成功回调函数,回调函数无返回参数。</li><li>fail: ( SQLiteFailCallback ) 可选 打开数据库失败回调函数</li></ul> 
 <p>例子：</p> 
 <pre><code class="prism language-bash">// 打开数据库
<span class="token keyword">function</span> <span class="token function-name function">openDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	plus.sqlite.openDatabase<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
		name: <span class="token string">'first'</span>,
		path: <span class="token string">'_doc/test.db'</span>,
		success: function<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console.log<span class="token punctuation">(</span><span class="token string">'openDatabase success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>,
		fail: function<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console.log<span class="token punctuation">(</span><span class="token string">'openDatabase failed: '</span>+JSON.stringify<span class="token punctuation">(</span>e<span class="token punctuation">))</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
</blockquote> 
<p>2、判断数据库是否打开</p> 
<pre><code class="prism language-bash">Boolean plus.sqlite.isOpenDatabase<span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           说明： 
          
         
        
       
         \color{red}说明： 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: red;">说明：</span></span></span></span></span><br> 数据库已经打开则返回true，数据库没有打开则返回false。</p> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           参数： 
          
         
        
       
         \color{red}参数： 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: red;">参数：</span></span></span></span></span><br> options参数为json类型，包含以下属性：</p> 
 <ul><li>name: ( String ) 必选 数据库名称</li><li>path: ( String ) 必选 数据库路径</li></ul> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           返回值： 
          
         
        
       
         \color{red}返回值： 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: red;">返回值：</span></span></span></span></span><br> Boolean : true表示数据库已打开，false表示数据库没有打开。</p> 
 <p>例子：</p> 
 <pre><code class="prism language-bash"><span class="token keyword">if</span> <span class="token punctuation">(</span>plus.sqlite.isOpenDatabase<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>name: <span class="token string">'first'</span>,path: <span class="token string">'_doc/test.db'</span><span class="token punctuation">}</span><span class="token punctuation">))</span><span class="token punctuation">{<!-- --></span>
    console.log<span class="token punctuation">(</span><span class="token string">'已经打开数据库。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>else<span class="token punctuation">{<!-- --></span>
    console.log<span class="token punctuation">(</span><span class="token string">'没有打开数据库！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
</blockquote> 
<p>3、关闭数据库</p> 
<pre><code class="prism language-bash">void plus.sqlite.closeDatabase<span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           说明： 
          
         
        
       
         \color{red}说明： 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: red;">说明：</span></span></span></span></span><br> 完成数据库操作后，必须关闭数据库，否则可能会导致系统资源无法释放。</p> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           参数： 
          
         
        
       
         \color{red}参数： 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: red;">参数：</span></span></span></span></span><br> options参数为json类型，包含以下属性：</p> 
 <ul><li>name: ( String ) 必选 数据库名称</li><li>success: ( SQLiteSuccessCallback ) 可选 关闭数据库成功回调函数,回调函数无返回参数。</li><li>fail: ( SQLiteFailCallback ) 可选 关闭数据库失败回调函数</li></ul> 
 <p>示例：</p> 
 <pre><code class="prism language-bash">// 关闭数据库
<span class="token keyword">function</span> <span class="token function-name function">closeDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	plus.sqlite.closeDatabase<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
		name: <span class="token string">'first'</span>,
		success: function<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console.log<span class="token punctuation">(</span><span class="token string">'closeDatabase success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>,
		fail: function<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console.log<span class="token punctuation">(</span><span class="token string">'closeDatabase failed: '</span>+JSON.stringify<span class="token punctuation">(</span>e<span class="token punctuation">))</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
</blockquote> 
<p>4、执行事务</p> 
<pre><code class="prism language-bash">void plus.sqlite.transaction<span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           参数： 
          
         
        
       
         \color{red}参数： 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: red;">参数：</span></span></span></span></span><br> options参数为json类型，包含以下属性：</p> 
 <ul><li>name: ( String ) 必选 数据库名称</li><li>operation: ( String ) 必选 需要执行的事务操作 
   <ul><li>begin（开始事务）</li><li>commit（提交）</li><li>rollback（回滚）</li></ul> </li><li>success: ( SQLiteSuccessCallback ) 可选 执行事务成功回调函数,回调函数无返回参数。</li><li>fail: ( SQLiteFailCallback ) 可选 执行事务失败回调函数</li></ul> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           返回值： 
          
         
        
       
         \color{red}返回值： 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: red;">返回值：</span></span></span></span></span><br> void : 无</p> 
 <p>示例：</p> 
 <pre><code class="prism language-bash">// 执行事务
<span class="token keyword">function</span> <span class="token function-name function">transactionDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	plus.sqlite.transaction<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
		name: <span class="token string">'first'</span>,
		operation: <span class="token string">'begin'</span>,
		success: function<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console.log<span class="token punctuation">(</span><span class="token string">'transaction success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>,
		fail: function<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console.log<span class="token punctuation">(</span><span class="token string">'transaction failed: '</span>+JSON.stringify<span class="token punctuation">(</span>e<span class="token punctuation">))</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
</blockquote> 
<p>5、执行增删改等操作的SQL语句</p> 
<pre><code class="prism language-bash">void plus.sqlite.executeSql<span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           参数： 
          
         
        
       
         \color{red}参数： 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: red;">参数：</span></span></span></span></span><br> options参数为json类型，包含以下属性：</p> 
 <ul><li>name: ( String ) 必选 数据库名称</li><li>sql: ( Array[String] | String ) 必选 需要执行的SQL语句 
   <ul><li>参数为字符串时，表示执行单条SQL语句；</li><li>参数为字符串数组时，表示执行多条SQL语句，按数组顺序执行，某条SQL语句执行错误则终止。<br> . + 注意：不支持SQL语句中使用“;”分割多条命令，要运行多条命令请使用字符串数组参数。</li></ul> </li><li>success: ( SQLiteSuccessCallback ) 可选 执行SQL语句成功回调函数 
   <ul><li>回调函数无返回参数。</li></ul> </li><li>fail: ( SQLiteFailCallback ) 可选 执行SQL语句失败回调函数</li></ul> 
 <p>示例：</p> 
 <pre><code class="prism language-bash">// 执行SQL语句
<span class="token keyword">function</span> <span class="token function-name function">executeSQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	plus.sqlite.executeSql<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
		name: <span class="token string">'first'</span>,
		sql: <span class="token string">'create table if not exists database("where" CHAR(110),"location" CHAR(100),"age" INT(11))'</span>,
		success: function<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console.log<span class="token punctuation">(</span><span class="token string">'executeSql success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			plus.sqlite.executeSql<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
				name: <span class="token string">'first'</span>,
				sql: <span class="token string">"insert into database values('北京','安乐林','11')"</span>,
				success: function<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					console.log<span class="token punctuation">(</span><span class="token string">'executeSql success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>,
				fail: function<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					console.log<span class="token punctuation">(</span><span class="token string">'executeSql failed: '</span>+JSON.stringify<span class="token punctuation">(</span>e<span class="token punctuation">))</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>,
		fail: function<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console.log<span class="token punctuation">(</span><span class="token string">'executeSql failed: '</span>+JSON.stringify<span class="token punctuation">(</span>e<span class="token punctuation">))</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
</blockquote> 
<p>6、执行查询的SQL语句</p> 
<pre><code class="prism language-bash">void plus.sqlite.selectSql<span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           参数： 
          
         
        
       
         \color{red}参数： 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: red;">参数：</span></span></span></span></span><br> options参数为json类型，包含以下属性：</p> 
 <ul><li>name: ( String ) 必选 数据库名称</li><li>sql: ( String ) 必选 需要查询的SQL语句</li><li>success: ( SQLiteSuccessCallback ) 可选 执行SQL语句成功回调函数 
   <ul><li>回调函数返回参数为JSON对象数组，其中JSON对象为查询的结果。 如果未查询到数据则返回参数为空数组。</li></ul> </li><li>fail: ( SQLiteFailCallback ) 可选 执行SQL语句失败回调函数</li></ul> 
 <p>示例：</p> 
 <pre><code class="prism language-bash">// 查询SQL语句
<span class="token keyword">function</span> <span class="token function-name function">selectSQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	plus.sqlite.selectSql<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
		name: <span class="token string">'first'</span>,
		sql: <span class="token string">'select * from database'</span>,
		success: function<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console.log<span class="token punctuation">(</span><span class="token string">'selectSql success: '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			for<span class="token punctuation">(</span>var i <span class="token keyword">in</span> data<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				console.log<span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>,
		fail: function<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console.log<span class="token punctuation">(</span><span class="token string">'selectSql failed: '</span>+JSON.stringify<span class="token punctuation">(</span>e<span class="token punctuation">))</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
</blockquote> 
<h3><a id="_247"></a>三、直接引用</h3> 
<p>我们现在来制作原始的接口，俱体的方法是找到我们的主文件：pages\index\index.vue。在这个文件开头，写入以下代码：</p> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/ca/53/qSgkekql_o.jpg" alt="在这里插入图片描述"><br> 源码如下：</p> 
 <pre><code class="prism language-html">		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>原始接口0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span><span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span><span class="token property">flex-wrap</span><span class="token punctuation">:</span> wrap<span class="token punctuation">;</span><span class="token property">justify-content</span><span class="token punctuation">:</span>flex-start<span class="token punctuation">;</span><span class="token property">justify-items</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>openDB<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>打开DB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isopen<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>是否打开<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>closeDB<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>关闭DB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>executeSQL<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>执行SQL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectSQL<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>查询SQL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>transBegin<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>事务开始<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>editDB<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>岁数+1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>transCommit<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>事务提交<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>transRollback<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>事务回滚<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
</blockquote> 
<p>在 <strong>methods:</strong> 处,加上我们改写的代码。<br> 1、打开数据库接口：</p> 
<pre><code class="prism language-js">			<span class="token comment">//打开数据库</span>
			<span class="token function">openDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">openDatabase</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'first'</span><span class="token punctuation">,</span>
					<span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'_doc/test.db'</span><span class="token punctuation">,</span>
					<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'openDatabase success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'openDatabase failed: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<blockquote> 
 <p>拷上面代码，去function,最后再上加**,**就可以了。以后的代码也是这样改。</p> 
</blockquote> 
<p>2、数据库是否打开：</p> 
<pre><code class="prism language-js"><span class="token comment">//db是否打开</span>
			<span class="token function">isopen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">isOpenDatabase</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'first'</span><span class="token punctuation">,</span><span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'_doc/test.db'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'已经打开数据库。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
				    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'没有打开数据库！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<blockquote> 
 <p>这应该算一个同步函数</p> 
</blockquote> 
<p>3、关闭数据库：</p> 
<pre><code class="prism language-js">            <span class="token function">closeDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">closeDatabase</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'first'</span><span class="token punctuation">,</span>
					<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'closeDatabase success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'closeDatabase failed: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<blockquote> 
 <p>每次操作数据库，都要关闭！<br> 4、执行SQL语句：</p> 
</blockquote> 
<pre><code class="prism language-js">			<span class="token function">executeSQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">executeSql</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'first'</span><span class="token punctuation">,</span>
					<span class="token literal-property property">sql</span><span class="token operator">:</span> <span class="token string">'create table if not exists database("where" CHAR(110),"location" CHAR(100),"age" INT(11))'</span><span class="token punctuation">,</span>
					<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'executeSql success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">executeSql</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
							<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'first'</span><span class="token punctuation">,</span>
							<span class="token literal-property property">sql</span><span class="token operator">:</span> <span class="token string">"insert into database values('北京','安乐林','11')"</span><span class="token punctuation">,</span>
							<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
								console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'executeSql success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token punctuation">}</span><span class="token punctuation">,</span>
							<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
								console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'executeSql failed: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token punctuation">}</span>
						<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'executeSql failed: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<blockquote> 
 <p>这个函数有点长，不过不用改逻辑，我们要试一下，能不能运行，接口是不是OK！<br> 5、查询SQL语句</p> 
</blockquote> 
<pre><code class="prism language-js">			<span class="token function">selectSQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">selectSql</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'first'</span><span class="token punctuation">,</span>
					<span class="token literal-property property">sql</span><span class="token operator">:</span> <span class="token string">'select * from database'</span><span class="token punctuation">,</span>
					<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'selectSql success: '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">in</span> data<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
							console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'selectSql failed: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<blockquote> 
 <p>这种函数，没有通用性<br> 6、执行事务(开始)</p> 
</blockquote> 
<pre><code class="prism language-js">			<span class="token function">transBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'first'</span><span class="token punctuation">,</span>
					<span class="token literal-property property">operation</span><span class="token operator">:</span> <span class="token string">'begin'</span><span class="token punctuation">,</span>
					<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'transaction begin success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'transaction begin failed: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<blockquote> 
 <p>事务接口，必须扩一下，扩成三个开始、提交、回滚</p> 
</blockquote> 
<p>7、执行事务(提交)</p> 
<pre><code class="prism language-js">			<span class="token function">transCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'first'</span><span class="token punctuation">,</span>
					<span class="token literal-property property">operation</span><span class="token operator">:</span> <span class="token string">'commit'</span><span class="token punctuation">,</span>
					<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'transaction commit success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'transaction commit failed: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p>8、执行事务(回滚)</p> 
<pre><code class="prism language-js">			<span class="token function">transRollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'first'</span><span class="token punctuation">,</span>
					<span class="token literal-property property">operation</span><span class="token operator">:</span> <span class="token string">'rollback'</span><span class="token punctuation">,</span>
					<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'transaction rollback success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'transaction rollback failed: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p>9、修改数据事务用</p> 
<pre><code class="prism language-js">			<span class="token function">editDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">executeSql</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'first'</span><span class="token punctuation">,</span>
					<span class="token literal-property property">sql</span><span class="token operator">:</span> <span class="token string">"update database set age=age+1 "</span><span class="token punctuation">,</span>
					<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'executeSql update success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'executeSql update failed: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<blockquote> 
 <p>这是事务中要用的，只要开启事务，修改数据，在提交后有效。如果回滚则无效！</p> 
</blockquote> 
<p>10、小结：</p> 
<p>这个接口是可以用的，特别是事务也是可以用！这对于关键业务相当有用。但是缺点也常非明显，不方便使用，我们在目前的基础之上，可以进化到一个单独的js文件中。</p> 
<h3><a id="1_446"></a>四、第1代接口</h3> 
<p>1、我们改template,增加如下代码：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>第1代接口<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span><span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span><span class="token property">flex-wrap</span><span class="token punctuation">:</span> wrap<span class="token punctuation">;</span><span class="token property">justify-content</span><span class="token punctuation">:</span>flex-start<span class="token punctuation">;</span><span class="token property">justify-items</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clickOpenDB<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>打开DB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clickIsOpen<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>是否打开<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clickCloseDB<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>关闭DB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clickExecuteSQL<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>执行SQL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clickSelectSQL<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>查询SQL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clickTransBegin<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>事务开始<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clickEditDB<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>岁数+1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clickTransCommit<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>事务提交<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clickTransRollback<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>事务回滚<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>2、我们新建目录common,并在其目录下建立新js文件：SQLite31.js，效果如图所示：</p> 
<pre><code class="prism language-js"><span class="token comment">//第一代SQLite接口，作者：天一先生，时间：2023-8-12</span>
<span class="token comment">//打开数据库</span>
<span class="token keyword">function</span> <span class="token function">openDB</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">openDatabase</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
		<span class="token operator">...</span>config<span class="token punctuation">,</span>
		<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'openDatabase success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'openDatabase failed: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//db是否打开</span>
<span class="token keyword">function</span> <span class="token function">isOpen</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">isOpenDatabase</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'已经打开数据库。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'没有打开数据库！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 关闭数据库</span>
<span class="token keyword">function</span> <span class="token function">closeDB</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">closeDatabase</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
		<span class="token operator">...</span>config<span class="token punctuation">,</span>
		<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'closeDatabase success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'closeDatabase failed: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行SQL语句</span>
<span class="token keyword">function</span> <span class="token function">executeSQL</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span>sql</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">executeSql</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
		<span class="token operator">...</span>config<span class="token punctuation">,</span>
		<span class="token literal-property property">sql</span><span class="token operator">:</span> sql<span class="token punctuation">,</span>
		<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'executeSql success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'executeSql failed: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 查询SQL语句</span>
<span class="token keyword">function</span> <span class="token function">selectSQL</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span>sql</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">selectSql</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
		<span class="token operator">...</span>config<span class="token punctuation">,</span>
		<span class="token literal-property property">sql</span><span class="token operator">:</span> sql<span class="token punctuation">,</span>
		<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'selectSql success: '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">in</span> data<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'selectSql failed: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行事务(开始)begin,commit,rollback</span>
<span class="token keyword">function</span> <span class="token function">trans</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span>oper</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
		<span class="token operator">...</span>config<span class="token punctuation">,</span>
		<span class="token literal-property property">operation</span><span class="token operator">:</span>oper<span class="token punctuation">,</span>
		<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'transaction '</span><span class="token operator">+</span>oper<span class="token operator">+</span><span class="token string">' success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'transaction '</span><span class="token operator">+</span>oper<span class="token operator">+</span><span class="token string">' failed: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>trans<span class="token punctuation">,</span>selectSQL<span class="token punctuation">,</span>executeSQL<span class="token punctuation">,</span>closeDB<span class="token punctuation">,</span>isOpen<span class="token punctuation">,</span>openDB<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>3、在主程序中我们引用这个js,在pages/index/index.vue的script</p> 
<pre><code class="prism language-js"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">import</span> sql1 <span class="token keyword">from</span> <span class="token string">'@/common/SQLite31.js'</span>
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'Hello'</span><span class="token punctuation">,</span>
				<span class="token literal-property property">config</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'first'</span><span class="token punctuation">,</span><span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'_doc/test.db'</span><span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token comment">//this.openDB();</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p>4、在methods之中增加事件如下：</p> 
<pre><code class="prism language-js"><span class="token comment">//==========================第1代接口=======================</span>
			<span class="token function">clickOpenDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				sql1<span class="token punctuation">.</span><span class="token function">openDB</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function">clickIsOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				sql1<span class="token punctuation">.</span><span class="token function">isOpen</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function">clickCloseDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				sql1<span class="token punctuation">.</span><span class="token function">closeDB</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function">clickExecuteSQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">let</span> sqltxt<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'create table if not exists database("where" CHAR(110),"location" CHAR(100),"age" INT(11))'</span><span class="token punctuation">,</span>
							<span class="token string">"insert into database values('北京','安乐林','11')"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				sql1<span class="token punctuation">.</span><span class="token function">executeSQL</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">,</span>sqltxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function">clickSelectSQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">let</span> sqltxt<span class="token operator">=</span><span class="token string">'select * from database'</span><span class="token punctuation">;</span>
				sql1<span class="token punctuation">.</span><span class="token function">selectSQL</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">,</span>sqltxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function">clickTransBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				sql1<span class="token punctuation">.</span><span class="token function">trans</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">,</span><span class="token string">'begin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function">clickEditDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">let</span> sqltxt<span class="token operator">=</span><span class="token string">"update database set age=age+1 "</span><span class="token punctuation">;</span>
				sql1<span class="token punctuation">.</span><span class="token function">executeSQL</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">,</span>sqltxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function">clickTransCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				sql1<span class="token punctuation">.</span><span class="token function">trans</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">,</span><span class="token string">'commit'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function">clickTransRollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				sql1<span class="token punctuation">.</span><span class="token function">trans</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">,</span><span class="token string">'rollback'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p>5、小结：我们已经做了接口，也用独立文件来表达。但是使用还是不方便，比如不能方便的使用连续两条SQL，必须要在回调中才安全。如果遇上复杂一点的SQL,我们就难以搞定。所以必须继续进行同步化！</p> 
<h3><a id="2_612"></a>五、第2代接口</h3> 
<p>1、同步化我们采用 async/promise/await来处理所有的已知函数，以isOpen为例说明，未同化前：</p> 
<pre><code class="prism language-js"><span class="token comment">//db是否打开</span>
<span class="token keyword">function</span> <span class="token function">isOpen</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">isOpenDatabase</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'已经打开数据库。'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'没有打开数据库！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>同化之后</p> 
<pre><code class="prism language-js"><span class="token comment">//db是否打开</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">isOpen</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">isOpenDatabase</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">code</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'已经打开数据库。'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
			<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">code</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'没有打开数据库！'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>如何使用同化后的函数呢？<br> 在模板之中：</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onclickIsOpen<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>是否打开<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>在脚本之中：</p> 
<pre><code class="prism language-js"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>

<span class="token keyword">import</span> sql2 <span class="token keyword">from</span> <span class="token string">'@/common/SQLite32.js'</span>
    <span class="token operator">...</span><span class="token operator">...</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token operator">...</span>
        		<span class="token keyword">async</span> <span class="token function">onclickIsOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">let</span> res<span class="token operator">=</span><span class="token keyword">await</span> sql2<span class="token punctuation">.</span><span class="token function">isOpen</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>code<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'已经打开'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">else</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<blockquote> 
 <p>事实上我们规定，所有同步函数都返回：{code:code,msg:msg,data:[]}<br> code,msg是必须的，data是可选的；code=1是操作成功，code=0是操作失败，msg:是成功信息或出错信息，data是数据</p> 
</blockquote> 
<p>2、我们在主页面的template,增加如下代码：</p> 
<pre><code class="prism language-html">		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>第2代接口<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span><span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span><span class="token property">flex-wrap</span><span class="token punctuation">:</span> wrap<span class="token punctuation">;</span><span class="token property">justify-content</span><span class="token punctuation">:</span>flex-start<span class="token punctuation">;</span><span class="token property">justify-items</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onclickOpenDB<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>打开DB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onclickIsOpen<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>是否打开<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onclickCloseDB<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>关闭DB<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onclickExecuteSQL<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>执行SQL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onclickSelectSQL<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>查询SQL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onclickTransBegin<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>事务开始<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onclickEditDB<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>岁数+1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onclickTransCommit<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>事务提交<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span><span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onclickTransRollback<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>事务回滚<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>3、新建common/SQLite32.js如下：</p> 
<pre><code class="prism language-js"><span class="token comment">/*
名称:	SQLite32.js
作者:	天一
功能:	SQLite3的同步接口
开创:	2023-08-12
最新:	2023-08-13
*/</span>
<span class="token comment">// 打开数据库</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">openDB</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
		plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">openDatabase</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
			<span class="token operator">...</span>config<span class="token punctuation">,</span>
			<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">code</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'打开数据库 成功!'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">code</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'打开数据库 失败: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//db是否打开</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">isOpen</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">isOpenDatabase</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">code</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'已经打开数据库。'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
			<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">code</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'没有打开数据库！'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 关闭数据库</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">closeDB</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
		plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">closeDatabase</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
			<span class="token operator">...</span>config<span class="token punctuation">,</span>
			<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'closeDatabase success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">code</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'关闭数据库成功。'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">code</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'关闭数据库失败：'</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行SQL语句</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">executeSQL</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span>sql</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
		plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">executeSql</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
			<span class="token operator">...</span>config<span class="token punctuation">,</span>
			<span class="token literal-property property">sql</span><span class="token operator">:</span> sql<span class="token punctuation">,</span>
			<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">code</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">msg</span><span class="token operator">:</span>e<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">code</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'执行SQL失败：'</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 查询SQL语句</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">selectSQL</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span>sql</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
		plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">selectSql</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
			<span class="token operator">...</span>config<span class="token punctuation">,</span>
			<span class="token literal-property property">sql</span><span class="token operator">:</span> sql<span class="token punctuation">,</span>
			<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">code</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">data</span><span class="token operator">:</span>data<span class="token punctuation">,</span><span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'查询SQL成功'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">code</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'查询SQL失败: '</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token comment">// 执行事务(oper)begin,commit,rollback</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">transaction</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span>oper</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
		plus<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
			<span class="token operator">...</span>config<span class="token punctuation">,</span>
			<span class="token literal-property property">operation</span><span class="token operator">:</span>oper<span class="token punctuation">,</span>
			<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">code</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'事务 '</span><span class="token operator">+</span>oper<span class="token operator">+</span><span class="token string">' 成功'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">code</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token literal-property property">msg</span><span class="token operator">:</span><span class="token string">'事务 '</span><span class="token operator">+</span>oper<span class="token operator">+</span><span class="token string">' 失败：'</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>closeDB<span class="token punctuation">,</span>openDB<span class="token punctuation">,</span>isOpen<span class="token punctuation">,</span>executeSQL<span class="token punctuation">,</span>selectSQL<span class="token punctuation">,</span>transaction<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>4、在主程序中我们引用这个js,在pages/index/index.vue的script</p> 
<pre><code class="prism language-js"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">import</span> sql2 <span class="token keyword">from</span> <span class="token string">'@/common/SQLite32.js'</span>
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'Hello'</span><span class="token punctuation">,</span>
				<span class="token literal-property property">config</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'first'</span><span class="token punctuation">,</span><span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'_doc/test.db'</span><span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token comment">//this.openDB();</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p>5、在methods之中增加事件如下：</p> 
<pre><code class="prism language-js">			<span class="token comment">//==========================第2代接口==================</span>
			<span class="token keyword">async</span> <span class="token function">onclickOpenDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">let</span> res<span class="token operator">=</span><span class="token keyword">await</span> sql2<span class="token punctuation">.</span><span class="token function">openDB</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>code<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'打开成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">else</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">//</span>
			<span class="token keyword">async</span> <span class="token function">onclickIsOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">let</span> res<span class="token operator">=</span><span class="token keyword">await</span> sql2<span class="token punctuation">.</span><span class="token function">isOpen</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>code<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'已经打开'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">else</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token keyword">async</span> <span class="token function">onclickCloseDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">let</span> res<span class="token operator">=</span><span class="token keyword">await</span> sql2<span class="token punctuation">.</span><span class="token function">closeDB</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token keyword">async</span> <span class="token function">onclickExecuteSQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">let</span> sqltxt<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'create table if not exists database("where" CHAR(110),"location" CHAR(100),"age" INT(11))'</span><span class="token punctuation">,</span>
							<span class="token string">"insert into database values('北京','安乐林','11')"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token keyword">let</span> res<span class="token operator">=</span><span class="token keyword">await</span> sql2<span class="token punctuation">.</span><span class="token function">executeSQL</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">,</span>sqltxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token keyword">async</span> <span class="token function">onclickSelectSQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">let</span> sqltxt<span class="token operator">=</span><span class="token string">'select * from database'</span><span class="token punctuation">;</span>
				<span class="token keyword">let</span> res<span class="token operator">=</span><span class="token keyword">await</span> sql2<span class="token punctuation">.</span><span class="token function">selectSQL</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">,</span>sqltxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token keyword">async</span> <span class="token function">onclickTransBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">let</span> res<span class="token operator">=</span><span class="token keyword">await</span> sql2<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">,</span><span class="token string">'begin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token keyword">async</span> <span class="token function">onclickEditDB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">let</span> sqltxt<span class="token operator">=</span><span class="token string">"update database set age=age+1 "</span><span class="token punctuation">;</span>
				<span class="token keyword">let</span> res<span class="token operator">=</span><span class="token keyword">await</span> sql2<span class="token punctuation">.</span><span class="token function">executeSQL</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">,</span>sqltxt<span class="token punctuation">)</span><span class="token punctuation">;</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token keyword">async</span> <span class="token function">onclickTransCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">let</span> res<span class="token operator">=</span><span class="token keyword">await</span> sql2<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">,</span><span class="token string">'commit'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token keyword">async</span> <span class="token function">onclickTransRollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token keyword">let</span> res<span class="token operator">=</span><span class="token keyword">await</span> sql2<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">,</span><span class="token string">'rollback'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		
</code></pre> 
<p>6、小结：本文只是初谈，所有代码，已上传 https://gitcode.net/sinat_26699091/SQLiteDemo</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1ed5a32fec5d0edcc600031022035ecd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python的装饰器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ccd84e82bf56e52eeef258ee0f0c7570/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数仓建设规范</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>