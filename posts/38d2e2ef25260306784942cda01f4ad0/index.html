<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>centos安装hadoop环境（编写中） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="centos安装hadoop环境（编写中）" />
<meta property="og:description" content="一、环境准备 服务集群机器 描述：使用Oracle VM VirtualBox搭建部署的五台虚拟机，使用系统Centos(2009)
192.168.1.11 bigdata1
192.168.1.12 bigdata2
192.168.1.13 bigdata3
192.168.1.14 bigdata4
192.168.1.15 bigdata5
ssh免登录的设置 在每台机器上分别执行ssh-keygen -t rsa，一直按住回车键。
在bigdata 192.168.1.11的机器上进行公钥的追加操作 cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys
将其他机器上生成的公钥拷贝到192.168.1.11的~/.ssh目录，生成id_rsa.pub12至15的文件
scp -r ~/.ssh/id_rsa.pub root@192.168.1.11:~/.ssh/id_rsa.pub12 scp -r ~/.ssh/id_rsa.pub root@192.168.1.11:~/.ssh/id_rsa.pub13
scp -r ~/.ssh/id_rsa.pub root@192.168.1.11:~/.ssh/id_rsa.pub14
scp -r ~/.ssh/id_rsa.pub root@192.168.1.11:~/.ssh/id_rsa.pub15
执行上面命令后在bigdata1的~/.ssh目录下ls，可看到如下文件
把相关文件追加到authorized_keys后，再进行分发。
cat id_rsa.pub12 &gt;&gt; authorized_keys
cat id_rsa.pub13 &gt;&gt; authorized_keys
cat id_rsa.pub14 &gt;&gt; authorized_keys
cat id_rsa.pub15 &gt;&gt; authorized_keys
chmod 600 authorized_keys （设置读写的权限）
进行分发的操作
scp -r ~/.ssh/authorized_keys root@192.168.1.12:~/.ssh" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/38d2e2ef25260306784942cda01f4ad0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-22T15:27:55+08:00" />
<meta property="article:modified_time" content="2022-10-22T15:27:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">centos安装hadoop环境（编写中）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、环境准备</h2> 
<h3>服务集群机器</h3> 
<p>描述：使用Oracle VM VirtualBox搭建部署的五台虚拟机，使用系统Centos(2009)</p> 
<p>192.168.1.11 bigdata1<br> 192.168.1.12 bigdata2<br> 192.168.1.13 bigdata3<br> 192.168.1.14 bigdata4<br> 192.168.1.15 bigdata5</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/7c/9d/gYnJuNje_o.jpg"></p> 
<p></p> 
<h3>ssh免登录的设置</h3> 
<p>在每台机器上分别执行ssh-keygen -t rsa，一直按住回车键。</p> 
<p>在bigdata 192.168.1.11的机器上进行公钥的追加操作  cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</p> 
<p>将其他机器上生成的公钥拷贝到192.168.1.11的~/.ssh目录，生成id_rsa.pub12至15的文件</p> 
<p>scp -r ~/.ssh/id_rsa.pub root@192.168.1.11:~/.ssh/id_rsa.pub12 <br> scp -r ~/.ssh/id_rsa.pub root@192.168.1.11:~/.ssh/id_rsa.pub13<br> scp -r ~/.ssh/id_rsa.pub root@192.168.1.11:~/.ssh/id_rsa.pub14<br> scp -r ~/.ssh/id_rsa.pub root@192.168.1.11:~/.ssh/id_rsa.pub15</p> 
<p>执行上面命令后在bigdata1的~/.ssh目录下ls，可看到如下文件<br><img alt="" src="https://images2.imgbox.com/7e/4f/xmM6r0RR_o.png"></p> 
<p> 把相关文件追加到authorized_keys后，再进行分发。</p> 
<p>cat id_rsa.pub12 &gt;&gt; authorized_keys</p> 
<p>cat id_rsa.pub13 &gt;&gt; authorized_keys</p> 
<p>cat id_rsa.pub14 &gt;&gt; authorized_keys</p> 
<p>cat id_rsa.pub15 &gt;&gt; authorized_keys</p> 
<p>chmod 600 authorized_keys （设置读写的权限）</p> 
<p>进行分发的操作</p> 
<p>scp -r ~/.ssh/authorized_keys root@192.168.1.12:~/.ssh<br> scp -r ~/.ssh/authorized_keys root@192.168.1.13:~/.ssh<br> scp -r ~/.ssh/authorized_keys root@192.168.1.14:~/.ssh<br> scp -r ~/.ssh/authorized_keys root@192.168.1.15:~/.ssh</p> 
<p>为每台机器设置 /etc/hosts配置</p> 
<p><br> 127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4<br> ::1         localhost localhost.localdomain localhost6 localhost6.localdomain6<br> 192.168.1.11 bigdata1<br> 192.168.1.12 bigdata2<br> 192.168.1.13 bigdata3<br> 192.168.1.14 bigdata4<br> 192.168.1.15 bigdata5</p> 
<p></p> 
<h2>二、安装部署</h2> 
<h3>安装JDK环境</h3> 
<p>每台机器上安装JDK环境，JDK的版本是jdk8</p> 
<p>rpm -ivh jdk-8u321-linux-x64.rpm</p> 
<p>配置环境变量</p> 
<p>在每台机器上执行vim /etc/profile</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b3/32/VIHXk9WI_o.jpg"></p> 
<p></p> 
<p>export JAVA_HOME=/usr/java/jdk1.8.0_321-amd64<br> export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar<br> export PATH=$PATH:$JAVA_HOME/bin</p> 
<p>使配置生效</p> 
<p>source /etc/profile</p> 
<p></p> 
<h3>三、安装zookeeper集群</h3> 
<p>安装目录 /home/bigdata</p> 
<p>下载Zookeeper并安装配置</p> 
<p>复制配置文件</p> 
<p>cp -r /home/bigdata/zookeeper/conf/zoo_sample.cfg /home/bigdata/zookeeper/conf/zoo.cfg</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/be/26/0auq46c6_o.jpg"></p> 
<p> zoo.cfg的内容</p> 
<p># The number of milliseconds of each tick<br> tickTime=2000<br> # The number of ticks that the initial <br> # synchronization phase can take<br> initLimit=10<br> # The number of ticks that can pass between <br> # sending a request and getting an acknowledgement<br> syncLimit=5<br> # the directory where the snapshot is stored.<br> # do not use /tmp for storage, /tmp here is just <br> # example sakes.<br> dataDir=/home/bigdata/zookeeper/data<br> dataLogDir=/home/bigdata/zookeeper/logs<br> # the port at which the clients will connect<br> clientPort=2181<br> # the maximum number of client connections.<br> # increase this if you need to handle more clients<br> maxClientCnxns=100<br> #<br> # Be sure to read the maintenance section of the <br> # administrator guide before turning on autopurge.<br> #<br> # http://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_maintenance<br> #<br> # The number of snapshots to retain in dataDir<br> autopurge.snapRetainCount=3<br> # Purge task interval in hours<br> # Set to "0" to disable auto purge feature<br> autopurge.purgeInterval=1<br> server.1=192.168.1.11:2888:3888<br> server.2=192.168.1.12:2888:3888<br> server.3=192.168.1.12:2888:3888<br> server.4=192.168.1.14:2888:3888<br> server.5=192.168.1.15:2888:3888<br> ## Metrics Providers<br> #<br> # https://prometheus.io Metrics Exporter<br> #metricsProvider.className=org.apache.zookeeper.metrics.prometheus.PrometheusMetricsProvider<br> #metricsProvider.httpPort=7000<br> #metricsProvider.exportJvmInfo=true</p> 
<p>将整理好的zookeeper目录进行分发</p> 
<p>scp -r /home/bigdata/zookeeper/ root@192.168.1.12:/home/bigdata/<br> scp -r /home/bigdata/zookeeper/ root@192.168.1.13:/home/bigdata/<br> scp -r /home/bigdata/zookeeper/ root@192.168.1.14:/home/bigdata/<br> scp -r /home/bigdata/zookeeper/ root@192.168.1.15:/home/bigdata/</p> 
<p>为每台机器分别设置myid值</p> 
<p>echo "1" &gt; /home/bigdata/zookeeper/data/myid</p> 
<p>echo "2" &gt; /home/bigdata/zookeeper/data/myid</p> 
<p>echo "3" &gt; /home/bigdata/zookeeper/data/myid</p> 
<p>echo "4" &gt; /home/bigdata/zookeeper/data/myid</p> 
<p>echo "5" &gt; /home/bigdata/zookeeper/data/myid</p> 
<p>设置zookeeper的环境变量，在/etc/profile中追加内容</p> 
<p>export ZOOKEEPER=/home/bigdata/zookeeper</p> 
<p>export PATH=$PATH:$JAVA_HOME/bin:$ZOOKEEPER/bin</p> 
<p></p> 
<p>启动zk的命令，在每台机器上执行<br> /home/bigdata/zookeeper/bin/zkServer.sh restart<br> /home/bigdata/zookeeper/bin/zkServer.sh stop</p> 
<p>检查是否启动成功    ps -ef | grep zookeeper</p> 
<p>输出下面的内容表示启动成功</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/cf/b1/LJFJCSCe_o.jpg"></p> 
<h3>四、安装hadoop环境</h3> 
<p>配置相关的环境变量，source /etc/profile</p> 
<p>export YARN_NODEMANAGER_USER=root<br> export YARN_RESOURCEMANAGER_USER=root<br> export HDFS_DATANODE_USER=root<br> export HDFS_JOURNALNODE_USER=root<br> export HDFS_ZKFC_USER=root<br> export HDFS_NAMENODE_USER=root</p> 
<p>export PATH USER LOGNAME MAIL HOSTNAME HISTSIZE HISTCONTROL<br> export JAVA_HOME=/usr/java/jdk1.8.0_321-amd64<br> export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar<br> export ZOOKEEPER=/home/bigdata/zookeeper</p> 
<p>export PATH=$PATH:$JAVA_HOME/bin:$ZOOKEEPER/bin</p> 
<p>解压hadoop文件并重命名文件夹，使用最新的版本是3.3.1</p> 
<p>tar -zxvf hadoop-3.3.1.tar.gz  &amp;&amp; mv hadoop-3.3.1 hadoop</p> 
<p>官方XML配置文件的地址<a href="https://hadoop.apache.org/docs/stable/" rel="nofollow" title="Hadoop – Apache Hadoop 3.3.1">Hadoop – Apache Hadoop 3.3.1</a></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/a0/9e/0VZwx4Fm_o.jpg"></p> 
<h4 style="text-align:center;"> core-site.xm</h4> 
<p><strong>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br> &lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;<br> &lt;!--<br>   Licensed under the Apache License, Version 2.0 (the "License");<br>   you may not use this file except in compliance with the License.<br>   You may obtain a copy of the License at</strong></p> 
<p><strong>    http://www.apache.org/licenses/LICENSE-2.0</strong></p> 
<p><strong>  Unless required by applicable law or agreed to in writing, software<br>   distributed under the License is distributed on an "AS IS" BASIS,<br>   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.<br>   See the License for the specific language governing permissions and<br>   limitations under the License. See accompanying LICENSE file.<br> --&gt;</strong></p> 
<p><strong>&lt;!-- Put site-specific property overrides in this file. --&gt;<br> &lt;!-- 官网配置文件的地址--&gt;<br> &lt;!-- https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/core-default.xml --&gt;</strong></p> 
<p><strong>&lt;configuration&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;fs.defaultFS&lt;/name&gt;<br>         &lt;value&gt;hdfs://liebe&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;<br>         &lt;value&gt;/home/bigdata/hadoop/tmp&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!--webUI展示时的用户--&gt;<br>     &lt;property&gt; <br>         &lt;name&gt;hadoop.http.staticuser.user&lt;/name&gt;            <br>         &lt;value&gt;root&lt;/value&gt; <br>     &lt;/property&gt;<br>      &lt;!-- 指定zookeeper地址 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt;<br>         &lt;value&gt;bigdata1:2181,bigdata2:2181,bigdata3:2181,bigdata4:2181,bigdata5:2181&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- NN 连接 JN 重试次数，默认是 10 次 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;ipc.client.connect.max.retries&lt;/name&gt;<br>         &lt;value&gt;20&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- 重试时间间隔，默认 1s --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;ipc.client.connect.retry.interval&lt;/name&gt;<br>         &lt;value&gt;2000&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- hadoop链接zookeeper的超时时长设置 --&gt;<br>      &lt;property&gt;<br>          &lt;name&gt;ha.zookeeper.session-timeout.ms&lt;/name&gt;<br>          &lt;value&gt;30000&lt;/value&gt;<br>          &lt;description&gt;ms&lt;/description&gt;<br>      &lt;/property&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;fs.trash.interval&lt;/name&gt;<br>         &lt;value&gt;1440&lt;/value&gt;<br>     &lt;/property&gt;<br> &lt;/configuration&gt;</strong></p> 
<h4 style="text-align:center;">hdfs-site.xml</h4> 
<p><strong>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br> &lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;<br> &lt;!--<br>   Licensed under the Apache License, Version 2.0 (the "License");<br>   you may not use this file except in compliance with the License.<br>   You may obtain a copy of the License at</strong></p> 
<p><strong>    http://www.apache.org/licenses/LICENSE-2.0</strong></p> 
<p><strong>  Unless required by applicable law or agreed to in writing, software<br>   distributed under the License is distributed on an "AS IS" BASIS,<br>   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.<br>   See the License for the specific language governing permissions and<br>   limitations under the License. See accompanying LICENSE file.<br> --&gt;</strong></p> 
<p><strong>&lt;!-- Put site-specific property overrides in this file. --&gt;<br> &lt;!-- 官网配置文件的地址--&gt;<br> &lt;!-- https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-hdfs/hdfs-default.xml --&gt;</strong></p> 
<p><strong>&lt;configuration&gt;<br>   &lt;property&gt;<br>     &lt;!-- 为namenode集群定义一个services name --&gt;<br>     &lt;name&gt;dfs.nameservices&lt;/name&gt;<br>     &lt;value&gt;liebe&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;!-- nameservice 包含哪些namenode，为各个namenode起名 --&gt;<br>     &lt;name&gt;dfs.ha.namenodes.liebe&lt;/name&gt;<br>     &lt;value&gt;cc1,cc2,cc3&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;!--  名为cc1的namenode 的rpc地址和端口号，rpc用来和datanode通讯 --&gt;<br>     &lt;name&gt;dfs.namenode.rpc-address.liebe.cc1&lt;/name&gt;<br>     &lt;value&gt;bigdata1:8020&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;!-- 名为cc2的namenode 的rpc地址和端口号，rpc用来和datanode通讯  --&gt;<br>     &lt;name&gt;dfs.namenode.rpc-address.liebe.cc2&lt;/name&gt;<br>     &lt;value&gt;bigdata2:8020&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;!-- 名为cc3的namenode 的rpc地址和端口号，rpc用来和datanode通讯  --&gt;<br>     &lt;name&gt;dfs.namenode.rpc-address.liebe.cc3&lt;/name&gt;<br>     &lt;value&gt;bigdata3:8020&lt;/value&gt;<br>   &lt;/property&gt;  <br>   &lt;property&gt;<br>     &lt;!--名为cc1的namenode 的http地址和端口号，web客户端 --&gt;<br>     &lt;name&gt;dfs.namenode.http-address.liebe.cc1&lt;/name&gt;<br>     &lt;value&gt;bigdata1:9870&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;!--名为cc2的namenode 的http地址和端口号，web客户端 --&gt;<br>     &lt;name&gt;dfs.namenode.http-address.liebe.cc2&lt;/name&gt;<br>     &lt;value&gt;bigdata2:9870&lt;/value&gt;<br>   &lt;/property&gt;<br>    &lt;property&gt;<br>     &lt;!--名为cc3的namenode 的http地址和端口号，web客户端 --&gt;<br>     &lt;name&gt;dfs.namenode.http-address.liebe.cc3&lt;/name&gt;<br>     &lt;value&gt;bigdata3:9870&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;!--  namenode间用于共享编辑日志的journal节点列表 --&gt;<br>     &lt;!-- 指定NameNode的edits元数据的共享存储位置。也就是JournalNode列表<br>                                             该url的配置格式：qjournal://host1:port1;host2:port2;host3:port3/journalId<br>         journalId推荐使用nameservice，默认端口号是：8485 --&gt;<br>     &lt;name&gt;dfs.namenode.shared.edits.dir&lt;/name&gt;<br>     &lt;value&gt;qjournal://bigdata1:8485;bigdata2:8485;bigdata3:8485/liebe&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;!--  journalnode 上用于存放edits日志的目录 --&gt;<br>     &lt;name&gt;dfs.journalnode.edits.dir&lt;/name&gt;<br>     &lt;value&gt;${hadoop.tmp.dir}/jn&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;!--  客户端连接可用状态的NameNode所用的代理类 --&gt;<br>     &lt;name&gt;dfs.client.failover.proxy.provider.liebe&lt;/name&gt;<br>     &lt;value&gt;org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;!-- 配置隔离机制方法，多个机制用换行分割，即每个机制暂用一行 --&gt;<br>     &lt;name&gt;dfs.ha.fencing.methods&lt;/name&gt;<br>     &lt;value&gt;<br>            sshfence<br>            shell(/bin/true)<br>     &lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;!-- 使用隔离机制时需要 ssh 秘钥登录--&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;dfs.ha.fencing.ssh.private-key-files&lt;/name&gt;<br>         &lt;value&gt;/home/root/.ssh/id_rsa&lt;/value&gt;<br>     &lt;/property&gt;  <br>    &lt;!-- journalnode集群之间通信的超时时间 --&gt;<br>   &lt;property&gt;<br>     &lt;name&gt;dfs.qjournal.start-segment.timeout.ms&lt;/name&gt;<br>     &lt;value&gt;60000&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;!-- 指定副本数 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;dfs.replication&lt;/name&gt;<br>         &lt;value&gt;3&lt;/value&gt;<br>     &lt;/property&gt;<br>   &lt;!--namenode路径--&gt;<br>   &lt;property&gt;<br>         &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;<br>        &lt;value&gt;file://${hadoop.tmp.dir}/name&lt;/value&gt;<br>     &lt;/property&gt;<br>   &lt;!--datanode路径--&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;<br>        &lt;value&gt;file://${hadoop.tmp.dir}/data&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- 开启NameNode失败自动切换 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;dfs.ha.automatic-failover.enabled&lt;/name&gt;<br>         &lt;value&gt;true&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- A switch to turn on/off tracking DataNode peer statistics. --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;dfs.datanode.peer.stats.enabled&lt;/name&gt;<br>         &lt;value&gt;true&lt;/value&gt;<br>     &lt;/property&gt;</strong></p> 
<p><strong>    &lt;!-- The timeout in seconds of calling rollEdits RPC on Active NN. --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;dfs.ha.tail-edits.rolledits.timeout&lt;/name&gt;<br>         &lt;value&gt;120&lt;/value&gt;<br>     &lt;/property&gt;<br> &lt;/configuration&gt;</strong><br>  </p> 
<h4 style="text-align:center;">yarn-site.xml</h4> 
<p></p> 
<p><strong>&lt;?xml version="1.0"?&gt;<br> &lt;!--<br>   Licensed under the Apache License, Version 2.0 (the "License");<br>   you may not use this file except in compliance with the License.<br>   You may obtain a copy of the License at</strong></p> 
<p><strong>    http://www.apache.org/licenses/LICENSE-2.0</strong></p> 
<p><strong>  Unless required by applicable law or agreed to in writing, software<br>   distributed under the License is distributed on an "AS IS" BASIS,<br>   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.<br>   See the License for the specific language governing permissions and<br>   limitations under the License. See accompanying LICENSE file.<br> --&gt;<br> &lt;configuration&gt;<br>   &lt;property&gt;<br>     &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;<br>     &lt;value&gt;mapreduce_shuffle&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;name&gt;yarn.resourcemanager.auto-update.containers&lt;/name&gt;<br>     &lt;value&gt;true&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;name&gt;yarn.webapp.api-service.enable&lt;/name&gt;<br>     &lt;value&gt;true&lt;/value&gt;<br>   &lt;/property&gt;<br>     <br>   &lt;property&gt;<br>     &lt;name&gt;yarn.log-aggregation-enable&lt;/name&gt;<br>     &lt;value&gt;true&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;name&gt;yarn.log-aggregation.retain-seconds&lt;/name&gt;<br>     &lt;value&gt;106800&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;!--  启用resourcemanager的ha功能 --&gt;<br>     &lt;name&gt;yarn.resourcemanager.ha.enabled&lt;/name&gt;<br>     &lt;value&gt;true&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;!--  为resourcemanage ha 集群起个id --&gt;<br>     &lt;name&gt;yarn.resourcemanager.cluster-id&lt;/name&gt;<br>     &lt;value&gt;yarn-liebe&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;property&gt;<br>     &lt;!--  指定resourcemanger ha 有哪些节点名 --&gt;<br>     &lt;name&gt;yarn.resourcemanager.ha.rm-ids&lt;/name&gt;<br>     &lt;value&gt;rm1,rm2,rm3&lt;/value&gt;<br>   &lt;/property&gt;<br>   &lt;!-- ========== rm1 的配置 ========== --&gt;<br>     &lt;!-- 指定 rm1 的主机名 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.hostname.rm1&lt;/name&gt;<br>         &lt;value&gt;bigdata1&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- 指定 rm1 的 web 端地址 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.webapp.address.rm1&lt;/name&gt;<br>         &lt;value&gt;bigdata1:8088&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- 指定 rm1 的内部通信地址 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.address.rm1&lt;/name&gt;<br>         &lt;value&gt;bigdata1:8032&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- 指定 AM 向 rm1 申请资源的地址 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.scheduler.address.rm1&lt;/name&gt;<br>         &lt;value&gt;bigdata1:8030&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- 指定供 NM 连接的地址 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.resource-tracker.address.rm1&lt;/name&gt;<br>         &lt;value&gt;bigdata1:8031&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- ========== rm2 的配置 ========== --&gt;<br>     &lt;!-- 指定 rm2 的主机名 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.hostname.rm2&lt;/name&gt;<br>         &lt;value&gt;bigdata2&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.webapp.address.rm2&lt;/name&gt;<br>         &lt;value&gt;bigdata2:8088&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.address.rm2&lt;/name&gt;<br>         &lt;value&gt;bigdata2:8032&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.scheduler.address.rm2&lt;/name&gt;<br>         &lt;value&gt;bigdata2:8030&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.resource-tracker.address.rm2&lt;/name&gt;<br>         &lt;value&gt;bigdata2:8031&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- ========== rm3 的配置 ========== --&gt;<br>     &lt;!-- 指定 rm1 的主机名 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.hostname.rm3&lt;/name&gt;<br>         &lt;value&gt;bigdata3&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- 指定 rm1 的 web 端地址 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.webapp.address.rm3&lt;/name&gt;<br>         &lt;value&gt;bigdata3:8088&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- 指定 rm1 的内部通信地址 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.address.rm3&lt;/name&gt;<br>         &lt;value&gt;bigdata3:8032&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- 指定 AM 向 rm1 申请资源的地址 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.scheduler.address.rm3&lt;/name&gt;<br>         &lt;value&gt;bigdata3:8030&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- 指定供 NM 连接的地址 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.resource-tracker.address.rm3&lt;/name&gt;<br>         &lt;value&gt;bigdata3:8031&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;property&gt;<br>     &lt;!--  指定resourcemanger ha 所用的zookeeper 节点 --&gt;<br>         &lt;name&gt;yarn.resourcemanager.zk-address&lt;/name&gt;<br>         &lt;value&gt;bigdata1:2181,bigdata2:2181,bigdata3:2181,bigdata4:2181,bigdata5:2181&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;property&gt;<br>     &lt;!--  --&gt;<br>         &lt;name&gt;yarn.resourcemanager.recovery.enabled&lt;/name&gt;<br>         &lt;value&gt;true&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- 制定resourcemanager的状态信息存储在zookeeper集群上 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;yarn.resourcemanager.store.class&lt;/name&gt;<br>         &lt;value&gt;org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;property&gt;<br>       &lt;name&gt;yarn.log.server.url&lt;/name&gt;<br>       &lt;value&gt;http://bigdata1:19888/jobhistory/logs/&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- 环境变量的继承 --&gt;<br>     &lt;property&gt;<br>       &lt;name&gt;yarn.nodemanager.env-whitelist&lt;/name&gt;<br>       &lt;value&gt;JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLAS<br> SPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;property&gt;<br>       &lt;name&gt;yarn.resourcemanager.am.max-attempts&lt;/name&gt;<br>       &lt;value&gt;5&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!--<br>     &lt;property&gt;<br>       &lt;name&gt;yarn.nodemanager.recovery.enabled&lt;/name&gt;<br>       &lt;value&gt;true&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;property&gt;<br>       &lt;name&gt;yarn.nodemanager.recovery.dir&lt;/name&gt;<br>       &lt;value&gt;${hadoop.tmp.dir}/yarn-nm-recovery&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;property&gt;<br>       &lt;name&gt;yarn.nodemanager.address&lt;/name&gt;<br>       &lt;value&gt;192.168.1.11&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;property&gt;<br>       &lt;name&gt;yarn.nodemanager.hostname&lt;/name&gt;<br>       &lt;value&gt;bigdata1&lt;/value&gt;<br>     &lt;/property&gt;<br>     --&gt;<br> &lt;/configuration&gt;</strong><br>  </p> 
<p></p> 
<h4 style="text-align:center;">workers</h4> 
<p><strong>bigdata1<br> bigdata2<br> bigdata3<br> bigdata4<br> bigdata5</strong><br>  </p> 
<p></p> 
<h4 style="text-align:center;"><strong>mapre-site.xml</strong></h4> 
<p></p> 
<p><strong>&lt;?xml version="1.0"?&gt;<br> &lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;<br> &lt;configuration&gt;<br>     &lt;!-- 配置 MapReduce Applications --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;mapreduce.framework.name&lt;/name&gt;<br>         &lt;value&gt;yarn&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- JobHistory Server ============================================================== --&gt;<br>     &lt;!-- 配置 MapReduce JobHistory Server 地址 ，默认端口10020 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;<br>         &lt;value&gt;bigdata1:10020&lt;/value&gt;<br>     &lt;/property&gt;<br>     &lt;!-- 配置 MapReduce JobHistory Server web ui 地址， 默认端口19888 --&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;<br>         &lt;value&gt;bigdata1:19888&lt;/value&gt;<br>     &lt;/property&gt;<br>  <br>     &lt;!-- 配置 Map段输出的压缩,snappy--&gt;<br>     &lt;property&gt;<br>         &lt;name&gt;mapreduce.map.output.compress&lt;/name&gt; <br>         &lt;value&gt;true&lt;/value&gt;<br>     &lt;/property&gt;              <br>    &lt;property&gt;<br>        &lt;name&gt;mapreduce.map.output.compress.codec&lt;/name&gt; <br>        &lt;value&gt;org.apache.hadoop.io.compress.SnappyCodec&lt;/value&gt;<br>     &lt;/property&gt;<br> &lt;/configuration&gt;</strong><br>  </p> 
<p></p> 
<p><strong>vim /home/bigdata/hadoop/etc/hadoop/hadoop-env.sh</strong></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/e5/f5/AwlKQSmJ_o.jpg"></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p>对bigdata1下/home/bigdata/hadoop文件夹进行分发操作</p> 
<p>scp -r /home/bigdata/hadoop/ root@192.168.1.12:/home/bigdata<br> scp -r /home/bigdata/hadoop/ root@192.168.1.13:/home/bigdata<br> scp -r /home/bigdata/hadoop/ root@192.168.1.14:/home/bigdata<br> scp -r /home/bigdata/hadoop/ root@192.168.1.15:/home/bigdata</p> 
<p>Hadoop集群的启动</p> 
<p>/home/bigdata/hadoop/sbin/start-all.sh</p> 
<p>启动完成，查看logs目录下的日志信息，出现错误，逐步排查解决。</p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<h2>使用验证</h2> 
<p>java.io.IOException: NameNode is not formatted.</p> 
<p>rm -rf /home/bigdata/hadoop/tmp/data/*<br> rm -rf /home/bigdata/hadoop/tmp/name/*<br> rm -rf /home/bigdata/hadoop/tmp/jn/*</p> 
<p>rm -rf /home/bigdata/hadoop/tmp/dfs/data/*<br> rm -rf /home/bigdata/hadoop/tmp/dfs/dn/*<br> rm -rf /home/bigdata/hadoop/tmp/dfs/name/*<br> rm -rf /home/bigdata/hadoop/tmp/dfs/jn/*<br> rm -rf /home/bigdata/hadoop/tmp/dfs/nn/*</p> 
<p>/home/bigdata/hadoop/bin/hdfs namenode -format</p> 
<p><img alt="" src="https://images2.imgbox.com/0d/13/bvtUixrM_o.jpg"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/c5/7a/FG4i6PaA_o.jpg"></p> 
<p style="text-align:center;"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/c7/72/h4A66yMk_o.jpg"></p> 
<p style="text-align:center;"> <img alt="" src="https://images2.imgbox.com/ef/9d/GraEaMRv_o.jpg"></p> 
<p></p> 
<p></p> 
<p style="text-align:center;"> <img alt="" src="https://images2.imgbox.com/45/7f/mF1QLp1O_o.jpg"></p> 
<h2>五、部署spark</h2> 
<h3>5.1、配置目录 ${spark_home}/conf</h3> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/d9/3b/9w4y8qs4_o.jpg"></p> 
<h3> 5.2、workers</h3> 
<pre><code class="hljs">node88
node89
node99</code></pre> 
<h3>5.3、spark-env.sh</h3> 
<pre><code class="hljs">#!/usr/bin/env bash

#
# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#    http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

# This file is sourced when running various Spark programs.
# Copy it as spark-env.sh and edit that to configure Spark for your site.
export SPARK_HOME=/home/spark-3.3.0-bin-hadoop3
#locally模式
# Options read when launching programs locally with
# ./bin/run-example or ./bin/spark-submit
# - HADOOP_CONF_DIR, to point Spark towards Hadoop configuration files
# - SPARK_LOCAL_IP, to set the IP address Spark binds to on this node
# - SPARK_PUBLIC_DNS, to set the public dns name of the driver program

# Options read by executors and drivers running inside the cluster
# - SPARK_LOCAL_IP, to set the IP address Spark binds to on this node
# - SPARK_PUBLIC_DNS, to set the public DNS name of the driver program
# - SPARK_LOCAL_DIRS, storage directories to use on this node for shuffle and RDD data
# - MESOS_NATIVE_JAVA_LIBRARY, to point to your libmesos.so if you use Mesos

# Options read in any mode
export SPARK_CONF_DIR=${SPARK_HOME}/conf
export SPARK_EXECUTOR_CORES=1
export SPARK_EXECUTOR_MEMORY=1G
export SPARK_DRIVER_MEMORY=1G

# Options read in any cluster manager using HDFS
export HADOOP_CONF_DIR=/home/hadoop-3.3.4/etc/hadoop

# Options read in YARN client/cluster mode
export YARN_CONF_DIR=/home/hadoop-3.3.4/etc/hadoop

export SPARK_HISTORY_OPTS="
-Dspark.history.ui.port=18080
-Dspark.history.fs.logDirectory=hdfs://liebe/spark/history-eventLog
-Dspark.history.retainedApplications=30"

# Options for the daemons used in the standalone deploy mode
# - SPARK_MASTER_HOST, to bind the master to a different IP address or hostname
# - SPARK_MASTER_PORT / SPARK_MASTER_WEBUI_PORT, to use non-default ports for the master
# - SPARK_MASTER_OPTS, to set config properties only for the master (e.g. "-Dx=y")
# - SPARK_WORKER_CORES, to set the number of cores to use on this machine
# - SPARK_WORKER_MEMORY, to set how much total memory workers have to give executors (e.g. 1000m, 2g)
# - SPARK_WORKER_PORT / SPARK_WORKER_WEBUI_PORT, to use non-default ports for the worker
# - SPARK_WORKER_DIR, to set the working directory of worker processes
# - SPARK_WORKER_OPTS, to set config properties only for the worker (e.g. "-Dx=y")
# - SPARK_DAEMON_MEMORY, to allocate to the master, worker and history server themselves (default: 1g).
# - SPARK_HISTORY_OPTS, to set config properties only for the history server (e.g. "-Dx=y")
# - SPARK_SHUFFLE_OPTS, to set config properties only for the external shuffle service (e.g. "-Dx=y")
# - SPARK_DAEMON_JAVA_OPTS, to set config properties for all daemons (e.g. "-Dx=y")
# - SPARK_DAEMON_CLASSPATH, to set the classpath for all daemons
# - SPARK_PUBLIC_DNS, to set the public dns name of the master or workers

# Options for launcher
# - SPARK_LAUNCHER_OPTS, to set config properties and Java options for the launcher (e.g. "-Dx=y")

# Generic options for the daemons used in the standalone deploy mode
# - SPARK_CONF_DIR      Alternate conf dir. (Default: ${SPARK_HOME}/conf)
# - SPARK_LOG_DIR       Where log files are stored.  (Default: ${SPARK_HOME}/logs)
# - SPARK_LOG_MAX_FILES Max log files of Spark daemons can rotate to. Default is 5.
# - SPARK_PID_DIR       Where the pid file is stored. (Default: /tmp)
# - SPARK_IDENT_STRING  A string representing this instance of spark. (Default: $USER)
# - SPARK_NICENESS      The scheduling priority for daemons. (Default: 0)
# - SPARK_NO_DAEMONIZE  Run the proposed command in the foreground. It will not output a PID file.
# Options for native BLAS, like Intel MKL, OpenBLAS, and so on.
# You might get better performance to enable these options if using native BLAS (see SPARK-21305).
# - MKL_NUM_THREADS=1        Disable multi-threading of Intel MKL
# - OPENBLAS_NUM_THREADS=1   Disable multi-threading of OpenBLAS
</code></pre> 
<h3>5.4、spark-defaults.conf</h3> 
<pre><code class="hljs">#
# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#    http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

# Default system properties included when running spark-submit.
# This is useful for setting default environmental settings.

# Example:
# spark.master                     spark://master:7077
spark.eventLog.enabled           true
spark.eventLog.dir               hdfs://liebe/spark
# spark.serializer                 org.apache.spark.serializer.KryoSerializer
# spark.driver.memory              5g
# spark.executor.extraJavaOptions  -XX:+PrintGCDetails -Dkey=value -Dnumbers="one two three"
</code></pre> 
<h2></h2> 
<h2></h2> 
<h2>六、部署flink</h2> 
<p>安装Flink（<a href="https://dlcdn.apache.org/flink/flink-1.14.3/flink-1.14.3-bin-scala_2.11.tgz" rel="nofollow" title="flink-1.14.3-bin-scala_2.11.tgz">flink-1.14.3-bin-scala_2.11.tgz</a>）</p> 
<p>flink-1.14.3-bin-scala_2.11.tgz  hadoop  tool  zookeeper</p> 
<p>上传安装包文件并进行解压重命名</p> 
<p>需要相关jar文件<a href="https://download.csdn.net/download/TT1024167802/82634170" title="(9条消息) flink-shaded-hadoop-3-uber-3.1.1.7.2.9.0-173-9.0.jar-Hadoop文档类资源-CSDN文库">(9条消息) flink-shaded-hadoop-3-uber-3.1.1.7.2.9.0-173-9.0.jar-Hadoop文档类资源-CSDN文库</a></p> 
<p><a href="https://download.csdn.net/download/TT1024167802/82634314" title="(9条消息) commons-cli-1.5.0.jar-Java文档类资源-CSDN文库">(9条消息) commons-cli-1.5.0.jar-Java文档类资源-CSDN文库</a></p> 
<p>FLINK的SESSION模式启动。</p> 
<p>/home/bigdata/flink/bin/yarn-session.sh -n 2 -s 2 -jm 512 -tm 512 -nm liebe</p> 
<h3 style="text-align:center;"><strong>配置文件flink.conf</strong></h3> 
<p></p> 
<p><strong>################################################################################<br> #  Licensed to the Apache Software Foundation (ASF) under one<br> #  or more contributor license agreements.  See the NOTICE file<br> #  distributed with this work for additional information<br> #  regarding copyright ownership.  The ASF licenses this file<br> #  to you under the Apache License, Version 2.0 (the<br> #  "License"); you may not use this file except in compliance<br> #  with the License.  You may obtain a copy of the License at<br> #<br> #      http://www.apache.org/licenses/LICENSE-2.0<br> #<br> #  Unless required by applicable law or agreed to in writing, software<br> #  distributed under the License is distributed on an "AS IS" BASIS,<br> #  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.<br> #  See the License for the specific language governing permissions and<br> # limitations under the License.<br> ################################################################################</strong></p> 
<p><br><strong>#==============================================================================<br> # Common<br> #==============================================================================</strong></p> 
<p><strong># The external address of the host on which the JobManager runs and can be<br> # reached by the TaskManagers and any clients which want to connect. This setting<br> # is only used in Standalone mode and may be overwritten on the JobManager side<br> # by specifying the --host &lt;hostname&gt; parameter of the bin/jobmanager.sh executable.<br> # In high availability mode, if you use the bin/start-cluster.sh script and setup<br> # the conf/masters file, this will be taken care of automatically. Yarn<br> # automatically configure the host name based on the hostname of the node where the<br> # JobManager runs.</strong></p> 
<p><strong>jobmanager.rpc.address: localhost</strong></p> 
<p><strong># The RPC port where the JobManager is reachable.</strong></p> 
<p><strong>jobmanager.rpc.port: 6123</strong></p> 
<p><br><strong># The total process memory size for the JobManager.<br> #<br> # Note this accounts for all memory usage within the JobManager process, including JVM metaspace and other overhead.</strong></p> 
<p><strong>jobmanager.memory.process.size: 1600m</strong></p> 
<p><br><strong># The total process memory size for the TaskManager.<br> #<br> # Note this accounts for all memory usage within the TaskManager process, including JVM metaspace and other overhead.</strong></p> 
<p><strong>taskmanager.memory.process.size: 1728m</strong></p> 
<p><strong># To exclude JVM metaspace and overhead, please, use total Flink memory size instead of 'taskmanager.memory.process.size'.<br> # It is not recommended to set both 'taskmanager.memory.process.size' and Flink memory.<br> #<br> taskmanager.memory.flink.size: 1280m</strong></p> 
<p><strong># The number of task slots that each TaskManager offers. Each slot runs one parallel pipeline.</strong></p> 
<p><strong>taskmanager.numberOfTaskSlots: 1</strong></p> 
<p><strong># The parallelism used for programs that did not specify and other parallelism.</strong></p> 
<p><strong>parallelism.default: 1</strong></p> 
<p><strong># The default file system scheme and authority.<br> # <br> # By default file paths without scheme are interpreted relative to the local<br> # root file system 'file:///'. Use this to override the default and interpret<br> # relative paths relative to a different file system,<br> # for example 'hdfs://mynamenode:12345'<br> #<br> # fs.default-scheme</strong></p> 
<p><strong>#==============================================================================<br> # High Availability 高可用的配置<br> #==============================================================================</strong></p> 
<p><strong># The high-availability mode. Possible options are 'NONE' or 'zookeeper'.<br> #  设置高可用模式，这里默认选用开启了zookeeper<br> high-availability: zookeeper</strong></p> 
<p><strong># The path where metadata for master recovery is persisted. While ZooKeeper stores<br> # the small ground truth for checkpoint and leader election, this location stores<br> # the larger objects, like persisted dataflow graphs.<br> # <br> # Must be a durable file system that is accessible from all nodes<br> # (like HDFS, S3, Ceph, nfs, ...) <br> # 设置文件系统的存储，这里使用的HDFS</strong>(必要的): JobManager 元数据持久化到文件系统 <code>high-#availability.storageDir</code> 配置的路径中，并且在 ZooKeeper 中只能有一个目录指向此位置。</p> 
<p><br><strong>high-availability.storageDir: hdfs://liebe/flink/ha/</strong></p> 
<p><strong># The list of ZooKeeper quorum peers that coordinate the high-availability<br> # setup. This must be a list of the form:<br> # "host1:clientPort,host2:clientPort,..." (default clientPort: 2181)</strong></p> 
<p><br> # (必要的): <em>ZooKeeper quorum</em> 是一个提供分布式协调服务的复制组。<br> high-availability.zookeeper.quorum: bigdata1:2181,bigdata2:2181,bigdata3:2181,bigdata4:2181,bigdata5:2181</p> 
<p>每个 <code>addressX:port</code> 指的是一个 ZooKeeper 服务器，它可以被 Flink 在给定的地址和端口上访问。</p> 
<p><a href="https://nightlies.apache.org/flink/flink-docs-release-1.14/zh/docs/deployment/config/#high-availability-zookeeper-path-root" rel="nofollow" title="high-availability.zookeeper.path.root">high-availability.zookeeper.path.root</a> (推荐的): <em>ZooKeeper 根节点</em>，集群的所有节点都放在该节点下。</p> 
<pre>high-availability.zookeeper.path.root: /flink</pre> 
<p><a href="https://nightlies.apache.org/flink/flink-docs-release-1.14/zh/docs/deployment/config/#high-availability-cluster-id" rel="nofollow" title="high-availability.cluster-id">high-availability.cluster-id</a> (推荐的): <em>ZooKeeper cluster-id 节点</em>，在该节点下放置集群所需的协调数据。</p> 
<p>high-availability.cluster-id: /default_ns # important: customize per cluster</p> 
<p>重要: 在 YARN、原生 Kubernetes 或其他集群管理器上运行时，不应该手动设置此值。在这些情况下，将自动生成一个集群 ID。如果在未使用集群管理器的机器上运行多个 Flink 高可用集群，则必须为每个集群手动配置单独的集群 ID（cluster-ids）。</p> 
<p><br><strong># ACL options are based on https://zookeeper.apache.org/doc/r3.1.2/zookeeperProgrammers.html#sc_BuiltinACLSchemes<br> # It can be either "creator" (ZOO_CREATE_ALL_ACL) or "open" (ZOO_OPEN_ACL_UNSAFE)<br> # The default value is "open" and it can be changed to "creator" if ZK security is enabled<br> #<br> # high-availability.zookeeper.client.acl: open</strong></p> 
<p><strong>#==============================================================================<br> # Fault tolerance and checkpointing<br> #==============================================================================</strong></p> 
<p><strong># The backend that will be used to store operator state checkpoints if<br> # checkpointing is enabled. Checkpointing is enabled when execution.checkpointing.interval &gt; 0.<br> #<br> # Execution checkpointing related parameters. Please refer to CheckpointConfig and ExecutionCheckpointingOptions for more details.<br> #<br> # execution.checkpointing.interval: 3min<br> # execution.checkpointing.externalized-checkpoint-retention: [DELETE_ON_CANCELLATION, RETAIN_ON_CANCELLATION]<br> # execution.checkpointing.max-concurrent-checkpoints: 1<br> # execution.checkpointing.min-pause: 0<br> # execution.checkpointing.mode: [EXACTLY_ONCE, AT_LEAST_ONCE]<br> # execution.checkpointing.timeout: 10min<br> # execution.checkpointing.tolerable-failed-checkpoints: 0<br> # execution.checkpointing.unaligned: false<br> #<br> # Supported backends are 'jobmanager', 'filesystem', 'rocksdb', or the<br> # &lt;class-name-of-factory&gt;.<br> #<br> # state.backend: filesystem</strong></p> 
<p><strong># Directory for checkpoints filesystem, when using any of the default bundled<br> # state backends.<br> #<br> # state.checkpoints.dir: hdfs://namenode-host:port/flink-checkpoints</strong></p> 
<p><strong># Default target directory for savepoints, optional.<br> #<br> # state.savepoints.dir: hdfs://namenode-host:port/flink-savepoints</strong></p> 
<p><strong># Flag to enable/disable incremental checkpoints for backends that<br> # support incremental checkpoints (like the RocksDB state backend). <br> #<br> # state.backend.incremental: false</strong></p> 
<p><strong># The failover strategy, i.e., how the job computation recovers from task failures.<br> # Only restart tasks that may have been affected by the task failure, which typically includes<br> # downstream tasks and potentially upstream tasks if their produced data is no longer available for consumption.</strong></p> 
<p><strong>jobmanager.execution.failover-strategy: region</strong></p> 
<p><strong>#==============================================================================<br> # Rest &amp; web frontend<br> #==============================================================================</strong></p> 
<p><strong># The port to which the REST client connects to. If rest.bind-port has<br> # not been specified, then the server will bind to this port as well.<br> #<br> rest.port: 8081</strong></p> 
<p><strong># The address to which the REST client will connect to<br> #<br> rest.address: 0.0.0.0</strong></p> 
<p><strong># Port range for the REST and web server to bind to.<br> #<br> #rest.bind-port: 8080-8090</strong></p> 
<p><strong># The address that the REST &amp; web server binds to<br> #<br> rest.bind-address: 0.0.0.0</strong></p> 
<p><strong># Flag to specify whether job submission is enabled from the web-based<br> # runtime monitor. Uncomment to disable.</strong></p> 
<p><strong>web.submit.enable: true</strong></p> 
<p><strong># Flag to specify whether job cancellation is enabled from the web-based<br> # runtime monitor. Uncomment to disable.</strong></p> 
<p><strong>web.cancel.enable: true</strong></p> 
<p><strong>#==============================================================================<br> # Advanced<br> #==============================================================================</strong></p> 
<p><strong># Override the directories for temporary files. If not specified, the<br> # system-specific Java temporary directory (java.io.tmpdir property) is taken.<br> #<br> # For framework setups on Yarn, Flink will automatically pick up the<br> # containers' temp directories without any need for configuration.<br> #<br> # Add a delimited list for multiple directories, using the system directory<br> # delimiter (colon ':' on unix) or a comma, e.g.:<br> #     /data1/tmp:/data2/tmp:/data3/tmp<br> #<br> # Note: Each directory entry is read from and written to by a different I/O<br> # thread. You can include the same directory multiple times in order to create<br> # multiple I/O threads against that directory. This is for example relevant for<br> # high-throughput RAIDs.<br> #<br> io.tmp.dirs: /tmp</strong></p> 
<p><strong># The classloading resolve order. Possible values are 'child-first' (Flink's default)<br> # and 'parent-first' (Java's default).<br> #<br> # Child first classloading allows users to use different dependency/library<br> # versions in their application than those in the classpath. Switching back<br> # to 'parent-first' may help with debugging dependency issues.<br> #<br> # classloader.resolve-order: child-first</strong></p> 
<p><strong># The amount of memory going to the network stack. These numbers usually need <br> # no tuning. Adjusting them may be necessary in case of an "Insufficient number<br> # of network buffers" error. The default min is 64MB, the default max is 1GB.<br> # <br> taskmanager.memory.network.fraction: 0.1<br> taskmanager.memory.network.min: 64mb<br> taskmanager.memory.network.max: 1gb</strong></p> 
<p><strong>#==============================================================================<br> # Flink Cluster Security Configuration<br> #==============================================================================</strong></p> 
<p><strong># Kerberos authentication for various components - Hadoop, ZooKeeper, and connectors -<br> # may be enabled in four steps:<br> # 1. configure the local krb5.conf file<br> # 2. provide Kerberos credentials (either a keytab or a ticket cache w/ kinit)<br> # 3. make the credentials available to various JAAS login contexts<br> # 4. configure the connector to use JAAS/SASL</strong></p> 
<p><strong># The below configure how Kerberos credentials are provided. A keytab will be used instead of<br> # a ticket cache if the keytab path and principal are set.</strong></p> 
<p><strong># security.kerberos.login.use-ticket-cache: true<br> # security.kerberos.login.keytab: /path/to/kerberos/keytab<br> # security.kerberos.login.principal: flink-user</strong></p> 
<p><strong># The configuration below defines which JAAS login contexts</strong></p> 
<p><strong># security.kerberos.login.contexts: Client,KafkaClient</strong></p> 
<p><strong>#==============================================================================<br> # ZK Security Configuration<br> #==============================================================================</strong></p> 
<p><strong># Below configurations are applicable if ZK ensemble is configured for security</strong></p> 
<p><strong># Override below configuration to provide custom ZK service name if configured<br> # zookeeper.sasl.service-name: zookeeper</strong></p> 
<p><strong># The configuration below must match one of the values set in "security.kerberos.login.contexts"<br> # zookeeper.sasl.login-context-name: Client</strong></p> 
<p><strong>#==============================================================================<br> # HistoryServer<br> #==============================================================================</strong></p> 
<p><strong># The HistoryServer is started and stopped via bin/historyserver.sh (start|stop)</strong></p> 
<p><strong># Directory to upload completed jobs to. Add this directory to the list of<br> # monitored directories of the HistoryServer as well (see below).<br> jobmanager.archive.fs.dir: hdfs://liebe/flink/jobmanager-completed-jobs/</strong></p> 
<p><strong># The address under which the web-based HistoryServer listens.<br> historyserver.web.address: 0.0.0.0</strong></p> 
<p><strong># The port under which the web-based HistoryServer listens.<br> historyserver.web.port: 8082</strong></p> 
<p><strong># Comma separated list of directories to monitor for completed jobs.<br> historyserver.archive.fs.dir: hdfs://liebe/flink/historyserver-completed-jobs/</strong></p> 
<p><strong># Interval in milliseconds for refreshing the monitored directories.<br> historyserver.archive.fs.refresh-interval: 10000</strong></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/2f/32/wI7zYt95_o.jpg"><br>  </p> 
<p>rm -rf /home/bigdata/zookeeper/data/version-2/ /home/bigdata/zookeeper/data/zookeeper_server.pid </p> 
<p></p> 
<p>选择Resource是Active的的节点启动Yarn Session Flink</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/58/b4/uJmrhhy2_o.jpg"></p> 
<p style="text-align:center;"></p> 
<p>/home/bigdata/flink/bin/yarn-session.sh -n 2 -s 2 -jm 512 -tm 512 -nm liebe</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/01/77/pKwJhYLn_o.jpg"></p> 
<h3 style="text-align:center;"> Flink UI的网页的页面</h3> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/55/c9/LjDIrlB3_o.jpg"></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/42726aab056ece6efa4929ba624b676c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">深度学习之物体检测算法yolov3</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1382625e55d1312af416c01b57c0a8a0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java八股文大全</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>