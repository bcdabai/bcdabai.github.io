<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>两万字，MySQL压力测试工具sysbench详解（sysbench mysql和mariadb性能测试） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="两万字，MySQL压力测试工具sysbench详解（sysbench mysql和mariadb性能测试）" />
<meta property="og:description" content="sysbench mysql和mariadb性能测试 sysbench是一个模块化的、跨平台、多线程基准测试工具，主要用于评估测试各种不同系统参数下的数据库负载情况。
主要测试方式cpu性能磁盘io性能调度程序性能内存分配及传输速度POSIX线程性能数据库性能(OLTP基准测试)找范围内最大素数{时间越短越好}不同场景下IOPS{越大越好}线程并发执行，循环响应信号量花费的时间{越少越好}以不同块大小传输一定数量的数据吞吐量大小{越大越好}并发线程同时申请互斥锁循环一定次数花费的时间{越少越好}qps、tps越高越好 目前sysbench主要支持 MySQL,pgsql,oracle 这3种数据库。
安装测试环境为：RHEL7.2 MariaDB5.5.44
安装sysbench-0.5 源码地址https://github.com/BoobooWei/sysbench/archive/master.zip
[root@localhost ~]# unzip sysbench-master.zip [root@localhost ~]# cd sysbench-master/ [root@localhost sysbench-master]# ls autogen.sh configure.ac doc Makefile.am README.md sysbench TODO ChangeLog COPYING install-sh missing README-Oracle.md tests config debian m4 mkinstalldirs README-WIN.txt third_party [root@localhost sysbench-master]# yum install -y automake libtool [root@localhost sysbench-master]# ./autogen.sh ./autogen.sh: running `libtoolize --copy --force&#39; libtoolize: putting auxiliary files in AC_CONFIG_AUX_DIR, `config&#39;. libtoolize: copying file `config/ltmain.sh&#39; libtoolize: putting macros in AC_CONFIG_MACRO_DIR, `m4&#39;." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/70db1a0b39644d8c9867c9a4de5ecff3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-21T22:05:23+08:00" />
<meta property="article:modified_time" content="2023-08-21T22:05:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">两万字，MySQL压力测试工具sysbench详解（sysbench mysql和mariadb性能测试）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="sysbench_mysqlmariadb_0"></a>sysbench mysql和mariadb性能测试</h2> 
<p>sysbench是一个模块化的、跨平台、多线程基准测试工具，主要用于评估测试各种不同系统参数下的数据库负载情况。</p> 
<table><thead><tr><th align="left">主要测试方式</th><th align="left"></th><th align="left"></th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left">cpu性能</td><td align="left">磁盘io性能</td><td align="left">调度程序性能</td><td align="left">内存分配及传输速度</td><td align="left">POSIX线程性能</td><td align="left">数据库性能(OLTP基准测试)</td></tr><tr><td align="left">找范围内最大素数{时间越短越好}</td><td align="left">不同场景下IOPS{越大越好}</td><td align="left">线程并发执行，循环响应信号量花费的时间{越少越好}</td><td align="left">以不同块大小传输一定数量的数据吞吐量大小{越大越好}</td><td align="left">并发线程同时申请互斥锁循环一定次数花费的时间{越少越好}</td><td align="left">qps、tps越高越好</td></tr></tbody></table> 
<p>目前sysbench主要支持 MySQL,pgsql,oracle 这3种数据库。</p> 
<p>安装测试环境为：RHEL7.2 MariaDB5.5.44</p> 
<h3><a id="sysbench05_15"></a>安装sysbench-0.5</h3> 
<p>源码地址<a href="https://codeload.github.com/BoobooWei/sysbench/zip/master" rel="nofollow">https://github.com/BoobooWei/sysbench/archive/master.zip</a></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># unzip sysbench-master.zip</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cd sysbench-master/</span>
<span class="token punctuation">[</span>root@localhost sysbench-master<span class="token punctuation">]</span><span class="token comment"># ls</span>
autogen.sh  configure.ac  doc         Makefile.am    README.md         sysbench     TODO
ChangeLog   COPYING       install-sh  missing        README-Oracle.md  tests
config      debian        m4          mkinstalldirs  README-WIN.txt    third_party
<span class="token punctuation">[</span>root@localhost sysbench-master<span class="token punctuation">]</span><span class="token comment"># yum install -y automake libtool</span>

<span class="token punctuation">[</span>root@localhost sysbench-master<span class="token punctuation">]</span><span class="token comment"># ./autogen.sh </span>
./autogen.sh: running <span class="token variable"><span class="token variable">`</span>libtoolize <span class="token parameter variable">--copy</span> --force' 
libtoolize: putting auxiliary files <span class="token keyword">in</span> AC_CONFIG_AUX_DIR, <span class="token variable">`</span></span>config<span class="token string">'.
libtoolize: copying file `config/ltmain.sh'</span>
libtoolize: putting macros <span class="token keyword">in</span> AC_CONFIG_MACRO_DIR, `m4'.
此处省略<span class="token punctuation">..</span>. <span class="token punctuation">..</span>.

<span class="token punctuation">[</span>root@localhost sysbench-master<span class="token punctuation">]</span><span class="token comment"># ./configure</span>
此处省略<span class="token punctuation">..</span>. <span class="token punctuation">..</span>.
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
sysbench version   <span class="token builtin class-name">:</span> <span class="token number">1.0</span>
CC                 <span class="token builtin class-name">:</span> gcc
CFLAGS             <span class="token builtin class-name">:</span> <span class="token parameter variable">-O2</span> <span class="token parameter variable">-ggdb3</span>  <span class="token parameter variable">-march</span><span class="token operator">=</span>core2 <span class="token parameter variable">-W</span> <span class="token parameter variable">-Wall</span> <span class="token parameter variable">-Wextra</span> -Wpointer-arith -Wbad-function-cast   -Wstrict-prototypes -Wnested-externs -Wno-inline -Wno-format-zero-length   -funroll-loops  <span class="token parameter variable">-Wundef</span> -Wstrict-prototypes -Wmissing-prototypes -Wmissing-declarations -Wredundant-decls -Wcast-align        <span class="token parameter variable">-pthread</span>
CPPFLAGS           <span class="token builtin class-name">:</span> <span class="token parameter variable">-D_GNU_SOURCE</span>   -I<span class="token variable"><span class="token variable">$(</span>top_srcdir<span class="token variable">)</span></span>/sysbench -I<span class="token variable"><span class="token variable">$(</span>abs_top_builddir<span class="token variable">)</span></span>/third_party/luajit/inc -I<span class="token variable"><span class="token variable">$(</span>abs_top_builddir<span class="token variable">)</span></span>/third_party/concurrency_kit/include
LDFLAGS            <span class="token builtin class-name">:</span>  
LIBS               <span class="token builtin class-name">:</span> <span class="token parameter variable">-lm</span> 
EXTRA_LDFLAGS      <span class="token builtin class-name">:</span> 

prefix             <span class="token builtin class-name">:</span> /usr/local/sysbench
bindir             <span class="token builtin class-name">:</span> <span class="token variable">${prefix}</span>/bin
libexecdir         <span class="token builtin class-name">:</span> <span class="token variable">${prefix}</span>/libexec
mandir             <span class="token builtin class-name">:</span> <span class="token variable">${prefix}</span>/share/man

MySQL support      <span class="token builtin class-name">:</span> <span class="token function">yes</span>
Drizzle support    <span class="token builtin class-name">:</span> no
AttachSQL support  <span class="token builtin class-name">:</span> no
Oracle support     <span class="token builtin class-name">:</span> no
PostgreSQL support <span class="token builtin class-name">:</span> no

LuaJIT             <span class="token builtin class-name">:</span> bundled
LUAJIT_CFLAGS      <span class="token builtin class-name">:</span> -I<span class="token variable"><span class="token variable">$(</span>abs_top_builddir<span class="token variable">)</span></span>/third_party/luajit/inc
LUAJIT_LIBS        <span class="token builtin class-name">:</span> <span class="token variable"><span class="token variable">$(</span>abs_top_builddir<span class="token variable">)</span></span>/third_party/luajit/lib/libluajit-5.1.a <span class="token parameter variable">-ldl</span>
LUAJIT_LDFLAGS     <span class="token builtin class-name">:</span> <span class="token parameter variable">-rdynamic</span>

Concurrency Kit    <span class="token builtin class-name">:</span> bundled
CK_CFLAGS          <span class="token builtin class-name">:</span> -I<span class="token variable"><span class="token variable">$(</span>abs_top_builddir<span class="token variable">)</span></span>/third_party/concurrency_kit/include
CK_LIBS            <span class="token builtin class-name">:</span> <span class="token variable"><span class="token variable">$(</span>abs_top_builddir<span class="token variable">)</span></span>/third_party/concurrency_kit/lib/libck.a
configure flags    <span class="token builtin class-name">:</span> 
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
<span class="token punctuation">[</span>root@localhost sysbench-master<span class="token punctuation">]</span><span class="token comment"># make</span>
<span class="token punctuation">[</span>root@localhost sysbench-master<span class="token punctuation">]</span><span class="token comment"># make install</span>
<span class="token punctuation">[</span>root@localhost sysbench-master<span class="token punctuation">]</span><span class="token comment"># cd /usr/local/sysbench</span>
<span class="token punctuation">[</span>root@localhost sysbench<span class="token punctuation">]</span><span class="token comment"># pwd</span>
/usr/local/sysbench
<span class="token punctuation">[</span>root@localhost sysbench<span class="token punctuation">]</span><span class="token comment"># ls</span>
bin  share
<span class="token punctuation">[</span>root@localhost sysbench<span class="token punctuation">]</span><span class="token comment"># echo export PATH=$PATH:/usr/local/sysbench/bin &gt;&gt; /etc/bashrc</span>
<span class="token punctuation">[</span>root@localhost sysbench<span class="token punctuation">]</span><span class="token comment"># source /etc/bashrc</span>
<span class="token punctuation">[</span>root@localhost sysbench<span class="token punctuation">]</span><span class="token comment"># which sysbench</span>
/usr/local/sysbench/bin/sysbench
<span class="token comment"># 测试的lua脚本存放位置</span>
<span class="token punctuation">[</span>root@localhost sysbench<span class="token punctuation">]</span><span class="token comment"># ls /root/sysbench-master/sysbench/tests/</span>
CMakeLists.txt  db      Makefile     Makefile.in  mutex     sb_fileio.h  sb_mutex.h    threads
cpu             fileio  Makefile.am  memory       sb_cpu.h  sb_memory.h  sb_threads.h
<span class="token punctuation">[</span>root@localhost sysbench<span class="token punctuation">]</span><span class="token comment"># ls /root/sysbench-master/sysbench/tests/db</span>
bulk_insert.lua  insert.lua   Makefile.in      parallel_prepare.lua      select_random_ranges.lua
common.lua       Makefile     oltp.lua         select.lua                update_index.lua
delete.lua       Makefile.am  oltp_simple.lua  select_random_points.lua  update_non_index.lua
</code></pre> 
<h4><a id="_88"></a>测试</h4> 
<h5><a id="MySQL_90"></a>MySQL数据库测试</h5> 
<p>sysbench 0.5通过一系列LUA脚本来替换之前的oltp，来模拟更接近真实的基准测试环境。这些测试脚本包含：insert.lua、oltp.lua、parallel_prepare.lua、select_random_points.lua、update_index.lua、delete.luaoltp_simple.lua、select.lua、select_random_ranges.lua、update_non_index.lua，脚本使用方式基本类似。</p> 
<p>sysbench 0.5默认使用sbtest库，但是需要自己手工先创建好，也可以使用–mysql-db指定，其他非默认项指定选项：</p> 
<p>–mysql-host</p> 
<p>–mysql-port</p> 
<p>–mysql-socket</p> 
<p>–mysql-user</p> 
<p>–mysql-password</p> 
<p>–mysql-db</p> 
<p>–mysql-ssl</p> 
<p>prepare</p> 
<p>生成表并插入数据，可使用parallel_prepare.lua脚本来并行准备数据。</p> 
<p>-–db-driver 服务器类型 mysql | drizzle,默认为mysql</p> 
<p>-–mysql-table-engine 表存数引擎</p> 
<p>-–myisam-max-rows MyISAM表MAX_ROWS选项(用于大表)</p> 
<p>–-oltp-table-count 生成表数量[sbtest1、sbtest2…]</p> 
<p>-–oltp-table-size 生成表的行数</p> 
<p>-–oltp-secondary ID列生成二级索引而不是主键</p> 
<p>–-oltp-auto-inc设置ID列是否自增 on | off，默认为on --oltp-read-only=on</p> 
<p>–test=sysbench-0.5/sysbench/tests目录下测试脚本</p> 
<pre><code class="prism language-shell">sysbench <span class="token punctuation">\</span> 
<span class="token parameter variable">--test</span><span class="token operator">=</span>/root/sysbench-master/sysbench/tests/db/oltp.lua  <span class="token punctuation">\</span> 
--mysql-host<span class="token operator">=</span>localhost  <span class="token punctuation">\</span> 
--mysql-port<span class="token operator">=</span><span class="token number">3306</span>  <span class="token punctuation">\</span> 
--mysql-user<span class="token operator">=</span>root  <span class="token punctuation">\</span> 
--mysql-password<span class="token operator">=</span>uplooking <span class="token punctuation">\</span> 
--oltp-table-size<span class="token operator">=</span><span class="token number">100000</span> <span class="token punctuation">\</span> 
--num-threads<span class="token operator">=</span><span class="token number">8</span> <span class="token punctuation">\</span> 
--max-time<span class="token operator">=</span><span class="token number">10</span> <span class="token punctuation">\</span> 
--mysql-db<span class="token operator">=</span>sbtest <span class="token punctuation">\</span> 
--max-requests<span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">\</span> 
--oltp-test-mode<span class="token operator">=</span>complex <span class="token punctuation">\</span> 
--report-interval<span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">\</span> 
--mysql-table-engine<span class="token operator">=</span>innodb  <span class="token punctuation">\</span> 
<span class="token punctuation">[</span>prepare<span class="token operator">|</span>run<span class="token operator">|</span>cleanup<span class="token punctuation">]</span>准备/测试/清除
</code></pre> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost sysbench<span class="token punctuation">]</span><span class="token comment"># sysbench --test=/root/sysbench-master/sysbench/tests/db/oltp.lua --mysql-host=localhost --mysql-port=3306 --mysql-user=root --mysql-password=uplooking --oltp-table-size=10000 --num-threads=8 --max-time=10 --mysql-db=sbtest --max-requests=0 --oltp-test-mode=complex --report-interval=1 --mysql-table-engine=innodb prepare</span>
sysbench <span class="token number">1.0</span> <span class="token punctuation">(</span>using bundled LuaJIT <span class="token number">2.1</span>.0-beta2<span class="token punctuation">)</span>

Creating table <span class="token string">'sbtest1'</span><span class="token punctuation">..</span>.
Inserting <span class="token number">10000</span> records into <span class="token string">'sbtest1'</span>
Creating secondary indexes on <span class="token string">'sbtest1'</span><span class="token punctuation">..</span>.

<span class="token punctuation">[</span>root@localhost sysbench<span class="token punctuation">]</span><span class="token comment"># sysbench --test=/root/sysbench-master/sysbench/tests/db/oltp.lua --mysql-host=localhost --mysql-port=3306 --mysql-user=root --mysql-password=uplooking --oltp-table-size=10000 --num-threads=8 --max-time=10 --mysql-db=sbtest --max-requests=0 --oltp-test-mode=complex --report-interval=1 --mysql-table-engine=innodb run</span>
sysbench <span class="token number">1.0</span> <span class="token punctuation">(</span>using bundled LuaJIT <span class="token number">2.1</span>.0-beta2<span class="token punctuation">)</span>

Running the <span class="token builtin class-name">test</span> with following options:
Number of threads: <span class="token number">8</span>
Report intermediate results every <span class="token number">1</span> second<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
Initializing random number generator from current <span class="token function">time</span>


Initializing worker threads<span class="token punctuation">..</span>.

Threads started<span class="token operator">!</span>

<span class="token punctuation">[</span>   1s<span class="token punctuation">]</span> threads: <span class="token number">8</span>, tps: <span class="token number">39.71</span>, reads: <span class="token number">639.17</span>, writes: <span class="token number">162.63</span>, response time: <span class="token number">363</span>.18ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   2s<span class="token punctuation">]</span> threads: <span class="token number">8</span>, tps: <span class="token number">45.45</span>, reads: <span class="token number">626.37</span>, writes: <span class="token number">185.74</span>, response time: <span class="token number">376</span>.49ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   3s<span class="token punctuation">]</span> threads: <span class="token number">8</span>, tps: <span class="token number">53.32</span>, reads: <span class="token number">733.18</span>, writes: <span class="token number">214.31</span>, response time: <span class="token number">272</span>.27ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   4s<span class="token punctuation">]</span> threads: <span class="token number">8</span>, tps: <span class="token number">43.35</span>, reads: <span class="token number">641.97</span>, writes: <span class="token number">176.17</span>, response time: <span class="token number">356</span>.70ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   5s<span class="token punctuation">]</span> threads: <span class="token number">8</span>, tps: <span class="token number">36.87</span>, reads: <span class="token number">501.05</span>, writes: <span class="token number">160.51</span>, response time: <span class="token number">458</span>.96ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   6s<span class="token punctuation">]</span> threads: <span class="token number">8</span>, tps: <span class="token number">35.18</span>, reads: <span class="token number">513.58</span>, writes: <span class="token number">141.71</span>, response time: <span class="token number">397</span>.39ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   7s<span class="token punctuation">]</span> threads: <span class="token number">8</span>, tps: <span class="token number">40.06</span>, reads: <span class="token number">545.80</span>, writes: <span class="token number">147.22</span>, response time: <span class="token number">520</span>.62ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   8s<span class="token punctuation">]</span> threads: <span class="token number">8</span>, tps: <span class="token number">54.99</span>, reads: <span class="token number">763.82</span>, writes: <span class="token number">216.95</span>, response time: <span class="token number">240</span>.02ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   9s<span class="token punctuation">]</span> threads: <span class="token number">8</span>, tps: <span class="token number">41.37</span>, reads: <span class="token number">577.26</span>, writes: <span class="token number">176.06</span>, response time: <span class="token number">331</span>.91ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>  10s<span class="token punctuation">]</span> threads: <span class="token number">7</span>, tps: <span class="token number">57.49</span>, reads: <span class="token number">807.87</span>, writes: <span class="token number">217.62</span>, response time: <span class="token number">240</span>.02ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
OLTP <span class="token builtin class-name">test</span> statistics:
    queries performed:
        read:                            <span class="token number">6398</span>
        write:                           <span class="token number">1828</span>
        other:                           <span class="token number">914</span>
        total:                           <span class="token number">9140</span>
    transactions:                        <span class="token number">457</span>    <span class="token punctuation">(</span><span class="token number">44.97</span> per sec.<span class="token punctuation">)</span>
    read/write requests:                 <span class="token number">8226</span>   <span class="token punctuation">(</span><span class="token number">809.37</span> per sec.<span class="token punctuation">)</span>
    other operations:                    <span class="token number">914</span>    <span class="token punctuation">(</span><span class="token number">89.93</span> per sec.<span class="token punctuation">)</span>
    ignored errors:                      <span class="token number">0</span>      <span class="token punctuation">(</span><span class="token number">0.00</span> per sec.<span class="token punctuation">)</span>
    reconnects:                          <span class="token number">0</span>      <span class="token punctuation">(</span><span class="token number">0.00</span> per sec.<span class="token punctuation">)</span>

General statistics:
    total time:                          <span class="token number">10</span>.1917s
    total number of events:              <span class="token number">457</span>
    total <span class="token function">time</span> taken by event execution: <span class="token number">80</span>.3041s

Latency statistics:
         min:                                 <span class="token number">22</span>.82ms
         avg:                                <span class="token number">175</span>.72ms
         max:                                <span class="token number">563</span>.77ms
         approx.  95th percentile:           <span class="token number">376</span>.49ms

Threads fairness:
    events <span class="token punctuation">(</span>avg/stddev<span class="token punctuation">)</span>:           <span class="token number">57.1250</span>/2.93
    execution <span class="token function">time</span> <span class="token punctuation">(</span>avg/stddev<span class="token punctuation">)</span>:   <span class="token number">10.0380</span>/0.07

<span class="token comment"># 我的机器是6G内存，2个cpu，单核，超多线程碾压的时候试一试64和128个线程</span>

<span class="token punctuation">[</span>root@localhost sysbench<span class="token punctuation">]</span><span class="token comment"># sysbench --test=/root/sysbench-master/sysbench/tests/db/oltp.lua --mysql-host=localhost --mysql-port=3306 --mysql-user=root --mysql-password=uplooking --oltp-table-size=10000 --num-threads=64 --max-time=30 --mysql-db=sbtest --max-requests=0 --oltp-test-mode=complex --report-interval=1 --mysql-table-engine=innodb run</span>
sysbench <span class="token number">1.0</span> <span class="token punctuation">(</span>using bundled LuaJIT <span class="token number">2.1</span>.0-beta2<span class="token punctuation">)</span>

OLTP <span class="token builtin class-name">test</span> statistics:
    queries performed:
        read:                            <span class="token number">21210</span>
        write:                           <span class="token number">6007</span>
        other:                           <span class="token number">3008</span>
        total:                           <span class="token number">30225</span>
    transactions:                        <span class="token number">1493</span>   <span class="token punctuation">(</span><span class="token number">49.07</span> per sec.<span class="token punctuation">)</span>
    read/write requests:                 <span class="token number">27217</span>  <span class="token punctuation">(</span><span class="token number">894.57</span> per sec.<span class="token punctuation">)</span>
    other operations:                    <span class="token number">3008</span>   <span class="token punctuation">(</span><span class="token number">98.87</span> per sec.<span class="token punctuation">)</span>
    ignored errors:                      <span class="token number">22</span>     <span class="token punctuation">(</span><span class="token number">0.72</span> per sec.<span class="token punctuation">)</span>
    reconnects:                          <span class="token number">0</span>      <span class="token punctuation">(</span><span class="token number">0.00</span> per sec.<span class="token punctuation">)</span>

General statistics:
    total time:                          <span class="token number">30</span>.6492s
    total number of events:              <span class="token number">1493</span>
    total <span class="token function">time</span> taken by event execution: <span class="token number">1445</span>.1459s

Latency statistics:
         min:                                 <span class="token number">35</span>.38ms
         avg:                                <span class="token number">967</span>.95ms
         max:                               <span class="token number">4147</span>.00ms
         approx.  95th percentile:          <span class="token number">2238</span>.47ms

Threads fairness:
    events <span class="token punctuation">(</span>avg/stddev<span class="token punctuation">)</span>:           <span class="token number">23.3281</span>/12.34
    execution <span class="token function">time</span> <span class="token punctuation">(</span>avg/stddev<span class="token punctuation">)</span>:   <span class="token number">22.5804</span>/11.02

<span class="token punctuation">[</span>root@localhost sysbench<span class="token punctuation">]</span><span class="token comment"># sysbench --test=/root/sysbench-master/sysbench/tests/db/oltp.lua --mysql-host=localhost --mysql-port=3306 --mysql-user=root --mysql-password=uplooking --oltp-table-size=10000 --num-threads=128 --max-time=60 --mysql-db=sbtest --max-requests=0 --oltp-test-mode=complex --report-interval=1 --mysql-table-engine=innodb run</span>
	
OLTP <span class="token builtin class-name">test</span> statistics:
    queries performed:
        read:                            <span class="token number">58086</span>
        write:                           <span class="token number">16337</span>
        other:                           <span class="token number">8198</span>
        total:                           <span class="token number">82621</span>
    transactions:                        <span class="token number">4049</span>   <span class="token punctuation">(</span><span class="token number">67.05</span> per sec.<span class="token punctuation">)</span>
    read/write requests:                 <span class="token number">74423</span>  <span class="token punctuation">(</span><span class="token number">1232.47</span> per sec.<span class="token punctuation">)</span>
    other operations:                    <span class="token number">8198</span>   <span class="token punctuation">(</span><span class="token number">135.76</span> per sec.<span class="token punctuation">)</span>
    ignored errors:                      <span class="token number">100</span>    <span class="token punctuation">(</span><span class="token number">1.66</span> per sec.<span class="token punctuation">)</span>
    reconnects:                          <span class="token number">0</span>      <span class="token punctuation">(</span><span class="token number">0.00</span> per sec.<span class="token punctuation">)</span>

General statistics:
    total time:                          <span class="token number">60</span>.7499s
    total number of events:              <span class="token number">4049</span>
    total <span class="token function">time</span> taken by event execution: <span class="token number">2685</span>.2741s

Latency statistics:
         min:                                 <span class="token number">15</span>.82ms
         avg:                                <span class="token number">663</span>.19ms
         max:                               <span class="token number">8312</span>.00ms
         approx.  95th percentile:          <span class="token number">1973</span>.38ms

Threads fairness:
    events <span class="token punctuation">(</span>avg/stddev<span class="token punctuation">)</span>:           <span class="token number">31.6328</span>/45.46
    execution <span class="token function">time</span> <span class="token punctuation">(</span>avg/stddev<span class="token punctuation">)</span>:   <span class="token number">20.9787</span>/22.98
<span class="token punctuation">[</span>root@localhost sysbench<span class="token punctuation">]</span><span class="token comment"># sysbench --test=/root/sysbench-master/sysbench/tests/db/oltp.lua --mysql-host=localhost --mysql-port=3306 --mysql-user=root --mysql-password=uplooking --oltp-table-size=10000 --num-threads=128 --max-time=60 --mysql-db=sbtest --max-requests=0 --oltp-test-mode=complex --report-interval=1 --mysql-table-engine=innodb cleanup</span>
sysbench <span class="token number">1.0</span> <span class="token punctuation">(</span>using bundled LuaJIT <span class="token number">2.1</span>.0-beta2<span class="token punctuation">)</span>

Dropping table <span class="token string">'sbtest1'</span><span class="token punctuation">..</span>.

</code></pre> 
<p>如果是多表呢并增加表的大小，情况又会如何呢？</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost sysbench<span class="token punctuation">]</span><span class="token comment"># sysbench --test=/root/sysbench-master/sysbench/tests/db/oltp.lua --mysql-host=localhost --mysql-port=3306 --mysql-user=root --mysql-password=uplooking --oltp-tables-count=10 --oltp-table-size=100000 --num-threads=128 --max-time=60 --mysql-db=sbtest --max-requests=0 --oltp-test-mode=complex --report-interval=1 --mysql-table-engine=innodb prepare</span>
sysbench <span class="token number">1.0</span> <span class="token punctuation">(</span>using bundled LuaJIT <span class="token number">2.1</span>.0-beta2<span class="token punctuation">)</span>

Creating table <span class="token string">'sbtest1'</span><span class="token punctuation">..</span>.
Inserting <span class="token number">100000</span> records into <span class="token string">'sbtest1'</span>
Creating secondary indexes on <span class="token string">'sbtest1'</span><span class="token punctuation">..</span>.
Creating table <span class="token string">'sbtest2'</span><span class="token punctuation">..</span>.
Inserting <span class="token number">100000</span> records into <span class="token string">'sbtest2'</span>
Creating secondary indexes on <span class="token string">'sbtest2'</span><span class="token punctuation">..</span>.
Creating table <span class="token string">'sbtest3'</span><span class="token punctuation">..</span>.
Inserting <span class="token number">100000</span> records into <span class="token string">'sbtest3'</span>
Creating secondary indexes on <span class="token string">'sbtest3'</span><span class="token punctuation">..</span>.
Creating table <span class="token string">'sbtest4'</span><span class="token punctuation">..</span>.
Inserting <span class="token number">100000</span> records into <span class="token string">'sbtest4'</span>
Creating secondary indexes on <span class="token string">'sbtest4'</span><span class="token punctuation">..</span>.
Creating table <span class="token string">'sbtest5'</span><span class="token punctuation">..</span>.
Inserting <span class="token number">100000</span> records into <span class="token string">'sbtest5'</span>
Creating secondary indexes on <span class="token string">'sbtest5'</span><span class="token punctuation">..</span>.
Creating table <span class="token string">'sbtest6'</span><span class="token punctuation">..</span>.
Inserting <span class="token number">100000</span> records into <span class="token string">'sbtest6'</span>
Creating secondary indexes on <span class="token string">'sbtest6'</span><span class="token punctuation">..</span>.
Creating table <span class="token string">'sbtest7'</span><span class="token punctuation">..</span>.
Inserting <span class="token number">100000</span> records into <span class="token string">'sbtest7'</span>
Creating secondary indexes on <span class="token string">'sbtest7'</span><span class="token punctuation">..</span>.
Creating table <span class="token string">'sbtest8'</span><span class="token punctuation">..</span>.
Inserting <span class="token number">100000</span> records into <span class="token string">'sbtest8'</span>
Creating secondary indexes on <span class="token string">'sbtest8'</span><span class="token punctuation">..</span>.
Creating table <span class="token string">'sbtest9'</span><span class="token punctuation">..</span>.
Inserting <span class="token number">100000</span> records into <span class="token string">'sbtest9'</span>
Creating secondary indexes on <span class="token string">'sbtest9'</span><span class="token punctuation">..</span>.
Creating table <span class="token string">'sbtest10'</span><span class="token punctuation">..</span>.
Inserting <span class="token number">100000</span> records into <span class="token string">'sbtest10'</span>
Creating secondary indexes on <span class="token string">'sbtest10'</span><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>root@localhost sysbench<span class="token punctuation">]</span><span class="token comment"># sysbench --test=/root/sysbench-master/sysbench/tests/db/oltp.lua --mysql-host=localhost --mysql-port=3306 --mysql-user=root --mysql-password=uplooking --oltp-tables-count=10 --oltp-table-size=100000 --num-threads=130 --max-time=20 --mysql-db=sbtest --max-requests=0 --oltp-test-mode=complex --report-interval=1 --mysql-table-engine=innodb run </span>
sysbench <span class="token number">1.0</span> <span class="token punctuation">(</span>using bundled LuaJIT <span class="token number">2.1</span>.0-beta2<span class="token punctuation">)</span>

Running the <span class="token builtin class-name">test</span> with following options:
Number of threads: <span class="token number">130</span>
Report intermediate results every <span class="token number">1</span> second<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
Initializing random number generator from current <span class="token function">time</span>


Initializing worker threads<span class="token punctuation">..</span>.

Threads started<span class="token operator">!</span>

<span class="token punctuation">[</span>   1s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">0.99</span>, reads: <span class="token number">1259.55</span>, writes: <span class="token number">11.93</span>, response time: <span class="token number">87</span>.56ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   2s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">14.04</span>, reads: <span class="token number">619.78</span>, writes: <span class="token number">242.70</span>, response time: <span class="token number">1903</span>.57ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   3s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">66.22</span>, reads: <span class="token number">547.33</span>, writes: <span class="token number">261.00</span>, response time: <span class="token number">2880</span>.27ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   4s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">19.21</span>, reads: <span class="token number">366.95</span>, writes: <span class="token number">62.68</span>, response time: <span class="token number">3911</span>.79ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   5s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">45.63</span>, reads: <span class="token number">876.69</span>, writes: <span class="token number">120.39</span>, response time: <span class="token number">4517</span>.90ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   6s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">38.79</span>, reads: <span class="token number">653.12</span>, writes: <span class="token number">183.46</span>, response time: <span class="token number">5312</span>.73ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   7s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">109.66</span>, reads: <span class="token number">833.38</span>, writes: <span class="token number">366.85</span>, response time: <span class="token number">3982</span>.86ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   8s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">9.94</span>, reads: <span class="token number">611.61</span>, writes: <span class="token number">17.90</span>, response time: <span class="token number">4683</span>.57ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>   9s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">4.04</span>, reads: <span class="token number">227.04</span>, writes: <span class="token number">74.67</span>, response time: <span class="token number">4358</span>.09ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>  10s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">108.98</span>, reads: <span class="token number">813.88</span>, writes: <span class="token number">425.94</span>, response time: <span class="token number">3574</span>.99ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>  11s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">21.48</span>, reads: <span class="token number">660.03</span>, writes: <span class="token number">24.41</span>, response time: <span class="token number">3773</span>.42ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>  12s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">41.65</span>, reads: <span class="token number">512.63</span>, writes: <span class="token number">221.12</span>, response time: <span class="token number">3982</span>.86ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>  13s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">40.33</span>, reads: <span class="token number">623.56</span>, writes: <span class="token number">256.46</span>, response time: <span class="token number">3267</span>.19ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>  14s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">39.68</span>, reads: <span class="token number">460.24</span>, writes: <span class="token number">76.38</span>, response time: <span class="token number">3841</span>.98ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>  15s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">37.63</span>, reads: <span class="token number">691.16</span>, writes: <span class="token number">215.86</span>, response time: <span class="token number">4517</span>.90ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>  16s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">53.97</span>, reads: <span class="token number">704.44</span>, writes: <span class="token number">166.64</span>, response time: <span class="token number">4055</span>.23ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>  17s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">22.56</span>, reads: <span class="token number">305.12</span>, writes: <span class="token number">166.53</span>, response time: <span class="token number">4855</span>.31ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>  18s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">1.00</span>, reads: <span class="token number">320.21</span>, writes: <span class="token number">36.14</span>, response time: <span class="token number">4943</span>.53ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>  19s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">82.52</span>, reads: <span class="token number">854.02</span>, writes: <span class="token number">259.49</span>, response time: <span class="token number">6026</span>.41ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>  20s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">11.85</span>, reads: <span class="token number">332.75</span>, writes: <span class="token number">12.84</span>, response time: <span class="token number">4517</span>.90ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
<span class="token punctuation">[</span>  21s<span class="token punctuation">]</span> threads: <span class="token number">130</span>, tps: <span class="token number">52.01</span>, reads: <span class="token number">332.47</span>, writes: <span class="token number">383.46</span>, response time: <span class="token number">5124</span>.81ms <span class="token punctuation">(</span><span class="token number">95</span>%<span class="token punctuation">)</span>, errors: <span class="token number">0.00</span>, reconnects:  <span class="token number">0.00</span>
OLTP <span class="token builtin class-name">test</span> statistics:
    queries performed:
        read:                            <span class="token number">12656</span>
        write:                           <span class="token number">3616</span>
        other:                           <span class="token number">1808</span>
        total:                           <span class="token number">18080</span>
    transactions:                        <span class="token number">904</span>    <span class="token punctuation">(</span><span class="token number">42.53</span> per sec.<span class="token punctuation">)</span>
    read/write requests:                 <span class="token number">16272</span>  <span class="token punctuation">(</span><span class="token number">765.60</span> per sec.<span class="token punctuation">)</span>
    other operations:                    <span class="token number">1808</span>   <span class="token punctuation">(</span><span class="token number">85.07</span> per sec.<span class="token punctuation">)</span>
    ignored errors:                      <span class="token number">0</span>      <span class="token punctuation">(</span><span class="token number">0.00</span> per sec.<span class="token punctuation">)</span>
    reconnects:                          <span class="token number">0</span>      <span class="token punctuation">(</span><span class="token number">0.00</span> per sec.<span class="token punctuation">)</span>

General statistics:
    total time:                          <span class="token number">21</span>.5991s
    total number of events:              <span class="token number">904</span>
    total <span class="token function">time</span> taken by event execution: <span class="token number">2713</span>.1958s

Latency statistics:
         min:                                 <span class="token number">87</span>.55ms
         avg:                               <span class="token number">3001</span>.32ms
         max:                               <span class="token number">6827</span>.14ms
         approx.  95th percentile:          <span class="token number">4855</span>.31ms

Threads fairness:
    events <span class="token punctuation">(</span>avg/stddev<span class="token punctuation">)</span>:           <span class="token number">6.9538</span>/0.78
    execution <span class="token function">time</span> <span class="token punctuation">(</span>avg/stddev<span class="token punctuation">)</span>:   <span class="token number">20.8707</span>/0.35

</code></pre> 
<h5><a id="CPU_375"></a>CPU测试</h5> 
<blockquote> 
 <p>使用64位整数，测试计算素数直到某个最大值所需要的时间</p> 
</blockquote> 
<p><code>sysbench --test=cpu --cpu-max-prime=2000 run</code></p> 
<p>查看CPU信息方法,查看物理cpu个数</p> 
<p><code>grep "physical id" /proc/cpuinfo | sort -u | wc -l</code> 查看核心数量</p> 
<p><code>grep "core id" /proc/cpuinfo | sort -u | wc -l</code> 查看线程数量</p> 
<p><code>grep "processor" /proc/cpuinfo | sort -u | wc -l</code></p> 
<p>在sysbench的测试中，–num-threads取值为"线程数量"即可</p> 
<h5><a id="thread_391"></a>线程(thread)测试</h5> 
<blockquote> 
 <p>测试线程调度器的性能。对于高负载情况下测试线程调度器的行为非常有用</p> 
</blockquote> 
<p><code>sysbench --test=threads --num-threads=64 --thread-yields=100 --thread-locks=2 run</code></p> 
<h5><a id="IO_397"></a>文件IO性能测试</h5> 
<blockquote> 
 <p>生成需要的测试文件，文件总大小5G，16个并发线程。执行完后会在当前目录下生成一堆小文件</p> 
</blockquote> 
<p><code>sysbench --test=fileio --num-threads=16 --file-total-size=5G prepare</code></p> 
<p>执行测试，指定随机读写模式:</p> 
<ul><li>seqwr顺序写入</li><li>seqrewr顺序重写</li><li>seqrd顺序读取</li><li>rndrd随机读取</li><li>rndwr随机写入</li><li>rndrw混合随机读/写</li></ul> 
<p><code>sysbench --test=fileio --num-threads=16 --init-rng=on --file-total-size=5G --file-test-mode=rndrw run</code></p> 
<p>除测试文件</p> 
<p><code>sysbench --test=fileio --num-threads=16 --file-total-size=5G cleanup</code></p> 
<h5><a id="_418"></a>内存测试</h5> 
<blockquote> 
 <p>内存测试测试了内存的连续读写性能。</p> 
</blockquote> 
<p><code>sysbench --test=memory --num-threads=16 --memory-block-size=8192 --memory-total-size=1G run</code></p> 
<h5><a id="Mutex_424"></a>互斥锁(Mutex)测试</h5> 
<blockquote> 
 <p>测试互斥锁的性能，方式是模拟所有线程在同一时刻并发运行，并都短暂请求互斥锁X。</p> 
</blockquote> 
<p><code>sysbench --test=mutex --num-threads=16 --mutex-num=1024 --mutex-locks=10000 --mutex-loops=5000 run</code></p> 
<h3><a id="sysbench04_431"></a>安装sysbench-0.4</h3> 
<p>源码在线下载地址：<a href="http://101.96.10.46/downloads.mysql.com/source/sysbench-0.4.12.10.tar.gz" rel="nofollow">http://101.96.10.46/downloads.mysql.com/source/sysbench-0.4.12.10.tar.gz</a></p> 
<p>rpm包下线下载地址：<a href="http://rpm.pbone.net/index.php3/stat/4/idpl/31446291/dir/centos_7/com/sysbench-0.4.12-12.el7.x86_64.rpm.html" rel="nofollow">http://rpm.pbone.net/index.php3/stat/4/idpl/31446291/dir/centos_7/com/sysbench-0.4.12-12.el7.x86_64.rpm.html</a></p> 
<h4><a id="_437"></a>源码步骤</h4> 
<h5><a id="rpm_439"></a>数据库rpm包安装则直接编译</h5> 
<p>如果数据库是rpm包安装则直接执行以下步骤，否则在configure的时候需要指定mysql数据库的库libs和includes路径</p> 
<ul><li>tar zxf sysbench-0.4.8.tar.gz</li><li>cd sysbench-0.4.8</li><li>./configure &amp;&amp; make &amp;&amp; make install</li><li>strip /usr/local/bin/sysbench</li></ul> 
<h5><a id="_448"></a>数据库为源码编译</h5> 
<p>数据库源码编译后路径如下：</p> 
<p>数据目录 /usr/local/mysql</p> 
<p>includes目录 /usr/local/mysql/include</p> 
<p>libs目录 /usr/local/mysql/lib</p> 
<p>执行以下步骤：</p> 
<ul><li>tar zxf sysbench-0.4.8.tar.gz</li><li>cd sysbench-0.4.8</li><li>./configure --with-mysql-includes=/usr/local/mysql/include --with-mysql-libs=/usr/local/mysql/lib &amp;&amp; make &amp;&amp; make install</li><li>strip /usr/local/bin/sysbench</li></ul> 
<h4><a id="rpm_466"></a>rpm包安装步骤</h4> 
<p>依赖包：</p> 
<p>mariadb-devel-5.5.44-2.el7.x86_64</p> 
<p>postgresql-libs.x86_64 0:9.2.13-1.el7_1<br> ​</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># rpm -q mariadb-devel</span>
mariadb-devel-5.5.44-2.el7.x86_64
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># </span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># rpm -ivh sysbench-0.4.12-12.el7.x86_64.rpm </span>
warning: sysbench-0.4.12-12.el7.x86_64.rpm: Header V4 RSA/SHA1 Signature, key ID 764429e6: NOKEY
error: Failed dependencies:
	libpq.so.5<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>64bit<span class="token punctuation">)</span> is needed by sysbench-0.4.12-12.el7.x86_64
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># yum localinstall -y sysbench-0.4.12-12.el7.x86_64.rpm </span>
Loaded plugins: langpacks, product-id, search-disabled-repos, subscription-manager
This system is not registered to Red Hat Subscription Management. You can use subscription-manager to register.
Examining sysbench-0.4.12-12.el7.x86_64.rpm: sysbench-0.4.12-12.el7.x86_64
Marking sysbench-0.4.12-12.el7.x86_64.rpm to be installed
Resolving Dependencies
--<span class="token operator">&gt;</span> Running transaction check
---<span class="token operator">&gt;</span> Package sysbench.x86_64 <span class="token number">0</span>:0.4.12-12.el7 will be installed
--<span class="token operator">&gt;</span> Processing Dependency: libpq.so.5<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>64bit<span class="token punctuation">)</span> <span class="token keyword">for</span> package: sysbench-0.4.12-12.el7.x86_64
--<span class="token operator">&gt;</span> Running transaction check
---<span class="token operator">&gt;</span> Package postgresql-libs.x86_64 <span class="token number">0</span>:9.2.13-1.el7_1 will be installed
--<span class="token operator">&gt;</span> Finished Dependency Resolution

Dependencies Resolved

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
 Package                       Arch                 Version                       Repository                                    Size
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Installing:
 sysbench                      x86_64               <span class="token number">0.4</span>.12-12.el7                 /sysbench-0.4.12-12.el7.x86_64               <span class="token number">172</span> k
Installing <span class="token keyword">for</span> dependencies:
 postgresql-libs               x86_64               <span class="token number">9.2</span>.13-1.el7_1                _mnt                                         <span class="token number">230</span> k

Transaction Summary
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Install  <span class="token number">1</span> Package <span class="token punctuation">(</span>+1 Dependent package<span class="token punctuation">)</span>

Total size: <span class="token number">402</span> k
Total download size: <span class="token number">230</span> k
Installed size: <span class="token number">836</span> k
Downloading packages:
Running transaction check
Running transaction <span class="token builtin class-name">test</span>
Transaction <span class="token builtin class-name">test</span> succeeded
Running transaction
  Installing <span class="token builtin class-name">:</span> postgresql-libs-9.2.13-1.el7_1.x86_64                                                                             <span class="token number">1</span>/2 
  Installing <span class="token builtin class-name">:</span> sysbench-0.4.12-12.el7.x86_64                                                                                     <span class="token number">2</span>/2 
  Verifying  <span class="token builtin class-name">:</span> sysbench-0.4.12-12.el7.x86_64                                                                                     <span class="token number">1</span>/2 
  Verifying  <span class="token builtin class-name">:</span> postgresql-libs-9.2.13-1.el7_1.x86_64                                                                             <span class="token number">2</span>/2 

Installed:
  sysbench.x86_64 <span class="token number">0</span>:0.4.12-12.el7                                                                                                    

Dependency Installed:
  postgresql-libs.x86_64 <span class="token number">0</span>:9.2.13-1.el7_1                                                                                            

Complete<span class="token operator">!</span>
</code></pre> 
<table><thead><tr><th align="left">主要测试方式</th><th align="left"></th><th align="left"></th><th align="left"></th><th align="left"></th><th align="left"></th></tr></thead><tbody><tr><td align="left">cpu性能</td><td align="left">磁盘io性能</td><td align="left">调度程序性能</td><td align="left">内存分配及传输速度</td><td align="left">POSIX线程性能</td><td align="left">数据库性能(OLTP基准测试)</td></tr><tr><td align="left">找范围内最大素数{时间越短越好}</td><td align="left">不同场景下IOPS{越大越好}</td><td align="left">线程并发执行，循环响应信号量花费的时间{越少越好}</td><td align="left">以不同块大小传输一定数量的数据吞吐量大小{越大越好}</td><td align="left">并发线程同时申请互斥锁循环一定次数花费的时间{越少越好}</td><td align="left">qps、tps越高越好</td></tr></tbody></table> 
<h4><a id="_538"></a>开始测试</h4> 
<p>编译成功之后，就要开始测试各种性能了，测试的方法官网网站上也提到一些，但涉及到 OLTP 测试的部分却不够准确。在这里我大致提一下：</p> 
<h5><a id="cpu_542"></a>cpu性能测试</h5> 
<blockquote> 
 <p>进行素数的加法运算:指定最大的素数为 20000，记录测试结果（可以根据机器cpu的性能来适当调整数值）</p> 
</blockquote> 
<p>sysbench --test=cpu --cpu-max-prime=20000 run</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sysbench --test=cpu --cpu-max-prime=20000 run</span>
sysbench <span class="token number">0.4</span>.12:  multi-threaded system evaluation benchmark

Running the <span class="token builtin class-name">test</span> with following options:
Number of threads: <span class="token number">1</span>

Doing CPU performance benchmark

Threads started<span class="token operator">!</span>
Done.

Maximum prime number checked <span class="token keyword">in</span> CPU test: <span class="token number">20000</span>


Test execution summary:
    total time:                          <span class="token number">30</span>.7005s
    total number of events:              <span class="token number">10000</span>
    total <span class="token function">time</span> taken by event execution: <span class="token number">30.6870</span>
    per-request statistics:
         min:                                  <span class="token number">2</span>.47ms
         avg:                                  <span class="token number">3</span>.07ms
         max:                                <span class="token number">106</span>.81ms
         approx.  <span class="token number">95</span> percentile:               <span class="token number">3</span>.74ms

Threads fairness:
    events <span class="token punctuation">(</span>avg/stddev<span class="token punctuation">)</span>:           <span class="token number">10000.0000</span>/0.00
    execution <span class="token function">time</span> <span class="token punctuation">(</span>avg/stddev<span class="token punctuation">)</span>:   <span class="token number">30.6870</span>/0.00
</code></pre> 
<h5><a id="_578"></a>线程测试</h5> 
<blockquote> 
 <p>测试64个线程<br> sysbench --test=threads --num-threads=64 --thread-yields=100 --thread-locks=2 run</p> 
</blockquote> 
<pre><code class="prism language-shell[root@localhost">sysbench 0.4.12:  multi-threaded system evaluation benchmark

Running the test with following options:
Number of threads: 64

Doing thread subsystem performance test
Thread yields per test: 100 Locks used: 2
Threads started!
Done.


Test execution summary:
    total time:                          1.3949s
    total number of events:              10000
    total time taken by event execution: 66.0646
    per-request statistics:
         min:                                  0.03ms
         avg:                                  6.61ms
         max:                               1265.23ms
         approx.  95 percentile:               9.50ms

Threads fairness:
    events (avg/stddev):           156.2500/302.22
    execution time (avg/stddev):   1.0323/0.33

</code></pre> 
<h5><a id="IO_613"></a>磁盘IO性能测试</h5> 
<blockquote> 
 <p>最大创建16个线程，创建的文件总大小为3G，文件读写模式为随机读</p> 
</blockquote> 
<p>sysbench --test=fileio --num-threads=16 --file-total-size=3G --file-test-mode=rndrw prepare #创建测试文件<br> ​ <br> sysbench --test=fileio --num-threads=16 --file-total-size=3G --file-test-mode=rndrw run #执行测试文件<br> ​ <br> sysbench --test=fileio --num-threads=16 --file-total-size=3G --file-test-mode=rndrw cleanup #删除测试文件</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sysbench --test=fileio --num-threads=16 --file-total-size=3G --file-test-mode=rndrw prepare</span>
sysbench <span class="token number">0.4</span>.12:  multi-threaded system evaluation benchmark

<span class="token number">128</span> files, 24576Kb each, 3072Mb total
Creating files <span class="token keyword">for</span> the test<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sysbench --test=fileio --num-threads=16 --file-total-size=3G --file-test-mode=rndrw run</span>
sysbench <span class="token number">0.4</span>.12:  multi-threaded system evaluation benchmark

Running the <span class="token builtin class-name">test</span> with following options:
Number of threads: <span class="token number">16</span>

Extra <span class="token function">file</span> <span class="token function">open</span> flags: <span class="token number">0</span>
<span class="token number">128</span> files, 24Mb each
3Gb total <span class="token function">file</span> size
Block size 16Kb
Number of random requests <span class="token keyword">for</span> random IO: <span class="token number">10000</span>
Read/Write ratio <span class="token keyword">for</span> combined random IO test: <span class="token number">1.50</span>
Periodic FSYNC enabled, calling fsync<span class="token punctuation">(</span><span class="token punctuation">)</span> each <span class="token number">100</span> requests.
Calling fsync<span class="token punctuation">(</span><span class="token punctuation">)</span> at the end of test, Enabled.
Using synchronous I/O mode
Doing random r/w <span class="token builtin class-name">test</span>
Threads started<span class="token operator">!</span>
Done.

Operations performed:  <span class="token number">6008</span> Read, <span class="token number">3997</span> Write, <span class="token number">12800</span> Other <span class="token operator">=</span> <span class="token number">22805</span> Total
Read <span class="token number">93</span>.875Mb  Written <span class="token number">62</span>.453Mb  Total transferred <span class="token number">156</span>.33Mb  <span class="token punctuation">(</span><span class="token number">2</span>.9644Mb/sec<span class="token punctuation">)</span>
  <span class="token number">189.72</span> Requests/sec executed

Test execution summary:
    total time:                          <span class="token number">52</span>.7348s
    total number of events:              <span class="token number">10005</span>
    total <span class="token function">time</span> taken by event execution: <span class="token number">434.9929</span>
    per-request statistics:
         min:                                  <span class="token number">0</span>.01ms
         avg:                                 <span class="token number">43</span>.48ms
         max:                               <span class="token number">1105</span>.16ms
         approx.  <span class="token number">95</span> percentile:             <span class="token number">180</span>.46ms

Threads fairness:
    events <span class="token punctuation">(</span>avg/stddev<span class="token punctuation">)</span>:           <span class="token number">625.3125</span>/46.52
    execution <span class="token function">time</span> <span class="token punctuation">(</span>avg/stddev<span class="token punctuation">)</span>:   <span class="token number">27.1871</span>/1.19
	
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sysbench --test=fileio --num-threads=16 --file-total-size=3G --file-test-mode=rndrw cleanup</span>
sysbench <span class="token number">0.4</span>.12:  multi-threaded system evaluation benchmark

Removing <span class="token builtin class-name">test</span> files<span class="token punctuation">..</span>.
</code></pre> 
<h5><a id="_672"></a>内存测试</h5> 
<blockquote> 
 <p>测试过程是在内存中传输 4G 的数据量，每个 block 大小为 8K。</p> 
</blockquote> 
<p>sysbench --test=memory --memory-block-size=8k --memory-total-size=4G run</p> 
<h5><a id="OLTP_679"></a>OLTP测试</h5> 
<blockquote> 
 <p>测试的表存储引擎类型为innodb，表最大记录数为 1000000，</p> 
</blockquote> 
<p>测试 OLTP 时，先创建数据库 sbtest，或者自己用参数 --mysql-db 来指定其他数据库。</p> 
<p>–test=oltp 制定测试类型为OLTP</p> 
<p>–db-driver=mysql 测试的数据库类型为mysql</p> 
<p>–mysql-table-engine 指定创建的测试表sbtest为 innodb 储引擎类型</p> 
<p>–mysql-host=localhost --mysql-user=root --mysql-password=uplooking 分别为服务器ip，用户名和密码</p> 
<p>–oltp-table-size=10000 创建的测试表的大小为1万行</p> 
<p>–num-threads=128 线程数量为128</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sysbench --test=oltp --db-driver=mysql --mysql-host=localhost --mysql-user=root --mysql-password=uplooking --mysql-db=sbtest --mysql-table-engine=innodb --oltp-table-size=10000 --num-threads=128 prepare</span>
sysbench <span class="token number">0.4</span>.12:  multi-threaded system evaluation benchmark

Creating table <span class="token string">'sbtest'</span><span class="token punctuation">..</span>.
Creating <span class="token number">10000</span> records <span class="token keyword">in</span> table <span class="token string">'sbtest'</span><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sysbench --test=oltp --db-driver=mysql --mysql-host=localhost --mysql-user=root --mysql-password=uplooking --mysql-db=sbtest --mysql-table-engine=innodb --oltp-table-size=10000 --num-threads=128 run</span>
sysbench <span class="token number">0.4</span>.12:  multi-threaded system evaluation benchmark

Running the <span class="token builtin class-name">test</span> with following options:
Number of threads: <span class="token number">128</span>

Doing OLTP test.
Running mixed OLTP <span class="token builtin class-name">test</span>
Using Special distribution <span class="token punctuation">(</span><span class="token number">12</span> iterations,  <span class="token number">1</span> pct of values are returned <span class="token keyword">in</span> <span class="token number">75</span> pct cases<span class="token punctuation">)</span>
Using <span class="token string">"BEGIN"</span> <span class="token keyword">for</span> starting transactions
Using auto_inc on the <span class="token function">id</span> <span class="token function">column</span>
Maximum number of requests <span class="token keyword">for</span> OLTP <span class="token builtin class-name">test</span> is limited to <span class="token number">10000</span>
Threads started<span class="token operator">!</span>
Done.

OLTP <span class="token builtin class-name">test</span> statistics:
    queries performed:
        read:                            <span class="token number">181986</span>
        write:                           <span class="token number">57056</span>
        other:                           <span class="token number">22999</span>
        total:                           <span class="token number">262041</span>
    transactions:                        <span class="token number">10000</span>  <span class="token punctuation">(</span><span class="token number">50.00</span> per sec.<span class="token punctuation">)</span>
    deadlocks:                           <span class="token number">2999</span>   <span class="token punctuation">(</span><span class="token number">14.99</span> per sec.<span class="token punctuation">)</span>
    read/write requests:                 <span class="token number">239042</span> <span class="token punctuation">(</span><span class="token number">1195.09</span> per sec.<span class="token punctuation">)</span>
    other operations:                    <span class="token number">22999</span>  <span class="token punctuation">(</span><span class="token number">114.98</span> per sec.<span class="token punctuation">)</span>

Test execution summary:
    total time:                          <span class="token number">200</span>.0198s
    total number of events:              <span class="token number">10000</span>
    total <span class="token function">time</span> taken by event execution: <span class="token number">25451.6909</span>
    per-request statistics:
         min:                                  <span class="token number">9</span>.47ms
         avg:                               <span class="token number">2545</span>.17ms
         max:                              <span class="token number">26148</span>.89ms
         approx.  <span class="token number">95</span> percentile:            <span class="token number">6902</span>.69ms

Threads fairness:
    events <span class="token punctuation">(</span>avg/stddev<span class="token punctuation">)</span>:           <span class="token number">78.1250</span>/7.68
    execution <span class="token function">time</span> <span class="token punctuation">(</span>avg/stddev<span class="token punctuation">)</span>:   <span class="token number">198.8413</span>/0.48

<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># sysbench --test=oltp --db-driver=mysql --mysql-host=localhost --mysql-user=root --mysql-password=uplooking --mysql-db=sbtest --mysql-table-engine=innodb --oltp-table-size=10000 --num-threads=128 cleanup</span>
sysbench <span class="token number">0.4</span>.12:  multi-threaded system evaluation benchmark

Dropping table <span class="token string">'sbtest'</span><span class="token punctuation">..</span>.
Done.
</code></pre> 
<p>50.00 per sec 为每秒事务量，1195.09 per sec 每秒的读写请求数，total time: 200.0198s 总的用时</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/64b04a8d8176c52f768817ec2bb29e79/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">使用中科大的 Ubuntu 软件源</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/68dfc083f65f4a92f2d9271f559bde19/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Stable Diffusion 原理介绍与源码分析（二、DDPM、DDIM、PLMS算法分析）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>