<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习系列 16：使用 scikit-learn 的 Pipeline - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习系列 16：使用 scikit-learn 的 Pipeline" />
<meta property="og:description" content="在机器学习项目中，我们经常需要进行大量的数据预处理步骤，最后用处理干净的数据集来拟合机器学习算法得到一个合适的机器学习模型。
scikit-learn 提供了一个强大的 Pipeline 类来帮助我们将所有的数据预处理步骤和训练模型的步骤串起来。就像流水线一样，前一个步骤处理完的结果输入到下一个步骤，依次处理。
这里我们将使用 UCI 提供的威斯康星洲乳腺癌数据集，下载地址如下：
https://archive.ics.uci.edu/dataset/17/breast&#43;cancer&#43;wisconsin&#43;diagnostic
这个数据集一共包含 569 个样本，每个样本有 30 个实数值特征，数据集的前 2 列分别是标识病人的 ID 和肿瘤诊断结果（M 表示恶性，B 表示良性）。让我们首先加载数据集，然后抽取出特征 X 和类别 y，我们还用了 scikit-learn 提供的 LabelEncoder 将字符串表示的样本类别编码成数字表示。
现在我们已经将 M 编码成 1，B 编码成 0。
然后我们将数据集拆分成训练集和测试集，其中训练集占 80%，测试集占 20%。
许多机器学习算法要求输入的特征的取值范围都在同一个范围内，由于这里的数据集中的特征是以不同的度量标准测到的，所以我们需要标准化特征。然后，假设我们还要将这 30 维的高维数据通过 PCA 压缩到 2 维空间。最后我们用数据集拟合逻辑回归算法得到一个二分类模型。
我们可以通过 make_pipeline 函数将中上述步骤中涉及的标准化、PCA 和训练模型串到一个管道（pipeline）中。
make_pipeline 函数可以接收任意数量的 scikit-learn transformer（包含 fit 和 trasnform 方法的对象），最后跟一个 scikit-learn estimator（实现了 fit 和 predict 方法的对象）。
在前面的例子中，StandardScaler() 和 PCA() 就是 transformer，LogisticRegression 就是 estimator。
在我调用 pipe_lr 的 fit 方法时，Pipeline 会先调用 transformer 的 fit_transform 方法（fit_transform 方法其实先调用 fit 再调用 transform），然后调用 estimator 的 fit 方法来训练模型。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/80b4b68ffe0e8f803b628b8a118500d9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-29T20:36:12+08:00" />
<meta property="article:modified_time" content="2024-01-29T20:36:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习系列 16：使用 scikit-learn 的 Pipeline</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在机器学习项目中，我们经常需要进行大量的数据预处理步骤，最后用处理干净的数据集来拟合机器学习算法得到一个合适的机器学习模型。</p> 
<p>scikit-learn 提供了一个强大的 Pipeline 类来帮助我们将所有的数据预处理步骤和训练模型的步骤串起来。就像流水线一样，前一个步骤处理完的结果输入到下一个步骤，依次处理。</p> 
<p>这里我们将使用 UCI 提供的威斯康星洲乳腺癌数据集，下载地址如下：</p> 
<p>https://archive.ics.uci.edu/dataset/17/breast+cancer+wisconsin+diagnostic</p> 
<p>这个数据集一共包含 569 个样本，每个样本有 30 个实数值特征，数据集的前 2 列分别是标识病人的 ID 和肿瘤诊断结果（M 表示恶性，B 表示良性）。让我们首先加载数据集，然后抽取出特征 X 和类别 y，我们还用了 scikit-learn 提供的 LabelEncoder 将字符串表示的样本类别编码成数字表示。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="255" src="https://images2.imgbox.com/70/70/dvLeurrR_o.png" width="678"></p> 
<p>现在我们已经将 M 编码成 1，B 编码成 0。</p> 
<p>然后我们将数据集拆分成训练集和测试集，其中训练集占 80%，测试集占 20%。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="92" src="https://images2.imgbox.com/3e/f1/5ldRTF7n_o.png" width="448"></p> 
<p>许多机器学习算法要求输入的特征的取值范围都在同一个范围内，由于这里的数据集中的特征是以不同的度量标准测到的，所以我们需要标准化特征。然后，假设我们还要将这 30 维的高维数据通过 <a href="http://mp.weixin.qq.com/s?__biz=MzI2ODUyMTQyNA==&amp;mid=2247487526&amp;idx=1&amp;sn=e9d997204991546b6bf48d02e78cc93d&amp;chksm=eaef0a99dd98838f07724607c39b47c3e7cf15fc7af63d61a4b5d4a99536369d9b11bd649f08&amp;scene=21#wechat_redirect" rel="nofollow" title="PCA">PCA</a> 压缩到 2 维空间。最后我们用数据集拟合逻辑回归算法得到一个二分类模型。</p> 
<p>我们可以通过 make_pipeline 函数将中上述步骤中涉及的标准化、PCA 和训练模型串到一个管道（pipeline）中。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="240" src="https://images2.imgbox.com/aa/96/OB8Hfrpl_o.png" width="680"></p> 
<p>make_pipeline 函数可以接收任意数量的 scikit-learn transformer（包含 fit 和 trasnform 方法的对象），最后跟一个 scikit-learn estimator（实现了 fit 和 predict 方法的对象）。</p> 
<p>在前面的例子中，StandardScaler() 和 PCA() 就是 transformer，LogisticRegression 就是 estimator。</p> 
<p>在我调用 pipe_lr 的 fit 方法时，Pipeline 会先调用 transformer 的 fit_transform 方法（fit_transform 方法其实先调用 fit 再调用 transform），然后调用 estimator 的 fit 方法来训练模型。</p> 
<p>如果我们在 Pipeline 的最后加了一个 estimator，那么我们可以通过调用 pipe_lr 的 predict 方法来对新数据进行同样的预处理，然后对预处理后的新数据进行预测。</p> 
<p></p> 
<p class="img-center"><img alt="图片" height="360" src="https://images2.imgbox.com/c8/4c/6IqmL04B_o.png" width="482"></p> 
<p>通过上图我们可以看到 Pipeline 将数据预处理和训练模型这些步骤串联起来，使得我们从头到尾就像在使用一个对象一样。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cb806e6ba113020eeef0fa7674c12126/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">探讨UI自动化测试几步骤</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/73c8aaf86adecc518466a629fae88363/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C语言】（9）分支结构</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>