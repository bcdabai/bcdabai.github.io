<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Mybatis使用IN语句查询 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Mybatis使用IN语句查询" />
<meta property="og:description" content="一、简介
在SQL语法中如果我们想使用in的话直接可以像如下一样使用:
select * from HealthCoupon where useType in ( &#39;4&#39; , &#39;3&#39; ) 但是如果在MyBatis中的使用in的话,像如下去做的话,肯定会报错:
Map&lt;String, Object&gt; selectByUserId(@Param(&#34;useType&#34;) String useType) &lt;select id=&#34;selectByUserId&#34; resultMap=&#34;BaseResultMap&#34; parameterType=&#34;java.lang.String&#34;&gt; select * from HealthCoupon where useType in (#{useType,jdbcType=VARCHAR}) &lt;/select&gt; 其中useType=&#34;2,3&#34;;这样的写法,看似很简单,但是MyBatis不支持这样操作，可以用$进行替换，如下方式即可运行
Map&lt;String, Object&gt; selectByUserId(@Param(&#34;useType&#34;) String useType) &lt;select id=&#34;selectByUserId&#34; resultMap=&#34;BaseResultMap&#34; parameterType=&#34;java.lang.String&#34;&gt; select * from HealthCoupon where useType in (${useType,jdbcType=VARCHAR}) &lt;/select&gt; #方式能够很大程度防止sql注入，$方式无法防止sql注入，所以还是推荐使用#方式，参考以下三种方式。
MyBatis中提供了foreach语句实现IN查询,foreach语法如下:
foreach语句中， collection属性的参数类型可以使：List、数组、map集合
​ collection： 必须跟mapper.java中@Param标签指定的元素名一样
​ item： 表示在迭代过程中每一个元素的别名，可以随便起名，但是必须跟元素中的#{}里面的名称一样。
index：表示在迭代过程中每次迭代到的位置(下标)
open：前缀， sql语句中集合都必须用小括号()括起来
​ close：后缀
separator：分隔符，表示迭代时每个元素之间以什么分隔
正确的写法有以下几种写法:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/9b437d6ea0ab16f1f900801642239e6e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-16T11:40:00+08:00" />
<meta property="article:modified_time" content="2024-01-16T11:40:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Mybatis使用IN语句查询</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>一、简介</strong></p> 
<p>在SQL语法中如果我们想使用in的话直接可以像如下一样使用:</p> 
<pre><code>select * from HealthCoupon where useType in ( '4' , '3' )</code></pre> 
<p>但是如果在MyBatis中的使用in的话,像如下去做的话,肯定会报错:</p> 
<pre><code class="language-XML">Map&lt;String, Object&gt; selectByUserId(@Param("useType") String useType)
	
&lt;select id="selectByUserId" resultMap="BaseResultMap" parameterType="java.lang.String"&gt;
	select * from HealthCoupon where useType in (#{useType,jdbcType=VARCHAR})
&lt;/select&gt;</code></pre> 
<p> 其中useType="2,3";这样的写法,看似很简单,但是MyBatis不支持这样操作，可以用$进行替换，如下方式即可运行</p> 
<pre><code class="language-XML">Map&lt;String, Object&gt; selectByUserId(@Param("useType") String useType)
	
&lt;select id="selectByUserId" resultMap="BaseResultMap" parameterType="java.lang.String"&gt;
    select * from HealthCoupon where useType in (${useType,jdbcType=VARCHAR})
&lt;/select&gt;</code></pre> 
<hr> 
<p>#方式能够很大程度防止sql注入，$方式无法防止sql注入，所以还是推荐使用#方式，参考以下三种方式。</p> 
<p>MyBatis中提供了foreach语句实现IN查询,foreach语法如下:</p> 
<blockquote> 
 <p>foreach语句中， collection属性的参数类型可以使：List、数组、map集合<br> ​     collection： 必须跟mapper.java中@Param标签指定的元素名一样<br> ​     item： 表示在迭代过程中每一个元素的别名，可以随便起名，但是必须跟元素中的#{}里面的名称一样。<br> 　  index：表示在迭代过程中每次迭代到的位置(下标)<br> 　  open：前缀， sql语句中集合都必须用小括号()括起来<br> ​      close：后缀<br> 　  separator：分隔符，表示迭代时每个元素之间以什么分隔</p> 
</blockquote> 
<p> 正确的写法有以下几种写法:</p> 
<p><strong>(一)、selectByIdSet(List idList)</strong></p> 
<p>如果参数的类型是List, 则在使用时，collection属性要必须指定为 list</p> 
<pre><code class="language-XML">List&lt;User&gt; selectByIdSet(List idList);
 
&lt;select id="selectByIdSet" resultMap="BaseResultMap"&gt;
	SELECT
	&lt;include refid="Base_Column_List" /&gt;
	from t_user
	WHERE 1=1
    &lt;if test="list!= null and list.size() &gt; 0"&gt;
        and id IN
        &lt;foreach collection="list" item="id" index="index" open="(" close=")" separator=","&gt;
	          #{id}
	    &lt;/foreach&gt;
     &lt;/if&gt;
&lt;/select&gt;</code></pre> 
<p><strong>(二)、List&lt;User&gt; selectByIdSet(String[] idList)</strong></p> 
<p>如果参数的类型是Array,则在使用时，collection属性要必须指定为 array</p> 
<pre><code class="language-XML">List&lt;User&gt; selectByIdSet(String[] idList);
 
&lt;select id="selectByIdSet" resultMap="BaseResultMap"&gt;
	SELECT
	&lt;include refid="Base_Column_List" /&gt;
	from t_user
	WHERE id IN
	&lt;foreach collection="array" item="id" index="index" open="(" close=")" separator=","&gt;
	  #{id}
	&lt;/foreach&gt;
&lt;/select&gt;</code></pre> 
<p><strong>(三)、参数有多个时</strong></p> 
<p>当查询的参数有多个时,有两种方式可以实现，一种是使用@Param("xxx")进行参数绑定，另一种可以通过Map来传参数。</p> 
<p>3.1 @Param("xxx")方式</p> 
<pre><code class="language-XML">List&lt;User&gt; selectByIdSet(@Param("name")String name, @Param("ids")String[] idList);
 
&lt;select id="selectByIdSet" resultMap="BaseResultMap"&gt;
	SELECT
	&lt;include refid="Base_Column_List" /&gt;
	from t_user
	WHERE  name=#{name,jdbcType=VARCHAR} and id IN
	&lt;foreach collection="ids" item="id" index="index" open="(" close=")" separator=","&gt;
	  #{id}
	&lt;/foreach&gt;
&lt;/select&gt;</code></pre> 
<p>3.2 Map方式</p> 
<pre><code class="language-XML">Map&lt;String, Object&gt; params = new HashMap&lt;String, Object&gt;(2);
params.put("name", name);
params.put("idList", ids);
mapper.selectByIdSet(params);
 
&lt;select id="selectByIdSet" resultMap="BaseResultMap"&gt;  
     select  
     &lt;include refid="Base_Column_List" /&gt;  
     from t_user where 
     name = #{name}
     and ID in  
     &lt;foreach item="item" index="index" collection="idList" open="(" separator="," close=")"&gt;  
      #{item}  
     &lt;/foreach&gt;  
&lt;/select&gt;</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ab3e928e8c3e0c51691a0945b333bc01/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">鸿蒙开发工具DevEco Studio的安装与使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/19fb177975d98f105d5e3b9ba958a8a4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">KT148A语音芯片智能锁扩展语音地址以及如何支持大量小文件的打包</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>