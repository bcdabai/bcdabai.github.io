<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>文件如何转换成pdf或html格式 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="文件如何转换成pdf或html格式" />
<meta property="og:description" content="1、使用jacob插件 2、使用方法 1）于word、ppt等上传文件转换为PDF格式文件的环境搭建，步骤如下：
① 首先电脑要先安装office软件（不可以是WPS软件）
② 需要把jacob.dll文件复制到JDK的bin目录下面，否则无法调用转换为PDF的功能。
2）使用的服务器上必须安装有office软件,因为原理是调用office的pdf转换器来实现的。
3）必须也要有PDF软件，因为office要通过调用本地的pdf软件来实现格式的转换。
3、office文件转PDF import java.io.File; import com.jacob.activeX.ActiveXComponent;import com.jacob.com.ComThread;import com.jacob.com.Dispatch; public class OfficeToPdf {private static final int wdFormatPDF = 17;private static final int xlTypePDF = 0;private static final int ppSaveAsPDF = 32; public static void main(String[] args) {convert2PDF(&#34;I:\\使用方法.txt&#34;,&#34;I:\\使用方法.pdf&#34;);} /* * 转换生存PDF文件，支持格式 doc docx txt ppt pptx xls xlsx * 1、需安装office软件，并有将office转化为PDF的插件 2、需有jacob(java com bridge）， * java与com组件之间的桥梁 */public static boolean convert2PDF(String inputFile, String pdfFile) {String suffix = getFileSufix(inputFile);File file = new File(inputFile);if (!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/cfd30072ef217a99f07b73e227047d48/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-07-25T14:32:00+08:00" />
<meta property="article:modified_time" content="2017-07-25T14:32:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">文件如何转换成pdf或html格式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="content" id="articleContent"> 
 <span id="OSC_h2_1"></span> 
 <h3>1、使用jacob插件</h3> 
 <span id="OSC_h2_2"></span> 
 <h3>2、使用方法</h3> 
 <p>1）于word、ppt等上传文件转换为PDF格式文件的环境搭建，步骤如下：<br> ① 首先电脑要先安装office软件（不可以是WPS软件）<br> ② 需要把jacob.dll文件复制到JDK的bin目录下面，否则无法调用转换为PDF的功能。</p> 
 <p> </p> 
 <p>2）使用的服务器上必须安装有office软件,因为原理是调用office的pdf转换器来实现的。</p> 
 <p><br> 3）必须也要有PDF软件，因为office要通过调用本地的pdf软件来实现格式的转换。</p> 
 <span id="OSC_h2_3"></span> 
 <h3>3、office文件转PDF</h3> 
 <pre> </pre> 
 <ol><li>import java.io.File;</li><li> </li><li>import com.jacob.activeX.ActiveXComponent;</li><li>import com.jacob.com.ComThread;</li><li>import com.jacob.com.Dispatch;</li><li> </li><li>public class OfficeToPdf {<!-- --></li><li>private static final int wdFormatPDF = 17;</li><li>private static final int xlTypePDF = 0;</li><li>private static final int ppSaveAsPDF = 32;</li><li> </li><li>public static void main(String[] args) {<!-- --></li><li>convert2PDF("I:\\使用方法.txt","I:\\使用方法.pdf");</li><li>}</li><li> </li><li>/*</li><li> * 转换生存PDF文件，支持格式 doc docx txt ppt pptx xls xlsx</li><li> * 1、需安装office软件，并有将office转化为PDF的插件 2、需有jacob(java com bridge），</li><li> * java与com组件之间的桥梁</li><li> */</li><li>public static boolean convert2PDF(String inputFile, String pdfFile) {<!-- --></li><li>String suffix = getFileSufix(inputFile);</li><li>File file = new File(inputFile);</li><li>if (!file.exists()) {<!-- --></li><li>System.out.println("文件不存在！");</li><li>return false;</li><li>}</li><li>if (suffix.equals("pdf")) {<!-- --></li><li>System.out.println("PDF not need to convert!");</li><li>return false;</li><li>}</li><li>OfficeToPdf officeToPdf = new OfficeToPdf();</li><li>if (suffix.equals("doc") || suffix.equals("docx")</li><li>|| suffix.equals("txt")) {<!-- --></li><li>return officeToPdf.word2PDF(inputFile, pdfFile);</li><li>} else if (suffix.equals("ppt") || suffix.equals("pptx")) {<!-- --></li><li>return officeToPdf.ppt2PDF(inputFile, pdfFile);</li><li>} else if (suffix.equals("xls") || suffix.equals("xlsx")) {<!-- --></li><li>return officeToPdf.excel2PDF(inputFile, pdfFile);</li><li>} else {<!-- --></li><li>System.out.println("文件格式不支持转换!");</li><li>return false;</li><li>}</li><li>}</li><li> </li><li>public static String getFileSufix(String fileName) {<!-- --></li><li>int splitIndex = fileName.lastIndexOf(".");</li><li>return fileName.substring(splitIndex + 1);</li><li>}</li><li> </li><li>public boolean word2PDF(String inputFile, String pdfFile) {<!-- --></li><li>try {<!-- --></li><li>// 打开word应用程序</li><li>ActiveXComponent app = new ActiveXComponent("Word.Application");</li><li>// 设置word不可见</li><li>app.setProperty("Visible", false);</li><li>// 获得word中所有打开的文档,返回Documents对象</li><li>Dispatch docs = app.getProperty("Documents").toDispatch();</li><li>// 调用Documents对象中Open方法打开文档，并返回打开的文档对象Document</li><li>Dispatch doc = Dispatch.call(docs, "Open", inputFile, false, true)</li><li>.toDispatch();</li><li>// 调用Document对象的SaveAs方法，将文档保存为pdf格式</li><li>/*</li><li> * Dispatch.call(doc, "SaveAs", pdfFile, wdFormatPDF</li><li> * //word保存为pdf格式宏，值为17 );</li><li> */</li><li>Dispatch.call(doc, "ExportAsFixedFormat", pdfFile, wdFormatPDF // word保存为pdf格式宏，值为17</li><li>);</li><li>// 关闭文档</li><li>Dispatch.call(doc, "Close", false);</li><li>// 关闭word应用程序</li><li>app.invoke("Quit", 0);</li><li>return true;</li><li>} catch (Exception e) {<!-- --></li><li>return false;</li><li>} finally {<!-- --></li><li>ComThread.Release();</li><li>}</li><li>}</li><li> </li><li>public boolean excel2PDF(String inputFile, String pdfFile) {<!-- --></li><li>try {<!-- --></li><li>ActiveXComponent app = new ActiveXComponent("Excel.Application");</li><li>app.setProperty("Visible", false);</li><li>Dispatch excels = app.getProperty("Workbooks").toDispatch();</li><li>Dispatch excel = Dispatch.call(excels, "Open", inputFile, false,</li><li>true).toDispatch();</li><li>Dispatch.call(excel, "ExportAsFixedFormat", xlTypePDF, pdfFile);</li><li>Dispatch.call(excel, "Close", false);</li><li>app.invoke("Quit");</li><li>return true;</li><li>} catch (Exception e) {<!-- --></li><li>return false;</li><li>} finally {<!-- --></li><li>ComThread.Release();</li><li>}</li><li> </li><li>}</li><li> </li><li>public boolean ppt2PDF(String inputFile, String pdfFile) {<!-- --></li><li>try {<!-- --></li><li>ActiveXComponent app = new ActiveXComponent(</li><li>"PowerPoint.Application");</li><li>// app.setProperty("Visible", msofalse);</li><li>Dispatch ppts = app.getProperty("Presentations").toDispatch();</li><li> </li><li>Dispatch ppt = Dispatch.call(ppts, "Open", inputFile, true,// ReadOnly</li><li>true,// Untitled指定文件是否有标题</li><li>false// WithWindow指定文件是否可见</li><li>).toDispatch();</li><li> </li><li>Dispatch.call(ppt, "SaveAs", pdfFile, ppSaveAsPDF);</li><li>Dispatch.call(ppt, "Close");</li><li>app.invoke("Quit");</li><li>return true;</li><li>} catch (Exception e) {<!-- --></li><li>return false;</li><li>} finally {<!-- --></li><li>ComThread.Release();</li><li>}</li><li>}</li><li>}</li></ol> 
 <span id="OSC_h2_4"></span> 
 <h3>4、office文件转html</h3> 
 <pre> </pre> 
 <ol><li>import java.io.File;</li><li> </li><li>import com.jacob.activeX.ActiveXComponent;</li><li>import com.jacob.com.ComThread;</li><li>import com.jacob.com.Dispatch;</li><li> </li><li>public class OfficeToHtml {<!-- --></li><li> </li><li>public static final int WORD_HTML = 8;</li><li>public static final int WORD_TXT = 7;</li><li>public static final int EXCEL_HTML = 44;</li><li>public static final int PPT_HTML = 44;</li><li> </li><li>public static void main(String[] args) {<!-- --></li><li>convert2HTML("I:\\使用方法.txt","I:\\使用方法.html");</li><li>}</li><li> </li><li>/*</li><li> * 转换生存PDF文件，支持格式 doc docx txt xls xlsx 1、需安装office软件，并有将office转化为PDF的插件</li><li> * 2、需有jacob(java com bridge）， java与com组件之间的桥梁</li><li> */</li><li>public static boolean convert2HTML(String inputFile, String pdfFile) {<!-- --></li><li>String suffix = getFileSufix(inputFile);</li><li>File file = new File(inputFile);</li><li>if (!file.exists()) {<!-- --></li><li>System.out.println("文件不存在！");</li><li>return false;</li><li>}</li><li>OfficeToHtml officeToHtml = new OfficeToHtml();</li><li>if (suffix.equals("doc") || suffix.equals("docx")</li><li>|| suffix.equals("txt")) {<!-- --></li><li>return officeToHtml.word2HTML(inputFile, pdfFile);</li><li>} else if (suffix.equals("xls") || suffix.equals("xlsx")) {<!-- --></li><li>return officeToHtml.excel2HTML(inputFile, pdfFile);</li><li>} else {<!-- --></li><li>System.out.println("文件格式不支持转换!");</li><li>return false;</li><li>}</li><li>}</li><li> </li><li>public static String getFileSufix(String fileName) {<!-- --></li><li>int splitIndex = fileName.lastIndexOf(".");</li><li>return fileName.substring(splitIndex + 1);</li><li>}</li><li> </li><li>/**</li><li> * WORD转HTML</li><li> * </li><li> * <a href="https://my.oschina.net/u/2303379" rel="nofollow" class="referer">@param</a> docfile</li><li> *            WORD文件全路径</li><li> * <a href="https://my.oschina.net/u/2303379" rel="nofollow" class="referer">@param</a> htmlfile</li><li> *            转换后HTML存放路径</li><li> */</li><li>public boolean word2HTML(String docfile, String htmlfile) {<!-- --></li><li>ActiveXComponent app = new ActiveXComponent("Word.Application"); // 启动word</li><li>try {<!-- --></li><li>app.setProperty("Visible", false);</li><li>app.setProperty("DisplayAlerts", false);// 设置不显示弹出覆盖警告</li><li>Dispatch docs = app.getProperty("Documents").toDispatch();</li><li>Dispatch doc = Dispatch.invoke(docs, "Open", Dispatch.Method,</li><li>new Object[] { docfile, false, true }, new int[1])</li><li>.toDispatch();</li><li>Dispatch.invoke(doc, "SaveAs", Dispatch.Method, new Object[] {<!-- --></li><li>htmlfile, WORD_HTML }, new int[1]);</li><li>Dispatch.call(doc, "Close", false);</li><li>app.invoke("Quit", 0);</li><li>return true;</li><li>} catch (Exception e) {<!-- --></li><li>return false;</li><li>} finally {<!-- --></li><li>ComThread.Release();</li><li>}</li><li>}</li><li> </li><li>/**</li><li> * EXCEL转HTML</li><li> * </li><li> * <a href="https://my.oschina.net/u/2303379" rel="nofollow" class="referer">@param</a> xlsfile</li><li> *            EXCEL文件全路径</li><li> * <a href="https://my.oschina.net/u/2303379" rel="nofollow" class="referer">@param</a> htmlfile</li><li> *            转换后HTML存放路径</li><li> */</li><li>public boolean excel2HTML(String xlsfile, String htmlfile) {<!-- --></li><li>ActiveXComponent app = new ActiveXComponent("Excel.Application"); // 启动exel</li><li>try {<!-- --></li><li>app.setProperty("Visible", false);</li><li>app.setProperty("DisplayAlerts", false);// 设置不显示弹出覆盖警告</li><li>Dispatch excels = app.getProperty("Workbooks").toDispatch();</li><li>Dispatch excel = Dispatch.invoke(excels, "Open", Dispatch.Method,</li><li>new Object[] { xlsfile, false, true }, new int[1])</li><li>.toDispatch();</li><li>Dispatch.invoke(excel, "SaveAs", Dispatch.Method, new Object[] {<!-- --></li><li>htmlfile, EXCEL_HTML }, new int[1]);</li><li>Dispatch.call(excel, "Close", false);</li><li>app.invoke("Quit");</li><li>return true;</li><li>} catch (Exception e) {<!-- --></li><li>return false;</li><li>} finally {<!-- --></li><li>ComThread.Release();</li><li>}</li><li> </li><li>}</li><li>}</li></ol> 
 <span id="OSC_h2_5"></span> 
 <h3>附件源码：</h3> 
 <p><strong>下载地址：http://pan.baidu.com/s/1c1PnkS4</strong></p> 
</div> 
<p>转载于:https://my.oschina.net/u/3616609/blog/1486887</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f41ff61277a111f069bf38a9246e36f2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">二代身份证上的信息</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/82fb1e57209e05fcae800cf028a8f272/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JQuery_九大选择器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>