<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在默认程序建立服务器文件关联,[Windows10]记一次修复注册表相关血案：该文件没有与之关联的应用来执行该操作。请安装应用，若已经安装应用，请在“默认应用设置”页面中创建关联。... - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="在默认程序建立服务器文件关联,[Windows10]记一次修复注册表相关血案：该文件没有与之关联的应用来执行该操作。请安装应用，若已经安装应用，请在“默认应用设置”页面中创建关联。..." />
<meta property="og:description" content="今天闲得蛋疼清理了一下右键菜单，于是在之后某时刻使用Everything的“双击路径列打开目录”功能时发现异常：
[Window Title]
Everything.exe
[Content]
该文件没有与之关联的应用来执行该操作。请安装应用，若已经安装应用，请在“默认应用设置”页面中创建关联。
[确定]
接下来的自救过程实在曲折，中间查到Everything是调用Windows API SHOpenFolderAndSelectItems 失败导致弹这个错误(Automatically open folder again with &#34;Open path with double click&#34;)。
我甚至还在网上找了一份可以调用这个API的代码，运行这份测试代码时出现了几乎完全一样的错误窗口。
#!python3
# https://stackoverflow.com/questions/20565401/how-to-access-shopenfolderandselectitems-by-ctypes
import win32api
from win32com.shell import shell, shellcon
import os
def launch_file_explorer(path, files):
&#39;&#39;&#39;
Given a absolute base path and names of its children (no path), open
up one File Explorer window with all the child files selected
&#39;&#39;&#39;
folder_pidl = shell.SHILCreateFromPath(path,0)[0]
desktop = shell.SHGetDesktopFolder()
shell_folder = desktop." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a95c599407d3a8ae1033e0683eb452d8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-09T04:42:52+08:00" />
<meta property="article:modified_time" content="2021-08-09T04:42:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在默认程序建立服务器文件关联,[Windows10]记一次修复注册表相关血案：该文件没有与之关联的应用来执行该操作。请安装应用，若已经安装应用，请在“默认应用设置”页面中创建关联。...</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>今天闲得蛋疼清理了一下右键菜单，于是在之后某时刻使用Everything的“双击路径列打开目录”功能时发现异常：</p> 
 <p>[Window Title]</p> 
 <p>Everything.exe</p> 
 <p>[Content]</p> 
 <p>该文件没有与之关联的应用来执行该操作。请安装应用，若已经安装应用，请在“默认应用设置”页面中创建关联。</p> 
 <p>[确定]</p> 
 <p align="center"><img src="https://images2.imgbox.com/b5/f4/XbIPSbFH_o.png" alt="cfad683f30b0be1454a0198f08987ecb.png"></p> 
 <p>接下来的自救过程实在曲折，中间查到Everything是调用Windows API  SHOpenFolderAndSelectItems 失败导致弹这个错误(Automatically open folder again with "Open path with double click")。</p> 
 <p align="center"><img src="https://images2.imgbox.com/8e/b0/gRoGCKfd_o.png" alt="e50ab3fd5eec6f4e86438e9cf5077285.png"></p> 
 <p>我甚至还在网上找了一份可以调用这个API的代码，运行这份测试代码时出现了几乎完全一样的错误窗口。</p> 
 <p>#!python3</p> 
 <p># https://stackoverflow.com/questions/20565401/how-to-access-shopenfolderandselectitems-by-ctypes</p> 
 <p>import win32api</p> 
 <p>from win32com.shell import shell, shellcon</p> 
 <p>import os</p> 
 <p>def launch_file_explorer(path, files):</p> 
 <p>'''</p> 
 <p>Given a absolute base path and names of its children (no path), open</p> 
 <p>up one File Explorer window with all the child files selected</p> 
 <p>'''</p> 
 <p>folder_pidl = shell.SHILCreateFromPath(path,0)[0]</p> 
 <p>desktop = shell.SHGetDesktopFolder()</p> 
 <p>shell_folder = desktop.BindToObject(folder_pidl, None,shell.IID_IShellFolder)</p> 
 <p>name_to_item_mapping = dict([(desktop.GetDisplayNameOf(item, shellcon.SHGDN_FORPARSING|shellcon.SHGDN_INFOLDER), item) for item in shell_folder])</p> 
 <p>print("name_to_item_mapping: {0}".format(name_to_item_mapping))</p> 
 <p>to_show = []</p> 
 <p>for file in files:</p> 
 <p>if file in name_to_item_mapping:</p> 
 <p>to_show.append(name_to_item_mapping[file])</p> 
 <p>else:</p> 
 <p>raise Exception('File: "%s" not found in "%s"' % (file, path))</p> 
 <p>print("to_show: {0}".format(to_show))</p> 
 <p>print("call SHOpenFolderAndSelectItems()")</p> 
 <p>result = shell.SHOpenFolderAndSelectItems(folder_pidl, to_show, 0)</p> 
 <p>last_error = win32api.GetLastError()</p> 
 <p>print("SHOpenFolderAndSelectItems returned {0}".format(result))</p> 
 <p>p=r'Z:\SHARE'</p> 
 <p>print(os.listdir(p))</p> 
 <p>launch_file_explorer(p, os.listdir(p))</p> 
 <p align="center"><img src="https://images2.imgbox.com/ab/c7/OJ2Mcebl_o.png" alt="5e1686f8aec776cb66de6a09a2e4f950.png"></p> 
 <p>此时其实离最终答案已经不远了，可我却没有及时发现，折腾到后期甚至怀疑并不是注册表引起的问题，毕竟早已经尝试过把右键菜单还原回去了。</p> 
 <p>直至尝试系统还原并且失败后，五味杂陈地一边看着这个窗口一边备份文件时才忽然灵光乍现！</p> 
 <p align="center"><img src="https://images2.imgbox.com/fd/d9/BU9x7G81_o.png" alt="413a70929446b08eeed2df266c7c7286.png"></p> 
 <p>既然可能是操作注册表导致的故障，那么找一份OK的注册表来对比或许还有救。</p> 
 <p>于是从另一台正常的Windows 10 PC里导出 HKEY_CLASSES_ROOT\Folder ，跟这里故障机导出的文件对比：</p> 
 <p align="center"><img src="https://images2.imgbox.com/2c/5b/MgNRt7BP_o.png" alt="21282e93c1d262c45dd478ff754bb5ba.png"></p> 
 <p>把天杀的 none 删除后故障成功排除！</p> 
 <p>此时回想起出问题的API SHOpenFolderAndSelectItems 名字里带着 Folder ，真是蓝瘦……</p> 
 <p>Win10该文件没有与之关联的应用来执行该操作&amp;period;&amp;period;&amp;period;请在&amp;quot&amp;semi;默认应用设置&amp;quot&amp;semi;页面中创建关联</p> 
 <p>问题发现:一直使用的一款软件--火柴,这两天忽然发现通过ctrl + 回车快捷键无法进入到文件所在的目录中(之前几天印象中还可以使用该功能).后来测试又发现无法打开网易云音乐中下载的音乐而进入到该音乐 ...</p> 
 <p>使用Js脚本 修改控制IE的注册表相关设置&amp;lpar;activex等&amp;rpar;</p> 
 <p>使用Js脚本 修改控制IE的注册表相关设置(activex等) 分类: PHP2012-12-05 18:51 2035人阅读 评论(2) 收藏 举报 脚本写法: </p> 
 <p>一,定义和用法 </p> 
 <hr> 标签在 HTML 页面中创建一条水平线. 水平分隔线(horizontal rule)可以在视觉上将文档分隔成各个部分. 二,HTML 与 XHTML 之间的 ... 
 <p>jsp页面中创建方法</p> 
 <p>在JSP页面中是用 &lt;%! void function(){ } %&gt; 这种方式可以定义函数. 如果只使用 &lt;% //todo %&gt; 代码块中的代码在编译时将会都被加到 sev ...</p> 
 <p>&amp;lbrack;Xcode 实际操作&amp;rsqb;九、实用进阶-&amp;lpar;28&amp;rpar;在iTunes Connect&amp;lpar;苹果商店的管理后台&amp;rpar;中创建一个新的新的APP</p> 
 <p>目录:[Swift]Xcode实际操作 本文将演示如何在iTunes Connect(苹果商店的管理后台)中创建一个新的新的APP. 首先要做的是打开浏览器,并进入[iTunesConnect网站], ...</p> 
 <p>通过开发MSBuild &amp;comma;引发的注册表相关知识</p> 
 <p>最近在做一个小项目,目的就是只需要点一个按钮,就把web程序发布到指定的服务器中.基本步骤就是 编译——&gt;打包-&gt;复制包到远程服务器-&gt;解压缩.我想重点说一下解压缩,我们可以用win ...</p> 
 <p>安装Mysql的一些问题，比如Net Connect 卸载不掉&amp;comma;注册表相关操作</p> 
 <p>我安装mysql用了一段时间后卸载了,在安装就发现安装不了了,原因就是卸载的时候Net Connetc无法卸载,我试了一个月也没有解决后来百度各种还是没有办法解决.于是就尝试自己手动卸载注册表.在“开 ...</p> 
 <p>随机推荐</p> 
 <p>WinXP&amp;sol;Win7&amp;sol;Win8本地用户配置文件迁移至域用户</p> 
 <p>一.概述 最近在进行加域的工作,PC大部分是Win7,使用过微软USMT 4.0和5.0工具进行迁移,但命令行报错,目前还没找到好的文章研究. 本文迁移方法很特殊,利用的是Windows默认配置文件. ...</p> 
 <p>(转)C&amp;num; foreach 中获取索引index的方法</p> 
 <p>在C# 开发中往往使用foreach 循环语句 来代替for循环语句.foreach 比 for 更加简洁高效.           foreach :                 foreach ...</p> 
 <p>Java提高篇(三四)-----fail-fast机制</p> 
 <p>在JDK的Collection中我们时常会看到类似于这样的话: 例如,ArrayList: 注意,迭代器的快速失败行为无法得到保证,因为一般来说,不可能对是否出现不同步并发修改做出任何硬性保证.快速失 ...</p> 
 <p>enbale blakboxing</p> 
 <p>chrome://flags/#enable-devtools-experiments</p> 
 <p>第4章 类型基础 -- 4&amp;period;1 所有类型都从System&amp;period;Object派生</p> 
 <p>4.1 所有类型都从System.Object派生 “运行时”要求每个类型最终都从System.Object类型派生. 由于所有类型最终都从System.Object派生,所以每个类型的每个对象都保证 ...</p> 
 <p>java：字符串的&amp;OpenCurlyDoubleQuote;&amp;plus;”运算</p> 
 <p>今天在一篇博客里,意外的看到了一段关于java中对字符串的“+”运算的处理(博客原文:http://blog.csdn.net/yirentianran/article/details/2871417 ...</p> 
 <p>Python爬虫入门：URLError异常处理</p> 
 <p>大家好,本节在这里主要说的是URLError还有HTTPError,以及对它们的一些处理. 1.URLError 首先解释下URLError可能产生的原因: 网络无连接,即本机无法上网 连接不到特定的 ...</p> 
 <p>Game Engine Architecture 5</p> 
 <p>[Game Engine Architecture 5] 1.Memory Ordering Semantics These mysterious and vexing problems can on ...</p> 
 <p>python迭代器的说明</p> 
 <p>data = [randint(0,20) for _ in xrange(30)]表示30个随机生成的0-20随机数其中for _ in xrange(30)表示循环30次. from random ...</p> 
 <p>转载 Python中关键字global与nonlocal的区别</p> 
 <p>转载自CSDN 雁丘1990, 原文地址: https://blog.csdn.net/xcyansun/article/details/79672634 这篇文章写的很赞, 条理清晰, 分析循序渐进 ...</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c71bda4ec582c85822681e4879755af3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">未得到服务器响应,使用无限循环进行测试时未从tornado服务器获取响应</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5daa29c30973a7b00f6ea5f731d44e77/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">笔记本电脑设置触摸板双指滑动</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>