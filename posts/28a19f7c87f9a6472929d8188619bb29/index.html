<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>FFmpeg的使用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="FFmpeg的使用" />
<meta property="og:description" content="下载：
https://github.com/BtbN/FFmpeg-Builds/releases/tag/autobuild-2021-01-26-12-37
解压，然后配置环境变量，在Path下配置，目录结构如下（解压后的/bin处）
然后再cmd中使用ffmpeg查看是否配置成功
2.查看视频关键帧
首先把MP4文件转成FLV文件
ffmpeg -i test.mp4 -c copy -f flv -flvflags add_keyframe_index output.flv
然后查看output.flv文件
ffprobe -v trace -i output.flv
其中keyframe就是关键帧的位置了了，我的这个视频总共时27.7s，然后关键帧可得分别是0s、3s、7s、11s、15s、19s、23s、27s
或者可以下载Elecard StreamEye Tools查看MP4文件格式（图中红色线条代表关键帧）
3.给视频添加关键帧
然后我们执行如下命令
ffmpeg -i 原视频名称 -force_key_frames expr:gte(t,n_forced*5) 新视频名称 #每0.5s插入一个关键帧 4.x264的安装
首先需要安装Mingw环境
下载：MinGW - Minimalist GNU for Windows - Browse Files at SourceForge.net
下载好后双击执行mingw-get-setup.exe文件，选择一个保存位置
安装完成后我们点击Continue(实际会在桌面生成一个MinGW Installer文件，点击Continue时会自动打开此文件)，双击打开后，如图，我们右键勾选这7项进行下载安装
安装完成后如图
然后我们会在之前设置的保存路径下得到如图内容
我们将..../mingw/mingw/bin配置到系统环境变量（根据你自己的位置路径去配置）
然后我们安装x264
下载：x264, the best H.264/AVC encoder - VideoLAN
然后得到一个x264-master.tar.bz2文件，我们选择一个位置保存并解压
然后我们找到mysys.bat，双击打开得到一个命令窗口
然后我们在命令窗口中找到x264中confugure所在路径，然后执行configure命令
发现提示我们使用--disable-asm命令，于是我们更新命令语句后再次执行
然后我们执行make语句如图
然后再执行make install，此时会在mysys/1.0目录下生成一个local文件夹" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/28a19f7c87f9a6472929d8188619bb29/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-16T10:34:55+08:00" />
<meta property="article:modified_time" content="2023-05-16T10:34:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">FFmpeg的使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>下载：</p> 
<p><a href="https://github.com/BtbN/FFmpeg-Builds/releases/tag/autobuild-2021-01-26-12-37" title="https://github.com/BtbN/FFmpeg-Builds/releases/tag/autobuild-2021-01-26-12-37">https://github.com/BtbN/FFmpeg-Builds/releases/tag/autobuild-2021-01-26-12-37</a></p> 
<p><img alt="" height="516" src="https://images2.imgbox.com/8b/bb/1xObJ9vy_o.png" width="555"></p> 
<p></p> 
<p>解压，然后配置环境变量，在Path下配置，目录结构如下（解压后的/bin处）</p> 
<p><img alt="" height="30" src="https://images2.imgbox.com/a7/61/izlbNrOg_o.png" width="383"></p> 
<p>然后再cmd中使用ffmpeg查看是否配置成功</p> 
<p><img alt="" height="60" src="https://images2.imgbox.com/ff/e8/RRfGY0JI_o.png" width="923"></p> 
<p> </p> 
<p>2.查看视频关键帧</p> 
<p>首先把MP4文件转成FLV文件</p> 
<p>ffmpeg -i test.mp4 -c copy -f flv -flvflags add_keyframe_index output.flv</p> 
<p>然后查看output.flv文件</p> 
<p>ffprobe -v trace -i output.flv</p> 
<p><img alt="" height="673" src="https://images2.imgbox.com/86/99/rvMvco1l_o.png" width="944"></p> 
<p></p> 
<p><img alt="" height="533" src="https://images2.imgbox.com/92/85/4DmgrX1q_o.png" width="895"></p> 
<p>其中keyframe就是关键帧的位置了了，我的这个视频总共时27.7s，然后关键帧可得分别是0s、3s、7s、11s、15s、19s、23s、27s</p> 
<p><img alt="" height="231" src="https://images2.imgbox.com/f6/81/D6dHY13u_o.png" width="621"></p> 
<p></p> 
<p>或者可以下载Elecard StreamEye Tools查看MP4文件格式（图中红色线条代表关键帧）</p> 
<p><img alt="" height="296" src="https://images2.imgbox.com/57/d1/rnEy0Spt_o.png" width="776"></p> 
<p></p> 
<p>3.给视频添加关键帧</p> 
<p>然后我们执行如下命令</p> 
<pre><code class="language-bash">ffmpeg -i 原视频名称 -force_key_frames expr:gte(t,n_forced*5)  新视频名称  #每0.5s插入一个关键帧</code></pre> 
<p></p> 
<p>4.x264的安装</p> 
<p>首先需要安装Mingw环境</p> 
<p>下载：<a href="https://sourceforge.net/projects/mingw/files/" rel="nofollow" title="MinGW - Minimalist GNU for Windows -  Browse Files at SourceForge.net">MinGW - Minimalist GNU for Windows - Browse Files at SourceForge.net</a></p> 
<p>下载好后双击执行mingw-get-setup.exe文件，选择一个保存位置</p> 
<p><img alt="" height="463" src="https://images2.imgbox.com/d0/2a/FO0NES7K_o.png" width="601"></p> 
<p>安装完成后我们点击Continue(实际会在桌面生成一个MinGW Installer文件，点击Continue时会自动打开此文件)，双击打开后，如图，我们右键勾选这7项进行下载安装</p> 
<p><img alt="" height="412" src="https://images2.imgbox.com/f0/97/Pv4uwQSX_o.png" width="1010"></p> 
<p>安装完成后如图</p> 
<p><img alt="" height="512" src="https://images2.imgbox.com/40/c2/q3PT4wZQ_o.png" width="1062"></p> 
<p>然后我们会在之前设置的保存路径下得到如图内容</p> 
<p><img alt="" height="308" src="https://images2.imgbox.com/28/03/YMKelBIv_o.png" width="663"></p> 
<p>我们将..../mingw/mingw/bin配置到系统环境变量（根据你自己的位置路径去配置）</p> 
<p><img alt="" height="49" src="https://images2.imgbox.com/42/47/XtSELbi9_o.png" width="387"></p> 
<p></p> 
<p>然后我们安装x264</p> 
<p>下载：<a href="http://www.videolan.org/developers/x264.html" rel="nofollow" title="x264, the best H.264/AVC encoder - VideoLAN">x264, the best H.264/AVC encoder - VideoLAN</a></p> 
<p><img alt="" height="332" src="https://images2.imgbox.com/f0/8d/fin8uxaI_o.png" width="642"></p> 
<p>然后得到一个x264-master.tar.bz2文件，我们选择一个位置保存并解压</p> 
<p><img alt="" height="655" src="https://images2.imgbox.com/2c/03/rcWlFfrp_o.png" width="742"></p> 
<p>然后我们找到mysys.bat，双击打开得到一个命令窗口</p> 
<p><img alt="" height="421" src="https://images2.imgbox.com/b8/d5/jxmtfevC_o.png" width="722"></p> 
<p>然后我们在命令窗口中找到x264中confugure所在路径，然后执行configure命令</p> 
<p><img alt="" height="652" src="https://images2.imgbox.com/25/fb/w66hkiYc_o.png" width="818"></p> 
<p><img alt="" height="97" src="https://images2.imgbox.com/e2/d4/zdMq1XSw_o.png" width="697"></p> 
<p>发现提示我们使用--disable-asm命令，于是我们更新命令语句后再次执行</p> 
<p><img alt="" height="484" src="https://images2.imgbox.com/e0/e5/xqvmjuZc_o.png" width="736"></p> 
<p>然后我们执行make语句如图</p> 
<p><img alt="" height="220" src="https://images2.imgbox.com/0d/58/l8TsJoDh_o.png" width="590"></p> 
<p><img alt="" height="236" src="https://images2.imgbox.com/2c/67/SXaWJi65_o.png" width="688"></p> 
<p>然后再执行make install，此时会在mysys/1.0目录下生成一个local文件夹</p> 
<p><img alt="" height="91" src="https://images2.imgbox.com/56/8b/BHwkF0r7_o.png" width="559"></p> 
<p>配置环境变量</p> 
<p><img alt="" height="54" src="https://images2.imgbox.com/4d/c2/wnEmH5Nb_o.png" width="453"></p> 
<p>然后再cmd中输入，看到如下内容说明配置成功</p> 
<pre><code>x264 --help</code></pre> 
<p><img alt="" height="350" src="https://images2.imgbox.com/2f/3f/W7FHWt1y_o.png" width="618"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a1c98e4fced06871f3afe286b4d0d890/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">laravel如何使用websocket</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a75dd99e0f57973b7d20e06071c7cb95/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">解决vsCode格式化代码属性强制换行问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>