<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>关于vue 版本的ant design pro 如何保留token验证去掉其他权限验证 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="关于vue 版本的ant design pro 如何保留token验证去掉其他权限验证" />
<meta property="og:description" content="如何在ant design vue pro 原有的登陆权限的基础上保留token验证而去掉其他权限验证
第一步：在src/main.js中注释掉mock.js
// with polyfills import &#39;core-js/stable&#39; import &#39;regenerator-runtime/runtime&#39; import Vue from &#39;vue&#39; import App from &#39;./App.vue&#39; import router from &#39;./router&#39; import store from &#39;./store/&#39; import { VueAxios } from &#39;./utils/request&#39; // mock // WARNING: `mockjs` NOT SUPPORT `IE` PLEASE DO NOT USE IN `production` ENV. // import &#39;./mock&#39; import bootstrap from &#39;./core/bootstrap&#39; import &#39;./core/lazy_use&#39; import &#39;./permission&#39; // permission control import &#39;./utils/filter&#39; // global filter import &#39;." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/beebe37df7a3f2dcb74b8aa5426ade9b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-05T10:40:29+08:00" />
<meta property="article:modified_time" content="2020-08-05T10:40:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">关于vue 版本的ant design pro 如何保留token验证去掉其他权限验证</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>如何在ant design vue pro 原有的登陆权限的基础上保留token验证而去掉其他权限验证</strong></p> 
<p><strong>第一步：在src/main.js中注释掉mock.js</strong></p> 
<pre><code>// with polyfills
import 'core-js/stable'
import 'regenerator-runtime/runtime'

import Vue from 'vue'
import App from './App.vue'
import router from './router'
import store from './store/'
import { VueAxios } from './utils/request'

// mock
// WARNING: `mockjs` NOT SUPPORT `IE` PLEASE DO NOT USE IN `production` ENV.
// import './mock'
  

import bootstrap from './core/bootstrap'
import './core/lazy_use'
import './permission' // permission control
import './utils/filter' // global filter
import './components/global.less'
import { Dialog } from '@/components'
import { Timeline } from 'ant-design-vue';
import { FormModel } from 'ant-design-vue';

Vue.config.productionTip = false

// mount axios Vue.$http and this.$http
Vue.use(VueAxios)
Vue.use(Timeline)
Vue.use(Dialog)
Vue.use(FormModel)

new Vue({
  router,
  store,
  created: bootstrap,
  render: h =&gt; h(App)
}).$mount('#app')
</code></pre> 
<p><strong>第二步：在src\layouts\BasicLayout.vue中</strong></p> 
<pre><code>import { asyncRouterMap } from '@/config/router.config.js'</code></pre> 
<p><strong>在created钩子函数中做以下修改</strong></p> 
<pre><code>created () {
    this.menus = asyncRouterMap.find((item) =&gt; item.path === '/').children
    this.collapsed = !this.sidebarOpened
}</code></pre> 
<p><strong>第三步：在 src/router/index.js中做以下修改</strong></p> 
<pre><code>import Vue from 'vue'
import Router from 'vue-router'
import { constantRouterMap, asyncRouterMap } from '@/config/router.config'

const originalPush = Router.prototype.push
Router.prototype.push = function push (location, onResolve, onReject) {
  if (onResolve || onReject) return originalPush.call(this, location, onResolve, onReject)
  return originalPush.call(this, location).catch(err =&gt; err)
}
Vue.use(Router)

export default new Router({
  mode: 'history',
  base: process.env.BASE_URL,
  scrollBehavior: () =&gt; ({ y: 0 }),
  routes: constantRouterMap.concat(asyncRouterMap)
})</code></pre> 
<p><strong>第四步：在src\permission.js中注释以下代码，在注释代码的地方添加next()</strong></p> 
<pre><code>next()
      // if (store.getters.roles.length === 0) {
      //   store
      //     .dispatch('GetInfo')
      //     .then(res =&gt; {
      //       const roles = res.result &amp;&amp; res.result.role
      //       store.dispatch('GenerateRoutes', { roles }).then(() =&gt; {
      //         // 根据roles权限生成可访问的路由表
      //         // 动态添加可访问路由表
      //         router.addRoutes(store.getters.addRouters)
      //         // 请求带有 redirect 重定向时，登录自动重定向到该地址
      //         const redirect = decodeURIComponent(from.query.redirect || to.path)
      //         if (to.path === redirect) {
      //           // hack方法 确保addRoutes已完成 ,set the replace: true so the navigation will not leave a history record
      //           next({ ...to, replace: true })
      //         } else {
      //           // 跳转到目的路由
      //           next({ path: redirect })
      //         }
      //       })
      //     })
      //     .catch(() =&gt; {
      //       notification.error({
      //         message: '错误',
      //         description: '请求用户信息失败，请重试'
      //       })
      //       store.dispatch('Logout').then(() =&gt; {
      //         next({ path: '/user/login', query: { redirect: to.fullPath } })
      //       })
      //     })
      // } else {
      //   next()
      // }</code></pre> 
<p>具体过程请到<a href="https://github.com/vueComponent/ant-design-vue-pro/issues/76">https://github.com/vueComponent/ant-design-vue-pro/issues/76</a>查看</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/40db7ced54307a6a63ab7eaf75705d88/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Ubuntu 系统镜像地址</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/58e63e78247a78bfa9dd6eb7e88affcc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">docker的优势</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>