<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Qt下普通成员函数和静态成员函数作为回调函数的实现（替代信号与槽） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Qt下普通成员函数和静态成员函数作为回调函数的实现（替代信号与槽）" />
<meta property="og:description" content="文章目录 前言一、使用信号与槽二、什么是回调函数三、使用普通成员函数作为回调函数四、使用静态成员函数作为回调函数五、示例完整代码总结 前言 在Qt中，使用信号与槽来实现不同对象之间的通信是非常方便的，这也是Qt框架中引以为傲的一项机制，这里对此不加以介绍，可以查看参考文章。在信号与槽之前，对象间的通信可以采用回调实现，接下来我们通过下面示例来学习如何将Qt下普通成员函数和静态成员函数作为回调函数来实现不同对象的通信，希望可以帮助到大家，如有错误之处，欢迎大家批评指正。
项目效果
提示：以下是本篇文章正文内容，下面案例可供参考
一、使用信号与槽 示例主界面是Widget，在其初始化函数中创建了子界面对象CallBackAdd，并在这里进行了信号与槽的连接，下面代码中可以看到信号与槽在Qt4和Qt5的写法，实现子界面点击后将输入的两个数值相加的结果发送到主界面显示出来：
下面的initWidget()函数是在主界面Widget类的构造函数中进行了调用：
//初始化界面 void Widget::initWidget() { //创建子界面对象并显示 m_addWidget = new CallBackAdd(); m_addWidget-&gt;move(500,400); //移到指定坐标防止遮挡主界面 m_addWidget-&gt;show(); //使用信号与槽 //connect(m_addWidget,SIGNAL(signal_addNum(int)),this,SLOT(slot_addNum(int))); //Qt4写法 connect(m_addWidget,&amp;CallBackAdd::signal_addNum,this,&amp;Widget::slot_addNum); //Qt5写法 } 主界面Widget类的h文件中添加槽函数：
private slots: void slot_addNum(int addNum); Widget类的cpp文件中进行定义：
//槽函数 void Widget::slot_addNum(int addNum) { ui-&gt;le_num-&gt;setText(QString::number(addNum)); } 子界面CallBackAdd类的h文件中添加信号：
signals: void signal_addNum(int addNum); CallBackAdd类的cpp文件中点击按钮后发送信号：
//按钮点击槽函数 void CallBackAdd::on_pb_add_clicked() { int num_1 = ui-&gt;le_num_1-&gt;text().toInt(); int num_2 = ui-&gt;le_num_2-&gt;text().toInt(); int addNum = num_1 &#43; num_2; //发送信号 emit signal_addNum(addNum); } 关于信号与槽的更多介绍可以查看该文章：C&#43;&#43; Qt开发：如何使用信号与槽" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/8cf052e410b74f6042fb8c7d545833e8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-23T08:00:00+08:00" />
<meta property="article:modified_time" content="2023-12-23T08:00:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Qt下普通成员函数和静态成员函数作为回调函数的实现（替代信号与槽）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_4" rel="nofollow">前言</a></li><li><a href="#_13" rel="nofollow">一、使用信号与槽</a></li><li><a href="#_69" rel="nofollow">二、什么是回调函数</a></li><li><a href="#_75" rel="nofollow">三、使用普通成员函数作为回调函数</a></li><li><a href="#_145" rel="nofollow">四、使用静态成员函数作为回调函数</a></li><li><a href="#_197" rel="nofollow">五、示例完整代码</a></li><li><a href="#_400" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_4"></a>前言</h2> 
<p>在Qt中，使用信号与槽来实现不同对象之间的通信是非常方便的，这也是Qt框架中引以为傲的一项机制，这里对此不加以介绍，可以查看参考文章。在信号与槽之前，对象间的通信可以采用回调实现，接下来我们通过下面示例来学习如何将Qt下普通成员函数和静态成员函数作为回调函数来实现不同对象的通信，希望可以帮助到大家，如有错误之处，欢迎大家批评指正。</p> 
<p><strong>项目效果</strong><br> <img src="https://images2.imgbox.com/dd/4f/jgNk9pXC_o.gif" alt="请添加图片描述"></p> 
<hr> 
<p><code>提示：以下是本篇文章正文内容，下面案例可供参考</code></p> 
<h2><a id="_13"></a>一、使用信号与槽</h2> 
<p>示例主界面是Widget，在其初始化函数中创建了子界面对象CallBackAdd，并在这里进行了信号与槽的连接，下面代码中可以看到信号与槽在Qt4和Qt5的写法，实现子界面点击后将输入的两个数值相加的结果发送到主界面显示出来：</p> 
<p>下面的initWidget()函数是在主界面Widget类的构造函数中进行了调用：</p> 
<pre><code class="prism language-c"><span class="token comment">//初始化界面</span>
<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">initWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//创建子界面对象并显示</span>
    m_addWidget <span class="token operator">=</span> new <span class="token function">CallBackAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_addWidget<span class="token operator">-&gt;</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//移到指定坐标防止遮挡主界面</span>
    m_addWidget<span class="token operator">-&gt;</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">//使用信号与槽</span>
    <span class="token comment">//connect(m_addWidget,SIGNAL(signal_addNum(int)),this,SLOT(slot_addNum(int)));   //Qt4写法</span>
    <span class="token function">connect</span><span class="token punctuation">(</span>m_addWidget<span class="token punctuation">,</span><span class="token operator">&amp;</span>CallBackAdd<span class="token operator">::</span>signal_addNum<span class="token punctuation">,</span>this<span class="token punctuation">,</span><span class="token operator">&amp;</span>Widget<span class="token operator">::</span>slot_addNum<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//Qt5写法</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>主界面Widget类的h文件中添加槽函数：</p> 
<pre><code class="prism language-c">private slots<span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">slot_addNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> addNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>Widget类的cpp文件中进行定义：</p> 
<pre><code class="prism language-c"><span class="token comment">//槽函数</span>
<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">slot_addNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> addNum<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span>le_num<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>QString<span class="token operator">::</span><span class="token function">number</span><span class="token punctuation">(</span>addNum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>子界面CallBackAdd类的h文件中添加信号：</p> 
<pre><code class="prism language-c">signals<span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">signal_addNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> addNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>CallBackAdd类的cpp文件中点击按钮后发送信号：</p> 
<pre><code class="prism language-c"><span class="token comment">//按钮点击槽函数</span>
<span class="token keyword">void</span> CallBackAdd<span class="token operator">::</span><span class="token function">on_pb_add_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> num_1 <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>le_num_1<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> num_2 <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>le_num_2<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> addNum <span class="token operator">=</span> num_1 <span class="token operator">+</span> num_2<span class="token punctuation">;</span>

    <span class="token comment">//发送信号</span>
    emit <span class="token function">signal_addNum</span><span class="token punctuation">(</span>addNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>关于信号与槽的更多介绍可以查看该文章：<a href="https://zhuanlan.zhihu.com/p/673057712" rel="nofollow">C++ Qt开发：如何使用信号与槽</a></p> 
<h2><a id="_69"></a>二、什么是回调函数</h2> 
<p>上面使用信号与槽实现了不同对象之间的通信，下面让我们先了解一下回调函数，再使用回调函数来替代信号与槽实现通信。</p> 
<blockquote> 
 <p>这里引用参考文章中的内容：函数指针的调用，即是一个通过函数指针调用的函数；如果你把函数的指针（地址）作为参数传递给另一个函数，当这个指针被用来调用其所指向的函数时，就说这是回调函数。</p> 
</blockquote> 
<p>参考文章：<a href="https://blog.csdn.net/llzhang_fly/article/details/104933969">什么是回调函数？为什么要使用回调函数？如何使用回调函数？</a></p> 
<h2><a id="_75"></a>三、使用普通成员函数作为回调函数</h2> 
<p>为什么类的普通成员函数不能作为回调函数去注册？因为普通成员函数中隐含着所属类的this指针，如果将普通成员函数注册给对方，但对方使用这个函数指针时，就会发生参数列表匹配的问题。这时候我们可以通过function和bind实现将普通成员函数作为回调函数进行调用，其用法可以参考：<a href="https://www.cnblogs.com/bencai/p/9124654.html" rel="nofollow">C++11 bind和function用法</a></p> 
<p>主界面Widget类的h文件中添加普通成员函数的声明：</p> 
<pre><code class="prism language-c">private<span class="token operator">:</span>
	<span class="token comment">//普通成员函数作为回调函数</span>
	<span class="token keyword">void</span> <span class="token function">getAddResult</span><span class="token punctuation">(</span><span class="token keyword">int</span> addResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>Widget类的cpp文件中进行定义：</p> 
<pre><code class="prism language-c"><span class="token comment">//初始化界面</span>
<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">initWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token comment">//使用回调函数（普通成员函数）,通过function和bind实现</span>
    m_addWidget<span class="token operator">-&gt;</span><span class="token function">setCallBackFun</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Widget<span class="token operator">::</span>getAddResult<span class="token punctuation">,</span>this<span class="token punctuation">,</span>_1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//回调函数的定义（普通成员函数）</span>
<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">getAddResult</span><span class="token punctuation">(</span><span class="token keyword">int</span> addResult<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span>le_num<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>QString<span class="token operator">::</span><span class="token function">number</span><span class="token punctuation">(</span>addResult<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>子界面CallBackAdd类的h文件中添加相关头文件和设置回调函数的接口函数等：</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;functional&gt;</span></span>

using namespace std<span class="token punctuation">;</span>
using namespace std<span class="token operator">::</span>placeholders<span class="token punctuation">;</span>   <span class="token comment">//占位符_N所在的命名空间</span>

<span class="token comment">//声明一个function类型的可调用对象（可理解为函数指针）</span>
<span class="token keyword">typedef</span> std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> CallBack<span class="token punctuation">;</span>

class CallBackAdd <span class="token operator">:</span> public QWidget
<span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
public<span class="token operator">:</span>
    <span class="token comment">//设置回调函数的接口函数</span>
    <span class="token keyword">void</span> <span class="token function">setCallBackFun</span><span class="token punctuation">(</span>CallBack fun<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
private<span class="token operator">:</span>
    CallBack m_callbackFun<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>CallBackAdd类的h文件中进行定义：</p> 
<pre><code class="prism language-c"><span class="token comment">//设置回调函数</span>
<span class="token keyword">void</span> CallBackAdd<span class="token operator">::</span><span class="token function">setCallBackFun</span><span class="token punctuation">(</span>CallBack fun<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    m_callbackFun <span class="token operator">=</span> fun<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//按钮点击槽函数</span>
<span class="token keyword">void</span> CallBackAdd<span class="token operator">::</span><span class="token function">on_pb_add_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> num_1 <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>le_num_1<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> num_2 <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>le_num_2<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> addNum <span class="token operator">=</span> num_1 <span class="token operator">+</span> num_2<span class="token punctuation">;</span>
    
    <span class="token comment">//使用回调</span>
    <span class="token function">m_callbackFun</span><span class="token punctuation">(</span>addNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_145"></a>四、使用静态成员函数作为回调函数</h2> 
<p>静态成员函数不包含this指针，可以直接将静态成员函数注册给对方，但是本示例的静态成员函数中有调用ui对象，同样因为不含this指针，所以不能直接访问ui对象，这里定义一个m_widget来间接使用this指针。</p> 
<p>主界面Widget类的h文件中添加普通成员函数的声明：</p> 
<pre><code class="prism language-c">private<span class="token operator">:</span>
	<span class="token comment">//声明一个静态的Widget类变量</span>
	<span class="token keyword">static</span> Widget <span class="token operator">*</span>m_widget<span class="token punctuation">;</span>

	<span class="token comment">//使用static函数作为回调函数</span>
	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getAddNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> addNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>Widget类的cpp文件中进行定义：</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"widget.h"</span></span>

<span class="token comment">//类外初始化静态的Widget类变量</span>
Widget <span class="token operator">*</span>Widget<span class="token operator">::</span>m_widget <span class="token operator">=</span> nullptr<span class="token punctuation">;</span>

Widget<span class="token operator">::</span><span class="token function">Widget</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">QWidget</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span>
    <span class="token punctuation">,</span> <span class="token function">ui</span><span class="token punctuation">(</span>new Ui<span class="token operator">::</span>Widget<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span><span class="token function">setupUi</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//赋值m_widget变量</span>
    m_widget <span class="token operator">=</span> this<span class="token punctuation">;</span>

    <span class="token comment">//初始化界面</span>
    this<span class="token operator">-&gt;</span><span class="token function">initWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//初始化界面</span>
<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">initWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token comment">//使用回调函数（静态成员函数）</span>
    m_addWidget<span class="token operator">-&gt;</span><span class="token function">setCallBackFun</span><span class="token punctuation">(</span>getAddNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//回调函数的定义（静态成员函数）</span>
<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">getAddNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> addNum<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//静态成员函数并不能直接访问ui对象(普通成员函数)</span>
    <span class="token comment">//此处使用m_widget变量来实现静态成员函数操作ui对象</span>
    m_widget<span class="token operator">-&gt;</span>ui<span class="token operator">-&gt;</span>le_num<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>QString<span class="token operator">::</span><span class="token function">number</span><span class="token punctuation">(</span>addNum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>子界面CallBackAdd类与第三部分中的代码一致。</p> 
<h2><a id="_197"></a>五、示例完整代码</h2> 
<p>1.callbackadd.h</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">CALLBACKADD_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CALLBACKADD_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QWidget&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;functional&gt;</span></span>

using namespace std<span class="token punctuation">;</span>
using namespace std<span class="token operator">::</span>placeholders<span class="token punctuation">;</span>   <span class="token comment">//占位符_N所在的命名空间</span>

<span class="token comment">//声明一个function类型的可调用对象（可理解为函数指针）</span>
<span class="token keyword">typedef</span> std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> CallBack<span class="token punctuation">;</span>

namespace Ui <span class="token punctuation">{<!-- --></span>
class CallBackAdd<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

class CallBackAdd <span class="token operator">:</span> public QWidget
<span class="token punctuation">{<!-- --></span>
    Q_OBJECT

public<span class="token operator">:</span>
    explicit <span class="token function">CallBackAdd</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> nullptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">CallBackAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//设置回调函数的接口函数</span>
    <span class="token keyword">void</span> <span class="token function">setCallBackFun</span><span class="token punctuation">(</span>CallBack fun<span class="token punctuation">)</span><span class="token punctuation">;</span>

signals<span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">signal_addNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> addNum<span class="token punctuation">)</span><span class="token punctuation">;</span>

private slots<span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">on_pb_add_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

private<span class="token operator">:</span>
    Ui<span class="token operator">::</span>CallBackAdd <span class="token operator">*</span>ui<span class="token punctuation">;</span>

    CallBack m_callbackFun<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// CALLBACKADD_H</span></span>
</code></pre> 
<p>2.callbackadd.cpp</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"callbackadd.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_callbackadd.h"</span></span>

CallBackAdd<span class="token operator">::</span><span class="token function">CallBackAdd</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span>
    <span class="token function">QWidget</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">ui</span><span class="token punctuation">(</span>new Ui<span class="token operator">::</span>CallBackAdd<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span><span class="token function">setupUi</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>
    this<span class="token operator">-&gt;</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>Qt<span class="token operator">::</span>WA_QuitOnClose<span class="token punctuation">,</span>false<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//设置随父窗口关闭</span>
<span class="token punctuation">}</span>

CallBackAdd<span class="token operator">::</span><span class="token operator">~</span><span class="token function">CallBackAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    delete ui<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//设置回调函数</span>
<span class="token keyword">void</span> CallBackAdd<span class="token operator">::</span><span class="token function">setCallBackFun</span><span class="token punctuation">(</span>CallBack fun<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    m_callbackFun <span class="token operator">=</span> fun<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//按钮点击槽函数</span>
<span class="token keyword">void</span> CallBackAdd<span class="token operator">::</span><span class="token function">on_pb_add_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> num_1 <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>le_num_1<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> num_2 <span class="token operator">=</span> ui<span class="token operator">-&gt;</span>le_num_2<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> addNum <span class="token operator">=</span> num_1 <span class="token operator">+</span> num_2<span class="token punctuation">;</span>

    <span class="token comment">//发送信号</span>
    <span class="token comment">//emit signal_addNum(addNum);</span>

    <span class="token comment">//使用回调</span>
    <span class="token function">m_callbackFun</span><span class="token punctuation">(</span>addNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>3.widget.h</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">WIDGET_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WIDGET_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QWidget&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"callbackadd.h"</span></span>

QT_BEGIN_NAMESPACE
namespace Ui <span class="token punctuation">{<!-- --></span> class Widget<span class="token punctuation">;</span> <span class="token punctuation">}</span>
QT_END_NAMESPACE

class Widget <span class="token operator">:</span> public QWidget
<span class="token punctuation">{<!-- --></span>
    Q_OBJECT

public<span class="token operator">:</span>
    <span class="token function">Widget</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> nullptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">Widget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">initWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

private slots<span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">slot_addNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> addNum<span class="token punctuation">)</span><span class="token punctuation">;</span>

private<span class="token operator">:</span>
    Ui<span class="token operator">::</span>Widget <span class="token operator">*</span>ui<span class="token punctuation">;</span>

    CallBackAdd <span class="token operator">*</span>m_addWidget<span class="token punctuation">;</span>

private<span class="token operator">:</span>
    <span class="token comment">//普通成员函数作为回调函数</span>
    <span class="token keyword">void</span> <span class="token function">getAddResult</span><span class="token punctuation">(</span><span class="token keyword">int</span> addResult<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//声明一个静态的Widget类变量</span>
    <span class="token keyword">static</span> Widget <span class="token operator">*</span>m_widget<span class="token punctuation">;</span>

    <span class="token comment">//使用static函数作为回调函数</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getAddNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> addNum<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// WIDGET_H</span></span>
</code></pre> 
<p>4.widget.cpp</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"widget.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_widget.h"</span></span>

<span class="token comment">//类外初始化静态的Widget类变量</span>
Widget <span class="token operator">*</span>Widget<span class="token operator">::</span>m_widget <span class="token operator">=</span> nullptr<span class="token punctuation">;</span>

Widget<span class="token operator">::</span><span class="token function">Widget</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">QWidget</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span>
    <span class="token punctuation">,</span> <span class="token function">ui</span><span class="token punctuation">(</span>new Ui<span class="token operator">::</span>Widget<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span><span class="token function">setupUi</span><span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//赋值m_widget变量</span>
    m_widget <span class="token operator">=</span> this<span class="token punctuation">;</span>

    <span class="token comment">//初始化界面</span>
    this<span class="token operator">-&gt;</span><span class="token function">initWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Widget<span class="token operator">::</span><span class="token operator">~</span><span class="token function">Widget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    delete ui<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//初始化界面</span>
<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">initWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//创建子界面对象并显示</span>
    m_addWidget <span class="token operator">=</span> new <span class="token function">CallBackAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m_addWidget<span class="token operator">-&gt;</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//移到指定坐标防止遮挡主界面</span>
    m_addWidget<span class="token operator">-&gt;</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//使用信号与槽</span>
    <span class="token comment">//connect(m_addWidget,SIGNAL(signal_addNum(int)),this,SLOT(slot_addNum(int)));   //Qt4写法</span>
    <span class="token comment">//connect(m_addWidget,&amp;CallBackAdd::signal_addNum,this,&amp;Widget::slot_addNum);   //Qt5写法</span>

    <span class="token comment">//使用回调函数（普通成员函数）,通过function和bind实现</span>
    <span class="token comment">//m_addWidget-&gt;setCallBackFun(std::bind(&amp;Widget::getAddResult,this,_1));</span>

    <span class="token comment">//使用回调函数（静态成员函数）</span>
    m_addWidget<span class="token operator">-&gt;</span><span class="token function">setCallBackFun</span><span class="token punctuation">(</span>getAddNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//槽函数</span>
<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">slot_addNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> addNum<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span>le_num<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>QString<span class="token operator">::</span><span class="token function">number</span><span class="token punctuation">(</span>addNum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//回调函数的定义（普通成员函数）</span>
<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">getAddResult</span><span class="token punctuation">(</span><span class="token keyword">int</span> addResult<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token operator">-&gt;</span>le_num<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>QString<span class="token operator">::</span><span class="token function">number</span><span class="token punctuation">(</span>addResult<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//回调函数的定义（静态成员函数）</span>
<span class="token keyword">void</span> Widget<span class="token operator">::</span><span class="token function">getAddNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> addNum<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//静态成员函数并不能直接访问ui对象(普通成员函数)</span>
    <span class="token comment">//此处使用m_widget变量来实现静态成员函数操作ui对象</span>
    m_widget<span class="token operator">-&gt;</span>ui<span class="token operator">-&gt;</span>le_num<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span>QString<span class="token operator">::</span><span class="token function">number</span><span class="token punctuation">(</span>addNum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>5.callbackadd.ui<br> <img src="https://images2.imgbox.com/ca/b0/VF7HMabu_o.png" alt="请添加图片描述"></p> 
<p>6.widget.ui<br> <img src="https://images2.imgbox.com/be/63/1OWnZZmq_o.png" alt="请添加图片描述"></p> 
<hr> 
<h2><a id="_400"></a>总结</h2> 
<p>通过以上这个示例可以看到在Qt中使用使用回调函数也是可以实现不同对象间的通信，这里的示例比较简单，主要让大家对回调函数有个简单的认识，实现回调函数还有其它的方式，详细的内容可以看一下参考文章。（在Qt下开发，信号与槽是真香啊~~）</p> 
<hr> 
<p>hello：<br> 共同学习，共同进步，如果还有相关问题，可在评论区留言进行讨论。</p> 
<p>参考文章：<br> <a href="https://zhuanlan.zhihu.com/p/673057712" rel="nofollow">C++ Qt开发：如何使用信号与槽</a><br> <a href="https://blog.csdn.net/llzhang_fly/article/details/104933969">什么是回调函数？为什么要使用回调函数？如何使用回调函数？</a><br> <a href="https://www.cnblogs.com/bencai/p/9124654.html" rel="nofollow">C++11 bind和function用法</a><br> <a href="https://blog.csdn.net/qq_37668436/article/details/105163037">五种将c++类的成员函数用作回调函数的方法——史上最全、最简！！！</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/db5709753da16ad6177beccddcb12295/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Arcgis pro 字段计算器 python3常用方法二</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9857ace17627def2a01bb12437226cfa/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">下一代自动驾驶系统，少不了大模型，系统调研来了</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>