<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Activiti】原理 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【Activiti】原理" />
<meta property="og:description" content="一、核心类 RepositoryService：部署管理流程资源，如bpmn文件、附件等等；RuntimeService：操作运行时的流程；TaskService：流程中任务的信息；HistoryService：流程的历史信息；ManagerService：管理流程引擎的信息。 二、核心表 ACT_GE_*：General，表示通用表。ACT_HI_*：History，保存历史数据，比如执行过的流程实例、变量、任务等等。Activiti默认提供四种历史级别：none（不保存任何历史记录）、activity（保存所有的流程实例、任务、活动信息）、audit（默认级别，保存所有的流程实例、任务、活动、表单属性）、full（最完整的历史记录，详细到日志跟踪）。ACT_ID_*：Identity，保存身份信息，比如用户和组之间的关系。Activiti被集成到某一系统时，这些表可以不用，而直接使用现有系统中的用户或组信息。ACT_RE_*：Repository，保存一些仓库信息，比如流程定义、流程资源(图片或规则等)。ACT_RU_*：Runtime，保存一些流程实例、用户任务、变量等的运行时数据。当流程结束后会立即移除这些数据。 三、使用步骤 （1）编写bpmn文件，画流程图，在application.yml配置文件中【process-definition-location-prefix】标明需要扫描的流程图路径；
（2）创建流程引擎；
（3）获取RepositoryService实例：相当于拿到数据库连接；
（4）使用RepositoryService部署流程：相当于使用RepositoryService操作数据库。此处可设置流程名字、addClassPathResource()绑定流程图、部署流程。
（5）启动流程【RuntimeService】；
（6）创建任务【TaskService】；
（7）根据流程定义处理人等查询，并根据任务ID完成任务：taskService.complete()。
// 1.创建流程引擎 ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine(); // 2.获取RepositoryService实例：相当于拿到数据库连接 RepositoryService repositoryService = processEngine.getRepositoryService(); // 3.使用RepositoryService部署流程：相当于使用RepositoryService操作数据库 Deployment deployment = repositoryService.createDeployment() .name(&#34;请假申请流程&#34;) // 设置流程的名称 .addClasspathResource(&#34;processes/Leave.bpmn&#34;) // 设置流程所用到的资源 .addClasspathResource(&#34;processes/Leave.png&#34;) // 设置流程所用到的图片 .deploy(); // 部署流程，相当于插入操作 // 4.获取RuntimeService，根据流程定义ID启动流程实例 RuntimeService runtimeService = processEngine.getRuntimeService(); ProcessInstance processInstance = runtimeService.startProcessInstanceByKey(&#34;myLeave&#34;); // 5.创建TaskService，根据流程key和任务负责人查询此流程（myLeave）下的该负责人（zhangsan）所拥有的任务信息。 TaskService taskService = processEngine.getTaskService(); // 6.获取TaskService，完成任务 TaskService taskService = processEngine.getTaskService(); Task task = taskService.createTaskQuery() .processDefinitionKey(&#34;myLeave&#34;) ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/4f005736b02ace03cceb1285b9b3f905/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-25T11:50:57+08:00" />
<meta property="article:modified_time" content="2023-06-25T11:50:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Activiti】原理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>一、核心类</h4> 
<ul><li>RepositoryService：部署管理流程资源，如bpmn文件、附件等等；</li><li>RuntimeService：操作运行时的流程；</li><li>TaskService：流程中任务的信息；</li><li>HistoryService：流程的历史信息；</li><li>ManagerService：管理流程引擎的信息。</li></ul> 
<h4>二、核心表</h4> 
<ul><li>ACT_<span style="color:#ff9900;"><strong>GE</strong></span>_*：General，表示<strong><span style="color:#ff9900;">通用</span></strong>表。</li><li>ACT_<span style="color:#ff9900;"><strong>HI</strong></span>_*：History，保存<strong><span style="color:#ff9900;">历史</span></strong>数据，比如执行过的流程实例、变量、任务等等。Activiti默认提供四种历史级别：none（不保存任何历史记录）、activity（保存所有的流程实例、任务、活动信息）、audit（默认级别，保存所有的流程实例、任务、活动、表单属性）、full（最完整的历史记录，详细到日志跟踪）。</li><li>ACT_<span style="color:#ff9900;"><strong>ID</strong></span>_*：Identity，保存<strong><span style="color:#ff9900;">身份信息</span></strong>，比如用户和组之间的关系。Activiti被集成到某一系统时，这些表可以不用，而直接使用现有系统中的用户或组信息。</li><li>ACT_<span style="color:#fe2c24;"><strong>RE</strong></span>_*：Repository，保存一些<span style="color:#fe2c24;"><strong>仓库</strong></span>信息，比如<span style="color:#fe2c24;"><strong>流程定义</strong></span>、<span style="color:#fe2c24;"><strong>流程资源</strong></span>(图片或规则等)。</li><li>ACT_<span style="color:#fe2c24;"><strong>RU</strong></span>_*：Runtime，保存一些<span style="color:#fe2c24;"><strong>流程实例</strong></span>、<span style="color:#fe2c24;"><strong>用户任务</strong></span>、<span style="color:#fe2c24;"><strong>变量等的运行时数据</strong></span>。当流程结束后会立即移除这些数据。</li></ul> 
<h4>三、使用步骤</h4> 
<p>（1）编写bpmn文件，画流程图，在application.yml配置文件中【process-definition-location-prefix】标明需要扫描的流程图路径；</p> 
<p>（2）创建流程引擎；</p> 
<p>（3）获取RepositoryService实例：相当于拿到数据库连接；</p> 
<p>（4）使用RepositoryService部署流程：相当于使用RepositoryService操作数据库。此处可设置流程名字、addClassPathResource()绑定流程图、部署流程。</p> 
<p>（5）启动流程【RuntimeService】；</p> 
<p>（6）创建任务【TaskService】；</p> 
<p>（7）根据流程定义处理人等查询，并根据任务ID完成任务：taskService.complete()。</p> 
<pre><code class="language-java">// 1.创建流程引擎
ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();

// 2.获取RepositoryService实例：相当于拿到数据库连接
RepositoryService repositoryService = processEngine.getRepositoryService();

// 3.使用RepositoryService部署流程：相当于使用RepositoryService操作数据库
Deployment deployment = repositoryService.createDeployment()
        .name("请假申请流程")                        // 设置流程的名称
        .addClasspathResource("processes/Leave.bpmn")    // 设置流程所用到的资源
        .addClasspathResource("processes/Leave.png")     // 设置流程所用到的图片
        .deploy();    // 部署流程，相当于插入操作

// 4.获取RuntimeService，根据流程定义ID启动流程实例
RuntimeService runtimeService = processEngine.getRuntimeService();
ProcessInstance processInstance = runtimeService.startProcessInstanceByKey("myLeave");

// 5.创建TaskService，根据流程key和任务负责人查询此流程（myLeave）下的该负责人（zhangsan）所拥有的任务信息。
TaskService taskService = processEngine.getTaskService();

// 6.获取TaskService，完成任务
TaskService taskService = processEngine.getTaskService();
Task task = taskService.createTaskQuery()
        .processDefinitionKey("myLeave")
        .taskAssignee("zhangsan")
        .singleResult();
if (task != null) {
    taskService.complete(task.getId());
}
</code></pre> 
<p><img alt="" height="404" src="https://images2.imgbox.com/0d/53/xsPOWbRB_o.png" width="1007"></p> 
<h4>四、 Activiti和Flowable对比</h4> 
<p><strong>（一）Flowable的优点：</strong></p> 
<ul><li><strong>架构灵活</strong>：Flowable的架构非常灵活，可以轻松地嵌入到Spring或者其他Java应用中，也可以作为独立的服务运行。</li><li><strong>扩展性强</strong>：Flowable提供了插件机制，可以方便地扩展和定制工作流引擎的功能。</li><li><strong>高可用性</strong>：Flowable<span style="color:#fe2c24;">支持分布式部署</span>，可以实现高可用性的工作流引擎。</li><li><strong>维护活跃</strong>：Flowable项目有一个活跃的社区，提供了及时的技术支持和更新。</li></ul> 
<p><strong>（二）Flowable的缺点：</strong></p> 
<ul><li><strong>文档相对较少：</strong>Flowable相对于Activiti，文档相对较少。</li><li><strong>社区相对较小：</strong>Flowable的社区相对于Activiti，规模较小。</li></ul> 
<p><strong>（三）Activiti的优点：</strong></p> 
<ul><li><strong>文档详细：</strong>Activiti的官方文档非常详细，易于新手学习和使用。</li><li><strong>社区活跃：</strong>Activiti的社区规模较大，提供了广泛的技术支持和资源。</li><li><strong>易于集成：</strong>Activiti可以轻松地与Spring集成，也可以作为独立的服务运行。</li><li><strong>贡献者较多：</strong>Activiti是一个比较成熟的工作流引擎，有大量的贡献者和用户，可以提供成熟的解决方案。</li></ul> 
<p><strong>（四）Activiti的缺点：</strong></p> 
<ul><li><strong>扩展性较弱：</strong>Activiti的插件机制较为有限，扩展和定制功能不如Flowable方便。</li><li><strong>可靠性较低：</strong>Activiti在一些用户反馈的场景下，存在一些稳定性问题，需要注意。</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/86e253701670699a4c493a12e9e99fd5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">软件测试实验五 自动化测试参考案例</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e9cef4952c2a84a9ae5b68d2dabde759/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【SSO】单点登录方案</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>