<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>2024年MySQL学习指南（五），探索MySQL数据库，掌握未来数据管理趋势 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="2024年MySQL学习指南（五），探索MySQL数据库，掌握未来数据管理趋势" />
<meta property="og:description" content="文章目录 17. 数据库设计17.1 概念17.2 表的关系 18. 多表查询18.1 内连接查询18.2 外连接查询18.3 子查询 19. 事务19.1 概念19.2 语法19.3 特征 20. 总结 17. 数据库设计 17.1 概念 数据库设计是软件研发过程中很重要的一个环节，在学习数据库设计之前，要先了解软件研发的步骤。
一个成熟的软件，从想法的产生到成功上线，要经历需求调研及分析，设计，编码，测试和部署等过程，在开始阶段产品经理会根据客户的需求设计产品原型，而设计一般有架构师和开发工程师完成，这其中就包括数据库设计，还有软件结构设计，接口设计等，接着就是由开发工程师来编写代码，由测试工程师来测试，接着就可以部署上线。
数据库设计就是根据业务系统的具体需求，结合我们所选用的 DBMS，为这个业务系统构造出最优的数据存储模型。通俗的说就是建立数据库中的表结构以及表与表之间的关联关系的过程，分析有哪些表，哪些字段等。
数据库设计分为以下几个步骤：
需求分析逻辑分析物理分析维护设计 17.2 表的关系 表和表之间的关系有一对一的关系，主要用于表的拆分，利于把常用数据和不常用数据分开存储，提高查询的效率。一对多或者多对一的关系，例如部门表和员工表的关系，多对多的关系，例如商品和订单的关系。
一对多的关系中，在表示多的一方建立外键，指向另一方的主键，示例：
-- 删除表 DROP TABLE IF EXISTS tb_emp; DROP TABLE IF EXISTS tb_dept; -- 部门表 CREATE TABLE tb_dept( id int primary key auto_increment, dep_name varchar(20), addr varchar(20) ); -- 员工表 CREATE TABLE tb_emp( id int primary key auto_increment, name varchar(20), age int, dep_id int, -- 添加外键 dep_id,关联 dept 表的id主键 CONSTRAINT fk_emp_dept FOREIGN KEY(dep_id) REFERENCES tb_dept(id) ); 查看两表结构模型：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/5154135416a65652d16bf54f66ab9d35/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-08T08:05:01+08:00" />
<meta property="article:modified_time" content="2024-01-08T08:05:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2024年MySQL学习指南（五），探索MySQL数据库，掌握未来数据管理趋势</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#17__1" rel="nofollow">17. 数据库设计</a></li><li><ul><li><a href="#171__3" rel="nofollow">17.1 概念</a></li><li><a href="#172__30" rel="nofollow">17.2 表的关系</a></li></ul> 
  </li><li><a href="#18__144" rel="nofollow">18. 多表查询</a></li><li><ul><li><a href="#181__190" rel="nofollow">18.1 内连接查询</a></li><li><a href="#182__234" rel="nofollow">18.2 外连接查询</a></li><li><a href="#183__280" rel="nofollow">18.3 子查询</a></li></ul> 
  </li><li><a href="#19__323" rel="nofollow">19. 事务</a></li><li><ul><li><a href="#191__325" rel="nofollow">19.1 概念</a></li><li><a href="#192__336" rel="nofollow">19.2 语法</a></li><li><a href="#193__402" rel="nofollow">19.3 特征</a></li></ul> 
  </li><li><a href="#20__412" rel="nofollow">20. 总结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="17__1"></a>17. 数据库设计</h2> 
<h3><a id="171__3"></a>17.1 概念</h3> 
<p>数据库设计是软件研发过程中很重要的一个环节，在学习数据库设计之前，要先了解软件研发的步骤。</p> 
<p>一个成熟的软件，从想法的产生到成功上线，要经历需求调研及分析，设计，编码，测试和部署等过程，在开始阶段产品经理会根据客户的需求设计产品原型，而设计一般有架构师和开发工程师完成，这其中就包括数据库设计，还有软件结构设计，接口设计等，接着就是由开发工程师来编写代码，由测试工程师来测试，接着就可以部署上线。</p> 
<p><img src="https://images2.imgbox.com/9e/a5/3kZMgGxA_o.png" alt="image-20230118162804575"></p> 
<p>数据库设计就是根据业务系统的具体需求，结合我们所选用的 DBMS，为这个业务系统构造出最优的数据存储模型。通俗的说就是建立数据库中的表结构以及表与表之间的关联关系的过程，分析有哪些表，哪些字段等。</p> 
<p>数据库设计分为以下几个步骤：</p> 
<ul><li>需求分析</li><li>逻辑分析</li><li>物理分析</li><li>维护设计</li></ul> 
<h3><a id="172__30"></a>17.2 表的关系</h3> 
<p>表和表之间的关系有一对一的关系，主要用于表的拆分，利于把常用数据和不常用数据分开存储，提高查询的效率。一对多或者多对一的关系，例如部门表和员工表的关系，多对多的关系，例如商品和订单的关系。</p> 
<p>一对多的关系中，在表示多的一方建立外键，指向另一方的主键，示例：</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 删除表</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> tb_emp<span class="token punctuation">;</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> tb_dept<span class="token punctuation">;</span>
<span class="token comment">-- 部门表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tb_dept<span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
dep_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
addr <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 员工表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tb_emp<span class="token punctuation">(</span>
id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
age <span class="token keyword">int</span><span class="token punctuation">,</span>
dep_id <span class="token keyword">int</span><span class="token punctuation">,</span>
<span class="token comment">-- 添加外键 dep_id,关联 dept 表的id主键</span>
<span class="token keyword">CONSTRAINT</span> fk_emp_dept <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>dep_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> tb_dept<span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>查看两表结构模型：</p> 
<p><img src="https://images2.imgbox.com/a6/a8/c9g22H9I_o.png" alt="image-20230118165220573"></p> 
<p>多对多的关系中，建立第三张中间表，中间表至少包含两个外键，分别关联两方主键，例如商品表和订单表。示例：</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 删除表</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> tb_order_goods<span class="token punctuation">;</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> tb_order<span class="token punctuation">;</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> tb_goods<span class="token punctuation">;</span>

<span class="token comment">-- 订单表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tb_order<span class="token punctuation">(</span>
	id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
	payment <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	payment_type <span class="token keyword">TINYINT</span><span class="token punctuation">,</span>
	<span class="token keyword">status</span> <span class="token keyword">TINYINT</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 商品表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tb_goods<span class="token punctuation">(</span>
	id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
	title <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	price <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 订单商品中间表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tb_order_goods<span class="token punctuation">(</span>
	id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
	order_id <span class="token keyword">int</span><span class="token punctuation">,</span>
	goods_id <span class="token keyword">int</span><span class="token punctuation">,</span>
	count <span class="token keyword">int</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 建完表后，添加外键</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> tb_order_goods <span class="token keyword">add</span> <span class="token keyword">CONSTRAINT</span> fk_order_id <span class="token keyword">FOREIGN</span> <span class="token keyword">key</span><span class="token punctuation">(</span>order_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span>
tb_order<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> tb_order_goods <span class="token keyword">add</span> <span class="token keyword">CONSTRAINT</span> fk_goods_id <span class="token keyword">FOREIGN</span> <span class="token keyword">key</span><span class="token punctuation">(</span>goods_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span>
tb_goods<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>查看两表的结构模型：</p> 
<p><img src="https://images2.imgbox.com/be/12/9Gl5N49v_o.png" alt="image-20230118170159454"></p> 
<p>一对一的关系中，在任意一方加入外键，关联另一方主键，并且设置外键为唯一(UNIQUE)，例如用户和用户详情。</p> 
<p>示例：</p> 
<pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> tb_user_desc <span class="token punctuation">(</span>
	id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
	city <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	edu <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	income <span class="token keyword">int</span><span class="token punctuation">,</span>
	<span class="token keyword">status</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	des <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> tb_user <span class="token punctuation">(</span>
	id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
	photo <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	nickname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	age <span class="token keyword">int</span><span class="token punctuation">,</span>
	gender <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	desc_id <span class="token keyword">int</span> <span class="token keyword">unique</span><span class="token punctuation">,</span>
<span class="token comment">-- 添加外键</span>
<span class="token keyword">CONSTRAINT</span> fk_user_desc <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>desc_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> tb_user_desc<span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/59/46/7MYlFd34_o.png" alt="image-20230118170432408"></p> 
<h2><a id="18__144"></a>18. 多表查询</h2> 
<p>前面学习查询操作时，一直是从一张表中查询数据，而数据库的多表查询操作也是非常重要的一部分。多表查询就是一次性从多张表中查询出需要的数据。</p> 
<p>在MySQL中多表查询分为连接查询和子查询，而连接查询又分为内连接查询和外连接查询，外连接查询的方式有左外连接查询和右外连接查询。下面对多表查询做一些基础的练习！</p> 
<p>下面是演示多表查询使用的 sql:</p> 
<pre><code class="prism language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> emp<span class="token punctuation">;</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> dept<span class="token punctuation">;</span>

<span class="token comment"># 创建部门表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> dept<span class="token punctuation">(</span>
	did <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	dname <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># 创建员工表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> emp <span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	gender <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">-- 性别</span>
	salary <span class="token keyword">DOUBLE</span><span class="token punctuation">,</span> <span class="token comment">-- 工资</span>
	dep_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
	<span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>dep_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> dept<span class="token punctuation">(</span>did<span class="token punctuation">)</span> <span class="token comment">-- 外键，关联部门表(部门表的主键)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 添加部门数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> dept <span class="token punctuation">(</span>dNAME<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'研发部'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'财务部'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'销售部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 添加员工数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> emp<span class="token punctuation">(</span>NAME<span class="token punctuation">,</span>gender<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>dep_id<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token string">'小张'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">3000</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'小李'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token number">3600</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'小王'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token number">9000</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token string">'小美'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token number">5000</span><span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>执行 sql ，创建表：</p> 
<p><img src="https://images2.imgbox.com/7a/b6/bt47mc18_o.png" alt="image-20230118205616530"></p> 
<h3><a id="181__190"></a>18.1 内连接查询</h3> 
<p>内连接查询分为隐式内连接查询和显式内连接查询，表示查询 A 集合和 B 集合的交集。</p> 
<p><img src="https://images2.imgbox.com/4d/7b/De57qZjV_o.png" alt="image-20230118211114307"></p> 
<p>语法：</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 隐式内连接查询</span>
<span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表<span class="token number">1</span><span class="token punctuation">,</span>表<span class="token number">2</span>… <span class="token keyword">WHERE</span> 条件<span class="token punctuation">;</span>

<span class="token comment">-- 显示内连接查询</span>
<span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表<span class="token number">1</span> <span class="token punctuation">[</span><span class="token keyword">INNER</span><span class="token punctuation">]</span> <span class="token keyword">JOIN</span> 表<span class="token number">2</span> <span class="token keyword">ON</span> 条件<span class="token punctuation">;</span>
</code></pre> 
<p>隐式内连接查询示例：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">,</span>dept <span class="token keyword">where</span> dep_id<span class="token operator">=</span>did<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<p><img src="https://images2.imgbox.com/b2/0c/IiC7LufX_o.png" alt="image-20230118205840002"></p> 
<p>显式内连接查询示例：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">inner</span> <span class="token keyword">join</span> dept <span class="token keyword">on</span> dep_id<span class="token operator">=</span>did<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<p><img src="https://images2.imgbox.com/b0/a6/f5HHBa92_o.png" alt="image-20230118210058156"></p> 
<h3><a id="182__234"></a>18.2 外连接查询</h3> 
<p>外连接查询分为作为连接查询和右外连接查询。左外连接查询：相当于查询A表所有数据和交集部分数据。</p> 
<p><img src="https://images2.imgbox.com/35/c1/KpxPf7Ar_o.png" alt="image-20230118211519159"></p> 
<p>右外连接查询：相当于查询B表所有数据和交集部分数据。</p> 
<p><img src="https://images2.imgbox.com/8c/4e/pgdtL6XU_o.png" alt="image-20230118211713784"></p> 
<p>语法：</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 左外连接</span>
<span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表<span class="token number">1</span> <span class="token keyword">LEFT</span> <span class="token punctuation">[</span><span class="token keyword">OUTER</span><span class="token punctuation">]</span> <span class="token keyword">JOIN</span> 表<span class="token number">2</span> <span class="token keyword">ON</span> 条件<span class="token punctuation">;</span>

<span class="token comment">-- 右外连接</span>
<span class="token keyword">SELECT</span> 字段列表 <span class="token keyword">FROM</span> 表<span class="token number">1</span> <span class="token keyword">RIGHT</span> <span class="token punctuation">[</span><span class="token keyword">OUTER</span><span class="token punctuation">]</span> <span class="token keyword">JOIN</span> 表<span class="token number">2</span> <span class="token keyword">ON</span> 条件<span class="token punctuation">;</span>
</code></pre> 
<p>左外连接查询示例：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept <span class="token keyword">on</span> dep_id<span class="token operator">=</span>did<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<p><img src="https://images2.imgbox.com/10/47/ZL5PJuCm_o.png" alt="image-20230118212108078"></p> 
<p>右外连接查询示例：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">right</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> dept <span class="token keyword">on</span> dep_id<span class="token operator">=</span>did<span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<p><img src="https://images2.imgbox.com/37/dc/rIIqc4ra_o.png" alt="image-20230118212146475"></p> 
<h3><a id="183__280"></a>18.3 子查询</h3> 
<p>子查询是指查询中嵌套有查询，以下的几种情况通常使用嵌套查询：</p> 
<p>子查询语句结果是单行单列，子查询语句作为条件值，使用 = != &gt; &lt; 等进行条件判断，例如查询员工中工资大于小李的员工信息：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> salary <span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">select</span> salary <span class="token keyword">from</span> emp <span class="token keyword">where</span> name<span class="token operator">=</span><span class="token string">'小李'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<p><img src="https://images2.imgbox.com/6d/f0/qg9XKJZW_o.png" alt="image-20230118212801301"></p> 
<p>子查询语句结果是多行单列，子查询语句作为条件值，使用 in 等关键字进行条件判断，例如查询研发部和财务部员工信息：</p> 
<pre><code class="prism language-sql">
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> dep_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> did <span class="token keyword">from</span> dept <span class="token keyword">where</span> dname<span class="token operator">=</span><span class="token string">'研发部'</span> <span class="token operator">or</span> dname<span class="token operator">=</span> <span class="token string">'财务部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>结果：</p> 
<p><img src="https://images2.imgbox.com/6b/f7/Jx8vELbM_o.png" alt="image-20230118213728883"></p> 
<p>子查询语句结果是多行多列，子查询语句作为虚拟表，例如查询员工中工资大于3000的员工的信息和部门信息：</p> 
<pre><code class="prism language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> salary<span class="token operator">&gt;</span><span class="token number">3000</span><span class="token punctuation">)</span> t1<span class="token punctuation">,</span> dept <span class="token keyword">where</span> t1<span class="token punctuation">.</span>dep_id<span class="token operator">=</span>dept<span class="token punctuation">.</span>did<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e7/9c/QkqHstOm_o.png" alt="image-20230118214412049"></p> 
<h2><a id="19__323"></a>19. 事务</h2> 
<h3><a id="191__325"></a>19.1 概念</h3> 
<p>数据库的事务是一种机制，包含了一组数据库操作命令。事务把所有的命令作为一个整体一起向系统提交或撤销操作请求，即这一组数据库命令要么同时成功，要么同时失败。</p> 
<p>例如在进行转账操作时，张三转账给李四 500 元，首先会验证张三账户余额是否充足，如果是，则张三账户减少 500，李四账户增加 500 。如果在这过程中，由于某种原因出现错误，李四的账户没有增加 500 ，那么张三账户减少 500 的操作也不能完成。也就是要保证在这个过程中张三和李四账户余额总和要保持不变。</p> 
<p><img src="https://images2.imgbox.com/e7/e7/bUKBWElq_o.png" alt="image-20230118220346611"></p> 
<h3><a id="192__336"></a>19.2 语法</h3> 
<p>开启事务：</p> 
<pre><code class="prism language-sql"><span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>
或者
<span class="token keyword">BEGIN</span><span class="token punctuation">;</span>
</code></pre> 
<p>回滚事务：</p> 
<pre><code class="prism language-sql"><span class="token keyword">commit</span><span class="token punctuation">;</span>
</code></pre> 
<p>提交事务：</p> 
<pre><code class="prism language-sql"><span class="token keyword">rollback</span><span class="token punctuation">;</span>
</code></pre> 
<p>小练习：张三转账给李四</p> 
<pre><code class="prism language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> account<span class="token punctuation">;</span>
<span class="token comment">-- 创建账户表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> account<span class="token punctuation">(</span>
	id <span class="token keyword">int</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
	name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	money <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> account<span class="token punctuation">(</span>name<span class="token punctuation">,</span>money<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>添加事务：</p> 
<pre><code class="prism language-sql"><span class="token comment">-- 开启事务</span>
<span class="token keyword">BEGIN</span><span class="token punctuation">;</span>
<span class="token comment">-- 转账操作</span>
<span class="token comment">-- 1. 查询李四账户金额是否大于500</span>
<span class="token comment">-- 2. 张三账户 -500</span>
<span class="token keyword">UPDATE</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">-</span> <span class="token number">500</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
<span class="token number">3</span><span class="token operator">%</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">--出现异常</span>
<span class="token comment">-- 3. 李四账户 +500</span>
<span class="token keyword">UPDATE</span> account <span class="token keyword">set</span> money <span class="token operator">=</span> money <span class="token operator">+</span> <span class="token number">500</span> <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'李四'</span><span class="token punctuation">;</span>
<span class="token comment">-- 提交事务</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
<span class="token comment">-- 回滚事务</span>
<span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span>
</code></pre> 
<p>如果不添加事务，张三的账户就会减少 500 ，而李四的账户并不会增加 500，这样并不符合我们的实际生活。否则张三的 500 便不翼而飞了，哈哈哈！可见事务的重要性。</p> 
<h3><a id="193__402"></a>19.3 特征</h3> 
<p>MySQl 事务具有四大特征，分别是：</p> 
<ul><li>原子性: 事务是不可分割的最小操作单位，要么同时成功，要么同时失败</li><li>一致性 :事务完成时，必须使所有的数据都保持一致状态</li><li>隔离性: 多个事务之间，操作的可见性</li><li>持久性: 事务一旦提交或回滚，它对数据库中的数据的改变就是永久的</li></ul> 
<h2><a id="20__412"></a>20. 总结</h2> 
<p><code>科技发展，社会进步。</code>未来对数据的定义会不断地革新，生活的方方面面都会被列入数据的行列。从某种意义上来说，数据就是信息，只是数据不能直观地带来价值，而信息可以，但未来，这两者之间的距离会越来越缩小，直至划上等号。</p> 
<p>未来是一个数字化的时代，数据是我们最为宝贵的资源，不论是哪个专业出身，未来或多或少都会卷入数据时代的浪潮之中。而那些前提性的工作基本都是依靠<code>数据库</code>来完成。</p> 
<p>祝你事业有成！下期见。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/09fd6fd18fa89f4de9b148cd77555500/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【C&#43;&#43;】C&#43;&#43;的类型转换</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0815eeffe086d5dbca940106a77180fb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">帆软笔记-表格中自定义现实</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>