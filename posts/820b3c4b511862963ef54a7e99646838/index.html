<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python &#43; Django &#43; MySQL 系列学习 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="python &#43; Django &#43; MySQL 系列学习" />
<meta property="og:description" content="python &#43; Django &#43; MySQL 系列学习 文章目录 python &#43; Django &#43; MySQL 系列学习前言一、环境搭建二、学习步骤1.留言板快速开发1.1 使用python创建Django项目1.2 创建应用1.3 配置html 逻辑1.4 Django 调用Mysql 2.读入数据 前言 本文记录 python &#43; django 的学习记录
一、环境搭建 python版本：python3.9
Django版本：Django==2.2
Pycharm 专业版
Navicat15 for MySQL
mysql for windows
django 中文文档：https://docs.djangoproject.com/zh-hans/2.0/
环境安装可自行百度进行安装，本文主要集中在如何使用Django构建项目
二、学习步骤 1.留言板快速开发 1.1 使用python创建Django项目 基础文件介绍：
（1）Message-&gt;Message-&gt;settings 中存放所有可配置的设置
（2）Message-&gt;Message-&gt;urls 中存放一些可映射的url地址
（3）Message-&gt;static 可存放一些全局静态文件（自行创建文件夹，并在setting中添加以下命令）
# 访问全局静态文件 STATICFILES_DIRS = [ os.path.join(BASE_DIR, &#39;static&#39;) ] （4）Message-&gt;manage.py 入口文件
（5）Message-&gt;media 可存放一些图片等信息（自行创建文件夹）
（6）Message-&gt;extra_apps 可以存放一些外部引用的应用（自行创建文件夹）
（7）Message-&gt;apps 可以存放一些自己创建的应用
（8）Message-&gt;apps-&gt;message_form-&gt;migrations 数据库迁移/修改需要用到的目录" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/820b3c4b511862963ef54a7e99646838/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-09T19:34:29+08:00" />
<meta property="article:modified_time" content="2022-04-09T19:34:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python &#43; Django &#43; MySQL 系列学习</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="python__Django__MySQL__0"></a>python + Django + MySQL 系列学习</h2> 
<hr> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#python__Django__MySQL__0" rel="nofollow">python + Django + MySQL 系列学习</a></li><li><a href="#_10" rel="nofollow">前言</a></li><li><a href="#_17" rel="nofollow">一、环境搭建</a></li><li><a href="#_28" rel="nofollow">二、学习步骤</a></li><li><ul><li><a href="#1_29" rel="nofollow">1.留言板快速开发</a></li><li><ul><li><a href="#11_pythonDjango_30" rel="nofollow">1.1 使用python创建Django项目</a></li><li><a href="#12__52" rel="nofollow">1.2 创建应用</a></li><li><a href="#13_html__63" rel="nofollow">1.3 配置html 逻辑</a></li><li><a href="#14_Django_Mysql_144" rel="nofollow">1.4 Django 调用Mysql</a></li></ul> 
   </li><li><a href="#2_179" rel="nofollow">2.读入数据</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_10"></a>前言</h2> 
<p>本文记录 python + django 的学习记录</p> 
<hr> 
<h2><a id="_17"></a>一、环境搭建</h2> 
<p>python版本：python3.9<br> Django版本：Django==2.2<br> Pycharm 专业版<br> Navicat15 for MySQL<br> mysql for windows</p> 
<p>django 中文文档：https://docs.djangoproject.com/zh-hans/2.0/</p> 
<p>环境安装可自行百度进行安装，本文主要集中在如何使用Django构建项目</p> 
<h2><a id="_28"></a>二、学习步骤</h2> 
<h3><a id="1_29"></a>1.留言板快速开发</h3> 
<h4><a id="11_pythonDjango_30"></a>1.1 使用python创建Django项目</h4> 
<p><img src="https://images2.imgbox.com/b8/28/Jx5kFDeF_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/31/11/gQJe1El2_o.png" alt="在这里插入图片描述"><br> 基础文件介绍：<br> （1）Message-&gt;Message-&gt;settings 中存放所有可配置的设置<br> （2）Message-&gt;Message-&gt;urls 中存放一些可映射的url地址<br> （3）Message-&gt;static 可存放一些全局静态文件（自行创建文件夹，并在setting中添加以下命令）</p> 
<pre><code class="prism language-c"># 访问全局静态文件
STATICFILES_DIRS <span class="token operator">=</span> <span class="token punctuation">[</span>
    os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span> <span class="token char">'static'</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre> 
<p>（4）Message-&gt;manage.py 入口文件<br> （5）Message-&gt;media 可存放一些图片等信息（自行创建文件夹）<br> （6）Message-&gt;extra_apps 可以存放一些外部引用的应用（自行创建文件夹）<br> （7）Message-&gt;apps 可以存放一些自己创建的应用<br> （8）Message-&gt;apps-&gt;message_form-&gt;migrations 数据库迁移/修改需要用到的目录<br> （9）Message-&gt;apps-&gt;message_form-&gt;static 可存放一些本应用的静态文件（自行创建文件夹）<br> （10）Message-&gt;apps-&gt;message_form-&gt;models.py 可通过该函数实现数据库的基础字段修改<br> （11）Message-&gt;apps-&gt;message_form-&gt;views.py 实现对网页的逻辑处理</p> 
<h4><a id="12__52"></a>1.2 创建应用</h4> 
<p>使用命令行创建应用</p> 
<pre><code class="prism language-c">python manage<span class="token punctuation">.</span>py startapp message_form
</code></pre> 
<p>使用pycharm创建应用<br> <img src="https://images2.imgbox.com/c4/5b/Ygjnpbrp_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/74/0a/599UmcHV_o.png" alt=""></p> 
<p>在setting 中的INSTALLED_APPS 中添加应用，不然会出错<br> <img src="https://images2.imgbox.com/a1/8d/AaxLTgY5_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="13_html__63"></a>1.3 配置html 逻辑</h4> 
<p>在view中定义对应的函数名</p> 
<pre><code class="prism language-c">from django<span class="token punctuation">.</span>shortcuts import render
from apps<span class="token punctuation">.</span>message_form<span class="token punctuation">.</span>models import Message
#配置一个html页面的显示步骤
#<span class="token number">1.</span> 配置url
#<span class="token number">2.</span> 配置对应的view逻辑
#<span class="token number">3.</span> 可拆分对应的静态（css<span class="token punctuation">,</span> js<span class="token punctuation">,</span> images）放入到<span class="token keyword">static</span>，html 放入到template之下
    # <span class="token number">3.1</span> <span class="token keyword">static</span> 可以放到对应的apps中，
    # <span class="token number">3.2</span> 也可以放到全局的tmplate 和 <span class="token keyword">static</span> 目录下
#<span class="token number">4.</span> 配置全局的<span class="token keyword">static</span>文件访问路径的配置，可以在setting中添加以下配置
    # 访问全局静态文件
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">STATICFILES_DIRS <span class="token operator">=</span> <span class="token punctuation">[</span></span></span>
    <span class="token macro property"><span class="token directive-hash">#</span>     <span class="token directive keyword">os</span><span class="token expression"><span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span> </span><span class="token char">'static'</span><span class="token expression"><span class="token punctuation">)</span></span></span>
    # <span class="token punctuation">]</span>


def <span class="token function">message_form</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token operator">:</span>
    #<span class="token number">1.</span> get all
    # 取出数据库所有的数据 返回的queryset字段，可用于<span class="token keyword">for</span>循环，切片操作
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">queryset</span><span class="token expression">本身并没有执行sql操作</span></span>
    all_messages <span class="token operator">=</span> Message<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span>all_messages<span class="token punctuation">.</span>query<span class="token punctuation">)</span>
    <span class="token keyword">for</span> message in all_messages<span class="token operator">:</span>
        <span class="token function">print</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>name<span class="token punctuation">)</span>

    #<span class="token number">2.</span> filter
    all_messages <span class="token operator">=</span> Message<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"fuxingxue"</span><span class="token punctuation">)</span>
    <span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">all</span><span class="token expression">_messages<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span>
    <span class="token function">print</span><span class="token punctuation">(</span>all_messages<span class="token punctuation">.</span>query<span class="token punctuation">)</span>
    <span class="token keyword">for</span> message in all_messages<span class="token operator">:</span>
        <span class="token function">print</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>email<span class="token punctuation">)</span>

    #<span class="token number">3.</span> get 返回的是一个对象，数据不存在 <span class="token operator">/</span> 有多条数据存在会抛出异常
    try<span class="token operator">:</span>
        message <span class="token operator">=</span> Message<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"fuxingxue"</span><span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    except Exception as e<span class="token operator">:</span>
        pass

    # <span class="token number">4.</span> 数据插入
    message <span class="token operator">=</span> <span class="token function">Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    message<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"bobby"</span>
    message<span class="token punctuation">.</span>email <span class="token operator">=</span> <span class="token string">"bobby@qq.com"</span>
    message<span class="token punctuation">.</span>address <span class="token operator">=</span> <span class="token string">"shenzhen"</span>
    message<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">"留言"</span>
    # 存在，更新
    # 不存在，插入
    message<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    # <span class="token number">5.</span> 从html中提取数据
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token operator">:</span>
        name <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
        email <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"email"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
        address <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"address"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
        message_text <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
        message <span class="token operator">=</span> <span class="token function">Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        message<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        message<span class="token punctuation">.</span>email <span class="token operator">=</span> email
        message<span class="token punctuation">.</span>address <span class="token operator">=</span> address
        message<span class="token punctuation">.</span>message <span class="token operator">=</span> message_text
        message<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    var_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token operator">:</span>
        all_messages <span class="token operator">=</span> Message<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> all_messages<span class="token operator">:</span>
            message <span class="token operator">=</span> all_messages<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            var_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string">"message"</span> <span class="token operator">:</span> message
            <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token function">render</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"message_form.html"</span><span class="token punctuation">,</span> var_dict<span class="token punctuation">)</span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Create your views here<span class="token punctuation">.</span></span></span>

</code></pre> 
<p>在url.py中引入访问地址 &amp;&amp; 函数入口名称<br> <img src="https://images2.imgbox.com/8a/b8/gzGjEy5z_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/75/11/iWllvfRb_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="14_Django_Mysql_144"></a>1.4 Django 调用Mysql</h4> 
<p>setting中使用的默认数据库为sqlite3，如需修改成MySQL，需要将文件按照如下配置（Django支持哪些数据库可以通过文档查询）<br> <img src="https://images2.imgbox.com/14/27/Atb4xtrF_o.png" alt="在这里插入图片描述"><br> 由于Django默认是不会安装MySQL驱动的，直接运行会报错 No install app with label ‘admin’</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token expression">Django 支持 mysql 下载地址<span class="token punctuation">(</span>需根据python版本进行下载<span class="token punctuation">)</span></span></span>
https<span class="token operator">:</span><span class="token comment">//www.lfd.uci.edu/~gohlke/pythonlibs/</span>

pip install mysqlclient‑<span class="token number">1.4</span><span class="token number">.6</span>‑cp39‑cp39‑win_amd64<span class="token punctuation">.</span>whl
</code></pre> 
<p>通过Tools-&gt;Run manage.py Task…，运行一下两个命令对mysql的表进行创建</p> 
<pre><code class="prism language-c"><span class="token function">makemigrations</span> <span class="token punctuation">(</span>对修改models<span class="token punctuation">.</span>py进行识别，并创建执行语句到migrations目录下<span class="token punctuation">)</span>
migrate（执行migrations下的文件）
</code></pre> 
<pre><code class="prism language-c">models<span class="token punctuation">.</span>py

from django<span class="token punctuation">.</span>db import models

class <span class="token function">Message</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token operator">:</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span><span class="token function">CharField</span><span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">"姓名"</span><span class="token punctuation">,</span> primary_key<span class="token operator">=</span>True<span class="token punctuation">)</span>
    email <span class="token operator">=</span> models<span class="token punctuation">.</span><span class="token function">EmailField</span><span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">"邮箱"</span><span class="token punctuation">)</span>
    address <span class="token operator">=</span> models<span class="token punctuation">.</span><span class="token function">CharField</span><span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">"联系地址"</span><span class="token punctuation">)</span>
    message <span class="token operator">=</span> models<span class="token punctuation">.</span><span class="token function">TextField</span><span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">"留言信息"</span><span class="token punctuation">)</span>

    class Meta<span class="token operator">:</span>
        verbose_name <span class="token operator">=</span> <span class="token string">"留言信息"</span>
        verbose_name_plural <span class="token operator">=</span> verbose_name
        # 表名
        db_table <span class="token operator">=</span> <span class="token string">"message"</span>

</code></pre> 
<h3><a id="2_179"></a>2.读入数据</h3> 
<p>代码如下（示例）：</p> 
<pre><code class="prism language-c">data <span class="token operator">=</span> pd<span class="token punctuation">.</span><span class="token function">read_csv</span><span class="token punctuation">(</span>
    'https<span class="token operator">:</span><span class="token comment">//labfile.oss.aliyuncs.com/courses/1283/adult.data.csv')</span>
<span class="token function">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p>该处使用的url网络请求的数据。</p> 
<hr>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7d911d66c2f79b47764a8caf0de4826c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Could not find or load main class org.apache.hadoop.mapreduce.v2.app.MRAppMaster</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/017abbf35ff87100560ed63c060a4f6a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">网络知识-02 物理层</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>