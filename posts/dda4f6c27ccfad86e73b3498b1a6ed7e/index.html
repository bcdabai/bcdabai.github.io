<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用ajaxSubmit方法实现多文件上传(异步) - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用ajaxSubmit方法实现多文件上传(异步)" />
<meta property="og:description" content="1、上传按钮
&lt;button οnclick=&#34;toImport()&#34; class=&#34;btn green&#34;&gt;导入&lt;i class=&#34;icon-upload-alt&#34;&gt;&lt;/i&gt;&lt;/button&gt; 2、文件选择弹出层和添加组件的html代码 &lt;div id=&#34;import_modal&#34; class=&#34;modal hide fade&#34;&gt;&lt;formaction=&#34;${pageContext.request.contextPath }/**/importFile!impXLS.do&#34;id=&#34;ajax_form&#34; class=&#34;form-horizontal&#34;&gt;&lt;div class=&#34;modal-header&#34;&gt;&lt;button type=&#34;button&#34; class=&#34;close cancelUpload&#34;data-dismiss=&#34;modal&#34; aria-hidden=&#34;true&#34;&gt;&lt;/button&gt;&lt;h3&gt;文件导入&lt;/h3&gt;&lt;/div&gt;&lt;div class=&#34;modal-body form&#34;&gt;&lt;div class=&#34;alert alert-error hide&#34;&gt;&lt;button class=&#34;close&#34; data-dismiss=&#34;alert&#34;&gt;&lt;/button&gt;&lt;span&gt; &lt;/span&gt;&lt;/div&gt;&lt;div class=&#34;control-group&#34;&gt;&lt;label class=&#34;control-label&#34;&gt;&lt;/label&gt;&lt;div class=&#34;controls&#34;&gt;&lt;span style=&#34;color:red&#34;&gt;*注：上传文件个数不能超过5个&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;control-group&#34;&gt;&lt;label class=&#34;control-label&#34;&gt;选择文件：&lt;/label&gt;&lt;div class=&#34;controls&#34;&gt;&lt;div class=&#34;fileupload fileupload-new&#34; data-provides=&#34;fileupload&#34;&gt;&lt;div class=&#34;input-append&#34;&gt;&lt;div class=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/dda4f6c27ccfad86e73b3498b1a6ed7e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-08-27T17:53:50+08:00" />
<meta property="article:modified_time" content="2014-08-27T17:53:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用ajaxSubmit方法实现多文件上传(异步)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p>1、上传按钮</p> 
 <p></p> 
 <pre><code class="language-html">&lt;button οnclick="toImport()" class="btn green"&gt;
	导入&lt;i class="icon-upload-alt"&gt;&lt;/i&gt;
&lt;/button&gt;</code></pre> 
 <br> 2、文件选择弹出层和添加组件的html代码 
 <p></p> 
 <p></p> 
 <p><br> </p> 
 <p></p> 
 <pre><code class="language-html">&lt;div id="import_modal" class="modal hide fade"&gt;
			&lt;form
				action="${pageContext.request.contextPath }/**/importFile!impXLS.do"
				id="ajax_form" class="form-horizontal"&gt;
				&lt;div class="modal-header"&gt;
					&lt;button type="button" class="close cancelUpload"
						data-dismiss="modal" aria-hidden="true"&gt;&lt;/button&gt;

					&lt;h3&gt;
						文件导入

					&lt;/h3&gt;
				&lt;/div&gt;

				&lt;div class="modal-body form"&gt;
					&lt;div class="alert alert-error hide"&gt;
						&lt;button class="close" data-dismiss="alert"&gt;&lt;/button&gt;
						&lt;span&gt; &lt;/span&gt;
					&lt;/div&gt;
					&lt;div class="control-group"&gt;
						&lt;label class="control-label"&gt;
							
						&lt;/label&gt;
						&lt;div class="controls"&gt;
							&lt;span style="color:red"&gt;*注：上传文件个数不能超过5个&lt;/span&gt;
						&lt;/div&gt;
					&lt;/div&gt;

					&lt;div class="control-group"&gt;
						&lt;label class="control-label"&gt;
							选择文件：
						&lt;/label&gt;
						&lt;div class="controls"&gt;
							&lt;div class="fileupload fileupload-new" data-provides="fileupload"&gt;
								&lt;div class="input-append"&gt;
									&lt;div class="uneditable-input"&gt;
										&lt;i class="icon-file fileupload-exists"&gt;&lt;/i&gt;
										&lt;span class="fileupload-preview"&gt;&lt;/span&gt;
									&lt;/div&gt;
									&lt;span class="btn btn-file"&gt; &lt;span class="fileupload-new"&gt;浏览...&lt;/span&gt;
										&lt;span class="fileupload-exists"&gt;修改...&lt;/span&gt; &lt;input
											type="file" class="default" name="importFile" /&gt; &lt;input
											type="hidden" name="flag" value="${flag }" /&gt; &lt;/span&gt;
									&lt;button type="button" class="btn green fileupload-append"
										style="text-align: right"&gt;
										新增
									&lt;/button&gt;
								&lt;/div&gt;
							&lt;/div&gt;
						&lt;/div&gt;
					&lt;/div&gt;
				&lt;/div&gt;

				&lt;div class="modal-footer"&gt;
					&lt;button type="button" οnclick="ajaxImp()" class="btn red"&gt;
						确定
					&lt;/button&gt;
					&lt;button type="button" data-dismiss="modal" class="btn cancelUpload"&gt;
						取消
					&lt;/button&gt;
				&lt;/div&gt;
			&lt;/form&gt;
		&lt;/div&gt;
		&lt;!-- 添加 文档上传组件  start--&gt;
		&lt;div class="control-group clone" style="display: none"&gt;
			&lt;label class="control-label"&gt;
				选择文件：
			&lt;/label&gt;
			&lt;div class="controls"&gt;
				&lt;div class="fileupload fileupload-new" data-provides="fileupload"&gt;
					&lt;div class="input-append"&gt;
						&lt;div class="uneditable-input"&gt;
							&lt;i class="icon-file fileupload-exists"&gt;&lt;/i&gt;
							&lt;span class="fileupload-preview"&gt;&lt;/span&gt;
						&lt;/div&gt;
						&lt;span class="btn btn-file"&gt; &lt;span class="fileupload-new"&gt;浏览...&lt;/span&gt;
							&lt;span class="fileupload-exists"&gt;修改...&lt;/span&gt; &lt;input type="file"
								class="default" name="importFile" /&gt; &lt;input type="hidden"
								name="flag" value="${flag }" /&gt; &lt;/span&gt;
						&lt;span onClick="javascript:toRemoveFile(this);" class="btn red"&gt;移除&lt;/span&gt;
					&lt;/div&gt;
				&lt;/div&gt;
			&lt;/div&gt;
		&lt;/div&gt;
		&lt;!-- end --&gt;</code></pre> 
 <br> 3、遮罩层代码 
 <p></p> 
 <p></p> 
 <p></p> 
 <pre><code class="language-html">&lt;div id="loading" class="modal hide fade"&gt;
		&lt;div class="modal-body"&gt;
			&lt;p&gt;
				数据导入中，请等待...
			&lt;img src="${pageContext.request.contextPath }/image/select2-spinner.gif" /&gt;
			&lt;/p&gt;
		&lt;/div&gt;
	&lt;/div&gt;</code></pre> 
 <br> 4、添加/移除文件上传框 限制文件上传个数 
 <p></p> 
 <p></p> 
 <p></p> 
 <pre><code class="language-html"> $(".fileupload-append").click(function(){
		   
	if($(".form .control-group").length&lt;=5){
		var fileuploadModule = $(".clone").clone(true);
		fileuploadModule.show();
		fileuploadModule.removeClass("clone");
		fileuploadModule.addClass("append");
		$(".form").append(fileuploadModule);
	}else{
					$error.hide();
				 	$("span",$error).html("可上传文件的个数不能超过5个...");
	                $error.show();
	}
});
//移除文件上传框和文件	   
$(".cancelUpload").click(function (){
	 $(".append").remove();
});</code></pre> 
 <br> 5、异步导入文件function ajaxImp(){ 
 <br> 
 <p></p> 
 <p></p> 
</blockquote> 
<blockquote> 
 <p></p> 
 <pre><code class="language-html"> function ajaxImp(){
	$("#ajax_form").ajaxSubmit({
		//clearForm:true,
		resetForm:true,
		dataType:'json',
		type:'post',
		beforeSubmit:function(formData,jqForm,options){
			var $error = $('.alert-error', jqForm);
			var flag = true;
			//遍历form中的导入框，判空并验证文件的格式
			$(".fileupload-preview",jqForm).each(function (){
				var fileName = $(this).text();
				$error.hide();
				if(App.isEmpty(fileName)){
					 $("span",$error).html("请选择XLS格式文件进行导入...");
		                	//$error.show();
		                	flag  = false;
		                	return false;
				}else if(fileName.lastIndexOf("\.")==-1||fileName.substring(fileName.lastIndexOf("\.")+1).toLowerCase()!='xls'){
					 $("span",$error).html("导入的文件后缀，必须为XLS...");
					 //$error.show();
					 flag  = false;
		                	return false;
				}
			});
			if(flag==false){
				$error.show();//显示错误信息
				return false;
			}
			$("#import_modal").modal('hide');//导入文件隐藏
				 	
				//导入加载框显示
				 $("#loading").modal({
					backdrop:"static",
					keyboard:false,
					show:true
				});

				return true;
			},
			success:function(data,statusText){
				if(statusText='success'){
					$("#loading").modal('hide');
					notification(data.headerMessage,data.message);
					&lt;span style="color:#FF0000;"&gt;oTable.fnDraw();    //列表信息使用Datatables来显示&lt;/span&gt;
					$(".append").remove();
				}
			}				
		});
			 
	}
//提醒对话框
	function notification(title,message){
		$.gritter.add({
			title:	title,
			text:	message,
			time:	2000,
			sticky: false
		});		
	}</code></pre> 
 <p></p> 
 <p></p> 
</blockquote> 
<blockquote> 
 <p>6、Java代码：ImportFileAction(注意要添加相应的get和set方法)<br>     </p> 
 <pre><code class="language-java">public class ImportFileAction extends BaseAction{
    private File[] importFile;
    private String[] importFileFileName;
    public void impXLS(){
    
        if (!StringUtil.isEmpty(importFile) &amp;&amp; importFile.length &gt; 0) {
                for (int i = 0; i &lt; importFile.length; i++) {
                    File impFile = importFile[i];
                    //……文件内容读取(略)
                }
        }
    }
}
</code></pre>7、效果图 
 <p></p> 
 <p></p> 
 <p><img alt="" src=""></p> 
 <p><br> </p> 
 <p>8、用到的js、css、gif及部分代码可点击这里<a target="_blank" href="http://download.csdn.net/detail/zdx1515888659/7657895" rel="noopener noreferrer">http://download.csdn.net/detail/zdx1515888659/7657895</a>下载<br> </p> 
 <p><br> </p> 
 <p><br> </p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7caf9ed480b9c04743c09b2534991079/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">混合推荐总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/345c415da8c0d2b5c045f8bf7c2ca52b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySql通过数据库文件恢复数据库</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>