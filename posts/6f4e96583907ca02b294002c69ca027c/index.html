<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Coursera课程-r语言-程序作业1 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Coursera课程-r语言-程序作业1" />
<meta property="og:description" content="题目介绍： r语言课程的第一个程序作业。将要编写3个函数。实验数据为“美国大气污染”的数据，可以从Coursera上下载，下载后的文件为zip文件。需要自行解压缩并添加到你的作业项目中。
数据介绍： zip文件可以从这里下载: specdata.zip [2.4MB] 这个zip文件中包含了332个csv文件。csv文件中记录着检测大气质量的数据，记录着美国332个地区的“细微颗粒值（PM值）”。每个csv文件中代表着一个监测地区的记录。例如：地区200的大气数据，记录在文件“200.csv”中。每个文件包含三个变量： -Date：date的数据以“YYYY-MM-DD”的方式存储 -sulfate：空气中硫化物颗粒水平 -nitrate：空气中硝化物颗粒水平 本作业中，你需要解压缩这个zip文件，并保存在目录名为“specdata”的文件夹下。你可以打开csv文件观察数据，你会发现里面包含着很多空值，这在空气质量监控的数据集中非常常见。
Part1 第一部分功能介绍： 编写一个函数“pollutantmean”能够计算指定文件列表中所有大气数据的污染物(sulfate或者nitrate)的均值。这个函数有三个属性，分别是’directory’、’pollutant’和’id’。’directory’代表文件目录，’pollutant’代表污染物的名称，’id’代表文件序列，是一个数值向量。注意，在数据处理中，你需要去掉空值。
第一部分程序实现： pollutantmean &lt;- function(directory, pollutant, id = 1:332) { filenames&lt;-dir(directory, full.names=T) n&lt;-length(id) m&lt;-rep(0,n) ct&lt;-rep(0,n) for(i in id){ data&lt;-read.csv(filenames[i],header=TRUE) ct[match(i,id)]&lt;-sum(!is.na(data[pollutant])) m[match(i,id)]&lt;-mean(as.matrix(data[pollutant]),na.rm=TRUE) } result&lt;-(m[ct&gt;0] %*% ct[ct&gt;0])[1,1]/sum(ct[ct&gt;0]) result } 第一部分程序运行结果： &gt; source(&#34;pollutantmean.R&#34;) &gt; pollutantmean(&#34;specdata&#34;, &#34;sulfate&#34;, 1:10) [1] 4.064128 &gt; pollutantmean(&#34;specdata&#34;, &#34;nitrate&#34;, 70:72) [1] 1.706047 &gt; pollutantmean(&#34;specdata&#34;, &#34;nitrate&#34;, 23) [1] 1.280833 Part2 第二部分功能介绍： 编写一个函数“complete”读取文件目录下的所有文件，计算每个csv文件中完整的记录数（每条记录都不包含空值）。函数需要返回一个dataframe，第一列为文件id，第二列为记录数nobs。
第二部分程序实现： complete &lt;- function(directory, id = 1:332) { files_list &lt;- dir(directory, full." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/6f4e96583907ca02b294002c69ca027c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-04-18T15:19:03+08:00" />
<meta property="article:modified_time" content="2015-04-18T15:19:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Coursera课程-r语言-程序作业1</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4 id="题目介绍">题目介绍：</h4> 
<p>r语言课程的第一个程序作业。将要编写3个函数。实验数据为“美国大气污染”的数据，可以从Coursera上下载，下载后的文件为zip文件。需要自行解压缩并添加到你的作业项目中。</p> 
<h4 id="数据介绍">数据介绍：</h4> 
<p>zip文件可以从这里下载: <br> <a href="https://d396qusza40orc.cloudfront.net/rprog%2Fdata%2Fspecdata.zip" rel="nofollow">specdata.zip [2.4MB]</a> <br> 这个zip文件中包含了332个csv文件。csv文件中记录着检测大气质量的数据，记录着美国332个地区的“细微颗粒值（PM值）”。每个csv文件中代表着一个监测地区的记录。例如：地区200的大气数据，记录在文件“200.csv”中。每个文件包含三个变量： <br> -Date：date的数据以“YYYY-MM-DD”的方式存储 <br> -sulfate：空气中硫化物颗粒水平 <br> -nitrate：空气中硝化物颗粒水平 <br> 本作业中，你需要解压缩这个zip文件，并保存在目录名为“specdata”的文件夹下。你可以打开csv文件观察数据，你会发现里面包含着很多空值，这在空气质量监控的数据集中非常常见。</p> 
<h4 id="part1">Part1</h4> 
<h5 id="第一部分功能介绍">第一部分功能介绍：</h5> 
<p>编写一个函数“pollutantmean”能够计算指定文件列表中所有大气数据的污染物(sulfate或者nitrate)的均值。这个函数有三个属性，分别是’directory’、’pollutant’和’id’。’directory’代表文件目录，’pollutant’代表污染物的名称，’id’代表文件序列，是一个数值向量。注意，在数据处理中，你需要去掉空值。</p> 
<h5 id="第一部分程序实现">第一部分程序实现：</h5> 
<pre class="prettyprint"><code class="language-R hljs haskell"><span class="hljs-title">pollutantmean</span> &lt;- function(directory, pollutant, id = <span class="hljs-number">1</span>:<span class="hljs-number">332</span>) {
  filenames&lt;-dir(directory, full.names=<span class="hljs-type">T</span>)
  n&lt;-length(id)
  m&lt;-rep(<span class="hljs-number">0</span>,n)
  ct&lt;-rep(<span class="hljs-number">0</span>,n)
  for(i <span class="hljs-keyword">in</span> id){
    <span class="hljs-typedef"><span class="hljs-keyword">data</span>&lt;-read.csv<span class="hljs-container">(<span class="hljs-title">filenames</span>[<span class="hljs-title">i</span>],<span class="hljs-title">header</span>=<span class="hljs-type">TRUE</span>)</span></span>
    ct[match(i,id)]&lt;-sum(!is.na(<span class="hljs-typedef"><span class="hljs-keyword">data</span>[pollutant]))</span>
    m[match(i,id)]&lt;-mean(<span class="hljs-keyword">as</span>.matrix(<span class="hljs-typedef"><span class="hljs-keyword">data</span>[pollutant]),na.rm=<span class="hljs-type">TRUE</span>)</span>
  }
  result&lt;-(m[ct&gt;<span class="hljs-number">0</span>] %*% ct[ct&gt;<span class="hljs-number">0</span>])[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]/sum(ct[ct&gt;<span class="hljs-number">0</span>])
  result
  }</code></pre> 
<h5 id="第一部分程序运行结果">第一部分程序运行结果：</h5> 
<pre class="prettyprint"><code class="language-r hljs ">&gt; <span class="hljs-keyword">source</span>(<span class="hljs-string">"pollutantmean.R"</span>)
&gt; pollutantmean(<span class="hljs-string">"specdata"</span>, <span class="hljs-string">"sulfate"</span>, <span class="hljs-number">1</span>:<span class="hljs-number">10</span>)
[<span class="hljs-number">1</span>] <span class="hljs-number">4.064128</span>
&gt; pollutantmean(<span class="hljs-string">"specdata"</span>, <span class="hljs-string">"nitrate"</span>, <span class="hljs-number">70</span>:<span class="hljs-number">72</span>)
[<span class="hljs-number">1</span>] <span class="hljs-number">1.706047</span>
&gt; pollutantmean(<span class="hljs-string">"specdata"</span>, <span class="hljs-string">"nitrate"</span>, <span class="hljs-number">23</span>)
[<span class="hljs-number">1</span>] <span class="hljs-number">1.280833</span></code></pre> 
<h4 id="part2">Part2</h4> 
<h5 id="第二部分功能介绍">第二部分功能介绍：</h5> 
<p>编写一个函数“complete”读取文件目录下的所有文件，计算每个csv文件中完整的记录数（每条记录都不包含空值）。函数需要返回一个dataframe，第一列为文件id，第二列为记录数nobs。</p> 
<h5 id="第二部分程序实现">第二部分程序实现：</h5> 
<pre class="prettyprint"><code class="language-r hljs ">complete &lt;- <span class="hljs-keyword">function</span>(directory, id = <span class="hljs-number">1</span>:<span class="hljs-number">332</span>) {
  files_list &lt;- dir(directory, full.names=<span class="hljs-literal">T</span>)[id]
  data_list&lt;-lapply(files_list,read.csv)
  nobs&lt;-sapply(lapply(data_list,complete.cases),sum)
  result&lt;-as.data.frame(cbind(id,nobs))
  result
}</code></pre> 
<h5 id="第二部分程序运行结果">第二部分程序运行结果：</h5> 
<pre class="prettyprint"><code class="language-r hljs ">&gt; <span class="hljs-keyword">source</span>(<span class="hljs-string">"complete.R"</span>)
&gt; complete(<span class="hljs-string">"specdata"</span>, <span class="hljs-number">1</span>)
  id nobs
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">117</span>
&gt; complete(<span class="hljs-string">"specdata"</span>, c(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>, <span class="hljs-number">12</span>))
  id nobs
<span class="hljs-number">1</span>  <span class="hljs-number">2</span> <span class="hljs-number">1041</span>
<span class="hljs-number">2</span>  <span class="hljs-number">4</span>  <span class="hljs-number">474</span>
<span class="hljs-number">3</span>  <span class="hljs-number">8</span>  <span class="hljs-number">192</span>
<span class="hljs-number">4</span> <span class="hljs-number">10</span>  <span class="hljs-number">148</span>
<span class="hljs-number">5</span> <span class="hljs-number">12</span>   <span class="hljs-number">96</span>
&gt; complete(<span class="hljs-string">"specdata"</span>, <span class="hljs-number">30</span>:<span class="hljs-number">25</span>)
  id nobs
<span class="hljs-number">1</span> <span class="hljs-number">30</span>  <span class="hljs-number">932</span>
<span class="hljs-number">2</span> <span class="hljs-number">29</span>  <span class="hljs-number">711</span>
<span class="hljs-number">3</span> <span class="hljs-number">28</span>  <span class="hljs-number">475</span>
<span class="hljs-number">4</span> <span class="hljs-number">27</span>  <span class="hljs-number">338</span>
<span class="hljs-number">5</span> <span class="hljs-number">26</span>  <span class="hljs-number">586</span>
<span class="hljs-number">6</span> <span class="hljs-number">25</span>  <span class="hljs-number">463</span>
&gt; complete(<span class="hljs-string">"specdata"</span>, <span class="hljs-number">3</span>)
  id nobs
<span class="hljs-number">1</span>  <span class="hljs-number">3</span>  <span class="hljs-number">243</span></code></pre> 
<h4 id="part3">Part3</h4> 
<h5 id="第三部分功能介绍">第三部分功能介绍：</h5> 
<p>编写一个函数“corr”，读取指定文件目录下的文件，当csv文件中完整的记录数超过预设的阀值时，计算该文件中sulfate和nitrate的相关系数。这个函数最后需要返回一个相关系数向量。</p> 
<h5 id="第三部分程序实现">第三部分程序实现：</h5> 
<pre class="prettyprint"><code class="language-r hljs ">corr &lt;- <span class="hljs-keyword">function</span>(directory, threshold = <span class="hljs-number">0</span>) {
  <span class="hljs-keyword">source</span>(<span class="hljs-string">"complete.R"</span>)
  IN&lt;-complete(directory,id = <span class="hljs-number">1</span>:<span class="hljs-number">332</span>)
  id&lt;-as.vector(IN[IN$nobs&gt;threshold,<span class="hljs-string">"id"</span>])
  result&lt;-c()
  <span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> id){
    files_list &lt;- dir(directory, full.names=<span class="hljs-literal">T</span>)[i]
    data&lt;-read.csv(files_list,header=<span class="hljs-literal">TRUE</span>)
    dataNoNA&lt;-na.omit(data)
    corrresult&lt;-cor(dataNoNA$sulfate,dataNoNA$nitrate)
    result&lt;-c(result,corrresult)
  }
  result
}</code></pre> 
<h5 id="第三部分程序运行结果">第三部分程序运行结果：</h5> 
<pre class="prettyprint"><code class="language-r hljs ">&gt; <span class="hljs-keyword">source</span>(<span class="hljs-string">"corr.R"</span>)
&gt; <span class="hljs-keyword">source</span>(<span class="hljs-string">"complete.R"</span>)
&gt; cr &lt;- corr(<span class="hljs-string">"specdata"</span>, <span class="hljs-number">150</span>)
&gt; head(cr)
[<span class="hljs-number">1</span>] -<span class="hljs-number">0.01895754</span> -<span class="hljs-number">0.14051254</span> -<span class="hljs-number">0.04389737</span> -<span class="hljs-number">0.06815956</span> -<span class="hljs-number">0.12350667</span>
[<span class="hljs-number">6</span>] -<span class="hljs-number">0.07588814</span>
&gt; summary(cr)
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-<span class="hljs-number">0.21060</span> -<span class="hljs-number">0.04999</span>  <span class="hljs-number">0.09463</span>  <span class="hljs-number">0.12530</span>  <span class="hljs-number">0.26840</span>  <span class="hljs-number">0.76310</span> 
&gt; cr &lt;- corr(<span class="hljs-string">"specdata"</span>, <span class="hljs-number">400</span>)
&gt; head(cr)
[<span class="hljs-number">1</span>] -<span class="hljs-number">0.01895754</span> -<span class="hljs-number">0.04389737</span> -<span class="hljs-number">0.06815956</span> -<span class="hljs-number">0.07588814</span>  <span class="hljs-number">0.76312884</span>
[<span class="hljs-number">6</span>] -<span class="hljs-number">0.15782860</span>
&gt; summary(cr)
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-<span class="hljs-number">0.17620</span> -<span class="hljs-number">0.03109</span>  <span class="hljs-number">0.10020</span>  <span class="hljs-number">0.13970</span>  <span class="hljs-number">0.26850</span>  <span class="hljs-number">0.76310</span> 
&gt; cr &lt;- corr(<span class="hljs-string">"specdata"</span>, <span class="hljs-number">5000</span>)
&gt; summary(cr)
Length  Class   Mode 
     <span class="hljs-number">0</span>   <span class="hljs-literal">NULL</span>   <span class="hljs-literal">NULL</span> 
&gt; length(cr)
[<span class="hljs-number">1</span>] <span class="hljs-number">0</span>
&gt; cr &lt;- corr(<span class="hljs-string">"specdata"</span>)
&gt; summary(cr)
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-<span class="hljs-number">1.00000</span> -<span class="hljs-number">0.05282</span>  <span class="hljs-number">0.10720</span>  <span class="hljs-number">0.13680</span>  <span class="hljs-number">0.27830</span>  <span class="hljs-number">1.00000</span> 
&gt; length(cr)
[<span class="hljs-number">1</span>] <span class="hljs-number">323</span></code></pre> 
<p>完成这个作业还是花了蛮多时间的，但是最终完成还是很有成就感的。fighting！！！</p> 
<p>转载请注明作者“<strong>MieAn100</strong>”及其出处 <br> CSDN博客(<a href="http://blog.csdn.net/MieAn100">http://blog.csdn.net/MieAn100</a>) </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dc4a57106b0027eb95369125d55fb170/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何在 Eclipse 中显示代码的行号</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5ced23e0dd93b9d1ea3820cd4e6aa27a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">树莓派 - 修改pi账号密码,开启root账号</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>