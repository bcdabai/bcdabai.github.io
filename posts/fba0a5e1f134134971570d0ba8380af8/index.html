<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>System.InvalidOperationException:“未在本地计算机上注册“Microsoft.ACE.OLEDB.12.0”提供程序 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="System.InvalidOperationException:“未在本地计算机上注册“Microsoft.ACE.OLEDB.12.0”提供程序" />
<meta property="og:description" content="【写在前面】
今天在做c#和ACCESS的连接测试时出现了如下图的BUG:
（本人VS为2017，access为2016 64位专业版）
CODES:
报错提示
error location
【原因分析】
这个错误的根本原因就是应用程序（32 位代码）和与 64 位 Microsoft Access 一同安装的 64 位 ACE 提供程序之间的版本不匹配，造成了错误“’Microsoft.ACE.OLEDB.12.0’ 提供程序未在本地计算机上注册”。
**知识点延伸：** 共同点：所有都是连接到Excel对象的接口引擎不同点：
1）对于不同版本的zhiExcel，有两个接口可供选择：daoMicrosoft.Jet.OLEDB.4.0（以下简称Jet引擎）和microsoft.ace.oledb.12.0（以下简称ACE引擎）。Jet引擎可以访问office 97-2003，但是你无法
访问office 2007。ACE引擎是与Office 20,071一起发布的数据库连接组件，您可以访问Office 2007或Office 97-2003。
2）microsoft.ace.oledb.12.0可以访问正在打开的Excel文件，而microsoft.jet.oledb.4.0是不可能的。因此，在使用不同版本的Office时，请注意使用正确的引擎。 扩展资料：
从2007版本开始，Access包含特定于Office的Jet版本，最初称为Office Access连接引擎（ACE），但现在称为Access数据库引擎。此引擎完全向后兼容以前版本的Jet引擎，因此它从早期的Access版本读取和写入（.mdb）文件。它引入了一种新的默认文件格式（.accdb），它为Access带来了一些改进，包括复杂数据类型，如多值字段，附件数据类型和备注字段中的历史记录跟踪。它还带来了安全性和加密性改进，并支持与Microsoft Windows SharePoint Services 3.0和Microsoft Office Outlook 2007的集成。
**【解决方案】** 1.下载office驱动程序，安装数据连接组件（官网下载链接）
https://www.microsoft.com/en-us/download/details.aspx?id=54920
（本人下载的连接：）
2.将 ConnectionString 属性的 Provider 参数设置为“Microsoft.ACE.OLEDB.16.0”如果要连接到 Microsoft Office access 数据，如果有问题的可以参考我下面的代码修改一下。
3.在运行框用inetmgr命令打开IIS管理器，选择该应用程序的应用程序池——&gt;高级设置——&gt;启动32位应用程序——&gt;true
【ps】有些童鞋的IIS可能没打开，在管理工具中找不到，不要紧，下面介绍一下IIS的打开方式
https://jingyan.baidu.com/article/ac6a9a5e36977d2b653eacb2.html
原文链接：https://blog.csdn.net/YYZZHC999/article/details/79367114" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/fba0a5e1f134134971570d0ba8380af8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-07-23T23:27:52+08:00" />
<meta property="article:modified_time" content="2020-07-23T23:27:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">System.InvalidOperationException:“未在本地计算机上注册“Microsoft.ACE.OLEDB.12.0”提供程序</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>【写在前面】</strong><br> 今天在做c#和ACCESS的连接测试时出现了如下图的BUG:<br> （本人VS为2017，access为2016 64位专业版）<br> CODES:<br> <img src="https://images2.imgbox.com/2e/3a/sB0qYDwJ_o.png" alt="在这里插入图片描述"></p> 
<ol><li> <p>报错提示<br> <img src="https://images2.imgbox.com/18/0e/za5t6W1h_o.png" alt="在这里插入图片描述"></p> </li><li> <p>error location<br> <img src="https://images2.imgbox.com/6e/d1/xNYBHXu0_o.png" alt="在这里插入图片描述"><br> <strong>【原因分析】</strong><br> 这个错误的根本原因就是<strong>应用程序（32 位代码）和与 64 位 Microsoft Access 一同安装的 64 位 ACE 提供程序之间的版本不匹配</strong>，造成了错误“’Microsoft.ACE.OLEDB.12.0’ 提供程序未在本地计算机上注册”。</p> <pre><code>**知识点延伸：**
</code></pre> 
  <ul><li>共同点：所有都是连接到Excel对象的接口引擎</li><li>不同点：<br> 1）对于不同版本的zhiExcel，有两个接口可供选择：daoMicrosoft.Jet.OLEDB.4.0（以下简称Jet引擎）和microsoft.ace.oledb.12.0（以下简称ACE引擎）。Jet引擎可以访问office 97-2003，但是你无法<br> 访问office 2007。ACE引擎是与Office 20,071一起发布的数据库连接组件，您可以访问Office 2007或Office 97-2003。<br> 2）microsoft.ace.oledb.12.0可以访问正在打开的Excel文件，而microsoft.jet.oledb.4.0是不可能的。因此，在使用不同版本的Office时，请注意使用正确的引擎。</li></ul> </li></ol> 
<p><strong>扩展资料：</strong></p> 
<p>从2007版本开始，Access包含特定于Office的Jet版本，最初称为Office Access连接引擎（ACE），但现在称为Access数据库引擎。此引擎完全向后兼容以前版本的Jet引擎，因此它从早期的Access版本读取和写入（.mdb）文件。它引入了一种新的默认文件格式（.accdb），它为Access带来了一些改进，包括复杂数据类型，如多值字段，附件数据类型和备注字段中的历史记录跟踪。它还带来了安全性和加密性改进，并支持与Microsoft Windows SharePoint Services 3.0和Microsoft Office Outlook 2007的集成。</p> 
<p><img src="https://images2.imgbox.com/5e/b7/G99SCAwI_o.png" alt="在这里插入图片描述"></p> 
<pre><code> **【解决方案】**
</code></pre> 
<p>1.下载office驱动程序，安装数据连接组件（<a href="http://download.microsoft.com/download/7/0/3/703ffbcb-dc0c-4e19-b0da-1463960fdcdb/AccessDatabaseEngine.exe" rel="nofollow">官网下载链接</a>）<br> <a href="https://www.microsoft.com/en-us/download/details.aspx?id=54920" rel="nofollow">https://www.microsoft.com/en-us/download/details.aspx?id=54920</a><br> （本人下载的连接：）<br> 2.将 ConnectionString 属性的 Provider 参数设置为“<strong>Microsoft.ACE.OLEDB.16.0</strong>”如果要连接到 Microsoft Office access 数据，如果有问题的可以参考我下面的代码修改一下。<br> <img src="https://images2.imgbox.com/dd/32/8fpjjAt6_o.png" alt="在这里插入图片描述"></p> 
<p>3.在运行框用inetmgr命令打开IIS管理器，选择该应用程序的应用程序池——&gt;高级设置——&gt;启动32位应用程序——&gt;true<br> <img src="https://images2.imgbox.com/c8/fe/RPTzhaNh_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/02/d6/HDYt2FWO_o.png" alt="在这里插入图片描述"></p> 
<p>【ps】有些童鞋的IIS可能没打开，在管理工具中找不到，不要紧，下面介绍一下IIS的打开方式<br> <a href="https://jingyan.baidu.com/article/ac6a9a5e36977d2b653eacb2.html" rel="nofollow">https://jingyan.baidu.com/article/ac6a9a5e36977d2b653eacb2.html</a></p> 
<p>原文链接：<a href="https://blog.csdn.net/YYZZHC999/article/details/79367114">https://blog.csdn.net/YYZZHC999/article/details/79367114</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/07b0fe6cb889a9e5d1c6358252c3e1bf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【微信读书每日一答辅助小程序】使用python对每日一答问题进行识别，并将结果保存到剪贴板以便搜索。</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c32a452c8216ae2b089d58bb69bbbfb6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">springboot项目中使用mvc:annotation-driven问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>