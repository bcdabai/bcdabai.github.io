<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Apache HTTP Server (httpd)服务离线安装 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Apache HTTP Server (httpd)服务离线安装" />
<meta property="og:description" content="Apache(httpd)服务离线安装文档
目录 一、说明依赖包及下载地址依赖包描述 二、安装准备软件包上传软件包解压处理依赖关系 三、开始安装四、配置五、启动六、验证七、附 一、说明 本文依据Apache官方使用文档编写，地址：https://httpd.apache.org/docs/2.4
依赖包及下载地址 本文使用到的离线包：
apr-1.7.0.tar.gz
apr-util-1.6.1.tar.gz
pcre2-10.40.tar.gz
expat-2.1.0-14.el7_9.x86_64.rpm
expat-devel-2.1.0-14.el7_9.x86_64.rpm
httpd-2.4.54.tar.gz
官方下载地址：
apr-1.7.0.tar.gz
https://dlcdn.apache.org//apr/apr-1.7.0.tar.gz
apr-util-1.6.1.tar.gz
https://dlcdn.apache.org//apr/apr-util-1.6.1.tar.gz
pcre2-10.40.tar.gz
https://github.com/PCRE2Project/pcre2/releases/download/pcre2-10.40/pcre2-10.40.tar.gz
expat-2.1.0-14.el7_9.x86_64.rpm
http://mirror.centos.org/centos/7/updates/x86_64/Packages/expat-2.1.0-14.el7_9.x86_64.rpm
expat-devel-2.1.0-14.el7_9.x86_64.rpm
http://mirror.centos.org/centos/7/updates/x86_64/Packages/expat-devel-2.1.0-14.el7_9.x86_64.rpm
httpd-2.4.54.tar.gz
https://dlcdn.apache.org/httpd/httpd-2.4.54.tar.gz
注：以上链接会由于版本更新导致失效，建议走官网入口：
https://httpd.apache.org/
依赖包描述 相关依赖包使用关键描述（此处引用官方文档原文）：
APR and APR-Util:
Make sure you have APR and APR-Util already
installed on your system. If you don’t, or prefer to not use the
system-provided versions, download the latest versions of both APR and
APR-Util from Apache APR, unpack them into" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/71e9a1e4c2b4dba99f63a917b0066d3a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-08T14:08:25+08:00" />
<meta property="article:modified_time" content="2022-08-08T14:08:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Apache HTTP Server (httpd)服务离线安装</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>Apache(httpd)服务离线安装文档</p> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><a href="#_5" rel="nofollow">一、说明</a></li><li><ul><li><a href="#_8" rel="nofollow">依赖包及下载地址</a></li><li><a href="#_36" rel="nofollow">依赖包描述</a></li></ul> 
   </li><li><a href="#_77" rel="nofollow">二、安装准备</a></li><li><ul><li><a href="#_79" rel="nofollow">软件包上传</a></li><li><a href="#_82" rel="nofollow">软件包解压</a></li><li><a href="#_111" rel="nofollow">处理依赖关系</a></li></ul> 
   </li><li><a href="#_144" rel="nofollow">三、开始安装</a></li><li><a href="#_177" rel="nofollow">四、配置</a></li><li><a href="#_226" rel="nofollow">五、启动</a></li><li><a href="#_247" rel="nofollow">六、验证</a></li><li><a href="#_261" rel="nofollow">七、附</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_5"></a>一、说明</h3> 
<p>本文依据Apache官方使用文档编写，地址：https://httpd.apache.org/docs/2.4</p> 
<h4><a id="_8"></a>依赖包及下载地址</h4> 
<p>本文使用到的离线包：<br> apr-1.7.0.tar.gz<br> apr-util-1.6.1.tar.gz<br> pcre2-10.40.tar.gz<br> expat-2.1.0-14.el7_9.x86_64.rpm<br> expat-devel-2.1.0-14.el7_9.x86_64.rpm<br> httpd-2.4.54.tar.gz</p> 
<p>官方下载地址：</p> 
<p><strong>apr-1.7.0.tar.gz</strong><br> https://dlcdn.apache.org//apr/apr-1.7.0.tar.gz<br> <strong>apr-util-1.6.1.tar.gz</strong><br> https://dlcdn.apache.org//apr/apr-util-1.6.1.tar.gz<br> <strong>pcre2-10.40.tar.gz</strong><br> https://github.com/PCRE2Project/pcre2/releases/download/pcre2-10.40/pcre2-10.40.tar.gz<br> <strong>expat-2.1.0-14.el7_9.x86_64.rpm</strong><br> http://mirror.centos.org/centos/7/updates/x86_64/Packages/expat-2.1.0-14.el7_9.x86_64.rpm<br> <strong>expat-devel-2.1.0-14.el7_9.x86_64.rpm</strong><br> http://mirror.centos.org/centos/7/updates/x86_64/Packages/expat-devel-2.1.0-14.el7_9.x86_64.rpm<br> <strong>httpd-2.4.54.tar.gz</strong><br> https://dlcdn.apache.org/httpd/httpd-2.4.54.tar.gz</p> 
<p><strong>注：以上链接会由于版本更新导致失效，建议走官网入口：<br> https://httpd.apache.org/</strong></p> 
<h4><a id="_36"></a>依赖包描述</h4> 
<p>相关依赖包使用关键描述（此处引用官方文档原文）：</p> 
<p>APR and APR-Util:</p> 
<blockquote> 
 <p>Make sure you have APR and APR-Util already<br> installed on your system. If you don’t, or prefer to not use the<br> system-provided versions, download the latest versions of both APR and<br> APR-Util from Apache APR, unpack them into<br> /httpd_source_tree_root/srclib/apr and<br> /httpd_source_tree_root/srclib/apr-util (be sure the directory names<br> do not have version numbers; for example, the APR distribution must be<br> under /httpd_source_tree_root/srclib/apr/) and use ./configure’s<br> –with-included-apr option. On some platforms, you may have to install the corresponding -dev packages to allow httpd to build against your<br> installed copy of APR and APR-Util</p> 
</blockquote> 
<p>Perl-Compatible Regular Expressions Library (PCRE):</p> 
<blockquote> 
 <p>This library is<br> required but not longer bundled with httpd. Download the source code<br> from http://www.pcre.org, or install a Port or Package. If your build<br> system can’t find the pcre-config script installed by the PCRE build,<br> point to it using the --with-pcre parameter. On some platforms, you<br> may have to install the corresponding -dev package to allow httpd to<br> build against your installed copy of PCRE…</p> 
</blockquote> 
<p>Expat:</p> 
<blockquote> 
 <p>This is expat, the C library for parsing XML, written by James Clark.<br> Expat is a stream oriented XML parser. This means that you register<br> handlers with the parser prior to starting the parse. These handlers<br> are called when the parser discovers the associated structures in the<br> document being parsed. A start tag is an example of the kind of<br> structures for which you may register handlers.</p> 
</blockquote> 
<p>Expat-devel:</p> 
<blockquote> 
 <p>The expat-devel package contains the libraries, include files and<br> documentation to develop XML applications with expat.</p> 
</blockquote> 
<h3><a id="_77"></a>二、安装准备</h3> 
<h4><a id="_79"></a>软件包上传</h4> 
<p>将六个软件包上传到要运行httpd的目录：{httpd_root_path}，本文后续将采用此标识表示httpd服务的根目录。本文推荐上传至/usr/local,即：{httpd_root_path}变量替换为/usr/local</p> 
<h4><a id="_82"></a>软件包解压</h4> 
<p>进入到目录{httpd_root_path}下：</p> 
<p>将httpd-2.4.54.tar.gz解压：</p> 
<pre><code class="prism language-sh">tar -zxvf httpd-2.4.54.tar.gz
</code></pre> 
<p>将apr-1.7.0.tar.gz解压：</p> 
<pre><code class="prism language-sh">tar -zxvf apr-1.7.0.tar.gz
</code></pre> 
<p>将apr-util-1.6.1.tar.gz解压：</p> 
<pre><code class="prism language-sh">tar -zxvf apr-util-1.6.1.tar.gz
</code></pre> 
<p>将pcre2-10.40.tar.gz解压：</p> 
<pre><code class="prism language-sh">tar -zxvf pcre2-10.40.tar.gz
</code></pre> 
<p>解压完成后{httpd_root_path}中含有以下文件夹：<br> httpd-2.4.54<br> apr-1.7.0<br> apr-util-1.6.1<br> pcre2-10.40</p> 
<h4><a id="_111"></a>处理依赖关系</h4> 
<p>将apr与apr-util的解压文件复制到目录{httpd_root_path}/httpd-2.4.54/srclib目录下。<br> 在{httpd_root_path}下执行：</p> 
<pre><code class="prism language-sh">mv apr-1.7.0 httpd-2.4.54/srclib/apr
mv apr-util-1.6.1 httpd-2.4.54/srclib/apr-util
</code></pre> 
<p>编译pcre：</p> 
<p>进入目录：{httpd_root_path}/pcre2-10.40</p> 
<pre><code class="prism language-sh">cd {httpd_root_path}/pcre2-10.40
</code></pre> 
<p>配置pcre编译选项：</p> 
<pre><code class="prism language-sh">./configure --prefix={httpd_root_path}/pcre
</code></pre> 
<p>编译pcre：</p> 
<pre><code class="prism language-sh">make &amp;&amp; make install
</code></pre> 
<p>安装expat：<br> 进入目录：{httpd_root_path}执行：</p> 
<pre><code class="prism language-sh">rpm -Uvh expat-2.1.0-14.el7_9.x86_64.rpm
rpm -Uvh expat-devel-2.1.0-14.el7_9.x86_64.rpm
</code></pre> 
<h3><a id="_144"></a>三、开始安装</h3> 
<p>3.1 进入目录：{httpd_root_path}/httpd-2.4.54</p> 
<pre><code class="prism language-sh">cd {httpd_root_path}/httpd-2.4.54
</code></pre> 
<p>3.2 执行编译配置：</p> 
<pre><code class="prism language-sh">./configure --prefix=/usr/local/httpd --with-port=9001 --enable-charset-lite --with-included-apr --with-pcre=/usr/local/pcre/bin/pcre2-config
</code></pre> 
<p>3.3 开始编译：</p> 
<pre><code class="prism language-sh">make &amp;&amp; make install
</code></pre> 
<p>编译完成后示例图：<br> <img src="https://images2.imgbox.com/8f/1f/CDFcRsRS_o.png" alt="编译完成后示例图"></p> 
<p>3.4 注意：若结束后提示错误中含expat相关异常，请按以下步骤进行操作：</p> 
<p>3.4.1 进入到{httpd_root_path}目录下，包含expat-2.1.0-14.el7_9.x86_64.rpm以及expat-devel-2.1.0-14.el7_9.x86_64.rpm两个软件包。</p> 
<p>3.4.2 执行：</p> 
<pre><code class="prism language-sh">rpm -Uvh expat-2.1.0-14.el7_9.x86_64.rpm
rpm -Uvh expat-devel-2.1.0-14.el7_9.x86_64.rpm
</code></pre> 
<p>4.4.3 再次执行4.1、4.2、4.3步骤进行编译安装。</p> 
<h3><a id="_177"></a>四、配置</h3> 
<p>配置文件为：{httpd_root_path}/httpd/conf目录下的httpd.conf</p> 
<p>由于资源文件不能使用root用户，因此需要自行分配一个用户及用户组：</p> 
<pre><code class="prism language-sh">useradd {用户名} -g {用户组名}
</code></pre> 
<p>编辑配置文件httpd.conf：<br> 4.1 修改服务端口号，并在防火墙开启该端口</p> 
<p><img src="https://images2.imgbox.com/13/c4/lQvZepbY_o.png" alt="修改服务端口号，并在防火墙开启该端口"></p> 
<p>4.2 修改上一步骤增加的用户及用户名</p> 
<p><img src="https://images2.imgbox.com/33/79/BYzV2Bo2_o.png" alt="修改用户及用户名"></p> 
<p>4.3 修改图片文件存放的根目录：</p> 
<p><img src="https://images2.imgbox.com/07/ed/IJK79lXp_o.png" alt="修改图片文件存放的根目录"></p> 
<p>4.4 保存修改</p> 
<p>4.5 验证配置：<br> 进入到目录{httpd_root_path}/httpd/bin下，执行：</p> 
<pre><code class="prism language-sh">./apachectl -k start
</code></pre> 
<p>展示为：</p> 
<p><img src="https://images2.imgbox.com/4c/ea/Jjo7BKEA_o.png" alt="展示为"></p> 
<p>说明配置完成。</p> 
<p>4.6.执行：</p> 
<pre><code class="prism language-sh">./apachectl -k stop
</code></pre> 
<p>展示为：<br> <img src="https://images2.imgbox.com/28/a2/Ng832YqY_o.png" alt="执行"></p> 
<p>至此，服务配置已经完成。</p> 
<h3><a id="_226"></a>五、启动</h3> 
<p>进入到目录{httpd_root_path}/httpd/bin下，执行：</p> 
<pre><code class="prism language-sh">./httpd -d {4.3步骤中配置的目录} -f {httpd_root_path}/httpd/conf/httpd.conf -k start
</code></pre> 
<p>启动后例如：</p> 
<p><img src="https://images2.imgbox.com/45/64/ljwdf038_o.png" alt="启动后例如"></p> 
<p>停止：<br> 进入到目录{httpd_root_path}/httpd/bin下，执行：</p> 
<pre><code class="prism language-sh">./httpd -k stop
</code></pre> 
<p>升级：<br> 详见官方文档：https://httpd.apache.org/docs/2.4/install.html</p> 
<p><img src="https://images2.imgbox.com/57/bd/ddDZaZnG_o.png" alt="详见官方文档"></p> 
<h3><a id="_247"></a>六、验证</h3> 
<p>在5.3步骤的根目录下创建几个测试文件：<br> <img src="https://images2.imgbox.com/cb/6e/QupYywMg_o.png" alt="创建几个测试文件"></p> 
<p>浏览器访问：http://服务IP地址:4.1步骤中配置的端口号<br> 展示例如：<br> <img src="https://images2.imgbox.com/97/0f/ogXePUrh_o.png" alt="展示例如"></p> 
<p>至此，服务部署启动完成。4.3配置目录将为图片文件存放路径，后续将在Nacos系统全局配置中进行设置。</p> 
<h3><a id="_261"></a>七、附</h3> 
<p>软件包清理：<br> 进入到目录{httpd_root_path}下，执行：</p> 
<pre><code class="prism language-sh">rm ./expat-*
</code></pre> 
<p>提示信息输入 y 后回车</p> 
<p>执行：</p> 
<pre><code class="prism language-sh">rm ./apr-*
</code></pre> 
<p>提示信息输入 y 后回车</p> 
<p>执行：</p> 
<pre><code class="prism language-sh">rm ./ pcre2-10.40.tar.gz
</code></pre> 
<p>提示信息输入 y 后回车</p> 
<p>执行：</p> 
<pre><code class="prism language-sh">rm -rf ./ httpd-2.4.54
</code></pre> 
<p>至此，所有安装步骤已经完成。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ac6461501c2fef2eed0435a5986bbf00/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">方舟综合指令代码大全系统综合</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d8c4570f3843af82877a68cc3227bccf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">更改ElementPlus默认样式的方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>