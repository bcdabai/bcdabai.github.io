<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>æœºå™¨å­¦ä¹ å®æˆ˜â€”â€”å¤šæ¨¡å‹å®ç°é¢„æµ‹åŠŸèƒ½ - ç¼–ç¨‹å¤§ç™½çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="æœºå™¨å­¦ä¹ å®æˆ˜â€”â€”å¤šæ¨¡å‹å®ç°é¢„æµ‹åŠŸèƒ½" />
<meta property="og:description" content="æ–‡ç« ç›®å½• å‰è¨€ä¸€ã€æ•°æ®å‡†å¤‡1.1 æ•°æ®ä¸‹è½½1.2 æ•°æ®æ ¼å¼è½¬æ¢1.3 æ•°æ®æ‹†åˆ† äºŒã€æ¨¡å‹æ„å»º2.1 Kè¿‘é‚»2.2 å†³ç­–æ ‘ä¸éšæœºæ£®æ—2.3 å¤šå±‚æ„ŸçŸ¥å™¨ å‰è¨€ å¤§å®¶å¥½âœ¨ï¼Œè¿™é‡Œæ˜¯bioğŸ¦–ã€‚
æœºå™¨å­¦ä¹ æ–¹æ³•å·²ç»åº”ç”¨åˆ°æ—¥å¸¸ç”Ÿæ´»çš„æ–¹æ–¹é¢é¢ã€‚ä»è‡ªåŠ¨æ¨èçœ‹ä»€ä¹ˆç”µå½±ã€ç‚¹ä»€ä¹ˆé£Ÿç‰©ã€ä¹°ä»€ä¹ˆå•†å“ï¼Œåˆ°ä¸ªæ€§åŒ–çš„åœ¨çº¿ç”µå°å’Œä»ç…§ç‰‡ä¸­è¯†åˆ«å¥½å‹ï¼Œè®¸å¤šç°ä»£åŒ–ç½‘ç«™å’Œè®¾å¤‡çš„æ ¸å¿ƒéƒ½æ˜¯æœºå™¨å­¦ä¹ ç®—æ³•ã€‚
æ‰€ä»¥è¿™æ¬¡ç»™å¤§å®¶å¸¦æ¥çš„æ˜¯æœºæ¢°å­¦ä¹ æ¨¡å‹çš„åº”ç”¨ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯å®æˆ˜ã€‚å¦‚æœä½ æ˜¯æ–°æ‰‹è¿™ç¯‡æ–‡å±•çš„ä»£ç å°†æœ‰åŠ©äºä½ ç†è§£æœºæ¢°å­¦ä¹ çš„åº”ç”¨ã€‚è§‚çœ‹å®Œæœ¬æ–‡ï¼ˆä¸»è¦æ˜¯ä»£ç ï¼‰ï¼Œä½ å°†å­¦ä¹ åˆ°ï¼š
1. å¦‚ä½•æ„å»ºç®€å•æœºæ¢°å­¦ä¹ æ¨¡å‹ KNN, Random Forest, Decision Tree and Multilayer Perceptron
2. å¦‚ä½•æé«˜æ¨¡å‹çš„è¡¨ç°
3. å¦‚ä½•å¯¹æ•°æ®è¿›è¡Œå¤„ç†ä»¥åŠå¯è§†åŒ–å±•ç°
ä¸€ã€æ•°æ®å‡†å¤‡ 1.1 æ•°æ®ä¸‹è½½ æ•°æ®æ¥è‡ªcsdnç¥å·æ•°ç é›†å›¢2022å¹´æ ¡å›­æŠ€æœ¯å¤§èµ›ï¼Œæå–ç ï¼šjc58ã€‚æ•°æ®é›†åŒ…æ‹¬trainæ•°æ®ã€testæ•°æ®ä»¥åŠå‚è€ƒçš„é¢„æµ‹ç»“æœæ ¼å¼ã€‚trainæ•°æ®åŒ…å«User ID Gender Age AnnualSalary Purchasedï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªäºŒåˆ†ç±»çš„é—®é¢˜ï¼Œæ ¹æ®ç”¨æˆ·çš„æ€§åˆ«ã€å¹´é¾„ã€å¹´æ”¶å…¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦è´­ä¹°è½¦è¾†ğŸš—ã€‚
å›¾ä¸€ï¼Œæ•°æ®é›†å±•ç¤ºå›¾ 1.2 æ•°æ®æ ¼å¼è½¬æ¢ ä½¿ç”¨pandasè¯»å…¥è®­ç»ƒæ•°æ®ï¼Œå…¶å±•ç¤ºå¦‚å›¾äºŒã€‚å…¶ä¸­Genderåˆ—åŒ…æ‹¬å¥³æ€§å’Œç”·æ€§ï¼Œå¯ä»¥å°†å…¶ä»å­—ç¬¦è½¬æ¢ä¸ºæ•°å­—0å’Œ1ã€‚
import pandas as pd train_test_data = pd.read_csv(&#39;train.csv&#39;) display(train_test_data) å›¾äºŒï¼Œè®­ç»ƒæ•°æ®å±•ç¤ºå›¾ ä½¿ç”¨å¦‚ä¸‹ä»£ç å°†maleå’Œfemaleè½¬æ¢ä¸º0å’Œ1ã€‚
trans_form = train_test_data[&#39;Gender&#39;] trans_form = [1 if i == &#34;Male&#34; else 0 for i in trans_form] train_test_data[&#34;Gender&#34;] = trans_form display(train_test_data) å›¾ä¸‰ï¼Œè®­ç»ƒæ•°æ®æ ¼å¼è½¬æ¢å±•ç¤ºå›¾ 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/38cd664766e14068d9ef53c05a6c89f3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-10T19:21:01+08:00" />
<meta property="article:modified_time" content="2023-04-10T19:21:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§ç™½çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§ç™½çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">æœºå™¨å­¦ä¹ å®æˆ˜â€”â€”å¤šæ¨¡å‹å®ç°é¢„æµ‹åŠŸèƒ½</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>æ–‡ç« ç›®å½•</h4> 
 <ul><li><a href="#_6" rel="nofollow">å‰è¨€</a></li><li><a href="#_22" rel="nofollow">ä¸€ã€æ•°æ®å‡†å¤‡</a></li><li><ul><li><a href="#11__23" rel="nofollow">1.1 æ•°æ®ä¸‹è½½</a></li><li><a href="#12__28" rel="nofollow">1.2 æ•°æ®æ ¼å¼è½¬æ¢</a></li><li><a href="#13__49" rel="nofollow">1.3 æ•°æ®æ‹†åˆ†</a></li></ul> 
  </li><li><a href="#_67" rel="nofollow">äºŒã€æ¨¡å‹æ„å»º</a></li><li><ul><li><a href="#21_K_68" rel="nofollow">2.1 Kè¿‘é‚»</a></li><li><a href="#22__102" rel="nofollow">2.2 å†³ç­–æ ‘ä¸éšæœºæ£®æ—</a></li><li><a href="#23__167" rel="nofollow">2.3 å¤šå±‚æ„ŸçŸ¥å™¨</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_6"></a>å‰è¨€</h2> 
<p>å¤§å®¶å¥½âœ¨ï¼Œè¿™é‡Œæ˜¯bioğŸ¦–ã€‚</p> 
<p>æœºå™¨å­¦ä¹ æ–¹æ³•å·²ç»åº”ç”¨åˆ°æ—¥å¸¸ç”Ÿæ´»çš„æ–¹æ–¹é¢é¢ã€‚ä»è‡ªåŠ¨æ¨èçœ‹ä»€ä¹ˆç”µå½±ã€ç‚¹ä»€ä¹ˆé£Ÿç‰©ã€ä¹°ä»€ä¹ˆå•†å“ï¼Œåˆ°ä¸ªæ€§åŒ–çš„åœ¨çº¿ç”µå°å’Œä»ç…§ç‰‡ä¸­è¯†åˆ«å¥½å‹ï¼Œè®¸å¤šç°ä»£åŒ–ç½‘ç«™å’Œè®¾å¤‡çš„æ ¸å¿ƒéƒ½æ˜¯æœºå™¨å­¦ä¹ ç®—æ³•ã€‚</p> 
<p>æ‰€ä»¥è¿™æ¬¡ç»™å¤§å®¶å¸¦æ¥çš„æ˜¯æœºæ¢°å­¦ä¹ æ¨¡å‹çš„åº”ç”¨ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯å®æˆ˜ã€‚å¦‚æœä½ æ˜¯æ–°æ‰‹è¿™ç¯‡æ–‡å±•çš„ä»£ç å°†æœ‰åŠ©äºä½ ç†è§£æœºæ¢°å­¦ä¹ çš„åº”ç”¨ã€‚è§‚çœ‹å®Œæœ¬æ–‡ï¼ˆä¸»è¦æ˜¯ä»£ç ï¼‰ï¼Œä½ å°†å­¦ä¹ åˆ°ï¼š</p> 
<p><em>1. å¦‚ä½•æ„å»ºç®€å•æœºæ¢°å­¦ä¹ æ¨¡å‹ KNN, Random Forest, Decision Tree and Multilayer Perceptron</em><br> <em>2. å¦‚ä½•æé«˜æ¨¡å‹çš„è¡¨ç°</em><br> <em>3. å¦‚ä½•å¯¹æ•°æ®è¿›è¡Œå¤„ç†ä»¥åŠå¯è§†åŒ–å±•ç°</em></p> 
<hr> 
<h2><a id="_22"></a>ä¸€ã€æ•°æ®å‡†å¤‡</h2> 
<h3><a id="11__23"></a>1.1 æ•°æ®ä¸‹è½½</h3> 
<p><a href="https://pan.baidu.com/s/15roglZNE6D2xu6xXkpq7tg#list/path=/" rel="nofollow">æ•°æ®</a>æ¥è‡ªcsdnç¥å·æ•°ç é›†å›¢2022å¹´æ ¡å›­æŠ€æœ¯å¤§èµ›ï¼Œæå–ç ï¼š<code>jc58</code>ã€‚æ•°æ®é›†åŒ…æ‹¬<strong>trainæ•°æ®</strong>ã€<strong>testæ•°æ®</strong>ä»¥åŠ<strong>å‚è€ƒçš„é¢„æµ‹ç»“æœæ ¼å¼</strong>ã€‚trainæ•°æ®åŒ…å«<code>User ID</code> <code>Gender</code> <code>Age</code> <code>AnnualSalary</code> <code>Purchased</code>ï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªäºŒåˆ†ç±»çš„é—®é¢˜ï¼Œæ ¹æ®ç”¨æˆ·çš„æ€§åˆ«ã€å¹´é¾„ã€å¹´æ”¶å…¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦è´­ä¹°è½¦è¾†ğŸš—ã€‚<br> <img src="https://images2.imgbox.com/fd/4a/5AqhGavd_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<center> 
 <b><font size="3">å›¾ä¸€ï¼Œæ•°æ®é›†å±•ç¤ºå›¾</font></b> 
</center> 
<h3><a id="12__28"></a>1.2 æ•°æ®æ ¼å¼è½¬æ¢</h3> 
<p>ä½¿ç”¨<code>pandas</code>è¯»å…¥è®­ç»ƒæ•°æ®ï¼Œå…¶å±•ç¤ºå¦‚å›¾äºŒã€‚å…¶ä¸­<code>Gender</code>åˆ—åŒ…æ‹¬å¥³æ€§å’Œç”·æ€§ï¼Œå¯ä»¥å°†å…¶ä»å­—ç¬¦è½¬æ¢ä¸ºæ•°å­—0å’Œ1ã€‚</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

train_test_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'train.csv'</span><span class="token punctuation">)</span>
display<span class="token punctuation">(</span>train_test_data<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/76/58/7MlTOoRZ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<center> 
 <b><font size="3">å›¾äºŒï¼Œè®­ç»ƒæ•°æ®å±•ç¤ºå›¾</font></b> 
</center> 
<p>ä½¿ç”¨å¦‚ä¸‹ä»£ç å°†maleå’Œfemaleè½¬æ¢ä¸º0å’Œ1ã€‚</p> 
<pre><code class="prism language-python">trans_form <span class="token operator">=</span> train_test_data<span class="token punctuation">[</span><span class="token string">'Gender'</span><span class="token punctuation">]</span>
trans_form <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span> <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">"Male"</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> trans_form<span class="token punctuation">]</span>
train_test_data<span class="token punctuation">[</span><span class="token string">"Gender"</span><span class="token punctuation">]</span> <span class="token operator">=</span> trans_form
display<span class="token punctuation">(</span>train_test_data<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fe/12/RG34CVJ1_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<center> 
 <b><font size="3">å›¾ä¸‰ï¼Œè®­ç»ƒæ•°æ®æ ¼å¼è½¬æ¢å±•ç¤ºå›¾</font></b> 
</center> 
<h3><a id="13__49"></a>1.3 æ•°æ®æ‹†åˆ†</h3> 
<p>å°†è®­ç»ƒæ•°æ®æ‹†æŒ‰ç…§3ï¼š1åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œ</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment"># train and test data</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>train_test_split<span class="token punctuation">(</span>train_test_data<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"Gender"</span><span class="token punctuation">,</span><span class="token string">"Age"</span><span class="token punctuation">,</span><span class="token string">"AnnualSalary"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> train_test_data<span class="token punctuation">[</span><span class="token string">"Purchased"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a2/d6/1snqLfd9_o.png" width="50%" align="left" title="è®­ç»ƒé›†"><img src="https://images2.imgbox.com/e8/8e/LLIx6SA1_o.png" width="50%" align="right"></p> 
<center> 
 <b><font size="3">å›¾å››ï¼Œæ‹†åˆ†åæ•°æ®é›†å›¾</font></b> 
</center> 
<hr> 
<h2><a id="_67"></a>äºŒã€æ¨¡å‹æ„å»º</h2> 
<h3><a id="21_K_68"></a>2.1 Kè¿‘é‚»</h3> 
<p>kè¿‘é‚»ï¼ˆK-Nearest Neighborsï¼‰ç®—æ³•ï¼Œä¹Ÿç§°ä¸ºKNNæˆ–k-NNï¼Œæ˜¯ä¸€ç§éå‚æ•°çš„ç›‘ç£å­¦ä¹ åˆ†ç±»ç®—æ³•ï¼Œå®ƒä½¿ç”¨é‚»è¿‘æ€§å¯¹å•ä¸ªæ•°æ®ç‚¹çš„åˆ†ç»„è¿›è¡Œåˆ†ç±»æˆ–é¢„æµ‹ã€‚ä»å›¾äº”å¯ä»¥çœ‹å‡ºé‚»å±…æ•°å°äºç­‰äºä¸‰çš„æƒ…å†µä¸‹ï¼Œå‡ºç°äº†è¿‡æ‹Ÿåˆï¼Œéšç€é‚»å±…æ•°ç›®å¢å¤šï¼Œæ¨¡å‹è¶Šå¤æ‚ã€‚æœ€å¥½çš„æƒ…å†µåº”å½“æ˜¯é‚»å±…æ•°ä¸º9æ—¶ã€‚</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neighbors <span class="token keyword">import</span> KNeighborsClassifier
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

train_accuracy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
test_accuracy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
neighbors <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> neighbor <span class="token keyword">in</span> neighbors<span class="token punctuation">:</span>
    knn <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span>n_neighbors<span class="token operator">=</span>neighbor<span class="token punctuation">)</span>
    knn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>
    knn<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span>
    train_accuracy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>knn<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">)</span>
    test_accuracy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>knn<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>neighbors<span class="token punctuation">,</span> train_accuracy<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'train accuracy'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>neighbors<span class="token punctuation">,</span> test_accuracy<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'test accuracy'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>j <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>neighbors<span class="token punctuation">,</span> train_accuracy<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>j <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>neighbors<span class="token punctuation">,</span> test_accuracy<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Neighbor"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Accuracy"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d1/7d/Tgq80IEX_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<center> 
 <b><font size="3">å›¾äº”ï¼Œé‚»å±…æ•°é‡ä¸å‡†ç¡®åº¦å…³ç³»å›¾</font></b> 
</center> 
<hr> 
<h3><a id="22__102"></a>2.2 å†³ç­–æ ‘ä¸éšæœºæ£®æ—</h3> 
<blockquote> 
 <p>å†³ç­–æ ‘ï¼ˆDecision treeï¼‰ç”±ä¸€ä¸ªå†³ç­–å›¾å’Œå¯èƒ½çš„ç»“æœï¼ˆåŒ…æ‹¬èµ„æºæˆæœ¬å’Œé£é™©ï¼‰ç»„æˆï¼Œ ç”¨æ¥åˆ›å»ºåˆ°è¾¾ç›®æ ‡çš„è§„åˆ’ã€‚å†³ç­–æ ‘å»ºç«‹å¹¶ç”¨æ¥è¾…åŠ©å†³ç­–ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ ‘ç»“æ„ã€‚å†³ç­–æ ‘æ˜¯ä¸€ä¸ªåˆ©ç”¨åƒæ ‘ä¸€æ ·çš„å›¾å½¢æˆ–å†³ç­–æ¨¡å‹çš„å†³ç­–æ”¯æŒå·¥å…·ï¼ŒåŒ…æ‹¬éšæœºäº‹ä»¶ç»“æœï¼Œèµ„æºä»£ä»·å’Œå®ç”¨æ€§ã€‚</p> 
</blockquote> 
<p>éšç€æ·±åº¦çš„å¢åŠ ï¼Œå†³ç­–æ ‘å‡ºç°äº†è¿‡æ‹Ÿåˆçš„æƒ…å†µï¼Œæœ€å¥½çš„æƒ…å†µæ˜¯æ·±åº¦ä¸º4æ—¶ã€‚è¯¥æ¨¡å‹åœ¨è¯¥æ•°æ®ä¸‹ä¼˜äºKNNã€‚</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

train_accuracy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
test_accuracy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
depth <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> num <span class="token keyword">in</span> depth<span class="token punctuation">:</span>
    tree <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>max_depth<span class="token operator">=</span>num<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    tree<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>
    train_accuracy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tree<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">)</span>
    test_accuracy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tree<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>depth<span class="token punctuation">,</span> train_accuracy<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"train accuracy"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>depth<span class="token punctuation">,</span> test_accuracy<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'test accuracy'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>j <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>depth<span class="token punctuation">,</span> train_accuracy<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>j <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>depth<span class="token punctuation">,</span> test_accuracy<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Depth"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Accuracy"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/02/35/xxx9moF6_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<center> 
 <b><font size="3">å›¾å…­ï¼Œæ·±åº¦ä¸å‡†ç¡®åº¦å…³ç³»å›¾</font></b> 
</center> 
<blockquote> 
 <p>éšæœºæ£®æ—æœ¬è´¨ä¸Šæ˜¯è®¸å¤šå†³ç­–æ ‘çš„é›†åˆï¼Œå…¶ä¸­æ¯æ£µæ ‘éƒ½å’Œå…¶ä»–æ ‘ç•¥æœ‰ä¸åŒã€‚éšæœºæ£®æ—èƒŒåçš„æ€æƒ³æ˜¯ï¼Œæ¯æ£µæ ‘çš„é¢„æµ‹å¯èƒ½éƒ½ç›¸å¯¹è¾ƒå¥½ï¼Œä½†å¯èƒ½å¯¹éƒ¨åˆ†æ•°æ®è¿‡æ‹Ÿåˆã€‚å¦‚æœæ„é€ å¾ˆå¤šæ ‘ï¼Œå¹¶ä¸”æ¯æ£µæ ‘çš„é¢„æµ‹éƒ½å¾ˆå¥½ï¼Œä½†éƒ½ä»¥ä¸åŒçš„æ–¹å¼è¿‡æ‹Ÿåˆï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¯¹è¿™äº›æ ‘çš„ç»“æœå–å¹³å‡å€¼æ¥é™ä½è¿‡æ‹Ÿåˆã€‚æ—¢èƒ½å‡å°‘è¿‡æ‹Ÿåˆåˆèƒ½ä¿æŒæ ‘çš„é¢„æµ‹èƒ½åŠ›ã€‚</p> 
</blockquote> 
<p>å¯ä»¥çœ‹å‡ºéšæœºæ£®æ—åœ¨è®­ç»ƒé›†æ‹Ÿåˆçš„éå¸¸å¥½ï¼Œä½†æ˜¯åœ¨æµ‹è¯•é›†è¡¨ç°è¾ƒå·®ï¼Œéƒ½å­˜åœ¨è¿‡æ‹Ÿåˆï¼Œä¸è¿‡æ²¡æœ‰æ­£åˆ™åŒ–å¯ä»¥é€‰æ‹©ï¼Œä¸ç„¶åº”è¯¥èƒ½å‡å°‘éƒ¨åˆ†è¿‡æ‹Ÿåˆã€‚</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

train_accuracy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
test_accuracy <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
forests <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> num <span class="token keyword">in</span> forests<span class="token punctuation">:</span>
    forest <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span>num<span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    forest<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
    train_accuracy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>forest<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">)</span>
    test_accuracy<span class="token punctuation">.</span>append<span class="token punctuation">(</span>forest<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>forests<span class="token punctuation">,</span> train_accuracy<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"train accuracy"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>forests<span class="token punctuation">,</span> test_accuracy<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"test accuracy"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>j <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>forests<span class="token punctuation">,</span> train_accuracy<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>j <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>forests<span class="token punctuation">,</span> test_accuracy<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Tree num"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Accuracy"</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/41/09/I4fvqZh8_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<center> 
 <b><font size="3">å›¾ä¸ƒï¼Œæ ‘æ•°é‡ä¸å‡†ç¡®åº¦å…³ç³»å›¾</font></b> 
</center> 
<hr> 
<h3><a id="23__167"></a>2.3 å¤šå±‚æ„ŸçŸ¥å™¨</h3> 
<p>å¤šå±‚æ„ŸçŸ¥æœºï¼ˆmultilayer perceptronï¼Œ MLPï¼‰ï¼Œå®ƒå¯ä»¥ä½œä¸ºç ”ç©¶æ›´å¤æ‚çš„æ·±åº¦å­¦ä¹ æ–¹æ³•çš„èµ·ç‚¹ã€‚MLP å¯ä»¥è¢«è§†ä¸ºå¹¿ä¹‰çš„çº¿æ€§æ¨¡å‹ï¼Œæ‰§è¡Œå¤šå±‚å¤„ç†åå¾—åˆ°ç»“è®ºã€‚</p> 
<p>é¦–å…ˆæ„é€ ä¸€ä¸ªç®€å•çš„MLPï¼Œè§‚å¯Ÿã€‚åœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„å‡†ç¡®ç‡éƒ½ä¸æ˜¯å¾ˆé«˜ï¼Œåªæœ‰ç™¾åˆ†ä¹‹å…­åå¤šã€‚</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neural_network <span class="token keyword">import</span> MLPClassifier

mlp <span class="token operator">=</span> MLPClassifier<span class="token punctuation">(</span>solver<span class="token operator">=</span><span class="token string">'lbfgs'</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> hidden_layer_sizes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mlp<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mlp<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token number">0.6044444444444445</span>
<span class="token number">0.6266666666666667</span>
</code></pre> 
<p>å¯¹æ•°æ®è¿›è¡Œç¼©æ”¾ï¼Œå³ä½¿ç”¨æ— ç›‘ç£å­¦ä¹ çš„æ–¹æ³•ï¼Œè¿™é‡Œå…ˆä½¿ç”¨MinMaxè¿›è¡Œå¤„ç†ï¼Œx-min/max-minï¼Œè¿™æ ·æ‰€æœ‰æ•°æ®å°±éƒ½åœ¨é›¶ä¸ä¸€ä¹‹é—´ã€‚è¿™æ ·å¤„ç†åæ¨¡å‹è¡¨ç°æ˜¾è‘—ä¸Šå‡ã€‚</p> 
<pre><code class="prism language-python"><span class="token comment"># data scale (unsupervised learning)</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> MinMaxScaler

<span class="token comment"># x-min/max-min</span>
scaler <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
scaler<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
X_train_scaled <span class="token operator">=</span> scaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
X_test_scaled <span class="token operator">=</span> scaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neural_network <span class="token keyword">import</span> MLPClassifier

mlp <span class="token operator">=</span> MLPClassifier<span class="token punctuation">(</span>solver<span class="token operator">=</span><span class="token string">'lbfgs'</span><span class="token punctuation">,</span>hidden_layer_sizes<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train_scaled<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mlp<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train_scaled<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mlp<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test_scaled<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token number">0.914074074074074</span>
<span class="token number">0.9022222222222223</span>
</code></pre> 
<hr>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/063e84d6af4cdc543bad921fe8b88ba6/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">vue3 å¯¹å…ƒç´ æ‹–æ‹½ã€ç¼©æ”¾</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d3ab0997a6a9a7084227279cb7845817/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">Linuxæ–‡ä»¶å»æ‰æ¯è¡Œæœ«å°¾^M</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§ç™½çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>