<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>File.exists() returns false when file exists - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="File.exists() returns false when file exists" />
<meta property="og:description" content="借用了下stackoverflow上的标题名，方便需要的同学搜索 - -！
原文地址：https://blog.csdn.net/ll413343176/article/details/84059549 转载请注明
英语能力强的可以先看下这两个帖子
https://stackoverflow.com/questions/919918/file-exists-returns-false-when-file-exists
https://bugs.java.com/bugdatabase/view_bug.do;:YfiG?bug_id=4483097
使用相对路径时，如果user.dir发生变化会导致下面两个结果运行不一致
file.exists() == false
file.getAbsoluteFile().exists() == true
来自oracle官网的解释为：
EVALUATION
Not a bug. If you need to resolve a filename against the value of
the &#34;user.dir&#34; system property then you must use getAbsolutePath (or
getAbsoluteFile, or getCanonicalPath, or getCanonicalFile). Simpler
operations such as exists() always resolve against the directory in
which the Java virtual machine was originally invoked (and no, there
is no way to change that)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e6e861941b6cf15ff10bf49da23fcd5c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-11-14T08:55:01+08:00" />
<meta property="article:modified_time" content="2018-11-14T08:55:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">File.exists() returns false when file exists</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>借用了下<a href="https://stackoverflow.com/questions/919918/file-exists-returns-false-when-file-exists" rel="nofollow">stackoverflow</a>上的标题名，方便需要的同学搜索 - -！</p> 
<p> </p> 
<p>原文地址：<a href="https://blog.csdn.net/ll413343176/article/details/84059549">https://blog.csdn.net/ll413343176/article/details/84059549</a>  转载请注明</p> 
<p> </p> 
<p>英语能力强的可以先看下这两个帖子</p> 
<p><a href="https://stackoverflow.com/questions/919918/file-exists-returns-false-when-file-exists" rel="nofollow">https://stackoverflow.com/questions/919918/file-exists-returns-false-when-file-exists</a></p> 
<p><a href="https://bugs.java.com/bugdatabase/view_bug.do;:YfiG?bug_id=4483097" rel="nofollow">https://bugs.java.com/bugdatabase/view_bug.do;:YfiG?bug_id=4483097</a></p> 
<p>使用相对路径时，如果user.dir发生变化会导致下面两个结果运行不一致</p> 
<p>file.exists() == false</p> 
<p>file.getAbsoluteFile().exists() == true</p> 
<p> </p> 
<p>来自oracle官网的解释为：</p> 
<p>EVALUATION</p> 
<p> </p> 
<p>Not a bug.  If you need to resolve a filename against the value of</p> 
<p>the "user.dir" system property then you must use getAbsolutePath (or</p> 
<p>getAbsoluteFile, or getCanonicalPath, or getCanonicalFile).  Simpler</p> 
<p>operations such as exists() always resolve against the directory in</p> 
<p>which the Java virtual machine was originally invoked (and no, there</p> 
<p>is no way to change that).</p> 
<p> </p> 
<p>通过讨论与测试，理解结论为：</p> 
<p>定义一个File时，若使用相对路径，则会因为user.dir发生改变时，调用file的getAbsxxx方法，会根据user.dir最新定义的位置改变</p> 
<p> </p> 
<p>所以，在操作文件时，一定要使用绝对路径定义，防止文件指向存在歧义。例子如下</p> 
<p>File file = new File(new File(".").getAbsolutePath(),"test.txt")；</p> 
<p>File file = new File("test.txt").getAbsoluteFile()；</p> 
<p> </p> 
<p>聊天记录微信已收藏，标签 File</p> 
<p> </p> 
<p>具体理解过程如下：</p> 
<p><img alt="" class="has" height="369" src="https://images2.imgbox.com/d0/96/3XuH4H5z_o.png" width="499"></p> 
<p> </p> 
<p>那么，还有一个问题，相对路径file.exists()指向的文件具体在哪呢，为此，把文件改成一个特殊的文件名，</p> 
<p>判断文件不存在时，进行新建，通过全盘搜索工具everything，查找文件所在位置，可以看到文件在当前工程目录之下。</p> 
<p><img alt="" class="has" height="436" src="https://images2.imgbox.com/bd/f3/J5RqruNa_o.png" width="680"></p> 
<p>回想一下，平常写代码时，特别是runnable jar，不都是使用相对路径，然后把文件放到jar同级目录么，此时程序内部若出现</p> 
<p>System.setProperty("user.dir", "e:/");</p> 
<p>f.getAbsolutePath();</p> 
<p>相关代码，那么恭喜你，成功入坑。</p> 
<p> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/219b902520718b4ade095d656202a3af/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Arduino core for ESP8266 WiFi chip  ESP8266 WiFi中文文档</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/77a3c03de442f78d17dfabd02e59ded0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">AGV-倍福beckhoff TWINCAT2及台达电机、传感器等使用总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>