<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>@Scheduled 注解的基本介绍、使用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="@Scheduled 注解的基本介绍、使用" />
<meta property="og:description" content="@Scheduled 注解基本介绍 ​ @Scheduled 比较官方一点的介绍 ： 是 Spring 框架中用于定时调度任务的注解。它允许您将一个方法标记为一个定时任务，然后可以配置任务的执行时间间隔或 cron 表达式。这个注解通常与 Spring Boot 一起使用，以创建定时任务。
​ 其实很简单，就是说，被@Scheduled标注的方法，会定时的执行。刚开始接触时，会有点理解不了这个定时执行，因为程序中的方法一般都是被调用之后才会执行。而这个定时执行是什么意思呢？没错，就是你想的这个意思：在spring项目中，主程序执行，项目启动之后，被@Scheduled标注的方法，就会定时的执行（每隔这么久时间就执行一次这个方法），不需要调用。
一般会应用在，比如： 定时执行任务、定时数据同步、缓存刷新、定时提醒和通知、定时报警和日志记录、定时任务调度管理 等场景
@Scheduled 注解基本使用 对这个注解有了大致的了解之后，我们来讲一下怎么使用
因为是Spring框架中的注解，所以当然是要引入Spring Boot Starter 或其他 Spring 的相关依赖啦
&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; 为了使@Scheduled生效，我们需要在 Spring Boot 应用中启用定时任务调度，很简单，在主应用类上添加 @EnableScheduling 注解就OK了
@SpringBootApplication @EnableScheduling	// 启用定时任务 public class MyApplication { public static void main(String[] args) { SpringApplication.run(MyApplication.class, args); } } 然后来看一下@Scheduled 在程序中在哪里定义、怎么去配置定时执行的时间
@Scheduled 注解通常用于Spring管理的Bean的方法
@Component // 声明这个类为一个Spring管理的Bean public class MyScheduledBean { @Scheduled(fixedRate = 5000) // 每隔5秒执行一次 public void myScheduledMethod() { // 这里放置需要定时执行的逻辑 System." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/977ee24cd83909ebe236e2fe61d57699/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-18T22:48:16+08:00" />
<meta property="article:modified_time" content="2023-10-18T22:48:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">@Scheduled 注解的基本介绍、使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="Scheduled__0"></a>@Scheduled 注解基本介绍</h3> 
<p>​ @Scheduled 比较官方一点的介绍 ： 是 Spring 框架中用于定时调度任务的注解。它允许您将一个方法标记为一个定时任务，然后可以配置任务的执行时间间隔或 cron 表达式。这个注解通常与 Spring Boot 一起使用，以创建定时任务。</p> 
<p>​ 其实很简单，就是说，被@Scheduled标注的方法，会定时的执行。刚开始接触时，会有点理解不了这个定时执行，因为程序中的方法一般都是被调用之后才会执行。而这个定时执行是什么意思呢？没错，就是你想的这个意思：在spring项目中，主程序执行，项目启动之后，被@Scheduled标注的方法，就会定时的执行（每隔这么久时间就执行一次这个方法），不需要调用。</p> 
<p>一般会应用在，比如： <strong>定时执行任务</strong>、<strong>定时数据同步</strong>、<strong>缓存刷新</strong>、<strong>定时提醒和通知</strong>、<strong>定时报警和日志记录</strong>、<strong>定时任务调度管理</strong> 等场景</p> 
<h3><a id="Scheduled__10"></a>@Scheduled 注解基本使用</h3> 
<p>对这个注解有了大致的了解之后，我们来讲一下怎么使用</p> 
<blockquote> 
 <p>因为是Spring框架中的注解，所以当然是要引入Spring Boot Starter 或其他 Spring 的相关依赖啦</p> 
</blockquote> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<blockquote> 
 <p>为了使@Scheduled生效，我们需要在 Spring Boot 应用中启用定时任务调度，很简单，在主应用类上添加 <code>@EnableScheduling</code> 注解就OK了</p> 
</blockquote> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableScheduling</span>					<span class="token comment">// 启用定时任务</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyApplication</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">MyApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>然后来看一下@Scheduled 在程序中在哪里定义、怎么去配置定时执行的时间</p> 
</blockquote> 
<p><code>@Scheduled</code> 注解通常用于Spring管理的Bean的方法</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Component</span> <span class="token comment">// 声明这个类为一个Spring管理的Bean</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyScheduledBean</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>fixedRate <span class="token operator">=</span> <span class="token number">5000</span><span class="token punctuation">)</span> <span class="token comment">// 每隔5秒执行一次</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">myScheduledMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 这里放置需要定时执行的逻辑</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Scheduled method executed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>@Scheduled</code> 有四种属性，可供使用者对方法执行的时间进行配置</p> 
<ol><li><strong>fixedRate</strong>：它指定了任务按照固定的速率执行，以毫秒为单位。例如，<code>fixedRate = 5000</code> 表示每隔5秒执行一次，<strong>无论任务执行时间长短</strong>。</li><li><strong>fixedDelay</strong>：这个属性指定了任务在上一次任务完成后，<strong>等待指定的时间</strong>再执行下一次任务，以毫秒为单位。</li><li><strong>initialDelay</strong>：这个属性用于配置在应用启动后，<strong>首次执行任务之前等待的时间</strong>，以毫秒为单位。它可以用于延迟任务的启动，以防止在应用启动时立即执行任务。</li><li><strong>cron</strong>：使用<code>cron</code>表达式配置任务的执行时间，这是一种非常灵活的方式。<code>cron</code>表达式允许你定义任务的执行时间规则，包括秒、分、时、日期等。例如，<code>@Scheduled(cron = "0 0 2 * * ?")</code> 表示每天凌晨2点执行。</li></ol> 
<p>其中，前三个属性就跟上面的例子一样使用就好了，这里详细说一下cron表达式的使用</p> 
<h3><a id="CRON_70"></a>CRON表达式</h3> 
<p><code>cron</code> 属性用于在Spring中非常灵活地配置任务的执行时间，基于CRON表达式的时间规则。CRON表达式由多个字段组成，每个字段表示不同的时间单位和条件。以下是一个基本的CRON表达式结构：</p> 
<pre><code class="prism language-bash">second minute hour day-of-month month day-of-week
</code></pre> 
<p>每个字段可以包含一个数字、多个数字或特殊字符，例如星号（*）、问号（?）、斜杠（/）等。下面是一些常用的CRON表达式示例：</p> 
<ol><li> <p><strong>每天的午夜12点执行</strong>（0秒、0分、0时）：</p> <pre><code class="prism language-java"><span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">"0 0 0 * * ?"</span><span class="token punctuation">)</span>
</code></pre> </li><li> <p><strong>每周日的中午12点执行</strong>：</p> <pre><code class="prism language-java"><span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">"0 0 12 ? * SUN"</span><span class="token punctuation">)</span>
</code></pre> </li><li> <p><strong>每小时的15分执行</strong>：</p> <pre><code class="prism language-java"><span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">"0 15 * * * ?"</span><span class="token punctuation">)</span>
</code></pre> </li><li> <p><strong>每隔5秒执行一次</strong>：</p> <pre><code class="prism language-java"><span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">"0/5 * * * * ?"</span><span class="token punctuation">)</span>
</code></pre> </li></ol> 
<p>CRON表达式字段的含义如下：</p> 
<ul><li><code>second</code>：秒（0-59）</li><li><code>minute</code>：分（0-59）</li><li><code>hour</code>：时（0-23）</li><li><code>day-of-month</code>：每月的某一天（1-31）</li><li><code>month</code>：月份（1-12或JAN-DEC）</li><li><code>day-of-week</code>：每周的某一天（0-7或SUN-SAT，0和7都代表星期日）</li></ul> 
<p>有一些特殊字符也可以在CRON表达式中使用：</p> 
<ul><li><code>*</code>：代表匹配任何值。例如，<code>*</code> 在分钟字段中表示”每“分钟。</li><li><code>?</code>：用于不指定特定的值，通常用于<code>day-of-month</code> 和 <code>day-of-week</code> 字段中的一个。</li><li><code>/</code>：用于指定间隔值。例如，<code>*/5</code> 在分钟字段中表示每5分钟执行一次。</li><li><code>-</code>：用于指定范围。例如，<code>1-5</code> 在<code>day-of-week</code> 字段中表示星期一到星期五。</li><li><code>,</code>：用于列出多个值。例如，<code>MON, WED, FRI</code> 在<code>day-of-week</code> 字段中表示星期一、星期三和星期五。</li><li><code>L</code>：用于表示“最后”的意思。通常用于 <code>day-of-month</code> 和 <code>day-of-week</code> 字段。例如： 
  <ul><li><code>0 0 1 * * L</code>：每月的最后一天执行一次。</li></ul> </li><li><code>W</code>：用于工作日（平日）的最接近的工作日。例如： 
  <ul><li><code>0 0 15 ? * WED</code>：每月的第三个工作日执行一次。</li></ul> </li><li><code>#</code>：用于表示 <code>day-of-week</code> 字段中的第几个工作日。例如： 
  <ul><li><code>0 0 ? * 1#2</code>：每月的第二个星期一执行一次。</li></ul> </li></ul> 
<h3><a id="_129"></a>注意事项</h3> 
<p>还有一点需要注意的是@Scheduled 方法是<code>单线程</code>，在主线程上执行的。所以会阻塞主线程。不同的@Scheduled方法之间也是相互制约的。</p> 
<p>所以，需要使用@Async注解，开启方法的异步调用，这样@Scheduled定时任务就会在后台执行，不会阻塞主线程和其他请求的处理。<br> <img src="https://images2.imgbox.com/12/b6/VeEVCrcE_o.jpg" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8f71331a71c883569f9d30c8d61d0009/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">QT自定义空间之软键盘</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/885fc6ed70aa74974f6beb340e383780/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux同时安装多个版本的JDK&amp;linux多版本JDK切换配置- [Centos 安装JDK]</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>