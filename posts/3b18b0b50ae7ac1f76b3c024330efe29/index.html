<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>yolov5s.yaml 文件解读 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="yolov5s.yaml 文件解读" />
<meta property="og:description" content="# YOLOv5 🚀 by Ultralytics, AGPL-3.0 license # Parameters nc: 81 # number of classes depth_multiple: 0.33 # model depth multiple width_multiple: 0.50 # layer channel multiple anchors: - [10,13, 16,30, 33,23] # P3/8 - [30,61, 62,45, 59,119] # P4/16 - [116,90, 156,198, 373,326] # P5/32 nc: 81 - 表示模型被训练来识别的类别数量为81。
depth_multiple: 0.33 - 模型深度的倍数。这个参数用于调整模型中层的深度。值为0.33意味着每个层的深度为原始设计深度的33%，通常用于减小模型大小和计算需求，但可能会牺牲精度。
width_multiple: 0.50 - 表示层通道的倍数。这个参数用于调整网络层中通道的数量。值为0.50意味着每个层的通道数为原始设计的50%。类似于深度倍数，也可用于减小模型的大小和计算需求。
anchors - 参数定义了一组锚点框（anchor boxes），这些框用于检测不同尺寸的物体。在YOLO模型中，锚点框是预定义的不同大小和比例的矩形，模型在这些矩形基础上调整以更好地适应实际检测到的物体。这里定义了三组不同尺寸的锚点框，每组用于不同层级的特征图（如P3/8, P4/16, P5/32），这些特征图代表不同的空间分辨率。
锚点框（Anchor Boxes）是一种在目标检测领域常用的技术，用于模型在图像中识别和定位对象。
基本概念 预定义的矩形框：锚点框是一组预定义的矩形框，这些框有不同的尺寸和长宽比。它们被设计为覆盖可能在图像中出现的各种对象的形状和大小。
特征图上的位置：在目标检测过程中，模型生成一个或多个特征图（feature maps），这些特征图在不同的空间分辨率上表示图像的特征。锚点框被放置在这些特征图的每个位置上。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/3b18b0b50ae7ac1f76b3c024330efe29/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-16T17:22:23+08:00" />
<meta property="article:modified_time" content="2024-01-16T17:22:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">yolov5s.yaml 文件解读</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <pre><code class="language-python"># YOLOv5 🚀 by Ultralytics, AGPL-3.0 license

# Parameters
nc: 81  # number of classes
depth_multiple: 0.33  # model depth multiple
width_multiple: 0.50  # layer channel multiple
anchors:
  - [10,13, 16,30, 33,23]  # P3/8
  - [30,61, 62,45, 59,119]  # P4/16
  - [116,90, 156,198, 373,326]  # P5/32</code></pre> 
<ol><li> <p><code>nc: 81</code> - 表示模型被训练来识别的类别数量为81。</p> </li><li> <p><code>depth_multiple: 0.33</code> - 模型深度的倍数。这个参数用于调整模型中层的深度。值为0.33意味着每个层的深度为原始设计深度的33%，通常用于减小模型大小和计算需求，但可能会牺牲精度。</p> </li><li> <p><code>width_multiple: 0.50</code> - 表示层通道的倍数。这个参数用于调整网络层中通道的数量。值为0.50意味着每个层的通道数为原始设计的50%。类似于深度倍数，也可用于减小模型的大小和计算需求。</p> </li><li> <p><code>anchors</code> - 参数定义了一组锚点框（anchor boxes），这些框用于检测不同尺寸的物体。在YOLO模型中，锚点框是预定义的不同大小和比例的矩形，模型在这些矩形基础上调整以更好地适应实际检测到的物体。这里定义了三组不同尺寸的锚点框，每组用于不同层级的特征图（如P3/8, P4/16, P5/32），这些特征图代表不同的空间分辨率。</p> </li></ol> 
<table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><td> <p>锚点框（Anchor Boxes）是一种在目标检测领域常用的技术，用于模型在图像中识别和定位对象。</p> <h4>基本概念</h4> 
    <ol><li> <p><strong>预定义的矩形框</strong>：锚点框是一组预定义的矩形框，这些框有不同的尺寸和长宽比。它们被设计为覆盖可能在图像中出现的各种对象的形状和大小。</p> </li><li> <p><strong>特征图上的位置</strong>：在目标检测过程中，模型生成一个或多个特征图（feature maps），这些特征图在不同的空间分辨率上表示图像的特征。锚点框被放置在这些特征图的每个位置上。</p> </li><li> <p><strong>多尺度检测</strong>：通过在不同层级的特征图上使用不同大小的锚点框，模型可以检测不同尺寸的对象。</p> </li></ol><h4>工作原理</h4> 
    <ol><li> <p><strong>初始定位</strong>：在模型训练的初始阶段，每个锚点框试图定位一个对象。它做的是一个粗略的定位，因为锚点框的位置和大小是预先定义的，而不是精确匹配对象的。</p> </li><li> <p><strong>调整和分类</strong>：模型学习如何调整这些锚点框的大小和位置以更好地匹配图像中的实际对象，并对每个调整后的框进行分类（判断框内是什么对象）。</p> </li><li> <p><strong>重叠框的处理</strong>：通常会有多个锚点框重叠在同一个对象上。因此，使用一种叫做非极大值抑制（Non-Maximum Suppression, NMS）的技术来选出最佳的框。</p> </li></ol><h4>优化</h4> <p>在实际应用中，锚点框的尺寸和比例通常需要根据具体任务和数据集进行调整。选择与数据集中常见对象尺寸和形状相匹配的锚点框，可以提高模型的检测性能。例如，如果你的数据集主要包含长形对象，你可能会选择更多长形的锚点框。</p> </td></tr></tbody></table> 
<p>优化建议：</p> 
<ul><li>可以通过减小<code>depth_multiple</code>和<code>width_multiple</code>的值，提高模型的速度和效率，但这可能会降低模型的精度。如果需要提高模型精度并且计算资源充足，可以增加这些值。</li><li>锚点框的选择对模型性能也有很大影响。通常，这些锚点框应该根据你的特定用例和数据集进行调整。可以通过分析数据集中物体的常见尺寸和比例来优化这些锚点框。</li></ul> 
<pre><code class="language-python"># YOLOv5 v6.0 backbone
backbone:
  # [from, number, module, args]
  [[-1, 1, Conv, [64, 6, 2, 2]],  # 0-P1/2
   [-1, 1, Conv, [128, 3, 2]],    # 1-P2/4
   [-1, 3, C3, [128]],            # 2
   [-1, 1, Conv, [256, 3, 2]],    # 3-P3/8
   [-1, 6, C2, [256]],            # 4-修改为C2*2
   [-1, 1, Conv, [512, 3, 2]],    # 5-P4/16
   [-1, 3, C3, [512]],            # 6-修改为C3*1
#   [-1, 1, Conv, [1024, 3, 2]],   # 7-删除P5/32
#   [-1, 3, C3, [1024]],           # 8-删除
   [-1, 1, SPPF, [512, 5]],      # 9-修改参数;层数变为7
  ]</code></pre> 
<p>这段代码是YOLOv5 v6.0模型的“backbone”（主干网络）的配置。</p> 
<h4>代码解读</h4> 
<ol><li> <p><code>[-1, 1, Conv, [64, 6, 2, 2]]</code> - 这行表示从前一层（由<code>-1</code>表示）向下连接一个卷积层（<code>Conv</code>），这个卷积层有64个过滤器，过滤器大小为6x6，步长为2，填充为2。这是P1/2层，意味着它将输入的空间分辨率减少一半。</p> </li><li> <p><code>[-1, 1, Conv, [128, 3, 2]]</code> - 从前一层向下连接一个卷积层，有128个过滤器，大小为3x3，步长为2。这是P2/4层，进一步降低空间分辨率。</p> </li><li> <p><code>[-1, 3, C3, [128]]</code> - 从前一层向下连接一个由3个C3模块组成的层，每个模块有128个过滤器。C3是YOLOv5特有的一个模块，包含多个瓶颈层（bottleneck layers）。</p> </li><li> <p><code>[-1, 1, Conv, [256, 3, 2]]</code> - 又一个卷积层，256个过滤器，3x3，步长为2。这是P3/8层。</p> </li><li> <p><code>[-1, 6, C2, [256]]</code> - 从前一层向下连接一个由6个C2模块组成的层，每个模块有256个过滤器。这是原始代码中的修改，原来是C3模块。</p> </li><li> <p><code>[-1, 1, Conv, [512, 3, 2]]</code> - 又一个卷积层，512个过滤器，3x3，步长为2。这是P4/16层。</p> </li><li> <p><code>[-1, 3, C3, [512]]</code> - 从前一层向下连接一个由3个C3模块组成的层，每个模块有512个过滤器。这是原始代码中的修改，原来可能是更多的C3模块。</p> </li><li> <p><code>[-1, 1, SPPF, [512, 5]]</code> - 从前一层向下连接一个SPPF（Spatial Pyramid Pooling-Fast）层，512个过滤器，核大小为5。SPPF是一种特殊的池化层，可以聚合不同尺度的特征。</p> </li></ol> 
<pre><code class="language-python"># YOLOv5 v6.0 head
head:
  [[-1, 1, Conv, [512, 3, 2]], # 修改参数
   [-1, 1, nn.Upsample, [None, 2, 'nearest']],
   [[-1, 6], 1, Concat, [1]],  # cat backbone P4
   [-1, 3, C3, [512, False]],  # 13-&gt;11

   [-1, 1, Conv, [256, 1, 1]],
   [-1, 1, nn.Upsample, [None, 2, 'nearest']],
   [[-1, 4], 1, Concat, [1]],  # cat backbone P3
   [-1, 3, C3, [256, False]],  # 17-&gt;15 (P3/8-small)

   [-1, 1, Conv, [256, 3, 2]],
   [[-1, 12], 1, Concat, [1]],  # cat head P4 修改层数-2
   [-1, 3, C3, [512, False]],  # 20-&gt;18 (P4/16-medium)

   [-1, 1, Conv, [512, 3, 2]],
   [[-1, 8], 1, Concat, [1]],  # cat head P5 修改层数-2
   [-1, 3, C3, [1024, False]],  # 23-&gt;21 (P5/32-large)

   [[15, 18, 21], 1, Detect, [nc, anchors]],  # Detect(P3, P4, P5) 修改层数-2
  ]
</code></pre> 
<p>这段代码是YOLOv5 v6.0的“head”部分，即模型的输出层，它负责将从主干网络（backbone）提取的特征用于目标的检测。</p> 
<ol><li> <p><code>[-1, 1, Conv, [512, 3, 2]]</code> - 从前一层向下连接一个卷积层，512个过滤器，核大小为3x3，步长为2。</p> </li><li> <p><code>[-1, 1, nn.Upsample, [None, 2, 'nearest']]</code> - 使用上采样（upsampling）技术放大特征图的尺寸，这里采用最近邻插值方法，放大比例为2。</p> </li><li> <p><code>[[[-1, 6], 1, Concat, [1]]</code> - 将当前层与主干网络中的第6层（P4层）的输出进行拼接（Concat）。</p> </li><li> <p><code>[-1, 3, C3, [512, False]]</code> - 使用3个C3模块，每个模块512个过滤器，这里的<code>False</code>可能表示不使用残差连接。</p> </li><li> <p>接下来的几行代码重复上述过程，但是用于不同的特征图尺寸和通道数。例如，使用256通道的卷积和C3模块处理P3层的特征图，然后通过卷积和拼接操作处理P4和P5层的特征图。</p> </li><li> <p><code>[[15, 18, 21], 1, Detect, [nc, anchors]]</code> - 这是模型的检测层，它整合了不同层级（P3、P4、P5）的特征图，并使用预定义的类别数（nc）和锚点框（anchors）来检测图像中的对象。</p> </li></ol> 
<h4>代码变更和优化</h4> 
<ul><li> <p>对于卷积层和C3模块的使用，可以根据需要调整过滤器的数量和层数，以找到性能和准确度之间的最佳平衡</p> </li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9f3ff9730827664175de80a0347e5932/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">2023 IoTDB 用户大会：天谋科技 Christofer Dutz《如何用Apache PLC4X构建极简工业数据采集》...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/595cb28247d0b8194d7f70a23b58b6b6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">详解SpringCloud微服务技术栈：Nacos配置管理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>