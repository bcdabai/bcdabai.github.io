<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>一文详解c&#43;&#43;的stl库中string、vector、list的使用和模拟实现 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="一文详解c&#43;&#43;的stl库中string、vector、list的使用和模拟实现" />
<meta property="og:description" content="提示：文章写完后，目录可以自动生成，如何生成可参考右边的帮助文档
文章目录 前言学习c&#43;&#43;,不能只满足于简单的使用，理解底层原理至关重要，今天这篇文章就简述一下string、vector、list的简单使用和模拟实现 一、string1、为何使用string2、简述string类3、string的简单使用（1）、构造，析构和运算符重载（2）其他接口（3）、迭代器小提一句 二、vector1、vector的简单介绍2.vector的使用（1）构造（2）迭代器的使用（3）空间相关的接口（4）vector的增删查改 3、迭代器失效问题 三、list1、list的简单介绍2、list的使用3、list的迭代器 四、模拟实现，了解底层1、成员变量（1）string（2）vector（3）list 2、构造，析构和赋值重载（1）string（2）vector（3）list 3、迭代器4、reserve和resize函数5、“查”操作6、插入和删除操作7、最后一点：反向迭代器 总结 前言 提示：这里可以添加本文要记录的大概内容：
学习c&#43;&#43;,不能只满足于简单的使用，理解底层原理至关重要，今天这篇文章就简述一下string、vector、list的简单使用和模拟实现 提示：以下是本篇文章正文内容，下面案例可供参考
一、string 1、为何使用string 在我的印象中，c语言也有字符串，标准库中也含有关于字符串的一些操作，那为何又要大费周章的搞一个string类呢。其实这些操作看似好用，其实危机四伏，str等函数是和字符串相分离的，极易造成越界访问等问题。
使用了string后，利用c&#43;&#43;一些重载等特性，可以很舒服的，安全的对字符串进行操作。
2、简述string类 c&#43;&#43;标准库中的string类是一种经过各种封装后得到的表示字符序列的类
它是basic_string的char类型实例化得到的
为何需要用一个模板来泛型表示出来呢，这就牵扯到不同编码规则的问题了，ascii编码中，一个byte可以表示256个英文字符，但在unicode中，所以字符都用两字节表示，这就说明了字符并不一定是char类型。
3、string的简单使用 （1）、构造，析构和运算符重载 构造函数最主要的有下面几个
构造一个空串
用c中的字符串来构造
拷贝构造：用一个已知的string对象去构造
int main() { string s(&#34;123&#34;); string s2(s); cout &lt;&lt; s &lt;&lt; endl; cout &lt;&lt; s2 &lt;&lt; endl; return 0; } 其他的构造函数都是比较少见的，需要用时查询相关资料即可，这里就不多赘述
析构函数
单纯的释放掉string占用的那一块空间即可
重载
类似相同的*&#43;&#43;、- -、-=等*操作均可通过直观感受快速使用出来
对于[]操作符也进行了重载，可读可写，因为重载时采取的是引用返回，当然，如果用const修饰以后就只能读了
（2）其他接口 首先就是size()和capacity()
这里推荐使用size()而不是length()，因为后续比如二叉树等就只能使用size(),尽量保持一致，size()的作用是求出字符串的长度，capacity()的作用是求出容量，也就是能存多少字符
resize()和reserve()
resize()的作用是改变字符的数量，如果是增加数量，可以用c来进行填充，如果没给c，则会用**‘\0’**来补，如果n的数量比capacty还要多，会直接报错吗？其实resize()还有扩容的能力，改变capacity的值，这就有点强买强卖的感觉了（狗头），其次还有n比size小的情况，为偷懒而生的c&#43;&#43;会直接改变size。
reserve()就比较老实了，会兢兢业业扩容，当然如果给的n小于capacity，老实人会不予理会。
clear()和empty()
这两个就比较简单了，一个是清空字符串（注意：容量是不变的，变得是size）
另一个是判断字符串是否为空串
append和push_back
append用于追加字符串，push_back后面追加一个字符
&#43;=可以简单，完美的替代这两位，因为&#43;=的底层就是以它们为基础的
c_str,find和substr" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/55425edd3a5c9b096263e89c50d1f81f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-18T17:17:59+08:00" />
<meta property="article:modified_time" content="2023-01-18T17:17:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">一文详解c&#43;&#43;的stl库中string、vector、list的使用和模拟实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>提示：文章写完后，目录可以自动生成，如何生成可参考右边的帮助文档</p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_7" rel="nofollow">前言</a></li><li><ul><li><a href="#cstringvectorlist_10" rel="nofollow">学习c++,不能只满足于简单的使用，理解底层原理至关重要，今天这篇文章就简述一下string、vector、list的简单使用和模拟实现</a></li></ul> 
  </li><li><a href="#string_15" rel="nofollow">一、string</a></li><li><ul><li><a href="#1string_17" rel="nofollow">1、为何使用string</a></li><li><a href="#2string_23" rel="nofollow">2、简述string类</a></li><li><a href="#3string_29" rel="nofollow">3、string的简单使用</a></li><li><ul><li><a href="#1_30" rel="nofollow">（1）、构造，析构和运算符重载</a></li><li><a href="#2_66" rel="nofollow">（2）其他接口</a></li><li><a href="#3_112" rel="nofollow">（3）、迭代器</a></li><li><a href="#_116" rel="nofollow">小提一句</a></li></ul> 
  </li></ul> 
  </li><li><a href="#vector_127" rel="nofollow">二、vector</a></li><li><ul><li><a href="#1vector_128" rel="nofollow">1、vector的简单介绍</a></li><li><a href="#2vector_134" rel="nofollow">2.vector的使用</a></li><li><ul><li><a href="#1_136" rel="nofollow">（1）构造</a></li><li><a href="#2_141" rel="nofollow">（2）迭代器的使用</a></li><li><a href="#3_149" rel="nofollow">（3）空间相关的接口</a></li><li><a href="#4vector_164" rel="nofollow">（4）vector的增删查改</a></li></ul> 
   </li><li><a href="#3_181" rel="nofollow">3、迭代器失效问题</a></li></ul> 
  </li><li><a href="#list_192" rel="nofollow">三、list</a></li><li><ul><li><a href="#1list_195" rel="nofollow">1、list的简单介绍</a></li><li><a href="#2list_197" rel="nofollow">2、list的使用</a></li><li><a href="#3list_210" rel="nofollow">3、list的迭代器</a></li></ul> 
  </li><li><a href="#_214" rel="nofollow">四、模拟实现，了解底层</a></li><li><ul><li><a href="#1_216" rel="nofollow">1、成员变量</a></li><li><ul><li><a href="#1string_218" rel="nofollow">（1）string</a></li><li><a href="#2vector_227" rel="nofollow">（2）vector</a></li><li><a href="#3list_240" rel="nofollow">（3）list</a></li></ul> 
   </li><li><a href="#2_265" rel="nofollow">2、构造，析构和赋值重载</a></li><li><ul><li><a href="#1string_266" rel="nofollow">（1）string</a></li><li><a href="#2vector_335" rel="nofollow">（2）vector</a></li><li><a href="#3list_416" rel="nofollow">（3）list</a></li></ul> 
   </li><li><a href="#3_485" rel="nofollow">3、迭代器</a></li><li><a href="#4reserveresize_540" rel="nofollow">4、reserve和resize函数</a></li><li><a href="#5_633" rel="nofollow">5、“查”操作</a></li><li><a href="#6_713" rel="nofollow">6、插入和删除操作</a></li><li><a href="#7_828" rel="nofollow">7、最后一点：反向迭代器</a></li></ul> 
  </li><li><a href="#_881" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_7"></a>前言</h2> 
<p><code>提示：这里可以添加本文要记录的大概内容：</code></p> 
<h3><a id="cstringvectorlist_10"></a>学习c++,不能只满足于简单的使用，理解底层原理至关重要，今天这篇文章就简述一下string、vector、list的简单使用和模拟实现</h3> 
<p><code>提示：以下是本篇文章正文内容，下面案例可供参考</code></p> 
<h2><a id="string_15"></a>一、string</h2> 
<h3><a id="1string_17"></a>1、为何使用string</h3> 
<p>在我的印象中，c语言也有字符串，标准库中也含有关于字符串的一些操作，那为何又要大费周章的搞一个string类呢。其实这些操作看似好用，其实危机四伏，str等函数是和字符串相分离的，极易造成越界访问等问题。</p> 
<p>使用了string后，利用c++一些重载等特性，可以很舒服的，安全的对字符串进行操作。</p> 
<h3><a id="2string_23"></a>2、简述string类</h3> 
<p>c++标准库中的string类是一种经过各种封装后得到的表示字符序列的类<br> <img src="https://images2.imgbox.com/26/80/nLBrna2a_o.png" alt="在这里插入图片描述"><br> 它是basic_string的char类型实例化得到的</p> 
<p>为何需要用一个模板来泛型表示出来呢，这就牵扯到不同编码规则的问题了，ascii编码中，一个byte可以表示256个英文字符，但在unicode中，所以字符都用两字节表示，这就说明了字符并不一定是char类型。</p> 
<h3><a id="3string_29"></a>3、string的简单使用</h3> 
<h4><a id="1_30"></a>（1）、构造，析构和运算符重载</h4> 
<p>构造函数最主要的有下面几个</p> 
<p><strong>构造一个空串</strong><br> <img src="https://images2.imgbox.com/9c/8a/dwg6rKE1_o.png" alt="在这里插入图片描述"><br> <strong>用c中的字符串来构造</strong><br> <img src="https://images2.imgbox.com/b7/ff/0XS7U2U1_o.png" alt="在这里插入图片描述"></p> 
<p><strong>拷贝构造：用一个已知的string对象去构造</strong><br> <img src="https://images2.imgbox.com/36/9e/wtk1dVM5_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	string <span class="token function">s</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	string <span class="token function">s2</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> s2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/76/fb/uREH1l8U_o.png" alt="在这里插入图片描述"><br> 其他的构造函数都是比较少见的，需要用时查询相关资料即可，这里就不多赘述<br> <img src="https://images2.imgbox.com/49/82/8vKorITb_o.png" alt="在这里插入图片描述"><br> <strong>析构函数</strong><br> 单纯的释放掉string占用的那一块空间即可</p> 
<p><strong>重载</strong><br> <img src="https://images2.imgbox.com/b0/5c/9WXxDGVH_o.png" alt="在这里插入图片描述"><br> 类似相同的*++、- -、-=等*操作均可通过直观感受快速使用出来</p> 
<p><img src="https://images2.imgbox.com/71/df/8KLp2MgT_o.png" alt="在这里插入图片描述"><br> 对于[]操作符也进行了重载，<strong>可读可写</strong>，因为重载时采取的是引用返回，当然，如果用<strong>const修饰以后就只能读了</strong></p> 
<h4><a id="2_66"></a>（2）其他接口</h4> 
<p><strong>首先就是size()和capacity()</strong><br> 这里推荐使用size()而不是length()，因为后续比如二叉树等就只能使用size(),尽量保持一致，<em><strong>size()的作用是求出字符串的长度</strong></em>，capacity()的作用是求出容量，也就是能存多少字符</p> 
<p><strong>resize()和reserve()</strong><br> <img src="https://images2.imgbox.com/15/6f/Ng9Gzt5k_o.png" alt="在这里插入图片描述"><br> resize()的作用是改变字符的数量，如果是增加数量，可以用c来进行填充，如果没给c，则会用**‘\0’**来补，如果n的数量比capacty还要多，会直接报错吗？<strong>其实resize()还有扩容的能力，改变capacity的值</strong>，这就有点强买强卖的感觉了（狗头），其次还有n比size小的情况，为偷懒而生的c++会直接改变size。</p> 
<p><img src="https://images2.imgbox.com/3b/e4/xLOTY4uy_o.png" alt="在这里插入图片描述"></p> 
<p>reserve()就比较老实了，会兢兢业业扩容，当然如果给的n小于capacity，老实人会不予理会。</p> 
<p><strong>clear()和empty()</strong><br> 这两个就比较简单了，一个是清空字符串（<strong>注意：容量是不变的，变得是size</strong>）<br> 另一个是判断字符串是否为空串</p> 
<p><strong>append和push_back</strong><br> <img src="https://images2.imgbox.com/ec/a4/6WLLGpmY_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/71/b2/nd6zwN0H_o.png" alt="在这里插入图片描述"><br> append用于追加字符串，push_back后面追加一个字符<br> +=可以简单，完美的替代这两位，因为+=的底层就是以它们为基础的</p> 
<p><strong>c_str,find和substr</strong><br> <img src="https://images2.imgbox.com/1f/d2/a128hd7W_o.png" alt="在这里插入图片描述"><br> c_str会返回一个c中const类型的字符串（const对象可以调用）<br> <img src="https://images2.imgbox.com/b3/20/0mdg5x0x_o.png" alt="在这里插入图片描述"></p> 
<p>find会重给的pos位置开始开始寻找，寻找到字符c的位置，并返回，如果给的是字符串，则返回字符串第一个字符的位置<br> <img src="https://images2.imgbox.com/56/d8/3TshiAKW_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/aa/4c/24ikXxxb_o.png" alt="在这里插入图片描述"></p> 
<p>substr是从pos位置开始，截取n个字符，并返回<br> <img src="https://images2.imgbox.com/3b/7b/4PcJiV98_o.png" alt="在这里插入图片描述"><br> <strong>operator&lt;&lt;,operator&gt;&gt;和getline</strong><br> string类不是内置类型，所以我们需要用重载来实现输入和输出<br> <img src="https://images2.imgbox.com/83/81/GJ2MDO9L_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8f/48/3QuxAxOa_o.png" alt="在这里插入图片描述"><br> 而这里为了不让输出变成str&lt;&lt;cout这中情况，我们一般使用类外函数来表示，或者是使用友元。</p> 
<p>而字符串的输入遇到’ ‘(空格）和’\n’会跳出，从而不能输入一整串字符。这里我们引用了一个函数getline<br> <img src="https://images2.imgbox.com/7a/d0/UDTpkze7_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/2d/9b/Q3Wikws3_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="3_112"></a>（3）、迭代器</h4> 
<p>在string对象里面，可以很方便的用[]和下标准确访问到需要的地方，但迭代器的重要性是毋庸置疑的，它是一个所以容器统一的访问接口，对于无法使用下表访问的（类如list）等至关重要，这里就不说了，下面和你们讲哈。</p> 
<h4><a id="_116"></a>小提一句</h4> 
<p>在不同的平台上，string的实现也大不相同。</p> 
<p>在vs中，string站28个字节，包括除了自己的size，capacity以及一个char类型的指针外，还有一个16字节的数组，在使用时，优先放在数组里面，超过容量再在堆上开辟出对应的空间，好处就是<strong>以空间换时间</strong></p> 
<p>而g++里面的string类只占四个字节的空间，只有一个指针，指向一个堆空间<br> 里面包括：<br> 空间总大小<br> 字符串有效长度<br> 引用计数<br> 指向堆上字符串的指针</p> 
<h2><a id="vector_127"></a>二、vector</h2> 
<h3><a id="1vector_128"></a>1、vector的简单介绍</h3> 
<p>1、vector是一个<strong>可变大小的类似数组的容器</strong>，在使用时，借用了泛型的模板来增加数组的兼容性。<br> 2、由于大小可变的缘故，在使用时不免出现容量不够的情况发生，针对这种情况，底层使用的方法是<strong>开辟一个更大的空间，然后将数据移到这个新空间里。</strong><br> 3、在扩容时，每个编译器处理时开辟的新空间大小都会有所不同，但都会<strong>预留一些空间以便再添加元素进来</strong>，而这个预留空间的尺度就要具体编译器具体拿捏了。<br> 4、由于它类似数组的这一特性，在访问元素时很轻松，<strong>尾删，尾插也很容易</strong>，但要是不在尾部进行删除时，由于vector是连续的，那么就需要将后面的元素往前面移动，“覆盖住”被删掉的元素，</p> 
<h3><a id="2vector_134"></a>2.vector的使用</h3> 
<h4><a id="1_136"></a>（1）构造</h4> 
<p><img src="https://images2.imgbox.com/2f/2d/8vdvzxVN_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b0/e5/GHIaSpD3_o.png" alt="在这里插入图片描述"><br> 文档中给出了包括无参构造，拷贝构造等四种构造方式，按需取用</p> 
<h4><a id="2_141"></a>（2）迭代器的使用</h4> 
<p>由于vector也通string一样可以通过[]和下标访问内容，但还是简单介绍一下它的迭代器<br> 由于泛型的需求，迭代器的定义也不止止局限在int*、char*，<strong>模板T的使用是很重要的。</strong><br> 迭代器的几个函数：<strong>begin()、end()、rbegin()、rend()。</strong><br> <strong>需要注意的有两点：</strong><br> 1、end（）返回的是最后一个的下一个的迭代器<br> 2、rbegin（）是最后一个元素，rend（）是第一个元素的前面一个。这里写到后面的反向迭代器时会重点强调。</p> 
<h4><a id="3_149"></a>（3）空间相关的接口</h4> 
<p>前面string的学习已经让我们对于一些简单的接口有了了解，下面列举出来就不多赘述了<br> size 数据的长度<br> capacity 容器的容量<br> empty 判空<br> resize 改变数据的长度<br> <img src="https://images2.imgbox.com/b9/fb/sHIgOq9T_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/48/46/UMowTKma_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/78/87/Mm4ti7zq_o.png" alt="在这里插入图片描述"><br> reserve 改变容量大小<br> <img src="https://images2.imgbox.com/89/4c/MrDoTZbe_o.png" alt="在这里插入图片描述"><br> 对于扩容有几点需要注意一下：<br> 1、扩容怎么扩？vs的底层设计是1.5倍的扩容，g++下是2倍的扩容。<br> 2、resize扩容后会初始化为0。<br> <img src="https://images2.imgbox.com/57/6e/ETgK1UPb_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="4vector_164"></a>（4）vector的增删查改</h4> 
<p><strong>push_back、pop_back</strong>尾插和尾删</p> 
<p><strong>insert和erase</strong><br> <img src="https://images2.imgbox.com/68/9d/hL9AEcFS_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6b/21/htRZAuqF_o.png" alt="在这里插入图片描述"><br> 这里要注意一个问题，平时我们弄删除和插入操作，都不会设置函数返回值，但这两个函数都返回了一个迭代器，这是为什么呢？这和我们下文会谈的迭代器失效有关</p> 
<p><strong>vector类内的swap函数</strong><br> <img src="https://images2.imgbox.com/e2/61/EN5Bcrpa_o.png" alt="在这里插入图片描述"><br> 为什么vector类不用库里的，而是自己在类内定义了一个呢？有大佬路过可以评论区探讨一下。</p> 
<p><strong>operator[]</strong><br> 既然可以将vector看作数组使用，那数组的访问方式当然是必不可少的。<br> 它可以直接有效的帮助我们不用迭代器的方式来访问容器内的元素</p> 
<h3><a id="3_181"></a>3、迭代器失效问题</h3> 
<p>迭代器的作用是提供一个统一的方法让我们去访问容器内的元素，其<strong>本质上就是一种指针</strong>，只不过有些容器的迭代器进行了<strong>封装</strong>，vector的迭代器底层其实就是一个T*。在进行某些操作时，会将某一块内存释放掉，但迭代器还指向了那一块内存，没有进行更改，从而导致程序崩溃的问题就是迭代器失效问题。下面这几种情况就有可能会造成迭代器失效<br> 1、对底层内存进行操作，如resize，push_back等。<br> <img src="https://images2.imgbox.com/20/53/FAUkLuE7_o.png" alt="在这里插入图片描述"><br> 比如对v进行resize（100）会导致扩容，而<strong>扩容的底层就是放弃原有空间，开辟了一块更大的空间</strong></p> 
<p>2、使用了erase函数<br> 按理说，erase函数删除对于元素后，其余元素会向前移动，不应该出现原空间释放的情况，但如果pos指向最后一个元素，删除后pos就指向了end，end位置没有元素，所以认为pos失效。基于此，<strong>vs上规定，删除任何位置后，erase都会失效。</strong>，所以我们回到上面的问题，为什么insert和erase会返回一个迭代器。查询相关资料，<strong>insert返回的是新地址的插入元素的迭代器，而erase返回的是删除元素的下一元素的迭代器</strong></p> 
<p>注：看到这里有人就开始疑惑，为什么不研究string的迭代器失效呢，这两容器不差不多嘛，这其实和他们给的函数参数有关，可以查一下文档看看，string给的参数都是什么，和vector有什么不同。</p> 
<h2><a id="list_192"></a>三、list</h2> 
<p><em>都坐稳了（狗头），文章较长，可以分次阅读</em></p> 
<h3><a id="1list_195"></a>1、list的简单介绍</h3> 
<p>list可以看作双向循环链表，在插入和删除上具有很高的效率，代价呢就是无法进行高效的随机访问，必须从头节点开始慢慢往后挪动。</p> 
<h3><a id="2list_197"></a>2、list的使用</h3> 
<p><img src="https://images2.imgbox.com/eb/21/eXJe9Lv6_o.png" alt="在这里插入图片描述"></p> 
<p>构造方法同上面两种相似</p> 
<p><strong>empty和size</strong><br> 一个是判空，一个是节点数量</p> 
<p><strong>front和back</strong><br> 返回第一个节点和最后一个节点<br> <img src="https://images2.imgbox.com/03/1c/aag5e0AJ_o.png" alt="在这里插入图片描述"><br> 使用方式和前面的vector基本相同。</p> 
<h3><a id="3list_210"></a>3、list的迭代器</h3> 
<p>不同的来了。<br> 我们前面讲到：迭代器的<strong>本质就是指针，只是有些进行了封装</strong>，比如list的迭代器，我们不能直接将其写成某种类型的指针，我们需要对这一个指针进行对应的封装，比如要重载它的**++运算符，解引用运算符**等，这个我们会在它的模拟实现上进行具体的实现和说明。</p> 
<h2><a id="_214"></a>四、模拟实现，了解底层</h2> 
<p>为了更好的去观察底层，我们将三个容器放一块对比学习（坐稳了哦）</p> 
<h3><a id="1_216"></a>1、成员变量</h3> 
<p>我们在模拟底层时可以根据这些容器的能力来类似出应该含有的成员变量</p> 
<h4><a id="1string_218"></a>（1）string</h4> 
<p>string和c中的字符串异曲同工，所以可以用一个<strong>指向字符串的指针</strong>来表示具体内容，为了更好的进行封装等功能，加上<strong>表示长度和容量的变量</strong></p> 
<pre><code class="prism language-cpp">		<span class="token keyword">char</span><span class="token operator">*</span> _str<span class="token punctuation">;</span>
		size_t _size<span class="token punctuation">;</span>
		size_t _capacity<span class="token punctuation">;</span>

</code></pre> 
<h4><a id="2vector_227"></a>（2）vector</h4> 
<p>相信很多人第一印象和我一样，开个T* 的指针指向数组元素，然后再加上长度和容量，但stl库中没有这样给（有知道为什么的大佬可以再评论区探讨一下）<br> 库中给的是三个指针，分别指向字符串开始，结束和总容器容量的结束位置</p> 
<pre><code class="prism language-cpp">		<span class="token keyword">typedef</span> T<span class="token operator">*</span> iterator<span class="token punctuation">;</span>
		<span class="token keyword">typedef</span> <span class="token keyword">const</span> T<span class="token operator">*</span> const_iterator<span class="token punctuation">;</span>
		
		iterator _start<span class="token punctuation">;</span>
		iterator _finish<span class="token punctuation">;</span>
		iterator _end_of_storage<span class="token punctuation">;</span>
</code></pre> 
<h4><a id="3list_240"></a>（3）list</h4> 
<p>list的成员函数很有趣，针对双向循环链表的功能，我们只给一个<strong>哨兵位的头节点</strong>，而<strong>节点位置</strong>就放在头节点的后面，利用<strong>指针来找到节点</strong>（这个节点的内容再用结构体来定义），最后再加上<strong>表示容量的变量</strong></p> 
<pre><code class="prism language-cpp">	<span class="token keyword">struct</span> <span class="token class-name">List_Node</span>
	<span class="token punctuation">{<!-- --></span>
		List_Node<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">*</span> _prev<span class="token punctuation">;</span>
		List_Node<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">*</span> _next<span class="token punctuation">;</span>
		T _data<span class="token punctuation">;</span>
		<span class="token function">List_Node</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> x<span class="token operator">=</span><span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token operator">:</span><span class="token function">_prev</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
			<span class="token punctuation">,</span><span class="token function">_next</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
			<span class="token punctuation">,</span><span class="token function">_data</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	
</code></pre> 
<pre><code class="prism language-cpp">		<span class="token keyword">typedef</span> List_Node<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> node<span class="token punctuation">;</span>
		node<span class="token operator">*</span> _head<span class="token punctuation">;</span>
		size_t _size<span class="token punctuation">;</span>
</code></pre> 
<h3><a id="2_265"></a>2、构造，析构和赋值重载</h3> 
<h4><a id="1string_266"></a>（1）string</h4> 
<p>string这需要注意的一个点就是用<strong>缺省参数</strong>来讲空初始化和字符串初始化结合起来</p> 
<pre><code class="prism language-cpp">		<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			_capacity <span class="token operator">=</span> _size<span class="token punctuation">;</span>
			_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p>然后就是简单的<strong>拷贝构造</strong>和<strong>析构函数</strong></p> 
<pre><code class="prism language-cpp">		<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>str<span class="token punctuation">.</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			_size <span class="token operator">=</span> str<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
			_capacity <span class="token operator">=</span> str<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>
			<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> str<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-cpp">		<span class="token operator">~</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span>
			_str <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
			_size <span class="token operator">=</span> _capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p>注意这里的拷贝构造是深拷贝，即**_str和str._str的元素相同，但是在堆上开辟的空间不同**，互不干扰。<br> 由于前面开辟空间时用的是new[]，析构时，也要用[]来delete。</p> 
<p>赋值重载也相同，注意避免浅拷贝的问题，还要注意释放掉原先的空间。当s1==s2时，我们直接返回s1。</p> 
<pre><code class="prism language-cpp">		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">!=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token function">strcpy</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span>
				_str <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
				_size <span class="token operator">=</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
				_capacity <span class="token operator">=</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p>以上的构造等等写法，还有更加“资本主义”的写法，就是利用已有的函数，创造一个中间人，然后讲中间人的东西都抢过来自己用，这里就拷贝构造举个例子</p> 
<pre><code class="prism language-cpp">		<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
		<span class="token operator">:</span><span class="token function">_str</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">,</span><span class="token function">_size</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">,</span><span class="token function">_capacity</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			string <span class="token function">tmp</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">swap</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p>这里的打工人虽然老实，但也不能随意欺负，所以在初始化列表位置给*this赋了一些值，来保证tmp不会生气，导致程序崩溃。</p> 
<h4><a id="2vector_335"></a>（2）vector</h4> 
<p><strong>构造函数</strong>还是很容易的</p> 
<pre><code class="prism language-cpp">		<span class="token function">vector</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token operator">:</span><span class="token function">_start</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
			<span class="token punctuation">,</span><span class="token function">_finish</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
			<span class="token punctuation">,</span><span class="token function">_end_of_storage</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

		<span class="token function">vector</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">,</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> val<span class="token operator">=</span><span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token operator">:</span><span class="token function">_start</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
			<span class="token punctuation">,</span> <span class="token function">_finish</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
			<span class="token punctuation">,</span> <span class="token function">_end_of_storage</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">push_back</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p><strong>析构</strong>也不难</p> 
<pre><code class="prism language-cpp">		<span class="token operator">~</span><span class="token function">vector</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _start<span class="token punctuation">;</span>
			_start <span class="token operator">=</span> _finish <span class="token operator">=</span> _end_of_storage <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p><strong>赋值重载</strong>呢这里用一种比较新的写法</p> 
<pre><code class="prism language-cpp">		<span class="token comment">//v1 = v2;</span>
		vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> v<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">swap</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p>这种写法的艺术成分很高啊！交换后的v由于是传值进来的，函数结束会直接调用析构删掉，活活“资本家”行为啊！！<br> 下面再说一个有意思的<strong>拷贝构造</strong><br> 还在用常规的写法，创造一个新的vector，将元素一个个放进去？这里还有打工人可以用！<br> 也是一种新的初始化方式：<strong>迭代器区间初始化</strong></p> 
<pre><code class="prism language-cpp">		<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">InputIterator</span><span class="token operator">&gt;</span>
		<span class="token function">vector</span><span class="token punctuation">(</span>InputIterator first<span class="token punctuation">,</span> InputIterator last<span class="token punctuation">)</span>
			<span class="token operator">:</span><span class="token function">_start</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
			<span class="token punctuation">,</span><span class="token function">_finish</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
			<span class="token punctuation">,</span><span class="token function">_end_of_storage</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>first <span class="token operator">!=</span> last<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">push_back</span><span class="token punctuation">(</span><span class="token operator">*</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
				first<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p>其原理就是利用了迭代器本质是指针的特性，将一段数据放进vector中，至于用模板来泛型化的原因呢。。<br> c++比起c语言的提升就是能够兼容，易于操作，这里的迭代器可以是<strong>任意容器的迭代器放进来，只要元素类型和vector相同</strong><br> 利用这种构造，一种很新的拷贝构造诞生了</p> 
<pre><code class="prism language-cpp">		<span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&amp;</span> v<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_start<span class="token punctuation">,</span> v<span class="token punctuation">.</span>_start<span class="token punctuation">)</span><span class="token punctuation">;</span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_finish<span class="token punctuation">,</span> v<span class="token punctuation">.</span>_finish<span class="token punctuation">)</span><span class="token punctuation">;</span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_end_of_storage<span class="token punctuation">,</span> v<span class="token punctuation">.</span>_end_of_storage<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token function">vector</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&amp;</span> v<span class="token punctuation">)</span>
			<span class="token operator">:</span><span class="token function">_start</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
			<span class="token punctuation">,</span> <span class="token function">_finish</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
			<span class="token punctuation">,</span> <span class="token function">_end_of_storage</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">tmp</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">swap</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p>这里的swap函数是为了<strong>深拷贝</strong>做考虑的。</p> 
<h4><a id="3list_416"></a>（3）list</h4> 
<p>由于list的构造常常用到这串代码</p> 
<pre><code class="prism language-cpp">		_head <span class="token operator">=</span> <span class="token keyword">new</span> node<span class="token punctuation">;</span>
		_head<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> _head<span class="token punctuation">;</span>
		_head<span class="token operator">-&gt;</span>_prev <span class="token operator">=</span> _head<span class="token punctuation">;</span>
		_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

</code></pre> 
<p>所以我们将其放在一个函数中，这样调用就很方便<br> 构造，拷贝构造和析构函数都和vector相差不大</p> 
<pre><code class="prism language-cpp">		<span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">empty_initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-cpp">		<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">InputIterator</span><span class="token operator">&gt;</span>
		<span class="token function">list</span><span class="token punctuation">(</span>InputIterator first<span class="token punctuation">,</span> InputIterator last<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">empty_initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>first <span class="token operator">!=</span> last<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">push_back</span><span class="token punctuation">(</span><span class="token operator">*</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token operator">++</span>first<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>list<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&amp;</span> it<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_head<span class="token punctuation">,</span> it<span class="token punctuation">.</span>_head<span class="token punctuation">)</span><span class="token punctuation">;</span>
			std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_size<span class="token punctuation">,</span> it<span class="token punctuation">.</span>_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token function">list</span><span class="token punctuation">(</span><span class="token keyword">const</span> list<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&amp;</span> it<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">empty_initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			list<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">tmp</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">swap</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

</code></pre> 
<p>由于list类内只存了_head，所以删除时需要<strong>遍历整个链表，删除每一个节点</strong></p> 
<pre><code class="prism language-cpp">		<span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			iterator it <span class="token operator">=</span> <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				it <span class="token operator">=</span> <span class="token function">erase</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token operator">~</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">delete</span> _head<span class="token punctuation">;</span>
			_head <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="3_485"></a>3、迭代器</h3> 
<p>string和vector的迭代器本身就是指针，分别是<strong>char* 和T</strong>*，原因是，它们本身顺序表的结构，简单的++和- -就能找到下一个元素。<br> <strong>那么list呢</strong>，它的本质是链表啊，数据的存储不是连续的。这里就要提到上面说过的封装问题。下面献上代码。</p> 
<pre><code class="prism language-cpp">	<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Ref</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Ptr</span><span class="token operator">&gt;</span>
	<span class="token keyword">struct</span> <span class="token class-name">_list_iterator</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">typedef</span> List_Node<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> node<span class="token punctuation">;</span>
		<span class="token keyword">typedef</span> _list_iterator<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> Ref<span class="token punctuation">,</span> Ptr<span class="token operator">&gt;</span> Self<span class="token punctuation">;</span>
		node<span class="token operator">*</span> _pnode<span class="token punctuation">;</span>
		<span class="token function">_list_iterator</span><span class="token punctuation">(</span>node<span class="token operator">*</span> p<span class="token punctuation">)</span>
			<span class="token operator">:</span><span class="token function">_pnode</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

		Ref <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _pnode<span class="token operator">-&gt;</span>_data<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		Ptr <span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token operator">&amp;</span>_pnode<span class="token operator">-&gt;</span>_data<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">//前置++和--;</span>
		Self<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_pnode <span class="token operator">=</span> _pnode<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		Self<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_pnode<span class="token operator">=</span>_pnode<span class="token operator">-&gt;</span>_prev<span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Self<span class="token operator">&amp;</span> it<span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _pnode <span class="token operator">==</span> it<span class="token punctuation">.</span>_pnode<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Self<span class="token operator">&amp;</span> it<span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _pnode <span class="token operator">!=</span> it<span class="token punctuation">.</span>_pnode<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

	<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> 
<p>可以看到模板给的**三个参数可以分别对应到&lt;T ,T&amp; ,T*&gt;（引用可以改变值）*<em>只要在用的时候传入进去就行<br> 并且这里的成员函数是node</em> _pnode，是一个指向节点的指针，进行简单的封装后，就可以和其他迭代器一样使用了。</p> 
<h3><a id="4reserveresize_540"></a>4、reserve和resize函数</h3> 
<p>这两个函数是vector和string这种顺序表结构所独有的，<br> <strong>string</strong>中</p> 
<pre><code class="prism language-cpp">		<span class="token keyword">void</span> <span class="token function">reserve</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token function">strcpy</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> _str<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span>
				_str <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
				_capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>

			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p>开空间（<strong>n+1的原因是预留一个位置存放’\0’</strong>），将原先的元素拷贝过去，删除原先的空间，更新capacity，一气呵成</p> 
<pre><code class="prism language-cpp">		<span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">,</span> <span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _size<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">reserve</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> _size<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					_str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				_size <span class="token operator">=</span> n<span class="token punctuation">;</span>
				_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span>
			<span class="token punctuation">{<!-- --></span>
				_str<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
				_size <span class="token operator">=</span> n<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p>resize需要注意几个点就行<br> 1、n和size的大小比较，这里复用了reserve将n与capacity的比较放到函数中去了。<br> 2、扩充的位置用ch来补充。</p> 
<p>对于<strong>vector</strong>呢，整体思路和string大同小异</p> 
<pre><code class="prism language-cpp">		<span class="token keyword">void</span> <span class="token function">reserve</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				size_t Old_Size <span class="token operator">=</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				T<span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> T<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>_start<span class="token punctuation">)</span><span class="token comment">//如果原来的不是空</span>
				<span class="token punctuation">{<!-- --></span>
					<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
					<span class="token punctuation">{<!-- --></span>
						tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> _start<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _start<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				_start <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
				_finish <span class="token operator">=</span> _start <span class="token operator">+</span> Old_Size<span class="token punctuation">;</span>
				_end_of_storage <span class="token operator">=</span> _start <span class="token operator">+</span> n<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p>由于后面有删除和修改_start的步骤，开始就先记录下size大小</p> 
<pre><code class="prism language-cpp">		<span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">,</span> T val <span class="token operator">=</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">reserve</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">while</span> <span class="token punctuation">(</span>_finish <span class="token operator">&lt;</span> _start <span class="token operator">+</span> n<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					<span class="token operator">*</span>_finish <span class="token operator">=</span> val<span class="token punctuation">;</span>
					<span class="token operator">++</span>_finish<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span>
			<span class="token punctuation">{<!-- --></span>
				_finish <span class="token operator">=</span> _start <span class="token operator">+</span> n<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

</code></pre> 
<p>需要注意的是是否需要扩容，在空间足够的情况下，只需要一个一个往后放val就行。</p> 
<h3><a id="5_633"></a>5、“查”操作</h3> 
<p><strong>string</strong>的查操作有通过[]访问，通过find函数找到对应的元素，这些都可以利用底层是字符串来解决</p> 
<pre><code class="prism language-cpp">		<span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> size_t pos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> _str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//常对象调用</span>
		<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> size_t pos<span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> _str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-cpp">		size_t <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> ch<span class="token punctuation">,</span> size_t pos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>_str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">==</span> ch<span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					<span class="token keyword">return</span> pos<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				pos<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> npos<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre> 
<p><strong>npos</strong>的值可以在类成员中定义一下<br> <img src="https://images2.imgbox.com/56/ad/N1gdU6f6_o.png" alt="在这里插入图片描述"></p> 
<p><strong>vector</strong>也可以通过迭代器和[]两种方法进行访问操作</p> 
<pre><code class="prism language-cpp">		T<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t x<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> _start<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-cpp">		iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _start<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _finish<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

</code></pre> 
<p><strong>注意这里的_finish是指向最后一个元素的下一个</strong></p> 
<p>而<strong>list</strong>呢，由于自身结构问题，只能通过迭代器进行访问</p> 
<pre><code class="prism language-cpp">		iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token function">iterator</span><span class="token punctuation">(</span>_head<span class="token operator">-&gt;</span>_next<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token function">iterator</span><span class="token punctuation">(</span>_head<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="6_713"></a>6、插入和删除操作</h3> 
<p>三个容器都是需要对数据进行这两个操作，只是操作的方式略有不同。<br> 首先是<strong>string和vector的插入操作</strong></p> 
<pre><code class="prism language-cpp">		<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">+</span> _size <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">reserve</span><span class="token punctuation">(</span>len <span class="token operator">+</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			size_t end <span class="token operator">=</span> _size <span class="token operator">+</span> len<span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>end <span class="token operator">&gt;</span> pos <span class="token operator">+</span> len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				_str<span class="token punctuation">[</span>end<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>end <span class="token operator">-</span> len<span class="token punctuation">]</span><span class="token punctuation">;</span>
				end<span class="token operator">--</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token function">strncpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> pos<span class="token punctuation">,</span> str<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
			_size <span class="token operator">+=</span> len<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

</code></pre> 
<pre><code class="prism language-cpp">		iterator <span class="token function">insert</span><span class="token punctuation">(</span>iterator pos<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> x<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _finish<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&gt;=</span> _start<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_finish <span class="token operator">==</span> _end_of_storage<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				size_t len <span class="token operator">=</span> pos <span class="token operator">-</span> _start<span class="token punctuation">;</span>
				size_t new_capacity <span class="token operator">=</span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> <span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
				<span class="token function">reserve</span><span class="token punctuation">(</span>new_capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
				pos <span class="token operator">=</span> _start <span class="token operator">+</span> len<span class="token punctuation">;</span><span class="token comment">//在扩容后迭代器会失效</span>
			<span class="token punctuation">}</span>
			iterator end <span class="token operator">=</span> _finish<span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>end <span class="token operator">&gt;</span> pos<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token operator">*</span>end <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>end <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token operator">--</span>end<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token operator">*</span>pos <span class="token operator">=</span> x<span class="token punctuation">;</span>
			_finish<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> pos<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

</code></pre> 
<p>判断插入位置，如果空间不够需要扩容，将位置后的元素往后移，在更新一下成员变量<br> 这边说一下string的插入中的<strong>strncpy函数</strong>，将str中的len个数据从_str+pos的位置开始复制上去，和strcpy的功能类似。<br> 其次是<strong>删除操作</strong></p> 
<pre><code class="prism language-cpp">		<span class="token keyword">void</span> <span class="token function">erase</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			size_t start <span class="token operator">=</span> pos<span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				_str<span class="token punctuation">[</span>start<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>start <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
				start<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-cpp">		iterator <span class="token function">erase</span><span class="token punctuation">(</span>iterator pos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _finish<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&gt;=</span> _start<span class="token punctuation">)</span><span class="token punctuation">;</span>
			iterator begin <span class="token operator">=</span> pos<span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>begin <span class="token operator">&lt;</span> _finish <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token operator">*</span>begin <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>begin <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token operator">++</span>begin<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			_finish<span class="token operator">--</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> pos<span class="token punctuation">;</span>

		<span class="token punctuation">}</span>
</code></pre> 
<p>需要移位置，所以<strong>中间和头部的插入删除的代价还是比较大的。</strong></p> 
<p><strong>list</strong>本身是双向循环链表，插入和删除操作只需要对<strong>一两个节点做出改变即可</strong>。</p> 
<pre><code class="prism language-cpp">		iterator <span class="token function">insert</span><span class="token punctuation">(</span>iterator pos<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> val<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			node<span class="token operator">*</span> new_node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">node</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
			node<span class="token operator">*</span> cur <span class="token operator">=</span> pos<span class="token punctuation">.</span>_pnode<span class="token punctuation">;</span>
			node<span class="token operator">*</span> prev <span class="token operator">=</span> pos<span class="token punctuation">.</span>_pnode<span class="token operator">-&gt;</span>_prev<span class="token punctuation">;</span>
			new_node<span class="token operator">-&gt;</span>_prev <span class="token operator">=</span> prev<span class="token punctuation">;</span>
			new_node<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> cur<span class="token punctuation">;</span>
			cur<span class="token operator">-&gt;</span>_prev <span class="token operator">=</span> new_node<span class="token punctuation">;</span>
			prev<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> new_node<span class="token punctuation">;</span>
			_size<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token function">iterator</span><span class="token punctuation">(</span>new_node<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		iterator <span class="token function">erase</span><span class="token punctuation">(</span>iterator pos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			node<span class="token operator">*</span> prev <span class="token operator">=</span> pos<span class="token punctuation">.</span>_pnode<span class="token operator">-&gt;</span>_prev<span class="token punctuation">;</span>
			node<span class="token operator">*</span> next <span class="token operator">=</span> pos<span class="token punctuation">.</span>_pnode<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
			prev<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> pos<span class="token punctuation">.</span>_pnode<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
			next<span class="token operator">-&gt;</span>_prev <span class="token operator">=</span> prev<span class="token punctuation">;</span>
			<span class="token keyword">delete</span> pos<span class="token punctuation">.</span>_pnode<span class="token punctuation">;</span>

			<span class="token operator">--</span>_size<span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token function">iterator</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</code></pre> 
<p>那么有了insert和erase后，push_back,pop_back这些函数都很简单了，对已有的进行复用即可。</p> 
<h3><a id="7_828"></a>7、最后一点：反向迭代器</h3> 
<p>反向迭代器是迭代器的一种在从后开始遍历较好时产生的一种类。没错，反向迭代器是将普通迭代器封装而产生的类。<br> 首先，为了兼容性，模板中的<strong>参数第一个便是放迭代器的</strong>，而后需要获得<strong>数据和对应的地址</strong>，我们在增加两个参数<br> <img src="https://images2.imgbox.com/6a/ab/1F3pYQc5_o.png" alt="在这里插入图片描述"><br> 在这个类里面，我们要实现反向迭代器++可以使得指向的元素向前移，- -向前移。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">Iterator</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Ref</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Ptr</span><span class="token operator">&gt;</span>
<span class="token keyword">class</span> <span class="token class-name">reverse_iterator</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">private</span><span class="token operator">:</span>
	Iterator _it<span class="token punctuation">;</span><span class="token comment">//对应类型的迭代器</span>
	<span class="token keyword">typedef</span> reverse_iterator<span class="token operator">&lt;</span>Iterator<span class="token punctuation">,</span> Ref<span class="token punctuation">,</span> Ptr<span class="token operator">&gt;</span> Self<span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">reverse_iterator</span><span class="token punctuation">(</span>Iterator it<span class="token punctuation">)</span>
		<span class="token operator">:</span><span class="token function">_it</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

	Self<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token operator">--</span>_it<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	Self<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token operator">++</span>_it<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	Ref <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		Iterator tmp <span class="token operator">=</span> _it<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">--</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	Ptr <span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Self<span class="token operator">&amp;</span> it1<span class="token punctuation">)</span> <span class="token keyword">const</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> _it <span class="token operator">!=</span> it1<span class="token punctuation">.</span>_it<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>很多人会好奇，为什么解引用后，返回的是指向位置的前一个位置。这里要从begin，rbegin，end，rend里面讨论了。<br> <img src="https://images2.imgbox.com/60/c2/dQecw1ox_o.png" alt="在这里插入图片描述"></p> 
<p>当开始时，<strong>反向迭代器指向最后一个元素的下一个位置</strong>，这是库里面规定的，我们只需要去了解并使用就行，不用可以造出不一样的东西。</p> 
<h2><a id="_881"></a>总结</h2> 
<p>这就是本文的全部内容啦，本人能力有限，非常欢迎路过的大佬指出错误<br> 最后，用一句话激励一下自己：<strong>只要我们能善用时间，就永远不愁时间不够用</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7bbc9fcddf61ac77c186fd0b9bb976ea/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">springboot整合quartz(集群环境)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/919c8f88d08c9d18dc556360d3f3b9a3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">怎么查看docker容器的ip</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>