<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>常见编码及乱码的处理 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="常见编码及乱码的处理" />
<meta property="og:description" content="常见编码及乱码的处理 常见编码及乱码的处理前言一、字符集与编码1、字符集简介2、ASCII编码3、Latin1字符集4、UTF-8编码5、字符集兼容性6、文件编码从哪看？ASCII码表 二、乱码1、文件乱码2、HTML乱码3、JSP乱码4、GET,POST请求乱码1）get提交2）post提交 5、URL包含特殊字符6、数据库乱码1、MySQL环境变量2、MySQL字符集3、MySQL字符集的设置4、MySQL字符集的转换过程5、MySQL乱码产生的原因6、编码无损转换 常见编码及乱码的处理 本文解决的问题
编码是什么字符是什么字符集是什么编码用在哪我们常出现的错误（乱码）怎么正确的使用编码 前言 我们日常接触到的文件分ASCII是“美国信息交换标准编码”的英文字头缩写，可称之为“美标”。美标规定了用从0到127的128个数字来代表信息的规范编码，其中包括33个控制码，一个空格码，和94个形象码。形象码中包括了英文大小写字母，阿拉伯数字，标点符号等。我们平时阅读的英文电脑文本，就是以形象码的方式传递和存储的。美标是国际上大部分大小电脑的通用编码。
然而电脑中的一个字符大都是用一个八位数的二进制数字表示。这样就有256个不同的数值，可以用来表示256个不同的字符。由于美标只规定了128个编码，剩下的另外128个数码没有规范，各家用法不一。另外美标中的33个控制码，各厂家用法也不尽一致。这样我们在不同电脑间交换文件的时候，就有必要区分两类不同的文件。第一类文件中每一个字都是美标形象码或空格码。这类文件称为“美标文本文件”(ASCII Text Files)，或略为“文本文件”，通常可在不同电脑系统间直接交换。第二类文件，也就是含有控制码或非美标码的文件，通常不能在不同电脑系统间直接交换。这类文件有一个通称，叫“二进制文件”(Binary Files)。
本文讨论的内容只在可读文本即ASCII系列
文章目录 常见编码及乱码的处理前言一、字符集与编码1、字符集简介2、ASCII编码3、Latin1字符集4、UTF-8编码5、字符集兼容性6、文件编码从哪看？ASCII码表 二、乱码1、文件乱码2、HTML乱码3、JSP乱码4、GET,POST请求乱码1）get提交2）post提交 5、URL包含特殊字符6、数据库乱码1、MySQL环境变量2、MySQL字符集3、MySQL字符集的设置4、MySQL字符集的转换过程5、MySQL乱码产生的原因6、编码无损转换 一、字符集与编码 1、字符集简介 **字符(Character)**是各种文字和符号的总称，包括各国家文字、标点符号、图形符号、数字等。
**字符集(Character set)**是多个字符的集合，字符集种类较多，每个字符集包含的字符个数不同，常见字符集名称：ASCII字符集、GB2312字符集、BIG5字符集、 GB18030字符集、Unicode字符集等。计算机要准确的处理各种字符集文字，需要进行字符编码，以便计算机能够识别和存储各种文字。
**字符编码（Character encoding）**是把字符集中的某个字符编码为指定字符集中字符，以便文本在计算机中存储和通过通信网络的传递。常见的例子包括将拉丁字母表编码成ASCII，ASCII将字母、数字和其它符号编号，并用7比特的二进制来表示。
**字符序 (collation)**是指同一个字符集内字符之间的比较规则。只有确定字符序后，才能在一个字符集上定义什么是等价的字符，以及字符之间的大小关系。一个字符可以包含多种字符序。MySQL字符序命名规则是：以字符序对应的字符集名称开头，以国家名居中(或以general居中)，以ci、cs、或bin结尾。以ci结尾的字符序表示大小写不敏感，以cs结尾的字符序表示大小写敏感，以bin结尾的字符序表示按二进制编码值比较。
2、ASCII编码 ASCII既是编码字符集，又是字符编码，ASCII直接将字符在编码字符集中的序号作为字符在计算机中存储从数值。
例如：在ASCII中A字符在表中排第65位，序号是65，而编码后A的数值是0100 0001，即十进制的65的二进制转换结果。
3、Latin1字符集 Latin1字符集在ASCII字符集基础上进行了扩展，仍然使用一个字节表示字符，但启用了高位，扩展了字符集的表示范围。
4、UTF-8编码 UTF-8（8-bit Unicode Transformation Format）是一种针对Unicode的可变长度字符编码，又称万国码。由Ken Thompson于1992年创建。现在已经标准化为RFC 3629。UTF-8用1到6个字节编码Unicode字符。
UTF-8是一种变长字节编码方式。对于某一个字符的UTF-8编码，如果只有一个字节则其最高二进制位为0；如果是多字节，其第一个字节从最高位开始，连续的二进制位值为1的个数决定了其编码的位数，其余各字节均以10开头。UTF-8最多可用到6个字节。 如表：
1字节 0xxxxxxx
2字节 110xxxxx 10xxxxxx
3字节 1110xxxx 10xxxxxx 10xxxxxx
4字节 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx
5字节 111110xx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx
6字节 1111110x 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c2dfdac75681c7e75b44b8ba1c01deed/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-11-20T17:31:10+08:00" />
<meta property="article:modified_time" content="2019-11-20T17:31:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">常见编码及乱码的处理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>常见编码及乱码的处理</h4> 
 <ul><li><a href="#_3" rel="nofollow">常见编码及乱码的处理</a></li><li><ul><li><a href="#_20" rel="nofollow">前言</a></li><li><a href="#_57" rel="nofollow">一、字符集与编码</a></li><li><ul><li><a href="#1_59" rel="nofollow">1、字符集简介</a></li><li><a href="#2ASCII_70" rel="nofollow">2、ASCII编码</a></li><li><a href="#3Latin1_75" rel="nofollow">3、Latin1字符集</a></li><li><a href="#4UTF8_79" rel="nofollow">4、UTF-8编码</a></li><li><a href="#5_92" rel="nofollow">5、字符集兼容性</a></li><li><a href="#6_106" rel="nofollow">6、文件编码从哪看？</a></li><li><a href="#ASCII_136" rel="nofollow">ASCII码表</a></li></ul> 
   </li><li><a href="#_278" rel="nofollow">二、乱码</a></li><li><ul><li><a href="#1_282" rel="nofollow">1、文件乱码</a></li><li><a href="#2HTML_312" rel="nofollow">2、HTML乱码</a></li><li><a href="#3JSP_352" rel="nofollow">3、JSP乱码</a></li><li><a href="#4GETPOST_386" rel="nofollow">4、GET,POST请求乱码</a></li><li><ul><li><a href="#1get_391" rel="nofollow">1）get提交</a></li><li><a href="#2post_463" rel="nofollow">2）post提交</a></li></ul> 
    </li><li><a href="#5URL_488" rel="nofollow">5、URL包含特殊字符</a></li><li><a href="#6_520" rel="nofollow">6、数据库乱码</a></li><li><ul><li><a href="#1MySQL_522" rel="nofollow">1、MySQL环境变量</a></li><li><a href="#2MySQL_554" rel="nofollow">2、MySQL字符集</a></li><li><a href="#3MySQL_569" rel="nofollow">3、MySQL字符集的设置</a></li><li><a href="#4MySQL_647" rel="nofollow">4、MySQL字符集的转换过程</a></li><li><a href="#5MySQL_659" rel="nofollow">5、MySQL乱码产生的原因</a></li><li><a href="#6_665" rel="nofollow">6、编码无损转换</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_3"></a>常见编码及乱码的处理</h2> 
<p><strong>本文解决的问题</strong></p> 
<ul><li>编码是什么</li><li>字符是什么</li><li>字符集是什么</li><li>编码用在哪</li><li>我们常出现的错误（乱码）</li><li>怎么正确的使用编码</li></ul> 
<h3><a id="_20"></a>前言</h3> 
<p>我们日常接触到的文件分<strong>ASCII</strong>是“美国信息交换标准编码”的英文字头缩写，可称之为“美标”。美标规定了用从0到127的128个数字来代表信息的规范编码，其中包括33个控制码，一个空格码，和94个形象码。形象码中包括了英文大小写字母，阿拉伯数字，标点符号等。我们平时阅读的英文电脑文本，就是以形象码的方式传递和存储的。美标是国际上大部分大小电脑的通用编码。</p> 
<p>然而电脑中的一个字符大都是用一个八位数的二进制数字表示。这样就有256个不同的数值，可以用来表示256个不同的字符。由于美标只规定了128个编码，剩下的另外128个数码没有规范，各家用法不一。另外美标中的33个控制码，各厂家用法也不尽一致。这样我们在不同电脑间交换文件的时候，就有必要区分两类不同的文件。第一类文件中每一个字都是美标形象码或空格码。这类文件称为“美标文本文件”(ASCII Text Files)，或略为“文本文件”，通常可在不同电脑系统间直接交换。第二类文件，也就是含有控制码或非美标码的文件，通常不能在不同电脑系统间直接交换。这类文件有一个通称，叫“<strong>二进制文件</strong>”(Binary Files)。</p> 
<p><img src="https://images2.imgbox.com/93/11/RWrWx8qg_o.png" alt="20191112140923.png"></p> 
<p>本文讨论的内容只在可读文本即<strong>ASCII</strong>系列</p> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_3" rel="nofollow">常见编码及乱码的处理</a></li><li><ul><li><a href="#_20" rel="nofollow">前言</a></li><li><a href="#_57" rel="nofollow">一、字符集与编码</a></li><li><ul><li><a href="#1_59" rel="nofollow">1、字符集简介</a></li><li><a href="#2ASCII_70" rel="nofollow">2、ASCII编码</a></li><li><a href="#3Latin1_75" rel="nofollow">3、Latin1字符集</a></li><li><a href="#4UTF8_79" rel="nofollow">4、UTF-8编码</a></li><li><a href="#5_92" rel="nofollow">5、字符集兼容性</a></li><li><a href="#6_106" rel="nofollow">6、文件编码从哪看？</a></li><li><a href="#ASCII_136" rel="nofollow">ASCII码表</a></li></ul> 
   </li><li><a href="#_278" rel="nofollow">二、乱码</a></li><li><ul><li><a href="#1_282" rel="nofollow">1、文件乱码</a></li><li><a href="#2HTML_312" rel="nofollow">2、HTML乱码</a></li><li><a href="#3JSP_352" rel="nofollow">3、JSP乱码</a></li><li><a href="#4GETPOST_386" rel="nofollow">4、GET,POST请求乱码</a></li><li><ul><li><a href="#1get_391" rel="nofollow">1）get提交</a></li><li><a href="#2post_463" rel="nofollow">2）post提交</a></li></ul> 
    </li><li><a href="#5URL_488" rel="nofollow">5、URL包含特殊字符</a></li><li><a href="#6_520" rel="nofollow">6、数据库乱码</a></li><li><ul><li><a href="#1MySQL_522" rel="nofollow">1、MySQL环境变量</a></li><li><a href="#2MySQL_554" rel="nofollow">2、MySQL字符集</a></li><li><a href="#3MySQL_569" rel="nofollow">3、MySQL字符集的设置</a></li><li><a href="#4MySQL_647" rel="nofollow">4、MySQL字符集的转换过程</a></li><li><a href="#5MySQL_659" rel="nofollow">5、MySQL乱码产生的原因</a></li><li><a href="#6_665" rel="nofollow">6、编码无损转换</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_57"></a>一、字符集与编码</h3> 
<h4><a id="1_59"></a>1、字符集简介</h4> 
<p>**字符(Character)**是各种文字和符号的总称，包括各国家文字、标点符号、图形符号、数字等。<br> **字符集(Character set)**是多个字符的集合，字符集种类较多，每个字符集包含的字符个数不同，常见字符集名称：ASCII字符集、GB2312字符集、BIG5字符集、 GB18030字符集、Unicode字符集等。计算机要准确的处理各种字符集文字，需要进行字符编码，以便计算机能够识别和存储各种文字。</p> 
<p>**字符编码（Character encoding）**是把字符集中的某个字符编码为指定字符集中字符，以便文本在计算机中存储和通过通信网络的传递。常见的例子包括将拉丁字母表编码成ASCII，ASCII将字母、数字和其它符号编号，并用7比特的二进制来表示。</p> 
<p>**字符序 (collation)**是指同一个字符集内字符之间的比较规则。只有确定字符序后，才能在一个字符集上定义什么是等价的字符，以及字符之间的大小关系。一个字符可以包含多种字符序。MySQL字符序命名规则是：以字符序对应的字符集名称开头，以国家名居中(或以general居中)，以ci、cs、或bin结尾。以ci结尾的字符序表示大小写不敏感，以cs结尾的字符序表示大小写敏感，以bin结尾的字符序表示按二进制编码值比较。</p> 
<h4><a id="2ASCII_70"></a>2、ASCII编码</h4> 
<p>ASCII既是编码字符集，又是字符编码，ASCII直接将字符在编码字符集中的序号作为字符在计算机中存储从数值。<br> 例如：在ASCII中A字符在表中排第65位，序号是65，而编码后A的数值是0100 0001，即十进制的65的二进制转换结果。</p> 
<h4><a id="3Latin1_75"></a>3、Latin1字符集</h4> 
<p>Latin1字符集在ASCII字符集基础上进行了扩展，仍然使用一个字节表示字符，但启用了高位，扩展了字符集的表示范围。</p> 
<h4><a id="4UTF8_79"></a>4、UTF-8编码</h4> 
<p>UTF-8（8-bit Unicode Transformation Format）是一种针对Unicode的可变长度字符编码，又称万国码。由Ken Thompson于1992年创建。现在已经标准化为RFC 3629。UTF-8用1到6个字节编码Unicode字符。<br> UTF-8是一种变长字节编码方式。对于某一个字符的UTF-8编码，如果只有一个字节则其最高二进制位为0；如果是多字节，其第一个字节从最高位开始，连续的二进制位值为1的个数决定了其编码的位数，其余各字节均以10开头。UTF-8最多可用到6个字节。 如表：<br> 1字节 0xxxxxxx<br> 2字节 110xxxxx 10xxxxxx<br> 3字节 1110xxxx 10xxxxxx 10xxxxxx<br> 4字节 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx<br> 5字节 111110xx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx<br> 6字节 1111110x 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx<br> 因此UTF-8中可以用来表示字符编码的实际位数最多有31位，即上表中x所表示的位。除去控制位（每字节开头的10等），x表示的位与UNICODE编码是一一对应的，位高低顺序也相同。<br> 实际将UNICODE转换为UTF-8编码时应先去除高位0，然后根据所剩编码的位数决定所需最小的UTF-8编码位数。 因此基本ASCII字符集中的字符（UNICODE兼容ASCII）只需要一个字节的UTF-8编码（7个二进制位）便可以表示。</p> 
<h4><a id="5_92"></a>5、字符集兼容性</h4> 
<p>对于中文字符来说，UTF-8、GBK、GB2312、BIG5四种编码之间是互不兼容的，直接相互转换会导致乱码；当UTF-8、GBK、GB2312、BIG5四种编码转换为ASCII编码和Latin1编码格式时，每个中文字符会被转换为0x3F，即中文字符’？’。<br> GB2312支持简体中文，BIG5支持繁体中文，GBK支持简体中文及繁体中文，UTF-8支持几乎所有字符。<br> GBK是国家标准GB2312基础上扩容后兼容GB2312的标准。GB2312是GBK的子集，GBK是GB18030的子集。</p> 
<p>GB编码标准中，比较常用的是GB2312和GBK两种，GB2312是GBK的一个子集，GB2312编码范围是 0xA1A1 - 0xFEFE ，如果纯粹的 GB2312编码，处理起来是十分简单的，但处理GBK字符集时有些小的提示，先说说GBK编码的标准吧：</p> 
<p>GBK 采用双字节表示，总体编码范围为 8140-FEFE，首字节在 81-FE 之间，尾字节在 40-FE 之间，剔除 xx7F 一条线。总计 23940 个码位，共收入 21886 个汉字和图形符号，其中汉字（包括部首和构件）21003 个，图形符号 883 个。</p> 
<h4><a id="6_106"></a>6、文件编码从哪看？</h4> 
<p>以notepad++ 为例</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-6en5xDiL-1574241894791)(https://i.loli.net/2019/11/12/kxESrPKRHlXATBY.png)]</p> 
<p>我们打开一个文本文件</p> 
<p><img src="https://images2.imgbox.com/93/3c/vOXIqRDL_o.png" alt="20191112140214.png"></p> 
<p>一般默认会指定一个正确的编码去读</p> 
<p><img src="https://images2.imgbox.com/40/06/3xspEP61_o.png" alt="20191112140331.png"></p> 
<p>如果我们以二进制的方式打开文件</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-fksApxjd-1574241894792)(https://i.loli.net/2019/11/12/aTyPWf2QOJcnrAx.png)]</p> 
<h4><a id="ASCII_136"></a>ASCII码表</h4> 
<table><thead><tr><th>二进制</th><th>十进制</th><th>十六进制</th><th>缩写</th><th>名称/意义</th></tr></thead><tbody><tr><td>0000 0000</td><td>0</td><td>0</td><td>NUL</td><td>空字符（Null）</td></tr><tr><td>0000 0001</td><td>1</td><td>1</td><td>SOH</td><td>标题开始</td></tr><tr><td>0000 0010</td><td>2</td><td>2</td><td>STX</td><td>本文开始</td></tr><tr><td>0000 0011</td><td>3</td><td>3</td><td>ETX</td><td>本文结束</td></tr><tr><td>0000 0100</td><td>4</td><td>4</td><td>EOT</td><td>传输结束</td></tr><tr><td>0000 0101</td><td>5</td><td>5</td><td>ENQ</td><td>请求</td></tr><tr><td>0000 0110</td><td>6</td><td>6</td><td>ACK</td><td>确认回应</td></tr><tr><td>0000 0111</td><td>7</td><td>7</td><td>BEL</td><td>响铃</td></tr><tr><td>0000 1000</td><td>8</td><td>8</td><td>BS</td><td>退格</td></tr><tr><td>0000 1001</td><td>9</td><td>9</td><td>HT</td><td>水平定位符号</td></tr><tr><td>0000 1010</td><td>10</td><td>0A</td><td>LF</td><td>换行键</td></tr><tr><td>0000 1011</td><td>11</td><td>0B</td><td>VT</td><td>垂直定位符号</td></tr><tr><td>0000 1100</td><td>12</td><td>0C</td><td>FF</td><td>换页键</td></tr><tr><td>0000 1101</td><td>13</td><td>0D</td><td>CR</td><td>归位键</td></tr><tr><td>0000 1110</td><td>14</td><td>0E</td><td>SO</td><td>取消变换（Shift out）</td></tr><tr><td>0000 1111</td><td>15</td><td>0F</td><td>SI</td><td>启用变换（Shift in）</td></tr><tr><td>0001 0000</td><td>16</td><td>10</td><td>DLE</td><td>跳出数据通讯</td></tr><tr><td>0001 0001</td><td>17</td><td>11</td><td>DC1</td><td>设备控制一（XON 启用软件速度控制）</td></tr><tr><td>0001 0010</td><td>18</td><td>12</td><td>DC2</td><td>设备控制二</td></tr><tr><td>0001 0011</td><td>19</td><td>13</td><td>DC3</td><td>设备控制三（XOFF 停用软件速度控制）</td></tr><tr><td>0001 0100</td><td>20</td><td>14</td><td>DC4</td><td>设备控制四</td></tr><tr><td>0001 0101</td><td>21</td><td>15</td><td>NAK</td><td>确认失败回应</td></tr><tr><td>0001 0110</td><td>22</td><td>16</td><td>SYN</td><td>同步用暂停</td></tr><tr><td>0001 0111</td><td>23</td><td>17</td><td>ETB</td><td>区块传输结束</td></tr><tr><td>0001 1000</td><td>24</td><td>18</td><td>CAN</td><td>取消</td></tr><tr><td>0001 1001</td><td>25</td><td>19</td><td>EM</td><td>连接介质中断</td></tr><tr><td>0001 1010</td><td>26</td><td>1A</td><td>SUB</td><td>替换</td></tr><tr><td>0001 1011</td><td>27</td><td>1B</td><td>ESC</td><td>跳出</td></tr><tr><td>0001 1100</td><td>28</td><td>1C</td><td>FS</td><td>文件分割符</td></tr><tr><td>0001 1101</td><td>29</td><td>1D</td><td>GS</td><td>组群分隔符</td></tr><tr><td>0001 1110</td><td>30</td><td>1E</td><td>RS</td><td>记录分隔符</td></tr><tr><td>0001 1111</td><td>31</td><td>1F</td><td>US</td><td>单元分隔符</td></tr><tr><td>0111 1111</td><td>127</td><td>7F</td><td>DEL</td><td>删除</td></tr></tbody></table> 
<table><thead><tr><th>二进制</th><th>十进制</th><th>十六进制</th><th>图形</th></tr></thead><tbody><tr><td>0010 0000</td><td>32</td><td>20</td><td>（空格）(␠)</td></tr><tr><td>0010 0001</td><td>33</td><td>21</td><td>!</td></tr><tr><td>0010 0010</td><td>34</td><td>22</td><td>"</td></tr><tr><td>0010 0011</td><td>35</td><td>23</td><td>#</td></tr><tr><td>0010 0100</td><td>36</td><td>24</td><td>$</td></tr><tr><td>0010 0101</td><td>37</td><td>25</td><td>%</td></tr><tr><td>0010 0110</td><td>38</td><td>26</td><td>&amp;</td></tr><tr><td>0010 0111</td><td>39</td><td>27</td><td>’</td></tr><tr><td>0010 1000</td><td>40</td><td>28</td><td>(</td></tr><tr><td>0010 1001</td><td>41</td><td>29</td><td>)</td></tr><tr><td>0010 1010</td><td>42</td><td>2A</td><td>*</td></tr><tr><td>0010 1011</td><td>43</td><td>2B</td><td>+</td></tr><tr><td>0010 1100</td><td>44</td><td>2C</td><td>,</td></tr><tr><td>0010 1101</td><td>45</td><td>2D</td><td>-</td></tr><tr><td>0010 1110</td><td>46</td><td>2E</td><td>.</td></tr><tr><td>0010 1111</td><td>47</td><td>2F</td><td>/</td></tr><tr><td>0011 0000</td><td>48</td><td>30</td><td>0</td></tr><tr><td>0011 0001</td><td>49</td><td>31</td><td>1</td></tr><tr><td>0011 0010</td><td>50</td><td>32</td><td>2</td></tr><tr><td>0011 0011</td><td>51</td><td>33</td><td>3</td></tr><tr><td>0011 0100</td><td>52</td><td>34</td><td>4</td></tr><tr><td>0011 0101</td><td>53</td><td>35</td><td>5</td></tr><tr><td>0011 0110</td><td>54</td><td>36</td><td>6</td></tr><tr><td>0011 0111</td><td>55</td><td>37</td><td>7</td></tr><tr><td>0011 1000</td><td>56</td><td>38</td><td>8</td></tr><tr><td>0011 1001</td><td>57</td><td>39</td><td>9</td></tr><tr><td>0011 1010</td><td>58</td><td>3A</td><td>:</td></tr><tr><td>0011 1011</td><td>59</td><td>3B</td><td>;</td></tr><tr><td>0011 1100</td><td>60</td><td>3C</td><td>&lt;</td></tr><tr><td>0011 1101</td><td>61</td><td>3D</td><td>=</td></tr><tr><td>0011 1110</td><td>62</td><td>3E</td><td>&gt;</td></tr><tr><td>0011 1111</td><td>63</td><td>3F</td><td>?</td></tr><tr><td>0100 0000</td><td>64</td><td>40</td><td>@</td></tr><tr><td>0100 0001</td><td>65</td><td>41</td><td>A</td></tr><tr><td>0100 0010</td><td>66</td><td>42</td><td>B</td></tr><tr><td>0100 0011</td><td>67</td><td>43</td><td>C</td></tr><tr><td>0100 0100</td><td>68</td><td>44</td><td>D</td></tr><tr><td>0100 0101</td><td>69</td><td>45</td><td>E</td></tr><tr><td>0100 0110</td><td>70</td><td>46</td><td>F</td></tr><tr><td>0100 0111</td><td>71</td><td>47</td><td>G</td></tr><tr><td>0100 1000</td><td>72</td><td>48</td><td>H</td></tr><tr><td>0100 1001</td><td>73</td><td>49</td><td>I</td></tr><tr><td>0100 1010</td><td>74</td><td>4A</td><td>J</td></tr><tr><td>0100 1011</td><td>75</td><td>4B</td><td>K</td></tr><tr><td>0100 1100</td><td>76</td><td>4C</td><td>L</td></tr><tr><td>0100 1101</td><td>77</td><td>4D</td><td>M</td></tr><tr><td>0100 1110</td><td>78</td><td>4E</td><td>N</td></tr><tr><td>0100 1111</td><td>79</td><td>4F</td><td>O</td></tr><tr><td>0101 0000</td><td>80</td><td>50</td><td>P</td></tr><tr><td>0101 0001</td><td>81</td><td>51</td><td>Q</td></tr><tr><td>0101 0010</td><td>82</td><td>52</td><td>R</td></tr><tr><td>0101 0011</td><td>83</td><td>53</td><td>S</td></tr><tr><td>0101 0100</td><td>84</td><td>54</td><td>T</td></tr><tr><td>0101 0101</td><td>85</td><td>55</td><td>U</td></tr><tr><td>0101 0110</td><td>86</td><td>56</td><td>V</td></tr><tr><td>0101 0111</td><td>87</td><td>57</td><td>W</td></tr><tr><td>0101 1000</td><td>88</td><td>58</td><td>X</td></tr><tr><td>0101 1001</td><td>89</td><td>59</td><td>Y</td></tr><tr><td>0101 1010</td><td>90</td><td>5A</td><td>Z</td></tr><tr><td>0101 1011</td><td>91</td><td>5B</td><td>[</td></tr><tr><td>0101 1100</td><td>92</td><td>5C</td><td>\</td></tr><tr><td>0101 1101</td><td>93</td><td>5D</td><td>]</td></tr><tr><td>0101 1110</td><td>94</td><td>5E</td><td>^</td></tr><tr><td>0101 1111</td><td>95</td><td>5F</td><td>_</td></tr><tr><td>0110 0000</td><td>96</td><td>60</td><td>`</td></tr><tr><td>0110 0001</td><td>97</td><td>61</td><td>a</td></tr><tr><td>0110 0010</td><td>98</td><td>62</td><td>b</td></tr><tr><td>0110 0011</td><td>99</td><td>63</td><td>c</td></tr><tr><td>0110 0100</td><td>100</td><td>64</td><td>d</td></tr><tr><td>0110 0101</td><td>101</td><td>65</td><td>e</td></tr><tr><td>0110 0110</td><td>102</td><td>66</td><td>f</td></tr><tr><td>0110 0111</td><td>103</td><td>67</td><td>g</td></tr><tr><td>0110 1000</td><td>104</td><td>68</td><td>h</td></tr><tr><td>0110 1001</td><td>105</td><td>69</td><td>i</td></tr><tr><td>0110 1010</td><td>106</td><td>6A</td><td>j</td></tr><tr><td>0110 1011</td><td>107</td><td>6B</td><td>k</td></tr><tr><td>0110 1100</td><td>108</td><td>6C</td><td>l</td></tr><tr><td>0110 1101</td><td>109</td><td>6D</td><td>m</td></tr><tr><td>0110 1110</td><td>110</td><td>6E</td><td>n</td></tr><tr><td>0110 1111</td><td>111</td><td>6F</td><td>o</td></tr><tr><td>0111 0000</td><td>112</td><td>70</td><td>p</td></tr><tr><td>0111 0001</td><td>113</td><td>71</td><td>q</td></tr><tr><td>0111 0010</td><td>114</td><td>72</td><td>r</td></tr><tr><td>0111 0011</td><td>115</td><td>73</td><td>s</td></tr><tr><td>0111 0100</td><td>116</td><td>74</td><td>t</td></tr><tr><td>0111 0101</td><td>117</td><td>75</td><td>u</td></tr><tr><td>0111 0110</td><td>118</td><td>76</td><td>v</td></tr><tr><td>0111 0111</td><td>119</td><td>77</td><td>w</td></tr><tr><td>0111 1000</td><td>120</td><td>78</td><td>x</td></tr><tr><td>0111 1001</td><td>121</td><td>79</td><td>y</td></tr><tr><td>0111 1010</td><td>122</td><td>7A</td><td>z</td></tr><tr><td>0111 1011</td><td>123</td><td>7B</td><td>{<!-- --></td></tr><tr><td>0111 1100</td><td>124</td><td>7C</td><td>|</td></tr><tr><td>0111 1101</td><td>125</td><td>7D</td><td>}</td></tr><tr><td>0111 1110</td><td>126</td><td>7E</td><td>~</td></tr></tbody></table> 
<h3><a id="_278"></a>二、乱码</h3> 
<h4><a id="1_282"></a>1、文件乱码</h4> 
<p>当使用编辑器打开文本文件时（如：txt、jsp、HTML、java、js、css……）发生乱码，可能是由于打开时使用了错误的字符集</p> 
<p>如下</p> 
<p><img src="https://images2.imgbox.com/ca/da/nLxgKizb_o.png" alt="20191113103700.png"></p> 
<p><strong>解决方案</strong></p> 
<p>切换正确的字符集即可</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-8yTMZYue-1574241894793)(https://i.loli.net/2019/11/13/EPZtvHOQzVI7Yum.png)]</p> 
<blockquote> 
 <p>也存在一种可能，文本写入时即发生乱码写入了错误的字符。此种方式不可逆，基本无法还原。所以，<strong>写入文本时一定确保写入的内容编码正确</strong></p> 
</blockquote> 
<h4><a id="2HTML_312"></a>2、HTML乱码</h4> 
<p><img src="https://images2.imgbox.com/32/b2/2zfOD8Zv_o.png" alt="20191112142930.png"></p> 
<p>检查浏览器使用的编码</p> 
<p><img src="https://images2.imgbox.com/a8/e4/OwL7mYgg_o.png" alt="20191112142826.png"></p> 
<p>查看源文件指定的字符集为UTF-8</p> 
<p><img src="https://images2.imgbox.com/ba/02/baWbxc9u_o.png" alt="20191112143402.png"></p> 
<p>指定浏览器编码</p> 
<p><img src="https://images2.imgbox.com/53/ce/cOuAgvs8_o.png" alt="20191112143049.png"></p> 
<p>** 解决方案**</p> 
<p>开发时HTML在<code>&lt;meta&gt;</code>中明确指定字符集</p> 
<h4><a id="3JSP_352"></a>3、JSP乱码</h4> 
<pre><code class="prism language-jsp">&lt;%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%&gt;

&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
        ...
    &lt;/head&gt;
    ...
&lt;/html&gt;
</code></pre> 
<p>JSP在部署后提供给用户使用，会经过<strong>三个阶段</strong>：</p> 
<ol><li>JSP生成java文件：这个阶段会使用pageEncoding所定义的编码格式进行转换</li><li>java文件生成class文件：这个阶段由服务器tomcat自动使用utf-8编码把java文件转换成字节码class文件</li><li>通过读取class文件展现给用户：这个阶段由tomcat服务器获取字节码内容，通过使用contentType所定义的编码格式展现给用户</li></ol> 
<p><img src="https://images2.imgbox.com/92/7e/alGJQozz_o.png" alt="20191112151803.png"></p> 
<p><strong>解决方案</strong></p> 
<p>请在各个环节指定正确的字符集，最好全部指定<code>utf-8</code></p> 
<p><img src="https://images2.imgbox.com/ce/4f/8CN3N9zo_o.png" alt="carbon (1).png"></p> 
<h4><a id="4GETPOST_386"></a>4、GET,POST请求乱码</h4> 
<p>form表单有两种方法把数据提交给服务器:</p> 
<h5><a id="1get_391"></a>1）get提交</h5> 
<p><img src="https://images2.imgbox.com/75/6a/VU0LlSRL_o.png" alt="20191120140024.png"></p> 
<p>get请求时，在前端URIEncode编码两次；</p> 
<p>容器接收时，默认ISO-8859-1解码一次；</p> 
<p>手动再解码一次。</p> 
<p>前端：</p> 
<pre><code class="prism language-javascript">url1<span class="token operator">=</span><span class="token function">encodeURI</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>   
url2<span class="token operator">=</span><span class="token function">encodeURI</span><span class="token punctuation">(</span>url1<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>后台：</p> 
<pre><code class="prism language-java">String name1<span class="token operator">=</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
String name2 <span class="token operator">=</span> java<span class="token punctuation">.</span>net<span class="token punctuation">.</span>URLDecoder<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>name1<span class="token punctuation">,</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> 
<p>不管容器用的什么编码，都不会有乱码：</p> 
<p>url1会把url中的中文编为ASCII码。</p> 
<p>url2对url1进行再编码，由于是对ASCII码进行编码，在request.getParameter(“name”)解码的时候，不管是按 GBK 还是 UTF-8 还是 ISO-8859-1 都好，都能够正确的得到url1。</p> 
<p>因为<strong>ASCII码用GBK、UTF-8、ISO-8859-1编码的结果是相同的</strong>。</p> 
<p>​ <strong>首先说下客户端（浏览器）的form表单用get方法是如何将数据编码后提交给服务器端的</strong>。</p> 
<p>​ 对于get方法来说，都是把数据串联在请求的url后面作为参数，如：<code>http://localhost:8080/servlet?msg=abc</code>（很常见的一个乱码问题就要出现了，如果url中出现中文或其它特殊字符的话，如：<code>http://localhost:8080/ /servlet?msg=南京</code>，服务器端容易得到乱码），url拼接完成后，浏览器会对url进行URL encode，然后发送给服务器，URL encode的过程就是把部分url做为字符，按照某种编码方式（如：utf-8,gbk等）编码成二进制的字节码，然后每个字节用一个包含3个字符的字符串 “%xy” 表示，其中xy为该字节的两位十六进制表示形式。具体介绍可以看下<code>java.net.URLEncoder</code>类的介绍。</p> 
<p>​ 了解了 URL encode的过程，我们能看到2个很重要的问题：</p> 
<p>​ 第一：需要URL encode的字符一般都是非ASCII的字符（笼统的讲），再通俗的讲就是除了英文字母以外的文字（如：中文，日文等）都要进行URL encode，所以对于我们来说，都是英文字母的url不会出现服务器得到乱码问题，出现乱码都是url里面带了中文或特殊字符造成的；</p> 
<p>​ 第二：URL encode到底按照那种编码方式对字符编码？这里就是浏览器的事情了，而且不同的浏览器有不同的做法，中文版的浏览器一般会默认的使用GBK，通过设置浏览器也可以使用UTF-8，可能不同的用户就有不同的浏览器设置，也就造成不同的编码方式，所以很多网站的做法都是先把url里面的中文或特殊字符用 javascript做URL encode，然后再拼接url提交数据，也就是替浏览器做了URL encode，好处就是网站可以统一get方法提交数据的编码方式。 完成了URL encode，那么现在的url就成了ASCII范围内的字符了，然后以iso-8859-1的编码方式转换成二进制随着请求头一起发送出去。这里想多说几句的是，对于get方法来说，没有请求实体，含有数据的url都在请求头里面，之所以用URL encode，我个人觉的原因是：对于请求头来说最终都是要用iso-8859-1编码方式编码成二进制的101010…的纯数据在互联网上传送，如果直接将含有中文等特殊字符做iso-8859-1编码会丢失信息，所以先做URL encode是有必要的。<br> <strong>服务器端（tomcat）是如何将数据获取到进行解码的。</strong><br> 第一步是先把数据用iso-8859-1进行解码，对于get方法来说，tomcat获取数据的是ASCII范围内的请求头字符，其中的请求url里面带有参数数据，如果参数中有中文等特殊字符，那么目前还是URL encode后的%XY状态，先停下，我们先说下开发人员一般获取数据的过程。通常大家都是request.getParameter(“name”)获取参数数据，我们在request对象或得的数据都是经过解码过的，而解码过程中程序里是无法指定，这里要说下，有很多新手说用 request.setCharacterEncoding(“字符集”)可以指定解码方式，其实是不可以的，看servlet的官方API说明有对此方法的解释：Overrides the name of the character encoding used in the body of this request. This method must be called prior to reading request parameters or reading input using getReader().可以看出对于get方法他是无能为力的。那么到底用什么编码方式解码数据的呢，这是tomcat的事情了，默认缺省用的是 iso-8859-1,这样我们就能找到为什么get请求带中文参数为什么在服务器端得到乱码了，原因是在客户端一般都是用UTF-8或GBK对数据 URL encode，这里用iso-8859-1方式URL decoder显然不行，在程序里我们可以直接</p> 
<p>Java代码</p> 
<pre><code class="prism language-java"><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">"iso-8859-1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"客户端指定的URL encode编码方式"</span><span class="token punctuation">)</span>
</code></pre> 
<p>还原回字节码，然后用正确的方式解码数据，通常是在tomcat里面做个配置<br> Xml代码</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Connector</span> <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>8080<span class="token punctuation">"</span></span> <span class="token attr-name">protocol</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>HTTP/1.1<span class="token punctuation">"</span></span> <span class="token attr-name">maxThreads</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>150<span class="token punctuation">"</span></span> <span class="token attr-name">connectionTimeout</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20000<span class="token punctuation">"</span></span> <span class="token attr-name">redirectPort</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>8443<span class="token punctuation">"</span></span> <span class="token attr-name">URIEncoding</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>GBK<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/42/a0/LEdTXtVQ_o.png" alt="20191113105344.png"></p> 
<p>这样是让tomcat在获取数据后用指定的方式URL decoder，URL decoder的介绍在这里</p> 
<p>http://blog.csdn.net/vickyway/article/details/46375971</p> 
<p>http://www.jb51.net/article/80181.htm</p> 
<h5><a id="2post_463"></a>2）post提交</h5> 
<p><img src="https://images2.imgbox.com/52/8e/i5bNsuDA_o.png" alt="20191120140007.png"></p> 
<p><strong>客户端（浏览器）的form表单用post方法是如何将数据编码后提交给服务器端的。</strong><br> 在post方法里所要传送的数据也要URL encode，那么他是用什么编码方式的呢？<br> 在form所在的html文件里如果有段<code>&lt;meta http-equiv="Content-Type" content="text/html; charset=字符集（GBK，utf-8等）"/&gt;</code>，那么post就会用此处指定的编码方式编码。一般大家都认为这段代码是为了让浏览器知道用什么字符集来对网页解释，所以网站都会把它放在html代码的最前端，尽量不出现乱码，其实它还有个作用就是指定form表单的post方法提交数据的 URL encode编码方式。从这里可以看出对于get方法来数，浏览器对数据的URL encode的编码方式是有浏览器设置来决定，（可以用js做统一指定），而post方法，开发人员可以指定。<br> <strong>服务器端（tomcat）是如何将数据获取到进行解码的。</strong><br> 如果用tomcat默认缺省设置，也没做过滤器等编码设置，那么他也是用iso-8859-1解码的，但是<code>request.setCharacterEncoding("字符集")</code>可以派上用场。</p> 
<p>我发现上面说的tomcat所做的事情前提都是在请求头里没有指定编码方式，如果请求头里指定了编码方式将按照这种方式编码。<br> 有2篇文章推荐下，地址分别是<br> 深入浅出URL编码：http://www.cnblogs.com/yencain/articles/1321386.html；<br> 表单用post方法提交数据时乱码问题：http://wanghuan8086.javaeye.com/blog/173869</p> 
<p>用post很重要的在form所在的html文件里如果有段<code>&lt;meta http-equiv="Content-Type" content="text/html; charset=字符集（GBK，utf-8等）"/&gt;</code><br> 强烈建议使用post提交</p> 
<blockquote> 
 <p>也可以通过base64编码传输，服务端base64解码拿到正确的字符</p> 
</blockquote> 
<h4><a id="5URL_488"></a>5、URL包含特殊字符</h4> 
<p>在HTTP请求时会遇到以下几种情况：</p> 
<ol><li>当字符串数据以url的形式传递给web服务器时，字符串中是不允许出现空格和特殊字符串的</li><li>url对字符有限制，比如把一个邮箱放入url，就需要使用urlencode函数。</li><li>url转义其实也只是为了符合url的规范而已。因为在标准的url规范中中文和很多的字符是不允许出现在url中的。</li></ol> 
<p><strong>解决方案</strong></p> 
<p>使用 <strong>urlencode</strong> (上文已介绍过)</p> 
<p>java：</p> 
<pre><code class="prism language-java">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span>URLEncoder<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">"要转码的内容"</span><span class="token punctuation">,</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 原来单参数方法已经过时。</span>
</code></pre> 
<p>javaScript:</p> 
<pre><code class="prism language-javascript"><span class="token function">encodeURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="6_520"></a>6、数据库乱码</h4> 
<h5><a id="1MySQL_522"></a>1、MySQL环境变量</h5> 
<p>Session会话变量：<br> 使用<code>show variables like '%char%';</code>可以查看Session会话的字符集变量：</p> 
<p><img src="https://images2.imgbox.com/86/fd/5P1WQbBe_o.png" alt="c600be454fc86ec01c6cb3f5c472b0a3.png"></p> 
<p><code>set character_set_server=utf8;</code><br> <code>set character_set_database=utf8;</code><br> 使用SET可以设置不同字符集。但是使用SET设置的字符集都是Session会话级别的，如果新打开一个会话，新会话使用的是默认的字符集。<br> Global全局变量：<br> 使用<code>show global variables like '%char%';</code>可以查看Global的字符集变量：</p> 
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ZLuomhT7-1574241894801)(https://i.loli.net/2019/11/12/AiQSf3M6umIK82O.png)]</p> 
<p><code>set global character_set_database=utf8;</code><br> <code>set global character_set_server=utf8;</code><br> 使用SET GLOBAL可以设置多个会话的字符集。<br> 使用<code>show charset;</code>查看MySQL支持的字符集和对应字符集的字符序。<br> MySQL服务重启后，Global的值会被重置为默认值。永久修改Global的值的方法如下：<br> 修改mysql配置文件<code>/etc/my.cnf</code>。</p> 
<pre><code class="prism language-properties">[mysqld]
character-set-server=utf8
[client]
default-character-set=utf8
[mysql]
default-character-set=utf8
</code></pre> 
<h5><a id="2MySQL_554"></a>2、MySQL字符集</h5> 
<p>MySQL服务器可以支持多种字符集，提供了不同级别的设置，包括server级、database级、table级、column级。<br> MySQL数据库的环境变量查看使用SQL语句<code>show variables like '%char%';</code><br> <strong>character_set_client</strong>：客户端使用的字符集，当客户端向服务器发送请求时，请求以客户端字符集进行编码。<br> <strong>character_set_connection</strong> ：客户端/数据库建立的通信连接使用的字符集，MySQL服务器接收客户端的查询请求后，将其转换为character_set_connection变量指定的字符集。<br> <strong>character_set_database</strong>：数据库服务器中某个数据库的字符集，如果没有默认数据库字符集，使用 <strong>character_set_server</strong>指定的字符集。<br> <strong>character_set_results</strong>：数据库给客户端返回时的字符集，MySQL数据库把结果集和错误信息转换为<strong>character_set_results</strong>指定的字符集，并发送给客户端。<br> <strong>character_set_server</strong>：数据库服务器的字符集，内部操作字符集。<br> <strong>character_set_system</strong>：系统元数据（字段名等）使用的字符集<br> 当客户端连接服务器的时候，客户端会将自己想要的字符集名称发给MySQL服务端，然后服务端就会使用字符集去设置character_set_connection、character_set_client、character_set_results。<br> 创建数据库时如果不指定数据库的字符集，默认会使用character_set_server字符集。<br> 创建表时如果不指定表的字符集，默认使用当前数据库字符集。<br> 创建列时如果不指定字符集，默认使用当前表的字符集。</p> 
<h5><a id="3MySQL_569"></a>3、MySQL字符集的设置</h5> 
<p><strong>A、MySQL服务器级字符集</strong><br> 修改MySQL服务器配置文件<code>/etc/my.cnf</code>文件。</p> 
<pre><code>[mysqld]
character_set_server=utf8
</code></pre> 
<p>重启MySQL数据库服务生效。<br> <strong>B、MySQL数据库级字符集：</strong><br> 创建数据库时指定：</p> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db_name
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token keyword">DEFAULT</span><span class="token punctuation">]</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> charset_name<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token keyword">DEFAULT</span><span class="token punctuation">]</span> <span class="token keyword">COLLATE</span> collation_name<span class="token punctuation">]</span>
</code></pre> 
<p>修改已有的数据库的字符集：</p> 
<pre><code class="prism language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> db_name
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token keyword">DEFAULT</span><span class="token punctuation">]</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> charset_name<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token keyword">DEFAULT</span><span class="token punctuation">]</span> <span class="token keyword">COLLATE</span> collation_name<span class="token punctuation">]</span>
</code></pre> 
<p>ALTER修改只对修改后在数据库上的操作有效。<br> <strong>C、MySQL表级字符集：</strong><br> 创建表时指定：</p> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tbl_name <span class="token punctuation">(</span>column_list<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token keyword">DEFAULT</span><span class="token punctuation">]</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> charset_name<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">COLLATE</span> collation_name<span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> 
<p>修改表的字符集：</p> 
<pre><code class="prism language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> tbl_name
<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token keyword">DEFAULT</span><span class="token punctuation">]</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> charset_name<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">COLLATE</span> collation_name<span class="token punctuation">]</span>
</code></pre> 
<p><strong>D、MySQL字段级字符集：</strong><br> 修改已有字段的字符集：</p> 
<pre><code class="prism language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">MODIFY</span>
column_name {<!-- --><span class="token keyword">CHAR</span> <span class="token operator">|</span> <span class="token keyword">VARCHAR</span> <span class="token operator">|</span> <span class="token keyword">TEXT</span>} <span class="token punctuation">(</span>column_length<span class="token punctuation">)</span>
  <span class="token punctuation">[</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> charset_name<span class="token punctuation">]</span>
  <span class="token punctuation">[</span><span class="token keyword">COLLATE</span> collation_name<span class="token punctuation">]</span>
</code></pre> 
<p>MySQL客户端设置：<code>set names utf8;</code>等价于：<br> <code>set character_set_client=utf8;</code><br> <code>set character_set_connection=utf8;</code><br> <code>set character_set_results=utf8;</code><br> <strong>E、客户端字符集</strong><br> 修改MySQL服务器配置文件<code>/etc/my.cnf</code>文件。</p> 
<pre><code>[client]
default-character-set=utf8
</code></pre> 
<p>等价于<code>set names utf8;</code><br> 会影响会话中的变量character_set_client，character_set_connection 和character_set_results的值。<br> 修改后无需重启MySQL数据库服务即可生效。</p> 
<h5><a id="4MySQL_647"></a>4、MySQL字符集的转换过程</h5> 
<p><img src="https://images2.imgbox.com/b1/af/84AWmMKI_o.png" alt="20191112175310.png"><br> A、MySQL服务端收到请求时将请求数据从character_set_client字符集转换为character_set_connection字符集。<br> B、进行内部操作前将请求数据从character_set_connection字符集转换为内部操作字符集。确定步骤：<br> –使用每个数据字段的CHARACTER SET设定值；<br> –若上述值不存在，则使用对应数据表的DEFAULT CHARACTER SET设定值；<br> –若上述值不存在，则使用对应数据库的DEFAULT CHARACTER SET设定值；<br> –若上述值不存在，则使用character_set_server字符集设定值；<br> C、将操作结果从内部操作字符集转换为character_set_results字符集。<br> D、将character_set_results字符集的执行结果转换为character_set_client字符集，发送到客户端，客户端使用设置的字符集展示结果。</p> 
<h5><a id="5MySQL_659"></a>5、MySQL乱码产生的原因</h5> 
<p>乱码产生的原因如下：<br> A、存入和取出时对应环节的编码不一致。<br> B、如果两个字符集之间无法进行无损编码转换，一定会出现乱码。</p> 
<h5><a id="6_665"></a>6、编码无损转换</h5> 
<p>如果一个使用编码A表示的字符X，转化为编码B的表示形式，而编码B的字符集中并没有X字符，则编码转换是有损的，否则编码转换就是无损的。<br> 由于每个字符集所支持的字符数量是有限的，并且各个字符集涵盖的字符之间存在差异。将UTF-8字符转换为GBK字符时，MySQL内部如果无法在GBK字符集找到一个UTF8字符集中的字符时，就会转换成一个错误标记（0x3F，问号）。<br> 编码无损转换的条件：<br> A、被转换的字符是否同时在两个字符集中。<br> B、目标字符集是否能够对不支持字符，保留其原有表达形式。</p> 
<p><strong>解决方案</strong></p> 
<p>从创建数据库，创建表到连接数据库全部指定统一字符集，并从一而终。</p> 
<hr> 
<p>©️ 框架组 <em>以上信息如有不足，请斧正 📧 mengfanding@aliyun.com</em></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8d2bf022ef20ecf11d6287df0ca00512/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python AVL树的插入</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0226013cca291424586d083b2ac1ecea/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MoveTask.</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>