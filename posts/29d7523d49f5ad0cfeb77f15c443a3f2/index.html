<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>同步FIFO - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="同步FIFO" />
<meta property="og:description" content="FIFO是（ first input first output）一般用作不同时钟域的缓冲器，顺序写入数据，顺序的读出数据，其数据地址由内部读写指针自动加一完成，根据读和写的时钟是否为同一时钟分为同步FIFO和异步FIFO。FIFO设计的难点在于怎样判断FIFO的空/满状态。为了保证数据正确的写入或读出，而不发生益处或读空的状态出现，必须保证FIFO在满的情况下，不 能进行写操作。在空的状态下不能进行读操作。典型的同步FIFO由三部分组成： FIFO写控制逻辑：用于产生FIFO写地址、写有效信号，同时产生FIFO写满、写错等状态信号。FIFO读控制逻辑：用于产生FIFO读地址、读有效信号，同时产生FIFO读空、读错等状态信号。FIFO存储实体（memory、reg） 结构图如下：
设计主要分为以下两部分：
读写过程的地址控制 定义reg来存储FIFO写数据，读数据。FIFO写操作：写地址加一。FIFO读操作：读地址加一。 空满状态的产生
引入计数器，count计数器存储FIFO数据的的个数。 写操作：count&#43;1。读操作 ：count-1。写满：count=fifo深度，写满为full。读空：count=0，读空为empty。 设计代码如下：
module syn_fifo ( input	clk; input	rst_n; input	wr_cs; input	wr_en; input [7:0]wr_data;	output	reg	full; input	rd_cs; input	dr_en; output [7:0]rd_data;	output	reg	empty; ); reg	[7:0]	wr_addr; reg	[7:0]	rd_addr; reg	[8:0]	count; reg	[7:0]	fifo_ram [255:0]; integer	i; //写数据 always@(posedge clk or negedge rst_n) begin if(!rst_n) begin for(i = 0; i &lt; 128;i = i &#43; 1) fifo_ram[i] &lt;= {8{1&#39;b0}}; end else if(wr_en&amp;&amp;(!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/29d7523d49f5ad0cfeb77f15c443a3f2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-12T09:32:29+08:00" />
<meta property="article:modified_time" content="2022-07-12T09:32:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">同步FIFO</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <ul><li>FIFO是（ first input first output）一般用作不同时钟域的缓冲器，顺序写入数据，顺序的读出数据，其数据地址由内部读写指针自动加一完成，根据读和写的时钟是否为同一时钟分为同步FIFO和异步FIFO。</li><li>FIFO设计的难点在于怎样判断FIFO的空/满状态。为了保证数据正确的写入或读出，而不发生益处或读空的状态出现，必须保证FIFO在满的情况下，不 能进行写操作。在空的状态下不能进行读操作。</li><li>典型的同步FIFO由三部分组成：</li></ul> 
<ol><li>FIFO写控制逻辑：用于产生FIFO写地址、写有效信号，同时产生FIFO写满、写错等状态信号。</li><li>FIFO读控制逻辑：用于产生FIFO读地址、读有效信号，同时产生FIFO读空、读错等状态信号。</li><li>FIFO存储实体（memory、reg）</li></ol> 
<p>结构图如下：<br> <img src="https://images2.imgbox.com/da/3c/ubvSqaKZ_o.png" alt="在这里插入图片描述"><br> 设计主要分为以下两部分：</p> 
<ul><li>读写过程的地址控制</li></ul> 
<ol><li>定义reg来存储FIFO写数据，读数据。</li><li>FIFO写操作：写地址加一。</li><li>FIFO读操作：读地址加一。</li></ol> 
<ul><li>空满状态的产生<br> 引入计数器，count计数器存储FIFO数据的的个数。</li></ul> 
<ol><li>写操作：count+1。</li><li>读操作 ：count-1。</li><li>写满：count=fifo深度，写满为full。</li><li>读空：count=0，读空为empty。</li></ol> 
<p>设计代码如下：</p> 
<pre><code class="prism language-c">module <span class="token function">syn_fifo</span>
<span class="token punctuation">(</span>
	input		clk<span class="token punctuation">;</span>
	input		rst_n<span class="token punctuation">;</span>

	input		wr_cs<span class="token punctuation">;</span>
	input		wr_en<span class="token punctuation">;</span>
	input  <span class="token punctuation">[</span><span class="token number">7</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>wr_data<span class="token punctuation">;</span>	
	output	reg	full<span class="token punctuation">;</span>

	input		rd_cs<span class="token punctuation">;</span>
	input		dr_en<span class="token punctuation">;</span>
	output  <span class="token punctuation">[</span><span class="token number">7</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>rd_data<span class="token punctuation">;</span>	
	output	reg	empty<span class="token punctuation">;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
	reg		<span class="token punctuation">[</span><span class="token number">7</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>	wr_addr<span class="token punctuation">;</span>
	reg		<span class="token punctuation">[</span><span class="token number">7</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>	rd_addr<span class="token punctuation">;</span>
	reg		<span class="token punctuation">[</span><span class="token number">8</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>	count<span class="token punctuation">;</span>
	reg		<span class="token punctuation">[</span><span class="token number">7</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span>	fifo_ram   <span class="token punctuation">[</span><span class="token number">255</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	integer	i<span class="token punctuation">;</span>
		
<span class="token comment">//写数据</span>
always@<span class="token punctuation">(</span>posedge clk or negedge rst_n<span class="token punctuation">)</span>
	begin
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span>
			begin
				<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">;</span>i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
					fifo_ram<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
			end
		<span class="token keyword">else</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>wr_en<span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token operator">!</span>full<span class="token punctuation">)</span><span class="token punctuation">)</span>
				fifo_ram<span class="token punctuation">[</span>wr_addr<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> wr_data<span class="token punctuation">;</span>
	end

<span class="token comment">//读数据</span>
always@<span class="token punctuation">(</span>posedge clk or negedge rst_n<span class="token punctuation">)</span>
	begin
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span>
			rd_data <span class="token operator">&lt;=</span> <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>rd_en<span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token operator">!</span>empty<span class="token punctuation">)</span><span class="token punctuation">)</span>
			rd_data <span class="token operator">&lt;=</span> fifo_ram<span class="token punctuation">[</span>rd_addr<span class="token punctuation">]</span><span class="token punctuation">;</span>
	end

<span class="token comment">//读写控制</span>
always@<span class="token punctuation">(</span>posedge clk or negedge rst_n<span class="token punctuation">)</span>
	begin
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span>
			wr_addr <span class="token operator">&lt;=</span> <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>wr_en<span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token operator">!</span>full<span class="token punctuation">)</span><span class="token punctuation">)</span>
			wr_addr <span class="token operator">&lt;=</span> wr_addr <span class="token operator">+</span><span class="token number">1</span>'b1<span class="token punctuation">;</span>
	end
always@<span class="token punctuation">(</span>posedge clk or negedge rst_n<span class="token punctuation">)</span>
	begin
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span>
			rd_addr <span class="token operator">&lt;=</span> <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b0<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>rd_en<span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token operator">!</span>empty<span class="token punctuation">)</span><span class="token punctuation">)</span>
			rd_addr <span class="token operator">&lt;=</span> rd_addr <span class="token operator">+</span><span class="token number">1</span>'b1<span class="token punctuation">;</span>
	end

<span class="token comment">//数据计数器  读一次减1，写一次加1</span>
always@<span class="token punctuation">(</span>posedge clk or negedge rst_n<span class="token punctuation">)</span>
	begin
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>rst_n<span class="token punctuation">)</span>
			count <span class="token operator">&lt;=</span> <span class="token number">9</span>'b0<span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>wr_en<span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token operator">!</span>full<span class="token punctuation">)</span><span class="token punctuation">)</span>
			count <span class="token operator">&lt;=</span> count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>rd_en<span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token operator">!</span>empty<span class="token punctuation">)</span><span class="token punctuation">)</span>
			count <span class="token operator">&lt;=</span> count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
	end
<span class="token comment">//空满判断</span>
assign	full <span class="token operator">=</span> <span class="token punctuation">(</span>count <span class="token operator">==</span> <span class="token punctuation">{<!-- --></span><span class="token number">8</span><span class="token punctuation">{<!-- --></span><span class="token number">1</span>'b1<span class="token punctuation">}</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assign	empty <span class="token operator">=</span> <span class="token punctuation">(</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
endmodule
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7a01da621edd40a12994314d49395fce/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">汉明距离（Hamming Distance）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0f11e226826a3266e936d64ed959c2a1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">单词环（图论、spfa找负环）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>