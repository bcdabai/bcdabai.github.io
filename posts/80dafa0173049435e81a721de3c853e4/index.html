<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>计算机视觉——相机模型与参数标定 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="计算机视觉——相机模型与参数标定" />
<meta property="og:description" content="目录
相机参数标定
一、相机内参矩阵原理
二、相机标定方法——张正友标定法
2.1方法描述
2.2计算内参和外参的初值
三、实验：Matlab实现
3.1实验数据
3.2实验过程
3.3实验结果
四、实验总结
相机参数标定 在拍摄中，相机可能会出现畸变，用软件的方法校正生成的图像，避免拍摄出的图像产生桶形和枕形畸变
不同的镜头的在生产和组装过程中的畸变程度各不相同，通过相机标定可以校正这种镜头畸变，生成矫正后的图像。
一、相机内参矩阵原理 设P=(X,Y,Z)为场景中的一点，在针孔相机模型中，其要经过以下几个变换，最终变为二维图像上的像点p=(μ,ν)
1、将P从世界坐标系通过刚体变换(旋转和平移)变换到相机坐标系，这个变换过程使用的是相机间的相对位姿，也就是相机的外参数。
2、从相机坐标系，通过透视投影变换到相机的成像平面上的像点p=(x,y)
3、将像点p从成像坐标系，通过缩放和平移变换到像素坐标系上点p=(μ,ν)
相机将场景中的三维点变换为图像中的二维点，也就是各个坐标系变换的组合，可将上面的变换过程整理为矩阵相乘的形式
二、相机标定方法——张正友标定法 2.1方法描述 使用棋盘格标定的方法，将照片中的三维信息压缩为二维（Z=0)
在张氏标定法中，用于标定的棋盘格是三维场景中的一个平面Π，其在成像平面的像是另一个平面π，知道了两个平面的对应点的坐标，就可以求解得到两个平面的单应矩阵H。其中，标定的棋盘格是特制的，其角点的坐标是已知的；图像中的角点，可以通过角点提取算法得到（如Harris角点），这样就可以得到棋盘平面Π和图像平面π的单应矩阵H。
方法步骤：
1、检测每张图片中的棋盘图案的角点；
2、利用解析解估算方法计算出5个内部参数，以及6个外部参数
3、通过基于极大似然准则的优化解,提高A，R，t矩阵的精度。
2.2计算内参和外参的初值 1、计算单应性矩阵H
棋盘格平面到图像平面的单应性关系为：
其中s为尺度因子，K为摄像机内参数，R为旋转矩阵，T为平移向量。令
s对于齐次坐标来说，不会改变齐次坐标值。张氏标定法中，将世界坐标系狗仔在棋盘格平面上，令棋盘格平面为Z=0的平面。则可得
我们把K[r1, r2, t]叫做单应性矩阵H，即
2、计算内参数矩阵
3、计算外参数矩阵
三、实验：Matlab实现 3.1实验数据 我准备了共20张的棋盘数据，在电脑上绘制黑白棋盘表格，并通过测量确定每个小正方格的长宽为 2.54厘米 ，然后再使用手机对棋盘进行拍摄，同时具有角度变换和距离变换等设置。
3.2实验过程 3.2.1实验要求
1.制作棋盘格（每个格子的大小可测量），最好是打印出来，贴在平面上（实在不行就用我刚才演示的黑白棋盘格方法）
2.根据棋盘格，采集10-20张图片，提取角点
3.解算出内外参数，内参截图放在博客中，外部参数最好能可视化
3.2.2标定步骤
3.2.3使用MATLAB自带的工具箱进行标定
MATLAB（matlab calibration toolbox-Matlab标定工具箱使用（单目标定和双目标定）
3.3实验结果 IntrinsicMatrix: [3x3 double] 内参矩阵
四、实验总结 1.Harris角点检测能够快速准确的检测到棋盘网格的边角，这对图像位置信息和空间坐标的标定参考提供了重要的数据。
2.在图片的分析当中，并不是所有拍摄的20张图片都被筛选进标定实验，其中很多不符合设置的，例如光线强度过大、角度变换过大等等影响到了角点检测和参数标定的图片都会被剔除，所以在一开始准备数据时就应该添加更多的图片以增加成功率，在本次实验中就被剔除了8张不合格的图片。
3.从最后的实验结果中，可以知道，我的手机相机的各种内部参数和外部参数。由于每部相机的生产过程当中，或多或少的都会产生一定的误差，而且这些误差也让每一部相机变得独一无二，所以每个人的相机参数都不会完全相同。
4.观察每张标定图可以发现，每张图中设置的X,Y和起始点设置都不是完全一样的，它会根据图片的旋转和角度等因素调整坐标系，说明图片的旋转和角度变换不会影响到标定结果。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/80dafa0173049435e81a721de3c853e4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-04-07T12:18:20+08:00" />
<meta property="article:modified_time" content="2020-04-07T12:18:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">计算机视觉——相机模型与参数标定</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E7%9B%B8%E6%9C%BA%E5%8F%82%E6%95%B0%E6%A0%87%E5%AE%9A-toc" style="margin-left:0px;"><a href="#%E7%9B%B8%E6%9C%BA%E5%8F%82%E6%95%B0%E6%A0%87%E5%AE%9A" rel="nofollow">相机参数标定</a></p> 
<p id="%E4%B8%80%E3%80%81%E7%9B%B8%E6%9C%BA%E5%86%85%E5%8F%82%E7%9F%A9%E9%98%B5%E5%8E%9F%E7%90%86-toc" style="margin-left:40px;"><a href="#%E4%B8%80%E3%80%81%E7%9B%B8%E6%9C%BA%E5%86%85%E5%8F%82%E7%9F%A9%E9%98%B5%E5%8E%9F%E7%90%86" rel="nofollow">一、相机内参矩阵原理</a></p> 
<p id="%E4%BA%8C%E3%80%81%E7%9B%B8%E6%9C%BA%E6%A0%87%E5%AE%9A%E6%96%B9%E6%B3%95%E2%80%94%E2%80%94%E5%BC%A0%E6%AD%A3%E5%8F%8B%E6%A0%87%E5%AE%9A%E6%B3%95-toc" style="margin-left:40px;"><a href="#%E4%BA%8C%E3%80%81%E7%9B%B8%E6%9C%BA%E6%A0%87%E5%AE%9A%E6%96%B9%E6%B3%95%E2%80%94%E2%80%94%E5%BC%A0%E6%AD%A3%E5%8F%8B%E6%A0%87%E5%AE%9A%E6%B3%95" rel="nofollow">二、相机标定方法——张正友标定法</a></p> 
<p id="2.1%E6%96%B9%E6%B3%95%E6%8F%8F%E8%BF%B0-toc" style="margin-left:80px;"><a href="#2.1%E6%96%B9%E6%B3%95%E6%8F%8F%E8%BF%B0" rel="nofollow">2.1方法描述</a></p> 
<p id="2.2%E8%AE%A1%E7%AE%97%E5%86%85%E5%8F%82%E5%92%8C%E5%A4%96%E5%8F%82%E7%9A%84%E5%88%9D%E5%80%BC-toc" style="margin-left:80px;"><a href="#2.2%E8%AE%A1%E7%AE%97%E5%86%85%E5%8F%82%E5%92%8C%E5%A4%96%E5%8F%82%E7%9A%84%E5%88%9D%E5%80%BC" rel="nofollow">2.2计算内参和外参的初值</a></p> 
<p id="%E4%B8%89%E3%80%81%E5%AE%9E%E9%AA%8C%EF%BC%9AMatlab%E5%AE%9E%E7%8E%B0-toc" style="margin-left:40px;"><a href="#%E4%B8%89%E3%80%81%E5%AE%9E%E9%AA%8C%EF%BC%9AMatlab%E5%AE%9E%E7%8E%B0" rel="nofollow">三、实验：Matlab实现</a></p> 
<p id="3.1%E5%AE%9E%E9%AA%8C%E6%95%B0%E6%8D%AE-toc" style="margin-left:80px;"><a href="#3.1%E5%AE%9E%E9%AA%8C%E6%95%B0%E6%8D%AE" rel="nofollow">3.1实验数据</a></p> 
<p id="3.2%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B-toc" style="margin-left:80px;"><a href="#3.2%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B" rel="nofollow">3.2实验过程</a></p> 
<p id="3.3%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C-toc" style="margin-left:80px;"><a href="#3.3%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C" rel="nofollow">3.3实验结果</a></p> 
<p id="%E5%9B%9B%E3%80%81%E5%AE%9E%E9%AA%8C%E6%80%BB%E7%BB%93-toc" style="margin-left:40px;"><a href="#%E5%9B%9B%E3%80%81%E5%AE%9E%E9%AA%8C%E6%80%BB%E7%BB%93" rel="nofollow">四、实验总结</a></p> 
<hr id="hr-toc"> 
<h2>相机参数标定</h2> 
<p>在拍摄中，相机可能会出现畸变，用软件的方法校正生成的图像，避免拍摄出的图像产生桶形和枕形畸变</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/e4/9c/3ibWjdvI_o.png"></p> 
<p>不同的镜头的在生产和组装过程中的畸变程度各不相同，通过相机标定可以校正这种镜头畸变，生成矫正后的图像。</p> 
<h3 id="%E4%B8%80%E3%80%81%E7%9B%B8%E6%9C%BA%E5%86%85%E5%8F%82%E7%9F%A9%E9%98%B5%E5%8E%9F%E7%90%86">一、相机内参矩阵原理</h3> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/a2/74/oWf2nMdH_o.png"></p> 
<p>设P=(X,Y,Z)为场景中的一点，在针孔相机模型中，其要经过以下几个变换，最终变为二维图像上的像点p=(μ,ν)<br> 1、将P从世界坐标系通过刚体变换(旋转和平移)变换到相机坐标系，这个变换过程使用的是相机间的相对位姿，也就是相机的外参数。<br> 2、从相机坐标系，通过透视投影变换到相机的成像平面上的像点p=(x,y)<br> 3、将像点p从成像坐标系，通过缩放和平移变换到像素坐标系上点p=(μ,ν)<br> 相机将场景中的三维点变换为图像中的二维点，也就是各个坐标系变换的组合，可将上面的变换过程整理为矩阵相乘的形式<br><img alt="在这里插入图片描述" src="https://images2.imgbox.com/71/17/DFGgPVRl_o.png"></p> 
<h3 id="%E4%BA%8C%E3%80%81%E7%9B%B8%E6%9C%BA%E6%A0%87%E5%AE%9A%E6%96%B9%E6%B3%95%E2%80%94%E2%80%94%E5%BC%A0%E6%AD%A3%E5%8F%8B%E6%A0%87%E5%AE%9A%E6%B3%95">二、<a name="t3"></a><a id="Recap__24"></a>相机标定方法——<a name="t4"></a><a id="_31"></a>张正友标定法</h3> 
<h4 id="2.1%E6%96%B9%E6%B3%95%E6%8F%8F%E8%BF%B0">2.1方法描述</h4> 
<p>使用棋盘格标定的方法，将照片中的三维信息压缩为二维（Z=0)<br> 在张氏标定法中，用于标定的棋盘格是三维场景中的一个平面Π，其在成像平面的像是另一个平面π，知道了两个平面的对应点的坐标，就可以求解得到两个平面的单应矩阵H。其中，标定的棋盘格是特制的，其角点的坐标是已知的；图像中的角点，可以通过角点提取算法得到（如Harris角点），这样就可以得到棋盘平面Π和图像平面π的单应矩阵H。<br><img alt="" height="753" src="https://images2.imgbox.com/4d/d9/LhS36ANt_o.png" width="742"></p> 
<p><strong>方法步骤：</strong><br> 1、检测每张图片中的棋盘图案的角点；<br> 2、利用解析解估算方法计算出5个内部参数，以及6个外部参数<br> 3、通过基于极大似然准则的优化解,提高A，R，t矩阵的精度。</p> 
<h4 id="2.2%E8%AE%A1%E7%AE%97%E5%86%85%E5%8F%82%E5%92%8C%E5%A4%96%E5%8F%82%E7%9A%84%E5%88%9D%E5%80%BC">2.2计算内参和外参的初值</h4> 
<p><strong>1、计算单应性矩阵H</strong><br> 棋盘格平面到图像平面的单应性关系为：</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/01/b3/ZcKsXjGP_o.png"></p> 
<p>其中s为尺度因子，K为摄像机内参数，R为旋转矩阵，T为平移向量。令</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/25/fd/WUUarUi3_o.png"></p> 
<p>s对于齐次坐标来说，不会改变齐次坐标值。张氏标定法中，将世界坐标系狗仔在棋盘格平面上，令棋盘格平面为Z=0的平面。则可得</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/7d/72/PDbalndL_o.png"></p> 
<p>我们把K[r1, r2, t]叫做单应性矩阵H，即</p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/47/2b/5kd90hdx_o.png"></p> 
<p><strong>2、计算内参数矩阵</strong></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/f9/cd/rjOimkYD_o.png"></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/4d/27/wTDH1hrC_o.png"></p> 
<p><strong>3、计算外参数矩阵</strong></p> 
<p><img alt="在这里插入图片描述" src="https://images2.imgbox.com/de/92/3GDuJs6t_o.png"></p> 
<h3 id="%E4%B8%89%E3%80%81%E5%AE%9E%E9%AA%8C%EF%BC%9AMatlab%E5%AE%9E%E7%8E%B0">三、实验：Matlab实现</h3> 
<h4 id="3.1%E5%AE%9E%E9%AA%8C%E6%95%B0%E6%8D%AE">3.1实验数据</h4> 
<p>       我准备了共20张的棋盘数据，在电脑上绘制黑白棋盘表格，并通过测量确定每个小正方格的长宽为 2.54厘米 ，然后再使用手机对棋盘进行拍摄，同时具有角度变换和距离变换等设置。</p> 
<p><img alt="" height="594" src="https://images2.imgbox.com/f6/7c/SvphK6iQ_o.png" width="951"></p> 
<h4 id="3.2%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B">3.2实验过程</h4> 
<p><strong>3.2.1实验要求</strong><br> 1.制作棋盘格（每个格子的大小可测量），最好是打印出来，贴在平面上（实在不行就用我刚才演示的黑白棋盘格方法）<br> 2.根据棋盘格，采集10-20张图片，提取角点<br> 3.解算出内外参数，内参截图放在博客中，外部参数最好能可视化</p> 
<p><strong>3.2.2标定步骤</strong></p> 
<p><img alt="" height="759" src="https://images2.imgbox.com/74/f2/I7P9yPIh_o.png" width="1200"></p> 
<p><strong>3.2.3使用MATLAB自带的工具箱进行标定</strong></p> 
<blockquote> 
 <p>MATLAB（matlab calibration toolbox-Matlab标定工具箱使用（单目标定和双目标定）</p> 
</blockquote> 
<p><img alt="" height="907" src="https://images2.imgbox.com/ec/c7/0s8mqyeL_o.png" width="1200"></p> 
<p><img alt="" height="760" src="https://images2.imgbox.com/e1/61/mOpSeRsT_o.png" width="1200"></p> 
<h4 id="3.3%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C">3.3实验结果</h4> 
<p><img alt="" height="240" src="https://images2.imgbox.com/77/de/OMnOV9Tw_o.png" width="308"></p> 
<p><img alt="" height="240" src="https://images2.imgbox.com/b5/f0/QEhKWy1F_o.png" width="298"></p> 
<p><img alt="" height="393" src="https://images2.imgbox.com/9a/f9/4IIv3QII_o.png" width="283"></p> 
<p><img alt="" height="634" src="https://images2.imgbox.com/44/49/x5R5Y0wS_o.png" width="682"></p> 
<p><strong>IntrinsicMatrix: [3x3 double] 内参矩阵</strong></p> 
<p><img alt="" height="128" src="https://images2.imgbox.com/da/60/YeIfNycB_o.png" width="375"></p> 
<p> </p> 
<h3 id="%E5%9B%9B%E3%80%81%E5%AE%9E%E9%AA%8C%E6%80%BB%E7%BB%93">四、实验总结</h3> 
<blockquote> 
 <p>1.Harris角点检测能够快速准确的检测到棋盘网格的边角，这对图像位置信息和空间坐标的标定参考提供了重要的数据。</p> 
 <p>2.在图片的分析当中，并不是所有拍摄的20张图片都被筛选进标定实验，其中很多不符合设置的，例如光线强度过大、角度变换过大等等影响到了角点检测和参数标定的图片都会被剔除，所以在一开始准备数据时就应该添加更多的图片以增加成功率，在本次实验中就被剔除了8张不合格的图片。</p> 
 <p>3.从最后的实验结果中，可以知道，我的手机相机的各种内部参数和外部参数。由于每部相机的生产过程当中，或多或少的都会产生一定的误差，而且这些误差也让每一部相机变得独一无二，所以每个人的相机参数都不会完全相同。</p> 
 <p>4.观察每张标定图可以发现，每张图中设置的X,Y和起始点设置都不是完全一样的，它会根据图片的旋转和角度等因素调整坐标系，说明图片的旋转和角度变换不会影响到标定结果。</p> 
</blockquote> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/09c62078be7f56cc3de8d30bb8d41c32/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mycat 添加数据时报错主键已存在(duplicate entry &#39;22&#39; for key &#39;PRIMARY&#39;)问题解决</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1f76b9d8aa7a7fe8142dc5ca4adf46ce/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">js小数的取舍处理</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>