<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>flutter 安装部署及开发问题总结 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="flutter 安装部署及开发问题总结" />
<meta property="og:description" content="flutter 安装部署问题总结
1、Mac版本下安装cocoapods，主要原因是rvm没有安装，ruby没有选择使用
\curl -sSL https://get.rvm.io | bash -s stable
出现长时间打不开，安装GPG等密钥工具，导入密码后也无法安装，首先检查https://get.rvm.io网址是否可访问，不可访问就没有办法。
解决方法：
curl -sSL https://github.com/rvm/rvm/tarball/stable -o rvm-stable.tar.gz
tar -xzvf rvm-stable.tar.gz
cd rvm-rvm-6bfc921/
./install --auto-dotfiles
source /Users/zhangjianyong/.rvm/scripts/rvm
rvm install 2.7.2
rvm use 2.7.2
sudo gem install cocoapods
2、如果出现No devices available
配置sdk位置
flutter config --android-sdk /Users/zhangjianyong/Library/Android/sdk
重启Android Studio 即可
3、flutter 如果使用Provider 进行状态管理。一定分好层，否则会监测不到。
@override Widget build(BuildContext context) { return Scaffold( body: Container( margin: EdgeInsets.only(top: 0), color: Colors.white, child: ChangeNotifierProvider&lt;CustomerFeeInfoNotefier&gt;.value( value: mCustomerFeeInfoNotefier, child: Column( children: [ Consumer&lt;CustomerFeeInfoNotefier&gt;( builder: (context, textValueAvaliableNotifier, child) { return __renderList(mCustomerFeeInfoNotefier); }) ], )))); } 4、在使用flutter调试支付宝时，由于大部分第三方插件不支持沙箱支付，需要修改源码。以flutter_alipay为例，需要在flutter的sdk下找到FlutterAlipayPlugin." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/75c705ee1ca963564812a0a39ecfbfdb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-12T12:48:04+08:00" />
<meta property="article:modified_time" content="2021-02-12T12:48:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">flutter 安装部署及开发问题总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>flutter 安装部署问题总结</p> 
<p>1、Mac版本下安装cocoapods，主要原因是rvm没有安装，ruby没有选择使用</p> 
<p> \curl -sSL <a href="https://get.rvm.io/" rel="nofollow">https://get.rvm.io</a> | bash -s stable</p> 
<p>出现长时间打不开，安装GPG等密钥工具，导入密码后也无法安装，首先检查<a href="https://get.rvm.io/" rel="nofollow">https://get.rvm.io</a>网址是否可访问，不可访问就没有办法。</p> 
<p>解决方法：</p> 
<p>curl -sSL https://github.com/rvm/rvm/tarball/stable -o rvm-stable.tar.gz</p> 
<p>tar -xzvf rvm-stable.tar.gz</p> 
<p>cd rvm-rvm-6bfc921/</p> 
<p>./install --auto-dotfiles</p> 
<p>source /Users/zhangjianyong/.rvm/scripts/rvm</p> 
<p>rvm install 2.7.2</p> 
<p>rvm use 2.7.2</p> 
<p>sudo gem install cocoapods</p> 
<p>2、如果出现<strong>No devices available</strong></p> 
<p><img alt="" height="103" src="https://images2.imgbox.com/bf/df/orhC7TyJ_o.png" width="553"></p> 
<p>配置sdk位置</p> 
<p>flutter config --android-sdk  /Users/zhangjianyong/Library/Android/sdk</p> 
<p>重启Android Studio 即可</p> 
<p>3、flutter 如果使用Provider 进行状态管理。一定分好层，否则会监测不到。</p> 
<pre><code>@override
  Widget build(BuildContext context) {
    return Scaffold(
        body: Container(
            margin: EdgeInsets.only(top: 0),
            color: Colors.white,
            child: ChangeNotifierProvider&lt;CustomerFeeInfoNotefier&gt;.value(
                value: mCustomerFeeInfoNotefier,
                child: Column(
                  children: [
                    Consumer&lt;CustomerFeeInfoNotefier&gt;(
                        builder: (context, textValueAvaliableNotifier, child) {
                      return __renderList(mCustomerFeeInfoNotefier);
                    })
                  ],
                ))));
  }</code></pre> 
<p>4、在使用flutter调试支付宝时，由于大部分第三方插件不支持沙箱支付，需要修改源码。以flutter_alipay为例，需要在flutter的sdk下找到FlutterAlipayPlugin.java源文件，参考路径：flutter-sdk根目录（个人安装的）/.pub-cache/hosted/pub.flutter-io.cn/flutter_alipay-1.0.0/android/src/main/java/org/zoomdev/flutter/alipay。<br> 中增加沙箱环境支持。EnvUtils.setEnv(EnvUtils.EnvEnum.SANDBOX);</p> 
<pre><code>public static void pay(final Activity currentActivity, final String payInfo, final Result callback){

    new AsyncTask&lt;String,Object,Map&lt;String,String&gt;&gt;(){

      @Override
      protected Map&lt;String, String&gt; doInBackground(String... strings) {
        try{
          PayTask alipay = new PayTask(currentActivity);
          EnvUtils.setEnv(EnvUtils.EnvEnum.SANDBOX);
          Map&lt;String, String&gt; result = alipay.payV2(payInfo, true);
          return result;
        }catch (Exception e){
          Map&lt;String,String&gt; result = new HashMap&lt;&gt;();
          result.put("$error",e.getMessage());

          return result;
        }
      }</code></pre> 
<p>5、flutter 调用高德地图。</p> 
<p>组件引用后一定在你的application/android/app/build.gradle中引入lib,否则会出现lcom/amap/api/maps/amapoptions等类没有找到</p> 
<pre><code class="language-java">dependencies {
    .....
    implementation('com.amap.api:3dmap:7.7.0')
}</code></pre> 
<p>6.flutter 调用定位组件后，按官方文档需要“implementation fileTree(include: ['*.jar'], dir: 'libs')”</p> 
<p>会和地图组件冲突，出现错误 More than one file was found with OS independent path 'assets/ap1.data'</p> 
<p>应修改为：implementation fileTree(include: ['AMap_Location_V5.3.1_20210331.jar'], dir: 'libs')</p> 
<p>原因：地图jar包重复导入。</p> 
<p>7.amap_flutter_location 2.0.0 中出现定位权限被禁用，AndroidManifest.xml中一定是8个权限，网上有帖子是6个造成</p> 
<p>&lt;uses-permission android:name="android.permission.INTERNET" /&gt;</p> 
<p>&lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /&gt;</p> 
<p>&lt;uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" /&gt;</p> 
<p>&lt;uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /&gt;</p> 
<p>&lt;uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" /&gt;</p> 
<p>&lt;uses-permission android:name="android.permission.READ_PHONE_STATE" /&gt;</p> 
<p>&lt;uses-permission android:name="android.permission.CHANGE_WIFI_STATE" /&gt;</p> 
<p>&lt;uses-permission android:name="android.permission.ACCESS_WIFI_STATE" /&gt;</p> 
<p>8. 阿里支付出现Execution failed for task ':flutter_alipay:bundleDebugAar'. </p> 
<p>dependencies {<!-- --></p> 
<p><span style="color:#f33b45;">classpath 'com.android.tools.build:gradle:3.5.0'</span></p> 
<p>classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"</p> 
<p>}</p> 
<p>android根目录的build.gradle下为3.5.0，我原来是4.0</p> 
<p>9、高德地图flutter开发总结</p> 
<p>（1）引用</p> 
<p>amap_flutter_map: ^1.0.1</p> 
<p>amap_flutter_location: ^1.0.1</p> 
<p>amap_location_flutter_plugin: ^0.1.4</p> 
<p>permission_handler: ^5.1.0+2</p> 
<p>（2）配置build.gradle</p> 
<p>sourceSets {<!-- --></p> 
<p></p> 
<p>main {<!-- --></p> 
<p>jniLibs.srcDirs = ['libs']</p> 
<p>}</p> 
<p>}</p> 
<p>dependencies {<!-- --></p> 
<p>//demo中引入高德地图SDK</p> 
<p><span style="color:#f33b45;">implementation('com.amap.api:3dmap:7.7.0')</span></p> 
<p><span style="color:#f33b45;">implementation fileTree(include: ['AMap_Location_V5.3.1_20210331.jar'], dir: 'libs')</span></p> 
<p>}</p> 
<p>(3)拷贝jar包到lib目录</p> 
<p><img alt="" height="191" src="https://images2.imgbox.com/26/fc/FIuy0UUE_o.png" width="328"></p> 
<p>（4）发布时候注意混淆问题</p> 
<p>buildTypes {<!-- --></p> 
<p>release {<!-- --></p> 
<p>// TODO: Add your own signing config for the release build.</p> 
<p>// Signing with the debug keys for now, so `flutter run --release` works.</p> 
<p>signingConfig signingConfigs.debug</p> 
<p>//关闭混淆, 否则在运行release包后可能出现运行崩溃， TODO后续进行混淆配置</p> 
<p>minifyEnabled false //删除无用代码</p> 
<p>shrinkResources false //删除无用资源</p> 
<p>}</p> 
<p>}</p> 
<p><img alt="" height="337" src="https://images2.imgbox.com/b5/8e/kkCYmF80_o.png" width="1173"></p> 
<p>(6) flutter_alipay的支付宝支付功能发布ios时，会出现【include statically linked binaries AlipaySDK】</p> 
<p>修改/Users/zhangjianyong/.pub-cache/hosted/pub.flutter-io.cn/flutter_alipay-1.0.0/ios/flutter_alipay.podspec，增加</p> 
<p><span style="color:#fe2c24;"><strong>s.static_framework = true</strong></span><br>  </p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5fa45d3d29f9ff09588f7eb57213ef7a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java怎么调用另一个类的方法_java如何调用另一个类的方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/61665797e45f2e2032502b2beecc500d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java ftp服务器_Java实现FTP服务器功能实例代码</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>