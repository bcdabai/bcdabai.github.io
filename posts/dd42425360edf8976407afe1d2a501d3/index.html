<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【CMake保姆级教程】定义变量、指定C&#43;&#43;标准、指定输出路径 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【CMake保姆级教程】定义变量、指定C&#43;&#43;标准、指定输出路径" />
<meta property="og:description" content="文章目录 前言一、变量1.1 为什么需要变量？1.2 set的使用1.3 使用变量 二、指定C&#43;&#43;标准2.1 为什么需要指定C&#43;&#43;标准？2.2 指定使用的C&#43;&#43;标准 三、指定输出路径3.1 为什么需要指定输出路径？3.2 设置输出路径 总结 前言 CMake是一个强大的构建工具，它通过简化项目的构建和配置过程，使得跨平台开发变得更加容易。CMake使用简洁的语法和自动生成的构建文件，可以帮助开发者更轻松地管理和组织项目。在本教程中，我们将学习如何使用CMake定义变量、指定C&#43;&#43;标准以及指定输出路径。
一、变量 1.1 为什么需要变量？ 在CMake中，变量是存储数据的容器，它们用于传递信息、控制流程，以及配置构建过程。定义变量可以提高代码的可读性和可维护性，同时也方便在不同的地方共享相同的信息。通过变量，我们可以轻松地调整配置选项、文件路径等，从而适应不同的开发环境和需求。
1.2 set的使用 # SET 指令的语法是： # [] 中的参数为可选项, 如不需要可以不写 SET(VAR [VALUE] [CACHE TYPE DOCSTRING [FORCE]]) 在一个文件夹中，我们有下面这些文件
. ├── build ├── CMakeLists.txt ├── func.c ├── func.h └── main.c 这2个源文件需要反复被使用，每次都直接将它们的名字写出来确实是很麻烦，此时我们就需要定义一个变量，将文件名对应的字符串存储起来，在cmake里定义变量需要使用set。
set(SRC_LIST main.c func.c) 比如像上面这样，前面为变量名，后面为你要赋的值
1.3 使用变量 如果你想使用变量，你需要这样${变量名}
如下所示：
cmake_minimum_required(VERSION 3.0.0) project(test) set(SRC_LIST main.c func.c) add_executable(app ${SRC_LIST}) ubuntu@ubuntu-2204:~/C/csdn-cmake$ cd build/ ubuntu@ubuntu-2204:~/C/csdn-cmake/build$ cmake .. -- The C compiler identification is GNU 11." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/dd42425360edf8976407afe1d2a501d3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-22T19:07:47+08:00" />
<meta property="article:modified_time" content="2023-12-22T19:07:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【CMake保姆级教程】定义变量、指定C&#43;&#43;标准、指定输出路径</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_5" rel="nofollow">前言</a></li><li><a href="#_10" rel="nofollow">一、变量</a></li><li><ul><li><a href="#11__11" rel="nofollow">1.1 为什么需要变量？</a></li><li><a href="#12_set_14" rel="nofollow">1.2 set的使用</a></li><li><a href="#13__41" rel="nofollow">1.3 使用变量</a></li></ul> 
  </li><li><a href="#C_84" rel="nofollow">二、指定C++标准</a></li><li><ul><li><a href="#21_C_85" rel="nofollow">2.1 为什么需要指定C++标准？</a></li><li><a href="#22_C_88" rel="nofollow">2.2 指定使用的C++标准</a></li></ul> 
  </li><li><a href="#_138" rel="nofollow">三、指定输出路径</a></li><li><ul><li><a href="#31__139" rel="nofollow">3.1 为什么需要指定输出路径？</a></li><li><a href="#32__142" rel="nofollow">3.2 设置输出路径</a></li></ul> 
  </li><li><a href="#_175" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_5"></a>前言</h2> 
<p>CMake是一个强大的构建工具，它通过简化项目的构建和配置过程，使得跨平台开发变得更加容易。CMake使用简洁的语法和自动生成的构建文件，可以帮助开发者更轻松地管理和组织项目。在本教程中，我们将学习如何使用CMake定义变量、指定C++标准以及指定输出路径。</p> 
<hr> 
<h2><a id="_10"></a>一、变量</h2> 
<h3><a id="11__11"></a>1.1 为什么需要变量？</h3> 
<p>在CMake中，变量是存储数据的容器，它们用于传递信息、控制流程，以及配置构建过程。定义变量可以提高代码的可读性和可维护性，同时也方便在不同的地方共享相同的信息。通过变量，我们可以轻松地调整配置选项、文件路径等，从而适应不同的开发环境和需求。</p> 
<h3><a id="12_set_14"></a>1.2 set的使用</h3> 
<pre><code class="prism language-bash"><span class="token comment"># SET 指令的语法是：</span>
<span class="token comment"># [] 中的参数为可选项, 如不需要可以不写</span>
SET<span class="token punctuation">(</span>VAR <span class="token punctuation">[</span>VALUE<span class="token punctuation">]</span> <span class="token punctuation">[</span>CACHE TYPE DOCSTRING <span class="token punctuation">[</span>FORCE<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p>在一个文件夹中，我们有下面这些文件</p> 
<pre><code class="prism language-bash"><span class="token builtin class-name">.</span>
├── build
├── CMakeLists.txt
├── func.c
├── func.h
└── main.c
</code></pre> 
<p>这2个源文件需要反复被使用，每次都直接将它们的名字写出来确实是很麻烦，此时我们就需要定义一个变量，将文件名对应的字符串存储起来，在cmake里定义变量需要使用set。</p> 
<pre><code class="prism language-bash">set<span class="token punctuation">(</span>SRC_LIST main.c func.c<span class="token punctuation">)</span>
</code></pre> 
<p>比如像上面这样，前面为变量名，后面为你要赋的值</p> 
<h3><a id="13__41"></a>1.3 使用变量</h3> 
<p>如果你想使用变量，你需要这样<code>${变量名}</code><br> 如下所示：</p> 
<pre><code class="prism language-bash">cmake_minimum_required<span class="token punctuation">(</span>VERSION <span class="token number">3.0</span>.0<span class="token punctuation">)</span>
project<span class="token punctuation">(</span>test<span class="token punctuation">)</span>

set<span class="token punctuation">(</span>SRC_LIST main.c func.c<span class="token punctuation">)</span>

add_executable<span class="token punctuation">(</span>app <span class="token variable">${SRC_LIST}</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-bash">ubuntu@ubuntu-2204:~/C/csdn-cmake$ <span class="token builtin class-name">cd</span> build/
ubuntu@ubuntu-2204:~/C/csdn-cmake/build$ cmake <span class="token punctuation">..</span>
-- The C compiler identification is GNU <span class="token number">11.4</span>.0
-- The CXX compiler identification is GNU <span class="token number">11.4</span>.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - <span class="token keyword">done</span>
-- Check <span class="token keyword">for</span> working C compiler: /usr/bin/cc - skipped
-- Detecting C compile features
-- Detecting C compile features - <span class="token keyword">done</span>
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - <span class="token keyword">done</span>
-- Check <span class="token keyword">for</span> working CXX compiler: /usr/bin/c++ - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - <span class="token keyword">done</span>
-- Configuring <span class="token keyword">done</span>
-- Generating <span class="token keyword">done</span>
-- Build files have been written to: /home/ubuntu/C/csdn-cmake/build
ubuntu@ubuntu-2204:~/C/csdn-cmake/build$ <span class="token function">make</span>
<span class="token punctuation">[</span> <span class="token number">33</span>%<span class="token punctuation">]</span> Building C object CMakeFiles/app.dir/main.c.o
<span class="token punctuation">[</span> <span class="token number">66</span>%<span class="token punctuation">]</span> Building C object CMakeFiles/app.dir/func.c.o
<span class="token punctuation">[</span><span class="token number">100</span>%<span class="token punctuation">]</span> Linking C executable app
<span class="token punctuation">[</span><span class="token number">100</span>%<span class="token punctuation">]</span> Built target app
ubuntu@ubuntu-2204:~/C/csdn-cmake/build$ ./app
Hello CMake
ubuntu@ubuntu-2204:~/C/csdn-cmake/build$ 
</code></pre> 
<p>可以看到，成功的cmake和make了</p> 
<h2><a id="C_84"></a>二、指定C++标准</h2> 
<h3><a id="21_C_85"></a>2.1 为什么需要指定C++标准？</h3> 
<p>指定C++标准是为了确保项目在不同的编译器和平台上都能正确编译和运行。不同的C++标准包含了不同的语法和特性，开发者需要根据项目的需要选择合适的标准。通过在CMake中指定C++标准，我们可以保证代码在各种环境中的一致性。</p> 
<h3><a id="22_C_88"></a>2.2 指定使用的C++标准</h3> 
<p>在编写C++程序的时候，可能会用到C++11、C++14、C++17、C++20等新特性，那么就需要在编译的时候在编译命令中制定出要使用哪个标准：</p> 
<pre><code class="prism language-bash">$ g++ *.cpp <span class="token parameter variable">-std</span><span class="token operator">=</span>c++11 <span class="token parameter variable">-o</span> app
</code></pre> 
<p>上面的例子中通过参数-std=c++11指定出要使用c++11标准编译程序，C++标准对应有一宏叫做DCMAKE_CXX_STANDARD。在CMake中想要指定C++标准有两种方式：<br> 在 CMakeLists.txt 中通过 set 命令指定</p> 
<pre><code class="prism language-bash"><span class="token comment">#增加-std=c++11</span>
set<span class="token punctuation">(</span>CMAKE_CXX_STANDARD <span class="token number">11</span><span class="token punctuation">)</span>
<span class="token comment">#增加-std=c++14</span>
set<span class="token punctuation">(</span>CMAKE_CXX_STANDARD <span class="token number">14</span><span class="token punctuation">)</span>
<span class="token comment">#增加-std=c++17</span>
set<span class="token punctuation">(</span>CMAKE_CXX_STANDARD <span class="token number">17</span><span class="token punctuation">)</span>
在执行 cmake 命令的时候指定出这个宏的值
</code></pre> 
<pre><code class="prism language-bash"><span class="token comment">#增加-std=c++11</span>
cmake CMakeLists.txt文件路径 <span class="token parameter variable">-DCMAKE_CXX_STANDARD</span><span class="token operator">=</span><span class="token number">11</span>
<span class="token comment">#增加-std=c++14</span>
cmake CMakeLists.txt文件路径 <span class="token parameter variable">-DCMAKE_CXX_STANDARD</span><span class="token operator">=</span><span class="token number">14</span>
<span class="token comment">#增加-std=c++17</span>
cmake CMakeLists.txt文件路径 <span class="token parameter variable">-DCMAKE_CXX_STANDARD</span><span class="token operator">=</span><span class="token number">17</span>
</code></pre> 
<p>就像下面这样：</p> 
<pre><code class="prism language-bash">ubuntu@ubuntu-2204:~/C/csdn-cmake/build$ cmake <span class="token punctuation">..</span>/CMakeLists.txt <span class="token parameter variable">-DCMAKE_CXX_STANDARD</span><span class="token operator">=</span><span class="token number">11</span>
-- The C compiler identification is GNU <span class="token number">11.4</span>.0
-- The CXX compiler identification is GNU <span class="token number">11.4</span>.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - <span class="token keyword">done</span>
-- Check <span class="token keyword">for</span> working C compiler: /usr/bin/cc - skipped
-- Detecting C compile features
-- Detecting C compile features - <span class="token keyword">done</span>
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - <span class="token keyword">done</span>
-- Check <span class="token keyword">for</span> working CXX compiler: /usr/bin/c++ - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - <span class="token keyword">done</span>
-- Configuring <span class="token keyword">done</span>
-- Generating <span class="token keyword">done</span>
-- Build files have been written to: /home/ubuntu/C/csdn-cmake
ubuntu@ubuntu-2204:~/C/csdn-cmake/build$
</code></pre> 
<h2><a id="_138"></a>三、指定输出路径</h2> 
<h3><a id="31__139"></a>3.1 为什么需要指定输出路径？</h3> 
<p>指定输出路径可以让我们更好地组织项目的构建结果。默认情况下，CMake会将可执行文件和库放在项目的构建目录中，但在实际项目中，我们可能希望将这些文件放在特定的文件夹中，以便更好地组织项目结构。</p> 
<h3><a id="32__142"></a>3.2 设置输出路径</h3> 
<p>在CMake中指定可执行程序输出的路径，也对应一个宏，叫做EXECUTABLE_OUTPUT_PATH，它的值还是通过set命令进行设置:</p> 
<p>文件夹层级如下：</p> 
<pre><code class="prism language-bash">ubuntu@ubuntu-2204:~/C/csdn-cmake$ tree <span class="token parameter variable">-L</span> <span class="token number">1</span>
<span class="token builtin class-name">.</span>
├── bin
├── build
├── CMakeLists.txt
├── func.cpp
├── func.h
└── main.cpp

<span class="token number">2</span> directories, <span class="token number">4</span> files
</code></pre> 
<pre><code class="prism language-bash">set<span class="token punctuation">(</span><span class="token environment constant">HOME</span> /home/ubuntu/C/csdn-cmake/<span class="token punctuation">)</span>
set<span class="token punctuation">(</span>EXECUTABLE_OUTPUT_PATH <span class="token variable">${<!-- --><span class="token environment constant">HOME</span>}</span>/bin<span class="token punctuation">)</span>
</code></pre> 
<p>第一行：定义一个变量用于存储一个绝对路径<br> 第二行：将拼接好的路径值设置给EXECUTABLE_OUTPUT_PATH宏<br> 如果这个路径中的子目录不存在，会自动生成，无需自己手动创建<br> 由于可执行程序是基于 cmake 命令生成的 makefile 文件然后再执行 make 命令得到的，所以如果此处指定可执行程序生成路径的时候使用的是相对路径 ./xxx/xxx，那么这个路径中的 ./ 对应的就是 makefile 文件所在的那个目录。</p> 
<p><img src="https://images2.imgbox.com/97/2c/2W0Ep3DI_o.png" alt="在这里插入图片描述"><br> 我们通过cmake和make就可以生成可执行程序了，如图所示</p> 
<hr> 
<h2><a id="_175"></a>总结</h2> 
<p>通过本教程，我们学习了如何在CMake中定义变量、指定C++标准以及指定输出路径。这些功能使得项目的配置和构建变得更加简便和灵活。变量提供了一种在不同地方共享信息的方式，指定C++标准确保了项目在不同平台上的一致性，而指定输出路径则使得项目的构建结果更加有条理。希望这些知识能够帮助你更好地使用CMake管理和构建你的项目。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e0fd7440041e2657349366672f14f478/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">算法设计与分析期末知识点总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e41fca6901747649df0d03ada107e505/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【CMake保姆级教程】搜索文件和包含头文件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>