<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>poi使用整理总结 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="poi使用整理总结" />
<meta property="og:description" content="一、 POI简介
Apache POI是Apache软件基金会的开放源码函式库，POI提供API给Java程序对Microsoft Office格式档案读和写的功能。
二、 HSSF概况
HSSF 是Horrible SpreadSheet Format的缩写，通过HSSF，你可以用纯Java代码来读取、写入、修改Excel文件。HSSF 为读取操作提供了两类API：usermodel和eventusermodel，即“用户模型”和“事件-用户模型”。
三、 POI EXCEL文档结构类
HSSFWorkbook excel文档对象
HSSFSheet excel的sheet HSSFRow excel的行
HSSFCell excel的单元格 HSSFFont excel字体
HSSFName 名称 HSSFDataFormat 日期格式
HSSFHeader sheet头
HSSFFooter sheet尾
HSSFCellStyle cell样式
HSSFDateUtil 日期
HSSFPrintSetup 打印
HSSFErrorConstants 错误信息表
四、 EXCEL常用操作方法
1、 得到Excel常用对象 [c-sharp] view plaincopy
POIFSFileSystem fs=newPOIFSFileSystem(new FileInputStream(&#34;d:/test.xls&#34;)); //得到Excel工作簿对象 HSSFWorkbook wb = new HSSFWorkbook(fs); //得到Excel工作表对象 HSSFSheet sheet = wb.getSheetAt(0); //得到Excel工作表的行 HSSFRow row = sheet.getRow(i); //得到Excel工作表指定行的单元格 HSSFCell cell = row." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/5ad15bcdff24a63eb860fa908ce97ed7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-08T07:45:11+08:00" />
<meta property="article:modified_time" content="2022-05-08T07:45:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">poi使用整理总结</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>一、 POI简介<br>             Apache POI是Apache软件基金会的开放源码函式库，POI提供API给Java程序对Microsoft Office格式档案读和写的功能。<br> 二、 HSSF概况</p> 
<p>            HSSF 是Horrible SpreadSheet Format的缩写，通过HSSF，你可以用纯Java代码来读取、写入、修改Excel文件。HSSF 为读取操作提供了两类API：usermodel和eventusermodel，即“用户模型”和“事件-用户模型”。<br> 三、 POI EXCEL文档结构类</p> 
<p>            HSSFWorkbook excel文档对象</p> 
<p>            HSSFSheet excel的sheet HSSFRow excel的行</p> 
<p>            HSSFCell excel的单元格 HSSFFont excel字体</p> 
<p>            HSSFName 名称 HSSFDataFormat 日期格式</p> 
<p>            HSSFHeader sheet头</p> 
<p>            HSSFFooter sheet尾</p> 
<p>            HSSFCellStyle cell样式</p> 
<p>            HSSFDateUtil 日期</p> 
<p>            HSSFPrintSetup 打印</p> 
<p>            HSSFErrorConstants 错误信息表<br> 四、 EXCEL常用操作方法<br>   1、 得到Excel常用对象           <br> [c-sharp] view plaincopy</p> 
<p>    POIFSFileSystem fs=newPOIFSFileSystem(new FileInputStream("d:/test.xls"));   <br>     //得到Excel工作簿对象   <br>     HSSFWorkbook wb = new HSSFWorkbook(fs);  <br>     //得到Excel工作表对象   <br>     HSSFSheet sheet = wb.getSheetAt(0);   <br>     //得到Excel工作表的行   <br>     HSSFRow row = sheet.getRow(i);  <br>     //得到Excel工作表指定行的单元格   <br>     HSSFCell cell = row.getCell((short) j);  <br>     cellStyle = cell.getCellStyle();//得到单元格样式  </p> 
<p> 2、建立Excel常用对象<br> [c-sharp] view plaincopy</p> 
<p>    HSSFWorkbook wb = new HSSFWorkbook();//创建Excel工作簿对象  <br>     HSSFSheet sheet = wb.createSheet("new sheet");//创建Excel工作表对象    <br>     HSSFRow row = sheet.createRow((short)0); //创建Excel工作表的行  <br>     cellStyle = wb.createCellStyle();//创建单元格样式  <br>     row.createCell((short)0).setCellStyle(cellStyle); //创建Excel工作表指定行的单元格  <br>     row.createCell((short)0).setCellValue(1); //设置Excel工作表的值  </p> 
<p>3、设置sheet名称和单元格内容<br> [c-sharp] view plaincopy</p> 
<p>    wb.setSheetName(1, "第一张工作表",HSSFCell.ENCODING_UTF_16);          <br>     cell.setEncoding((short) 1);      <br>     cell.setCellValue("单元格内容");  </p> 
<p>4、取得sheet的数目 <br> [c-sharp] view plaincopy</p> 
<p>    wb.getNumberOfSheets()   </p> 
<p>5、  根据index取得sheet对象<br> [c-sharp] view plaincopy</p> 
<p>    HSSFSheet sheet = wb.getSheetAt(0);  </p> 
<p>6、取得有效的行数<br> [c-sharp] view plaincopy</p> 
<p>    int rowcount = sheet.getLastRowNum();  </p> 
<p>7、取得一行的有效单元格个数<br> [c-sharp] view plaincopy</p> 
<p>    row.getLastCellNum();    </p> 
<p>8、单元格值类型读写</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    cell.setCellType(HSSFCell.CELL_TYPE_STRING); //设置单元格为STRING类型  <br>     cell.getNumericCellValue();//读取为数值类型的单元格内容  </p> 
<p> </p> 
<p>9、设置列宽、行高</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    sheet.setColumnWidth((short)column,(short)width);      <br>     row.setHeight((short)height);    </p> 
<p> </p> 
<p>10、添加区域，合并单元格</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    Region region = new Region((short)rowFrom,(short)columnFrom,(short)rowTo  <br>     ,(short)columnTo);//合并从第rowFrom行columnFrom列  <br>     sheet.addMergedRegion(region);// 到rowTo行columnTo的区域     <br>     //得到所有区域      <br>     sheet.getNumMergedRegions()   </p> 
<p> </p> 
<p>11、保存Excel文件</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    FileOutputStream fileOut = new FileOutputStream(path);   <br>     wb.write(fileOut);   </p> 
<p> </p> 
<p>12、根据单元格不同属性返回字符串数值</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    public String getCellStringValue(HSSFCell cell) {      <br>             String cellValue = "";      <br>             switch (cell.getCellType()) {      <br>             case HSSFCell.CELL_TYPE_STRING://字符串类型  <br>                 cellValue = cell.getStringCellValue();      <br>                 if(cellValue.trim().equals("")||cellValue.trim().length()&lt;=0)      <br>                     cellValue=" ";      <br>                 break;      <br>             case HSSFCell.CELL_TYPE_NUMERIC: //数值类型  <br>                 cellValue = String.valueOf(cell.getNumericCellValue());      <br>                 break;      <br>             case HSSFCell.CELL_TYPE_FORMULA: //公式  <br>                 cell.setCellType(HSSFCell.CELL_TYPE_NUMERIC);      <br>                 cellValue = String.valueOf(cell.getNumericCellValue());      <br>                 break;      <br>             case HSSFCell.CELL_TYPE_BLANK:      <br>                 cellValue=" ";      <br>                 break;      <br>             case HSSFCell.CELL_TYPE_BOOLEAN:      <br>                 break;      <br>             case HSSFCell.CELL_TYPE_ERROR:      <br>                 break;      <br>             default:      <br>                 break;      <br>             }      <br>             return cellValue;      <br>         }     </p> 
<p> </p> 
<p>13、常用单元格边框格式</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    HSSFCellStyle style = wb.createCellStyle();      <br>     style.setBorderBottom(HSSFCellStyle.BORDER_DOTTED);//下边框       <br>     style.setBorderLeft(HSSFCellStyle.BORDER_DOTTED);//左边框       <br>     style.setBorderRight(HSSFCellStyle.BORDER_THIN);//右边框       <br>     style.setBorderTop(HSSFCellStyle.BORDER_THIN);//上边框    </p> 
<p> </p> 
<p>14、设置字体和内容位置</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    HSSFFont f  = wb.createFont();      <br>     f.setFontHeightInPoints((short) 11);//字号      <br>     f.setBoldweight(HSSFFont.BOLDWEIGHT_NORMAL);//加粗      <br>     style.setFont(f);      <br>     style.setAlignment(HSSFCellStyle.ALIGN_CENTER);//左右居中      <br>     style.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER);//上下居中      <br>     style.setRotation(short rotation);//单元格内容的旋转的角度      <br>     HSSFDataFormat df = wb.createDataFormat();      <br>     style1.setDataFormat(df.getFormat("0.00%"));//设置单元格数据格式      <br>     cell.setCellFormula(string);//给单元格设公式      <br>     style.setRotation(short rotation);//单元格内容的旋转的角度   </p> 
<p> </p> 
<p>15、插入图片</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    //先把读进来的图片放到一个ByteArrayOutputStream中，以便产生ByteArray      <br>           ByteArrayOutputStream byteArrayOut = new ByteArrayOutputStream();      <br>           BufferedImage bufferImg = ImageIO.read(new File("ok.jpg"));      <br>           ImageIO.write(bufferImg,"jpg",byteArrayOut);      <br>     //读进一个excel模版      <br>     FileInputStream fos = new FileInputStream(filePathName+"/stencil.xlt");       <br>     fs = new POIFSFileSystem(fos);      <br>     //创建一个工作薄      <br>     HSSFWorkbook wb = new HSSFWorkbook(fs);      <br>     HSSFSheet sheet = wb.getSheetAt(0);      <br>     HSSFPatriarch patriarch = sheet.createDrawingPatriarch();      <br>     HSSFClientAnchor anchor = new HSSFClientAnchor(0,0,1023,255,(short) 0,0,(short)10,10);           <br>     patriarch.createPicture(anchor , wb.addPicture(byteArrayOut.toByteArray(),HSSFWorkbook.PICTURE_TYPE_JPEG));    </p> 
<p> </p> 
<p>16、调整工作表位置</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    HSSFWorkbook wb = new HSSFWorkbook();     <br>     HSSFSheet sheet = wb.createSheet("format sheet");     <br>     HSSFPrintSetup ps = sheet.getPrintSetup();     <br>     sheet.setAutobreaks(true);     <br>     ps.setFitHeight((short)1);     <br>     ps.setFitWidth((short)1);   </p> 
<p>  </p> 
<p> </p> 
<p>17、设置打印区域</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    HSSFSheet sheet = wb.createSheet("Sheet1");     <br>     wb.setPrintArea(0, "$A$1:$C$2");    </p> 
<p> </p> 
<p>18、标注脚注</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    HSSFSheet sheet = wb.createSheet("format sheet");     <br>     HSSFFooter footer = sheet.getFooter()     <br>     footer.setRight( "Page " + HSSFFooter.page() + " of " + HSSFFooter.numPages() );   </p> 
<p> </p> 
<p>19、在工作单中清空行数据，调整行位置</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    HSSFWorkbook wb = new HSSFWorkbook();     <br>     HSSFSheet sheet = wb.createSheet("row sheet");     <br>     // Create various cells and rows for spreadsheet.     <br>     // Shift rows 6 - 11 on the spreadsheet to the top (rows 0 - 5)     <br>     sheet.shiftRows(5, 10, -5);    </p> 
<p> </p> 
<p>20、选中指定的工作表</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    HSSFSheet sheet = wb.createSheet("row sheet");     <br>     heet.setSelected(true);     </p> 
<p> </p> 
<p>21、工作表的放大缩小</p> 
<p> <br> [c-sharp] view plaincopy</p> 
<p>    HSSFSheet sheet1 = wb.createSheet("new sheet");     <br>     sheet1.setZoom(1,2);   // 50 percent magnification    </p> 
<p> </p> 
<p>22、头注和脚注</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    HSSFSheet sheet = wb.createSheet("new sheet");     <br>     HSSFHeader header = sheet.getHeader();     <br>     header.setCenter("Center Header");     <br>     header.setLeft("Left Header");     <br>     header.setRight(HSSFHeader.font("Stencil-Normal", "Italic") +     <br>     HSSFHeader.fontSize((short) 16) + "Right w/ Stencil-Normal Italic font and size 16");  </p> 
<p> </p> 
<p>23、自定义颜色</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    HSSFCellStyle style = wb.createCellStyle();     <br>     style.setFillForegroundColor(HSSFColor.LIME.index);     <br>     style.setFillPattern(HSSFCellStyle.SOLID_FOREGROUND);     <br>     HSSFFont font = wb.createFont();     <br>     font.setColor(HSSFColor.RED.index);     <br>     style.setFont(font);     <br>     cell.setCellStyle(style);     </p> 
<p>24、填充和颜色设置</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    HSSFCellStyle style = wb.createCellStyle();     <br>     style.setFillBackgroundColor(HSSFColor.AQUA.index);     <br>     style.setFillPattern(HSSFCellStyle.BIG_SPOTS);     <br>     HSSFCell cell = row.createCell((short) 1);     <br>     cell.setCellValue("X");     <br>     style = wb.createCellStyle();     <br>     style.setFillForegroundColor(HSSFColor.ORANGE.index);     <br>     style.setFillPattern(HSSFCellStyle.SOLID_FOREGROUND);     <br>     cell.setCellStyle(style);   </p> 
<p>25、强行刷新单元格公式</p> 
<p>[c-sharp] view plaincopy</p> 
<p>    HSSFFormulaEvaluator eval=new HSSFFormulaEvaluator((HSSFWorkbook) wb);    <br>     private static void updateFormula(Workbook wb,Sheet s,int row){     <br>             Row r=s.getRow(row);     <br>             Cell c=null;     <br>             FormulaEcaluator eval=null;     <br>             if(wb instanceof HSSFWorkbook)     <br>                 eval=new HSSFFormulaEvaluator((HSSFWorkbook) wb);     <br>             else if(wb instanceof XSSFWorkbook)     <br>                 eval=new XSSFFormulaEvaluator((XSSFWorkbook) wb);     <br>             for(int i=r.getFirstCellNum();i&lt;r.getLastCellNum();i++){     <br>                 c=r.getCell(i);     <br>                 if(c.getCellType()==Cell.CELL_TYPE_FORMULA)     <br>                     eval.evaluateFormulaCell(c);     <br>             }     <br>         }    </p> 
<p>说明：FormulaEvaluator提供了evaluateFormulaCell(Cell cell)方法，计算公式保存结果，但不改变公式。而evaluateInCell(Cell cell) 方法是计算公式，并将原公式替换为计算结果，也就是说该单元格的类型不在是Cell.CELL_TYPE_FORMULA而是Cell.CELL_TYPE_NUMBERIC。HSSFFormulaEvaluator提供了静态方法evaluateAllFormu</p> 
<p>laCells(HSSFWorkbook wb) ，计算一个Excel文件的所有公式，用起来很方便。</p> 
<p style="margin-left:0;text-align:justify;"><em>1.</em> <em>HSSFWorkbook</em><em>类（创建excel表）</em></p> 
<p style="margin-left:0;text-align:left;">首先从Workbook开始我们的POI编程之旅。要生成一个Workbook，需要用到HSSFWorkbook类文件，类定义如下：</p> 
<ul><li style="text-align:left;">java.lang.Object</li><li style="text-align:left;">org.apache.poi.hssf.usermodel.HSSFWorkbook</li><li style="text-align:left;">public class HSSFWorkbook extends java.lang.Object</li></ul> 
<p style="margin-left:0;text-align:left;">它有五个构造方法：</p> 
<table><tbody><tr><td> <p style="margin-left:0;text-align:center;"><strong>构建器 </strong></p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFWorkbook()<br> Creates new HSSFWorkbook from scratch (start here!)</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFWorkbook(java.io.InputStream s)</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFWorkbook(java.io.InputStream s, boolean preserveNodes)<br> Companion to HSSFWorkbook(POIFSFileSystem), this constructs the POI filesystem around your inputstream.</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFWorkbook(POIFSFileSystem fs)</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFWorkbook(POIFSFileSystem fs, boolean preserveNodes)<br> given a POI POIFSFileSystem object, read in its Workbook and populate the high and low level models.</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:left;">我们用第一个构建器来生成一个Workbook</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook</p> 
<p style="margin-left:0;text-align:left;">public HSSFWorkbook()</p> 
<p style="margin-left:0;text-align:left;">Creates new HSSFWorkbook from scratch (start here!)</p> 
<p style="margin-left:0;text-align:left;">使用方法如下：</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;">接下来再来对生成的Workbook进行保存操作，保存操作用「HSSFWorkbook」类的「write」方法:</p> 
<p style="margin-left:0;text-align:left;">write</p> 
<p style="margin-left:0;text-align:left;">public void write(java.io.OutputStream stream) throws</p> 
<p style="margin-left:0;text-align:left;">java.io.IOException</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Method write - write out this workbook to an Outputstream.</p> 
<p style="margin-left:0;text-align:left;">Constructs a new POI POIFSFileSystem, passes in the workbook</p> 
<p style="margin-left:0;text-align:left;">binary representation and writes it out.</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  stream - - the java OutputStream you wish to write the XLS to</p> 
<p style="margin-left:0;text-align:left;">Throws:</p> 
<p style="margin-left:0;text-align:left;">  java.io.IOException - if anything can't be written.</p> 
<p style="margin-left:0;text-align:left;">参数是作为保存对象的输出流对象「OutputStream」。</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">可以自己实际做一下啊。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = new HSSFWorkbook();//创建一个空白的workbook</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);//调用HSSFWorkbook类的write方法写入到输出流</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">运行刚才的示例程序来生成一个Excel文件吧。</p> 
<p style="margin-left:0;text-align:left;">==========================================异常华丽的分割线=============================================================</p> 
<p style="margin-left:0;text-align:left;"><em>2. POIFSFileSystem</em><em>类（读取excel表格）</em></p> 
<p style="margin-left:0;text-align:left;">这次我们用POI打开一个已经存在的Workbook。因为没有现成的方法，所以只能再次利用HSSFWorkbook构造方法</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook</p> 
<p style="margin-left:0;text-align:left;">public HSSFWorkbook(POIFSFileSystem fs) throws java.io.IOException</p> 
<p style="margin-left:0;text-align:left;">--</p> 
<p style="margin-left:0;text-align:left;">这个构建器虽然没什么说明，但可以看出它的参数是一个「POIFSFileSystem」这样的一个类对象。那我们再来看看「POIFSFileSystem」类定义。</p> 
<p style="margin-left:0;text-align:left;"><strong>POIFSFileSystem</strong><strong>类定义</strong></p> 
<p style="margin-left:0;text-align:left;">「POIFSFileSystem」类对象可以把Excel文件作为数据流来进行传入传出。</p> 
<ul><li style="text-align:left;">java.lang.Object</li><li style="text-align:left;">org.apache.poi.poifs.filesystem.POIFSFileSystem</li><li style="text-align:left;">public class POIFSFileSystem extends java.lang.Object implements POIFSViewable</li></ul> 
<p style="margin-left:0;text-align:left;">「POIFSFileSystem」类有两个构建器</p> 
<table><tbody><tr><td> <p style="margin-left:0;text-align:center;"><strong>构建器 </strong></p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">POIFSFileSystem()<br> Constructor, intended for writing</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">POIFSFileSystem(java.io.InputStream stream)<br> Create a POIFSFileSystem from an InputStream</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:left;">读取文件时使用第二个构建器。</p> 
<p style="margin-left:0;text-align:left;">POIFSFileSystem</p> 
<p style="margin-left:0;text-align:left;">public POIFSFileSystem(java.io.InputStream stream) throws</p> 
<p style="margin-left:0;text-align:left;">java.io.IOException</p> 
<p style="margin-left:0;text-align:left;">Create a POIFSFileSystem from an InputStream</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  stream - the InputStream from which to read the data</p> 
<p style="margin-left:0;text-align:left;">Throws:</p> 
<p style="margin-left:0;text-align:left;">  java.io.IOException - on errors reading, or on invalid data</p> 
<p style="margin-left:0;text-align:left;">参数设定为读入Excel文件的流对象「InputStream」。使用方法如下。</p> 
<p style="margin-left:0;text-align:left;">FileInputStream in = new FileInputStream("sample.xls");//文件输入流</p> 
<p style="margin-left:0;text-align:left;">POIFSFileSystem fs = new POIFSFileSystem(in);//构建poifsfileSystem对象，根据输入流</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook wb = new HSSFWorkbook(fs);</p> 
<p style="margin-left:0;text-align:left;"><strong>通过POIFSFileSystem读取Excel文件</strong></p> 
<p style="margin-left:0;text-align:left;">下面就实际做一下如何读取Excel文件。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    FileInputStream in = null;</p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = null;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      in = new FileInputStream("sample1.xls");//将excel文件转为输入流</p> 
<p style="margin-left:0;text-align:left;">      POIFSFileSystem fs = new POIFSFileSystem(in);//构建POIFSFileSystem类对象，用输入流构建</p> 
<p style="margin-left:0;text-align:left;">      workbook = new HSSFWorkbook(fs);//创建个workbook，根据POIFSFileSystem对象</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">        in.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch (IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample2.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">这个示例程序的作用是读取「sample1.xls」文件后再把它作为「sample2.xls」保存。<br> 「sample1.xls」文件如下。</p> 
<p style="margin-left:0;text-align:center;"><img class="img-loading" src="https://images2.imgbox.com/6c/62/9wop2Kyu_o.gif" alt="uploading.4e448015.gif">正在上传…重新上传取消</p> 
<p style="margin-left:0;text-align:left;">实行之后，会生成一模一样的文件「sample2.xls」。<br> 打开如下。</p> 
<p style="margin-left:0;text-align:center;"><img class="img-loading" src="https://images2.imgbox.com/c7/09/WWIFQyB7_o.gif" alt="uploading.4e448015.gif">正在上传…重新上传取消</p> 
<p style="margin-left:0;text-align:left;">==========================================异常华丽的分割线=============================================================</p> 
<p style="margin-left:0;text-align:left;"><em>3. </em><em>关于Sheet</em></p> 
<p style="margin-left:0;text-align:left;"><strong><em>HSSFSheet</em></strong><strong><em>类定义</em></strong></p> 
<p style="margin-left:0;text-align:left;">用POI来作成一个Sheet，可以用「HSSFSheet」类，它的类定义如下。</p> 
<ul><li style="text-align:left;">java.lang.Object</li><li style="text-align:left;">org.apache.poi.hssf.usermodel.HSSFSheet</li><li style="text-align:left;">public class HSSFSheet extends java.lang.Object</li></ul> 
<p style="margin-left:0;text-align:left;">它有两个构造方法。</p> 
<table><tbody><tr><td> <p style="margin-left:0;text-align:center;"><strong>构建器 </strong></p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">protected HSSFSheet(Workbook book)<br> Creates new HSSFSheet – called by HSSFWorkbook to create a sheet from scratch.</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">protected HSSFSheet(Workbook book, Sheet sheet)<br> Creates an HSSFSheet representing the given Sheet object.</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:left;">虽然有两个构建器，但都是protected的，所以要新建Sheet,只能通过Workbook。</p> 
<p style="margin-left:0;text-align:left;"><strong>新建Sheet</strong></p> 
<p style="margin-left:0;text-align:left;">在Workbook里新建Sheet时，还是使用「HSSFWorkbook」类的「createSheet」的方法，详细可以参照「<a href="http://justdoblogger.com/blog/200910/createsheet.html" rel="nofollow" title="在Workbook里创建Sheet">在Workbook里创建Sheet</a>」。<br> 使用方法如下。</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook workbook = new HSSFWorkbook();//创建个空白的workbook</p> 
<p style="margin-left:0;text-align:left;">HSSFSheet sheet = workbook.createSheet();//创建个空白的sheet</p> 
<p style="margin-left:0;text-align:left;"><strong>读取现有的Sheet</strong></p> 
<p style="margin-left:0;text-align:left;">对于在Workbook已经存在的Sheet来说，可以用「HSSFWorkbook」类的「getSheet」方法来读取。</p> 
<p style="margin-left:0;text-align:left;">getSheet</p> 
<p style="margin-left:0;text-align:left;">public HSSFSheet getSheet(java.lang.String name)</p> 
<p style="margin-left:0;text-align:left;">Get sheet with the given name</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  name - of the sheet</p> 
<p style="margin-left:0;text-align:left;">Returns:</p> 
<p style="margin-left:0;text-align:left;">  HSSFSheet with the name provided or null if it does not exist</p> 
<p style="margin-left:0;text-align:left;">(java.lang.String name)参数为Sheet名称。<br> 使用方法如下。</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;">HSSFSheet sheet = workbook.getSheet("sheet1")//读取名称为sheet1的sheet</p> 
<p style="margin-left:0;text-align:left;">不用Sheet名而用Sheet的序列号来取得Sheet的话，可以用「HSSFWorkbook」类的「getSheetAt」方法。</p> 
<p style="margin-left:0;text-align:left;">getSheetAt</p> 
<p style="margin-left:0;text-align:left;">public HSSFSheet getSheetAt(int index)</p> 
<p style="margin-left:0;text-align:left;">Get the HSSFSheet object at the given index.</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  index - of the sheet number (0-based physical &amp; logical)</p> 
<p style="margin-left:0;text-align:left;">Returns:</p> 
<p style="margin-left:0;text-align:left;">  HSSFSheet at the provided index</p> 
<p style="margin-left:0;text-align:left;">(int index)参数为sheet的序号</p> 
<p style="margin-left:0;text-align:left;">使用方法如下。</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;">HSSFSheet sheet = workbook.getSheetAt(1);//读取序号为1的sheet（第二张sheet）</p> 
<p style="margin-left:0;text-align:left;">=================</p> 
<p style="margin-left:0;text-align:left;"><strong><em>Workbook</em></strong><strong><em>创建Sheet</em></strong></p> 
<p style="margin-left:0;text-align:left;">要在Workbook里创建一个Sheet，可以使用「HSSFWorkbook」类的「createSheet」方法。</p> 
<p style="margin-left:0;text-align:left;">createSheet</p> 
<p style="margin-left:0;text-align:left;">public HSSFSheet createSheet()</p> 
<p style="margin-left:0;text-align:left;">create an HSSFSheet for this HSSFWorkbook, adds it to the sheets and</p> 
<p style="margin-left:0;text-align:left;">returns the high level representation. Use this to create new sheets.</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Returns:</p> 
<p style="margin-left:0;text-align:left;">  HSSFSheet representing the new sheet.</p> 
<p style="margin-left:0;text-align:left;">还有一个名称相同的「createSheet」方法，但可以指定Sheet名。</p> 
<p style="margin-left:0;text-align:left;">createSheet</p> 
<p style="margin-left:0;text-align:left;">public HSSFSheet createSheet(java.lang.String sheetname)</p> 
<p style="margin-left:0;text-align:left;">create an HSSFSheet for this HSSFWorkbook, adds it to the sheets and</p> 
<p style="margin-left:0;text-align:left;">returns the high level representation. Use this to create new sheets.</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  sheetname - sheetname to set for the sheet.</p> 
<p style="margin-left:0;text-align:left;">Returns:</p> 
<p style="margin-left:0;text-align:left;">  HSSFSheet representing the new sheet.</p> 
<p style="margin-left:0;text-align:left;">创建的Sheet作为「HSSFSheet」类对象返回。</p> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    workbook.createSheet();//创建workbook的sheet</p> 
<p style="margin-left:0;text-align:left;">    workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;">    workbook.createSheet("test");</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">上面的示例程序执行后，会生成下面的「sample1.xls」文件。</p> 
<p style="margin-left:0;text-align:center;"> </p> 
<p style="margin-left:0;text-align:left;">如果没有设定Sheet名，会从0开始默认设定为Sheet0,Sheet1等，设定为test的话，则可以创建test这样的Sheet。</p> 
<p style="margin-left:0;text-align:left;">===================================</p> 
<p style="margin-left:0;text-align:left;"><strong><em>Workbook</em></strong><strong><em>复制Sheet</em></strong></p> 
<p style="margin-left:0;text-align:left;">要复制Workbook里现有的Sheet来创建新的Sheet，可以使用「HSSFWorkbook」类的「cloneSheet」方法。</p> 
<p style="margin-left:0;text-align:left;">cloneSheet</p> 
<p style="margin-left:0;text-align:left;">public HSSFSheet cloneSheet(int sheetNum)</p> 
<p style="margin-left:0;text-align:left;">create an HSSFSheet from an existing sheet in the HSSFWorkbook.</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Returns:</p> 
<p style="margin-left:0;text-align:left;">  HSSFSheet representing the cloned sheet.</p> 
<p style="margin-left:0;text-align:left;">指定要复制的Sheet序列号。</p> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">再一次动手来做做吧。复制前Workbook如下。</p> 
<p style="margin-left:0;text-align:center;"> </p> 
<p style="margin-left:0;text-align:center;"> </p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    FileInputStream in = null;</p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = null;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      in = new FileInputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      POIFSFileSystem fs = new POIFSFileSystem(in);</p> 
<p style="margin-left:0;text-align:left;">      workbook = new HSSFWorkbook(fs);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">        in.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch (IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    workbook.cloneSheet(0);</p> 
<p style="margin-left:0;text-align:left;">    workbook.cloneSheet(1);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">执行后打开「sample1.xls」文件看看。</p> 
<p style="margin-left:0;text-align:center;"> </p> 
<p style="margin-left:0;text-align:left;">可以看出，两个Sheet被成功复制。被复制的Sheet名格式是「原Sheet名(序列号)」。顺便一提的是，如果你手动在Excel里进行复制的话，被复制的Sheet名的格式是「原Sheet名 (序列号)」。也就是原Sheet名和(序列号)之间有一个半角空格。</p> 
<p style="margin-left:0;text-align:left;">=============</p> 
<p style="margin-left:0;text-align:left;"><strong><em>Workbook</em></strong><strong><em>删除Sheet</em></strong></p> 
<p style="margin-left:0;text-align:left;">要从Workbook里删除Sheet,可以使用「HSSFWorkbook」类的方法「removeSheetAt」。</p> 
<p style="margin-left:0;text-align:left;">removeSheetAt</p> 
<p style="margin-left:0;text-align:left;">public void removeSheetAt(int index)</p> 
<p style="margin-left:0;text-align:left;">removes sheet at the given index</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  index - of the sheet (0-based)</p> 
<p style="margin-left:0;text-align:left;">(int index)指定要删除Sheet的序列号。<br> 如果不知道序列号的话，也可以通过「HSSFWorkbook」类的方法「getSheetIndex」，设定Sheet名来取得序列号。</p> 
<p style="margin-left:0;text-align:left;">getSheetIndex</p> 
<p style="margin-left:0;text-align:left;">public int getSheetIndex(java.lang.String name)</p> 
<p style="margin-left:0;text-align:left;">Returns the index of the sheet by his name</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  name - the sheet name</p> 
<p style="margin-left:0;text-align:left;">Returns:</p> 
<p style="margin-left:0;text-align:left;">  index of the sheet (0 based)</p> 
<p style="margin-left:0;text-align:left;">(java.lang.String name)参数请指定要删除的Sheet名。</p> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">生成一个Workbook,再在其中创建三个Sheet，最后再把名为「Sheet1」的Sheet删除。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;">    workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;">    workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    workbook.removeSheetAt(workbook.getSheetIndex("Sheet1"));</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    System.out.println("Sheet0 = " + workbook.getSheetIndex("Sheet0"));</p> 
<p style="margin-left:0;text-align:left;">    System.out.println("Sheet2 = " + workbook.getSheetIndex("Sheet2"));</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">示例程序执行后，会生成「sample1.xls」这样的文件，打开来看看先。</p> 
<p style="margin-left:0;text-align:center;"> </p> 
<p style="margin-left:0;text-align:left;">从图中可以看出，Sheet1被删除了，那么这时候序列号又是怎么样的呢？你还是可以通过「HSSFWorkbook」类的方法「getSheetIndex」，设定Sheet名来取得序列号看看。</p> 
<p style="margin-left:0;text-align:left;">Sheet0 = 0</p> 
<p style="margin-left:0;text-align:left;">Sheet2 = 1</p> 
<p style="margin-left:0;text-align:left;">我们发现中间的Sheet被删除后，后面的Sheet序列号会往前移一个，总之会维持从0开始的整数顺序。</p> 
<p style="margin-left:0;text-align:left;">============</p> 
<p style="margin-left:0;text-align:left;"><strong><em>改变sheet的名称</em></strong></p> 
<p style="margin-left:0;text-align:left;">要改变现有Sheet或刚新建Sheet的名称，可以用「HSSFWorkbook」类的「setSheetName」方法。</p> 
<p style="margin-left:0;text-align:left;">setSheetName</p> 
<p style="margin-left:0;text-align:left;">public void setSheetName(int sheet, java.lang.String name)</p> 
<p style="margin-left:0;text-align:left;">set the sheet name. Will throw IllegalArgumentException if the name</p> 
<p style="margin-left:0;text-align:left;">is greater than 31 chars or contains /\?*[]</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  sheet - number (0 based)</p> 
<p style="margin-left:0;text-align:left;">参数：（int sheet）指定要改变的Sheet的序列号。参数（java.lang.String  name）为要改变的名称，设置名称时，最大长度是31个文字，还有「/\?*[]」这样的字符不能使用。<br> 指定汉字Sheet名时，用第二个方法。</p> 
<p style="margin-left:0;text-align:left;">setSheetName</p> 
<p style="margin-left:0;text-align:left;">public void setSheetName(int sheet, java.lang.String name,</p> 
<p style="margin-left:0;text-align:left;">                                   short encoding)</p> 
<p style="margin-left:0;text-align:left;">--</p> 
<p style="margin-left:0;text-align:left;">「encoding」的参数在「HSSFWorkbook」类里被定义成下面两种。</p> 
<p style="margin-left:0;text-align:left;">static byte ENCODING_COMPRESSED_UNICODE</p> 
<p style="margin-left:0;text-align:left;">static byte ENCODING_UTF_16     ---------------设置中文用</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">参数(int sheet, java.lang.String name,short encoding)</p> 
<p style="margin-left:0;text-align:left;">int sheet     sheet号</p> 
<p style="margin-left:0;text-align:left;">java.lang.String name     改变的名字</p> 
<p style="margin-left:0;text-align:left;">short encoding      设定汉字时（包括日语），「encoding」的参数应该传入「HSSFWorkbook.ENCODING_UTF_16」。</p> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">亲自动手做一做吧。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;">    workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    workbook.setSheetName(0, "test");//更改sheet0的名字为test</p> 
<p style="margin-left:0;text-align:left;">    workbook.setSheetName(1, "测试", HSSFWorkbook.ENCODING_UTF_16);//更改sheet1的名字为“测试”设置为utf-16</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">程序执行后，打开「sample1.xls」文件来看看。</p> 
<p style="margin-left:0;text-align:center;"> </p> 
<p style="margin-left:0;text-align:left;">可以看出，汉字Sheet名被正常设好了。<br> 使用「createSheet」方法创建新的Sheet时，不能进行encoding设定。所以要设置汉字Sheet名时，只能先新建一个Sheet，然后再对该Sheet进行改名操作。</p> 
<p style="margin-left:0;text-align:left;">=====================</p> 
<p style="margin-left:0;text-align:left;"><strong><em>设定列宽度</em></strong></p> 
<p style="margin-left:0cm;">如果想在工作表里指定列宽度的话，可以使用「HSSFSheet」类的「setColumnWidth」方法。</p> 
<pre style="margin-left:0;">setColumnWidth</pre> 
<pre style="margin-left:0;">public void setColumnWidth(short column, short width)</pre> 
<pre style="margin-left:0;">set the width (in units of 1/256th of a character width) </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Parameters:</pre> 
<pre style="margin-left:0;">  column - - the column to set (0-based)</pre> 
<pre style="margin-left:0;">  width - - the width in units of 1/256th of a character width</pre> 
<p style="margin-left:0cm;">（short column）指定列的序列号, （short width）指定列的宽度。宽度如果指定1的话，那就是一个文字的1/256（也就是说一个文字占256的宽度），4个文字的宽度是1024。</p> 
<p style="margin-left:0cm;">另外，要取得列宽度可以使用「HSSFSheet」类的「getColumnWidth」方法。</p> 
<pre style="margin-left:0;">getColumnWidth</pre> 
<pre style="margin-left:0;">public short getColumnWidth(short column)</pre> 
<pre style="margin-left:0;">get the width (in units of 1/256th of a character width ) </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Parameters:</pre> 
<pre style="margin-left:0;">  column - - the column to set (0-based)</pre> 
<pre style="margin-left:0;">Returns:</pre> 
<pre style="margin-left:0;">  width - the width in units of 1/256th of a character width</pre> 
<p style="margin-left:0cm;">（short column）指定列的序列号</p> 
<h3 style="margin-left:0cm;"><strong>示例程序</strong></h3> 
<p style="margin-left:0cm;">自己动手做一下吧。仍然按照下图准备一个Excel文件，取得从第0列到第2列的列宽、然后把第2列的列宽指定给第0列和第1列。</p> 
<p style="margin-left:0cm;"> </p> 
<pre style="margin-left:0;">import java.io.*;</pre> 
<pre style="margin-left:0;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    FileInputStream in = null;</pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = null;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      in = new FileInputStream("sample.xls");</pre> 
<pre style="margin-left:0;">      POIFSFileSystem fs = new POIFSFileSystem(in);</pre> 
<pre style="margin-left:0;">      workbook = new HSSFWorkbook(fs);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try{<!-- --></pre> 
<pre style="margin-left:0;">        in.close();</pre> 
<pre style="margin-left:0;">      }catch (IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.getSheetAt(0);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    short[] width = new short[3];</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    for (int i = 0 ; i &lt; 3 ; i++){<!-- --></pre> 
<pre style="margin-left:0;">      width[i] = sheet.getColumnWidth((short)i);</pre> 
<pre style="margin-left:0;">      System.out.println(i + "列宽度：" + width[i]);</pre> 
<pre style="margin-left:0;">    }//循环获取0,1,2的宽度</pre> 
<pre style="margin-left:0;">   //将第二列的宽度赋给第0，1列</pre> 
<pre style="margin-left:0;">    sheet.setColumnWidth((short)0, width[2]);</pre> 
<pre style="margin-left:0;">    sheet.setColumnWidth((short)1, width[2]);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    FileOutputStream out = null;</pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      out = new FileOutputStream("sample2.xls");</pre> 
<pre style="margin-left:0;">      workbook.write(out);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try {<!-- --></pre> 
<pre style="margin-left:0;">        out.close();</pre> 
<pre style="margin-left:0;">      }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">打开新生成的Excel文件看看。</p> 
<pre style="margin-left:0;">0列宽度：1865</pre> 
<pre style="margin-left:0;">1列宽度：3986</pre> 
<pre style="margin-left:0;">2列宽度：2048</pre> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">一个Excel文件新生成时，有自己默认的列宽度，当然我们也可以用POI来指定默认的列宽度。</p> 
<h3 style="margin-left:0cm;"><strong>指定默认的列宽度</strong></h3> 
<p style="margin-left:0cm;">指定默认的列宽度用「HSSFSheet」类的「setDefaultColumnWidth」方法。</p> 
<pre style="margin-left:0;">setDefaultColumnWidth</pre> 
<pre style="margin-left:0;">public void setDefaultColumnWidth(short width)</pre> 
<pre style="margin-left:0;">set the default column width for the sheet (if the columns do not define</pre> 
<pre style="margin-left:0;">their own width) in characters </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Parameters:</pre> 
<pre style="margin-left:0;">  width - default column width</pre> 
<p style="margin-left:0cm;">（short width）参数，这里要注意的就是，和刚才的方法不一样，这里的列宽度单位是1个文字，而不是刚才的一个文字的1/256。</p> 
<p style="margin-left:0cm;">要取得原来的默认列宽度，使用「getDefaultColumnWidth」方法。</p> 
<pre style="margin-left:0;">getDefaultColumnWidth</pre> 
<pre style="margin-left:0;">public short getDefaultColumnWidth()</pre> 
<pre style="margin-left:0;">get the default column width for the sheet (if the columns do not define</pre> 
<pre style="margin-left:0;">their own width) in characters </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Returns:</pre> 
<pre style="margin-left:0;">  default column width</pre> 
<p style="margin-left:0cm;">这里的列宽度单位也是一个文字</p> 
<h3 style="margin-left:0cm;"><strong>示例程序</strong></h3> 
<p style="margin-left:0cm;">动手做做看吧。</p> 
<pre style="margin-left:0;">import java.io.*;</pre> 
<pre style="margin-left:0;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = new HSSFWorkbook();</pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.createSheet();</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    sheet.setDefaultColumnWidth((short)5);//将默认的列宽设为5个文字大小</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    FileOutputStream out = null;</pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      out = new FileOutputStream("sample2.xls");</pre> 
<pre style="margin-left:0;">      workbook.write(out);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try {<!-- --></pre> 
<pre style="margin-left:0;">        out.close();</pre> 
<pre style="margin-left:0;">      }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">新生成的Excel文件打开来看看吧。</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0;text-align:left;">=================</p> 
<p style="margin-left:0;text-align:left;"><strong><em>调整工作表</em></strong><strong><em>Sheet</em></strong><strong><em>的显示比例</em></strong></p> 
<p style="margin-left:0cm;">有时我们可能会手动去调整工作表Sheet的显示比例,用POI同样也能做到这一点。这时我们可以使用「HSSFSheet」类的「setZoom」方法。</p> 
<pre style="margin-left:0;">setZoom</pre> 
<pre style="margin-left:0;">public void setZoom(int numerator, int denominator)</pre> 
<pre style="margin-left:0;">Sets the zoom magnication for the sheet. The zoom is expressed as a</pre> 
<pre style="margin-left:0;">fraction. For example to express a zoom of 75% use 3 for the</pre> 
<pre style="margin-left:0;">numerator and 4 for the denominator. </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Parameters:</pre> 
<pre style="margin-left:0;">  numerator - The numerator for the zoom magnification.</pre> 
<pre style="margin-left:0;">  denominator - The denominator for the zoom magnification.</pre> 
<p style="margin-left:0cm;">(int numerator, int denominator)参数，这样就可以指定显示比例了，指定方法是用”numerator”÷”denominator”，比方说，「setZoom(2, 1)」就是设定为200%的比例，「setZoom(3, 4)」就是设定为75%的比例。</p> 
<h3 style="margin-left:0cm;"><strong>示例程序</strong></h3> 
<p style="margin-left:0cm;">动手做一下吧。</p> 
<pre style="margin-left:0;">import java.io.*;</pre> 
<pre style="margin-left:0;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFRow;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    FileInputStream in = null;</pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = null;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      in = new FileInputStream("sample.xls");</pre> 
<pre style="margin-left:0;">      POIFSFileSystem fs = new POIFSFileSystem(in);</pre> 
<pre style="margin-left:0;">      workbook = new HSSFWorkbook(fs);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try{<!-- --></pre> 
<pre style="margin-left:0;">        in.close();</pre> 
<pre style="margin-left:0;">      }catch (IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.getSheetAt(0);//取得序号为0的sheet </pre> 
<pre style="margin-left:0;">    sheet.setZoom(2, 1);//改变sheet的显示比例为200%</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    FileOutputStream out = null;</pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      out = new FileOutputStream("sample2.xls");</pre> 
<pre style="margin-left:0;">      workbook.write(out);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try {<!-- --></pre> 
<pre style="margin-left:0;">        out.close();</pre> 
<pre style="margin-left:0;">      }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">新生成的Excel文件如下图所示。</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">==========</p> 
<p style="margin-left:0cm;"><strong><em>合并单元格</em></strong></p> 
<p style="margin-left:0;text-align:left;">现在再看看如果将指定的单元格进行合并操作。用POI进行合并操作，使用「HSSFSheet」类的「addMergedRegion」方法。</p> 
<p style="margin-left:0;text-align:left;">addMergedRegion</p> 
<p style="margin-left:0;text-align:left;">public int addMergedRegion(Region region)</p> 
<p style="margin-left:0;text-align:left;">adds a merged region of cells (hence those cells form one)</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  region - (rowfrom/colfrom-rowto/colto) to merge</p> 
<p style="margin-left:0;text-align:left;">Returns:</p> 
<p style="margin-left:0;text-align:left;">  index of this region</p> 
<p style="margin-left:0;text-align:left;">参数(Region region)，合并范围必须使用「Region」类来指定，关于「Region」类的介绍如下。</p> 
<p style="margin-left:0;text-align:left;">「Region」类关系图</p> 
<ul><li style="text-align:left;">java.lang.Object</li><li style="text-align:left;">org.apache.poi.hssf.util.Region</li><li style="text-align:left;">public class Region extends java.lang.Object implements java.lang.Comparable</li></ul> 
<p style="margin-left:0;text-align:left;">「Region」类的构造方法</p> 
<p style="margin-left:0;text-align:left;">Region</p> 
<p style="margin-left:0;text-align:left;">public Region(int rowFrom, short colFrom, int rowTo, short colTo)// rowFrom起始行号, colFrom起始列号，rowTo结束行号，colTo结束列号</p> 
<p style="margin-left:0;text-align:left;">--</p> 
<p style="margin-left:0;text-align:left;">指定范围时，从左上的单元格到右下的单元格指定，比方像下面这样。</p> 
<p style="margin-left:0;text-align:left;">Region(1, (short)1, 2, (short)3)</p> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">动手做做看，还是使用原来的Excel文件。</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">把上图选中的单元格进行合并操作时，看下面的程序。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.util.Region;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    FileInputStream in = null;</p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = null;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      in = new FileInputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      POIFSFileSystem fs = new POIFSFileSystem(in);</p> 
<p style="margin-left:0;text-align:left;">      workbook = new HSSFWorkbook(fs);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">        in.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch (IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.getSheetAt(0);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    sheet.addMergedRegion(new Region(1, (short)1, 2, (short)3));//从第2行第2列开始并到第3行，第4列</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample2.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">把刚作成的新的Excel文件打开看看吧</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0;text-align:left;">==========================================异常华丽的分割线=============================================================</p> 
<p style="margin-left:0;text-align:left;"><strong><em>4.</em></strong><strong><em>关于SHEET中的行</em></strong></p> 
<p style="margin-left:0;text-align:left;"><strong><em>HSSFRow</em></strong><strong><em>类定义</em></strong></p> 
<p style="margin-left:0;text-align:left;">用POI在工作表里作成一个行，可以用「HSSFRow」类，它的类定义如下。</p> 
<ul><li style="text-align:left;">java.lang.Object</li><li style="text-align:left;">org.apache.poi.hssf.usermodel.HSSFRow</li><li style="text-align:left;">public class HSSFRow extends java.lang.Object implements java.lang.Comparable</li></ul> 
<p style="margin-left:0;text-align:left;">它的构造方法有三个。</p> 
<table><tbody><tr><td> <p style="margin-left:0;text-align:center;">构造方法</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">protected HSSFRow()</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">protected HSSFRow(Workbook book, Sheet sheet, int rowNum)<br> Creates new HSSFRow from scratch.</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">protected HSSFRow(Workbook book, Sheet sheet, RowRecord record)<br> Creates an HSSFRow from a low level RowRecord object.</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:left;">虽然有三个，但每一个都是protected的，所以不能直接使用它的构造方法，而是用Sheet对象来创建行。</p> 
<p style="margin-left:0;text-align:left;">创建行</p> 
<p style="margin-left:0;text-align:left;">在工作表里创建行，使用「HSSFSheet」类的「createRow」方法，前面也讲过，你可以参照一下『<a href="http://justdoblogger.com/blog/200910/sheetrow_create.html" rel="nofollow" title="Sheet里行的创建">Sheet里行的创建</a>』。</p> 
<p style="margin-left:0;text-align:left;">使用方法如下：</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;">HSSFSheet sheet = workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;">HSSFRow row = sheet.createRow(0);</p> 
<p style="margin-left:0;text-align:left;">取得已经存在的行</p> 
<p style="margin-left:0;text-align:left;">在工作表里取得行，使用「HSSFSheet」类的「getRow」方法，详细内容你可以参照一下『<a href="http://justdoblogger.com/blog/200910/sheetrow_read.html" rel="nofollow" title="Sheet里行的读取">Sheet里行的读取</a>』。</p> 
<p style="margin-left:0;text-align:left;">使用方法如下：</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;">HSSFSheet sheet = workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;">HSSFRow row = sheet.getRow(0);</p> 
<p style="margin-left:0;text-align:left;">=============</p> 
<p style="margin-left:0;text-align:left;"><strong><em>A.</em></strong><strong><em>获取行的状态</em></strong></p> 
<p style="margin-left:0cm;">我们还可以用POI获取当前工作表的行的一些状态，比如获得第一行的序列号，使用「HSSFSheet」类的「getFirstRowNum」方法。</p> 
<pre style="margin-left:0;">getFirstRowNum</pre> 
<pre style="margin-left:0;">public int getFirstRowNum()</pre> 
<pre style="margin-left:0;">gets the first row on the sheet </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Returns:</pre> 
<pre style="margin-left:0;">  the number of the first logical row on the sheet</pre> 
<p style="margin-left:0cm;">还有，获得最后一行的序列号，使用「HSSFSheet」类的「getLastRowNum」方法。</p> 
<pre style="margin-left:0;">getLastRowNum</pre> 
<pre style="margin-left:0;">public int getLastRowNum()</pre> 
<pre style="margin-left:0;">gets the last row on the sheet </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Returns:</pre> 
<pre style="margin-left:0;">  last row contained n this sheet.</pre> 
<p style="margin-left:0cm;">还可以获得实际存在的行的总数，使用「HSSFSheet」类的「getPhysicalNumberOfRows」方法。</p> 
<pre style="margin-left:0;">getPhysicalNumberOfRows</pre> 
<pre style="margin-left:0;">public int getPhysicalNumberOfRows()</pre> 
<pre style="margin-left:0;">Returns the number of phsyically defined rows (NOT the number of rows</pre> 
<pre style="margin-left:0;">in the sheet)</pre> 
<h3 style="margin-left:0cm;"><strong>示例程序</strong></h3> 
<p style="margin-left:0cm;">自己动手做做吧。</p> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFRow;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = new HSSFWorkbook();</pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.createSheet();</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    System.out.println("创建行之前的状态:");</pre> 
<pre style="margin-left:0;">    System.out.println("First:" + sheet.getFirstRowNum());//sheet.getFirstRowNum()获取sheet的第一行行号</pre> 
<pre style="margin-left:0;">    System.out.println("Last:" + sheet.getLastRowNum());//getLastRowNum()获取sheet的最后行行号</pre> 
<pre style="margin-left:0;">    System.out.println("Total:" + sheet.getPhysicalNumberOfRows() + "\n");// getPhysicalNumberOfRows()获取sheet的行总数</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    sheet.createRow(1);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    System.out.println("创建第一行后的状态:");</pre> 
<pre style="margin-left:0;">    System.out.println("First:" + sheet.getFirstRowNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Last:" + sheet.getLastRowNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Total:" + sheet.getPhysicalNumberOfRows() + "\n");</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    sheet.createRow(3);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    System.out.println("创建第三行后的状态:");</pre> 
<pre style="margin-left:0;">    System.out.println("First:" + sheet.getFirstRowNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Last:" + sheet.getLastRowNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Total:" + sheet.getPhysicalNumberOfRows());</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">用上面的代码实行看看。</p> 
<pre style="margin-left:0;">创建行之前的状态:</pre> 
<pre style="margin-left:0;">First:0</pre> 
<pre style="margin-left:0;">Last:0</pre> 
<pre style="margin-left:0;">Total:0</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">创建第一行后的状态:</pre> 
<pre style="margin-left:0;">First:0</pre> 
<pre style="margin-left:0;">Last:1</pre> 
<pre style="margin-left:0;">Total:1</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">创建第三行后的状态:</pre> 
<pre style="margin-left:0;">First:0</pre> 
<pre style="margin-left:0;">Last:3</pre> 
<pre style="margin-left:0;">Total:2</pre> 
<pre style="margin-left:0;">getPhysicalNumberOfRows() 取得是创建的总行数，即存在的行数</pre> 
<p style="margin-left:0;text-align:left;">==================</p> 
<p style="margin-left:0;text-align:left;"><strong><em>B</em></strong><strong><em>．行的创建</em></strong></p> 
<p style="margin-left:0;text-align:left;">之前仅仅新建了Sheet,虽然可以看到新建的Sheet里有无数的单元格,但还不能直接往这些单元格设值。要想往这些单元格里设值,你还必须创建行。<br> 因此，再来看看行创建的方法。<br> 在Sheet里创建行，使用「HSSFSheet」类的「createRow」方法。</p> 
<p style="margin-left:0;text-align:left;">createRow</p> 
<p style="margin-left:0;text-align:left;">public HSSFRow createRow(int rownum)</p> 
<p style="margin-left:0;text-align:left;">Create a new row within the sheet and return the high</p> 
<p style="margin-left:0;text-align:left;">level representation</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  rownum - row number</p> 
<p style="margin-left:0;text-align:left;">Returns:</p> 
<p style="margin-left:0;text-align:left;">  High level HSSFRow object representing a row in the sheet</p> 
<p style="margin-left:0;text-align:left;">(int rownum)创建指定行号的行。行号是从0开始的整数，最大是65535，可以支持65536行。创建行所返回的值是「HSSFRow」类对象，关于「HSSFRow」类定义的说明，以后再详细说。<br> 创建方法很多，要说详细挺复杂。比方说，即使第一行（行号为0）和第二行不创建，也能直接创建第三行。</p> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">亲自动手做一下吧。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = new HSSFWorkbook();//创建个空白的workbook</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.createSheet();//创建个空白的sheet</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row = sheet.createRow(2);//创建行号为2的行，excel中的第三行</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell = row.createCell((short)0);//创建上面行的第一个单元格</p> 
<p style="margin-left:0;text-align:left;">    cell.setCellValue("test");//将test写入单元格</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">在上面的程序里，生成一个Sheet，然后单独创建了第三行（行号为2），接着又创建了一个单元格，最后给这个单元格设了值。执行后，打开「sample.xls」文件看看。</p> 
<p style="margin-left:0;text-align:center;"> </p> 
<p style="margin-left:0;text-align:left;">可以看到，在第三行第一列，值已经被设定好了。</p> 
<p style="margin-left:0;text-align:left;">================</p> 
<p style="margin-left:0;text-align:left;"><strong><em>C</em></strong><strong><em>．行的读取</em></strong></p> 
<p style="margin-left:0;text-align:left;">要取得Sheet里的某一行，可以使用「HSSFSheet」类的「getRow」方法。</p> 
<p style="margin-left:0;text-align:left;">getRow</p> 
<p style="margin-left:0;text-align:left;">public HSSFRow getRow(int rownum)</p> 
<p style="margin-left:0;text-align:left;">Returns the logical row (not physical) 0-based. If you ask for a row</p> 
<p style="margin-left:0;text-align:left;">that is not defined you get a null. This is to say row 4 represents</p> 
<p style="margin-left:0;text-align:left;">the fifth row on a sheet.</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  rownum - row to get</p> 
<p style="margin-left:0;text-align:left;">Returns:</p> 
<p style="margin-left:0;text-align:left;">  HSSFRow representing the rownumber or null if its not defined on the</p> 
<p style="margin-left:0;text-align:left;">    sheet</p> 
<p style="margin-left:0;text-align:left;">利用行号取得指定的行。如果行不存在，则返回NULL。</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">动手做做看。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row = sheet.createRow(1);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    for (int i = 0 ; i &lt; 3 ; i++){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      HSSFRow r = sheet.getRow(i);</p> 
<p style="margin-left:0;text-align:left;">      if (r  == null){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println("第" + i + "行不存在。");</p> 
<p style="margin-left:0;text-align:left;">      }else{<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println("第" + i + "行取得成功。");</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">上面的程序里，先创建一个Sheet，然后创建第二行（行号为1）。最后读取第一行到第三行的三行。结果如下。</p> 
<p style="margin-left:0;text-align:left;">第0行不存在。</p> 
<p style="margin-left:0;text-align:left;">第1行取得成功。</p> 
<p style="margin-left:0;text-align:left;">第2行不存在。</p> 
<p style="margin-left:0;text-align:left;">这和予想的一样。</p> 
<p style="margin-left:0;text-align:left;"><strong><em>读取有值的行</em></strong></p> 
<p style="margin-left:0;text-align:left;">按照下图准备一个Excel文件。</p> 
<p style="margin-left:0;text-align:center;"> </p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    FileInputStream in = null;</p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = null;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      in = new FileInputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      POIFSFileSystem fs = new POIFSFileSystem(in);</p> 
<p style="margin-left:0;text-align:left;">      workbook = new HSSFWorkbook(fs);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">        in.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch (IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.getSheetAt(0);//读取序号为0的sheet</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    for (int i = 0 ; i &lt; 3 ; i++){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      HSSFRow r = sheet.getRow(i);</p> 
<p style="margin-left:0;text-align:left;">      if (r  == null){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println("第" + i + "行不存在。");</p> 
<p style="margin-left:0;text-align:left;">      }else{<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println("第" + i + "行取得成功。");</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">结果如下。</p> 
<p style="margin-left:0;text-align:left;">第0行取得成功。</p> 
<p style="margin-left:0;text-align:left;">第1行取得成功。</p> 
<p style="margin-left:0;text-align:left;">第2行不存在。</p> 
<p style="margin-left:0;text-align:left;">从上面的例子可以看出，如果当前行有值的话，那么读取这一行时肯定存在。</p> 
<p style="margin-left:0;text-align:left;"><strong><em>从取得的行里获取单元格的值。</em></strong></p> 
<p style="margin-left:0;text-align:left;">这一次从已经取得的行里获取单元格的值。仍然使用刚才的Excel文件。用getRow方法先取得行对象，再从单元格里获取值。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    FileInputStream in = null;</p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = null;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      in = new FileInputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      POIFSFileSystem fs = new POIFSFileSystem(in);</p> 
<p style="margin-left:0;text-align:left;">      workbook = new HSSFWorkbook(fs);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">        in.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch (IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.getSheetAt(0);//读取序号为0的sheet</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row = sheet.getRow(1);//取得sheet中第二行（行号1）</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell = row.getCell((short)1);//取得第二行，第二格（单元格号1）</p> 
<p style="margin-left:0;text-align:left;">    System.out.println(cell.getStringCellValue());//cell.getStringCellValue()取值</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">结果如下。</p> 
<p style="margin-left:0;text-align:left;">sample</p> 
<p style="margin-left:0;text-align:left;">可以看出，把第二行第二列的值取出来了。</p> 
<p style="margin-left:0;text-align:left;">===================</p> 
<p style="margin-left:0;text-align:left;"><strong><em>在现有的行上创建行（貌似没什么用啊）</em></strong></p> 
<p style="margin-left:0;text-align:left;">最后，再来试试看，在现有的行上，用「createRow」方法创建一行看看会是什么结果。还是使用刚才的Excel文件，在第二行上创建一行，再把值取出来。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    FileInputStream in = null;</p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = null;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      in = new FileInputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      POIFSFileSystem fs = new POIFSFileSystem(in);</p> 
<p style="margin-left:0;text-align:left;">      workbook = new HSSFWorkbook(fs);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">        in.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch (IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.getSheetAt(0);//取得0sheet</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row = sheet.createRow(1);//在已经有第二行的情况下再建第二行</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell = row.getCell((short)1);//取得新建第二行的值</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    System.out.println(cell.getStringCellValue());</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">结果如下。</p> 
<p style="margin-left:0;text-align:left;">Exception in thread "main" java.lang.NullPointerException</p> 
<p style="margin-left:0;text-align:left;">        at POISample.main(POISample.java:35)</p> 
<p style="margin-left:0;text-align:left;">发生了空指针异常。本来对于已经存在的行用「createRow」方法进行创建行操作，可能你会以为会复制原来的行，但事实并非如此。<br> 让我们在原来程序的基础上再稍作一些变化，已经存在的行用「createRow」方法进行创建行操作后，再在该行的空白单元格设上值，保存为新的文件。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    FileInputStream in = null;</p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = null;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      in = new FileInputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      POIFSFileSystem fs = new POIFSFileSystem(in);</p> 
<p style="margin-left:0;text-align:left;">      workbook = new HSSFWorkbook(fs);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">        in.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch (IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.getSheetAt(0);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row = sheet.createRow(1);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell = row.createCell((short)3);</p> 
<p style="margin-left:0;text-align:left;">    cell.setCellValue("news");</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample2.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">执行上面程序后，打开新的Excel文件如下。</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">对于已经存在的行再用「createRow」方法执行的话，那从原来行里有值的单元格取值时会发生空指针异常。但如果新创建一个单元格再设值的话，那之前单元格的值也会被保留下来。虽然是猜测，不过大家可以自己亲自动手来验证一下。</p> 
<p style="margin-left:0;text-align:left;">=======================</p> 
<p style="margin-left:0;text-align:left;"><strong><em>D</em></strong><strong><em>．移动行</em></strong></p> 
<p style="margin-left:0cm;">如果要移动某一行的话,可以使用「HSSFSheet」类的「shiftRows」方法。</p> 
<pre style="margin-left:0;">shiftRows</pre> 
<pre style="margin-left:0;">public void shiftRows(int startRow, int endRow, int n)</pre> 
<pre style="margin-left:0;">Shifts rows between startRow and endRow n number of rows. If you use</pre> 
<pre style="margin-left:0;">a negative number, it will shift rows up. Code ensures that rows don't</pre> 
<pre style="margin-left:0;">wrap around. Calls shiftRows(startRow, endRow, n, false, false); </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Additionally shifts merged regions that are completely defined in</pre> 
<pre style="margin-left:0;">these rows (ie. merged 2 cells on a row to be shifted). </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Parameters:</pre> 
<pre style="margin-left:0;">  startRow - the row to start shifting</pre> 
<pre style="margin-left:0;">  endRow - the row to end shifting</pre> 
<pre style="margin-left:0;">   n - the number of rows to shift</pre> 
<p style="margin-left:0cm;">int startRow, int endRow：指定要移动的行的范围从「startRow」行到「endRow」行。</p> 
<p style="margin-left:0cm;">int n：「n」如果是正数就往下移动的行数，如果为负，就往上移动。</p> 
<h3 style="margin-left:0cm;"><strong>示例程序</strong></h3> 
<p style="margin-left:0cm;">按下图准备一个Excel文件。</p> 
<p style="margin-left:0cm;"> </p> 
<pre style="margin-left:0;">import java.io.*;</pre> 
<pre style="margin-left:0;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFRow;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    FileInputStream in = null;</pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = null;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      in = new FileInputStream("sample.xls");</pre> 
<pre style="margin-left:0;">      POIFSFileSystem fs = new POIFSFileSystem(in);</pre> 
<pre style="margin-left:0;">      workbook = new HSSFWorkbook(fs);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try{<!-- --></pre> 
<pre style="margin-left:0;">        in.close();</pre> 
<pre style="margin-left:0;">      }catch (IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.getSheetAt(0);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    sheet.shiftRows(1, 2, 2);//第二行和第三行向下移动两行</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    FileOutputStream out = null;</pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      out = new FileOutputStream("sample2.xls");</pre> 
<pre style="margin-left:0;">      workbook.write(out);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try {<!-- --></pre> 
<pre style="margin-left:0;">        out.close();</pre> 
<pre style="margin-left:0;">      }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">打开新建的Sample2.xls文件看看。</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">从上图可以看出，第二行和第三行的内容已经移动到第四行和第五行，并覆盖原第四行和第五行的内容。但第二行到第五行的行高却维持原样没有变化。<br> 再来看看有没有办法可以既移动内容，又可以移动行高呢？从帮助文档里可以看出，对于「shiftRows」方法，还有另外一种用法。</p> 
<pre style="margin-left:0;">shiftRows</pre> 
<pre style="margin-left:0;">public void shiftRows(int startRow, int endRow, int n,</pre> 
<pre style="margin-left:0;">              boolean copyRowHeight, boolean resetOriginalRowHeight)</pre> 
<pre style="margin-left:0;">Shifts rows between startRow and endRow n number of rows. If you use</pre> 
<pre style="margin-left:0;">a negative number, it will shift rows up. Code ensures that rows don't</pre> 
<pre style="margin-left:0;">wrap around </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Additionally shifts merged regions that are completely defined in</pre> 
<pre style="margin-left:0;">these rows (ie. merged 2 cells on a row to be shifted). </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">TODO Might want to add bounds checking here </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Parameters:</pre> 
<pre style="margin-left:0;">  startRow - the row to start shifting</pre> 
<pre style="margin-left:0;">  endRow - the row to end shifting</pre> 
<pre style="margin-left:0;">  n - the number of rows to shift</pre> 
<pre style="margin-left:0;">  copyRowHeight - whether to copy the row height during the shift</pre> 
<pre style="margin-left:0;">  resetOriginalRowHeight - whether to set the original row's height</pre> 
<pre style="margin-left:0;">    to the default</pre> 
<p style="margin-left:0cm;">前面3个参数和之前一样。如要使行高也一起移动的话，设置「copyRowHeight」参数为「true」。<br> 还有，移动后，原来的行是保留原行高不变还是恢复到默认行高呢？可以设置「resetOriginalRowHeight」参数。为「true」时，则可以恢复到默认行高。反之则保留原行高不变。</p> 
<h3 style="margin-left:0cm;"><strong>示例程序</strong></h3> 
<pre style="margin-left:0;">import java.io.*;</pre> 
<pre style="margin-left:0;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFRow;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    FileInputStream in = null;</pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = null;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      in = new FileInputStream("sample.xls");</pre> 
<pre style="margin-left:0;">      POIFSFileSystem fs = new POIFSFileSystem(in);</pre> 
<pre style="margin-left:0;">      workbook = new HSSFWorkbook(fs);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try{<!-- --></pre> 
<pre style="margin-left:0;">        in.close();</pre> 
<pre style="margin-left:0;">      }catch (IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.getSheetAt(0);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    sheet.shiftRows(1, 2, 2, true, true);//第二行和第三行保留原来高度向下移动两行，原栏位恢复默认高度</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    FileOutputStream out = null;</pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      out = new FileOutputStream("sample2.xls");</pre> 
<pre style="margin-left:0;">      workbook.write(out);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try {<!-- --></pre> 
<pre style="margin-left:0;">        out.close();</pre> 
<pre style="margin-left:0;">      }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">再打开新生成的Sample2.xls文件来看看。</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">从上图可以看出，移动后，原行高也被移动了，而原行则恢复到默认行高。</p> 
<p style="margin-left:0cm;">===================</p> 
<p style="margin-left:0;text-align:left;">==========================================异常华丽的分割线=============================================================</p> 
<p style="margin-left:0;text-align:justify;"><strong><em>关于单元格</em></strong></p> 
<p style="margin-left:0;text-align:justify;"><strong><em>HSSFCell</em></strong><strong><em>类定义</em></strong></p> 
<p style="margin-left:0;text-align:left;">这一章开始介绍单元格，其实前面一章已经提到过了，用POI创建单元格，使用「HSSFCell」类，类定义如下。</p> 
<ul><li style="text-align:left;">java.lang.Object</li><li style="text-align:left;">org.apache.poi.hssf.usermodel.HSSFCell</li><li style="text-align:left;">public class HSSFCell extends java.lang.Object</li></ul> 
<p style="margin-left:0;text-align:left;">该类包含三个构造方法。</p> 
<table><tbody><tr><td> <p style="margin-left:0;text-align:center;"><strong>构造方法</strong></p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">protected HSSFCell(Workbook book, Sheet sheet, int row, CellValueRecordInterface cval)<br> Creates an HSSFCell from a CellValueRecordInterface.</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">protected HSSFCell(Workbook book, Sheet sheet, int row, short col)<br> Creates new Cell – Should only be called by HSSFRow.</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">protected HSSFCell(Workbook book, Sheet sheet, int row, short col, int type)<br> Deprecated. As of 22-Jan-2002 use @see org.apache.poi.hssf.usermodel.HSSFRow<br> #createCell(short) and use setCellValue to specify the type lazily.</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:left;">同之前一样，虽然有三个构造方法，但都是protected类型的，所以直接用构造方法创建单元格行不通，只能通过行来创建单元格。</p> 
<p style="margin-left:0;text-align:left;"><strong>创建单元格</strong></p> 
<p style="margin-left:0;text-align:left;">在一个工作表里创建一个单元格，必须用「HSSFRow」类的「createCell」方法，详细请参照『<a href="http://justdoblogger.com/blog/200910/createcell.html" rel="nofollow" title="行里创建单元格">行里创建单元格</a>』。</p> 
<p style="margin-left:0;text-align:left;">使用方法如下：</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;">HSSFSheet sheet = workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;">HSSFRow row = sheet.createRow(0);</p> 
<p style="margin-left:0;text-align:left;">HSSFCell cell = row.createCell((short)2);</p> 
<p style="margin-left:0;text-align:left;"><strong>读取现有单元格</strong></p> 
<p style="margin-left:0;text-align:left;">要读取某一行现有的单元格，使用「HSSFRow」类的「getCell」方法，详细请参照『<a href="http://justdoblogger.com/blog/200910/getcell.html" rel="nofollow" title="读取单元格">读取单元格</a>』。</p> 
<p style="margin-left:0;text-align:left;">使用方法如下：</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;">HSSFSheet sheet = workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;">HSSFRow row = sheet.getRow(0);</p> 
<p style="margin-left:0;text-align:left;">HSSFCell cell = row.getCell((short)2);</p> 
<p style="margin-left:0;text-align:left;">==========</p> 
<p style="margin-left:0cm;"><strong><em>行里创建单元格</em></strong></p> 
<p style="margin-left:0cm;">下面来看看如何在取得现有行或者在新创建的行里，再创建一个单元格。用POI来创建的话，使用「HSSFRow」类的「createCell」方法。</p> 
<pre style="margin-left:0;">createCell</pre> 
<pre style="margin-left:0;">public HSSFCell createCell(short column)</pre> 
<pre style="margin-left:0;">Use this to create new cells within the row and return it. </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">The cell that is returned is a CELL_TYPE_BLANK. The type can be</pre> 
<pre style="margin-left:0;">changed either through calling setCellValue or setCellType. </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Parameters:</pre> 
<pre style="margin-left:0;">  column - - the column number this cell represents</pre> 
<pre style="margin-left:0;">Returns:</pre> 
<pre style="margin-left:0;">  HSSFCell a high level representation of the created cell.</pre> 
<p style="margin-left:0cm;">(short column)创建指定列号的单元格。列号和行号一样，也是从0开始数的。创建的单元格以「HSSFCell」类的对象返回，关于「HSSFCell」类的介绍，我们放在下面几章进行。</p> 
<h3 style="margin-left:0cm;"><strong>示例程序</strong></h3> 
<p style="margin-left:0cm;">自己动手做做看吧。</p> 
<pre style="margin-left:0;">import java.io.*;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFRow;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFCell;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = new HSSFWorkbook();</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.createSheet();</pre> 
<pre style="margin-left:0;">    HSSFRow row = sheet.createRow(1);//创建序号为1的行，第2行</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFCell cell = row.createCell((short)2);//创建序号为2的单元格，第二行第3格</pre> 
<pre style="margin-left:0;">    cell.setCellValue("test");//写入test</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    FileOutputStream out = null;</pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      out = new FileOutputStream("sample.xls");</pre> 
<pre style="margin-left:0;">      workbook.write(out);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try {<!-- --></pre> 
<pre style="margin-left:0;">        out.close();</pre> 
<pre style="margin-left:0;">      }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">上面的例子里，先创建一个工作表Sheet,然后在工作表里只创建第二行，最后再在这一行创建一个新的单元格，并设上一个值。实行这个程序会生成「sample.xls」这样的Excel文件，打开来看看吧。</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">从图中可以看到，第一行（行号为1，实际是第3行）的第二列（列号是2，实际是第3列）的单元格里，被赋上了值。</p> 
<p style="margin-left:0cm;">==============</p> 
<p style="margin-left:0cm;"><strong><em>读取单元格</em></strong></p> 
<p style="margin-left:0cm;">如果要从现有的行里取得某一个单元格，POI提供了「HSSFRow」类的「getCell」方法。</p> 
<pre style="margin-left:0;">getCell</pre> 
<pre style="margin-left:0;">public HSSFCell getCell(short cellnum)</pre> 
<pre style="margin-left:0;">get the hssfcell representing a given column (logical cell)</pre> 
<pre style="margin-left:0;">0-based.</pre> 
<pre style="margin-left:0;">If you ask for a cell that is not defined....you get a null. </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Parameters:</pre> 
<pre style="margin-left:0;">  cellnum - 0 based column number</pre> 
<pre style="margin-left:0;">Returns:</pre> 
<pre style="margin-left:0;">  HSSFCell representing that column or null if undefined.</pre> 
<p style="margin-left:0cm;">(short cellnum)取得指定列号的单元格。如果是不存在的单元格，会返回「null」。</p> 
<h3 style="margin-left:0cm;"><strong>示例程序</strong></h3> 
<p style="margin-left:0cm;">再来动手做做吧。</p> 
<pre style="margin-left:0;">import java.io.*;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFRow;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFCell;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = new HSSFWorkbook();</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.createSheet();</pre> 
<pre style="margin-left:0;">    HSSFRow row = sheet.createRow(1);//创建第二行</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFCell cell = row.createCell((short)2);//创建第二行第三格</pre> 
<pre style="margin-left:0;">    cell.setCellValue("test");//第二行第三格写入test</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    for (int i = 0 ; i &lt; 3 ; i++){<!-- --></pre> 
<pre style="margin-left:0;">      HSSFCell c = row.getCell((short)i);</pre> 
<pre style="margin-left:0;">      if (c  == null){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println("第" + i + "列单元格不存在");</pre> 
<pre style="margin-left:0;">      }else{<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println("第" + i + "列单元格获取成功");</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">上面的例子里，先做成一行（行号为1），然后在这一行的第2列（行号为2）创建单元格，最后再从第0列到第2列依次取得单元格，结果如下：</p> 
<pre style="margin-left:0;">第0列单元格不存在</pre> 
<pre style="margin-left:0;">第1列单元格不存在</pre> 
<pre style="margin-left:0;">第2列单元格获取成功</pre> 
<pre style="margin-left:0;">===============</pre> 
<h3 style="margin-left:0cm;"><strong>读取有值的Excel表格</strong></h3> 
<p style="margin-left:0cm;">像下面那样准备一个Excel表格来做做看。</p> 
<p style="margin-left:0cm;"> </p> 
<pre style="margin-left:0;">import java.io.*;</pre> 
<pre style="margin-left:0;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFRow;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFCell;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    FileInputStream in = null;</pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = null;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      in = new FileInputStream("sample.xls");</pre> 
<pre style="margin-left:0;">      POIFSFileSystem fs = new POIFSFileSystem(in);</pre> 
<pre style="margin-left:0;">      workbook = new HSSFWorkbook(fs);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try{<!-- --></pre> 
<pre style="margin-left:0;">        in.close();</pre> 
<pre style="margin-left:0;">      }catch (IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.getSheetAt(0);//取得第一张sheet</pre> 
<pre style="margin-left:0;">    HSSFRow row = sheet.getRow(1);//第2行</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    for (int i = 0 ; i &lt; 3 ; i++){<!-- --></pre> 
<pre style="margin-left:0;">      HSSFCell c = row.getCell((short)i);</pre> 
<pre style="margin-left:0;">      if (c  == null){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println("第" + i + "列单元格不存在");</pre> 
<pre style="margin-left:0;">      }else{<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println("第" + i + "列单元格取得成功");</pre> 
<pre style="margin-left:0;">        System.out.println("单元格的值：" + c.getStringCellValue());//getStringCellValue()取得单元格的值</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">结果如下：</p> 
<pre style="margin-left:0;">第0列单元格取得成功</pre> 
<pre style="margin-left:0;">单元格的值：cell a-2</pre> 
<pre style="margin-left:0;">第1列单元格不存在</pre> 
<pre style="margin-left:0;">第2列单元格取得成功</pre> 
<pre style="margin-left:0;">单元格的值：cell c-2</pre> 
<p style="margin-left:0;text-align:left;">===========</p> 
<p style="margin-left:0;text-align:left;"><strong><em>POI</em></strong><strong><em>向单元格写入值</em></strong></p> 
<p style="margin-left:0;text-align:left;">前面介绍了如何用POI获取单元格的值，这一节介绍如何用POI向单元格里设定值。和之前获取值一样，对于不同类型的值，写入的方法也是不同的。</p> 
<table><tbody><tr><td> <p style="margin-left:0;text-align:center;"><strong>值</strong></p> </td><td> <p style="margin-left:0;text-align:center;"><strong>方法</strong></p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">boolean</p> </td><td> <p style="margin-left:0;text-align:left;">setCellValue(boolean value)</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">date</p> </td><td> <p style="margin-left:0;text-align:left;">setCellValue(java.util.Calendar value)</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">date</p> </td><td> <p style="margin-left:0;text-align:left;">setCellValue(java.util.Date value)</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">numeric</p> </td><td> <p style="margin-left:0;text-align:left;">setCellValue(double value)</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">string</p> </td><td> <p style="margin-left:0;text-align:left;">setCellValue(java.lang.String value)</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:left;">方法名称相同，但参数类型不同，这样的方法有5个。关于日期型的方法，有Calender型和Date型两种。</p> 
<p style="margin-left:0;text-align:left;">当然，POI也可以写入Error值和计算式。</p> 
<table><tbody><tr><td> <p style="margin-left:0;text-align:center;"><strong>值</strong></p> </td><td> <p style="margin-left:0;text-align:center;"><strong>方法</strong></p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">error value</p> </td><td> <p style="margin-left:0;text-align:left;">setCellErrorValue(byte value)</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">Formula</p> </td><td> <p style="margin-left:0;text-align:left;">setCellFormula(java.lang.String formula)</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:left;">先统一看一下各种方法的Doc文档说明吧。</p> 
<p style="margin-left:0;text-align:left;"><strong>setCellValue(boolean value)</strong></p> 
<p style="margin-left:0;text-align:left;">写入boolean型使用「setCellValue(boolean value)」方法。</p> 
<p style="margin-left:0;text-align:left;">setCellValue</p> 
<p style="margin-left:0;text-align:left;">public void setCellValue(boolean value)</p> 
<p style="margin-left:0;text-align:left;">set a boolean value for the cell</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  value - the boolean value to set this cell to. For formulas</p> 
<p style="margin-left:0;text-align:left;">    we'll set the precalculated value, for booleans we'll set</p> 
<p style="margin-left:0;text-align:left;">    its value. For other types we will change the cell to a</p> 
<p style="margin-left:0;text-align:left;">    boolean cell and set its value.</p> 
<p style="margin-left:0;text-align:left;">如果对象单元格不是boolean型的话，则自动转换为boolean型写入。</p> 
<p style="margin-left:0;text-align:left;"><strong>setCellValue(java.util.Calendar value)</strong></p> 
<p style="margin-left:0;text-align:left;">写入Calendar型使用「setCellValue(java.util.Calendar value)」方法。</p> 
<p style="margin-left:0;text-align:left;">setCellValue</p> 
<p style="margin-left:0;text-align:left;">public void setCellValue(java.util.Calendar value)</p> 
<p style="margin-left:0;text-align:left;">set a date value for the cell. Excel treats dates as numeric</p> 
<p style="margin-left:0;text-align:left;">so you will need to format the cell as a date.</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  value - the date value to set this cell to. For formulas</p> 
<p style="margin-left:0;text-align:left;">    we'll set the precalculated value, for numerics we'll</p> 
<p style="margin-left:0;text-align:left;">    set its value. For othertypes we will change the cell</p> 
<p style="margin-left:0;text-align:left;">    to a numeric cell and set its value.</p> 
<p style="margin-left:0;text-align:left;">Calendar型的值是作为数值型写入的，如何想表示为日期型的话，需要做格式转换处理。如果对象单元格不是数值型的话，则自动转换为数值型写入。</p> 
<p style="margin-left:0;text-align:left;"><strong>setCellValue(java.util.Date value)</strong></p> 
<p style="margin-left:0;text-align:left;">写入Date型使用「setCellValue(java.util.Date value)」方法。</p> 
<p style="margin-left:0;text-align:left;">setCellValue</p> 
<p style="margin-left:0;text-align:left;">public void setCellValue(java.util.Date value)</p> 
<p style="margin-left:0;text-align:left;">set a date value for the cell. Excel treats dates as numeric</p> 
<p style="margin-left:0;text-align:left;">so you will need to format the cell as a date.</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  value - the date value to set this cell to. For formulas</p> 
<p style="margin-left:0;text-align:left;">    we'll set the precalculated value, for numerics we'll</p> 
<p style="margin-left:0;text-align:left;">    set its value. For other types we will change the cell</p> 
<p style="margin-left:0;text-align:left;">    to a numeric cell and set its value.</p> 
<p style="margin-left:0;text-align:left;">Date型的值是作为数值型写入的，如何想表示为日期型的话，需要做格式转换处理。如果对象单元格不是数值型的话，则自动转换为数值型写入。</p> 
<p style="margin-left:0;text-align:left;"><strong>setCellValue(double value)</strong></p> 
<p style="margin-left:0;text-align:left;">写入数值型使用「setCellValue(double value)」方法。</p> 
<p style="margin-left:0;text-align:left;">setCellValue</p> 
<p style="margin-left:0;text-align:left;">public void setCellValue(double value)</p> 
<p style="margin-left:0;text-align:left;">set a numeric value for the cell</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  value - the numeric value to set this cell to. For formulas</p> 
<p style="margin-left:0;text-align:left;">    we'll set the precalculated value, for numerics we'll</p> 
<p style="margin-left:0;text-align:left;">    set its value. For other types we will change the cell</p> 
<p style="margin-left:0;text-align:left;">    to a numeric cell and set its value.</p> 
<p style="margin-left:0;text-align:left;">如果对象单元格不是数值型的话，则自动转换为数值型写入。</p> 
<p style="margin-left:0;text-align:left;"><strong>setCellValue(java.lang.String value)</strong></p> 
<p style="margin-left:0;text-align:left;">写入字符串型使用「setCellValue(java.lang.String value)」方法。</p> 
<p style="margin-left:0;text-align:left;">setCellValue</p> 
<p style="margin-left:0;text-align:left;">public void setCellValue(java.lang.String value)</p> 
<p style="margin-left:0;text-align:left;">set a string value for the cell. Please note that if you are</p> 
<p style="margin-left:0;text-align:left;">using full 16 bit unicode you should call setEncoding() first.</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  value - value to set the cell to. For formulas we'll set</p> 
<p style="margin-left:0;text-align:left;">    the formula string, for String cells we'll set its value.</p> 
<p style="margin-left:0;text-align:left;">    For other types we will change the cell to a string cell</p> 
<p style="margin-left:0;text-align:left;">    and set its value. If value is null then we will change</p> 
<p style="margin-left:0;text-align:left;">    the cell to a Blank cell.</p> 
<p style="margin-left:0;text-align:left;">要写入中文等文字的话，必须要先使用「setEncoding」方法进行转换。如果对象单元格不是字符串型的话，则自动转换为字符串型写入。还有，如果写入的值是”null”的话，则单元格为空白。</p> 
<p style="margin-left:0;text-align:left;"><strong>setCellErrorValue(byte value)</strong></p> 
<p style="margin-left:0;text-align:left;">写入Error型使用「setCellErrorValue(byte value)」方法。</p> 
<p style="margin-left:0;text-align:left;">setCellErrorValue</p> 
<p style="margin-left:0;text-align:left;">public void setCellErrorValue(byte value)</p> 
<p style="margin-left:0;text-align:left;">set a error value for the cell</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  value - the error value to set this cell to. For formulas</p> 
<p style="margin-left:0;text-align:left;">    we'll set the precalculated value ??? IS THIS RIGHT??? ,</p> 
<p style="margin-left:0;text-align:left;">    for errors we'll set its value. For other types we will</p> 
<p style="margin-left:0;text-align:left;">    change the cell to an error cell and set its value.</p> 
<p style="margin-left:0;text-align:left;">如果对象单元格不是Error型的话，则自动转换为Error型写入。</p> 
<p style="margin-left:0;text-align:left;"><strong>setCellFormula</strong></p> 
<p style="margin-left:0;text-align:left;">写入计算式使用「setCellFormula」方法。</p> 
<p style="margin-left:0;text-align:left;">setCellFormula</p> 
<p style="margin-left:0;text-align:left;">public void setCellFormula(java.lang.String formula)</p> 
<p style="margin-left:0;text-align:left;">--</p> 
<p style="margin-left:0;text-align:left;">写入计算式方法的参数虽然是字符串，但Doc文档里一点说明也没有。</p> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">下面仍然自己动手做一下吧。需要注意的是，对于日期型是作为数值写入的，而数值到底表示什么样的日期是看不出来的，这时只能通过另外指定日期格式。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;">import java.util.Calendar;</p> 
<p style="margin-left:0;text-align:left;">import java.util.Date;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFErrorConstants;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row = sheet.createRow(1);//创建第二行</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell1 = row.createCell((short)0);//2,1格</p> 
<p style="margin-left:0;text-align:left;">    cell1.setCellValue(true);//写入true</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell2 = row.createCell((short)1);//2,2格</p> 
<p style="margin-left:0;text-align:left;">    Calendar cal = Calendar.getInstance();//Calendar？？？</p> 
<p style="margin-left:0;text-align:left;">    cell2.setCellValue(cal);//写入Calendar型对象cal</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell3 = row.createCell((short)2);//2,3格</p> 
<p style="margin-left:0;text-align:left;">    Date date = new Date(); //日期型</p> 
<p style="margin-left:0;text-align:left;">    cell3.setCellValue(date);//写入日期型</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell4 = row.createCell((short)3);//2,4格</p> 
<p style="margin-left:0;text-align:left;">    cell4.setCellValue(150);//写入150</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell5 = row.createCell((short)4);//2.5格</p> 
<p style="margin-left:0;text-align:left;">    cell5.setCellValue("hello");//写入hello</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row2 = sheet.createRow(2);//第三行</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell6 = row2.createCell((short)0);//3,1格</p> 
<p style="margin-left:0;text-align:left;">    cell6.setCellErrorValue(HSSFErrorConstants.ERROR_NUM);//写入error型</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">运行结果如下：</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">关于计算式和中文文字的写入,下面几节里将会有具体介绍,还有包括日期型的格式指定。</p> 
<p style="margin-left:0;text-align:left;">===============</p> 
<p style="margin-left:0;text-align:left;"><strong><em>POI</em></strong><strong><em>中写入中文</em></strong></p> 
<p style="margin-left:0cm;">如果你现在下载最新版的POI开发包，你会发现，用POI向单元格里写入字符串时，如果是中文文字或者日文文字的话，已经不需要指定Unicode了，直接就可以显示汉字。之前版本存在的「HSSFCell」类的「setEncoding」方法已经被删除了。下面是被删除的方法说明。</p> 
<pre style="margin-left:0;">setEncoding</pre> 
<pre style="margin-left:0;">public void setEncoding(short encoding)</pre> 
<pre style="margin-left:0;">set the encoding to either 8 or 16 bit. (US/UK use 8-bit,</pre> 
<pre style="margin-left:0;">rest of the western world use 16bit) </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Parameters:</pre> 
<pre style="margin-left:0;">  encoding - either ENCODING_COMPRESSED_UNICODE (0)</pre> 
<pre style="margin-left:0;">    or ENCODING_UTF_16 (1)</pre> 
<h3 style="margin-left:0cm;"><strong>示例程序</strong></h3> 
<p style="margin-left:0cm;">用下面程序来做做看。</p> 
<pre style="margin-left:0;">import java.io.*;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFRow;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFCell;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = new HSSFWorkbook();</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.createSheet();</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFRow row1 = sheet.createRow(1);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFCell cell1 = row1.createCell((short)0);</pre> 
<pre style="margin-left:0;">    //cell1.setEncoding(HSSFCell.ENCODING_UTF_16);</pre> 
<pre style="margin-left:0;">    cell1.setCellValue("使用中文");</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFCell cell2 = row1.createCell((short)1);</pre> 
<pre style="margin-left:0;">    //cell2.setEncoding(HSSFCell.ENCODING_COMPRESSED_UNICODE);</pre> 
<pre style="margin-left:0;">    cell2.setCellValue("日本語を使う");</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    FileOutputStream out = null;</pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      out = new FileOutputStream("sample.xls");</pre> 
<pre style="margin-left:0;">      workbook.write(out);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try {<!-- --></pre> 
<pre style="margin-left:0;">        out.close();</pre> 
<pre style="margin-left:0;">      }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">运行结果如下：</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0;text-align:justify;"><strong><em>=============</em></strong></p> 
<p style="margin-left:0;text-align:justify;"><strong><em>POI</em></strong><strong><em>获取单元格类值类型</em></strong></p> 
<p style="margin-left:0;text-align:left;">在获取单元格值的时候，不同类型，使用的方法也不一样，所以获取之前，必须要知道类型。这一节就来介绍如何知道单元格里的值是何类型。</p> 
<p style="margin-left:0;text-align:left;">要获取单元格值的类型，使用「HSSFCell」类的「getCellType」方法。</p> 
<p style="margin-left:0;text-align:left;">getCellType</p> 
<p style="margin-left:0;text-align:left;">public int getCellType()</p> 
<p style="margin-left:0;text-align:left;">get the cells type (numeric, formula or string)</p> 
<p style="margin-left:0;text-align:left;">下面就是类型和定义值的一览表。</p> 
<table><tbody><tr><td style="width:46.75pt;"> <p style="margin-left:0;text-align:center;"><strong>Cell type</strong></p> </td><td style="width:93.5pt;"> <p style="margin-left:0;text-align:center;"><strong>定义值</strong></p> </td><td style="width:46.75pt;"> <p style="margin-left:0;text-align:center;"><strong>值(int)</strong></p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">Blank</p> </td><td> <p style="margin-left:0;text-align:left;">CELL_TYPE_BLANK</p> </td><td> <p style="margin-left:0;text-align:left;">3</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">Boolean</p> </td><td> <p style="margin-left:0;text-align:left;">CELL_TYPE_BOOLEAN</p> </td><td> <p style="margin-left:0;text-align:left;">4</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">Error</p> </td><td> <p style="margin-left:0;text-align:left;">CELL_TYPE_ERROR</p> </td><td> <p style="margin-left:0;text-align:left;">5</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">Formula</p> </td><td> <p style="margin-left:0;text-align:left;">CELL_TYPE_FORMULA</p> </td><td> <p style="margin-left:0;text-align:left;">2</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">Numeric</p> </td><td> <p style="margin-left:0;text-align:left;">CELL_TYPE_NUMERIC</p> </td><td> <p style="margin-left:0;text-align:left;">0</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">String</p> </td><td> <p style="margin-left:0;text-align:left;">CELL_TYPE_STRING</p> </td><td> <p style="margin-left:0;text-align:left;">1</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">下面来实际动手做做看。按下图准备一个Excel文件。</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    FileInputStream in = null;</p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = null;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      in = new FileInputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      POIFSFileSystem fs = new POIFSFileSystem(in);</p> 
<p style="margin-left:0;text-align:left;">      workbook = new HSSFWorkbook(fs);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">        in.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch (IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.getSheetAt(0);</p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row = sheet.getRow(1);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell = row.getCell((short)0);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println("A:2=" + getType(cell.getCellType()));</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell = row.getCell((short)1);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println("B:2=" + getType(cell.getCellType()));</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell = row.getCell((short)2);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println("C:2=" + getType(cell.getCellType()));</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell = row.getCell((short)3);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println("D:2=" + getType(cell.getCellType()));</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell = row.getCell((short)4);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println("E:2=" + getType(cell.getCellType()));</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">  public static String getType(int type){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    if (type == HSSFCell.CELL_TYPE_BLANK){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      return "CELL_TYPE_BLANK";</p> 
<p style="margin-left:0;text-align:left;">    }else if (type == HSSFCell.CELL_TYPE_BOOLEAN){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      return "CELL_TYPE_BOOLEAN";</p> 
<p style="margin-left:0;text-align:left;">    }else if (type == HSSFCell.CELL_TYPE_ERROR){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      return "CELL_TYPE_ERROR";</p> 
<p style="margin-left:0;text-align:left;">    }else if (type == HSSFCell.CELL_TYPE_FORMULA){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      return "CELL_TYPE_FORMULA";</p> 
<p style="margin-left:0;text-align:left;">    }else if (type == HSSFCell.CELL_TYPE_NUMERIC){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      return "CELL_TYPE_NUMERIC";</p> 
<p style="margin-left:0;text-align:left;">    }else if (type == HSSFCell.CELL_TYPE_STRING){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      return "CELL_TYPE_STRING";</p> 
<p style="margin-left:0;text-align:left;">    }else{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      return "Not defined";</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">实行结果如下：</p> 
<p style="margin-left:0;text-align:left;">A:2=CELL_TYPE_NUMERIC</p> 
<p style="margin-left:0;text-align:left;">B:2=CELL_TYPE_STRING</p> 
<p style="margin-left:0;text-align:left;">C:2=CELL_TYPE_BOOLEAN</p> 
<p style="margin-left:0;text-align:left;">D:2=CELL_TYPE_NUMERIC</p> 
<p style="margin-left:0;text-align:left;">E:2=CELL_TYPE_ERROR</p> 
<p style="margin-left:0;text-align:left;">有一点要注意的是，数值型和日期型都是「CELL_TYPE_NUMERIC」。</p> 
<p style="margin-left:0;text-align:left;"><strong><em>日期型检查</em></strong></p> 
<p style="margin-left:0;text-align:left;">到底是数值型还是日期型，可以通过「org.apache.poi.hssf.usermodel.HSSFDateUtil」类的「isCellDateFormatted」方法来检证。</p> 
<p style="margin-left:0;text-align:left;">isCellDateFormatted</p> 
<p style="margin-left:0;text-align:left;">public static boolean isCellDateFormatted(HSSFCell cell)</p> 
<p style="margin-left:0;text-align:left;">Check if a cell contains a date Since dates are</p> 
<p style="margin-left:0;text-align:left;">stored internally in Excel as double values we</p> 
<p style="margin-left:0;text-align:left;">infer it is a date if it is formatted as such.</p> 
<p style="margin-left:0;text-align:left;">因为这个方法是静态的，可以直接调用如下所示。</p> 
<p style="margin-left:0;text-align:left;">if (HSSFDateUtil.isCellDateFormatted(cell)){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    /* 日期型 */</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">现在就把之前的示例程序稍微改动一下，再运行看看。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFDateUtil;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    FileInputStream in = null;</p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = null;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      in = new FileInputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      POIFSFileSystem fs = new POIFSFileSystem(in);</p> 
<p style="margin-left:0;text-align:left;">      workbook = new HSSFWorkbook(fs);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">        in.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch (IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.getSheetAt(0);</p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row = sheet.getRow(1);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell = row.getCell((short)0);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println("A:2=" + getType(cell));</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell = row.getCell((short)1);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println("B:2=" + getType(cell));</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell = row.getCell((short)2);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println("C:2=" + getType(cell));</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell = row.getCell((short)3);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println("D:2=" + getType(cell));</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell = row.getCell((short)4);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println("E:2=" + getType(cell));</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">  public static String getType(HSSFCell cell){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    int type = cell.getCellType();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    if (type == HSSFCell.CELL_TYPE_BLANK){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      return "CELL_TYPE_BLANK";</p> 
<p style="margin-left:0;text-align:left;">    }else if (type == HSSFCell.CELL_TYPE_BOOLEAN){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      return "CELL_TYPE_BOOLEAN";</p> 
<p style="margin-left:0;text-align:left;">    }else if (type == HSSFCell.CELL_TYPE_ERROR){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      return "CELL_TYPE_ERROR";</p> 
<p style="margin-left:0;text-align:left;">    }else if (type == HSSFCell.CELL_TYPE_FORMULA){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      return "CELL_TYPE_FORMULA";</p> 
<p style="margin-left:0;text-align:left;">}else if (type == HSSFCell.CELL_TYPE_NUMERIC){<!-- --></p> 
<p style="margin-left:0;text-align:left;">//检查日期类型</p> 
<p style="margin-left:0;text-align:left;">      if (HSSFDateUtil.isCellDateFormatted(cell)){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        return "CELL_TYPE_DATE";</p> 
<p style="margin-left:0;text-align:left;">      }else{<!-- --></p> 
<p style="margin-left:0;text-align:left;">        return "CELL_TYPE_NUMERIC";</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }else if (type == HSSFCell.CELL_TYPE_STRING){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      return "CELL_TYPE_STRING";</p> 
<p style="margin-left:0;text-align:left;">    }else{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      return "Not defined";</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">实行结果如下：</p> 
<p style="margin-left:0;text-align:left;">A:2=CELL_TYPE_NUMERIC</p> 
<p style="margin-left:0;text-align:left;">B:2=CELL_TYPE_STRING</p> 
<p style="margin-left:0;text-align:left;">C:2=CELL_TYPE_BOOLEAN</p> 
<p style="margin-left:0;text-align:left;">D:2=CELL_TYPE_DATE</p> 
<p style="margin-left:0;text-align:left;">E:2=CELL_TYPE_ERROR</p> 
<p style="margin-left:0;text-align:left;">这一次，日期型也可以被检查出来了。</p> 
<p style="margin-left:0;text-align:justify;"><strong><em>=========</em></strong></p> 
<p style="margin-left:0;text-align:justify;"><strong><em>POI</em></strong><strong><em>获取单元格类的值</em></strong></p> 
<p style="margin-left:0cm;">这一节介绍如何获取单元格的值。在POI里，对于不同类型的单元格的值，所调用的方法是不一样的。</p> 
<table><tbody><tr><td> <p style="margin-left:0;text-align:center;"><strong>型</strong></p> </td><td> <p style="margin-left:0;text-align:center;"><strong>函数名</strong></p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">boolean型</p> </td><td> <p style="margin-left:0;text-align:left;">getBooleanCellValue()</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">java.util.Date型</p> </td><td> <p style="margin-left:0;text-align:left;">getDateCellValue()</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">byte型</p> </td><td> <p style="margin-left:0;text-align:left;">getErrorCellValue()</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">double型</p> </td><td> <p style="margin-left:0;text-align:left;">getNumericCellValue()</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">java.lang.String型</p> </td><td> <p style="margin-left:0;text-align:left;">getStringCellValue()</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">java.lang.String型</p> </td><td> <p style="margin-left:0;text-align:left;">getCellFormula()</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:left;">如果单元格里是String型的值，调用方法「getStringCellValue」，数值型的话，则调用「getNumericCellValue」。再一起来看看其它方法。</p> 
<p style="margin-left:0;text-align:left;"><strong>getBooleanCellValue</strong></p> 
<p style="margin-left:0;text-align:left;">获取boolean型的値，调用「getBooleanCellValue」方法。</p> 
<p style="margin-left:0;text-align:left;">getBooleanCellValue</p> 
<p style="margin-left:0;text-align:left;">public boolean getBooleanCellValue()</p> 
<p style="margin-left:0;text-align:left;">get the value of the cell as a boolean. For strings, numbers,</p> 
<p style="margin-left:0;text-align:left;">and errors, we throw an exception. For blank cells we return</p> 
<p style="margin-left:0;text-align:left;">a false.</p> 
<p style="margin-left:0;text-align:left;">如果调用这个方法来获取字符串，数值型的值的话，会发生Exception异常，如果对象单元格里不含值，则返回「false」。</p> 
<p style="margin-left:0;text-align:left;"><strong>getDateCellValue</strong></p> 
<p style="margin-left:0;text-align:left;">获取日期Date型时，调用「getDateCellValue」方法。</p> 
<p style="margin-left:0;text-align:left;">getDateCellValue</p> 
<p style="margin-left:0;text-align:left;">public java.util.Date getDateCellValue()</p> 
<p style="margin-left:0;text-align:left;">get the value of the cell as a date. For strings we</p> 
<p style="margin-left:0;text-align:left;">throw an exception.</p> 
<p style="margin-left:0;text-align:left;">For blank cells we return a null.</p> 
<p style="margin-left:0;text-align:left;">如果用这个方法来获取字符串时，会有Exception异常发生，如果对象单元格里不含值，则返回「null」。</p> 
<p style="margin-left:0;text-align:left;"><strong>getErrorCellValue</strong></p> 
<p style="margin-left:0;text-align:left;">单元格如果是Error值，比如#VALUE!等，这时可以使用「getErrorCellValue」方法。</p> 
<p style="margin-left:0;text-align:left;">getErrorCellValue</p> 
<p style="margin-left:0;text-align:left;">public byte getErrorCellValue()</p> 
<p style="margin-left:0;text-align:left;">get the value of the cell as an error code. For strings,</p> 
<p style="margin-left:0;text-align:left;">numbers, and booleans, we throw an exception. For blank</p> 
<p style="margin-left:0;text-align:left;">cells we return a 0.</p> 
<p style="margin-left:0;text-align:left;">字符串，数值型，布尔型的值用这个方法的话，会产生异常，而单元格里值为空时则返回「0」。</p> 
<p style="margin-left:0;text-align:left;">对于单元格的Error值类型，在POI里的「org.apache.poi.hssf.usermodel.HSSFErrorConstants」有定义列表如下：</p> 
<table><tbody><tr><td> <p style="margin-left:0;text-align:center;"><strong>常量名</strong></p> </td><td> <p style="margin-left:0;text-align:center;"><strong>错误代码</strong></p> </td><td> <p style="margin-left:0;text-align:center;"><strong>Excel</strong><strong>里的Error值</strong></p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">public static final byte ERROR_DIV_0</p> </td><td> <p style="margin-left:0;text-align:left;">7</p> </td><td> <p style="margin-left:0;text-align:left;">#DIV/0!</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">public static final byte ERROR_NA</p> </td><td> <p style="margin-left:0;text-align:left;">42</p> </td><td> <p style="margin-left:0;text-align:left;">#N/A</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">public static final byte ERROR_NAME</p> </td><td> <p style="margin-left:0;text-align:left;">29</p> </td><td> <p style="margin-left:0;text-align:left;">#NAME?</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">public static final byte ERROR_NULL</p> </td><td> <p style="margin-left:0;text-align:left;">0</p> </td><td> <p style="margin-left:0;text-align:left;">#NULL!</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">public static final byte ERROR_NUM</p> </td><td> <p style="margin-left:0;text-align:left;">36</p> </td><td> <p style="margin-left:0;text-align:left;">#NUM!</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">public static final byte ERROR_REF</p> </td><td> <p style="margin-left:0;text-align:left;">23</p> </td><td> <p style="margin-left:0;text-align:left;">#REF!</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">public static final byte ERROR_VALUE</p> </td><td> <p style="margin-left:0;text-align:left;">15</p> </td><td> <p style="margin-left:0;text-align:left;">#VALUE!</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:left;">所以这里要注意了，Excel的ERROR.TYPE函数所返回的值，和POI所定义的是不一样的。</p> 
<p style="margin-left:0;text-align:left;"><strong>getNumericCellValue</strong></p> 
<p style="margin-left:0;text-align:left;">读取数值型时，调用「getNumericCellValue」方法。</p> 
<p style="margin-left:0;text-align:left;">getNumericCellValue</p> 
<p style="margin-left:0;text-align:left;">public double getNumericCellValue()</p> 
<p style="margin-left:0;text-align:left;">get the value of the cell as a number. For strings</p> 
<p style="margin-left:0;text-align:left;">we throw an exception.</p> 
<p style="margin-left:0;text-align:left;">For blank cells we return a 0.</p> 
<p style="margin-left:0;text-align:left;">用这个方法来读取字符串类型时，会有Exception发生，如果单元格里值为空时则返回「0」。</p> 
<p style="margin-left:0;text-align:left;"><strong>getStringCellValue</strong></p> 
<p style="margin-left:0;text-align:left;">字符串类型取得时，使用「getStringCellValue」方法。</p> 
<p style="margin-left:0;text-align:left;">getStringCellValue</p> 
<p style="margin-left:0;text-align:left;">public java.lang.String getStringCellValue()</p> 
<p style="margin-left:0;text-align:left;">get the value of the cell as a string - for numeric cells</p> 
<p style="margin-left:0;text-align:left;">we throw an exception.</p> 
<p style="margin-left:0;text-align:left;">For blank cells we return an empty string. For formulaCells</p> 
<p style="margin-left:0;text-align:left;">that are not string Formulas, we return empty String</p> 
<p style="margin-left:0;text-align:left;">同样的，用这个方法来读取数值型时，也会有异常Exception发生。单元格值为空时，则返回空白。</p> 
<p style="margin-left:0;text-align:left;"><strong>getCellFormula</strong></p> 
<p style="margin-left:0;text-align:left;">读取单元格里的计算式时，使用「getCellFormula」方法。</p> 
<p style="margin-left:0;text-align:left;">getCellFormula</p> 
<p style="margin-left:0;text-align:left;">public java.lang.String getCellFormula()</p> 
<p style="margin-left:0;text-align:left;">--</p> 
<p style="margin-left:0;text-align:left;">单元格里如果是计算式的话，则把计算式作为字符串来获取。关于具体内容，在最新文档里，竟然没有，不知道为什么。</p> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">下面我们就在一个Excel文件里，设定各种值，然后用上面的方法来读取。像下图一样准备一个Excel文件吧。</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">通过下面程序来获取各种类型的单元格的值。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    FileInputStream in = null;</p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = null;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      in = new FileInputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      POIFSFileSystem fs = new POIFSFileSystem(in);</p> 
<p style="margin-left:0;text-align:left;">      workbook = new HSSFWorkbook(fs);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">        in.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch (IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.getSheetAt(0);</p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row = sheet.getRow(1);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell = row.getCell((short)0);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println(cell.getNumericCellValue());</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell = row.getCell((short)1);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println(cell.getStringCellValue());</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell = row.getCell((short)2);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println(cell.getBooleanCellValue());</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell = row.getCell((short)3);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println(cell.getErrorCellValue());</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell = row.getCell((short)4);</p> 
<p style="margin-left:0;text-align:left;">    System.out.println(cell.getDateCellValue());</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">运行结果如下：</p> 
<p style="margin-left:0;text-align:left;">125.0</p> 
<p style="margin-left:0;text-align:left;">你好</p> 
<p style="margin-left:0;text-align:left;">true</p> 
<p style="margin-left:0;text-align:left;">7</p> 
<p style="margin-left:0;text-align:left;">Tue Oct 27 00:00:00 JST 2009</p> 
<div> 
 <p style="margin-left:0;text-align:left;">和预想的一样吧</p> 
</div> 
<p style="margin-left:0;text-align:justify;"><strong><em>POI</em></strong><strong><em>读取写入函数式</em></strong></p> 
<p style="margin-left:0cm;">单元格里可以写入函数，自动进行计算操作，这也是Excel功能强大的一方面。前面也提到过，使用POI，往单元格里写入函数，使用「setCellFormula」方法，要获取单元格的函数则使用「getCellFormula」方法。</p> 
<p style="margin-left:0cm;">两个方法，在DOC文档里都没有详细说明，原因不明。总之，先动手做做看。首先来看看如何从单元格取出函数式。</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">上图中，在单元格「C:2」里的函数式是「=A2*B2」，「C:3」里的函数式是「=SUM(A3:B3)」。</p> 
<pre style="margin-left:0;">import java.io.*;</pre> 
<pre style="margin-left:0;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFRow;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFCell;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    FileInputStream in = null;</pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = null;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      in = new FileInputStream("sample.xls");</pre> 
<pre style="margin-left:0;">      POIFSFileSystem fs = new POIFSFileSystem(in);</pre> 
<pre style="margin-left:0;">      workbook = new HSSFWorkbook(fs);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try{<!-- --></pre> 
<pre style="margin-left:0;">        in.close();</pre> 
<pre style="margin-left:0;">      }catch (IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.getSheetAt(0);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFRow row1 = sheet.getRow(1);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFCell cell1 = row1.getCell((short)2);</pre> 
<pre style="margin-left:0;">    System.out.println("C:2的函数式 " + cell1.getCellFormula());//getCellFormula()取得函数式</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFRow row2 = sheet.getRow(2);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFCell cell2 = row2.getCell((short)2);</pre> 
<pre style="margin-left:0;">    System.out.println("C:3的函数式 " + cell2.getCellFormula());</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">实行结果如下：</p> 
<pre style="margin-left:0;">C:2的函数式 A2*B2</pre> 
<pre style="margin-left:0;">C:3的函数式 SUM(A3:B3)</pre> 
<p style="margin-left:0cm;">如上所示，函数式被正常取出，只是函数式前的「=」被省略了。</p> 
<p style="margin-left:0cm;">下面再来看看如何向单元格写入函数式。还是利用之前的Excel文件，「C:2」单元格里写入「A2+B2」，「C:3」单元格里写入「AVERAGE(A3,B3)」这样的函数式。</p> 
<pre style="margin-left:0;">import java.io.*;</pre> 
<pre style="margin-left:0;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFRow;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFCell;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    FileInputStream in = null;</pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = null;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      in = new FileInputStream("sample.xls");</pre> 
<pre style="margin-left:0;">      POIFSFileSystem fs = new POIFSFileSystem(in);</pre> 
<pre style="margin-left:0;">      workbook = new HSSFWorkbook(fs);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try{<!-- --></pre> 
<pre style="margin-left:0;">        in.close();</pre> 
<pre style="margin-left:0;">      }catch (IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.getSheetAt(0);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFRow row1 = sheet.getRow(1);</pre> 
<pre style="margin-left:0;">    HSSFCell cell1 = row1.createCell((short)2);</pre> 
<pre style="margin-left:0;">    cell1.setCellFormula("A2+B2");// setCellFormula写入函数式</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFRow row2 = sheet.getRow(2);</pre> 
<pre style="margin-left:0;">    HSSFCell cell2 = row2.createCell((short)2);</pre> 
<pre style="margin-left:0;">    cell2.setCellFormula("AVERAGE(A3,B3)");</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    FileOutputStream out = null;</pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      out = new FileOutputStream("sample3.xls");</pre> 
<pre style="margin-left:0;">      workbook.write(out);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try {<!-- --></pre> 
<pre style="margin-left:0;">        out.close();</pre> 
<pre style="margin-left:0;">      }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">实行结果如下：</p> 
<p style="margin-left:0cm;"> </p> 
<p style="margin-left:0cm;">到底什么样的函数式可以用，什么样的不能用，这一点还不是很明白，但至少一部分是可以用的。</p> 
<div> 
 <p style="margin-left:0cm;">最后要注意的就是，对于使用getCell方法获取的单元格，函数式是不能被写入的。因此对于已经存在的单元格，在写入函数式时，只能先通过createCell方法创建单元格，再写入函数式。</p> 
</div> 
<p style="margin-left:0;text-align:justify;"><strong><em>POI</em></strong><strong><em>获取行单元格相关信息</em></strong></p> 
<p style="margin-left:0cm;">有时可能你想要知道行里面单元格的具体信息,比方说,该行实际上有多少单元格,最初的单元格在什么位置,最后的单元格又在哪里?用POI也可以实现。<br> 要取得某一行实际存在的单元格的总数，使用「HSSFRow」类的「getPhysicalNumberOfCells」方法。</p> 
<pre style="margin-left:0;">getPhysicalNumberOfCells</pre> 
<pre style="margin-left:0;">public int getPhysicalNumberOfCells()</pre> 
<pre style="margin-left:0;">gets the number of defined cells (NOT number of cells in the</pre> 
<pre style="margin-left:0;">actual row!). That is to say if only columns 0,4,5 have values</pre> 
<pre style="margin-left:0;">then there would be 3. </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Returns:</pre> 
<pre style="margin-left:0;">  int representing the number of defined cells in the row.</pre> 
<p style="margin-left:0cm;">要想知道最初的单元格的位置，可以使用「HSSFRow」类的「getFirstCellNum」方法。</p> 
<pre style="margin-left:0;">getFirstCellNum</pre> 
<pre style="margin-left:0;">public short getFirstCellNum()</pre> 
<pre style="margin-left:0;">get the number of the first cell contained in this row. </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Returns:</pre> 
<pre style="margin-left:0;">  short representing the first logical cell in the row,</pre> 
<pre style="margin-left:0;">or -1 if the row does not contain any cells.</pre> 
<p style="margin-left:0cm;">你也可以使用「HSSFRow」类的「getLastCellNum」方法来获取最后的单元格的位置，但这里要注意一点，如果单元格存在，如下面的API文档所说，获取的值是实际列号再加上1，在以前的版本可不是这样的。</p> 
<pre style="margin-left:0;">getLastCellNum</pre> 
<pre style="margin-left:0;">public short getLastCellNum()</pre> 
<pre style="margin-left:0;">get the number of the last cell contained in this row. </pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">Returns:</pre> 
<pre style="margin-left:0;">  short representing the last logical cell in the row PLUS ONE,</pre> 
<pre style="margin-left:0;"> or -1 if the row does not contain any cells.</pre> 
<p style="margin-left:0cm;">需要注意的是，POI在获取最初单元格位置和最后单元格位置时，返回的值并不是某一行特有的，而是针对所有的行。也就是说，上面的两个方法，针对所有的行，返回一个最小的列号和最大的列号。因此，不管对于哪一行，实行上面的两个方法，返回的值都是一样的。</p> 
<h3 style="margin-left:0cm;"><strong>示例程序</strong></h3> 
<p style="margin-left:0cm;">自己动手做做看吧。</p> 
<pre style="margin-left:0;">import java.io.*;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFRow;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFCell;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = new HSSFWorkbook();</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.createSheet();</pre> 
<pre style="margin-left:0;">    HSSFRow row = sheet.createRow(1);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    System.out.println("创建单元格前的状态:");</pre> 
<pre style="margin-left:0;">    System.out.println("First:" + row.getFirstCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Last:" + row.getLastCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Total:"</pre> 
<pre style="margin-left:0;">                + row.getPhysicalNumberOfCells() + "\n");</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    row.createCell((short)1);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    System.out.println("创建第二列（列号为1）单元格:");</pre> 
<pre style="margin-left:0;">    System.out.println("First:" + row.getFirstCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Last:" + row.getLastCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Total:"</pre> 
<pre style="margin-left:0;">                + row.getPhysicalNumberOfCells() + "\n");</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    row.createCell((short)3);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    System.out.println("创建第四列（列号为3）单元格:");</pre> 
<pre style="margin-left:0;">    System.out.println("First:" + row.getFirstCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Last:" + row.getLastCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Total:"</pre> 
<pre style="margin-left:0;">                + row.getPhysicalNumberOfCells() + "\n");</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">结果如下：</p> 
<pre style="margin-left:0;">创建单元格前的状态:</pre> 
<pre style="margin-left:0;">First:-1</pre> 
<pre style="margin-left:0;">Last:-1</pre> 
<pre style="margin-left:0;">Total:0</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">创建第二列（列号为1）单元格:</pre> 
<pre style="margin-left:0;">First:1</pre> 
<pre style="margin-left:0;">Last:2</pre> 
<pre style="margin-left:0;">Total:1</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">创建第四列（列号为3）单元格:</pre> 
<pre style="margin-left:0;">First:1</pre> 
<pre style="margin-left:0;">Last:4</pre> 
<pre style="margin-left:0;">Total:2</pre> 
<p style="margin-left:0cm;">一行当中没有单元格的情况下，调用「getFirstCellNum」方法和「getLastCellNum」方法，返回值都是「-1」。有单元格时，调用「getLastCellNum」方法，返回的值总是实际列号再加上1（实际第几列）。</p> 
<p style="margin-left:0cm;">===============</p> 
<h3 style="margin-left:0cm;"><strong><em>从现有的Excel文件读取单元格信息</em></strong></h3> 
<p style="margin-left:0cm;">再来看看如何从现有的Excel文件里读取单元格信息。</p> 
<p style="margin-left:0cm;"> </p> 
<pre style="margin-left:0;">import java.io.*;</pre> 
<pre style="margin-left:0;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFRow;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFCell;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    FileInputStream in = null;</pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = null;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      in = new FileInputStream("sample.xls");</pre> 
<pre style="margin-left:0;">      POIFSFileSystem fs = new POIFSFileSystem(in);</pre> 
<pre style="margin-left:0;">      workbook = new HSSFWorkbook(fs);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try{<!-- --></pre> 
<pre style="margin-left:0;">        in.close();</pre> 
<pre style="margin-left:0;">      }catch (IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.getSheetAt(0);</pre> 
<pre style="margin-left:0;">    HSSFRow row = sheet.getRow(1);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    System.out.println("First:" + row.getFirstCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Last:" + row.getLastCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Total:"</pre> 
<pre style="margin-left:0;">                 + row.getPhysicalNumberOfCells() + "\n");</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    row = sheet.getRow(2);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    System.out.println("First:" + row.getFirstCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Last:" + row.getLastCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Total:"</pre> 
<pre style="margin-left:0;">                 + row.getPhysicalNumberOfCells() + "\n");</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">结果如下：</p> 
<pre style="margin-left:0;">First:0</pre> 
<pre style="margin-left:0;">Last:4</pre> 
<pre style="margin-left:0;">Total:2</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">First:0</pre> 
<pre style="margin-left:0;">Last:4</pre> 
<pre style="margin-left:0;">Total:2</pre> 
<p style="margin-left:0cm;">接下来对这个Excel文件在另外的单元格里输入值，再用同样的程序（稍有变化）来运行看看。</p> 
<p style="margin-left:0cm;"> </p> 
<pre style="margin-left:0;">import java.io.*;</pre> 
<pre style="margin-left:0;">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFSheet;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFRow;</pre> 
<pre style="margin-left:0;">import org.apache.poi.hssf.usermodel.HSSFCell;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">public class POISample{<!-- --></pre> 
<pre style="margin-left:0;">  public static void main(String[] args){<!-- --></pre> 
<pre style="margin-left:0;">    FileInputStream in = null;</pre> 
<pre style="margin-left:0;">    HSSFWorkbook workbook = null;</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    try{<!-- --></pre> 
<pre style="margin-left:0;">      in = new FileInputStream("sample.xls");</pre> 
<pre style="margin-left:0;">      POIFSFileSystem fs = new POIFSFileSystem(in);</pre> 
<pre style="margin-left:0;">      workbook = new HSSFWorkbook(fs);</pre> 
<pre style="margin-left:0;">    }catch(IOException e){<!-- --></pre> 
<pre style="margin-left:0;">      System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">    }finally{<!-- --></pre> 
<pre style="margin-left:0;">      try{<!-- --></pre> 
<pre style="margin-left:0;">        in.close();</pre> 
<pre style="margin-left:0;">      }catch (IOException e){<!-- --></pre> 
<pre style="margin-left:0;">        System.out.println(e.toString());</pre> 
<pre style="margin-left:0;">      }</pre> 
<pre style="margin-left:0;">    }</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    HSSFSheet sheet = workbook.getSheetAt(0);</pre> 
<pre style="margin-left:0;">    HSSFRow row = sheet.getRow(1);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    System.out.println("First:" + row.getFirstCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Last:" + row.getLastCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Total:"</pre> 
<pre style="margin-left:0;">                   + row.getPhysicalNumberOfCells() + "\n");</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    row = sheet.getRow(2);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    System.out.println("First:" + row.getFirstCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Last:" + row.getLastCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Total:"</pre> 
<pre style="margin-left:0;">                   + row.getPhysicalNumberOfCells() + "\n");</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    row = sheet.getRow(3);</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">    System.out.println("First:" + row.getFirstCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Last:" + row.getLastCellNum());</pre> 
<pre style="margin-left:0;">    System.out.println("Total:"</pre> 
<pre style="margin-left:0;">                   + row.getPhysicalNumberOfCells() + "\n");</pre> 
<pre style="margin-left:0;">  }</pre> 
<pre style="margin-left:0;">}</pre> 
<p style="margin-left:0cm;">结果如下：</p> 
<pre style="margin-left:0;">First:0</pre> 
<pre style="margin-left:0;">Last:5</pre> 
<pre style="margin-left:0;">Total:2</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">First:0</pre> 
<pre style="margin-left:0;">Last:5</pre> 
<pre style="margin-left:0;">Total:2</pre> 
<pre style="margin-left:0;"> </pre> 
<pre style="margin-left:0;">First:0</pre> 
<pre style="margin-left:0;">Last:5</pre> 
<pre style="margin-left:0;">Total:1</pre> 
<p style="margin-left:0cm;">虽然对于不同的行，单元格的总数不一样，但不管哪一行，它的最小列号和最大列号都是一样的。</p> 
<p style="margin-left:0;text-align:justify;"> </p> 
<p style="margin-left:0;text-align:left;">==========================================异常华丽的分割线=============================================================</p> 
<p style="margin-left:0;text-align:left;"><strong><em>POI</em></strong><strong><em>样式的设定</em></strong></p> 
<p style="margin-left:0;text-align:left;"><strong><em>HSSFCellStyle</em></strong><strong><em>类定义</em></strong></p> 
<p style="margin-left:0;text-align:left;">这一节开始介绍如何通过POI来进行单元格格式的设定。设定格式使用「HSSFCellStyle」类，关于它的类定义如下：</p> 
<ul><li style="text-align:left;">java.lang.Object</li><li style="text-align:left;">org.apache.poi.hssf.usermodel.HSSFCellStyle</li><li style="text-align:left;">public class HSSFCellStyle extends java.lang.Object</li></ul> 
<p style="margin-left:0;text-align:left;">它有一个构造方法。</p> 
<table><tbody><tr><td> <p style="margin-left:0;text-align:center;"><strong>构造方法</strong></p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">protected HSSFCellStyle(short index, ExtendedFormatRecord rec)<br> Creates new HSSFCellStyle why would you want to do this??</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:left;">虽然有构造方法，但却是protected的，所以不能直接使用，要通过一个工作簿workbook来生成格式对象。</p> 
<p style="margin-left:0;text-align:left;">在POI里，格式好像是以workbook为单位来管理的，所以要先作成一个格式对象，保存在workbook里，然后再对已生成好的单元格进行设定。</p> 
<p style="margin-left:0;text-align:left;"><strong>在单元格里指定格式</strong></p> 
<p style="margin-left:0;text-align:left;">要作成一个格式对象，可以使用「HSSFWorkbook」类的「createCellStyle」方法。</p> 
<p style="margin-left:0;text-align:left;">createCellStyle</p> 
<p style="margin-left:0;text-align:left;">public HSSFCellStyle createCellStyle()</p> 
<p style="margin-left:0;text-align:left;">create a new Cell style and add it to the workbook's style table</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Returns:</p> 
<p style="margin-left:0;text-align:left;">  the new Cell Style object</p> 
<p style="margin-left:0;text-align:left;">另外，要取出现有的格式对象的话，使用「HSSFWorkbook」类的「getCellStyleAt」方法，这个方法有参数，是被保存格式的INDEX号。</p> 
<p style="margin-left:0;text-align:left;">getCellStyleAt</p> 
<p style="margin-left:0;text-align:left;">public HSSFCellStyle getCellStyleAt(short idx)</p> 
<p style="margin-left:0;text-align:left;">get the cell style object at the given index</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  idx - index within the set of styles</p> 
<p style="margin-left:0;text-align:left;">Returns:</p> 
<p style="margin-left:0;text-align:left;">  HSSFCellStyle object at the index</p> 
<p style="margin-left:0;text-align:left;">还有，对于某一个单元格，也可以取出它的格式对象。这时要使用「HSSFCell」类的「getCellStyle」方法。</p> 
<p style="margin-left:0;text-align:left;">getCellStyle</p> 
<p style="margin-left:0;text-align:left;">public HSSFCellStyle getCellStyle()</p> 
<p style="margin-left:0;text-align:left;">get the style for the cell. This is a reference to a cell style</p> 
<p style="margin-left:0;text-align:left;">contained in the workbook object.</p> 
<p style="margin-left:0;text-align:left;">这样的话，不管是新创建的或者是从现有的单元格里取出来的格式对象，都可以用来对某一个单元格进行格式的设定。设定方法使用「HSSFCell」类的「setCellStyle」方法。</p> 
<p style="margin-left:0;text-align:left;">setCellStyle</p> 
<p style="margin-left:0;text-align:left;">public void setCellStyle(HSSFCellStyle style)</p> 
<p style="margin-left:0;text-align:left;">set the style for the cell. The style should be an HSSFCellStyle</p> 
<p style="margin-left:0;text-align:left;">created/retreived from the HSSFWorkbook.</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  style - reference contained in the workbook</p> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">关于格式的详细设定方法，下几节再讲，先做个示例程序来看看。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCellStyle;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.util.HSSFColor;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row = sheet.createRow(1);//第二行</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell = row.createCell((short)0);//2,1格</p> 
<p style="margin-left:0;text-align:left;">    cell.setCellValue("sample");//写入sample</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">HSSFCellStyle style = workbook.createCellStyle();//创建个workbook的HSSFCellStyle格式对象style</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">//设定格式</p> 
<p style="margin-left:0;text-align:left;">    style.setFillBackgroundColor(HSSFColor.WHITE.index);</p> 
<p style="margin-left:0;text-align:left;">    style.setFillForegroundColor(HSSFColor.LIGHT_ORANGE.index);</p> 
<p style="margin-left:0;text-align:left;">    style.setFillPattern(HSSFCellStyle.THICK_HORZ_BANDS);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell.setCellStyle(style);//对2,1格写入上面的格式</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">按上面程序，在某一个单元格里设定了顔色。运行结果如下：</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">好了，从下一节开始详细介绍单元格格式的设定。</p> 
<p style="margin-left:0;text-align:left;"><strong><em>===============</em></strong></p> 
<p style="margin-left:0;text-align:left;"><strong><em>POI</em></strong><strong><em>单元格颜色设定</em></strong></p> 
<p style="margin-left:0;text-align:left;">先从单元格顔色设定开始介绍。单元格的顔色有前景色和背景色。</p> 
<p style="margin-left:0;text-align:left;">前景色的设定使用「HSSFCellStyle」类的「setFillForegroundColor」方法。</p> 
<p style="margin-left:0;text-align:left;">setFillForegroundColor</p> 
<p style="margin-left:0;text-align:left;">public void setFillForegroundColor(short bg)</p> 
<p style="margin-left:0;text-align:left;">set the foreground fill color</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  bg - color</p> 
<p style="margin-left:0;text-align:left;">背景色的设定则使用「HSSFCellStyle」类的「setFillBackgroundColor」方法。</p> 
<p style="margin-left:0;text-align:left;">setFillBackgroundColor</p> 
<p style="margin-left:0;text-align:left;">public void setFillBackgroundColor(short bg)</p> 
<p style="margin-left:0;text-align:left;">set the background fill color.</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  bg - color</p> 
<p style="margin-left:0;text-align:left;">两个方法都是通过参数来设定具体什么顔色。该参数类型为short型，在「HSSFColor」类里，准备了各种各样顔色的定义值。</p> 
<p style="margin-left:0;text-align:left;"><strong>HSSFColor</strong><strong>类</strong></p> 
<p style="margin-left:0;text-align:left;">HSSFColor类定义如下：</p> 
<ul><li style="text-align:left;">java.lang.Object</li><li style="text-align:left;">org.apache.poi.hssf.util.HSSFColor</li><li style="text-align:left;">public class HSSFColor extends java.lang.Object</li></ul> 
<p style="margin-left:0;text-align:left;">而各种顔色又是作为HSSFColor类的子类，定义一览表如下：</p> 
<table><tbody><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.AQUA</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.BLACK</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.BLUE</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.BLUE_GREY</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.BRIGHT_GREEN</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.BROWN</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.CORAL</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.CORNFLOWER_BLUE</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.DARK_BLUE</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.DARK_GREEN</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.DARK_RED</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.DARK_TEAL</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.DARK_YELLOW</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.GOLD</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.GREEN</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.GREY_25_PERCENT</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.GREY_40_PERCENT</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.GREY_50_PERCENT</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.GREY_80_PERCENT</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.INDIGO</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.LAVENDER</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.LEMON_CHIFFON</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.LIGHT_BLUE</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.LIGHT_CORNFLOWER_BLUE</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.LIGHT_GREEN</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.LIGHT_ORANGE</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.LIGHT_TURQUOISE</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.LIGHT_YELLOW</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.LIME</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.MAROON</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.OLIVE_GREEN</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.ORANGE</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.ORCHID</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.PALE_BLUE</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.PINK</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.PLUM</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.RED</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.ROSE</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.ROYAL_BLUE</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.SEA_GREEN</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.SKY_BLUE</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.TAN</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.TEAL</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.TURQUOISE</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.VIOLET</p> </td><td> <p style="margin-left:0;text-align:left;">HSSFColor.WHITE</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">HSSFColor.YELLOW</p> </td><td> <p style="margin-left:0;text-align:left;"> </p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:left;">设定顔色时，用这些子类的静态常量「index」作为参数，使用方法如下：</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">HSSFCellStyle style = workbook.createCellStyle();</p> 
<p style="margin-left:0;text-align:left;">style.setFillForegroundColor(HSSFColor.LIME.index);</p> 
<p style="margin-left:0;text-align:left;">style.setFillBackgroundColor(HSSFColor.GREEN.index);</p> 
<p style="margin-left:0;text-align:left;">如果这些顔色还不够你用的话，那么下一节再介绍怎么设定自己想要的顔色。</p> 
<p style="margin-left:0;text-align:left;"><strong>填充模式</strong></p> 
<p style="margin-left:0;text-align:left;">指定填充模式的话，使用「HSSFCellStyle」类的「setFillPattern」方法。</p> 
<p style="margin-left:0;text-align:left;">setFillPattern</p> 
<p style="margin-left:0;text-align:left;">public void setFillPattern(short fp)</p> 
<p style="margin-left:0;text-align:left;">setting to one fills the cell with the foreground color</p> 
<p style="margin-left:0;text-align:left;">... No idea about other values</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  fp - fill pattern (set to 1 to fill w/foreground color)</p> 
<p style="margin-left:0;text-align:left;">指定的填充模式，在「HSSFCellStyle」类里也有定义，类型为static short型，如下所示：</p> 
<table><tbody><tr><td> <p style="margin-left:0;text-align:center;"><strong>值</strong></p> </td><td> <p style="margin-left:0;text-align:center;"><strong>说明</strong></p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">NO_FILL</p> </td><td> <p style="margin-left:0;text-align:left;">No background</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">SOLID_FOREGROUND</p> </td><td> <p style="margin-left:0;text-align:left;">Solidly filled</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">FINE_DOTS</p> </td><td> <p style="margin-left:0;text-align:left;">Small fine dots</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">ALT_BARS</p> </td><td> <p style="margin-left:0;text-align:left;">Wide dots</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">SPARSE_DOTS</p> </td><td> <p style="margin-left:0;text-align:left;">Sparse dots</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">THICK_HORZ_BANDS</p> </td><td> <p style="margin-left:0;text-align:left;">Thick horizontal bands</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">THICK_VERT_BANDS</p> </td><td> <p style="margin-left:0;text-align:left;">Thick vertical bands</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">THICK_BACKWARD_DIAG</p> </td><td> <p style="margin-left:0;text-align:left;">Thick backward facing diagonals</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">THICK_FORWARD_DIAG</p> </td><td> <p style="margin-left:0;text-align:left;">Thick forward facing diagonals</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BIG_SPOTS</p> </td><td> <p style="margin-left:0;text-align:left;">Large spots</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BRICKS</p> </td><td> <p style="margin-left:0;text-align:left;">Brick-like layout</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">THIN_HORZ_BANDS</p> </td><td> <p style="margin-left:0;text-align:left;">Thin horizontal bands</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">THIN_VERT_BANDS</p> </td><td> <p style="margin-left:0;text-align:left;">Thin vertical bands</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">THIN_BACKWARD_DIAG</p> </td><td> <p style="margin-left:0;text-align:left;">Thin backward diagonal</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">THIN_FORWARD_DIAG</p> </td><td> <p style="margin-left:0;text-align:left;">Thin forward diagonal</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">SQUARES</p> </td><td> <p style="margin-left:0;text-align:left;">Squares</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">DIAMONDS</p> </td><td> <p style="margin-left:0;text-align:left;">Diamonds</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:left;">实际的使用方法如下：</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">HSSFCellStyle style = workbook.createCellStyle();</p> 
<p style="margin-left:0;text-align:left;">style.setFillForegroundColor(HSSFColor.LIME.index);</p> 
<p style="margin-left:0;text-align:left;">style.setFillBackgroundColor(HSSFColor.GREEN.index);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">style.setFillPattern(HSSFCellStyle.SOLID_FOREGROUND);</p> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">这就实际动手做做看吧，首先看一下定义的顔色到底是什么顔色，全部拉上来看看。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCellStyle;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.util.HSSFColor;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  static HSSFWorkbook workbook;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row[] = new HSSFRow[12];</p> 
<p style="margin-left:0;text-align:left;">    for (int i = 0; i &lt; 12 ; i++){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      row[i] = sheet.createRow(i);</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell[][] = new HSSFCell[12][4];</p> 
<p style="margin-left:0;text-align:left;">    for (int i = 0; i &lt; 12; i++){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      for (int j = 0; j &lt; 4 ; j++){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        cell[i][j] = row[i].createCell((short)j);</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[0][0], "AQUA", HSSFColor.AQUA.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[0][1], "BLACK", HSSFColor.BLACK.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[0][2], "BLUE", HSSFColor.BLUE.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[0][3], "BLUE_GREY", HSSFColor.BLUE_GREY.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[1][0], "BRIGHT_GREEN",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.BRIGHT_GREEN.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[1][1], "BROWN", HSSFColor.BROWN.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[1][2], "CORAL", HSSFColor.CORAL.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[1][3], "CORNFLOWER_BLUE",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.CORNFLOWER_BLUE.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[2][0], "DARK_BLUE", HSSFColor.DARK_BLUE.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[2][1], "DARK_GREEN", HSSFColor.DARK_GREEN.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[2][2], "DARK_RED", HSSFColor.DARK_RED.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[2][3], "DARK_TEAL", HSSFColor.DARK_TEAL.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[3][0], "DARK_YELLOW",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.DARK_YELLOW.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[3][1], "GOLD", HSSFColor.GOLD.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[3][2], "GREEN", HSSFColor.GREEN.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[3][3], "GREY_25_PERCENT",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.GREY_25_PERCENT.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[4][0], "GREY_40_PERCENT",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.GREY_40_PERCENT.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[4][1], "GREY_50_PERCENT",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.GREY_50_PERCENT.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[4][2], "GREY_80_PERCENT",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.GREY_80_PERCENT.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[4][3], "INDIGO", HSSFColor.INDIGO.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[5][0], "LAVENDER", HSSFColor.LAVENDER.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[5][1], "LEMON_CHIFFON",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.LEMON_CHIFFON.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[5][2], "LIGHT_BLUE",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.LIGHT_BLUE.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[5][3], "LIGHT_CORNFLOWER_BLUE",</p> 
<p style="margin-left:0;text-align:left;">                          HSSFColor.LIGHT_CORNFLOWER_BLUE.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[6][0], "LIGHT_GREEN",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.LIGHT_GREEN.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[6][1], "LIGHT_ORANGE",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.LIGHT_ORANGE.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[6][2], "LIGHT_TURQUOISE",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.LIGHT_TURQUOISE.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[6][3], "LIGHT_YELLOW",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.LIGHT_YELLOW.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[7][0], "LIME", HSSFColor.LIME.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[7][1], "MAROON", HSSFColor.MAROON.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[7][2], "OLIVE_GREEN",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.OLIVE_GREEN.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[7][3], "ORANGE", HSSFColor.ORANGE.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[8][0], "ORCHID", HSSFColor.ORCHID.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[8][1], "PALE_BLUE", HSSFColor.PALE_BLUE.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[8][2], "PINK", HSSFColor.PINK.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[8][3], "PLUM", HSSFColor.PLUM.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[9][0], "RED", HSSFColor.RED.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[9][1], "ROSE", HSSFColor.ROSE.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[9][2], "ROYAL_BLUE",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.ROYAL_BLUE.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[9][3], "SEA_GREEN", HSSFColor.SEA_GREEN.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[10][0], "SKY_BLUE", HSSFColor.SKY_BLUE.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[10][1], "TAN", HSSFColor.TAN.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[10][2], "TEAL", HSSFColor.TEAL.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[10][3], "TURQUOISE",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFColor.TURQUOISE.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[11][0], "VIOLET", HSSFColor.VIOLET.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[11][1], "WHITE", HSSFColor.WHITE.index);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[11][2], "YELLOW", HSSFColor.YELLOW.index);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">  public static void setStyle(HSSFCell cell, String col, short fg){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    HSSFCellStyle style = workbook.createCellStyle();</p> 
<p style="margin-left:0;text-align:left;">    style.setFillForegroundColor(fg);</p> 
<p style="margin-left:0;text-align:left;">    style.setFillPattern(HSSFCellStyle.SOLID_FOREGROUND);</p> 
<p style="margin-left:0;text-align:left;">    cell.setCellStyle(style);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell.setCellValue(col);</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">上面程序只指定了「ForegroundColor」，填充模式是「SOLID_FOREGROUND」，因此顔色应该是全部充满整个单元格的。运行结果如下：</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">下面再对填充模式进行各种修改来看看。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCellStyle;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.util.HSSFColor;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  static HSSFWorkbook workbook;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row[] = new HSSFRow[5];</p> 
<p style="margin-left:0;text-align:left;">    for (int i = 0; i &lt; 5 ; i++){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      row[i] = sheet.createRow(i);</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell[][] = new HSSFCell[5][4];</p> 
<p style="margin-left:0;text-align:left;">    for (int i = 0; i &lt; 5; i++){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      for (int j = 0; j &lt; 4 ; j++){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        cell[i][j] = row[i].createCell((short)j);</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[0][0], "NO_FILL", HSSFCellStyle.NO_FILL);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[0][1], "SOLID_FOREGROUND",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFCellStyle.SOLID_FOREGROUND);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[0][2], "FINE_DOTS", HSSFCellStyle.FINE_DOTS);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[0][3], "ALT_BARS", HSSFCellStyle.ALT_BARS);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[1][0], "SPARSE_DOTS", HSSFCellStyle.SPARSE_DOTS);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[1][1], "THICK_HORZ_BANDS",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFCellStyle.THICK_HORZ_BANDS);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[1][2], "THICK_VERT_BANDS",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFCellStyle.THICK_VERT_BANDS);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[1][3], "THICK_BACKWARD_DIAG",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFCellStyle.THICK_BACKWARD_DIAG);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[2][0], "THICK_FORWARD_DIAG",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFCellStyle.THICK_FORWARD_DIAG);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[2][1], "BIG_SPOTS", HSSFCellStyle.BIG_SPOTS);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[2][2], "BRICKS", HSSFCellStyle.BRICKS);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[2][3], "THIN_HORZ_BANDS",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFCellStyle.THIN_HORZ_BANDS);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[3][0], "THIN_VERT_BANDS",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFCellStyle.THIN_VERT_BANDS);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[3][1], "THIN_BACKWARD_DIAG",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFCellStyle.THIN_BACKWARD_DIAG);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[3][2], "THIN_FORWARD_DIAG",</p> 
<p style="margin-left:0;text-align:left;">                              HSSFCellStyle.THIN_FORWARD_DIAG);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[3][3], "SQUARES", HSSFCellStyle.SQUARES);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[4][0], "DIAMONDS", HSSFCellStyle.DIAMONDS);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">  public static void setStyle(HSSFCell cell, String fps,</p> 
<p style="margin-left:0;text-align:left;">                              short fp){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    HSSFCellStyle style = workbook.createCellStyle();</p> 
<p style="margin-left:0;text-align:left;">    style.setFillForegroundColor(HSSFColor.WHITE.index);</p> 
<p style="margin-left:0;text-align:left;">    style.setFillForegroundColor(HSSFColor.LIGHT_ORANGE.index);</p> 
<p style="margin-left:0;text-align:left;">    style.setFillPattern(fp);</p> 
<p style="margin-left:0;text-align:left;">    cell.setCellStyle(style);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell.setCellValue(fps);</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">上面固定了「ForegroundColor」和「BackgroundColor」，而填充模式则做了各种尝试。运行结果如下：</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;"><strong><em>================</em></strong></p> 
<p style="margin-left:0;text-align:left;"><strong><em>POI</em></strong><strong><em>调色板操作</em></strong></p> 
<p style="margin-left:0;text-align:left;">上一节介绍了如何设定POI里已经准备好的顔色，但有时你想要的顔色不在这个范围内，怎么办呢？这一节就来介绍如何使用调色板的RGB的值来设定你喜欢的顔色。</p> 
<p style="margin-left:0;text-align:left;">要创建一个新的颜色，在调色板里如果有这个对应值那当然没问题。那有没有可能你想要的顔色在调色板里也没有呢？关于这个解决办法还不知道。总之，先从有对应值的来做做看吧。</p> 
<p style="margin-left:0;text-align:left;">首先取出现在正在使用的调色板。调色板是由「HSSFPalette」类定义的。其定义如下：</p> 
<ul><li style="text-align:left;">java.lang.Object</li><li style="text-align:left;">org.apache.poi.hssf.usermodel.HSSFPalette</li><li style="text-align:left;">public class HSSFPalette extends java.lang.Object</li></ul> 
<p style="margin-left:0;text-align:left;">构造方法虽然有一个，但仍然是protected的，所以也不能直接使用，而要用「HSSFWorkbook」类的「getCustomPalette」方法来取得调色板对象。</p> 
<p style="margin-left:0;text-align:left;">getCustomPalette</p> 
<p style="margin-left:0;text-align:left;">public HSSFPalette getCustomPalette()</p> 
<p style="margin-left:0;text-align:left;">--</p> 
<p style="margin-left:0;text-align:left;">非常遗憾，该方法也是没有任何说明，原因不明。先按下面的方法使用吧。</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;">HSSFPalette palette = workbook.getCustomPalette();</p> 
<p style="margin-left:0;text-align:left;">调色板取得后，就可以使用「HSSFPalette」类的「setColorAtIndex」方法设定自己想要的顔色了。</p> 
<p style="margin-left:0;text-align:left;">setColorAtIndex</p> 
<p style="margin-left:0;text-align:left;">public void setColorAtIndex(short index,</p> 
<p style="margin-left:0;text-align:left;">              byte red, byte green, byte blue)</p> 
<p style="margin-left:0;text-align:left;">Sets the color at the given offset</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  index - the palette index, between 0x8 to</p> 
<p style="margin-left:0;text-align:left;">          0x40 inclusive</p> 
<p style="margin-left:0;text-align:left;">  red - the RGB red component, between 0</p> 
<p style="margin-left:0;text-align:left;">          and 255 inclusive</p> 
<p style="margin-left:0;text-align:left;">  green - the RGB green component, between 0</p> 
<p style="margin-left:0;text-align:left;">          and 255 inclusive</p> 
<p style="margin-left:0;text-align:left;">  blue - the RGB blue component, between 0</p> 
<p style="margin-left:0;text-align:left;">          and 255 inclusive</p> 
<p style="margin-left:0;text-align:left;">第一个参数设定你想要顔色的主色调的index号，如上一节一样，使用「HSSFColor」类的子类。</p> 
<p style="margin-left:0;text-align:left;">HSSFColor.RED.index</p> 
<p style="margin-left:0;text-align:left;">剩下的三个参数，通过设定RGB值来调节你想要的顔色。每一个都可以设定0～255的值。</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">HSSFPalette palette = workbook.getCustomPalette();</p> 
<p style="margin-left:0;text-align:left;">palette.setColorAtIndex(HSSFColor.RED.index,</p> 
<p style="margin-left:0;text-align:left;">                 (byte)100, (byte)0, (byte)0);</p> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">自己做做看吧，首先要确定你想要顔色的主色调。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCellStyle;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.util.HSSFColor;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row = sheet.createRow(1);</p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell = row.createCell((short)1);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCellStyle style = workbook.createCellStyle();</p> 
<p style="margin-left:0;text-align:left;">    style.setFillForegroundColor(HSSFColor.RED.index);</p> 
<p style="margin-left:0;text-align:left;">    style.setFillPattern(HSSFCellStyle.SOLID_FOREGROUND);</p> 
<p style="margin-left:0;text-align:left;">    cell.setCellStyle(style);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell.setCellValue("RED");</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">上面程序对一个单元格设定了红色「HSSFColor.RED」的主色调，运行结果如下：</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">下面就对这个顔色通过RGB值来做一些改动吧。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCellStyle;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.util.HSSFColor;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFPalette;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFPalette palette = workbook.getCustomPalette();</p> 
<p style="margin-left:0;text-align:left;">    palette.setColorAtIndex(HSSFColor.RED.index,</p> 
<p style="margin-left:0;text-align:left;">                    (byte)128, (byte)0, (byte)0);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row = sheet.createRow(1);</p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell = row.createCell((short)1);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCellStyle style = workbook.createCellStyle();</p> 
<p style="margin-left:0;text-align:left;">    style.setFillForegroundColor(HSSFColor.RED.index);</p> 
<p style="margin-left:0;text-align:left;">    style.setFillPattern(HSSFCellStyle.SOLID_FOREGROUND);</p> 
<p style="margin-left:0;text-align:left;">    cell.setCellStyle(style);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell.setCellValue("RED");</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">上面程序使用调色板对红色「HSSFColor.RED」进行了一些改动，之后用前面一个例子的方法同样设定红色，但得到的结果却是不一样的。运行结果如下：</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">因为调色板在一个workbook里是共有的，所以如果用调色板改变了某一种顔色，下次使用时，相同的顔色就全部改变了。</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;"><strong><em>===============</em></strong></p> 
<p style="margin-left:0;text-align:left;"><strong><em>POI</em></strong><strong><em>设置边框  </em></strong></p> 
<p style="margin-left:0;text-align:left;">在做一个电子表格时，边框的设置有时是必不可少的。这一节就来介绍边框，设置时，可以指定边框的位置，边框的种类，边框的顔色。</p> 
<p style="margin-left:0;text-align:left;">首先是边框的位置和种类。对单元格设置边框时，有上下左右位置之分，所以POI也准备了四个不同的方法。</p> 
<p style="margin-left:0;text-align:left;">上部的边框：</p> 
<p style="margin-left:0;text-align:left;">setBorderTop</p> 
<p style="margin-left:0;text-align:left;">public void setBorderTop(short border)</p> 
<p style="margin-left:0;text-align:left;">set the type of border to use for the top</p> 
<p style="margin-left:0;text-align:left;">border of the cell</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  border - type</p> 
<p style="margin-left:0;text-align:left;">下部的边框：</p> 
<p style="margin-left:0;text-align:left;">setBorderBottom</p> 
<p style="margin-left:0;text-align:left;">public void setBorderBottom(short border)</p> 
<p style="margin-left:0;text-align:left;">set the type of border to use for the</p> 
<p style="margin-left:0;text-align:left;">bottom border of the cell</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  border - type</p> 
<p style="margin-left:0;text-align:left;">左侧的边框：</p> 
<p style="margin-left:0;text-align:left;">setBorderLeft</p> 
<p style="margin-left:0;text-align:left;">public void setBorderLeft(short border)</p> 
<p style="margin-left:0;text-align:left;">set the type of border to use for the</p> 
<p style="margin-left:0;text-align:left;">left border of the cell</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  border - type</p> 
<p style="margin-left:0;text-align:left;">右侧的边框：</p> 
<p style="margin-left:0;text-align:left;">setBorderRight</p> 
<p style="margin-left:0;text-align:left;">public void setBorderRight(short border)</p> 
<p style="margin-left:0;text-align:left;">set the type of border to use for the</p> 
<p style="margin-left:0;text-align:left;">right border of the cell</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  border - type</p> 
<p style="margin-left:0;text-align:left;">参数通过表示边框种类的short型值来指定。下面是定义在「HSSFCellStyle」类里可以被指定值的一览表。</p> 
<table><tbody><tr><td> <p style="margin-left:0;text-align:center;"><strong>值</strong></p> </td><td> <p style="margin-left:0;text-align:center;"><strong>说明</strong></p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BORDER_DASH_DOT</p> </td><td> <p style="margin-left:0;text-align:left;">dash-dot border</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BORDER_DASH_DOT_DOT</p> </td><td> <p style="margin-left:0;text-align:left;">dash-dot-dot border</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BORDER_DASHED</p> </td><td> <p style="margin-left:0;text-align:left;">dash border</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BORDER_DOTTED</p> </td><td> <p style="margin-left:0;text-align:left;">dot borderhair-line border</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BORDER_DOUBLE</p> </td><td> <p style="margin-left:0;text-align:left;">double-line border</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BORDER_HAIR</p> </td><td> <p style="margin-left:0;text-align:left;">hair-line border</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BORDER_MEDIUM</p> </td><td> <p style="margin-left:0;text-align:left;">Medium border</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BORDER_MEDIUM_DASH_DOT</p> </td><td> <p style="margin-left:0;text-align:left;">medium dash-dot border</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BORDER_MEDIUM_DASH_DOT_DOT</p> </td><td> <p style="margin-left:0;text-align:left;">medium dash-dot-dot border</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BORDER_MEDIUM_DASHED</p> </td><td> <p style="margin-left:0;text-align:left;">Medium dashed border</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BORDER_NONE</p> </td><td> <p style="margin-left:0;text-align:left;">No border</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BORDER_SLANTED_DASH_DOT</p> </td><td> <p style="margin-left:0;text-align:left;">slanted dash-dot border</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BORDER_THICK</p> </td><td> <p style="margin-left:0;text-align:left;">Thick border</p> </td></tr><tr><td> <p style="margin-left:0;text-align:left;">BORDER_THIN</p> </td><td> <p style="margin-left:0;text-align:left;">Thin border</p> </td></tr></tbody></table> 
<p style="margin-left:0;text-align:left;">比如要在单元格下边框设置两重线的边框时，按如下方法：</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">HSSFCellStyle style = workbook.createCellStyle();</p> 
<p style="margin-left:0;text-align:left;">style.setBorderRight(HSSFCellStyle.BORDER_THIN);</p> 
<p style="margin-left:0;text-align:left;">下面再看看指定边框顔色。同样也分为上下左右边框来操作。</p> 
<p style="margin-left:0;text-align:left;">上部的边框：</p> 
<p style="margin-left:0;text-align:left;">setTopBorderColor</p> 
<p style="margin-left:0;text-align:left;">public void setTopBorderColor(short color)</p> 
<p style="margin-left:0;text-align:left;">set the color to use for the top border</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  color -</p> 
<p style="margin-left:0;text-align:left;">下部的边框：</p> 
<p style="margin-left:0;text-align:left;">setBottomBorderColor</p> 
<p style="margin-left:0;text-align:left;">public void setBottomBorderColor(short color)</p> 
<p style="margin-left:0;text-align:left;">set the color to use for the bottom border</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  color -</p> 
<p style="margin-left:0;text-align:left;">左侧的边框：</p> 
<p style="margin-left:0;text-align:left;">setLeftBorderColor</p> 
<p style="margin-left:0;text-align:left;">public void setLeftBorderColor(short color)</p> 
<p style="margin-left:0;text-align:left;">set the color to use for the left border</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  color -</p> 
<p style="margin-left:0;text-align:left;">右侧的边框：</p> 
<p style="margin-left:0;text-align:left;">setRightBorderColor</p> 
<p style="margin-left:0;text-align:left;">public void setRightBorderColor(short color)</p> 
<p style="margin-left:0;text-align:left;">set the color to use for the right border</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">Parameters:</p> 
<p style="margin-left:0;text-align:left;">  color -</p> 
<p style="margin-left:0;text-align:left;">仍然是通过参数来指定顔色，而且使用方法和前面一节也是一样。具体如下：</p> 
<p style="margin-left:0;text-align:left;">HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">HSSFCellStyle style = workbook.createCellStyle();</p> 
<p style="margin-left:0;text-align:left;">style.setRightBorderColor(HSSFColor.RED.index);</p> 
<p style="margin-left:0;text-align:left;">style.setBorderRight(HSSFCellStyle.BORDER_THIN);</p> 
<p style="margin-left:0;text-align:left;"><strong>示例程序</strong></p> 
<p style="margin-left:0;text-align:left;">实际动手做做吧。首先看看如何设置上下左右的边框。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCellStyle;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.util.HSSFColor;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFPalette;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    HSSFWorkbook workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row = sheet.createRow(1);</p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell1 = row.createCell((short)1);</p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell2 = row.createCell((short)2);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCellStyle style1 = workbook.createCellStyle();</p> 
<p style="margin-left:0;text-align:left;">    style1.setBorderTop(HSSFCellStyle.BORDER_DOUBLE);</p> 
<p style="margin-left:0;text-align:left;">    style1.setBorderLeft(HSSFCellStyle.BORDER_DOUBLE);</p> 
<p style="margin-left:0;text-align:left;">    style1.setTopBorderColor(HSSFColor.GOLD.index);</p> 
<p style="margin-left:0;text-align:left;">    style1.setLeftBorderColor(HSSFColor.PLUM.index);</p> 
<p style="margin-left:0;text-align:left;">    cell1.setCellStyle(style1);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCellStyle style2 = workbook.createCellStyle();</p> 
<p style="margin-left:0;text-align:left;">    style2.setBorderBottom(HSSFCellStyle.BORDER_DOUBLE);</p> 
<p style="margin-left:0;text-align:left;">    style2.setBorderRight(HSSFCellStyle.BORDER_DOUBLE);</p> 
<p style="margin-left:0;text-align:left;">    style2.setBottomBorderColor(HSSFColor.ORANGE.index);</p> 
<p style="margin-left:0;text-align:left;">    style2.setRightBorderColor(HSSFColor.SKY_BLUE.index);</p> 
<p style="margin-left:0;text-align:left;">    cell2.setCellStyle(style2);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell1.setCellValue("U &amp; L");</p> 
<p style="margin-left:0;text-align:left;">    cell2.setCellValue("B &amp; R");</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">上面程序既改了顔色，也设置了上和左的边框各一个，右和下的边框各一个。</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">下面再对边框种类进行各种各样的顔色改变来看看效果。</p> 
<p style="margin-left:0;text-align:left;">import java.io.*;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFSheet;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFRow;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCell;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.usermodel.HSSFCellStyle;</p> 
<p style="margin-left:0;text-align:left;">import org.apache.poi.hssf.util.HSSFColor;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">public class POISample{<!-- --></p> 
<p style="margin-left:0;text-align:left;">  static HSSFWorkbook workbook;</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">  public static void main(String[] args){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    workbook = new HSSFWorkbook();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFSheet sheet = workbook.createSheet();</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFRow row[] = new HSSFRow[5];</p> 
<p style="margin-left:0;text-align:left;">    for (int i = 0; i &lt; 5 ; i++){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      row[i] = sheet.createRow(i);</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    HSSFCell cell[][] = new HSSFCell[5][3];</p> 
<p style="margin-left:0;text-align:left;">    for (int i = 0; i &lt; 5; i++){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      for (int j = 0; j &lt; 3 ; j++){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        cell[i][j] = row[i].createCell((short)j);</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[0][0], "DASH_DOT",</p> 
<p style="margin-left:0;text-align:left;">                          HSSFCellStyle.BORDER_DASH_DOT);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[0][1], "DASH_DOT_DOT",</p> 
<p style="margin-left:0;text-align:left;">                          HSSFCellStyle.BORDER_DASH_DOT_DOT);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[0][2], "DASHED",</p> 
<p style="margin-left:0;text-align:left;">                          HSSFCellStyle.BORDER_DASHED);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[1][0], "DOTTED",</p> 
<p style="margin-left:0;text-align:left;">                          HSSFCellStyle.BORDER_DOTTED);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[1][1], "DOUBLE",</p> 
<p style="margin-left:0;text-align:left;">                          HSSFCellStyle.BORDER_DOUBLE);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[1][2], "HAIR",</p> 
<p style="margin-left:0;text-align:left;">                          HSSFCellStyle.BORDER_HAIR);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[2][0], "MEDIUM",</p> 
<p style="margin-left:0;text-align:left;">                          HSSFCellStyle.BORDER_MEDIUM);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[2][1], "MEDIUM_DASH_DOT",</p> 
<p style="margin-left:0;text-align:left;">                          HSSFCellStyle.BORDER_MEDIUM_DASH_DOT);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[2][2], "MEDIUM_DASH_DOT_DOT",</p> 
<p style="margin-left:0;text-align:left;">                          HSSFCellStyle.BORDER_MEDIUM_DASH_DOT_DOT);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[3][0], "MEDIUM_DASHED",</p> 
<p style="margin-left:0;text-align:left;">                          HSSFCellStyle.BORDER_MEDIUM_DASHED);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[3][1], "NONE",</p> 
<p style="margin-left:0;text-align:left;">                          HSSFCellStyle.BORDER_NONE);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[3][2], "SLANTED_DASH_DOT",</p> 
<p style="margin-left:0;text-align:left;">                          HSSFCellStyle.BORDER_SLANTED_DASH_DOT);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[4][0], "THICK", HSSFCellStyle.BORDER_THICK);</p> 
<p style="margin-left:0;text-align:left;">    setStyle(cell[4][1], "THIN", HSSFCellStyle.BORDER_THIN);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    FileOutputStream out = null;</p> 
<p style="margin-left:0;text-align:left;">    try{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      out = new FileOutputStream("sample.xls");</p> 
<p style="margin-left:0;text-align:left;">      workbook.write(out);</p> 
<p style="margin-left:0;text-align:left;">    }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">      System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">    }finally{<!-- --></p> 
<p style="margin-left:0;text-align:left;">      try {<!-- --></p> 
<p style="margin-left:0;text-align:left;">        out.close();</p> 
<p style="margin-left:0;text-align:left;">      }catch(IOException e){<!-- --></p> 
<p style="margin-left:0;text-align:left;">        System.out.println(e.toString());</p> 
<p style="margin-left:0;text-align:left;">      }</p> 
<p style="margin-left:0;text-align:left;">    }</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">  public static void setStyle(HSSFCell cell,</p> 
<p style="margin-left:0;text-align:left;">                          String bn, short border){<!-- --></p> 
<p style="margin-left:0;text-align:left;">    HSSFCellStyle style = workbook.createCellStyle();</p> 
<p style="margin-left:0;text-align:left;">    style.setBorderBottom(border);</p> 
<p style="margin-left:0;text-align:left;">    style.setBottomBorderColor(HSSFColor.ORANGE.index);</p> 
<p style="margin-left:0;text-align:left;">    cell.setCellStyle(style);</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">    cell.setCellValue(bn);</p> 
<p style="margin-left:0;text-align:left;">  }</p> 
<p style="margin-left:0;text-align:left;">}</p> 
<p style="margin-left:0;text-align:left;">运行结果如下：</p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;"> </p> 
<p style="margin-left:0;text-align:left;">==========================================异常华丽的分割线=============================================================</p> 
<p style="margin-left:0;text-align:justify;"><img src="https://images2.imgbox.com/2e/1a/2C4FJU9B_o.png" alt="2372fd96a36648e4acc0dade6d5c6cd1.png"><img src="https://images2.imgbox.com/a3/f2/2FldO4B8_o.png" alt="7ff4cc72342942c78d4387139d9200cd.png"><img src="https://images2.imgbox.com/a4/6a/QBnyLzQA_o.png" alt="35814d4be6ed42ee988a5b172a284f8e.png"><img src="https://images2.imgbox.com/ce/72/IUka0X3I_o.png" alt="ea0a083cd89b4090aa53a48ad2720ed6.png"><img src="https://images2.imgbox.com/2b/7a/9WIDbZuv_o.png" alt="5f5ce03de8d24f3589261b9d75dd7f96.png"><img src="https://images2.imgbox.com/ea/40/GoktftA0_o.png" alt="2919ad0437ab4e8daf5014b9241b2960.png"><img src="https://images2.imgbox.com/d9/62/OXLADfGx_o.png" alt="78434361508e4cf49ca8d778caa31c69.png"><img src="https://images2.imgbox.com/04/f0/Sq11vXva_o.png" alt="3afd1908ba464ca6b1e73ac57f5aa68f.png"><img src="https://images2.imgbox.com/fa/7c/94eBYAHI_o.png" alt="29a69449ae6e4b8fa6ca9b6830f5b91c.png"><img src="https://images2.imgbox.com/c5/d7/sXmZF0Wa_o.png" alt="22821cb193b84dccb0377a582623720a.png"><img src="https://images2.imgbox.com/40/8b/NQmUzaVa_o.png" alt="8fc0a1589ee6459bbd629a54daeedbb0.png"><img src="https://images2.imgbox.com/e6/5a/Xcsgj4V7_o.png" alt="f1207a0fa07842e899b07ad01a37a824.png"><img src="https://images2.imgbox.com/1f/8c/8GOMWTgA_o.png" alt="186acc1ab6704dceb7fa9e0db4a73f4b.png"><img src="https://images2.imgbox.com/86/76/oCGjekY7_o.png" alt="520fe95194e44443af5747e630cd1b1e.png"><img src="https://images2.imgbox.com/0a/0e/QSrXDQAx_o.png" alt="19e0441c71cc4577a1bd24068cd60c1d.png"><img src="https://images2.imgbox.com/5f/f6/1i0cJbzT_o.png" alt="0de248eb76704f52b5025d0de3b4a249.png"><img src="https://images2.imgbox.com/cf/bf/fatDRhoh_o.png" alt="d15643e2f72e48f3a1b1847b3e8baef3.png"><img src="https://images2.imgbox.com/e3/52/TmU5Om5E_o.png" alt="7987c619727f4ea8bbeff35221538564.png"><img src="https://images2.imgbox.com/eb/31/Smz2UkbM_o.png" alt="2caf2cb1adb545478b9044791f2bb6d6.png"><img src="https://images2.imgbox.com/30/8d/ICcZSLZm_o.png" alt="3b6ea1e8ccfc45569d5c1706e5ab7afc.png"><img src="https://images2.imgbox.com/1f/41/b8R0Vb1G_o.png" alt="83dc2f602b784dcf9bdc09c58b8f3c30.png"><img src="https://images2.imgbox.com/d3/28/PvNQVsoh_o.png" alt="700ce27f1c6646328ba587c5450b4b4e.png"><img src="https://images2.imgbox.com/a1/b4/d2tv22EQ_o.png" alt="9942646c5b4c4ab78c88b7329af896de.png"><img src="https://images2.imgbox.com/fb/c7/xfPIOz61_o.png" alt="6c36643bf46646a48cfcb93da1b918b5.png"><img src="https://images2.imgbox.com/01/e1/EhT8zEnO_o.png" alt="f2bbc33f6106472d9924439a1a60ddea.png"><img src="https://images2.imgbox.com/1c/84/I4X39wqo_o.png" alt="45feb5e93e9f46689d091580cf919704.png"><img src="https://images2.imgbox.com/66/fd/4OPz0GpY_o.png" alt="947506bfab0745dd8d50827ddd107a8a.png"><img src="https://images2.imgbox.com/df/a2/Z68ffdby_o.png" alt="1ff87705cde34530a29f2a3222b4f4a5.png"><img src="https://images2.imgbox.com/fd/cd/aFxW5boN_o.png" alt="55d481e130d34fd1960b3b23f2a3ff26.png"><img src="https://images2.imgbox.com/61/4a/PUg3fS0x_o.png" alt="229ec109db304e47a1c54d2029feaeea.png"><img src="https://images2.imgbox.com/8e/75/ksug7IG8_o.png" alt="eb4edbb08bd34a9a86c4d0b58f5f41c0.png"><img src="https://images2.imgbox.com/8b/51/aLUA1mSK_o.png" alt="9e1923f1f78f4ebdbdc02172c9c07ee5.png"><img src="https://images2.imgbox.com/1c/63/9ZZPlA8E_o.png" alt="5a467be7205f4fad8a4b39a052ff56ca.png"><img src="https://images2.imgbox.com/55/65/EEV1EY2n_o.png" alt="2489906918c5412794bceccb9948ee35.png"><img src="https://images2.imgbox.com/21/56/1vp3bKoN_o.png" alt="5d100ad7670940ebbef271fbf9d5e78a.png"><img src="https://images2.imgbox.com/f8/f1/dkwuCG9k_o.png" alt="2c4ccf041f834e39b33d1e8a491dca05.png"><img src="https://images2.imgbox.com/9e/45/ZLv9bOIK_o.png" alt="c9615c626311479aadeaa5c8cb0885f9.png"><img src="https://images2.imgbox.com/0b/f4/Tuc8G3Ie_o.png" alt="79f7bab5510d4bc79617cb9487655c8c.png"><img src="https://images2.imgbox.com/94/d8/hcuX2JEd_o.png" alt="0d0659cdf7184e6f9de3376445152256.png"><img src="https://images2.imgbox.com/fe/e6/KuFNS5Ma_o.png" alt="c50e0bae435e4441a90ed22470b9b02b.png"><img src="https://images2.imgbox.com/b1/9a/nNs85lES_o.png" alt="39810da28490442887333f242e8cdaf7.png"><img src="https://images2.imgbox.com/8c/7e/QgVFk2n9_o.png" alt="d8b247b78d524917967c45d6e807545a.png"><img src="https://images2.imgbox.com/44/3f/0pqmNRQO_o.png" alt="df73cd66ae9440ccaa1ab7ea69222155.png"><img src="https://images2.imgbox.com/61/ce/FnFXEKPg_o.png" alt="b5bc30389cdd45028820103d14d3aed5.png"><img src="https://images2.imgbox.com/7c/03/acRAdkJm_o.png" alt="f2e079d8fb0d4593b6e0aeffeacbabae.png"><img src="https://images2.imgbox.com/aa/f9/5ZzJHLFX_o.png" alt="32df2d23e8bb44e39c9a61bbaeb65e2b.png"><img src="https://images2.imgbox.com/ff/a1/2P7oF7Ta_o.png" alt="df7fe7797e214997bea66001654412b4.png"><img src="https://images2.imgbox.com/c7/de/XJBkhjgx_o.png" alt="3f1f29bda8c34f518ce1a4060b94c417.png"><img src="https://images2.imgbox.com/fc/f7/Iz6Eh2ru_o.png" alt="7335491bc4cf48f8987611261a19c334.png"><img src="https://images2.imgbox.com/18/de/qC494mH5_o.png" alt="829a38e7d6df4869bb86a318083e88da.png"><img src="https://images2.imgbox.com/0b/e5/YW9m4RGt_o.png" alt="54de78f6879a49cab7df39f02258a925.png"><img src="https://images2.imgbox.com/ca/c8/Xs6zwImS_o.png" alt="a58a8ef774fd4269b6077e1817c53269.png"><img src="https://images2.imgbox.com/70/82/Lpaug1uP_o.png" alt="50337201f3e84cb39da93886aa59c3e5.png"><img src="https://images2.imgbox.com/39/dc/epq40c8B_o.png" alt="976ef0a28db9436a955480a3b37c0c59.png"><img src="https://images2.imgbox.com/91/14/zKWeqbrK_o.png" alt="94bda026943c44f6bcab416f1029f293.png"><img src="https://images2.imgbox.com/9a/36/lOBHgXNu_o.png" alt="5d537eb79a19485488567794b9592b6e.png"><img src="https://images2.imgbox.com/87/7d/ELn4OgHm_o.png" alt="367dd6d6f10740a796e009666c9fa75c.png"><img src="https://images2.imgbox.com/e6/c4/jxVFQQiJ_o.png" alt="0c23cc0ac7274ea8b8342ecafecf81eb.png"><img src="https://images2.imgbox.com/28/40/up11z1Zq_o.png" alt="f28f2a876944456094ef62fd85c07fad.png"><img src="https://images2.imgbox.com/1b/85/TjcT6kGG_o.png" alt="7b2af76b85e540d48c00399f25e4055e.png"><img src="https://images2.imgbox.com/1f/af/pHQXH9T7_o.png" alt="4d90e30e1836403fa5bb0914705deb95.png"><img src="https://images2.imgbox.com/2d/0c/Z5IeG28h_o.png" alt="e6ef70288c9647a2b905a48d4ccc4382.png"><img src="https://images2.imgbox.com/d9/ce/36etfTZn_o.png" alt="a5cb1a8ef0bb402d919fb0496f5a5434.png"><img src="https://images2.imgbox.com/4d/f2/iK2NN9ju_o.png" alt="fc91941bccbb44bb8134aa31bd5b3db9.png"><img src="https://images2.imgbox.com/7a/99/oL1KGvXb_o.png" alt="e08ea0d174034ea8b51fd17e8e08c35f.png"><img src="https://images2.imgbox.com/50/fe/qN6XTTtP_o.png" alt="a29578b80711428a8e34b6f48d46d78e.png"></p> 
<p style="margin-left:0;text-align:justify;">添加 POI 支持 <br>  <br> 鉴于现在大部分应用是以 Maven 作为构建，可在 pom.xml 中加入 POI 的 maven 依赖,但是 maven 现在只支持到 3.1 版本，对 3.5 版本还不提供支持。 &lt;dependency&gt; &lt;groupId&gt;poi&lt;/groupId&gt;    &lt;artifactId&gt;poi&lt;/artifactId&gt;    &lt;version&gt;3.1-FINAL&lt;/version&gt; &lt;/dependency&gt; <br>  <br> 因此可以直接在 Apache 官网下载 POI3.5 版本，作为 reference library 加入 工程中 <br> 创建新工作簿 Workbook wb = new HSSFWorkbook();     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut);     fileOut.close(); <br>  <br>     Workbook wb = new XSSFWorkbook(); FileOutputStream fileOut = new FileOutputStream("workbook.xlsx");     wb.write(fileOut); fileOut.close(); <br>  <br> 创建新 sheet 页     Workbook wb = new HSSFWorkbook();     //Workbook wb = new XSSFWorkbook();     Sheet sheet1 = wb.createSheet("new sheet");     Sheet sheet2 = wb.createSheet("second sheet");     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut);     fileOut.close(); <br>  <br> 创建单元格     Workbook wb = new HSSFWorkbook();     //Workbook wb = new XSSFWorkbook();     CreationHelper createHelper = wb.getCreationHelper();     Sheet sheet = wb.createSheet("new sheet"); <br>  <br> //创建一列，在其中加入多个单元格，列索引号从 0 开始，单元格的索引号也是从 0 //开始 <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 6 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>     Row row = sheet.createRow((short)0);1     //创建一个单元格，并在其中加入内容.     Cell cell = row.createCell(0);     cell.setCellValue(1); <br>  <br>     // 上面的多行代码可以采用下面的一行代码的方式完成     row.createCell(1).setCellValue(1.2);     row.createCell(2).setCellValue(          createHelper.createRichTextString("This is a string"));     row.createCell(3).setCellValue(true); <br>  <br>     //将输出流写入一个文件     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut);     fileOut.close();                      <br> 新建一个时间格式的单元格     //Workbook wb = new XSSFWorkbook();     CreationHelper createHelper = wb.getCreationHelper();     Sheet sheet = wb.createSheet("new sheet"); <br>  <br>    //创建一列，在其中加入多个单元格，列索引号从 0 开始，单元格的索引号也是从 0 //开始     Row row = sheet.createRow(0); <br>  <br>     //创建一个单元格，并在其中加入内容.  第一个单元格的内容不设置为日期时间格式     Cell cell = row.createCell(0);     cell.setCellValue(new Date()); <br>  <br> //我们将第二个单元格设置成日期（和时间）格式。对这个文件来说创建一个新的单 //元格格式非常重要，除非您能够不用内置的格式来渲染所有的单元格     CellStyle cellStyle = wb.createCellStyle();     cellStyle.setDataFormat(     createHelper.createDataFormat().getFormat("m/d/yy h:mm"));     cell = row.createCell(1);     cell.setCellValue(new Date());     cell.setCellStyle(cellStyle); <br>  <br>     //也可以用 java.util.Calendar 来设置单元格格式      cell = row.createCell(2);     cell.setCellValue(Calendar.getInstance()); <br>                                                              1 很多方法的参数是 short 而不是 int 所以需要做一次类型转换  --译者注 <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 7 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>     cell.setCellStyle(cellStyle); <br>  <br>     // 将输出流写入一个文件     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut); fileOut.close(); <br>  <br> 处理不同内容格式的单元格     Workbook wb = new HSSFWorkbook();     Sheet sheet = wb.createSheet("new sheet");     Row row = sheet.createRow((short)2);     row.createCell(0).setCellValue(1.1);     row.createCell(1).setCellValue(new Date());     row.createCell(2).setCellValue(Calendar.getInstance());     row.createCell(3).setCellValue("a string");     row.createCell(4).setCellValue(true);     row.createCell(5).setCellType(HSSFCell.CELL_TYPE_ERROR); <br>  <br>     //将输出流写入一个文件     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut); fileOut.close(); <br>  <br> 遍历列和单元格  有些时候您仅希望遍历一个 sheet 页中所有的列或是一列中所有的单元格。这可以用 一个简单的 for 循环来实现。 <br>  幸运的是，这非常简单。Row 对象定义了一个 CellIterator 内部类用来处理单元格的 遍历（可以通过调用 row.cellIterator() 来获得 Iterator 对象），另外,Sheet 对象提供 了一个 rowIterator()方法对所有列进行遍历 <br>  除此之外，Sheet 和 Row 对象都实现了 java.lang.Iterable 接口，因此如果您用的 是 Java 1.5 及以上版本，您可以简单的调用内置的“foreach”来实现。请看： <br>  Sheet sheet = wb.getSheetAt(0);  for (Iterator&lt;Row&gt; rit = sheet.rowIterator(); rit.hasNext(); ) {   Row row = rit.next();   for (Iterator&lt;Cell&gt; cit = row.cellIterator(); cit.hasNext(); ) {    Cell cell = cit.next();    // Do something here   } <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 8 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>  } 使用 J ava1.5 foreach 循环遍历列和单元格 <br> 有时候您仅希望遍历一个 sheet 页中所有的列或是一列中所有的单元格。如果您使用的是 java1.5 或是以上版本，那么这将十分的方便，因为它支持新的 foreach 循环。 <br> 幸运的是，这非常的简单。Sheet 和 Row 对象都实现了 java.lang.Iterable 接口支持 foreach 循环。对 Row 对象来说它支持通过调用 CellIterator 内部类用来处理单元格的 遍历，对于 Sheet 对象来说它提供了一个 rowIterator()方法对所有列进行遍历。 <br>  Sheet sheet = wb.getSheetAt(0);  for (Row row : sheet) {   for (Cell cell : row) {    // Do something here   }  } <br>  <br> 获得单元格内的内容 <br> 要想获得单元格内的内容，您首先要要知道单元格内容的格式（比如您想获得从字符 格式的单元格内获得一个数字，您将得到的是 NumberFormatException 错误）。因此， 您将希望能够切换到该单元格格式，然后为获得该单元格内容调用合适的 getter 方法。 <br> 在以下的代码中我们将对一个 sheet 页中的所有单元格进行遍历，并打印出单元格的引用 和内容。 <br> // import org.apache.poi.ss.usermodel.*; <br>  <br> Sheet sheet1 = wb.getSheetAt(0); for (Row row : sheet1) {  for (Cell cell : row) {   CellReference cellRef = new CellReference(row.getRowNum(), cell.getCellNum());   System.out.print(cellRef.formatAsString());   System.out.print(" - ");      switch(cell.getCellType()) {       case Cell.CELL_TYPE_STRING:         System.out.println(cell.getRichStringCellValue().getString());         break;       case Cell.CELL_TYPE_NUMERIC:         if(DateUtil.isCellDateFormatted(cell)) {           System.out.println(cell.getDateCellValue());         } else {           System.out.println(cell.getNumericCellValue()); <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 9 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>         }         break;       case Cell.CELL_TYPE_BOOLEAN:         System.out.println(cell.getBooleanCellValue());         break;       case Cell.CELL_TYPE_FORMULA:         System.out.println(cell.getCellFormula());         break;       default:         System.out.println();   }  } } <br>  <br> 文本提取 <br> 对于大多数的文本提取需求，标准的 ExcelExtractor 类应该能够满足您所有的需求。 <br>  InputStream inp = new FileInputStream("workbook.xls");  HSSFWorkbook wb = new HSSFWorkbook(new POIFSFileSystem(inp));  ExcelExtractor extractor = new ExcelExtractor(wb); <br>  <br>  extractor.setFormulasNotResults(true);  extractor.setIncludeSheetNames(false);  String text = extractor.getText(); <br> 对于特殊的文本提取，比如将 xls 文件内容写入 csv 文件，可以参考： /src/examples/src/org/apache/poi/hssf/eventusermodel/examples/XLS2CSV mra.java 文件 <br> 单元格的各种对齐方式     public static void main(String[] args)  throws Exception {         Workbook wb = new XSSFWorkbook(); //或者是 new HSSFWorkbook(); <br>  <br>         Sheet sheet = wb.createSheet();         Row row = sheet.createRow((short) 2);         row.setHeightInPoints(30); <br>  <br>         createCell(wb, row, (short) 0, XSSFCellStyle.ALIGN_CENTER, XSSFCellStyle.VERTICAL_BOTTOM);         createCell(wb, row, (short) 1, XSSFCellStyle.ALIGN_CENTER_SELECTION, XSSFCellStyle.VERTICAL_BOTTOM);         createCell(wb, row, (short) 2, XSSFCellStyle.ALIGN_FILL, XSSFCellStyle.VERTICAL_CENTER); <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 10 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>         createCell(wb, row, (short) 3, XSSFCellStyle.ALIGN_GENERAL, XSSFCellStyle.VERTICAL_CENTER);         createCell(wb, row, (short) 4, XSSFCellStyle.ALIGN_JUSTIFY, XSSFCellStyle.VERTICAL_JUSTIFY);         createCell(wb, row, (short) 5, XSSFCellStyle.ALIGN_LEFT, XSSFCellStyle.VERTICAL_TOP);         createCell(wb, row, (short) 6, XSSFCellStyle.ALIGN_RIGHT, XSSFCellStyle.VERTICAL_TOP); <br>  <br>         //将输出流写入一个文件         FileOutputStream fileOut = new FileOutputStream("xssf-align.xlsx");         wb.write(fileOut);         fileOut.close(); <br>  <br>     } <br>  <br>     /**      *创建一个单元格并为其设定指定的对齐方式.      *      * @param wb       工作簿      * @param row     单元格所在的列      * @param column 单元格所在的行索引号      * @param halign 单元格的水平对齐方式.      */     private static void createCell(Workbook wb, Row row, short column, short halign, short valign) {         Cell cell = row.createCell(column);         cell.setCellValue(new XSSFRichTextString("Align It"));         CellStyle cellStyle = wb.createCellStyle();         cellStyle.setAlignment(halign);         cellStyle.setVerticalAlignment(valign);         cell.setCellStyle(cellStyle);     }                      <br> 如何处理边框     Workbook wb = new HSSFWorkbook();     Sheet sheet = wb.createSheet("new sheet"); <br>  <br>    //创建一列，在其中加入多个单元格，列索引号从 0 开始，单元格的索引号也是从 0 //开始.     Row row = sheet.createRow(1); <br>  <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 11 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>     //创建一个单元格，并在其中加入内容.     Cell cell = row.createCell(1);     cell.setCellValue(4); <br>  <br>     //设置单元格边框为四周环绕.     CellStyle style = wb.createCellStyle();     style.setBorderBottom(CellStyle.BORDER_THIN);     style.setBottomBorderColor(IndexedColors.BLACK.getIndex());     style.setBorderLeft(CellStyle.BORDER_THIN);     style.setLeftBorderColor(IndexedColors.GREEN.getIndex());     style.setBorderRight(CellStyle.BORDER_THIN);     style.setRightBorderColor(IndexedColors.BLUE.getIndex());     style.setBorderTop(CellStyle.BORDER_MEDIUM_DASHED);     style.setTopBorderColor(IndexedColors.BLACK.getIndex());     cell.setCellStyle(style); <br>  <br>     //将输出流写入一个文件     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut);     fileOut.close(); <br>  <br> 填充色和颜色操作 Workbook wb = new XSSFWorkbook();     Sheet sheet = wb.createSheet("new sheet"); <br>  <br>    //创建一列，在其中加入多个单元格，列索引号从 0 开始，单元格的索引号也是从 0 //开始     Row row = sheet.createRow((short) 1); <br>  <br>     // 浅绿色背景色     CellStyle style = wb.createCellStyle();     style.setFillBackgroundColor(IndexedColors.AQUA.getIndex());     style.setFillPattern(CellStyle.BIG_SPOTS);     Cell cell = row.createCell((short) 1);     cell.setCellValue("X");     cell.setCellStyle(style); <br>  <br>     //橙色前景色。前景色：前景色是指正在使用的填充颜色，而非字体颜色     style = wb.createCellStyle();     style.setFillForegroundColor(IndexedColors.ORANGE.getIndex());     style.setFillPattern(CellStyle.SOLID_FOREGROUND);     cell = row.createCell((short) 2);     cell.setCellValue("X"); <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 12 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>     cell.setCellStyle(style); <br>  <br>     //将输出流写入一个文件     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut); fileOut.close(); <br>  <br> 合并单元格     Workbook wb = new HSSFWorkbook();     Sheet sheet = wb.createSheet("new sheet"); <br>  <br>     Row row = sheet.createRow((short) 1);     Cell cell = row.createCell((short) 1);     cell.setCellValue("This is a test of merging"); <br>  <br>     sheet.addMergedRegion(new CellRangeAddress(             1, //first row (0-based)             1, //last row  (0-based)             1, //first column (0-based)             2  //last column  (0-based)     )); <br>  <br>     //将输出流写入一个文件     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut);     fileOut.close(); <br>  <br> 字体的处理     Workbook wb = new HSSFWorkbook();     Sheet sheet = wb.createSheet("new sheet"); <br>  <br>    //创建一列，在其中加入多个单元格，列索引号从 0 开始，单元格的索引号也是从 0 //开始     Row row = sheet.createRow(1); <br>  <br>     // 创建一个字体并修改它的样式.     Font font = wb.createFont();     font.setFontHeightInPoints((short)24);     font.setFontName("Courier New");     font.setItalic(true);     font.setStrikeout(true); <br>  <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 13 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br> //字体在样式（style）中载入才能使用，因此创建一个 style 来使用该字体     CellStyle style = wb.createCellStyle();     style.setFont(font); <br>  <br>     //创建一个单元格，并在其中加入内容.     Cell cell = row.createCell(1);     cell.setCellValue("This is a test of fonts");     cell.setCellStyle(style); <br>  <br>     //将输出流写入一个文件     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut);     fileOut.close();    注意：  一个工作簿中最大的自定义字体数目为 32767（short 类型最大正数）。您应当复用这些字 体，而不是为每一个单元格新建一个字体。比如：  <br> 错误的用法：  <br>         for (int i = 0; i &lt; 10000; i++) {             Row row = sheet.createRow(i);             Cell cell = row.createCell((short) 0); <br>  <br>             CellStyle style = workbook.createCellStyle();             Font font = workbook.createFont();             font.setBoldweight(Font.BOLDWEIGHT_BOLD);             style.setFont(font);             cell.setCellStyle(style);         } <br> 正确的用法 :  <br>         CellStyle style = workbook.createCellStyle();         Font font = workbook.createFont();         font.setBoldweight(Font.BOLDWEIGHT_BOLD);         style.setFont(font);         for (int i = 0; i &lt; 10000; i++) {             Row row = sheet.createRow(i);             Cell cell = row.createCell((short) 0);             cell.setCellStyle(style);         } <br>  <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 14 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br> 自定义颜色 <br> HSSF:  <br>     HSSFWorkbook wb = new HSSFWorkbook();     HSSFSheet sheet = wb.createSheet();     HSSFRow row = sheet.createRow((short) 0);     HSSFCell cell = row.createCell((short) 0);     cell.setCellValue("Default Palette"); <br>  <br> //就像上面一个例子一样从标准调色板上获得几种颜色 //我们将在石灰色的背景上应用红色字体 <br>  <br>     HSSFCellStyle style = wb.createCellStyle();     style.setFillForegroundColor(HSSFColor.LIME.index);     style.setFillPattern(HSSFCellStyle.SOLID_FOREGROUND); <br>  <br>     HSSFFont font = wb.createFont();     font.setColor(HSSFColor.RED.index);     style.setFont(font); <br>  <br>     cell.setCellStyle(style); <br>  <br>     //替换保存为默认调色板     FileOutputStream out = new FileOutputStream("default_palette.xls");     wb.write(out);     out.close(); <br>  <br>     //现在然我们把橙色和石灰色的组合替换成更有吸引力的组合     // 还是比较喜欢 freebsd.org 提供的色彩方案 <br>  <br>     cell.setCellValue("Modified Palette"); <br>  <br>     //为该工作簿新建一个调色板     HSSFPalette palette = wb.getCustomPalette(); <br>  <br>     //替换标准红色为 freebsd.org 上的红色     palette.setColorAtIndex(HSSFColor.RED.index,             (byte) 153,  //RGB red (0-255)             (byte) 0,    //RGB green             (byte) 0     //RGB blue     );     //替换石灰色为 freebsd.org 上的金色 <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 15 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>     palette.setColorAtIndex(HSSFColor.LIME.index, (byte) 255, (byte) 204, (byte) 102); <br>  <br>     //将其保存为“修改过的调色板”     // 注意，不论我们以前在哪里用到了红色和石灰色，都会奇迹般的换上现在的颜色     out = new FileOutputStream("modified_palette.xls");     wb.write(out);     out.close();                      <br> XSSF:  <br>     XSSFWorkbook wb = new XSSFWorkbook();     XSSFSheet sheet = wb.createSheet();     XSSFRow row = sheet.createRow(0);     XSSFCell cell = row.createCell( 0);     cell.setCellValue("custom XSSF colors"); <br>  <br>     XSSFCellStyle style1 = wb.createCellStyle();     style1.setFillForegroundColor(new XSSFColor(new java.awt.Color(128, 0, 128)));     style1.setFillPattern(CellStyle.SOLID_FOREGROUND);                      <br> 读取和重写工作簿     InputStream inp = new FileInputStream("workbook.xls");     //InputStream inp = new FileInputStream("workbook.xlsx"); <br>  <br>     Workbook wb = WorkbookFactory.create(inp);     Sheet sheet = wb.getSheetAt(0);     Row row = sheet.getRow(2);     Cell cell = row.getCell(3);     if (cell == null)         cell = row.createCell(3);     cell.setCellType(Cell.CELL_TYPE_STRING);     cell.setCellValue("a test"); <br>  <br>     //将输出流写入一个文件     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut);     fileOut.close();                      <br> 在单元格中使用换行     Workbook wb = new XSSFWorkbook();   //or new HSSFWorkbook(); <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 16 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>     Sheet sheet = wb.createSheet(); <br>  <br>     Row row = sheet.createRow(2);     Cell cell = row.createCell(2);     cell.setCellValue("Use \n with word wrap on to create a new line"); <br>  <br>     //为了能够使用换行，您需要设置单元格的样式 wrap=true     CellStyle cs = wb.createCellStyle();     cs.setWrapText(true);     cell.setCellStyle(cs); <br>  <br>     //增加单元格的高度已能够容纳两行文字     row.setHeightInPoints((2*sheet.getDefaultRowHeightInPoints())); <br>  <br>     // 调整列宽以使用内容长度     sheet.autoSizeColumn((short)2); <br>  <br>     FileOutputStream fileOut = new FileOutputStream("ooxml-newlines.xlsx");     wb.write(fileOut);     fileOut.close();                    <br> 创建用户自定义数据格式     Workbook wb = new HSSFWorkbook();     Sheet sheet = wb.createSheet("format sheet");     CellStyle style;     DataFormat format = wb.createDataFormat();     Row row;     Cell cell;     short rowNum = 0;     short colNum = 0; <br>  <br>     row = sheet.createRow(rowNum++);     cell = row.createCell(colNum);     cell.setCellValue(11111.25);     style = wb.createCellStyle();     style.setDataFormat(format.getFormat("0.0"));     cell.setCellStyle(style); <br>  <br>     row = sheet.createRow(rowNum++);     cell = row.createCell(colNum);     cell.setCellValue(11111.25); <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 17 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>     style = wb.createCellStyle();     style.setDataFormat(format.getFormat("#,##0.0000"));     cell.setCellStyle(style); <br>  <br>     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut);     fileOut.close();                      <br> Sheet 页自适应页面大小     Workbook wb = new HSSFWorkbook();     Sheet sheet = wb.createSheet("format sheet");     PrintSetup ps = sheet.getPrintSetup(); <br>  <br>     sheet.setAutobreaks(true); <br>  <br>     ps.setFitHeight((short)1);     ps.setFitWidth((short)1); <br>  <br>  <br> //为电子表格创建多行多列.  。。。。。。。     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut);     fileOut.close();                      <br> 设定打印区域     Workbook wb = new HSSFWorkbook();     Sheet sheet = wb.createSheet("Sheet1");     //为第一个 sheet 页设定打印区域     wb.setPrintArea(0, "$A$1:$C$2");          //也可以这样实现：     wb.setPrintArea(             0, //sheet 页标             0, //开始列标             1, //结束列标             0, //开始行标             0  //结束行标     ); <br>  <br>     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut); <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 18 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>     fileOut.close();                      <br> 设置脚注页码     HSSFWorkbook wb = new HSSFWorkbook();     HSSFSheet sheet = wb.createSheet("format sheet");     HSSFFooter footer = sheet.getFooter() <br>  <br>     footer.setRight( "Page " + HSSFFooter.page() + " of " + HSSFFooter.numPages() ); <br>  <br>  <br> //为电子表格创建多行多列 。。。。。。 <br>  <br>     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut);     fileOut.close(); <br>  <br> 使用便捷函数 <br> 便捷函数存在于 contrib2中，并提供许多实用功能如不用明确的新建一个样式就能够为合 并区域设置边框和改变样式。 <br>     HSSFWorkbook wb = new HSSFWorkbook();     HSSFSheet sheet1 = wb.createSheet( "new sheet" ); <br>  <br>     //创建一个合并区域     HSSFRow row = sheet1.createRow( (short) 1 );     HSSFRow row2 = sheet1.createRow( (short) 2 );     HSSFCell cell = row.createCell( (short) 1 );     cell.setCellValue( "This is a test of merging" );     Region region = new Region( 1, (short) 1, 4, (short) 4 );     sheet1.addMergedRegion( region ); <br>  <br>     // 设置边框和边框颜色     final short borderMediumDashed = HSSFCellStyle.BORDER_MEDIUM_DASHED;     HSSFRegionUtil.setBorderBottom( borderMediumDashed,         region, sheet1, wb );     HSSFRegionUtil.setBorderTop( borderMediumDashed,         region, sheet1, wb ); <br>                                                              2Contrib：外围爱好者根据需要自行编译并贡献的软件 —译者注 <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 19 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>     HSSFRegionUtil.setBorderLeft( borderMediumDashed,         region, sheet1, wb );     HSSFRegionUtil.setBorderRight( borderMediumDashed,         region, sheet1, wb );     HSSFRegionUtil.setBottomBorderColor(HSSFColor.AQUA.index, region, sheet1, wb);     HSSFRegionUtil.setTopBorderColor(HSSFColor.AQUA.index, region, sheet1, wb);     HSSFRegionUtil.setLeftBorderColor(HSSFColor.AQUA.index, region, sheet1, wb);     HSSFRegionUtil.setRightBorderColor(HSSFColor.AQUA.index, region, sheet1, wb); <br>  <br>     //展示 HSSFCellUtil 的一些用法     HSSFCellStyle style = wb.createCellStyle();     style.setIndention((short)4);     HSSFCellUtil.createCell(row, 8, "This is the value of the cell", style);     HSSFCell cell2 = HSSFCellUtil.createCell( row2, 8, "This is the value of the cell");     HSSFCellUtil.setAlignment(cell2, wb, HSSFCellStyle.ALIGN_CENTER); <br>  <br>     //输出工作簿     FileOutputStream fileOut = new FileOutputStream( "workbook.xls" );     wb.write( fileOut );     fileOut.close();                      <br> 上下移动一行         Workbook wb = new HSSFWorkbook();         Sheet sheet = wb.createSheet("row sheet"); <br>  <br>       //为电子表格创建多行多列  。。。。。。       // 将第 6 到 第 11 行移至顶端 第 0 到 第 5 行         sheet.shiftRows(5, 10, -5); <br>  <br> 将 sheet 页设定为默认选中     Workbook wb = new HSSFWorkbook();     Sheet sheet = wb.createSheet("row sheet");     sheet.setSelected(true); <br>  <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 20 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br> 设置 sheet 页放大倍率 <br> 放大倍率是用分数来表示的，比如，如果放大倍率是 75%，那么可以用 3/4 来表示 <br>     Workbook wb = new HSSFWorkbook();     Sheet sheet1 = wb.createSheet("new sheet");     sheet1.setZoom(3,4);   // 75%放大倍率 <br>  <br> 拆分和冻结窗格 <br> 您可以创建两种窗格：冻结窗格和拆分窗格 <br> 冻结窗格是由行和列来分隔的。您可以采用以下的方式来创建冻结窗格： <br> sheet1.createFreezePane( 3, 2, 3, 2 ); 3 <br> The first two parameters are the columns and rows you wish to split by. The second two parameters indicate the cells that are visible in the bottom right quadrant.  <br> 前两个参数是您想分隔开的列数和行数，后两个参数表示在右下部分中可见的单元格。其 中第三个参数是右边区域可见的左边列数，第四个参数是下面区域可见的首行。 <br> 拆分窗格看起来和冻结窗格很不一样。拆分窗格被分成了 4 个单独的工作区域。拆分是像 素级别的，用户可以通过改变拆分点来调整拆分的效果。 <br> 拆分窗格可以通过调用以下方法实现： <br> sheet2.createSplitPane( 2000, 2000, 0, 0, Sheet.PANE_LOWER_LEFT );  <br> 第一个参数是拆分点在 X 轴上的坐标。单位是 1/20 个点。在这里可以把一个点看成一个 像素。第二个参数是拆分点在 Y 轴上的坐标，单位同样也是 1/20 个点。第三个参数是右边 区域可见的左边列数，第四个参数是下面区域可见的首行 <br> 最后一个参数指定了该拆分点落在了哪个窗格中。一共有四种选项 Sheet.PANE_LOWER_LEFT, PANE_LOWER_RIGHT, PANE_UPPER_RIGHT 或者 PANE_UPPER_LEFT.  <br>     Workbook wb = new HSSFWorkbook();     Sheet sheet1 = wb.createSheet("new sheet");     Sheet sheet2 = wb.createSheet("second sheet");     Sheet sheet3 = wb.createSheet("third sheet");     Sheet sheet4 = wb.createSheet("fourth sheet"); <br>  <br>     // 冻结第一行     sheet1.createFreezePane( 0, 1, 0, 1 ); <br>                                                              3 createFreezePane 方法有两种 createFreezePane(int colSplit, int rowSplit, int leftmostColumn, int topRow) 和 createFreezePane(int colSplit, int rowSplit) 在冻结整行整列时第二种方法更为简便 –译者注 <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 21 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>     // 冻结第一列     sheet2.createFreezePane( 1, 0, 1, 0 );     //冻结列和行（这里可以忽略右下方的滚动条的位置）     sheet3.createFreezePane( 2, 2 );     //拆分窗口并且使左下方有焦点     sheet4.createSplitPane( 2000, 2000, 0, 0, Sheet.PANE_LOWER_LEFT ); <br>  <br>     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut);     fileOut.close();                      <br> 重复列和行  <br> 在打印时，可以通过 HSSFWorkbook 类的 setRepeatingRowsAndColumns()方法设 置重复的列和行。  <br> 这个方法包含五个参数。第一个参数是 sheet 页的索引（0 代表第一个 sheet 页）。第二 和第三个参数指定了重复列的范围，如果不想重复列的话，可以用-1 代替。第四和第五 个参数指定了重复行的范围，同样如果不想重复行可以用-1 替代起止索引号。 <br>     Workbook wb = new HSSFWorkbook();     Sheet sheet1 = wb.createSheet("new sheet");     Sheet sheet2 = wb.createSheet("second sheet"); <br>  <br>  //设置第一张 sheet 页中的第一到第三列重复     wb.setRepeatingRowsAndColumns(0,0,2,-1,-1);     // 为第二张 sheet 页设置重复列和行     wb.setRepeatingRowsAndColumns(1,4,5,1,2); <br>  <br>     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut);     fileOut.close();                      <br> 页眉和页脚 <br> 这是一个页眉的例子，但页脚也同样适用 <br>     Workbook wb = new HSSFWorkbook();     Sheet sheet = wb.createSheet("new sheet"); <br>  <br>     Header header = sheet.getHeader();     header.setCenter("Center Header");     header.setLeft("Left Header");     header.setRight(HSSFHeader.font("Stencil-Normal", "Italic") + <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 22 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>                     HSSFHeader.fontSize((short) 16) + "Right w/ Stencil-Normal Italic font and size 16"); <br>  <br>     FileOutputStream fileOut = new FileOutputStream("workbook.xls");     wb.write(fileOut);     fileOut.close();                      <br> 绘制图形  <br> POI 支持调用 MS-Office 绘图工具进行图形的绘制。一张 sheet 页上的图形是按照有层 级的图形组和图形来安排的。最顶层的图形是 patriarch，它在 sheet 页上是不可见的。 在开始绘制图形之前，您需要在 HSSFSheet 对象中调用 createPatriarch 方法。调 用这个方法会清除在该 sheet 页中储存的所有的图形信息。默认情况下只要这个方法不 被调用，POI 不会将图形数据清除。 <br> 要创建一个图形，您需要做以下几步： <br> 1． 创建一个 patriarch 对象 <br> 2． 创建一个锚点以供图形在 sheet 页上定位 <br> 3． 调用 patriarch 对象创建一个图形 <br> 4． 设置图形类型（直线，椭圆，矩形等等） <br> 5． 设置图形的其他样式细节（例如：线条粗细等等） <br>     HSSFPatriarch patriarch = sheet.createDrawingPatriarch(); <br>     a = new HSSFClientAnchor( 0, 0, 1023, 255, (short) 1, 0, (short) 1, 0 );     HSSFSimpleShape shape1 = patriarch.createSimpleShape(a1);     shape1.setShapeType(HSSFSimpleShape.OBJECT_TYPE_LINE);                      <br> 文本框的创建方式如下：<br>  <br>     HSSFTextbox textbox1 = patriarch.createTextbox(             new HSSFClientAnchor(0,0,0,0,(short)1,1,(short)2,2));     textbox1.setString(new HSSFRichTextString("This is a test") );                      <br> 在同一文本框中设置不同的字体样式也是可以实现的<br>  <br>     HSSFFont font = wb.createFont();     font.setItalic(true);     font.setUnderline(HSSFFont.U_DOUBLE);     HSSFRichTextString string = new HSSFRichTextString("Woo!!!"); <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 23 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>     string.applyFont(2,5,font);     textbox.setString(string );                      <br> Just as can be done manually using Excel, it is possible to group shapes together. This is done by calling createGroup() and then creating the shapes using those groups.  <br> 如同 Excel 中可以手动设置组一样，调用 createGroup（）方法，用新建的组创建图形 也可以实现。组中也可以嵌套其他组。 <br> 注意 <br> 任何一个组中必须至少包含两个不同图形或是其他的子组。 <br>  <br> 创建图片组可以参考下面的例子：      // 创建一个图片组. HSSFShapeGroup group = patriarch.createGroup( new HSSFClientAnchor(0,0,900,200,(short)2,2,(short)2,2)); <br>  <br>     //在图片组中创建多条直线.     HSSFSimpleShape shape1 = group.createShape(new HSSFChildAnchor(3,3,500,500));     shape1.setShapeType(HSSFSimpleShape.OBJECT_TYPE_LINE);     ( (HSSFChildAnchor) shape1.getAnchor() ).setAnchor((short)3,3,500,500);     HSSFSimpleShape shape2 = group.createShape(new HSSFChildAnchor((short)1,200,400,600));     shape2.setShapeType(HSSFSimpleShape.OBJECT_TYPE_LINE);                      <br> 如果您足够细心，您将会发下，在图形组中添加的图形使用的是一个新类型的锚点对象 HSSFChildAnchor。这是因为新创建的组会有自己的坐标空间。在 POI 中，这个 坐标 空间默认为(0,0,1023,255)，但是您也可以根据自己的意愿进行修改。 <br>     myGroup.setCoordinates(10,10,20,20); // top-left, bottom-right                      <br> 如果您在一个图片组中加入了另外一个图片组，同样该子图片组也有自己的坐标空间。 <br>  <br> 设置图形样式 <br> 默认的图片演示看起来有些平常。为图形设置不同的样式也可以通过 POI 来实现。不过现 在仅能支持以下几种图形样式改变： <br>  变换填充色 <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 24 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>  去除填充色 <br>  改变线条粗细 <br>  改变线条样式 比如：虚线，点线等等 <br>  改变线条颜色 <br> 以下是如何实现  <br>     HSSFSimpleShape s = patriarch.createSimpleShape(a);     s.setShapeType(HSSFSimpleShape.OBJECT_TYPE_OVAL);     s.setLineStyleColor(10,10,10);     s.setFillColor(90,10,200);     s.setLineWidth(HSSFShape.LINEWIDTH_ONE_PT * 3);     s.setLineStyle(HSSFShape.LINESTYLE_DOTSYS);                      <br> 图形和 Graphics2d 类 <br> 虽然推荐使用本地 POI 命名来创建图形，但有时我们也希望调用标准 AIP 获得和外部库 的兼容性。处于这目的我们对 Graphics 和 Graphics2d 类进行了扩充。 <br> 注意： <br> 在开始使用之前，您需要知道 Graphics2d 对 MS-office 绘图命令的支持不是很好，虽 然 Graphics 类比起来对 MS-office 绘图命令更加兼容，但仍然差强人意。 <br> 所有的绘图指令都封装在 HSSFShapeGroup 类中。以下是它们的用法：  <br>     a = new HSSFClientAnchor( 0, 0, 1023, 255, (short) 1, 0, (short) 1, 0 );     group = patriarch.createGroup( a );     group.setCoordinates( 0, 0, 80 * 4 , 12 * 23  );     float verticalPointsPerPixel = a.getAnchorHeightInPoints(sheet) / (float)Math.abs(group.getY2() - group.getY1());     g = new EscherGraphics( group, wb, Color.black, verticalPointsPerPixel );     g2d = new EscherGraphics2d( g );     drawChemicalStructure( g2d );                      <br> 首先我们做的是为我们将要进行的绘制创建一个组并设置它的坐标。接下来，我们计算出 一个合理的 fontSizeMultipler 创建一个 EscherGraphics 对象。因为我们想得到的是 Graphics2d 对象，所以我们我们新建一个 EscherGraphics2d 对象并把它传入一个创 建好的 Graphics 对 象 中 。 最 后 我 们 会 通 过 一 系 列 流 程 将 它 绘 制 成 一 个 EscherGraphics2d 对象。  <br> 在垂直方向上每个点的像素值还需要再深入说明一下。在将 Graphics 对象调用转化成<br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 25 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br> Escher 对象调用中遇到的一个困难是，在 Excel 中没有明确的对绝对位置的像素定义。 在 Excel 中，单元格的宽度是用“字符”宽度，高度是用“点”来度量的。不幸的是，在 Excel 中并没有明确的定义被用来度量的字符的类型。估计是由于 Excel 想在不同的平台 上或是在同一平台上使用不同的字体造成的。  <br> 因为这些限制，我们必须要实现一个标准 verticalPointsPerPixel 用来度量每个垂直方 向点所占的像素。当您调用像是 drawString（）这样的方法时，所用到的字体的 verticalPointsPerPixel 度量值必须明确。 <br> 计算 verticalPointsPerPixel 值的公式如下： <br>     multipler = groupHeightInPoints / heightOfGroup                      <br> 图形组的高度可以通过简单的计算不同图形边界盒的 Y 轴坐标来得到。 获得图新组的高 度也可以简单的调用以下这个方法： <br>  HSSFClientAnchor.getAnchorHeightInPoints().  <br> 许多 Graphic 类支持的方法还没有实现，现在已知实现的方法是： <br>  fillRect()  fillOval()  drawString()  drawOval()  drawLine()  clearRect() <br> 现在还不支持的方法会调用 POI 日志机制返回并记录日志信息（默认为 disabled） <br> 提纲 <br> 提纲对将不同部分的信息聚合在一起非常重要。它可以用 POI 提供的 API 简单的这样实 现： <br>     Workbook wb = new HSSFWorkbook();     Sheet sheet1 = wb.createSheet("new sheet"); <br>  <br>     sheet1.groupRow( 5, 14 );     sheet1.groupRow( 7, 14 );     sheet1.groupRow( 16, 19 ); <br>  <br>     sheet1.groupColumn( (short)4, (short)7 );     sheet1.groupColumn( (short)9, (short)12 );     sheet1.groupColumn( (short)10, (short)11 ); <br>  <br>     FileOutputStream fileOut = new FileOutputStream(filename); <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 26 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>     wb.write(fileOut);     fileOut.close();                      折叠（或展开）一个提纲，可以用以下的方法：     sheet1.setRowGroupCollapsed( 7, true );     sheet1.setColumnGroupCollapsed( (short)4, true );                      <br> 被选中的行或列必须包含一个已经创建好的组，可以是组内的任意位置。 <br>  <br> 图像处理 <br> 图像是绘图支持的一部分。提价一张图片可以用最高级别的 Drawing 对象调用 createPicture()。现在支持的图片格式有：  <br>  PNG  JPG  DIB <br> 应当值得注意的是任何已经存在的绘图可能会因为您添加一张图片到 sheet 页上而被清 除  <br> 插入图片<br>      //创建一个新的工作簿     Workbook wb = new XSSFWorkbook(); //or new HSSFWorkbook(); <br>  <br>     //为工作簿添加图片.     InputStream is = new FileInputStream("image1.jpeg");     byte[] bytes = IOUtils.toByteArray(is);     int pictureIdx = wb.addPicture(bytes, Workbook.PICTURE_TYPE_JPEG);     is.close(); <br>  <br>     CreationHelper helper = wb.getCreationHelper(); <br>  <br>     //创建 sheet 页     Sheet sheet = wb.createSheet(); <br>  <br>     // 创建顶层的 Drawing 对象，它是所有图形和图像的载体     Drawing drawing = sheet.createDrawingPatriarch(); <br>  <br>     //添加一个图片图形     ClientAnchor anchor = helper.createClientAnchor(); <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 27 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>     //设置图形左上角的位置 //然后调用 Picture 的 resize() 方法，自动关联到新坐标    anchor.setCol1(3);     anchor.setRow1(2);     Picture pict = drawing.createPicture(anchor, pictureIdx); <br>  <br>     //自动关联到新坐标     pict.resize(); <br>  <br>     //保存到工作簿     String file = "picture.xls";     if(wb instanceof XSSFWorkbook) file += "x";     FileOutputStream fileOut = new FileOutputStream(file);     wb.write(fileOut);     fileOut.close();          注意 Picture.resize() 现仅支持 JPEG 和 PNG 格式的图片，其他格式暂不支持 <br>  <br> 从工作簿中读取图片<br>        List lst = workbook.getAllPictures();     for (Iterator it = lst.iterator(); it.hasNext(); ) {         PictureData pict = (PictureData)it.next();         String ext = pict.suggestFileExtension();         byte[] data = pict.getData();         if (ext.equals("jpeg")){           FileOutputStream out = new FileOutputStream("pict.jpg");           out.write(data);           out.close();         }     } <br>  <br> 关联范围和关联单元格  <br> 关联范围是用一个名字代表一组单元格的方式。关联单元格是关联范围的下一级一组单元 格中的一个。您可以用他们的关联范围创建或是得到对应的单元格。当要处理关联范围时 可 以 用 org.apache.poi.hssf.util.CellReference 和 org.apache.poi.hssf.util.AreaReference 两个类（除了包名不一样外，在 XSSF 和 HSSF 中同样有这两个类） <br> 创建管理范围 / 关联单元格<br>  <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 28 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>     // 准备数据     String sname = "TestSheet", cname = "TestName", cvalue = "TestVal";     Workbook wb = new HSSFWorkbook();     Sheet sheet = wb.createSheet(sname);     sheet.createRow(0).createCell((short) 0).setCellValue(cvalue); <br>  <br>     //1.用空间引用为一个单元格创建关联范围     Name namedCell = wb.createName();     namedCell.setNameName(cname);     String reference = sname+"!A1:A1"; // 空间引用     namedCell.setRefersToFormula(reference); <br>  <br>     // 2.用单元格引用为一个单元格创建关联范围     Name namedCel2 = wb.createName();     namedCel2.setNameName(cname);     String reference = sname+"!A1"; //单元格引用     namedCel2.setRefersToFormula(reference); <br>  <br>     // 3. 用空间引用为一组单元格创建关联范围     Name namedCel3 = wb.createName();     namedCel3.setNameName(cname);     String reference = sname+"!A1:C5"; // 空间引用     namedCel3.setRefersToFormula(reference); <br>  <br>     // 4. 创建关联方程     Name namedCel4 = wb.createName();     namedCel4.setNameName("my_sum");     namedCel4.setRefersToFormula("SUM(sname+!$I$2:$I$6)");              <br> 从关联范围 / 关联单元格读取数据  <br>     // 准备数据     String cname = "TestName";     Workbook wb = getMyWorkbook(); // 获得工作簿 <br>  <br>     //获得关联范围     int namedCellIdx = wb.getNameIndex(cellName);     Name aNamedCell = wb.getNameAt(namedCellIdx); <br>  <br> //在关联范围中获得单元格并检测它的内容     AreaReference aref = new AreaReference(aNamedCell.getRefersToFormula());     CellReference[] crefs = aref.getAllReferencedCells();     for (int i=0; i&lt;crefs.length; i++) { <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 29 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>         Sheet s = wb.getSheet(crefs[i].getSheetName());         Row r = sheet.getRow(crefs[i].getRow());         Cell c = r.getCell(crefs[i].getCol());         //根据单元格数据格式取出单元格内容。。。。。。.     }              从不连续的关联范围中读取数据     // 准备数据     String cname = "TestName";     Workbook wb = getMyWorkbook(); // retrieve workbook <br>  <br>     // 获得关联范围     // Will be something like "$C$10,$D$12:$D$14";     int namedCellIdx = wb.getNameIndex(cellName);     Name aNamedCell = wb.getNameAt(namedCellIdx); <br>  <br>     //在关联范围中获得单元格并检测它的内容 //将会返回 C10 单元格和 D12 到 D14 单元格的空间引用     AreaReference[] arefs = AreaReference.generateContiguous(aNamedCell.getRefersToFormula()) ;     for (int i=0; i&lt;arefs.length; i++) {         // Only get the corners of the Area         // (use arefs[i].getAllReferencedCells() to get all cells)         CellReference[] crefs = arefs[i].getCells();         for (int j=0; j&lt;crefs.length; j++) {             // Check it turns into real stuff             Sheet s = wb.getSheet(crefs[j].getSheetName());             Row r = s.getRow(crefs[j].getRow());             Cell c = r.getCell(crefs[j].getCol());             // 对此单元格进行相应的处理。。。。。。         }     }              注意：  当单元格被删除的时候，Excel 并不会删除和它关联的关联范围。因此，在工作簿 中会存在关联范围指向不存在的单元格的情况。在创建空间引用时应该先验证两者之间的关 联引用是否正确。      if(name.isDeleted()){       //关联范围指向一个不存在的单元格      } else {       AreaReference ref = new AreaReference(name.getRefersToFormula());     } <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 30 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>              <br> 为单元格添加注释  <br> 注释是不同于单元格的内容是附属于或者从属与单元格的富文本。注释的内容是独立于单 元格独自存储的，并且是在绘制对象中展示的（比如一个文本框），因此它既独立于单元 格同时又与单元格紧密联系。 <br> 添加注释<br>  Workbook wb = new XSSFWorkbook(); //or new HSSFWorkbook(); <br>  <br>     CreationHelper factory = wb.getCreationHelper(); <br>  <br>     Sheet sheet = wb.createSheet();          Cell cell = sheet.createRow(3).createCell(5);     cell.setCellValue("F4");          Drawing drawing = sheet.createDrawingPatriarch(); <br>  <br>     ClientAnchor anchor = factory.createClientAnchor();     Comment comment = drawing.createCellComment(anchor);     RichTextString str = factory.createRichTextString("Hello, World!");     comment.setString(str);     comment.setAuthor("Apache POI");     //将注释注册到单元格     cell.setCellComment(comment); <br>  <br>     String fname = "comment-xssf.xls";     if(wb instanceof XSSFWorkbook) fname += "x";     FileOutputStream out = new FileOutputStream(fname);     wb.write(out);     out.close();          <br> 读取单元格的注释<br>      Cell cell = sheet.get(3).getColumn((short)1);     Comment comment = cell.getCellComment();     if (comment != null) {       RichTextString str = comment.getString();       String author = comment.getAuthor();     }     //  另外您也可以用 sheet.getCellComment(row, column)来获取内容     comment = sheet.getCellComment(3, 1); <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 31 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>  <br> 根据内容调整单元格的宽度 Sheet sheet = workbook.getSheetAt(0);     sheet.autoSizeColumn((short)0); //调整第一列的宽度     sheet.autoSizeColumn((short)1); //调整第二列的宽度          注意： 因为 HSSFSheet.autoSizeColumn 使用 Java2D 类来计算列的宽度，因此在图形环境 （graphical environment）不可用的情况下，调用会报错。如果图形环境不可用的情况 下，您必须告诉 java 您使用的是 headless 模式，请设置以下系统属性：  java.awt.headless=true .  <br>  <br> 超级链接 <br> 获取超级链接<br>  Sheet sheet = workbook.getSheetAt(0); <br>  <br>     Cell cell = sheet.getRow(0).getCell((short)0);     Hyperlink link = cell.getHyperlink();     if(link != null){         System.out.println(link.getAddress());     } <br> 创建超级链接<br>      Workbook wb = new XSSFWorkbook(); //or new HSSFWorkbook();     CreationHelper createHelper = wb.getCreationHelper(); <br>  <br>     //设置单元格格式为超级链接     //默认情况下超级链接为下划线、蓝色字体     CellStyle hlink_style = wb.createCellStyle();     Font hlink_font = wb.createFont();     hlink_font.setUnderline(Font.U_SINGLE);     hlink_font.setColor(IndexedColors.BLUE.getIndex());     hlink_style.setFont(hlink_font); <br>  <br>     Cell cell;     Sheet sheet = wb.createSheet("Hyperlinks");     //URL     cell = sheet.createRow(0).createCell((short)0);     cell.setCellValue("URL Link"); <br>  <br>     Hyperlink link = <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 32 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br> createHelper.createHyperlink(Hyperlink.LINK_URL);     link.setAddress("http://poi.apache.org/");     cell.setHyperlink(link);     cell.setCellStyle(hlink_style); <br>  <br>     //关联到当前目录的文件     cell = sheet.createRow(1).createCell((short)0);     cell.setCellValue("File Link");     link = createHelper.createHyperlink(Hyperlink.LINK_FILE);     link.setAddress("link1.xls");     cell.setHyperlink(link);     cell.setCellStyle(hlink_style); <br>  <br>     //e-mail 关联     cell = sheet.createRow(2).createCell((short)0);     cell.setCellValue("Email Link");     link = createHelper.createHyperlink(Hyperlink.LINK_EMAIL);     //注意：如果邮件主题中存在空格，请保证是按照 URL 格式书写的     link.setAddress("mailto:poi@apache.org?subject=Hyperlinks");     cell.setHyperlink(link);     cell.setCellStyle(hlink_style); <br>  <br>     //关联到工作簿中的位置 <br>  <br>     //创建一个目标 sheet 页和目标单元格     Sheet sheet2 = wb.createSheet("Target Sheet");     sheet2.createRow(0).createCell((short)0).setCellValue("Target Cell"); <br>  <br>     cell = sheet.createRow(3).createCell((short)0);     cell.setCellValue("Worksheet Link");     Hyperlink link2 = createHelper.createHyperlink(Hyperlink.LINK_DOCUMENT);     link2.setAddress("'Target Sheet'!A1");     cell.setHyperlink(link2);     cell.setCellStyle(hlink_style); <br>  <br>     FileOutputStream out = new FileOutputStream("hyperinks.xlsx");     wb.write(out);     out.close();          <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 33 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br> 数据验证 <br> 注意： <br> 最新的 3.5 版本，XSSF 数据流不支持数据验证而且 HSSF 数据流也不支持从 sheet 页 中恢复数据的验证 <br> 检测用户输入是否与预定义的值相悖<br>  <br> 以下的代码中，见限制用户在 A1 单元格中输入的数值仅为 10,20,30 中的一个 <br>   HSSFWorkbook workbook = new HSSFWorkbook();   HSSFSheet sheet = workbook.createSheet("Data Validation");   CellRangeAddressList addressList = new CellRangeAddressList(       0, 0, 0, 0);   DVConstraint dvConstraint = DVConstraint.createExplicitListConstraint(       new String[]{"10", "20", "30"});   HSSFDataValidation dataValidation = new HSSFDataValidation       (addressList, dvConstraint);   datavalidation.setSuppressDropDownArrow(true);   sheet.addValidationData(dataValidation);          <br> 下拉列表<br>  <br> 以下的代码将完成相同的功能，但是提供一个下拉列表供用户选择 <br>   HSSFWorkbook workbook = new HSSFWorkbook();   HSSFSheet sheet = workbook.createSheet("Data Validation");   CellRangeAddressList addressList = new CellRangeAddressList(       0, 0, 0, 0);   DVConstraint dvConstraint = DVConstraint.createExplicitListConstraint(       new String[]{"10", "20", "30"});   HSSFDataValidation dataValidation = new HSSFDataValidation       (addressList, dvConstraint);   datavalidation.setSuppressDropDownArrow(false);   sheet.addValidationData(dataValidation);          <br> 错误提示信息  <br> 当用户输入非法值是弹出一个消息窗（Message box）告知用户 <br>  dataValidation.setErrorStyle(HSSFDataValidation.ErrorStyle.STOP);   dataValidation.createErrorBox("Box Title", "Message Text");          <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 34 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br> 替换“Box Title”为您想在消息框标题栏所显示的标题名称，替换“Message Text” 为您的错误提示信息 <br> 提示框（ Prompt ）  <br> 当需要验证的单元格被选中时弹出提示框（Prompt）提醒用户 <br>   dataValidation.createPromptBox("Title", "Message Text");   dataValidation.setShowPromptBox(true);          createPromptBox() 中的第一个参数是提示框的标题，第二个参数是提示信息。 DVConstraint 对象的 createExplicitListConstraint() 传 入 的 参 数 可 以 是 表 示 Integer，floating point, date 或是文本的 String 数组。 <br> 高级数据校验<br>  <br> 对输入的数据进行校验比如输入一个在 10 到 100 之间整型的值可以用 <br> DVConstraint.createNumericConstraint(int, int, String, String)这个工厂方法 <br>   dvConstraint = DVConstraint.createNumericConstraint(     DVConstraint.ValidationType.INTEGER,     DVConstraint.OperatorType.BETWEEN, "10", "100");          <br> 如果查阅一下 javaDoc 可以看到其他的校验方法和可以支持的类型。请记住不是所有的 类型都支持校验 。通过两个 String 类型传入的参数可以是公式。“=”是一个公式的标 志。 <br>   dvConstraint = DVConstraint.createNumericConstraint(     DVConstraint.ValidationType.INTEGER,     DVConstraint.OperatorType.BETWEEN, "=SUM(A1:A3)", "100");          <br> 如果 createNumericConstraint()方法已经被调用，那将不能够创建一个下拉列表。同 时 setSuppressDropDownArrow(false)的调用也将被忽略。 时间和日期的约束可以 通 过 调 用 createDateConstraint(int, String, String, String) 或是 createTimeConstraint(int, String, String)来实现。两者的调用与上面的方法类似， javaDoc 中有很详细的解释。  <br> 用单元格中数据创建数据校验值<br>  <br> 特 定 的 单 元 格 的 内 容 可 以 为 数据校验提 供 校 验 值 。 DVConstraint.createFormulaListConstraint(String)方法对这种校验方式提供支持。 指定从连续的单元格取得的内容作为校验值可以采用以下两种方法中的一种： <br>   dvConstraint = DVConstraint.createFormulaListConstraint("$A$1:$A$3");        <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 35 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br> 或者 <br>   HSSFNamedRange namedRange = workbook.createName();   namedRange.setNameName("list1");   namedRange.setRefersToFormula("$A$1:$A$3");   dvConstraint = DVConstraint.createFormulaListConstraint("list1");        <br> 在上面两个例子中，用户将可以从下拉列表中选择从 A1A2A3 单元格中取到的值。 <br> 所有的数据不一定都是校验值。然而从不同的 sheet 页中取得数据的话，这个 sheet 页 在创建的时候必须别赋予一个 sheet 名，并且这个名字应该在方程式中使用。那么，假设 存在一个名字是“Data Sheet”的 sheet 页，那可以这样操作： <br>   HSSFNamedRange namedRange = workbook.createName();   namedRange.setNameName("list1");   namedRange.setRefersToFormula("'Data Sheet'!$A$1:$A$3");   dvConstraint = DVConstraint.createFormulaListConstraint("list1");        <br> 这样也是可以的: <br>   dvConstraint = DVConstraint.createFormulaListConstraint("'Data Sheet'!$A$1:$A$3"); <br> 但这样是不行的: <br>   HSSFNamedRange namedRange = workbook.createName();   namedRange.setNameName("list1");   namedRange.setRefersToFormula("'Sheet1'!$A$1:$A$3");   dvConstraint = DVConstraint.createFormulaListConstraint("list1");        <br> 这样也是不行的： <br>   dvConstraint = DVConstraint.createFormulaListConstraint("'Sheet1'!$A$1:$A$3"); <br> 嵌入其他资源对象 <br> 可以对嵌入的 Excel、word、PowerPoint 文档或者其他类型的嵌入对象进行更加进行的 操作。 <br> HSSF:  <br>   POIFSFileSystem fs = new POIFSFileSystem(new FileInputStream("excel_with_embeded.xls"));   HSSFWorkbook workbook = new HSSFWorkbook(fs);   for (HSSFObjectData obj : workbook.getAllEmbeddedObjects()) {       //该对象的 OLE2 类名 <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 36 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>       String oleName = obj.getOLE2ClassName();       if (oleName.equals("Worksheet")) {           DirectoryNode dn = (DirectoryNode) obj.getDirectory();           HSSFWorkbook embeddedWorkbook = new HSSFWorkbook(dn, fs, false);           //System.out.println(entry.getName() + ": " + embeddedWorkbook.getNumberOfSheets());       } else if (oleName.equals("Document")) {           DirectoryNode dn = (DirectoryNode) obj.getDirectory();           HWPFDocument embeddedWordDocument = new HWPFDocument(dn, fs);           //System.out.println(entry.getName() + ": " + embeddedWordDocument.getRange().text());       }  else if (oleName.equals("Presentation")) {           DirectoryNode dn = (DirectoryNode) obj.getDirectory();           SlideShow embeddedPowerPointDocument = new SlideShow(new HSLFSlideShow(dn, fs));           //System.out.println(entry.getName() + ": " + embeddedPowerPointDocument.getSlides().length);       } else {           if(obj.hasDirectoryEntry()){        // 文件夹实体类（DirectoryEntry）是一个文档节点（ DocumentNode） // 检查它的实体，获得它的内容               DirectoryNode dn = (DirectoryNode) obj.getDirectory();               for (Iterator entries = dn.getEntries(); entries.hasNext();) {                   Entry entry = (Entry) entries.next();                   //System.out.println(oleName + "." + entry.getName());               }           } else {               // 如果没有文件夹实体类（DirectoryEntry）               //从 HSSFObjectData 对象中恢复嵌入文档的数据               byte[] objectData = obj.getObjectData();           }       }   }         <br> XSSF:  <br>   XSSFWorkbook workbook = new XSSFWorkbook("excel_with_embeded.xlsx");   for (PackagePart pPart : workbook.getAllEmbedds()) {       String contentType = pPart.getContentType(); <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 37 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br>       //Excel 工作簿 二进制或 OpenXML 格式       if (contentType.equals("application/vnd.ms-excel")) {           HSSFWorkbook embeddedWorkbook = new HSSFWorkbook(pPart.getInputStream());       }       //Excel 工作簿 OpenXML 格式       else if (contentType.equals("application/vnd.openxmlformats-officedocumen t.spreadsheetml.sheet")) {           OPCPackage docPackage = OPCPackage.open(pPart.getInputStream());           XSSFWorkbook embeddedWorkbook = new XSSFWorkbook(docPackage);       }       // word 文档- 二进制 (OLE2CDF) 文件格式       else if (contentType.equals("application/msword")) {           HWPFDocument document = new HWPFDocument(pPart.getInputStream());       }       // word 文档 - OpenXML 文件格式       else if (contentType.equals("application/vnd.openxmlformats-officedocumen t.wordprocessingml.document")) {           OPCPackage docPackage = OPCPackage.open(pPart.getInputStream());           XWPFDocument document = new XWPFDocument(docPackage);       }       //PPT 文档 –二进制文件格式       else if (contentType.equals("application/vnd.ms-powerpoint")) {           HSLFSlideShow slideShow = new HSLFSlideShow(pPart.getInputStream());       }       // PPT 文档 - OpenXML 文件格式       else if (contentType.equals("application/vnd.openxmlformats-officedocumen t.presentationml.presentation")) {           OPCPackage docPackage = OPCPackage.open(pPart.getInputStream());           XSLFSlideShow slideShow = new XSLFSlideShow(docPackage);       }       //其他的嵌入文件格式.       else {           System.out.println("Unknown Embedded Document: " + <br> POI3.5 HSSF&amp;XSSF Excel 操作快速入门 <br> 38 <br> 本文翻译自 http://poi.apache.org/spreadsheet/quick-guide.html<br> 欢迎交流指正                岑坚 ( 高凯 )hellonickco.javaeye.com <br> contentType);           InputStream inputStream = pPart.getInputStream();       }   } <br>  </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/431481de05761223b7ab69255dd1b10f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">笔记：STM32——使用ADC通道采集端口电压数据</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/23e2322dac4d974dd983582118cd9bc3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux高级进程编程———在任意两个进程间传递文件描述符：使用 sendmsg 和 recvmsg 实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>