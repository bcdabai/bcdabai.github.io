<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#中英文语音合成与中文语音识别技术 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#中英文语音合成与中文语音识别技术" />
<meta property="og:description" content="在.net中,对英文语音有较好的支持，但是对中文语音的支持还没有加入进来，我们要想实现中文发音或中文语音识别，必需先安装微软的Speech Application SDK（SASDK），它的最新版本是 SAPI 5.1 他能够识别中、日、英三种语言，你可以在这里下载：http://www.microsoft.com/speech/download/sdk51/,需要安装这两个文件Speech SDK 5.1和5.1 Language Pack，其中5.1 Language Pack可以选择安装支持的语言。 安装好以后，我们就可以开始进行语音程序的开发了，当然，在这之前我们需要把SAPI.dll通过如下图所示添加到引用中 下面我们设计一个能够朗读中英文混合语言的类： 我们将用单例模式实现该类，类的代码如下，我们将详细解释： public class Speach { private static Speach _Instance = null ; private SpeechLib.SpVoiceClass voice =null; private Speach() { BuildSpeach() ; } public static Speach instance() { if (_Instance == null) _Instance = new Speach() ; return _Instance ; } private void SetChinaVoice() { voice.Voice = voice.GetVoices(string.Empty,string.Empty).Item(0) ; } private void SetEnglishVoice() { voice.Voice = voice." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a0001d420836fec7a4faa20537907a9e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2007-03-28T13:29:00+08:00" />
<meta property="article:modified_time" content="2007-03-28T13:29:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#中英文语音合成与中文语音识别技术</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    在.net中,对英文语音有较好的支持，但是对中文语音的支持还没有加入进来，我们要想实现中文发音或中文语音识别，必需先安装微软的Speech Application SDK（SASDK），它的最新版本是 SAPI 5.1 他能够识别中、日、英三种语言，你可以在这里下载：http://www.microsoft.com/speech/download/sdk51/,需要安装这两个文件Speech SDK 5.1和5.1 Language Pack，其中5.1 Language Pack可以选择安装支持的语言。 
<br> 
<br>安装好以后，我们就可以开始进行语音程序的开发了，当然，在这之前我们需要把SAPI.dll通过如下图所示添加到引用中 
<br> 
<br>下面我们设计一个能够朗读中英文混合语言的类： 
<br> 
<br>我们将用单例模式实现该类，类的代码如下，我们将详细解释： 
<br> 
<br>public class Speach 
<br> 
<br>{ 
<br> 
<br>private static Speach _Instance = null ; 
<br> 
<br>private SpeechLib.SpVoiceClass voice =null; 
<br> 
<br>private Speach() 
<br> 
<br>{ 
<br> 
<br>BuildSpeach() ; 
<br> 
<br>} 
<br> 
<br>public static Speach instance() 
<br> 
<br>{ 
<br> 
<br>if (_Instance == null) 
<br> 
<br>_Instance = new Speach() ; 
<br> 
<br>return _Instance ; 
<br> 
<br>} 
<br> 
<br>private void SetChinaVoice() 
<br> 
<br>{ 
<br> 
<br>voice.Voice = voice.GetVoices(string.Empty,string.Empty).Item(0) ; 
<br> 
<br>} 
<br> 
<br>private void SetEnglishVoice() 
<br> 
<br>{ 
<br> 
<br>voice.Voice = voice.GetVoices(string.Empty,string.Empty).Item(1) ; 
<br> 
<br>} 
<br> 
<br>private void SpeakChina(string strSpeak) 
<br> 
<br>{ 
<br> 
<br>SetChinaVoice() ; 
<br> 
<br>Speak(strSpeak) ; 
<br> 
<br>} 
<br> 
<br>private void SpeakEnglishi(string strSpeak) 
<br> 
<br>{ 
<br> 
<br>SetEnglishVoice() ; 
<br> 
<br>Speak(strSpeak) ; 
<br> 
<br>} 
<br> 
<br> 
<br> 
<br>public void AnalyseSpeak(string strSpeak) 
<br> 
<br>{ 
<br> 
<br>int iCbeg = 0 ; 
<br> 
<br>int iEbeg = 0 ; 
<br> 
<br>bool IsChina = true ; 
<br> 
<br>for(int i=0;i&lt;strSpeak.Length;i++) 
<br> 
<br>{ 
<br> 
<br>char chr = strSpeak[i] ; 
<br> 
<br>if (IsChina) 
<br> 
<br>{ 
<br> 
<br>if (chr&lt;=122&amp;&amp;chr&gt;=65) 
<br> 
<br>{ 
<br> 
<br>int iLen = i - iCbeg ; 
<br> 
<br>string strValue = strSpeak.Substring(iCbeg,iLen) ; 
<br> 
<br>SpeakChina(strValue) ; 
<br> 
<br>iEbeg = i ; 
<br> 
<br>IsChina = false ; 
<br> 
<br>} 
<br> 
<br>} 
<br> 
<br>else 
<br> 
<br>{ 
<br> 
<br>if (chr&gt;122||chr&lt;65) 
<br> 
<br>{ 
<br> 
<br>int iLen = i - iEbeg ; 
<br> 
<br>string strValue = strSpeak.Substring(iEbeg,iLen) ; 
<br> 
<br>this.SpeakEnglishi(strValue) ; 
<br> 
<br>iCbeg = i ; 
<br> 
<br>IsChina = true ; 
<br> 
<br>} 
<br> 
<br>} 
<br> 
<br> 
<br> 
<br>}//end for 
<br> 
<br>if (IsChina) 
<br> 
<br>{ 
<br> 
<br>int iLen = strSpeak.Length - iCbeg ; 
<br> 
<br>string strValue = strSpeak.Substring(iCbeg,iLen) ; 
<br> 
<br>SpeakChina(strValue) ; 
<br> 
<br>} 
<br> 
<br>else 
<br> 
<br>{ 
<br> 
<br>int iLen = strSpeak.Length - iEbeg ; 
<br> 
<br>string strValue = strSpeak.Substring(iEbeg,iLen) ; 
<br> 
<br>SpeakEnglishi(strValue) ; 
<br> 
<br>} 
<br> 
<br> 
<br> 
<br>} 
<br> 
<br>private void BuildSpeach() 
<br> 
<br>{ 
<br> 
<br>if (voice == null) 
<br> 
<br>voice = new SpVoiceClass() ; 
<br> 
<br>} 
<br> 
<br>public int Volume 
<br> 
<br>{ 
<br> 
<br>get 
<br> 
<br>{ 
<br> 
<br>return voice.Volume ; 
<br> 
<br>} 
<br> 
<br>set 
<br> 
<br>{ 
<br> 
<br>voice.SetVolume((ushort)(value)) ; 
<br> 
<br>} 
<br> 
<br>} 
<br> 
<br>public int Rate 
<br> 
<br>{ 
<br> 
<br>get 
<br> 
<br>{ 
<br> 
<br>return voice.Rate ; 
<br> 
<br>} 
<br> 
<br>set 
<br> 
<br>{ 
<br> 
<br>voice.SetRate(value) ; 
<br> 
<br>} 
<br> 
<br>} 
<br> 
<br>private void Speak(string strSpeack) 
<br> 
<br>{ 
<br> 
<br>try 
<br> 
<br>{ 
<br> 
<br>voice.Speak(strSpeack,SpeechVoiceSpeakFlags.SVSFlagsAsync) ; 
<br> 
<br>} 
<br> 
<br>catch(Exception err) 
<br> 
<br>{ 
<br> 
<br>throw(new Exception("发生一个错误："+err.Message)) ; 
<br> 
<br>} 
<br> 
<br>} 
<br> 
<br> 
<br> 
<br>public void Stop() 
<br> 
<br>{ 
<br> 
<br>voice.Speak(string.Empty,SpeechLib.SpeechVoiceSpeakFlags.SVSFPurgeBeforeSpeak) ; 
<br> 
<br>} 
<br> 
<br>public void Pause() 
<br> 
<br>{ 
<br> 
<br>voice.Pause() ; 
<br> 
<br>} 
<br> 
<br>public void Continue() 
<br> 
<br>{ 
<br> 
<br>voice.Resume() ; 
<br> 
<br>} 
<br> 
<br> 
<br> 
<br> 
<br> 
<br>}//end class 
<br> 
<br> 
<br> 
<br> 
<br> 
<br>在 private SpeechLib.SpVoiceClass voice =null;这里，我们定义个一个用来发音的类，并且在第一次调用该类时，对它用BuildSpeach方法进行了初始化。 
<br> 
<br>我们还定义了两个属性Volume和Rate，能够设置音量和语速。 
<br> 
<br>我们知道，SpVoiceClass 有一个Speak方法，我们发音主要就是给他传递一个字符串，它负责读出该字符串，如下所示。 
<br> 
<br>private void Speak(string strSpeack) 
<br> 
<br>{ 
<br> 
<br>try 
<br> 
<br>{ 
<br> 
<br>voice.Speak(strSpeack,SpeechVoiceSpeakFlags.SVSFlagsAsync) ; 
<br> 
<br>} 
<br> 
<br>catch(Exception err) 
<br> 
<br>{ 
<br> 
<br>throw(new Exception("发生一个错误："+err.Message)) ; 
<br> 
<br>} 
<br> 
<br>} 
<br> 
<br>其中SpeechVoiceSpeakFlags.SVSFlagsAsync表示异步发音。  
<br> 但是，这个方法本身并不知道你给的字符串是什么语言，所以需要我们它这个字符串用什么语言读出。SpVoiceClass 类的Voice 属性就是用来设置语种的，我们可以通过SpVoiceClass 的GetVoices方法得到所有的语种列表，然后在根据参数选择相应的语种，比如设置语种为汉语如下所示： 
<br> 
<br>private void SetChinaVoice() 
<br> 
<br>{ 
<br> 
<br>voice.Voice = voice.GetVoices(string.Empty,string.Empty).Item(0) ; 
<br> 
<br>} 
<br> 
<br>0表示是汉用，1234都表示英语，就是口音不同。 
<br> 
<br>这样，我们就设置了语种，如果结合发音方法，我们就可以设计出一个只发汉语语音的方法 
<br> 
<br>private void SpeakChina(string strSpeak) 
<br> 
<br>{ 
<br> 
<br>SetChinaVoice() ; 
<br> 
<br>Speak(strSpeak) ; 
<br> 
<br>} 
<br> 
<br>只发英语语音的方法也是类似的，上面程序里有。 
<br> 
<br>对于一段中英文混合的语言，我们让程序读出混合语音的方法就是：编程把这段语言的中英文分开，对于中文调用SpeakChina方法，英文调用SpeakEnglishi方法；至于怎样判断一个字符是英文还是中文，我采用的是判断asc码的方法，具体的类方法是通过AnalyseSpeak实现的。 
<br> 
<br>这样，对于一段中英文混合文字，我们只需把它作为参数传递给AnalyseSpeak就可以了，他能够完成中英文的混合发音。 
<br> 
<br>当然，对于发音的暂定、继续、停止等操作，上面也给出了简单的方法调用，很容易明白。 
<br> 
<br> 
<br> 
<br>下面简单介绍一下中文语音识别的方法： 
<br> 
<br>先把该语音识别的类源代码贴在下面，然后再做说明： 
<br> 
<br>public class SpRecognition 
<br> 
<br>{ 
<br> 
<br>private static SpRecognition _Instance = null ; 
<br> 
<br>private SpeechLib.ISpeechRecoGrammar isrg ; 
<br> 
<br>private SpeechLib.SpSharedRecoContextClass ssrContex =null; 
<br> 
<br>private System.Windows.Forms.Control cDisplay ; 
<br> 
<br>private SpRecognition() 
<br> 
<br>{ 
<br> 
<br>ssrContex = new SpSharedRecoContextClass() ; 
<br> 
<br>isrg = ssrContex.CreateGrammar(1) ; 
<br> 
<br>SpeechLib._ISpeechRecoContextEvents_RecognitionEventHandler recHandle = 
<br> 
<br>new _ISpeechRecoContextEvents_RecognitionEventHandler(ContexRecognition) ; 
<br> 
<br>ssrContex.Recognition += recHandle ; 
<br> 
<br>} 
<br> 
<br>public void BeginRec(Control tbResult) 
<br> 
<br>{ 
<br> 
<br>isrg.DictationSetState(SpeechRuleState.SGDSActive) ; 
<br> 
<br>cDisplay = tbResult ; 
<br> 
<br>} 
<br> 
<br>public static SpRecognition instance() 
<br> 
<br>{ 
<br> 
<br>if (_Instance == null) 
<br> 
<br>_Instance = new SpRecognition() ; 
<br> 
<br>return _Instance ; 
<br> 
<br>} 
<br> 
<br>public void CloseRec() 
<br> 
<br>{ 
<br> 
<br>isrg.DictationSetState(SpeechRuleState.SGDSInactive) ; 
<br> 
<br>} 
<br> 
<br>private void ContexRecognition(int iIndex,object obj,SpeechLib.SpeechRecognitionType type,SpeechLib.ISpeechRecoResult result) 
<br> 
<br>{ 
<br> 
<br>cDisplay.Text += result.PhraseInfo.GetText(0,-1,true) ; 
<br> 
<br>} 
<br> 
<br> 
<br> 
<br>} 
<br> 
<br> 
<br> 
<br>我们定义了ssrContex 和isrg为语音识别的上下文和语法，通过设置isrg的DictationSetState方法，我们可以开始或结束识别，在上面的程序中是BeginRec和CloseRec方法。cDisplay 是我们用来输出识别结果的地方，为了能够在大部分控件上都可以显示结果，我用了一个Control 类来定义它。当然，每次语音识别后都会触发ISpeechRecoContextEvents_RecognitionEventHandler 事件，我们定义了一个这样的方法ContexRecognition来响应事件，并且在这个方法里输出识别结果。 
<br> 
<br> 
<br> 
<br>这样，中文语音处理的一些最基本的问题就有了一个简单的解决方法，当然，这种方法还有很多不完善的地方，希望大家多提出批评意见，共同提高。  
<br> 
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4e3cc85727824dbdd26188f948580c91/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">U盘无法双击打开的解决办法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0955d74991bcee83c70907a770bd02d5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">常用软件密码破解完全指南[转]</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>