<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Java使用JaxWsDynamicClientFactory和HttpURLConnection调取Webservice接口 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Java使用JaxWsDynamicClientFactory和HttpURLConnection调取Webservice接口" />
<meta property="og:description" content="点击上方“猿芯”，选择“设为星标”
后台回复&#34;1024&#34;，有份惊喜送给面试的你
方式1. 代理类工厂的方式,需要拿到对方的接口
try { // 接口地址 // 代理工厂 JaxWsProxyFactoryBean jaxWsProxyFactoryBean = new JaxWsProxyFactoryBean(); // 设置代理地址 wsdlAddress: WSDL地址（http://localhost:8082/ws/services/bank?wsdl） jaxWsProxyFactoryBean.setAddress(wsdlAddress); // 设置接口类型 jaxWsProxyFactoryBean.setServiceClass(ICommonService.class); // 创建一个代理接口实现 ICommonService cs = (ICommonService) jaxWsProxyFactoryBean.create(); // 数据准备 String userName = &#34;Leftso&#34;; // 调用代理接口的方法调用并返回结果 String result = cs.sayHello(userName); System.out.println(&#34;返回结果:&#34; &#43; result); } catch (Exception e) { e.printStackTrace(); } 方式2. 动态调用方式 //WSDL路径 String wsUrl = &#34;http://localhost:8082/ws/services/bank?wsdl&#34; ; //方法名 String method = &#34;getCaseProve&#34;; JaxWsDynamicClientFactory factory = JaxWsDynamicClientFactory.newInstance(); Client client = factory." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/62e1db731117768faa943d60fd10533b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-28T10:44:15+08:00" />
<meta property="article:modified_time" content="2022-09-28T10:44:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Java使用JaxWsDynamicClientFactory和HttpURLConnection调取Webservice接口</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p style="text-align:center;">点击上方“<strong>猿芯</strong>”，选择“<strong>设为星标</strong>”</p> 
 <p style="text-align:center;">后台回复"<strong>1024</strong>"，有份惊喜送给面试的你</p> 
 <p><strong>方式1.  代理类工厂的方式,需要拿到对方的接口</strong></p> 
 <pre class="has"><code class="language-javascript">try {
    // 接口地址
    // 代理工厂
    JaxWsProxyFactoryBean jaxWsProxyFactoryBean = new JaxWsProxyFactoryBean();
    // 设置代理地址 wsdlAddress: WSDL地址（http://localhost:8082/ws/services/bank?wsdl）
    jaxWsProxyFactoryBean.setAddress(wsdlAddress);
    // 设置接口类型
    jaxWsProxyFactoryBean.setServiceClass(ICommonService.class);
    // 创建一个代理接口实现
    ICommonService cs = (ICommonService) jaxWsProxyFactoryBean.create();
    // 数据准备
    String userName = "Leftso";
    // 调用代理接口的方法调用并返回结果
    String result = cs.sayHello(userName);
    System.out.println("返回结果:" + result);
} catch (Exception e) {
    e.printStackTrace();
}</code></pre> 
 <pre class="has"><code class="language-go">方式2. 动态调用方式</code></pre> 
 <pre class="has"><code class="language-javascript">//WSDL路径 
　　String wsUrl = "http://localhost:8082/ws/services/bank?wsdl"  ;  
   //方法名 
   String method = "getCaseProve"; 
    
    JaxWsDynamicClientFactory factory = JaxWsDynamicClientFactory.newInstance();
    Client client = factory.createClient(wsUrl);
    Endpoint endpoint = client.getEndpoint();
    QName opName = new QName(endpoint.getService().getName().getNamespaceURI(), method);
    BindingInfo bindingInfo = endpoint.getEndpointInfo().getBinding();
   System.out.println(client);
    if (bindingInfo.getOperation(opName) == null) {
      for (BindingOperationInfo operationInfo : bindingInfo.getOperations()) {
        if (method.equals(operationInfo.getName().getLocalPart())) {
          opName = operationInfo.getName();
          break;
        }
      }
    }
　　//请求报文
　　String xmlInput= "&lt;Request RequestType=\"RegInfo\"&gt;&lt;MachineInfo MachineAccount=\"1\" MachinePassword=\"1\"&gt;&lt;/MachineInfo&gt;&lt;FiterInfo UnitNo=\""
          + unit
          + "\" HouseID=\""
          + houseId
          + "\" RecHouseNum=\""
          + recHouseNum + "\"&gt;&lt;/FiterInfo&gt;&lt;/Request&gt;";
　　Object[] res = null;     
   try { 
     res = client.invoke(opName, xmlInput);  
     String xml = (String) res[0];
     System.err.println("@@@@@@@@@@@@@@@@@"+xml);
   } catch (Exception e) {     
     e.printStackTrace();     
   }</code></pre> 
 <pre class="has"><code class="language-go">方式3. HttpURLConnection调用方式</code></pre> 
 <pre class="has"><code class="language-powershell">public class PropertiesUtil {
    private static final Logger logger = LoggerFactory
            .getLogger(PropertiesUtil.class);
    private static Properties properties = null;
    private static String fileName = "/app.properties";
    static {
        properties = new Properties();
        try {
            properties.load(PropertiesUtil.class.getResourceAsStream(fileName));
        } catch (IOException e) {
            logger.error("加载配置文件失败", e);
        }
    }


    public static Properties getProperties() {
        return properties;
    }


    public static String getProp(String propName) {
        return properties.getProperty(propName);
    }
}


public static Map&lt;String, String&gt; resultInterface(String id,String type, String jsonStr) {
    StringBuilder res = new StringBuilder();
    // 1：创建服务地址
    URL url;
    String resultUserName = PropertiesUtil.getProp("resultUserName");
    String resultPassWord = PropertiesUtil.getProp("resultPassWord");
    Map&lt;String, String&gt; map = new HashMap&lt;String, String&gt;();
    try {
      url = new URL(PropertiesUtil.getProp("resultUrl"));
      // 2：打开到服务地址的一个连接
      HttpURLConnection connection = (HttpURLConnection) url.openConnection();
      // 3：设置连接参数
      // 3.1设置发送方式：POST必须大写
      connection.setRequestMethod("POST");
      // 3.2设置数据格式：Content-type
      connection.setRequestProperty("content-type", "text/xml;charset=utf-8");
      // 3.3设置输入输出，新创建的connection默认是没有读写权限的，
      connection.setDoInput(true);
      connection.setDoOutput(true);
      //"{\"ANNOUNCEMENT_CODE\": \"CSGGBH001\",\"ANNOUNCEMENT_CONNECT\": \"asdfasdfasdfasdfasdfasdfasdfsa\",\"ANNOUNCEMENT_DEADLINE\": \"20181031\",\"ANNOUNCEMENT_GUID\": \"71F15848-C296-4A60-883C-223C55E9E8D8\",\"ANNOUNCEMENT_START_TIME\": \"20181101\",\"ANNOUNCEMENT_TITLE\": \"公告标题\",\"ANNOUNCEMENT_TYPE\": \"1\",\"ANNOUNCEMENT_UNIT\": \"单位\",\"ATTACHMENT_SET_CODE\": \"123\",\"CANCEL_REASON\": \"撤销理由\",\"CHANGE_TIME\": \"20181101\",\"CONTACT_NUMBER\": \"13333333333\",\"CONTACT_PERSON\": \"联系人\",\"CREATE_TIME\": \"20181101\",\"DATA_TIMESTAMP\": \"20181101154911\",\"EMAIL\": \"123@qq.com\",\"END_DATE\": \"20181101\",\"FIELD_NUM\": \"123\",\"LAND_DISTRICT\": \"440601\",\"LIAISON_UNIT\": \"单位\",\"LISTING_DEADLINE\": \"\",\"LISTING_START_TIME\": \"\",\"LISTING_TYPE\": \"0\",\"PLATFORM_CODE\": \"91441900708017879M\",\"PUBLISHING_TIME\": \"20181101\",\"PUB_SERVICE_PLAT_CODE\": \"123707003283632515\",\"RETREAT_TIME\": \"20181101\",\"SUPPLY_TYPE\": \"1\",\"UNIFIED_DEAL_CODE\": \"B01-123707003283632515-20181025-000015-V\",\"UNIT_ADDRESS\": \"单位地址\",\"URL\": \"http://www.baidu.com\",\"ZIP_CODE\": \"215600\"}";
      //TDJYGG
      // 4：组织SOAP协议数据，发送给服务端
      String soapXML = "&lt;soap12:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap12=\"http://www.w3.org/2003/05/soap-envelope\"&gt;"
          + "       &lt;soap12:Header&gt;                           "
          + "         &lt;root xmlns=\"http://tempuri.org/\"&gt;      "
          + "           &lt;UserName&gt;"+resultUserName+"&lt;/UserName&gt;           "
          + "           &lt;PassWord&gt;"+resultPassWord+"&lt;/PassWord&gt;           "
          + "         &lt;/root&gt;                                 "
          + "       &lt;/soap12:Header&gt;                          "
          + "       &lt;soap12:Body&gt;                             "
          + "         &lt;Push xmlns=\"http://tempuri.org/\"&gt;      "
          + "           &lt;Type&gt;"+type+"&lt;/Type&gt;                   "
          + "           &lt;JsonStr&gt;"+jsonStr+"&lt;/JsonStr&gt;"
          + "         &lt;/Push&gt;                                 "
          + "       &lt;/soap12:Body&gt;                            "
          + "     &lt;/soap12:Envelope&gt;";
      OutputStream os = connection.getOutputStream();
      os.write(soapXML.getBytes("utf-8"));


      // 5：接收服务端的响应
      int responseCode = connection.getResponseCode();
      if (200 == responseCode) {// 表示服务端响应成功
        InputStream is = connection.getInputStream();
        InputStreamReader isr = new InputStreamReader(is,"utf-8");
        BufferedReader br = new BufferedReader(isr);
        String temp = null;
        while (null != (temp = br.readLine())) {
          res.append(temp);
        }
        
        is.close();
        isr.close();
        br.close();
        String xml = res.toString();
        Document doc = DocumentHelper.parseText(xml); // 将字符串转为XML
        Element rootElt = doc.getRootElement(); // 获取根节点
        //System.out.println("根节点：" + rootElt.getStringValue()); 
        
        Element nameElem = rootElt.element("Body").element("PushResponse").element("PushResult");
        String code = nameElem.element("Code").getTextTrim();
        String description = nameElem.element("Description").getTextTrim();
        map.put("code", code);
        map.put("description", description);
      } else {
        //res.append("调接口异常!");
        map.put("code", "500");
        map.put("description", "数据推送失败,服务端响应失败!");
        logger.error("数据推送失败,服务端响应失败!");
      }
      os.close();
    } catch (Exception e) {
      //res.append("调接口异常!");
      map.put("code", "500");
      map.put("description", "数据推送异常,推送信息为trans_notice表或trans_target表的id&gt;&gt;&gt;&gt;:" + id);
      logger.error("数据推送异常,推送信息为trans_notice表或trans_target表的id&gt;&gt;&gt;&gt;:" + id + "", e);
    }
    
    return map;
  }</code></pre> 
 <p style="text-align:right;">原文：https://www.cnblogs.com/gaomanito/p/10043753.html</p> 
 <p><img title="金属质感分割线" src="https://images2.imgbox.com/89/d5/DYjqAHyl_o.jpg" alt="e51d53437d3eb5b779b5595208bb3348.jpeg"><br></p> 
 <p style="text-align:center;"><strong>往期推荐</strong></p> 
 <ol><li><p><a href="" rel="nofollow">肝九千字长文 | MyBatis-Plus 码之重器 lambda 表达式使用指南，开发效率瞬间提升80%</a><br></p></li><li><p><a href="" rel="nofollow">用 MHA 做 MySQL 读写分离，频繁爆发线上生产事故后，泪奔分享 Druid 连接池参数优化实战</a></p></li><li><p><a href="" rel="nofollow">微服务架构下，解决数据库跨库查询的一些思路</a></p></li><li><p><a href="" rel="nofollow">一文读懂阿里大中台、小前台战略</a></p></li></ol> 
 <p><strong><em>作者简介</em></strong><em>：</em><em>猿芯，<strong>一枚简单的北漂程序员。</strong></em><em>喜欢</em><em>用简单的文字记录工作与生活中的点点滴滴，愿与你一起分享程序员灵魂深处真正的内心独白</em><em>。我的微信号：</em><strong><em>WooolaDunzung</em></strong><em>，公众号【<strong>猿芯</strong>】</em><em>输入 <strong>1024 </strong>，有份面试惊喜送给你哦</em><em>。</em><br></p> 
 <p style="text-align:center;"><strong>&lt; END &gt;</strong></p> 
 <p>【猿芯】</p> 
 <p><img src="https://images2.imgbox.com/31/d0/Et6AteFc_o.jpg" alt="c978092a515c07b425d9cdc7de96904c.jpeg"></p> 
 <p> 微信扫描二维码，关注我的公众号。</p> 
 <p>分享不易，莫要干想，如果觉得有点用的话，动动你的发财之手，一键三连击：<em>分享、点赞、在看</em>，你们的鼓励是我分享优质文章的最强动力 ^_^</p> 
 <p style="text-align:right;"><strong>分享、点赞、在看，3连3连！</strong><strong><img src="https://images2.imgbox.com/43/28/53LefbzX_o.gif" alt="29eda13e3cfdca94404032034d044d3d.gif"></strong></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4ce119a25fbef30f29febcb6c1b375eb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Verilog我思我用】-generate</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/38c65e647707fcdd90364fe713514018/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">编写两个jsp文件，实现利用include动作完成参数传递计算1！&#43;2！&#43;...&#43;n!</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>