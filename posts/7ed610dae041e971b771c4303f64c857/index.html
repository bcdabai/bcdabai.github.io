<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>https原理浅析 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="https原理浅析" />
<meta property="og:description" content="之前一直对于https原理比较迷惑，只是知道是http的安全版，花了些时间学习，发现讲解https的博客有很多，但是知识点比较散乱，不成系统。这里列举下我对https的认识，有错误希望支持。
hash算法 Hash算法是一种单向算法，可以对目标信息进行加密生成一段特定长度的Hash值，但反过来却不能对这个Hash值进行反向运算得到目标信息。即使修改文本的一个字节，采用hash算法hash值会有很大不同。Hash算法常用于信息完整性和可信性的校验。 举个例子： 例如tomcat官网[http://tomcat.apache.org/download-native.cgi]，展示了每个现在文件的采用不同hash算法得到的hash值，如果一个用户下载了对应的安装包，那怎么取验证该安装包是否被篡改呢？将该安装包采用每一种hash算法计算该文件的hash值然后与官网比对，如果不一致，代表该文件被第三方篡改了。常用的有MD5，SHA等加密算法。
加密算法 加密算法分成对称加密和非对称加密 对称加密： 加密和解密使用相同的秘钥，优点加密算法简单快速，缺点双方共享同一个秘钥，技能加密也能解密，安全性较差。常用的加密算法有DES，AES等算法 非对称加密：加密和解密使用不同秘钥，加密采用私钥，解密使用公钥。优点私钥自己保管，公钥可以随意对外公开。非对称加密最常见的就是RSA加密算法。
采用http有哪些不好？ http最大的隐患是用户的信息在公网中都是采用明文传输的，想象下我们的支付宝账号和密码如果是明文传输，万一在运营上某个路由器上被黑客劫持怎么办，就好比“出门没有穿裤子” 另外http在公网中明文传输，网络运营商加点内容（比如广告）易如反掌。
https工作原理 浏览器将自己支持的一套加密规则(包括加密算法和hash算法)发送给网站。网站从中选出一组加密算法与HASH算法，并将自己的身份信息以证书的形式发回给浏览器。证书里面包含了网站地址，加密公钥，以及证书的颁发机构等信息。获得网站证书之后浏览器要做以下工作： 验证证书的合法性（颁发证书的机构是否合法，证书中包含的网站地址是否与正在访问的地址一致等），如果证书受信任，则浏览器栏里面会显示一个小锁头，否则会给出证书不受信的提示。如果证书受信任，或者是用户接受了不受信的证书，浏览器会生成一串随机数的密码，并用证书中提供的公钥加密。使用约定好的HASH计算握手消息，并使用生成的随机数对消息进行加密，最后将之前生成的所有信息发送给网站。网站接收浏览器发来的数据之后要做以下的操作： 使用自己的私钥将信息解密取出密码，使用密码解密浏览器发来的握手消息，并验证HASH是否与浏览器发来的一致。使用密码加密一段握手消息，发送给浏览器。浏览器解密并计算握手消息的HASH，如果与服务端发来的HASH一致，此时握手过程结束，之后所有的通信数据将由之前浏览器生成的随机密码并利用对称加密算法进行加密。 有了对称加密的秘钥，也就是上面的随机密码 再采用约定好的对称加密算法，就可以安全的传输用户名和密码了。
https是不是一定安全呢？ 假如客户端在上述步骤1中，请求被拦截，发送到一个坏的黑客服务器中了呢？假如黑客服务器按照上面相同的方法跟客户端进行https安全握手，那岂不是照样不安全吗？ 要解决这个问题，关键在上面第3步中第1）小部，验证证书的合法性（颁发证书的机构是否合法，证书中包含的网站地址是否与正在访问的地址一致等），这个就是CA（第三方可行机构），如果要发布一个服务采用https，大公司都会想CA购买证书，CA机构颁发的证书非常昂贵。如果证书受信任，则浏览器栏里面会显示一个小锁头，否则会给出证书不受信的提示。 如果浏览器提示了证书不受信任，用户仍然点击确认，是一个安全网站还好，如果是一个钓鱼网站就怪不了别人了。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/7ed610dae041e971b771c4303f64c857/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-12-27T22:47:13+08:00" />
<meta property="article:modified_time" content="2015-12-27T22:47:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">https原理浅析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>之前一直对于https原理比较迷惑，只是知道是http的安全版，花了些时间学习，发现讲解https的博客有很多，但是知识点比较散乱，不成系统。这里列举下我对https的认识，有错误希望支持。</p> 
<hr> 
<h4 id="hash算法"><strong>hash算法</strong></h4> 
<p>Hash算法是一种单向算法，可以对目标信息进行加密生成一段特定长度的Hash值，但反过来却不能对这个Hash值进行反向运算得到目标信息。即使修改文本的一个字节，采用hash算法hash值会有很大不同。Hash算法常用于信息完整性和可信性的校验。 <br> 举个例子： 例如tomcat官网[<a href="http://tomcat.apache.org/download-native.cgi%5D" rel="nofollow">http://tomcat.apache.org/download-native.cgi]</a>，展示了每个现在文件的采用不同hash算法得到的hash值，如果一个用户下载了对应的安装包，那怎么取验证该安装包是否被篡改呢？将该安装包采用每一种hash算法计算该文件的hash值然后与官网比对，如果不一致，代表该文件被第三方篡改了。常用的有MD5，SHA等加密算法。</p> 
<hr> 
<h4 id="加密算法"><strong>加密算法</strong></h4> 
<p>加密算法分成对称加密和非对称加密 <br> 对称加密： 加密和解密使用相同的秘钥，优点加密算法简单快速，缺点双方共享同一个秘钥，技能加密也能解密，安全性较差。常用的加密算法有DES，AES等算法 <br> 非对称加密：加密和解密使用不同秘钥，加密采用私钥，解密使用公钥。优点私钥自己保管，公钥可以随意对外公开。非对称加密最常见的就是RSA加密算法。</p> 
<hr> 
<h4 id="采用http有哪些不好"><strong>采用http有哪些不好？</strong></h4> 
<p>http最大的隐患是用户的信息在公网中都是采用明文传输的，想象下我们的支付宝账号和密码如果是明文传输，万一在运营上某个路由器上被黑客劫持怎么办，就好比“出门没有穿裤子” <br> 另外http在公网中明文传输，网络运营商加点内容（比如广告）易如反掌。</p> 
<hr> 
<h4 id="https工作原理"><strong>https工作原理</strong></h4> 
<p><img src="https://images2.imgbox.com/64/86/gVCi4xTn_o.png" alt="这里写图片描述" title=""></p> 
<blockquote> 
 <ol><li>浏览器将自己支持的一套<strong>加密规则</strong>(包括加密算法和hash算法)发送给网站。</li><li>网站从中选出一组加密算法与HASH算法，并将自己的身份信息以证书的形式发回给浏览器。证书里面包含了<strong>网站地址</strong>，<strong>加密公钥</strong>，以及<strong>证书的颁发机构</strong>等信息。</li><li>获得网站证书之后浏览器要做以下工作： <br> 
   <ol><li>验证证书的合法性（颁发证书的机构是否合法，证书中包含的网站地址是否与正在访问的地址一致等），如果证书受信任，则浏览器栏里面会显示一个小锁头，否则会给出证书不受信的提示。</li><li>如果证书受信任，或者是用户接受了不受信的证书，浏览器会生成一串随机数的密码，并用证书中提供的公钥加密。</li><li>使用约定好的HASH计算握手消息，并使用生成的随机数对消息进行加密，最后将之前生成的所有信息发送给网站。</li></ol></li><li>网站接收浏览器发来的数据之后要做以下的操作： <br> 
   <ol><li>使用自己的私钥将信息解密取出密码，使用密码解密浏览器发来的握手消息，并验证HASH是否与浏览器发来的一致。</li><li>使用密码加密一段握手消息，发送给浏览器。</li></ol></li><li>浏览器解密并计算握手消息的HASH，如果与服务端发来的HASH一致，此时握手过程结束，之后所有的通信数据将由之前浏览器生成的<strong>随机密码</strong>并利用<strong>对称加密算法</strong>进行加密。</li></ol> 
</blockquote> 
<p>有了对称加密的秘钥，也就是上面的<strong>随机密码</strong> 再采用约定好的对称加密算法，就可以安全的传输用户名和密码了。</p> 
<hr> 
<h4 id="https是不是一定安全呢">https是不是一定安全呢？</h4> 
<p>假如客户端在上述步骤1中，请求被拦截，发送到一个坏的黑客服务器中了呢？假如黑客服务器按照上面相同的方法跟客户端进行https安全握手，那岂不是照样不安全吗？ <br> 要解决这个问题，关键在上面第3步中第1）小部，<strong>验证证书的合法性（颁发证书的机构是否合法，证书中包含的网站地址是否与正在访问的地址一致等）</strong>，这个就是CA（第三方可行机构），如果要发布一个服务采用https，大公司都会想CA购买证书，CA机构颁发的证书非常昂贵。如果证书受信任，则浏览器栏里面会显示一个小锁头，否则会给出证书不受信的提示。 <br> 如果浏览器提示了证书不受信任，用户仍然点击确认，是一个安全网站还好，如果是一个钓鱼网站就怪不了别人了。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9430e58706093c11dedb85853ef08f52/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">用指针方法编写一个程序，输入3个整数，将它们按由小到大的顺序输出</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/603c17a185b817cf7a4db96a6e8e8075/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">面试题_103_to_124_关于 OOP 和设计模式的面试题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>