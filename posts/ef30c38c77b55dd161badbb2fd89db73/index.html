<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【MySQL】表的约束 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【MySQL】表的约束" />
<meta property="og:description" content="文章目录 一. 什么是约束？二. 为什么要有约束？三. 如何约束？1. 空属性 --- not null2. 默认值 --- default3. 列描述 --- comment4. zerofill5. 主键 --- primary key6. 自增长 --- auto_increment7. 唯一键 --- unique8. 外键 --- foreign key 一. 什么是约束？ 在上一篇介绍数据类型时就引入“约束”这个概念，约束字段的是数据类型，但是数据类型的约束很单一，还需要有一些额外的约束以更好的保证数据的合法性，这篇文章将重点说明MySQL中的几种约束。
下面给出约束的定义：约束本质上是MySQL通过限制用户操作的方式，来达到维护数据安全的一套完整性方案，即约束的最终目的是从业务逻辑的角度保证数据的正确性、安全性。
二. 为什么要有约束？ 我们知道MySQL是一套数据存储容灾解决方法，除了完成基本的数据存储功能之外，还要保证数据尽可能的安全，减少用户误操作的可能性。
三. 如何约束？ 1. 空属性 — not null 我们在注册账号或填写用户信息时，有些属性是必填的，有些是选填的：
对应到数据库层面，我们在定义表中的每一个字段时，它们有两种可供选择的属性：null（默认的）和not null(不为空)。数据库字段的默认属性是null，即允许为空；但是实际开发时，尽可能保证字段不为空，因为数据为空没办法参与运算。
举例：
创建一张Person表，字段包括人的姓名、性别，且都允许为空：
创建一张PersonNotNull表，也包含两个字段：姓名、性别，但是不都允许为空：
2. 默认值 — default 通常我们在注册社交平台账号时，需要绑定你的电话号码，对于电话号码，不同的国家有不同的国际区号。比如中国的国际区号就是&#43;86，如果这个社交媒体平台是中国本土的，则默认中国人使用的最多，所以默认区号就是&#43;86了：
默认值：某一个字段会经常性的用到某个具体的值，我们可以一开始就指定好这个值，在对该字段插入时，用户可以直接使用这个默认值而不需要再去指定。
使用方法：定义字段时在后面加上default 默认值。
举例：
// 1、创建一张表 mysql&gt; create table if not exists Person( -&gt; name varchar(20), -&gt; nationality varchar(20) default &#39;中国&#39;, -&gt; age tinyint unsigned default 0 -&gt; ); Query OK, 0 rows affected (0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ef30c38c77b55dd161badbb2fd89db73/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-25T11:44:37+08:00" />
<meta property="article:modified_time" content="2022-09-25T11:44:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【MySQL】表的约束</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#__1" rel="nofollow">一. 什么是约束？</a></li><li><a href="#__5" rel="nofollow">二. 为什么要有约束？</a></li><li><a href="#__8" rel="nofollow">三. 如何约束？</a></li><li><ul><li><a href="#1___not_null_9" rel="nofollow">1. 空属性 --- not null</a></li><li><a href="#2___default_20" rel="nofollow">2. 默认值 --- default</a></li><li><a href="#3___comment_89" rel="nofollow">3. 列描述 --- comment</a></li><li><a href="#4_zerofill_127" rel="nofollow">4. zerofill</a></li><li><a href="#5___primary_key_179" rel="nofollow">5. 主键 --- primary key</a></li><li><a href="#6___auto_increment_251" rel="nofollow">6. 自增长 --- auto_increment</a></li><li><a href="#7___unique_284" rel="nofollow">7. 唯一键 --- unique</a></li><li><a href="#8___foreign_key_342" rel="nofollow">8. 外键 --- foreign key</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="__1"></a>一. 什么是约束？</h2> 
<p>在上一篇介绍数据类型时就引入“约束”这个概念，约束字段的是数据类型，但是数据类型的约束很单一，还需要有一些额外的约束以更好的保证数据的合法性，这篇文章将重点说明MySQL中的几种约束。</p> 
<p>下面给出约束的定义：约束本质上是MySQL通过限制用户操作的方式，来达到维护数据安全的一套完整性方案，即约束的最终目的是从业务逻辑的角度保证数据的正确性、安全性。</p> 
<h2><a id="__5"></a>二. 为什么要有约束？</h2> 
<p>我们知道MySQL是一套数据存储容灾解决方法，除了完成基本的数据存储功能之外，还要保证数据尽可能的安全，减少用户误操作的可能性。</p> 
<h2><a id="__8"></a>三. 如何约束？</h2> 
<h3><a id="1___not_null_9"></a>1. 空属性 — not null</h3> 
<p>我们在注册账号或填写用户信息时，有些属性是必填的，有些是选填的：<br> <img src="https://images2.imgbox.com/ae/25/aeTZ351H_o.png" alt="在这里插入图片描述"><br> 对应到数据库层面，我们在定义表中的每一个字段时，它们有两种可供选择的属性：null（默认的）和not null(不为空)。数据库字段的默认属性是null，即允许为空；但是实际开发时，尽可能保证字段不为空，因为数据为空没办法参与运算。</p> 
<p><strong>举例</strong>：</p> 
<ul><li> <p>创建一张Person表，字段包括人的姓名、性别，且都允许为空：<br> <img src="https://images2.imgbox.com/68/c2/3qr91IFF_o.png" alt="在这里插入图片描述"></p> </li><li> <p>创建一张PersonNotNull表，也包含两个字段：姓名、性别，但是不都允许为空：<br> <img src="https://images2.imgbox.com/0b/65/SxF3J5gg_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<h3><a id="2___default_20"></a>2. 默认值 — default</h3> 
<p>通常我们在注册社交平台账号时，需要绑定你的电话号码，对于电话号码，不同的国家有不同的国际区号。比如中国的国际区号就是+86，如果这个社交媒体平台是中国本土的，则默认中国人使用的最多，所以默认区号就是+86了：<br> <img src="https://images2.imgbox.com/63/72/8tiUIUVc_o.png" alt="在这里插入图片描述"></p> 
<p><strong>默认值</strong>：某一个字段会经常性的用到某个具体的值，我们可以一开始就指定好这个值，在对该字段插入时，用户可以直接使用这个默认值而不需要再去指定。</p> 
<p><strong>使用方法</strong>：定义字段时在后面加上<code>default 默认值</code>。</p> 
<p><strong>举例</strong>：</p> 
<pre><code class="prism language-cpp"><span class="token comment">// 1、创建一张表</span>
mysql<span class="token operator">&gt;</span> create table <span class="token keyword">if</span> <span class="token operator">not</span> exists <span class="token function">Person</span><span class="token punctuation">(</span>
    <span class="token operator">-&gt;</span> name <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-&gt;</span> nationality <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token char">'中国'</span><span class="token punctuation">,</span>
    <span class="token operator">-&gt;</span> age tinyint <span class="token keyword">unsigned</span> <span class="token keyword">default</span> <span class="token number">0</span>
    <span class="token operator">-&gt;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> rows <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.03</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 2、国籍和年龄字段设定了默认值</span>
mysql<span class="token operator">&gt;</span> desc Person<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> Field       <span class="token operator">|</span> Type                <span class="token operator">|</span> Null <span class="token operator">|</span> Key <span class="token operator">|</span> Default <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> name        <span class="token operator">|</span> <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>         <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token constant">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> nationality <span class="token operator">|</span> <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>         <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> 中国    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> age         <span class="token operator">|</span> <span class="token function">tinyint</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token number">0</span>       <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">3</span> rows in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 3、插入一条数据，国籍和年龄字段使用默认值</span>
mysql<span class="token operator">&gt;</span> insert into <span class="token function">Person</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token function">values</span> <span class="token punctuation">(</span><span class="token char">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> row <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> select <span class="token operator">*</span> from Person<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span> name   <span class="token operator">|</span> nationality <span class="token operator">|</span> age  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span> 张三   <span class="token operator">|</span> 中国        <span class="token operator">|</span>    <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token number">1</span> row in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p><strong>问题：not null 和 default 同时设置，会发生什么情况？</strong></p> 
</blockquote> 
<p>下面这段代码对该问题进行了测试。我们建表时，同时设定nationality字段为<code>not null</code>和<code>default</code>；发现在插入数据时，即使不手动插入该字段的数据MySQL也不会报错，而且该字段最终采用了我们设定的默认值：</p> 
<pre><code class="prism language-cpp"><span class="token comment">// 1、新建表，nationality字段同时设定了not null和 default</span>
mysql<span class="token operator">&gt;</span> create table <span class="token keyword">if</span> <span class="token operator">not</span> exists <span class="token function">Person</span><span class="token punctuation">(</span>
    <span class="token operator">-&gt;</span> nationality <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">not</span> null <span class="token keyword">default</span> <span class="token char">'中国'</span><span class="token punctuation">,</span>
    <span class="token operator">-&gt;</span> age tinyint <span class="token keyword">unsigned</span>
    <span class="token operator">-&gt;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> rows <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.03</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 2、插入一条数据，nationality字段不手动插入</span>
mysql<span class="token operator">&gt;</span> insert into <span class="token function">Person</span> <span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token function">values</span> <span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> row <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 3、观察结果，nationality即使不手动插入也没有报错，且最终插入了默认值</span>
mysql<span class="token operator">&gt;</span> select <span class="token operator">*</span> from Person<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span> nationality <span class="token operator">|</span> age  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span> 中国        <span class="token operator">|</span>   <span class="token number">18</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token number">1</span> row in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p><strong>总结</strong>：在<code>not null</code>和<code>default</code>同时设置的情况下，插入数据时我们依然可以对该字段不填而采用默认值，且不会报错。但不建议一起使用，通常在必须填入数据的字段中只用not null，在事先确定好具体默认值的情况下只用default。</p> 
<h3><a id="3___comment_89"></a>3. 列描述 — comment</h3> 
<p><strong>列描述(comment)</strong>：用来描述某个字段的信息，作用相当于对该字段进行注释。它会保存在表的创建语句里，用来给程序员或DBA来进行字段的了解。</p> 
<p><strong>查看方式</strong>：列描述信息在用desc关键字查看表结构时不会显示，只能通过show查看表创建语句时出现：</p> 
<pre><code class="prism language-cpp"><span class="token comment">// 1、新建表，每一个字段都用comment进行信息描述</span>
mysql<span class="token operator">&gt;</span> create table <span class="token keyword">if</span> <span class="token operator">not</span> exists <span class="token function">Person</span><span class="token punctuation">(</span>
    <span class="token operator">-&gt;</span> name <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> comment <span class="token char">'这是用户的姓名，必填'</span><span class="token punctuation">,</span>
    <span class="token operator">-&gt;</span> gender <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token char">'男'</span> comment <span class="token char">'这是用户的性别，默认为男性'</span><span class="token punctuation">,</span>
    <span class="token operator">-&gt;</span> age tinyint <span class="token keyword">unsigned</span> <span class="token keyword">default</span> <span class="token number">18</span> comment <span class="token char">'这是用户的年龄，默认为18'</span>
    <span class="token operator">-&gt;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> rows <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 2、通过desc查看不到描述信息</span>
mysql<span class="token operator">&gt;</span> desc Person<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> Field  <span class="token operator">|</span> Type                <span class="token operator">|</span> Null <span class="token operator">|</span> Key <span class="token operator">|</span> Default <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> name   <span class="token operator">|</span> <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>         <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token constant">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> gender <span class="token operator">|</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>             <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> 男      <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> age    <span class="token operator">|</span> <span class="token function">tinyint</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token number">18</span>      <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">3</span> rows in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 3、通过show查看表的创建语句时可以看到描述信息</span>
mysql<span class="token operator">&gt;</span> show create table Person \G
<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> <span class="token number">1.</span> row <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>
       Table<span class="token operator">:</span> Person
Create Table<span class="token operator">:</span> CREATE TABLE `Person` <span class="token punctuation">(</span>
  `name` <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> DEFAULT <span class="token constant">NULL</span> COMMENT <span class="token char">'这是用户的姓名，必填'</span><span class="token punctuation">,</span>
  `gender` <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> DEFAULT <span class="token char">'男'</span> COMMENT <span class="token char">'这是用户的性别，默认为男性'</span><span class="token punctuation">,</span>
  `age` <span class="token function">tinyint</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> DEFAULT <span class="token char">'18'</span> COMMENT <span class="token char">'这是用户的年龄，默认为18'</span>
<span class="token punctuation">)</span> ENGINE<span class="token operator">=</span>InnoDB DEFAULT CHARSET<span class="token operator">=</span>utf8
<span class="token number">1</span> row in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p><strong>使用建议</strong>：列描述信息最好放到字段的最后位置写，因为它不像<code>not null</code>或<code>default</code>那样对字段具有很强的影响性，这样我们在查看时也更容易解读字段信息。</p> 
<h3><a id="4_zerofill_127"></a>4. zerofill</h3> 
<p>到目前为止，我们学习到如下两种类型后面可以加圆括号：</p> 
<ul><li>字符类型：char(len)、varchar(len)。这里圆括号中的数字决定了该字段存储字符个数的上限。</li><li>数值类型：int(num)、tinyint(num)等。这里圆括号中的数字决定了显示数据的位宽，只有加上<code>zerofill</code>关键字才会起作用。</li></ul> 
<p><strong>举例</strong>：<br> 我们创建一张表，其中包含了两个int类型的字段a和b，规定它们的位宽都是10，但是只有b字段添加了关键字<code>zerofill</code>，然后向该表中插入一行记录，观察插入后数据的显示结果：</p> 
<pre><code class="prism language-cpp"><span class="token comment">// 1、新建表</span>
mysql<span class="token operator">&gt;</span> create table <span class="token keyword">if</span> <span class="token operator">not</span> exists <span class="token function">Number</span><span class="token punctuation">(</span>
    <span class="token operator">-&gt;</span> a <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">-&gt;</span> b <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> zerofill
    <span class="token operator">-&gt;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> rows <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.06</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 2、观察表结构</span>
mysql<span class="token operator">&gt;</span> desc Number<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> Field <span class="token operator">|</span> Type                      <span class="token operator">|</span> Null <span class="token operator">|</span> Key <span class="token operator">|</span> Default <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> a     <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>                   <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token constant">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> b     <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> zerofill <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token constant">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">2</span> rows in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 3、插入一行数据</span>
mysql<span class="token operator">&gt;</span> insert into Number <span class="token function">values</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> row <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 4、发现a字段的数据按插入的样子正常显示，b字段数据按位宽为10的格式显示</span>
mysql<span class="token operator">&gt;</span> select <span class="token operator">*</span> from Number<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span> a    <span class="token operator">|</span> b          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span>   <span class="token number">10</span> <span class="token operator">|</span> <span class="token number">0000000020</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token number">1</span> row in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p>可以看到b字段数据的值显示位宽是10，而a的值就是正常的显示。这就是zerofill属性的作用，如果数据本身宽度小于设定的宽度（这里设置的是10），就会自动填充0已达到设定位宽。要注意的是，这只是最后显示的结果，在MySQL中实际存储的还是20，我们可以用hex函数来证明，该函数是以16进制形式显示数值的：</p> 
<pre><code class="prism language-cpp">mysql<span class="token operator">&gt;</span> select b<span class="token punctuation">,</span> <span class="token function">hex</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> from Number<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span> b          <span class="token operator">|</span> <span class="token function">hex</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span> <span class="token number">0000000020</span> <span class="token operator">|</span> <span class="token number">14</span>     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token number">1</span> row in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p>可以看出MySQL内部存储的还是数字20，0000000020只是设置了<code>zerofill</code>属性后的一种格式化输出而已。</p> 
<h3><a id="5___primary_key_179"></a>5. 主键 — primary key</h3> 
<p>主键(primary key)是一张表中唯一标识一行记录的字段。如果把表比作红黑树的话，表的每一行记录对应红黑树的每一个节点，表的主键字段就对应节点中的key，而表的其他字段对应节点中的value。</p> 
<p>表的主键有如下三个特点：</p> 
<ul><li>一张表只有一个主键字段，该字段唯一标识表中的一行记录。</li><li>主键字段默认是not null属性。</li><li>主键字段的值不能重复。</li></ul> 
<p><strong>举例</strong>：<br> <img src="https://images2.imgbox.com/d0/12/yupSMbZ6_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>复合主建</strong></p> 
</blockquote> 
<p>创建一个Address表，把ip字段和port字段组合成为复合主键，用来标识公网内唯一的一个进程：</p> 
<pre><code class="prism language-cpp"><span class="token comment">// 1、新建表，复合主建单独一行写出来</span>
mysql<span class="token operator">&gt;</span> create table <span class="token keyword">if</span> <span class="token operator">not</span> exists <span class="token function">Address</span><span class="token punctuation">(</span>
    <span class="token operator">-&gt;</span> ip <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> comment <span class="token char">'主机的公网IP'</span><span class="token punctuation">,</span>
    <span class="token operator">-&gt;</span> port <span class="token keyword">int</span> <span class="token keyword">unsigned</span> comment <span class="token char">'进程在主机内的唯一标识'</span><span class="token punctuation">,</span>
    <span class="token operator">-&gt;</span> name <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> comment <span class="token char">'主机用户名'</span><span class="token punctuation">,</span>
    <span class="token operator">-&gt;</span> primary <span class="token function">key</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> rows affected<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token function">warning</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 2、查看表结构，发现ip和port字段都标识了PRI</span>
mysql<span class="token operator">&gt;</span> desc Address<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> Field <span class="token operator">|</span> Type             <span class="token operator">|</span> Null <span class="token operator">|</span> Key <span class="token operator">|</span> Default <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> ip    <span class="token operator">|</span> <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>      <span class="token operator">|</span> NO   <span class="token operator">|</span> PRI <span class="token operator">|</span> <span class="token constant">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> port  <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">|</span> NO   <span class="token operator">|</span> PRI <span class="token operator">|</span> <span class="token constant">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> name  <span class="token operator">|</span> <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>      <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token constant">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">3</span> rows in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p>只有复合主键中所有字段的值完全一致时，才算主键冲突：</p> 
<pre><code class="prism language-cpp">mysql<span class="token operator">&gt;</span> insert into Address <span class="token function">values</span> <span class="token punctuation">(</span><span class="token char">'127.0.1'</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">,</span> <span class="token char">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> row <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> insert into Address <span class="token function">values</span> <span class="token punctuation">(</span><span class="token char">'127.0.1'</span><span class="token punctuation">,</span> <span class="token number">1111</span><span class="token punctuation">,</span> <span class="token char">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> row <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.17</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> select <span class="token operator">*</span> from Address<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span> ip      <span class="token operator">|</span> port <span class="token operator">|</span> name   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span> <span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">1</span> <span class="token operator">|</span> <span class="token number">1111</span> <span class="token operator">|</span> 张三   <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">1</span> <span class="token operator">|</span> <span class="token number">8080</span> <span class="token operator">|</span> 张三   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token number">2</span> rows in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p><strong>主键修改操作</strong></p> 
</blockquote> 
<p><strong>1、追加主键</strong><br> 如果表已经创建好但是没有主键的话，可以使用如下语句追加主键，但要确保追加成为主键的字段的数据唯一性和非空：</p> 
<pre><code class="prism language-cpp">alter table 表名 add primary <span class="token function">key</span><span class="token punctuation">(</span>字段列表<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>2、删除主键</strong><br> 一张表中只会有一个主键（普通主键或复合主建），所以在删除表的主键时不需要指明具体字段：</p> 
<pre><code class="prism language-cpp">alter table 表名 drop primary key<span class="token punctuation">;</span>
</code></pre> 
<blockquote> 
 <p><strong>设置表主键的建议</strong></p> 
</blockquote> 
<p>一般而言，我们建议将主键设计成为<strong>和当前业务无关的字段</strong>，这样，当业务调整的时候，我们可以尽量不对主键做过大的调整。</p> 
<h3><a id="6___auto_increment_251"></a>6. 自增长 — auto_increment</h3> 
<p><code>auto_increment</code>：设为自增长的字段必须和主键搭配使用。在插入时该字段可以不给值，这时自增长属性会自动的被系统触发，从当前表的自增长字段中<strong>已经有的最大值</strong>进行+1操作，得到一个新的且不同的值。</p> 
<p><strong>自增长字段的特点</strong>：</p> 
<ul><li>自增长字段必须是整数类型。</li><li>自增长字段必须是主键或复合主键中的一个字段。</li><li>一张表最多只能有一个自增长字段。</li></ul> 
<p><strong>使用方法</strong>：在创建表时，在字段后加上<code>auto_increment</code>。如果是复合主键，则需要把自增长列放在复合主键的第一个位置，也就是最左边，如下面代码所示：</p> 
<pre><code class="prism language-cpp"><span class="token comment">// 把复合主建中的a字段设为自增长</span>
<span class="token comment">// 这样插入的话,只需要指定非自增长的字段的值即可</span>
create table <span class="token function">t</span><span class="token punctuation">(</span>
	a <span class="token keyword">int</span> auto_increment<span class="token punctuation">,</span>
	b <span class="token keyword">int</span><span class="token punctuation">,</span>
	primary <span class="token function">key</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>举例</strong>：<br> 创建一张学生表，把学号设为自增长，这样每次插入一行数据时只需指定学生姓名即可，他们的学号按自增长给出的值分配：<br> <img src="https://images2.imgbox.com/40/d3/n5b0eG2F_o.png" alt="在这里插入图片描述"></p> 
<p>当前表中一行数据都没有，我们插入一个学生叫“张三”，学号使用自增长给的值，发现自增长初始时默认给值是数字1：<br> <img src="https://images2.imgbox.com/72/11/W2b0TbdQ_o.png" alt="在这里插入图片描述"></p> 
<p>继续插入数据，观察到自增长给的值是在原来已经有的最大值基础上+1：<br> <img src="https://images2.imgbox.com/4c/53/j4pokCe8_o.png" alt="在这里插入图片描述"></p> 
<p>我们这次插入一行自己的“学号，姓名”记录，其中学号值为20204912，然后观察自增长值的后续变化：<br> <img src="https://images2.imgbox.com/0c/67/DjlIbRMs_o.png" alt="在这里插入图片描述"></p> 
<p>发现自增长值的分配规律：按当前自增长字段的最大值+1分配。</p> 
<h3><a id="7___unique_284"></a>7. 唯一键 — unique</h3> 
<p>一张表中有往往有很多字段需要保证唯一性，即在一张表中该字段的值不能重复，被设为主键的字段有唯一性的约束，但是一张表中只能有一个主键字段，那么其他需要保证唯一性的字段该怎么办呢？唯一键就可以解决表中有多个字段需要唯一性约束的问题。</p> 
<p>比如在学校，我们需要一个学生管理系统，系统中有一个学生表，学生表中有两个字段，一个身份证号码，一个是学号，我们可以选择以身份号码作为主键。这样学号就只是一个普通的字段，MySQL没有对其提供一个安全性约束，万一不小心输入了重复的学号系统也检测不到，直到业务出问题后才改就很麻烦。所以我们设计学生学号的时候，需要一种约束：学生的学号都不能重复，我们可以在设计表的时候将学生学号设计成为唯一键。</p> 
<p><strong>唯一键设置方法</strong>：定义字段时加上<code>unique</code>关键字。</p> 
<p><strong>唯一键和主键的区别</strong>：</p> 
<ul><li>唯一键允许为空，且空字段不做为唯一性的判断依据。</li><li>主键的侧重点在于它作为一行数据的唯一标识，而唯一键的侧重点在于保证表中该字段数据的唯一性。</li></ul> 
<p><strong>举例</strong>：<br> 创建一张学信息表，其中把学号设为唯一键并通过一系列插入操作验证唯一键的特性：</p> 
<pre><code class="prism language-cpp"><span class="token comment">// 1、创建一张学生信息表</span>
mysql<span class="token operator">&gt;</span> create table <span class="token keyword">if</span> <span class="token operator">not</span> exists <span class="token function">Student</span><span class="token punctuation">(</span>
    <span class="token operator">-&gt;</span> name <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">not</span> null comment <span class="token char">'学生的姓名，不允许为空'</span><span class="token punctuation">,</span>
    <span class="token operator">-&gt;</span> st_id <span class="token keyword">int</span> <span class="token keyword">unsigned</span> unique comment <span class="token char">'学生的学号，设为唯一键'</span><span class="token punctuation">,</span>
    <span class="token operator">-&gt;</span> telephone <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> primary key comment <span class="token char">'学生的电话号码，设为主键'</span>
    <span class="token operator">-&gt;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> rows <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.03</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 2、观察表的结构，唯一键字段会被标识出UNI</span>
mysql<span class="token operator">&gt;</span> desc Student<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> Field     <span class="token operator">|</span> Type             <span class="token operator">|</span> Null <span class="token operator">|</span> Key <span class="token operator">|</span> Default <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> name      <span class="token operator">|</span> <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>      <span class="token operator">|</span> NO   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token constant">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> st_id     <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">|</span> YES  <span class="token operator">|</span> UNI <span class="token operator">|</span> <span class="token constant">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> telephone <span class="token operator">|</span> <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> NO   <span class="token operator">|</span> PRI <span class="token operator">|</span> <span class="token constant">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">3</span> rows in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 测试1：唯一键字段的数据不能重复</span>
mysql<span class="token operator">&gt;</span> insert into <span class="token function">Student</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> st_id<span class="token punctuation">,</span> telephone<span class="token punctuation">)</span> <span class="token function">values</span> <span class="token punctuation">(</span><span class="token char">'张三'</span><span class="token punctuation">,</span> <span class="token number">20204912</span><span class="token punctuation">,</span> <span class="token char">'111xxx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> row <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> insert into <span class="token function">Student</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> st_id<span class="token punctuation">,</span> telephone<span class="token punctuation">)</span> <span class="token function">values</span> <span class="token punctuation">(</span><span class="token char">'李四'</span><span class="token punctuation">,</span> <span class="token number">20204912</span><span class="token punctuation">,</span> <span class="token char">'222xxx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ERROR <span class="token number">1062</span> <span class="token punctuation">(</span><span class="token number">23000</span><span class="token punctuation">)</span><span class="token operator">:</span> Duplicate entry <span class="token char">'20204912'</span> <span class="token keyword">for</span> key <span class="token char">'st_id'</span>

<span class="token comment">// 测试二：唯一键字段可以为空</span>
mysql<span class="token operator">&gt;</span> insert into <span class="token function">Student</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> telephone<span class="token punctuation">)</span> <span class="token function">values</span> <span class="token punctuation">(</span><span class="token char">'张三'</span><span class="token punctuation">,</span> <span class="token char">'222xxx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> row <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> insert into <span class="token function">Student</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> telephone<span class="token punctuation">)</span> <span class="token function">values</span> <span class="token punctuation">(</span><span class="token char">'李四'</span><span class="token punctuation">,</span> <span class="token char">'333xxx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> row <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 3、观察最终插入结果</span>
mysql<span class="token operator">&gt;</span> select <span class="token operator">*</span> from Student<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> name   <span class="token operator">|</span> st_id    <span class="token operator">|</span> telephone <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> 张三   <span class="token operator">|</span> <span class="token number">20204912</span> <span class="token operator">|</span> <span class="token number">111</span>xxx    <span class="token operator">|</span>
<span class="token operator">|</span> 张三   <span class="token operator">|</span>     <span class="token constant">NULL</span> <span class="token operator">|</span> <span class="token number">222</span>xxx    <span class="token operator">|</span>
<span class="token operator">|</span> 李四   <span class="token operator">|</span>     <span class="token constant">NULL</span> <span class="token operator">|</span> <span class="token number">333</span>xxx    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">3</span> rows in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="8___foreign_key_342"></a>8. 外键 — foreign key</h3> 
<p>外键用于定义主表和从表之间的关系：外键定义在从表上，主表则必须是有主键约束或unique约束。</p> 
<p>当定义外键后两张表就有了外键约束，要求从表外键字段的值必须存在于主表的主键或唯一键数据中，当然也可以为NULL。</p> 
<p><strong>理解外键</strong>：<br> <img src="https://images2.imgbox.com/4e/bf/akplgMti_o.png" alt="在这里插入图片描述"></p> 
<p><strong>外键设置方法</strong>：<br> 在创建从表时单起一行来专门设置外键：</p> 
<pre><code class="prism language-cpp">foreign <span class="token function">key</span> <span class="token punctuation">(</span>从表里的字段名<span class="token punctuation">)</span> references 主表名<span class="token punctuation">(</span>主表里的字段名<span class="token punctuation">)</span>
</code></pre> 
<p><strong>举例</strong>：<br> 创建一张学生表，里面有学生的名字和班级号；再创建一张班级表，里面存有各个班级对应的科目信息。</p> 
<p>用外键把学生表里的班级号和班级表里的班级号关联起来：</p> 
<pre><code class="prism language-cpp"><span class="token comment">// 1、主表必须先创建出来</span>
mysql<span class="token operator">&gt;</span> create table <span class="token keyword">if</span> <span class="token operator">not</span> exists <span class="token function">ClaTable</span><span class="token punctuation">(</span>
    <span class="token operator">-&gt;</span> id <span class="token keyword">int</span> <span class="token keyword">unsigned</span> primary key comment <span class="token char">'班级号'</span><span class="token punctuation">,</span>
    <span class="token operator">-&gt;</span> course <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">not</span> null comment <span class="token char">'班级课程'</span>
    <span class="token operator">-&gt;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> rows <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.02</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 2、从表在创建时可以选择自己的某个字段与主表中的字段建立外键约束关系</span>
mysql<span class="token operator">&gt;</span> create table <span class="token keyword">if</span> <span class="token operator">not</span> exists <span class="token function">StuTable</span><span class="token punctuation">(</span>
    <span class="token operator">-&gt;</span> name <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">not</span> null comment <span class="token char">'学生姓名'</span><span class="token punctuation">,</span>
    <span class="token operator">-&gt;</span> class_id <span class="token keyword">int</span> <span class="token keyword">unsigned</span> comment <span class="token char">'学生所在班级'</span><span class="token punctuation">,</span>
    <span class="token operator">-&gt;</span> foreign <span class="token function">key</span><span class="token punctuation">(</span>class_id<span class="token punctuation">)</span> references <span class="token function">ClaTable</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> rows <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.03</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 3、观察主表结构，班级号设为了主键</span>
mysql<span class="token operator">&gt;</span> desc ClaTable<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> Field  <span class="token operator">|</span> Type             <span class="token operator">|</span> Null <span class="token operator">|</span> Key <span class="token operator">|</span> Default <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> id     <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">|</span> NO   <span class="token operator">|</span> PRI <span class="token operator">|</span> <span class="token constant">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> course <span class="token operator">|</span> <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>      <span class="token operator">|</span> NO   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token constant">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">2</span> rows in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

<span class="token comment">// 4、观察从表结构观，从表中的class_id字段键信息为MUL，代表它被设为了外键</span>
mysql<span class="token operator">&gt;</span> desc StuTable<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> Field    <span class="token operator">|</span> Type             <span class="token operator">|</span> Null <span class="token operator">|</span> Key <span class="token operator">|</span> Default <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> name     <span class="token operator">|</span> <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>      <span class="token operator">|</span> NO   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token constant">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> class_id <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token keyword">unsigned</span> <span class="token operator">|</span> YES  <span class="token operator">|</span> MUL <span class="token operator">|</span> <span class="token constant">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token number">2</span> rows in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p>我们先在主表ClaTable中插入两条班级相关的数据：</p> 
<pre><code class="prism language-cpp">mysql<span class="token operator">&gt;</span> insert into <span class="token function">ClaTable</span> <span class="token punctuation">(</span>id<span class="token punctuation">,</span> course<span class="token punctuation">)</span> <span class="token function">values</span> <span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">,</span> <span class="token char">'物理、化学、地理'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> row <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> insert into <span class="token function">ClaTable</span> <span class="token punctuation">(</span>id<span class="token punctuation">,</span> course<span class="token punctuation">)</span> <span class="token function">values</span> <span class="token punctuation">(</span><span class="token number">405</span><span class="token punctuation">,</span> <span class="token char">'历史、政治、生物'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> row <span class="token function">affected</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> select <span class="token operator">*</span> from ClaTable<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span> id  <span class="token operator">|</span> course                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token operator">|</span> <span class="token number">401</span> <span class="token operator">|</span> 物理、化学、地理         <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">405</span> <span class="token operator">|</span> 历史、政治、生物         <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">+</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">+</span>
<span class="token number">2</span> rows in <span class="token function">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p>接下来向从表StuTable中插入数据来验证外键的特点：</p> 
<ul><li>插入一个班级号为500班的学生，MySQL检测到主表中没有这个班级，所以插入失败，这是外键约束在起作用：<br> <img src="https://images2.imgbox.com/05/7c/FHM9vNZ3_o.png" alt="在这里插入图片描述"></li><li>从表中外键字段的数据是允许为NULL的。在从表中插入班级id为null的一个学生，意为来了一个新学生，目前还没有分配班级：<br> <img src="https://images2.imgbox.com/80/ef/ytfbqMPQ_o.png" alt="在这里插入图片描述"></li></ul> 
<blockquote> 
 <p>理解外键和外键约束</p> 
</blockquote> 
<p>还是上面的例子，我们不创建外键约束，就正常建立学生表，以及班级表，该有的字段我们都有，然后通过对照学生表和班级表的id信息也能让两张表关联起来，为什么还要有外键存在呢？</p> 
<p>有没有可能插入的学生信息中不小心输错了班级号，但是班级表中并没有这个班级，这时MySQL是不会去检查的，因为两张表没有建立约束关系，这样在后面业务中可能出现问题。</p> 
<p>解决方案就是建立两张表的外键约束关系。建立外键约束的本质其实就是把相关性交给MySQL去审核了，提前告诉MySQL表之间的约束关系，那么当用户插入不符合业务逻辑的数据的时候，MySQL就会检查出来，不允许你插入。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/926b034b0430a400f7e9a0a258ae15e2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">什么是token？token是用来干嘛的？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/46933eeba344fd08646dc8cc1aba264f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Maven异常‘parent.relativePath‘ of POM...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>