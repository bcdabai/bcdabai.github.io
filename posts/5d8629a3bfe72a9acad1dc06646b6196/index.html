<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CF 254E(从当前向后递推) - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CF 254E(从当前向后递推)" />
<meta property="og:description" content="E. 宿舍分享 time limit per test 1 second memory limit per test 256 megabytes input input.txt output output.txt 一个学期有 n 天.第i天早上Vasya会带 ai kg食物来学校（食物最多放2天，今天和明天）.
Vasya 每天吃 v kg 食物.他带来的食物原来够吃，但是Vasya 的 m 个室友会吃他的，编号 1 到 m. 第 j 个室友会在 lj到 rj 天和他一起住且每天吃 fj kg食物. Vasya 每天可以给同住的人 j 分 fj kg食物（可以选一些人分).Vasya每一次分食物都要让人吃饱（要不然不厚道).
Vasya 怎样分出最多次食物？
Input 第一行2个整数 n 和 v (1 ≤ n, v ≤ 400). 第2行 n 个整数 a1, a2, ..., an (1 ≤ ai ≤ 400), 第三行一个整数 m (1 ≤ m ≤ 400)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/5d8629a3bfe72a9acad1dc06646b6196/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-12-28T17:36:55+08:00" />
<meta property="article:modified_time" content="2012-12-28T17:36:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CF 254E(从当前向后递推)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="margin:0px; padding:0px; font-family:verdana,arial,sans-serif; font-size:14px; position:relative"> 
 <div id="content" class="content-with-sidebar" style="margin:1em; padding:1em 0px 0px; min-height:20em"> 
  <div class="ttypography" style="margin:0px; padding:0px; font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; line-height:21px; color:rgb(34,34,34); word-wrap:break-word"> 
   <div class="problem-statement" style="margin:0.5em; padding:0px; line-height:1.5em"> 
    <div class="header" style="margin:0px 0px 1em; padding:0px; text-align:center"> 
     <div class="title" style="margin:0px 0px 0.5em; padding:0px; font-size:21px">
       E. 宿舍分享 
     </div> 
     <div class="time-limit" style="margin:0px auto; padding:0px"> 
      <div class="property-title" style="margin:0px; padding:0px 4px 0px 0px; display:inline">
        time limit per test 
      </div> 1 second 
     </div> 
     <div class="memory-limit" style="margin:0px auto; padding:0px"> 
      <div class="property-title" style="margin:0px; padding:0px 4px 0px 0px; display:inline">
        memory limit per test 
      </div> 256 megabytes 
     </div> 
     <div class="input-file" style="margin:0px auto; padding:0px"> 
      <div class="property-title" style="margin:0px; padding:0px 4px 0px 0px; display:inline">
        input 
      </div> input.txt 
     </div> 
     <div class="output-file" style="margin:0px auto; padding:0px"> 
      <div class="property-title" style="margin:0px; padding:0px 4px 0px 0px; display:inline">
        output 
      </div> output.txt 
     </div> 
    </div> 
    <div style="margin:0px; padding:0px"> 
     <p style="margin-top:1.5em; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-size:1em; line-height:1.5em"> 一个学期有 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>n</em></span> 天.第<span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>i</em></span>天早上Vasya会带 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>a</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em"><em>i</em></sub></span> kg食物来学校（食物最多放2天，今天和明天）.</p> 
     <p style="margin-top:1.5em; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-size:1em; line-height:1.5em"> Vasya 每天吃 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>v</em></span> kg 食物.他带来的食物原来够吃，但是Vasya 的 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>m</em></span> 个室友会吃他的，编号 1 到 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>m</em></span>. 第  <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>j</em></span> 个室友会在 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>l</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em"><em>j</em></sub></span>到 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>r</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em"><em>j </em></sub></span>天和他一起住且每天吃 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>f</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em"><em>j</em></sub></span> kg食物. Vasya 每天可以给同住的人<span style="color:rgb(34,34,34); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:21px">  </span><span class="tex-span" style="color:rgb(34,34,34); line-height:21px; font-size:18px; font-family:'times new roman',sans-serif"><em>j</em></span><span style="color:rgb(34,34,34); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:21px"> </span>分<span style="color:rgb(34,34,34); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:21px"> </span><span class="tex-span" style="color:rgb(34,34,34); line-height:21px; font-size:18px; font-family:'times new roman',sans-serif"><em>f</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em"><em>j</em></sub></span><span style="color:rgb(34,34,34); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:21px"> kg</span>食物（可以选一些人分).Vasya每一次分食物都要让人吃饱（要不然不厚道).</p> 
     <p style="margin-top:1.5em; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-size:1em; line-height:1.5em"> Vasya 怎样分出最多次食物？</p> 
    </div> 
    <div class="input-specification" style="margin:0px; padding:0px"> 
     <div class="section-title" style="margin:0px; padding:0px; font-size:16px; font-weight:bold">
       Input 
     </div> 
     <p style="margin-top:1.5em; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-size:1em; line-height:1.5em"> 第一行2个整数 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>n</em></span> 和 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>v</em></span> (<span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif">1 ≤ <em>n</em>, <em>v</em> ≤ 400</span>). 第2行 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>n</em></span> 个整数 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>a</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em">1</sub>, <em>a</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em">2</sub>, ..., <em>a</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em"><em>n</em></sub></span> (<span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif">1 ≤ <em>a</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em"><em>i</em></sub> ≤ 400</span>), </p> 
     <p style="margin-top:1.5em; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-size:1em; line-height:1.5em"> 第三行一个整数 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>m</em></span> (<span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif">1 ≤ <em>m</em> ≤ 400</span>). 接下来 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>m</em></span> 行每行3个整数.第  <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>j</em></span> 行为 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>l</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em"><em>j</em></sub>, <em>r</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em"><em>j</em></sub>, <em>f</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em"><em>j</em></sub></span> (<span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif">1 ≤ <em>l</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em"><em>j</em></sub> ≤ <em>r</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em"><em>j</em></sub> ≤ <em>n</em>, 1 ≤ <em>f</em><sub class="lower-index" style="font-size:13px; line-height:0; position:relative; vertical-align:baseline; bottom:-0.25em"><em>j</em></sub> ≤ 400</span>).</p> 
    </div> 
    <div class="output-specification" style="margin:0px 0px 1em; padding:0px"> 
     <div class="section-title" style="margin:0px; padding:0px; font-size:16px; font-weight:bold">
       Output 
     </div> 
     <p style="margin-top:1.5em; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-size:1em; line-height:1.5em"> 第一行输出最多分出食物次数. 接下来 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>n</em></span> 行第一行输出第 <span class="tex-span" style="font-size:18px; font-family:'times new roman',sans-serif"><em>i </em></span>天分几次.接下来输出当天分的朋友的编号(任意顺序).若有多解任意输出一种.</p> 
    </div> 
    <div class="sample-tests" style="margin:0px; padding:0px; font-family:Consolas,'Lucida Console','Andale Mono','Bitstream Vera Sans Mono','Courier New',Courier; font-size:0.9em"> 
     <div class="section-title" style="margin:0px; padding:0px; font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; font-weight:bold">
       Sample test(s) 
     </div> 
     <div class="sample-test" style="margin:0px; padding:0px"> 
      <div class="input" style="margin:0px; padding:0px; border:1px solid rgb(136,136,136)"> 
       <div class="title" style="margin:0px; padding:0.25em; font-size:1.3em; border-bottom-width:1px; border-bottom-style:solid; border-bottom-color:rgb(136,136,136); text-transform:lowercase; font-weight:bold">
         input 
       </div> 
       <pre style="margin-top:0px; margin-bottom:0px; padding:0.25em; font-family:Consolas,'Lucida Console','Andale Mono','Bitstream Vera Sans Mono','Courier New',Courier; line-height:1.25em; white-space:pre-wrap; word-wrap:break-word; color:rgb(136,0,0); background-color:rgb(239,239,239)">4 1
3 2 5 4
3
1 3 2
1 4 1
3 4 2
</pre> 
      </div> 
      <div class="output" style="margin:0px 0px 1em; padding:0px; border:1px solid rgb(136,136,136); position:relative; top:-1px"> 
       <div class="title" style="margin:0px; padding:0.25em; font-size:1.3em; border-bottom-width:1px; border-bottom-style:solid; border-bottom-color:rgb(136,136,136); text-transform:lowercase; font-weight:bold">
         output 
       </div> 
       <pre style="margin-top:0px; margin-bottom:0px; padding:0.25em; font-family:Consolas,'Lucida Console','Andale Mono','Bitstream Vera Sans Mono','Courier New',Courier; line-height:1.25em; white-space:pre-wrap; word-wrap:break-word; color:rgb(136,0,0); background-color:rgb(239,239,239)">7
1 2
1 2
3 2 1 3
2 2 3</pre> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div> 
<p><span style="font-size:14px">Dp题，主要推方程。</span></p> 
<p><span style="font-size:14px">显然每天从食量最小的贪起。</span></p> 
<p><span style="font-size:14px">为了处理食物隔夜问题，多留一维表示昨天剩下的食物。</span></p> 
<p><span style="font-size:14px">由于不好求出向前的方程，也不知道终态，所以要从当前向后递推（而非从前面向当前递推，类似<a href="http://blog.csdn.net/nike0good/article/details/8203799">矿工食堂</a>的解决方案）</span></p> 
<p><span style="font-size:14px"><br> </span></p> 
<p><span style="font-size:14px"></span></p> 
<pre><code class="language-cpp">#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;cstdlib&gt;
#include&lt;cmath&gt;
#include&lt;algorithm&gt;
#include&lt;functional&gt;
#include&lt;iostream&gt;
#include&lt;vector&gt;
using namespace std;
#define MAXN (400+10)
#define MAXV (400+10)
#define MAXAi (400+10)
#define MAXM (400+10)
#define TomorrowFood (min(a[i],x))
#define _Next_ [i+1][TomorrowFood]
int n,m,v;
vector &lt;pair&lt; int,int&gt; &gt; man[MAXN]; // ith day jth man eat k food. //pair(j,k) 
int a[MAXN]={0};
int f[MAXN][MAXV*2]={0}; // ith day havv j food left last night,-&gt;rat
int totlastf[MAXN][MAXV*2]={0}; //昨晚几个人吃 
int last[MAXN][MAXV*2]={0};   //昨晚剩多少 
int solve(int i,int j)
{
	if (i&gt;2) solve(i-1,last[i][j]); //{ n+1-&gt;n n-&gt;n-1 ... 2-&gt;1 }   1-&gt;0
	cout&lt;&lt;totlastf[i][j];
	for (int k=1;k&lt;=totlastf[i][j];k++)
		cout&lt;&lt;' '&lt;&lt;man[i-1][k].second;
	cout&lt;&lt;endl;	
}
int main()
{
	freopen("input.txt","r",stdin);
	freopen("output.txt","w",stdout);
	cin&gt;&gt;n&gt;&gt;v;
	for (int i=1;i&lt;=n;i++){cin&gt;&gt;a[i]; man[i].push_back(make_pair(0,0)); }
	cin&gt;&gt;m;
	for (int i=1;i&lt;=m;i++)
	{
		int l,r,fi; cin&gt;&gt;l&gt;&gt;r&gt;&gt;fi; //fi=food in a man
		for (int j=l;j&lt;=r;j++)
			man[j].push_back(make_pair(fi,i));
	}
	for (int i=1;i&lt;=n;i++) sort(man[i].begin(),man[i].end());
		
	memset(f,128,sizeof(f));
	f[1][0]=0;
	
	for (int i=1;i&lt;=n;i++)
	{
		for (int j=0;j&lt;=a[i-1];j++) //昨晚最多留下a[i] food(其它过期） 
		{
			int x=j-v+a[i];  //表示昨天剩下的，吃了v，又多了今天的a[i]
			if (x&lt;0) continue; //一定够吃
			if (f[i+1][TomorrowFood]&lt;f[i][j])
			{
				f[i+1][TomorrowFood]=f[i][j];
				totlastf[i+1][TomorrowFood]=0;
				last _Next_ =j;
			}
			for (int k=1;k&lt;man[i].size();k++)
			{
				x-=man[i][k].first;
				if (x&lt;0) break;
				if (f[i+1][TomorrowFood]&lt;f[i][j]+k)
				{
					f[i+1][TomorrowFood]=f[i][j]+k;
					totlastf[i+1][TomorrowFood]=k;
					last _Next_ =j;
				}							
			}
		}
	}
	
	int ans=-1,now;
	for (int j=0;j&lt;=MAXV;j++) 
		if (ans&lt;f[n+1][j]) {ans=f[n+1][j]; now=j; }
	cout&lt;&lt;ans&lt;&lt;endl;
	solve(n+1,now);
	return 0;
}</code></pre> 
<br> 
<br> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6eadbfbf6d133a0a765eee92d1d823b1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">网络直播电视之M3U8解析篇 （下）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3d32ea897aab5afe37540eee616f1d88/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">淘宝TOP程序API接口接入教程--入门篇</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>