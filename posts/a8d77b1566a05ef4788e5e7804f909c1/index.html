<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>2021黑盾杯CTF部分WP - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="2021黑盾杯CTF部分WP" />
<meta property="og:description" content="一、 Signin 通过观察附件得到附件为一个文本 全由01组成
根据以往的经验来是这个应该是是通过PIL库将01转换为像素点来构造二维码
from PIL import Image MAX = 500 pic = Image.new(&#34;RGB&#34;, (MAX, MAX)) str=&#34;1111...1111&#34; #文档太大所以省略了文档内容&#34; i = 0 for y in range(0, MAX): for x in range(0, MAX): if str[i] == &#39;1&#39;: pic.putpixel([x, y], (0, 0, 0)) else: pic.putpixel([x, y], (255, 255, 255)) i = i &#43; 1 pic.show() pic.save(&#34;flag.png&#34;) 构造出这么一个二维码
这个二维码是不完整的缺少一个定位角但是无伤大雅有这么一个神奇的网站https://demo.dynamsoft.com/barcode-reader/
缺少一个定位角扫描对他来说都不是事（可惜了是个在线工具建议大家还是学一下咋补定位角）
扫描出来的结果就是这段就是flagflag{5E57527B60}
二、 日志分析 解压后得到一个access.log,用notepad&#43;&#43;打开，尝试搜索password查看其中sql语句发现规律，看得出来他是尝试枚举进行暴力破解密码
一共十个字母，经过分析发现，状态码200后面的数字，跟前面的select语句有关系
675代表True，678代表False，所以可以看出，经过筛选后的ASCII码有十个相对应的字母，加上flag{}提交即可
三、 ICS-Modbus的秘密 解压后得到modbus的秘密.pcap用Wireshark打开根据提示直接找最长的modbus，flag就在里
四、 Decode 文本给了三组nec，常见题型，直接写脚本" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/a8d77b1566a05ef4788e5e7804f909c1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-05T20:57:21+08:00" />
<meta property="article:modified_time" content="2021-12-05T20:57:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2021黑盾杯CTF部分WP</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_Signin_0"></a>一、 Signin</h3> 
<p>通过观察附件得到附件为一个文本 全由01组成<img src="https://images2.imgbox.com/3d/67/qwGNMetz_o.png" alt="在这里插入图片描述"><br> 根据以往的经验来是这个应该是是通过PIL库将01转换为像素点来构造二维码</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image

MAX <span class="token operator">=</span> <span class="token number">500</span>
pic <span class="token operator">=</span> Image<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token string">"RGB"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>MAX<span class="token punctuation">,</span> MAX<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token builtin">str</span><span class="token operator">=</span><span class="token string">"1111...1111"</span> <span class="token comment">#文档太大所以省略了文档内容"</span>

i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> MAX<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> MAX<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>
            pic<span class="token punctuation">.</span>putpixel<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            pic<span class="token punctuation">.</span>putpixel<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
pic<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

pic<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"flag.png"</span><span class="token punctuation">)</span>

</code></pre> 
<p>构造出这么一个二维码<img src="https://images2.imgbox.com/92/98/OaKoHsmD_o.png" alt="在这里插入图片描述"><br> 这个二维码是不完整的缺少一个定位角但是无伤大雅有这么一个神奇的网站https://demo.dynamsoft.com/barcode-reader/<br> 缺少一个定位角扫描对他来说都不是事（可惜了是个在线工具建议大家还是学一下咋补定位角）<br> <img src="https://images2.imgbox.com/e5/11/j7pmUCJZ_o.png" alt="在这里插入图片描述"><br> 扫描出来的结果就是这段就是flag<code>flag{5E57527B60}</code></p> 
<h3><a id="__31"></a>二、 日志分析</h3> 
<p>解压后得到一个access.log,用notepad++打开，尝试搜索password查看其中sql语句发现规律，看得出来他是尝试枚举进行暴力破解密码<br> <img src="https://images2.imgbox.com/31/f4/KUj6xIWS_o.png" alt="在这里插入图片描述"><br> 一共十个字母，经过分析发现，状态码200后面的数字，跟前面的select语句有关系<br> 675代表True，678代表False，所以可以看出，经过筛选后的ASCII码有十个相对应的字母，加上flag{}提交即可</p> 
<h3><a id="_ICSModbus_38"></a>三、 ICS-Modbus的秘密</h3> 
<p>解压后得到modbus的秘密.pcap用Wireshark打开根据提示直接找最长的modbus，flag就在里<br> <img src="https://images2.imgbox.com/06/32/5ZeO2udt_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_Decode_43"></a>四、 Decode</h3> 
<p>文本给了三组nec，常见题型，直接写脚本</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> GCD<span class="token punctuation">,</span> inverse<span class="token punctuation">,</span> long_to_bytes

n1 <span class="token operator">=</span> <span class="token number">15228664629164509105936278301396170708905691970126305196584505186788860519598413718493859625462561931380632032431490419378905593909771649295663481782473029836321132574188559245931660756414915507930357509270674460219615256962333464689419869130366867401404262606367700782040693275068101244535880649261286041921882470460606034302142183971677715439862839410834231609821777031530457674591868138859358815039755085358568037032478394036448363183057305077227769673701227083943898736796552550712057417053897722979700329662099072959306298177351997084389916443815546425080826441671985030755256185725913397986385179516049927425591</span>
n2 <span class="token operator">=</span> <span class="token number">28182418532443955655250943929828439725377604572088962537896240628709829618999901367131159759359513146864646169253348651905865895468151210748207509325666501438590382812326109260537618829438786609626137074778638549998280533912080708785604673270460635181275360847313985764185991865570533815651261638439461846512012164531330949433517277559149828806588070421852157781670188281908625986974579194819272643409859915715455134433970119584552350648013116998668938513347083566970423327936691885137812528912263666957628197241313496232397910546498542303925205356813548741679943691886217742767778075067797422624969714343428365022749</span>
n3 <span class="token operator">=</span> <span class="token number">18355811159408154065817199279776805621878757240392366715869421799780946779485225342662736231980532326015283372375030686507311099745671828649419794838611580909610100636296701054995302819692794479292794716441442731393027118795245239019609474743841061251498233337758043553376098591254587406941205804917663153256036922860462415387926973551020540123742773938055950168965005226319984869124543783579240130888344231027912143592472823564266887957101575622993773291455143915263715932280728961208233983782906070719786115187115449430196335973764600533097718947377609348244073036523422892353195107093782201003551217830556519184839</span>
e1 <span class="token operator">=</span> <span class="token number">65537</span>
e2 <span class="token operator">=</span> <span class="token number">27751</span>
e3 <span class="token operator">=</span> <span class="token number">65537</span>
c1 <span class="token operator">=</span> <span class="token number">5368342382489380107251269030258282008067103595899117880173297169710980852124379736420135829984131832023988667774795223808420069001078159756328642298736759964890517323144475742861501409284299556459601222657540302786301791897975932176538612601162552795835603779910738886150925504885639254302406755008796950704938463132687940418772021406619622090999564746948113296328739593309200238996686945891130656599419832796482095787039339269564880847130379179831744694000940207887150388411084465949903406848727641093033681144598595895383689139227400553234701993087147186292040330589331703587405822925483701667354935313494938769206</span>
c2 <span class="token operator">=</span> <span class="token number">21521672635651854919517759696514027081496995002884626306313384597771682621826437868933822942195279941318573525337109548152966094293276717095298929811895186384560362917891928656637913236676702009205642367801075592458101830488916914437754803979953027152373619293870115731171449223105986403604973873007338969000153480949617700626516389419935352576014084068271819009465242491467427642787306345049280205827574043586767133396458785487959251540831856187380154825027964867977651727983254127239427622549059938701125498520279503972702883327594442747467858234391945790597844344295786118320620376681461727686876948563884520137741</span>
c3 <span class="token operator">=</span> <span class="token number">13940747781246179701167820858098775936269078279837839169409057305686612176371099274767269714494905207551971162649902129137425806839867713157472497469542260664882313041602553845621113546259276402534229231780532278276697961222319054833980226978574905974878218905613341365260453461080117407529132948986104191917111000811731784483944945364091757083949827612260904757837644538366763161154611658652020868326985526984718638276184626634240096213703958275241215175054246685206226179114590838833694648062135027841593419815101363262701960507235056752424778384286627997500871204804629047307688466887868894491042058198480775705486</span>

p1 <span class="token operator">=</span> GCD<span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span>
q1 <span class="token operator">=</span> n1 <span class="token operator">//</span> p1
phi1 <span class="token operator">=</span> <span class="token punctuation">(</span>p1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
d1 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> phi1<span class="token punctuation">)</span>

str1 <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> d1<span class="token punctuation">,</span> n1<span class="token punctuation">)</span><span class="token punctuation">)</span>

p2 <span class="token operator">=</span> GCD<span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span>
q2 <span class="token operator">=</span> n2 <span class="token operator">//</span> p2
phi2 <span class="token operator">=</span> <span class="token punctuation">(</span>p2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
d2 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e2<span class="token punctuation">,</span> phi2<span class="token punctuation">)</span>

str2 <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> d2<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">)</span>

p3 <span class="token operator">=</span> GCD<span class="token punctuation">(</span>n2<span class="token punctuation">,</span> n3<span class="token punctuation">)</span>
q3 <span class="token operator">=</span> n3 <span class="token operator">//</span> p3
phi3 <span class="token operator">=</span> <span class="token punctuation">(</span>p3 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q3 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
d3 <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e3<span class="token punctuation">,</span> phi3<span class="token punctuation">)</span>

str3 <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c3<span class="token punctuation">,</span> d3<span class="token punctuation">,</span> n3<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>str1<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">b'is :'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> str2<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">b'is :'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> str3<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">b'is :'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre> 
<p>得到flag<code>flag{G00d_w4y_tO_cR4ck_RS4}</code></p> 
<h3><a id="_my_Tempalate_85"></a>五、 my Tempalate</h3> 
<p>用御剑直接扫<br> <img src="https://images2.imgbox.com/37/98/DghixtWj_o.png" alt="在这里插入图片描述"><br> 发现有个www.zip然后直接下载代码审计发现把session删除，然后访问admin.php,GET传参，覆盖掉<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         f 
        
       
         i 
        
       
         l 
        
       
         e 
        
       
         , 
        
       
         在 
        
       
         利 
        
       
         用 
        
       
         d 
        
       
         a 
        
       
         t 
        
       
         a 
        
       
         伪 
        
       
         协 
        
       
         议 
        
       
         给 
        
       
      
        file, 在利用data伪协议给 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord cjk_fallback">在</span><span class="mord cjk_fallback">利</span><span class="mord cjk_fallback">用</span><span class="mord mathdefault">d</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord cjk_fallback">伪</span><span class="mord cjk_fallback">协</span><span class="mord cjk_fallback">议</span><span class="mord cjk_fallback">给</span></span></span></span></span>content，于是构造payload：/admin.php?file=data:text/plain,&lt;?php echo(`ls`)?&gt;在根下有flag.php，cat一下，得到flag</p> 
<h3><a id="_Mastof_of_VM_92"></a>六、 Mastof of VM</h3> 
<pre><code>	用xshll连接到ssh发现有个flag文件
</code></pre> 
<p><img src="https://images2.imgbox.com/f1/5e/2esPpUDG_o.png" alt="在这里插入图片描述"><br> 但是无法下载我试着去其他目录寻找在根目录找到了这个flag.txt文件里面就是flag<img src="https://images2.imgbox.com/93/24/3mEGUt1Q_o.png" alt="在这里插入图片描述"></p> 
<p>PS:高职组的小菜鸡第一次参与这种ctf赛第一次写wp写的不好多多见谅</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5f9bb6988a19f08318599604d41ecea9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java并发编程的艺术(5-10)学习总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8851f9980668e125247f7f16f0995a79/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java 与(&amp;)、或(|)、异或(^)、按位取反(~)、左移（＜＜）、右移（＞＞）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>