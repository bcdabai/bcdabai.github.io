<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>2.机器学习-K最近邻(k-Nearest Neighbor，KNN)分类算法原理讲解 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="2.机器学习-K最近邻(k-Nearest Neighbor，KNN)分类算法原理讲解" />
<meta property="og:description" content="2️⃣机器学习-K最近邻（k-Nearest Neighbor，KNN）分类算法原理讲解 个人简介一·算法概述二·算法思想2.1 KNN的优缺点 三·实例演示3.1电影分类3.2使用KNN算法预测 鸢(yuan)尾花 的种类3.3 预测年收入是否大于50K美元 个人简介 🏘️🏘️个人主页：以山河作礼。
🎖️🎖️:Python领域新星创作者，CSDN实力新星认证，CSDN内容合伙人，阿里云社区专家博主，新星计划导师，在职数据分析师。 🎉🎉免费学习专栏：
1. 《Python基础入门》——0基础入门
2.《Python网络爬虫》——从入门到精通
3.《Web全栈开发》——涵盖了前端、后端和数据库等多个领域
💕💕悲索之人烈焰加身，堕落者不可饶恕。永恒燃烧的羽翼，带我脱离凡间的沉沦。
一·算法概述 K-最近邻算法（K-Nearest Neighbor，简称KNN）是一种基于实例学习的算法，可以应用于分类和回归任务。作为一种非参数算法，KNN不对数据分布做任何假设，而是直接使用数据中的最近K个邻居的标签来预测新数据点的标签。
在KNN算法中，每个数据点都可以表示为一个n维向量，其中n是特征的数量。对于一个新的数据点，KNN算法会计算它与每个训练数据点之间的距离，并选择最近的K个训练数据点。对于分类问题，KNN算法会将这K个训练数据点中出现最多的类别作为预测结果。而对于回归问题，KNN算法会将这K个训练数据点的输出值的平均值作为预测结果。
在KNN算法中，K的取值是一个超参数，需要根据数据集的特点和算法的性能进行选择。通常情况下，较小的K值可以使模型更复杂，更容易受到噪声的影响，而较大的K值可以使模型更简单、更稳定，但可能会导致模型的欠拟合。因此，选择合适的K值对于KNN算法的性能至关重要。
二·算法思想 KNN（K-最近邻）算法是一种基于实例的分类方法，通过计算不同特征值之间的距离来进行分类。
1️⃣其核心思想是：
如果一个样本在特征空间中的k个最邻近的样本中的大多数属于某一个类别，则该样本也划分为这个类别。KNN算法中，所选择的邻居都是已经正确分类的对象。该方法在定类决策上只依据最邻近的一个或者几个样本的类别来决定待分样本所属的类别。
2️⃣ KNN算法的主要步骤如下：
确定k值，即选取多少个最近邻居参与投票。计算待分类样本与已知分类样本之间的距离，通常使用欧氏距离作为距离度量。对距离进行排序，找出最近的k个邻居。统计这k个邻居中各个类别的数量，将数量最多的类别作为待分类样本的类别。 3️⃣KNN算法涉及3个主要因素：
实例集、距离或相似的衡量、k的大小。实例集是指已知分类的样本集合；距离或相似的衡量是指计算样本之间距离的方法，如欧氏距离；k的大小是指选取多少个最近邻居参与投票，k值的选择会影响分类结果的准确性。
一个实例的最近邻是根据标准欧氏距离定义的。更精确地讲，把任意的实例x表示为下面的特征向量：
其中ar(x)表示实例x的第r个属性值。那么两个实例xi和xj间的距离定义为d(xi,xj)，其中：
2.1 KNN的优缺点 1️⃣K-最近邻算法（KNN）的优点：
简单易懂：KNN算法的原理和实现都非常简单，容易理解和掌握。
非参数化：KNN是一种非参数化算法，不需要对数据分布做任何假设。
对异常值不敏感：KNN能够有效处理包含异常值的数据。
多用途：适用于分类和回归问题。
高维数据处理：可以处理高维特征空间的数据。
非线性问题处理：能够适应非线性的数据分布。
高度可解释性：结果直观，易于解释。
2️⃣KNN算法的缺点：
效率低：在大型数据集上计算距离时效率较低，尤其是在高维数据中。
对噪声敏感：训练数据中的噪声可能影响最近邻的选择，导致预测结果不准确。
K值选择：K值的选择对算法性能有很大影响，需要通过实验来确定最佳值。
距离度量：选择合适的距离度量方法对算法性能至关重要。
特征缩放敏感：需要对特征进行归一化或标准化，否则可能导致某些特征过于主导。
缺失值处理：处理缺失值较为困难，需要采取特定策略来应对。
解释性差：由于是基于实例的预测，相对于其他模型来说解释性较差。
三·实例演示 3.1电影分类 1.导入数据分析三剑客
import numpy as np import pandas as pd import matplotlib.pyplot as plt 2.导入KNN算法
# 谷歌的机器学习库 from sklearn." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ea13b2844d92e931b37dde96ee19f29e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-22T18:00:25+08:00" />
<meta property="article:modified_time" content="2024-01-22T18:00:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2.机器学习-K最近邻(k-Nearest Neighbor，KNN)分类算法原理讲解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>2️⃣机器学习-K最近邻（k-Nearest Neighbor，KNN）分类算法原理讲解</h4> 
 <ul><li><a href="#_4" rel="nofollow">个人简介</a></li><li><a href="#_16" rel="nofollow">一·算法概述</a></li><li><a href="#_23" rel="nofollow">二·算法思想</a></li><li><ul><li><ul><li><a href="#21_KNN_48" rel="nofollow">2.1 KNN的优缺点</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_69" rel="nofollow">三·实例演示</a></li><li><ul><li><ul><li><a href="#31_70" rel="nofollow">3.1电影分类</a></li><li><a href="#32KNN_yuan__152" rel="nofollow">3.2使用KNN算法预测 鸢(yuan)尾花 的种类</a></li><li><a href="#33_50K_241" rel="nofollow">3.3 预测年收入是否大于50K美元</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_4"></a>个人简介</h2> 
<blockquote> 
 <p>🏘️🏘️个人主页：<a href="https://blog.csdn.net/weixin_50804299?type=blog">以山河作礼</a>。<br> 🎖️🎖️:<font color="Red">Python领域新星创作者，CSDN实力新星认证，CSDN内容合伙人，阿里云社区专家博主，新星计划导师，在职数据分析师。 </font><br> 🎉🎉<strong>免费学习专栏</strong>：</p> 
 <p><a href="https://blog.csdn.net/weixin_50804299/category_12136118.html?spm=1001.2014.3001.5482">1. 《Python基础入门》——0基础入门</a><br> <a href="https://blog.csdn.net/weixin_50804299/category_12221159.html?spm=1001.2014.3001.5482">2.《Python网络爬虫》——从入门到精通</a><br> <a href="https://blog.csdn.net/weixin_50804299/category_12313749.html?spm=1001.2014.3001.5482">3.《Web全栈开发》——涵盖了前端、后端和数据库等多个领域</a></p> 
 <p>💕💕悲索之人烈焰加身，堕落者不可饶恕。永恒燃烧的羽翼，带我脱离凡间的沉沦。</p> 
</blockquote> 
<h2><a id="_16"></a>一·算法概述</h2> 
<p><strong>K-最近邻算法（K-Nearest Neighbor，简称KNN）是一种基于实例学习的算法，可以应用于分类和回归任务</strong>。作为一种<code>非参数算法</code>，<mark>KNN不对数据分布做任何假设，而是直接使用数据中的最近K个邻居的标签来预测新数据点的标签</mark>。</p> 
<p>在KNN算法中，<strong>每个数据点都可以表示为一个n维向量</strong>，其中<strong>n是特征的数量</strong>。对于一个新的数据点，KNN算法会计算它与每个训练数据点之间的距离，并选择最近的K个训练数据点。对于分类问题，KNN算法会将这K个训练数据点中出现最多的类别作为预测结果。而对于回归问题，KNN算法会将这K个训练数据点的输出值的平均值作为预测结果。</p> 
<p>在KNN算法中，K的取值是一个超参数，需要根据数据集的特点和算法的性能进行选择。通常情况下，较小的K值可以使模型更复杂，更容易受到噪声的影响，而较大的K值可以使模型更简单、更稳定，但可能会导致模型的欠拟合。因此，选择合适的K值对于KNN算法的性能至关重要。<br> <img src="https://images2.imgbox.com/3d/75/i4eR6CnR_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_23"></a>二·算法思想</h2> 
<p><strong>KNN（K-最近邻）算法是一种基于实例的分类方法，通过计算不同特征值之间的距离来进行分类</strong>。</p> 
<p>1️⃣<mark>其核心思想是</mark>：<br> 如果一个样本在特征空间中的k个最邻近的样本中的大多数属于某一个类别，则该样本也划分为这个类别。KNN算法中，所选择的邻居都是已经正确分类的对象。该方法在定类决策上只依据最邻近的一个或者几个样本的类别来决定待分样本所属的类别。</p> 
<p>2️⃣ <mark>KNN算法的主要步骤如下</mark>：</p> 
<ol><li>确定k值，即选取多少个最近邻居参与投票。</li><li>计算待分类样本与已知分类样本之间的距离，通常使用欧氏距离作为距离度量。</li><li>对距离进行排序，找出最近的k个邻居。</li><li>统计这k个邻居中各个类别的数量，将数量最多的类别作为待分类样本的类别。</li></ol> 
<p>3️⃣<mark>KNN算法涉及3个主要因素</mark>：<br> 实例集、距离或相似的衡量、k的大小。实例集是指已知分类的样本集合；距离或相似的衡量是指计算样本之间距离的方法，如欧氏距离；k的大小是指选取多少个最近邻居参与投票，k值的选择会影响分类结果的准确性。</p> 
<p>一个实例的最近邻是根据标准欧氏距离定义的。更精确地讲，把任意的实例x表示为下面的特征向量：<br> <img src="https://images2.imgbox.com/7e/ee/FrQzRilT_o.png" alt="在这里插入图片描述"></p> 
<p>其中ar(x)表示实例x的第r个属性值。那么两个实例xi和xj间的距离定义为d(xi,xj)，其中：</p> 
<p><img src="https://images2.imgbox.com/6f/64/1v3KeNu1_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/a3/5c/P7YcJFrV_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="21_KNN_48"></a>2.1 KNN的优缺点</h4> 
<p>1️⃣<mark>K-最近邻算法（KNN）的优点</mark>：</p> 
<p><code>简单易懂</code>：KNN算法的原理和实现都非常简单，容易理解和掌握。<br> <code>非参数化</code>：KNN是一种非参数化算法，不需要对数据分布做任何假设。<br> <code>对异常值不敏感</code>：KNN能够有效处理包含异常值的数据。<br> <code>多用途</code>：适用于分类和回归问题。<br> <code>高维数据处理</code>：可以处理高维特征空间的数据。<br> <code>非线性问题处理</code>：能够适应非线性的数据分布。<br> <code>高度可解释性</code>：结果直观，易于解释。</p> 
<p>2️⃣<mark>KNN算法的缺点</mark>：</p> 
<p><code>效率低</code>：在大型数据集上计算距离时效率较低，尤其是在高维数据中。<br> <code>对噪声敏感</code>：训练数据中的噪声可能影响最近邻的选择，导致预测结果不准确。<br> <code>K值选择</code>：K值的选择对算法性能有很大影响，需要通过实验来确定最佳值。<br> <code>距离度量</code>：选择合适的距离度量方法对算法性能至关重要。<br> <code>特征缩放敏感</code>：需要对特征进行归一化或标准化，否则可能导致某些特征过于主导。<br> <code>缺失值处理</code>：处理缺失值较为困难，需要采取特定策略来应对。<br> <code>解释性差</code>：由于是基于实例的预测，相对于其他模型来说解释性较差。</p> 
<h2><a id="_69"></a>三·实例演示</h2> 
<h4><a id="31_70"></a>3.1电影分类</h4> 
<p><strong>1.导入数据分析三剑客</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
</code></pre> 
<p><strong>2.导入KNN算法</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 谷歌的机器学习库 </span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neighbors <span class="token keyword">import</span> KNeighborsClassifier

</code></pre> 
<p><strong>3.导入warnings模块，并设置警告过滤器为忽略所有警告</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> warnings
warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span>action<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>4.使用电影数据</strong></p> 
<pre><code class="prism language-python">movies <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'../data/movies.xlsx'</span><span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
movies
</code></pre> 
<p><img src="https://images2.imgbox.com/15/13/7bHa9Lob_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment">#  有标签的：有监督学习</span>

<span class="token comment"># 训练数据</span>
<span class="token comment"># x_train,y_train </span>

<span class="token comment"># 测试数据</span>
<span class="token comment"># x_test,y_test</span>

<span class="token comment"># data  : x特征数据</span>
<span class="token comment"># target ：y标签数据</span>

</code></pre> 
<pre><code class="prism language-python">data <span class="token operator">=</span> movies<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'武打镜头'</span><span class="token punctuation">,</span><span class="token string">'接吻镜头'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
data <span class="token comment"># 二维</span>

target <span class="token operator">=</span> movies<span class="token punctuation">.</span>分类情况
target  <span class="token comment"># 一维</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/05/60/LYjK5Fim_o.png" alt="在这里插入图片描述"></p> 
<p><strong><mark>KNN模型</mark></strong><br> <strong>1.创建模型</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># n_neighbors=5, k值  k = 5</span>
<span class="token comment"># p = 2 距离算法，p=2表示欧氏距离 ，p = 1 表示曼哈顿距离</span>
<span class="token comment"># </span>
knn <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span>n_neighbors<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>p<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>2.训练</strong></p> 
<pre><code class="prism language-python">knn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>data<span class="token punctuation">,</span>target<span class="token punctuation">)</span>
</code></pre> 
<p><strong>3.预测</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 自己提供测试数据，训练数据和测试数据列得相同，行可以不同</span>

x_test<span class="token operator">=</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
x_test <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span>columns<span class="token operator">=</span> data<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
y_test <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'动作片'</span><span class="token punctuation">,</span><span class="token string">'爱情片'</span><span class="token punctuation">,</span><span class="token string">'爱情片'</span><span class="token punctuation">,</span><span class="token string">'动作片'</span><span class="token punctuation">,</span><span class="token string">'爱情片'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
y_pred <span class="token operator">=</span> knn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span>
y_pred
</code></pre> 
<p><img src="https://images2.imgbox.com/64/4c/0HUT6lDE_o.png" alt="在这里插入图片描述"><br> <strong>4.得分 ，准确率</strong><br> <img src="https://images2.imgbox.com/82/26/axvkTyWY_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="32KNN_yuan__152"></a>3.2使用KNN算法预测 鸢(yuan)尾花 的种类</h4> 
<p><img src="https://images2.imgbox.com/56/67/1Lq3ofyT_o.png" alt="在这里插入图片描述"></p> 
<p><strong>1.导入数据分析三剑客</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
</code></pre> 
<p><strong>2.导入KNN算法</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 谷歌的机器学习库 </span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neighbors <span class="token keyword">import</span> KNeighborsClassifier

</code></pre> 
<p><strong>3.导入warnings模块，并设置警告过滤器为忽略所有警告</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> warnings
warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span>action<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>
</code></pre> 
<p>4.得到鸢尾花数据</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># return_X_y=True  只返回data和target</span>
<span class="token comment">#  data,target = load_iris(return_X_y=True)</span>
</code></pre> 
<p><strong>5.使用sklearn库中的load_iris()函数加载鸢尾花数据集，并将数据集分为数据（data）、目标（target）、目标名称（target_names）、特征名称（feature_names）四个部分。</strong></p> 
<pre><code class="prism language-python">iris <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> iris<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span>
target <span class="token operator">=</span> iris<span class="token punctuation">[</span><span class="token string">'target'</span><span class="token punctuation">]</span>
target_names <span class="token operator">=</span> iris<span class="token punctuation">[</span><span class="token string">'target_names'</span><span class="token punctuation">]</span>
feature_names <span class="token operator">=</span> iris<span class="token punctuation">[</span><span class="token string">'feature_names'</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">,</span>columns<span class="token operator">=</span>feature_names<span class="token punctuation">)</span>
df
</code></pre> 
<p><img src="https://images2.imgbox.com/a3/32/CPhw1UH6_o.png" alt="在这里插入图片描述"></p> 
<p><strong>6.拆分数据集<br> 把data和target取一部分作为测试数据，剩下的作为训练数据<br> 从sklearn库的model_selection模块中导入train_test_split函数，该函数用于将数据集划分为训练集和测试集。</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split 
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># test_size</span>
<span class="token comment"># 整数：测试数据的数量</span>
<span class="token comment"># 小数：测试数据的占比，一般比较小，0.2,0.3</span>

x_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>data<span class="token punctuation">,</span>
                                                    target<span class="token punctuation">,</span>
                                                    test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>
x_train<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> x_test<span class="token punctuation">.</span>shape
</code></pre> 
<pre><code class="prism language-python"><span class="token comment"># y_test 表示测试数据的真实结果</span>
<span class="token comment"># y_pred：表示测试数据的预测结果</span>
</code></pre> 
<p><strong>7.使用KNN算法</strong></p> 
<pre><code class="prism language-python">knn <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>
knn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">knn<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span>
<span class="token comment">#0.33 </span>
<span class="token comment">#0.7以上:得分正常</span>
<span class="token comment">#0.8以上:比较好</span>
<span class="token comment">#0.9以上:非常好</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/99/55/NQDg55ts_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="33_50K_241"></a>3.3 预测年收入是否大于50K美元</h4> 
<p><strong>1.导入数据分析三剑客</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
</code></pre> 
<p><strong>2.导入KNN算法</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 谷歌的机器学习库 </span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neighbors <span class="token keyword">import</span> KNeighborsClassifier

</code></pre> 
<p><strong>3.导入warnings模块，并设置警告过滤器为忽略所有警告</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> warnings
warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span>action<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>

读取adults<span class="token punctuation">.</span>csv文件，最后一列是年收入，并使用KNN算法训练模型，然后使用模型预测一个人的年收入是否大于<span class="token number">50</span>

```python
adults <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'../data/adults.csv'</span><span class="token punctuation">)</span>
adults
</code></pre> 
<p><img src="https://images2.imgbox.com/8d/6b/SruN1GkL_o.png" alt="在这里插入图片描述"></p> 
<p>4.获取年龄age、教育程度education、职位workclass、每周工作时间hours_per_week 作为机器学习数据 获取薪水作为对应结果</p> 
<pre><code class="prism language-python">data <span class="token operator">=</span> adults<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'age'</span><span class="token punctuation">,</span><span class="token string">'education'</span><span class="token punctuation">,</span><span class="token string">'workclass'</span><span class="token punctuation">,</span><span class="token string">'hours_per_week'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
target <span class="token operator">=</span> adults<span class="token punctuation">[</span><span class="token string">'salary'</span><span class="token punctuation">]</span>
</code></pre> 
<p>5.数据转换，将String/Object类型数据转换为int,用0,1,2,3…表示<br> 使用factorize()函数</p> 
<pre><code class="prism language-python">data<span class="token punctuation">[</span><span class="token string">'education'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'education'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>factorize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python">data<span class="token punctuation">[</span><span class="token string">'workclass'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'workclass'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>factorize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> 
<pre><code class="prism language-python">data
</code></pre> 
<p><img src="https://images2.imgbox.com/c4/3e/J581vM1k_o.png" alt="在这里插入图片描述"><br> <strong>6.拆分数据集：训练数据和预测数据</strong></p> 
<pre><code class="prism language-python">x_train<span class="token punctuation">,</span>x_test<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>data<span class="token punctuation">,</span>target<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">x_train
</code></pre> 
<p><img src="https://images2.imgbox.com/a4/8c/B5IquJu0_o.png" alt="在这里插入图片描述"></p> 
<p><strong>7.使用KNN算法</strong></p> 
<pre><code class="prism language-python">knn <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>
knn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">knn<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2d/11/dQRQXgOp_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/238f68b2964927775d6d2c95a400be0d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">深度学习技术栈 —— 用Pytorch搭建神经网络识别数字(Kaggle实战)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f771027bae77fe5e8d3c38206ae926d6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">云风网（www.niech.cn）个人网站搭建（九）html静态菜单列表替换为接口请求动态数据</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>