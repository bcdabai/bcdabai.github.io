<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>quill-editor实现自定义按钮,上传图片到服务器,获取文本内容并展示 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="quill-editor实现自定义按钮,上传图片到服务器,获取文本内容并展示" />
<meta property="og:description" content="quill-editor是一款非常强大的富文本组件,在最近的项目里也是使用到了,附上:插件源码
使用也是非常简单:
一.下载Vue-Quill-Editor
npm install vue-quill-editor --save 二.在vue里的组件中使用
&lt;template&gt; &lt;div class=&#34;edit_container&#34;&gt; &lt;quill-editor v-model=&#34;content&#34; ref=&#34;myQuillEditor&#34; :options=&#34;editorOption&#34; @blur=&#34;onEditorBlur($event)&#34; @focus=&#34;onEditorFocus($event)&#34; @change=&#34;onEditorChange($event)&#34;&gt; &lt;/quill-editor&gt; &lt;/div&gt; &lt;/template&gt; &lt;script&gt; import { quillEditor } from &#34;vue-quill-editor&#34;; //调用编辑器 export default { components: { quillEditor }, data() { return { content: `&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;strong&gt;&lt;em&gt;Or drag/paste an image here.&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;&lt;em&gt;rerew&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;&lt;em&gt;rtrete&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;&lt;em&gt;tytrytr&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;&lt;em&gt;uytu&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;&lt;/ol&gt;`, editorOption: {} } }, methods: { onEditorReady(editor) {} // 准备编辑器, onEditorBlur(){}, // 失去焦点事件 onEditorFocus(){}, // 获得焦点事件 onEditorChange(){}, // 内容改变事件 }, computed: { editor() { return this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/3f1aa49306eeb26c4da0ee9a98e5dd40/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-02-21T22:20:43+08:00" />
<meta property="article:modified_time" content="2019-02-21T22:20:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">quill-editor实现自定义按钮,上传图片到服务器,获取文本内容并展示</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>quill-editor是一款非常强大的富文本组件,在最近的项目里也是使用到了,附上:<a href="https://github.com/surmon-china/vue-quill-editor">插件源码</a></p> 
<p>使用也是非常简单:</p> 
<p><strong>一.下载Vue-Quill-Editor</strong></p> 
<pre><code class="prism language-js">
npm install vue<span class="token operator">-</span>quill<span class="token operator">-</span>editor <span class="token operator">--</span>save
</code></pre> 
<p><strong>二.在vue里的组件中使用</strong></p> 
<pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"edit_container"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>quill<span class="token operator">-</span>editor 
            v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"content"</span> 
            ref<span class="token operator">=</span><span class="token string">"myQuillEditor"</span> 
            <span class="token punctuation">:</span>options<span class="token operator">=</span><span class="token string">"editorOption"</span> 
            @blur<span class="token operator">=</span><span class="token string">"onEditorBlur($event)"</span> @focus<span class="token operator">=</span><span class="token string">"onEditorFocus($event)"</span>
            @change<span class="token operator">=</span><span class="token string">"onEditorChange($event)"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>quill<span class="token operator">-</span>editor<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> quillEditor <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue-quill-editor"</span><span class="token punctuation">;</span> <span class="token comment">//调用编辑器</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    components<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        quillEditor
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
            content<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;strong&gt;&lt;em&gt;Or drag/paste an image here.&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;&lt;em&gt;rerew&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;&lt;em&gt;rtrete&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;&lt;em&gt;tytrytr&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;&lt;em&gt;uytu&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;&lt;/ol&gt;`</span></span><span class="token punctuation">,</span>
            editorOption<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">onEditorReady</span><span class="token punctuation">(</span>editor<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span> <span class="token comment">// 准备编辑器,</span>
        <span class="token function">onEditorBlur</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 失去焦点事件</span>
        <span class="token function">onEditorFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 获得焦点事件</span>
        <span class="token function">onEditorChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 内容改变事件</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    computed<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">editor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>myQuillEditor<span class="token punctuation">.</span>quill<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">"scss"</span><span class="token operator">&gt;</span>
    <span class="token punctuation">.</span>edit_container  <span class="token punctuation">{<!-- --></span>
        width<span class="token punctuation">:</span> <span class="token number">800</span>px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> 

    <span class="token comment">//输入框</span>
    <span class="token punctuation">.</span>ql<span class="token operator">-</span>container <span class="token punctuation">{<!-- --></span>
        height<span class="token punctuation">:</span> <span class="token number">400</span>px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre> 
<p><strong>三.获取富文本里的内容</strong></p> 
<p>我们发现富文本里数据是双向数据绑定到content这个变量上面的,那我们可以在methods里面写一个方法,在页面上添加一个按钮,当点击按钮时我们输出内容</p> 
<pre><code class="prism language-js"><span class="token comment">//html</span>
<span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"getQuillEditorContent"</span><span class="token operator">&gt;</span>点击输出内容<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

<span class="token comment">//methods里面的方法</span>
<span class="token function">getQuillEditorContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">)</span> <span class="token comment">//输出的是一段html</span>
    <span class="token comment">// console.log(this.$refs.myQuillEditor.quill.getText())</span>
    <span class="token comment">// console.log(this.$refs.myQuillEditor) //获取到富文本对象</span>
    <span class="token comment">//这里一定要注意写法,这里获取的是一个Delta对象</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>myQuillEditor<span class="token punctuation">.</span>quill<span class="token punctuation">.</span><span class="token function">getContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// console.log(this.$refs.myQuillEditor.quill.getText())</span>
   	<span class="token comment">// console.log(this.$refs.myQuillEditor.quill.root.innerHTML)</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c0/a0/yoZnYUAC_o.png" alt="在这里插入图片描述"></p> 
<p>一定要注意第二个console.log里面的写法:</p> 
<pre><code>1.this.$refs.myQuillEditor是获取到富文本对象 console.log(this.$refs.myQuillEditor)
2.一定要点quill否则拿不到quill的api(各种方法)
</code></pre> 
<p>由此可见,获取富文本内容的三种方式:</p> 
<ol><li>content双向数据绑定的方式</li><li>getContents() —— 返回的是Delta对象，一种JSON数组</li><li>getText() —— 返回文本域里对应字符串</li></ol> 
<p><strong>四 展示富文本数据</strong></p> 
<p>我们获取到的富文本是一段纯标签的数据,里面没有带上行内样式,为了原样展示出富文本的数据,专门写了一个展示的组件</p> 
<pre><code class="prism language-js"><span class="token comment">//展示子组件</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token string">'height:500px;width:700px;'</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">'quill-editor'</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"ql-container"</span><span class="token operator">&gt;</span>
                	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 利用v<span class="token operator">-</span>html标签做到原样展示 <span class="token operator">--</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">'ql-editor'</span> v<span class="token operator">-</span>html<span class="token operator">=</span><span class="token string">"quillHtml"</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span> 
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token string">'quill/dist/quill.core.css'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'quill/dist/quill.snow.css'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'quill/dist/quill.bubble.css'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    name<span class="token punctuation">:</span> <span class="token string">"quillShow"</span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
          quillHtml<span class="token punctuation">:</span> <span class="token string">""</span>  
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//这里的created钩子只会执行一次,所以做不到传递异步数据的效果</span>

        <span class="token comment">// this.quillHtml = this.quillHtmlStr</span>
        
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>quillHtml<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>quillHtmlStr<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    watch<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">//利用watch来实现传递异步数据</span>
      <span class="token string">"quillHtmlStr"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>newVal<span class="token punctuation">,</span>oldVal<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>quillHtml <span class="token operator">=</span> newVal
      <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    props<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        quillHtmlStr<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
            type<span class="token punctuation">:</span> String
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p>在需要展示的父组件里引入这个组件并传值就可以了</p> 
<pre><code class="prism language-js"><span class="token comment">//使用</span>
<span class="token operator">&lt;</span>quill<span class="token operator">-</span>show <span class="token punctuation">:</span>quillHtmlStr<span class="token punctuation">.</span>sync<span class="token operator">=</span><span class="token string">"quillHtmlStr"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>quill<span class="token operator">-</span>show<span class="token operator">&gt;</span>

<span class="token comment">//然后在方法里调用就可以了</span>
<span class="token function">getQuillEditorContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
     <span class="token comment">// console.log(this.content)</span>
     <span class="token comment">// console.log(this.$refs.myQuillEditor)</span>
     <span class="token comment">// console.log(this.$refs.myQuillEditor.quill.getContents())</span>
     <span class="token comment">// console.log(this.$refs.myQuillEditor.quill.getText())</span>
     <span class="token comment">// console.log(this.$refs.myQuillEditor.quill.root.innerHTML)</span>

     <span class="token keyword">this</span><span class="token punctuation">.</span>quillHtmlStr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p><strong>五.自定义一个图标</strong></p> 
<p>自定义一个图标的方式有两种方式:<a href="https://quilljs.com/docs/modules/toolbar/" rel="nofollow">官方文档</a></p> 
<p><strong>1.利用options来配置:</strong></p> 
<pre><code class="prism language-js"><span class="token comment">//这里是全部的图标,你想要选择什么就留下什么就可以了</span>
<span class="token keyword">var</span> toolbarOptions <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">'bold'</span><span class="token punctuation">,</span> <span class="token string">'italic'</span><span class="token punctuation">,</span> <span class="token string">'underline'</span><span class="token punctuation">,</span> <span class="token string">'strike'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token comment">// toggled buttons</span>
  <span class="token punctuation">[</span><span class="token string">'blockquote'</span><span class="token punctuation">,</span> <span class="token string">'code-block'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> <span class="token string">'header'</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> <span class="token string">'header'</span><span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>               <span class="token comment">// custom button values</span>
  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> <span class="token string">'list'</span><span class="token punctuation">:</span> <span class="token string">'ordered'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> <span class="token string">'list'</span><span class="token punctuation">:</span> <span class="token string">'bullet'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> <span class="token string">'script'</span><span class="token punctuation">:</span> <span class="token string">'sub'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> <span class="token string">'script'</span><span class="token punctuation">:</span> <span class="token string">'super'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>      <span class="token comment">// superscript/subscript</span>
  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> <span class="token string">'indent'</span><span class="token punctuation">:</span> <span class="token string">'-1'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> <span class="token string">'indent'</span><span class="token punctuation">:</span> <span class="token string">'+1'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token comment">// outdent/indent</span>
  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> <span class="token string">'direction'</span><span class="token punctuation">:</span> <span class="token string">'rtl'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                         <span class="token comment">// text direction</span>

  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> <span class="token string">'size'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'small'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">'large'</span><span class="token punctuation">,</span> <span class="token string">'huge'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// custom dropdown</span>
  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> <span class="token string">'header'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> <span class="token string">'color'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> <span class="token string">'background'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token comment">// dropdown with defaults from theme</span>
  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> <span class="token string">'font'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span> <span class="token string">'align'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token punctuation">[</span><span class="token string">'clean'</span><span class="token punctuation">]</span>                                         <span class="token comment">// remove formatting button</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> 
<p>具体含义:</p> 
<p>背景颜色 - background<br> 加粗- bold<br> 颜色 - color<br> 字体 - font<br> 内联代码 - code<br> 斜体 - italic<br> 链接 - link<br> 大小 - size<br> 删除线 - strike<br> 上标/下标 - script<br> 下划线 - underline<br> 引用- blockquote<br> 标题 - header<br> 缩进 - indent<br> 列表 - list<br> 文本对齐 - align<br> 文本方向 - direction<br> 代码块 - code-block<br> 公式 - formula<br> 图片 - image<br> 视频 - video<br> 清除字体样式- clean</p> 
<p>现在我们在vue的组件里配置:</p> 
<pre><code class="prism language-js"><span class="token comment">//这里配置的是部分图标</span>
<span class="token keyword">const</span> toolbarOptions <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">'bold'</span><span class="token punctuation">,</span> <span class="token string">'italic'</span><span class="token punctuation">,</span> <span class="token string">'underline'</span><span class="token punctuation">,</span> <span class="token string">'strike'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token comment">// toggled buttons</span>
  <span class="token punctuation">[</span><span class="token string">'blockquote'</span><span class="token punctuation">,</span> <span class="token string">'code-block'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">'clean'</span><span class="token punctuation">]</span>                                         <span class="token comment">// remove formatting button</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    components<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        quillEditor
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
            content<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">``</span></span><span class="token punctuation">,</span>
            editorOption<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
                modules<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
                    toolbar<span class="token punctuation">:</span> toolbarOptions
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>配置出来的效果:<br> <img src="https://images2.imgbox.com/3e/e0/hiLLdc0R_o.png" alt="在这里插入图片描述"><br> <strong>2.利用solt的形式</strong><br> solt形式就是利用button来实现和这个效果</p> 
<p><strong>3.增加一个图标</strong></p> 
<p><strong>3.1 新建一个quill-config.js</strong></p> 
<p>在这个js里面重写配置一个操作按钮的数组,其中的[‘sourceEditor’]就是新的操作按钮的名字,而handlers 就是点击这个按钮应该做的事情,initButton是初始化这个按钮的样式函数,必须在mounted钩子去初始化这个按钮.</p> 
<pre><code class="prism language-js"><span class="token keyword">const</span> toolbarOptions <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">'bold'</span><span class="token punctuation">,</span> <span class="token string">'italic'</span><span class="token punctuation">,</span> <span class="token string">'underline'</span><span class="token punctuation">,</span> <span class="token string">'strike'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token comment">// toggled buttons</span>
  <span class="token punctuation">[</span><span class="token string">'blockquote'</span><span class="token punctuation">,</span> <span class="token string">'code-block'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">'clean'</span><span class="token punctuation">]</span>                                         <span class="token comment">// remove formatting button</span>
  <span class="token punctuation">[</span><span class="token string">'sourceEditor'</span><span class="token punctuation">]</span> <span class="token comment">//新添加的工具</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//重写事件方法</span>
<span class="token keyword">const</span> handlers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  shadeBox<span class="token punctuation">:</span><span class="token keyword">null</span><span class="token punctuation">,</span>
  sourceEditor<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>     <span class="token comment">//添加工具方法</span>
       <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'我新添加的工具方法'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//默认导出一个对象</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  placeholder<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
  theme<span class="token punctuation">:</span> <span class="token string">'snow'</span><span class="token punctuation">,</span>  <span class="token comment">// 主题</span>
  modules<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    toolbar<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      container<span class="token punctuation">:</span> toolOptions<span class="token punctuation">,</span>  <span class="token comment">// 工具栏选项</span>
      handlers<span class="token punctuation">:</span> handlers  <span class="token comment">// 事件重写</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  initButton<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>      <span class="token comment">//在使用的页面中初始化按钮样式</span>
    <span class="token keyword">const</span> sourceEditorButton <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.ql-sourceEditor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sourceEditorButton<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cssText <span class="token operator">=</span> <span class="token string">"width:80px; border:1px solid #ccc; border-radius:5px;"</span><span class="token punctuation">;</span>
    sourceEditorButton<span class="token punctuation">.</span>innerText<span class="token operator">=</span><span class="token string">"源码编辑"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>3.2 在页面上使用</strong></p> 
<p>在页面上使用的时候,注意的是要在mounted钩子里面初始化这个按钮,不然页面上的按钮将没有样式.</p> 
<pre><code class="prism language-js">
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>quill<span class="token operator">-</span>editor ref<span class="token operator">=</span><span class="token string">"myTextEditor"</span>
    	v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"content"</span> <span class="token punctuation">:</span>options<span class="token operator">=</span><span class="token string">"quillOption"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>quill<span class="token operator">-</span>editor<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
 
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
 
  <span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> quillEditor <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-quill-editor'</span>
  <span class="token keyword">import</span> quillConfig <span class="token keyword">from</span> <span class="token string">'./quill-config.js'</span>
 
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    components<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      quillEditor
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token comment">//在mounted钩子里面初始化富文本的样式</span>
      quillConfig<span class="token punctuation">.</span><span class="token function">initButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
        content<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        quillOption<span class="token punctuation">:</span> quillConfig<span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p><strong>五 上传图片到服务器</strong></p> 
<p>这里的方法最主要是借鉴了quill-editor-vue组件在github里issue的实现方法,<a href="https://github.com/surmon-china/vue-quill-editor/issues/134">地址</a></p> 
<pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 图片上传组件辅助<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>upload
                <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"avatar-uploader"</span>
                <span class="token punctuation">:</span>action<span class="token operator">=</span><span class="token string">"serverUrl"</span>
                name<span class="token operator">=</span><span class="token string">"img"</span>
                <span class="token punctuation">:</span>headers<span class="token operator">=</span><span class="token string">"header"</span>
                <span class="token punctuation">:</span>show<span class="token operator">-</span>file<span class="token operator">-</span>list<span class="token operator">=</span><span class="token string">"false"</span>
                <span class="token punctuation">:</span>on<span class="token operator">-</span>success<span class="token operator">=</span><span class="token string">"uploadSuccess"</span>
                <span class="token punctuation">:</span>on<span class="token operator">-</span>error<span class="token operator">=</span><span class="token string">"uploadError"</span>
                <span class="token punctuation">:</span>before<span class="token operator">-</span>upload<span class="token operator">=</span><span class="token string">"beforeUpload"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>upload<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>富文本编辑器组件<span class="token operator">--</span><span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>el<span class="token operator">-</span>row v<span class="token operator">-</span>loading<span class="token operator">=</span><span class="token string">"uillUpdateImg"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>quill<span class="token operator">-</span>editor
                v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"detailContent"</span>
                ref<span class="token operator">=</span><span class="token string">"myQuillEditor"</span>
                <span class="token punctuation">:</span>options<span class="token operator">=</span><span class="token string">"editorOption"</span>
                @change<span class="token operator">=</span><span class="token string">"onEditorChange($event)"</span>
                @ready<span class="token operator">=</span><span class="token string">"onEditorReady($event)"</span>
        <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>quill<span class="token operator">-</span>editor<span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    	<span class="token comment">// 工具栏配置</span>
		<span class="token keyword">const</span> toolbarOptions <span class="token operator">=</span> <span class="token punctuation">[</span>
		  <span class="token punctuation">[</span><span class="token string">'bold'</span><span class="token punctuation">,</span> <span class="token string">'italic'</span><span class="token punctuation">,</span> <span class="token string">'underline'</span><span class="token punctuation">,</span> <span class="token string">'strike'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token comment">// toggled buttons</span>
		  <span class="token punctuation">[</span><span class="token string">'blockquote'</span><span class="token punctuation">,</span> <span class="token string">'code-block'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		
		  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'header'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'header'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>               <span class="token comment">// custom button values</span>
		  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'list'</span><span class="token punctuation">:</span> <span class="token string">'ordered'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'list'</span><span class="token punctuation">:</span> <span class="token string">'bullet'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'script'</span><span class="token punctuation">:</span> <span class="token string">'sub'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'script'</span><span class="token punctuation">:</span> <span class="token string">'super'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>      <span class="token comment">// superscript/subscript</span>
		  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'indent'</span><span class="token punctuation">:</span> <span class="token string">'-1'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'indent'</span><span class="token punctuation">:</span> <span class="token string">'+1'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token comment">// outdent/indent</span>
		  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'direction'</span><span class="token punctuation">:</span> <span class="token string">'rtl'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                         <span class="token comment">// text direction</span>
		
		  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'size'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'small'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">'large'</span><span class="token punctuation">,</span> <span class="token string">'huge'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// custom dropdown</span>
		  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'header'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		
		  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'color'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'background'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>          <span class="token comment">// dropdown with defaults from theme</span>
		  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'font'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		  <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">'align'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		  <span class="token punctuation">[</span><span class="token string">'link'</span><span class="token punctuation">,</span> <span class="token string">'image'</span><span class="token punctuation">,</span> <span class="token string">'video'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		  <span class="token punctuation">[</span><span class="token string">'clean'</span><span class="token punctuation">]</span>                                         <span class="token comment">// remove formatting button</span>
		<span class="token punctuation">]</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
                serverUrl<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>  <span class="token comment">// 这里写你要上传的图片服务器地址</span>
                header<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>token<span class="token punctuation">:</span> sessionStorage<span class="token punctuation">.</span>token<span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 有的图片服务器要求请求头需要有token之类的参数，写在这里</span>
                detailContent<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 富文本内容</span>
                editorOption<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
                    placeholder<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
                    theme<span class="token punctuation">:</span> <span class="token string">'snow'</span><span class="token punctuation">,</span>  <span class="token comment">// or 'bubble'</span>
                    modules<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
                        toolbar<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
                            container<span class="token punctuation">:</span> toolbarOptions<span class="token punctuation">,</span>  <span class="token comment">// 工具栏</span>
                            handlers<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
                                <span class="token string">'image'</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                                    <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                                        document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#quill-upload input'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                                        <span class="token keyword">this</span><span class="token punctuation">.</span>quill<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'image'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token punctuation">}</span>
                                <span class="token punctuation">}</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 富文本图片上传前</span>
            <span class="token function">beforeUpload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 显示loading动画</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>quillUpdateImg <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            
            <span class="token function">uploadSuccess</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> file<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// res为图片服务器返回的数据</span>
                <span class="token comment">// 获取富文本组件实例</span>
                <span class="token keyword">let</span> quill <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>myQuillEditor<span class="token punctuation">.</span>quill
                <span class="token comment">// 如果上传成功</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token string">'200'</span> <span class="token operator">&amp;&amp;</span> res<span class="token punctuation">.</span>info <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 获取光标所在位置</span>
                    <span class="token keyword">let</span> length <span class="token operator">=</span> quill<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index<span class="token punctuation">;</span>
                    <span class="token comment">// 插入图片  res.info为服务器返回的图片地址</span>
                    quill<span class="token punctuation">.</span><span class="token function">insertEmbed</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span> <span class="token string">'image'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>info<span class="token punctuation">)</span>
                    <span class="token comment">// 调整光标到最后</span>
                    quill<span class="token punctuation">.</span><span class="token function">setSelection</span><span class="token punctuation">(</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'图片插入失败'</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// loading动画消失</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>quillUpdateImg <span class="token operator">=</span> <span class="token boolean">false</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
       
            <span class="token comment">// 富文本图片上传失败</span>
            <span class="token function">uploadError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// loading动画消失</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>quillUpdateImg <span class="token operator">=</span> <span class="token boolean">false</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'图片插入失败'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> 
<p>上面的代码是与element-ui结合实现的,其实与可以自己实现一个图片上传框,比如:</p> 
<pre><code class="prism language-js"><span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"viewport"</span> content<span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1.0"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">"X-UA-Compatible"</span> content<span class="token operator">=</span><span class="token string">"ie=edge"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Document<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
        <span class="token punctuation">.</span>box <span class="token punctuation">{<!-- --></span>
            width<span class="token punctuation">:</span> <span class="token number">500</span>px<span class="token punctuation">;</span>
            height<span class="token punctuation">:</span> <span class="token number">550</span>px<span class="token punctuation">;</span>
            margin<span class="token punctuation">:</span> <span class="token number">150</span>px auto<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        input <span class="token punctuation">{<!-- --></span>
            height<span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>
            margin<span class="token operator">-</span>bottom<span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>
            border<span class="token punctuation">:</span> <span class="token number">1</span>px solid #<span class="token number">000</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token punctuation">.</span>imgShow <span class="token punctuation">{<!-- --></span>
            width<span class="token punctuation">:</span> <span class="token number">500</span>px<span class="token punctuation">;</span>
            height<span class="token punctuation">:</span> <span class="token number">400</span>px<span class="token punctuation">;</span>
            border<span class="token punctuation">:</span> <span class="token number">5</span>px solid #<span class="token number">000</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"box"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 利用label标签可以美化上传按钮 <span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"fileBtn"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"uploadFile"</span><span class="token operator">&gt;</span>上传文件<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"file"</span> id<span class="token operator">=</span><span class="token string">"fileBtn"</span> style<span class="token operator">=</span><span class="token string">"display: none"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"imgShow"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">""</span> alt<span class="token operator">=</span><span class="token string">""</span><span class="token operator">&gt;</span>	
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'fileBtn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onchange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>

        <span class="token comment">//获取到文件</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// console.dir(this);</span>

        <span class="token comment">//限制上传的代码格式与大小</span>
        <span class="token keyword">var</span> fileSize <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>size 
        <span class="token keyword">var</span> size <span class="token operator">=</span> fileSize <span class="token operator">/</span> <span class="token number">1024</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>size<span class="token operator">&gt;</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>  
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"附件不能大于2M"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//限制上传的文件格式</span>
        <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
        <span class="token keyword">var</span> fileName <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> fileName <span class="token operator">!=</span><span class="token string">"jpg"</span>  
        	<span class="token operator">&amp;&amp;</span> fileName <span class="token operator">!=</span><span class="token string">"jpeg"</span> 
        	<span class="token operator">&amp;&amp;</span> fileName <span class="token operator">!=</span><span class="token string">"pdf"</span> 
            <span class="token operator">&amp;&amp;</span> fileName <span class="token operator">!=</span><span class="token string">"png"</span> 
            <span class="token operator">&amp;&amp;</span> fileName <span class="token operator">!=</span><span class="token string">"dwg"</span> 
            <span class="token operator">&amp;&amp;</span> fileName <span class="token operator">!=</span><span class="token string">"gif"</span> <span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"请选择图片格式文件上传(jpg,png,gif,dwg,pdf,gif等)！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	            <span class="token keyword">this</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
	            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 将文件生成一个url路径字符串</span>
        <span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 将图片展示在div的盒子里面</span>
         document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.imgShow'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token string">"url("</span><span class="token operator">+</span> url <span class="token operator">+</span> <span class="token string">") no-repeat center/cover"</span><span class="token punctuation">;</span>
	
		<span class="token comment">//也可以将图片显示在img单标签里面</span>
		 document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/30d4b51cabc8a4f901c634482aac07cd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">微信小程序动态设置live-pusher/live-player属性</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1e3a22207a6db01c2f0cd7a5b9390a14/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">opencv中四种立体匹配算法示例（StereoBM,StereoSGBM，StereoBinaryBM,  StereoBinarySGBM）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>