<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习_常见算法比较模型效果(LR、KNN、SVM、NB、DT、RF、XGB、LGB、CAT) - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习_常见算法比较模型效果(LR、KNN、SVM、NB、DT、RF、XGB、LGB、CAT)" />
<meta property="og:description" content="文章目录 KNNSVM朴素贝叶斯决策树随机森林 KNN “近朱者赤，近墨者黑”可以说是 KNN 的工作原理。
整个计算过程分为三步：
计算待分类物体与其他物体之间的距离；统计距离最近的 K 个邻居；对于 K 个最近的邻居，它们属于哪个分类最多，待分类物体就属于哪一类。 说说向量的距离。在KNN和其他机器学习算法中，常用的距离计算公式包括欧氏距离和曼哈顿距离。两个向量之间，用不同的距离计算公式得出来的结果是不一样的。
欧氏距离是欧几里得空间中两点间的“普通”(即直线)距离。在欧几里得空间中，点x=(x1, … ,xn)和点y=(y1, … ,yn)之间的欧氏距离为:
曼哈顿距离，也叫方格线距离或城市区块距离，是两个点在标准坐标系上的绝对轴距的总和。!在欧几里得空间的固定直角坐标系上，曼哈顿距离的意义为两点所形成的线段对轴产生的投影的距离总和。在平面上，点x=(xi，.，!x.)和点y=(yi,.,yn)之间的曼哈顿距离为:
下图的两个点之间，1、2与3线表示的各种曼哈顿距离长度都相同，而4线表示的则是欧氏距离。
下图中的两个特征，就形成了二维空间,图中心的问号代表一个未知类别的样本。如何归类呢，它是圆圈还是叉号?如果K=3，叉号所占比例大，问号样本将被判定为叉号类;如果K=7.则圆圈所占比例大，问号样本将被判定为圆圈类。
因此，KNN算法的结果和K的取值有关系。要注意的是，KNN要找的邻居都是已经“站好队的人”，也就是已经正确分类的对象。
SVM 用 SVM 计算的过程就是帮我们找到那个超平面的过程，这个超平面就是我们的 SVM 分类器。
主要说说超平面(hyperplane)和支持向量( support vector)这两个概念。超平面，就是用于特征空间根据数据的类别切分出来的分界平面。如下图所示的两个特征的二分类问题，我们就可以用一条线来表示超平面。如果特征再多一维，可以想象切割线会延展成一个平面，以此类推。而支持向量,就是离当前超平面最近的数据点，也就是下图中被分界线的两条平行线所切割的数据点，这些点对于超平面的进一步确定和优化最为重要。
如下图所示，在一个数据集的特征空间中，存在很多种可能的类分割超平面。比如，图中的H0实线和两条虚线，都可以把数据集成功地分成两类。
是实线分割较好，因为这样的分界线离两个类中的支持向量都比较远。SVM算法就是要在支持向量的帮助之下，通过类似于梯度下降的优化方法，找到最优的分类超平面——具体的目标就是令支持向量到超平面之间的垂直距离最宽，称为“最宽街道”。
那么目前的特征空间中有以下3条线。
H0就是目前的超平面。与之平行的H1H₂线上的特征点就是支持向量。
这3条线，由线性函数和其权重、偏置的值所确定:
然后计算支持向量到超平面的垂直距离，并通过机器学习算法调整参数w和b，将距离(也就是特征空间中的这条街道宽度)最大化。这和线性回归寻找最优函数的斜率和截距的过程很相似。 普通的SVM分类超平面只能应对线性可分的情况，对于非线性的分类，SVM要通过核方法( kernel method)解决。核方法是机器学习中的一类算法，并非专用于SVM。它的思路是，首先通过某种非线性映射(核函数)对特征粒度进行细化，将原始数据的特征嵌入合适的更高维特征空间；然后，利用通用的线性模型在这个新的空间中分析和处理模式，这样，将在二维上线性不可分的问题在多维上变得线性可分，那么SVM就可以在此基础上找到最优分割超平面。
朴素贝叶斯 朴素贝叶斯是一个通过条件概率进行分类的算法。
所谓条件概率，就是在事件A发生的概率下B发生的概率。例如，男生(事件A)是烟民(事件B)的概率为30%,女生(事件A)是烟民(事件B)的概率为5%。这些事件A就是“已发生的事件”，也就是所谓“预设”，也就是条件。
那么如何把条件概率引入机器学习呢?可以这么理解:数据集中数据样本的特征就形成了条件事件。比如:男，80岁，血压150mmHg，这3个已发生的事件，就是样本已知的特征。下面就需要进行二分类，确定患病还是未患病。此时我们拥有的信息量不多，怎么办呢?看一下训练数据集中满足这3个条件的数据有多少个，然后计算概率和计算分布。假如还有3个同样是80岁的男人，血压也是150mmHg，两个有心脏病，一个健康。此时算法就告诉我们，应该判断这个人也有心脏病的概率比较大。如果没有其他血压读数刚好是150的人呢?那就看看其他80岁的男人。如果10个人里面6个人都有心脏病，我们也只好推断此人有心脏病。
这就是朴素贝叶斯的基本原理。它会假设每个特征都是相互独立的(这就是一个很强的预设)，然后计算每个类别下的各个特征的条件概率。条件概率的公式如下:
在机器学习实践中，可以将上面的公式拆分成多个具体的特征:
公式解释如下。
Ck，代表的是分类的具体类别k。
P(c｜x)是条件概率，也就是所要计算的，当特征为x时，类别为c的概率。
P(x l c)叫作似然(likelihood)，就是训练集中标签分类为c的情况下，特征为x的概率。
比如，在垃圾电子邮件中，文本中含有“幸运抽奖”这个词的概率为0.2，换句话说，这个“0.2” 也就是“幸运抽奖”这个词出现在垃圾电子邮件中的似然。
P©，是训练集中分类为C的先验概率。比如,全部电子邮件中,垃圾电子邮件的概率为0.1。
P(x)，是特征的先验概率。
为什么图中这两个公式不大一样，第二个公式没有P(x)了。
因为在实践中，这个分母项在计算过程中会被忽略。因为这个P(x)，不管它的具体值多大，具体到一个特征向量，对于所有的分类e来说，这个值其实是固定的一并不随中K值的变化而改变。因此它是否存在，并不影响一个特定数据样本的归类。机器最后要做的，只是确保所求出的所有类的后验概率之和为1。这可以通过增加一个归一化参数
实现。
基本上，朴素贝叶斯是基于现有特征的概率对输入进行分类的，它的速度相当快，当没有太多数据并且需要快速得到结果时，朴素贝叶斯算法可以说是解决分类问题的良好选择。
决策树 这个算法简单直观，很容易理解。它有点像是将一大堆的if… else 语句进行连接，直到最后得到想要的结果。算法中的各个节点是根据训练数据集中的特征形成的。大家要注意特征节点的选择不同时，可以生成很多不一样的决策树。”
“下图所示是一个相亲数据集和根据该数据集而形成的决策树。此处我们设定一个根节点，作为决策的起点，从该点出发，根据数据集中的特征和标签值给树分叉。”
为什么要选择相貌这个特征作为这棵决策树的根节点?，是因为熵。
在信息学中，熵(entropy)，度量着信息的不确定性，信息的不确定性越大，熵越大。信息熵和事件发生的概率成反比。比如，“相亲者会认为这位先生很帅”这一句话的信息熵为0，因为这是事实。
这里有几个新概念，下面介绍一下。
信息熵代表随机变量的复杂度，也就是不确定性。条件熵代表在某一个条件下，随机变量的复杂度。信息增益等于信息熵减去条件熵，它代表了在某个条件下，信息复杂度(不确定性)减少的程度。 因此，如果一个特征从不确定到确定，这个过程对结果影响比较大的话，就可以认为这个特征的分类能力比较强。那么先根据这个特征进行决策之后，对于整个数据集而言，熵(不确定性)减少得最多，也就是信息增益最大。相亲的时候你们最看中什么，就先问什么，如果先问相点，说明你们觉得相貌不合格则后面其他所有问题都不用再问了，当然你们的妈妈可能一般会先问收入。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c56d1a2597751ae489888f744abfacc9/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-25T13:00:53+08:00" />
<meta property="article:modified_time" content="2024-01-25T13:00:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习_常见算法比较模型效果(LR、KNN、SVM、NB、DT、RF、XGB、LGB、CAT)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#KNN_3" rel="nofollow">KNN</a></li><li><a href="#SVM_30" rel="nofollow">SVM</a></li><li><a href="#_51" rel="nofollow">朴素贝叶斯</a></li><li><a href="#_78" rel="nofollow">决策树</a></li><li><a href="#_116" rel="nofollow">随机森林</a></li><li><a href="#_134" rel="nofollow"></a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="KNN_3"></a>KNN</h2> 
<p>“近朱者赤，近墨者黑”可以说是 KNN 的工作原理。<br> 整个计算过程分为三步：</p> 
<ul><li>计算待分类物体与其他物体之间的距离；</li><li>统计距离最近的 K 个邻居；</li><li>对于 K 个最近的邻居，它们属于哪个分类最多，待分类物体就属于哪一类。</li></ul> 
<p>说说向量的距离。在KNN和其他机器学习算法中，常用的距离计算公式包括欧氏距离和曼哈顿距离。两个向量之间，用不同的距离计算公式得出来的结果是不一样的。</p> 
<p>欧氏距离是欧几里得空间中两点间的“普通”(即直线)距离。在欧几里得空间中，点x=(x1, … ,xn)和点y=(y1, … ,yn)之间的欧氏距离为:<br> <img src="https://images2.imgbox.com/68/77/MhTXfhEJ_o.png" alt="在这里插入图片描述"></p> 
<p>曼哈顿距离，也叫方格线距离或城市区块距离，是两个点在标准坐标系上的绝对轴距的总和。!在欧几里得空间的固定直角坐标系上，曼哈顿距离的意义为两点所形成的线段对轴产生的投影的距离总和。在平面上，点x=(xi，.，!x.)和点y=(yi,.,yn)之间的曼哈顿距离为:<br> <img src="https://images2.imgbox.com/b2/ee/wfP8Ef9c_o.png" alt="在这里插入图片描述"></p> 
<p>下图的两个点之间，1、2与3线表示的各种曼哈顿距离长度都相同，而4线表示的则是欧氏距离。<br> <img src="https://images2.imgbox.com/8b/5c/zGEYSfDB_o.png" alt="在这里插入图片描述"></p> 
<p>下图中的两个特征，就形成了二维空间,图中心的问号代表一个未知类别的样本。如何归类呢，它是圆圈还是叉号?如果K=3，叉号所占比例大，问号样本将被判定为叉号类;如果K=7.则圆圈所占比例大，问号样本将被判定为圆圈类。</p> 
<p><img src="https://images2.imgbox.com/24/12/FIsl9Ey8_o.png" alt="在这里插入图片描述"></p> 
<p>因此，KNN算法的结果和K的取值有关系。要注意的是，KNN要找的邻居都是已经“站好队的人”，也就是已经正确分类的对象。</p> 
<h2><a id="SVM_30"></a>SVM</h2> 
<p><strong>用 SVM 计算的过程就是帮我们找到那个超平面的过程，这个超平面就是我们的 SVM 分类器。</strong></p> 
<p>主要说说超平面(hyperplane)和支持向量( support vector)这两个概念。超平面，就是用于特征空间根据数据的类别切分出来的分界平面。如下图所示的两个特征的二分类问题，我们就可以用一条线来表示超平面。如果特征再多一维，可以想象切割线会延展成一个平面，以此类推。而支持向量,就是离当前超平面最近的数据点，也就是下图中被分界线的两条平行线所切割的数据点，这些点对于超平面的进一步确定和优化最为重要。</p> 
<p>如下图所示，在一个数据集的特征空间中，存在很多种可能的类分割超平面。比如，图中的H0实线和两条虚线，都可以把数据集成功地分成两类。<br> <img src="https://images2.imgbox.com/15/f6/FVSh14d0_o.png" alt="在这里插入图片描述"></p> 
<p>是实线分割较好，因为这样的分界线离两个类中的支持向量都比较远。SVM算法就是要在支持向量的帮助之下，通过类似于梯度下降的优化方法，找到最优的分类超平面——具体的目标就是令支持向量到超平面之间的垂直距离最宽，称为“最宽街道”。</p> 
<p>那么目前的特征空间中有以下3条线。</p> 
<ul><li>H0就是目前的超平面。</li><li>与之平行的H1H₂线上的特征点就是支持向量。<br> 这3条线，由线性函数和其权重、偏置的值所确定:<br> <img src="https://images2.imgbox.com/92/03/mGCG6ZAb_o.png" alt="在这里插入图片描述"><br> 然后计算支持向量到超平面的垂直距离，并通过机器学习算法调整参数w和b，将距离(也就是特征空间中的这条街道宽度)最大化。这和线性回归寻找最优函数的斜率和截距的过程很相似。</li></ul> 
<p>普通的SVM分类超平面只能应对线性可分的情况，对于非线性的分类，SVM要通过核方法( kernel method)解决。核方法是机器学习中的一类算法，并非专用于SVM。它的思路是，首先通过某种非线性映射(核函数)对特征粒度进行细化，将原始数据的特征嵌入合适的更高维特征空间；然后，利用通用的线性模型在这个新的空间中分析和处理模式，这样，将在二维上线性不可分的问题在多维上变得线性可分，那么SVM就可以在此基础上找到最优分割超平面。</p> 
<h2><a id="_51"></a>朴素贝叶斯</h2> 
<p>朴素贝叶斯是一个通过条件概率进行分类的算法。</p> 
<p>所谓条件概率，就是在事件A发生的概率下B发生的概率。例如，男生(事件A)是烟民(事件B)的概率为30%,女生(事件A)是烟民(事件B)的概率为5%。这些事件A就是“已发生的事件”，也就是所谓“预设”，也就是条件。</p> 
<p>那么如何把条件概率引入机器学习呢?可以这么理解:数据集中数据样本的特征就形成了条件事件。比如:男，80岁，血压150mmHg，这3个已发生的事件，就是样本已知的特征。下面就需要进行二分类，确定患病还是未患病。此时我们拥有的信息量不多，怎么办呢?看一下训练数据集中满足这3个条件的数据有多少个，然后计算概率和计算分布。假如还有3个同样是80岁的男人，血压也是150mmHg，两个有心脏病，一个健康。此时算法就告诉我们，应该判断这个人也有心脏病的概率比较大。如果没有其他血压读数刚好是150的人呢?那就看看其他80岁的男人。如果10个人里面6个人都有心脏病，我们也只好推断此人有心脏病。<br> 这就是朴素贝叶斯的基本原理。它会假设每个特征都是相互独立的(这就是一个很强的预设)，然后计算每个类别下的各个特征的条件概率。条件概率的公式如下:</p> 
<p>在机器学习实践中，可以将上面的公式拆分成多个具体的特征:</p> 
<p>公式解释如下。<br> Ck，代表的是分类的具体类别k。<br> P(c｜x)是条件概率，也就是所要计算的，当特征为x时，类别为c的概率。<br> P(x l c)叫作似然(likelihood)，就是训练集中标签分类为c的情况下，特征为x的概率。<br> 比如，在垃圾电子邮件中，文本中含有“幸运抽奖”这个词的概率为0.2，换句话说，这个“0.2” 也就是“幸运抽奖”这个词出现在垃圾电子邮件中的似然。<br> P©，是训练集中分类为C的先验概率。比如,全部电子邮件中,垃圾电子邮件的概率为0.1。<br> P(x)，是特征的先验概率。</p> 
<p>为什么图中这两个公式不大一样，第二个公式没有P(x)了。<br> 因为在实践中，这个分母项在计算过程中会被忽略。因为这个P(x)，不管它的具体值多大，具体到一个特征向量，对于所有的分类e来说，这个值其实是固定的一并不随中K值的变化而改变。因此它是否存在，并不影响一个特定数据样本的归类。机器最后要做的，只是确保所求出的所有类的后验概率之和为1。这可以通过增加一个归一化参数<br> 实现。</p> 
<p>基本上，朴素贝叶斯是基于现有特征的概率对输入进行分类的，它的速度相当快，当没有太多数据并且需要快速得到结果时，朴素贝叶斯算法可以说是解决分类问题的良好选择。</p> 
<h2><a id="_78"></a>决策树</h2> 
<p>这个算法简单直观，很容易理解。它有点像是将一大堆的if… else 语句进行连接，直到最后得到想要的结果。算法中的各个节点是根据训练数据集中的特征形成的。大家要注意特征节点的选择不同时，可以生成很多不一样的决策树。”<br> “下图所示是一个相亲数据集和根据该数据集而形成的决策树。此处我们设定一个根节点，作为决策的起点，从该点出发，根据数据集中的特征和标签值给树分叉。”<br> <img src="https://images2.imgbox.com/58/e9/dJyj22LO_o.png" alt="在这里插入图片描述"></p> 
<p>为什么要选择相貌这个特征作为这棵决策树的根节点?，是因为熵。</p> 
<p>在信息学中，熵(entropy)，度量着信息的不确定性，信息的不确定性越大，熵越大。信息熵和事件发生的概率成反比。比如，“相亲者会认为这位先生很帅”这一句话的信息熵为0，因为这是事实。</p> 
<p>这里有几个新概念，下面介绍一下。</p> 
<ul><li>信息熵代表随机变量的复杂度，也就是不确定性。</li><li>条件熵代表在某一个条件下，随机变量的复杂度。</li><li>信息增益等于信息熵减去条件熵，它代表了在某个条件下，信息复杂度(不确定性)减少的程度。</li></ul> 
<p>因此，<strong>如果一个特征从不确定到确定，这个过程对结果影响比较大的话，就可以认为这个特征的分类能力比较强</strong>。那么先根据这个特征进行决策之后，对于整个数据集而言，熵(不确定性)减少得最多，<strong>也就是信息增益最大</strong>。相亲的时候你们最看中什么，就先问什么，如果先问相点，说明你们觉得相貌不合格则后面其他所有问题都不用再问了，当然你们的妈妈可能一般会先问收入。</p> 
<p>除了熵之外，还有Gini不纯度等度量信息不确定性的指标。</p> 
<p>决策树的深度和剪枝<br> 决策树算法有以下两个特点。<br> (1)由于if…else可以无限制地写下去，因此，针对任何训练集，只要树的深度足够，决策树肯定能够达到100%的准确率。这听起来像是个好消息。<br> (2)决策树非常容易过拟合。也就是说，在训练集上，只要分得足够细，就能得到100%的正确结果，然而在测试集上，准确率会显著下降。<br> 这种过拟合的现象在下图的这个二分类问题中就可以体现出来。决策树算法将每一个样本都根据标签值成功分类，图中的两种颜色就显示出决策树算法生成的分类边界。</p> 
<p>而实际上，当分类边界精确地绕过了每一个点时，过拟合已经发生了。根据直觉，那个被圆圈包围着的叉号并不需要被考虑，它只是一个特例。因此，树的最后几个分叉，也就是找到虚线框内叉号的决策过程都应该省略，才能够提高模型的泛化功能。解决的方法是为决策树进行剪枝(pruning)，有以下两种形式。</p> 
<ul><li>先剪枝:分支的过程中，熵减少的量小于某一个阈值时，就停止分支的创建。</li><li>后剪枝:先创建出完整的决策树，然后尝试消除多余的节点。</li></ul> 
<p>整体来说，决策树算法很直观，易于理解，因为它与人类决策思考的习惯是基本契合的，而且模型还可以通过树的形式可视化。此外，决策树还可以直接处理非数值型数据，不需要进行哑变量的转化，甚至可以直接处理含缺失值的数据。因此，决策树算法是应用较为广泛的算法。</p> 
<p>然而，它的缺点明显。首先，对于多特征的复杂分类问题效率很一般，而且容易过拟合。节点很深的树容易学习到高度不规则的模式，造成较大的方差，泛化能力弱。此外，决策树算法处理连续变量问题时效果也不太好。</p> 
<p>因为这些缺点，决策树很少独立作为一种算法被应用于实际问题。然而，一个非常微妙的事是，决策树经过集成的各种升级版的算法一随机森林、梯度提升树算法等,都是非常优秀的常用算法。</p> 
<h2><a id="_116"></a>随机森林</h2> 
<p>随机森林(random forest)是一种健壮且实用的机器学习算法，它是在决策树的基础上衍生而成的。决策树和随机森林的关系就是树和森林的关系。通过对原始训练样本的抽样，以及对特征节点的选择，我们可以得到很多棵不同的树。<br> 刚才说到决策树很容易过拟合,而随机森林的思路是把很多棵决策树的结果集成起来,以避免过拟合，同时提高准确率。其中，每一棵决策树都是在原始数据集中抽取不同子集进行训练的，尽管这种做法会小幅度地增加每棵树的预测偏差，但是最终对各棵树的预测结果进行综合平均之后的模型性能通常会大大提高。<br> 这就是随机森林算法的核心:或许每棵树都是一个非常糟糕的预测器，但是当我们将很多棵树的预测集中在一起考量时，很有可能会得到一个好的模型。<br> 假设我们有一个包含N个训练样本的数据集,特征的维度为M,随机森林通过下面算法构造树。<br> (1)从N个训练样本中以有放回抽样(replacement sampling)的方式，取样N次，形成一个新训练集(这种方法也叫bootstrap取样)，可用未抽到的样本进行预测，评估其误差。<br> (2)对于树的每一个节点，都随机选择m个特征(m是M的一个子集，数目远小于M)，决策树上每个节点的决定都只是基于这些特征确定的，即根据这m个特征，计算最佳的分裂方式。<br> (3)默认情况下，每棵树都会完整成长而不会剪枝。<br> 上述算法有两个关键点:一个是有放回抽样，二是节点生成时不总是考量全部特征。这两个关键点，都增加了树生成过程中的随机性，从而降低了过拟合。<br> 仅引入了一点小技巧，就形成了如此强大的随机森林算法。这就是算法之美，是机器学习之美。<br> 在Skleam 的随机森林分类器中，可以设定的一些的参数项如下。</p> 
<ul><li>n_estimators:要生成的树的数量。</li><li>criterion :信息增益指标，可选择gini(Gini不纯度)或者entropy(熵)。</li><li>bootstrap :可选择是否使用bootstrap方法取样，True或者False。如果选择False,则所有树都基于原始数据集生成。</li><li>max_features:通常由算法默认确定。对于分类问题，默认值是总特征数的平方根，即如果一共有9个特征，分类器会随机选取其中3个。</li></ul> 
<h2><a id="_134"></a></h2> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment">#导入NumPy数学工具箱</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd <span class="token comment">#导入Pandas数据处理工具箱</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"../数据集/BankCustomer.csv"</span><span class="token punctuation">)</span> <span class="token comment"># 读取文件</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 显示文件前5行</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d0/28/xI7NWqXX_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 构建特征和标签集</span>
y <span class="token operator">=</span> df<span class="token punctuation">.</span>Exited<span class="token punctuation">.</span>values
X <span class="token operator">=</span> df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Exited'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split  <span class="token comment"># 拆分训练集和测试集</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test_size <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># 进行特征缩放</span>
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> preprocessing
scaler <span class="token operator">=</span> preprocessing<span class="token punctuation">.</span>MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
X_train <span class="token operator">=</span> scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
X_test <span class="token operator">=</span> scaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>


<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> <span class="token punctuation">(</span>f1_score<span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">)</span> <span class="token comment"># 导入评估指标</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression <span class="token comment"># 导入逻辑回归模型</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> f1_score<span class="token punctuation">,</span> confusion_matrix <span class="token comment"># 导入评估标准</span>
lr <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 逻辑回归</span>
lr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span> <span class="token comment"># 训练模型</span>
y_pred <span class="token operator">=</span> lr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span> <span class="token comment"># 预测结果</span>
lr_acc <span class="token operator">=</span> lr<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># 准确率</span>
lr_f1 <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># F1分数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"逻辑回归测试集准确率： {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>lr_acc<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"逻辑回归测试集F1分数: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>lr_f1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'逻辑回归测试集混淆矩阵:\n'</span><span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/36/4e/Oey2EG6m_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neighbors <span class="token keyword">import</span> KNeighborsClassifier <span class="token comment"># 导入KNN算法</span>
k <span class="token operator">=</span> <span class="token number">5</span> <span class="token comment"># 设定初始K值为5</span>
knn <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span>n_neighbors <span class="token operator">=</span> k<span class="token punctuation">)</span>  <span class="token comment"># KNN模型</span>
knn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment"># 拟合KNN模型</span>
y_pred <span class="token operator">=</span> knn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span> <span class="token comment"># 预测结果</span>
knn_acc <span class="token operator">=</span> knn<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># 准确率</span>
knn_f1 <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># F1分数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{}NN 预测准确率: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> knn_acc<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{}NN 预测F1分数: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> knn_f1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'KNN 混淆矩阵:\n'</span><span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/31/16/yQKmR8Om_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVC <span class="token comment"># 导入SVM分类器</span>
svm <span class="token operator">=</span> SVC<span class="token punctuation">(</span>random_state <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># SVM模型</span>
svm<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment">#拟合SVM模型</span>
y_pred <span class="token operator">=</span> svm<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span> <span class="token comment"># 预测结果</span>
svm_acc <span class="token operator">=</span> svm<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># 准确率</span>
svm_f1 <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># F1分数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"SVM 预测准确率:: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>svm_acc<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"SVM 预测F1分数: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>svm_f1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'SVM 混淆矩阵:\n'</span><span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8c/72/BScTUUTn_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> GaussianNB <span class="token comment"># 导入模型</span>
nb <span class="token operator">=</span> GaussianNB<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 朴素贝叶斯模型</span>
nb<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment"># 拟合模型</span>
y_pred <span class="token operator">=</span> nb<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span> <span class="token comment"># 预测结果</span>
nb_acc <span class="token operator">=</span> nb<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># 准确率</span>
nb_f1 <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># F1分数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"朴素贝叶斯测试集准确率:: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>nb_acc<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"朴素贝叶斯测试集F1分数: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>nb_f1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'朴素贝叶斯混淆矩阵:\n'</span><span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/07/49/TMbIIkXi_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifier <span class="token comment"># 导入模型</span>
dt <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 分类决策树</span>
dt<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment"># 拟合模型</span>
y_pred <span class="token operator">=</span> dt<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span> <span class="token comment"># 预测结果</span>
dt_acc <span class="token operator">=</span> dt<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># 准确率</span>
dt_f1 <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># F1分数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"决策树测试集准确率:: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>dt_acc<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"决策树测试集F1分数: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>dt_f1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'决策树混淆矩阵:\n'</span><span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8b/f7/JI9mDIDH_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestClassifier <span class="token comment"># 导入模型</span>
rf <span class="token operator">=</span> RandomForestClassifier<span class="token punctuation">(</span>n_estimators <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 随机森林</span>
rf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment"># 拟合模型</span>
y_pred <span class="token operator">=</span> rf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span> <span class="token comment"># 预测结果</span>
rf_acc <span class="token operator">=</span> rf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># 准确率</span>
rf_f1 <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># F1分数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"随机森林 预测准确率:: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>rf_acc<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"随机森林 预测F1分数: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>rf_f1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'随机森林 混淆矩阵:\n'</span><span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">(</span> y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d5/9a/DcyUQbfh_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> xgboost <span class="token keyword">import</span> XGBClassifier
xgb <span class="token operator">=</span> XGBClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>
xgb<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment"># 拟合模型</span>
y_pred <span class="token operator">=</span> xgb<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span> <span class="token comment"># 预测结果</span>
xgb_acc <span class="token operator">=</span> xgb<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># 准确率</span>
xgb_f1 <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># F1分数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"XGB 预测准确率:: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>xgb_acc<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"XGB 预测F1分数: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>xgb_f1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'XGB 混淆矩阵:\n'</span><span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">(</span> y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/70/dd/2nWVAdy0_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> xgboost <span class="token keyword">import</span> XGBClassifier
xgb_c <span class="token operator">=</span> XGBClassifier<span class="token punctuation">(</span>max_depth<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> learning_rate<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span> n_estimators<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span> 
                    objective<span class="token operator">=</span><span class="token string">'binary:logistic'</span><span class="token punctuation">,</span> tree_method<span class="token operator">=</span><span class="token string">'hist'</span><span class="token punctuation">,</span> 
                    subsample<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span> colsample_bytree<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span> 
                    min_child_samples<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> eval_metric<span class="token operator">=</span><span class="token string">'auc'</span><span class="token punctuation">,</span> reg_lambda<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
<span class="token comment">#hist之前是gpu_hist，gpu_hist是需要用到gpu，而我们没有，所以去掉gpu</span>
xgb_c<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
y_pred <span class="token operator">=</span> xgb_c<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
xgb_c_acc <span class="token operator">=</span> xgb_c<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># 准确率</span>
xgb_c_f1 <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># F1分数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"xgb_c 预测准确率:: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>xgb_c_acc<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"xgb_c 预测F1分数: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>xgb_c_f1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'xgb_c 混淆矩阵:\n'</span><span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">(</span> y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2b/50/AIOC7iIP_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> lightgbm <span class="token keyword">import</span> LGBMClassifier
lgb <span class="token operator">=</span> LGBMClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>
lgb<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment"># 拟合模型</span>
y_pred <span class="token operator">=</span> lgb<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span> <span class="token comment"># 预测结果</span>
lgb_acc <span class="token operator">=</span> lgb<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># 准确率</span>
lgb_f1 <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># F1分数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"LGB 预测准确率:: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>lgb_acc<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"LGB 预测F1分数: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>lgb_f1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'LGB 混淆矩阵:\n'</span><span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">(</span> y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9d/93/1T6aPhM2_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> lightgbm <span class="token keyword">import</span> LGBMClassifier
lgb_c <span class="token operator">=</span> LGBMClassifier<span class="token punctuation">(</span>num_leaves<span class="token operator">=</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> reg_alpha<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span> reg_lambda<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span> 
                       objective<span class="token operator">=</span><span class="token string">'binary'</span><span class="token punctuation">,</span>max_depth<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> learning_rate<span class="token operator">=</span><span class="token number">0.005</span><span class="token punctuation">,</span> 
                       min_child_samples<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">2021</span><span class="token punctuation">,</span>
                       n_estimators<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span> subsample<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> colsample_bytree<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
lgb_c<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment"># 拟合模型</span>
y_pred <span class="token operator">=</span> lgb_c<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span> <span class="token comment"># 预测结果</span>
lgb_c_acc <span class="token operator">=</span> lgb_c<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># 准确率</span>
lgb_c_f1 <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># F1分数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"lgb_c 预测准确率:: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>lgb_c_acc<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"lgb_c 预测F1分数: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>lgb_c_f1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'lgb_c 混淆矩阵:\n'</span><span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">(</span> y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/15/16/Ol5OWg8n_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> catboost <span class="token keyword">import</span> CatBoostClassifier
cat <span class="token operator">=</span> CatBoostClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>
cat<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span> <span class="token comment"># 拟合模型</span>
y_pred <span class="token operator">=</span> cat<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span> <span class="token comment"># 预测结果</span>
cat_acc <span class="token operator">=</span> cat<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># 准确率</span>
cat_f1 <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># F1分数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Cat 预测准确率:: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>cat_acc<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Cat 预测F1分数: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>cat_f1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Cat 混淆矩阵:\n'</span><span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">(</span> y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/18/71/Ia52fEtR_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> catboost <span class="token keyword">import</span> CatBoostClassifier
cat_c <span class="token operator">=</span> CatBoostClassifier<span class="token punctuation">(</span>iterations<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token comment">#最大树数，即迭代次数</span>
                           depth <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token comment">#树的深度</span>
                           learning_rate <span class="token operator">=</span> <span class="token number">0.03</span><span class="token punctuation">,</span> <span class="token comment">#学习率</span>
                           custom_loss<span class="token operator">=</span><span class="token string">'AUC'</span><span class="token punctuation">,</span> <span class="token comment">#训练过程中，用户自定义的损失函数</span>
                           eval_metric<span class="token operator">=</span><span class="token string">'AUC'</span><span class="token punctuation">,</span> <span class="token comment">#过拟合检验（设置True）的评估指标，用于优化</span>
                           bagging_temperature<span class="token operator">=</span><span class="token number">0.83</span><span class="token punctuation">,</span> <span class="token comment">#贝叶斯bootstrap强度设置</span>
                           rsm <span class="token operator">=</span> <span class="token number">0.78</span><span class="token punctuation">,</span> <span class="token comment">#随机子空间</span>
                           od_type<span class="token operator">=</span><span class="token string">'Iter'</span><span class="token punctuation">,</span> <span class="token comment">#过拟合检查类型</span>
                           od_wait<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token comment">#使用Iter时，表示达到指定次数后，停止训练</span>
                           metric_period <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token comment">#计算优化评估值的频率</span>
                           l2_leaf_reg <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">#l2正则参数</span>
                           thread_count <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token comment">#并行线程数量</span>
                           random_seed <span class="token operator">=</span> <span class="token number">967</span> <span class="token comment">#随机数种子</span>
                          <span class="token punctuation">)</span>
cat_c<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
y_pred <span class="token operator">=</span> cat_c<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
cat_c_acc <span class="token operator">=</span> cat_c<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># 准确率</span>
cat_c_f1 <span class="token operator">=</span> f1_score<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token comment"># F1分数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"cat_c 预测准确率:: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>cat_c_acc<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"cat_c 预测F1分数: {:.2f}%"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>cat_c_f1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'cat_c 混淆矩阵:\n'</span><span class="token punctuation">,</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2d/f0/KO27tPhI_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 用直方图显示出各个算法的F1分数</span>
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
methods <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Logistic Regression"</span><span class="token punctuation">,</span> <span class="token string">"KNN"</span><span class="token punctuation">,</span> <span class="token string">"SVM"</span><span class="token punctuation">,</span> <span class="token string">"Naive Bayes"</span><span class="token punctuation">,</span> <span class="token string">"Decision Tree"</span><span class="token punctuation">,</span> 
           <span class="token string">"Random Forest"</span><span class="token punctuation">,</span> <span class="token string">"XGB"</span><span class="token punctuation">,</span> <span class="token string">"xgb_c"</span><span class="token punctuation">,</span><span class="token string">"LGB"</span><span class="token punctuation">,</span> <span class="token string">"lgb_c"</span><span class="token punctuation">,</span> <span class="token string">"cat"</span><span class="token punctuation">,</span> <span class="token string">"cat_c"</span><span class="token punctuation">]</span>
f1 <span class="token operator">=</span> <span class="token punctuation">[</span>lr_f1<span class="token punctuation">,</span> knn_f1<span class="token punctuation">,</span> svm_f1<span class="token punctuation">,</span> nb_f1<span class="token punctuation">,</span> dt_f1<span class="token punctuation">,</span> rf_f1<span class="token punctuation">,</span> xgb_f1<span class="token punctuation">,</span> xgb_c_f1<span class="token punctuation">,</span> lgb_f1<span class="token punctuation">,</span> lgb_c_f1<span class="token punctuation">,</span> cat_f1<span class="token punctuation">,</span> cat_c_f1<span class="token punctuation">]</span>
colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"orange"</span><span class="token punctuation">,</span><span class="token string">"red"</span><span class="token punctuation">,</span><span class="token string">"purple"</span><span class="token punctuation">,</span> <span class="token string">"magenta"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">,</span><span class="token string">"blue"</span><span class="token punctuation">]</span>
sns<span class="token punctuation">.</span>set_style<span class="token punctuation">(</span><span class="token string">"whitegrid"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"F1 Score"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Algorithms"</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span>methods<span class="token punctuation">,</span> y<span class="token operator">=</span>f1<span class="token punctuation">,</span> palette<span class="token operator">=</span>colors<span class="token punctuation">)</span>
<span class="token comment"># plt.grid(b=None)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b2/5b/ZgDnlfFx_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 用直方图显示出各个算法的F1分数 实现数值功能</span>
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
methods_f1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>

methods_f1<span class="token punctuation">[</span><span class="token string">'methods'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Logistic Regression"</span><span class="token punctuation">,</span> <span class="token string">"KNN"</span><span class="token punctuation">,</span> <span class="token string">"SVM"</span><span class="token punctuation">,</span> <span class="token string">"Naive Bayes"</span><span class="token punctuation">,</span> <span class="token string">"Decision Tree"</span><span class="token punctuation">,</span> 
                           <span class="token string">"Random Forest"</span><span class="token punctuation">,</span> <span class="token string">"XGB"</span><span class="token punctuation">,</span> <span class="token string">"xgb_c"</span><span class="token punctuation">,</span><span class="token string">"LGB"</span><span class="token punctuation">,</span> <span class="token string">"lgb_c"</span><span class="token punctuation">,</span> <span class="token string">"cat"</span><span class="token punctuation">,</span> <span class="token string">"cat_c"</span><span class="token punctuation">]</span>
methods_f1<span class="token punctuation">[</span><span class="token string">'f1'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>lr_f1<span class="token punctuation">,</span> knn_f1<span class="token punctuation">,</span> svm_f1<span class="token punctuation">,</span> nb_f1<span class="token punctuation">,</span> dt_f1<span class="token punctuation">,</span> rf_f1<span class="token punctuation">,</span> xgb_f1<span class="token punctuation">,</span> xgb_c_f1<span class="token punctuation">,</span> lgb_f1<span class="token punctuation">,</span> lgb_c_f1<span class="token punctuation">,</span> cat_f1<span class="token punctuation">,</span> cat_c_f1<span class="token punctuation">]</span>
colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"orange"</span><span class="token punctuation">,</span><span class="token string">"red"</span><span class="token punctuation">,</span><span class="token string">"purple"</span><span class="token punctuation">,</span> <span class="token string">"magenta"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">,</span><span class="token string">"blue"</span><span class="token punctuation">]</span>
sns<span class="token punctuation">.</span>set_style<span class="token punctuation">(</span><span class="token string">"whitegrid"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"F1 Score"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Algorithms"</span><span class="token punctuation">)</span>
g <span class="token operator">=</span> sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">"methods"</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">"f1"</span><span class="token punctuation">,</span> data<span class="token operator">=</span>methods_f1<span class="token punctuation">,</span> palette<span class="token operator">=</span>colors<span class="token punctuation">)</span>
<span class="token keyword">for</span> index<span class="token punctuation">,</span> row <span class="token keyword">in</span> methods_f1<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 第一个参数代表第几个柱子</span>
    <span class="token comment"># 第二个参数就传柱子代表的数量，相当于柱子的长度</span>
    g<span class="token punctuation">.</span>text<span class="token punctuation">(</span>index<span class="token punctuation">,</span> row<span class="token punctuation">.</span>f1<span class="token punctuation">,</span> <span class="token builtin">round</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span>f1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>

<span class="token comment"># plt.grid(b=None)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/8d/a8/wX9z1VNm_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 用直方图显示出各个算法的预测准确率</span>
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
methods <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Logistic Regression"</span><span class="token punctuation">,</span> <span class="token string">"KNN"</span><span class="token punctuation">,</span> <span class="token string">"SVM"</span><span class="token punctuation">,</span> <span class="token string">"Naive Bayes"</span><span class="token punctuation">,</span> <span class="token string">"Decision Tree"</span><span class="token punctuation">,</span> 
           <span class="token string">"Random Forest"</span><span class="token punctuation">,</span> <span class="token string">"XGB"</span><span class="token punctuation">,</span> <span class="token string">"xgb_c"</span><span class="token punctuation">,</span><span class="token string">"LGB"</span><span class="token punctuation">,</span> <span class="token string">"lgb_c"</span><span class="token punctuation">,</span> <span class="token string">"cat"</span><span class="token punctuation">,</span> <span class="token string">"cat_c"</span><span class="token punctuation">]</span>
acc <span class="token operator">=</span> <span class="token punctuation">[</span>lr_acc<span class="token punctuation">,</span> knn_acc<span class="token punctuation">,</span> svm_acc<span class="token punctuation">,</span> nb_acc<span class="token punctuation">,</span> dt_acc<span class="token punctuation">,</span> rf_acc<span class="token punctuation">,</span> xgb_acc<span class="token punctuation">,</span> xgb_c_acc<span class="token punctuation">,</span> lgb_acc<span class="token punctuation">,</span> lgb_c_acc<span class="token punctuation">,</span> cat_acc<span class="token punctuation">,</span> cat_c_acc<span class="token punctuation">]</span>
colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"orange"</span><span class="token punctuation">,</span><span class="token string">"red"</span><span class="token punctuation">,</span><span class="token string">"purple"</span><span class="token punctuation">,</span> <span class="token string">"magenta"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">,</span><span class="token string">"blue"</span><span class="token punctuation">]</span>
sns<span class="token punctuation">.</span>set_style<span class="token punctuation">(</span><span class="token string">"whitegrid"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Accurancy %"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Algorithms"</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span>methods<span class="token punctuation">,</span> y<span class="token operator">=</span>acc<span class="token punctuation">,</span> palette<span class="token operator">=</span>colors<span class="token punctuation">)</span>
<span class="token comment"># plt.grid(b=None)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/59/ae/j3Hb3lMj_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 用直方图显示出各个算法的预测准确率</span>
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
methods_acc <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
methods_acc<span class="token punctuation">[</span><span class="token string">'methods'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Logistic Regression"</span><span class="token punctuation">,</span> <span class="token string">"KNN"</span><span class="token punctuation">,</span> <span class="token string">"SVM"</span><span class="token punctuation">,</span> <span class="token string">"Naive Bayes"</span><span class="token punctuation">,</span> <span class="token string">"Decision Tree"</span><span class="token punctuation">,</span> 
                           <span class="token string">"Random Forest"</span><span class="token punctuation">,</span> <span class="token string">"XGB"</span><span class="token punctuation">,</span> <span class="token string">"xgb_c"</span><span class="token punctuation">,</span><span class="token string">"LGB"</span><span class="token punctuation">,</span> <span class="token string">"lgb_c"</span><span class="token punctuation">,</span> <span class="token string">"cat"</span><span class="token punctuation">,</span> <span class="token string">"cat_c"</span><span class="token punctuation">]</span>
methods_acc<span class="token punctuation">[</span><span class="token string">'acc'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>lr_acc<span class="token punctuation">,</span> knn_acc<span class="token punctuation">,</span> svm_acc<span class="token punctuation">,</span> nb_acc<span class="token punctuation">,</span> dt_acc<span class="token punctuation">,</span> rf_acc<span class="token punctuation">,</span> xgb_acc<span class="token punctuation">,</span> xgb_c_acc<span class="token punctuation">,</span> lgb_acc<span class="token punctuation">,</span> lgb_c_acc<span class="token punctuation">,</span> cat_acc<span class="token punctuation">,</span> cat_c_acc<span class="token punctuation">]</span>
colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"orange"</span><span class="token punctuation">,</span><span class="token string">"red"</span><span class="token punctuation">,</span><span class="token string">"purple"</span><span class="token punctuation">,</span> <span class="token string">"magenta"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">,</span><span class="token string">"blue"</span><span class="token punctuation">]</span>
sns<span class="token punctuation">.</span>set_style<span class="token punctuation">(</span><span class="token string">"whitegrid"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Accurancy %"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Algorithms"</span><span class="token punctuation">)</span>
g <span class="token operator">=</span> sns<span class="token punctuation">.</span>barplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">'methods'</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">'acc'</span><span class="token punctuation">,</span> palette<span class="token operator">=</span>colors<span class="token punctuation">,</span> data<span class="token operator">=</span>methods_acc<span class="token punctuation">)</span>
<span class="token keyword">for</span> index<span class="token punctuation">,</span> row <span class="token keyword">in</span> methods_acc<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 第一个参数代表第几个柱子</span>
    <span class="token comment"># 第二个参数就传柱子代表的数量，相当于柱子的长度</span>
    g<span class="token punctuation">.</span>text<span class="token punctuation">(</span>index<span class="token punctuation">,</span> row<span class="token punctuation">.</span>acc<span class="token punctuation">,</span> <span class="token builtin">round</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span>acc<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span> ha<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
<span class="token comment"># plt.grid(b=None)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a4/a2/41cCqXsg_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token comment"># 绘制各算法的混淆矩阵</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> confusion_matrix
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'SimHei'</span>
y_pred_lr <span class="token operator">=</span> lr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
kNN5 <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span>n_neighbors <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span>
kNN5<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>
y_pred_kNN5 <span class="token operator">=</span> kNN5<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
y_pred_svm <span class="token operator">=</span> svm<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
y_pred_nb <span class="token operator">=</span> nb<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
y_pred_dt <span class="token operator">=</span> dt<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
y_pred_rf <span class="token operator">=</span> rf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
y_pred_xgb <span class="token operator">=</span> xgb<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
y_pred_xgb_c <span class="token operator">=</span> xgb_c<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
y_pred_lgb <span class="token operator">=</span> lgb<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
y_pred_lgb_c <span class="token operator">=</span> lgb_c<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
y_pred_cat <span class="token operator">=</span> cat<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
y_pred_cat_c <span class="token operator">=</span> cat_c<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>

cm_lr <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred_lr<span class="token punctuation">)</span>
cm_kNN5 <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred_kNN5<span class="token punctuation">)</span>
cm_svm <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred_svm<span class="token punctuation">)</span>
cm_nb <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred_nb<span class="token punctuation">)</span>
cm_dt <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred_dt<span class="token punctuation">)</span>
cm_rf <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred_rf<span class="token punctuation">)</span>
cm_xgb <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred_xgb<span class="token punctuation">)</span>
cm_xgb_c <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred_xgb_c<span class="token punctuation">)</span>
cm_lgb <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred_lgb<span class="token punctuation">)</span>
cm_lgb_c <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred_lgb_c<span class="token punctuation">)</span>
cm_cat <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred_cat<span class="token punctuation">)</span>
cm_cat_c <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred_cat_c<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>suptitle<span class="token punctuation">(</span><span class="token string">"Confusion Matrixes"</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplots_adjust<span class="token punctuation">(</span>wspace <span class="token operator">=</span> <span class="token number">0.4</span><span class="token punctuation">,</span> hspace<span class="token operator">=</span> <span class="token number">0.4</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Logistic Regression Confusion Matrix"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>cm_lr<span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">"Blues"</span><span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">"d"</span><span class="token punctuation">,</span>cbar<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> annot_kws<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"size"</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"K Nearest Neighbors Confusion Matrix"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>cm_kNN5<span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">"Blues"</span><span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">"d"</span><span class="token punctuation">,</span>cbar<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> annot_kws<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"size"</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Support Vector Machine Confusion Matrix"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>cm_svm<span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">"Blues"</span><span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">"d"</span><span class="token punctuation">,</span>cbar<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> annot_kws<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"size"</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Naive Bayes Confusion Matrix"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>cm_nb<span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">"Blues"</span><span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">"d"</span><span class="token punctuation">,</span>cbar<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> annot_kws<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"size"</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Decision Tree Classifier Confusion Matrix"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>cm_dt<span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">"Blues"</span><span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">"d"</span><span class="token punctuation">,</span>cbar<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> annot_kws<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"size"</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Random Forest Confusion Matrix"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>cm_rf<span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">"Blues"</span><span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">"d"</span><span class="token punctuation">,</span>cbar<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> annot_kws<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"size"</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"XGBClassifier Confusion Matrix"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>cm_xgb<span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">"Blues"</span><span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">"d"</span><span class="token punctuation">,</span>cbar<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> annot_kws<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"size"</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"XGBClassifier_祖传参数 Confusion Matrix"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>cm_xgb_c<span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">"Blues"</span><span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">"d"</span><span class="token punctuation">,</span>cbar<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> annot_kws<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"size"</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"LGBMClassifier Confusion Matrix"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>cm_lgb<span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">"Blues"</span><span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">"d"</span><span class="token punctuation">,</span>cbar<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> annot_kws<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"size"</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"LGBMClassifier_祖传参数 Confusion Matrix"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>cm_lgb_c<span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">"Blues"</span><span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">"d"</span><span class="token punctuation">,</span>cbar<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> annot_kws<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"size"</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"CatBoostClassifier Confusion Matrix"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>cm_cat<span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">"Blues"</span><span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">"d"</span><span class="token punctuation">,</span>cbar<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> annot_kws<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"size"</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"CatBoostClassifier_祖传参数 Confusion Matrix"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>cm_cat_c<span class="token punctuation">,</span>annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">"Blues"</span><span class="token punctuation">,</span>fmt<span class="token operator">=</span><span class="token string">"d"</span><span class="token punctuation">,</span>cbar<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> annot_kws<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"size"</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/88/da/XanfriQD_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<p>学习机器学习的参考资料：<br> （1）书籍<br> 利用Python进行数据分析<br> 西瓜书<br> 百面机器学习<br> 机器学习实战<br> 阿里云天池大赛赛题解析(机器学习篇)<br> 白话机器学习中的数学<br> 零基础学机器学习<br> 图解机器学习算法<br> …</p> 
<p>（2）机构<br> 光环大数据<br> 开课吧<br> 极客时间<br> 七月在线<br> 深度之眼<br> 贪心学院<br> 拉勾教育<br> 博学谷<br> …</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f05a7adb2055fbe719a1d483e06e5f8c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Selenium教程11：模拟账号密码，自动登入qq空间</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2c898ce8b34480b3a9f92165b51fb6c1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringMVC-RESTFul</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>