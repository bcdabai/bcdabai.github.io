<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MySQL 用户权限和远程访问设置 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MySQL 用户权限和远程访问设置" />
<meta property="og:description" content="目录 一、用户操作查看当前拥有用户创建用户修改用户密码删除用户给root用户开放外网访问 二、用户权限操作授予权限的原则查看授予用户的权限给用户添加权限回收权限 一、用户操作 先要使用root用户登录MySQL后在执行后面操作
查看当前拥有用户 SELECT host,user,Grant_priv,Super_priv FROM mysql.user; 这里可以看到有两个root用户，但是运行访问host不同，一个host为localhost只能本地访问，一个host为%对所有ip开放访问。
创建用户 # 语法 CREATE USER &#39;用户名&#39;@&#39;host&#39; IDENTIFIED BY &#39;你的密码&#39;; # 例： # 创建test_01用户，赋予所有IP连接权限 # 如果只想给某个IP使用可以写成127.0.0.1，如果想给某个网段使用可以写成192.168.0.%，%代表全部 CREATE USER &#39;test_01&#39;@&#39;%&#39; IDENTIFIED BY &#39;123456&#39;; 修改用户密码 # MySQL8.0 ALTER USER &#39;用户名&#39;@&#39;host&#39; IDENTIFIED BY &#39;新密码&#39; PASSWORD EXPIRE NEVER; # MySQL8.0之前版本 SET password FOR &#39;用户名&#39;@&#39;host&#39; = password(&#39;新密码&#39;); 删除用户 # 语法 DROP USER &#39;用户名&#39;@&#39;host&#39;; # 例： # 删除用户名称为test_01 host为%的用户 DROP USER &#39;test_01&#39;@&#39;%&#39;; 给root用户开放外网访问 # 创建一个能被全部IP访问的root用户，MySQL相同用户名称但是host不同代表的是两个不同用户 CREATE USER &#39;root&#39;@&#39;%&#39; IDENTIFIED BY &#39;你的密码&#39;; # 赋予&#39;root&#39;@&#39;%&#39; 用户全部权限，和授权于下一个人用户权限的能力 GRANT ALL PRIVILEGES ON *." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/2e9270a6b3a0aa34060267001ee6f76e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-26T15:29:54+08:00" />
<meta property="article:modified_time" content="2023-09-26T15:29:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MySQL 用户权限和远程访问设置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">一、用户操作</a></li><li><ul><li><a href="#_4" rel="nofollow">查看当前拥有用户</a></li><li><a href="#_12" rel="nofollow">创建用户</a></li><li><a href="#_21" rel="nofollow">修改用户密码</a></li><li><a href="#_30" rel="nofollow">删除用户</a></li><li><a href="#root_39" rel="nofollow">给root用户开放外网访问</a></li></ul> 
   </li><li><a href="#_48" rel="nofollow">二、用户权限操作</a></li><li><ul><li><a href="#_49" rel="nofollow">授予权限的原则</a></li><li><a href="#_75" rel="nofollow">查看授予用户的权限</a></li><li><a href="#_85" rel="nofollow">给用户添加权限</a></li><li><a href="#_99" rel="nofollow">回收权限</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>一、用户操作</h3> 
<p>先要使用root用户登录MySQL后在执行后面操作</p> 
<h4><a id="_4"></a>查看当前拥有用户</h4> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> host<span class="token punctuation">,</span><span class="token keyword">user</span><span class="token punctuation">,</span>Grant_priv<span class="token punctuation">,</span>Super_priv <span class="token keyword">FROM</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c8/14/q865TUIN_o.png" alt="在这里插入图片描述"><br> 这里可以看到有两个root用户，但是运行访问host不同，一个host为localhost只能本地访问，一个host为%对所有ip开放访问。</p> 
<h4><a id="_12"></a>创建用户</h4> 
<pre><code class="prism language-sql"><span class="token comment"># 语法</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token string">'用户名'</span><span class="token variable">@'host'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'你的密码'</span><span class="token punctuation">;</span>
<span class="token comment"># 例：</span>
<span class="token comment"># 创建test_01用户，赋予所有IP连接权限</span>
<span class="token comment"># 如果只想给某个IP使用可以写成127.0.0.1，如果想给某个网段使用可以写成192.168.0.%，%代表全部</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token string">'test_01'</span><span class="token variable">@'%'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_21"></a>修改用户密码</h4> 
<pre><code class="prism language-sql"><span class="token comment"># MySQL8.0</span>
<span class="token keyword">ALTER</span> <span class="token keyword">USER</span> <span class="token string">'用户名'</span><span class="token variable">@'host'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'新密码'</span> PASSWORD EXPIRE NEVER<span class="token punctuation">;</span>
<span class="token comment"># MySQL8.0之前版本</span>
<span class="token keyword">SET</span> password <span class="token keyword">FOR</span> <span class="token string">'用户名'</span><span class="token variable">@'host'</span> <span class="token operator">=</span> password<span class="token punctuation">(</span><span class="token string">'新密码'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_30"></a>删除用户</h4> 
<pre><code class="prism language-sql"><span class="token comment"># 语法</span>
<span class="token keyword">DROP</span> <span class="token keyword">USER</span> <span class="token string">'用户名'</span><span class="token variable">@'host'</span><span class="token punctuation">;</span>
<span class="token comment"># 例：</span>
<span class="token comment"># 删除用户名称为test_01 host为%的用户</span>
<span class="token keyword">DROP</span> <span class="token keyword">USER</span> <span class="token string">'test_01'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="root_39"></a>给root用户开放外网访问</h4> 
<pre><code class="prism language-sql"><span class="token comment"># 创建一个能被全部IP访问的root用户，MySQL相同用户名称但是host不同代表的是两个不同用户</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token string">'root'</span><span class="token variable">@'%'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'你的密码'</span><span class="token punctuation">;</span>
<span class="token comment"># 赋予'root'@'%' 用户全部权限，和授权于下一个人用户权限的能力</span>
<span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'root'</span><span class="token variable">@'%'</span> <span class="token keyword">WITH</span> <span class="token keyword">GRANT</span> <span class="token keyword">OPTION</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="_48"></a>二、用户权限操作</h3> 
<h4><a id="_49"></a>授予权限的原则</h4> 
<p>（1）只授予能满足需要的最小权限 ，防止用户干坏事。比如用户只是需要查询，那就只给 select 权限就可以了，不要给用户赋予update 、 insert 或者 delete 权限</p> 
<p>（2）创建用户的时候限制用户的登录主机 ，一般是限制成指定 IP 或者内网IP 段。</p> 
<p>（3）为每个用户设置满足密码复杂度的密码 。</p> 
<p>（4）定期清理不需要的用户 ，回收权限或者删除用户。</p> 
<pre><code class="prism language-sql"><span class="token comment"># 授权语法：</span>
<span class="token comment"># 没有with GRANT option,被授权者无法授权于下一个人用户</span>
<span class="token keyword">GRANT</span> 权限列表 <span class="token keyword">on</span> 库名<span class="token punctuation">.</span>表名 <span class="token keyword">to</span> <span class="token string">'用户名'</span><span class="token variable">@'主机'</span> <span class="token punctuation">[</span><span class="token keyword">with</span> <span class="token keyword">GRANT</span> <span class="token keyword">option</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> 
<table><thead><tr><th>mysql用户常用权限列表</th><th>说明</th></tr></thead><tbody><tr><td>ALL 或者ALL PRIVILEGES</td><td>授予用户所有权限</td></tr><tr><td>CREATE</td><td>授予用户创建新数据库和表的权限</td></tr><tr><td>DROP</td><td>授予用户删除数据库和表的权限</td></tr><tr><td>DELETE</td><td>授予用户删除表中的行的权限</td></tr><tr><td>ALTER</td><td>授予用户修改表结构的权限</td></tr><tr><td>INSERT</td><td>授予用户在表中插入行（add）的权限</td></tr><tr><td>SELECT</td><td>授予用户运行select命令以从表中读取数据的权限</td></tr><tr><td>UPDATE</td><td>授予用户更新表中的数据的权限</td></tr></tbody></table> 
<h4><a id="_75"></a>查看授予用户的权限</h4> 
<pre><code class="prism language-sql"><span class="token comment"># 语法</span>
<span class="token keyword">SHOW</span> GRANTS <span class="token keyword">FOR</span> <span class="token string">'用户名'</span><span class="token variable">@'host'</span><span class="token punctuation">;</span>

<span class="token comment"># 例：查看用户名root host为%</span>
<span class="token keyword">SHOW</span> GRANTS <span class="token keyword">FOR</span> <span class="token string">'root'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_85"></a>给用户添加权限</h4> 
<p>添加权限后最好执行一下刷新权限操作 <code>FLUSH PRIVILEGES;</code>，避免添加权限后生效不及时</p> 
<pre><code class="prism language-sql"><span class="token comment"># 语法</span>
<span class="token keyword">GRANT</span> 权限类型 <span class="token keyword">ON</span> 库<span class="token punctuation">.</span>表 <span class="token keyword">TO</span> <span class="token string">'用户名'</span><span class="token variable">@'host'</span><span class="token punctuation">;</span>

<span class="token comment"># 例1：给用户test_01 host为%的用户赋予全部权限和所有的库所有的表</span>
<span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'test_01'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
<span class="token comment"># 例2：给用户test_01 host为%的用户赋予全部权限和所有的库所有的表，并且赋予具有授予下一个人权限的权利的授权</span>
<span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'test_01'</span><span class="token variable">@'%'</span> <span class="token keyword">WITH</span> <span class="token keyword">GRANT</span> <span class="token keyword">OPTION</span><span class="token punctuation">;</span>
<span class="token comment"># 例3：给用户test_02 host为%的用户赋予指定权限和指定库指定表</span>
<span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span><span class="token punctuation">,</span><span class="token keyword">INSERT</span> <span class="token keyword">ON</span> test_02_db<span class="token punctuation">.</span>test_02_table <span class="token keyword">TO</span> <span class="token string">'test_01'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_99"></a>回收权限</h4> 
<pre><code class="prism language-sql"><span class="token comment"># 语法</span>
<span class="token keyword">REVOKE</span> 权限类型 <span class="token keyword">ON</span> 数据库<span class="token punctuation">.</span>表 <span class="token keyword">FROM</span> <span class="token string">'用户名'</span><span class="token variable">@'host'</span><span class="token punctuation">;</span>

<span class="token comment"># 例1：回收赋权权限</span>
<span class="token keyword">REVOKE</span> <span class="token keyword">GRANT</span> <span class="token keyword">OPTION</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token string">'test_01'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
<span class="token comment"># 例1：回收用户所有库所有权限，不包含赋权权限</span>
<span class="token keyword">REVOKE</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token string">'test_01'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
<span class="token comment"># 例2：回收用户所有库的新增和修改权限</span>
<span class="token keyword">REVOKE</span> <span class="token keyword">INSERT</span><span class="token punctuation">,</span><span class="token keyword">UPDATE</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token string">'test_01'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
<span class="token comment"># 例3：回收用户指定数据库全部权限，前提是在赋权时只给这个用户赋予了test_01_db库的权限</span>
<span class="token keyword">REVOKE</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> test_01_db<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token string">'test_01'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1b48e52a8876cc7a3cf55aa39d724733/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">CentOS 安装 Docker</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9f0e06fd013f49561cbff09c7ecc732d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">大数据flink篇之二-基础实例wordcount</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>