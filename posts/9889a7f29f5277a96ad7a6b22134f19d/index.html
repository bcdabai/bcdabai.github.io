<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用 NFSv4 ACL 的文件系统 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用 NFSv4 ACL 的文件系统" />
<meta property="og:description" content="NFSv4 (Network File System – Version 4) 协议引入了一种新的 ACL（访问控制列表）格式，这种格式扩展了现有的其他 ACL 格式。NFSv4 ACL 很容易使用，还引入了更详细的文件安全属性，因此 NFSv4 ACL 更安全。IBM® AIX®、Sun Solaris 和 Linux® 等操作系统已经在文件系统中实现了 NFSv4 ACL。 当前，IBM AIX 5L version 5.3 和更高版本中支持 NFSv4 ACL 的文件系统是 NFSv4、JFS2 with EAv2 (Extended Journaled Filesystem with Extended Attributes format version 2) 和 General Parallel Filesystem (GPFS)。在 Sun Solaris 中，ZFS 支持这种 ACL 模型。在 RedHat Linux 中，NFSv4 支持 NFSv4 ACL。
什么是 ACL？
访问控制列表 (ACL) 用来指定文件系统对象（比如文件和目录）的访问权限。它是由许多访问控制项 (ACE) 组成的列表，每个访问控制项定义一个用户或组及其权限。
关于 ZFS ACL" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/9889a7f29f5277a96ad7a6b22134f19d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2009-11-04T09:49:00+08:00" />
<meta property="article:modified_time" content="2009-11-04T09:49:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用 NFSv4 ACL 的文件系统</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>    　NFSv4 (Network File System – Version 4) 协议引入了一种新的 ACL（访问控制列表）格式，这种格式扩展了现有的其他 ACL 格式。NFSv4 ACL 很容易使用，还引入了更详细的文件安全属性，因此 NFSv4 ACL 更安全。IBM® AIX®、Sun Solaris 和 Linux® 等操作系统已经在文件系统中实现了 NFSv4 ACL。 </p> 
<p>　　当前，IBM AIX 5L version 5.3 和更高版本中支持 NFSv4 ACL 的文件系统是 NFSv4、JFS2 with EAv2 (Extended Journaled Filesystem with Extended Attributes format version 2) 和 General Parallel Filesystem (GPFS)。在 Sun Solaris 中，ZFS 支持这种 ACL 模型。在 RedHat Linux 中，NFSv4 支持 NFSv4 ACL。</p> 
<p>　　什么是 ACL？</p> 
<p>　　访问控制列表 (ACL) 用来指定文件系统对象（比如文件和目录）的访问权限。它是由许多访问控制项 (ACE) 组成的列表，每个访问控制项定义一个用户或组及其权限。</p> 
<p>　　关于 ZFS ACL</p> 
<p>　　Sun 通过 Solaris 10 操作系统补丁包引入了 ZFS 文件系统。</p> 
<p>　　ZFS 支持 NFSv4 ACL 模型，并通过现有的 ls 和 chmod 命令的新选项实现了相关命令。可以使用 chmod 和 ls 命令设置和显示 ACL；没有引入新的命令。因此，在 ZFS 中使用 ACL 非常容易。</p> 
<p>　　ZFS ACL 格式</p> 
<p>　　ZFS ACL 采用一种定义良好的格式。这种格式和其中涉及的实体如下：</p> 
<p>　　语法 A</p> 
<p><code class="txcode">　　　　　　　　　<br>ACL_entry_type:Access_permissions/…/[:Inheritance_flags]:deny　or　allow　<br>　　　</code></p> 
<p>　　ACL_entry_type 包括 “owner@”、“group@” 或 “everyone@”。</p> 
<p>　　例如：</p> 
<p><code class="txcode">group@:write_data/append_data/execute:deny　</code></p> 
<p>　　语法 B</p> 
<p><code class="txcode">　　　　　　　　　<br>ACL_entry_type:　ACL_entry_ID:Access_permissions/…/[:Inheritance_flags]:deny　or　allow　<br>　　　</code></p> 
<p>　　ACL_entry_type 包括 “user” 或 “group”。</p> 
<p>　　ACL_entry_ID 包括 “user_name” 或 “group_name”。</p> 
<p>　　例如：</p> 
<p><code class="txcode">user:samy:list_Directory/read_data/execute:allow　</code></p> 
<p>　　继承标志</p> 
<p><code class="txcode">　　　　　　<br>f　:　FILE_INHERIT　<br>d　:　DIRECTORY_INHERIT　<br>i　:　INHERIT_ONLY　<br>n　:　NO_PROPAGATE_INHERIT　<br>S　:　SUCCESSFUL_ACCESS_ACE_FLAG　<br>F　:　FAILED_ACCESS_ACE_FLAG　</code></p> 
<p>　　列出 ZFS 文件和目录的 ACL</p> 
<p>　　可以使用带 -v 和 -V 选项的 ls 命令列出 ACL。使用 -d 选项列出目录的 ACL。</p> 
<p>操作命令列出文件的 ACL 项ls –[v | V] &lt;file_name&gt; 列出目录的 ACL 项ls –d[v | V] &lt;dir_name&gt; </p> 
<p>　　列出文件的 ACL 的示例</p> 
<p><code class="txcode">ls　-v　file.1　<br>-rw-r--r--　1　root　root　2703　Nov　4　12:37　file.1　<br>0:owner@:execute:deny　<br>1:owner@:read_data/write_data/append_data/write_xattr/write_attributes/　<br>　　　　write_acl/write_owner:allow　<br>2:group@:write_data/append_data/execute:deny　<br>3:group@:read_data:allow　<br>4:everyone@:write_data/append_data/write_xattr/execute/write_attributes/　<br>　　　　write_acl/write_owner:deny　<br>5:everyone@:read_data/read_xattr/read_attributes/read_acl/synchronize:allow　</code></p> 
<p>　　列出目录的 ACL 的示例</p> 
<p><code class="txcode">　　　　　<br>#　ls　-dv　dir.1　<br>drwxr-xr-x　2　root　root　2　Nov　1　14:51　dir.1　<br>0:owner@::deny　<br>1:owner@:list_directory/read_data/add_file/write_data/add_subdirectory/　<br>　　append_data/write_xattr/execute/write_attributes/write_acl/write_owner:allow　<br>2:group@:add_file/write_data/add_subdirectory/append_data:deny　<br>3:group@:list_directory/read_data/execute:allow　<br>4:everyone@:add_file/write_data/add_subdirectory/append_data/write_xattr　/　<br>　　write_attributes/write_acl/write_owner:deny　<br>5:everyone@:list_directory/read_data/read_xattr/execute/read_attributes　/　<br>　　read_acl/synchronize:allow　</code></p> 
<p>　　以紧凑格式列出 ACL 的示例</p> 
<p><code class="txcode">#　ls　-Vd　dir.1　<br>drwxr-xr-x　　2　root　　　root　　　　　　2　Sep　1　05:46　d　<br>　　owner@:--------------:------:deny　<br>　　owner@:rwxp---A-W-Co-:------:allow　<br>　　group@:-w-p----------:------:deny　<br>　　group@:r-x-----------:------:allow　<br>everyone@:-w-p---A-W-Co-:------:deny　<br>everyone@:r-xp--a-R-c--s:------:allow　</code></p> 
<p>　　在上面的示例中，以紧凑格式显示 ACL，也就是使用掩码显示访问权限和继承标志。每行显示一个 ACL 项，所以很容易理解。</p> 
<p>　　修改 ZFS 文件和目录的 ACL</p> 
<p>　　可以使用 chmod 命令设置或修改 ACL。chmod 命令使用 ACL 声明，其中包含前面给出的 ACL 格式（语法 A 或 B）。</p> 
<p>操作命令按索引 ID 添加 ACL 项# chmod Aindex_ID+acl_specification filename为用户添加 ACL 项# chmod A+acl_specification filename按索引 ID 删除 ACL 项# chmod Aindex_ID- filename按用户删除 ACL 项# chmod A-acl_specification filename删除文件的 ACL# chmod A- filename替换索引 ID 位置上的 ACL 项# chmod Aindex_ID=acl_specification filename替换文件的 ACL# chmod A=acl_specification filename</p> 
<p>　　修改 ZFS ACL 的示例</p> 
<p>　　列出 ACL 项</p> 
<p><code class="txcode">#　ls　–v　a　<br>-rw-r--r--　　1　root　　　root　　　　　　0　Sep　1　04:25　a　<br>0:owner@:execute:deny　<br>1:owner@:read_data/write_data/append_data/write_xattr/write_attributes/　<br>　　write_acl/write_owner:allow　<br>2:group@:write_data/append_data/execute:deny　<br>3:group@:read_data:allow　<br>4:everyone@:write_data/append_data/write_xattr/execute/write_attributes/　<br>　　write_acl/write_owner:deny　<br>5:everyone@:read_data/read_xattr/read_attributes/read_acl/synchronize:allow　<br>　<br>　</code></p> 
<p>　　添加 ACL 项</p> 
<p><code class="txcode">#　chmod　A+user:samy:read_data:allow　a　<br>#　ls　-v　a　<br>-rw-r--r--+　1　root　　　root　　　　　　0　Sep　1　02:01　a　<br>0:user:samy:read_data:allow　<br>1:owner@:execute:deny　<br>2:owner@:read_data/write_data/append_data/write_xattr/write_attributes/　<br>　　write_acl/write_owner:allow　<br>3:group@:write_data/append_data/execute:deny　<br>4:group@:read_data:allow　<br>5:everyone@:write_data/append_data/write_xattr/execute/write_attributes/　<br>　　write_acl/write_owner:deny　<br>6:everyone@:read_data/read_xattr/read_attributes/read_acl/synchronize:allow　<br>　<br>#　chmod　A1+user:samy:execute:deny　a　<br>#　ls　-v　a　<br>-rw-r--r--+　1　root　　　root　　　　　　0　Sep　1　02:01　a　<br>0:user:samy:read_data:allow　<br>1:user:samy:execute:deny　<br>2:owner@:execute:deny　<br>3:owner@:read_data/write_data/append_data/write_xattr/write_attributes/　<br>　　write_acl/write_owner:allow　<br>4:group@:write_data/append_data/execute:deny　<br>5:group@:read_data:allow　<br>6:everyone@:write_data/append_data/write_xattr/execute/write_attributes/　<br>　　write_acl/write_owner:deny　<br>7:everyone@:read_data/read_xattr/read_attributes/read_acl/synchronize:allow　<br>　</code></p> 
<p>　　替换 ACL 项</p> 
<p><code class="txcode">#　chmod　A0=user:samy:read_data/write_data:allow　a　<br>#　ls　-v　<br>total　2　<br>-rw-r--r--+　1　root　　　root　　　　　　0　Sep　1　02:01　a　<br>0:user:samy:read_data/write_data:allow　<br>1:user:samy:execute:deny　<br>2:owner@:execute:deny　<br>3:owner@:read_data/write_data/append_data/write_xattr/write_attributes/　<br>　　write_acl/write_owner:allow　<br>4:group@:write_data/append_data/execute:deny　<br>5:group@:read_data:allow　<br>6:everyone@:write_data/append_data/write_xattr/execute/write_attributes/　<br>　　write_acl/write_owner:deny　<br>7:everyone@:read_data/read_xattr/read_attributes/read_acl/synchronize:allow　<br>　<br>　<br>#　chmod　A=user:samy:read_data/write_data/append_data:allow　a　<br>#　ls　-v　a　<br>----------+　1　root　　　root　　　　　　0　Sep　1　02:01　a　<br>0:user:samy:read_data/write_data/append_data:allow　</code></p> 
<p>　　还可以使用掩码（而不是指定完整名称）修改 ACL。</p> 
<p>　　使用掩码修改 ACL 项</p> 
<p><code class="txcode">#　ls　-V　a　<br>-rw-r--r--+　1　root　　　root　　　　　　0　Sep　5　01:50　a　<br>user:samy:--------------:------:deny　<br>user:samy:rwx-----------:------:allow　<br>　　owner@:--x-----------:------:deny　<br>　　owner@:rw-p---A-W-Co-:------:allow　<br>　　group@:-wxp----------:------:deny　<br>　　group@:r-------------:------:allow　<br>everyone@:-wxp---A-W-Co-:------:deny　<br>everyone@:r-----a-R-c--s:------:allow　<br>　<br>#　chmod　A1=user:samy:rwxp:allow　a　<br>　<br>#　ls　-V　a　<br>-rw-r--r--+　1　root　　　root　　　　　　0　Sep　5　01:50　a　<br>user:samy:--------------:------:deny　<br>user:samy:rwxp----------:------:allow　<br>　　owner@:--x-----------:------:deny　<br>　　owner@:rw-p---A-W-Co-:------:allow　<br>　　group@:-wxp----------:------:deny　<br>　　group@:r-------------:------:allow　<br>everyone@:-wxp---A-W-Co-:------:deny　<br>everyone@:r-----a-R-c--s:------:allow　<br>　</code></p> 
<p>　　删除 ACL 项</p> 
<p><code class="txcode">#　ls　-v　a　<br>-rw-r-----+　1　root　　　root　　　　　　0　Sep　5　01:50　a　<br>0:user:samy:read_data/write_data/execute:allow　<br>1:owner@:execute:deny　<br>2:owner@:read_data/write_data/append_data/write_xattr/write_attributes/　<br>　　write_acl/write_owner:allow　<br>3:group@:write_data/append_data/execute:deny　<br>4:group@:read_data:allow　<br>5:everyone@:read_data/write_data/append_data/write_xattr/execute/　<br>　　write_attributes/write_acl/write_owner:deny　<br>6:everyone@:read_xattr/read_attributes/read_acl/synchronize:allow　<br>　<br>#　chmod　A-　a　<br>#　ls　-v　a　<br>-rw-r-----　　1　root　　　root　　　　　　0　Sep　5　01:50　a　<br>0:owner@:execute:deny　<br>1:owner@:read_data/write_data/append_data/write_xattr/write_attributes/　<br>　　write_acl/write_owner:allow　<br>2:group@:write_data/append_data/execute:deny　<br>3:group@:read_data:allow　<br>4:everyone@:read_data/write_data/append_data/write_xattr/execute/　<br>　　write_attributes/write_acl/write_owner:deny　<br>5:everyone@:read_xattr/read_attributes/read_acl/synchronize:allow　<br>　<br>#　chmod　A5-　a　<br>#　ls　-v　a　<br>-rw-r-----　　1　root　　　root　　　　　　0　Sep　5　01:50　a　<br>0:owner@:execute:deny　<br>1:owner@:read_data/write_data/append_data/write_xattr/write_attributes/　<br>　　write_acl/write_owner:allow　<br>2:group@:write_data/append_data/execute:deny　<br>3:group@:read_data:allow　<br>4:everyone@:read_data/write_data/append_data/write_xattr/execute/　<br>　　write_attributes/write_acl/write_owner:deny　<br>　<br>　</code></p> 
<p>　　关于 JFS2 ACL</p> 
<p>　　Enhanced Journaled File System (JFS2) 是基本 AIX 操作系统中内置的文件系统。要想在 JFS2 文件系统中支持 NFSv4 ACL，需要在创建文件系统时启用 “Extended Attribute Format - Version 2”。在创建文件系统之后，无法启用或禁用这个特性。 </p> 
<p>　　本文假设已经启用了 “Extended Attribute Format - Version 2”。</p> 
<p>　　JFS2 ACL 格式</p> 
<p>　　这种格式和其中涉及的实体如下：</p> 
<p>　　语法</p> 
<p><code class="txcode">IDENTITY　ACE_TYPE　ACE_MASK　INHERITANCE_AND_AUDIT_ATTRS　<br>　<br>　Where:　<br>　　IDENTITY　has　format:　'IDENTITY_type:IDENTITY_name(IDENTITY_who):'　<br>　　　　<br>　Where:　<br>　　IDENTITY_type　is　one　of　the　following:　<br>　　　u　:　user　<br>　　　g　:　group　<br>　　　s　:　special　who　string　(IDENTITY_who　must　be　a　special　who)　<br>　IDENTITY_name　=&gt;　user/group　name　<br>　IDENTITY_who　=&gt;　who　string　<br>　<br>　ACE_TYPE　is　one　of　the　following　ACE　Type:　<br>　　　a　:　allow　<br>　　　d　:　deny　<br>　　　l　:　alarm　<br>　　　u　:　audit　</code></p> 
<p>　　继承标志</p> 
<p><code class="txcode">INHERITANCE_AND_AUDIT_ATTRS　(Optional)　is　one　or　more　of　the　following:　<br>　　　fi　:　FILE_INHERIT　<br>　　　di　:　DIRECTORY_INHERIT　<br>　　　oi　:　INHERIT_ONLY　<br>　　　ni　:　NO_PROPAGATE_INHERIT　<br>　　　sf　:　SUCCESSFUL_ACCESS_ACE_FLAG　<br>　　　ff　:　FAILED_ACCESS_ACE_FLAG　</code></p> 
<p>　　列出 JFS2 文件和目录的 ACL</p> 
<p>　　JFS 提供下面这些与 ACL 相关的命令。</p> 
<p>操作命令显示文件的 ACLaclget &lt;filename&gt;设置文件的 ACLaclput [-i infile] [-t acl_type] [-v] &lt;filename&gt;编辑文件的 ACLacledit [-t acl_type] &lt;filename&gt;把文件的 ACL 从一种类型转换为另一种类型aclconvert [ -R ] -t &lt;acltype&gt; &lt;filename&gt;获取文件系统路径所支持的 ACL 类型aclgettypes &lt;filename&gt;</p> 
<p>　　在 JFS2 分区中，在默认情况下启用 AIX Classic (AIXC) ACL 而不是 NFSv4 ACL。需要把 AIXC ACL 转换为 NFS4。</p> 
<p>　　下面的命令列出 JFS2 分区中一个新文件的 ACL：</p> 
<p>　　显示 ACL</p> 
<p><code class="txcode">#　aclget　file1　<br>*　<br>*　ACL_type　　AIXC　<br>*　<br>attributes:　<br>base　permissions　<br>　　owner(root):　rw-　<br>　　group(system):　r--　<br>　　others:　r--　<br>extended　permissions　<br>　　disabled　</code></p> 
<p>　　在这个示例中，AIXC 表明这些是 AIX Classic ACL。</p> 
<p>　　要想转换为任何其他类型，需要了解这个文件系统支持的 ACL 类型。</p> 
<p>　　显示支持的 ACL 类型：</p> 
<p><code class="txcode">#　aclgettypes　file1　<br>Supported　ACL　types　are:　<br>　　　　AIXC　<br>　　　　NFS4　<br>　</code></p> 
<p>　　现在，可以把 AIXC ACL 转换为 NFS4： </p> 
<p>　　把 ACL 由 AIX Classic 形式转换为 NFSv4 形式</p> 
<p><code class="txcode">#　aclconvert　-t　NFS4　file1　<br>#　aclget　a　<br>*　<br>*　ACL_type　　NFS4　<br>*　<br>*　<br>*　Owner:　root　<br>*　Group:　system　<br>*　<br>s:(OWNER@):　　　a　　　　rwpRWaAdcCs　<br>s:(OWNER@):　　　d　　　　xo　<br>s:(GROUP@):　　　a　　　　rRadcs　<br>s:(GROUP@):　　　d　　　　wpWxACo　<br>s:(EVERYONE@):　a　　　　rRadcs　<br>s:(EVERYONE@):　d　　　　wpWxACo　<br>　</code></p> 
<p>　　修改 JFS2 文件和目录的 ACL</p> 
<p>　　可以使用 aclput 或 acledit 命令修改 ACL。设置 ACL 的最好方法是，首先使用 aclget 命令获取文件的 ACL，把它保存在文件中。然后，修改文件中的 ACL，使用 aclput –i &lt;input_acl_file&gt; 存储它们。</p> 
<p>　　acledit 命令使用一个编辑器显示和修改 ACL。在使用 acledit 命令之前，需要设置环境变量 EDITOR。</p> 
<p>　　为了避免每次在目录中添加文件时都要把 ACL 由 AIXC 类型转换为 NFS4，可以在目录中设置适当的继承标志。</p> 
<p>　　还可以使用前面的命令在 AIX 上管理 NFSv4 ACL。</p> 
<p>　　关于 GPFS ACL</p> 
<p>　　IBM General Parallel File System (GPFS) 是一种强大的集群文件系统。它提供集群环境所需的几个高级特性并在 AIX 和 Linux 上支持 NFSv4 ACL。</p> 
<p>　　GPFS ACL 格式</p> 
<p>　　GPFS 支持 NFS4 和 POSIX ACL 格式。 </p> 
<p>　　POSIX GPFS ACL 通常像下面这样：</p> 
<p>　　GPFS POSIX ACL</p> 
<p><code class="txcode">#owner:guest　<br>#group:usr　<br>user::rwxc　<br>group::rwx-　#effective:rw—　<br>other::--x-　<br>mask::rw-c　<br>user:samy:rwxc　#effective:rw-c　<br>group:audit:rwx-　#effective:rw--　<br>group:system:-w--　</code></p> 
<p>　　在这个示例中，除了一般的模式位 rwx 之外，还有新的 c 位，这是 GPFS 特有的，代表 ACL Control。如果为任何用户设置了这一位，用户就可以修改文件或目录的 ACL。 </p> 
<p>　　另外，注意 mask ACL 项。它不是任何用户或组的 ACL 项，而是一个筛选器，可以应用于所有组、所有用户和文件或目录的所有者组的 ACL。它代表这三者可以拥有的最大权限。注意，它不应用于所有者用户和其他项。 </p> 
<p>　　在前面的示例中，mask 设置为 rw-c。因此，这是其他用户可以拥有的最大权限，例如尽管 samy 的 ACL 是 rwxc，但是有效的 ALC 只是 rw-c。</p> 
<p>　　GPFS 中的 NFS4 ACL 格式</p> 
<p>　　在 GPFS ACL 的 NFS4 形式中，每个 ACL 项由三行组成。</p> 
<p>　　语法</p> 
<p><code class="txcode">Format　for　first　line:　<br>　<br>IDENTITY_TYPE:IDENTITY_NAME:PERMISSIONS_BITS:TYPE[:INHERITANCE_FLAGS]　<br>　<br>Where:　<br>　　IDENTITY_TYPE　is　one　of　the　following:　<br>　　user　　:　A　normal　user.　<br>　　group　　:　A　normal　Group.　<br>　　special　:　File　owning　owner,　group,　or　everyone.　<br>　<br>IDENTITY_NAME　is　one　of　the　following:　<br>　　If　IDENTITY_TYPE　is　user　or　group,　then　IDENTITY_NAME　is　name　of　user　or　group.　<br>　　If　IDENTITY_TYPE　is　special,　then　IDENTITY_NAME　is　either　“owner@”,　“group@”　<br>　　or　“everyone@”.　<br>　<br>PERMISSIONS　is　one　or　more　of　the　following:　<br>　　r　:　Read.　<br>　　w　:　Write.　<br>　　x　:　Execute.　<br>　　c　:　ACL　Control.　<br>　<br>TYPE　is　one　of　the　following:　<br>　　allow　<br>　　deny　<br>　<br>Next　2　lines　represent　the　list　of　access　permissions.　</code></p> 
<p>　　继承标志</p> 
<p><code class="txcode">INHERITANCE_FLAGS　is　one　or　more　of　the　following:　<br>　　FileInherit　<br>　　DirInherit　<br>　　InheritOnly　</code></p> 
<p>　　示例</p> 
<p><code class="txcode">group:staff:r-x-:allow　<br>(X)READ/LIST　(-)WRITE/CREATE　(-)MKDIR　(-)SYNCHRONIZE　(-)READ_ACL　　<br>　　(X)READ_ATTR　(-)READ_NAMED　<br>(-)DELETE　　(-)DELETE_CHILD　(-)CHOWN　(X)EXEC/SEARCH　(-)WRITE_ACL　<br>　　(-)WRITE_ATTR　(-)WRITE_NAMED　<br>　</code></p> 
<p>　　GPFS 中的 ACL 命令</p> 
<p>操作命令显示文件的 ACLmmgetacl &lt;filename&gt;添加、替换和删除 ACL 项mmputacl –i &lt;input_acl_file&gt; &lt;filename&gt;编辑文件的 ACLmmeditacl &lt;filename&gt;删除 ACL 项mmdelacl &lt;filename&gt;</p> 
<p>　　在默认情况下，文件包含 POSIX ACL。通过在 mmgetacl 命令中使用 -k nfs4 选项，可以把 POSIX ACL 显示为 NFS4 形式。可以使用 mmchfs &lt;device&gt; –k nfs4 把 GPFS 文件系统的默认 ACL 设置为 NFS4。</p> 
<p>　　在已经设置了 POSIX ACL 的文件上设置 NFS4 ACL，NFS4 ACL 就会覆盖原来的 ACL。</p> 
<p>　　ZFS、JFS2 和 GPFS ACL 操作比较</p> 
<p>　　ZFS 支持使用 ls 和 chmod 命令列出和修改 ACL。 </p> 
<p>　　在 JFSv2 with Extended Attributes v2 (JFS2 with EAv2) 中，可以使用 acl* 命令集列出和修改 ACL。在默认情况下，对于新创建的文件，只启用 AIX Classic ACL，NFS4 ACL 是禁用的。在这种情况下，在父目录上没有设置 ACL 继承标志。可以使用 aclconvert –t NFS4 &lt;path or file_name&gt; 命令启用 NFS4 ACL。 </p> 
<p>　　GPFS mmgetacl、mmputacl、mmdelacl 和 mmeditacl 命令用于 ACL 操作。</p> 
<p>操作ZFS 命令JFS2ea2 命令GPFS 命令显示文件的 ACLls –v &lt;file_name&gt;aclget &lt;file_name&gt;mmgetacl –knfs4 &lt;file_name&gt;添加 ACL 项chmod Aindex_ID+acl_specification &lt;file_name&gt;aclput –t NFS4 &lt;file_name&gt;mmputacl –i input_acl_file &lt;file_name&gt;　chmod A+acl_specification &lt;file_name&gt;acledit &lt;file_name&gt;mmeditacl &lt;file_name&gt;替换 ACL 项chmod Aindex_ID=acl_specification &lt;file_name&gt;acledit –t NFS4 &lt;file_name&gt;mmputacl –i input_acl_file &lt;file_name&gt;　chmod A=acl_specification &lt;file_name&gt;　mmeditacl &lt;file_name&gt;删除 ACL 项chmod Aindex_ID- filenameacledit &lt;file_name&gt;mmeditacl &lt;file_name&gt;　chmod A-acl_specification &lt;file_name&gt;　　　chmod A- &lt;file_name&gt;　　</p> 
<p>　　chmod 命令的效果</p> 
<p>　　对于 ZFS 文件，在使用 chmod 命令修改基本权限位时，并不删除扩展的或显式的 NFS ACL。在修改权限位时，相应地设置 NFS ACL，反之亦然。 </p> 
<p>　　对于 JFS2ea2 中的文件，只能使用 chmod 命令修改权限位，不能用它修改 ACL 中的位。chmod 命令只能修改 setuid、setgid 或 sticky 位，而不会影响 NFS ACL。如果试图修改任何 Unix® 权限位，那么所有 NFS ACL 都会丢失并设置相应的 AIXC ACL。</p> 
<p>　　对于 GPFS，使用 chmod 的结果是相似的。如果在 GPFS 文件系统上设置了 -k nfs4 选项，那么除 owner@、group@ 和 everyone@ 之外的所有 ACL 项都被删除。如果在 GPFS 文件系统上没有设置 -k nfs4，那么运行 chmod 会删除所有 NFS4 ACL，保留 owner@、group@ 和 everyone@ 的 POSIX ACL 项。 </p> 
<p>　　在 JFS2 上运行 chmod 命令的效果</p> 
<p><code class="txcode">#　aclget　a　<br>*　<br>*　ACL_type　　NFS4　<br>*　<br>*　<br>*　Owner:　root　<br>*　Group:　system　<br>*　<br>s:(OWNER@):　　　a　　　　rwpRWxaAdcCs　<br>s:(OWNER@):　　　d　　　　o　<br>s:(GROUP@):　　　a　　　　rRadcs　<br>s:(GROUP@):　　　d　　　　wpWxACo　<br>s:(EVERYONE@):　a　　　　rRadcs　<br>s:(EVERYONE@):　d　　　　wpWxACo　<br>　<br>#　chmod　744　a　<br>#　aclget　a　<br>*　<br>*　ACL_type　　AIXC　<br>*　<br>attributes:　<br>base　permissions　<br>owner(root):　rwx　<br>group(system):　r--　<br>others:　r--　<br>extended　permissions　<br>disabled　</code></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6efa5860ff14f18fce5a97d9b27af777/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">EXCEL 十进制角度转换为度分秒格式</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/08c5f01dd55553c2db223b6d504aec4f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">tc 流控脚本</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>