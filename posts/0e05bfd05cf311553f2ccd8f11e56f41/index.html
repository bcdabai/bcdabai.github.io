<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SQL高级查询 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SQL高级查询" />
<meta property="og:description" content="函数
是一个可反复使用的程序段
从其他的程序段中使用调用语句来执行这段程序
好处
减少编程的工作量，提高开发效率
提高代码的可重用性
SQL Server的内部函数
可以和SQL Server的SELECT语句联合使用
可以与UPDATE和INSERT语句一起使用
进行类型转换、日期处理、数学计算，实现系统功能
系统函数
获取有关SQL Server中对象和设置的系统信息
字符串函数
控制返回给用户的字符串
字符串函数
几乎所有信息都需要转换成字符串才能正确显示
使用“&#43;”运算符拼接两个字符串
日期函数
可以提取日期值中日、月以及年，并进行操作
日期函数
标准的日期字符串写法格式
“YYYY-MM-DD HH:MM:SS”或“YYYY-MM-DD”
聚合函数
用于对一组值执行计算，并返回单个值
如：求总和、平均值、最大或最小值等
SUM：求总和
AVG:求平均数
MAX：返回最大值
MIN：返回最小值
XOUNT：返回非空值的计数
分组查询
指将查询结果按条件分组，再使用聚合函数返回每一个组的汇总信息
SELECT select_list FROM table_name
GROUP BY column_name 对查询结果进行分组
HAVING search_conditions指定分组查询条件
比较HAVING子句和WHERE子句
过滤数据的时间
条件
WHERE子句
分组之前
不能包含聚合函数
HAVING子句
分组之后
经常包含聚合函数
同在一个SELECT语句中，执行顺序
WHEREàGROUP BYàHAVING
数学函数
用于对数值进行代数运算
如果一个查询需要对多个表进行操作，就称为联接查询
联接查询的结果集或结果称为表之间的联接
关系数据库查询的特征
通过各个表之间共同列的关联性查询数据
表的联接类型
内联接
只返回两个数据集合之间匹配关系的行（INNER JOIN）
外联接" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/0e05bfd05cf311553f2ccd8f11e56f41/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-15T19:35:43+08:00" />
<meta property="article:modified_time" content="2023-05-15T19:35:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SQL高级查询</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:.0001pt;text-align:justify;">函数</p> 
<p style="margin-left:.0001pt;text-align:justify;">是一个可反复使用的程序段</p> 
<p style="margin-left:.0001pt;text-align:justify;">从其他的程序段中使用调用语句来执行这段程序</p> 
<p style="margin-left:.0001pt;text-align:justify;">好处</p> 
<p style="margin-left:.0001pt;text-align:justify;">减少编程的工作量，提高开发效率</p> 
<p style="margin-left:.0001pt;text-align:justify;">提高代码的可重用性</p> 
<p style="margin-left:.0001pt;text-align:justify;">SQL Server的内部函数</p> 
<p style="margin-left:.0001pt;text-align:justify;">可以和SQL Server的SELECT语句联合使用</p> 
<p style="margin-left:.0001pt;text-align:justify;">可以与UPDATE和INSERT语句一起使用</p> 
<p style="margin-left:.0001pt;text-align:justify;"> 进行类型转换、日期处理、数学计算，实现系统功能</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">系统函数</p> 
<p style="margin-left:.0001pt;text-align:justify;">获取有关SQL Server中对象和设置的系统信息</p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" src="https://images2.imgbox.com/67/5c/i1qHU2aX_o.png"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;">字符串函数</p> 
<p style="margin-left:.0001pt;text-align:justify;">控制返回给用户的字符串</p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" src="https://images2.imgbox.com/a4/af/4yLyKFav_o.png"></p> 
<p>字符串函数</p> 
<p style="margin-left:.0001pt;text-align:justify;">几乎所有信息都需要转换成字符串才能正确显示</p> 
<p style="margin-left:.0001pt;text-align:justify;">使用“+”运算符拼接两个字符串</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">日期函数</p> 
<p style="margin-left:.0001pt;text-align:justify;">可以提取日期值中日、月以及年，并进行操作</p> 
<p style="margin-left:.0001pt;"><img alt="" src="https://images2.imgbox.com/e9/3c/jqTlwgl2_o.png">日期函数</p> 
<p style="margin-left:.0001pt;text-align:justify;">标准的日期字符串写法格式</p> 
<p style="margin-left:.0001pt;text-align:justify;">     “YYYY-MM-DD HH:MM:SS”或“YYYY-MM-DD”</p> 
<p style="margin-left:.0001pt;text-align:justify;">聚合函数</p> 
<p style="margin-left:.0001pt;text-align:justify;">用于对一组值执行计算，并返回单个值</p> 
<p style="margin-left:.0001pt;text-align:justify;">如：求总和、平均值、最大或最小值等</p> 
<p style="margin-left:.0001pt;text-align:justify;">SUM：求总和</p> 
<p style="margin-left:.0001pt;text-align:justify;">AVG:求平均数</p> 
<p style="margin-left:.0001pt;text-align:justify;">MAX：返回最大值</p> 
<p style="margin-left:.0001pt;text-align:justify;">MIN：返回最小值</p> 
<p style="margin-left:.0001pt;text-align:justify;">XOUNT：返回非空值的计数</p> 
<p style="margin-left:.0001pt;text-align:justify;">分组查询</p> 
<p style="margin-left:.0001pt;text-align:justify;">指将查询结果按条件分组，再使用聚合函数返回每一个组的汇总信息</p> 
<p style="margin-left:.0001pt;text-align:justify;">SELECT select_list FROM table_name</p> 
<p style="margin-left:.0001pt;text-align:justify;">GROUP BY column_name 对查询结果进行分组</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">HAVING search_conditions指定分组查询条件</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">比较HAVING子句和WHERE子句</p> 
<table border="1" cellspacing="0" style="margin-left:-1.8pt;width:480pt;"><tbody><tr><td style="background-color:#5b9bd5;width:160pt;"> <p style="margin-left:0;text-align:left;"></p> </td><td style="background-color:#5b9bd5;width:160pt;"> <p style="margin-left:0;text-align:left;"><strong><span style="color:#ffffff;"><strong>过滤数据的时间</strong></span></strong></p> </td><td style="background-color:#5b9bd5;width:160pt;"> <p style="margin-left:0;text-align:left;"><strong><span style="color:#ffffff;"><strong>条件</strong></span></strong></p> </td></tr><tr><td style="background-color:#d2deef;width:160pt;"> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">WHERE子句</span></p> </td><td style="background-color:#d2deef;width:160pt;"> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">分组之前</span></p> </td><td style="background-color:#d2deef;width:160pt;"> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">不能包含聚合函数</span></p> </td></tr><tr><td style="background-color:#eaeff7;width:160pt;"> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">HAVING子句</span></p> </td><td style="background-color:#eaeff7;width:160pt;"> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">分组之后</span></p> </td><td style="background-color:#eaeff7;width:160pt;"> <p style="margin-left:0;text-align:left;"><span style="color:#000000;">经常包含聚合函数</span></p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">同在一个SELECT语句中，执行顺序</p> 
<p style="margin-left:.0001pt;text-align:justify;">WHEREàGROUP BYàHAVING</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">数学函数</p> 
<p style="margin-left:.0001pt;text-align:justify;">用于对数值进行代数运算</p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" src="https://images2.imgbox.com/3f/04/kKte5SvV_o.png"></p> 
<p></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">如果一个查询需要对多个表进行操作，就称为联接查询</p> 
<p style="margin-left:.0001pt;text-align:justify;">联接查询的结果集或结果称为表之间的联接</p> 
<p style="margin-left:.0001pt;text-align:justify;">关系数据库查询的特征</p> 
<p style="margin-left:.0001pt;text-align:justify;">通过各个表之间共同列的关联性查询数据</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">表的联接类型</p> 
<p style="margin-left:.0001pt;text-align:justify;">内联接</p> 
<p style="margin-left:.0001pt;text-align:justify;">只返回两个数据集合之间匹配关系的行（INNER JOIN）</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">外联接</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;">左外联接</p> 
<p style="margin-left:.0001pt;text-align:justify;">结果集包括左表的所有行（LEFT JOIN）</p> 
<p style="margin-left:.0001pt;text-align:justify;">右外联接</p> 
<p style="margin-left:.0001pt;text-align:justify;">结果集包括右表的所有行（RIGHT JOIN）</p> 
<p style="margin-left:.0001pt;text-align:justify;">完整外联接</p> 
<p style="margin-left:.0001pt;text-align:justify;">返回左表和右表中的所有行（FULL JOIN）</p> 
<p style="margin-left:.0001pt;text-align:justify;">交叉联接</p> 
<p style="margin-left:.0001pt;text-align:justify;">返回左表与右表每个联接的所有行</p> 
<p style="margin-left:.0001pt;text-align:justify;"></p> 
<p style="margin-left:.0001pt;text-align:justify;"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/60db721dbf75f7120d6f8a8d87c3e33a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">详解c&#43;&#43;STL—string组件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f6ff28ae5e50abf3efd10869a4f7d237/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">wps删除分节符导致前面格式变乱的解决方案</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>