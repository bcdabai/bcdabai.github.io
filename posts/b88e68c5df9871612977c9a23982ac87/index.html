<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java将Word转换成PDF三种方法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java将Word转换成PDF三种方法" />
<meta property="og:description" content="网上有很多将Word转换成PDF的方式，这里找了三种比较简单的工具：poi、jacob和aspose。
1.POI 依赖
&lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt; &lt;version&gt;3.17&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt; &lt;artifactId&gt;fr.opensagres.poi.xwpf.converter.pdf-gae&lt;/artifactId&gt; &lt;version&gt;2.0.1&lt;/version&gt; &lt;/dependency&gt; 工具类
FileInputStream fileInputStream = new FileInputStream(&#34;F:\poi笔记.docx&#34;); XWPFDocument xwpfDocument = new XWPFDocument(fileInputStream); PdfOptions pdfOptions = PdfOptions.create(); FileOutputStream fileOutputStream = new FileOutputStream(&#34;F:\poi笔记.pdf&#34;); PdfConverter.getInstance().convert(xwpfDocument,fileOutputStream,pdfOptions); fileInputStream.close(); fileOutputStream.close(); 2.jacob jacob 缺点：需要 window 环境，而且速度是最慢的需要安装 msofficeWord 以及 SaveAsPDFandXPS.exe ( word 的一个插件，用来把 word 转化为 pdf )
开发流程：
SaveAsPDFandXPS 下载地址： http://www.microsoft.com/zh-cn/download/details.aspx?id=7
jacob 包下载地址： http://sourceforge.net/projects/jacob-project/
1、安装SaveAsPDFandXPS
2、下载 jacob 解压后存放路径：
jacob.jar 放在 C:Program FilesJavajdk1.8.0_171jrelibext目录下
jacob.dll 放在 C:Program FilesJavajdk1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b88e68c5df9871612977c9a23982ac87/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-28T13:15:54+08:00" />
<meta property="article:modified_time" content="2022-07-28T13:15:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java将Word转换成PDF三种方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>网上有很多将Word转换成PDF的方式，这里找了三种比较简单的工具：poi、jacob和aspose。</p> 
<h2><a id="1POI_4"></a>1.POI</h2> 
<p><strong>依赖</strong></p> 
<pre><code>&lt;dependency&gt;
	&lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
	&lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;
	&lt;version&gt;3.17&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
	&lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
	&lt;artifactId&gt;fr.opensagres.poi.xwpf.converter.pdf-gae&lt;/artifactId&gt;
	&lt;version&gt;2.0.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> 
<p><strong>工具类</strong></p> 
<pre><code>FileInputStream fileInputStream = new FileInputStream("F:\poi笔记.docx");
XWPFDocument xwpfDocument = new XWPFDocument(fileInputStream);
PdfOptions pdfOptions = PdfOptions.create();
FileOutputStream fileOutputStream = new FileOutputStream("F:\poi笔记.pdf");
PdfConverter.getInstance().convert(xwpfDocument,fileOutputStream,pdfOptions);
fileInputStream.close();
fileOutputStream.close();
</code></pre> 
<h2><a id="2jacob_34"></a>2.jacob</h2> 
<p>jacob 缺点：需要 window 环境，而且速度是最慢的需要安装 msofficeWord 以及 SaveAsPDFandXPS.exe ( word 的一个插件，用来把 word 转化为 pdf )</p> 
<p><strong>开发流程：</strong></p> 
<p>SaveAsPDFandXPS 下载地址： <a href="http://www.microsoft.com/zh-cn/download/details.aspxid=7" rel="nofollow">http://www.microsoft.com/zh-cn/download/details.aspx?id=7</a></p> 
<p>jacob 包下载地址： <a href="http://sourceforge.net/projects/jacob-project/" rel="nofollow">http://sourceforge.net/projects/jacob-project/</a><br> 　　1、安装SaveAsPDFandXPS<br> 　　2、下载 jacob 解压后存放路径：<br> 　　　　jacob.jar 放在 C:Program FilesJavajdk1.8.0_171jrelibext目录下<br> 　　　 jacob.dll 放在 C:Program FilesJavajdk1.8.0_171jrein 目录下</p> 
<p><strong>工具类</strong></p> 
<pre><code>public class Word2PdfJacobUtil {
 
	/* 转PDF格式值 */
	private static final int wdFormatPDF = 17;
	/**
	 * Word文档转换
	 * 
	 * @param inputFile
	 * @param pdfFile
	 */
	public static boolean word2PDF(String inputFile, String pdfFile) {
		ComThread.InitMTA(true);
	    long start = System.currentTimeMillis();
	    ActiveXComponent app = null;
	    Dispatch doc = null;
	    try {
	        app = new ActiveXComponent("Word.Application");// 创建一个word对象
	        app.setProperty("Visible", new Variant(false)); // 不可见打开word
	        app.setProperty("AutomationSecurity", new Variant(3)); // 禁用宏
	        Dispatch docs = app.getProperty("Documents").toDispatch();// 获取文挡属性
 
	        System.out.println("打开文档 &gt;&gt;&gt; " + inputFile);
	        // Object[]第三个参数是表示“是否只读方式打开”
	        // 调用Documents对象中Open方法打开文档，并返回打开的文档对象Document
	        doc = Dispatch.call(docs, "Open", inputFile, false, true).toDispatch();
	        System.out.println("转换文档 [" + inputFile + "] &gt;&gt;&gt; [" + pdfFile + "]");
            // 调用Document对象的SaveAs方法，将文档保存为pdf格式
            // word保存为pdf格式宏，值为17
            Dispatch.call(doc, "SaveAs", pdfFile, wdFormatPDF);// word保存为pdf格式宏，值为17
 
	        long end = System.currentTimeMillis();
 
	        System.out.println("用时：" + (end - start) + "ms.");
	        return true;
	    } catch (Exception e) {
	        e.printStackTrace();
	        System.out.println("========Error:文档转换失败：" + e.getMessage());
	    } finally {
	        Dispatch.call(doc, "Close", false);
	        System.out.println("关闭文档");
	        if (app != null)
	            app.invoke("Quit", new Variant[] {});
            // 如果没有这句话,winword.exe进程将不会关闭
            ComThread.Release();
            ComThread.quitMainSTA();
        }
	    return false;
	}
	}
</code></pre> 
<p><strong>测试运行：</strong></p> 
<pre><code>public static void main(String[] arg){
		String docPath = "C:\Users\Administrator\Desktop\test.docx";
		String pdfPath = "C:\Users\Administrator\Desktop\test.pdf";
        boolean res = Word2PdfJacobUtil.word2PDF(docPath, pdfPath);
        System.out.println(res);
}
</code></pre> 
<p><strong>结果如下：</strong><br> <img src="https://images2.imgbox.com/5a/20/n2kyXUBL_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="3aspose_115"></a>3.aspose</h2> 
<p>当文档中含有中文字符时，该段代码的执行需要调用操作系统的本地字体库支持，否则所有中文字符都将乱码。</p> 
<p>该段代码如果想要在Linux服务器上完美运行，需要给Linux服务器安装中文字体库</p> 
<p>如何在Linux环境安装Windows字体库，将在本人的另一篇文章里详细讲解<br> <a href="https://blog.csdn.net/neulily2005/article/details/106003527">Java使用Spire.Pdf或Aspose-Words实现Word转换Pdf在Linux服务器上的中文乱码问题</a></p> 
<p>建议将jar包下载下来并上传私服里去<br> <strong>依赖</strong></p> 
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;com.aspose&lt;/groupId&gt;
    &lt;artifactId&gt;aspose-words&lt;/artifactId&gt;
    &lt;version&gt;15.8.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> 
<p>使用aspose不需要像jacob那样往jdk里加入ddl文件，但是需要在项目里加入一个license.xml，不然生成的pdf会有水印<br> <strong>license.xml如下：</strong></p> 
<pre><code>&lt;?xml version="1.0" encoding="UTF-8" ?&gt; 
&lt;License&gt;
  &lt;Data&gt;
    &lt;Products&gt;
      &lt;Product&gt;Aspose.Total for Java&lt;/Product&gt;
      &lt;Product&gt;Aspose.Words for Java&lt;/Product&gt;
    &lt;/Products&gt;
    &lt;EditionType&gt;Enterprise&lt;/EditionType&gt;
    &lt;SubscriptionExpiry&gt;20991231&lt;/SubscriptionExpiry&gt;
    &lt;LicenseExpiry&gt;20991231&lt;/LicenseExpiry&gt;
    &lt;SerialNumber&gt;8bfe198c-7f0c-4ef8-8ff0-acc3237bf0d7&lt;/SerialNumber&gt;
  &lt;/Data&gt;
  &lt;Signature&gt;sNLLKGMUdF0r8O1kKilWAGdgfs2BvJb/2Xp8p5iuDVfZXmhppo+d0Ran1P9TKdjV4ABwAgKXxJ3jcQTqE/2IRfqwnPf8itN8aFZlV3TJPYeD3yWE7IT55Gz6EijUpC7aKeoohTb4w2fpox58wWoF3SNp6sK6jDfiAUGEHYJ9pjU=&lt;/Signature&gt;
&lt;/License&gt;
</code></pre> 
<p><strong>工具类：</strong></p> 
<pre><code>public class Word2PdfAsposeUtil {
 
	
	public static boolean getLicense() {
        boolean result = false;  
        try {  
            InputStream is = Test.class.getClassLoader().getResourceAsStream("\license.xml"); // license.xml应放在..WebRootWEB-INFclasses路径下
            License aposeLic = new License();  
            aposeLic.setLicense(is);  
            result = true;  
        } catch (Exception e) {
            e.printStackTrace();  
        }  
        return result;  
    }  
  
    public static boolean doc2pdf(String inPath, String outPath) {
        if (!getLicense()) { // 验证License 若不验证则转化出的pdf文档会有水印产生  
            return false;  
        }
        FileOutputStream os = null;
        try {  
            long old = System.currentTimeMillis();
            File file = new File(outPath); // 新建一个空白pdf文档
            os = new FileOutputStream(file);
            Document doc = new Document(inPath); // Address是将要被转化的word文档  
            doc.save(os, SaveFormat.PDF);// 全面支持DOC, DOCX, OOXML, RTF HTML, OpenDocument, PDF,  
                                         // EPUB, XPS, SWF 相互转换  
            long now = System.currentTimeMillis();
            System.out.println("pdf转换成功，共耗时：" + ((now - old) / 1000.0) + "秒"); // 转化用时
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }finally {
            if (os != null) {
                try {
                    os.flush();
                    os.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }
        return true;
    }  
  }
</code></pre> 
<p><strong>测试运行：</strong></p> 
<pre><code> public static void main(String[] arg){
        String docPath = "C:\Users\Administrator\Desktop\test.docx";
        String pdfPath = "C:\Users\Administrator\Desktop\test.pdf";
        Word2PdfAsposeUtil.doc2pdf(docPath,pdfPath);
}
</code></pre> 
<p><strong>结果：</strong><br> <img src="https://images2.imgbox.com/2a/b8/oeB7rrTK_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="jacobasposejar_216"></a>jacob和aspose相关jar下载</h2> 
<p>链接：<a href="https://pan.baidu.com/s/1D10sJOihQc551tZPv9uWwQ" rel="nofollow">https://pan.baidu.com/s/1D10sJOihQc551tZPv9uWwQ</a><br> 提取码：zsgg</p> 
<p>微信扫一扫即可获取文件（已包含提取码）<br> <img src="https://images2.imgbox.com/c3/68/gAS4xqwH_o.png" alt="微信扫一扫即可获取文件"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/01c758378b7b8ef0f0dda7b016d192d1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Apollo7.0系统概述</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/978d27f67182fdb8b865130ba4d6e972/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">JAVA 获取当前时间（年月日时分秒） 时间戳转换</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>