<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MySQL基础-17 事物的介绍 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MySQL基础-17 事物的介绍" />
<meta property="og:description" content="事物的介绍 1 TCL 语言 transaction Control language 事务控制语言
2 事务 一个或一组sql 语句组成一个执行单元，这个执行单元要么全部执行要么全部不执行。
3 事务的属性（ACID） 原子性（Atomicity）
原子性指事务是一个不可分割的工作单位，事务中的操作要么都发生，要么都不发生。一致性（Consistency）
事务必须使数据库从一个一致性状态变换到另外一个一致性状态。隔离性（Isolation）
事务隔离性指一个事务的执行不能被其他事务干扰，即一个事务内部操作及使用的数据对并发的其他事务是隔离的，并发执行的各个事务之间不能互相干扰。持久性（Durability）
持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的，接下来的其他操作和数据故障不应该对其有任何影响。 4 事务的创建 分类：
隐式事务：事务没有明显的开启和结束的标记，比如：insert,update,delete 语句。显示事务：有明显的开启和结束的标记，前提：必须设置自动提交事务功能为禁用：set autocommit=0; #查看事务是否开启 SHOW VARIABLES LIKE &#39;autocommit&#39;; 步骤1：开启事务 SET autocommit=0; START TRANSACTION; #可选的 步骤2:编写事务中的sql语句步骤3：结束事务
commit; 提交事务
callback;回滚事务
savepoint 节点名; 设置保存点 案例
CREATE TABLE account( id INT PRIMARY KEY AUTO_INCREMENT, username VARCHAR(20), balance DOUBLE ); INSERT INTO account(username,balance) VALUES(&#39;张无忌&#39;,1000),(&#39;赵敏&#39;,1000); #开启事务 SET autocommit=0; START TRANSACTION; #编写一组事务 UPDATE account SET balance=500 WHERE username=&#39;张无忌&#39;; UPDATE account SET balance=1500 WHERE username=&#39;赵敏&#39;; #结束事务 COMMIT; SELECT * FROM account 演示 savepoint 的使用" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/65f0defea73c73361a1574eaead8a784/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-16T09:15:00+08:00" />
<meta property="article:modified_time" content="2022-05-16T09:15:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MySQL基础-17 事物的介绍</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>事物的介绍</h2> 
<h2><a id="1_TCL__1"></a>1 TCL 语言</h2> 
<p>transaction Control language 事务控制语言</p> 
<h2><a id="2__4"></a>2 事务</h2> 
<p>一个或一组sql 语句组成一个执行单元，这个执行单元要么全部执行要么全部不执行。</p> 
<h2><a id="3_ACID_7"></a>3 事务的属性（ACID）</h2> 
<ol><li>原子性（Atomicity）<br> 原子性指事务是一个不可分割的工作单位，事务中的操作要么都发生，要么都不发生。</li><li>一致性（Consistency）<br> 事务必须使数据库从一个一致性状态变换到另外一个一致性状态。</li><li>隔离性（Isolation）<br> 事务隔离性指一个事务的执行不能被其他事务干扰，即一个事务内部操作及使用的数据对并发的其他事务是隔离的，并发执行的各个事务之间不能互相干扰。</li><li>持久性（Durability）<br> 持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的，接下来的其他操作和数据故障不应该对其有任何影响。</li></ol> 
<h2><a id="4__17"></a>4 事务的创建</h2> 
<p>分类：</p> 
<ul><li>隐式事务：事务没有明显的开启和结束的标记，比如：insert,update,delete 语句。</li><li>显示事务：有明显的开启和结束的标记，前提：必须设置自动提交事务功能为禁用：set autocommit=0;</li></ul> 
<pre><code class="prism language-sql"><span class="token comment">#查看事务是否开启</span>
<span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">'autocommit'</span><span class="token punctuation">;</span>
</code></pre> 
<ol><li>步骤1：开启事务</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SET</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span> <span class="token comment">#可选的</span>
</code></pre> 
<ol start="2"><li>步骤2:编写事务中的sql语句</li><li>步骤3：结束事务<br> commit; 提交事务<br> callback;回滚事务<br> savepoint 节点名; 设置保存点</li></ol> 
<p>案例</p> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> account<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	username <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	balance <span class="token keyword">DOUBLE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> account<span class="token punctuation">(</span>username<span class="token punctuation">,</span>balance<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'张无忌'</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'赵敏'</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">#开启事务</span>
<span class="token keyword">SET</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>
<span class="token comment">#编写一组事务</span>
<span class="token keyword">UPDATE</span> account <span class="token keyword">SET</span> balance<span class="token operator">=</span><span class="token number">500</span> <span class="token keyword">WHERE</span> username<span class="token operator">=</span><span class="token string">'张无忌'</span><span class="token punctuation">;</span>
<span class="token keyword">UPDATE</span> account <span class="token keyword">SET</span> balance<span class="token operator">=</span><span class="token number">1500</span> <span class="token keyword">WHERE</span> username<span class="token operator">=</span><span class="token string">'赵敏'</span><span class="token punctuation">;</span>
<span class="token comment">#结束事务</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> account
</code></pre> 
<p>演示 savepoint 的使用</p> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">start</span> <span class="token keyword">transaction</span><span class="token punctuation">;</span>
<span class="token keyword">delete</span> <span class="token keyword">from</span> account <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">savepoint</span> a<span class="token punctuation">;</span> <span class="token comment">#设置保存点</span>
<span class="token keyword">delete</span> <span class="token keyword">from</span> account <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">rollback</span> <span class="token keyword">to</span> a<span class="token punctuation">;</span> <span class="token comment">#回滚到保存点处</span>
</code></pre> 
<h2><a id="5__76"></a>5 事务并发问题介绍</h2> 
<p>对于同事运行的多个事务，当这些事务访问数据库中相同的数据时，如果没有采取必要的隔离机制，就会导致各种并发问题：</p> 
<ol><li><strong>脏读</strong>：对于两个事务T1,T2，T1读取了已经被T2更新但还<strong>没有提交</strong>的字段，之后，若T2回滚，T1读取的内容就是临时且无效的。</li><li><strong>不可重复读</strong>：对于两个事务T1,T2，T1读取了一个字段，然后T2更新了该字段，之后，T1再次读取同一个字段，值就不同了。</li><li><strong>幻读</strong>：对于两个事务T1,T2，T1从一个表中读取了一个字段，然后T2在该表中插入了一些新的行，之后，如果T1再次读取同一个表，就会多出几行。</li></ol> 
<p><strong>数据库事务的隔离性</strong>：数据库系统必须具有隔离并发运行各个事务的能力，使他们不会相互影响，避免各种并发问题。</p> 
<p><strong>数据库提供的4种事务隔离级别</strong>：</p> 
<table><thead><tr><th>隔离级别</th><th>描述</th></tr></thead><tbody><tr><td>read uncommited(读未提交数据)</td><td>允许事务读取未被其他事务提交的变更，脏读，不可重复读和幻读的问题都会出现</td></tr><tr><td>read commited(读已提交数据)</td><td>只允许事务读取已经被其他事务提交的变更，可以避免脏读，但不可重复读和幻读问题仍然可能出现。</td></tr><tr><td>repeatable read(可重复读)</td><td>确保事务可以多次从一个字段中读取相同的值，在这个事务持续期间，禁止其他事务对这个字段进行更新，可以避免脏读和不可重复读，但幻读的问题仍然存在。</td></tr><tr><td>serializable(串行化)</td><td>确保事务可以从一个表中读取相同的行，在这个事务持续期间，禁止其他事务对该表执行插入，更新和删除操作，所有并发问题都可以避免，但效率低。</td></tr></tbody></table> 
<ul><li>Oracle 支持的2中事务隔离级别：read commited,serializable.Oracle默认的隔离级别为：read commited。</li><li>Mysql 支持四种隔离级别，Mysql 默认的隔离级别为 ： repeatable read</li></ul> 
<p><strong>案例</strong></p> 
<ol><li>read uncommited<br> 命令行面板1</li></ol> 
<pre><code class="prism language-sql">C:\Windows\system32<span class="token operator">&gt;</span>mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>proot
Welcome <span class="token keyword">to</span> the MySQL monitor<span class="token punctuation">.</span>  Commands <span class="token keyword">end</span> <span class="token keyword">with</span> <span class="token punctuation">;</span> <span class="token operator">or</span> \g<span class="token punctuation">.</span>
Your MySQL connection id <span class="token operator">is</span> <span class="token number">1</span>
Server version: <span class="token number">5.5</span><span class="token number">.15</span> MySQL Community Server <span class="token punctuation">(</span>GPL<span class="token punctuation">)</span>

Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">2010</span><span class="token punctuation">,</span> Oracle <span class="token operator">and</span><span class="token operator">/</span><span class="token operator">or</span> its affiliates<span class="token punctuation">.</span> <span class="token keyword">All</span> rights reserved<span class="token punctuation">.</span>

Oracle <span class="token operator">is</span> a registered trademark <span class="token keyword">of</span> Oracle Corporation <span class="token operator">and</span><span class="token operator">/</span><span class="token operator">or</span> its
affiliates<span class="token punctuation">.</span> Other names may be trademarks <span class="token keyword">of</span> their respective
owners<span class="token punctuation">.</span>

<span class="token keyword">Type</span> <span class="token string">'help;'</span> <span class="token operator">or</span> <span class="token string">'\h'</span> <span class="token keyword">for</span> help<span class="token punctuation">.</span> <span class="token keyword">Type</span> <span class="token string">'\c'</span> <span class="token keyword">to</span> clear the <span class="token keyword">current</span> input statement<span class="token punctuation">.</span>

<span class="token comment"># 查询隔离级别</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> @<span class="token variable">@tx_isolation</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------------+</span>
<span class="token operator">|</span> @<span class="token variable">@tx_isolation</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------+</span>
<span class="token operator">|</span> <span class="token keyword">REPEATABLE</span><span class="token operator">-</span><span class="token keyword">READ</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

<span class="token comment">#重新设置隔离级别</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> <span class="token keyword">session</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span> <span class="token keyword">read</span> <span class="token keyword">uncommitted</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> @<span class="token variable">@tx_isolation</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">------------------+</span>
<span class="token operator">|</span> @<span class="token variable">@tx_isolation</span>   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------+</span>
<span class="token operator">|</span> <span class="token keyword">READ</span><span class="token operator">-</span><span class="token keyword">UNCOMMITTED</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> names gbk<span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> username <span class="token operator">|</span> balance <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> 张无忌        <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> 赵敏         <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">update</span> account <span class="token keyword">set</span> username<span class="token operator">=</span><span class="token string">'john'</span> <span class="token keyword">where</span> id <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
<span class="token keyword">Rows</span> <span class="token keyword">matched</span>: <span class="token number">1</span>  Changed: <span class="token number">1</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">rollback</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p>命令行面板2</p> 
<pre><code class="prism language-sql">C:\Windows\system32<span class="token operator">&gt;</span>mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>proot
Welcome <span class="token keyword">to</span> the MySQL monitor<span class="token punctuation">.</span>  Commands <span class="token keyword">end</span> <span class="token keyword">with</span> <span class="token punctuation">;</span> <span class="token operator">or</span> \g<span class="token punctuation">.</span>
Your MySQL connection id <span class="token operator">is</span> <span class="token number">5</span>
Server version: <span class="token number">5.5</span><span class="token number">.15</span> MySQL Community Server <span class="token punctuation">(</span>GPL<span class="token punctuation">)</span>

Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">2010</span><span class="token punctuation">,</span> Oracle <span class="token operator">and</span><span class="token operator">/</span><span class="token operator">or</span> its affiliates<span class="token punctuation">.</span> <span class="token keyword">All</span> rights reserved<span class="token punctuation">.</span>

Oracle <span class="token operator">is</span> a registered trademark <span class="token keyword">of</span> Oracle Corporation <span class="token operator">and</span><span class="token operator">/</span><span class="token operator">or</span> its
affiliates<span class="token punctuation">.</span> Other names may be trademarks <span class="token keyword">of</span> their respective
owners<span class="token punctuation">.</span>

<span class="token keyword">Type</span> <span class="token string">'help;'</span> <span class="token operator">or</span> <span class="token string">'\h'</span> <span class="token keyword">for</span> help<span class="token punctuation">.</span> <span class="token keyword">Type</span> <span class="token string">'\c'</span> <span class="token keyword">to</span> clear the <span class="token keyword">current</span> input statement<span class="token punctuation">.</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> <span class="token keyword">session</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span> <span class="token keyword">read</span> <span class="token keyword">uncommitted</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">use</span> test<span class="token punctuation">;</span>
<span class="token keyword">Database</span> changed

mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> username <span class="token operator">|</span> balance <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> john     <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> 璧垫晱     <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> names gbk<span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> username <span class="token operator">|</span> balance <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> john     <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> 赵敏         <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/c8/8d/KEvk7WRM_o.png" alt="在这里插入图片描述"></p> 
<p>表格流程显示如下：</p> 
<table><thead><tr><th></th><th>面板1</th><th>面板2</th><th>结果</th></tr></thead><tbody><tr><td>1</td><td>select * from account;</td><td></td><td></td></tr><tr><td>2</td><td>set autocommit=0;update account set username=‘john’ where id=1;</td><td></td><td></td></tr><tr><td>3</td><td></td><td>set autocommit=0;select * from account;</td><td>面板1并未提交事务，但是面板2依旧可以查看到被更改的信息，出现了脏读现象</td></tr><tr><td>4</td><td>回滚 rollback；</td><td></td><td></td></tr><tr><td>5</td><td></td><td>select * from account;</td><td>username=‘张无忌’,跟上一次查看的结果不一样，出现不可重复度和幻读的现象。</td></tr></tbody></table> 
<ol start="2"><li>read committed<br> 命令行面板1</li></ol> 
<pre><code class="prism language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> <span class="token keyword">session</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span> <span class="token keyword">read</span> <span class="token keyword">committed</span><span class="token punctuation">;</span>

mysql<span class="token operator">&gt;</span>  <span class="token keyword">select</span> @<span class="token variable">@tx_isolation</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token operator">|</span> @<span class="token variable">@tx_isolation</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token operator">|</span> <span class="token keyword">READ</span><span class="token operator">-</span><span class="token keyword">COMMITTED</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> username <span class="token operator">|</span> balance <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> 张飞        <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> 赵敏         <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">update</span> account <span class="token keyword">set</span> username<span class="token operator">=</span><span class="token string">'john'</span> <span class="token keyword">where</span> id <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
<span class="token keyword">Rows</span> <span class="token keyword">matched</span>: <span class="token number">1</span>  Changed: <span class="token number">1</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

</code></pre> 
<p>命令行面板2</p> 
<pre><code class="prism language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> <span class="token keyword">session</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span> <span class="token keyword">read</span> <span class="token keyword">committed</span><span class="token punctuation">;</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> @<span class="token variable">@tx_isolation</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token operator">|</span> @<span class="token variable">@tx_isolation</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token operator">|</span> <span class="token keyword">READ</span><span class="token operator">-</span><span class="token keyword">COMMITTED</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> username <span class="token operator">|</span> balance <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> john     <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> 赵敏         <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/9d/19/aQ2FBZNL_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/ce/de/PV0hbvFP_o.png" alt="在这里插入图片描述"></p> 
<p>表格流程显示如下：</p> 
<table><thead><tr><th></th><th>面板1</th><th>面板2</th><th>结果</th></tr></thead><tbody><tr><td>1</td><td>select * from account;</td><td></td><td>username=‘张无忌’</td></tr><tr><td>2</td><td>set autocommit=0;update account set username=‘张飞’ where id=1;</td><td></td><td></td></tr><tr><td>3</td><td></td><td>set autocommit=0;select * from account;</td><td>面板1并未提交事务，面板2获没有获取到面板1更新的数据，所以避免了脏读现象 username=‘john’</td></tr><tr><td>4 提交 commit；</td><td></td><td></td><td></td></tr><tr><td>5</td><td></td><td>select * from account;</td><td>username=‘张飞’,跟上一次查看的结果不一样，出现不可重复度和幻读的现象。</td></tr></tbody></table> 
<ol start="3"><li>repeatable read<br> 命令行面板1</li></ol> 
<pre><code class="prism language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> <span class="token keyword">session</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span> <span class="token keyword">repeatable</span> <span class="token keyword">read</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span>  <span class="token keyword">select</span> @<span class="token variable">@tx_isolation</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------------+</span>
<span class="token operator">|</span> @<span class="token variable">@tx_isolation</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------+</span>
<span class="token operator">|</span> <span class="token keyword">REPEATABLE</span><span class="token operator">-</span><span class="token keyword">READ</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> username <span class="token operator">|</span> balance <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> john     <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> 赵敏         <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">update</span> account <span class="token keyword">set</span> username<span class="token operator">=</span><span class="token string">'刘备'</span> <span class="token keyword">where</span> id <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
<span class="token keyword">Rows</span> <span class="token keyword">matched</span>: <span class="token number">1</span>  Changed: <span class="token number">1</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">commit</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p>命令行面板2</p> 
<pre><code class="prism language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> <span class="token keyword">session</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span> <span class="token keyword">repeatable</span> <span class="token keyword">read</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> @<span class="token variable">@tx_isolation</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------------+</span>
<span class="token operator">|</span> @<span class="token variable">@tx_isolation</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------+</span>
<span class="token operator">|</span> <span class="token keyword">REPEATABLE</span><span class="token operator">-</span><span class="token keyword">READ</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> username <span class="token operator">|</span> balance <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> john     <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> 赵敏         <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> username <span class="token operator">|</span> balance <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> john     <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> 赵敏         <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">commit</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> username <span class="token operator">|</span> balance <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> 刘备         <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> 赵敏         <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/27/bc/ZL7rDzMH_o.png" alt="在这里插入图片描述"><br> 出现幻读的情况</p> 
<p>表格流程显示如下：</p> 
<table><thead><tr><th></th><th>面板1</th><th>面板2</th><th>结果</th></tr></thead><tbody><tr><td>1</td><td>select * from account;</td><td></td><td>username=‘张无忌’</td></tr><tr><td>2</td><td>set autocommit=0;update account set username=‘刘备’ where id=1;</td><td></td><td></td></tr><tr><td>3</td><td></td><td>set autocommit=0; select * from account;</td><td>username=‘john’</td></tr><tr><td>4</td><td>commit;</td><td></td><td></td></tr><tr><td>5</td><td></td><td>select * from acount;</td><td></td></tr><tr><td>6</td><td></td><td>commit;set autocommit=0; select * from account;</td><td>username=‘刘备’,在面板2提交的情况下才获取到了面板一修改的信息</td></tr><tr><td>7</td><td>set autocommit=0;update account set username=‘mmm’ 暂时不执行</td><td>set autocommit=0;insert into account values(‘tt’,1000);commit;</td><td></td></tr><tr><td>8</td><td>update account set username=‘mmm’ 执行语句</td><td></td><td>发现修改了三条语句，此时出现了幻读现象</td></tr></tbody></table> 
<ol start="4"><li>serailizable<br> 命令行面板1</li></ol> 
<pre><code class="prism language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> <span class="token keyword">session</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span> <span class="token keyword">serializable</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span>  <span class="token keyword">select</span> @<span class="token variable">@tx_isolation</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token operator">|</span> @<span class="token variable">@tx_isolation</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token operator">|</span> <span class="token keyword">SERIALIZABLE</span>   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> username <span class="token operator">|</span> balance <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> 刘备         <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> 赵敏         <span class="token operator">|</span>    <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+---------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">update</span> account <span class="token keyword">set</span> username<span class="token operator">=</span><span class="token string">'mmmmm'</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
<span class="token keyword">Rows</span> <span class="token keyword">matched</span>: <span class="token number">2</span>  Changed: <span class="token number">2</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">update</span> account <span class="token keyword">set</span> username<span class="token operator">=</span><span class="token string">'mmmmm'</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
<span class="token keyword">Rows</span> <span class="token keyword">matched</span>: <span class="token number">2</span>  Changed: <span class="token number">0</span>  <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">commit</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p>命令行面板2</p> 
<pre><code class="prism language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> <span class="token keyword">session</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span> <span class="token keyword">serializable</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> @<span class="token variable">@tx_isolation</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token operator">|</span> @<span class="token variable">@tx_isolation</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token operator">|</span> <span class="token keyword">SERIALIZABLE</span>   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">set</span> autocommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">insert</span> <span class="token keyword">into</span> account <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'关羽'</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ERROR <span class="token number">1136</span> <span class="token punctuation">(</span><span class="token number">21</span>S01<span class="token punctuation">)</span>: <span class="token keyword">Column</span> count doesn<span class="token string">'t match value count at row 1
mysql&gt; insert into account values(null,'</span>关羽<span class="token string">',2000);
ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction
mysql&gt; insert into account values(null,'</span>关羽'<span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">15.89</span> sec<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ca/77/Z1buQNqz_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8f/66/AjjKEQp0_o.png" alt="在这里插入图片描述"><br> 表格流程显示如下：</p> 
<table><thead><tr><th></th><th>面板1</th><th>面板2</th><th>结果</th></tr></thead><tbody><tr><td>1</td><td>set autocommit=0;</td><td></td><td></td></tr><tr><td>2</td><td></td><td>set autocommit=0;insert into account values(null,‘dd’,2000);</td><td>会出现阻塞等待的情况</td></tr><tr><td>3</td><td>update account set username=‘mmm’;commit;</td><td></td><td>这时候面板2sql语句会执行</td></tr></tbody></table> 
<p><strong>小结</strong></p> 
<ol><li> <p>查看当前隔离级别<br> <strong>select @@tx_isolation;</strong></p> </li><li> <p>设置当前mysql连接的隔离级别：<br> <strong>set transaction isolation level read committed;</strong></p> </li><li> <p>设置数据库系统的全局隔离级别：<br> set <strong>global</strong> transaction isolation level read committed;</p> </li><li></ol> 
<table><thead><tr><th>事物的隔离级别脏读</th><th></th><th>不可重复读</th><th>幻读</th></tr></thead><tbody><tr><td>read uncommitted</td><td>√</td><td>√</td><td>√</td></tr><tr><td>read committed</td><td>×</td><td>√</td><td>√</td></tr><tr><td>repeatable read</td><td>×</td><td>×</td><td>√</td></tr><tr><td>serializable</td><td>×</td><td>×</td><td>×</td></tr></tbody></table> 
<h2><a id="6_delete__truncate__481"></a>6 delete 和 truncate 在事务使用的区别</h2> 
<p>演示delete</p> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> aotucommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">delete</span> <span class="token keyword">from</span> account<span class="token punctuation">;</span>
<span class="token keyword">rollback</span><span class="token punctuation">;</span>
</code></pre> 
<p>回滚成功</p> 
<p>演示 truncate</p> 
<pre><code class="prism language-sql"><span class="token keyword">set</span> aotucommit<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">truncate</span> <span class="token keyword">table</span> account<span class="token punctuation">;</span>
<span class="token keyword">rollback</span><span class="token punctuation">;</span>
</code></pre> 
<p>不支持回滚</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c77c13fc9e9583482aa187aa8154094c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">git bash shell 脚本 ：从文件获取git仓库列表 git clone所有仓库</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9bc77b9a8880e49e9144841317069dab/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">微信小程序 - 云开发轮询实现定时推送订阅消息</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>