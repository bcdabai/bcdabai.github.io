<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue项目中直接操作cookie - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue项目中直接操作cookie" />
<meta property="og:description" content="封装设定cookie函数 // 没有定义时效 // document.cookie = &#39;phone=1&#39;; // 设定cookie时效的语法,设定的时效,就是时间对象的时间戳 // JavaScript时间对象的默认时间戳是,本地时间,与服务器时间有时差,必须要计算时差 // 还必须要计算时效时间 // 新的时间戳,要设定为时间对象的时间戳 // document.cookie = &#39;phone=1;expires=时间对象&#39;; // 删除cookie,只要将时效性定义为-1就行了 // 通过函数的形式来设定cookie,定义时效 // 三个参数:名称,数据,时效 function mySetCookie(key, value, time) { // JavaScript中计时单位都是毫秒 // 1,获取当前时间 let t = new Date(); // 获取当前时间戳 单位是毫秒 // 服务器的事件与当前本地时间相差8个小时,减去8个小时的毫秒 // 还必须计算当前的时效,秒转化为毫秒 // 当前cookie新的时间戳 let t1 = t.getTime() - 8 * 60 * 60 * 1000 &#43; time * 1000; // 将这个新的时间戳,设定为 Date()对象的时间戳 // 将cookie的时效,设定为当前时间对象Date()对象的时间戳 // 将计算好的t1时间戳,设定为t时间对象的时间戳 t." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f4ec241445b75ac87623a10ffc0cab57/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-18T08:50:28+08:00" />
<meta property="article:modified_time" content="2023-08-18T08:50:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue项目中直接操作cookie</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h5>封装设定cookie函数</h5> 
<pre><code class="language-javascript">        // 没有定义时效
        // document.cookie = 'phone=1';

        // 设定cookie时效的语法,设定的时效,就是时间对象的时间戳
        // JavaScript时间对象的默认时间戳是,本地时间,与服务器时间有时差,必须要计算时差
        // 还必须要计算时效时间
        // 新的时间戳,要设定为时间对象的时间戳
        // document.cookie  = 'phone=1;expires=时间对象';

        // 删除cookie,只要将时效性定义为-1就行了


        // 通过函数的形式来设定cookie,定义时效
        // 三个参数:名称,数据,时效

        function mySetCookie(key, value, time) {
            // JavaScript中计时单位都是毫秒

            // 1,获取当前时间
            let t = new Date();
            // 获取当前时间戳 单位是毫秒
            // 服务器的事件与当前本地时间相差8个小时,减去8个小时的毫秒
            // 还必须计算当前的时效,秒转化为毫秒
            // 当前cookie新的时间戳
            let t1 = t.getTime() - 8 * 60 * 60 * 1000 + time * 1000;

            // 将这个新的时间戳,设定为 Date()对象的时间戳
            // 将cookie的时效,设定为当前时间对象Date()对象的时间戳
            // 将计算好的t1时间戳,设定为t时间对象的时间戳
            t.setTime(t1);

            // 设定cookie,名称是参数key,数据是参数value
            // 时效是,t时间对象的时间戳,也就是计算过的t1
            document.cookie = `${key}=${value};expires=${t}`;
        }

        mySetCookie('phone', '1', 60);

            // getTime() 是获取当前时间的时间戳
            // setTime() 是设定当前时间的时间戳</code></pre> 
<h5>封装获取cookie函数</h5> 
<pre><code class="language-javascript">       // JavaScript中cookie是一个字符串
        // 名称=数据; 名称=数据

        // 例如: age=18; sex=男; addr=北京; name=100

        // 如果想要获取cookie中的数据信息,就只能自己设定程序
        // 将cookie字符串,转化cookie对象,方便通过名称获取数据
        
        function getCookie(cookieStr) {
            // 建立一个空对象,存储cookie的数据
            const obj = {};

            // 1,获取cookie字符串,以 ;空格为间隔内容,转化为数组
            let arr = cookieStr.split('; ');
            // console.log(arr);

            // 2,在循环遍历数组中的单元,提取单元的数据
            // name=100,以等号为间隔,再次转化为数组
            arr.forEach(function (item) {
                // 将itme,也就是name=100,再以=为间隔,转化为数组
                let newArr = item.split('=');
                // 将数组newArr中数据,写入到对象中
                // 数组newArr是 ['name','100'];
                // newArr[0]是name newArr[1]是100
                // 给obj中添加单元,单元的属性是name,单元的数据是100
                obj[newArr[0]] = newArr[1];
            })

            return obj;
        }

        const cookieObj = getCookie(document.cookie);

        // 总结步骤

        // 前端获取到的cookie是一个字符串
        // 形式 名称=数据; 名称=数据; 名称=数据
        // 最终需要将字符串转化为对象
        // 步骤: 
        // 1: 以 分号空格 为间隔,将cookie字符串转化为数组
        //   数组的形式 
        /*
            [
                0:'name=100',
                1:'age=18',
                2:'sex=男',
                3:'addr=北京',
            ]

            2: 循环遍历生成的数组,获取数组的单元数据,再以等号为间隔,转化为新的数组
            结果  ['name' , '100']
                 ['age' , '18']
                 ['sex' , '男']
                 ['addr' , '北京']

            3: 将数组的第一个单元作为对象的属性,第二个单元作为对象的属性值
                obj[newArr[0]] = newArr[1]

            4: 整个循环结束之后,将对象作为返回值</code></pre> 
<p> </p> 
<h5>使用 js-cookie 工具</h5> 
<p>地址：</p> 
<p><a href="https://www.npmjs.com/package/js-cookie" rel="nofollow" title="https://www.npmjs.com/package/js-cookie">https://www.npmjs.com/package/js-cookie</a></p> 
<p></p> 
<p></p> 
<p> </p> 
<pre><code class="language-javascript">//安装 
cnpm i js-cookie
//引入
import Cookies from 'js-cookie'

使用方法：

Basic Usage

Create a cookie, valid across the entire site:

Cookies.set('name', 'value');
Create a cookie that expires 7 days from now, valid across the entire site:

Cookies.set('name', 'value', { expires: 7 });
Create an expiring cookie, valid to the path of the current page:

Cookies.set('name', 'value', { expires: 7, path: '' });
Read cookie:

Cookies.get('name'); // =&gt; 'value'
Cookies.get('nothing'); // =&gt; undefined
Read all visible cookies:

Cookies.get(); // =&gt; { name: 'value' }
Delete cookie:

Cookies.remove('name');
Delete a cookie valid to the path of the current page:

Cookies.set('name', 'value', { path: '' });
Cookies.remove('name'); // fail!
Cookies.remove('name', { path: '' }); // removed!
IMPORTANT! when deleting a cookie, you must pass the exact same path and domain attributes that was used to set the cookie,
 unless you're relying on the default attributes.

Note: Removing unexisting cookie does not raise any exception nor return any value</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e79e0df5f950763188f3dfc552a2e075/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">css常见的单位汇总分类</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8d1270bbdfd736f5dfa837661a1acbca/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">js金额数字格式化</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>