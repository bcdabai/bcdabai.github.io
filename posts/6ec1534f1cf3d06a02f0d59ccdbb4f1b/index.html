<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C&#43;&#43;拾遗（一） 内存 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C&#43;&#43;拾遗（一） 内存" />
<meta property="og:description" content="内存分区模型 内存四区分布 C&#43;&#43;程序在执行时，将内存大方向划分为4个区
代码区：存放函数体（如main函数）的二进制代码，即存放 CPU 执行的机器指令，由操作系统进行管理。
代码区特点：
1.代码区是共享的，共享的目的是对于频繁被执行的程序，只需要在内存中有一份代码即可 2.代码区是只读的，使其只读的原因是防止程序意外地修改了它的指令
全局区：存放全局变量和静态变量以及常量，其中常量属于全局区的常量区。该区域的数据在程序结束后由操作系统释放。
栈区：由编译器自动分配释放, 存放函数的参数值，局部变量等
堆区：由程序员分配和释放，若程序员不释放，程序结束时由操作系统回收
内存四区意义 不同区域存放的数据，赋予不同的生命周期, 给我们更大的灵活编程
程序执行前后内存分布 程序执行前 在程序编译后，生成了exe可执行程序，未执行该程序前分为两个区域，代码区和全局区
int g_a = 10; int g_b = 10; 定义全局变量，使其属于整个程序，生命周期同原程序一样
const int c_g_a = 10; const int c_g_b = 10; 全局常量，使其属于整个程序，且其值不可被改变
int main() {
int a = 10; int b = 10; 局部变量，使其只属于mai函数
打印地址：利用&amp;获取地址
std::cout &lt;&lt; (int)&amp;a &lt;&lt; std::endl; 以int类型方式打印a地址，&amp;获取a的地址，将a地址转化为int类型打印出去
std::cout &lt;&lt; (int)&amp;b &lt;&lt; std::endl; 打印b地址
std::cout &lt;&lt; (int)&amp;g_a &lt;&lt; std::endl; 打印&amp;g_a地址" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/6ec1534f1cf3d06a02f0d59ccdbb4f1b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-24T12:15:46+08:00" />
<meta property="article:modified_time" content="2024-01-24T12:15:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C&#43;&#43;拾遗（一） 内存</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div> 
 <h2>内存分区模型</h2> 
 <h3>内存四区分布</h3> 
 <p style="margin-left:0;"><span style="color:#333333;">C++</span><span style="color:#333333;">程序在执行时，将内存大方向划分为4个区</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">代码区：存放函数体（如main函数）的二进制代码，即存放 CPU </span><span style="color:#333333;">执行的机器指令，由操作系统进行管理。</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">代码区特点：</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">1.代码区是共享的，共享的目的是对于频繁被执行的程序，只需要在内存中有一份代码即可 </span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">2.代码区是只读的，使其只读的原因是防止程序意外地修改了它的指令</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">全局区：存放全局变量和静态变量以及常量，其中常量属于全局区的常量区。该区域的数据在程序结束后由操作系统释放。</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">栈区：由编译器自动分配释放</span><span style="color:#333333;">, </span><span style="color:#333333;">存放函数的参数值，</span><span style="color:#333333;">局部变量等</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">堆区：由程序员分配和释放，</span><span style="color:#333333;">若程序员不释放，</span><span style="color:#333333;">程序结束时由操作系统回收</span></p> 
 <h3 style="margin-left:0px;"><strong><span style="color:#333333;">内存四区意义</span></strong></h3> 
 <p style="margin-left:0;"><span style="color:#333333;">不同区域存放的数据，赋予不同的生命周期</span><span style="color:#333333;">, </span><span style="color:#333333;">给我们更大的灵活编程</span></p> 
 <h3 style="margin-left:0px;"><strong><span style="color:#333333;">程序执行前后内存分布</span></strong></h3> 
 <h4><strong><span style="color:#333333;">程序执行前</span></strong></h4> 
 <p style="margin-left:0;"><span style="color:#333333;">在程序编译后，生成了</span><span style="color:#333333;">exe</span><span style="color:#333333;">可执行程序，未执行该程序前分为两个区域，代码区和全局区</span></p> 
</div> 
<div> 
 <p style="margin-left:0;"><span style="color:#0d0016;">int g_a = 10; </span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">int g_b = 10; 定义全局变量，使其属于整个程序，生命周期同原程序一样</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">const int c_g_a = 10; </span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">const int c_g_b = 10; 全局常量，使其属于整个程序，且其值不可被改变</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">int main() {<!-- --></span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">int a = 10; int b = 10; 局部变量，使其只属于mai函数</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">打印地址：利用&amp;获取地址</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">std::cout &lt;&lt;  (int)&amp;a &lt;&lt; std::endl; 以int类型方式打印a地址，&amp;获取a的地址，将a地址转化为int类型打印出去</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">std::cout &lt;&lt;  (int)&amp;b &lt;&lt; std::endl; 打印b地址</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">std::cout &lt;&lt; (int)&amp;g_a &lt;&lt; std::endl; 打印&amp;g_a地址</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">std::cout &lt;&lt; (int)&amp;g_b &lt;&lt; std::endl; 打印&amp;g_b地址</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">静态变量：该变量进入函数，运行结束后，不会消失，仍然存在，并且其值保存为函数运行后的值</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">static int s_a = 10; </span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">static int s_b = 10; 此处定义两个静态变量</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">std::cout &lt;&lt; (int)&amp;s_a &lt;&lt; std::endl; </span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">std::cout &lt;&lt; (int)&amp;s_b &lt;&lt; std::endl; 打印该静态变量地址</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">std::cout &lt;&lt; (int)&amp;"hello world" &lt;&lt; std::endl; </span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">std::cout &lt;&lt; (int)&amp;"hello world1" &lt;&lt; std::endl; 打印该字符串常量地址</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">std::cout  (int)&amp;c_g_a &lt;&lt; std::endl; </span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">std::cout  &lt;&lt; (int)&amp;c_g_b &lt;&lt; std::endl; 打印该全局常量地址</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">const int c_l_a = 10; </span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">const int c_l_b = 10; 定义局部常量</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">std::cout &lt;&lt; (int)&amp;c_l_a &lt;&lt; std::endl;</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">std::cout &lt;&lt; (int)&amp;c_l_b &lt;&lt; std::endl; </span> 打印该局部常量地址</p> 
 <p style="margin-left:0;">system("pause");</p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">return 0;</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">}</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">打印结果可以总结</span>：</p> 
</div> 
<div> 
 <p style="margin-left:0;"><span style="color:#333333;">C++</span><span style="color:#333333;">中在程序运行前分为全局区和代码区代码区特点是共享和只读</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">全局区中存放全局变量、静态变量、常量</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">常量区中存放 </span><span style="color:#333333;">const</span><span style="color:#333333;">修饰的全局常量 和 字符串常量</span></p> 
 <h4 style="margin-left:0px;"><a name="1.2_%E7%A8%8B%E5%BA%8F%E8%BF%90%E8%A1%8C%E5%90%8E"></a><strong><span style="color:#333333;">程序执行后</span></strong></h4> 
 <p>执行该程序后分为两个区域：栈区和堆区</p> 
 <p style="margin-left:0;"><span style="color:#333333;">栈区：</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">注意事项：不能返回局部变量的地址，由于</span>局部变量存储在函数调用时创建的栈内存上，当函数结</p> 
 <p style="margin-left:0;">束后会自动释放该内存空间<span style="color:#333333;">栈区开辟的数据，此时程序已经没有该变量内存，也就无法返回</span></p> 
</div> 
<div> 
 <p style="margin-left:0;"><span style="color:#333333;">堆区：</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">在</span><span style="color:#333333;">C++</span><span style="color:#333333;">中主要利用</span><span style="color:#333333;">new</span><span style="color:#333333;">在堆区开辟内存</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">堆区数据由程序员分配释放</span><span style="color:#333333;">,</span><span style="color:#333333;">若程序员不释放</span><span style="color:#333333;">,</span><span style="color:#333333;">程序结束时由操作系统回收</span></p> 
 <p style="margin-left:0;">栈内存和堆内存分配在代码形式的表示如下：</p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">int func()  栈表现形式</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">{<!-- --></span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">int a = 10; </span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">}</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">int* func()  堆表现形式</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">{<!-- --></span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">int* a = new int(10);</span></p> 
 <p style="margin-left:0;"><span style="color:#0d0016;">}</span></p> 
 <h2 style="margin-left:0px;"><span style="color:#0d0016;">new操作符</span></h2> 
 <p style="margin-left:0;"><span style="color:#333333;">C++</span><span style="color:#333333;">中利用</span><span style="color:#333333;">new</span><span style="color:#333333;">操作符在堆区开辟数据</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">堆区开辟的数据，由程序员手动开辟，手动释放，释放利用操作符 </span><span style="color:#333333;">delete</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">语法： </span><span style="color:#333333;">new </span><span style="color:#333333;">数据类型</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">利用</span><span style="color:#333333;">new</span><span style="color:#333333;">创建的数据，会返回该数据对应的类型的指针</span></p> 
 <p style="margin-left:0;"><span style="color:#333333;">应用一: 开辟普通变量内存空间</span></p> 
</div> 
<p style="margin-left:9pt;">int* func()</p> 
<p style="margin-left:9pt;">{<!-- --></p> 
<p style="margin-left:9pt;">    int *a = new int(10); 利用new为a分配内存</p> 
<p style="margin-left:9pt;">    return a;</p> 
<p style="margin-left:9pt;">}</p> 
<p style="margin-left:9pt;"><span style="color:#0d0016;">int main() {<!-- --></span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">int *p = func();  用p接受a的数据</span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">std::cout &lt;&lt; *p &lt;&lt; std::endl; </span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">delete p; 利用delete释放堆区数据</span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">std::cout &lt;&lt; *p &lt;&lt; std::endl; 报错，释放的空间不可访问</span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">system("pause");</span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">return 0;</span></p> 
<p style="margin-left:9pt;"><span style="color:#0d0016;">}</span></p> 
<p style="margin-left:0;"><span style="color:#333333;">应用二：堆区开辟数组</span></p> 
<p style="margin-left:9pt;"><span style="color:#0d0016;">int main()</span></p> 
<p style="margin-left:9pt;"><span style="color:#0d0016;">{<!-- --></span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">int* arr = new int[10]; 开辟一个元素11个的数组内存空间</span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">for (int i = 0; i &lt; 10; i++)</span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">{<!-- --></span></p> 
<p style="margin-left:51.3pt;"><span style="color:#0d0016;">arr[i] = i + 100; 数组初始化赋值</span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">}</span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">for (int i = 0; i &lt; 10; i++)</span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">{<!-- --></span></p> 
<p style="margin-left:51.3pt;"><span style="color:#0d0016;">std::cout &lt;&lt; arr[i] &lt;&lt; std::endl; 打印数组</span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">}</span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">delete[] arr; 释放数组 delete 后加 []</span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">system("pause");</span></p> 
<p style="margin-left:30.15pt;"><span style="color:#0d0016;">return 0;</span></p> 
<p style="margin-left:9pt;"><span style="color:#0d0016;">}</span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0cadcfd82966d939811b4d500426e151/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【刷题】 leetcode 面试题 01.06 字符串压缩</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e4324efc2402101b5b6c8087c5396f48/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux基础命令-scp远程复制文件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>