<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SpringBoot实现图片识别文字的四种方式 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SpringBoot实现图片识别文字的四种方式" />
<meta property="og:description" content="SpringBoot实现图片识别文字 文末含有案例地址哦！！！
SpringBoot 整合 Tess4J 实现 Tesseract是一个开源的光学字符识别（OCR）引擎，它可以将图像中的文字转换为计算机可读的文本。支持多种语言和书面语言，并且可以在命令行中执行。它是一个流行的开源OCR工具，可以在许多不同的操作系统上运行。
Tess4J是一个基于Tesseract OCR引擎的Java接口，可以用来识别图像中的文本，说白了，就是封装了它的API，让Java可以直接调用。
1、引入tess4j依赖 &lt;!-- tess4j --&gt; &lt;dependency&gt; &lt;groupId&gt;net.sourceforge.tess4j&lt;/groupId&gt; &lt;artifactId&gt;tess4j&lt;/artifactId&gt; &lt;version&gt;4.5.4&lt;/version&gt; &lt;/dependency&gt; 2、yml配置 把训练数据的目录路径配置在yml里，后续可以扩展到配置中心。
server: port: 8888 # 训练数据文件夹的路径 tess4j: datapath: E:/gitee/OCR/tess4j_data Tesseract OCR库通过训练数据来学习不同语言和字体的特征，以便更好地识别图片中的文字。
在安装Tesseract OCR库时，通常会生成一个包含多个子文件夹的训练数据文件夹，其中每个子文件夹都包含了特定语言或字体的训练数据。
比如我这里是下载后放到了D盘的tessdata目录下，如图所示，其实就是一个.traineddata为后缀的文件，大小约2M多。
训练数据，官方下载地址：https://digi.bib.uni-mannheim.de/tesseract/
GitHub官网地址：https://github.com/tesseract-o
3、编写配置类 @Configuration public class TesseractOcrConfig { @Value(&#34;${tess4j.dataPath}&#34;) private String dataPath; @Bean public Tesseract tesseract() { Tesseract tesseract = new Tesseract(); // 设置训练数据文件夹路径 tesseract.setDatapath(dataPath); // 设置为中文简体 tesseract.setLanguage(&#34;chi_sim&#34;); return tesseract; } } 4、编写业务实现类 @Service public class OcrServiceImpl implements OcrService { private final Tesseract tesseract; public OcrServiceImpl(Tesseract tesseract) { this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/dffc7d4405d9ffb503ec18fc3dd4483b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-18T20:53:30+08:00" />
<meta property="article:modified_time" content="2023-11-18T20:53:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SpringBoot实现图片识别文字的四种方式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="SpringBoot_0"></a>SpringBoot实现图片识别文字</h2> 
<p>文末含有案例地址哦！！！</p> 
<h3><a id="SpringBoot__Tess4J__3"></a>SpringBoot 整合 Tess4J 实现</h3> 
<p>Tesseract是一个开源的光学字符识别（OCR）引擎，它可以将图像中的文字转换为计算机可读的文本。支持多种语言和书面语言，并且可以在命令行中执行。它是一个流行的开源OCR工具，可以在许多不同的操作系统上运行。</p> 
<p>Tess4J是一个基于Tesseract OCR引擎的Java接口，可以用来识别图像中的文本，说白了，就是封装了它的API，让Java可以直接调用。</p> 
<h4><a id="1tess4j_9"></a>1、引入tess4j依赖</h4> 
<pre><code class="prism language-xml"><span class="token comment">&lt;!-- tess4j --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>net.sourceforge.tess4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>tess4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.5.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="2yml_20"></a>2、yml配置</h4> 
<p>把训练数据的目录路径配置在yml里，后续可以扩展到配置中心。</p> 
<pre><code class="prism language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8888</span>

<span class="token comment"># 训练数据文件夹的路径</span>
<span class="token key atrule">tess4j</span><span class="token punctuation">:</span>
  <span class="token key atrule">datapath</span><span class="token punctuation">:</span> E<span class="token punctuation">:</span>/gitee/OCR/tess4j_data
</code></pre> 
<p>Tesseract OCR库通过训练数据来学习不同语言和字体的特征，以便更好地识别图片中的文字。</p> 
<p>在安装Tesseract OCR库时，通常会生成一个包含多个子文件夹的训练数据文件夹，其中每个子文件夹都包含了特定语言或字体的训练数据。</p> 
<p>比如我这里是下载后放到了D盘的tessdata目录下，如图所示，其实就是一个.traineddata为后缀的文件，大小约2M多。</p> 
<p>训练数据，官方下载地址：https://digi.bib.uni-mannheim.de/tesseract/</p> 
<p>GitHub官网地址：https://github.com/tesseract-o</p> 
<p><img src="https://images2.imgbox.com/de/e3/XzA3vNzd_o.png" alt="image20231117115838967.png"></p> 
<h4><a id="3_45"></a>3、编写配置类</h4> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Configuration</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TesseractOcrConfig</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${tess4j.dataPath}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> dataPath<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Tesseract</span> <span class="token function">tesseract</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

        <span class="token class-name">Tesseract</span> tesseract <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tesseract</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置训练数据文件夹路径</span>
        tesseract<span class="token punctuation">.</span><span class="token function">setDatapath</span><span class="token punctuation">(</span>dataPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置为中文简体</span>
        tesseract<span class="token punctuation">.</span><span class="token function">setLanguage</span><span class="token punctuation">(</span><span class="token string">"chi_sim"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> tesseract<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="4_69"></a>4、编写业务实现类</h4> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OcrServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">OcrService</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Tesseract</span> tesseract<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">OcrServiceImpl</span><span class="token punctuation">(</span><span class="token class-name">Tesseract</span> tesseract<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>tesseract <span class="token operator">=</span> tesseract<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     *
     * @param imageFile 要识别的图片
     * @return
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">recognizeText</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> imageFile<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">TesseractException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 转换</span>
        <span class="token class-name">InputStream</span> sbs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span>imageFile<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BufferedImage</span> bufferedImage <span class="token operator">=</span> <span class="token class-name">ImageIO</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>sbs<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 对图片进行文字识别</span>
        <span class="token keyword">return</span> tesseract<span class="token punctuation">.</span><span class="token function">doOCR</span><span class="token punctuation">(</span>bufferedImage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="5_98"></a>5、编写测试接口</h4> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/api"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OcrController</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">OcrService</span> ocrService<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">OcrController</span><span class="token punctuation">(</span><span class="token class-name">OcrService</span> ocrService<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ocrService <span class="token operator">=</span> ocrService<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/recognize"</span><span class="token punctuation">,</span> consumes <span class="token operator">=</span> <span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">MULTIPART_FORM_DATA_VALUE</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">recognizeImage</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TesseractException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>

        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>ocrService<span class="token punctuation">.</span><span class="token function">recognizeText</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 调用OcrService中的方法进行文字识别</span>
        <span class="token keyword">return</span> ocrService<span class="token punctuation">.</span><span class="token function">recognizeText</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="postman_122"></a>postman配置：</h4> 
<p><img src="https://images2.imgbox.com/34/32/xpIDgcPQ_o.png" alt="image20231117120601161.png"></p> 
<h4><a id="_126"></a>效果：</h4> 
<p><img src="https://images2.imgbox.com/df/a8/LkD5RLye_o.png" alt="image20231117120728923.png"></p> 
<blockquote> 
 <p>此方法的识别精准度差，不建议使用。</p> 
 <p>案例完整代码：https://github.com/rookiesnewbie/OCR</p> 
</blockquote> 
<h3><a id="_137"></a>整合百度智能云实现</h3> 
<p>官网文档：https://ai.baidu.com/ai-doc/OCR/dk3iqnq51</p> 
<h4><a id="1_141"></a>1、根据官方文档创建应用</h4> 
<h4><a id="2_143"></a>2、引入依赖</h4> 
<pre><code class="prism language-xml"><span class="token comment">&lt;!--百度ocr--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baidu.aip<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>java-sdk<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.16.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="3yml_154"></a>3、编写yml配置文件</h4> 
<pre><code class="prism language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8090</span>

<span class="token key atrule">baidu</span><span class="token punctuation">:</span>
  <span class="token key atrule">APP_ID</span><span class="token punctuation">:</span> <span class="token comment">#应用的appid</span>
  <span class="token key atrule">API_KEY</span><span class="token punctuation">:</span> <span class="token comment">#你的app_key</span>
  <span class="token key atrule">SECRET_KEY</span><span class="token punctuation">:</span> <span class="token comment">#你的secret_key</span>
</code></pre> 
<h4><a id="4OCR_166"></a>4、创建一个配置类来初始化百度OCR的客户端</h4> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"baidu"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> baiduOcrConfig <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token constant">APP_ID</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token constant">API_KEY</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token constant">SECRET_KEY</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">AipOcr</span> <span class="token function">aipOcr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AipOcr</span><span class="token punctuation">(</span><span class="token constant">APP_ID</span><span class="token punctuation">,</span> <span class="token constant">API_KEY</span><span class="token punctuation">,</span> <span class="token constant">SECRET_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="5controller_186"></a>5、编写controller</h4> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/api"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BaiduOcrController</span> <span class="token punctuation">{<!-- --></span>


    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">AipOcr</span> aipOcr<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/process"</span><span class="token punctuation">,</span>consumes <span class="token operator">=</span> <span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">MULTIPART_FORM_DATA_VALUE</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">processImage</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        options<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"detect_direction"</span><span class="token punctuation">,</span> <span class="token string">"true"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        options<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"probability"</span><span class="token punctuation">,</span> <span class="token string">"true"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> imageBytes <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">JSONObject</span> result <span class="token operator">=</span> aipOcr<span class="token punctuation">.</span><span class="token function">basicGeneral</span><span class="token punctuation">(</span>imageBytes<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 解析百度OCR的识别结果</span>
            <span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            result<span class="token punctuation">.</span><span class="token function">getJSONArray</span><span class="token punctuation">(</span><span class="token string">"words_result"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>item <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">JSONObject</span> word <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">)</span> item<span class="token punctuation">;</span>
                sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>word<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"words"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span> sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token string">"Error processing image"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="6postm_225"></a>6、使用postm测试</h4> 
<p><img src="https://images2.imgbox.com/1d/c7/f7bRoDel_o.png" alt="image20231117173334187.png"></p> 
<h4><a id="_229"></a>效果：</h4> 
<p><img src="https://images2.imgbox.com/8f/46/KoTMbhmR_o.png" alt="image20231117173515001.png"></p> 
<blockquote> 
 <p>精准度很高，推荐使用，而且还有很多的精准度选择</p> 
</blockquote> 
<h4><a id="API_237"></a><strong>常用API</strong>：</h4> 
<h4><a id="httpsaibaiducomaidocOCRNkibizxlf_239"></a>https://ai.baidu.com/ai-doc/OCR/Nkibizxlf</h4> 
<ul><li> <h3><a id="_241"></a>通用文字识别</h3> <p>官网文档：https://ai.baidu.com/ai-doc/OCR/Nkibizxlf#%E9%80%9A%E7%94%A8%E6%96%87%E5%AD%97%E8%AF%86%E5%88%AB</p> 
  <ul><li> <pre><code class="prism language-java"><span class="token comment">//image为图片的二进制字节数组，options为传入可选参数调用接口</span>
<span class="token function">basicGeneral</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> image<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> options<span class="token punctuation">)</span> 
</code></pre> </li><li> <pre><code class="prism language-java"><span class="token comment">//image为图片的存放路径，options为传入可选参数调用接口</span>
<span class="token function">basicGeneral</span><span class="token punctuation">(</span><span class="token class-name">String</span> image<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> options<span class="token punctuation">)</span>
</code></pre> </li><li> <pre><code class="prism language-java"><span class="token comment">//image为图片的存放在服务器的路径，options为传入可选参数调用接口</span>
<span class="token function">basicGeneralUrl</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> options<span class="token punctuation">)</span>
</code></pre> </li></ul> </li><li> <h3><a id="_264"></a>通用文字识别（高精度版）</h3> <p>官网文档：https://ai.baidu.com/ai-doc/OCR/Nkibizxlf#%E9%80%9A%E7%94%A8%E6%96%87%E5%AD%97%E8%AF%86%E5%88%AB%EF%BC%88%E9%AB%98%E7%B2%BE%E5%BA%A6%E7%89%88%EF%BC%89</p> 
  <ul><li> <pre><code class="prism language-java"><span class="token comment">//image为图片的二进制字节数组，options为传入可选参数调用接口</span>
<span class="token function">basicAccurateGeneral</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> image<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> options<span class="token punctuation">)</span>
</code></pre> </li><li> <pre><code class="prism language-java"><span class="token comment">//image为本地图片的存放路径，options为传入可选参数调用接口</span>
<span class="token function">basicAccurateGeneral</span><span class="token punctuation">(</span><span class="token class-name">String</span> image<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> options<span class="token punctuation">)</span>
</code></pre> </li></ul> </li><li> <h3><a id="_280"></a>通用文字识别（含位置信息版）</h3> <p>官网文档：https://ai.baidu.com/ai-doc/OCR/Nkibizxlf#%E9%80%9A%E7%94%A8%E6%96%87%E5%AD%97%E8%AF%86%E5%88%AB%EF%BC%88%E5%90%AB%E4%BD%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E7%89%88%EF%BC%89</p> 
  <ul><li> <pre><code class="prism language-java"><span class="token comment">//image为图片的二进制字节数组，options为传入可选参数调用接口</span>
<span class="token function">general</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> image<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> options<span class="token punctuation">)</span>
</code></pre> </li><li> <pre><code class="prism language-java"><span class="token comment">//image为图片的存放路径，options为传入可选参数调用接口</span>
<span class="token function">general</span><span class="token punctuation">(</span><span class="token class-name">String</span> image<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> options<span class="token punctuation">)</span>
</code></pre> </li><li> <pre><code class="prism language-java"><span class="token comment">//image为图片的存放在服务器的路径，options为传入可选参数调用接口</span>
<span class="token function">generalUrl</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> options<span class="token punctuation">)</span>
</code></pre> </li></ul> </li><li> <h3><a id="_303"></a>通用文字识别（含位置高精度版）</h3> <p>官网文档：https://ai.baidu.com/ai-doc/OCR/Nkibizxlf#%E9%80%9A%E7%94%A8%E6%96%87%E5%AD%97%E8%AF%86%E5%88%AB%EF%BC%88%E5%90%AB%E4%BD%8D%E7%BD%AE%E9%AB%98%E7%B2%BE%E5%BA%A6%E7%89%88%EF%BC%89</p> 
  <ul><li> <pre><code class="prism language-java"><span class="token comment">//image为图片的二进制字节数组，options为传入可选参数调用接口</span>
<span class="token function">accurateGeneral</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> image<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> options<span class="token punctuation">)</span>
</code></pre> </li><li> <pre><code class="prism language-java"><span class="token comment">//image为图片的存放路径，options为传入可选参数调用接口</span>
<span class="token function">accurateGeneral</span><span class="token punctuation">(</span><span class="token class-name">String</span> image<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> options<span class="token punctuation">)</span>
</code></pre> </li></ul> </li><li> <h3><a id="_319"></a>通用文字识别（含生僻字版）</h3> <p>官网文档：https://ai.baidu.com/ai-doc/OCR/Nkibizxlf#%E9%80%9A%E7%94%A8%E6%96%87%E5%AD%97%E8%AF%86%E5%88%AB%EF%BC%88%E5%90%AB%E7%94%9F%E5%83%BB%E5%AD%97%E7%89%88%EF%BC%89</p> 
  <ul><li> <pre><code class="prism language-java"><span class="token function">enhancedGeneral</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> image<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> options<span class="token punctuation">)</span>
</code></pre> </li><li> <pre><code class="prism language-java"><span class="token function">enhancedGeneral</span><span class="token punctuation">(</span><span class="token class-name">String</span> image<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> options<span class="token punctuation">)</span>
</code></pre> </li><li> <pre><code class="prism language-java"><span class="token function">enhancedGeneralUrl</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> options<span class="token punctuation">)</span>
</code></pre> </li></ul> </li></ul> 
<h3><a id="_337"></a>整合阿里云阿里云</h3> 
<p>官方文档：https://next.api.aliyun.com/api-tools/sdk/ocr-api?spm=a2c4g.442247.0.0.40933e8eQ3GZIX&amp;version=2021-07-07&amp;language=java-tea&amp;tab=primer-doc</p> 
<p>https://next.api.aliyun.com/api/ocr-api/2021-07-07/RecognizeAdvanced?spm=api-workbench.SDK%20Document.0.0.2e7652e95jnhKE&amp;tab=DOC&amp;sdkStyle=dara&amp;lang=JAVA</p> 
<h4><a id="1_343"></a>1、引入依赖</h4> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.aliyun<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>ocr_api20210707<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h4><a id="2yml_353"></a>2、编写yml配置文件</h4> 
<pre><code class="prism language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8099</span>

<span class="token key atrule">aliyun</span><span class="token punctuation">:</span>
  <span class="token key atrule">KeyId</span><span class="token punctuation">:</span> <span class="token comment">#你的KeyId</span>
  <span class="token key atrule">KeySecret</span><span class="token punctuation">:</span> <span class="token comment">#你的KeySecret</span>
  <span class="token key atrule">endpoint</span><span class="token punctuation">:</span> ocr<span class="token punctuation">-</span>api.cn<span class="token punctuation">-</span>hangzhou.aliyuncs.com
</code></pre> 
<h4><a id="3_365"></a>3、编写配置类</h4> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"aliyun"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AliyunOcrConfig</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token class-name">KeyId</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token class-name">KeySecret</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> endpoint<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Client</span> <span class="token function">ocrClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>

            <span class="token class-name">Client</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Client</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAccessKeyId</span><span class="token punctuation">(</span><span class="token class-name">KeyId</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAccessKeySecret</span><span class="token punctuation">(</span><span class="token class-name">KeySecret</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setEndpoint</span><span class="token punctuation">(</span>endpoint<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> client<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="4_389"></a>4、编写测试接口</h4> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/api"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AliyunOcrController</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">Client</span> client<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"ocr"</span><span class="token punctuation">,</span>consumes <span class="token operator">=</span> <span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">MULTIPART_FORM_DATA_VALUE</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token class-name">OcrTest</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">RecognizeGeneralRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RecognizeGeneralRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">setBody</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">RecognizeGeneralResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">recognizeGeneral</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Gson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> split <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> split<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"\\"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//            return json;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">TeaException</span> error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Common</span><span class="token punctuation">.</span><span class="token function">assertAsString</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">TeaException</span> error <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TeaException</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 如有需要，请打印 error</span>
            <span class="token class-name">Common</span><span class="token punctuation">.</span><span class="token function">assertAsString</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="5postman_426"></a>5、使用postman测试</h4> 
<p><img src="https://images2.imgbox.com/70/f3/0Nwzj6Jr_o.png" alt="image20231118172215893.png"></p> 
<h3><a id="_436"></a>整合腾讯云实现</h3> 
<p>官网文档：https://cloud.tencent.com/document/product/866</p> 
<p>官网API：https://cloud.tencent.com/document/api/866/33515</p> 
<p>官网参数说明与在线调试：https://console.cloud.tencent.com/api/explorer?Product=ocr&amp;Version=2018-11-19&amp;Action=GeneralHandwritingOCR</p> 
<h4><a id="1_444"></a>1、获取密钥：</h4> 
<p><em>https://console.cloud.tencent.com/cam/capi</em></p> 
<h4><a id="2_448"></a>2、引入依赖</h4> 
<pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>tencentcloudapi<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>tencentcloud<span class="token operator">-</span>sdk<span class="token operator">-</span>java<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">3.1</span><span class="token number">.909</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> 
<h4><a id="3yml_458"></a>3、编写yml配置文件</h4> 
<pre><code class="prism language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9090</span>

<span class="token key atrule">tencent</span><span class="token punctuation">:</span>
  <span class="token key atrule">SecretId</span><span class="token punctuation">:</span> <span class="token comment">#你的SecretId</span>
  <span class="token key atrule">SecretKey</span><span class="token punctuation">:</span> <span class="token comment">#你的SecretKey</span>
</code></pre> 
<h4><a id="4_469"></a>4、编写配置类</h4> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"tencent"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TencentOcrConfig</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token class-name">SecretId</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token class-name">SecretKey</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Credential</span> <span class="token function">credential</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Credential</span><span class="token punctuation">(</span><span class="token class-name">SecretId</span><span class="token punctuation">,</span><span class="token class-name">SecretKey</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="5Base64_490"></a>5、编写将文件转换成Base64编码的工具类</h4> 
<p>由于腾讯云OCR的API接收的参数如下图，所以要编写将文件转码成Base64的工具类：</p> 
<p><img src="https://images2.imgbox.com/42/51/Fcdg9EjW_o.png" alt="image20231118140704897.png"></p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ByteToBase64Converter</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">encodeBytesToBase64</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="6_506"></a>6、编写接口测试</h4> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/api"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TencentOcrController</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">Credential</span> credential<span class="token punctuation">;</span>


    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/tencent"</span><span class="token punctuation">,</span>consumes <span class="token operator">=</span> <span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">MULTIPART_FORM_DATA_VALUE</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token class-name">TencentOCR</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TencentCloudSDKException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>

        <span class="token comment">// 实例化一个http选项，可选的，没有特殊需求可以跳过</span>
        <span class="token class-name">HttpProfile</span> httpProfile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpProfile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        httpProfile<span class="token punctuation">.</span><span class="token function">setEndpoint</span><span class="token punctuation">(</span><span class="token string">"ocr.tencentcloudapi.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 实例化一个client选项，可选的，没有特殊需求可以跳过</span>
        <span class="token class-name">ClientProfile</span> clientProfile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClientProfile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        clientProfile<span class="token punctuation">.</span><span class="token function">setHttpProfile</span><span class="token punctuation">(</span>httpProfile<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 实例化要请求产品的client对象,clientProfile是可选的</span>
        <span class="token class-name">OcrClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OcrClient</span><span class="token punctuation">(</span>credential<span class="token punctuation">,</span> <span class="token string">"ap-guangzhou"</span><span class="token punctuation">,</span> clientProfile<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//将上传的文件转换成base64编码</span>
        <span class="token class-name">String</span> encodeBytesToBase64 <span class="token operator">=</span> <span class="token class-name">ByteToBase64Converter</span><span class="token punctuation">.</span><span class="token function">encodeBytesToBase64</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">// 实例化一个请求对象,每个接口都会对应一个request对象</span>
        <span class="token class-name">GeneralBasicOCRRequest</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GeneralBasicOCRRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        req<span class="token punctuation">.</span><span class="token function">setImageBase64</span><span class="token punctuation">(</span>encodeBytesToBase64<span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token comment">// req.setImageUrl("https://ltmyblog.oss-cn-shenzhen.aliyuncs.com/myBlog/article/image-20230924213423855.png");</span>

        <span class="token comment">// 返回的resp是一个GeneralBasicOCRResponse的实例，与请求对象对应</span>
        <span class="token class-name">GeneralBasicOCRResponse</span> resp <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">client<span class="token punctuation">.</span></span>GeneralBasicOCR</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token class-name">GeneralBasicOCRResponse</span><span class="token punctuation">.</span><span class="token function">toJsonString</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 输出json格式的字符串回包</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">GeneralBasicOCRResponse</span><span class="token punctuation">.</span><span class="token function">toJsonString</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">GeneralBasicOCRResponse</span><span class="token punctuation">.</span><span class="token function">toJsonString</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="7postman_554"></a>7、使用postman测试</h4> 
<p><img src="https://images2.imgbox.com/03/39/2W93gWbm_o.png" alt="image20231118155218507.png"></p> 
<blockquote> 
 <p>本文的全部案例：https://github.com/rookiesnewbie/OCR</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7cb1264af90c8fbddff2b05e06ae9d7b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VSCode安装，配置，编译运行C&#43;&#43;（详细整理）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/547c64084f7249a62e9da98ab53c583e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">前端-relation-graph实现关系数据展示（关系图/流程图）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>