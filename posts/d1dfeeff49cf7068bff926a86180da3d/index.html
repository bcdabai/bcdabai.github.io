<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>优化 js中的if  else-if  语句 过多的情况 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="优化 js中的if  else-if  语句 过多的情况" />
<meta property="og:description" content="像这种代码就很打脑壳~
// 贷款申请操作的处理 function check() { // 是否输入正确用户名 if (this.checkUsername(this.username)) { // 是否输入正确身份证号 if (this.checkIdCard(this.idCard)) { // 请输入正确的电话号码 if (this.checkTel(this.tel)) { // 担保人是本人 if (this.dbr === &#39;担保人是本人&#39;) { // 是否存在身份证正面 if (document.querySelector(&#39;.sfzzm img&#39;)) { console.log(&#39;存在身份证正面&#39;) // 是否存在身份证反面 if (document.querySelector(&#39;.sfzfm img&#39;)) { console.log(&#39;存在身份证反面&#39;) // 是否存在学历证书 if (document.querySelector(&#39;.xlzs img&#39;)) { console.log(&#39;存在学历证书&#39;) if (this.ydxy) { this.tijiaoIsShow = false } } else { Toast(&#39;请上传学历证书&#39;) this.tijiaoIsShow = true } } else { Toast(&#39;请上传身份证反面&#39;) } } else { Toast(&#39;请上传身份证正面&#39;) } } else if (this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/d1dfeeff49cf7068bff926a86180da3d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-05T13:49:00+08:00" />
<meta property="article:modified_time" content="2021-06-05T13:49:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">优化 js中的if  else-if  语句 过多的情况</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html" style="font-size: 16px;"> 
 <p>像这种代码就很打脑壳~</p> 
 <div class="cnblogs_code"> 
  <div id="cnblogs_code_open_9ce7f728-a24e-4254-8d67-e88b90a61971" class="cnblogs_code_hide"> 
   <pre><code class="has">// 贷款申请操作的处理
function check() {
  // 是否输入正确用户名
  if (this.checkUsername(this.username)) {
    // 是否输入正确身份证号
    if (this.checkIdCard(this.idCard)) {
      // 请输入正确的电话号码
      if (this.checkTel(this.tel)) {
        // 担保人是本人
        if (this.dbr === '担保人是本人') {
          // 是否存在身份证正面
          if (document.querySelector('.sfzzm img')) {
            console.log('存在身份证正面')
            // 是否存在身份证反面
            if (document.querySelector('.sfzfm img')) {
              console.log('存在身份证反面')
              // 是否存在学历证书
              if (document.querySelector('.xlzs img')) {
                console.log('存在学历证书')
                if (this.ydxy) {
                  this.tijiaoIsShow = false
                }
              } else {
                Toast('请上传学历证书')
                this.tijiaoIsShow = true
              }
            } else {
              Toast('请上传身份证反面') 
            }
          } else {
            Toast('请上传身份证正面')
          }
        } else if (this.dbr == '担保人不是本人') {
          if (this.checkUsername(this.dbrname)) {
            if (this.checkIdCard(this.dbridCard)) {
              if (this.checkTel(this.dbrzyzh)) {
                if (document.querySelector('.sfzzm img')) {
                  console.log('存在身份证正面')
                  if (document.querySelector('.sfzfm img')) {
                    console.log('存在身份证反面')
                    if (document.querySelector('.xlzs img')) {
                      console.log('存在学历证书')
                      this.tijiaoIsShow = false
                    } else {
                      Toast('请上传学历证书')
                    }
                  } else {
                    Toast('请上传身份证反面')
                  }
                } else {
                  Toast('请上传身份证正面')
                }
              } else {
                Toast('请输入担保人展业证号')
              }
            } else {
              Toast('请输入担保人身份证号')
            }
          } else {
            Toast('请输入担保人姓名')
          }
        } else {
          Toast('请选择担保人是否为本人')
        }
      } else {
        Toast('请输入正确的电话号码')
      }
    } else {
      Toast('请输入正确的身份证号')
    }
  } else {
    Toast('请输入正确的姓名')
  }
}</code>
</pre> 
  </div> 
  <span class="cnblogs_code_collapse">View Code</span> 
 </div> 
 <h3>单个if语句优化</h3> 
 <p><strong>优化前</strong></p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">if (flag) {
 this.handleFn()
}</code>
</pre> 
 </div> 
 <p><strong>优化后</strong></p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">flag &amp;&amp; this.handleFn()
// handleFn是普通函数</code>
</pre> 
 </div> 
 <p>另外如果遇到有很多的<code>if</code>语句，但是执行的功能函数却是一致的情况，我们可以用”逻辑与“或者”逻辑或“来把他们合并成一个表达式。如果我们这些彼此独立的条件判断可以被视为同一次检查的场景时，一次检查的意图明显在可读性上优于多次的条件检查。我们来看一段代码片段:</p> 
 <p><strong>优化前</strong></p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">if (!(staffInfo.patientName &amp;&amp; staffInfo.phone)) {
  // doSomething
}
...
if (!(staffInfo.phone &amp;&amp; staffInfo.idCardNum)) {
  // doSomething
}</code>
</pre> 
 </div> 
 <p><strong>优化后</strong></p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">if(!(staffInfo.patientName &amp;&amp; staffInfo.phone) || !(staffInfo.phone &amp;&amp; staffInfo.idCardNum)){
  // doSomething
} </code>
</pre> 
 </div> 
 <h3>if/else语句优化</h3> 
 <p><code>if/else</code>可以说在项目中遇到频率是最高，通常可以这两种策略优化</p> 
 <ul class="list-paddingleft-2"><li>排非策略</li><li>三元运算符</li></ul> 
 <h4>排非策略</h4> 
 <p>比如用户登录场景，如果用户名和密码输入框为空，那么我们就提示用户”用户名和密码不能为空”；如果有值，就执行登录的操作。</p> 
 <p><strong>优化前</strong></p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">  if (user &amp;&amp; password) {
        // 逻辑处理
    } else {
        throw('用户名和密码不能为空!')
    }</code>
</pre> 
 </div> 
 <p><strong>优化后</strong></p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">if (!user || !password) return throw('用户名和密码不能为空!')
// 逻辑处理</code>
</pre> 
 </div> 
 <p>表单提交时，需要提前排除那些提交不规范的内容，通常情况下，表单提交遇到不符合我们要求大于我们提交成功的情形，排非策略是个很不错的选择。</p> 
 <h4>三元运算符</h4> 
 <p><strong>示例一</strong></p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">let allow = null
if(age &gt;= 18){ 
   allow = '通过'; 
} else { 
   allow = '拒绝'; 
}

// 优化后
let allow = age &gt;= 18 ? '通过' : '拒绝</code>
</pre> 
 </div> 
 <p><strong>示例二</strong></p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">if (flag) {
 success();
} else {
 fail();
}
  
//优化后
flag ? success() : fail();</code>
</pre> 
 </div> 
 <p>三元运算符相比<code>if/else</code>来说，只需一行语句，代码简练精炼</p> 
 <h3>单个if多条件优化</h3> 
 <p><strong>优化前</strong></p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">function test(type) {
  if (type === 'jpg' || type === 'png' || type === 'gif' || type === 'svg') {
    console.log("该文件为图片");
  }
}</code>
</pre> 
 </div> 
 <p><strong>优化后</strong></p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">function test(type) {
    const imgArr = ['jpg', 'png', 'gif', 'svg']
    if (imgArr.includes(type)) {
        console.log("该文件为图片")
    }
}</code>
</pre> 
 </div> 
 <h3>多个else if分支优化</h3> 
 <p>多个<code>else if</code>通常是一个糟糕的选择，它导致设计复杂，代码可读性差，并且可能导致重构困难。</p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">if (this.type === 'A') {
  this.handleA();
} else if (this.type === 'B') {
  this.handleB();
} else if (this.type === 'C') {
  this.handleC();
} else if (this.type === 'D') {
  this.handleD();
} else {
  this.handleE();
}</code>
</pre> 
 </div> 
 <p>我们经常遇到多个<code>else if</code>条件判断代码，随着逻辑复杂性的增加，<code>else if</code>的代码将变得越来越肿。</p> 
 <p></p> 
 <div style="text-align: center;"> 
  <img src="https://images2.imgbox.com/3c/17/80qMRsL0_o.png" alt="" style="outline: none;"> 
 </div> 
 <p>从上面的流程图可以看出，不同条件分支的代码具有很高的耦合度。先前的条件判断将影响后续的代码流，并且此类代码在后续开发中难以维护。我们可以通过<code>switch</code>、<code>key-value</code>和<code>Map</code>来优化代码。</p> 
 <h4>switch</h4> 
 <div class="cnblogs_code"> 
  <pre><code class="has">  switch(val){
    case 'A':
      handleA()
      break
    case 'B':
      handleB()
      break
    case 'C':
      handleC()
      break
    case 'D':
      handleD()
      break
  }</code>
</pre> 
 </div> 
 <h4>key-value</h4> 
 <p>虽然<code>switch</code>语句在逻辑上确实比<code>else if</code>语句简单，但是代码本身也有点多。</p> 
 <p>其实我们对象枚举，将条件与特定操作相关联的键值</p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">let enums = {
  'A': handleA,
  'B': handleB,
  'C': handleC,
  'D': handleD,
  'E': handleE
}
function action(val){
  let handleType = enums[val]
  handleType()
}</code>
</pre> 
 </div> 
 <p>这种方式<strong>消除了所有条件语句，并使用键值对象存储条件和操作之间的关系</strong>。当我们需要根据条件执行代码时，我们不再需要使用<code>else if</code>或<code>switch</code>语句来处理相应的动作，我们只需从中提取相应的函数handleType并执行它即可。</p> 
 <h4>Map</h4> 
 <p>实际上我们还可以通过<code>Map</code>来进一步的优化我们的代码。</p> 
 <p>对比<code>Object</code>的话，<code>Map</code>具有许多优点</p> 
 <ul class="list-paddingleft-2"><li>对象的键只能是字符串或符号，而<code>Map</code>的键可以是任何类型的值。</li><li>我们可以使用<code>Map size</code>属性轻松获取<code>Map</code>的键/值对的数量，而对象的键/值对的数量只能手动确定。</li><li>具有极快的查找速度。</li></ul> 
 <p>上面的例子可以优化如下：</p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">let enums = new Map([
  ['A', handleA],
  ['B', handleB],
  ['C', handleC],
  ['D', handleD],
  ['E', handleE]
])

function action(val){
  let handleType = enums(val)
  handleType()
}</code>
</pre> 
 </div> 
 <p>如果我们遇到<strong>多层复杂条件</strong>，<code>Map</code>语句优势就更明显了！</p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">if (mode == 'kline') {
    if (this.type === 'A') {
        this.handleA()
    } else if (this.type === 'B') {
        this.handleB()
    } else if (this.type === 'C') {
        this.handleC()
    } else if (this.type === 'D') {
        this.handleD()
    }
} else if ((mode = 'depth')) {
    if (this.type === 'A') {
        this.handleA()
    } else if (this.type === 'B') {
        this.handleB()
    } else if (this.type === 'C') {
        this.handleC()
    } else if (this.type === 'D') {
        this.handleD()
    }
}</code>
</pre> 
 </div> 
 <p>对于上述如此复杂的场景，是否可以通过<code>Map</code>来进行优化？</p> 
 <p>其实我们只需要将不同的判断语句连接成一个字符串，以便我们可以将条件和操作以键值格式关联在一起。</p> 
 <div class="cnblogs_code"> 
  <pre><code class="has">let enums = new Map([
  ['kline_A', handleKlineA],
  ['kline_B', handleKlineB],
  ['kline_C', handleKlineC],
  ['kline_D', handleKlineD],
  ['kline_E', handleKlineE],
  ['depth_A', handleDepthA],
  ['depth_B', handleDepthB],
  ['depth_C', handleDepthC],
])

function action(mode, type){
  let key = `${mode}_${type}`
  let handleType = enums(key)
  handleType()
}</code>
</pre> 
 </div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a4dfa9e5d6abe713226e4d278ba8c6b3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">html主题切换,vue 切换主题（换肤）功能</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d19eeac861264074c63882fa179b9d77/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">hive3.1.2 hiveserver启动报错 报tez配置找不到</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>