<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习实战：Python基于LDA线性判别模型进行分类预测（五） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习实战：Python基于LDA线性判别模型进行分类预测（五）" />
<meta property="og:description" content="文章目录 1 前言1.1 线性判别模型的介绍1.2 线性判别模型的应用 2 demo数据演示2.1 导入函数2.2 训练模型2.3 预测模型 3 LDA手写数字数据演示3.1 导入函数3.2 导入数据3.3 输出图像3.4 建立模型3.5 预测模型 4 讨论 1 前言 1.1 线性判别模型的介绍 线性判别模型（Linear Discriminant Analysis，LDA）是一种经典的监督学习算法，它旨在通过学习输入特征和它们所属类别之间的线性关系来进行分类任务。线性判别模型通常可以被看作是一种分类器，可以用于二元分类和多元分类问题。
线性判别模型的主要思想是将输入特征空间中的样本投影到一条直线或者一个超平面上，从而实现对样本的分类。这个超平面的选择是通过最小化类内距离和最大化类间距离来完成的。类内距离指的是同一类别样本之间的距离，类间距离则指不同类别样本之间的距离。通过最小化类内距离和最大化类间距离，线性判别模型能够更好地区分不同类别的样本。
优点：
线性判别模型是一种经典的监督学习算法，具有较高的可解释性和可理解性，能够提供直观的结果。
线性判别模型具有较快的训练速度和较低的存储成本，适用于处理大型数据集。
线性判别模型能够在高维数据中很好地工作，并且在特征选择方面具有很好的性能。
缺点：
线性判别模型是一种线性模型，对于非线性分类问题的表现可能较差。
线性判别模型对于噪声数据和异常值比较敏感，容易造成误分类。
线性判别模型的分类效果受特征之间相关性的影响，如果存在高度相关的特征，分类效果可能较差。
1.2 线性判别模型的应用 线性判别模型广泛应用于数据分类、降维和特征提取等领域，在实际应用中有很多场景，例如：
信用评分：根据用户的个人信息和历史数据，对其信用评分进行分类，以决定是否批准贷款。
医学诊断：根据患者的生理指标和症状，将其分为健康和患病两类，以进行诊断和治疗。
人脸识别：根据人脸图像的特征向量，将其分为不同的人脸类别，以实现人脸识别和身份验证。
情感分析：根据文本内容中的关键词和情感指标，将其分为正面、负面和中性等不同的情感类别。
图像分类：根据图像的特征向量，将其分为不同的图像类别，以进行图像识别和分类等。
在生信领域还是常用于基因表达数据分析、蛋白结构预测、biomarker鉴定和药物设计，LDA可以用于分析分子结构和描述化学性质，从而优化药物设计和发现。
2 demo数据演示 2.1 导入函数 import numpy as np import matplotlib.pyplot as plt from mpl_toolkits.mplot3d import Axes3D from sklearn.discriminant_analysis import LinearDiscriminantAnalysis from sklearn.datasets import make_classification 2.2 训练模型 # 制作四个类别的数据，每个类别100个样本 X, y = make_classification(n_samples=1000, n_features=3, n_redundant=0, n_classes=4, n_informative=2, n_clusters_per_class=1, class_sep=3, random_state=10) # 可视化分布 fig = plt." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ea3f1941e803d083de88eb11a74651b7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-19T11:12:06+08:00" />
<meta property="article:modified_time" content="2023-04-19T11:12:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习实战：Python基于LDA线性判别模型进行分类预测（五）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#1__1" rel="nofollow">1 前言</a></li><li><ul><li><a href="#11__2" rel="nofollow">1.1 线性判别模型的介绍</a></li><li><a href="#12__23" rel="nofollow">1.2 线性判别模型的应用</a></li></ul> 
   </li><li><a href="#2_demo_38" rel="nofollow">2 demo数据演示</a></li><li><ul><li><a href="#21__39" rel="nofollow">2.1 导入函数</a></li><li><a href="#22__49" rel="nofollow">2.2 训练模型</a></li><li><a href="#23__80" rel="nofollow">2.3 预测模型</a></li></ul> 
   </li><li><a href="#3_LDA_117" rel="nofollow">3 LDA手写数字数据演示</a></li><li><ul><li><a href="#31__118" rel="nofollow">3.1 导入函数</a></li><li><a href="#32__128" rel="nofollow">3.2 导入数据</a></li><li><a href="#33__142" rel="nofollow">3.3 输出图像</a></li><li><a href="#34__158" rel="nofollow">3.4 建立模型</a></li><li><a href="#35__176" rel="nofollow">3.5 预测模型</a></li></ul> 
   </li><li><a href="#4__217" rel="nofollow">4 讨论</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="1__1"></a>1 前言</h3> 
<h4><a id="11__2"></a>1.1 线性判别模型的介绍</h4> 
<p>线性判别模型（<strong>Linear Discriminant Analysis，LDA</strong>）是一种经典的监督学习算法，它旨在通过学习输入特征和它们所属类别之间的线性关系来进行分类任务。线性判别模型通常可以被看作是一种分类器，可以用于二元分类和多元分类问题。</p> 
<p>线性判别模型的主要思想是将输入特征空间中的样本投影到一条直线或者一个超平面上，从而实现对样本的分类。这个超平面的选择是通过最小化类内距离和最大化类间距离来完成的。类内距离指的是同一类别样本之间的距离，类间距离则指不同类别样本之间的距离。通过最小化类内距离和最大化类间距离，线性判别模型能够更好地区分不同类别的样本。</p> 
<p><strong>优点：</strong></p> 
<ul><li> <p>线性判别模型是一种经典的监督学习算法，具有较高的可解释性和可理解性，能够提供直观的结果。</p> </li><li> <p>线性判别模型具有较快的训练速度和较低的存储成本，适用于处理大型数据集。</p> </li><li> <p>线性判别模型能够在高维数据中很好地工作，并且在特征选择方面具有很好的性能。</p> </li></ul> 
<p><strong>缺点：</strong></p> 
<ul><li> <p>线性判别模型是一种线性模型，对于非线性分类问题的表现可能较差。</p> </li><li> <p>线性判别模型对于噪声数据和异常值比较敏感，容易造成误分类。</p> </li><li> <p>线性判别模型的分类效果受特征之间相关性的影响，如果存在高度相关的特征，分类效果可能较差。</p> </li></ul> 
<h4><a id="12__23"></a>1.2 线性判别模型的应用</h4> 
<p>线性判别模型广泛应用于数据分类、降维和特征提取等领域，在实际应用中有很多场景，例如：</p> 
<ol><li> <p>信用评分：根据用户的个人信息和历史数据，对其信用评分进行分类，以决定是否批准贷款。</p> </li><li> <p>医学诊断：根据患者的生理指标和症状，将其分为健康和患病两类，以进行诊断和治疗。</p> </li><li> <p>人脸识别：根据人脸图像的特征向量，将其分为不同的人脸类别，以实现人脸识别和身份验证。</p> </li><li> <p>情感分析：根据文本内容中的关键词和情感指标，将其分为正面、负面和中性等不同的情感类别。</p> </li><li> <p>图像分类：根据图像的特征向量，将其分为不同的图像类别，以进行图像识别和分类等。</p> </li></ol> 
<p>在生信领域还是常用于基因表达数据分析、蛋白结构预测、biomarker鉴定和药物设计，LDA可以用于分析分子结构和描述化学性质，从而优化药物设计和发现。</p> 
<h3><a id="2_demo_38"></a>2 demo数据演示</h3> 
<h4><a id="21__39"></a>2.1 导入函数</h4> 
<pre><code class="prism language-py"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np 
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt 
<span class="token keyword">from</span> mpl_toolkits<span class="token punctuation">.</span>mplot3d <span class="token keyword">import</span> Axes3D
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>discriminant_analysis <span class="token keyword">import</span> LinearDiscriminantAnalysis
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_classification
</code></pre> 
<h4><a id="22__49"></a>2.2 训练模型</h4> 
<pre><code class="prism language-py"><span class="token comment"># 制作四个类别的数据，每个类别100个样本</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> make_classification<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> n_redundant<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
                           n_classes<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> n_informative<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> n_clusters_per_class<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>
                           class_sep<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment"># 可视化分布</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
ax <span class="token operator">=</span> Axes3D<span class="token punctuation">(</span>fig<span class="token punctuation">,</span> rect<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> elev<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> azim<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>auto_add_to_figure<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
fig<span class="token punctuation">.</span>add_axes<span class="token punctuation">(</span>ax<span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/98/ba/GFBD4Sbm_o.png" alt=""></p> 
<p>建模</p> 
<pre><code class="prism language-py"><span class="token comment"># 建立 LDA 模型</span>
lda <span class="token operator">=</span> LinearDiscriminantAnalysis<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 训练模型</span>
lda<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token comment"># 查看 LDA 模型的参数</span>
lda<span class="token punctuation">.</span>get_params<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/56/b3/XLdw1NMy_o.png" alt=""></p> 
<h4><a id="23__80"></a>2.3 预测模型</h4> 
<pre><code class="prism language-py"><span class="token comment"># 进行模型预测</span>
X_new <span class="token operator">=</span> lda<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token comment"># 可视化预测数据</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_new<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X_new<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e1/38/cZVOs6AD_o.png" alt=""></p> 
<p>用新数据测试</p> 
<pre><code class="prism language-py">a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>a<span class="token punctuation">}</span></span><span class="token string"> 类别是: "</span></span><span class="token punctuation">,</span> lda<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>a<span class="token punctuation">}</span></span><span class="token string"> 类别概率分别是: "</span></span><span class="token punctuation">,</span> lda<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>

a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">91</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>a<span class="token punctuation">}</span></span><span class="token string"> 类别是: "</span></span><span class="token punctuation">,</span> lda<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>a<span class="token punctuation">}</span></span><span class="token string"> 类别概率分别是: "</span></span><span class="token punctuation">,</span> lda<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>

a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>a<span class="token punctuation">}</span></span><span class="token string"> 类别是: "</span></span><span class="token punctuation">,</span> lda<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>a<span class="token punctuation">}</span></span><span class="token string"> 类别概率分别是: "</span></span><span class="token punctuation">,</span> lda<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>

a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">90.1</span><span class="token punctuation">,</span> <span class="token number">9.1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>a<span class="token punctuation">}</span></span><span class="token string"> 类别是: "</span></span><span class="token punctuation">,</span> lda<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>a<span class="token punctuation">}</span></span><span class="token string"> 类别概率分别是: "</span></span><span class="token punctuation">,</span> lda<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/e0/56/Z4Y1X3iM_o.png" alt=""></p> 
<h3><a id="3_LDA_117"></a>3 LDA手写数字数据演示</h3> 
<h4><a id="31__118"></a>3.1 导入函数</h4> 
<pre><code class="prism language-py"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_digits
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>discriminant_analysis <span class="token keyword">import</span> LinearDiscriminantAnalysis
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report<span class="token punctuation">,</span> confusion_matrix
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> matplotlib
</code></pre> 
<h4><a id="32__128"></a>3.2 导入数据</h4> 
<pre><code class="prism language-py"><span class="token comment"># 导入MNIST数据集</span>
mnist <span class="token operator">=</span> load_digits<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 查看数据集信息</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The Mnist dataeset:\n'</span><span class="token punctuation">,</span>mnist<span class="token punctuation">)</span>
<span class="token comment"># 分割数据为训练集和测试集,7/3分</span>
x<span class="token punctuation">,</span> test_x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_y <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>mnist<span class="token punctuation">.</span>data<span class="token punctuation">,</span> mnist<span class="token punctuation">.</span>target<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a5/7b/iDBQcc8F_o.png" alt=""></p> 
<h4><a id="33__142"></a>3.3 输出图像</h4> 
<pre><code class="prism language-py">images <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>dpi<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> images<span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">330</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> i<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cmap <span class="token operator">=</span> matplotlib<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>binary<span class="token punctuation">,</span>interpolation<span class="token operator">=</span><span class="token string">"nearest"</span><span class="token punctuation">)</span>
<span class="token comment"># show the plot</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c5/38/Mx1bm2PZ_o.png" alt=""></p> 
<h4><a id="34__158"></a>3.4 建立模型</h4> 
<pre><code class="prism language-py"><span class="token comment"># 建立 LDA 模型</span>
m_lda <span class="token operator">=</span> LinearDiscriminantAnalysis<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 训练模型</span>
m_lda<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token comment"># 进行模型预测</span>
x_new <span class="token operator">=</span> m_lda<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token comment"># 可视化预测数据</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x_new<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x_new<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'MNIST with LDA Model'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/27/78/fGTzSqTq_o.png" alt=""></p> 
<h4><a id="35__176"></a>3.5 预测模型</h4> 
<pre><code class="prism language-py">y_test_pred <span class="token operator">=</span> m_lda<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_x<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"测试集的真实标签:\n"</span><span class="token punctuation">,</span> test_y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"测试集的预测标签:\n"</span><span class="token punctuation">,</span> y_test_pred<span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b3/d8/0F0pGbVU_o.png" alt=""></p> 
<pre><code class="prism language-py"><span class="token comment"># 统计结果指标</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>test_y<span class="token punctuation">,</span> y_test_pred<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f6/e6/PkGdqIXq_o.png" alt=""></p> 
<pre><code class="prism language-py"><span class="token comment"># 计算混淆矩阵</span>
C2 <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>test_y<span class="token punctuation">,</span> y_test_pred<span class="token punctuation">)</span>
<span class="token comment"># 打混淆矩阵</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>C2<span class="token punctuation">)</span>

<span class="token comment"># 将混淆矩阵以热力图的防线显示</span>
sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
f<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 画热力图</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>C2<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">"YlGnBu_r"</span><span class="token punctuation">,</span> annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> ax<span class="token operator">=</span>ax<span class="token punctuation">)</span>  
<span class="token comment"># 标题 </span>
ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'confusion matrix'</span><span class="token punctuation">)</span>
<span class="token comment"># x轴为预测类别</span>
ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'predict'</span><span class="token punctuation">)</span>  
<span class="token comment"># y轴实际类别</span>
ax<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'true'</span><span class="token punctuation">)</span>  
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/71/73/vSfWJrhc_o.png" alt=""></p> 
<h3><a id="4__217"></a>4 讨论</h3> 
<p>LDA模型还是比较简明扼要的，主要是针对于<strong>线性可分数据</strong>，判别目的就是使同类别的距离相近，使不同类别的距离隔远。对于<strong>非线性可分数据</strong>需要特别留意实际情况。</p> 
<p>LDA是一种监督学习的降维技术，且每个样本都是区分类别输出的；区别于PCA，PCA是不考虑样本类别的无监督降维技术，但是目的是一样的，都可以理解为将同类别的数据。相比于后者，LDA我认为<strong>最大的优势</strong>就是基于监督可以参考类别的先验经验，即可以不断“叠加”；然鹅<strong>很硬性的一个缺点</strong>就是不适合对非高斯分布样本进行降维，这个问题PCA也存在。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/385a95e0102deb4f24970416d792c3bc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">深元AI盒子在矿山安全生产中实现皮带跑偏、异物、煤流量、大块煤等识别</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4eff33d658f10ec0ae5dfeea2366a44e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringMVC笔记</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>