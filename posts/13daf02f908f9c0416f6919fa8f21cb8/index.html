<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>skLearn 特征工程 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="skLearn 特征工程" />
<meta property="og:description" content="参考：https://github.com/fuqiuai/sklearn-feature-engineering from sklearn.feature_selection import SelectFromModel from sklearn.linear_model import LogisticRegression from sklearn.feature_selection import RFE from sklearn.feature_selection import chi2 from sklearn.feature_selection import SelectKBest from sklearn.feature_selection import VarianceThreshold from sklearn.preprocessing import FunctionTransformer from numpy import log1p from sklearn.preprocessing import PolynomialFeatures from sklearn.impute import SimpleImputer as Imputer from numpy import vstack, array, nan from sklearn.preprocessing import OneHotEncoder from sklearn.preprocessing import Binarizer from sklearn.preprocessing import Normalizer from sklearn.preprocessing import MinMaxScaler from sklearn.preprocessing import StandardScaler from sklearn." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/13daf02f908f9c0416f6919fa8f21cb8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-20T10:58:23+08:00" />
<meta property="article:modified_time" content="2021-07-20T10:58:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">skLearn 特征工程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre><code class="prism language-php">参考：<span class="token argument-name">https</span><span class="token punctuation">:</span><span class="token comment">//github.com/fuqiuai/sklearn-feature-engineering</span>
</code></pre> 
<pre><code class="prism language-php">from sklearn<span class="token operator">.</span>feature_selection import SelectFromModel
from sklearn<span class="token operator">.</span>linear_model import LogisticRegression
from sklearn<span class="token operator">.</span>feature_selection import <span class="token constant">RFE</span>
from sklearn<span class="token operator">.</span>feature_selection import chi2
from sklearn<span class="token operator">.</span>feature_selection import SelectKBest
from sklearn<span class="token operator">.</span>feature_selection import VarianceThreshold
from sklearn<span class="token operator">.</span>preprocessing import FunctionTransformer
from numpy import log1p
from sklearn<span class="token operator">.</span>preprocessing import PolynomialFeatures
from sklearn<span class="token operator">.</span>impute import SimpleImputer <span class="token keyword">as</span> Imputer
from numpy import vstack<span class="token punctuation">,</span> <span class="token keyword type-declaration">array</span><span class="token punctuation">,</span> nan
from sklearn<span class="token operator">.</span>preprocessing import OneHotEncoder
from sklearn<span class="token operator">.</span>preprocessing import Binarizer
from sklearn<span class="token operator">.</span>preprocessing import Normalizer
from sklearn<span class="token operator">.</span>preprocessing import MinMaxScaler
from sklearn<span class="token operator">.</span>preprocessing import StandardScaler
from sklearn<span class="token operator">.</span>datasets import load_iris

<span class="token comment"># 导入IRIS数据集</span>
iris <span class="token operator">=</span> <span class="token function">load_iris</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 特征矩阵</span>
iris<span class="token operator">.</span>data

<span class="token comment"># 目标向量</span>
iris<span class="token operator">.</span>target
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"original"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>iris<span class="token operator">.</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"---------------------"</span><span class="token punctuation">)</span>


<span class="token comment"># 标准化，返回值为标准化后的数据</span>
iris1 <span class="token operator">=</span> <span class="token function">StandardScaler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">fit_transform</span><span class="token punctuation">(</span>iris<span class="token operator">.</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"after standardlize"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>iris1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"---------------------"</span><span class="token punctuation">)</span>

<span class="token comment"># 区间缩放，返回值为缩放到[0, 1]区间的数据</span>
iris2 <span class="token operator">=</span> <span class="token function">MinMaxScaler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">fit_transform</span><span class="token punctuation">(</span>iris<span class="token operator">.</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0-1"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>iris2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"---------------------"</span><span class="token punctuation">)</span>

<span class="token comment"># 归一化，返回值为归一化后的数据</span>
iris3 <span class="token operator">=</span> <span class="token function">Normalizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">fit_transform</span><span class="token punctuation">(</span>iris<span class="token operator">.</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"after normalized"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>iris3<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"---------------------"</span><span class="token punctuation">)</span>


<span class="token comment"># 二值化，阈值设置为3，返回值为二值化后的数据</span>
iris4 <span class="token operator">=</span> <span class="token function">Binarizer</span><span class="token punctuation">(</span>threshold<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">fit_transform</span><span class="token punctuation">(</span>iris<span class="token operator">.</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"after binarized"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>iris4<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"---------------------"</span><span class="token punctuation">)</span>

<span class="token comment"># 哑编码，对IRIS数据集的目标值，返回值为哑编码后的数据</span>
iris5 <span class="token operator">=</span> <span class="token function">OneHotEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">fit_transform</span><span class="token punctuation">(</span>iris<span class="token operator">.</span>target<span class="token operator">.</span><span class="token function">reshape</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"after oneHot"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>iris5<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"---------------------"</span><span class="token punctuation">)</span>


<span class="token comment"># 缺失值计算，返回值为计算缺失值后的数据</span>
<span class="token comment"># 参数missing_value为缺失值的表示形式，默认为NaN</span>
<span class="token comment"># 参数strategy为缺失值填充方式，默认为mean（均值）</span>
iris6 <span class="token operator">=</span> <span class="token function">vstack</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>nan<span class="token punctuation">,</span> nan<span class="token punctuation">,</span> nan<span class="token punctuation">,</span> nan<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> iris<span class="token operator">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"add nan nan nan nan to the data:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>iris6<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"---------------------"</span><span class="token punctuation">)</span>

iris7 <span class="token operator">=</span> <span class="token function">Imputer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">fit_transform</span><span class="token punctuation">(</span>
    <span class="token function">vstack</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">[</span>nan<span class="token punctuation">,</span> nan<span class="token punctuation">,</span> nan<span class="token punctuation">,</span> nan<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> iris<span class="token operator">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"after fill the nan with mean:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>iris7<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"---------------------"</span><span class="token punctuation">)</span>


<span class="token comment"># 多项式转换</span>
<span class="token comment"># 参数degree为度，默认值为2</span>
iris8 <span class="token operator">=</span> <span class="token function">PolynomialFeatures</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">fit_transform</span><span class="token punctuation">(</span>iris<span class="token operator">.</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"after PolynomialFeatures:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>iris8<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"---------------------"</span><span class="token punctuation">)</span>

<span class="token comment"># 自定义转换函数为对数函数的数据变换</span>
<span class="token comment"># 第一个参数是单变元函数</span>
iris9 <span class="token operator">=</span> <span class="token function">FunctionTransformer</span><span class="token punctuation">(</span>log1p<span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">fit_transform</span><span class="token punctuation">(</span>iris<span class="token operator">.</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"after FunctionTransformer:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>iris9<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"---------------------"</span><span class="token punctuation">)</span>


<span class="token comment"># 方差选择法，返回值为特征选择后的数据</span>
<span class="token comment"># 参数threshold为方差的阈值</span>
iris10 <span class="token operator">=</span> <span class="token function">VarianceThreshold</span><span class="token punctuation">(</span>threshold<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">fit_transform</span><span class="token punctuation">(</span>iris<span class="token operator">.</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"VarianceThreshold:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>iris10<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"---------------------"</span><span class="token punctuation">)</span>


<span class="token comment"># 选择K个最好的特征，返回选择特征后的数据</span>
iris11 <span class="token operator">=</span> <span class="token function">SelectKBest</span><span class="token punctuation">(</span>chi2<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">fit_transform</span><span class="token punctuation">(</span>iris<span class="token operator">.</span>data<span class="token punctuation">,</span> iris<span class="token operator">.</span>target<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SelectKBest:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>iris11<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"---------------------"</span><span class="token punctuation">)</span>


<span class="token comment"># 递归特征消除法，返回特征选择后的数据</span>
<span class="token comment"># 参数estimator为基模型</span>
<span class="token comment"># 参数n_features_to_select为选择的特征个数</span>
iris12 <span class="token operator">=</span> <span class="token function">RFE</span><span class="token punctuation">(</span>estimator<span class="token operator">=</span><span class="token function">LogisticRegression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n_features_to_select<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">fit_transform</span><span class="token punctuation">(</span>
    iris<span class="token operator">.</span>data<span class="token punctuation">,</span> iris<span class="token operator">.</span>target<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"features_to_select:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>iris12<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"---------------------"</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/65870aaf94931e101fa526f16a827980/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Pyecharts Geo创建中国可视化地图</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/30503b0b541bddea73d287e1f43efaf3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">虚拟仿真教学系统网页化Web技术路线分析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>