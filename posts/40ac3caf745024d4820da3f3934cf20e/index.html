<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Oracle sid_name 和service_name的区别 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Oracle sid_name 和service_name的区别" />
<meta property="og:description" content="目录
问题: 排查一:
排查二：
jdbc连接oracle的方式 问题: kettle连接Oracle时候报错：
错误连接数据库 [MFG Prod] : org.pentaho.di.core.exception.KettleDatabaseException: Error occurred while trying to connect to the database
Error connecting to database: (using class oracle.jdbc.driver.OracleDriver)
Listener refused the connection with the following error:
ORA-12505, TNS:listener does not currently know of SID given in connect descriptor
org.pentaho.di.core.exception.KettleDatabaseException: Error occurred while trying to connect to the database
Error connecting to database: (using class oracle.jdbc.driver.OracleDriver)
Listener refused the connection with the following error:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/40ac3caf745024d4820da3f3934cf20e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-25T10:01:29+08:00" />
<meta property="article:modified_time" content="2022-02-25T10:01:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Oracle sid_name 和service_name的区别</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:80px;"></p> 
<p id="%E9%97%AE%E9%A2%98%3A%C2%A0-toc" style="margin-left:80px;"><a href="#%E9%97%AE%E9%A2%98%3A%C2%A0" rel="nofollow">问题: </a></p> 
<p id="%E6%8E%92%E6%9F%A5%E4%B8%80%3A-toc" style="margin-left:80px;"><a href="#%E6%8E%92%E6%9F%A5%E4%B8%80%3A" rel="nofollow">排查一:</a></p> 
<p id="%E6%8E%92%E6%9F%A5%E4%BA%8C%EF%BC%9A-toc" style="margin-left:80px;"><a href="#%E6%8E%92%E6%9F%A5%E4%BA%8C%EF%BC%9A" rel="nofollow">排查二：</a></p> 
<p id="jdbc%E8%BF%9E%E6%8E%A5oracle%E7%9A%84%E6%96%B9%E5%BC%8F%C2%A0-toc" style="margin-left:80px;"><a href="#jdbc%E8%BF%9E%E6%8E%A5oracle%E7%9A%84%E6%96%B9%E5%BC%8F%C2%A0" rel="nofollow">jdbc连接oracle的方式 </a></p> 
<hr id="hr-toc"> 
<p></p> 
<h4 id="%E9%97%AE%E9%A2%98%3A%C2%A0">问题: </h4> 
<p>kettle连接Oracle时候报错：</p> 
<p>错误连接数据库 [MFG Prod] : org.pentaho.di.core.exception.KettleDatabaseException: <br> Error occurred while trying to connect to the database</p> 
<p>Error connecting to database: (using class oracle.jdbc.driver.OracleDriver)<br> Listener refused the connection with the following error:<br> ORA-12505, TNS:listener does not currently know of SID given in connect descriptor<br>  </p> 
<p><br> org.pentaho.di.core.exception.KettleDatabaseException: <br> Error occurred while trying to connect to the database</p> 
<p>Error connecting to database: (using class oracle.jdbc.driver.OracleDriver)<br> Listener refused the connection with the following error:<br> ORA-12505, TNS:listener does not currently know of SID given in connect descriptor</p> 
<h4 id="%E6%8E%92%E6%9F%A5%E4%B8%80%3A">排查一:</h4> 
<p>连接另外一个Oracle数据库都是正常的，经过查询两个Oracle的版本不一致，可能是<strong><span style="color:#7c79e5;"><u>oracle jar包版本的问题</u></span></strong></p> 
<p><img alt="" class="has" height="470" src="https://images2.imgbox.com/48/59/WzAbFkA7_o.png" width="537"></p> 
<p>于是像这位前辈学习了一下：</p> 
<p><a href="https://www.cnblogs.com/elleniou/archive/2012/08/14/2638025.html" rel="nofollow" title="Oracle数据库的驱动包ojdbc*.jar之间的差别 - elleniou - 博客园">Oracle数据库的驱动包ojdbc*.jar之间的差别 - elleniou - 博客园</a></p> 
<blockquote> 
 <pre class="has"><code class="language-html">尽量使用和数据库版本一致的驱动,有bug时，换高版本的JDBC驱动试试 。</code></pre> 
</blockquote> 
<p>换成对应的jar包还是报错，排除jar不兼容问题。</p> 
<h4 id="%E6%8E%92%E6%9F%A5%E4%BA%8C%EF%BC%9A">排查二：</h4> 
<p>最后查到的原因如下</p> 
<p>查找资料得知：</p> 
<p><strong><u><em>jdbc连接数据库的时候，需要使用数据库的sid_name，而不是数据库的services_name</em></u></strong><br> 而使用plsql连接数据库的时候，只需要数据库的services_name即可，所以修改连接字符串中的services_name （即连接参数中的database name）为sid_name。</p> 
<p>现在很多工具提供了两种连接方式，例如dbeaver</p> 
<p><img alt="" height="526" src="https://images2.imgbox.com/5f/e2/02QXcEtD_o.png" width="505"></p> 
<p><img alt="" height="422" src="https://images2.imgbox.com/bd/12/D0ef18SP_o.png" width="340"> </p> 
<p> 因为这个工具是java写的，底层还是jdbc，应该也是会转化为下面的方式去连接。</p> 
<pre><code>通过查找JDBC帮助得知JDBC连接ORACLE的方法由三种：

格式一：jdbc:oracle:thin:@//&lt;host&gt;:&lt;port&gt;/&lt;service_name&gt;
格式二：jdbc:oracle:thin:@&lt;host&gt;:&lt;port&gt;:&lt;SID&gt;
格式三：jdbc:oracle:thin:@&lt;TNSName&gt;</code></pre> 
<h4 id="jdbc%E8%BF%9E%E6%8E%A5oracle%E7%9A%84%E6%96%B9%E5%BC%8F%C2%A0">jdbc连接oracle的方式 </h4> 
<pre><code># jdbc连接oracle实例 
driverClassName: oracle.jdbc.driver.OracleDriver
 url: jdbc:oracle:thin:@10.2.1.22:1521:testdb1
 username: abc
 password: 123</code></pre> 
<pre><code># jdbc连接oracle service_name      
 driverClassName: oracle.jdbc.driver.OracleDriver
 url: jdbc:oracle:thin:@10.2.1.5:1521/PRODDB
 username: adm
 password: admin</code></pre> 
<p>在操作系统中要取得与数据库之间的交互，必须使用数据库实例名。例如，要和某一个数据库server连接，就必须知道其数据库实例名，只知道数据库名是没有用的，与数据库名不同，在数据安装或创建数据库之后，实例名可以被修改。</p> 
<p>那么sid_name 和service_name 到底有什么区别？</p> 
<blockquote> 
 <p>1.数据库实例名（SID）<br> 什么是数据库实例名？<br> 数据库实例名是用于和操作系统进行联系的标识，就是说<u><em>数据库和操作系统之间的交互用的是数据库实例名</em></u>。实例名也被写入参数文件中，该参数为instance_name，在win平台中，实例名同时也被写入注册表。<br> 数据库名和实例名可以相同也可以不同。<br> 在一般情况下，数据库名和实例名是一对一的关系，<strong><em><u>但如果在oracle并行服务器架构(即oracle实时应用集群)中，数据库名和实例名是一对多的关系。(MFG的PROD是如此，最著名的是</u></em></strong>如RAC技术<strong><em><u>)</u></em></strong></p> 
 <p><strong><em><u>一个serice name 对应多个 sid name. </u></em></strong></p> 
 <p>2.数据库服务名（SERVICE_NAME）<br> 什么是数据库服务名？<br> 从oracle9i版本开始，引入了一个新的参数，即数据库服务名。参数名是SERVICE_NAME。<br> 如果数据库有域名，则数据库服务名就是全局数据库名；否则，数据库服务名与数据库名相同。<br>  </p> 
</blockquote> 
<p>tnsname.ora  如下</p> 
<p>配置tnsname.ora时，可以用SID,也可以用SERVICE_NAME.  注意这两个值不一定相同，具体要看数据库服务器中的配置。</p> 
<p><img alt="" class="has" height="195" src="https://images2.imgbox.com/85/66/MRsARlRM_o.png" width="464"></p> 
<p><strong><em><u>connect_data对应的是SID还是SERVICE_NAME？ </u></em></strong>如果是SID则对应该数据库的实例名称（instant_name），如果是SERVICE_NAME的话则填写数据库服务名,即全局数据库名</p> 
<p></p> 
<p>PS：查看数据库的sid_name语句：</p> 
<p>select INSTANCE_NAME from v$instance;</p> 
<p></p> 
<p>总之jdbc连接数据库的时候是sid_name；</p> 
<p>      psql连接数据库的时候是service_name；</p> 
<p>我们平常使用工具连接的都属于psql连接，kettle是通过java jdbc接口连接DB的，故应该为sid_name，事实上，多数的数据库两者一致，导致我们忽视了此问题。</p> 
<p>参考文章：<a href="https://www.cnblogs.com/lcword/p/8038352.html" rel="nofollow" title="ORACLE中SID和SERVICE_NAME的区别 - lclc - 博客园">ORACLE中SID和SERVICE_NAME的区别 - lclc - 博客园</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3fbc95ec8900c8de77eb381f9f8152e4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">STM32F103 实例应用（3.1）——GPIO(增加深度)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fb8677fdde8a9708977d143a0c2794fe/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">前端在H5页面唤起微信支付（H5支付）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>