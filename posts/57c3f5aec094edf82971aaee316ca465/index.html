<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ubantu20.04 一键部署 RocketChat 服务完整教程（极简） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ubantu20.04 一键部署 RocketChat 服务完整教程（极简）" />
<meta property="og:description" content="开始前我们先更新下操作系统
sudo apt update &amp;&amp; sudo apt upgrade 全选代码
复制
安装 Rocket.Chat 最快的方法是使用它的 Snap。Snap 是 Linux 系统上一种软件包管理的方式。它类似一个容器拥有一个应用程序所有的文件和库，各个应用程序之间完全独立。所以使用snap包的好处就是它解决了应用程序之间的依赖问题，使应用程序之间更容易管理。在 Ubuntu 16.04 LTS 以上版本的系统都内置了。
只需部署SNAPD环境包即可：
执行
sudo apt-get install snapd 全选代码
复制
安装 Rocket.Chat 执行 一定要手动输入
sudo snap install rocketchat-server 全选代码
复制
提示了：rocketchat-server (6.x/stable) 6.2.5 from Rocket.Chat (rocketchat✓) installed 则表示安装成功！
可以通过 http://IP:3000访问
安装后，Rocket.Chat 服务会自动启动，检查一下是否在运行：
sudo service snap.rocketchat-server.rocketchat-server status 全选代码
复制
你可以访问 Rocket.Chat snap 查看一些其他命令。
nginx返代理设置
//我们从安装Nginx开始：
# sudo apt install nginx //安装 Nginx 后，我们继续为 RocketChat 配置虚拟主机：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/57c3f5aec094edf82971aaee316ca465/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-16T22:37:24+08:00" />
<meta property="article:modified_time" content="2023-06-16T22:37:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ubantu20.04 一键部署 RocketChat 服务完整教程（极简）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>开始前我们先更新下操作系统</p> 
<pre><code>sudo apt update &amp;&amp; sudo apt upgrade</code></pre> 
<p>全选代码</p> 
<p>复制</p> 
<p>安装 Rocket.Chat 最快的方法是使用它的 Snap。Snap 是 Linux 系统上一种软件包管理的方式。它类似一个容器拥有一个应用程序所有的文件和库，各个应用程序之间完全独立。所以使用snap包的好处就是它解决了应用程序之间的依赖问题，使应用程序之间更容易管理。在 Ubuntu 16.04 LTS 以上版本的系统都内置了。<br><br> 只需部署SNAPD环境包即可：<br><br> 执行</p> 
<pre><code>sudo apt-get install snapd</code></pre> 
<p>全选代码</p> 
<p>复制</p> 
<p><br><br> 安装 Rocket.Chat 执行 一定要手动输入</p> 
<pre><code>sudo snap install rocketchat-server</code></pre> 
<p>全选代码</p> 
<p>复制</p> 
<p>提示了：rocketchat-server (6.x/stable) 6.2.5 from Rocket.Chat (<strong><span style="color:#1c7331;">rocketchat✓</span></strong>) installed   则表示安装成功！<br> 可以通过 http://IP:3000访问</p> 
<p>安装后，Rocket.Chat 服务会自动启动，检查一下是否在运行：</p> 
<pre><code>sudo service snap.rocketchat-server.rocketchat-server status</code></pre> 
<p>全选代码</p> 
<p>复制</p> 
<p>你可以访问 Rocket.Chat snap 查看一些其他命令。</p> 
<p><strong>nginx返代理设置</strong></p> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">//我们从安装Nginx开始：</span></span></p> 
<pre class="has" style="margin-left:0;"><code class="language-wp-block-code"># sudo apt install nginx</code></pre> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">//安装 Nginx 后，我们继续为 RocketChat 配置虚拟主机：</span></span></p> 
<pre class="has" style="margin-left:0;"><code class="language-wp-block-code"># sudo nano /etc/nginx/conf.d/rocketchat.conf</code></pre> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">// 在里面我们将放置以下几行：</span></span></p> 
<pre class="has" style="margin-left:0;"><code class="language-wp-block-code">upstream rocket_backend {
  server 127.0.0.1:3000;
}

server {
    listen 80;
    server_name rocket.1234f.com;
    access_log /var/log/nginx/rocketchat-access.log;
    error_log /var/log/nginx/rocketchat-error.log;

    location / {
        proxy_pass http://ip:3000/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $http_host;

        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forward-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forward-Proto http;
        proxy_set_header X-Nginx-Proxy true;

        proxy_redirect off;
    }
}</code></pre> 
<p><span style="color:#fe2c24;">ctrl+o 保存   ctrl+X 退出</span></p> 
<p><span style="color:#fe2c24;">ctrl+o  切换  shift+:  切换到保存  输入  ：wq   回车保存退出</span></p> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">//我们检查虚拟主机配置，重启并激活 Nginx：</span></span></p> 
<pre class="has" style="margin-left:0;"><code class="language-wp-block-code"># 一行一行复制提交

sudo nginx  -t



# 一行一行复制提交
sudo systemctl restart nginx



# 一行一行复制提交
sudo systemctl enable nginx</code></pre> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">我们已经准备好通过 http://rocket.1234f.com 访问 RocketChat 的反向代理</span></span></p> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">但我们会更进一步，现在我们将配置 Nginx 以通过 https 访问 RocketChat，为此我们将在今天的案例中实施自签名 SSL 证书。我使用自签名证书的原因是因为你们中的大多数人在互联网上没有真正的域，所以不可能获得有效的证书。</span></span></p> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">//第一件事是生成我们的密钥和证书：</span></span></p> 
<pre class="has" style="margin-left:0;"><code class="language-wp-block-code"># sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout /etc/ssl/private/nginx-rocket.key -out /etc/ssl/certs/nginx-rocket.crt</code></pre> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">//填写请求的数据。</span></span></p> 
<pre class="has" style="margin-left:0;"><code class="language-wp-block-code">Country Name (2 letter code) [AU]:CU

State or Province Name (full name) [Some-State]:Mayabeque

Locality Name (eg, city) []:Santa Cruz del Norte

Organization Name (eg, company) [Internet Widgits Pty Ltd]:NETWORLD

Organizational Unit Name (eg, section) []:Redes y Internet

Common Name (e.g. server FQDN or YOUR name) []:rocket.1234f.com

Email Address []:admin@1234f.com
</code></pre> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">//关注数据，方便修改。</span></span></p> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">//我们为示例生成pem文件，大小为2048绰绰有余：</span></span></p> 
<pre class="has" style="margin-left:0;"><code class="language-wp-block-code"># sudo openssl dhparam -out /etc/nginx/dhparam.pem 2048</code></pre> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">//让我们创建一个专用的 RocketChat 文件来保存关键文件位置：</span></span></p> 
<pre class="has" style="margin-left:0;"><code class="language-wp-block-code"># sudo nano /etc/nginx/snippets/rocket.conf</code></pre> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">//内容将是：</span></span></p> 
<pre class="has" style="margin-left:0;"><code class="language-wp-block-code">ssl_certificate /etc/ssl/certs/nginx-rocket.crt;
ssl_certificate_key /etc/ssl/private/nginx-rocket.key;</code></pre> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">//让我们为 Nginx 配置 SSL 参数：</span></span></p> 
<pre class="has" style="margin-left:0;"><code class="language-wp-block-code"># sudo nano /etc/nginx/snippets/ssl-params.conf</code></pre> 
<pre class="has" style="margin-left:0;"><code class="language-wp-block-code">ssl_protocols TLSv1.2;
ssl_prefer_server_ciphers on;
ssl_dhparam /etc/nginx/dhparam.pem;
ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384;
ssl_ecdh_curve secp384r1; # Requires nginx &gt;= 1.1.0
ssl_session_timeout  10m;
ssl_session_cache shared:SSL:10m;
ssl_session_tickets off; # Requires nginx &gt;= 1.5.9
ssl_stapling on; # Requires nginx &gt;= 1.3.7
ssl_stapling_verify on; # Requires nginx =&gt; 1.3.7
resolver 8.8.8.8 8.8.4.4 valid=300s;
resolver_timeout 5s;
# Disable strict transport security for now. You can uncomment the following
# line if you understand the implications.
# add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
add_header X-Frame-Options DENY;
add_header X-Content-Type-Options nosniff;
add_header X-XSS-Protection "1; mode=block";</code></pre> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">//这次我们再次编辑 RocketChat 虚拟主机文件以使用 SSL 并监听端口 443：</span></span></p> 
<pre class="has" style="margin-left:0;"><code class="language-wp-block-code"># sudo nano /etc/nginx/conf.d/rocketchat.conf</code></pre> 
<pre class="has" style="margin-left:0;"><code class="language-wp-block-code">upstream rocket_backend {
  server 127.0.0.1:3000;
}
server {
    listen 80;
    server_name rocket.1234f.com;

return 301 https://$server_name$request_uri;

    access_log /var/log/nginx/rocketchat-access.log;
    error_log /var/log/nginx/rocketchat-error.log;

    location / {
        proxy_pass https://IP:3000/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $http_host;

        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forward-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forward-Proto http;
        proxy_set_header X-Nginx-Proxy true;

        proxy_redirect off;
    }


listen 443 ssl;
include snippets/rocket.conf;
include snippets/ssl-params.conf;


}</code></pre> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">//前移的是我们必须添加的行。</span></span></p> 
<p style="margin-left:0;"></p> 
<p><strong><span style="color:#444444;"><span style="background-color:#ffffff;">ctrl+o 保存   ctrl+X 退出</span></span></strong></p> 
<p><strong><span style="color:#444444;"><span style="background-color:#ffffff;">ctrl+o  切换  shift+:  切换到保存  输入  ：wq   回车保存退出</span></span></strong></p> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">//我们检查 Nginx 中的一切是否正确，然后我们重新启动服务：</span></span></p> 
<pre class="has" style="margin-left:0;"><code class="language-wp-block-code"># sudo nginx -t
# sudo systemctl restart nginx</code></pre> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">//我们准备通过：https://rocket.1234f.com 访问RocketChat配置向导，因为是自签名证书，当然会出现安全警告，我们添加异常继续。</span></span></p> 
<p style="margin-left:0;"><span style="color:#444444;"><span style="background-color:#ffffff;">就是这样，我们已经在我们的网络上运行了我们的聊天系统，您可以使用浏览器或官方桌面应用程序。</span></span></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d38fa3e77bdb5279be212e180c4e7a38/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">h264结构与码流</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e90d3bcc11c19a9ba03bb6edb8363ea5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关系数据库SQL数据查询</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>