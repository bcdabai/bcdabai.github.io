<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Hive中的四种排序方式（order by,sort by,distribute by,cluster by）使用与区别详解 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Hive中的四种排序方式（order by,sort by,distribute by,cluster by）使用与区别详解" />
<meta property="og:description" content="在平时的Hive数仓开发工作中经常会用到排序，而Hive中支持的排序方式有四种，这里结合具体的案例详细介绍一下他们的使用与区别：
order bysort bydistribute bycluster by 准备工作：
新建一个测试用表employInfo： create table employInfo(deptID int,employID int,employName string,employSalary double) row format delimited fields terminated by &#39;,&#39;; 向测试用表中导入测试数据： load data local inpath &#39;/home/hadoop/datas/employInfo.txt&#39; into table employInfo; 以下为测试用的数据：
[hadoop@weekend110 datas]$ cat employInfo.txt deptID,employID,employName,employSalary 1,1001,Jack01,5000 1,1002,Jack02,5001 1,1003,Jack03,5002 1,1004,Jack04,5003 1,1005,Jack05,5004 1,1006,Jack06,5005 1,1007,Jack07,5006 1,1008,Jack08,5007 1,1009,Jack09,5008 1,1010,Jack10,5009 1,1011,Jack11,5010 1,1012,Jack12,5011 2,1013,Maria01,7500 2,1014,Maria02,7501 2,1015,Maria03,7502 2,1016,Maria04,7503 2,1017,Maria05,7504 2,1018,Maria06,7505 2,1019,Maria07,7506 2,1020,Maria08,7507 2,1021,Maria09,7508 3,1022,Lucy01,8540 3,1023,Lucy02,8541 3,1024,Lucy03,8542 3,1025,Lucy04,8543 3,1026,Lucy05,8544 3,1027,Lucy06,8545 3,1028,Lucy07,8546 3,1029,Lucy08,8547 3,1030,Lucy09,8548 3,1031,Lucy10,8549 3,1032,Lucy11,8550 3,1033,Lucy12,8551 4,1034,Jimmy01,10000 4,1035,Jimmy02,10001 4,1036,Jimmy03,10002 4,1037,Jimmy04,10003 4,1038,Jimmy05,10004 4,1039,Jimmy06,10005 4,1040,Jimmy07,6300 4,1041,Jimmy08,6301 4,1042,Jimmy09,6302 4,1043,Jimmy10,6303 4,1044,Jimmy11,6304 4,1045,Jimmy12,6305 5,1046,Ace01,6306 5,1047,Ace02,9700 5,1048,Ace03,9701 5,1049,Ace04,9702 5,1050,Ace05,9703 5,1051,Ace06,9704 5,1052,Ace07,9705 下面详细介绍四种排序：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/3dce23a994c8136bbf755b24ac5f6f64/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-07-14T17:42:17+08:00" />
<meta property="article:modified_time" content="2020-07-14T17:42:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Hive中的四种排序方式（order by,sort by,distribute by,cluster by）使用与区别详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>在平时的Hive数仓开发工作中经常会用到排序，而Hive中支持的排序方式有四种，这里结合具体的案例详细介绍一下他们的使用与区别：</p> 
<ul><li>order by</li><li>sort by</li><li>distribute by</li><li>cluster by</li></ul> 
<p><strong>准备工作：</strong></p> 
<pre><code class="prism language-java">新建一个测试用表employInfo：
create table <span class="token function">employInfo</span><span class="token punctuation">(</span>deptID <span class="token keyword">int</span><span class="token punctuation">,</span>employID <span class="token keyword">int</span><span class="token punctuation">,</span>employName string<span class="token punctuation">,</span>employSalary <span class="token keyword">double</span><span class="token punctuation">)</span> 
row format delimited fields terminated by <span class="token string">','</span><span class="token punctuation">;</span>

向测试用表中导入测试数据：
load data local inpath <span class="token string">'/home/hadoop/datas/employInfo.txt'</span> into table employInfo<span class="token punctuation">;</span>
</code></pre> 
<p>以下为测试用的数据：</p> 
<pre><code class="prism language-handlebars"><span class="token brackets"><span class="token punctuation">[</span><span class="token variable">hadoop@weekend110 datas</span><span class="token punctuation">]</span></span><span class="token variable">$</span> <span class="token variable">cat</span> <span class="token variable">employInfo</span><span class="token punctuation">.</span><span class="token variable">txt</span> 
<span class="token variable">deptID</span><span class="token punctuation">,</span><span class="token variable">employID</span><span class="token punctuation">,</span><span class="token variable">employName</span><span class="token punctuation">,</span><span class="token variable">employSalary</span>
<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1001</span><span class="token punctuation">,</span><span class="token variable">Jack01</span><span class="token punctuation">,</span><span class="token number">5000</span>
<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1002</span><span class="token punctuation">,</span><span class="token variable">Jack02</span><span class="token punctuation">,</span><span class="token number">5001</span>
<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1003</span><span class="token punctuation">,</span><span class="token variable">Jack03</span><span class="token punctuation">,</span><span class="token number">5002</span>
<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1004</span><span class="token punctuation">,</span><span class="token variable">Jack04</span><span class="token punctuation">,</span><span class="token number">5003</span>
<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1005</span><span class="token punctuation">,</span><span class="token variable">Jack05</span><span class="token punctuation">,</span><span class="token number">5004</span>
<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1006</span><span class="token punctuation">,</span><span class="token variable">Jack06</span><span class="token punctuation">,</span><span class="token number">5005</span>
<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1007</span><span class="token punctuation">,</span><span class="token variable">Jack07</span><span class="token punctuation">,</span><span class="token number">5006</span>
<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1008</span><span class="token punctuation">,</span><span class="token variable">Jack08</span><span class="token punctuation">,</span><span class="token number">5007</span>
<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1009</span><span class="token punctuation">,</span><span class="token variable">Jack09</span><span class="token punctuation">,</span><span class="token number">5008</span>
<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1010</span><span class="token punctuation">,</span><span class="token variable">Jack10</span><span class="token punctuation">,</span><span class="token number">5009</span>
<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1011</span><span class="token punctuation">,</span><span class="token variable">Jack11</span><span class="token punctuation">,</span><span class="token number">5010</span>
<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1012</span><span class="token punctuation">,</span><span class="token variable">Jack12</span><span class="token punctuation">,</span><span class="token number">5011</span>
<span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1013</span><span class="token punctuation">,</span><span class="token variable">Maria01</span><span class="token punctuation">,</span><span class="token number">7500</span>
<span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1014</span><span class="token punctuation">,</span><span class="token variable">Maria02</span><span class="token punctuation">,</span><span class="token number">7501</span>
<span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1015</span><span class="token punctuation">,</span><span class="token variable">Maria03</span><span class="token punctuation">,</span><span class="token number">7502</span>
<span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1016</span><span class="token punctuation">,</span><span class="token variable">Maria04</span><span class="token punctuation">,</span><span class="token number">7503</span>
<span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1017</span><span class="token punctuation">,</span><span class="token variable">Maria05</span><span class="token punctuation">,</span><span class="token number">7504</span>
<span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1018</span><span class="token punctuation">,</span><span class="token variable">Maria06</span><span class="token punctuation">,</span><span class="token number">7505</span>
<span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1019</span><span class="token punctuation">,</span><span class="token variable">Maria07</span><span class="token punctuation">,</span><span class="token number">7506</span>
<span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1020</span><span class="token punctuation">,</span><span class="token variable">Maria08</span><span class="token punctuation">,</span><span class="token number">7507</span>
<span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1021</span><span class="token punctuation">,</span><span class="token variable">Maria09</span><span class="token punctuation">,</span><span class="token number">7508</span>
<span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1022</span><span class="token punctuation">,</span><span class="token variable">Lucy01</span><span class="token punctuation">,</span><span class="token number">8540</span>
<span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1023</span><span class="token punctuation">,</span><span class="token variable">Lucy02</span><span class="token punctuation">,</span><span class="token number">8541</span>
<span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token variable">Lucy03</span><span class="token punctuation">,</span><span class="token number">8542</span>
<span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1025</span><span class="token punctuation">,</span><span class="token variable">Lucy04</span><span class="token punctuation">,</span><span class="token number">8543</span>
<span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1026</span><span class="token punctuation">,</span><span class="token variable">Lucy05</span><span class="token punctuation">,</span><span class="token number">8544</span>
<span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1027</span><span class="token punctuation">,</span><span class="token variable">Lucy06</span><span class="token punctuation">,</span><span class="token number">8545</span>
<span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1028</span><span class="token punctuation">,</span><span class="token variable">Lucy07</span><span class="token punctuation">,</span><span class="token number">8546</span>
<span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1029</span><span class="token punctuation">,</span><span class="token variable">Lucy08</span><span class="token punctuation">,</span><span class="token number">8547</span>
<span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1030</span><span class="token punctuation">,</span><span class="token variable">Lucy09</span><span class="token punctuation">,</span><span class="token number">8548</span>
<span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1031</span><span class="token punctuation">,</span><span class="token variable">Lucy10</span><span class="token punctuation">,</span><span class="token number">8549</span>
<span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1032</span><span class="token punctuation">,</span><span class="token variable">Lucy11</span><span class="token punctuation">,</span><span class="token number">8550</span>
<span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1033</span><span class="token punctuation">,</span><span class="token variable">Lucy12</span><span class="token punctuation">,</span><span class="token number">8551</span>
<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1034</span><span class="token punctuation">,</span><span class="token variable">Jimmy01</span><span class="token punctuation">,</span><span class="token number">10000</span>
<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1035</span><span class="token punctuation">,</span><span class="token variable">Jimmy02</span><span class="token punctuation">,</span><span class="token number">10001</span>
<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1036</span><span class="token punctuation">,</span><span class="token variable">Jimmy03</span><span class="token punctuation">,</span><span class="token number">10002</span>
<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1037</span><span class="token punctuation">,</span><span class="token variable">Jimmy04</span><span class="token punctuation">,</span><span class="token number">10003</span>
<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1038</span><span class="token punctuation">,</span><span class="token variable">Jimmy05</span><span class="token punctuation">,</span><span class="token number">10004</span>
<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1039</span><span class="token punctuation">,</span><span class="token variable">Jimmy06</span><span class="token punctuation">,</span><span class="token number">10005</span>
<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1040</span><span class="token punctuation">,</span><span class="token variable">Jimmy07</span><span class="token punctuation">,</span><span class="token number">6300</span>
<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1041</span><span class="token punctuation">,</span><span class="token variable">Jimmy08</span><span class="token punctuation">,</span><span class="token number">6301</span>
<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1042</span><span class="token punctuation">,</span><span class="token variable">Jimmy09</span><span class="token punctuation">,</span><span class="token number">6302</span>
<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1043</span><span class="token punctuation">,</span><span class="token variable">Jimmy10</span><span class="token punctuation">,</span><span class="token number">6303</span>
<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1044</span><span class="token punctuation">,</span><span class="token variable">Jimmy11</span><span class="token punctuation">,</span><span class="token number">6304</span>
<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1045</span><span class="token punctuation">,</span><span class="token variable">Jimmy12</span><span class="token punctuation">,</span><span class="token number">6305</span>
<span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1046</span><span class="token punctuation">,</span><span class="token variable">Ace01</span><span class="token punctuation">,</span><span class="token number">6306</span>
<span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1047</span><span class="token punctuation">,</span><span class="token variable">Ace02</span><span class="token punctuation">,</span><span class="token number">9700</span>
<span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1048</span><span class="token punctuation">,</span><span class="token variable">Ace03</span><span class="token punctuation">,</span><span class="token number">9701</span>
<span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1049</span><span class="token punctuation">,</span><span class="token variable">Ace04</span><span class="token punctuation">,</span><span class="token number">9702</span>
<span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1050</span><span class="token punctuation">,</span><span class="token variable">Ace05</span><span class="token punctuation">,</span><span class="token number">9703</span>
<span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1051</span><span class="token punctuation">,</span><span class="token variable">Ace06</span><span class="token punctuation">,</span><span class="token number">9704</span>
<span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1052</span><span class="token punctuation">,</span><span class="token variable">Ace07</span><span class="token punctuation">,</span><span class="token number">9705</span>
</code></pre> 
<p>下面详细介绍四种排序：</p> 
<p><strong>一、order by（全局排序）</strong></p> 
<p><strong>1、作用：全局排序，只有一个reducer。</strong><br> order by 会对输入做全局排序，因此只有一个reducer（多个reducer无法保证全局有序），也正因为只有一个reducer，所以当输入的数据规模较大时会导致计算时间较长。<br> 　　set hive.mapred.mode=nonstrict; (default value / 默认值)<br> 　　set hive.mapred.mode=strict;<br> order by 和数据库中的Order by 功能一致，按照某一项&amp;几项排序输出。与数据库中 order by 的区别在于在hive.mapred.mode = strict 模式下必须指定 limit 否则执行会报错。<br> <img src="https://images2.imgbox.com/f6/cd/tsAtHL5S_o.png" alt="在这里插入图片描述"><br> 原因：在order by 状态下所有数据会到一台服务器进行reduce操作也即只有一个reduce，如果在数据量大的情况下会出现无法输出结果的情况，如果进行 limit n ，那只有 n * map number 条记录而已。只有一个reduce也可以处理过来。</p> 
<p><strong>2、案例实操：</strong><br> 在使用 ORDER BY 子句排序时默认的是升序ASC（ascend），DESC（descend）为降序，且ORDER BY 子句在SELECT语句的结尾使用。</p> 
<pre><code class="prism language-java">（<span class="token number">1</span>）查询员工信息按工资升序排序
select <span class="token operator">*</span> from employInfo order by employSalary<span class="token punctuation">;</span>
（<span class="token number">2</span>）查询员工信息按工资降序排序
select <span class="token operator">*</span> from employInfo order by employSalary desc<span class="token punctuation">;</span>
（<span class="token number">3</span>）按照员工薪水的<span class="token number">2</span>倍升序排序
select employName<span class="token punctuation">,</span> employSalary<span class="token operator">*</span><span class="token number">2</span> twoSalary from employInfo order by twoSalary<span class="token punctuation">;</span>
（<span class="token number">4</span>）按照部门和工资升序排序
select employName<span class="token punctuation">,</span> deptID<span class="token punctuation">,</span> employSalary from employInfo order by deptID<span class="token punctuation">,</span> employSalary <span class="token punctuation">;</span>
</code></pre> 
<p>查看执行结果：<br> <img src="https://images2.imgbox.com/03/47/3b4KfZDz_o.png" alt="在这里插入图片描述"><br> 可见，order by全局排序时只分配了一个reducer。</p> 
<p><strong>二、sort by（每个MapReduce内部排序）</strong></p> 
<p><strong>1、作用：每个Reducer内部进行排序，对全局结果集来说不是排序。</strong><br> sort by不是全局排序，其在数据进入reducer前完成排序。因此，如果用sort by进行排序，并且设置mapred.reduce.tasks&gt;1， 则sort by只保证每个reducer的输出有序，不保证全局有序。<br> sort by 不受 hive.mapred.mode 是否为strict ,nostrict 的影响<br> sort by 的数据只能保证在同一reduce中的数据可以按指定字段排序。<br> 使用sort by 你可以指定执行的reduce 个数 （set mapred.reduce.tasks=）,对输出的数据再执行归并排序，即可以得到全部结果。<br> 注意：可以用limit子句大大减少数据量。使用limit n后，传输到reduce端（单机）的数据记录数就减少到n* （map个数）。否则由于数据过大可能出不了结果。</p> 
<p><strong>2、案例实操：</strong></p> 
<pre><code class="prism language-java">（<span class="token number">1</span>）设置reduce个数
set mapreduce<span class="token punctuation">.</span>job<span class="token punctuation">.</span>reduces<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
（<span class="token number">2</span>）查看设置reduce个数
set mapreduce<span class="token punctuation">.</span>job<span class="token punctuation">.</span>reduces<span class="token punctuation">;</span>
（<span class="token number">3</span>）根据员工编号降序查看员工信息
select <span class="token operator">*</span> from employInfo sort by employID desc<span class="token punctuation">;</span>
</code></pre> 
<p>查看执行结果：<br> <img src="https://images2.imgbox.com/91/39/CoTVU5Jh_o.png" alt="在这里插入图片描述"><br> 以下是全部的显示信息：</p> 
<pre><code class="prism language-handlebars"><span class="token variable">employinfo</span><span class="token punctuation">.</span><span class="token variable">deptid</span>       <span class="token variable">employinfo</span><span class="token punctuation">.</span><span class="token variable">employid</span>     <span class="token variable">employinfo</span><span class="token punctuation">.</span><span class="token variable">employname</span>   <span class="token variable">employinfo</span><span class="token punctuation">.</span><span class="token variable">employsalary</span>
<span class="token number">5</span>       <span class="token number">1048</span>    <span class="token variable">Ace03</span>   <span class="token number">9701.0</span>
<span class="token number">5</span>       <span class="token number">1046</span>    <span class="token variable">Ace01</span>   <span class="token number">6306.0</span>
<span class="token number">4</span>       <span class="token number">1045</span>    <span class="token variable">Jimmy12</span> <span class="token number">6305.0</span>
<span class="token number">4</span>       <span class="token number">1041</span>    <span class="token variable">Jimmy08</span> <span class="token number">6301.0</span>
<span class="token number">4</span>       <span class="token number">1040</span>    <span class="token variable">Jimmy07</span> <span class="token number">6300.0</span>
<span class="token number">4</span>       <span class="token number">1039</span>    <span class="token variable">Jimmy06</span> <span class="token number">10005.0</span>
<span class="token number">4</span>       <span class="token number">1038</span>    <span class="token variable">Jimmy05</span> <span class="token number">10004.0</span>
<span class="token number">4</span>       <span class="token number">1035</span>    <span class="token variable">Jimmy02</span> <span class="token number">10001.0</span>
<span class="token number">3</span>       <span class="token number">1033</span>    <span class="token variable">Lucy12</span>  <span class="token number">8551.0</span>
<span class="token number">3</span>       <span class="token number">1031</span>    <span class="token variable">Lucy10</span>  <span class="token number">8549.0</span>
<span class="token number">3</span>       <span class="token number">1029</span>    <span class="token variable">Lucy08</span>  <span class="token number">8547.0</span>
<span class="token number">3</span>       <span class="token number">1024</span>    <span class="token variable">Lucy03</span>  <span class="token number">8542.0</span>
<span class="token number">3</span>       <span class="token number">1023</span>    <span class="token variable">Lucy02</span>  <span class="token number">8541.0</span>
<span class="token number">2</span>       <span class="token number">1021</span>    <span class="token variable">Maria09</span> <span class="token number">7508.0</span>
<span class="token number">2</span>       <span class="token number">1018</span>    <span class="token variable">Maria06</span> <span class="token number">7505.0</span>
<span class="token number">2</span>       <span class="token number">1017</span>    <span class="token variable">Maria05</span> <span class="token number">7504.0</span>
<span class="token number">2</span>       <span class="token number">1014</span>    <span class="token variable">Maria02</span> <span class="token number">7501.0</span>
<span class="token number">1</span>       <span class="token number">1009</span>    <span class="token variable">Jack09</span>  <span class="token number">5008.0</span>
<span class="token number">1</span>       <span class="token number">1008</span>    <span class="token variable">Jack08</span>  <span class="token number">5007.0</span>
<span class="token number">1</span>       <span class="token number">1007</span>    <span class="token variable">Jack07</span>  <span class="token number">5006.0</span>
<span class="token number">1</span>       <span class="token number">1006</span>    <span class="token variable">Jack06</span>  <span class="token number">5005.0</span>
<span class="token number">1</span>       <span class="token number">1005</span>    <span class="token variable">Jack05</span>  <span class="token number">5004.0</span>
<span class="token number">1</span>       <span class="token number">1004</span>    <span class="token variable">Jack04</span>  <span class="token number">5003.0</span>
<span class="token number">5</span>       <span class="token number">1052</span>    <span class="token variable">Ace07</span>   <span class="token number">9705.0</span>
<span class="token number">5</span>       <span class="token number">1050</span>    <span class="token variable">Ace05</span>   <span class="token number">9703.0</span>
<span class="token number">5</span>       <span class="token number">1049</span>    <span class="token variable">Ace04</span>   <span class="token number">9702.0</span>
<span class="token number">5</span>       <span class="token number">1047</span>    <span class="token variable">Ace02</span>   <span class="token number">9700.0</span>
<span class="token number">4</span>       <span class="token number">1037</span>    <span class="token variable">Jimmy04</span> <span class="token number">10003.0</span>
<span class="token number">4</span>       <span class="token number">1036</span>    <span class="token variable">Jimmy03</span> <span class="token number">10002.0</span>
<span class="token number">4</span>       <span class="token number">1034</span>    <span class="token variable">Jimmy01</span> <span class="token number">10000.0</span>
<span class="token number">3</span>       <span class="token number">1028</span>    <span class="token variable">Lucy07</span>  <span class="token number">8546.0</span>
<span class="token number">3</span>       <span class="token number">1026</span>    <span class="token variable">Lucy05</span>  <span class="token number">8544.0</span>
<span class="token number">3</span>       <span class="token number">1025</span>    <span class="token variable">Lucy04</span>  <span class="token number">8543.0</span>
<span class="token number">2</span>       <span class="token number">1019</span>    <span class="token variable">Maria07</span> <span class="token number">7506.0</span>
<span class="token number">2</span>       <span class="token number">1016</span>    <span class="token variable">Maria04</span> <span class="token number">7503.0</span>
<span class="token number">2</span>       <span class="token number">1013</span>    <span class="token variable">Maria01</span> <span class="token number">7500.0</span>
<span class="token number">1</span>       <span class="token number">1011</span>    <span class="token variable">Jack11</span>  <span class="token number">5010.0</span>
<span class="token number">1</span>       <span class="token number">1010</span>    <span class="token variable">Jack10</span>  <span class="token number">5009.0</span>
<span class="token number">1</span>       <span class="token number">1003</span>    <span class="token variable">Jack03</span>  <span class="token number">5002.0</span>
<span class="token number">1</span>       <span class="token number">1002</span>    <span class="token variable">Jack02</span>  <span class="token number">5001.0</span>
<span class="token number">1</span>       <span class="token number">1001</span>    <span class="token variable">Jack01</span>  <span class="token number">5000.0</span>
<span class="token number">5</span>       <span class="token number">1051</span>    <span class="token variable">Ace06</span>   <span class="token number">9704.0</span>
<span class="token number">4</span>       <span class="token number">1044</span>    <span class="token variable">Jimmy11</span> <span class="token number">6304.0</span>
<span class="token number">4</span>       <span class="token number">1043</span>    <span class="token variable">Jimmy10</span> <span class="token number">6303.0</span>
<span class="token number">4</span>       <span class="token number">1042</span>    <span class="token variable">Jimmy09</span> <span class="token number">6302.0</span>
<span class="token number">3</span>       <span class="token number">1032</span>    <span class="token variable">Lucy11</span>  <span class="token number">8550.0</span>
<span class="token number">3</span>       <span class="token number">1030</span>    <span class="token variable">Lucy09</span>  <span class="token number">8548.0</span>
<span class="token number">3</span>       <span class="token number">1027</span>    <span class="token variable">Lucy06</span>  <span class="token number">8545.0</span>
<span class="token number">3</span>       <span class="token number">1022</span>    <span class="token variable">Lucy01</span>  <span class="token number">8540.0</span>
<span class="token number">2</span>       <span class="token number">1020</span>    <span class="token variable">Maria08</span> <span class="token number">7507.0</span>
<span class="token number">2</span>       <span class="token number">1015</span>    <span class="token variable">Maria03</span> <span class="token number">7502.0</span>
<span class="token number">1</span>       <span class="token number">1012</span>    <span class="token variable">Jack12</span>  <span class="token number">5011.0</span>
<span class="token variable">NULL</span>    <span class="token variable">NULL</span>    <span class="token variable">employName</span>      <span class="token variable">NULL</span>
</code></pre> 
<p>可见，具有3个reducer，每个reducer内部进行排序，对全局结果集来说不是排序。</p> 
<pre><code class="prism language-java">（<span class="token number">4</span>）将查询结果导入到文件中（按照员工编号降序排序）
insert overwrite local directory <span class="token string">'/home/hadoop/datas/sortby-result'</span> 
select <span class="token operator">*</span> from employInfo sort by employID desc<span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/91/e5/g0wTqV29_o.png" alt="在这里插入图片描述"><br> 可见，在输出目录下有3个reducer对应的3个输出文件。</p> 
<p>查看每个文件里面的内容：每个文件中内按照员工编号降序排序</p> 
<pre><code class="prism language-handlebars"><span class="token brackets"><span class="token punctuation">[</span><span class="token variable">hadoop@weekend110 sortby-result</span><span class="token punctuation">]</span></span><span class="token variable">$</span> <span class="token variable">cat</span> <span class="token number">000000</span><span class="token variable">_0</span> 
<span class="token number">5</span> <span class="token number">1048</span> <span class="token variable">Ace03</span> <span class="token number">9701.0</span>
<span class="token number">5</span> <span class="token number">1046</span> <span class="token variable">Ace01</span> <span class="token number">6306.0</span>
<span class="token number">4</span> <span class="token number">1045</span> <span class="token variable">Jimmy12</span> <span class="token number">6305.0</span>
<span class="token number">4</span> <span class="token number">1041</span> <span class="token variable">Jimmy08</span> <span class="token number">6301.0</span>
<span class="token number">4</span> <span class="token number">1040</span> <span class="token variable">Jimmy07</span> <span class="token number">6300.0</span>
<span class="token number">4</span> <span class="token number">1039</span> <span class="token variable">Jimmy06</span> <span class="token number">10005.0</span>
<span class="token number">4</span> <span class="token number">1038</span> <span class="token variable">Jimmy05</span> <span class="token number">10004.0</span>
<span class="token number">4</span> <span class="token number">1035</span> <span class="token variable">Jimmy02</span> <span class="token number">10001.0</span>
<span class="token number">3</span> <span class="token number">1033</span> <span class="token variable">Lucy12</span> <span class="token number">8551.0</span>
<span class="token number">3</span> <span class="token number">1031</span> <span class="token variable">Lucy10</span> <span class="token number">8549.0</span>
<span class="token number">3</span> <span class="token number">1029</span> <span class="token variable">Lucy08</span> <span class="token number">8547.0</span>
<span class="token number">3</span> <span class="token number">1024</span> <span class="token variable">Lucy03</span> <span class="token number">8542.0</span>
<span class="token number">3</span> <span class="token number">1023</span> <span class="token variable">Lucy02</span> <span class="token number">8541.0</span>
<span class="token number">2</span> <span class="token number">1021</span> <span class="token variable">Maria09</span> <span class="token number">7508.0</span>
<span class="token number">2</span> <span class="token number">1018</span> <span class="token variable">Maria06</span> <span class="token number">7505.0</span>
<span class="token number">2</span> <span class="token number">1017</span> <span class="token variable">Maria05</span> <span class="token number">7504.0</span>
<span class="token number">2</span> <span class="token number">1014</span> <span class="token variable">Maria02</span> <span class="token number">7501.0</span>
<span class="token number">1</span> <span class="token number">1009</span> <span class="token variable">Jack09</span> <span class="token number">5008.0</span>
<span class="token number">1</span> <span class="token number">1008</span> <span class="token variable">Jack08</span> <span class="token number">5007.0</span>
<span class="token number">1</span> <span class="token number">1007</span> <span class="token variable">Jack07</span> <span class="token number">5006.0</span>
<span class="token number">1</span> <span class="token number">1006</span> <span class="token variable">Jack06</span> <span class="token number">5005.0</span>
<span class="token number">1</span> <span class="token number">1005</span> <span class="token variable">Jack05</span> <span class="token number">5004.0</span>
<span class="token number">1</span> <span class="token number">1004</span> <span class="token variable">Jack04</span> <span class="token number">5003.0</span>
<span class="token brackets"><span class="token punctuation">[</span><span class="token variable">hadoop@weekend110 sortby-result</span><span class="token punctuation">]</span></span><span class="token variable">$</span> <span class="token variable">cat</span> <span class="token number">000001</span><span class="token variable">_0</span>   
<span class="token number">5</span> <span class="token number">1052</span> <span class="token variable">Ace07</span> <span class="token number">9705.0</span>
<span class="token number">5</span> <span class="token number">1050</span> <span class="token variable">Ace05</span> <span class="token number">9703.0</span>
<span class="token number">5</span> <span class="token number">1049</span> <span class="token variable">Ace04</span> <span class="token number">9702.0</span>
<span class="token number">5</span> <span class="token number">1047</span> <span class="token variable">Ace02</span> <span class="token number">9700.0</span>
<span class="token number">4</span> <span class="token number">1037</span> <span class="token variable">Jimmy04</span> <span class="token number">10003.0</span>
<span class="token number">4</span> <span class="token number">1036</span> <span class="token variable">Jimmy03</span> <span class="token number">10002.0</span>
<span class="token number">4</span> <span class="token number">1034</span> <span class="token variable">Jimmy01</span> <span class="token number">10000.0</span>
<span class="token number">3</span> <span class="token number">1028</span> <span class="token variable">Lucy07</span> <span class="token number">8546.0</span>
<span class="token number">3</span> <span class="token number">1026</span> <span class="token variable">Lucy05</span> <span class="token number">8544.0</span>
<span class="token number">3</span> <span class="token number">1025</span> <span class="token variable">Lucy04</span> <span class="token number">8543.0</span>
<span class="token number">2</span> <span class="token number">1019</span> <span class="token variable">Maria07</span> <span class="token number">7506.0</span>
<span class="token number">2</span> <span class="token number">1016</span> <span class="token variable">Maria04</span> <span class="token number">7503.0</span>
<span class="token number">2</span> <span class="token number">1013</span> <span class="token variable">Maria01</span> <span class="token number">7500.0</span>
<span class="token number">1</span> <span class="token number">1011</span> <span class="token variable">Jack11</span> <span class="token number">5010.0</span>
<span class="token number">1</span> <span class="token number">1010</span> <span class="token variable">Jack10</span> <span class="token number">5009.0</span>
<span class="token number">1</span> <span class="token number">1003</span> <span class="token variable">Jack03</span> <span class="token number">5002.0</span>
<span class="token number">1</span> <span class="token number">1002</span> <span class="token variable">Jack02</span> <span class="token number">5001.0</span>
<span class="token number">1</span> <span class="token number">1001</span> <span class="token variable">Jack01</span> <span class="token number">5000.0</span>
<span class="token brackets"><span class="token punctuation">[</span><span class="token variable">hadoop@weekend110 sortby-result</span><span class="token punctuation">]</span></span><span class="token variable">$</span> <span class="token variable">cat</span> <span class="token number">000002</span><span class="token variable">_0</span>  
<span class="token number">5</span> <span class="token number">1051</span> <span class="token variable">Ace06</span> <span class="token number">9704.0</span>
<span class="token number">4</span> <span class="token number">1044</span> <span class="token variable">Jimmy11</span> <span class="token number">6304.0</span>
<span class="token number">4</span> <span class="token number">1043</span> <span class="token variable">Jimmy10</span> <span class="token number">6303.0</span>
<span class="token number">4</span> <span class="token number">1042</span> <span class="token variable">Jimmy09</span> <span class="token number">6302.0</span>
<span class="token number">3</span> <span class="token number">1032</span> <span class="token variable">Lucy11</span> <span class="token number">8550.0</span>
<span class="token number">3</span> <span class="token number">1030</span> <span class="token variable">Lucy09</span> <span class="token number">8548.0</span>
<span class="token number">3</span> <span class="token number">1027</span> <span class="token variable">Lucy06</span> <span class="token number">8545.0</span>
<span class="token number">3</span> <span class="token number">1022</span> <span class="token variable">Lucy01</span> <span class="token number">8540.0</span>
<span class="token number">2</span> <span class="token number">1020</span> <span class="token variable">Maria08</span> <span class="token number">7507.0</span>
<span class="token number">2</span> <span class="token number">1015</span> <span class="token variable">Maria03</span> <span class="token number">7502.0</span>
<span class="token number">1</span> <span class="token number">1012</span> <span class="token variable">Jack12</span> <span class="token number">5011.0</span>
<span class="token punctuation">\</span><span class="token variable">N</span> <span class="token punctuation">\</span><span class="token variable">N</span> <span class="token variable">employName</span> <span class="token punctuation">\</span><span class="token variable">N</span>
</code></pre> 
<p><strong>三、distribute by（分区排序）</strong></p> 
<p><strong>1、作用：</strong><br> 在有些情况下，我们需要控制某个特定行应该到哪个reducer，通常是为了进行后续的聚集操作。distribute by 子句可以做这件事。distribute by类似MR中partition（自定义分区），进行分区，结合sort by使用。distribute by和sort by的常见使用场景有：</p> 
<ul><li>Map输出的文件大小不均</li><li>Reduce输出文件大小不均</li><li>小文件过多</li><li>文件超大</li></ul> 
<p><strong>2、案例实操：</strong><br> 提示：对于distribute by进行测试，一定要分配多reduce进行处理，否则无法看到distribute by的效果。</p> 
<pre><code class="prism language-java">（<span class="token number">1</span>）设置reducer的个数为<span class="token number">4</span>
set mapreduce<span class="token punctuation">.</span>job<span class="token punctuation">.</span>reduces<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span>
（<span class="token number">2</span>）将查询结果导入到文件中（按照部门编号分区且按照薪资降序排序）
insert overwrite local directory <span class="token string">'/home/hadoop/datas/distribute-result'</span> 
select <span class="token operator">*</span> from employInfo distribute by deptID sort by employSalary desc<span class="token punctuation">;</span>
</code></pre> 
<p>查看执行结果：<br> <img src="https://images2.imgbox.com/f6/67/0Cph4Bij_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/22/80/nECxa5tZ_o.png" alt="在这里插入图片描述"><br> 可见，在输出目录下是4个reducer所对应的4个输出文件，再查看每个文件的内容：</p> 
<pre><code class="prism language-handlebars"><span class="token brackets"><span class="token punctuation">[</span><span class="token variable">hadoop@weekend110 distribute-result</span><span class="token punctuation">]</span></span><span class="token variable">$</span> <span class="token variable">cat</span> <span class="token number">000000</span><span class="token variable">_0</span> 
<span class="token number">4</span> <span class="token number">1039</span> <span class="token variable">Jimmy06</span> <span class="token number">10005.0</span>
<span class="token number">4</span> <span class="token number">1038</span> <span class="token variable">Jimmy05</span> <span class="token number">10004.0</span>
<span class="token number">4</span> <span class="token number">1037</span> <span class="token variable">Jimmy04</span> <span class="token number">10003.0</span>
<span class="token number">4</span> <span class="token number">1036</span> <span class="token variable">Jimmy03</span> <span class="token number">10002.0</span>
<span class="token number">4</span> <span class="token number">1035</span> <span class="token variable">Jimmy02</span> <span class="token number">10001.0</span>
<span class="token number">4</span> <span class="token number">1034</span> <span class="token variable">Jimmy01</span> <span class="token number">10000.0</span>
<span class="token number">4</span> <span class="token number">1045</span> <span class="token variable">Jimmy12</span> <span class="token number">6305.0</span>
<span class="token number">4</span> <span class="token number">1044</span> <span class="token variable">Jimmy11</span> <span class="token number">6304.0</span>
<span class="token number">4</span> <span class="token number">1043</span> <span class="token variable">Jimmy10</span> <span class="token number">6303.0</span>
<span class="token number">4</span> <span class="token number">1042</span> <span class="token variable">Jimmy09</span> <span class="token number">6302.0</span>
<span class="token number">4</span> <span class="token number">1041</span> <span class="token variable">Jimmy08</span> <span class="token number">6301.0</span>
<span class="token number">4</span> <span class="token number">1040</span> <span class="token variable">Jimmy07</span> <span class="token number">6300.0</span>
<span class="token punctuation">\</span><span class="token variable">N</span> <span class="token punctuation">\</span><span class="token variable">N</span> <span class="token variable">employName</span> <span class="token punctuation">\</span><span class="token variable">N</span>
<span class="token brackets"><span class="token punctuation">[</span><span class="token variable">hadoop@weekend110 distribute-result</span><span class="token punctuation">]</span></span><span class="token variable">$</span> <span class="token variable">cat</span> <span class="token number">000001</span><span class="token variable">_0</span> 
<span class="token number">5</span> <span class="token number">1052</span> <span class="token variable">Ace07</span> <span class="token number">9705.0</span>
<span class="token number">5</span> <span class="token number">1051</span> <span class="token variable">Ace06</span> <span class="token number">9704.0</span>
<span class="token number">5</span> <span class="token number">1050</span> <span class="token variable">Ace05</span> <span class="token number">9703.0</span>
<span class="token number">5</span> <span class="token number">1049</span> <span class="token variable">Ace04</span> <span class="token number">9702.0</span>
<span class="token number">5</span> <span class="token number">1048</span> <span class="token variable">Ace03</span> <span class="token number">9701.0</span>
<span class="token number">5</span> <span class="token number">1047</span> <span class="token variable">Ace02</span> <span class="token number">9700.0</span>
<span class="token number">5</span> <span class="token number">1046</span> <span class="token variable">Ace01</span> <span class="token number">6306.0</span>
<span class="token number">1</span> <span class="token number">1012</span> <span class="token variable">Jack12</span> <span class="token number">5011.0</span>
<span class="token number">1</span> <span class="token number">1011</span> <span class="token variable">Jack11</span> <span class="token number">5010.0</span>
<span class="token number">1</span> <span class="token number">1010</span> <span class="token variable">Jack10</span> <span class="token number">5009.0</span>
<span class="token number">1</span> <span class="token number">1009</span> <span class="token variable">Jack09</span> <span class="token number">5008.0</span>
<span class="token number">1</span> <span class="token number">1008</span> <span class="token variable">Jack08</span> <span class="token number">5007.0</span>
<span class="token number">1</span> <span class="token number">1007</span> <span class="token variable">Jack07</span> <span class="token number">5006.0</span>
<span class="token number">1</span> <span class="token number">1006</span> <span class="token variable">Jack06</span> <span class="token number">5005.0</span>
<span class="token number">1</span> <span class="token number">1005</span> <span class="token variable">Jack05</span> <span class="token number">5004.0</span>
<span class="token number">1</span> <span class="token number">1004</span> <span class="token variable">Jack04</span> <span class="token number">5003.0</span>
<span class="token number">1</span> <span class="token number">1003</span> <span class="token variable">Jack03</span> <span class="token number">5002.0</span>
<span class="token number">1</span> <span class="token number">1002</span> <span class="token variable">Jack02</span> <span class="token number">5001.0</span>
<span class="token number">1</span> <span class="token number">1001</span> <span class="token variable">Jack01</span> <span class="token number">5000.0</span>
<span class="token brackets"><span class="token punctuation">[</span><span class="token variable">hadoop@weekend110 distribute-result</span><span class="token punctuation">]</span></span><span class="token variable">$</span> <span class="token variable">cat</span> <span class="token number">000002</span><span class="token variable">_0</span> 
<span class="token number">2</span> <span class="token number">1021</span> <span class="token variable">Maria09</span> <span class="token number">7508.0</span>
<span class="token number">2</span> <span class="token number">1020</span> <span class="token variable">Maria08</span> <span class="token number">7507.0</span>
<span class="token number">2</span> <span class="token number">1019</span> <span class="token variable">Maria07</span> <span class="token number">7506.0</span>
<span class="token number">2</span> <span class="token number">1018</span> <span class="token variable">Maria06</span> <span class="token number">7505.0</span>
<span class="token number">2</span> <span class="token number">1017</span> <span class="token variable">Maria05</span> <span class="token number">7504.0</span>
<span class="token number">2</span> <span class="token number">1016</span> <span class="token variable">Maria04</span> <span class="token number">7503.0</span>
<span class="token number">2</span> <span class="token number">1015</span> <span class="token variable">Maria03</span> <span class="token number">7502.0</span>
<span class="token number">2</span> <span class="token number">1014</span> <span class="token variable">Maria02</span> <span class="token number">7501.0</span>
<span class="token number">2</span> <span class="token number">1013</span> <span class="token variable">Maria01</span> <span class="token number">7500.0</span>
<span class="token brackets"><span class="token punctuation">[</span><span class="token variable">hadoop@weekend110 distribute-result</span><span class="token punctuation">]</span></span><span class="token variable">$</span> <span class="token variable">cat</span> <span class="token number">000003</span><span class="token variable">_0</span> 
<span class="token number">3</span> <span class="token number">1033</span> <span class="token variable">Lucy12</span> <span class="token number">8551.0</span>
<span class="token number">3</span> <span class="token number">1032</span> <span class="token variable">Lucy11</span> <span class="token number">8550.0</span>
<span class="token number">3</span> <span class="token number">1031</span> <span class="token variable">Lucy10</span> <span class="token number">8549.0</span>
<span class="token number">3</span> <span class="token number">1030</span> <span class="token variable">Lucy09</span> <span class="token number">8548.0</span>
<span class="token number">3</span> <span class="token number">1029</span> <span class="token variable">Lucy08</span> <span class="token number">8547.0</span>
<span class="token number">3</span> <span class="token number">1028</span> <span class="token variable">Lucy07</span> <span class="token number">8546.0</span>
<span class="token number">3</span> <span class="token number">1027</span> <span class="token variable">Lucy06</span> <span class="token number">8545.0</span>
<span class="token number">3</span> <span class="token number">1026</span> <span class="token variable">Lucy05</span> <span class="token number">8544.0</span>
<span class="token number">3</span> <span class="token number">1025</span> <span class="token variable">Lucy04</span> <span class="token number">8543.0</span>
<span class="token number">3</span> <span class="token number">1024</span> <span class="token variable">Lucy03</span> <span class="token number">8542.0</span>
<span class="token number">3</span> <span class="token number">1023</span> <span class="token variable">Lucy02</span> <span class="token number">8541.0</span>
<span class="token number">3</span> <span class="token number">1022</span> <span class="token variable">Lucy01</span> <span class="token number">8540.0</span>
</code></pre> 
<p>显然，有个文件中有两个分区且分区是降序排序的，有两个分区这个可以理解，因为reducer只有4个，而部门有5个。另外，每个文件中都是按照部门编号分区降序且分区下又是按照员工的薪资降序排序的。</p> 
<p><strong>四、cluster by</strong></p> 
<p><strong>1、作用：</strong><br> 当distribute by和sorts by字段相同时，可以使用cluster by方式代替。<br> cluster by除了具有distribute by的功能外还兼具sort by的功能。但是排序只能是升序排序，不能像distribute by一样去指定排序的规则为ASC或者DESC，否则报错：<br> <img src="https://images2.imgbox.com/ec/8b/pRwhoAUj_o.png" alt="在这里插入图片描述"><br> 以下两种写法等价：</p> 
<pre><code class="prism language-java">select <span class="token operator">*</span> from employInfo cluster by deptID<span class="token punctuation">;</span>
select <span class="token operator">*</span> from employInfo distribute by deptID sort by deptID<span class="token punctuation">;</span>
</code></pre> 
<p><strong>2、案例实操：</strong></p> 
<pre><code class="prism language-java">将查询结果导入到文件中（按照部门编号分区且默认以升序排序）
insert overwrite local directory <span class="token string">'/home/hadoop/datas/cluster-result'</span> 
select <span class="token operator">*</span> from employInfo cluster by deptID<span class="token punctuation">;</span>
</code></pre> 
<p>查看目标目录下的输出文件：<br> <img src="https://images2.imgbox.com/96/a0/77xwox1E_o.png" alt="在这里插入图片描述"><br> 查看每个文件的内容：</p> 
<pre><code class="prism language-handlebars"><span class="token brackets"><span class="token punctuation">[</span><span class="token variable">hadoop@weekend110 cluster-result</span><span class="token punctuation">]</span></span><span class="token variable">$</span> <span class="token variable">cat</span> <span class="token number">000000</span><span class="token variable">_0</span> 
<span class="token punctuation">\</span><span class="token variable">N</span> <span class="token punctuation">\</span><span class="token variable">N</span> <span class="token variable">employName</span> <span class="token punctuation">\</span><span class="token variable">N</span>
<span class="token number">4</span> <span class="token number">1039</span> <span class="token variable">Jimmy06</span> <span class="token number">10005.0</span>
<span class="token number">4</span> <span class="token number">1038</span> <span class="token variable">Jimmy05</span> <span class="token number">10004.0</span>
<span class="token number">4</span> <span class="token number">1037</span> <span class="token variable">Jimmy04</span> <span class="token number">10003.0</span>
<span class="token number">4</span> <span class="token number">1036</span> <span class="token variable">Jimmy03</span> <span class="token number">10002.0</span>
<span class="token number">4</span> <span class="token number">1035</span> <span class="token variable">Jimmy02</span> <span class="token number">10001.0</span>
<span class="token number">4</span> <span class="token number">1034</span> <span class="token variable">Jimmy01</span> <span class="token number">10000.0</span>
<span class="token number">4</span> <span class="token number">1045</span> <span class="token variable">Jimmy12</span> <span class="token number">6305.0</span>
<span class="token number">4</span> <span class="token number">1044</span> <span class="token variable">Jimmy11</span> <span class="token number">6304.0</span>
<span class="token number">4</span> <span class="token number">1043</span> <span class="token variable">Jimmy10</span> <span class="token number">6303.0</span>
<span class="token number">4</span> <span class="token number">1042</span> <span class="token variable">Jimmy09</span> <span class="token number">6302.0</span>
<span class="token number">4</span> <span class="token number">1041</span> <span class="token variable">Jimmy08</span> <span class="token number">6301.0</span>
<span class="token number">4</span> <span class="token number">1040</span> <span class="token variable">Jimmy07</span> <span class="token number">6300.0</span>
<span class="token brackets"><span class="token punctuation">[</span><span class="token variable">hadoop@weekend110 cluster-result</span><span class="token punctuation">]</span></span><span class="token variable">$</span> <span class="token variable">cat</span> <span class="token number">000001</span><span class="token variable">_0</span> 
<span class="token number">1</span> <span class="token number">1007</span> <span class="token variable">Jack07</span> <span class="token number">5006.0</span>
<span class="token number">1</span> <span class="token number">1008</span> <span class="token variable">Jack08</span> <span class="token number">5007.0</span>
<span class="token number">1</span> <span class="token number">1009</span> <span class="token variable">Jack09</span> <span class="token number">5008.0</span>
<span class="token number">1</span> <span class="token number">1010</span> <span class="token variable">Jack10</span> <span class="token number">5009.0</span>
<span class="token number">1</span> <span class="token number">1011</span> <span class="token variable">Jack11</span> <span class="token number">5010.0</span>
<span class="token number">1</span> <span class="token number">1012</span> <span class="token variable">Jack12</span> <span class="token number">5011.0</span>
<span class="token number">1</span> <span class="token number">1001</span> <span class="token variable">Jack01</span> <span class="token number">5000.0</span>
<span class="token number">1</span> <span class="token number">1002</span> <span class="token variable">Jack02</span> <span class="token number">5001.0</span>
<span class="token number">1</span> <span class="token number">1003</span> <span class="token variable">Jack03</span> <span class="token number">5002.0</span>
<span class="token number">1</span> <span class="token number">1004</span> <span class="token variable">Jack04</span> <span class="token number">5003.0</span>
<span class="token number">1</span> <span class="token number">1005</span> <span class="token variable">Jack05</span> <span class="token number">5004.0</span>
<span class="token number">1</span> <span class="token number">1006</span> <span class="token variable">Jack06</span> <span class="token number">5005.0</span>
<span class="token number">5</span> <span class="token number">1052</span> <span class="token variable">Ace07</span> <span class="token number">9705.0</span>
<span class="token number">5</span> <span class="token number">1051</span> <span class="token variable">Ace06</span> <span class="token number">9704.0</span>
<span class="token number">5</span> <span class="token number">1050</span> <span class="token variable">Ace05</span> <span class="token number">9703.0</span>
<span class="token number">5</span> <span class="token number">1049</span> <span class="token variable">Ace04</span> <span class="token number">9702.0</span>
<span class="token number">5</span> <span class="token number">1048</span> <span class="token variable">Ace03</span> <span class="token number">9701.0</span>
<span class="token number">5</span> <span class="token number">1047</span> <span class="token variable">Ace02</span> <span class="token number">9700.0</span>
<span class="token number">5</span> <span class="token number">1046</span> <span class="token variable">Ace01</span> <span class="token number">6306.0</span>
<span class="token brackets"><span class="token punctuation">[</span><span class="token variable">hadoop@weekend110 cluster-result</span><span class="token punctuation">]</span></span><span class="token variable">$</span> <span class="token variable">cat</span> <span class="token number">000002</span><span class="token variable">_0</span> 
<span class="token number">2</span> <span class="token number">1019</span> <span class="token variable">Maria07</span> <span class="token number">7506.0</span>
<span class="token number">2</span> <span class="token number">1020</span> <span class="token variable">Maria08</span> <span class="token number">7507.0</span>
<span class="token number">2</span> <span class="token number">1018</span> <span class="token variable">Maria06</span> <span class="token number">7505.0</span>
<span class="token number">2</span> <span class="token number">1017</span> <span class="token variable">Maria05</span> <span class="token number">7504.0</span>
<span class="token number">2</span> <span class="token number">1016</span> <span class="token variable">Maria04</span> <span class="token number">7503.0</span>
<span class="token number">2</span> <span class="token number">1015</span> <span class="token variable">Maria03</span> <span class="token number">7502.0</span>
<span class="token number">2</span> <span class="token number">1014</span> <span class="token variable">Maria02</span> <span class="token number">7501.0</span>
<span class="token number">2</span> <span class="token number">1013</span> <span class="token variable">Maria01</span> <span class="token number">7500.0</span>
<span class="token number">2</span> <span class="token number">1021</span> <span class="token variable">Maria09</span> <span class="token number">7508.0</span>
<span class="token brackets"><span class="token punctuation">[</span><span class="token variable">hadoop@weekend110 cluster-result</span><span class="token punctuation">]</span></span><span class="token variable">$</span> <span class="token variable">cat</span> <span class="token number">000003</span><span class="token variable">_0</span> 
<span class="token number">3</span> <span class="token number">1023</span> <span class="token variable">Lucy02</span> <span class="token number">8541.0</span>
<span class="token number">3</span> <span class="token number">1022</span> <span class="token variable">Lucy01</span> <span class="token number">8540.0</span>
<span class="token number">3</span> <span class="token number">1024</span> <span class="token variable">Lucy03</span> <span class="token number">8542.0</span>
<span class="token number">3</span> <span class="token number">1025</span> <span class="token variable">Lucy04</span> <span class="token number">8543.0</span>
<span class="token number">3</span> <span class="token number">1027</span> <span class="token variable">Lucy06</span> <span class="token number">8545.0</span>
<span class="token number">3</span> <span class="token number">1028</span> <span class="token variable">Lucy07</span> <span class="token number">8546.0</span>
<span class="token number">3</span> <span class="token number">1029</span> <span class="token variable">Lucy08</span> <span class="token number">8547.0</span>
<span class="token number">3</span> <span class="token number">1030</span> <span class="token variable">Lucy09</span> <span class="token number">8548.0</span>
<span class="token number">3</span> <span class="token number">1031</span> <span class="token variable">Lucy10</span> <span class="token number">8549.0</span>
<span class="token number">3</span> <span class="token number">1032</span> <span class="token variable">Lucy11</span> <span class="token number">8550.0</span>
<span class="token number">3</span> <span class="token number">1033</span> <span class="token variable">Lucy12</span> <span class="token number">8551.0</span>
<span class="token number">3</span> <span class="token number">1026</span> <span class="token variable">Lucy05</span> <span class="token number">8544.0</span>
</code></pre> 
<p>可见，每个输出文件中是按照部门分区且多个分区的话默认是升序排序的。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fb1bb8ec68a5d4ff8c29965aefc1a3e3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">a2dp播放流程源码分析</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a8cf7ae14f1536b875b5e1e5cb9123e5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Win 7中excel 2016未响应</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>