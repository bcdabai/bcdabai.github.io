<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>淘宝OpenAPI使用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="淘宝OpenAPI使用" />
<meta property="og:description" content="我也使用淘宝OpenAPI也大半年了。不过了，由于阿里软件的文档比较的乱，让很多初学者分不清头绪（注：淘宝OpenAPI是开放在阿里软件的一个平台上，是什么服务集群平台吧）。当然了，在中国，能够将自己的服务资源开放出来给第三方使用，特别是淘宝网这种大型商业网站来说，阿里巴巴的这种分享精神和开放的胸怀还是令人佩服的。因此在使用OpenAPI过程中，我们如果觉得资料不是很充分，也不要过多的抱怨，开放的同时意味着责任。呵呵！ 在这了，趁端午节放假，将我使用淘宝Open API的心得分享出来，先写一篇简单的入门教程，也算是分享和开放吧。
通过阅读阿里软件提供的文档，我们对如何调用淘宝OpenAPI有了基本的了解。阿里软件OpenAPI平台即服务集成平台SIP相关的文档链接如下（在使用SIP平台上的OpenAPI还是先要了解下该平台的相关策略如安全策略，访问控制策略等）：
http://wiki.isv.alisoft.com/index.php/%E6%9C%8D%E5%8A%A1%E9%9B%86%E6%88%90%E5%B9%B3%E5%8F%B0
服务集群平台就不多唠叨了，去上面的文档地址去看看。我就简要的讲讲就我所知道的一些值得注意的地方：
1.淘宝OpenAPI每分钟访问的次数是有限制的，好像是400次/分钟，即一个应用访问任何一个淘宝API，一分钟内最多只能访问400次；
2.在次数方面，除了上面的控制外，还有日访问次数控制。如果你的应用是上架的，则日访问量没有限制；如果你的应用没有上架，那么一天之内，你访问淘宝OpenAPI的次数累计起来不能超过1000次。不要有意见哦，人家的资源也是有限的，而且还是免费的。
3.服务集成平台的api的安全级别分为四类：无安全策略校验；签名校验；用户授权校验（包含签名校验）；可选用户授权校验（包含签名校验）。淘宝OpenAPI大多都是需要用户授权的。所谓用户授权就是应用软件在操作用户的淘宝数据时，就需要用户授权。如淘宝卖家在使用店铺管理软件维护自己的店铺时，淘宝网就需要淘宝卖家对该店铺软件进行授权，只有授权了，店铺管理软件才能操作淘宝卖家的数据。
4.授权除了上面所描述的外，授权还有时效性。就是授权是有期限的，现在淘宝授权一次的最大有效时效为一个小时。如果在一个小时内，没用调用任何淘宝OpenAPI，则授权过期了，需要重新授权。而对于未上架的应用，授权时效内不管有没有调用淘宝OpenAPI，授权期限过后就需要重新授权。看来，上架的应用还是有相当大的空间优势。
其他的就不多唠叨了，还没有在阿里软件注册应用的，还得先去阿里软件平台注册一个应用，注册成功后，你会得到APPID及CERTCODE。其中APP ID是用来标记应用，即你注册应用的ID，CERT CODE则是你应用的密钥，在做签名时用。
下面直接来个demo，感受下淘宝的OpenAPI。我们调用交易类的taobao.trade.get为例，该api文档地址为：http://isp.alisoft.com/apidoc/api/apiIndex.html#isp_taobao-6-281。可以知道这个api是用户授权，即需要用户授权才可以访问该用户的交易信息。
源代码如下：
import java.security.MessageDigest;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;
import java.util.Set;
import java.util.TreeSet;
import org.apache.commons.httpclient.HttpClient;
import org.apache.commons.httpclient.NameValuePair;
import org.apache.commons.httpclient.methods.PostMethod;
public class TaobaoOpenApiDemo
/**
* 调用淘宝的taobao.trade.get demo，
* 运行该示例时，你需要将appId,appSecret,tid
* 这三个参数替换为你自己的，就可以运行该demo
*
* 在第一次运行时 会提醒你登录淘宝进行授权，
* 授权成功后 再次运行该demo就可以获取指定交易的信息 呵呵
*
* 这只是一个简单的demo，只是为初学者提供方便
* 有了这个原型 大家就可以各显自己的神通了
*/
public static void main(String args)
// 淘宝Open API平台即SIP平台的入口" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/472b228e1c3f73d958e1dd3aa457fa09/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2010-08-09T19:35:00+08:00" />
<meta property="article:modified_time" content="2010-08-09T19:35:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">淘宝OpenAPI使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>我也使用淘宝OpenAPI也大半年了。不过了，由于阿里软件的文档比较的乱，让很多初学者分不清头绪（注：淘宝OpenAPI是开放在阿里软件的一个平台上，是什么服务集群平台吧）。当然了，在中国，能够将自己的服务资源开放出来给第三方使用，特别是淘宝网这种大型商业网站来说，<a href="http://it.hexun.com/2007/alibabaipo/" rel="nofollow noopener noreferrer" target="_blank"><span style="color: #000000;">阿里巴巴</span></a>的这种分享精神和开放的胸怀还是令人佩服的。因此在使用OpenAPI过程中，我们如果觉得资料不是很充分，也不要过多的抱怨，开放的同时意味着责任。呵呵！ </p> 
<p> </p> 
<p>　　在这了，趁端午节放假，将我使用淘宝Open API的心得分享出来，先写一篇简单的入门教程，也算是分享和开放吧。</p> 
<p>　　通过阅读阿里软件提供的文档，我们对如何调用淘宝OpenAPI有了基本的了解。阿里软件OpenAPI平台即服务集成平台SIP相关的文档链接如下（在使用SIP平台上的OpenAPI还是先要了解下该平台的相关策略如安全策略，访问控制策略等）：</p> 
<p>　　http://wiki.isv.alisoft.com/index.php/%E6%9C%8D%E5%8A%A1%E9%9B%86%E6%88%90%E5%B9%B3%E5%8F%B0</p> 
<p>　　服务集群平台就不多唠叨了，去上面的文档地址去看看。我就简要的讲讲就我所知道的一些值得注意的地方：</p> 
<p>　　1.淘宝OpenAPI每分钟访问的次数是有限制的，好像是400次/分钟，即一个应用访问任何一个淘宝API，一分钟内最多只能访问400次；</p> 
<p>　　2.在次数方面，除了上面的控制外，还有日访问次数控制。如果你的应用是上架的，则日访问量没有限制；如果你的应用没有上架，那么一天之内，你访问淘宝OpenAPI的次数累计起来不能超过1000次。不要有意见哦，人家的资源也是有限的，而且还是免费的。</p> 
<p>　　3.服务集成平台的api的安全级别分为四类：无安全策略校验；签名校验；用户授权校验（包含签名校验）；可选用户授权校验（包含签名校验）。淘宝OpenAPI大多都是需要用户授权的。所谓用户授权就是应用软件在操作用户的淘宝数据时，就需要用户授权。如淘宝卖家在使用店铺管理软件维护自己的店铺时，淘宝网就需要淘宝卖家对该店铺软件进行授权，只有授权了，店铺管理软件才能操作淘宝卖家的数据。</p> 
<p>　　4.授权除了上面所描述的外，授权还有时效性。就是授权是有期限的，现在淘宝授权一次的最大有效时效为一个小时。如果在一个小时内，没用调用任何淘宝OpenAPI，则授权过期了，需要重新授权。而对于未上架的应用，授权时效内不管有没有调用淘宝OpenAPI，授权期限过后就需要重新授权。看来，上架的应用还是有相当大的空间优势。</p> 
<p>　　其他的就不多唠叨了，还没有在阿里软件注册应用的，还得先去阿里软件平台注册一个应用，注册成功后，你会得到APPID及CERTCODE。其中APP ID是用来标记应用，即你注册应用的ID，CERT CODE则是你应用的密钥，在做签名时用。</p> 
<p>　　下面直接来个demo，感受下淘宝的OpenAPI。我们调用交易类的taobao.trade.get为例，该api文档地址为：http://isp.alisoft.com/apidoc/api/apiIndex.html#isp_taobao-6-281。可以知道这个api是用户授权，即需要用户授权才可以访问该用户的交易信息。</p> 
<p>　　源代码如下：</p> 
<p>　　import java.security.MessageDigest;</p> 
<p>　　import java.text.SimpleDateFormat;</p> 
<p>　　import java.util.Date;</p> 
<p>　　import java.util.HashMap;</p> 
<p>　　import java.util.Iterator;</p> 
<p>　　import java.util.Map;</p> 
<p>　　import java.util.Set;</p> 
<p>　　import java.util.TreeSet;</p> 
<p>　　import org.apache.commons.httpclient.HttpClient;</p> 
<p>　　import org.apache.commons.httpclient.NameValuePair;</p> 
<p>　　import org.apache.commons.httpclient.methods.PostMethod;</p> 
<p>　　public class TaobaoOpenApiDemo</p> 
<p>　　/**</p> 
<p>　　* 调用淘宝的taobao.trade.get demo，</p> 
<p>　　* 运行该示例时，你需要将appId,appSecret,tid</p> 
<p>　　* 这三个参数替换为你自己的，就可以运行该demo</p> 
<p>　　*</p> 
<p>　　* 在第一次运行时 会提醒你登录淘宝进行授权，</p> 
<p>　　* 授权成功后 再次运行该demo就可以获取指定交易的信息 呵呵</p> 
<p>　　*</p> 
<p>　　* 这只是一个简单的demo，只是为初学者提供方便</p> 
<p>　　* 有了这个原型 大家就可以各显自己的神通了</p> 
<p>　　*/</p> 
<p>　　public static void main(String args)</p> 
<p>　　// 淘宝Open API平台即SIP平台的入口</p> 
<p>　　String sipRequestUrl = "http://sip.alisoft.com/sip/rest";</p> 
<p>　　String appId = "****"; // 在阿里软件平台注册的应用ID,请使用你自己的应用ID</p> 
<p>　　String appSecret = "******"; // 注册的应用的密钥，请使用你自己应用的密钥</p> 
<p>　　String taobaoApiName = "taobao.trade.get"; // 交易类api</p> 
<p>　　String sessionId = "1234567";//sessionId是isv应用自己生成的字符串</p> 
<p>　　//确保每个使用该应用的用户各自的sessionId各不相同</p> 
<p>　　SimpleDateFormat formater = newSimpleDateFormat("yyyy-MM-ddHH:mm:ss");</p> 
<p>　　Map ms = new HashMap();</p> 
<p>　　ms.put("sip_appkey", appId);</p> 
<p>　　ms.put("sip_apiname", taobaoApiName);</p> 
<p>　　ms.put("sip_timestamp", formater.format(new Date()));</p> 
<p>　　ms.put("sip_sessionid", sessionId);</p> 
<p>　　ms.put("fields","seller_nick,buyer_nick,title,type,created,sid");</p> 
<p>　　ms.put("tid", "******"); //请设置你要查询的交易号</p> 
<p>　　ms.put("format", "xml");</p> 
<p>　　ms.put("v", "1.0");</p> 
<p>　　ms.put("sip_sign", getSign(appSecret, ms));</p> 
<p>　　String result = requestOpenApi(sipRequestUrl, ms);</p> 
<p>　　if (result != null&amp;&amp;result.startsWith("sip_isp_loginurl:"))</p> 
<p>　　result = result.replaceAll("&amp;", "&amp;");</p> 
<p>　　System.out.println("打开浏览器，访问下面的URL进行用户授权，授权成功后" +</p> 
<p>　　"，再次运行该类就可以调用api获取交易信息");</p> 
<p>　　System.out.println(result.substring("sip_isp_loginurl:".length()));</p> 
<p>　　else if (result != null)</p> 
<p>　　System.out.println(result);</p> 
<p>　　/**</p> 
<p>　　* 请求淘宝Open API服务</p> 
<p>　　* @m url 服务集群平台入口</p> 
<p>　　* @m ms 请求参数</p> 
<p>　　* @return 请求结果</p> 
<p>　　*/</p> 
<p>　　public static String requestOpenApi(String url, Map ms)</p> 
<p>　　HttpClient client = new HttpClient();</p> 
<p>　　PostMethod postMethod = new PostMethod(url);</p> 
<p>　　try</p> 
<p>　　NameValuePair postData = new NameValuePair[ms.size()];</p> 
<p>　　Iterator iters = ms.keySet().iterator();</p> 
<p>　　int i = 0;</p> 
<p>　　while (iters.hasNext())</p> 
<p>　　String key = (String) iters.next();</p> 
<p>　　postData[i] = new NameValuePair(key, ms.get(key).toString());</p> 
<p>　　i++;</p> 
<p>　　postMethod.setRequestBody(postData);</p> 
<p>　　client.executeMethod(postMethod);</p> 
<p>　　String resultCode =postMethod.getResponseHeader("sip_status")</p> 
<p>　　.getValue();</p> 
<p>　　if (resultCode null ("".equals(resultCode)))</p> 
<p>　　return null;</p> 
<p>　　else if ("1004".equals(resultCode))</p> 
<p>　　return "sip_isp_loginurl:"</p> 
<p>　　+ postMethod.getResponseHeader("sip_isp_loginurl")</p> 
<p>　　.getValue();</p> 
<p>　　else if (!"9999".equals(resultCode))</p> 
<p>　　return resultCode</p> 
<p>　　+ ":"</p> 
<p>　　+ postMethod.getResponseHeader("sip_errormessage")</p> 
<p>　　.getValue();</p> 
<p>　　return postMethod.getResponseBodyAsString();</p> 
<p>　　catch (Exception ex)</p> 
<p>　　ex.printStackTrace();</p> 
<p>　　finally</p> 
<p>　　if (postMethod != null)</p> 
<p>　　postMethod.releaseConnection();</p> 
<p>　　return null;</p> 
<p>　　/**</p> 
<p>　　* 对所有参数进行签名</p> 
<p>　　* @m secret APP ID对应的密钥</p> 
<p>　　* @m ms 请求中所有的参数</p> 
<p>　　* @return 签名</p> 
<p>　　*/</p> 
<p>　　public static String getSign(String secret, Map ms)</p> 
<p>　　if (secret null "".equals(secret) ms null)</p> 
<p>　　throw new RuntimeException(</p> 
<p>　　"secret or ms is null or blank, please check");</p> 
<p>　　StringBuilder sb = new StringBuilder().append(secret);</p> 
<p>　　String result = null;</p> 
<p>　　try</p> 
<p>　　Set sortedKeys = new TreeSet();</p> 
<p>　　sortedKeys.addAll(ms.keySet());</p> 
<p>　　for (String key : sortedKeys)</p> 
<p>　　sb.append(key).append(ms.get(key));</p> 
<p>　　MessageDigest md = MessageDigest.getInstance("MD5");</p> 
<p>　　result=byteTohex(md.digest(sb.toString().getBytes("utf-8")));</p> 
<p>　　catch (Exception e)</p> 
<p>　　throw new RuntimeException(e);</p> 
<p>　　return result;</p> 
<p>　　public static String byteTohex(byte b)</p> 
<p>　　StringBuffer sb = new StringBuffer();</p> 
<p>　　String stmp = "";</p> 
<p>　　for (int n = 0; n &lt; b.length; n++)</p> 
<p>　　stmp = (java.lang.Integer.toHexString(b[n] &amp; 0XFF));</p> 
<p>　　if (stmp.length() 1)</p> 
<p>　　sb.append("0").append(stmp);</p> 
<p>　　else</p> 
<p>　　sb.append(stmp);</p> 
<p>　　return sb.toString().toUpperCase();</p> 
<p>　　上面短短的100多行代码只是向初学者展示如何使用淘宝OpenAPI服务。从代码也可以看到，基于rest的OpenAPI的确使用起来相当的方便。当然，要想使用好淘宝OpenAPI，还得好好的阅读淘宝OpenAPI文档。同时，还需打开自己的思维，使用淘宝OpenAPI编写出有创意的应用。早日上架，早日盈利！</p> 
<p>　　如果大家有什么问题，可以回复本贴，有问必答。大家相互探讨，共同进步。呵呵！</p> 
<p>　　编辑推荐</p> 
<p>　　助推Silverlight 微软与淘宝合作“闪光店铺”</p> 
<p>　　SaaS开发入门 阿里软件平台HelloWorld开发实例</p> 
<p>　　微软Silverlight技术 闪光淘宝</p> 
<p>　　阿里软件投10亿全面进军管理软件市场</p> 
<p>　　SaaS开发入门 阿里软件平台HelloWorld开发实例</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/06931cbe461c3224a317a378900b6fab/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">DirectUI －从配置中动态产生界面</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/451514832b787c7880d59ce4d8172b71/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">接口中的方法可以是static吗？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>