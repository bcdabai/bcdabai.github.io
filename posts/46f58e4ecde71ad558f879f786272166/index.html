<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ORACLE 巡检脚本 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ORACLE 巡检脚本" />
<meta property="og:description" content="脚本内容 vim oracle_inspection_report.sh
#!/bin/bash # # file name: /home/oracle/oracle_inspection_report.sh # # description: # part 1.collecting the DB basic infomation # part 2.collecting the DB performance infomation # part 3.collecting the DB LOG infomation # part 4.collecting the OS infomation # # excute: bash /home/oracle/oracle_inspection_report.sh # # author:chaicheng # # date(yyyy-mm-dd):2019-11-04 # # version:1.0 # # modified:none # echo &#39;Instance Health Data&#39; echo &#39;************************************************&#39; echo &#39;The current database ORACLLE_SID is &#39;$ORACLE_SID echo &#39;The current running processes for &#39;$ORACLE_SID &#39;are&#39; echo &#39;************************************************&#39; #ps -ef|grep $ORACLE_SID sqlplus -S /nolog &lt;&lt;EOF connect / as sysdba set feedback off set heading off select &#39;*******************************************************************************&#39; from dual; select &#39;* 1: DB information *&#39; from dual; select &#39;*******************************************************************************&#39; from dual; select &#39;#####1-1: instance information&#39; from dual; select &#39;************************************************&#39; from dual; set linesize 1000 set pagesize 1000 col HOST_NAME for a10 set heading on select instance_name,host_name,to_char(startup_time,&#39;yyyy-mm-dd hh24:mi:ss&#39;) &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/46f58e4ecde71ad558f879f786272166/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-11-03T22:27:00+08:00" />
<meta property="article:modified_time" content="2019-11-03T22:27:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ORACLE 巡检脚本</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>脚本内容</h3> 
<p>vim oracle_inspection_report.sh</p> 
<pre><code class="prism language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">#</span>
<span class="token comment">#    file name: /home/oracle/oracle_inspection_report.sh   </span>
<span class="token comment">#</span>
<span class="token comment">#    description:</span>
<span class="token comment">#    part 1.collecting the DB basic infomation</span>
<span class="token comment">#    part 2.collecting the DB performance infomation</span>
<span class="token comment">#    part 3.collecting the DB LOG infomation</span>
<span class="token comment">#    part 4.collecting the OS infomation</span>
<span class="token comment">#</span>
<span class="token comment">#    excute: bash /home/oracle/oracle_inspection_report.sh</span>
<span class="token comment">#</span>
<span class="token comment">#    author:chaicheng</span>
<span class="token comment">#  </span>
<span class="token comment">#    date(yyyy-mm-dd):2019-11-04</span>
<span class="token comment">#</span>
<span class="token comment">#    version:1.0</span>
<span class="token comment">#</span>
<span class="token comment">#    modified:none       </span>
<span class="token comment">#    </span>

<span class="token keyword">echo</span> <span class="token string">'Instance Health Data'</span>
<span class="token keyword">echo</span> <span class="token string">'************************************************'</span>
<span class="token keyword">echo</span> <span class="token string">'The current database ORACLLE_SID is '</span><span class="token variable">$ORACLE_SID</span>
<span class="token keyword">echo</span> <span class="token string">'The current running processes for '</span><span class="token variable">$ORACLE_SID</span> <span class="token string">'are'</span>
<span class="token keyword">echo</span> <span class="token string">'************************************************'</span>
<span class="token comment">#ps -ef|grep $ORACLE_SID</span>


sqlplus -S /nolog <span class="token operator">&lt;&lt;</span><span class="token string">EOF     
 connect / as sysdba
set feedback off
set heading off
select '*******************************************************************************' from dual;
select '*                               1: DB information                             *' from dual;
select '*******************************************************************************' from dual;
select '#####1-1: instance information' from dual;
select '************************************************' from dual;
set linesize 1000
set pagesize 1000
col HOST_NAME for a10
set heading on
select instance_name,host_name,to_char(startup_time,'yyyy-mm-dd hh24:mi:ss') "startup_time",status,database_status from v\<span class="token variable">$instance</span>;


set heading off
select '#####1-2: database created date and archive type' from dual;
select '************************************************' from dual;
set heading on 
Select to_char(Created,'yyyy-mm-dd hh24:mi:ss') "Created Time",Log_Mode From V\<span class="token variable">$Database</span>;


set heading off
select '#####1-3: ulimit oracle' from dual;
select '************************************************' from dual;
!ulimit -a


set heading off
col VALUE for a10
select '#####1-4: installed production option' from dual;
select '************************************************' from dual;
set linesize 1000
set pagesize 1000
set heading on
select * from v\<span class="token variable">$option</span>;


set heading off
select '#####1-5: used production component' from dual;
select '************************************************' from dual;
set linesize 1000
set pagesize 1000
col COMP_NAME for a40
set heading on
select COMP_ID, COMP_NAME, VERSION,STATUS from   dba_registry;


set heading off
select '#####1-6: spfile' from dual;
select '************************************************' from dual;
show parameter spfile


set heading off
select '#####1-7: not default parameter' from dual;
select '************************************************' from dual;
col name for a40
col value for a40
set heading on
select name,value from v\<span class="token variable">$parameter</span> where isdefault='FALSE';


set heading off
select '#####1-8: control file' from dual;
select '************************************************' from dual;
show parameter control_files


set heading off
select '#####1-9: backup control file' from dual;
select '************************************************' from dual;
alter database backup controlfile to trace;


set heading off
select '#####1-10: log file' from dual;
select '************************************************' from dual;
set linesize 1000
set pagesize 1000
set heading on
select group#,thread#,bytes/1024/1024 size_MB , members, archived,status from v\<span class="token variable">$Log</span>;


set heading off
select '#####1-11: log file' from dual;
col MEMBER for a40
select '************************************************' from dual;
set heading on
select * From v\<span class="token variable">$logfile</span> order by 1;


set heading off
select '#####1-12: Archive log' from dual;
select '************************************************' from dual;
Archive log list 


select '#####1-13: data file' from dual;
select '************************************************' from dual;
set heading on
col MAX_G for a20
col USED_G for a20 
select count(*),sum(bytes)/1024/1024/1024 ||'G'  max_G from v\<span class="token variable">$datafile</span>;
SELECT trunc(sum(sum_m-sum_free_m)/1024,2)||'G' used_G
FROM ( 
SELECT tablespace_name,sum(bytes)/1024/1024 AS sum_m FROM dba_data_files
where tablespace_name not like 'UNDO%' GROUP BY tablespace_name) df,
(SELECT tablespace_name,
sum(bytes)/1024/1024 AS sum_free_m
FROM dba_free_space GROUP BY tablespace_name ) fs
where df.tablespace_name=fs.tablespace_name;


set heading off
select '#####1-14: data file location' from dual;
select '************************************************' from dual;
set heading on
col FILE_NAME for a60
select t1.TABLESPACE_NAME,t1.FILE_ID, t1.bytes/1024/1024 SIZE_MB,t1.AUTOEXTENSIBLE AUT,t2.status,t1.FILE_NAME
from dba_data_files t1,v\<span class="token variable">$datafile</span> t2
where t1.file_id=t2.file#;

set heading off
select '------1-14-1.temp data file' from dual;
select '************************************************' from dual;
set heading on
col FILE_NAME for a60
select FILE_NAME,FILE_ID,TABLESPACE_NAME,BYTES/1024/1024 byte_MB,status,AUTOEXTENSIBLE from sys.dba_temp_files;

set heading off
select '-----1-14-2.temp tablespace' from dual;
select '************************************************' from dual;
set heading on
col file_name for a30
col  byte_MB for a20
col  cached_MB for a20
SELECT d.file_name,  v.status, TO_CHAR((d.bytes / 1024 / 1024), '99999990.000') byte_MB, 
TO_CHAR(NVL(t.bytes_cached, 0) / 1024 / 1024, '99999990.000') cached_MB, d.autoextensible, d.increment_by, d.maxblocks 
FROM sys.dba_temp_files d, v\<span class="token variable">$temp_extent_pool</span> t, v\<span class="token variable">$tempfile</span> v 
WHERE (t.file_id (+)= d.file_id) AND (d.tablespace_name = 'TEMP') AND (d.file_id = v.file#);


set heading off
select '#####1-15: system tablespace' from dual;
select '************************************************' from dual;
set heading on
select owner,segment_type,segment_name from dba_segments where owner not in('SYS','SYSTEM','MDSYS','ORDSYS','OUTLN','WMSYS') and tablespace_name='SYSTEM' order by 1;
exit
EOF</span>

ora_version<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>sqlplus -S <span class="token string">'/ as sysdba'</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
set head off
select version from v\\\<span class="token variable">$instance</span>;
exit;
EOF</span><span class="token variable">`</span></span>

<span class="token keyword">echo</span> <span class="token variable">$ora_version</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">`</span><span class="token keyword">echo</span> $ora_version<span class="token operator">|</span><span class="token function">awk</span> -F<span class="token string">"."</span> <span class="token string">'{print <span class="token variable">$1</span>}'</span><span class="token variable">`</span></span> -ne 8 <span class="token punctuation">]</span>
<span class="token keyword">then</span>
sqlplus -S /nolog <span class="token operator">&lt;&lt;</span><span class="token string">EOF
conn / as sysdba
set linesize 1000
set pagesize 1000
set heading off
select '#####1-16: tablespace fragmentation and free' from dual;
select '************************************************' from dual;
col TABLESPACE_NAME for a30
col FREE_PCT for a20
set heading on
SELECT df.TABLESPACE_NAME,FILES, extent_management ,sum_m as TOTAL_SIZE,--sum(largest) as "MAXFREE_MB", 
sum_free_m as "FREE_MB",to_char(100*sum_free_m/sum_m, '999.99') AS FREE_PCT--,sum(blocks) as "FREE_EXTENTS"
FROM ( SELECT tablespace_name,count(file_id) as files ,sum(bytes)/1024/1024 AS sum_m FROM dba_data_files GROUP BY tablespace_name) df,
(SELECT tablespace_name,--max(bytes)/1024/1024 largest,
sum(bytes)/1024/1024 AS sum_free_m --,count(blocks) as blocks
FROM dba_free_space GROUP BY tablespace_name ) fs,(select tablespace_name,extent_management from dba_tablespaces) ts
where df.tablespace_name=fs.tablespace_name and fs.tablespace_name=ts.tablespace_name; 
exit;
EOF</span>


<span class="token keyword">else</span>
sqlplus -S /nolog <span class="token operator">&lt;&lt;</span><span class="token string">EOF
conn / as sysdba
set linesize 1000
set pagesize 1000
select '#####1-16: tablespace fragmentation and free (8i)' from dual;
select '************************************************' from dual;
col TABLESPACE_NAME for a30
col FREE_PCT for a20
set heading on
SELECT df.TABLESPACE_NAME,FILES, sum_m as TOTAL_SIZE,--sum(largest) as "MAXFREE_MB", 
sum_free_m as "FREE_MB",to_char(100*sum_free_m/sum_m, '999.99') AS FREE_PCT--,sum(blocks) as "FREE_EXTENTS"
FROM ( SELECT tablespace_name,count(file_id) as files ,sum(bytes)/1024/1024 AS sum_m FROM dba_data_files GROUP BY tablespace_name) df,
(SELECT tablespace_name,--max(bytes)/1024/1024 largest,
sum(bytes)/1024/1024 AS sum_free_m --,count(blocks) as blocks
FROM dba_free_space GROUP BY tablespace_name ) fs,(select tablespace_name from dba_tablespaces) ts
where df.tablespace_name=fs.tablespace_name and fs.tablespace_name=ts.tablespace_name; 
exit;
EOF</span>
<span class="token keyword">fi</span>


sqlplus -S /nolog <span class="token operator">&lt;&lt;</span><span class="token string">EOF
conn / as sysdba
set linesize 1000
set pagesize 1000
set heading off
select '#####1-17: object list' from dual;
select '************************************************' from dual;
col OBJECT_TYPE for a20
set heading on
select owner,replace(object_type,' ','_') as OBJECT_TYPE,count(*) from dba_objects where
owner not in ('SYS','SYSTEM') group by owner,object_type order by owner,object_type;


set heading off
select '#####1-18: invalid objects' from dual;
select '************************************************' from dual;
col OBJECT_NAME for a40
col OBJECT_TYPE for a20
set heading on
select OWNER,OBJECT_NAME,replace(OBJECT_TYPE,' ','_') as OBJECT_TYPE,STATUS,TIMESTAMP from dba_objects where status='INVALID';


set heading off
select '#####1-19: dblinks' from dual;
select '************************************************' from dual;
col DB_LINK for a40
col OWNER for a10
col HOST for a20
set heading on
select * from dba_db_links;


set heading off
select '#####1-20: indexes' from dual;
select '************************************************' from dual;
set heading on
select * From dba_indexes where BLEVEL&gt;4;


set heading off
select '#####1-21: dba role' from dual;
select '************************************************' from dual;
set heading on
select grantee,granted_role from dba_role_privs where granted_role='DBA';


set heading off
select '#####1-22: sysdba role' from dual;
select '************************************************' from dual;
set heading on
SELECT * FROM v\<span class="token variable">$pwfile_users</span> order by username;


set head off
select '*******************************************************************************' from dual;
select '*                               2: performance                                *' from dual;
select '*******************************************************************************' from dual;
select ' ' from dual;
select '#####2-1: buffer cache hit ratio:(Higher than 80% is ok, high value does not alwasy mean good performance)' from dual;
select '************************************************' from dual;
set head on
select (1 - (sum(decode(name, 'physical reads', value, 0)) /
(sum(decode(name, 'db block gets', value, 0)) +
sum(decode(name, 'consistent gets', value, 0))))) * 100 
"Hit Ratio" from v\<span class="token variable">$sysstat</span>;

set head off
select '#####2-2: data dictionary hit ratio:should &gt;98%' from dual;
select '************************************************' from dual;
set head on
select (1 - (sum(getmisses) / sum(gets))) * 100 "Hit Ratio"
from v\<span class="token variable">$rowcache</span>;

set head off
select '#####2-3: library cache hit ratio:(Should be kept over 90%, otherwise there mighe be too much reparse)' from dual;
select '************************************************' from dual;
set head on
select sum(pins) / (sum(pins) + sum(reloads)) * 100 "Hit Ratio"
from v\<span class="token variable">$librarycache</span>;

set head off
select '#####2-4: menory sort ratio:should &gt;98%' from dual;
select '************************************************' from dual;
set head on
select a.value "Disk Sorts",
b.value "Memory Sorts",
round<span class="token variable"><span class="token punctuation">((</span><span class="token number">100</span> <span class="token operator">*</span> b.value<span class="token punctuation">)</span> <span class="token operator">/</span>
decode<span class="token punctuation">((</span>a.value <span class="token operator">+</span> b.value<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>a.value <span class="token operator">+</span> b.value<span class="token punctuation">))</span></span>,
2) "Pct Memory Sorts"
from v\<span class="token variable">$sysstat</span> a, v\<span class="token variable">$sysstat</span> b
where a.name = 'sorts (disk)'
and b.name = 'sorts (memory)';

set head off
select '#####2-5: memory top 10 sql read ratio:should &lt;5%' from dual;
select '************************************************' from dual;
set head on
select sum(pct_bufgets)
from (select rank() over(order by buffer_gets desc) as rank_bufgets,
to_char(100 * ratio_to_report(buffer_gets) over(), '999.99') pct_bufgets
from v\<span class="token variable">$sqlarea</span>)
where rank_bufgets &lt; 11;

set heading off
select '' from dual;
select '#####2-6: Top 10 Wait Event (Time unit:Hundreths of a second, IO operations should be common wait event)' from dual;
select '************************************************' from dual;
set heading on
column event format a30
select * from (select event,total_waits,time_waited, average_wait from v\<span class="token variable">$system_event</span> where 
event not like 'SQL*Net%' and event not like '%ipc%' order by total_waits desc) where 
rownum&lt;11;

set head off
select '#####2-7: memory top 10 sql' from dual;
select '************************************************' from dual;
set head on

set serveroutput on size 1000000
declare
top10 number;
text1 varchar2(4000);
x number;
len1 number;
cursor c1 is
select buffer_gets, substr(sql_text, 1, 4000)
from v\<span class="token variable">$sqlarea</span>
order by buffer_gets desc;
begin

dbms_output.put_line('------------' || ' ' || '-------------------');
open c1;
for i in 1 .. 10 loop
fetch c1 into top10, text1;
dbms_output.put_line('------------top sql No.' ||i||'-------------------');
dbms_output.put_line(rpad(to_char(top10), 9) );
len1 := length(text1);
x := 1;
while len1 &gt; x - 1 loop
dbms_output.put_line('  ' || substr(text1, x, 65));
x := x + 66;
end loop;
end loop;
end;
/

set head off
select '#####2-8: IO information' from dual;
select '************************************************' from dual;
set head on
col NAME for a60
Select phyrds,phywrts,d.name from v\<span class="token variable">$datafile</span> d,v\<span class="token variable">$filestat</span> f where f.file#=d.file# order by d.name;

set head off
select '#####2-9: full table scan' from dual;
select '************************************************' from dual;
set head on
select name,value value1 from v\<span class="token variable">$sysstat</span> where name like '%table scan%';

set head off
select '*******************************************************************************' from dual;
select '*                                   3: LOG                                    *' from dual;
select '*******************************************************************************' from dual;
select '#####3-1: sys and system security' from dual;
select '************************************************' from dual;
select username "User(s) with Default Password!",ACCOUNT_STATUS
from dba_users
where password in
('E066D214D5421CCC',  -- dbsnmp
'24ABAB8B06281B4C',  -- ctxsys
'72979A94BAD2AF80',  -- mdsys
'C252E8FA117AF049',  -- odm
'A7A32CD03D3CE8D5',  -- odm_mtr
'88A2B2C183431F00',  -- ordplugins
'7EFA02EC7EA6B86F',  -- ordsys
'4A3BA55E08595C81',  -- outln
'F894844C34402B67',  -- scott
'3F9FBD883D787341',  -- wk_proxy
'79DF7A1BD138CF11',  -- wk_sys
'7C9BA362F8314299',  -- wmsys
'88D8364765FCE6AF',  -- xdb
'F9DA8977092B7B81',  -- tracesvr
'9300C0977D7DC75E',  -- oas_public
'A97282CE3D94E29E',  -- websys
'AC9700FD3F1410EB',  -- lbacsys
'E7B5D92911C831E1',  -- rman
'AC98877DE1297365',  -- perfstat
'66F4EF5650C20355',  -- exfsys
'84B8CBCA4D477FA3',  -- si_informtn_schema
'D4C5016086B2DC6A',  -- sys
'D4DF7931AB130E37')  -- system
;
exit
EOF</span>


<span class="token function">cd</span> <span class="token variable">$ORACLE_HOME</span>/network/admin/
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">'#####3-2: listener configure'</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token keyword">echo</span> <span class="token string">'listener.ora'</span>
<span class="token keyword">echo</span> <span class="token string">'----------------------------------------------'</span>
<span class="token function">cat</span> listener*.ora
<span class="token function">sleep</span> 2<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">'sqlnet.ora'</span>
<span class="token keyword">echo</span> <span class="token string">'----------------------------------------------'</span>
<span class="token function">cat</span> sqlnet*.ora
<span class="token function">sleep</span> 2<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">'tnsnames.ora'</span>
<span class="token keyword">echo</span> <span class="token string">'----------------------------------------------'</span>
<span class="token function">cat</span> tnsnames*.ora
<span class="token function">sleep</span> 2<span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">'#####3-3: user dump'</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
ora_dump<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>sqlplus -S <span class="token string">'/ as sysdba'</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
set head off
select value
from v\\\<span class="token variable">$parameter</span>
where name='user_dump_dest';
exit;
EOF</span><span class="token variable">`</span></span>

<span class="token function">cd</span> <span class="token variable">$ora_dump</span>
<span class="token function">ls</span> -lt<span class="token operator">|</span><span class="token function">head</span> -n 2<span class="token operator">|</span><span class="token function">tail</span> -n 1<span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$9</span>}'</span><span class="token operator">|</span><span class="token function">xargs</span> <span class="token function">cat</span>
<span class="token function">sleep</span> 2<span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">'#####3-4: Alert Log ORA- Warning Error'</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
ora_background_dump<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>sqlplus -S <span class="token string">'/ as sysdba'</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF
set head off
select value
from v\\\<span class="token variable">$parameter</span>
where name='background_dump_dest';
exit;
EOF</span><span class="token variable">`</span></span>

<span class="token function">cd</span> <span class="token variable">$ora_background_dump</span>
<span class="token function">tail</span> -10000 alert_<span class="token variable">$ORACLE_SID</span>.log<span class="token operator">|</span><span class="token function">grep</span> ORA-
<span class="token function">sleep</span> 2<span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">'#####3-5: Alert Log size'</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">du</span> -sh  alert_<span class="token variable">$ORACLE_SID</span>.log

<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">'#####3-6: listener.log size'</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
lsnrctl status<span class="token operator">|</span><span class="token function">grep</span> listener.log<span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$4</span>}'</span><span class="token operator">|</span><span class="token function">xargs</span> <span class="token function">du</span> -sh

<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">'#####3-7: crontab info'</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">crontab</span> -l

<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">'#####3-8:Alert Log  tail 200 nums'</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">tail</span> -2000 alert_<span class="token variable">$ORACLE_SID</span>.log


SYSTEM<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">uname</span> -s<span class="token variable">`</span></span>
<span class="token function">export</span> SYSTEM
<span class="token keyword">echo</span> <span class="token string">' '</span>
<span class="token keyword">echo</span> <span class="token string">'*******************************************************************************'</span> from dual<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">'*                             4.machine information                           *'</span>
<span class="token keyword">echo</span> <span class="token string">'*******************************************************************************'</span> from dual<span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$SYSTEM</span> <span class="token operator">=</span> <span class="token string">"Linux"</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.1: host name"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">hostname</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.2: id"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">id</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.3: Current uptime,users and load averages"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">uptime</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.4: CPU number"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token keyword">echo</span> <span class="token string">'4.4.1 CPU version'</span>
<span class="token keyword">echo</span> <span class="token string">'----------------------------------------------'</span>
<span class="token function">cat</span> /proc/cpuinfo <span class="token operator">|</span> <span class="token function">grep</span> name <span class="token operator">|</span> <span class="token function">cut</span> -f2 -d: <span class="token operator">|</span> <span class="token function">uniq</span> -c
<span class="token keyword">echo</span> <span class="token string">'4.4.2 CPU physical number'</span>
<span class="token keyword">echo</span> <span class="token string">'----------------------------------------------'</span>
<span class="token function">cat</span> /proc/cpuinfo<span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"physical id"</span><span class="token operator">|</span> <span class="token function">sort</span><span class="token operator">|</span> <span class="token function">uniq</span><span class="token operator">|</span> <span class="token function">wc</span> -l
<span class="token keyword">echo</span> <span class="token string">'4.4.3 CPU logical number'</span>
<span class="token keyword">echo</span> <span class="token string">'----------------------------------------------'</span>
<span class="token function">cat</span> /proc/cpuinfo<span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"processor"</span><span class="token operator">|</span> <span class="token function">wc</span> -l
<span class="token keyword">echo</span> <span class="token string">'4.4.4 CPU core number'</span>
<span class="token keyword">echo</span> <span class="token string">'----------------------------------------------'</span>
<span class="token function">cat</span> /proc/cpuinfo<span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"processor"</span><span class="token operator">|</span> <span class="token function">wc</span> -l
<span class="token function">sleep</span> 1<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.5: memory info"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">cat</span> /proc/meminfo
<span class="token function">sleep</span> 1<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.6: disk info"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">df</span> -Th
<span class="token function">sleep</span> 1<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.7: kernel parameter"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">cat</span> /etc/sysctl.conf
<span class="token function">sleep</span> 1<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.8: OS Version"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
lsb_release -a
<span class="token function">sleep</span> 1<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.9: product type"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
dmidecode <span class="token operator">|</span><span class="token function">grep</span> Product
<span class="token function">sleep</span> 1<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.10: CPU memory usage"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">vmstat</span> 5 5
<span class="token function">sleep</span> 1<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.11: top info"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token comment">#top -d 1 -n 20</span>
<span class="token comment">#sleep 5;</span>
<span class="token comment">#top -d 1 -n 20 </span>
<span class="token comment">#sleep 5;</span>
<span class="token comment">#top -d 1 -n 20 </span>
<span class="token comment">#sleep 5;</span>
<span class="token comment">#top -d 1 -n 20 </span>
<span class="token comment">#sleep 5;</span>
<span class="token comment">#top -d 1 -n 20 </span>

<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$SYSTEM</span> <span class="token operator">=</span> <span class="token string">"SunOS"</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.1: host name"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">hostname</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.2: id"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">id</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.3: CPU,memory number"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
/usr/platform/sun4u/sbin/prtdiag -v
<span class="token keyword">echo</span> <span class="token string">"#####4.4: os lever"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">cat</span> /etc/release
<span class="token keyword">echo</span> <span class="token string">"#####4.5: Kernel parameter"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
/usr/sbin/sysdef <span class="token operator">|</span><span class="token function">grep</span> SHM
/usr/sbin/sysdef <span class="token operator">|</span><span class="token function">grep</span> SEM
<span class="token function">cat</span> /etc/system
<span class="token keyword">echo</span> <span class="token string">"#####4.6: disk info"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">df</span> -k
<span class="token keyword">echo</span> <span class="token string">"#####4.7: IP info"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">ifconfig</span> -a
<span class="token function">sleep</span> 1<span class="token punctuation">;</span>

<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$SYSTEM</span> <span class="token operator">=</span> <span class="token string">"AIX"</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.1: host name"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">hostname</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.2: id"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">id</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.3: machine plat"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">uname</span> -M
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.4: CPU,memory number"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
prtconf
<span class="token function">sleep</span> 2<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.5: disk info"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">df</span> -k
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.6: os lever"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
oslevel -r
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.7: kernel parameter"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
lsattr -El sys0
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.8: HACMP"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
lslpp -l <span class="token operator">|</span><span class="token function">grep</span> cluster
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.9: network parameter"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
no -a
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.10: CPU memory usage"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">vmstat</span> 5 5
<span class="token function">sleep</span> 1<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.11: IP info"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">ifconfig</span> -a
<span class="token function">sleep</span> 1<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.12: view cluster"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
lssrc -g cluster
<span class="token function">sleep</span> 1<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.13: view VG"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
lsvg
<span class="token function">sleep</span> 1<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">""</span>


<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$SYSTEM</span> <span class="token operator">=</span> <span class="token string">"HP-UX"</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.1: host name"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">hostname</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.2: id"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">id</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.3: machine plat"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
model
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.4: CPU,memory number"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
machinfo
<span class="token function">sleep</span> 2<span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.5: disk info"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
bdf
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.6: os lever"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
oslevel -r
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.7: HACMP"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
lslpp -l <span class="token operator">|</span><span class="token function">grep</span> cluster
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.8: network parameter"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
no -a
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.9: CPU memory usage"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">vmstat</span> 5 5
<span class="token function">sleep</span> 1<span class="token punctuation">;</span>
sar -du 5 5
<span class="token keyword">echo</span> <span class="token string">""</span>
<span class="token keyword">echo</span> <span class="token string">"#####4.10: IP info"</span>
<span class="token keyword">echo</span> <span class="token string">'**********************************************'</span>
<span class="token function">ifconfig</span> -a

<span class="token keyword">else</span>
<span class="token keyword">echo</span> <span class="token string">"--------------------What?---------------------"</span>
<span class="token keyword">fi</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f15937ed3430001b83913356e8a9a4d8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">kali之beef的使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/36607554d16c695d8ba995a97b811146/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">linux基本操作</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>