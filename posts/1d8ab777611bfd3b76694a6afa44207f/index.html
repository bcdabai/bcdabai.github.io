<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Decode()函数使用技巧 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Decode()函数使用技巧" />
<meta property="og:description" content="decode(条件,值1,翻译值1,值2,翻译值2,...值n,翻译值n,缺省值)
该函数的含义如下：
IF 条件=值1 THEN
RETURN(翻译值1)
ELSIF 条件=值2 THEN
RETURN(翻译值2)
......
ELSIF 条件=值n THEN
RETURN(翻译值n)
ELSE
RETURN(缺省值)
END IF
· 使用方法：
1、比较大小
select decode(sign(变量1-变量2),-1,变量1,变量2) from dual; --取较小值
sign()函数根据某个值是0、正数还是负数，分别返回0、1、-1
例如：
变量1=10，变量2=20
则sign(变量1-变量2)返回-1，decode解码结果为“变量1”，达到了取较小值的目的。
2、表、视图结构转化
现有一个商品销售表sale，表结构为：
month　char(6)　--月份
sell　number(10,2)　--月销售金额
现有数据为：
200001　1000
200002　1100
200003　1200
200004　1300
200005　1400
200006　1500
200007　1600
200101　1100
200202　1200
200301　1300
想要转化为以下结构的数据：
year　char(4)　--年份
month1　number(10,2)　--1月销售金额
month2　number(10,2)　--2月销售金额" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1d8ab777611bfd3b76694a6afa44207f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-07-04T12:55:15+08:00" />
<meta property="article:modified_time" content="2019-07-04T12:55:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Decode()函数使用技巧</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body">
    
 <p><strong><u><span style="color:#0000FF;font-family:'宋体';">decode</span></u></strong><span style="font-family:'宋体';">(条件,值1,翻译值1,值2,翻译值2,...值n,翻译值n,缺省值)<br><br>该函数的含义如下：<br>IF 条件=值1 THEN<br>　　　　RETURN(翻译值1)<br>ELSIF 条件=值2 THEN<br>　　　　RETURN(翻译值2)<br>　　　　......<br>ELSIF 条件=值n THEN<br>　　　　RETURN(翻译值n)<br><br>ELSE<br>　　　　RETURN(缺省值)<br>END IF<br>·        使用方法：<br>1、比较大小<br>select <strong><u><span style="color:#FF0000;">decode</span></u></strong>(sign(变量1-变量2),-1,变量1,变量2) from dual; --取较小值<br>sign()函数根据某个值是0、正数还是负数，分别返回0、1、-1<br><br>例如：<br>变量1=10，变量2=20<br>则sign(变量1-变量2)返回-1，<strong><u><span style="color:#FF0000;">decode</span></u></strong>解码结果为“变量1”，达到了取较小值的目的。<br><br><br>2、表、视图结构转化<br>现有一个商品销售表sale，表结构为：<br>month　　　 char(6)　　　　　 --月份<br>sell　　　　number(10,2)　　　--月销售金额<br><br>现有数据为：<br>200001　　1000<br>200002　　1100<br>200003　　1200<br>200004　　1300<br>200005　　1400<br>200006　　1500<br>200007　　1600<br>200101　　1100<br>200202　　1200<br>200301　　1300<br><br>想要转化为以下结构的数据：<br>year　　　char(4)　　　　　 --年份<br>month1　　number(10,2)　　　--1月销售金额<br>month2　　number(10,2)　　　--2月销售金额<br>month3　　number(10,2)　　　--3月销售金额<br>month4　　number(10,2)　　　--4月销售金额<br>month5　　number(10,2)　　　--5月销售金额<br>month6　　number(10,2)　　　--6月销售金额<br>month7　　number(10,2)　　　--7月销售金额<br>month8　　number(10,2)　　　--8月销售金额<br>month9　　number(10,2)　　　--9月销售金额<br>month10　　number(10,2)　　　--10月销售金额<br>month11　　number(10,2)　　　--11月销售金额<br>month12　　number(10,2)　　　--12月销售金额<br><br>结构转化的SQL语句为：<br>create or replace view<br>v_sale(year,month1,month2,month3,month4,month5,month6,month7,month8,month9,month10,month11,month12)<br>as<br>　　　　select<br>　　　　substrb(month,1,4),<br>　　　　sum(<strong><u><span style="color:#FF0000;">decode</span></u></strong>(substrb(month,5,2),'01',sell,0)),<br>　　　　sum(<strong><u><span style="color:#FF0000;">decode</span></u></strong>(substrb(month,5,2),'02',sell,0)),<br>　　　　sum(<strong><u><span style="color:#FF0000;">decode</span></u></strong>(substrb(month,5,2),'03',sell,0)),<br>　　　　sum(<strong><u><span style="color:#FF0000;">decode</span></u></strong>(substrb(month,5,2),'04',sell,0)),<br>　　　　sum(<strong><u><span style="color:#FF0000;">decode</span></u></strong>(substrb(month,5,2),'05',sell,0)),<br>　　　　sum(<strong><u><span style="color:#FF0000;">decode</span></u></strong>(substrb(month,5,2),'06',sell,0)),<br>　　　　sum(<strong><u><span style="color:#FF0000;">decode</span></u></strong>(substrb(month,5,2),'07',sell,0)),<br>　　　　sum(<strong><u><span style="color:#FF0000;">decode</span></u></strong>(substrb(month,5,2),'08',sell,0)),<br>　　　　sum(<strong><u><span style="color:#FF0000;">decode</span></u></strong>(substrb(month,5,2),'09',sell,0)),<br>　　　　sum(<strong><u><span style="color:#FF0000;">decode</span></u></strong>(substrb(month,5,2),'10',sell,0)),<br>　　　　sum(<strong><u><span style="color:#FF0000;">decode</span></u></strong>(substrb(month,5,2),'11',sell,0)),<br>　　　　sum(<strong><u><span style="color:#FF0000;">decode</span></u></strong>(substrb(month,5,2),'12',sell,0))<br>　　　　from sale<br>　　　　group by substrb(month,1,4);</span></p> 
 <p> </p> 
 <p> </p> 
 <p> </p> 
 <p>员工工作年限分析：计算工作时间1个月，1至6个月，大于6个月的员工人数   1. 分3列显示<br>    2．分3行显示<br>要求：不能用sub-query</p> 
 <p>SELECT QUARTER, COUNT(*) FROM (select EMPLID, <br>DECODE(ceil((last_date_worked-hire_dt)/30), null, 1, 0, 1, 1, 1,<br>2, 2,<br>3, 2,<br>4, 2,<br>5, 3,<br>6, 3,<br>7, 3,<br>8, 4,<br>9, 4,<br>10, 4,<br>11, 4,<br>12, 4,<br>13, 4,<br>5) as quarter<br>from ps_job<br>where action = 'TER') EMP_TER<br>GROUP BY quarter<br>ORDER BY quarter;<br>--group by quarter</p> 
 <p><br>select sum(DECODE(ceil((last_date_worked-hire_dt)/30), null, 1, 0, 1, 1, 1, 0)) 一个月,<br>sum(DECODE(ceil((last_date_worked-hire_dt)/30), 2, 1, 3, 1, 4, 1, 0)) 一至三个月,<br>sum(DECODE(ceil((last_date_worked-hire_dt)/30), 5, 1,<br>5, 1,<br>6, 1, 0)) 三至六个月,<br>sum(DECODE(ceil((last_date_worked-hire_dt)/30), 7, 1,<br>8, 1,<br>9, 1, <br>10, 1,<br>11, 1,<br>12, 1,<br>13, 1,<br>0)) 六至十二个月,<br>sum(decode(sign(ceil((last_date_worked-hire_dt)/30) - 13), 1, 1, 0)) 大于十二个月<br>from ps_job<br>where action = 'TER';<br></p> 
</div> 
<p>转载于:https://www.cnblogs.com/GoDevil/archive/2008/08/11/1265162.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/245e3a35f099df6f037090f3550a207a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VMware安装Ghost版Win10 失败的解决方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4cbd6c76474644931258476040975332/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Find Navigation of Page from Component Name</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>