<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>轻松上手：＜Android Studio笔记应用开发＞（二）大功告成！添加新笔记！ - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="轻松上手：＜Android Studio笔记应用开发＞（二）大功告成！添加新笔记！" />
<meta property="og:description" content="文章目录 一、引言二、第一步 - 数据库创建与管理1. 定义**4个**属性：表名、内容字段、主键字段、时间字段。2. 实现构造方法3. 执行 SQL 语句创建名为 &#34;notes&#34; 的数据库表格。4. 数据库升级5. `NoteDatabase`类的代码(注释详细)如下： 三、第二步 - CRUD操作1. 必要的属性2. 构造方法3. 数据库连接的打开和关闭4. 添加一条笔记记录5. 获取所有笔记记录6. `CRUD`类的代码(注释详细)如下： 四、第三步 - ListView五、第四步 - 主页(`MainActivity`)1. 属性2. `onCreate`方法3. 刷新笔记列表4. `MainActivity`的代码(注释详细)如下： 六、第五步 - 笔记列表(`EditActivity`)1. 新添两个属性：`content`和`time`2. 为意图添加额外数据3. 指定时间显示格式4. `EditActivity`的代码(注释详细)如下： 七、结果演示八、结语持续爆肝更新中...🫡🫡🫡求点赞👍求关注🤗求转发😍 一、引言 欢迎回到我们的Android笔记应用开发系列！
在日常生活中，我们常常需要记录重要的想法、任务或灵感。随着智能手机的普及，将这些笔记存储在便捷的应用程序中已经成为了一种习惯。
但是，你是否曾经想过如何创建自己的笔记应用，以更好地满足个人需求，或者简单地出于好奇？
在这个教程中，我们将在上一篇文章的基础上，继续带着你一步步创建一个功能强大的 Android 笔记应用。
无需担心，即使你是一个初学者，我们将以易懂的方式解释每个步骤，让你能够轻松掌握 Android 应用开发的精髓。
我们将从数据库的创建、CRUD操作的实现，一直到精心构建用户界面，最终让你轻松掌握如何添加新笔记的功能
无论你是初学者还是有经验的开发者，都将在这里找到有趣的灵感和宝贵的知识。
现在，让我们继续踏上这个令人兴奋的 Android 开发之旅吧！
二、第一步 - 数据库创建与管理 首先，让我们创建NoteDatabase类，这将帮助我们管理笔记数据。数据库操作中的核心就是这个类。它继承自SQLiteOpenHelper，用于创建和维护数据库。
在创建NoteDatabase类时，
1. 定义4个属性：表名、内容字段、主键字段、时间字段。 代码如下：
// 定义数据库表和字段的常量 public static final String TABLE_NAME = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/44dee8ecbff432e886717c0370229284/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-22T11:39:04+08:00" />
<meta property="article:modified_time" content="2023-10-22T11:39:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">轻松上手：＜Android Studio笔记应用开发＞（二）大功告成！添加新笔记！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_2" rel="nofollow">一、引言</a></li><li><a href="#___20" rel="nofollow">二、第一步 - 数据库创建与管理</a></li><li><ul><li><a href="#1_4_25" rel="nofollow">1. 定义**4个**属性：表名、内容字段、主键字段、时间字段。</a></li><li><a href="#2__43" rel="nofollow">2. 实现构造方法</a></li><li><a href="#3__SQL__notes__67" rel="nofollow">3. 执行 SQL 语句创建名为 "notes" 的数据库表格。</a></li><li><a href="#4__95" rel="nofollow">4. 数据库升级</a></li><li><a href="#5_NoteDatabase_128" rel="nofollow">5. `NoteDatabase`类的代码(注释详细)如下：</a></li></ul> 
   </li><li><a href="#__CRUD_169" rel="nofollow">三、第二步 - CRUD操作</a></li><li><ul><li><a href="#1__173" rel="nofollow">1. 必要的属性</a></li><li><a href="#2__195" rel="nofollow">2. 构造方法</a></li><li><a href="#3__210" rel="nofollow">3. 数据库连接的打开和关闭</a></li><li><a href="#4__226" rel="nofollow">4. 添加一条笔记记录</a></li><li><a href="#5__254" rel="nofollow">5. 获取所有笔记记录</a></li><li><a href="#6_CRUD_308" rel="nofollow">6. `CRUD`类的代码(注释详细)如下：</a></li></ul> 
   </li><li><a href="#__ListView_388" rel="nofollow">四、第三步 - ListView</a></li><li><a href="#__MainActivity_420" rel="nofollow">五、第四步 - 主页(`MainActivity`)</a></li><li><ul><li><a href="#1__426" rel="nofollow">1. 属性</a></li><li><a href="#2_onCreate_457" rel="nofollow">2. `onCreate`方法</a></li><li><a href="#3__501" rel="nofollow">3. 刷新笔记列表</a></li><li><a href="#4_MainActivity_530" rel="nofollow">4. `MainActivity`的代码(注释详细)如下：</a></li></ul> 
   </li><li><a href="#__EditActivity_634" rel="nofollow">六、第五步 - 笔记列表(`EditActivity`)</a></li><li><ul><li><a href="#1_contenttime_640" rel="nofollow">1. 新添两个属性：`content`和`time`</a></li><li><a href="#2__647" rel="nofollow">2. 为意图添加额外数据</a></li><li><a href="#3__657" rel="nofollow">3. 指定时间显示格式</a></li><li><a href="#4_EditActivity_669" rel="nofollow">4. `EditActivity`的代码(注释详细)如下：</a></li></ul> 
   </li><li><a href="#_721" rel="nofollow">七、结果演示</a></li><li><a href="#_753" rel="nofollow">八、结语</a></li><li><a href="#_761" rel="nofollow">持续爆肝更新中...🫡🫡🫡</a></li><li><a href="#_763" rel="nofollow">求点赞👍求关注🤗求转发😍</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_2"></a>一、引言</h3> 
<p>欢迎回到我们的Android笔记应用开发系列！</p> 
<p>在日常生活中，我们常常需要记录重要的想法、任务或灵感。随着智能手机的普及，将这些笔记存储在便捷的应用程序中已经成为了一种习惯。</p> 
<p>但是，你是否曾经想过如何创建自己的笔记应用，以更好地满足个人需求，或者简单地出于好奇？</p> 
<p>在这个教程中，我们将在上一篇文章的基础上，继续带着你一步步创建一个功能强大的 Android 笔记应用。</p> 
<p>无需担心，即使你是一个初学者，我们将以易懂的方式解释每个步骤，让你能够轻松掌握 Android 应用开发的精髓。</p> 
<p>我们将从数据库的创建、CRUD操作的实现，一直到精心构建用户界面，最终让你轻松掌握如何添加新笔记的功能</p> 
<p>无论你是初学者还是有经验的开发者，都将在这里找到有趣的灵感和宝贵的知识。</p> 
<p>现在，让我们继续踏上这个令人兴奋的 Android 开发之旅吧！</p> 
<h3><a id="___20"></a>二、第一步 - 数据库创建与管理</h3> 
<p>首先，让我们创建<code>NoteDatabase</code>类，这将帮助我们管理笔记数据。数据库操作中的核心就是这个类。它继承自<code>SQLiteOpenHelper</code>，用于创建和维护数据库。</p> 
<p>在创建<code>NoteDatabase</code>类时，</p> 
<h4><a id="1_4_25"></a>1. 定义<strong>4个</strong>属性：表名、内容字段、主键字段、时间字段。</h4> 
<p>代码如下：</p> 
<pre><code class="prism language-java"><span class="token comment">// 定义数据库表和字段的常量</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">TABLE_NAME</span> <span class="token operator">=</span> <span class="token string">"notes"</span><span class="token punctuation">;</span> <span class="token comment">// 表名</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">CONTENT</span> <span class="token operator">=</span> <span class="token string">"content"</span><span class="token punctuation">;</span> <span class="token comment">// 内容字段</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">ID</span> <span class="token operator">=</span> <span class="token string">"_id"</span><span class="token punctuation">;</span> <span class="token comment">// 主键字段</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">TIME</span> <span class="token operator">=</span> <span class="token string">"time"</span><span class="token punctuation">;</span> <span class="token comment">// 时间字段</span>
</code></pre> 
<p>其中，<code>public static final</code> 定义了一个可以在任何地方通过类名直接访问的不可改变的常量，即 <strong>静态常量</strong>。<br> 常用于：配置参数、常用数学常数、数据库表名、错误代码等等。</p> 
<ul><li><code>public</code> 表示公开可访问</li><li><code>static</code> 表示与类相关而非类的实例</li><li><code>final</code> 表示值是不可更改的</li></ul> 
<h4><a id="2__43"></a>2. 实现构造方法</h4> 
<p>代码如下：</p> 
<pre><code class="prism language-java"><span class="token comment">// 构造方法，接受上下文参数</span>
<span class="token keyword">public</span> <span class="token class-name">NoteDatabase</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string">"notes"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建数据库，指定名称和版本</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>其中，</p> 
<ol><li><code>context</code>即上下文对象，理解它的概念干啥？用就完了！</li><li><code>super(context, "notes", null, 1)</code>: 这个部分调用了父类 <code>SQLiteOpenHelper</code> 的构造函数，<code>super</code> 表示调用父类的构造函数。</li></ol> 
<p>它将创建一个名为 “notes” 的数据库，它会在给定的 <code>context</code> 中被使用，版本号为 1。这个数据库将用于存储笔记数据。</p> 
<ul><li> <p><code>context</code>: 这是我们传递给构造函数的 <code>Context</code> 对象，它告诉数据库在哪个上下文中被创建和使用。</p> </li><li> <p><code>"notes"</code>: 这是数据库的名称，通常是一个字符串。在这里，数据库的名称被设置为 “notes”。</p> </li><li> <p><code>null</code>: 这个参数通常用于传递一个自定义的游标工厂，但在这里我们不需要，所以传递 <code>null</code>。</p> </li><li> <p><code>1</code>: 这是数据库的版本号。每当你更改数据库的结构，你需要增加版本号。这有助于数据库升级的管理。在这里，我们将数据库的版本设置为 1。</p> </li></ul> 
<h4><a id="3__SQL__notes__67"></a>3. 执行 SQL 语句创建名为 “notes” 的数据库表格。</h4> 
<p>这个表格将用于存储我们的笔记数据，确保数据的完整性和唯一性。</p> 
<pre><code class="prism language-java"><span class="token comment">// 当数据库首次创建时会调用此方法</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">SQLiteDatabase</span> db<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 执行 SQL 语句创建名为 "notes" 的表</span>
    db<span class="token punctuation">.</span><span class="token function">execSQL</span><span class="token punctuation">(</span><span class="token string">"CREATE TABLE "</span> <span class="token operator">+</span> <span class="token constant">TABLE_NAME</span>
            <span class="token operator">+</span> <span class="token string">"("</span>
            <span class="token operator">+</span> <span class="token constant">ID</span> <span class="token operator">+</span> <span class="token string">" INTEGER PRIMARY KEY AUTOINCREMENT, "</span> <span class="token comment">// 主键字段，自增长</span>
            <span class="token operator">+</span> <span class="token constant">CONTENT</span> <span class="token operator">+</span> <span class="token string">" TEXT NOT NULL, "</span> <span class="token comment">// 内容字段，不能为空</span>
            <span class="token operator">+</span> <span class="token constant">TIME</span> <span class="token operator">+</span> <span class="token string">" TEXT NOT NULL)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 时间字段，不能为空</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>其中，</p> 
<ol><li> <p><code>db.execSQL(...)</code>: 这一行代码用于执行 SQL 语句。<code>db</code> 是一个 <code>SQLiteDatabase</code> 对象，它代表了我们的数据库。<code>execSQL</code> 是执行 SQL 语句的方法。</p> </li><li> <p><code>"CREATE TABLE " + TABLE_NAME ...</code>: 这是 SQL 语句的一部分，用于创建一个名为 “notes” 的表格。<code>TABLE_NAME</code> 是我们之前定义的一个常量，它包含了表格的名称，即 “notes”。</p> </li><li> <p><code>+ ID + " INTEGER PRIMARY KEY AUTOINCREMENT, "</code>: 这一部分定义了表格的主键。<code>ID</code> 是我们之前定义的常量，表示主键字段的名称。<code>INTEGER</code> 表示这是一个整数字段，<code>PRIMARY KEY</code> 表示这是主键，<code>AUTOINCREMENT</code> 表示这个主键字段会自动增长，每次插入一条新记录时，主键值会自动递增。</p> </li><li> <p><code>+ CONTENT + " TEXT NOT NULL, "</code>: 这部分定义了内容字段，<code>CONTENT</code> 是我们之前定义的字段名称，<code>TEXT</code> 表示这是一个文本字段，<code>NOT NULL</code> 表示内容字段不能为空。</p> </li><li> <p><code>+ TIME + " TEXT NOT NULL)"</code>: 同样，这部分定义了时间字段，<code>TIME</code> 是字段名称，<code>TEXT</code> 表示这是一个文本字段，<code>NOT NULL</code> 表示时间字段不能为空。</p> </li></ol> 
<h4><a id="4__95"></a>4. 数据库升级</h4> 
<p>这是一个必须定义的方法，但至少可以预见的时间内将不会用到这个方法，所以不必实现。<br> 注意：<strong>必须定义，不然编译器会报错，</strong></p> 
<pre><code class="prism language-java"><span class="token comment">// 当数据库需要升级时会调用此方法</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onUpgrade</span><span class="token punctuation">(</span><span class="token class-name">SQLiteDatabase</span> db<span class="token punctuation">,</span> <span class="token keyword">int</span> oldVersion<span class="token punctuation">,</span> <span class="token keyword">int</span> newVersion<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 在数据库升级时的操作，此处不需要实现</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>如果你真的好奇，可以参考以下代码：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onUpgrade</span><span class="token punctuation">(</span><span class="token class-name">SQLiteDatabase</span> db<span class="token punctuation">,</span> <span class="token keyword">int</span> oldVersion<span class="token punctuation">,</span> <span class="token keyword">int</span> newVersion<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 在数据库升级时，可以执行一系列操作，如创建新表、迁移数据等</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newVersion <span class="token operator">&gt;</span> oldVersion<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 版本号增加，说明需要执行升级操作</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>oldVersion<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                <span class="token comment">// 假设从版本1升级到版本2</span>
                <span class="token comment">// 创建一个新表或添加新列</span>
                db<span class="token punctuation">.</span><span class="token function">execSQL</span><span class="token punctuation">(</span><span class="token string">"ALTER TABLE "</span> <span class="token operator">+</span> <span class="token constant">TABLE_NAME</span> <span class="token operator">+</span> <span class="token string">" ADD COLUMN "</span> <span class="token operator">+</span> <span class="token constant">MODE</span> <span class="token operator">+</span> <span class="token string">" INTEGER DEFAULT 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 在这里可以继续执行其他升级操作</span>
            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
                <span class="token comment">// 假设从版本2升级到版本3</span>
                <span class="token comment">// 执行其他升级操作</span>
            <span class="token comment">// ...</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="5_NoteDatabase_128"></a>5. <code>NoteDatabase</code>类的代码(注释详细)如下：</h4> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>my_notes_record</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>content<span class="token punctuation">.</span></span><span class="token class-name">Context</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>database<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span></span><span class="token class-name">SQLiteDatabase</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>database<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span></span><span class="token class-name">SQLiteOpenHelper</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NoteDatabase</span> <span class="token keyword">extends</span> <span class="token class-name">SQLiteOpenHelper</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 定义数据库表和字段的常量</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">TABLE_NAME</span> <span class="token operator">=</span> <span class="token string">"notes"</span><span class="token punctuation">;</span> <span class="token comment">// 表名</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">CONTENT</span> <span class="token operator">=</span> <span class="token string">"content"</span><span class="token punctuation">;</span> <span class="token comment">// 内容字段</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">ID</span> <span class="token operator">=</span> <span class="token string">"_id"</span><span class="token punctuation">;</span> <span class="token comment">// 主键字段</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">TIME</span> <span class="token operator">=</span> <span class="token string">"time"</span><span class="token punctuation">;</span> <span class="token comment">// 时间字段</span>

    <span class="token comment">// 构造方法，接受上下文参数</span>
    <span class="token keyword">public</span> <span class="token class-name">NoteDatabase</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string">"notes"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建数据库，指定名称和版本</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 当数据库首次创建时会调用此方法</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">SQLiteDatabase</span> db<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 执行 SQL 语句创建名为 "notes" 的表</span>
        db<span class="token punctuation">.</span><span class="token function">execSQL</span><span class="token punctuation">(</span><span class="token string">"CREATE TABLE "</span> <span class="token operator">+</span> <span class="token constant">TABLE_NAME</span>
                <span class="token operator">+</span> <span class="token string">"("</span>
                <span class="token operator">+</span> <span class="token constant">ID</span> <span class="token operator">+</span> <span class="token string">" INTEGER PRIMARY KEY AUTOINCREMENT, "</span> <span class="token comment">// 主键字段，自增长</span>
                <span class="token operator">+</span> <span class="token constant">CONTENT</span> <span class="token operator">+</span> <span class="token string">" TEXT NOT NULL, "</span> <span class="token comment">// 内容字段，不能为空</span>
                <span class="token operator">+</span> <span class="token constant">TIME</span> <span class="token operator">+</span> <span class="token string">" TEXT NOT NULL)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 时间字段，不能为空</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 当数据库需要升级时会调用此方法</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onUpgrade</span><span class="token punctuation">(</span><span class="token class-name">SQLiteDatabase</span> db<span class="token punctuation">,</span> <span class="token keyword">int</span> oldVersion<span class="token punctuation">,</span> <span class="token keyword">int</span> newVersion<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 在数据库升级时的操作，此处不需要实现</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>NoteDatabase</code>定义了笔记数据库的结构，包括内容、ID和时间字段。我们将使用它来存储和检索笔记数据。</p> 
<h3><a id="__CRUD_169"></a>三、第二步 - CRUD操作</h3> 
<p>接下来，我们需要一些方法来执行常见的数据库操作 - 增加、查询、更新和删除（CRUD）。我们创建了<code>CRUD</code>类，用于实现这些操作。</p> 
<h4><a id="1__173"></a>1. 必要的属性</h4> 
<pre><code class="prism language-java"><span class="token class-name">SQLiteOpenHelper</span> dbHandler<span class="token punctuation">;</span> <span class="token comment">// SQLiteOpenHelper 实例用于处理数据库连接</span>
<span class="token class-name">SQLiteDatabase</span> db<span class="token punctuation">;</span> <span class="token comment">// SQLiteDatabase 实例用于执行数据库操作</span>

<span class="token comment">// 定义数据库表的列名</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> columns <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">ID</span><span class="token punctuation">,</span>
        <span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">CONTENT</span><span class="token punctuation">,</span>
        <span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">TIME</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>其中，</p> 
<ol><li> <p><code>SQLiteOpenHelper</code> 是 Android 中用于管理 SQLite 数据库的类，它提供了一些方法来创建、打开和管理数据库。</p> </li><li> <p><code>SQLiteDatabase</code> 是 Android 中用于执行 SQL 操作的类，包括插入、查询、更新和删除数据等。</p> </li><li> <p><code>private static final String[] columns</code>: 这是一个字符串数组，定义了数据库表的列名。在这个数组中，包含了三个字符串元素，分别是 <code>NoteDatabase.ID</code>、<code>NoteDatabase.CONTENT</code> 和 <code>NoteDatabase.TIME</code>。这些元素表示了数据库表中的列名，可以在后续的操作中用于查询或操作数据库中的数据。</p> </li></ol> 
<h4><a id="2__195"></a>2. 构造方法</h4> 
<pre><code class="prism language-java"><span class="token comment">// 构造方法，接受上下文参数</span>
<span class="token keyword">public</span> <span class="token function">CRUD</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    dbHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NoteDatabase</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始化数据库处理器</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>通过这个构造方法，可以初始化数据库处理器 <code>dbHandler</code>，以便在后续的数据库操作中使用。</p> 
<p>更具体地说，我们首先接受一个 <code>Context</code> 参数，它代表 Android 应用的运行上下文。这个上下文参数是必需的，因为它能够提供应用程序的环境信息，比如访问资源、执行数据库操作等。</p> 
<p>然后，我们初始化了 <code>dbHandler</code>，这是一个 <code>NoteDatabase</code> 类型的实例。<code>NoteDatabase</code> 类继承自 <code>SQLiteOpenHelper</code>，用于创建和维护数据库。所以，<code>dbHandler</code> 就是用来处理数据库连接的“处理器”。</p> 
<h4><a id="3__210"></a>3. 数据库连接的打开和关闭</h4> 
<pre><code class="prism language-java"><span class="token comment">// 打开数据库连接</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    db <span class="token operator">=</span> dbHandler<span class="token punctuation">.</span><span class="token function">getWritableDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取可写的数据库连接</span>
<span class="token punctuation">}</span>

<span class="token comment">// 关闭数据库连接</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    dbHandler<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭数据库处理器</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这里没啥好说的，都是自带的库函数，这里只是包装一下。</p> 
<h4><a id="4__226"></a>4. 添加一条笔记记录</h4> 
<p>当我们想要添加一条笔记记录时。</p> 
<p>首先，我们需要准备一份包含要存储的数据的清单，这个清单中包括了笔记的内容和时间信息。</p> 
<p>随后，我们把这份数据清单交给数据库，要求它把这些数据存储起来。数据库负责将这些数据放到合适的位置，同时还会为每一条记录生成一个独特的标识，通常是一个数字。这个数字标识着这条笔记在数据库中的位置，就好像每本书都有一个独一无二的编号一样。</p> 
<p>最后，数据库把生成的编号交还给我们，这样我们就知道了这条笔记的独特身份。</p> 
<p>这个过程很类似于在书籍中生成一本新书的编号，以便之后可以找到它。</p> 
<p>于是，不难写出代码如下：</p> 
<pre><code class="prism language-java"><span class="token comment">// 添加一条笔记记录</span>
<span class="token keyword">public</span> <span class="token class-name">Note</span> <span class="token function">addNote</span><span class="token punctuation">(</span><span class="token class-name">Note</span> note<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">ContentValues</span> contentValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ContentValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个用于存储数据的 ContentValues 对象</span>
    contentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">CONTENT</span><span class="token punctuation">,</span> note<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 添加内容</span>
    contentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">TIME</span><span class="token punctuation">,</span> note<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 添加时间</span>
    <span class="token keyword">long</span> insertId <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> contentValues<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将数据插入数据库</span>
    note<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>insertId<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将插入后的 ID 设置到笔记对象中</span>
    <span class="token keyword">return</span> note<span class="token punctuation">;</span> <span class="token comment">// 返回包含新数据的笔记对象</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>其中，<code>contentValues</code>对象是Android提供的用于存储数据的容器。<br> 这个对象就像一张清单，我们可以把需要存储的数据逐一添加进去。</p> 
<h4><a id="5__254"></a>5. 获取所有笔记记录</h4> 
<p>要获取所有笔记记录，我们首先需要向数据库查询请求。</p> 
<p>我们需要告诉数据库我们希望从哪个表中获取数据（本文中是"notes"表），以及我们希望获取哪些列的数据（ID、内容、时间等）。</p> 
<p>然后，数据库会返回一个包含这些数据的游标（<code>Cursor</code>）。</p> 
<p>接着，我们检查游标中是否有数据。</p> 
<p>如果有，就逐一提取每一行的数据，创建笔记对象，将数据填充到笔记对象中。</p> 
<p>接下来再将笔记对象添加到一个列表中。</p> 
<p>这个列表会包含所有的笔记记录。</p> 
<p>最后，关闭游标，释放资源，返回笔记列表即可。</p> 
<p>于是，不难写出代码如下：</p> 
<pre><code class="prism language-java"><span class="token comment">// 获取所有笔记记录</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAllNotes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    <span class="token class-name">Cursor</span> cursor <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>
            <span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span>  <span class="token comment">// 表名</span>
            columns<span class="token punctuation">,</span>                <span class="token comment">// 要查询的列（在这里是ID、内容、时间）</span>
            <span class="token keyword">null</span><span class="token punctuation">,</span>                   <span class="token comment">// 查询条件（null表示无特殊条件）</span>
            <span class="token keyword">null</span><span class="token punctuation">,</span>                   <span class="token comment">// 查询条件参数（null表示无特殊条件）</span>
            <span class="token keyword">null</span><span class="token punctuation">,</span>                   <span class="token comment">// 分组方式（null表示不分组）</span>
            <span class="token keyword">null</span><span class="token punctuation">,</span>                   <span class="token comment">// 过滤方式（null表示不过滤）</span>
            <span class="token keyword">null</span>                    <span class="token comment">// 排序方式（null表示不排序）</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span><span class="token punctuation">&gt;</span></span> notes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个笔记列表用于存储查询结果</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">moveToNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Note</span> note <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建笔记对象</span>
            note<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">ID</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置 ID</span>
            note<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">CONTENT</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置内容</span>
            note<span class="token punctuation">.</span><span class="token function">setTime</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">TIME</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置时间</span>
            notes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>note<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将笔记对象添加到列表中</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    cursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭游标</span>
    <span class="token keyword">return</span> notes<span class="token punctuation">;</span> <span class="token comment">// 返回包含所有笔记记录的列表</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>List&lt;Note&gt; notes = new ArrayList&lt;&gt;();</code> 这行代码创建了一个名为 <code>notes</code> 的列表，用于存储 <code>Note</code> 对象，初始化为空的 <code>ArrayList</code>。</p> 
<ul><li> <p><code>List&lt;Note&gt;</code>：定义了列表类型，其中 <code>List</code> 是一个表示集合数据结构的接口，<code>&lt;Note&gt;</code> 指明了该列表将存储 <code>Note</code> 对象。</p> </li><li> <p><code>new ArrayList&lt;&gt;()</code>：创建了一个新的 <code>ArrayList</code> 实例，用于存储多个元素。 <code>&lt;Note&gt;</code> 表示创建一个存储 <code>Note</code> 对象的 <code>ArrayList</code>。<code>new</code> 关键字用于实例化新对象，<code>()</code> 表示创建一个空的 <code>ArrayList</code>，没有初始化元素。</p> </li></ul> 
<p>此外，<code>Cursor</code> 是一个数据库查询结果的引用，它指向查询结果的第一行数据之前，可用于访问数据库查询的结果集，如检索记录的各个字段的值。这是在 Android 中处理数据库查询结果的常见方式。</p> 
<h4><a id="6_CRUD_308"></a>6. <code>CRUD</code>类的代码(注释详细)如下：</h4> 
<pre><code class="prism language-java">
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>my_notes_record</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>content<span class="token punctuation">.</span></span><span class="token class-name">ContentValues</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>content<span class="token punctuation">.</span></span><span class="token class-name">Context</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>database<span class="token punctuation">.</span></span><span class="token class-name">Cursor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>database<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span></span><span class="token class-name">SQLiteDatabase</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>database<span class="token punctuation">.</span>sqlite<span class="token punctuation">.</span></span><span class="token class-name">SQLiteOpenHelper</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CRUD</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">SQLiteOpenHelper</span> dbHandler<span class="token punctuation">;</span> <span class="token comment">// SQLiteOpenHelper 实例用于处理数据库连接</span>
    <span class="token class-name">SQLiteDatabase</span> db<span class="token punctuation">;</span> <span class="token comment">// SQLiteDatabase 实例用于执行数据库操作</span>
    
    <span class="token comment">// 定义数据库表的列名</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> columns <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">ID</span><span class="token punctuation">,</span>
            <span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">CONTENT</span><span class="token punctuation">,</span>
            <span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">TIME</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 构造方法，接受上下文参数</span>
    <span class="token keyword">public</span> <span class="token function">CRUD</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        dbHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NoteDatabase</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始化数据库处理器</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 打开数据库连接</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        db <span class="token operator">=</span> dbHandler<span class="token punctuation">.</span><span class="token function">getWritableDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取可写的数据库连接</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 关闭数据库连接</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        dbHandler<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭数据库处理器</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 添加一条笔记记录</span>
    <span class="token keyword">public</span> <span class="token class-name">Note</span> <span class="token function">addNote</span><span class="token punctuation">(</span><span class="token class-name">Note</span> note<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ContentValues</span> contentValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ContentValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个用于存储数据的 ContentValues 对象</span>
        contentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">CONTENT</span><span class="token punctuation">,</span> note<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 添加内容</span>
        contentValues<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">TIME</span><span class="token punctuation">,</span> note<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 添加时间</span>
        <span class="token keyword">long</span> insertId <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> contentValues<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将数据插入数据库</span>
        note<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>insertId<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将插入后的 ID 设置到笔记对象中</span>
        <span class="token keyword">return</span> note<span class="token punctuation">;</span> <span class="token comment">// 返回包含新数据的笔记对象</span>
    <span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAllNotes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    
    <span class="token class-name">Cursor</span> cursor <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>
            <span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span>  <span class="token comment">// 表名</span>
            columns<span class="token punctuation">,</span>                <span class="token comment">// 要查询的列（在这里是ID、内容、时间）</span>
            <span class="token keyword">null</span><span class="token punctuation">,</span>                   <span class="token comment">// 查询条件（null表示无特殊条件）</span>
            <span class="token keyword">null</span><span class="token punctuation">,</span>                   <span class="token comment">// 查询条件参数（null表示无特殊条件）</span>
            <span class="token keyword">null</span><span class="token punctuation">,</span>                   <span class="token comment">// 分组方式（null表示不分组）</span>
            <span class="token keyword">null</span><span class="token punctuation">,</span>                   <span class="token comment">// 过滤方式（null表示不过滤）</span>
            <span class="token keyword">null</span>                    <span class="token comment">// 排序方式（null表示不排序）</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span><span class="token punctuation">&gt;</span></span> notes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个笔记列表用于存储查询结果</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">moveToNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Note</span> note <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Note</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建笔记对象</span>
            note<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">ID</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置 ID</span>
            note<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">CONTENT</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置内容</span>
            note<span class="token punctuation">.</span><span class="token function">setTime</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">NoteDatabase</span><span class="token punctuation">.</span><span class="token constant">TIME</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置时间</span>
            notes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>note<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将笔记对象添加到列表中</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    cursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭游标</span>
    <span class="token keyword">return</span> notes<span class="token punctuation">;</span> <span class="token comment">// 返回包含所有笔记记录的列表</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> 
<p><code>CRUD</code>类包含了一系列方法，用于执行数据库操作。我们可以添加笔记、获取所有笔记等。</p> 
<h3><a id="__ListView_388"></a>四、第三步 - ListView</h3> 
<p>我们需要将<code>activity_main.xml</code>中的<code>TextView</code>组件替换为<code>ListView</code>组件，具体如下：</p> 
<pre><code class="prism language-XML">    &lt;ListView
        android:id="@+id/lv"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_marginLeft="10dp"
        android:layout_marginRight="10dp"
        android:layout_marginTop="8dp"
        android:dividerHeight="8dp"&gt;

    &lt;/ListView&gt;
</code></pre> 
<p><code>ListView</code> 在 Android 中用于显示垂直滚动的可滚动列表，通常用于展示大量数据，以确保用户可以滚动查看所有数据，而不必在屏幕上放置所有内容。</p> 
<p>选择使用<code>ListView</code>组件关键在于其四大优势：</p> 
<ol><li> <p><strong>滚动能力</strong>：<code>ListView</code> 允许用户在有限的屏幕空间内滚动查看大量项目，以便浏览长列表或数据集。</p> </li><li> <p><strong>节省空间</strong>：相对于将所有项目一次性放在屏幕上，<code>ListView</code> 只会渲染并占用屏幕空间的一部分，这有助于节省屏幕空间，同时使应用更具交互性。</p> </li><li> <p><strong>性能优化</strong>：<code>ListView</code> 采用适用于大型数据集的数据适配器模式，只加载当前可见区域的数据，从而提高性能。</p> </li><li> <p><strong>动态数据</strong>：<code>ListView</code> 可以轻松地与动态数据集结合使用，以实时更新列表内容。</p> </li></ol> 
<p>如欲了解更多信息，这篇名叫<a href="https://www.tutorialspoint.com/android/android_list_view.htm" rel="nofollow">Android List View</a>的文档也许能满足你。</p> 
<h3><a id="__MainActivity_420"></a>五、第四步 - 主页(<code>MainActivity</code>)</h3> 
<p>现在，让我们来看看应用的主要界面 - <code>MainActivity</code>。这是我们的笔记应用的入口，也是笔记列表的显示和添加点。在这里，我们将与数据库交互，加载和显示笔记。</p> 
<p>前面的文章中已经写出了部分代码，下面将主要针对修改或添加的地方加以解释。</p> 
<h4><a id="1__426"></a>1. 属性</h4> 
<p>比起原先的属性，在保留<code>FloatingActionButton</code>类的同时增添了多个属性。</p> 
<pre><code class="prism language-java"><span class="token comment">// 声明类的成员变量</span>
    <span class="token keyword">private</span> <span class="token class-name">Context</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// 上下文对象，用于数据库操作</span>
    <span class="token keyword">private</span> <span class="token class-name">NoteDatabase</span> dbHelper<span class="token punctuation">;</span> <span class="token comment">// 数据库帮助类</span>
    <span class="token keyword">private</span> <span class="token class-name">NoteAdapter</span> adapter<span class="token punctuation">;</span> <span class="token comment">// 笔记适配器</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span><span class="token punctuation">&gt;</span></span> noteList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 笔记列表</span>
    <span class="token keyword">private</span> <span class="token class-name">FloatingActionButton</span> btn<span class="token punctuation">;</span> <span class="token comment">// 悬浮按钮</span>
    <span class="token keyword">private</span> <span class="token class-name">ListView</span> lv<span class="token punctuation">;</span> <span class="token comment">// 列表视图</span>

    <span class="token comment">// 定义一个 ActivityResultLauncher，用于处理其他活动的结果</span>
    <span class="token keyword">private</span> <span class="token class-name">ActivityResultLauncher</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Intent</span><span class="token punctuation">&gt;</span></span> someActivityResultLauncher<span class="token punctuation">;</span>
</code></pre> 
<ol><li> <p><code>context</code> 是一个上下文对象，用于进行数据库操作。在这里，它引用了当前 Activity 的上下文。</p> </li><li> <p><code>dbHelper</code> 是一个数据库帮助类，用于管理数据库的创建和升级。</p> </li><li> <p><code>adapter</code> 是一个笔记适配器，用于在用户界面中显示笔记数据。</p> </li><li> <p><code>noteList</code> 是一个笔记列表，初始化为空，用于存储笔记对象。</p> </li><li> <p><code>btn</code> 是一个悬浮按钮，通常用于触发用户界面上的某些操作。</p> </li><li> <p><code>lv</code> 是一个列表视图，用于显示数据列表，例如显示笔记的列表。</p> </li><li> <p><code>someActivityResultLauncher</code> 是用于处理其他活动返回的数据或结果的工具。</p> </li></ol> 
<h4><a id="2_onCreate_457"></a>2. <code>onCreate</code>方法</h4> 
<p>在<code>protected void onCreate(Bundle savedInstanceState) </code><br> 和<code>someActivityResultLauncher = registerForActivityResult</code><br> 之间添加了大量代码，具体如下：</p> 
<pre><code class="prism language-java">    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//调用父类的 onCreate 方法，用于执行一些初始化操作</span>
    <span class="token comment">//savedInstanceState 参数用于恢复之前的状态</span>

    <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置当前 Activity 的布局</span>
    
    btn <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>fab<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 悬浮按钮</span>


    <span class="token comment">//以下是新添的代码</span>

    lv <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>lv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 列表视图，用于显示数据列表</span>

    adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NoteAdapter</span><span class="token punctuation">(</span><span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> noteList<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//初始化一个笔记适配器，并将应用的上下文对象和笔记列表传递给适配器</span>

    <span class="token function">refreshListView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 刷新笔记列表</span>
    
    lv<span class="token punctuation">.</span><span class="token function">setAdapter</span><span class="token punctuation">(</span>adapter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将适配器与列表视图关联，从而显示笔记列表中的数据在界面上</span>
</code></pre> 
<p>在<code>if (data != null){...}</code>中（…部分）替换为下面这段代码：</p> 
<pre><code class="prism language-java">    <span class="token comment">// 从 EditActivity 返回的内容和时间</span>
    <span class="token class-name">String</span> content <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> time <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">"time"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Note</span> note <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Note</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建笔记对象</span>

    <span class="token comment">// 打开数据库连接，将笔记添加到数据库</span>
    <span class="token class-name">CRUD</span> op <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CRUD</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    op<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    op<span class="token punctuation">.</span><span class="token function">addNote</span><span class="token punctuation">(</span>note<span class="token punctuation">)</span><span class="token punctuation">;</span>
    op<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭数据库连接</span>

    <span class="token function">refreshListView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 刷新笔记列表</span>
</code></pre> 
<h4><a id="3__501"></a>3. 刷新笔记列表</h4> 
<p>要想刷新笔记列表。</p> 
<p>首先我们需要确保数据库连接已经打开。</p> 
<p>接下来，我们需要清空当前的笔记列表，因为我们要用最新的数据替代它。</p> 
<p>然后，我们从数据库中获取所有的笔记数据，并将它们添加到列表中。</p> 
<p>最后，我们关闭数据库连接，以释放资源。</p> 
<p>刷新列表时，我们通知适配器，数据已经更改，需要刷新列表视图，以确保用户界面上显示的笔记列表是最新的。</p> 
<p>于是不难写出代码如下：</p> 
<pre><code class="prism language-java">    <span class="token comment">// 刷新笔记列表</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">refreshListView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建数据库操作对象，打开数据库连接</span>
        <span class="token class-name">CRUD</span> op <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CRUD</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        op<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>noteList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> noteList<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 清空笔记列表</span>
        noteList<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>op<span class="token punctuation">.</span><span class="token function">getAllNotes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取数据库中所有笔记</span>
        op<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭数据库连接</span>

        adapter<span class="token punctuation">.</span><span class="token function">notifyDataSetChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 通知适配器数据已更改，刷新列表视图</span>
    <span class="token punctuation">}</span>
</code></pre> 
<h4><a id="4_MainActivity_530"></a>4. <code>MainActivity</code>的代码(注释详细)如下：</h4> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>my_notes_record</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>content<span class="token punctuation">.</span></span><span class="token class-name">Context</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>content<span class="token punctuation">.</span></span><span class="token class-name">Intent</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span><span class="token class-name">Bundle</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>view<span class="token punctuation">.</span></span><span class="token class-name">View</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span></span><span class="token class-name">ListView</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">androidx<span class="token punctuation">.</span>activity<span class="token punctuation">.</span>result<span class="token punctuation">.</span></span><span class="token class-name">ActivityResultLauncher</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">androidx<span class="token punctuation">.</span>activity<span class="token punctuation">.</span>result<span class="token punctuation">.</span>contract<span class="token punctuation">.</span></span><span class="token class-name">ActivityResultContracts</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">androidx<span class="token punctuation">.</span>appcompat<span class="token punctuation">.</span>app<span class="token punctuation">.</span></span><span class="token class-name">AppCompatActivity</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>android<span class="token punctuation">.</span>material<span class="token punctuation">.</span>floatingactionbutton<span class="token punctuation">.</span></span><span class="token class-name">FloatingActionButton</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>


<span class="token comment">// 创建名为 "MainActivity" 的主活动类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">Context</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// 上下文对象，用于数据库操作</span>
    <span class="token keyword">private</span> <span class="token class-name">NoteDatabase</span> dbHelper<span class="token punctuation">;</span> <span class="token comment">// 数据库帮助类</span>
    <span class="token keyword">private</span> <span class="token class-name">NoteAdapter</span> adapter<span class="token punctuation">;</span> <span class="token comment">// 笔记适配器</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span><span class="token punctuation">&gt;</span></span> noteList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 笔记列表</span>
    <span class="token keyword">private</span> <span class="token class-name">FloatingActionButton</span> btn<span class="token punctuation">;</span> <span class="token comment">// 悬浮按钮</span>
    <span class="token keyword">private</span> <span class="token class-name">ListView</span> lv<span class="token punctuation">;</span> <span class="token comment">// 列表视图</span>

    <span class="token comment">// 定义一个 ActivityResultLauncher，用于处理其他活动的结果</span>
    <span class="token keyword">private</span> <span class="token class-name">ActivityResultLauncher</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Intent</span><span class="token punctuation">&gt;</span></span> someActivityResultLauncher<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//调用父类的 onCreate 方法，用于执行一些初始化操作</span>
        <span class="token comment">//savedInstanceState 参数用于恢复之前的状态</span>

        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设置当前 Activity 的布局</span>
        
        btn <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>fab<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 悬浮按钮</span>

        lv <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>lv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 列表视图，用于显示数据列表</span>

        adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NoteAdapter</span><span class="token punctuation">(</span><span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> noteList<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//初始化一个笔记适配器，并将应用的上下文对象和笔记列表传递给适配器</span>

        <span class="token function">refreshListView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 刷新笔记列表</span>

        lv<span class="token punctuation">.</span><span class="token function">setAdapter</span><span class="token punctuation">(</span>adapter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将适配器与列表视图关联，从而显示笔记列表中的数据在界面上</span>

        <span class="token comment">// 初始化 ActivityResultLauncher，用于处理启动其他活动的结果</span>
        someActivityResultLauncher <span class="token operator">=</span> <span class="token function">registerForActivityResult</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">ActivityResultContracts<span class="token punctuation">.</span>StartActivityForResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                result <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getResultCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">RESULT_OK</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token class-name">Intent</span> data <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token comment">// 从 EditActivity 返回的内容和时间</span>
                            <span class="token class-name">String</span> content <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token class-name">String</span> time <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">getStringExtra</span><span class="token punctuation">(</span><span class="token string">"time"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token class-name">Note</span> note <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Note</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建笔记对象</span>

                            <span class="token comment">// 打开数据库连接，将笔记添加到数据库</span>
                            <span class="token class-name">CRUD</span> op <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CRUD</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            op<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            op<span class="token punctuation">.</span><span class="token function">addNote</span><span class="token punctuation">(</span>note<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            op<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭数据库连接</span>

                            <span class="token function">refreshListView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 刷新笔记列表</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 设置悬浮按钮的点击事件监听器</span>
        btn<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> view<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 启动 EditActivity 并等待结果</span>
                <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">EditActivity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                someActivityResultLauncher<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 刷新笔记列表</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">refreshListView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建数据库操作对象，打开数据库连接</span>
        <span class="token class-name">CRUD</span> op <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CRUD</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        op<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>noteList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> noteList<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 清空笔记列表</span>
        noteList<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>op<span class="token punctuation">.</span><span class="token function">getAllNotes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取数据库中所有笔记</span>
        op<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭数据库连接</span>

        adapter<span class="token punctuation">.</span><span class="token function">notifyDataSetChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 通知适配器数据已更改，刷新列表视图</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="__EditActivity_634"></a>六、第五步 - 笔记列表(<code>EditActivity</code>)</h3> 
<p>最后，让我们看一下编辑笔记的界面 - <code>EditActivity</code>。这是用户输入笔记内容的地方，我们还会将时间自动添加到笔记中。</p> 
<p>前面的文章中已经写出了部分代码，下面将主要针对修改或添加的地方加以解释。</p> 
<h4><a id="1_contenttime_640"></a>1. 新添两个属性：<code>content</code>和<code>time</code></h4> 
<pre><code class="prism language-java"><span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span> <span class="token comment">// 声明用于存储笔记内容的变量</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> time<span class="token punctuation">;</span> <span class="token comment">// 声明用于存储笔记时间的变量</span>
</code></pre> 
<h4><a id="2__647"></a>2. 为意图添加额外数据</h4> 
<p><code>else if (keyCode == KeyEvent.KEYCODE_BACK) {...}</code>中<br> 将<code>intent.putExtra("input", et.getText().toString());</code><br> 替换为</p> 
<pre><code class="prism language-java">intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">,</span> et<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将编辑框中的文本内容放入意图中</span>
intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"time"</span><span class="token punctuation">,</span> <span class="token function">dateToStringing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将当前时间放入意图中</span>
</code></pre> 
<h4><a id="3__657"></a>3. 指定时间显示格式</h4> 
<pre><code class="prism language-java"><span class="token comment">// 将当前时间格式化为字符串</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">dateToStringing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Date</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取当前日期和时间</span>
    <span class="token class-name">SimpleDateFormat</span> simpleDateFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建日期格式化器</span>
    <span class="token keyword">return</span> simpleDateFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 格式化日期并返回字符串</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="4_EditActivity_669"></a>4. <code>EditActivity</code>的代码(注释详细)如下：</h4> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>my_notes_record</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>content<span class="token punctuation">.</span></span><span class="token class-name">Intent</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span><span class="token class-name">Bundle</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>view<span class="token punctuation">.</span></span><span class="token class-name">KeyEvent</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span></span><span class="token class-name">EditText</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">androidx<span class="token punctuation">.</span>appcompat<span class="token punctuation">.</span>app<span class="token punctuation">.</span></span><span class="token class-name">AppCompatActivity</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">SimpleDateFormat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EditActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span><span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span> <span class="token comment">// 声明用于存储笔记内容的变量</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> time<span class="token punctuation">;</span> <span class="token comment">// 声明用于存储笔记时间的变量</span>

    <span class="token class-name">EditText</span> et<span class="token punctuation">;</span> <span class="token comment">// 声明文本编辑框</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>edit_layout<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置视图为 "edit_layout"</span>
        et <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>et<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从布局文件中获取文本编辑框</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 处理按键事件</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onKeyDown</span><span class="token punctuation">(</span><span class="token keyword">int</span> keyCode<span class="token punctuation">,</span> <span class="token class-name">KeyEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>keyCode <span class="token operator">==</span> <span class="token class-name">KeyEvent</span><span class="token punctuation">.</span><span class="token constant">KEYCODE_HOME</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 如果按下 HOME 键，返回 true，表示事件已处理</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>keyCode <span class="token operator">==</span> <span class="token class-name">KeyEvent</span><span class="token punctuation">.</span><span class="token constant">KEYCODE_BACK</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个新意图</span>
            intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">,</span> et<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将编辑框中的文本内容放入意图中</span>
            intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">"time"</span><span class="token punctuation">,</span> <span class="token function">dateToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将当前时间放入意图中</span>
            <span class="token function">setResult</span><span class="token punctuation">(</span><span class="token constant">RESULT_OK</span><span class="token punctuation">,</span> intent<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置结果为 OK，并附带意图</span>
            <span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 结束当前活动</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 返回 true，表示事件已处理</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onKeyDown</span><span class="token punctuation">(</span>keyCode<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 如果按键不是 HOME 或 BACK，使用默认处理</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 将当前时间格式化为字符串</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">dateToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Date</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取当前日期和时间</span>
        <span class="token class-name">SimpleDateFormat</span> simpleDateFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建日期格式化器</span>
        <span class="token keyword">return</span> simpleDateFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 格式化日期并返回字符串</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_721"></a>七、结果演示</h3> 
<p><img src="https://images2.imgbox.com/13/c4/kqtclZT7_o.png" alt="1.png"></p> 
<p><img src="https://images2.imgbox.com/83/3a/cN3mWNqi_o.png" alt="2.png"></p> 
<p><img src="https://images2.imgbox.com/cd/74/NNhBRgmi_o.png" alt="3.png"></p> 
<p><img src="https://images2.imgbox.com/af/53/kYWsudUz_o.png" alt="4.png"></p> 
<p><img src="https://images2.imgbox.com/a7/76/N1dsTirf_o.png" alt="5.png"></p> 
<p><img src="https://images2.imgbox.com/26/ca/YAu9EU6v_o.png" alt="6.png"></p> 
<p><img src="https://images2.imgbox.com/54/d4/9HFemNcQ_o.png" alt="7.png"></p> 
<p><img src="https://images2.imgbox.com/25/d5/NTMNopNK_o.png" alt="8.png"></p> 
<p><img src="https://images2.imgbox.com/84/b5/Amiie1o6_o.png" alt="9.png"></p> 
<p><img src="https://images2.imgbox.com/84/cf/3JwIPbbd_o.png" alt="10.png"></p> 
<p><img src="https://images2.imgbox.com/32/17/msxTBJJT_o.png" alt="11.png"></p> 
<p><img src="https://images2.imgbox.com/f4/df/94jyKWki_o.png" alt="12.png"></p> 
<p><img src="https://images2.imgbox.com/da/68/wQNTFFRk_o.png" alt="13.png"></p> 
<p><img src="https://images2.imgbox.com/56/cd/vYPrmRUf_o.png" alt="14.png"></p> 
<h3><a id="_753"></a>八、结语</h3> 
<p>太棒了，现在我们可以轻松地添加和展示笔记了。</p> 
<p>在下一篇文章中，我们将实现笔记的可查看、可编辑等功能。</p> 
<p>敬请关注！</p> 
<h3><a id="_761"></a>持续爆肝更新中…🫡🫡🫡</h3> 
<h3><a id="_763"></a>求点赞👍求关注🤗求转发😍</h3>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c9d211e6d85a9c2e42e7534a565795ab/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue3 使用 elementUi： ./lib/theme-chalk/index.css is not exported from package</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/124cbd6138094b224ace35f2a7384487/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">element-plus: 二次封装el-form方案？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>