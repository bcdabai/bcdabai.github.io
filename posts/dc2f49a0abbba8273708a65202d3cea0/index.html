<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>小知识点：ARM 架构 Linux 大数据集群基础环境搭建（Hadoop、MySQL、Hive、Spark、Flink、ZK、Kafka、Nginx、Node） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="小知识点：ARM 架构 Linux 大数据集群基础环境搭建（Hadoop、MySQL、Hive、Spark、Flink、ZK、Kafka、Nginx、Node）" />
<meta property="og:description" content="换了 M2 芯片的 Mac，以前 x86 版本的 Linux 大数据集群基础环境搭建在 ARM 架构的虚拟机集群上有些用不了了，现在重新写一份基于 ARM 架构的，少数不兼容之外其他都差不多，相当于更新一版以前的
部分和 x86 的一样
x86 版：Linux 虚拟机：大数据集群基础环境搭建（Hadoop、Spark、Flink、Hive、Zookeeper、Kafka、Nginx）
目录 一、相关文件下载地址二、基础环境配置三、语言环境配置3.1 Java 环境安装3.2 Python 环境安装3.3 Scala 环境安装 四、大数据组件安装4.1 Hadoop 集群安装4.2 Docker 安装4.3 MySQL 安装4.4 Hive 安装4.5 Spark 安装4.6 Flink 安装4.7 Zookeeper 安装4.8 Kafka 安装4.9 Nginx 安装4.10 Node 安装4.11 Doris 安装 五、问题解决5.1 环境配置错误，丢失命令5.2 start-yarn.sh 无法启动 resourcemanager5.3 mysql 远程连接报错 Public Key Retrieval is not allowed5.4 Flink 提交任务报错 classloader.check-leaked-classloader5.5 Kafka 启动报错 UseG1GC5.6 Nginx 启动报错 Permission denied5." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/dc2f49a0abbba8273708a65202d3cea0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-21T08:50:14+08:00" />
<meta property="article:modified_time" content="2023-02-21T08:50:14+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">小知识点：ARM 架构 Linux 大数据集群基础环境搭建（Hadoop、MySQL、Hive、Spark、Flink、ZK、Kafka、Nginx、Node）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>  换了 M2 芯片的 Mac，以前 x86 版本的 Linux 大数据集群基础环境搭建在 ARM 架构的虚拟机集群上有些用不了了，现在重新写一份基于 ARM 架构的，少数不兼容之外其他都差不多，相当于更新一版以前的</p> 
</blockquote> 
<p>部分和 x86 的一样<br> x86 版：<a href="https://blog.csdn.net/baidu_40468340/article/details/128892621">Linux 虚拟机：大数据集群基础环境搭建（Hadoop、Spark、Flink、Hive、Zookeeper、Kafka、Nginx）</a></p> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><a href="#_7" rel="nofollow">一、相关文件下载地址</a></li><li><a href="#_40" rel="nofollow">二、基础环境配置</a></li><li><a href="#_123" rel="nofollow">三、语言环境配置</a></li><li><ul><li><a href="#31_Java__124" rel="nofollow">3.1 Java 环境安装</a></li><li><a href="#32_Python__146" rel="nofollow">3.2 Python 环境安装</a></li><li><a href="#33_Scala__166" rel="nofollow">3.3 Scala 环境安装</a></li></ul> 
   </li><li><a href="#_185" rel="nofollow">四、大数据组件安装</a></li><li><ul><li><a href="#41_Hadoop__186" rel="nofollow">4.1 Hadoop 集群安装</a></li><li><a href="#42_Docker__298" rel="nofollow">4.2 Docker 安装</a></li><li><a href="#43_MySQL__313" rel="nofollow">4.3 MySQL 安装</a></li><li><a href="#44_Hive__329" rel="nofollow">4.4 Hive 安装</a></li><li><a href="#45_Spark__413" rel="nofollow">4.5 Spark 安装</a></li><li><a href="#46_Flink__448" rel="nofollow">4.6 Flink 安装</a></li><li><a href="#47_Zookeeper__475" rel="nofollow">4.7 Zookeeper 安装</a></li><li><a href="#48_Kafka__512" rel="nofollow">4.8 Kafka 安装</a></li><li><a href="#49_Nginx__544" rel="nofollow">4.9 Nginx 安装</a></li><li><a href="#410_Node__571" rel="nofollow">4.10 Node 安装</a></li><li><a href="#411_Doris__599" rel="nofollow">4.11 Doris 安装</a></li></ul> 
   </li><li><a href="#_604" rel="nofollow">五、问题解决</a></li><li><ul><li><a href="#51__605" rel="nofollow">5.1 环境配置错误，丢失命令</a></li><li><a href="#52_startyarnsh__resourcemanager_612" rel="nofollow">5.2 start-yarn.sh 无法启动 resourcemanager</a></li><li><a href="#53_mysql__Public_Key_Retrieval_is_not_allowed_617" rel="nofollow">5.3 mysql 远程连接报错 Public Key Retrieval is not allowed</a></li><li><a href="#54_Flink__classloadercheckleakedclassloader_622" rel="nofollow">5.4 Flink 提交任务报错 classloader.check-leaked-classloader</a></li><li><a href="#55_Kafka__UseG1GC_629" rel="nofollow">5.5 Kafka 启动报错 UseG1GC</a></li><li><a href="#56_Nginx__Permission_denied_636" rel="nofollow">5.6 Nginx 启动报错 Permission denied</a></li><li><a href="#57_Nginx_403_Forbidden_644" rel="nofollow">5.7 Nginx 403 Forbidden</a></li><li><a href="#58_Node__GLIBC_227_not_found_650" rel="nofollow">5.8 Node 报错 GLIBC_2.27 not found</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_7"></a>一、相关文件下载地址</h3> 
<ul><li>ARM 架构的 Centos 7 
  <ul><li>参考：<a href="https://blog.csdn.net/baidu_40468340/article/details/129066070">小知识点：Mac M1/M2 VMware Fusion 安装 Centos 7.9（ARM 64 版本）</a></li></ul> </li><li>Java-1.8 
  <ul><li>https://www.oracle.com/java/technologies/downloads/#java8 
    <ul><li>选择 ARM 64 版本的，网上搜一个 Oracle 账号就能下载</li></ul> </li></ul> </li><li>Python-3.9 
  <ul><li>https://www.python.org/ftp/python/3.9.6/Python-3.9.6.tgz</li></ul> </li><li>Scala-2.12 
  <ul><li>https://www.scala-lang.org/download/2.12.12.html</li></ul> </li><li>Hadoop-3.2.1 
  <ul><li>http://archive.apache.org/dist/hadoop/common/hadoop-3.2.1/hadoop-3.2.1.tar.gz</li></ul> </li><li>Spark-3.1.2 
  <ul><li>http://archive.apache.org/dist/spark/spark-3.1.2/spark-3.1.2-bin-hadoop3.2.tgz</li></ul> </li><li>Flink-1.13.1 
  <ul><li>http://archive.apache.org/dist/flink/flink-1.13.1/flink-1.13.1-bin-scala_2.12.tgz</li></ul> </li><li>Hive-3.1.3 
  <ul><li>http://archive.apache.org/dist/hive/hive-3.1.3/apache-hive-3.1.3-bin.tar.gz</li></ul> </li><li>Zookeeper-3.8.0 
  <ul><li>http://archive.apache.org/dist/zookeeper/zookeeper-3.8.0/apache-zookeeper-3.8.0-bin.tar.gz</li></ul> </li><li>Kafka-3.2.0 
  <ul><li>http://archive.apache.org/dist/kafka/3.2.0/kafka_2.12-3.2.0.tgz</li></ul> </li><li>Nginx-1.23.1 
  <ul><li>https://nginx.org/download/nginx-1.23.1.tar.gz</li></ul> </li><li>Node-18.14.1 
  <ul><li>https://nodejs.org/dist/v17.9.1/node-v17.9.1-linux-arm64.tar.gz</li></ul> </li><li>Doris-1.2.2 
  <ul><li>https://mirrors.tuna.tsinghua.edu.cn/apache/doris/1.2/1.2.2-rc01/apache-doris-fe-1.2.2-bin-arm.tar.xz</li><li>https://mirrors.tuna.tsinghua.edu.cn/apache/doris/1.2/1.2.2-rc01/apache-doris-be-1.2.2-bin-arm.tar.xz</li><li>https://mirrors.tuna.tsinghua.edu.cn/apache/doris/1.2/1.2.2-rc01/apache-doris-dependencies-1.2.2-bin-arm.tar.xz</li></ul> </li></ul> 
<h3><a id="_40"></a>二、基础环境配置</h3> 
<ul><li>创建的用户并添加 sudo 权限并免密</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># root 下</span>
<span class="token function">useradd</span> -m ac_cluster
<span class="token function">passwd</span> ac_cluster
<span class="token comment"># sudo 权限</span>
<span class="token function">sudo</span> <span class="token function">vi</span> /etc/sudoers
<span class="token comment"># 添加下面两条</span>
ac_cluster	ALL<span class="token operator">=</span><span class="token punctuation">(</span>ALL<span class="token punctuation">)</span>	ALL
ac_cluster	ALL<span class="token operator">=</span><span class="token punctuation">(</span>ALL<span class="token punctuation">)</span>	NOPASSWD: ALL
<span class="token comment"># 保存退出</span>
:wq<span class="token operator">!</span>
</code></pre> 
<ul><li>修改静态 IP</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 编辑该文件</span>
<span class="token function">sudo</span> <span class="token function">vi</span> /etc/sysconfig/network-scripts/ifcfg-ens160
<span class="token comment"># 修改参考如下，具体的在安装虚拟机的时候有展示，</span>
BOOTPROTO<span class="token operator">=</span>static
GATEWAY<span class="token operator">=</span><span class="token string">"192.168.104.2"</span>
IPADDR<span class="token operator">=</span><span class="token string">"192.168.104.101"</span>
NETMASK<span class="token operator">=</span><span class="token string">"255.255.255.0"</span>
DNS1<span class="token operator">=</span><span class="token string">"8.8.8.8"</span>
DNS2<span class="token operator">=</span><span class="token string">"114.114.114.114"</span>
<span class="token comment"># 重启网络</span>
<span class="token function">sudo</span> systemctl restart network
</code></pre> 
<ul><li>修改 yum 源 
  <ul><li>这里用的是阿里云的 yum 源</li></ul> </li></ul> 
<pre><code class="prism language-shell"><span class="token comment"># 先下载 wget</span>
<span class="token function">sudo</span> yum -y <span class="token function">install</span> <span class="token function">wget</span>
<span class="token comment"># 修改阿里云的配置</span>
<span class="token function">sudo</span> <span class="token function">wget</span> http://mirrors.aliyun.com/repo/Centos-altarch-7.repo -O /etc/yum.repos.d/CentOS-Base.repo
<span class="token comment"># 清理软件源</span>
yum clean all
<span class="token comment"># 元数据缓存</span>
yum makecache
<span class="token comment"># 测试</span>
<span class="token function">sudo</span> yum -y <span class="token function">install</span> vim
</code></pre> 
<ul><li>修改 hostname</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 根据实际修改</span>
vim /etc/hostname
<span class="token comment"># 重启</span>
<span class="token function">reboot</span>
</code></pre> 
<ul><li>关闭防火墙</li></ul> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl stop firewalld
<span class="token function">sudo</span> systemctl disable firewalld
</code></pre> 
<ul><li>修改域名映射</li></ul> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> vim /etc/hosts
</code></pre> 
<ul><li>配置机器间免密登陆</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 输入后三次回车</span>
ssh-keygen -t rsa
<span class="token comment"># 配置节点</span>
ssh-copy-id hybrid01
</code></pre> 
<p><img src="https://images2.imgbox.com/03/db/wlZuUK6C_o.png" alt="在这里插入图片描述"></p> 
<ul><li>配置时间同步</li></ul> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> yum -y <span class="token function">install</span> ntpdate
<span class="token function">sudo</span> ntpdate ntp1.aliyun.com
<span class="token comment"># 可选，也可以配置自动执行时间同步，根据自己需求来</span>
<span class="token function">crontab</span> -e */1 * * * * <span class="token function">sudo</span> /usr/sbin/ntpdate ntp1.aliyun.com
</code></pre> 
<h3><a id="_123"></a>三、语言环境配置</h3> 
<h4><a id="31_Java__124"></a>3.1 Java 环境安装</h4> 
<ul><li>准备好 ARM 64 的 Java 包</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 使用 rz -be 上传文件，没有的先下载，或者使用其他工具上传</span>
<span class="token function">sudo</span> yum -y <span class="token function">install</span> lrzsz
<span class="token comment"># 上传，选择本地下载好的位置</span>
rz -be
<span class="token comment"># 解压 Java 包</span>
<span class="token function">tar</span> -zxvf jdk-8u361-linux-aarch64.tar.gz -C <span class="token punctuation">..</span>/program/
<span class="token comment"># 配置环境变量</span>
vim ~/.bash_profile
<span class="token comment"># 添加下面两条</span>
<span class="token function">export</span> JAVA_HOME<span class="token operator">=</span>/xx/xx
<span class="token function">export</span> PATH<span class="token operator">=</span><span class="token variable">$JAVA_HOME</span>/bin:<span class="token variable">$PATH</span>
<span class="token comment"># 更新环境</span>
<span class="token function">source</span> ~/.bash_profile
<span class="token comment"># 测试</span>
java -version
<span class="token comment"># 传给其他节点并配置环境变量即可</span>
<span class="token function">scp</span> -r jdk1.8.0_361/ ac_cluster@hybrid02:<span class="token variable">$PWD</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/82/23/CHRI9zdq_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="32_Python__146"></a>3.2 Python 环境安装</h4> 
<ul><li>下载好源码包，可以使用 wget 下载</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 下载 Python 源码包</span>
<span class="token function">wget</span> https://www.python.org/ftp/python/3.9.6/Python-3.9.6.tgz
<span class="token comment"># 解压</span>
<span class="token function">tar</span> -zxvf Python-3.9.6.tgz
<span class="token comment"># 安装依赖环境</span>
<span class="token function">sudo</span> yum -y <span class="token function">install</span> unzip net-tools <span class="token function">bzip2</span> zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel libpcap-devel xz-devel libglvnd-glx gcc gcc-c++ <span class="token function">make</span>
<span class="token comment"># 预配置</span>
./configure --prefix<span class="token operator">=</span>/home/ac_cluster/program/python3.9.6 
<span class="token comment"># 编译安装</span>
<span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span>
<span class="token comment"># 配置环境变量或者软链接到 /usr/bin 中</span>
<span class="token function">sudo</span> <span class="token function">ln</span> -s /home/ac_cluster/program/python3.9.6/bin/python3.9 /usr/bin/python3
<span class="token function">sudo</span> <span class="token function">ln</span> -s /home/ac_cluster/program/python3.9.6/bin/pip3.9 /usr/bin/pip3
<span class="token comment"># 测试</span>
python3 --version
</code></pre> 
<h4><a id="33_Scala__166"></a>3.3 Scala 环境安装</h4> 
<ul><li>下载好相关包</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 上传，也可以使用其他方式上传到虚拟机</span>
rz -be
<span class="token comment"># 解压</span>
<span class="token function">tar</span> -zxvf scala-2.12.10.tgz -C <span class="token punctuation">..</span>/program/
<span class="token comment"># 配置环境</span>
vim ~/.bash_profile
<span class="token comment"># 添加下面两条</span>
<span class="token function">export</span> SCALA_HOME<span class="token operator">=</span>/home/ac_cluster/program/scala-2.12.10
<span class="token function">export</span> PATH<span class="token operator">=</span><span class="token variable">$PATH</span><span class="token keyword">:</span><span class="token variable">$SCALA_HOME</span>/bin
<span class="token comment"># 更新环境</span>
<span class="token function">source</span> ~/.bash_profile
<span class="token comment"># 测试</span>
scala -version
</code></pre> 
<p><img src="https://images2.imgbox.com/99/a5/Zk8qSxik_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_185"></a>四、大数据组件安装</h3> 
<h4><a id="41_Hadoop__186"></a>4.1 Hadoop 集群安装</h4> 
<ul><li>下载相关包并上传虚拟机</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 上传</span>
rz -be
<span class="token comment"># 解压</span>
<span class="token function">tar</span> -zxvf hadoop-3.2.1.tar.gz -C <span class="token punctuation">..</span>/program/
<span class="token comment"># 进入配置目录</span>
<span class="token function">cd</span> <span class="token punctuation">..</span>/program/hadoop-3.2.1/etc/hadoop
<span class="token comment"># 修改 hadoop-env.sh，添加下面的内容</span>
<span class="token function">export</span> JAVA_HOME<span class="token operator">=</span>/home/ac_cluster/program/jdk1.8.0_361
</code></pre> 
<ul><li>修改 core-site.xml</li></ul> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>fs.defaultFS<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hdfs://hybrid01:9000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hadoop.tmp.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/home/ac_cluster/runtime/hadoop_repo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ul><li>修改 hdfs-site.xml</li></ul> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.replication<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.secondary.http-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hybrid01:50090<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ul><li>修改 mapred-site.xml</li></ul> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.framework.name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>yarn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ul><li>修改 yarn-site.xml</li></ul> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.aux-services<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>mapreduce_shuffle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.env-whitelist<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.hostname<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hybrid02<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ul><li>修改 workers 
  <ul><li>添加相关 datanode 节点主机名</li></ul> </li><li>修改 hdfs、yarn 启动脚本</li></ul> 
<pre><code class="prism language-shell"><span class="token comment"># start-dfs.sh、stop-dfs.sh</span>
HDFS_DATANODE_USER<span class="token operator">=</span>root
HDFS_DATANODE_SECURE_USER<span class="token operator">=</span>hdfs
HDFS_NAMENODE_USER<span class="token operator">=</span>root
HDFS_SECONDARYNAMENODE_USER<span class="token operator">=</span>root
<span class="token comment"># start-yarn.sh、stop-yarn.sh</span>
YARN_RESOURCEMANAGER_USER<span class="token operator">=</span>root
HADOOP_SECURE_DN_USER<span class="token operator">=</span>yarn
YARN_NODEMANAGER_USER<span class="token operator">=</span>root
</code></pre> 
<ul><li>环境配置</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 根据实际情况修改配置文件</span>
vim ~/.bash_profile
<span class="token comment"># 添加下面的配置</span>
<span class="token function">export</span> HADOOP_HOME<span class="token operator">=</span>/home/ac_cluster/program/hadoop-3.2.1
<span class="token function">export</span> PATH<span class="token operator">=</span><span class="token variable">$PATH</span><span class="token keyword">:</span><span class="token variable">$HADOOP_HOME</span>/bin:<span class="token variable">$HADOOP_HOME</span>/sbin
<span class="token function">export</span> HADOOP_CONF_DIR<span class="token operator">=</span><span class="token variable">${HADOOP_HOME}</span>/etc/hadoop
<span class="token function">export</span> HADOOP_CLASSPATH<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>hadoop classpath<span class="token variable">`</span></span>
<span class="token comment"># 更新环境</span>
<span class="token function">source</span> ~/.bash_profile
</code></pre> 
<ul><li>剩余操作</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 分发各节点，根据自己实际情况操作</span>
<span class="token function">scp</span> -r hadoop-3.2.1/ ac_cluster@hybrid02:<span class="token variable">$PWD</span>
<span class="token function">scp</span> -r hadoop-3.2.1/ ac_cluster@hybrid03:<span class="token variable">$PWD</span>
<span class="token comment"># 格式化 namenode</span>
hdfs namenode -format
<span class="token comment"># hdfs 启动</span>
start-dfs.sh
<span class="token comment"># yarn 启动（进入部署 resourcemanager 的节点进行部署）</span>
start-yarn.sh
</code></pre> 
<p><img src="https://images2.imgbox.com/68/52/WLjO7eaN_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f7/f8/Zu7PYMuS_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="42_Docker__298"></a>4.2 Docker 安装</h4> 
<pre><code class="prism language-bash"><span class="token comment"># 依赖安装</span>
<span class="token function">sudo</span> yum -y <span class="token function">install</span> yum-utils device-mapper-persistent-data lvm2
<span class="token comment"># 配置 docker yum 源</span>
<span class="token function">sudo</span> yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
<span class="token comment"># 下载 docker</span>
<span class="token function">sudo</span> yum -y <span class="token function">install</span> docker-ce docker-ce-cli containerd.io
<span class="token comment"># 启动 docker</span>
<span class="token function">sudo</span> <span class="token function">service</span> docker start
<span class="token comment"># 如果直接用不了，需要 sudo 的话可以直接去掉</span>
<span class="token function">sudo</span> gpasswd -a ac_cluster<span class="token punctuation">(</span>你的用户名<span class="token punctuation">)</span> docker
newgrp docker
</code></pre> 
<h4><a id="43_MySQL__313"></a>4.3 MySQL 安装</h4> 
<ul><li>MySQL 安装的是 5.7 版本，基于 docker 进行安装 
  <ul><li>目前看只有 8 以上支持 ARM 64</li><li>提前准备好挂载的目录 conf、data<br> <img src="https://images2.imgbox.com/80/4b/wIHMtVQU_o.png" alt="在这里插入图片描述"></li></ul> </li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 拉取镜像</span>
docker pull mysql:8
<span class="token comment"># 启动容器</span>
docker run -d --name<span class="token operator">=</span>mysql -p 3306:3306 --restart<span class="token operator">=</span>always --privileged<span class="token operator">=</span>true -v /home/ac_cluster/docker/mysql/data:/var/lib/mysql -v /home/ac_cluster/docker/mysql/conf:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD<span class="token operator">=</span>123456 mysql:8 --character-set-server<span class="token operator">=</span>utf8mb4 --collation-server<span class="token operator">=</span>utf8mb4_unicode_ci
<span class="token comment"># 下载驱动留着备用</span>
<span class="token function">wget</span> http://ftp.ntu.edu.tw/MySQL/Downloads/Connector-J/mysql-connector-java-8.0.26.tar.gz
</code></pre> 
<h4><a id="44_Hive__329"></a>4.4 Hive 安装</h4> 
<ul><li>下载相关包并上传</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 上传</span>
rz -be
<span class="token comment"># 解压</span>
<span class="token function">tar</span> -zxvf apache-hive-3.1.3-bin.tar.gz -C <span class="token punctuation">..</span>/program/
<span class="token comment"># 进入配置目录</span>
<span class="token function">cd</span> <span class="token punctuation">..</span>/program/apache-hive-3.1.3-bin/conf/
<span class="token comment"># 修改 hive-env.sh</span>
<span class="token function">cp</span> hive-env.sh.template hive-env.sh
vim hive-env.sh
<span class="token comment"># 添加下面的内容</span>
HADOOP_HOME<span class="token operator">=</span>/home/ac_cluster/program/hadoop-3.2.1
<span class="token function">export</span> HIVE_CONF_DIR<span class="token operator">=</span>/home/ac_cluster/program/apache-hive-3.1.3-bin/conf
<span class="token comment"># 修改 hive-site.xml</span>
vim hive-site.xml
</code></pre> 
<ul><li>hive-site.xml 配置</li></ul> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0"?&gt;</span>
<span class="token prolog">&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- jdbc 连接的 URL --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionURL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>jdbc:mysql://hybrid03:3306/hive?createDatabaseIfNotExist=true<span class="token entity" title="&amp;">&amp;amp;</span>useSSL=false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- jdbc 连接的 Driver--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionDriverName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>com.mysql.cj.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- jdbc 连接的 username--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionUserName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- jdbc 连接的 password --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionPassword<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>123456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- Hive 默认在 HDFS 的工作目录 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.metastore.warehouse.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/user/hive/warehouse<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 指定存储元数据要连接的地址 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.metastore.uris<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>thrift://hybrid03:9083<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ul><li>其他操作</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 进入 hive 目录</span>
<span class="token function">cd</span> ~/program/apache-hive-3.1.3-bin
<span class="token comment"># 将 MySQL 启动复制一份到 lib 下</span>
<span class="token function">cp</span> ~/package/mysql-connector-java-8.0.26/mysql-connector-java-8.0.26.jar ./lib/
<span class="token comment"># guava 包问题，将 Hadoop 下的 guava 包复制到 lib 下</span>
<span class="token function">cp</span> ~/program/hadoop-3.2.1/share/hadoop/common/lib/guava-27.0-jre.jar ./lib/
<span class="token comment"># 备份</span>
<span class="token function">mv</span> ./lib/guava-19.0.jar ./lib/guava-19.0.jar.bak
<span class="token comment"># 初始化数据库</span>
bin/schematool -dbType mysql -initSchema
<span class="token comment"># 配置环境</span>
vim ~/.bash_profile
<span class="token comment"># 添加下面的配置</span>
<span class="token function">export</span> HIVE_HOME<span class="token operator">=</span>/home/ac_cluster/program/apache-hive-3.1.3-bin
<span class="token function">export</span> PATH<span class="token operator">=</span><span class="token variable">$PATH</span><span class="token keyword">:</span><span class="token variable">$HIVE_HOME</span>/bin
<span class="token comment"># 刷新环境</span>
<span class="token function">source</span> ~/.bash_profile
<span class="token comment"># 启动服务</span>
<span class="token function">nohup</span> hive --service metastore <span class="token operator">&amp;</span>
<span class="token comment"># 启动交互</span>
hive
</code></pre> 
<h4><a id="45_Spark__413"></a>4.5 Spark 安装</h4> 
<ul><li>平常习惯 Spark 是基于 Yarn 跑任务，这里只是简单解压，不安装集群</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 上传</span>
rz -be
<span class="token comment"># 解压</span>
<span class="token function">tar</span> -zxvf spark-3.1.2-bin-hadoop3.2.tgz -C <span class="token punctuation">..</span>/program/
<span class="token comment"># 配置环境</span>
vim ~/.bash_profile
<span class="token comment"># 添加下面配置</span>
<span class="token function">export</span> SPARK_HOME<span class="token operator">=</span>/home/ac_cluster/program/spark-3.1.2-bin-hadoop3.2
<span class="token function">export</span> PATH<span class="token operator">=</span><span class="token variable">$PATH</span><span class="token keyword">:</span><span class="token variable">$SPARK_HOME</span>/bin
<span class="token comment"># 刷新</span>
<span class="token function">source</span> ~/.bash_profile
</code></pre> 
<ul><li>测试样例 yarn 提交 
  <ul><li>在 Hadoop Yarn 的 8088 端口页面中可以看到相关信息</li></ul> </li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 进入样例 jar 包所在位置</span>
<span class="token function">cd</span> ~/program/spark-3.1.2-bin-hadoop3.2/examples/jars
<span class="token comment"># 提交任务</span>
spark-submit --master yarn --class org.apache.spark.examples.SparkPi spark-examples_2.12-3.1.2.jar 100
</code></pre> 
<p><img src="https://images2.imgbox.com/8c/c1/AR1GlwCL_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/0c/1d/sxXvvT08_o.png" alt="在这里插入图片描述"></p> 
<ul><li>配置 Hive 环境 
  <ul><li>将 Hive 的 hive-site.xml 放到 Spark 的 conf 下</li><li>将 MySQL 的驱动放到 Spark 的 jars 里</li><li>测试 
    <ul><li>spark-shell</li><li>spark.sql(“show databases”).show()</li></ul> </li></ul> </li></ul> 
<p><img src="https://images2.imgbox.com/a1/60/xs9be4x2_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="46_Flink__448"></a>4.6 Flink 安装</h4> 
<ul><li>Flink 和 Spark 一样基于 Yarn 运行，不安装集群</li><li>下载相关包并上传</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 上传</span>
rz -be
<span class="token comment"># 解压</span>
<span class="token function">tar</span> -zxvf flink-1.13.1-bin-scala_2.12.tgz -C <span class="token punctuation">..</span>/program/
<span class="token comment"># 配置环境</span>
vim ~/.bash_profile
<span class="token comment"># 添加下面的配置</span>
<span class="token function">export</span> FLINK_HOME<span class="token operator">=</span>/home/ac_cluster/program/flink-1.13.1
<span class="token function">export</span> PATH<span class="token operator">=</span><span class="token variable">$PATH</span><span class="token keyword">:</span><span class="token variable">$FLINK_HOME</span>/bin
<span class="token comment"># 刷新环境</span>
<span class="token function">source</span> ~/.bash_profile
</code></pre> 
<ul><li>测试样例 yarn 提交 
  <ul><li>在 Hadoop Yarn 的 8088 端口页面中可以看到相关信息</li></ul> </li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 进入样例目录</span>
<span class="token function">cd</span> ~/program/flink-1.13.1/examples/batch
<span class="token comment"># 提交任务</span>
flink run -m yarn-cluster WordCount.jar
</code></pre> 
<p><img src="https://images2.imgbox.com/bf/7d/YRs8PZqh_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/0f/02/eZNZZVzu_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="47_Zookeeper__475"></a>4.7 Zookeeper 安装</h4> 
<ul><li>下载相应的包上传</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 上传</span>
rz -be
<span class="token comment"># 解压</span>
<span class="token function">tar</span> -zxvf apache-zookeeper-3.8.0-bin.tar.gz -C <span class="token punctuation">..</span>/program/
<span class="token comment"># 创建数据目录和日志目录（所有节点都要操作）</span>
<span class="token function">mkdir</span> -p ~/runtime/zookeeper/data ~/runtime/zookeeper/logs
<span class="token comment"># 进入配置目录</span>
<span class="token function">cd</span> ~/program/apache-zookeeper-3.8.0-bin/conf
<span class="token comment"># 修改 zoo.cfg</span>
<span class="token function">cp</span> zoo_sample.cfg zoo.cfg
vim zoo.cfg
<span class="token comment"># 修改下面的配置</span>
dataDir<span class="token operator">=</span>/home/ac_cluster/runtime/zookeeper/data
dataLogDir<span class="token operator">=</span>/home/ac_cluster/runtime/zookeeper/logs
server.1<span class="token operator">=</span>hybrid01:2888:3888
server.2<span class="token operator">=</span>hybrid02:2888:3888
server.3<span class="token operator">=</span>hybrid03:2888:3888
<span class="token comment"># 分发节点</span>
<span class="token function">scp</span> -r apache-zookeeper-3.8.0-bin/ ac_cluster@hybrid02:<span class="token variable">$PWD</span>
<span class="token comment"># 在 dataDir 目录下添加 myid 并赋值，其他节点同样操作，不同 id</span>
<span class="token keyword">echo</span> 1 <span class="token operator">&gt;</span> ~/runtime/zookeeper/data/myid
<span class="token comment"># 配置环境（三个节点都要配）</span>
vim ~/.bash_profile
<span class="token comment"># 添加下面的配置</span>
<span class="token function">export</span> ZOOKEEPER_HOME<span class="token operator">=</span>/home/ac_cluster/program/apache-zookeeper-3.8.0-bin
<span class="token function">export</span> PATH<span class="token operator">=</span><span class="token variable">$PATH</span><span class="token keyword">:</span><span class="token variable">$ZOOKEEPER_HOME</span>/bin
<span class="token comment"># 刷新</span>
<span class="token function">source</span> ~/.bash_profile
<span class="token comment"># 三个节点逐个启动</span>
zkServer.sh start
<span class="token comment"># 查看状态</span>
zkServer.sh status
</code></pre> 
<h4><a id="48_Kafka__512"></a>4.8 Kafka 安装</h4> 
<ul><li>下载相应的包并上传</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 上传</span>
rz -be
<span class="token comment"># 解压</span>
<span class="token function">tar</span> -zxvf kafka_2.12-3.2.0.tgz -C <span class="token punctuation">..</span>/program/
<span class="token comment"># 创建 log 目录</span>
<span class="token function">mkdir</span> -p ~/runtime/kafka/logs
<span class="token comment"># 进入 conf 目录修改 server.properties</span>
<span class="token function">cd</span> ~/program/kafka_2.12-3.2.0/config/
vim server.properties
<span class="token comment"># 查看并修改下面的配置，id 必须唯一，传给其他节点需要修改</span>
broker.id<span class="token operator">=</span>0
log.dirs<span class="token operator">=</span>/home/ac_cluster/runtime/kafka/logs
zookeeper.connect<span class="token operator">=</span>hybrido1:2181,hybrid02:2181,hybrid03:2181
listeners<span class="token operator">=</span>PLAINTEXT://192.168.104.101:9092
advertised.listeners<span class="token operator">=</span>PLAINTEXT://192.168.104.101:9092
<span class="token comment"># 配置环境</span>
vim ~/.bash_profile
<span class="token comment"># 添加下面的配置</span>
<span class="token function">export</span> KAFKA_HOME<span class="token operator">=</span>/home/ac_cluster/program/kafka_2.12-3.2.0
<span class="token function">export</span> PATH<span class="token operator">=</span><span class="token variable">$PATH</span><span class="token keyword">:</span><span class="token variable">$KAFKA_HOME</span>/bin
<span class="token comment"># 刷新</span>
<span class="token function">source</span> ~/.bash_profile
<span class="token comment"># 分发节点，并修改相关配置，配置环境变量</span>
<span class="token function">scp</span> -r kafka_2.12-3.2.0/ ac_cluster@hybrid02:<span class="token variable">$PWD</span>
<span class="token function">scp</span> -r kafka_2.12-3.2.0/ ac_cluster@hybrid03:<span class="token variable">$PWD</span>
<span class="token comment"># 逐个启动节点，如果有报错，查看下方解决方案</span>
<span class="token function">nohup</span> kafka-server-start.sh <span class="token variable">$KAFKA_HOME</span>/config/server.properties <span class="token operator">&gt;</span> ~/runtime/kafka/logs/nohup.log 2<span class="token operator">&gt;</span><span class="token operator">&amp;</span>1 <span class="token operator">&amp;</span>
</code></pre> 
<h4><a id="49_Nginx__544"></a>4.9 Nginx 安装</h4> 
<ul><li>下载相应的包并上传，也可以使用 wget 下载</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 环境依赖安装</span>
<span class="token function">sudo</span> yum -y <span class="token function">install</span> gcc zlib zlib-devel pcre-devel openssl openssl-devel
<span class="token comment"># wget 下载包</span>
<span class="token function">wget</span> https://nginx.org/download/nginx-1.22.1.tar.gz
<span class="token comment"># 解压</span>
<span class="token function">tar</span> -zxvf nginx-1.22.1.tar.gz
<span class="token comment"># 创建配置目录</span>
<span class="token function">mkdir</span> ~/program/nginx-1.22.1
<span class="token comment"># 预编译，一般只需要配置 --prefix，其他的可选安装</span>
./configure --prefix<span class="token operator">=</span>/home/ac_cluster/program/nginx-1.22.1 --with-http_stub_status_module --with-http_ssl_module --with-http_realip_module --with-stream --with-http_auth_request_module
<span class="token comment"># 编译安装</span>
<span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span>
<span class="token comment"># 配置环境</span>
vim ~/.bash_profile
<span class="token comment"># 添加下面的配置</span>
<span class="token function">export</span> NGINX_HOME<span class="token operator">=</span>/home/ac_cluster/program/nginx-1.22.1
<span class="token function">export</span> PATH<span class="token operator">=</span><span class="token variable">$PATH</span><span class="token keyword">:</span><span class="token variable">$NGINX_HOME</span>/sbin
<span class="token comment"># 刷新</span>
<span class="token function">source</span> ~/.bash_profile
<span class="token comment"># 启动，启动报错查看下方解决方案</span>
nginx
</code></pre> 
<p><img src="https://images2.imgbox.com/f4/41/EBMT16Qm_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="410_Node__571"></a>4.10 Node 安装</h4> 
<ul><li>下载相关包并上传</li></ul> 
<pre><code class="prism language-bash"><span class="token comment"># 使用 wget 下载</span>
<span class="token function">wget</span> https://nodejs.org/dist/v17.9.1/node-v17.9.1-linux-arm64.tar.gz
<span class="token comment"># 解压</span>
<span class="token function">tar</span> -zxvf node-v17.9.1-linux-arm64.tar.gz -C <span class="token punctuation">..</span>/program/
<span class="token comment"># 配置环境变量</span>
vim ~/.bash_profile
<span class="token comment"># 添加下面的配置</span>
<span class="token function">export</span> NODE_HOME<span class="token operator">=</span>/home/ac_cluster/program/node-v17.9.1-linux-arm64
<span class="token function">export</span> PATH<span class="token operator">=</span><span class="token variable">$PATH</span><span class="token keyword">:</span><span class="token variable">$NODE_HOME</span>/bin
<span class="token comment"># 刷新</span>
<span class="token function">source</span> ~/.bash_profile
<span class="token comment"># 查看版本</span>
node -v
<span class="token function">npm</span> -v
<span class="token comment"># 安装淘宝镜像</span>
<span class="token function">npm</span> <span class="token function">install</span> -g cnpm --registry<span class="token operator">=</span>https://registry.npm.taobao.org
<span class="token comment"># 查看</span>
cnpm -v
<span class="token comment"># 安装 vue-cli 脚手架</span>
cnpm <span class="token function">install</span> -g vue-cli
<span class="token comment"># 查看</span>
vue -V
</code></pre> 
<p><img src="https://images2.imgbox.com/67/43/bAECS5Jf_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="411_Doris__599"></a>4.11 Doris 安装</h4> 
<p>持续更新中～～～</p> 
<h3><a id="_604"></a>五、问题解决</h3> 
<h4><a id="51__605"></a>5.1 环境配置错误，丢失命令</h4> 
<ul><li>添加临时命令</li></ul> 
<pre><code class="prism language-bash"><span class="token function">export</span> PATH<span class="token operator">=</span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
</code></pre> 
<h4><a id="52_startyarnsh__resourcemanager_612"></a>5.2 start-yarn.sh 无法启动 resourcemanager</h4> 
<ul><li>查看日志报错 java.net.BindException: Port in use: hybrid02:8088</li><li>解决：进入 resourcemanager 部署的节点进行启动<br> - start-yarn.sh</li></ul> 
<h4><a id="53_mysql__Public_Key_Retrieval_is_not_allowed_617"></a>5.3 mysql 远程连接报错 Public Key Retrieval is not allowed</h4> 
<ul><li>我使用的是 DBeaver，在驱动属性里面修改配置为 true 即可</li></ul> 
<p><img src="https://images2.imgbox.com/6e/51/8Ro8cBj1_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="54_Flink__classloadercheckleakedclassloader_622"></a>5.4 Flink 提交任务报错 classloader.check-leaked-classloader</h4> 
<p>Exception in thread “Thread-5” java.lang.IllegalStateException: Trying to access closed classloader. Please check if you store classloaders directly or indirectly in static fields. If the stacktrace suggests that the leak occurs in a third party library and cannot be fixed immediately, you can disable this check with the configuration ‘classloader.check-leaked-classloader’.<br> <img src="https://images2.imgbox.com/1a/36/D4qycU5I_o.png" alt="在这里插入图片描述"></p> 
<ul><li>解决 
  <ul><li>编辑在 flink 目录 conf 下的 flink-conf.yaml 
    <ul><li>添加：classloader.check-leaked-classloader: false</li></ul> </li></ul> </li></ul> 
<h4><a id="55_Kafka__UseG1GC_629"></a>5.5 Kafka 启动报错 UseG1GC</h4> 
<p>VM option ‘UseG1GC’ is experimental and must be enabled via -XX:+UnlockExperimentalVMOptions<br> <img src="https://images2.imgbox.com/07/dd/ia1VbVWU_o.png" alt="在这里插入图片描述"></p> 
<ul><li>解决 
  <ul><li>进入 Kafka 安装目录下的 bin 目录，修改 kafka-run-class.sh，删除下图中的配置，重新启动</li></ul> </li></ul> 
<p><img src="https://images2.imgbox.com/da/dc/HtGIu8Jm_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="56_Nginx__Permission_denied_636"></a>5.6 Nginx 启动报错 Permission denied</h4> 
<p>nginx: [emerg] bind() to 0.0.0.0:80 failed (13: Permission denied)<br> sudo: nginx：找不到命令<br> <img src="https://images2.imgbox.com/c2/9b/njhT4xzP_o.png" alt="在这里插入图片描述"></p> 
<ul><li>普通用户启动 Nginx 没有权限启动 80 端口，sudo 后找不到命令 
  <ul><li>解决方案：直接去到目录下使用 sudo 启动 
    <ul><li>sudo sbin/nginx</li></ul> </li></ul> </li></ul> 
<h4><a id="57_Nginx_403_Forbidden_644"></a>5.7 Nginx 403 Forbidden</h4> 
<p><img src="https://images2.imgbox.com/06/ac/4nlplpt1_o.png" alt="在这里插入图片描述">- 浏览器访问 nginx 的时候报 403<br> - 解决：修改 nginx.conf 配置文件，添加 user root 配置<br> - 保存后重新加载配置 sudo sbin/nginx -s reload</p> 
<p><img src="https://images2.imgbox.com/f4/6c/pysqYFqE_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="58_Node__GLIBC_227_not_found_650"></a>5.8 Node 报错 GLIBC_2.27 not found</h4> 
<p>node: /lib64/libm.so.6: version ‘GLIBC_2.27’ not found (required by node)<br> node: /lib64/libc.so.6: version ‘GLIBC_2.28’ not found (required by node)<br> …</p> 
<ul><li>Node 18 版本之后 GLIBC 提高到了 2.28 or later 
  <ul><li>解决：降低 Node 版本或者提高 GLIBC 版本，推荐是降低 Node 版本到 17 版本，GLIBC 不好弄</li></ul> </li></ul> 
<p><img src="https://images2.imgbox.com/08/62/f5bcHXbM_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b566a87f6a227be6a573ed2c36e54deb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Jaccard 评价指标的简介与图示</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/07eed321f2fe08f697ec6afa866a791d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringSecurity前后端分离（包含token和验证码登录）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>