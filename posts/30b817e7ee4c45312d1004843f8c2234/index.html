<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>keybd_event()使用方法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="keybd_event()使用方法" />
<meta property="og:description" content="keybd_event()使用方法 函数说明 函数功能：keybd_event函数模拟一次击键事件。系统可使用这种模拟的击键事件来产生WM_KEYUP或WM_KEYDOWN消息，键盘驱动程序的中断处理程序调用keybd_event函数。在Windows NT中该函数己被使用SendInput来替代它完成操作。
函数原型；VOID keybd_event（BYTE bVk，BYTE bScan，DWORD dwFlags，DWORD dwExtralnfo）；
函数参数：
bVk：定义一个虚拟键码，键码值必须在1～254之间。
bScan：定义该键的硬件扫描码。
dwFlags：定义函数操作的各个方面的一个标志位集。应用程序可使用如下一些预定义常数的组合设置标志位：
KEYEVENTF_EXTENDEDKEY：若指定该值，则扫描码前一个值为OXEO（224）的前缀字节。KEYEVENTF_KEYUP：若指定该值，该键将被释放；若未指定该值，该键将被按下。 dwExtralnfo：定义与击键相关的附加的32位值。
返回值：该函数无返回值。
#include&amp;lt;afx.h&amp;gt;
#include&amp;lt;WinUser.h&amp;gt;
#include&amp;lt;Windows.h&amp;gt;
voidmain()
{
keybd_event(16,0,0,0); // 按下Shift键
keybd_event(&#39;A&#39;,0,0,0); // 按下a键
Sleep(100);
keybd_event(&#39;A&#39;,0,KEYEVENTF_KEYUP,0);// 松开a键
keybd_event(16,0,KEYEVENTF_KEYUP,0);// 松开Shift键
// 构成组合键----&amp;gt;按下Shift的同时按下a，形成A
}
使用说明 尽管keybd_event函数传递一个与OEM相关的硬件扫描码给系统，但应用程序不能用此扫描码。系统在内部将扫描码转换成虚拟键码，并且在传送给应用程序前清除键码的UP/DOWN位。应用程序可以摸拟PRINTSCREEN键的按下来获得一个屏幕快照，并把它存放到剪切板中。若要做到这一点，则要将keybd_event的bVk参数置为VK_SNAPSHOT，bScan参数置为0（用以获得全屏快照）或hScan置为1（仅获得活动窗口的快照）。
Windows CE：WindowsCE支持dwFlags参数附加的标志位，即使用KEYEVENTF_SILENT标志模拟击键，而不产生敲击的声音。
Windows CE不支持KEYEVENTF_EXTENDEDKEY标志。
适用版本 速查：Windows NT：3.1及以上版本；Windows：95及以上版本 ；Windows CE：1.0及以上版本；头文件：winuser.h；库文件：user32.lib。
详细说明 Windows提供了一个模拟键盘操作的API函数keybd_event()，使用该函数可以模拟相应的键盘动作。keybd_event()函数能触发一个按键事件，也就是说会产生一个WM_KEYDOWN或WM_KEYUP消息。该函数原型如下：
VOID keybd_event(
BYTE bVk, // virtual-key code
BYTE bScan, // hardware scan code
DWORD dwFlags, // flags specifying various function options" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/30b817e7ee4c45312d1004843f8c2234/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-08-23T08:28:25+08:00" />
<meta property="article:modified_time" content="2018-08-23T08:28:25+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">keybd_event()使用方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="margin-left:0cm;"><span style="color:#ff9900;">keybd_event()使用方法</span></h2> 
<h3 style="margin-left:0cm;"><span style="color:#0000FF;">函数说明</span></h3> 
<p style="margin-left:0cm;"><span style="color:#000000;">函数功能：</span><span style="color:#000000;">keybd_event</span><span style="color:#000000;">函数模拟一次击键事件。系统可使用这种模拟的击键事件来产生</span><span style="color:#000000;">WM_KEYUP</span><span style="color:#000000;">或</span><span style="color:#000000;">WM_KEYDOWN</span><span style="color:#000000;">消息，键盘驱动程序的中断处理程序调用</span><span style="color:#000000;">keybd_event</span><span style="color:#000000;">函数。在</span><span style="color:#000000;">Windows NT</span><span style="color:#000000;">中该函数己被使用</span><span style="color:#000000;">SendInput</span><span style="color:#000000;">来替代它完成操作。</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#FF0000;">函数原型</span></strong><span style="color:#000000;">；</span><span style="color:#000000;">VOID keybd_event</span><span style="color:#000000;">（</span><span style="color:#000000;">BYTE bVk</span><span style="color:#000000;">，</span><span style="color:#000000;">BYTE bScan</span><span style="color:#000000;">，</span><span style="color:#000000;">DWORD dwFlags</span><span style="color:#000000;">，</span><span style="color:#000000;">DWORD dwExtralnfo</span><span style="color:#000000;">）；</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#FF0000;">函数参数</span></strong><span style="color:#000000;">：</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#000000;">bVk</span></strong><span style="color:#000000;">：定义一个虚拟键码，键码值必须在</span><span style="color:#000000;">1</span><span style="color:#000000;">～</span><span style="color:#000000;">254</span><span style="color:#000000;">之间。</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#000000;">bScan</span></strong><span style="color:#000000;">：定义该键的硬件扫描码。</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#000000;">dwFlags</span></strong><span style="color:#000000;">：定义函数操作的各个方面的一个标志位集。应用程序可使用如下一些预定义常数的组合设置标志位：</span></p> 
<ol><li><span style="color:#000000;">KEYEVENTF_EXTENDEDKEY</span><span style="color:#000000;">：若指定该值，则扫描码前一个值为</span><span style="color:#000000;">OXEO</span><span style="color:#000000;">（</span><span style="color:#000000;">224</span><span style="color:#000000;">）的前缀字节。</span></li><li><span style="color:#000000;">KEYEVENTF_KEYUP</span><span style="color:#000000;">：若指定该值，该键将被释放；若未指定该值，该键将被按下。</span></li></ol> 
<p style="margin-left:0cm;"><strong><span style="color:#000000;">dwExtralnfo</span></strong><span style="color:#000000;">：定义与击键相关的附加的</span><span style="color:#000000;">32</span><span style="color:#000000;">位值。</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">返回值：该函数无返回值。</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">#include&amp;lt;afx.h&amp;gt;</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">#include&amp;lt;WinUser.h&amp;gt;</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">#include&amp;lt;Windows.h&amp;gt;</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">voidmain()</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">{<!-- --></span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(16,0,0,0);    // </span><span style="color:#0000FF;">按下</span><span style="color:#0000FF;">Shift</span><span style="color:#0000FF;">键</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event('A',0,0,0);    // </span><span style="color:#0000FF;">按下</span><span style="color:#0000FF;">a</span><span style="color:#0000FF;">键</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">Sleep(100);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event('A',0,KEYEVENTF_KEYUP,0);// </span><span style="color:#0000FF;">松开</span><span style="color:#0000FF;">a</span><span style="color:#0000FF;">键</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(16,0,KEYEVENTF_KEYUP,0);// </span><span style="color:#0000FF;">松开</span><span style="color:#0000FF;">Shift</span><span style="color:#0000FF;">键</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">// </span><span style="color:#0000FF;">构成组合键</span><span style="color:#0000FF;">----&amp;gt;</span><span style="color:#0000FF;">按下</span><span style="color:#0000FF;">Shift</span><span style="color:#0000FF;">的同时按下</span><span style="color:#0000FF;">a</span><span style="color:#0000FF;">，形成</span><span style="color:#0000FF;">A</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">}</span></p> 
<h3 style="margin-left:0cm;"><span style="color:#0000FF;"><a name="2"></a><a name="sub1080077_2"></a><a name="%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E"></a>使用说明</span></h3> 
<p style="margin-left:0cm;"><span style="color:#000000;">尽管</span><span style="color:#000000;">keybd_event</span><span style="color:#000000;">函数传递一个与</span><span style="color:#000000;">OEM</span><span style="color:#000000;">相关的硬件扫描码给系统，但应用程序不能用此扫描码。系统在内部将扫描码转换成虚拟键码，并且在传送给应用程序前清除键码的</span><span style="color:#000000;">UP/DOWN</span><span style="color:#000000;">位。应用程序可以摸拟</span><span style="color:#000000;">PRINTSCREEN</span><span style="color:#000000;">键的按下来获得一个屏幕快照，并把它存放到剪切板中。若要做到这一点，则要将</span><span style="color:#000000;">keybd_event</span><span style="color:#000000;">的</span><span style="color:#000000;">bVk</span><span style="color:#000000;">参数置为</span><span style="color:#000000;">VK_SNAPSHOT</span><span style="color:#000000;">，</span><span style="color:#000000;">bScan</span><span style="color:#000000;">参数置为</span><span style="color:#000000;">0</span><span style="color:#000000;">（用以获得全屏快照）或</span><span style="color:#000000;">hScan</span><span style="color:#000000;">置为</span><span style="color:#000000;">1</span><span style="color:#000000;">（仅获得活动窗口的快照）。</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">Windows CE</span><span style="color:#000000;">：</span><span style="color:#000000;">WindowsCE</span><span style="color:#000000;">支持</span><span style="color:#000000;">dwFlags</span><span style="color:#000000;">参数附加的标志位，即使用</span><span style="color:#000000;">KEYEVENTF_SILENT</span><span style="color:#000000;">标志模拟击键，而不产生敲击的声音。</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">Windows CE</span><span style="color:#000000;">不支持</span><span style="color:#000000;">KEYEVENTF_EXTENDEDKEY</span><span style="color:#000000;">标志。</span></p> 
<h3 style="margin-left:0cm;"><span style="color:#0000FF;"><a name="3"></a><a name="sub1080077_3"></a><a name="%E9%80%82%E7%94%A8%E7%89%88%E6%9C%AC"></a>适用版本</span></h3> 
<p style="margin-left:0cm;"><span style="color:#000000;">速查：</span><span style="color:#000000;">Windows NT</span><span style="color:#000000;">：</span><span style="color:#000000;">3.1</span><span style="color:#000000;">及以上版本；</span><span style="color:#000000;">Windows</span><span style="color:#000000;">：</span><span style="color:#000000;">95</span><span style="color:#000000;">及以上版本</span> <span style="color:#000000;">；</span><span style="color:#000000;">Windows CE</span><span style="color:#000000;">：</span><span style="color:#000000;">1.0</span><span style="color:#000000;">及以上版本；头文件：</span><span style="color:#000000;">winuser.h</span><span style="color:#000000;">；库文件：</span><span style="color:#000000;">user32.lib</span><span style="color:#000000;">。</span></p> 
<h3 style="margin-left:0cm;"><span style="color:#0000FF;">详细说明</span></h3> 
<p style="margin-left:0cm;"><span style="color:#000000;">Windows</span><span style="color:#000000;">提供了一个模拟键盘操作的</span><span style="color:#000000;">API</span><span style="color:#000000;">函数</span><span style="color:#000000;">keybd_event()</span><span style="color:#000000;">，使用该函数可以模拟相应的键盘动作。</span><span style="color:#000000;">keybd_event()</span><span style="color:#000000;">函数能触发一个按键事件，也就是说会产生一个</span><span style="color:#000000;">WM_KEYDOWN</span><span style="color:#000000;">或</span><span style="color:#000000;">WM_KEYUP</span><span style="color:#000000;">消息。该函数原型如下：</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">VOID keybd_event(</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">BYTE bVk,                     // virtual-key code</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">BYTE bScan,                  // hardware scan code</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">DWORD dwFlags,         // flags specifying various function options</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">DWORD dwExtraInfo   // additional data associated with keystroke);</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">从原型可以看出，</span><span style="color:#000000;">keybd_event ()</span><span style="color:#000000;">共有四个参数：</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#FF0000;">bVk</span></strong><span style="color:#000000;">：按键虚拟键值，如回车键为</span><span style="color:#000000;">vk_return</span><span style="color:#000000;">，</span><span style="color:#000000;">Tab</span><span style="color:#000000;">键为</span><span style="color:#000000;">vk_tab</span><span style="color:#000000;">；</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#FF0000;">bScan</span></strong><span style="color:#000000;">：为扫描码，一般不用设置，用</span><span style="color:#000000;">0</span><span style="color:#000000;">代替就行；</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#FF0000;">dwFlags</span></strong><span style="color:#000000;">：为选项标志，如果为</span><span style="color:#000000;">keydown</span><span style="color:#000000;">则置</span><span style="color:#000000;">0</span><span style="color:#000000;">即可，如果为</span><span style="color:#000000;">keyup</span><span style="color:#000000;">则设成</span><span style="color:#000000;">"KEYEVENTF_KEYUP"</span><span style="color:#000000;">；</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#FF0000;">dwExtraInfo</span></strong><span style="color:#000000;">：一般置</span><span style="color:#000000;">0</span><span style="color:#000000;">即可。</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">// </span><span style="color:#0000FF;">例子</span><span style="color:#0000FF;">1</span><span style="color:#0000FF;">：模拟按下</span><span style="color:#0000FF;">'A'</span><span style="color:#0000FF;">键</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(65,0,0,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(65,0,KEYEVENTF_KEYUP,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">// </span><span style="color:#0000FF;">例子</span><span style="color:#0000FF;">2</span><span style="color:#0000FF;">：模拟按下</span><span style="color:#0000FF;">'ALT+F4'</span><span style="color:#0000FF;">键</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(18,0,0,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(115,0,0,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(115,0,KEYEVENTF_KEYUP,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(18,0,KEYEVENTF_KEYUP,0);</span></p> 
<h3 style="margin-left:0cm;"><span style="color:#0000FF;">实用例程</span></h3> 
<p style="margin-left:0cm;"><span style="color:#000000;">模拟键盘平时不是很常用，但是当调用某些快捷键执行某项功能时，它真的是那么的方便，看看下面的实现。</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#FF0000;">1. </span></strong><strong><span style="color:#FF0000;">显示桌面</span></strong></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">很多软件有显示桌面的功能，并且大家的方法都是遍历窗口，然后让它们最小化，其实</span><span style="color:#000000;">Windows</span><span style="color:#000000;">系统给了一个非常方便的</span><span style="color:#000000;">WIN</span><span style="color:#000000;">键（就是键盘上在</span><span style="color:#000000;">CTRL</span><span style="color:#000000;">键和</span><span style="color:#000000;">ALT</span><span style="color:#000000;">键之间的那个带</span><span style="color:#000000;">win</span><span style="color:#000000;">标志的按键）。利用它可以轻松的完成显示桌面的功能。</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">// </span><span style="color:#0000FF;">显示桌面</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_LWIN, 0, 0 ,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event('M', 0, 0 ,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event('M', 0, KEYEVENTF_KEYUP ,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_LWIN, 0, KEYEVENTF_KEYUP,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">其他的操作也类似，比如直接显示“开始”的运行，就把上面的</span><span style="color:#000000;">'M'</span><span style="color:#000000;">换成</span><span style="color:#000000;">'R'</span><span style="color:#000000;">即可。</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">// </span><span style="color:#0000FF;">显示开始运行</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_LWIN, 0, 0 ,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_LWIN, 0, KEYEVENTF_KEYUP,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">直接显示“开始”对话框了。</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#FF0000;">2. </span></strong><strong><span style="color:#FF0000;">实现快速全选</span></strong></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">很多的时候，比如</span><span style="color:#000000;">listctrl</span><span style="color:#000000;">实现全选，你可以用</span><span style="color:#000000;">listctrl</span><span style="color:#000000;">循环设置每一项的状态为选中，多啰嗦的事情。用快捷键试一试</span><span style="color:#000000;">CTRL</span><span style="color:#000000;">＋</span><span style="color:#000000;">A</span><span style="color:#000000;">，其他的快捷键一样的用法。</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_CONTROL, (BYTE)0, 0 ,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event('A',(BYTE)0, 0 ,0); //</span><span style="color:#0000FF;">此处可以用</span><span style="color:#0000FF;">  'A', (BYTE)65, </span><span style="color:#0000FF;">用</span><span style="color:#0000FF;">'a'</span><span style="color:#0000FF;">不起作用</span><span style="color:#0000FF;">.</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event('A', (BYTE)0, KEYEVENTF_KEYUP,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_CONTROL, (BYTE)0, KEYEVENTF_KEYUP,0);</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#FF0000;">3. </span></strong><strong><span style="color:#FF0000;">执行某些特殊键，比如数字键，大小写键</span></strong></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">bool bState=true;              // true</span><span style="color:#0000FF;">为按下</span><span style="color:#0000FF;">NumLock</span><span style="color:#0000FF;">，</span><span style="color:#0000FF;">false</span><span style="color:#0000FF;">反之</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">BYTE keyState[256];</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">GetKeyboardState((LPBYTE)&amp;keyState);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">if( (bState &amp;&amp; !(keyState[VK_NUMLOCK] &amp; 1)) ||</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;"> (!bState &amp;&amp; (keyState[VK_NUMLOCK] &amp; 1)) )</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">{<!-- --></span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">// Simulate a key press</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event( VK_NUMLOCK, 0x45, KEYEVENTF_EXTENDEDKEY | 0, 0 );</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">// Simulate a key release</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event( VK_NUMLOCK, 0x45, KEYEVENTF_EXTENDEDKEY | KEYEVENTF_KEYUP, 0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">}</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#FF0000;">4. </span></strong><strong><span style="color:#FF0000;">实现</span></strong><strong><span style="color:#FF0000;">CTRL</span></strong><strong><span style="color:#FF0000;">＋</span></strong><strong><span style="color:#FF0000;">ALT</span></strong><strong><span style="color:#FF0000;">＋</span></strong><strong><span style="color:#FF0000;">DELETE</span></strong><strong><span style="color:#FF0000;">三键一起按下</span></strong></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_CONTROL, 0, 0 ,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_MENU,0, 0 ,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_DELETE,0, 0 ,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_CONTROL, 0, KEYEVENTF_KEYUP ,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_MENU,0, KEYEVENTF_KEYUP ,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_DELETE,0, KEYEVENTF_KEYUP ,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">这样不会成功，因为这几个键是操作系统直接截获执行的，而模拟键盘只能发向应用程序，所以这种方法不行的（想显示锁定对话框，用</span><span style="color:#000000;">LockWorkStation();</span><span style="color:#000000;">）</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">5. Window2000/NT/XP</span><span style="color:#000000;">已经不提倡用这个函数了，上面的方法只是为了让大家开阔一下思路，怎么替代？</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">// Window2000/NT/XP</span><span style="color:#0000FF;">下用这个代替，包含</span><span style="color:#0000FF;">"winable.h"</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">INPUT input[4];</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">memset(input, 0, sizeof(input));</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">input[0].type = input[1].type = input[2].type = input[3].type = INPUT_KEYBOARD;</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">input[0].ki.wVk  = input[3].ki.wVk = VK_LWIN;</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">input[1].ki.wVk  = input[2].ki.wVk = 'R';</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">//</span><span style="color:#0000FF;">接下来释放它，这一点很重要。</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">input[2].ki.dwFlags = input[3].ki.dwFlags = KEYEVENTF_KEYUP;</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">input[0].ki.time = input[1].ki.time = input[2].ki.time = input[3].ki.time = GetTickCount();</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">SendInput(4, input, sizeof(INPUT));</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">感觉比那个有点啰嗦。</span></p> 
<h3 style="margin-left:0cm;"><span style="color:#0000FF;">WIN键部分快捷键</span></h3> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">WIN</span><span style="color:#0000FF;">键</span><span style="color:#0000FF;">+D=</span><span style="color:#0000FF;">快速的切到桌面，再次点击返回；</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">WIN</span><span style="color:#0000FF;">键</span><span style="color:#0000FF;">+E=</span><span style="color:#0000FF;">快速打开资源管理器；</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">WIN</span><span style="color:#0000FF;">键</span><span style="color:#0000FF;">+R=“</span><span style="color:#0000FF;">运行</span><span style="color:#0000FF;">”</span><span style="color:#0000FF;">；</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">WIN</span><span style="color:#0000FF;">键</span><span style="color:#0000FF;">+M=</span><span style="color:#0000FF;">全部视窗最小化；</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">WIN</span><span style="color:#0000FF;">键</span><span style="color:#0000FF;">+Shift+M=</span><span style="color:#0000FF;">取消全部视窗最小化；</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">WIN</span><span style="color:#0000FF;">键</span><span style="color:#0000FF;">+F1=Help</span><span style="color:#0000FF;">；</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">WIN</span><span style="color:#0000FF;">键</span><span style="color:#0000FF;">+F=</span><span style="color:#0000FF;">“寻找”；</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">WIN</span><span style="color:#0000FF;">键</span><span style="color:#0000FF;">+Ctrl+F=</span><span style="color:#0000FF;">显示“查找电脑”；</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">WIN</span><span style="color:#0000FF;">键</span><span style="color:#0000FF;">+Tab=</span><span style="color:#0000FF;">切换工作列的程式；</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">WIN</span><span style="color:#0000FF;">键</span><span style="color:#0000FF;">+Break=</span><span style="color:#0000FF;">显示系统内容。</span></p> 
<h3 style="margin-left:0cm;"><span style="color:#0000FF;">SendMessage、PostMessage、keybd_event区别</span></h3> 
<p style="margin-left:0cm;"><span style="color:#000000;">首先你会发现</span><span style="color:#000000;">keybd_event</span><span style="color:#000000;">函数中是没有窗口句柄作为参数的，那是因为</span><span style="color:#000000;">keybd_event</span><span style="color:#000000;">是全局模拟按键的，只对前台窗口（即当前的活动窗口）才可以，但是如果模拟的按键正好也是某个窗口的全局热键消息，那该窗口也能接收到的。</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">而</span><span style="color:#000000;">SendMessage</span><span style="color:#000000;">、</span><span style="color:#000000;">PostMessage</span><span style="color:#000000;">是对指定句柄窗口都起作用的，对于做一些外挂是非常有用的。例如可以做成这样的效果：即用</span><span style="color:#000000;">SendMessage/PostMessage</span><span style="color:#000000;">在某一个窗口模拟动作，而同时自己可以在其他窗口做其他事情，互不影响！</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">但是有一点要注意，很多人在模拟键盘消息的时候，都会忘记模拟</span><span style="color:#000000;">WM_KEYUP</span><span style="color:#000000;">的消息。</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">还有一点就是</span><span style="color:#000000;">PostMessage</span><span style="color:#000000;">中的窗口句柄参数，可以设置为</span><span style="color:#000000;">HWND_BROADCAST</span><span style="color:#000000;">，即广播，但不要理所当然地认为是对所有的窗口都起作用。它只对系统的顶层窗口起作用，子窗口是收不到这个消息的！</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">还要注意的是</span><span style="color:#000000;">SendMessage</span><span style="color:#000000;">是没有</span><span style="color:#000000;">HWND_BROADCAST</span><span style="color:#000000;">参数的，那是因为，</span><span style="color:#000000;">SendMessage</span><span style="color:#000000;">总是等发送的消息在对应的窗口消息队列中处理完毕后才返回的（这是一种负责的行为），细想一下就知道为什么</span><span style="color:#000000;">SendMessage</span><span style="color:#000000;">没有</span><span style="color:#000000;">HWND_BROADCAST</span><span style="color:#000000;">参数了！</span></p> 
<p style="margin-left:0cm;"><span style="color:#000000;">个人认为：</span></p> 
<ol><li><span style="color:#000000;">当需要模拟键盘输入命令时，比如</span><span style="color:#000000;">Ctrl + V</span><span style="color:#000000;">，选择</span><span style="color:#000000;">keybd_event</span><span style="color:#000000;">；</span></li><li><span style="color:#000000;">当需要模拟键盘输入一串字符时，选择</span><span style="color:#000000;">PostKeybdMessage</span><span style="color:#000000;">；</span></li><li><span style="color:#000000;">当需要模拟键盘输入单个字符时，选择</span><span style="color:#000000;">keybd_event</span><span style="color:#000000;">。</span></li></ol> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">// </span><span style="color:#0000FF;">实例</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">SendMessage(Button.Handle, WM_LBUTTONDOWN, 0, 0);   //</span><span style="color:#0000FF;">鼠标左键按下</span> </p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">SendMessage(Button.Handle, WM_LBUTTONUP, 0, 0);   //</span><span style="color:#0000FF;">鼠标左键抬起</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">SendMessage(Edit.Handle, WM_SETTEXT, 255, Integer(PChar('abc')));   //</span><span style="color:#0000FF;">传递文本</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">SendMessage(Edit.Handle, WM_Char, Wparam('Q'), 2);   // </span><span style="color:#0000FF;">传递字符</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">SendMessage(Button.Handle, BM_SETSTYLE, BS_RADIOBUTTON, 1);   //</span><span style="color:#0000FF;">改变</span><span style="color:#0000FF;">Button</span><span style="color:#0000FF;">风格</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">SendMessage(ComboBox.Handle, CB_SETDROPPEDWIDTH, 300, 0);   //</span><span style="color:#0000FF;">改变</span><span style="color:#0000FF;">CBDownWidth</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">WM_CUT</span><span style="color:#0000FF;">、</span><span style="color:#0000FF;">WM_COPY</span><span style="color:#0000FF;">和</span><span style="color:#0000FF;">WM_PASTE</span><span style="color:#0000FF;">剪切，复制，粘帖</span> </p> 
<p style="margin-left:0cm;"><strong><span style="color:#000000;">实现任意组合键：</span></strong></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_Control, MapVirtualKey(VK_Control, 0), 0, 0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(ord('V'), MapVirtualKey(ord('V'), 0), 0, 0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(ord('V'), MapVirtualKey(ord('V'), 0), KEYEVENTF_KEYUP, 0); </span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_Control, MapVirtualKey(VK_Control, 0), KEYEVENTF_KEYUP, 0);</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#000000;">模拟鼠标按下事件：</span></strong></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">::PostMessage(hwd0,WM_MOUSEMOVE, MK_LBUTTON, MAKELONG(x,y));</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">::PostMessage(hwd0,WM_LBUTTONDOWN,MK_LBUTTON,MAKELPARAM(x,y));</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">::PostMessage(hwd0,WM_LBUTTONUP,MK_LBUTTON,MAKELPARAM(x,y));</span></p> 
<p style="margin-left:0cm;"><strong><span style="color:#000000;">模拟键盘按下事件</span></strong></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_TAB,0,0,0);</span></p> 
<p style="margin-left:0cm;"><span style="color:#0000FF;">keybd_event(VK_TAB,0,KEYEVENTF_KEYUP,0);</span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a1dd4a7c6ad1b30db09d89006e4ca754/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">js将图片转换为base64</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b33e8d904a9f0b1c2dcaccb5a334e053/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SecurityUtils.getSubject().getPrincipal() 为null</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>