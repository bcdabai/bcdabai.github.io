<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Git中的submodule操作 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Git中的submodule操作" />
<meta property="og:description" content="环境 windows 10 64-bit
github
前言 子模块( submodule )是一个内嵌在 git 仓库(父工程)中的 git 仓库，有点儿拗口。通过子模块，可以将外部的仓库作为子目录放到自己的仓库中，既能方便的管理依赖，又可以保持依赖本身的独立性。
子模块将被记录在一个名叫 .gitmodules 的文件中，其中会记录子模块的相关信息
[submodule &#34;module_name&#34;] # 子模块的名称 path = file_path # 子模块在本仓库中文件的存储路径 url = repo_url # 子模块的远程仓库地址 前文我们介绍 基于YOLOv5和DeepSort的目标跟踪 时，它的代码仓库就是把 yolov5 作为子目录来进行管理
实践 本文在 github 平台上进行操作，其它基于 git 的管理平台也是类似的
新建项目
在 github 上创建一个新项目 gitDemo
git submodule 然后，将上面创建好的项目克隆到本地
git clone https://github.com/xugaoxiang/gitDemo.git git submodule 添加子模块
现在开始来添加子模块，这里以 yolov5 为例，将其作为子模块放在 gitDemo 项目里
git submodule add https://github.com/ultralytics/yolov5.git git submodule 这时候的目录结构是这样的
git submodule 通过 git status 查看当前状态" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/fd0eca54b812baee9e749749ec06fd1e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-18T07:00:00+08:00" />
<meta property="article:modified_time" content="2021-09-18T07:00:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Git中的submodule操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <h3>环境</h3> 
 <ul><li><p>windows 10 64-bit</p></li><li><p>github</p></li></ul> 
 <h3>前言</h3> 
 <p>子模块( <code>submodule</code> )是一个内嵌在 <code>git</code> 仓库(父工程)中的 <code>git</code> 仓库，有点儿拗口。通过子模块，可以将外部的仓库作为子目录放到自己的仓库中，既能方便的管理依赖，又可以保持依赖本身的独立性。</p> 
 <p>子模块将被记录在一个名叫 <code>.gitmodules</code> 的文件中，其中会记录子模块的相关信息</p> 
 <pre class="has"><code class="language-go">[submodule "module_name"]      # 子模块的名称
path = file_path               # 子模块在本仓库中文件的存储路径
url = repo_url                 # 子模块的远程仓库地址</code></pre> 
 <p>前文我们介绍 基于YOLOv5和DeepSort的目标跟踪 时，它的代码仓库就是把 <code>yolov5</code> 作为子目录来进行管理</p> 
 <h3>实践</h3> 
 <p>本文在 <code>github</code> 平台上进行操作，其它基于 <code>git</code> 的管理平台也是类似的</p> 
 <p><strong>新建项目</strong></p> 
 <p>在 <code>github</code> 上创建一个新项目 <code>gitDemo</code></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/ef/2f/Yq4XNkfX_o.png" alt="b7ea17408142d0b0c1057f2c3e830b97.png"></p> 
 <figcaption>
   git submodule 
 </figcaption> 
 <p>然后，将上面创建好的项目克隆到本地</p> 
 <pre class="has"><code class="language-go">git clone https://github.com/xugaoxiang/gitDemo.git</code></pre> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/71/f6/Xaw3uJf4_o.png" alt="4769eca31d42a8700c80db77d0434534.png"></p> 
 <figcaption>
   git submodule 
 </figcaption> 
 <p><strong>添加子模块</strong></p> 
 <p>现在开始来添加子模块，这里以 <code>yolov5</code> 为例，将其作为子模块放在 <code>gitDemo</code> 项目里</p> 
 <pre class="has"><code class="language-go">git submodule add https://github.com/ultralytics/yolov5.git</code></pre> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/5a/9f/jhxgAyeu_o.png" alt="7b76550a99297ab791dec1c715284e0d.png"></p> 
 <figcaption>
   git submodule 
 </figcaption> 
 <p>这时候的目录结构是这样的</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/79/60/YXcHRX6V_o.png" alt="09e60aaff4a78f188dff7e1cdaa8cfb5.png"></p> 
 <figcaption>
   git submodule 
 </figcaption> 
 <p>通过 <code>git status</code> 查看当前状态</p> 
 <pre class="has"><code class="language-go">(base) PS C:\Users\Administrator\Desktop\gitDemo&gt; git status
On branch main
Your branch is up to date with 'origin/main'.

Changes to be committed:
  (use "git reset HEAD &lt;file&gt;..." to unstage)

        new file:   .gitmodules
        new file:   yolov5</code></pre> 
 <p>可以项目目录下多了个文件 <code>.gitmodules</code> , 这个文件是用来保存子模块的信息，子模块是 <code>yolov5</code></p> 
 <p>通过 <code>git submodule</code> 查看子模块</p> 
 <pre class="has"><code class="language-go">(base) PS C:\Users\Administrator\Desktop\gitDemo&gt; git submodule
 27a4736e968158063a87024be74534a560fc8e84 yolov5 (v5.0-438-g27a4736)</code></pre> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/59/09/l0ItGbuX_o.png" alt="d26067f0c3f171cea9ea45217940f550.png"></p> 
 <figcaption>
   git submodule 
 </figcaption> 
 <p>可以看到添加到 <code>gitDemo</code> 项目中的 <code>yolov5</code> 提交版本号是 <code>621b6d5ba80707ca98242dd7c71d738e5594b41e</code></p> 
 <p>这时候就可以将子模块提交到 <code>gitDemo</code> 中去了</p> 
 <pre class="has"><code class="language-go">(base) PS C:\Users\Administrator\Desktop\gitDemo&gt; git commit -m "add submodule yolov5"
[main 739f379] add submodule yolov5
 2 files changed, 4 insertions(+)
 create mode 100644 .gitmodules
 create mode 160000 yolov5</code></pre> 
 <p>然后就可以开始推送了</p> 
 <pre class="has"><code class="language-go">git push origin main</code></pre> 
 <p>完成后，就可以看到了 <code>gitDemo</code> 下的 <code>yolov5</code> 子模块了，这个子模块有点像超链接，点击后就直接进入了原版的 <code>yolov5</code> 了</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/ac/69/5C3qfRo4_o.png" alt="a6ae86ef8b426351ef304f2df3a0f859.png"></p> 
 <figcaption>
   git submodule 
 </figcaption> 
 <p><strong>克隆带有子模块的工程</strong></p> 
 <p>克隆项目后，子模块目录默认是空的，需要我们在项目根目录下执行如下命令完成子模块的下载</p> 
 <pre class="has"><code class="language-go">git submodule init
git submodule update</code></pre> 
 <p>或者</p> 
 <pre class="has"><code class="language-go">git submodule update --init --recursive</code></pre> 
 <p>上面的方法，步骤繁多，比较麻烦，不推荐。可以直接在克隆的时候一起下载子模块，一气呵成，命令如下</p> 
 <pre class="has"><code class="language-go">git clone https://github.com/xugaoxiang/gitDemo.git --recursive</code></pre> 
 <p><strong>更新子模块</strong></p> 
 <p>一般来说，子模块是不断在维护更新的，在我们自己的项目里，一般不会去改动子模块。但是如果想保持本地子项目与远程仓库版本一致，就需要去更新子模块至远程仓库的最新版</p> 
 <pre class="has"><code class="language-go">git submodule update --remote</code></pre> 
 <p>需要注意的是，命令 <code>git submodule update</code> 是更新项目内子模块到最新版本</p> 
 <p><strong>删除子模块</strong></p> 
 <p>如果不再依赖子模块了，就可以将其删除了，步骤如下</p> 
 <pre class="has"><code class="language-go"># 删除子目录
git rm yolov5</code></pre> 
 <p>然后修改 <code>.gitmodules</code> 将其中跟子模块相关的删除，如果是最后一个子模块的话，可以直接删除文件 <code>.gitmodules</code></p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/38/36/U8JgPMpv_o.png" alt="19d275159a18df67dbd76b497d6baa53.png"></p> 
 <figcaption>
   git submodule 
 </figcaption> 
 <p>接着修改 <code>.git/config</code>，同样将对应子模块的信息删除</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/86/d0/QoFRk2R9_o.png" alt="99ef7a9095e9caefda1c211ae27a4c1d.png"></p> 
 <figcaption>
   git submodule 
 </figcaption> 
 <p>接下来，删除 <code>.git</code> 文件夹中的相关子模块文件，如这里的 <code>yolov5</code></p> 
 <p>最后就可以<code>git commit</code> 和 <code>git push</code> 了</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d63d675135356e8569340c825f1cf736/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">大型数据库（1）--- Hive安装与配置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b93e5ea9554d37686c5edacb5e8a5bb3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">炸裂，pandas实现列转行的几个实用技巧</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>