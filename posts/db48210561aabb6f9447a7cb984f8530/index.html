<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>php 结构体_HashTable结构讲解，据说是PHP的灵魂 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="php 结构体_HashTable结构讲解，据说是PHP的灵魂" />
<meta property="og:description" content=" 说 HashTable 是PHP的灵魂，一点也不为过。在Zend引擎中，比如变量表、常量表、函数表、数组，以及资源管理、线程安全等，其实现都有HashTable的身影。HashTable 是一种查找性能极高的数据结构，理想情况下其算法复杂度是O(1)。
PHP 源码信息
PHP 版本：php-5.6.17头文件: Zend/zend_hash.h,源文件: Zend/zend_hash.c注意：说明中使用了伪代码形式，只有代码块中的代码才可以执行 PHP HashTable 概述
有两部分组成，Bucket 和 HashTable，而且均为结构体(struct)。Bucket 是存储数据的单元，用于保存具体的数据内容；HashTable 用于保存整个哈希表需要的基本信息。二者关系可以简单理解为：HashTable = Array(); HashTable[&#39;arBuckets&#39;] = [Bucket1, Bucket2, Bucket3, …]。HashTable 的目的就是通过索引把每个Bucket元素分散到唯一的位置。PHP 内核通过HashTable 结构管理Bucket 数组。相比普通HashTable，PHP的HashTable同时维护一个双向链表。在HashTable.arBuckets 存储的是包含多个Bucket指针的向量，每个指针又指向一个双向链表(多个bucket组成)。 HashTable 源码展示
在Zend/zend_hash.h的line 55~83 中定义了结构体 Bucket 和 HashTable。注意 Bucket 和 HashTable 是别名，分别对应结构体 bucket 和 _hashtable。
Bucket 解析说明
先分析一下Bucket 结构体成员变量的作用：
说明
一. pData 和 pDataPtr 的关系，
pData 指向的是保存数据的内存块地址，一般通过malloc等分配;pDataPtr 如果是指针数据，此值会指向真正的value，同时pData 会指向该值疑问 内存块地址，不也是指针吗？和pDataPtr什么区别？？ 二. h 成员保存的是HashTable key 哈希后的值，而非HashTable中的索引值，为什么？
索引值和HashTable的容量有关系，如果HashTable扩容，那么这些索引还得重新进行哈希，再进行索引映射数字索引直接就可以作为哈希表的索引，数字也无需进行哈希处理HashTable 解析说明 " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/db48210561aabb6f9447a7cb984f8530/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-06T15:37:01+08:00" />
<meta property="article:modified_time" content="2020-12-06T15:37:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">php 结构体_HashTable结构讲解，据说是PHP的灵魂</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p class="ql-align-justify">说 HashTable 是PHP的灵魂，一点也不为过。在Zend引擎中，比如变量表、常量表、函数表、数组，以及资源管理、线程安全等，其实现都有HashTable的身影。HashTable 是一种查找性能极高的数据结构，理想情况下其算法复杂度是O(1)。</p> 
 <p class="ql-align-justify"><strong>PHP 源码信息</strong></p> 
 <ul><li class="ql-align-justify">PHP 版本：php-5.6.17</li><li class="ql-align-justify">头文件: Zend/zend_hash.h,</li><li class="ql-align-justify">源文件: Zend/zend_hash.c</li><li class="ql-align-justify">注意：说明中使用了伪代码形式，只有代码块中的代码才可以执行</li></ul> 
 <p class="ql-align-justify"><strong>PHP HashTable 概述</strong></p> 
 <ul><li class="ql-align-justify">有两部分组成，Bucket 和 HashTable，而且均为结构体(struct)。</li><li class="ql-align-justify">Bucket 是存储数据的单元，用于保存具体的数据内容；HashTable 用于保存整个哈希表需要的基本信息。</li><li class="ql-align-justify">二者关系可以简单理解为：HashTable = Array(); HashTable['arBuckets'] = [Bucket1, Bucket2, Bucket3, …]。</li><li class="ql-align-justify">HashTable 的目的就是通过索引把每个Bucket元素分散到唯一的位置。</li><li class="ql-align-justify">PHP 内核通过HashTable 结构管理Bucket 数组。</li><li class="ql-align-justify">相比普通HashTable，PHP的HashTable同时维护一个双向链表。在HashTable.arBuckets 存储的是包含多个Bucket指针的向量，每个指针又指向一个双向链表(多个bucket组成)。</li></ul> 
 <p class="ql-align-justify"><strong>HashTable 源码展示</strong></p> 
 <p class="ql-align-justify">在Zend/zend_hash.h的line 55~83 中定义了结构体 Bucket 和 HashTable。注意 Bucket 和 HashTable 是别名，分别对应结构体 bucket 和 _hashtable。</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/1a/25/lmapgIC6_o.png" alt="96159171656b57ba42e10b6b9b87024d.png"> 
 </div> 
 <p class="ql-align-justify"><strong>Bucket 解析说明</strong></p> 
 <p class="ql-align-justify">先分析一下Bucket 结构体成员变量的作用：</p> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/55/ab/ULLf3AvM_o.png" alt="9a891310a17049397c7f3e7b4033c410.png"> 
 </div> 
 <p class="ql-align-justify"><strong>说明</strong></p> 
 <p class="ql-align-justify">一. pData 和 pDataPtr 的关系，</p> 
 <ul><li class="ql-align-justify">pData 指向的是保存数据的内存块地址，一般通过malloc等分配;</li><li class="ql-align-justify">pDataPtr 如果是指针数据，此值会指向真正的value，同时pData 会指向该值</li><li class="ql-align-justify">疑问 内存块地址，不也是指针吗？和pDataPtr什么区别？？</li></ul> 
 <p class="ql-align-justify">二. h 成员保存的是HashTable key 哈希后的值，而非HashTable中的索引值，为什么？</p> 
 <ul><li class="ql-align-justify">索引值和HashTable的容量有关系，如果HashTable扩容，那么这些索引还得重新进行哈希，再进行索引映射</li><li class="ql-align-justify">数字索引直接就可以作为哈希表的索引，数字也无需进行哈希处理</li><li class="ql-align-justify">HashTable 解析说明</li></ul> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/21/76/LttOR37y_o.png" alt="94873148b12ee9417f1bb1833e7c9ce0.png"> 
 </div> 
 <div class="pgc-img"> 
  <img src="https://images2.imgbox.com/59/96/s0Ge8tgM_o.png" alt="95aef8526fa74545e9e0fdb3b34230ac.png"> 
 </div> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f94d4b551f472f15e9477eb3d77acf09/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【git】解决ssh: connect to host ssh.github.com port 22: Connection timed out的问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0825ea9fcab3c0358cbd2f934a89a30a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">IDEA-SpringBoot项目利用docker实现一键打包部署运行</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>