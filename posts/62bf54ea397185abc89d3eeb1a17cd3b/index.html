<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>spring @Scheduled实现定时任务 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="spring @Scheduled实现定时任务" />
<meta property="og:description" content="转载于：http://blog.csdn.net/prisonbreak_/article/details/49180307 Spring配置文件xmlns加入：
xmlns:task=&#34;http://www.springframework.org/schema/task&#34; xsi:schemaLocation中加入：
http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-3.0.xsd&#34; Spring扫描注解的配置：（如果已经有了，看一下能扫到定时任务类的包么）
&lt;context:component-scan base-package=&#34;com.thinkgem.jeesite&#34;&gt; &lt;!-- base-package 如果多个，用“,”分隔 --&gt; &lt;context:exclude-filter type=&#34;annotation&#34; expression=&#34;org.springframework.stereotype.Controller&#34;/&gt; &lt;!-- 解决事物失效问题：在主容器中不扫描@Controller注解，在SpringMvc中只扫描@Controller注解 --&gt; &lt;/context:component-scan&gt; 任务扫描注解：
&lt;!-- 配置任务线性池 --&gt; &lt;task:executor id=&#34;executor&#34; pool-size=&#34;10&#34;/&gt; &lt;task:scheduler id=&#34;scheduler&#34; pool-size=&#34;10&#34;/&gt; &lt;!-- 启用annotation方式 --&gt; &lt;task:annotation-driven scheduler=&#34;scheduler&#34; executor=&#34;executor&#34; proxy-target-class=&#34;true&#34;/&gt;代码实现： 在类文件上加上注解： @Service //在用在controller时要注意，因为之前配置了context:exclude-filter在主容器中屏蔽了controller注解，所以不走前台请求的话是不能注入此controller的，此时就要使用@component来注入服务。所以建议此时还是将定时任务放到service层比较好。 @Lazy(false)//为了避免spring懒加载造成的定时任务失效，必须加上此注解 在方法上写定时任务配置：
@Scheduled(cron = &#34;0 0 10 * * ?&#34;) public void birthdayReminder() { } 配置规则： 一个cron表达式有至少6个（也可能7个）有空格分隔的时间元素。
按顺序依次为
秒（0~59）
分钟（0~59）
小时（0~23）
天（月）（0~31，但是你需要考虑你月的天数）
月（0~11）
天（星期）（1~7 1=SUN 或 SUN，MON，TUE，WED，THU，FRI，SAT）
7.年份（1970－2099）
其中每个元素可以是一个值(如6),一个连续区间(9-12),一个间隔时间(8-18/4)(/表示每隔4小时),一个列表(1,3,5),通配符。由于”月份中的日期”和”星期中的日期”这两个元素互斥的,必须要对其中一个设置?." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/62bf54ea397185abc89d3eeb1a17cd3b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-02-28T17:46:52+08:00" />
<meta property="article:modified_time" content="2019-02-28T17:46:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">spring @Scheduled实现定时任务</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>转载于：<a href="http://blog.csdn.net/prisonbreak_/article/details/49180307">http://blog.csdn.net/prisonbreak_/article/details/49180307</a> <br> Spring配置文件xmlns加入：</p> 
<pre class="has"><code class="language-java">xmlns:task="http://www.springframework.org/schema/task"</code></pre> 
<ul><li> </li></ul> 
<p>xsi:schemaLocation中加入：</p> 
<pre class="has"><code class="language-java"> http://www.springframework.org/schema/task
 http://www.springframework.org/schema/task/spring-task-3.0.xsd"</code></pre> 
<p>Spring扫描注解的配置：（如果已经有了，看一下能扫到定时任务类的包么）</p> 
<pre class="has"><code class="language-java">&lt;context:component-scan base-package="com.thinkgem.jeesite"&gt;
&lt;!-- base-package 如果多个，用“,”分隔 --&gt;
    &lt;context:exclude-filter type="annotation" expression="org.springframework.stereotype.Controller"/&gt;
&lt;!-- 解决事物失效问题：在主容器中不扫描@Controller注解，在SpringMvc中只扫描@Controller注解 --&gt;
&lt;/context:component-scan&gt;</code></pre> 
<p>任务扫描注解：</p> 
<pre class="has"><code class="language-java">&lt;!-- 配置任务线性池 --&gt;
&lt;task:executor id="executor" pool-size="10"/&gt; 
&lt;task:scheduler id="scheduler" pool-size="10"/&gt;
&lt;!-- 启用annotation方式 --&gt; 
&lt;task:annotation-driven scheduler="scheduler" executor="executor" proxy-target-class="true"/&gt;代码实现： 
</code></pre> 
<pre>在类文件上加上注解：</pre> 
<pre class="has"><code class="language-java">@Service  //在用在controller时要注意，因为之前配置了context:exclude-filter在主容器中屏蔽了controller注解，所以不走前台请求的话是不能注入此controller的，此时就要使用@component来注入服务。所以建议此时还是将定时任务放到service层比较好。
@Lazy(false)//为了避免spring懒加载造成的定时任务失效，必须加上此注解</code></pre> 
<p>在方法上写定时任务配置：</p> 
<pre class="has"><code class="language-java">@Scheduled(cron = "0 0 10 * * ?")
public void birthdayReminder() {
}</code></pre> 
<p>配置规则： <br> 一个cron表达式有至少6个（也可能7个）有空格分隔的时间元素。</p> 
<p>按顺序依次为</p> 
<p>秒（0~59）</p> 
<p>分钟（0~59）</p> 
<p>小时（0~23）</p> 
<p>天（月）（0~31，但是你需要考虑你月的天数）</p> 
<p>月（0~11）</p> 
<p>天（星期）（1~7 1=SUN 或 SUN，MON，TUE，WED，THU，FRI，SAT）</p> 
<p>7.年份（1970－2099）</p> 
<p>其中每个元素可以是一个值(如6),一个连续区间(9-12),一个间隔时间(8-18/4)(/表示每隔4小时),一个列表(1,3,5),通配符。由于”月份中的日期”和”星期中的日期”这两个元素互斥的,必须要对其中一个设置?.</p> 
<p>0 0 10,14,16 * * ? 每天上午10点，下午2点，4点 <br> 0 0/30 9-17 * * ? 朝九晚五工作时间内每半小时 <br> 0 0 12 ? * WED 表示每个星期三中午12点 <br> “0 0 12 * * ?” 每天中午12点触发 <br> “0 15 10 ? * *” 每天上午10:15触发 <br> “0 15 10 * * ?” 每天上午10:15触发 <br> “0 15 10 * * ? *” 每天上午10:15触发 <br> “0 15 10 * * ? 2005” 2005年的每天上午10:15触发 <br> “0 * 14 * * ?” 在每天下午2点到下午2:59期间的每1分钟触发 <br> “0 0/5 14 * * ?” 在每天下午2点到下午2:55期间的每5分钟触发 <br> “0 0/5 14,18 * * ?” 在每天下午2点到2:55期间和下午6点到6:55期间的每5分钟触发 <br> “0 0-5 14 * * ?” 在每天下午2点到下午2:05期间的每1分钟触发 <br> “0 10,44 14 ? 3 WED” 每年三月的星期三的下午2:10和2:44触发 <br> “0 15 10 ? * MON-FRI” 周一至周五的上午10:15触发 <br> “0 15 10 15 * ?” 每月15日上午10:15触发 <br> “0 15 10 L * ?” 每月最后一日的上午10:15触发 <br> “0 15 10 ? * 6L” 每月的最后一个星期五上午10:15触发 <br> “0 15 10 ? * 6L 2002-2005” 2002年至2005年的每月的最后一个星期五上午10:15触发 <br> “0 15 10 ? * 6#3” 每月的第三个星期五上午10:15触发</p> 
<p>有些子表达式能包含一些范围或列表</p> 
<p>例如：子表达式（天（星期））可以为 “MON-FRI”，“MON，WED，FRI”，“MON-WED,SAT”</p> 
<p>“*”字符代表所有可能的值</p> 
<p>因此，“<em>”在子表达式（月）里表示每个月的含义，“</em>”在子表达式（天（星期））表示星期的每一天</p> 
<p>“/”字符用来指定数值的增量</p> 
<p>例如：在子表达式（分钟）里的“0/15”表示从第0分钟开始，每15分钟</p> 
<pre class="has"><code>     在子表达式（分钟）里的“3/20”表示从第3分钟开始，每20分钟（它和“3，23，43”）的含义一样
</code></pre> 
<ul><li>1</li></ul> 
<p>“？”字符仅被用于天（月）和天（星期）两个子表达式，表示不指定值</p> 
<p>当2个子表达式其中之一被指定了值以后，为了避免冲突，需要将另一个子表达式的值设为“？”</p> 
<p>“L” 字符仅被用于天（月）和天（星期）两个子表达式，它是单词“last”的缩写</p> 
<p>但是它在两个子表达式里的含义是不同的。</p> 
<p>在天（月）子表达式中，“L”表示一个月的最后一天</p> 
<p>在天（星期）自表达式中，“L”表示一个星期的最后一天，也就是SAT</p> 
<p>如果在“L”前有具体的内容，它就具有其他的含义了</p> 
<p>例如：“6L”表示这个月的倒数第６天，“ＦＲＩＬ”表示这个月的最一个星期五</p> 
<p>注意：在使用“L”参数时，不要指定列表或范围，因为这会导致问题</p> 
<p>字段 允许值 允许的特殊字符 <br> 秒 0-59 , - * / <br> 分 0-59 , - * / <br> 小时 0-23 , - * / <br> 日期 1-31 , - * ? / L W C <br> 月份 1-12 或者 JAN-DEC , - * / <br> 星期 1-7 或者 SUN-SAT , - * ? / L C # <br> 年（可选） 留空, 1970-2099 , - * /</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e1002cc5888a0ad2df53d9de60741bda/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">分布式事务_三阶段提交(3PC)协议</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8399ca38a4763d52aaad542724666ae1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">数据结构与算法：树与二叉树python实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>