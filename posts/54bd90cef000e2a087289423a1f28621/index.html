<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>记在墨者学院业务逻辑漏洞靶场实战感受 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="记在墨者学院业务逻辑漏洞靶场实战感受" />
<meta property="og:description" content="目录
一、身份认证失效
二、登陆密码重置
三、逻辑漏洞-0元买东西
四、热点评论刷分
一、身份认证失效
漏洞分析
1.什么是身份认证？ 验证用户或者客户端身份的过程，其实就是证明你是你自己
2.身份认证漏洞原理？
1）、身份验证机制无法充分防御暴力攻击。
2）、逻辑缺陷或较差的编码使攻击者可以完全绕过身份验证机制。
3.预防措施
1）、严格的逻辑验证。防止在登录页面，注册页面，密码修改页面等出现逻辑错误
2）、防止暴力破解。登录请求在达到特定限制后进行登录验证
3）、防止用户凭据泄露。账户明文传输可能会导致用户名和密码泄露
靶场实战
靶场环境：身份认证失效漏洞实战_身份认证和会话管理_在线靶场_墨者学院_专注于网络安全人才培养
目标要求：通过代理网站获取目标用户手机号码等信息
思路：打开网站后看见登录框和下面一排用户头像和信息，目标是获取马春生的个人信息，目前只知道测试账户test/test，首先查看该网页源代码寻找信息
可以发现钻石代理为马春生，同时获取到马春生的图片id为20128880316，打开bp，登录test/test账户进行抓包看数据
通过抓到的数据包可以看到test账户的图片ID，然后进行改包，将card_id改成马春生的图片id，重放，发送获取数据
可以在右侧获取到账户和密码，不过密码是加密的，浏览器搜在线解密就可以，然后通过获取到账户密码可以登录到马春生账户，查看个人信息。
二、登陆密码重置（逻辑漏洞）
1）、验证码绕过原理：主要是因为验证码的校验机制是在客户端本地的，也就是可以在本地的源码中可以看到的
2）、预防：1设置多重验证，2进行逻辑清晰组件建设，3验证码只能有一次，用完立即过期
思路：观察第一个页面需要重置171手机号密码，第二个页面中有四个输入表单，未知的是验证码，所以从验证码下手，在一个看说明，即188手机号已经注册，也就是188可以收到验证码，那么可不可以直接用188手机号获取到验证码，然后用来给171重置密码呢？
1.输入188手机号来获取验证码
2.然后将手机号改为171的
3.成功，这里也可以用bp进行抓包 然后将数据包中的181手机号改成171的，同样可以完成操作
三、逻辑漏洞-0元买东西
靶场：PHP逻辑漏洞利用实战(第1题)_安全意识_在线靶场_墨者学院_专注于网络安全人才培养
逻辑漏洞原理：开发者在设计时考虑不周，造成不安全设计，缺乏或无效的控制设计（owasp top10中的不安全设计）
预防措施：1.实施访问控制 2.建立安全的策略 3.加强用户认证 4.使用安全组件
首先登录靶场user：xiaoming | password：123456，登录成功页面如下：
思路：可以观察余额为1，书的价格超出预算，可以拿bp抓包，然后修改书的价格，达成0元购买，观察bi11和bi22参数分别为10 20 ，对应书的价格，将其改为0，然后放行数据包 即可找到key
四、热点评论刷分
靶场地址：热点评论刷分漏洞分析溯源_网络安全_在线靶场_墨者学院_专注于网络安全人才培养
思路：抓取点赞包，放到爆破模块中，在http头中增加一个X-Forwarded-for用于修改IP地址
，IP设置变量，使其IP不断变化爆破，IP一边变化一边发包，达到多次点赞的目的
这里多了个知识点X-Forwarded-for的理解：是一个 HTTP 扩展头部，主要是为了让 Web 服务器获取访问用户的真实 IP 地址。那么，我在对IP地址最后进行改包更改，就可以实现不同ip点击此点赞包的效果，达到增加点赞数量的效果" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/54bd90cef000e2a087289423a1f28621/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-10T00:13:42+08:00" />
<meta property="article:modified_time" content="2023-06-10T00:13:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">记在墨者学院业务逻辑漏洞靶场实战感受</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E5%A4%B1%E6%95%88-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E5%A4%B1%E6%95%88" rel="nofollow">一、身份认证失效</a></p> 
<p id="%E4%BA%8C%E3%80%81%E7%99%BB%E9%99%86%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E7%99%BB%E9%99%86%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE" rel="nofollow">二、登陆密码重置</a></p> 
<p id="%E4%B8%89%E3%80%81%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E-0%E5%85%83%E4%B9%B0%E4%B8%9C%E8%A5%BF-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E-0%E5%85%83%E4%B9%B0%E4%B8%9C%E8%A5%BF" rel="nofollow">三、逻辑漏洞-0元买东西</a></p> 
<p id="%E5%9B%9B%E3%80%81%E7%83%AD%E7%82%B9%E8%AF%84%E8%AE%BA%E5%88%B7%E5%88%86-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81%E7%83%AD%E7%82%B9%E8%AF%84%E8%AE%BA%E5%88%B7%E5%88%86" rel="nofollow">四、热点评论刷分</a></p> 
<p><span style="color:#fe2c24;">一、身份认证失效</span></p> 
<h2></h2> 
<p id="%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90">漏洞分析</p> 
<p><strong>1.什么是身份认证？</strong> </p> 
<p>        验证用户或者客户端身份的过程，其实就是证明你是你自己</p> 
<p><strong>2.身份认证漏洞原理？</strong></p> 
<p id="%C2%A0">1）、身份验证机制无法充分防御暴力攻击。</p> 
<p>2）、逻辑缺陷或较差的编码使攻击者可以完全绕过身份验证机制。</p> 
<p><strong>3.预防措施</strong></p> 
<p>1）、严格的逻辑验证。防止在登录页面，注册页面，密码修改页面等出现逻辑错误</p> 
<p>2）、防止暴力破解。登录请求在达到特定限制后进行登录验证</p> 
<p>3）、防止用户凭据泄露。账户明文传输可能会导致用户名和密码泄露</p> 
<p></p> 
<p id="%E9%9D%B6%E5%9C%BA%E5%AE%9E%E6%88%98"><strong>靶场实战</strong></p> 
<p>靶场环境：<a href="https://www.mozhe.cn/bug/detail/eUM3SktudHdrUVh6eFloU0VERzB4Zz09bW96aGUmozhe" rel="nofollow" title="身份认证失效漏洞实战_身份认证和会话管理_在线靶场_墨者学院_专注于网络安全人才培养">身份认证失效漏洞实战_身份认证和会话管理_在线靶场_墨者学院_专注于网络安全人才培养</a></p> 
<p>目标要求：通过代理网站获取目标用户手机号码等信息</p> 
<p></p> 
<p><img alt="" height="516" src="https://images2.imgbox.com/10/8b/whkIL7yc_o.png" width="722"></p> 
<p>思路：打开网站后看见登录框和下面一排用户头像和信息，目标是获取马春生的个人信息，目前只知道测试账户test/test，首先查看该网页源代码寻找信息</p> 
<p><img alt="" height="297" src="https://images2.imgbox.com/6f/a0/hWIeRAuh_o.png" width="858"></p> 
<p> </p> 
<p>可以发现钻石代理为马春生，同时获取到马春生的图片id为20128880316，打开bp，登录test/test账户进行抓包看数据</p> 
<p><img alt="" height="637" src="https://images2.imgbox.com/e4/98/D5GcHny3_o.png" width="1200"></p> 
<p> 通过抓到的数据包可以看到test账户的图片ID，然后进行改包，将card_id改成马春生的图片id，重放，发送获取数据</p> 
<p><img alt="" height="727" src="https://images2.imgbox.com/be/b9/ph3uleMg_o.png" width="1200"></p> 
<p> 可以在右侧获取到账户和密码，不过密码是加密的，浏览器搜在线解密就可以，然后通过获取到账户密码可以登录到马春生账户，查看个人信息。</p> 
<p></p> 
<p></p> 
<p><span style="color:#fe2c24;"><strong>二、登陆密码重置（逻辑漏洞</strong>）</span></p> 
<p>1）、验证码绕过原理：主要是因为验证码的校验机制是在客户端本地的，也就是可以在本地的源码中可以看到的</p> 
<p>2）、预防：1设置多重验证，2进行逻辑清晰组件建设，3验证码只能有一次，用完立即过期</p> 
<p></p> 
<p><img alt="" height="196" src="https://images2.imgbox.com/9c/59/eN1rz5Ko_o.png" width="478"></p> 
<p><img alt="" height="315" src="https://images2.imgbox.com/84/0b/ApcIrK3H_o.png" width="322"> </p> 
<p> 思路：观察第一个页面需要重置171手机号密码，第二个页面中有四个输入表单，未知的是验证码，所以从验证码下手，在一个看说明，即188手机号已经注册，也就是188可以收到验证码，那么可不可以直接用188手机号获取到验证码，然后用来给171重置密码呢？</p> 
<p> 1.输入188手机号来获取验证码</p> 
<p><img alt="" height="299" src="https://images2.imgbox.com/80/19/u6GCxxbv_o.png" width="249"></p> 
<p>2.然后将手机号改为171的</p> 
<p> <img alt="" height="244" src="https://images2.imgbox.com/95/37/UgeCiQCQ_o.png" width="223"></p> 
<p> 3.成功，这里也可以用bp进行抓包 然后将数据包中的181手机号改成171的，同样可以完成操作</p> 
<p></p> 
<p></p> 
<p>三、逻辑漏洞-0元买东西</p> 
<p>靶场：<a href="https://www.mozhe.cn/bug/detail/RmF2NExLM2E2QnZReGJCQzBoTEdRdz09bW96aGUmozhe" rel="nofollow" title="PHP逻辑漏洞利用实战(第1题)_安全意识_在线靶场_墨者学院_专注于网络安全人才培养">PHP逻辑漏洞利用实战(第1题)_安全意识_在线靶场_墨者学院_专注于网络安全人才培养</a></p> 
<p>逻辑漏洞原理：开发者在设计时考虑不周，造成不安全设计，缺乏或无效的控制设计（owasp top10中的不安全设计）</p> 
<p>预防措施：1.实施访问控制  2.建立安全的策略  3.加强用户认证 4.使用安全组件</p> 
<p></p> 
<p>首先登录靶场user：xiaoming | password：123456，登录成功页面如下：</p> 
<p>思路：可以观察余额为1，书的价格超出预算，可以拿bp抓包，然后修改书的价格，达成0元购买，观察bi11和bi22参数分别为10 20 ，对应书的价格，将其改为0，然后放行数据包 即可找到key</p> 
<p><img alt="" height="359" src="https://images2.imgbox.com/d8/22/oU48l9td_o.png" width="315"></p> 
<p><img alt="" height="182" src="https://images2.imgbox.com/56/ef/cGrgrlHa_o.png" width="512"></p> 
<p></p> 
<p><img alt="" height="231" src="https://images2.imgbox.com/55/74/wXsT4AoR_o.png" width="513"></p> 
<p></p> 
<p>四、热点评论刷分</p> 
<p>靶场地址：<a href="https://www.mozhe.cn/bug/detail/UWRuRTBMWGFIUFN1ZHBwOUNzeGNyQT09bW96aGUmozhe" rel="nofollow" title="热点评论刷分漏洞分析溯源_网络安全_在线靶场_墨者学院_专注于网络安全人才培养">热点评论刷分漏洞分析溯源_网络安全_在线靶场_墨者学院_专注于网络安全人才培养</a></p> 
<p> 思路：抓取点赞包，放到爆破模块中，在http头中增加一个X-Forwarded-for用于修改IP地址</p> 
<p>，IP设置变量，使其IP不断变化爆破，IP一边变化一边发包，达到多次点赞的目的</p> 
<p>这里多了个知识点X-Forwarded-for的理解：是一个 HTTP 扩展头部，主要是为了让 Web 服务器获取访问用户的真实 IP 地址。那么，我在对IP地址最后进行改包更改，就可以实现不同ip点击此点赞包的效果，达到增加点赞数量的效果</p> 
<p><img alt="" height="266" src="https://images2.imgbox.com/89/ab/NbWp3lU8_o.png" width="462"></p> 
<p><img alt="" height="342" src="https://images2.imgbox.com/90/9f/CeUQ8GKm_o.png" width="456"></p> 
<p><img alt="" height="350" src="https://images2.imgbox.com/e2/c1/oDcqSUrE_o.png" width="790"></p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p> </p> 
<p></p> 
<p> </p> 
<p> </p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/034eecf867d627c347dfc5af025b7b66/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JavaScript 类继承</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2b6d6c71df0a5e689532e30bef1feed7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">CSS中的Flex布局常用的属性介绍和使用说明</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>