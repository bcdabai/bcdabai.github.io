<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>防火墙概述及实战 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="防火墙概述及实战" />
<meta property="og:description" content="目录
前言
一、概述
（一）、防火墙分类
（二）、防火墙性能
（三）、iptables
（四）、iptables中表的概念
二、iptables规则匹配条件分类
（一）、基本匹配条件
（二）、显式匹配使用选项及功能
（三）、iptables规则
三、iptables应用
（一）、进行标记，可在LVS调度器中应用
（二）、iptables nat表应用案例
四、什么是防火墙
五、FireWalld防火墙的配置
（一）、Firewalld默认共9个zone
（二）、端口和服务名称的对应关系
总结
前言 防火墙是一种综合性的技术，涉及到计算机网络技术、密码技术、安全技术、软件技术、安全协议、网络标准化组织的安全规范以及安全操作系统等多方面。
一、概述 在计算机领域，防火墙是用于保护信息安全的设备，其会依照用户定义的规则，允许或限制数据的传输。
作用
用于保护内网安全的一种设备
依据规则进行防护
用户定义规则
允许或拒绝外部用户访问
（一）、防火墙分类 逻辑上划分
防火墙可以大体分为主机防火墙和网络防火墙
主机防火墙
针对于单个主机进行防护
网络防火墙
针对网络进行防护，处于网络边缘，防火墙背后是本地局域网网络防火墙主外(服务集体)，主机防火墙主内(服务个人)
物理上划分
防火墙可分为硬件防火墙和软件防火墙
硬件防火墙
在硬件级别实现防火墙功能，另一部分基于软件实现，其性能高，硬件成本高
软件防火墙
应用软件处理逻辑运行于通用硬件平台之上的防火墙，其性能相较于硬件防火墙低，成本较低，对于
Linux系统已自带，直接使用即可
硬件防火墙定义
硬件防火墙是指把具备配置数据包通过规则的软件嵌入硬件设备中，为网络提供安全防护的硬件设备。多见于网络边缘。
硬件防火墙作用（拓扑图 ups）
硬件防火墙品牌：Juniper、cisco（思科ASA） 、华为、天融信等
软件防火墙定义
软件防火墙是单独使用具备配置数据包通过规则的软件来实现数据包过滤。多见于单主机系统或个人计算机。
硬件防火墙与软件防火墙比较
硬件防火墙有独立的硬件设备，运算效率较高，价格略高，可为计算机网络提供安全防护。
软件防火墙必须部署在主机系统之上，相较于硬件防火墙运算效率低，在一定程度上会影响到主机系统性能，一般用 于单机系统或个人计算机中，不直接用于计算机网络中。
Web应用防火墙(WAF)
Web应用防火墙是对web防护(网页保护)的安全防护设备(软件)，主要用于截获所有HTTP数据或仅仅满足某些规则的 会话。多见于云平台中。
（二）、防火墙性能 吞吐量
并发连接
新建连接
时延
抖动
（三）、iptables iptables是什么？
iptables不是防火墙，是防火墙用户代理用于把用户的安全设置添加到“安全框架”中 “安全框架”是防火墙，“安全框架”的名称为netﬁlter。
netﬁlter位于内核空间中，是Linux操作系统核心层内部的一个数据包处理模块iptables是用于在用户空间对内核空间的netﬁlter进行操作的命令行工具。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/25372b4594789a5c403db75f4072ab95/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-14T11:34:02+08:00" />
<meta property="article:modified_time" content="2023-09-14T11:34:02+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">防火墙概述及实战</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">前言</a></p> 
<p id="%E4%B8%80%E3%80%81%E6%A6%82%E8%BF%B0-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E6%A6%82%E8%BF%B0" rel="nofollow">一、概述</a></p> 
<p id="%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81%E9%98%B2%E7%81%AB%E5%A2%99%E5%88%86%E7%B1%BB-toc" style="margin-left:40px;"><a href="#%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81%E9%98%B2%E7%81%AB%E5%A2%99%E5%88%86%E7%B1%BB" rel="nofollow">（一）、防火墙分类</a></p> 
<p id="%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81%E9%98%B2%E7%81%AB%E5%A2%99%E6%80%A7%E8%83%BD-toc" style="margin-left:40px;"><a href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81%E9%98%B2%E7%81%AB%E5%A2%99%E6%80%A7%E8%83%BD" rel="nofollow">（二）、防火墙性能</a></p> 
<p id="%EF%BC%88%E4%B8%89%EF%BC%89%E3%80%81iptables-toc" style="margin-left:40px;"><a href="#%EF%BC%88%E4%B8%89%EF%BC%89%E3%80%81iptables" rel="nofollow">（三）、iptables</a></p> 
<p id="%EF%BC%88%E5%9B%9B%EF%BC%89%E3%80%81iptables%E4%B8%AD%E8%A1%A8%E7%9A%84%E6%A6%82%E5%BF%B5-toc" style="margin-left:40px;"><a href="#%EF%BC%88%E5%9B%9B%EF%BC%89%E3%80%81iptables%E4%B8%AD%E8%A1%A8%E7%9A%84%E6%A6%82%E5%BF%B5" rel="nofollow">（四）、iptables中表的概念</a></p> 
<p id="%E4%BA%8C%E3%80%81iptables%E8%A7%84%E5%88%99%E5%8C%B9%E9%85%8D%E6%9D%A1%E4%BB%B6%E5%88%86%E7%B1%BB-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81iptables%E8%A7%84%E5%88%99%E5%8C%B9%E9%85%8D%E6%9D%A1%E4%BB%B6%E5%88%86%E7%B1%BB" rel="nofollow">二、iptables规则匹配条件分类</a></p> 
<p id="%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81%E5%9F%BA%E6%9C%AC%E5%8C%B9%E9%85%8D%E6%9D%A1%E4%BB%B6-toc" style="margin-left:40px;"><a href="#%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81%E5%9F%BA%E6%9C%AC%E5%8C%B9%E9%85%8D%E6%9D%A1%E4%BB%B6" rel="nofollow">（一）、基本匹配条件</a></p> 
<p id="%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81%E6%98%BE%E5%BC%8F%E5%8C%B9%E9%85%8D%E4%BD%BF%E7%94%A8%E9%80%89%E9%A1%B9%E5%8F%8A%E5%8A%9F%E8%83%BD-toc" style="margin-left:40px;"><a href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81%E6%98%BE%E5%BC%8F%E5%8C%B9%E9%85%8D%E4%BD%BF%E7%94%A8%E9%80%89%E9%A1%B9%E5%8F%8A%E5%8A%9F%E8%83%BD" rel="nofollow">（二）、显式匹配使用选项及功能</a></p> 
<p id="%EF%BC%88%E4%B8%89%EF%BC%89%E3%80%81iptables%E8%A7%84%E5%88%99-toc" style="margin-left:40px;"><a href="#%EF%BC%88%E4%B8%89%EF%BC%89%E3%80%81iptables%E8%A7%84%E5%88%99" rel="nofollow">（三）、iptables规则</a></p> 
<p id="%E4%B8%89%E3%80%81iptables%E5%BA%94%E7%94%A8-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81iptables%E5%BA%94%E7%94%A8" rel="nofollow">三、iptables应用</a></p> 
<p id="%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81%E8%BF%9B%E8%A1%8C%E6%A0%87%E8%AE%B0%EF%BC%8C%E5%8F%AF%E5%9C%A8LVS%E8%B0%83%E5%BA%A6%E5%99%A8%E4%B8%AD%E5%BA%94%E7%94%A8-toc" style="margin-left:40px;"><a href="#%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81%E8%BF%9B%E8%A1%8C%E6%A0%87%E8%AE%B0%EF%BC%8C%E5%8F%AF%E5%9C%A8LVS%E8%B0%83%E5%BA%A6%E5%99%A8%E4%B8%AD%E5%BA%94%E7%94%A8" rel="nofollow">（一）、进行标记，可在LVS调度器中应用</a></p> 
<p id="%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81iptables%20nat%E8%A1%A8%E5%BA%94%E7%94%A8%E6%A1%88%E4%BE%8B-toc" style="margin-left:40px;"><a href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81iptables%20nat%E8%A1%A8%E5%BA%94%E7%94%A8%E6%A1%88%E4%BE%8B" rel="nofollow">（二）、iptables nat表应用案例</a></p> 
<p id="%E5%9B%9B%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E9%98%B2%E7%81%AB%E5%A2%99-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E9%98%B2%E7%81%AB%E5%A2%99" rel="nofollow">四、什么是防火墙</a></p> 
<p id="%E4%BA%94%E3%80%81FireWalld%E9%98%B2%E7%81%AB%E5%A2%99%E7%9A%84%E9%85%8D%E7%BD%AE-toc" style="margin-left:0px;"><a href="#%E4%BA%94%E3%80%81FireWalld%E9%98%B2%E7%81%AB%E5%A2%99%E7%9A%84%E9%85%8D%E7%BD%AE" rel="nofollow">五、FireWalld防火墙的配置</a></p> 
<p id="%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81Firewalld%E9%BB%98%E8%AE%A4%E5%85%B19%E4%B8%AAzone-toc" style="margin-left:40px;"><a href="#%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81Firewalld%E9%BB%98%E8%AE%A4%E5%85%B19%E4%B8%AAzone" rel="nofollow">（一）、Firewalld默认共9个zone</a></p> 
<p id="%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81%E7%AB%AF%E5%8F%A3%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%90%8D%E7%A7%B0%E7%9A%84%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB-toc" style="margin-left:40px;"><a href="#%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81%E7%AB%AF%E5%8F%A3%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%90%8D%E7%A7%B0%E7%9A%84%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB" rel="nofollow">（二）、端口和服务名称的对应关系</a></p> 
<p id="%E6%80%BB%E7%BB%93-toc" style="margin-left:0px;"><a href="#%E6%80%BB%E7%BB%93" rel="nofollow">总结</a></p> 
<hr id="hr-toc"> 
<p></p> 
<hr> 
<p></p> 
<hr> 
<h2 id="%E5%89%8D%E8%A8%80"><a id="_7"></a>前言</h2> 
<p>防火墙是一种综合性的技术，涉及到计算机网络技术、密码技术、安全技术、软件技术、安全协议、网络标准化组织的安全规范以及安全操作系统等多方面。</p> 
<p></p> 
<h2 id="%E4%B8%80%E3%80%81%E6%A6%82%E8%BF%B0"><a id="pandas_16"></a>一、概述</h2> 
<p><span style="color:#333333;">在计算机领域，防火墙是用于保护信息安全的设备，其会依照用户定义的规则，允许或限制数据的传输。</span></p> 
<p><img alt="" height="241" src="https://images2.imgbox.com/de/fc/RQNAgzeZ_o.png" width="552"></p> 
<p><strong><span style="color:#fe2c24;">作用</span></strong></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">用于保护内网安全的一种设备</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">依据规则进行防护</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">用户定义规则</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">允许或拒绝外部用户访问</span></p> 
<h3 id="%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81%E9%98%B2%E7%81%AB%E5%A2%99%E5%88%86%E7%B1%BB" style="background-color:transparent;">（一）、<strong><strong><span style="color:#333333;"><strong>防火墙分类</strong></span></strong></strong></h3> 
<table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><td style="width:99px;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;">逻辑上划分</span></p> </td><td style="width:399px;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">防火墙可以大体分为主机防火墙和网络防火墙</span></p> </td></tr><tr><td style="width:99px;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">主机防火墙</span></p> </td><td style="width:399px;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">针对于单个主机进行防护</span></p> </td></tr><tr><td style="width:99px;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">网络防火墙</span></p> </td><td style="width:399px;"> <p style="margin-left:.0001pt;"><span style="color:#333333;">针对网络进行防护，处于网络边缘，防火墙背后是本地局域网</span><span style="color:#333333;">网络防火墙主外</span><span style="color:#333333;">(</span><span style="color:#333333;">服务集体</span><span style="color:#333333;">)</span><span style="color:#333333;">，主机防火墙主内</span><span style="color:#333333;">(</span><span style="color:#333333;">服务个人</span><span style="color:#333333;">)</span></p> </td></tr><tr><td style="width:99px;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;">物理上划分</span></p> </td><td style="width:399px;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">防火墙可分为硬件防火墙和软件防火墙</span></p> </td></tr><tr><td style="width:99px;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">硬件防火墙</span></p> </td><td style="width:399px;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">在硬件级别实现防火墙功能，另一部分基于软件实现，其性能高，硬件成本高</span></p> </td></tr><tr><td style="width:99px;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">软件防火墙</span></p> </td><td style="width:399px;"> <p style="margin-left:.0001pt;"><span style="color:#333333;">应用软件处理逻辑运行于通用硬件平台之上的防火墙，其性能相较于硬件防火墙低，成本较低，对于</span></p> <p style="margin-left:.0001pt;"><span style="color:#333333;">Linux</span><span style="color:#333333;">系统已自带，直接使用即可</span></p> </td></tr></tbody></table> 
<p><span style="color:#956fe7;"><strong><strong><strong>硬件防火墙定义</strong></strong></strong></span></p> 
<p><span style="color:#333333;">硬件防火墙是指把具备配置数据包通过规则的软件嵌入硬件设备中，为网络提供安全防护的硬件设备。多见于网络边</span><span style="color:#333333;">缘。</span></p> 
<p><strong><span style="color:#956fe7;">硬件防火墙作用（拓扑图 ups）</span></strong></p> 
<p><img alt="" height="444" src="https://images2.imgbox.com/ed/a9/3tmBk6yK_o.png" width="703"></p> 
<p style="margin-left:.0001pt;"><span style="color:#956fe7;"><strong>硬件防火墙品牌</strong></span><strong>：</strong><span style="color:#333333;">Juniper、cisco（思科</span><span style="color:#333333;">ASA） 、华为、天融信等</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#956fe7;"><strong><strong><strong>软件防火墙定义</strong></strong></strong></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">软件防火墙是单独使用具备配置数据包通过规则的软件来实现数据包过滤。多见于单主机系统或个人计算机。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#956fe7;">硬件防火墙与软件防火墙比较</span></strong></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">硬件防火墙有独立的硬件设备，运算效率较高，价格略高，可为计算机网络提供安全防护。</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">软件防火墙必须部署在主机系统之上，相较于硬件防火墙运算效率低，在一定程度上会影响到主机系统性能，一般用   </span><span style="color:#333333;">于单机系统或个人计算机中，不直接用于计算机网络中。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#956fe7;">Web应用防火墙(WAF)</span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">Web</span><span style="color:#333333;">应用防火墙是对</span><span style="color:#333333;">web</span><span style="color:#333333;">防护</span><span style="color:#333333;">(</span><span style="color:#333333;">网页保护</span><span style="color:#333333;">)</span><span style="color:#333333;">的安全防护设备</span><span style="color:#333333;">(</span><span style="color:#333333;">软件</span><span style="color:#333333;">)</span><span style="color:#333333;">，主要用于截获所有</span><span style="color:#333333;">HTTP</span><span style="color:#333333;">数据或仅仅满足某些规则的   </span><span style="color:#333333;">会话。多见于云平台中。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="285" src="https://images2.imgbox.com/14/22/HJAcqZ1A_o.png" width="722"></p> 
<h3 id="%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81%E9%98%B2%E7%81%AB%E5%A2%99%E6%80%A7%E8%83%BD" style="background-color:transparent;margin-left:.0001pt;text-align:justify;">（二）、<strong><strong><span style="color:#333333;"><strong>防火墙性能</strong></span></strong></strong></h3> 
<div> 
 <p style="margin-left:.0001pt;"><span style="color:#333333;">吞吐量</span></p> 
</div> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">并发连接</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">新建连接</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">时延</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">抖动</span></p> 
<h3 id="%EF%BC%88%E4%B8%89%EF%BC%89%E3%80%81iptables" style="margin-left:.0001pt;"><span style="color:#333333;">（三）、</span><strong><strong><span style="color:#333333;"><strong>iptables</strong></span></strong></strong></h3> 
<p><span style="color:#956fe7;"><strong><strong><strong>iptables</strong></strong><strong><strong>是什么？</strong></strong></strong></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">iptables</span><span style="color:#333333;">不是防火墙，是防火墙用户代理</span><span style="color:#333333;">用于把用户的安全设置添加到</span><span style="color:#333333;">“</span><span style="color:#333333;">安全框架</span><span style="color:#333333;">”</span><span style="color:#333333;">中  </span><span style="color:#333333;">“</span><span style="color:#333333;">安全框架</span><span style="color:#333333;">”</span><span style="color:#333333;">是防火墙，</span><span style="color:#333333;">“</span><span style="color:#333333;">安全框架</span><span style="color:#333333;">”</span><span style="color:#333333;">的名称为</span><span style="color:#333333;">netﬁlter。</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">netﬁlter</span><span style="color:#333333;">位于内核空间中，是</span><span style="color:#333333;">Linux</span><span style="color:#333333;">操作系统核心层内部的一个数据包处理模块</span><span style="color:#333333;">iptables</span><span style="color:#333333;">是用于在用户空间对内核空间的</span><span style="color:#333333;">netﬁlter</span><span style="color:#333333;">进行操作的命令行工具。</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">平常我们使用</span><span style="color:#333333;">iptables</span><span style="color:#333333;">并不是防火墙的</span><span style="color:#333333;">“</span><span style="color:#333333;">服务</span><span style="color:#333333;">”</span><span style="color:#333333;">，而服务是由内核提供的。</span></p> 
<p style="margin-left:6pt;"><span style="color:#956fe7;"><strong><strong><strong>iptables</strong></strong><strong><strong>工作依据</strong></strong><strong> </strong><strong><strong>规则</strong></strong><strong><strong>(rules)</strong></strong></strong></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">iptables</span><span style="color:#333333;">是按照规则</span><span style="color:#333333;">(rules)</span><span style="color:#333333;">来办事的，而规则就是运维人员所定义的条件；规则一般定义为</span><span style="color:#333333;">“</span><span style="color:#333333;">如果数据包头符合这样的</span><span style="color:#333333;">条件，就这样处理这个数据包</span><span style="color:#333333;">”</span><span style="color:#333333;">。</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">规则存储在内核空间的数据包过滤表中，这些规则分别指定了源地址、目的地址，传输协议</span><span style="color:#333333;">(TCP</span><span style="color:#333333;">、</span><span style="color:#333333;">UDP</span><span style="color:#333333;">、</span><span style="color:#333333;">ICMP)</span><span style="color:#333333;">和服</span><span style="color:#333333;">务类型</span><span style="color:#333333;">(HTTP</span><span style="color:#333333;">、</span><span style="color:#333333;">FTP)</span><span style="color:#333333;">等。</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">当数据包与规则匹配时，</span><span style="color:#333333;">iptables</span><span style="color:#333333;">就根据规则所定义的方法来处理这些数据包，比如放行(ACCEPT)、拒绝</span><span style="color:#333333;">(REJECT)</span><span style="color:#333333;">、   </span><span style="color:#333333;">丢弃</span><span style="color:#333333;">(DROP)</span><span style="color:#333333;">等。</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#0d0016;">配置防火墙主要工作就是对iptables规则进行添加、修改、删除等。</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#fe2c24;"><strong>iptables规则管理</strong></span></p> 
<p style="margin-left:.0001pt;"><img alt="" height="135" src="https://images2.imgbox.com/f2/cc/dkhYqxJ9_o.png" width="827"></p> 
<p style="margin-left:.0001pt;"><span style="color:#956fe7;"><strong>iptables规则显示</strong></span></p> 
<p style="margin-left:.0001pt;"><img alt="" height="181" src="https://images2.imgbox.com/87/d6/N6lNFkbI_o.png" width="833"></p> 
<p style="margin-left:6pt;"><span style="color:#956fe7;"><strong><strong><strong>netﬁlter/iptables</strong></strong><strong><strong>功能</strong></strong></strong></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">netﬁlter/iptables</span><span style="color:#333333;">可简称为</span><span style="color:#333333;">iptables</span><span style="color:#333333;">，为</span><span style="color:#333333;">Linux</span><span style="color:#333333;">平台下的包过滤防火墙，是开源的，内核自带的，可以代替成本较高的   </span><span style="color:#333333;">企业级硬件防火墙，能够实现如下功能：</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">数据包过滤，即防火墙；</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">数据包重定向，即转发；</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">网络地址转换，即可</span><span style="color:#333333;">NAT。</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#956fe7;"><strong>iptables</strong><strong>中链的概念</strong></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">当客户端访问服务器端的</span><span style="color:#333333;">web</span><span style="color:#333333;">服务时，客户端发送访问请求报文至网卡，而</span><span style="color:#333333;">tcp/ip</span><span style="color:#333333;">协议栈是属于内核的一部分，所     以，客户端的请求报文会通过内核的</span><span style="color:#333333;">TCP</span><span style="color:#333333;">协议传输到用户空间的</span><span style="color:#333333;">web</span><span style="color:#333333;">服务，而客户端报文的目标地址为</span><span style="color:#333333;">web</span><span style="color:#333333;">服务器所  </span><span style="color:#333333;">监听的套接字</span><span style="color:#333333;">(ip:port)</span><span style="color:#333333;">上，当</span><span style="color:#333333;">web</span><span style="color:#333333;">服务器响应客户端请求时，</span><span style="color:#333333;">web</span><span style="color:#333333;">服务所回应的响应报文的目标地址为客户端地址，  我们说过，</span><span style="color:#333333;">netﬁlter</span><span style="color:#333333;">才是真正的防火墙，属于内核的一部分，所以，我们要想让</span><span style="color:#333333;">netﬁlter</span><span style="color:#333333;">起到作用，我们就需要在内   核中设置</span><span style="color:#333333;">“</span><span style="color:#333333;">关口</span><span style="color:#333333;">”</span><span style="color:#333333;">，所以进出的数据报文都要通过这些关口，经检查，符合放行条件的准允放行，符合阻拦条件的则被 </span> <span style="color:#333333;">阻止，于是就出现了</span><span style="color:#333333;">input</span><span style="color:#333333;">和</span><span style="color:#333333;">output</span><span style="color:#333333;">关口，然而在</span><span style="color:#333333;">iptables</span><span style="color:#333333;">中我们把关口叫做</span><span style="color:#333333;">“</span><span style="color:#333333;">链</span><span style="color:#333333;">”</span><span style="color:#333333;">。</span></p> 
<p style="margin-left:.0001pt;"><img alt="" height="690" src="https://images2.imgbox.com/e2/5c/7Qn4qdJL_o.png" width="667"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">如果客户端发到本机的报文中包含的服务器地址并不是本机，而是其他服务器，此时本机就应该能够  进行转发，那么这个转发就是本机内核所支持的</span><span style="color:#956fe7;">IP_FORWARD</span><span style="color:#333333;">功能，此时我们的主机类似于路由器功能，所以我们会   </span><span style="color:#333333;">看到在</span><span style="color:#333333;">iptables</span><span style="color:#333333;">中，所谓的关口并只有上面所提到的</span><span style="color:#333333;">input</span><span style="color:#333333;">及</span><span style="color:#333333;">output</span><span style="color:#333333;">这两个，应该还有</span><span style="color:#333333;">“</span><span style="color:#333333;">路由前</span><span style="color:#333333;">”</span><span style="color:#333333;">，</span><span style="color:#333333;">“</span><span style="color:#333333;">转发</span><span style="color:#333333;">”</span><span style="color:#333333;">，</span><span style="color:#333333;">“</span><span style="color:#333333;">路由后</span><span style="color:#333333;">”</span>，<span style="color:#333333;">它们所对应的英文名称分别为</span><span style="color:#333333;">“</span><span style="color:#956fe7;">PREROUTING</span><span style="color:#333333;">”</span><span style="color:#333333;">，</span><span style="color:#333333;">“</span><span style="color:#956fe7;">FORWARD</span><span style="color:#333333;">”</span><span style="color:#333333;">，</span><span style="color:#333333;">“</span><span style="color:#956fe7;">POSTROUTING</span><span style="color:#333333;">”</span><span style="color:#333333;">，这就是我们说到的</span><span style="color:#fe2c24;">5链</span><span style="color:#333333;">。</span></p> 
<p style="margin-left:.0001pt;"><img alt="" height="464" src="https://images2.imgbox.com/50/57/ROrXVOmH_o.png" width="799"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">当我们在本地启动了防火墙功能时，数据报文需要经过以上关口，根据各报文情况，各报名经常  的</span><span style="color:#333333;">“</span><span style="color:#333333;">链</span><span style="color:#333333;">”</span><span style="color:#333333;">可能不同，如果报文目标地址是本机，则会经常</span><span style="color:#333333;">input</span><span style="color:#333333;">链发往本机用户空间，如果报文目标不是本机，则会直接 </span> <span style="color:#333333;">在内核空间中经常</span><span style="color:#956fe7;">forward</span><span style="color:#333333;">链和</span><span style="color:#956fe7;">postrouting</span><span style="color:#333333;">链转发出去。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">有的时候我们也经常听到人们在称呼</span><span style="color:#333333;">input</span><span style="color:#333333;">为</span><span style="color:#333333;">“</span><span style="color:#333333;">规则链</span><span style="color:#333333;">”</span><span style="color:#333333;">，这又是怎么回事呢？我们知道，防火墙的作用在于对经过的数 </span> <span style="color:#333333;">据报文进行规则匹配，然后执行对应的</span><span style="color:#333333;">“</span><span style="color:#333333;">动作</span><span style="color:#333333;">”</span><span style="color:#333333;">，所以数据包经过这些关口时，必须匹配这个关口规则，但是关口规则   可能不止一条，可能会有很多，当我们把众多规则放在一个关口上时，所有的数据包经常都要进行匹配，那么就形成  </span><span style="color:#333333;">了一个要匹配的规则链条，因此我们也把</span><span style="color:#333333;">“</span><span style="color:#333333;">链</span><span style="color:#333333;">”</span><span style="color:#333333;">称作</span><span style="color:#333333;">“</span><span style="color:#333333;">规则链</span><span style="color:#333333;">”</span><span style="color:#333333;">。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="709" src="https://images2.imgbox.com/e4/c1/LLUnZ3ux_o.png" width="743"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;">INPUT</span><span style="color:#333333;">:</span><span style="color:#333333;">处理入站数据包</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;">OUTPUT</span><span style="color:#333333;">:</span><span style="color:#333333;">处理出站数据包</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#956fe7;">FORWARD</span><span style="color:#333333;">:</span><span style="color:#333333;">处理转发数据包</span><span style="color:#333333;">(</span><span style="color:#333333;">主要是将数据包转发至本机其它网卡</span><span style="color:#333333;">)</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">当数据报文经过本机时，网卡接收数据报文至缓冲区，内核读取报文</span><span style="color:#333333;">ip</span><span style="color:#333333;">首部，发现报文不是送到本机时（目的</span><span style="color:#333333;">ip  </span><span style="color:#333333;">不是本机），由内核直接送到</span><span style="color:#333333;">forward</span><span style="color:#333333;">链做匹配，匹配之后若符合</span><span style="color:#333333;">forward</span><span style="color:#333333;">的规则，再经由</span><span style="color:#333333;">postrouting</span><span style="color:#333333;">送往下一</span><span style="color:#333333;">跳或目的主机。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;">PREROUTING</span><span style="color:#333333;">:</span><span style="color:#333333;">在进行路由选择前处理数据包，修改到达防火墙数据包的目的</span><span style="color:#333333;">IP</span><span style="color:#333333;">地址，用于判断目标主机。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;">POSTROUTING</span><span style="color:#333333;">:</span><span style="color:#333333;">在进行路由选择后处理数据包，修改要离开防火墙数据包的源</span><span style="color:#333333;">IP</span><span style="color:#333333;">地址，判断经由哪一接口送往</span><span style="color:#333333;">下一跳。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#956fe7;">iptables链管理方法（了解）</span></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="225" src="https://images2.imgbox.com/58/78/b5FyFha3_o.png" width="823"></p> 
<h3 id="%EF%BC%88%E5%9B%9B%EF%BC%89%E3%80%81iptables%E4%B8%AD%E8%A1%A8%E7%9A%84%E6%A6%82%E5%BF%B5" style="margin-left:.0001pt;text-align:justify;">（四）、<strong><strong><span style="color:#333333;"><strong>iptables</strong></span></strong><strong><span style="color:#333333;"><strong>中表的概念</strong></span></strong></strong></h3> 
<p><span style="color:#333333;">每个</span><span style="color:#333333;">“</span><span style="color:#333333;">规则链</span><span style="color:#333333;">”</span><span style="color:#333333;">上都设置了一串规则，这样的话，我们就可以把不同的</span><span style="color:#333333;">“</span><span style="color:#333333;">规则链</span><span style="color:#333333;">”</span><span style="color:#333333;">组合成能够完成某一特定功能集合分</span><span style="color:#333333;">类，而这个集合分类我们就称为表，</span><span style="color:#333333;">iptables中共有5张表。</span><span style="color:#956fe7;">security</span><span style="color:#333333;">:是后加上的，定义强制访问控制规则；通常为</span><span style="color:#fe2c24;">4表</span><span style="color:#333333;">。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#956fe7;">ﬁlter</span></strong><span style="color:#333333;">: </span><span style="color:#fe2c24;">过滤</span><span style="color:#333333;">功能，确定是否放行该数据包，属于真正防火墙，内核模块：</span><span style="color:#333333;">iptables_ﬁlter。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;"><strong>nat</strong></span><span style="color:#333333;">: </span><span style="color:#333333;">网络地址</span><span style="color:#fe2c24;">转换</span><span style="color:#333333;">功能，修改数据包中的源、目标</span><span style="color:#333333;">IP</span><span style="color:#333333;">地址或端口；内核模块：</span><span style="color:#333333;">iptable_nat。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;"><strong>mangle</strong></span><span style="color:#333333;">: </span><span style="color:#333333;">对数据包进行重新封装功能，</span><span style="color:#0d0016;">为数据包设置</span><span style="color:#ff0000;">标记</span><span style="color:#333333;">；内核模块：</span><span style="color:#333333;">iptable_mangle。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#956fe7;">raw</span></strong><span style="color:#333333;">: 确定是否对数据包进行</span><span style="color:#ff0000;">跟踪</span><span style="color:#333333;">；内核模块：</span><span style="color:#333333;">iptables_raw。</span></p> 
<p style="margin-left:6pt;"><span style="color:#956fe7;"><strong>iptables中表链之间的关系</strong></span></p> 
<p style="margin-left:6pt;"><img alt="" height="385" src="https://images2.imgbox.com/e5/66/La9hgmEr_o.png" width="785"></p> 
<p style="margin-left:6pt;"><strong><span style="color:#956fe7;">iptables中表的优先级：</span></strong><span style="color:#333333;">raw-mangle-nat-ﬁlter(</span><span style="color:#333333;">由高至低</span><span style="color:#333333;">)</span></p> 
<h2 id="%E4%BA%8C%E3%80%81iptables%E8%A7%84%E5%88%99%E5%8C%B9%E9%85%8D%E6%9D%A1%E4%BB%B6%E5%88%86%E7%B1%BB"><a id="_19"></a>二、<strong><span style="color:#333333;">iptables</span></strong><strong><span style="color:#333333;">规则匹配条件分类</span></strong></h2> 
<h3 id="%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81%E5%9F%BA%E6%9C%AC%E5%8C%B9%E9%85%8D%E6%9D%A1%E4%BB%B6" style="margin-left:.0001pt;"><span style="color:#0d0016;"><strong>（一）、基本匹配条件</strong></span></h3> 
<table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><td style="width:143px;"> <p style="margin-left:.0001pt;"><span style="color:#0d0016;">-p（protocal）</span></p> </td><td style="width:355px;"> <p style="margin-left:.0001pt;"><span style="color:#333333;">指定规则协议，</span><span style="color:#333333;">tcp</span><span style="color:#333333;">（传输层）</span> <span style="color:#333333;">udp</span><span style="color:#333333;">（传输层）</span> <span style="color:#333333;">icmp</span><span style="color:#333333;">（网络层）</span> <span style="color:#333333;">ip（网络层）</span></p> </td></tr><tr><td style="width:143px;">-s<span style="color:#0d0016;">（source） </span></td><td style="width:355px;"> <p style="margin-left:.0001pt;"><span style="color:#333333;">指定数据包的源地址</span></p> </td></tr><tr><td style="width:143px;"> <p style="margin-left:.0001pt;"><span style="color:#0d0016;">-d（destination）</span></p> </td><td style="width:355px;"> <p style="margin-left:.0001pt;"><span style="color:#333333;">指定目的地址</span></p> </td></tr><tr><td style="width:143px;"> <p style="margin-left:.0001pt;"><span style="color:#0d0016;">-i</span></p> </td><td style="width:355px;"> <p style="margin-left:.0001pt;"><span style="color:#333333;">输入</span><span style="color:#333333;">网卡接口（lo本地回环，ens</span><span style="color:#333333;">33）</span></p> </td></tr><tr><td style="width:143px;">-o</td><td style="width:355px;"> <p style="margin-left:.0001pt;"><span style="color:#333333;">输出</span><span style="color:#333333;">网卡接口（ens</span><span style="color:#333333;">37</span><span style="color:#333333;">，ens</span><span style="color:#333333;">33</span><span style="color:#333333;">等）</span></p> </td></tr><tr><td style="width:143px;">!</td><td style="width:355px;">取反</td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#956fe7;">基本匹配的特点是</span></strong><span style="color:#333333;">：无需加载扩展模块，匹配规则生效。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;">拒绝icmp的访问</span><span style="color:#333333;">（</span><span style="color:#fe2c24;">ACCEPT</span>为允许<span style="color:#333333;">）</span></p> 
<pre><code>iptables -A INPUT -p icmp -j REJECT</code></pre> 
<p><img alt="" src="https://images2.imgbox.com/f5/7a/lR17NXtl_o.png"><img alt="" src="https://images2.imgbox.com/56/3b/ZJVFC6WA_o.png"><img alt="" src="https://images2.imgbox.com/6a/0b/slAvR2C2_o.png"></p> 
<p><span style="color:#956fe7;">拒绝tcp的访问</span></p> 
<pre><code>iptables -A INPUT -p tcp -j REJECT</code></pre> 
<p><img alt="" src="https://images2.imgbox.com/ca/93/hEuioIqq_o.png"><img alt="" src="https://images2.imgbox.com/1d/1a/e3gz41Je_o.png"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/9a/6a/pHMs3dXA_o.png"></p> 
<p><span style="color:#956fe7;">拒绝源地址的访问</span></p> 
<pre><code>iptables -A INPUT -s 192.168.238.131 -j REJECT</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/97/bf/TvgUtPMB_o.png"><img alt="" src="https://images2.imgbox.com/85/fb/xUmEcv0j_o.png"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;">除了icmp协议可以通信</span><span style="color:#0d0016;">（</span><span style="color:#fe2c24;">DROP</span><span style="color:#0d0016;">为拒绝但反应较慢）</span></p> 
<pre><code>iptables -A INPUT ! -p icmp -i ens33 -j DROP</code></pre> 
<p style="margin-left:.0001pt;"><img alt="" src="https://images2.imgbox.com/78/cd/g9hCcazv_o.png"><img alt="" src="https://images2.imgbox.com/e5/ce/mVWlWiha_o.png"></p> 
<h3 id="%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81%E6%98%BE%E5%BC%8F%E5%8C%B9%E9%85%8D%E4%BD%BF%E7%94%A8%E9%80%89%E9%A1%B9%E5%8F%8A%E5%8A%9F%E8%83%BD" style="margin-left:.0001pt;">（二）、显式匹配使用选项及功能</h3> 
<p><span style="color:#956fe7;"><img alt="" height="253" src="https://images2.imgbox.com/40/d6/BmL7V1I9_o.png" width="780"></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#956fe7;">禁止访问80端口，其他都可以</span></p> 
<p style="margin-left:.0001pt;"><img alt="" src="https://images2.imgbox.com/a2/8c/dnTsgYbD_o.png"><img alt="" src="https://images2.imgbox.com/33/35/Vy1GBQZp_o.png"></p> 
<p style="margin-left:.0001pt;"><span style="color:#956fe7;">不允许别人Ping我，我可以Ping别人</span></p> 
<pre><code>iptables -A INPUT -p icmp --icmp-type 8/0 -j REJECT</code></pre> 
<p style="margin-left:.0001pt;"><img alt="" src="https://images2.imgbox.com/30/fb/F2SQRz4D_o.png"><img alt="" src="https://images2.imgbox.com/73/39/NLeGFSsO_o.png"></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">多端口：</span><span style="color:#38d8f0;"><strong>multiport</strong></span></p> 
<p><span style="color:#956fe7;">禁止80和20端口访问，其他端口允许</span></p> 
<pre><code>iptables -I INPUT  -p tcp -m multiport --dports 80,20 -j REJECT</code></pre> 
<p><img alt="" src="https://images2.imgbox.com/07/d1/6KP4MaDR_o.png"><img alt="" src="https://images2.imgbox.com/7e/61/bm3RXDvH_o.png"></p> 
<p><span style="color:#333333;">多IP地址：</span><strong><span style="color:#4da8ee;">iprange</span></strong></p> 
<p><span style="color:#956fe7;">禁止192.168.238.120~192.168.238.130IP的访问</span></p> 
<p><img alt="" src="https://images2.imgbox.com/f9/f3/LFG4msB9_o.png"><img alt="" src="https://images2.imgbox.com/6f/b3/AdHvM129_o.png"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">指定访问时间范围：</span><span style="color:#38d8f0;"><strong>time</strong></span><span style="color:#0d0016;"><strong>（</strong></span><span style="color:#fe2c24;"><strong>注意时区</strong></span><span style="color:#0d0016;"><strong>）</strong></span></p> 
<pre><code>iptables -I INPUT -p tcp --dport 80 -m time --weekdays Tus --timestart 10:00:00 --timestop 18:00:00  -j REJECT</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/3d/cb/zgdGlKx1_o.png"><img alt="" src="https://images2.imgbox.com/da/d6/VySqiLyX_o.png"></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">connlimit（了解）</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">连接限制，根据每个客户端</span><span style="color:#333333;">IP</span><span style="color:#333333;">作并发连接数量限制。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="80" src="https://images2.imgbox.com/05/ea/4xRyLDgV_o.png" width="852"></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">limit（了解）</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">报文速率限制。</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">state</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">追踪本机上的请求和响应之间的数据报文的状态。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;">状态有五种</span></p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><td style="width:208px;"><span style="color:#0d0016;">NEW</span></td><td style="width:290px;"> <p style="margin-left:.0001pt;"><span style="color:#333333;">新连接请求</span></p> </td></tr><tr><td style="width:208px;"><span style="color:#0d0016;">ESTABLISHED</span></td><td style="width:290px;"> <p style="margin-left:.0001pt;"><span style="color:#333333;">已建立的连接</span></p> </td></tr><tr><td style="width:208px;"><span style="color:#0d0016;">INVALID</span></td><td style="width:290px;"> <p style="margin-left:.0001pt;"><span style="color:#333333;">无法识别的连接</span></p> </td></tr><tr><td style="width:208px;"><span style="color:#0d0016;">RELATED</span></td><td style="width:290px;"> <p style="margin-left:.0001pt;"><span style="color:#333333;">相关联的连接，当前连接是一个新请求</span></p> </td></tr><tr><td style="width:208px;"><span style="color:#0d0016;">UNTRACKED</span></td><td style="width:290px;"> <p style="margin-left:.0001pt;"><span style="color:#333333;">未追踪的连接</span></p> </td></tr></tbody></table> 
<p><img alt="" height="207" src="https://images2.imgbox.com/d2/28/kcz3AgBu_o.png" width="991"></p> 
<h3 id="%EF%BC%88%E4%B8%89%EF%BC%89%E3%80%81iptables%E8%A7%84%E5%88%99">（三）、<span style="color:#333333;">iptables</span><span style="color:#333333;">规则</span></h3> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#956fe7;">制定iptables规则思路</span></strong></p> 
<p><span style="color:#333333;">选择一张表，此表决定了数据报文处理的功能</span></p> 
<p><span style="color:#333333;">选择一条链，此链决定了数据报文流经哪些位置</span></p> 
<p><span style="color:#333333;">选择合适的规则，此条件决定了对数据做何种条件匹配</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">选择处理数据报文的动作 拒绝还是允许</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;"><strong>制定iptables规则策略</strong></span></p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><td style="width:73px;">黑名单</td><td style="width:426px;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">没有被拒绝的流量都可以通过，这种策略下管理员必须针对每一种新出现的攻击，制定新的规则，因此不推荐</span></p> </td></tr><tr><td style="width:73px;">白名单</td><td style="width:426px;"> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">没有被允许的流量都要拒绝，这种策略比较保守，根据需要，主机主机逐渐开放，目前一般都采用白名单策</span><span style="color:#333333;">略，推荐</span></p> </td></tr></tbody></table> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#956fe7;"><strong>iptables规则中动作</strong></span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">iptables</span><span style="color:#333333;">规则中的动作常称为</span><span style="color:#333333;">target</span><span style="color:#333333;">，也分为基本动作和扩展动作。</span></p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:500px;"><tbody><tr><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">ACCEPT</span></p> </td><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">允许数据包通过</span></p> </td></tr><tr><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">DROP</span></p> </td><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">直接丢弃数据包，不给任何回应信息</span></p> </td></tr><tr><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">REJECT</span></p> </td><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">拒绝数据包通过，发送回应信息给客户端</span></p> </td></tr><tr><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">SNAT</span></p> </td><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">源地址转换</span></p> </td></tr><tr><td></td><td> <p style="margin-left:.0001pt;"><span style="color:#333333;">数据包从网卡发送出去的时候，把数据包中的源地址部分替换为指定的</span><span style="color:#333333;">IP</span><span style="color:#333333;">，接收方认为数据包的来</span></p> <p style="margin-left:.0001pt;"><span style="color:#333333;">源是被替换的那个</span><span style="color:#333333;">IP</span><span style="color:#333333;">主机，返回响应时，也以被替换的</span><span style="color:#333333;">IP</span><span style="color:#333333;">地址进行</span></p> </td></tr><tr><td></td><td> <p style="margin-left:.0001pt;"><span style="color:#333333;">修改数据包源地址，当内网数据包到达防火墙后，防火墙会使用外部地址替换掉数据包的源</span><span style="color:#333333;">IP</span><span style="color:#333333;">地址</span></p> <p style="margin-left:.0001pt;"><span style="color:#333333;">（目的</span><span style="color:#333333;">IP</span><span style="color:#333333;">地址不变），使网络内部主机能够与网络外部主机通信</span></p> </td></tr><tr><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">MASQUERADE</span></p> </td><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">伪装，类似于</span><span style="color:#333333;">SNAT</span><span style="color:#333333;">，适用于动态的、临时会变的</span><span style="color:#333333;">ip</span><span style="color:#333333;">地址上，例如：家庭使用的宽带。  </span><span style="color:#333333;">用发送数据的网卡上的</span><span style="color:#333333;">IP</span><span style="color:#333333;">来替换源</span><span style="color:#333333;">IP</span><span style="color:#333333;">，对于</span><span style="color:#333333;">IP</span><span style="color:#333333;">地址不固定场合使用</span></p> </td></tr><tr><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">DNAT</span></p> </td><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">目标地址转换</span></p> </td></tr><tr><td></td><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">数据包从网卡发出时，修改数据包中的目的</span><span style="color:#333333;">IP</span><span style="color:#333333;">，表现为你想访问</span><span style="color:#333333;">A</span><span style="color:#333333;">，但因网关做了</span><span style="color:#333333;">DNAT</span><span style="color:#333333;">，把所有  </span><span style="color:#333333;">访问</span><span style="color:#333333;">A</span><span style="color:#333333;">的数据包中的目的</span><span style="color:#333333;">IP</span><span style="color:#333333;">地址全部修改为</span><span style="color:#333333;">B,</span><span style="color:#333333;">实际最终访问的是</span><span style="color:#333333;">B</span></p> </td></tr><tr><td></td><td> <p style="margin-left:.0001pt;"><span style="color:#333333;">改变数据包目的地址，当防火墙收到来自外网的数据包后，会将该数据包的目的</span><span style="color:#333333;">IP</span><span style="color:#333333;">地址进行替换</span></p> <p style="margin-left:.0001pt;"><span style="color:#333333;">（源</span><span style="color:#333333;">IP</span><span style="color:#333333;">地址不变），重新转发到内网的主机</span></p> </td></tr><tr><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">REDIRECT</span></p> </td><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">在本机做端口映射</span></p> </td></tr><tr><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">LOG</span></p> </td><td> <p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">在</span><span style="color:#333333;">/var/log/message</span><span style="color:#333333;">文件中记录日志信息，然后将数据包传递给下一条规则</span></p> </td></tr></tbody></table> 
<p>SNAT</p> 
<p><img alt="" height="265" src="https://images2.imgbox.com/b6/53/tr1cRAAQ_o.png" width="764"></p> 
<pre><code>iptables -t nat -A POSTROUTING -s 192.168.10.0/24 -o eth1 -j SNAT --to-source 202.12.10.100
</code></pre> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">DNAT</span></p> 
<p><img alt="" height="265" src="https://images2.imgbox.com/9a/c6/9xlTdUr7_o.png" width="764"></p> 
<pre><code>iptables -t nat -A PREROUTING -d 202.12.10.100 -p tcp --dport 80 -j DNAT --to- destination 192.168.10.254</code></pre> 
<p><span style="color:#0d0016;">路由是按照目的地址进行路由选择的，因此，DNAT是在PREROUTING链上进行的，SNAT是在数据包发出的时候进行的，因此是在POSTROUTING链上进行的。</span></p> 
<p style="margin-left:6pt;"><span style="color:#956fe7;"><strong><strong><strong>iptables</strong></strong><strong><strong>基础语法结构</strong></strong></strong></span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">iptables</span> <span style="color:#333333;">[-t</span> <span style="color:#333333;">表名</span><span style="color:#333333;">] </span><span style="color:#333333;">管理选项 </span><span style="color:#333333;">[</span><span style="color:#333333;">链名</span><span style="color:#333333;">] [</span><span style="color:#333333;">条件匹配</span><span style="color:#333333;">] </span><span style="color:#333333;">[-j</span> <span style="color:#333333;">目标动作或跳转</span><span style="color:#333333;">]</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">不指定表名时，默认表示</span><span style="color:#956fe7;">ﬁlter</span><span style="color:#0d0016;">表，不指定链名时，默认表示该表内所有链，除非设置规则链的默认策略，否则  需要指定匹配条件。</span></p> 
<p><img alt="" height="461" src="https://images2.imgbox.com/7b/dd/tZc6vzuC_o.png" width="801"></p> 
<h2 id="%E4%B8%89%E3%80%81iptables%E5%BA%94%E7%94%A8">三、<strong><strong><span style="color:#333333;"><strong>iptables</strong></span></strong><strong><span style="color:#333333;"><strong>应用</strong></span></strong></strong></h2> 
<p>服务名：<span style="color:#b95514;">iptables-services</span><span style="color:#0d0016;">（yum）</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">centos7系统中默认存在iptables命令，此命令仅为简单查询及操作命令，不包含配置文件，安装iptables- services后，将直接生成配置文件，便于配置保存。包含ipv4及ipv6。</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">保存规则：</span><span style="color:#aa5400;">ptables-save &gt;</span> <span style="color:#aa5400;">/etc/sysconfig/iptables</span><span style="color:#0d0016;">（路径可自定义）</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#0d0016;">重载：</span><span style="color:#aa5400;">iptables-restore &lt;</span> <span style="color:#aa5400;">/etc/sysconfig/iptables</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#956fe7;"><strong>不允许通过本地回环网卡访问本机</strong></span></p> 
<pre><code>iptables -I INPUT -i lo -j REJECT</code></pre> 
<p><img alt="" src="https://images2.imgbox.com/fc/83/o7qQDM0m_o.png"><img alt="" src="https://images2.imgbox.com/b7/84/OUBnhiR5_o.png"></p> 
<p style="margin-left:.0001pt;text-align:justify;"><strong><span style="color:#956fe7;">本机无法访问本机</span></strong></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/a1/54/TWARVCrO_o.png"></p> 
<p>解决办法</p> 
<p><img alt="" src="https://images2.imgbox.com/3e/20/F9BneXuU_o.png"></p> 
<h3 id="%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81%E8%BF%9B%E8%A1%8C%E6%A0%87%E8%AE%B0%EF%BC%8C%E5%8F%AF%E5%9C%A8LVS%E8%B0%83%E5%BA%A6%E5%99%A8%E4%B8%AD%E5%BA%94%E7%94%A8">（一）、<span style="color:#0d0016;"><strong>进行标记，可在LVS调度器中应用</strong></span></h3> 
<p>详细列表</p> 
<p>iptables -t mangle -nL</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ce/43/EXTljlXz_o.png"></p> 
<p>进行标记</p> 
<p><img alt="" src="https://images2.imgbox.com/20/fe/FvUEO1li_o.png"><img alt="" src="https://images2.imgbox.com/86/9a/ZdypYShJ_o.png"><img alt="" src="https://images2.imgbox.com/fd/75/pfp0m8eV_o.png"><img alt="" src="https://images2.imgbox.com/e9/aa/47p31oQx_o.png"></p> 
<h3 id="%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81iptables%20nat%E8%A1%A8%E5%BA%94%E7%94%A8%E6%A1%88%E4%BE%8B" style="background-color:transparent;">（二）、<strong><span style="color:#333333;">iptables nat</span></strong><strong><span style="color:#333333;">表应用案例</span></strong></h3> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">nat表作用：导流</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">nat表作用位置</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">KVM</span><span style="color:#333333;">或</span><span style="color:#333333;">OpenStack中虚拟机或云主机与外部通信</span></p> 
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#333333;">Docker</span><span style="color:#333333;">管理的容器与外部通信</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">开启路由转发功能</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#333333;">SNAT源地址转换、DNAT目标地址转换</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#956fe7;"><strong>案列</strong></span></p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" src="https://images2.imgbox.com/25/f4/Vnz56erq_o.png"></p> 
<p style="margin-left:.0001pt;"><strong><span style="color:#956fe7;">实验环境</span>：</strong></p> 
<p style="margin-left:.0001pt;"><span style="color:#0d0016;">hd1：</span><span style="color:#4da8ee;">192.168.238.101、</span><span style="color:#0d0016;">网关：</span><span style="color:#4da8ee;">192.168.238.100</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#0d0016;">hd2：</span><span style="color:#4da8ee;"> 192.168.100.101</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#0d0016;">hd3：</span><span style="color:#4da8ee;"> 192.168.100.100</span><span style="color:#ad720d;">（ens33）</span><span style="color:#4da8ee;">、192.168.238.100</span><span style="color:#ad720d;">（ens37）</span></p> 
<p style="margin-left:.0001pt;"><span style="color:#fe2c24;"><strong>注意</strong></span>：为了方便互相验证先在hd1和hd3上先装好httpd服务</p> 
<p style="margin-left:.0001pt;"><strong><span style="color:#956fe7;">步骤</span></strong></p> 
<p style="margin-left:.0001pt;"><span style="color:#fe2c24;"><strong>snat</strong></span></p> 
<p style="margin-left:.0001pt;">hd1       </p> 
<p style="margin-left:.0001pt;"> 安装httpd服务，启动httpd服务</p> 
<p style="margin-left:.0001pt;">配置静态IP及网关</p> 
<p style="margin-left:.0001pt;">创建访问文件        echo hello &gt; /var/www/html/index.html（可不创建，只是为了方便观察）</p> 
<p style="margin-left:.0001pt;"></p> 
<p style="margin-left:.0001pt;">hd2      </p> 
<p style="margin-left:.0001pt;">安装httpd服务，启动httpd服务</p> 
<p style="margin-left:.0001pt;">配置静态IP及网关</p> 
<p style="margin-left:.0001pt;">创建访问文件        echo OKOK &gt; /var/www/html/index.html</p> 
<p style="margin-left:.0001pt;"></p> 
<p style="margin-left:.0001pt;">hd3        添加网卡ens37，配置静态IP</p> 
<p style="margin-left:.0001pt;">开启防火墙的路由转发功能</p> 
<p style="margin-left:.0001pt;">vim  /etc/sysctl.conf</p> 
<p style="margin-left:.0001pt;text-align:center;"><img alt="" src="https://images2.imgbox.com/96/da/c0D69eqt_o.png"></p> 
<p style="margin-left:.0001pt;">sysctl -p 激活</p> 
<p style="margin-left:.0001pt;">配置防火墙的snat地址转换</p> 
<pre><code>iptables -t nat -A POSTROUTING -s 192.168.238.0/24 -o ens37 -j SNAT --to-source 192.168.100.100</code></pre> 
<p style="margin-left:.0001pt;">到hd1上进行验证</p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/fc/98/tW7V4Uui_o.png"></p> 
<p><span style="color:#fe2c24;"><strong>dnat</strong></span></p> 
<p>hd3配置防火墙的dnat地址转换</p> 
<pre><code>iptables -t nat -A PREROUTING -d 192.168.100.100 -p tcp -j DNAT --to-destination 192.168.238.101</code></pre> 
<p>到hd2上进行验证</p> 
<p><img alt="" src="https://images2.imgbox.com/56/a5/6wrOLL8G_o.png"></p> 
<p></p> 
<h2 id="%E5%9B%9B%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E9%98%B2%E7%81%AB%E5%A2%99" style="background-color:transparent;">四、什么是防火墙</h2> 
<p>防火墙：防范一些网络攻击。有软件防火墙、硬件防火墙之分。</p> 
<p>防火墙选择让正常请求通过，从而保证网络安全性。</p> 
<p><img alt="" height="510" src="https://images2.imgbox.com/39/11/FaeHl3sN_o.png" width="980"></p> 
<p><strong>Windows防火墙</strong></p> 
<p><img alt="" height="531" src="https://images2.imgbox.com/c2/75/sjTIHYMC_o.png" width="1200"></p> 
<p><strong>传统Linux防火墙</strong></p> 
<p><img alt="" height="650" src="https://images2.imgbox.com/39/62/HgyHLkDO_o.png" width="1200"></p> 
<p><strong>FireWalld防火墙的概念</strong></p> 
<p>CentOS6中防火墙叫做<span style="color:#ad720d;">iptables</span></p> 
<p>CentOS7中默认使用的防火墙是<span style="color:#ad720d;">firewalld</span></p> 
<p>FireWalld增加了区域的概念，所谓区域是指，firewalld预先准备了几套防火墙策略的集合，类似于策略的模板，用户可以根据需求选择区域。</p> 
<p>FireWalld属于动态防火墙，是CentOS7系统中用于对netﬁlter内核模块用户空间管理工具。FireWalld仅仅替代了iptables service部分，其底层还是使用iptables做为防火墙规则管理入口。</p> 
<p>常见区域及相应策略规则</p> 
<table border="1" cellpadding="1" cellspacing="1"><tbody><tr><td> <p>trusted</p> </td><td> <p>允许所有数据包</p> </td></tr><tr><td> <p>home</p> </td><td> <p>拒绝流入的流量，除非与流出的流量相关，允许</p> <p>ssh,mdns,ippclient,amba-client,dhcpv6-client服务通过</p> </td></tr><tr><td> <p>internal</p> </td><td> <p>等同于home</p> </td></tr><tr><td> <p>work</p> </td><td> <p>拒绝流入的流量，除非与流出的流量相关，允许ssh,ipp</p> <p>client,dhcpv6-client服务通过</p> </td></tr><tr><td> <p>public</p> </td><td> <p>拒绝流入的流量，除非与流出的流量相关，允许</p> <p>ssh,dhcpv6-client服务通过</p> </td></tr><tr><td> <p>external</p> </td><td> <p>拒绝流入的流量，除非与流出的流量相关，允许ssh服务通</p> <p>过</p> </td></tr><tr><td> <p>dmz</p> </td><td> <p>拒绝流入的流量，除非与流出的流量相关，允许ssh服务通</p> <p>过</p> </td></tr><tr><td> <p>block</p> </td><td> <p>拒绝流入的流量，除非与流出的流量相关，非法流量采取拒</p> <p>绝操作</p> </td></tr><tr><td> <p>drop</p> </td><td> <p>拒绝流入的流量，除非与流出的流量相关，非法流量采取丢</p> <p>弃操作</p> </td></tr></tbody></table> 
<table border="1" cellpadding="1" cellspacing="1"><tbody><tr><td> <p>运行模式</p> </td><td> <p>配置的防火墙策略立即生效，但是不写入配置文件</p> </td></tr><tr><td> <p>永久模式</p> </td><td> <p>配置的防火墙策略写入配置文件，但是需要reload</p> <p>重新加载才能生效</p> </td></tr></tbody></table> 
<h2 id="%E4%BA%94%E3%80%81FireWalld%E9%98%B2%E7%81%AB%E5%A2%99%E7%9A%84%E9%85%8D%E7%BD%AE">五、FireWalld<strong>防火墙的配置</strong></h2> 
<p>使用systemctl来管理firewalld的服务</p> 
<p>语法：systemctl [选项] firewalld</p> 
<table border="1" cellpadding="1" cellspacing="1"><tbody><tr><td> <p>start</p> </td><td> <p>启动指定服务</p> </td></tr><tr><td>status</td><td>检查指定服务的运行状况</td></tr><tr><td> <p>reload</p> </td><td> <p>重新加载指定服务的配置文件（并非所有服务都支持</p> <p>reload，通常使用restart)</p> </td></tr><tr><td> <p>restart</p> </td><td> <p>重启指定服务</p> </td></tr><tr><td> <p>stop</p> </td><td> <p>停止指定服务</p> </td></tr></tbody></table> 
<p><strong>管理firewall配置 </strong></p> 
<p>查看默认使用的区域       <span style="color:#ad720d;"> firewall-cmd --get-default-zone</span></p> 
<p>查看所有可用区域         <span style="color:#ad720d;">  firewall-cmd --get-zones</span></p> 
<p>列出当前使用区域配置   <span style="color:#ad720d;"> firewall-cmd --list-all</span></p> 
<p><img alt="" src="https://images2.imgbox.com/b3/10/18rjj79R_o.png"></p> 
<p>列出所有区域的配置        <span style="color:#ad720d;">firewall-cmd --list-all-zones</span></p> 
<p><img alt="" src="https://images2.imgbox.com/5f/43/kNyXX7Th_o.png"></p> 
<p>在public区域，添加允许tcp协议的1024端口通过的规则       </p> 
<p><span style="color:#ad720d;">firewall-cmd --zone=public --add-port=1024/tcp</span></p> 
<p>在public区域，去掉允许tcp协议的1024端口通过的规则</p> 
<p><span style="color:#ad720d;">firewall-cmd --zone=public --remove-port=1024/tcp</span></p> 
<p>在public区域，使用permanent参数，永久添加允许1024端口通过的规则</p> 
<p><span style="color:#ad720d;">firewall-cmd --permanent --zone=public --add port=1024/tcp</span></p> 
<p></p> 
<h3 id="%EF%BC%88%E4%B8%80%EF%BC%89%E3%80%81Firewalld%E9%BB%98%E8%AE%A4%E5%85%B19%E4%B8%AAzone">（一）、Firewalld默认共9个zone</h3> 
<p>FireWalld不同区域之间的差异主要是每个区域对待数据包的默认行为不同</p> 
<table border="1" cellpadding="1" cellspacing="1"><tbody><tr><td> <p>内部</p> </td><td> <p>internal</p> </td></tr><tr><td> <p>非军事化</p> </td><td> <p>dmz</p> </td></tr><tr><td>外部</td><td>external</td></tr><tr><td> <p>家 庭</p> </td><td> <p>home</p> </td></tr><tr><td> <p>拒 绝</p> </td><td> <p>block</p> </td></tr><tr><td> <p>默认区域</p> </td><td> <p>Firewalld</p> </td></tr><tr><td> <p>丢 弃</p> </td><td> <p>drop</p> </td></tr><tr><td> <p>信  任</p> </td><td> <p>trusted</p> </td></tr><tr><td> <p>工作区</p> </td><td> <p>work</p> </td></tr></tbody></table> 
<h3 id="%EF%BC%88%E4%BA%8C%EF%BC%89%E3%80%81%E7%AB%AF%E5%8F%A3%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%90%8D%E7%A7%B0%E7%9A%84%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB">（二）、<strong>端口和服务名称的对应关系</strong></h3> 
<p><strong><span style="color:#956fe7;">查看端口和服务名称的对应关系  </span>      <span style="color:#ad720d;">cat /etc/services </span></strong></p> 
<table border="1" cellpadding="1" cellspacing="1"><tbody><tr><td> <p>新建规则</p> </td><td> <p>--add</p> </td></tr><tr><td>删除规则</td><td> <p>--remove</p> </td></tr><tr><td>改变规则</td><td> <p>--change</p> </td></tr><tr><td>查询规则</td><td> <p>--query</p> </td></tr></tbody></table> 
<p>--add-interface=eth0             <span style="color:#ad720d;">将网络接口添加到默认的区域内</span></p> 
<p>--add-service=http --permanent</p> 
<p><span style="color:#ad720d;">添加服务到区域开放列表中（注意服务的名称需要与此区域支持的服务列表中的名称一致）</span></p> 
<p>--remove-interface=eth0      <span style="color:#ad720d;">  将网络接口在默认的区域内删除</span></p> 
<p>--change-interface=eth1        <span style="color:#ad720d;">改变指定的接口到其他区域</span></p> 
<p>--query-masquerade             <span style="color:#ad720d;"> 查询SNAT的状态</span></p> 
<hr> 
<h2 id="%E6%80%BB%E7%BB%93"><a id="_45"></a>总结</h2> 
<p>首先要了解防火墙的一些概念再去操作要好一些，因为操作命令较长，不好背记，理解了选项的含义会更加得心应手。4表5链和iptables服务需要重点掌握。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4800fc9c0a2ecfedb68be5f846c7a664/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">盘点java写入文件的几种方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/274cb8afe9181b403189b6305516a1ac/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">xargs 命令详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>