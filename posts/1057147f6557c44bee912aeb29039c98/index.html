<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>发送邮箱验证码【spring boot】 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="发送邮箱验证码【spring boot】" />
<meta property="og:description" content="⭐前言⭐ ※※※大家好！我是同学〖森〗，一名计算机爱好者，今天让我们进入学习模式。若有错误，请多多指教。更多有趣的代码请移步Gitee
👍 点赞 ⭐ 收藏 📝留言 都是我创作的最大的动力！
1. 思维导图 2. 获取邮箱授权码 2.1 1. 开启POP3/SMTP服务 登录QQ邮箱 --&gt; 设置 --&gt; 账户 向下滑动滚动条，找到账户页面下方的 POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务一栏，点击管理服务
第一次会让你绑定手机后再进行操作 按要求进行操作就好； 进入安全模式，点击生成授权码； 短信验证
验证成功会生成授权码
一定要复制授权码，并保存到一个地方；别问我怎么知道的；
3. 创建 Spring Boot 项目 3.1 引入依赖 &lt;!-- 发送邮件 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt; &lt;/dependency&gt; 添加依赖后一定要重新 ReLoad 一下；
3.2 配置application.yml文件 Spring: # 邮箱基本配置 mail: # 配置 smtp 服务主机地址 # qq 邮箱 smtp.qq.com 端口号 465 或 587 # sina smtp.sina.com # aliyun smtp.aliyun.com # 163 smtp." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/1057147f6557c44bee912aeb29039c98/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-02T17:07:08+08:00" />
<meta property="article:modified_time" content="2023-07-02T17:07:08+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">发送邮箱验证码【spring boot】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>⭐前言⭐</h2> 
<blockquote> 
 <p>※※※大家好！我是同学〖森〗，一名计算机爱好者，今天让我们进入学习模式。若有错误，请多多指教。更多有趣的代码请移步<a href="https://gitee.com/never-give-in" rel="nofollow">Gitee</a><br> 👍 点赞 ⭐ 收藏 📝留言 都是我创作的最大的动力！</p> 
</blockquote> 
<h2><a id="1__6"></a>1. 思维导图</h2> 
<p><img src="https://images2.imgbox.com/73/ae/kcxJB0Wx_o.png" alt="发送邮箱验证码的思维导图"></p> 
<h2><a id="2__10"></a>2. 获取邮箱授权码</h2> 
<h3><a id="21_1_POP3SMTP_11"></a>2.1 1. 开启POP3/SMTP服务</h3> 
<blockquote> 
 <ul><li><strong>登录QQ邮箱 --&gt; 设置 --&gt; 账户</strong></li></ul> 
</blockquote> 
<p><img src="https://images2.imgbox.com/66/33/s0LBqTmg_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <ul><li><strong>向下滑动滚动条，找到账户页面下方的 POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务一栏，点击<em>管理服务</em></strong><br> <img src="https://images2.imgbox.com/37/1c/H2nIBMZy_o.png" alt="在这里插入图片描述"></li></ul> 
</blockquote> 
<blockquote> 
 <ul><li>第一次会让你绑定手机后再进行操作 按要求进行操作就好；</li></ul> 
</blockquote> 
<blockquote> 
 <ul><li>进入安全模式，点击生成授权码；</li></ul> 
 <p><img src="https://images2.imgbox.com/19/c3/bKNnAXBq_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<blockquote> 
 <ul><li>短信验证<br> <img src="https://images2.imgbox.com/86/26/a9yBKr8z_o.png" alt="在这里插入图片描述"></li></ul> 
</blockquote> 
<blockquote> 
 <ul><li>验证成功会生成授权码<br> <img src="https://images2.imgbox.com/05/94/1ERD7e8x_o.png" alt="在这里插入图片描述"></li></ul> 
</blockquote> 
<blockquote> 
 <p>一定要复制授权码，并保存到一个地方；别问我怎么知道的；</p> 
</blockquote> 
<h2><a id="3__Spring_Boot__37"></a>3. 创建 Spring Boot 项目</h2> 
<h3><a id="31__39"></a>3.1 引入依赖</h3> 
<pre><code class="prism language-xml"><span class="token comment">&lt;!--   发送邮件     --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-mail<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<blockquote> 
 <p>添加依赖后一定要重新 ReLoad 一下；</p> 
 <p><img src="https://images2.imgbox.com/9c/05/DpB79acW_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<h3><a id="32_applicationyml_52"></a>3.2 配置application.yml文件</h3> 
<pre><code class="prism language-yaml"><span class="token key atrule">Spring</span><span class="token punctuation">:</span>
  <span class="token comment"># 邮箱基本配置</span>
  <span class="token key atrule">mail</span><span class="token punctuation">:</span>
    <span class="token comment"># 配置 smtp 服务主机地址</span>
    <span class="token comment"># qq 邮箱     smtp.qq.com    端口号 465 或 587</span>
    <span class="token comment"># sina       smtp.sina.com</span>
    <span class="token comment"># aliyun     smtp.aliyun.com</span>
    <span class="token comment"># 163        smtp.163.com   端口号 465 或 994</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> smtp.qq.com
    <span class="token comment"># 发送者邮箱</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> xxxxxxxx@qq.com
    <span class="token comment"># 在邮箱内申请的授权码</span>
    <span class="token key atrule">password</span><span class="token punctuation">:</span> xttfwlhoyguxbacg
    <span class="token comment"># 端口号</span>
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">587</span>
    <span class="token comment"># 默认的邮件编码为UTF-8</span>
    <span class="token key atrule">default-encoding</span><span class="token punctuation">:</span> UTF<span class="token punctuation">-</span><span class="token number">8</span>
    <span class="token comment"># 其他参数</span>
    <span class="token key atrule">properties</span><span class="token punctuation">:</span>
      <span class="token key atrule">mail</span><span class="token punctuation">:</span>
          <span class="token comment"># 配置SSL 加密工厂</span>
        <span class="token key atrule">smtp</span><span class="token punctuation">:</span>
          <span class="token key atrule">ssl</span><span class="token punctuation">:</span>
            <span class="token comment"># 本地测试， 先放开ssl</span>
            <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
            <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
          <span class="token comment">#开启debug模式，这样邮件发送过程的日志会在控制台打印出来，方便排查错误</span>
        <span class="token key atrule">debug</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre> 
<blockquote> 
 <ul><li>这里注意一下port 465有时会报错，换一个就好；</li><li>把username 改成自己的QQ邮箱号，把password 换成刚刚我们申请的授权码（不是QQ密码哟）</li></ul> 
</blockquote> 
<h3><a id="33_ToEmail_88"></a>3.3 实体类ToEmail</h3> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>sendemail<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @version IntelliJ IDEA || java version 11.
 * @Author: Oliver
 * @Description: 邮箱验证码实体类
 * @Date: 2023-07-02
 * @Time: 14:21
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span> <span class="token comment">//生成一个包含所有类字段的构造函数</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ToEmail</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     *  邮件接受方
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> tos<span class="token punctuation">;</span>
    <span class="token comment">/**
     *      邮件主题
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> subject<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 邮件内容
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="34_6_124"></a>3.4 生成6位验证码</h3> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>sendemail<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">SecureRandom</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Random</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @version IntelliJ IDEA || java version 11.
 * @Author: Oliver
 * @Description: 生成验证码工具类
 * @Date: 2023-07-02
 * @Time: 14:35
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VerCodeGenerateUtil</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     * 验证码包含的字段
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SYMBOLS <span class="token operator">=</span> <span class="token string">"0123456789ABCDEFGHIGKLMNOPQRSTUVWXYZ"</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Random</span> RAND <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 生成 6 位数的随机数字
     * @return {@link String 验证码}
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">generateVerCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> code <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> code<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            code<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> SYMBOLS<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>RAND<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>SYMBOLS<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//  RAND.nextInt(SYMBOLS.length()) 生成一个随机的索引值;</span>
            <span class="token comment">//  RAND.nextInt(n) 生成一个0到n-1之间的随机整数;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p><strong>SecureRandom() 和 Random()</strong></p> 
 <ul><li><code>java.util.Random</code>是一个<strong>伪随机数生成器</strong>，它使用线性同余算法生成随机数。 
   <ul><li>这种算法虽然能够快速生成随机数，但是它的随机性并不够强，因此不适用于安全相关的场景。在Java中，使用java.util.Random生成的随机数只能用于一些非安全性的场景，例如模拟数据或游戏等。</li></ul> </li><li><code>java.security.SecureRandom</code>是一个<strong>强随机数生成器</strong>，它使用安全的随机数生成算法生成随机数。 
   <ul><li>这种算法的随机性更加强大和安全，可以用于安全相关的场景，例如密码学或安全通信等。在Java中，使用<code>java.security.SecureRandom</code>生成的随机数可以用于安全性要求更高的场景。</li></ul> </li></ul> 
</blockquote> 
<h3><a id="35_MailService_168"></a>3.5 邮件服务器类MailService</h3> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>sendemail<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>mail<span class="token punctuation">.</span>javamail<span class="token punctuation">.</span></span><span class="token class-name">JavaMailSenderImpl</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>mail<span class="token punctuation">.</span>javamail<span class="token punctuation">.</span></span><span class="token class-name">MimeMessageHelper</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>lang3<span class="token punctuation">.</span></span><span class="token class-name">StringUtils</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>mail<span class="token punctuation">.</span></span><span class="token class-name">MessagingException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MailService</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     * 注入邮件工具类
     */</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">JavaMailSenderImpl</span> javaMailSender<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${spring.mail.username}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> sendMailer<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 检测邮件信息类
     * @param receiveEmail 接收者
     * @param subject  主题
     * @param emailMsg 内容
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">checkMail</span><span class="token punctuation">(</span><span class="token class-name">String</span> receiveEmail<span class="token punctuation">,</span> <span class="token class-name">String</span> subject<span class="token punctuation">,</span> <span class="token class-name">String</span> emailMsg<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//  StringUtils 需要引入  commons-lang3 依赖</span>
        <span class="token comment">//  可以用 receiveEmail == null || receiveEmail.isEmpty() 来代替</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>receiveEmail<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"邮件收件人不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>subject<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"邮件主题不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>emailMsg<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"邮件内容不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/**
     * 发送纯文本邮件
     * @param receiveEmail 接收者
     * @param subject  主题
     * @param emailMsg 内容
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Boolean</span> <span class="token function">sendTextMail</span><span class="token punctuation">(</span><span class="token class-name">String</span> receiveEmail<span class="token punctuation">,</span> <span class="token class-name">String</span> subject<span class="token punctuation">,</span> <span class="token class-name">String</span> emailMsg<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 参数检查</span>
        <span class="token function">checkMail</span><span class="token punctuation">(</span>receiveEmail<span class="token punctuation">,</span> subject<span class="token punctuation">,</span> emailMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// true 代表支持复杂的类型</span>
            <span class="token class-name">MimeMessageHelper</span> mimeMessageHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MimeMessageHelper</span><span class="token punctuation">(</span>javaMailSender<span class="token punctuation">.</span><span class="token function">createMimeMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 邮件发件人</span>
            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setFrom</span><span class="token punctuation">(</span>sendMailer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 邮件收件人</span>
            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span>receiveEmail<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 邮件主题</span>
            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span>subject<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 邮件内容</span>
            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>emailMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 邮件发送时间</span>
            mimeMessageHelper<span class="token punctuation">.</span><span class="token function">setSentDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
            <span class="token comment">// 发送邮件</span>
            javaMailSender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>mimeMessageHelper<span class="token punctuation">.</span><span class="token function">getMimeMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"发送邮件成功: "</span> <span class="token operator">+</span> sendMailer <span class="token operator">+</span> <span class="token string">"--&gt;"</span> <span class="token operator">+</span> receiveEmail<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">MessagingException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"发送邮件失败: "</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="36_EmailController_252"></a>3.6 EmailController</h3> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>sendemail<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>sendemail<span class="token punctuation">.</span>common<span class="token punctuation">.</span></span><span class="token class-name">AjaxResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>sendemail<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">ToEmail</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>sendemail<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">MailService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>sendemail<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">VerCodeGenerateUtil</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @version IntelliJ IDEA || java version 11.
 * @Author: Oliver
 * @Description: 邮箱验证码
 * @Date: 2023-07-02
 * @Time: 15:06
 */</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/email"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmailController</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">MailService</span> mailService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/sendEmail"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">sendEmail</span><span class="token punctuation">(</span><span class="token class-name">ToEmail</span> toEmail<span class="token punctuation">,</span> <span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>toEmail <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> toEmail<span class="token punctuation">.</span><span class="token function">getTos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"参数错误!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        toEmail<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span><span class="token string">"你本次的验证码是"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取验证码</span>
        <span class="token class-name">String</span> verCode <span class="token operator">=</span> <span class="token class-name">VerCodeGenerateUtil</span><span class="token punctuation">.</span><span class="token function">generateVerCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> content <span class="token operator">=</span> <span class="token string">"尊敬的xxx,您好:\n"</span>
                <span class="token operator">+</span> <span class="token string">"\n本次请求的邮件验证码为:"</span> <span class="token operator">+</span> verCode <span class="token operator">+</span> <span class="token string">",本验证码 5 分钟内效，请及时输入。（请勿泄露此验证码）\n"</span>
                <span class="token operator">+</span> <span class="token string">"\n如非本人操作，请忽略该邮件。\n(这是一封通过自动发送的邮件，请不要直接回复）"</span><span class="token punctuation">;</span>
        toEmail<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Boolean</span> check <span class="token operator">=</span> mailService<span class="token punctuation">.</span><span class="token function">sendTextMail</span><span class="token punctuation">(</span>toEmail<span class="token punctuation">.</span><span class="token function">getTos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> toEmail<span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> toEmail<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>check<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"发送成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"发送失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <ul><li>AjaxResult 统一格式返回类，包含 状态码 code ， 状态码描述信息 msg， 返回的数据 data；</li></ul> 
</blockquote> 
<h2><a id="4__307"></a>4 功能测试</h2> 
<p>使用 PostMan测试</p> 
<p><img src="https://images2.imgbox.com/d0/1b/p5iDewXD_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p>其中 tos 的 val 值是要收件人的邮箱；</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/2b/2e/tXAeAGZz_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e35cbb825a6ef2be47d3a84cf8d57d34/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">20230702 正态分布的几个性质</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/730ae093b1c9d78f151cefe3b78fa253/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MOBAXterm软件上实现一个命令多个终端同时执行</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>