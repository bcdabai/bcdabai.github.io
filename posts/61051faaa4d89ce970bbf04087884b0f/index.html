<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>经典mysql数据库面试题_【数据库】MySQL经典面试题（练习） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="经典mysql数据库面试题_【数据库】MySQL经典面试题（练习）" />
<meta property="og:description" content="id number(32) NOT NULL,
name varchar(10) DEFAULT NULL,
sax varchar(10) DEFAULT NULL,
age number(6) DEFAULT NULL,
PRIMARY KEY (id)
)
insert into tbl_students (id, name, sax, age) values(&#39;2&#39;,&#39;李四&#39;,&#39;男&#39;,&#39;21&#39;);
insert into tbl_students (id, name, sax, age) values(&#39;3&#39;,&#39;张三&#39;,&#39;女&#39;,&#39;17&#39;);
insert into tbl_students (id, name, sax, age) values(&#39;4&#39;,&#39;李四&#39;,&#39;男&#39;,&#39;12&#39;);
insert into tbl_students (id, name, sax, age) values(&#39;6&#39;,&#39;凤姐&#39;,&#39;女&#39;,&#39;20&#39;);
insert into tbl_students (id, name, sax, age) values(&#39;5&#39;,&#39;凤姐&#39;,&#39;女&#39;,&#39;20&#39;);
insert into tbl_students (id, name, sax, age) values(&#39;7&#39;,&#39;田七&#39;,&#39;男&#39;,&#39;18&#39;);
insert into tbl_students (id, name, sax, age) values(&#39;1&#39;,&#39;田七&#39;,&#39;男&#39;,&#39;18&#39;);" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/61051faaa4d89ce970bbf04087884b0f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-19T14:51:18+08:00" />
<meta property="article:modified_time" content="2021-01-19T14:51:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">经典mysql数据库面试题_【数据库】MySQL经典面试题（练习）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>id number(32) NOT NULL,</p> 
 <p>name varchar(10) DEFAULT NULL,</p> 
 <p>sax varchar(10) DEFAULT NULL,</p> 
 <p>age number(6) DEFAULT NULL,</p> 
 <p>PRIMARY KEY (id)</p> 
 <p>)</p> 
 <p>insert into tbl_students (id, name, sax, age) values('2','李四','男','21');</p> 
 <p>insert into tbl_students (id, name, sax, age) values('3','张三','女','17');</p> 
 <p>insert into tbl_students (id, name, sax, age) values('4','李四','男','12');</p> 
 <p>insert into tbl_students (id, name, sax, age) values('6','凤姐','女','20');</p> 
 <p>insert into tbl_students (id, name, sax, age) values('5','凤姐','女','20');</p> 
 <p>insert into tbl_students (id, name, sax, age) values('7','田七','男','18');</p> 
 <p>insert into tbl_students (id, name, sax, age) values('1','田七','男','18');</p> 
 <p>insert into tbl_students (id, name, sax, age) values('8','张三','男','17');</p> 
 <p>答案：</p> 
 <p>mySql</p> 
 <p>DELETE FROM student WHERE sid NOT IN (SELECT sid FROM ((SELECT MIN(sid) sid FROM student GROUP BY sName,sSex ))t)</p> 
 <p>oracle：</p> 
 <p>DELETE FROM student WHERE sid NOT IN(SELECT MIN(sid) sid FROM student GROUP BY sName,sSex )</p> 
 <p>二、查询各科成绩都及格的学员</p> 
 <p>(要求查询出参加考试的各科成绩都高于60分，不管参加了多少科考试)</p> 
 <p align="center"><img src="https://images2.imgbox.com/01/b7/1RnsE6kK_o.png" alt="0d1396bb501e8aafa593985c4f44229a.png"></p> 
 <p>要求结果：</p> 
 <p align="center"><img src="https://images2.imgbox.com/a0/01/bFsasfQy_o.png" alt="a215e2ff0a38508a9cfc694eee18c1b0.png"></p> 
 <p>表：</p> 
 <p>CREATE TABLE tbl_score (</p> 
 <p>id NUMBER(10) NOT NULL,</p> 
 <p>username varchar(20) DEFAULT NULL,</p> 
 <p>course varchar(20) DEFAULT NULL,</p> 
 <p>score NUMBER(10) DEFAULT NULL,</p> 
 <p>PRIMARY KEY (id)</p> 
 <p>)</p> 
 <p>数据：</p> 
 <p>insert into tbl_score (id, username, course, score) values('1','张三','语文','50');</p> 
 <p>insert into tbl_score (id, username, course, score) values('2','张三','数学','80');</p> 
 <p>insert into tbl_score (id, username, course, score) values('3','张三','英语','90');</p> 
 <p>insert into tbl_score (id, username, course, score) values('4','李四','语文','70');</p> 
 <p>insert into tbl_score (id, username, course, score) values('5','李四','数学','80');</p> 
 <p>insert into tbl_score (id, username, course, score) values('6','李四','英语','80');</p> 
 <p>insert into tbl_score (id, username, course, score) values('7','王五','语文','50');</p> 
 <p>insert into tbl_score (id, username, course, score) values('8','王五','英语','70');</p> 
 <p>insert into tbl_score (id, username, course, score) values('9','赵六','数学','90');</p> 
 <p>答案：</p> 
 <p>select username,scor from tbl where id not in (select id from tbl where score &lt; 60)</p> 
 <p>MySQL题型练习</p> 
 <p>表(MYSQL)</p> 
 <p>Student(sid,Sname,Sage,Ssex) 学生表</p> 
 <p>CREATE TABLE student (</p> 
 <p>sid varchar(10) NOT NULL,</p> 
 <p>sName varchar(20) DEFAULT NULL,</p> 
 <p>sAge datetime DEFAULT '1980-10-12 23:12:36',</p> 
 <p>sSex varchar(10) DEFAULT NULL,</p> 
 <p>PRIMARY KEY (sid)</p> 
 <p>) ENGINE=InnoDB DEFAULT CHARSET=utf8;</p> 
 <p>Course(cid,Cname,tid) 课程表</p> 
 <p>CREATE TABLE course (</p> 
 <p>cid varchar(10) NOT NULL,</p> 
 <p>cName varchar(10) DEFAULT NULL,</p> 
 <p>tid int(20) DEFAULT NULL,</p> 
 <p>PRIMARY KEY (cid)</p> 
 <p>) ENGINE=InnoDB DEFAULT CHARSET=utf8;</p> 
 <p>SC(sid,cid,score) 成绩表</p> 
 <p>CREATE TABLE sc (</p> 
 <p>sid varchar(10) DEFAULT NULL,</p> 
 <p>cid varchar(10) DEFAULT NULL,</p> 
 <p>score int(10) DEFAULT NULL</p> 
 <p>) ENGINE=InnoDB DEFAULT CHARSET=utf8;</p> 
 <p>Teacher(tid,Tname) 教师表</p> 
 <p>CREATE TABLE taacher (</p> 
 <p>tid int(10) DEFAULT NULL,</p> 
 <p>tName varchar(10) DEFAULT NULL</p> 
 <p>) ENGINE=InnoDB DEFAULT CHARSET=utf8;</p> 
 <p>数据：(MySQL)</p> 
 <p>insert into taacher(tid,tName) values (1,'李老师'),(2,'何以琛'),(3,'叶平');</p> 
 <p>insert into student(sid,sName,sAge,sSex) values ('1001','张三丰','1980-10-12 23:12:36','男'),('1002','张无极','1995-10-12 23:12:36','男'),('1003','李奎','1992-10-12 23:12:36','女'),('1004','李元宝','1980-10-12 23:12:36','女'),('1005','李世明','1981-10-12 23:12:36','男'),('1006','赵六','1986-10-12 23:12:36','男'),('1007','田七','1981-10-12 23:12:36','女');</p> 
 <p>insert into sc(sid,cid,score) values ('1','001',80),('1','002',60),('1','003',75),('2','001',85),('2','002',70),('3','004',100),('3','001',90),('3','002',55),('4','002',65),('4','003',60);</p> 
 <p>insert into course(cid,cName,tid) values ('001','企业管理',3),('002','马克思',3),('003','UML',2),('004','数据库',1),('005','英语',1);</p> 
 <p>(扩展Oracle)ORACLE(表+数据)</p> 
 <p>CREATETABLEstudent (</p> 
 <p>sidvarchar2(10)NOTNULL,</p> 
 <p>sNamevarchar2(20)DEFAULTNULL,</p> 
 <p>sAgedate,</p> 
 <p>sSexvarchar2(10)DEFAULTNULL,</p> 
 <p>PRIMARYKEY(sid)</p> 
 <p>)</p> 
 <p>CREATETABLEcourse (</p> 
 <p>cidvarchar2(10)NOTNULL,</p> 
 <p>cNamevarchar2(10)DEFAULTNULL,</p> 
 <p>tidnumber(20)DEFAULTNULL,</p> 
 <p>PRIMARYKEY(cid)</p> 
 <p>)</p> 
 <p>CREATETABLEsc (</p> 
 <p>sidvarchar2(10)DEFAULTNULL,</p> 
 <p>cidvarchar2(10)DEFAULTNULL,</p> 
 <p>scorenumber(10)DEFAULTNULL</p> 
 <p>)</p> 
 <p>CREATETABLEteacher (</p> 
 <p>tidnumber(10)DEFAULTNULL,</p> 
 <p>tNamevarchar2(10)DEFAULTNULL</p> 
 <p>)</p> 
 <p>insertintocourse(cid,cName,tid)values('001','企业管理',3);</p> 
 <p>insertintocourse(cid,cName,tid)values('002','马克思',3);</p> 
 <p>insertintocourse(cid,cName,tid)values('004','数据库',1);</p> 
 <p>insertintocourse(cid,cName,tid)values('005','英语',1);</p> 
 <p>insertintosc(sid,cid,score)values('1001','001',80);</p> 
 <p>insertintosc(sid,cid,score)values('1001','002',60);</p> 
 <p>insertintosc(sid,cid,score)values('1001','003',70);</p> 
 <p>insertintosc(sid,cid,score)values('1002','001',85);</p> 
 <p>insertintosc(sid,cid,score)values('1002','002',70);</p> 
 <p>insertintosc(sid,cid,score)values('1003','004',90);</p> 
 <p>insertintosc(sid,cid,score)values('1003','001',90);</p> 
 <p>insertintosc(sid,cid,score)values('1003','002',99);</p> 
 <p>insertintosc(sid,cid,score)values('1004','002',65);</p> 
 <p>insertintosc(sid,cid,score)values('1004','003',50);</p> 
 <p>insertintosc(sid,cid,score)values('1005','005',80);</p> 
 <p>insertintosc(sid,cid,score)values('1005','004',70);</p> 
 <p>insertintosc(sid,cid,score)values('1003','003',10);</p> 
 <p>insertintosc(sid,cid,score)values('1003','005',10);</p> 
 <p>insertintostudent(sid,sName,sAge,sSex)values('1001','张三丰',to_date('1980-10-12 23:12:36','YYYY-MM-DD HH24:MI:SS'),'男');</p> 
 <p>insertintostudent(sid,sName,sAge,sSex)values('1002','张无极',to_date('1995-10-12 23:12:36','YYYY-MM-DD HH24:MI:SS'),'男');</p> 
 <p>insertintostudent(sid,sName,sAge,sSex)values('1003','李奎',to_date('1992-10-12 23:12:36','YYYY-MM-DD HH24:MI:SS'),'女');</p> 
 <p>insertintostudent(sid,sName,sAge,sSex)values('1004','李元宝',to_date('1980-10-12 23:12:36','YYYY-MM-DD HH24:MI:SS'),'女');</p> 
 <p>insertintostudent(sid,sName,sAge,sSex)values('1005','李世明',to_date('1981-10-12 23:12:36','YYYY-MM-DD HH24:MI:SS'),'男');</p> 
 <p>insertintostudent(sid,sName,sAge,sSex)values('1006','赵六',to_date('1986-10-12 23:12:36','YYYY-MM-DD HH24:MI:SS'),'男');</p> 
 <p>insertintostudent(sid,sName,sAge,sSex)values('1007','田七',to_date('1981-10-12 23:12:36','YYYY-MM-DD HH24:MI:SS'),'女');</p> 
 <p>insertintoteacher(tid,tName)values(1,'李老师');</p> 
 <p>insertintoteacher(tid,tName)values(2,'何以琛');</p> 
 <p>insertintoteacher(tid,tName)values(3,'叶平');</p> 
 <p>SQL问题：</p> 
 <p>1.查询“001”课程比“002”课程成绩高的所有学生的学号;</p> 
 <p>select a.sid from (select sid,score from SC where cid='001') a,(select sid,score</p> 
 <p>from SC where cid='002') b</p> 
 <p>where a.score&gt;b.score and a.sid=b.sid;</p> 
 <p>2、查询平均成绩大于60分的同学的学号和平均成绩;</p> 
 <p>select sid,avg(score)</p> 
 <p>from sc</p> 
 <p>group by sid having avg(score) &gt;60;</p> 
 <p>3、查询所有同学的学号、姓名、选课数、总成绩;</p> 
 <p>select Student.sid,Student.Sname,count(SC.cid),sum(score)</p> 
 <p>from Student left Outer join SC on Student.sid=SC.sid</p> 
 <p>group by Student.sid,Sname</p> 
 <p>4、查询姓“李”的老师的个数;</p> 
 <p>select count(distinct(Tname))</p> 
 <p>from Teacher</p> 
 <p>where Tname like '李%';</p> 
 <p>5、查询没学过“叶平”老师课的同学的学号、姓名;</p> 
 <p>select Student.sid,Student.Sname</p> 
 <p>from Student</p> 
 <p>where sid not in (select distinct( SC.sid) from SC,Course,Teacher where SC.cid=Course.cid and Teacher.tid=Course.tid and Teacher.Tname='叶平');</p> 
 <p>6、查询学过“001”并且也学过编号“002”课程的同学的学号、姓名;</p> 
 <p>A:select Student.sid,Student.Sname from Student,SC where Student.sid=SC.sid and SC.cid='001'and exists( Select * from SC as SC_2 where SC_2.sid=SC.sid and SC_2.cid='002');</p> 
 <p>B:SELECTs.sid,s.sName</p> 
 <p>FROMstudent s,(SELECT sid,COUNT(cid) FROM sc WHERE cid IN ('001','002') GROUP BY sid HAVING COUNT(cid)&gt;=2) t WHERE s.sid = t.sid</p> 
 <p>7、查询学过“叶平”老师所教的所有课的同学的学号、姓名;</p> 
 <p>select sid,Sname</p> 
 <p>from Student</p> 
 <p>where sid in (select sid from SC ,Course ,Teacher where SC.cid=Course.cid and Teacher.tid=Course.tid and Teacher.Tname='叶平' group by sid having count(SC.cid)=(select count(cid) from Course,Teacher where Teacher.tid=Course.tid and Tname='叶平'));</p> 
 <p>8、查询课程编号“002”的成绩比课程编号“001”课程低的所有同学的学号、姓名;</p> 
 <p>1&gt;Select sid,Sname from (select Student.sid,Student.Sname,score ,(select score from SC SC_2 where SC_2.sid=Student.sid and SC_2.cid='002') score2</p> 
 <p>from Student,SC where Student.sid=SC.sid and cid='001') S_2 where score2 </p> 
 <p>2&gt;SELECT s.sid,s.sName FROM student s,</p> 
 <p>(SELECT sid,score FROM sc WHERE cid = '001') sc_1,</p> 
 <p>(SELECT sid,score FROM sc WHERE cid = '002') sc_2</p> 
 <p>WHERE sc_1.sid = sc_2.sid AND s.sid = sc_2.sid AND sc_2.score &lt; sc_1.score</p> 
 <p>9、查询所有课程成绩小于60分的同学的学号、姓名;</p> 
 <p>select sid,Sname</p> 
 <p>from Student</p> 
 <p>where sid not in (select Student.sid from Student,SC where S.sid=SC.sid and score&gt;60);</p> 
 <p>10、查询没有学全所有课的同学的学号、姓名;</p> 
 <p>1&gt;select Student.sid,Student.Sname</p> 
 <p>from Student,SC</p> 
 <p>where Student.sid=SC.sid group by Student.sid,Student.Sname having count(cid) </p> 
 <p>2&gt;SELECT s.sid,s.sname FROM student s,</p> 
 <p>(SELECT sid,COUNT(cid) FROM sc GROUP BY sid HAVING COUNT(cid) &lt; (SELECT COUNT(cid) FROM course) )t</p> 
 <p>WHERE s.sid = t.sid</p> 
 <p>11、查询至少有一门课与学号为“1001”的同学所学相同的同学的学号和姓名;</p> 
 <p>select sid,Sname from Student,SC where Student.sid=SC.sid and cid in (select cid from SC where sid='1001');</p> 
 <p>13、把“SC”表中“叶平”老师教的课的成绩都更改为此课程的平均成绩;</p> 
 <p>UPDATE sc,(SELECT c.cid,AVG(score) avgs FROM sc,course c,teacher t WHERE sc.cid = c.cid AND</p> 
 <p>c.tid = t.tid AND t.tName = '叶平' GROUP BY c.cid)sc_2 SET sc.score = sc_2.avgs WHERE sc.cid = sc_2.cid</p> 
 <p>14、查询和“1002”号的同学学习的课程完全相同的其他同学学号和姓名;</p> 
 <p>select sid from SC where cid in (select cid from SC where sid='1002')</p> 
 <p>group by sid having count(*)=(select count(*) from SC where sid='1002');</p> 
 <p>15、删除学习“叶平”老师课的SC表记录;</p> 
 <p>DELETE FROM sc WHERE sc.cid IN (SELECT sc.cid FROM course c ,teacher t WHERE sc.cid = c.cid AND c.tid = t.tid AND t.tName = '叶平')</p> 
 <p>17、按平均成绩从高到低显示所有学生的“数据库”、“企业管理”、“英语”三门的课程成绩，按如下形式显示： 学生ID,,数据库,企业管理,英语,有效课程数,有效平均分</p> 
 <p>SELECT sid as 学生ID</p> 
 <p>,(SELECT score FROM SC WHERE SC.sid=t.sid AND cid='004') AS 数据库</p> 
 <p>,(SELECT score FROM SC WHERE SC.sid=t.sid AND cid='001') AS 企业管理</p> 
 <p>,(SELECT score FROM SC WHERE SC.sid=t.sid AND cid='005') AS 英语</p> 
 <p>,COUNT(*) AS 有效课程数, AVG(t.score) AS 平均成绩</p> 
 <p>FROM SC AS t</p> 
 <p>GROUP BY sid</p> 
 <p>ORDER BY avg(t.score)</p> 
 <p>18、查询各科成绩最高和最低的分：以如下形式显示：课程ID，最高分，最低分</p> 
 <p>selectcid "课程ID",max(score) "最高分",min(score) "最低分"fromscgroupbycid</p> 
 <p>19、按各科平均成绩从低到高和及格率的百分数从高到低排序</p> 
 <p>oracle&gt;</p> 
 <p>SELECTt.cidAS课程号,MAX(course.Cname)AS课程名,nvl(AVG(score),0)AS平均成绩,100*SUM(CASEWHENnvl(score,0)&gt;=60THEN1ELSE0END)/COUNT(*)AS及格百分数</p> 
 <p>FROMSC T,Course</p> 
 <p>WHEREt.cid=course.cid</p> 
 <p>GROUPBYt.cid</p> 
 <p>ORDERBY100*SUM(CASEWHENnvl(score,0)&gt;=60THEN1ELSE0END)/COUNT(*)DESC</p> 
 <p>Mysql&gt;</p> 
 <p>SELECT t.cid AS课程号,MAX(course.Cname)AS课程名,IFNULL(AVG(score),0) AS平均成绩,100 * SUM(CASE WHEN IFNULL(score,0)&gt;=60 THEN 1 ELSE 0 END)/COUNT(*) AS及格百分数</p> 
 <p>FROM SC T,Course</p> 
 <p>WHERE t.cid=course.cid</p> 
 <p>GROUP BY t.cid</p> 
 <p>ORDER BY 100 * SUM(CASE WHEN IFNULL(score,0)&gt;=60 THEN 1 ELSE 0 END)/COUNT(*) DESC</p> 
 <p>20、查询如下课程平均成绩和及格率的百分数(用"1行"显示):企业管理(001)，马克思(002)，OO&amp;UML(003)，数据库(004)</p> 
 <p>SELECT SUM(CASE WHEN cid ='001' THEN score ELSE 0 END)/SUM(CASE cid WHEN '001' THEN 1 ELSE 0 END) AS 企业管理平均分</p> 
 <p>,100 * SUM(CASE WHEN cid = '001' AND score &gt;= 60 THEN 1 ELSE 0 END)/SUM(CASE WHEN cid = '001' THEN 1 ELSE 0 END) AS 企业管理及格百分数</p> 
 <p>,SUM(CASE WHEN cid = '002' THEN score ELSE 0 END)/SUM(CASE cid WHEN '002' THEN 1 ELSE 0 END) AS 马克思平均分</p> 
 <p>,100 * SUM(CASE WHEN cid = '002' AND score &gt;= 60 THEN 1 ELSE 0 END)/SUM(CASE WHEN cid = '002' THEN 1 ELSE 0 END) AS 马克思及格百分数</p> 
 <p>,SUM(CASE WHEN cid = '003' THEN score ELSE 0 END)/SUM(CASE cid WHEN '003' THEN 1 ELSE 0 END) AS UML平均分</p> 
 <p>,100 * SUM(CASE WHEN cid = '003' AND score &gt;= 60 THEN 1 ELSE 0 END)/SUM(CASE WHEN cid = '003' THEN 1 ELSE 0 END) AS UML及格百分数</p> 
 <p>,SUM(CASE WHEN cid = '004' THEN score ELSE 0 END)/SUM(CASE cid WHEN '004' THEN 1 ELSE 0 END) AS 数据库平均分</p> 
 <p>,100 * SUM(CASE WHEN cid = '004' AND score &gt;= 60 THEN 1 ELSE 0 END)/SUM(CASE WHEN cid = '004' THEN 1 ELSE 0 END) AS 数据库及格百分数</p> 
 <p>FROM SC</p> 
 <p>21、查询不同老师所教不同课程平均分从高到低显示 要求显示：教师ID,教师姓名，课程ID,课程名称，平均成绩</p> 
 <p>SELECT MAX(t.tid) "教师ID",MAX(t.tName) "教师姓名",c.cid "课程ID", MAX(c.cName) "课程名称" ,AVG(sc.score) "平均成绩"</p> 
 <p>FROM sc,course c,teacher t WHERE sc.cid = c.cid AND c.tid = t.tid GROUP BY c.tid,c.cid</p> 
 <p>ORDER BY AVG(sc.score) DESC</p> 
 <p>23、统计列印各科成绩,各分数段人数:课程ID,课程名称,[100-85],[85-70],[70-60],[ &lt;60]</p> 
 <p>SELECT SC.cid as 课程ID, Cname as 课程名称</p> 
 <p>,SUM(CASE WHEN score BETWEEN 85 AND 100 THEN 1 ELSE 0 END) AS [100 - 85]</p> 
 <p>,SUM(CASE WHEN score BETWEEN 70 AND 85 THEN 1 ELSE 0 END) AS [85 - 70]</p> 
 <p>,SUM(CASE WHEN score BETWEEN 60 AND 70 THEN 1 ELSE 0 END) AS [70 - 60]</p> 
 <p>,SUM(CASE WHEN score &lt; 60 THEN 1 ELSE 0 END) AS [60 -]</p> 
 <p>FROM SC,Course</p> 
 <p>where SC.cid=Course.cid</p> 
 <p>GROUP BY SC.cid,Cname;</p> 
 <p>26、查询每门课程被选修的学生数</p> 
 <p>select cid,count(sid) from sc group by cid;</p> 
 <p>27、查询出只选修了一门课程的全部学生的学号和姓名</p> 
 <p>select SC.sid,Student.Sname,count(cid) AS 选课数</p> 
 <p>from SC ,Student</p> 
 <p>where SC.sid=Student.sid group by SC.sid ,Student.Sname having count(cid)=1;</p> 
 <p>28、查询男生、女生人数</p> 
 <p>Select count(Ssex) as 男生人数 from Student group by Ssex having Ssex='男';</p> 
 <p>Select count(Ssex) as 女生人数 from Student group by Ssex having Ssex='女';</p> 
 <p>29、查询姓“张”的学生名单</p> 
 <p>SELECT Sname FROM Student WHERE Sname like '张%';</p> 
 <p>30、查询同名同性学生名单，并统计同名人数</p> 
 <p>SELECT sName,sSex ,COUNT(*) FROM student GROUP BY sName,sSex HAVING COUNT(*) &gt; 1</p> 
 <p>31、1981年出生的学生名单(注：Student表中Sage列的类型是datetime)</p> 
 <p>Mysql&gt;</p> 
 <p>select Sname, CONVERT(char (11),DATEPART(year,Sage)) as age</p> 
 <p>from student</p> 
 <p>where CONVERT(char(11),DATEPART(year,Sage))='1981';</p> 
 <p>Oracle&gt;</p> 
 <p>select*fromstudentwheresubstr(to_char(sage,'yyyy-MM-dd'),1,4)='1981'</p> 
 <p>32、查询每门课程的平均成绩，结果按平均成绩升序排列，平均成绩相同时，按课程号降序排列</p> 
 <p>Select cid,Avg(score) from SC group by cid order by Avg(score),cid DESC ;</p> 
 <p>33、查询平均成绩大于85的所有学生的学号、姓名和平均成绩</p> 
 <p>select Sname,SC.sid ,avg(score)</p> 
 <p>from Student,SC</p> 
 <p>where Student.sid=SC.sid group by SC.sid,Sname having avg(score)&gt;85;</p> 
 <p>34、查询课程名称为“数据库”，且分数低于60的学生姓名和分数</p> 
 <p>Select Sname,isnull(score,0)</p> 
 <p>from Student,SC,Course</p> 
 <p>where SC.sid=Student.sid and SC.cid=Course.cid and Course.Cname='数据库'and score &lt;60;</p> 
 <p>35、查询所有学生的选课情况;</p> 
 <p>SELECT SC.sid,SC.cid,Sname,Cname</p> 
 <p>FROM SC,Student,Course</p> 
 <p>where SC.sid=Student.sid and SC.cid=Course.cid ;</p> 
 <p>36、查询任何一门课程成绩在70分以上的姓名、课程名称和分数;</p> 
 <p>SELECT distinct student.sid,student.Sname,SC.cid,SC.score</p> 
 <p>FROM student,Sc</p> 
 <p>WHERE SC.score&gt;=70 AND SC.sid=student.sid;</p> 
 <p>37、查询不及格的课程，并按课程号从大到小排列</p> 
 <p>select cid from sc where scor e &lt;60 order by cid ;</p> 
 <p>38、查询课程编号为003且课程成绩在80分以上的学生的学号和姓名;</p> 
 <p>select SC.sid,Student.Sname from SC,Student where SC.sid=Student.sid and Score&gt;80 and cid='003';</p> 
 <p>39、求选了课程的学生人数</p> 
 <p>select count(*) from sc;</p> 
 <p>40、查询选修“叶平”老师所授课程的学生中，成绩最高的学生姓名及其成绩</p> 
 <p>select Student.Sname,score</p> 
 <p>from Student,SC,Course C,Teacher</p> 
 <p>where Student.sid=SC.sid and SC.cid=C.cid and C.tid=Teacher.tid and Teacher.Tname='叶平' and SC.score=(select max(score)from SC where cid=C.cid );</p> 
 <p>41、查询各个课程及相应的选修人数</p> 
 <p>select count(*) from sc group by cid;</p> 
 <p>42、查询不同课程成绩相同的学生的学号、课程号、学生成绩</p> 
 <p>select distinct A.sid,B.score from SC A ,SC B where A.Score=B.Score and A.cid &lt;&gt;B.cid ;</p> 
 <p>43、查询每门功课成绩最好的前两名</p> 
 <p>SELECT *</p> 
 <p>FROM sc t1</p> 
 <p>WHERE (</p> 
 <p>SELECT COUNT(*)</p> 
 <p>FROM sc t2</p> 
 <p>WHERE t1.cid=t2.cid</p> 
 <p>AND t2.score&gt;=t1.score</p> 
 <p>) &lt;=2 ORDER BY t1.cid</p> 
 <p>44、统计每门课程的学生选修人数(超过10人的课程才统计)。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列</p> 
 <p>SELECT cid "课程号",COUNT(*) "选修人数" FROM sc GROUP BY cid HAVING COUNT(*) &gt;10 ORDER BY COUNT(*) DESC,cid</p> 
 <p>45、检索至少选修两门课程的学生学号</p> 
 <p>select sid</p> 
 <p>from sc</p> 
 <p>group by sid</p> 
 <p>having count(*) &gt; = 2</p> 
 <p>46、查询全部学生都选修的课程的课程号和课程名</p> 
 <p>SELECT s.sName,c.cName, COUNT(*) FROM student s,course c, sc WHERE s.sid = sc.sid AND sc.cid = c.cid GROUP BY sc.cid HAVING COUNT(*) = (SELECT COUNT(*) FROM student)</p> 
 <p>47、查询没学过“叶平”老师讲授的任一门课程的学生姓名</p> 
 <p>SELECT DISTINCT Sname FROM Student WHERE sid NOT IN (SELECT sid FROM Course,Teacher,SC WHERE Course.tid=Teacher.tid AND SC.cid=course.cid AND Tname='叶平');</p> 
 <p>48、查询两门以上不及格课程的同学的学号及其平均成绩</p> 
 <p>select sid,avg(ifnull(score,0)) from SC where sid in (select sid from SC where score &lt;60 group by sid having count(*)&gt;2)group by sid;</p> 
 <p>49、检索“004”课程分数小于60，按分数降序排列的同学学号</p> 
 <p>select sid from SC where cid='004'and score &lt;60 order by score desc;</p> 
 <p>50、删除“1002”同学的“001”课程的成绩</p> 
 <p>delete from Sc where sid='1002' and cid='001';</p> 
 <p>行转列</p> 
 <p>CREATE TABLE stu_score (</p> 
 <p>grade_id varchar(10) DEFAULT NULL,</p> 
 <p>subject_name varchar(10) DEFAULT NULL,</p> 
 <p>max_score int(10) DEFAULT NULL</p> 
 <p>)</p> 
 <p>insert into `stu_score`(`grade_id`,`subject_name`,`max_score`) values('1','语文',98);</p> 
 <p>insert into `stu_score`(`grade_id`,`subject_name`,`max_score`) values('2','数学',95);</p> 
 <p>insert into `stu_score`(`grade_id`,`subject_name`,`max_score`) values('2','政治',87);</p> 
 <p>insert into `stu_score`(`grade_id`,`subject_name`,`max_score`) values('5','语文',97);</p> 
 <p>insert into `stu_score`(`grade_id`,`subject_name`,`max_score`) values('5','数学',100);</p> 
 <p>insert into `stu_score`(`grade_id`,`subject_name`,`max_score`) values('5','政治',92);</p> 
 <p>1.查询出要求的结果格式</p> 
 <p>SELECT</p> 
 <p>CASE grade_id WHEN 1 THEN '一年级'</p> 
 <p>WHEN 2 THEN '二年级'</p> 
 <p>WHEN 5 THEN '五年级'</p> 
 <p>END AS '年级',</p> 
 <p>CASE subject_name WHEN '语文' THEN max_score END AS '语文',</p> 
 <p>CASE subject_name WHEN '数学' THEN max_score END AS '数学',</p> 
 <p>CASE subject_name WHEN '政治' THEN max_score END AS '政治'</p> 
 <p>FROM stu_score</p> 
 <p>2,去除null</p> 
 <p>SELECT</p> 
 <p>CASE grade_id WHEN 1 THEN '一年级'</p> 
 <p>WHEN 2 THEN '二年级'</p> 
 <p>WHEN 5 THEN '五年级'</p> 
 <p>END AS '年级',</p> 
 <p>IFNULL(CASE subject_name WHEN '语文' THEN max_score END,0)AS '语文',</p> 
 <p>IFNULL(CASE subject_name WHEN '数学' THEN max_score END,0) AS '数学',</p> 
 <p>IFNULL(CASE subject_name WHEN '政治' THEN max_score END,0) AS '政治'</p> 
 <p>FROM stu_score</p> 
 <p>3.合并结果。</p> 
 <p>SELECT</p> 
 <p>CASE grade_id WHEN 1 THEN '一年级'</p> 
 <p>WHEN 2 THEN '二年级'</p> 
 <p>WHEN 5 THEN '五年级'</p> 
 <p>END AS '年级',</p> 
 <p>MAX(IFNULL(CASE subject_name WHEN '语文' THEN max_score END,0)) AS '语文',</p> 
 <p>MAX(IFNULL(CASE subject_name WHEN '数学' THEN max_score END,0)) AS '数学',</p> 
 <p>MAX(IFNULL(CASE subject_name WHEN '政治' THEN max_score END,0)) AS '政治'</p> 
 <p>FROM stu_score</p> 
 <p>GROUP BY grade_id</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1a06a69ef850ff7fda53e24fb7b69a97/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mysql中func什么意思_在C语言程序中，func()是什么意思？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fa919e803f5355e10e52c3a89467a059/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mysql的两个时间比较大小_mysql中日期比较大小的方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>