<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Java导出Word文档的实现 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Java导出Word文档的实现" />
<meta property="og:description" content="在日常的开发工作中，我们时常会遇到导出Word文档报表的需求，比如公司的财务报表、医院的患者统计报表、电商平台的销售报表等等。
导出Word方式多种多样，通常有以下几种方式：
1. 使用第三方Java工具类库Hutool的Word工具类，参考网址为https://www.hutool.cn/docs/#/poi/Word生成-Word07Writer;
2. 利用Apache POI 和 FreeMarker模板引擎;
3. 第三方报表工具。
上面的几种方式虽然可以实现Word文档的导出，但有以下缺点：
第一种方式操作简单，但也只能生成简单的Word文档，无法生成有表格的Word文档；
第二种方式可以生成复杂的Word文档，但是还要进行Word转xml，xml转ftl的双重转换，不适合内容经常变更的Word文档；
第三种方式有时候不适合对格式要求严格的文档。
那么，有没有既简单又高效的导出Word的方法呢？答案是肯定有的。接下来我就来介绍一种用Java语言实现的，通过XDocReport和FreeMarker模板引擎生成Word文档的方法。
准备环境 开发语言：
Java7及以上的版本。
开发工具：
Eclipse/Idea。
第三方依赖库：
XDocReport、POI、Freemarker。
模板语言：
FreeMarker。
Word编辑器：
Microsoft 365或其他版本较高的Word编辑器。
示例Word模板 制作模板 Word模板如上图，可以看到，结构比较简单，包括两个部分，第一部分是纯文字和数字，第二部分主要是表格。我们在实际的开发过程中生成的报表几乎都是动态生成的，所以模板中的数字和表格里的数据都要替换成我们后台的实际数据。
替换Word模板中的动态变量，我们需要掌握两个知识点：
1.Word文档中的Word域，word域是引导Word在文档中自动插入文字、图形、页码或其他信息的一组代码。在这里我们可以把 Word域理解成标识符，这个标识符表示Word文档中要被替换的内容；
2.FreeMarker模板下的变量表达式，比如用${city}替换Word示例模板中的北京市。
了解了以上两个概念后，我们就可以动手编辑Word模板了，步骤如下：
1. 首先在Word模板中选中要替换的文本，在这儿拿标题中的&#34;北京市&#34;为例，然后键盘使用 Ctrl &#43; F9 组合键将其设置为域，此时文本会被&#34;{}&#34;包围，接着鼠标右键选择【编辑域(E)...】：
2. 在弹出的对话框中，类别选择“邮件合并”，域名选择 &#34;MergeField&#34;，域属性中的域名填入模版表达式${city}，点击【确定】按钮:
3. 编辑后的效果如下：
4. 掌握替换文本的方法后，我们可以把Word模板第一部分需要替换的内容都替换成模板变量：
Word模板中表格数据的处理 表格中的数据实质上就是对集合的遍历。
表格数据的处理其实和上面对文本内容的处理是类似的，只不过要在Word模板中加上集合的变量，Java代码中也要有对集合进行特对的处理(这个在后面的代码展示部分会说)。
具体操作步骤如下：
1. 选定表格中要替换的文本，然后键盘使用 Ctrl &#43; F9 组合键将其设置为域，接着鼠标右键选择【编辑域(E)...】：
2. 在弹出的对话框中，类别选择“邮件合并”，域名选择 &#34;MergeField&#34;，域属性中的域名填入模版表达式${goods.num}，点击【确定】按钮；
3. 重复步骤2，替换表格中的其他文本内容：
后台代码 添加依赖到pom.xml文件
&lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi&lt;/artifactId&gt; &lt;version&gt;4." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/04d04fcaf1c7edaf5ad568a84564a865/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-21T22:44:49+08:00" />
<meta property="article:modified_time" content="2022-09-21T22:44:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Java导出Word文档的实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<p><a name="t1"></a>在日常的开发工作中，我们时常会遇到导出Word文档报表的需求，比如公司的财务报表、医院的患者统计报表、电商平台的销售报表等等。</p> 
<p><strong>导出Word方式多种多样，通常有以下几种方式：</strong></p> 
<p>    1. 使用第三方Java工具类库Hutool的Word工具类，参考网址为<u><a href="https://www.hutool.cn/docs/#/poi/Word%E7%94%9F%E6%88%90-Word07Writer" rel="nofollow" title="https://www.hutool.cn/docs/#/poi/Word生成-Word07Writer">https://www.hutool.cn/docs/#/poi/Word生成-Word07Writer</a>;</u></p> 
<p>    2. 利用<a href="https://so.csdn.net/so/search?q=Apache&amp;spm=1001.2101.3001.7020" title="Apache">Apache</a> POI 和 FreeMarker模板引擎;</p> 
<p>    3. 第三方报表工具。</p> 
<p><strong>上面的几种方式虽然可以实现Word文档的导出，但有以下缺点：</strong></p> 
<p>    第一种方式操作简单，但也只能生成简单的Word文档，无法生成有表格的Word文档；</p> 
<p>    第二种方式可以生成复杂的Word文档，但是还要进行Word转xml，xml转ftl的双重转换，不适合内容经常变更的Word文档；</p> 
<p>    第三种方式有时候不适合对格式要求严格的文档。</p> 
<p><strong><span style="color:#fe2c24;">那么，有没有既简单又高效的导出Word的方法呢？答案是肯定有的。接下来我就来介绍一种用Java语言实现的，通过XDocReport和FreeMarker<a href="https://so.csdn.net/so/search?q=%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E&amp;spm=1001.2101.3001.7020" title="模板引擎">模板引擎</a>生成Word文档的方法。</span></strong></p> 
<h4><a name="t2"></a></h4> 
<h4><a name="t3"></a>准备环境</h4> 
<p><strong>开发语言：</strong></p> 
<p>Java7及以上的版本。</p> 
<p><strong>开发工具：</strong></p> 
<p>Eclipse/Idea。</p> 
<p><strong>第三方依赖库：</strong></p> 
<p>XDocReport、POI、<a href="https://so.csdn.net/so/search?q=Freemarker&amp;spm=1001.2101.3001.7020" title="Freemarker">Freemarker</a>。</p> 
<p><strong>模板语言：</strong></p> 
<p>FreeMarker。</p> 
<p><strong>Word编辑器：</strong></p> 
<p>Microsoft 365或其他版本较高的Word编辑器。</p> 
<p></p> 
<h4><a name="t4"></a>示例Word模板</h4> 
<p><img alt="" src="https://images2.imgbox.com/56/db/T0fx6seS_o.png"></p> 
<h4><a name="t5"></a>                     </h4> 
<h4><a name="t6"></a>制作模板</h4> 
<p>Word模板如上图，可以看到，结构比较简单，包括两个部分，第一部分是纯文字和数字，第二部分主要是表格。我们在实际的开发过程中生成的报表几乎都是动态生成的，所以模板中的数字和表格里的数据都要替换成我们后台的实际数据。</p> 
<p>替换Word模板中的动态变量，我们需要掌握两个知识点：</p> 
<p>    1.Word文档中的Word域，word域是引导Word在文档中自动插入文字、图形、页码或其他信息的一组代码。在这里我们可以把         Word域理解成标识符，这个标识符表示Word文档中要被替换的内容；</p> 
<p>    2.FreeMarker模板下的变量表达式，比如用${city}替换Word示例模板中的北京市。</p> 
<p>了解了以上两个概念后，我们就可以动手编辑Word模板了，<strong>步骤如下：</strong></p> 
<p>1. 首先在Word模板中选中要替换的文本，在这儿拿标题中的"北京市"为例，然后键盘使用 Ctrl + F9 组合键将其设置为域，此时文本会被"{}"包围，接着鼠标右键选择【编辑域(<u>E</u>)...】：</p> 
<p><img alt="" height="281" src="https://images2.imgbox.com/00/b4/kCkOQdAs_o.png" width="498"></p> 
<p>2. 在弹出的对话框中，类别选择“邮件合并”，域名选择 "MergeField"，域属性中的域名填入模版表达式${city}，点击【确定】按钮:</p> 
<p><img alt="" height="508" src="https://images2.imgbox.com/03/55/3mA5fkhD_o.png" width="702"></p> 
<p>3. 编辑后的效果如下：</p> 
<p><img alt="" height="147" src="https://images2.imgbox.com/d1/43/PM6j66Pe_o.png" width="458"></p> 
<p>4. 掌握替换文本的方法后，我们可以把Word模板第一部分需要替换的内容都替换成模板变量：</p> 
<p><img alt="" height="263" src="https://images2.imgbox.com/1a/77/i58zJGWA_o.png" width="448"></p> 
<h4><a name="t7"></a>Word模板中表格数据的处理</h4> 
<p>表格中的数据实质上就是对集合的遍历。</p> 
<p>表格数据的处理其实和上面对文本内容的处理是类似的，只不过要在Word模板中加上集合的变量，Java代码中也要有对集合进行特对的处理(这个在后面的代码展示部分会说)。</p> 
<p>具体操作步骤如下：</p> 
<p>1. 选定表格中要替换的文本，然后键盘使用 Ctrl + F9 组合键将其设置为域，接着鼠标右键选择【编辑域(<u>E</u>)...】：</p> 
<p><img alt="" height="537" src="https://images2.imgbox.com/c5/d8/EdbX4Pjh_o.png" width="962"></p> 
<p>2. 在弹出的对话框中，类别选择“邮件合并”，域名选择 "MergeField"，域属性中的域名填入模版表达式${goods.num}，点击【确定】按钮；</p> 
<p>3. 重复步骤2，替换表格中的其他文本内容：</p> 
<p><img alt="" height="153" src="https://images2.imgbox.com/71/5b/8S1rldgD_o.png" width="508"></p> 
<h4><a name="t8"></a>后台代码</h4> 
<p>添加依赖到<strong>pom.xml</strong>文件</p> 
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
    &lt;artifactId&gt;poi&lt;/artifactId&gt;
    &lt;version&gt;4.1.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
    &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;
    &lt;version&gt;4.1.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.jxls&lt;/groupId&gt;
    &lt;artifactId&gt;jxls&lt;/artifactId&gt;
    &lt;version&gt;2.6.0&lt;/version&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
            &lt;artifactId&gt;logback-core&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.jxls&lt;/groupId&gt;
    &lt;artifactId&gt;jxls-poi&lt;/artifactId&gt;
    &lt;version&gt;1.2.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.core&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.document&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.template&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.document.docx&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.template.freemarker&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.freemarker&lt;/groupId&gt;
    &lt;artifactId&gt;freemarker&lt;/artifactId&gt;
    &lt;version&gt;2.3.23&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;commons-io&lt;/groupId&gt;
    &lt;artifactId&gt;commons-io&lt;/artifactId&gt;
    &lt;version&gt;2.5&lt;/version&gt;
&lt;/dependency&gt;</code></pre> 
<p>springboot项目中如果出现freemaker启动报错，是因为版本不匹配导致的，把上面的freemarker的依赖换成</p> 
<pre><code>        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;
        &lt;/dependency&gt;</code></pre> 
<p>编写Java代码</p> 
<pre><code>package com.tzsj.test;
 
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.List;
import org.junit.Test;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import fr.opensagres.xdocreport.core.XDocReportException;
import fr.opensagres.xdocreport.document.IXDocReport;
import fr.opensagres.xdocreport.document.registry.XDocReportRegistry;
import fr.opensagres.xdocreport.template.IContext;
import fr.opensagres.xdocreport.template.TemplateEngineKind;
import fr.opensagres.xdocreport.template.formatter.FieldsMetadata;
import io.renren.entity.Goods;
 
@Controller
@RequestMapping("/word")
public class WordTest {
	@Test
	public void test() throws IOException, XDocReportException {
		generateWord();
	}
	
	public void generateWord() throws IOException, XDocReportException {
		//获取Word模板，模板存放路径在项目的resources目录下
	    InputStream ins = this.getClass().getResourceAsStream("/模板.docx");
        //注册xdocreport实例并加载FreeMarker模板引擎
        IXDocReport report = XDocReportRegistry.getRegistry().loadReport(ins,     
                               TemplateEngineKind.Freemarker);
        //创建xdocreport上下文对象
        IContext context = report.createContext();
        
        //创建要替换的文本变量
        context.put("city", "北京市");
        context.put("startDate", "2020-09-17");
        context.put("endDate", "2020-10-16");
        context.put("totCnt", 3638763);
        context.put("totAmt", "6521");
        context.put("onCnt", 2874036);
        context.put("onAmt", "4768");
        context.put("offCnt", 764727);
        context.put("offAmt", "1753");
        context.put("typeCnt", 36);
        
        List&lt;Goods&gt; goodsList = new ArrayList&lt;Goods&gt;();
        Goods goods1 = new Goods();
        goods1.setNum(1);
        goods1.setType("臭美毁肤");
        goods1.setSv(675512);
        goods1.setSa("589");
        Goods goods2 = new Goods();
        goods2.setNum(2);
        goods2.setType("女装");
        goods2.setSv(602145);
        goods2.setSa("651");
        Goods goods3 = new Goods();
        goods3.setNum(3);
        goods3.setType("手机");
        goods3.setSv(587737);
        goods3.setSa("866");
        Goods goods4 = new Goods();
        goods4.setNum(4);
        goods4.setType("家具家装");
        goods4.setSv(551193);
        goods4.setSa("783");
        Goods goods5 = new Goods();
        goods5.setNum(5);
        goods5.setType("食物饮品");
        goods5.setSv(528604);
        goods5.setSa("405");
        goodsList.add(goods1);
        goodsList.add(goods2);
        goodsList.add(goods3);
        goodsList.add(goods4);
        goodsList.add(goods5);
        context.put("goods", goodsList);
        
        //创建字段元数据
        FieldsMetadata fm = report.createFieldsMetadata();
        //Word模板中的表格数据对应的集合类型
        fm.load("goods", Goods.class, true);
       
        //输出到本地目录
        FileOutputStream out = new FileOutputStream(new File("D://商品销售报表.docx"));
        report.process(context, out);
	}
 
}</code></pre> 
<h4><a name="t9"></a>Word模板中生成序号</h4> 
<p>给表格数据添加序号是通过后台代码生成的，比如上面的"goods1.setNum(1)"这段代码，其实也可以在Word模板中设置对应的域变量来实现序号的填充。</p> 
<p>语法如下：</p> 
<pre><code>@before-row[#list sequence as item]
    item?index
@after-row[/#list]</code></pre> 
<p>在表格中添加上面的表达式，XDocReport就会自动解析并生成序号，表格中的其他字段也需要进行相应的改动:</p> 
<p><img alt="" height="176" src="https://images2.imgbox.com/f8/5f/kTio6N36_o.png" width="592"></p> 
<p></p> 
<p><strong>提示：</strong></p> 
<p>1. <strong>序号的表达式要拆成三个域</strong>，如下图，要把这三部分分别设置成域；</p> 
<p><img alt="" height="114" src="https://images2.imgbox.com/6b/dc/r5iu10AW_o.png" width="532"></p> 
<p><strong>     设置完成的结果参考上面表格中的序号表达式，表达式中"item?index+1"是因为序号是从0开始的，所以要加1</strong>；</p> 
<p>2. 表格中除序号的列需要改成item.xxx而不是之前的goods.xxx:</p> 
<p><img alt="" height="146" src="https://images2.imgbox.com/bf/d4/ZGJOBo3v_o.png" width="363"></p> 
<p>3. 生成效果如下:</p> 
<p><img alt="" height="393" src="https://images2.imgbox.com/31/c5/0lmYom62_o.png" width="569"></p> 
<p><strong>建议：序号最好在后台生成</strong>，用序号表达式生成的序号列会占用比较大的空间，对资源有所浪费。</p> 
<h4><a name="t10"></a>补充</h4> 
<p>1. JavaWeb项目中通常是通过浏览器下载的方式来下载Word文档，此时只需要把之前下载到本地的代码改成浏览器端下载的代码即可：</p> 
<pre><code>//输出到本地目录
//FileOutputStream out = new FileOutputStream(new File("D://商品销售报表.docx"));
//report.process(context, out);
 
//浏览器端下载
response.setCharacterEncoding("utf-8");  
response.setContentType("application/msword");  
String fileName = "商品销售报表.docx";  
response.setHeader("Content-Disposition", "attachment;filename="  
				    .concat(String.valueOf(URLEncoder.encode(fileName, "UTF-8"))));  
report.process(context, response.getOutputStream());</code></pre> 
<p>2. Word模板中的表格的长度最好充满Word文档的左右两边，否则如果表格下面还有其他文本内容，下面的文本内容会自动填充到表格的缝隙处，而且会对下面的文本内容进行覆盖。</p> 
<p></p> 
<h4><a name="t11"></a>加餐</h4> 
<p>其实，导出Word模板，上面的模板和代码已经够用了，但也有少数模板需要添加图片和图形(比如饼状图)。</p> 
<p></p> 
<p><strong>制作图片</strong></p> 
<p>图片的生成<strong>不使用编辑域，使用模板图片和Word的书签功能，而且需要在元数据中加入图片类型的代码</strong>，以下为具体步骤：</p> 
<p>1. 在Word模版中需要插入图片的位置插入一张模版图片，然后鼠标单击模板图片插入一个书签，设置书签名称，比如img1， 最后点击【添加】按钮:</p> 
<p><img alt="" height="707" src="https://images2.imgbox.com/e7/a2/0AmwyXNP_o.png" width="1175"></p> 
<p> 2. 如果需要插入多个图片，就在需要插入图片的位置插入多个模板图片并插入书签设置对应的书签名称即可，后台代码如下： </p> 
<pre><code>package com.tzsj.test;
 
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import org.junit.Test;
import fr.opensagres.xdocreport.core.XDocReportException;
import fr.opensagres.xdocreport.document.IXDocReport;
import fr.opensagres.xdocreport.document.registry.XDocReportRegistry;
import fr.opensagres.xdocreport.template.IContext;
import fr.opensagres.xdocreport.template.TemplateEngineKind;
import fr.opensagres.xdocreport.template.formatter.FieldsMetadata;
 
public class ImgTest {
 
	@Test
	public void test() throws IOException, XDocReportException {
		generateWordForImg();
	}
	
	
	public void generateWordForImg() throws IOException, XDocReportException {
		//获取Word模板，模板存放路径在项目的resources目录下
	    InputStream ins = this.getClass().getResourceAsStream("/图片.docx");
        //注册xdocreport实例并加载FreeMarker模板引擎
        IXDocReport report = XDocReportRegistry.getRegistry().loadReport(ins, 
                               TemplateEngineKind.Freemarker);
        //创建xdocreport上下文对象
        IContext context = report.createContext();
        
        FieldsMetadata fm = report.createFieldsMetadata();
        //元数据中加入图片
        fm.addFieldAsImage("img1");
        fm.addFieldAsImage("img2");
        
        //获取图片
        InputStream img1 = this.getClass().getResourceAsStream("/11.jpg");
        InputStream img2 = this.getClass().getResourceAsStream("/33.jpg");
        
        //把图片添加到上下文对象
        context.put("img1", img1);
        context.put("img2", img2);
        
        //输出到本地目录
        FileOutputStream out = new FileOutputStream(new File("D://图片报表.docx"));
        report.process(context, out);
	}
 
}</code></pre> 
<p> 3. 导出效果如下：</p> 
<p><img alt="" height="475" src="https://images2.imgbox.com/1e/61/MM1LzcR3_o.png" width="351"></p> 
<p></p> 
<p><strong>制作图形</strong></p> 
<p>要在Word文档中生成柱状图、饼状图等图形，需要在项目中引入第三方绘图工具，在这里使用xchart来演示在Word中生成饼状图图形。</p> 
<p>生成饼状图和生成图片的方法很类似，具体步骤如下：</p> 
<p>1. 在Word模版中需要插入图片的位置插入一张模版图片，然后鼠标单击模板图片插入一个书签，设置书签名称，比如chart，最后点击【添加】按钮:</p> 
<p><img alt="" height="670" src="https://images2.imgbox.com/dc/63/Innu0xIM_o.png" width="1200"></p> 
<p>2. 编写代码:</p> 
<p>2.1 在<strong>pom.xml</strong>文件中添加xchart的依赖:</p> 
<pre><code>&lt;dependency&gt;
	&lt;groupId&gt;org.knowm.xchart&lt;/groupId&gt;
	&lt;artifactId&gt;xchart&lt;/artifactId&gt;
	&lt;version&gt;3.5.4&lt;/version&gt;
&lt;/dependency&gt;</code></pre> 
<p>2.2 后台代码:</p> 
<pre><code>package com.tzsj.test;
 
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import org.junit.Test;
import org.knowm.xchart.BitmapEncoder;
import org.knowm.xchart.PieChart;
import org.knowm.xchart.PieChartBuilder;
import fr.opensagres.xdocreport.core.XDocReportException;
import fr.opensagres.xdocreport.document.IXDocReport;
import fr.opensagres.xdocreport.document.images.ByteArrayImageProvider;
import fr.opensagres.xdocreport.document.registry.XDocReportRegistry;
import fr.opensagres.xdocreport.template.IContext;
import fr.opensagres.xdocreport.template.TemplateEngineKind;
import fr.opensagres.xdocreport.template.formatter.FieldsMetadata;
 
public class ChartTest {
 
	@Test
	public void test() throws IOException, XDocReportException {
		generateWordForChart();
	}
	
	
	public void generateWordForChart() throws IOException, XDocReportException {
		//获取Word模板，模板存放路径在项目的resources目录下
	    InputStream ins = this.getClass().getResourceAsStream("/饼图.docx");
        //注册xdocreport实例并加载FreeMarker模板引擎
        IXDocReport report = XDocReportRegistry.getRegistry().loadReport(ins,                 
                                 TemplateEngineKind.Freemarker);
        
        //创建xdocreport上下文对象
        IContext context = report.createContext();
        
        FieldsMetadata fm = report.createFieldsMetadata();
        //元数据中加入图片
        fm.addFieldAsImage("chart");
        
        PieChart chart = new PieChartBuilder().width(800).height(620)
                                .title("销售饼图").build();
        
        //给饼图设置对应的值
        chart.addSeries("臭美毁肤", 589);
        chart.addSeries("女装", 651);
        chart.addSeries("手机", 866);
        chart.addSeries("家居家装", 783);
        chart.addSeries("食物饮品", 405);
        
        //生成饼图
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        BitmapEncoder.saveBitmap(chart, baos, BitmapEncoder.BitmapFormat.JPG);
        
        //把饼图添加到上下文对象
        context.put("chart", new ByteArrayImageProvider(baos.toByteArray()));
        
        //输出到本地目录
        FileOutputStream out = new FileOutputStream(new File("D://饼图报表.docx"));
        report.process(context, out);
	}
 
 
}</code></pre> 
<p>3. 导出效果如下:</p> 
<p><img alt="" height="392" src="https://images2.imgbox.com/71/39/RsKOQlsS_o.png" width="576"></p> 
<h4><a name="t12"></a>总结</h4> 
<p>这就是用<strong>Java</strong>语言实现，结合<strong>XDocReport</strong>和<strong>FreeMarker</strong>模板引擎生成Word文档的方法。希望能给致力于开发的小伙伴带来一丝丝帮助。</p> 
<p><strong>word转pdf：</strong></p> 
<p><a href="https://blog.csdn.net/m0_67402774/article/details/126032809?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166262271316782388013671%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=166262271316782388013671&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-2-126032809-null-null.142%5Ev47%5Epc_rank_34_queryrelevant25,201%5Ev3%5Econtrol&amp;utm_term=java%20word%E5%AF%BC%E5%87%BApdf&amp;spm=1018.2226.3001.4187" title="java将Word转换成PDF三种方法_前端的哭的博客-CSDN博客_java word 转换pdf">java将Word转换成PDF三种方法_前端的哭的博客-CSDN博客_java word 转换pdf</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/64d4e600d0397e0b875dc9abeaa26f8d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Ubuntu下安装OpenCV4.6.0并使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c12cd9d29f7b9f94c0cbce7010b9db7e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">算法题：开根号</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>