<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SkyWalking 安装部署 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SkyWalking 安装部署" />
<meta property="og:description" content="SkyWalking 安装部署 目录 SkyWalking 安装部署一、介绍二、前置步骤三、下载安装四、`SkyWalking` 的配置4.1 对 `oap` 进行配置4.2 对 `webapp` 进行配置4.3 对 `agent` 进行配置 五、启动六、总结 一、介绍 本次安装部署为最简化安装部署流程。 二、前置步骤 安装 JDK dnf -y install java wget 安装 ElasticSearch7 三、下载安装 本次演示使用的是 8.5.0 - ES7 版本，小伙伴们可以在 skywalking 官网 自行选择合适的版本。
tar -zxvf apache-skywalking-apm-es7-8.5.0.tar.tar.gz 四、SkyWalking 的配置 在服务器解压完毕后，我们将分三步进行，完成整体 SkyWalking 的配置。
Skywalking 主要分为 oap 、webapp 和 agent 三部分，
oap 用于汇总数据。webapp 用于汇总数据的展示。agent 是探针，部署在需要收集数据的应用服务器上，并将数据同步到Skywalking的平台。 oap 和 webapp这两块共同组成了Skywalking的平台
4.1 对 oap 进行配置 进入 config 文件夹, application.yml 文件夹进行编辑。 下面将进行集群配置、存储配置、自监控空配置。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/ad8aa1368a8845d777f9f4ca30e7cd70/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-01T10:20:15+08:00" />
<meta property="article:modified_time" content="2022-09-01T10:20:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SkyWalking 安装部署</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="SkyWalking__0"></a>SkyWalking 安装部署</h2> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#SkyWalking__0" rel="nofollow">SkyWalking 安装部署</a></li><li><a href="#_2" rel="nofollow">一、介绍</a></li><li><a href="#_4" rel="nofollow">二、前置步骤</a></li><li><a href="#_10" rel="nofollow">三、下载安装</a></li><li><a href="#SkyWalking__17" rel="nofollow">四、`SkyWalking` 的配置</a></li><li><ul><li><a href="#41__oap__27" rel="nofollow">4.1 对 `oap` 进行配置</a></li><li><a href="#42__webapp__61" rel="nofollow">4.2 对 `webapp` 进行配置</a></li><li><a href="#43__agent__76" rel="nofollow">4.3 对 `agent` 进行配置</a></li></ul> 
  </li><li><a href="#_85" rel="nofollow">五、启动</a></li><li><a href="#_99" rel="nofollow">六、总结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>一、介绍</h2> 
<ul><li>本次安装部署为最简化安装部署流程。</li></ul> 
<h2><a id="_4"></a>二、前置步骤</h2> 
<ol><li>安装 JDK</li></ol> 
<pre><code class="prism language-linux">dnf -y install java wget 
</code></pre> 
<ol start="3"><li>安装 ElasticSearch7</li></ol> 
<h2><a id="_10"></a>三、下载安装</h2> 
<p>本次演示使用的是 <a href="https://archive.apache.org/dist/skywalking/8.5.0/apache-skywalking-apm-es7-8.5.0.tar.gz" rel="nofollow">8.5.0 - ES7</a> 版本，小伙伴们可以在 <a href="https://skywalking.apache.org/downloads/" rel="nofollow">skywalking 官网</a> 自行选择合适的版本。</p> 
<p><img src="https://images2.imgbox.com/89/32/51yEsH4c_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-linux">tar -zxvf apache-skywalking-apm-es7-8.5.0.tar.tar.gz
</code></pre> 
<h2><a id="SkyWalking__17"></a>四、<code>SkyWalking</code> 的配置</h2> 
<blockquote> 
 <p>在服务器解压完毕后，我们将分三步进行，完成整体 SkyWalking 的配置。<br> Skywalking 主要分为 oap 、webapp 和 agent 三部分，</p> 
</blockquote> 
<ul><li><code>oap</code> 用于汇总数据。</li><li><code>webapp</code> 用于汇总数据的展示。</li><li><code>agent</code> 是探针，部署在需要收集数据的应用服务器上，并将数据同步到Skywalking的平台。</li></ul> 
<p><strong><code>oap</code> 和 <code>webapp</code>这两块共同组成了Skywalking的平台</strong></p> 
<h3><a id="41__oap__27"></a>4.1 对 <code>oap</code> 进行配置</h3> 
<ul><li>进入 <code>config</code> 文件夹, <code>application.yml</code> 文件夹进行编辑。</li></ul> 
<blockquote> 
 <p>下面将进行集群配置、存储配置、自监控空配置。</p> 
</blockquote> 
<ul><li>集群部分</li></ul> 
<pre><code class="prism language-yml"><span class="token key atrule">cluster</span><span class="token punctuation">:</span>
  <span class="token comment"># 配置我们是集群还是单节点。这里我们是单节点，所以不做改变。</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>SW_CLUSTER<span class="token punctuation">:</span>standalone<span class="token punctuation">}</span>
</code></pre> 
<ul><li>存储部分这里我们的存储使用 elasticsearch7</li></ul> 
<pre><code class="prism language-yml"><span class="token key atrule">storage</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>SW_STORAGE<span class="token punctuation">:</span>elasticsearch7<span class="token punctuation">}</span>
  ……
  <span class="token key atrule">elasticsearch7</span><span class="token punctuation">:</span>
    <span class="token comment"># sky-walking 在 ES 中索引的前缀</span>
    <span class="token key atrule">nameSpace</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>SW_NAMESPACE<span class="token punctuation">:</span><span class="token string">"Sky-walking"</span><span class="token punctuation">}</span>
    <span class="token comment"># 在 ES 安装的位置与端口</span>
    <span class="token key atrule">clusterNodes</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>SW_STORAGE_ES_CLUSTER_NODES<span class="token punctuation">:</span>localhost<span class="token punctuation">:</span><span class="token number">9200</span><span class="token punctuation">}</span>
</code></pre> 
<ul><li>自监控</li></ul> 
<pre><code class="prism language-yml"><span class="token key atrule">prometheus-fetcher</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>SW_PROMETHEUS_FETCHER<span class="token punctuation">:</span>default<span class="token punctuation">}</span>
  <span class="token key atrule">default</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabledRules</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>SW_PROMETHEUS_FETCHER_ENABLED_RULES<span class="token punctuation">:</span><span class="token string">"self"</span><span class="token punctuation">}</span>
    <span class="token key atrule">active</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>SW_PROMETHEUS_FETCHER_ACTIVE<span class="token punctuation">:</span><span class="token boolean important">true</span><span class="token punctuation">}</span>
  ……
<span class="token key atrule">telemetry</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span> $<span class="token punctuation">{<!-- --></span>SW_TELEMETRY<span class="token punctuation">:</span>prometheus<span class="token punctuation">}</span>
</code></pre> 
<ul><li><a href="https://blog.csdn.net/miluan_ren/article/details/118211431">完整版 oap 配置文件。</a></li></ul> 
<h3><a id="42__webapp__61"></a>4.2 对 <code>webapp</code> 进行配置</h3> 
<ol><li>访问 oap 的方式默认使用graphql方式访问oap的数据收集端口，因此监听的是12800端口<br> 由于oap 和web 在同一台机器上。所以我填写的是127.0.0.1</li></ol> 
<pre><code class="prism language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8888</span> <span class="token comment">#访问页面使用的端口</span>

<span class="token key atrule">collector</span><span class="token punctuation">:</span>
  <span class="token key atrule">path</span><span class="token punctuation">:</span> /graphql
  <span class="token key atrule">ribbon</span><span class="token punctuation">:</span>
    <span class="token key atrule">ReadTimeout</span><span class="token punctuation">:</span> <span class="token number">10000</span>
    <span class="token comment"># Point to all backend's restHost:restPort, split by ,</span>
    <span class="token key atrule">listOfServers</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">12800</span>
</code></pre> 
<p>完成上述步骤就可以启动了</p> 
<h3><a id="43__agent__76"></a>4.3 对 <code>agent</code> 进行配置</h3> 
<p>客户端 agent 配置</p> 
<pre><code class="prism language-yml"><span class="token punctuation">-</span>javaagent<span class="token punctuation">:</span>/opt/apache<span class="token punctuation">-</span>skywalking<span class="token punctuation">-</span>apm<span class="token punctuation">-</span>bin<span class="token punctuation">-</span>es7/agent/skywalking<span class="token punctuation">-</span>agent.jar=agent.service_name=NJ<span class="token punctuation">-</span>GL<span class="token punctuation">,</span>agent.application_code=90001<span class="token punctuation">,</span>logging.level=debug
</code></pre> 
<p>详细配置</p> 
<pre><code class="prism language-yml">JAVA_OPTS="<span class="token punctuation">-</span>Xms4096m <span class="token punctuation">-</span>Xmx4096m <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>NewRatio=1 <span class="token punctuation">-</span>Xss1024K <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>+HeapDumpOnOutOfMemoryError <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>HeapDumpPath=/home/logs/tomcatlog/java_heapdump.hprof <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>+UseConcMarkSweepGC <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>+CMSParallelRemarkEnabled <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>+UseCMSCompactAtFullCollection <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>CMSFullGCsBeforeCompaction=0 <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>+PrintGCDetails <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>+PrintGCDateStamps <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>+PrintHeapAtGC <span class="token punctuation">-</span>Xloggc<span class="token punctuation">:</span>/home/logs/tomcatlog/tomcat_gc.log <span class="token punctuation">-</span>XX<span class="token punctuation">:</span>+DisableExplicitGC <span class="token punctuation">-</span>Dfile.encoding=utf<span class="token punctuation">-</span>8 <span class="token punctuation">-</span>javaagent<span class="token punctuation">:</span>/opt/apache<span class="token punctuation">-</span>skywalking<span class="token punctuation">-</span>apm<span class="token punctuation">-</span>bin<span class="token punctuation">-</span>es7/agent/skywalking<span class="token punctuation">-</span>agent.jar=agent.service_name=NJ<span class="token punctuation">-</span>GL<span class="token punctuation">-</span>TEST<span class="token punctuation">,</span>agent.application_code=90000<span class="token punctuation">,</span>logging.level=debug"
</code></pre> 
<h2><a id="_85"></a>五、启动</h2> 
<p>进入 <code>bin</code> 目录执行 <code>startup.sh</code> 文件即可启动 <code>SkyWalking</code> 平台,内部文件其实是分别执行 <code>oapService.sh</code> 与<code>webappService.sh</code> 文件，如果我们是分开部署这两部分功能，可以单独运行对应的 <code>.sh</code> 文件即可启动对应部分。</p> 
<pre><code class="prism language-linux">cd ../bin
./startup.sh
</code></pre> 
<p><code>startup.sh</code> 脚本内容。</p> 
<pre><code class="prism language-bat">setlocal
call "%~dp0"\oapService.bat start
call "%~dp0"\webappService.bat start
endlocal
</code></pre> 
<p><img src="https://images2.imgbox.com/18/49/WDyhmw3T_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_99"></a>六、总结</h2> 
<p>到目前为止项目 Skywalking 就已经部署成功了。后续会继续写 UI 解读，以及相关Agen 配置 、<br> 告警等操作，敬请期待。<br> ps： 如果有不对的地方，欢迎留言，不喜勿喷。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/38d14d2b8b9b1af747c8cf52cb9a3385/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">快速了解德国TRINAMIC运动控制芯片(TMC电机驱动芯片)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/66d96bfd30759a14599bcc9e3c5ca028/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SQL Server Reporting Services</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>