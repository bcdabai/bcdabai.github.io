<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Flutter入门到进阶】Flutter基础篇---弹窗Dialog - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【Flutter入门到进阶】Flutter基础篇---弹窗Dialog" />
<meta property="og:description" content="1 AlertDialog 1.1 说明 最简单的方案是利用AlertDialog组件构建一个弹框
1.2 示例 void alertDialog(BuildContext context) async { var result = await showDialog( barrierDismissible: false, //表示点击灰色背景的时候是否消失弹出框 context: context, builder: (context) { return AlertDialog( title: const Text(&#34;提示信息!&#34;), content: const Text(&#34;您确定要删除吗&#34;), actions: [ TextButton( onPressed: () { print(&#34;ok&#34;); Navigator.of(context).pop(&#34;ok&#34;); //点击按钮让AlertDialog消失 }, child: const Text(&#34;确定&#34;)), TextButton( onPressed: () { print(&#34;cancel&#34;); Navigator.of(context).pop(&#34;取消&#34;); }, child: const Text(&#34;取消&#34;)) ], ); }); print(&#34;-----------&#34;); print(result); } 2 SimpleDialog 2.1 说明 通过SimpleDialog构建一个选择框
2.2 示例 void simpleDialog(BuildContext context) async { var result = await showDialog( barrierDismissible: false, //表示点击灰色背景的时候是否消失弹出框 context: context, builder: (context) { return SimpleDialog( title: const Text(&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/dad0338b03b9950667ef4a7122386f89/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-06T11:48:55+08:00" />
<meta property="article:modified_time" content="2023-03-06T11:48:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Flutter入门到进阶】Flutter基础篇---弹窗Dialog</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>1 AlertDialog</h2> 
<h3>1.1 说明</h3> 
<p>        最简单的方案是利用AlertDialog组件构建一个弹框</p> 
<h3>1.2 示例</h3> 
<pre><code class="language-Dart">void alertDialog(BuildContext context) async {
  var result = await showDialog(
      barrierDismissible: false, //表示点击灰色背景的时候是否消失弹出框
      context: context,
      builder: (context) {
        return AlertDialog(
          title: const Text("提示信息!"),
          content: const Text("您确定要删除吗"),
          actions: [
            TextButton(
                onPressed: () {
                  print("ok");
                  Navigator.of(context).pop("ok"); //点击按钮让AlertDialog消失
                },
                child: const Text("确定")),
            TextButton(
                onPressed: () {
                  print("cancel");
                  Navigator.of(context).pop("取消");
                },
                child: const Text("取消"))
          ],
        );
      });

  print("-----------");
  print(result);
}</code></pre> 
<h2>2 SimpleDialog</h2> 
<h3>2.1 说明</h3> 
<p>        通过SimpleDialog构建一个选择框</p> 
<h3>2.2 示例</h3> 
<pre><code class="language-Dart">void simpleDialog(BuildContext context) async {
  var result = await showDialog(
      barrierDismissible: false, //表示点击灰色背景的时候是否消失弹出框
      context: context,
      builder: (context) {
        return SimpleDialog(
          title: const Text("请选择语言"),
          children: [
            SimpleDialogOption(
              onPressed: () {
                print("汉语");
                Navigator.pop(context, "汉语");
              },
              child: const Text("汉语"),
            ),
            const Divider(),
            SimpleDialogOption(
              onPressed: () {
                print("英语");
                Navigator.pop(context, "英语");
              },
              child: const Text("英语"),
            ),
            const Divider(),
            SimpleDialogOption(
              onPressed: () {
                print("日语");
                Navigator.pop(context, "日语");
              },
              child: const Text("日语"),
            ),
            const Divider(),
          ],
        );
      });
  print("-----------");
  print(result);
}
</code></pre> 
<h2>3 自定义Flutter Dialog </h2> 
<h3>3.1 说明</h3> 
<p>        通过继承Dialog实现自定义的弹窗</p> 
<h3>3.2 示例</h3> 
<pre><code class="language-Dart">// 自定义dialog
class MyDialog extends Dialog {
  String title;
  String content;
  Function()? onClosed;

  MyDialog({Key? key, required this.title,required
  this.onClosed,this.content=""}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return Material(
      type: MaterialType.transparency,
      child: Center(
          child: Container(
            height: 300,
            width: 300,
            color: Colors.white,
            child: Column(
              children: &lt;Widget&gt;[
                Padding(
                  padding: const EdgeInsets.all(10),
                  child: Stack(
                    children: &lt;Widget&gt;[
                      Align(
                        alignment: Alignment.center,
                        child: Text(title),
                      ),
                      Align(
                        alignment: Alignment.centerRight,
                        child: InkWell(
                          onTap: onClosed,
                          child: const Icon(Icons.close),
                        ),
                      )
                    ],
                  ),
                ),
                const Divider(),
                Container(
                  padding: const EdgeInsets.all(10),
                  width: double.infinity,
                  child: Text(content,textAlign: TextAlign.left),
                )
              ],
            ),

          )),
    );
  }
}</code></pre> 
<h2>4 Flutter Toast</h2> 
<h3>4.1 第三方框架</h3> 
<h4>4.1.1 说明        </h4> 
<p>        https://pub.dev/packages/fluttertoast</p> 
<h4>4.1.2 示例</h4> 
<pre><code class="language-Dart">Fluttertoast.showToast(
                  msg: "提示信息",
                  toastLength: Toast.LENGTH_LONG,   //值针对 android 平台
                  timeInSecForIosWeb: 1,  //提示时间 针对ios 和 web
                  backgroundColor: Colors.black26, //背景颜色
                  textColor: Colors.white,   //文本颜色
                  fontSize: 16.0  //文本字体大小
              );</code></pre> 
<h3>4.2 自定义</h3> 
<h4>4.2.1 说明</h4> 
<p>        所谓toast框其实就是在图层的最上面一层插入一个显示图层，在Flutter中利用OverLayEntry构建图层，然后通过Overlay进行插入</p> 
<h4>4.2.2 示例</h4> 
<pre><code class="language-Dart">import 'package:flutter/material.dart';

class Toast {
  static var _lastMsg;

  static int _lastShowms = 0;

  static get flag =&gt; true;

  static OverlayEntry? entry;
  static Future _show(BuildContext context, String msg, int duration) {
    entry = OverlayEntry(
        builder: (BuildContext context) =&gt; Positioned(
              //top值，可以改变这个值来改变toast在屏幕中的位置
              top: MediaQuery.of(context).size.height.toDouble() * 0.5,
              child: Container(
                    alignment: Alignment.center,
                    width: MediaQuery.of(context).size.width,
                    child: Padding(
                      padding: const EdgeInsets.symmetric(horizontal: 10.0),
                      child: ToastWidget(msg: "test",duration: duration,),
                      // child: _buildToastWidget(context,msg),
                    )
                ),
              ),
    );

    ///往Overlay中插入插入OverlayEntry
    Overlay.of(context)?.insert(entry!);

    ///两秒后，移除Toast
    // Future result = Future.delayed(Duration(milliseconds: duration)).then((value) {
    //   print("移除....");
    //   entry!.remove();
    // });
    // return result;
    return Future(() =&gt; 0);
  }

  //toast UI绘制
  static _buildToastWidget(context, String msg) {
    return Row(
      mainAxisSize: MainAxisSize.min,
      children: [
        Container(
            alignment: Alignment.center,
            decoration: BoxDecoration(
              borderRadius: BorderRadius.circular(12.0),
              shape: BoxShape.rectangle,
              color: Colors.black45,
            ),
            child: Padding(
              padding: const EdgeInsets.all(10),
              child: Text(
                  msg,
                  style: const TextStyle(
                      color: Colors.white,
                      decoration: TextDecoration.none,
                      fontSize: 14)
              ),
            )
        )
      ],
    );
  }

  //处理重复多次点击
  static void _handleDuplicateAndShow(
      String message, BuildContext context, int duration) {
    if (_lastMsg == message) {
      //相同信息内容
      int currentms = DateTime.now().millisecondsSinceEpoch;
      int interval = currentms - _lastShowms;
      if (interval &gt; duration) {
        //大于时间间隔 可以显示
        _show(context, message, duration);
        _lastShowms = currentms;
      }
    } else {
      _show(context, message, duration);
      _lastMsg = message;
    }
  }

  /// 提示
  static void showInfo(String message, {required BuildContext context, int duration = 2000}) {
    _handleDuplicateAndShow(message, context, duration);
  }
}


class ToastWidget extends StatefulWidget {
  String msg;

  int duration;



  ToastWidget({super.key,required this.msg,required this.duration});


  @override
  State&lt;ToastWidget&gt; createState() =&gt; _ToastState();
}

class _ToastState extends State&lt;ToastWidget&gt; with SingleTickerProviderStateMixin {

  late AnimationController _controller;

  @override
  void initState() {

    _controller = AnimationController(
      vsync: this,
      duration: const Duration(seconds: 1),
    );
  }

  @override
  void dispose() {
    _controller.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    //启动正序一次
    Future((){
      print("启动动画...");
      _controller.forward();
    }).then((value) {
      //结束倒叙一次
      Future.delayed(Duration(milliseconds: widget.duration-2)).then((value) async{
        print("启动结束动画...");
        await _controller.reverse();
        //移除图层
        Toast.entry!.remove();
        print("移除图层...");
      });
    });

    print("构建组件");
    return Center(
      child: FadeTransition(
        opacity: _controller,
        child:Row(
          mainAxisSize: MainAxisSize.min,
          children: [
            Container(
                alignment: Alignment.center,
                decoration: BoxDecoration(
                  borderRadius: BorderRadius.circular(12.0),
                  shape: BoxShape.rectangle,
                  color: Colors.black45,
                ),
                child: Padding(
                  padding: const EdgeInsets.all(10),
                  child: Text(
                      widget.msg,
                      style: const TextStyle(
                          color: Colors.white,
                          decoration: TextDecoration.none,
                          fontSize: 14)
                  ),
                )
            )
          ],
        ),

      ),
    );
  }
}</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3457638b7da3a6f244c72f2de872d79c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">sftp方式下载、上传、删除</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d8018de2c0371c30c142f56b9afb079a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Redis哨兵（Sentinel）模式</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>