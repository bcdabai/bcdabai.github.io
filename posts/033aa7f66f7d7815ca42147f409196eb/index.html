<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C# 代码实现打印以及各种设置 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C# 代码实现打印以及各种设置" />
<meta property="og:description" content="1.有弹出窗口打印 private void btnPrint_Click(object sender, EventArgs e) { PrintDocument printDocument1 = new PrintDocument(); //printDocument1.DefaultPageSettings.PrinterSettings.PrinterName = &#34;ZDesigner GX430t&#34;;//打印机名称设置 //printDocument1.DefaultPageSettings.PaperSize = new PaperSize(&#34;Custum&#34;, label_biaoda1.Width, label_biaoda1.Height);//设置纸张大小 printDocument1.PrintPage &#43;= new PrintPageEventHandler(this.PrintDocument_PrintPage); PrintPreviewDialog printPreviewDialog1 = new PrintPreviewDialog(); printPreviewDialog1.Document = printDocument1; DialogResult result = printPreviewDialog1.ShowDialog(); if (result == DialogResult.OK) printDocument1.Print(); } //以下代码获取到一张用作打印内容的图片 private void PrintDocument_PrintPage(object sender, System.Drawing.Printing.PrintPageEventArgs e) { //Image image = Image.FromFile(@&#34;D:\0000-临时文件\4.png&#34;); Bitmap _NewBitmap = (Bitmap)img; /* e.Graphics.DrawImage(_NewBitmap, 0, 0, _NewBitmap.Width, _NewBitmap.Height);//调整图片的大小 e.Graphics.DrawImage(_NewBitmap, 0, 0, 570, 380);*/ //各种调整，消除锯齿 /*e." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/033aa7f66f7d7815ca42147f409196eb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-25T11:16:48+08:00" />
<meta property="article:modified_time" content="2023-09-25T11:16:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C# 代码实现打印以及各种设置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1_0"></a>1.有弹出窗口打印</h2> 
<pre><code class="prism language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnPrint_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
			<span class="token class-name">PrintDocument</span> printDocument1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//printDocument1.DefaultPageSettings.PrinterSettings.PrinterName = "ZDesigner GX430t";//打印机名称设置</span>
            <span class="token comment">//printDocument1.DefaultPageSettings.PaperSize = new PaperSize("Custum", label_biaoda1.Width, label_biaoda1.Height);//设置纸张大小</span>
            printDocument1<span class="token punctuation">.</span>PrintPage <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintPageEventHandler</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>PrintDocument_PrintPage<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">PrintPreviewDialog</span> printPreviewDialog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintPreviewDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            printPreviewDialog1<span class="token punctuation">.</span>Document <span class="token operator">=</span> printDocument1<span class="token punctuation">;</span>
            <span class="token class-name">DialogResult</span> result <span class="token operator">=</span> printPreviewDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>OK<span class="token punctuation">)</span>
                printDocument1<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token comment">//以下代码获取到一张用作打印内容的图片</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PrintDocument_PrintPage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Printing<span class="token punctuation">.</span>PrintPageEventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
        	
            <span class="token comment">//Image image = Image.FromFile(@"D:\0000-临时文件\4.png");</span>
            <span class="token class-name">Bitmap</span> _NewBitmap <span class="token operator">=</span> <span class="token punctuation">(</span>Bitmap<span class="token punctuation">)</span>img<span class="token punctuation">;</span>
            <span class="token comment">/* e.Graphics.DrawImage(_NewBitmap, 0, 0, _NewBitmap.Width, _NewBitmap.Height);//调整图片的大小
             e.Graphics.DrawImage(_NewBitmap, 0, 0, 570, 380);*/</span>
			
			<span class="token comment">//各种调整，消除锯齿</span>
            <span class="token comment">/*e.Graphics.SmoothingMode = SmoothingMode.HighQuality;
            e.Graphics.InterpolationMode = InterpolationMode.HighQualityBicubic;
            _NewBitmap.SetResolution(583, 390);*/</span>

            e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawImage</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> image<span class="token punctuation">.</span>Width<span class="token punctuation">,</span> image<span class="token punctuation">.</span>Height<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//_NewBitmap.Save("D:\\0000-临时文件\\1.png", System.Drawing.Imaging.ImageFormat.Png);//图片保存</span>
        <span class="token punctuation">}</span>


</code></pre> 
<h2><a id="2_35"></a>2.无弹出窗口打印</h2> 
<p>内含绘图打印内容，二维码生成，条形码生成。</p> 
<pre><code class="prism language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button2_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>

            <span class="token class-name">PrintDocument</span> pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            pd<span class="token punctuation">.</span>PrintPage <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintPageEventHandler</span><span class="token punctuation">(</span>printDocument_PrintA4Page<span class="token punctuation">)</span><span class="token punctuation">;</span>
            pd<span class="token punctuation">.</span>DefaultPageSettings<span class="token punctuation">.</span>PrinterSettings<span class="token punctuation">.</span>PrinterName <span class="token operator">=</span> <span class="token string">"ZDesigner GX430t"</span><span class="token punctuation">;</span>  <span class="token comment">//打印机名称</span>
            pd<span class="token punctuation">.</span>DefaultPageSettings<span class="token punctuation">.</span>Landscape <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token comment">//设置横向打印，不设置默认是纵向的</span>
            pd<span class="token punctuation">.</span>PrintController <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Printing<span class="token punctuation">.</span>StandardPrintController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//pd.PrinterSettings.Copies = (short)copies; //打印份数</span>
            pd<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>

<span class="token comment">//设置打印的内容</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PrintDocument_PrintA4Page</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">PrintPageEventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">LabelInfo</span> ProductLabelInfo <span class="token operator">=</span> <span class="token function">RowChangeLabelInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//用于打印</span>
            <span class="token class-name">Brush</span> solidBrush <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SolidBrush</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Black<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//画刷           </span>
            <span class="token class-name">Pen</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Pen</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>Black<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//线条颜色</span>
            <span class="token class-name">Font</span> fntTxt1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Font</span><span class="token punctuation">(</span><span class="token string">"微软雅黑"</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> FontStyle<span class="token punctuation">.</span>Bold<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//动态内容字体</span>
            <span class="token class-name">Font</span> fntTxt2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Font</span><span class="token punctuation">(</span><span class="token string">"微软雅黑"</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> FontStyle<span class="token punctuation">.</span>Bold<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//动态内容字体</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//居中</span>
                <span class="token class-name">StringFormat</span> sf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                sf<span class="token punctuation">.</span>LineAlignment <span class="token operator">=</span> StringAlignment<span class="token punctuation">.</span>Center<span class="token punctuation">;</span>
                sf<span class="token punctuation">.</span>Alignment <span class="token operator">=</span> StringAlignment<span class="token punctuation">.</span>Center<span class="token punctuation">;</span>

                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>ProductName<span class="token punctuation">,</span> fntTxt2<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//point,size 26</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>Quality<span class="token punctuation">,</span> fntTxt2<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">310</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>SteelGrade<span class="token punctuation">,</span> fntTxt1<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>Date<span class="token punctuation">,</span> fntTxt1<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">310</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>CoilNo<span class="token punctuation">,</span> fntTxt1<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>SurfaceQuality<span class="token punctuation">,</span> fntTxt1<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">310</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>Size<span class="token punctuation">,</span> fntTxt1<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>NW<span class="token punctuation">,</span> fntTxt1<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">310</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>Standard<span class="token punctuation">,</span> fntTxt1<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>GW<span class="token punctuation">,</span> fntTxt1<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">310</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>

                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>SurfaceStructure<span class="token punctuation">,</span> fntTxt1<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>ContractNo<span class="token punctuation">,</span> fntTxt1<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>WeightMarker<span class="token punctuation">,</span> fntTxt2<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">310</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>CoatingMass<span class="token punctuation">,</span> fntTxt1<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>SurfTreatment<span class="token punctuation">,</span> fntTxt2<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">270</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>PackagedForm<span class="token punctuation">,</span> fntTxt2<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">310</span><span class="token punctuation">,</span> <span class="token number">270</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span>ReferenceLength<span class="token punctuation">,</span> fntTxt1<span class="token punctuation">,</span> solidBrush<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">270</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sf<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//492</span>

                <span class="token class-name">Bitmap</span> bitmap <span class="token operator">=</span> LabelInfo<span class="token punctuation">.</span><span class="token function">CreateQRCode</span><span class="token punctuation">(</span>ProductLabelInfo<span class="token punctuation">.</span><span class="token function">ToStringPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//绘制二维码</span>
                bitmap<span class="token punctuation">.</span><span class="token function">MakeTransparent</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>White<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//跟随颜色调整</span>
                e<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">DrawImage</span><span class="token punctuation">(</span>bitmap<span class="token punctuation">,</span> <span class="token number">350</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//二维码所处位置</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span>ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>

		<span class="token comment">//生成二维码</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">Bitmap</span> <span class="token function">CreateQRCode</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> asset<span class="token punctuation">)</span><span class="token comment">//字符串内容为二维码内容</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">EncodingOptions</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">QrCodeEncodingOptions</span>
            <span class="token punctuation">{<!-- --></span>
                DisableECI <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                CharacterSet <span class="token operator">=</span> <span class="token string">"UTF-8"</span><span class="token punctuation">,</span> <span class="token comment">//编码</span>
                Width <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">,</span>             <span class="token comment">//宽度</span>
                Height <span class="token operator">=</span> <span class="token number">80</span>             <span class="token comment">//高度</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token class-name">BarcodeWriter</span> writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">BarcodeWriter</span>
            <span class="token punctuation">{<!-- --></span>
                Format <span class="token operator">=</span> BarcodeFormat<span class="token punctuation">.</span>QR_CODE<span class="token punctuation">,</span>
                Options <span class="token operator">=</span> options
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> writer<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>asset<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

		<span class="token comment">//左对齐函数（可用于调整二维码内字符的位置）</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">strLeft</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> str<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Encoding</span> coding <span class="token operator">=</span> Encoding<span class="token punctuation">.</span>Default<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">char</span></span> ch <span class="token keyword">in</span> str<span class="token punctuation">.</span><span class="token function">ToCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">int</span></span> byteCount <span class="token operator">=</span> coding<span class="token punctuation">.</span><span class="token function">GetByteCount</span><span class="token punctuation">(</span>ch<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>byteCount <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
                    count<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token class-name"><span class="token keyword">string</span></span> result <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">PadRight</span><span class="token punctuation">(</span><span class="token number">18</span> <span class="token operator">-</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> result<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
<span class="token comment">//生成条形码</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">CreateBarCode</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> filePath<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> barCodeContent<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">ZXing<span class="token punctuation">.</span>Common<span class="token punctuation">.</span>EncodingOptions</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ZXing<span class="token punctuation">.</span>Common<span class="token punctuation">.</span>EncodingOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                Height <span class="token operator">=</span> <span class="token number">120</span><span class="token punctuation">,</span><span class="token comment">//设置宽高</span>
                Width <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token comment">//生成条形码的图片并保存</span>
            <span class="token class-name">ZXing<span class="token punctuation">.</span>BarcodeWriter</span> wr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ZXing<span class="token punctuation">.</span>BarcodeWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                Options <span class="token operator">=</span> options<span class="token punctuation">,</span><span class="token comment">//进行指定规格</span>
                Format <span class="token operator">=</span> ZXing<span class="token punctuation">.</span>BarcodeFormat<span class="token punctuation">.</span>CODE_128<span class="token punctuation">,</span><span class="token comment">//条形码的规格</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Bitmap</span> img <span class="token operator">=</span> wr<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>barCodeContent<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//生成图片</span>
            img<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Imaging<span class="token punctuation">.</span>ImageFormat<span class="token punctuation">.</span>Jpeg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            img<span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>Process<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> 
<p>个人记录，大家可参考。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/742a126ffbed9a783408e1fc130de422/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">STM32 USB CDC 虚拟串口</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ad2dbbc1c1eeeae5a4440f0a42e0a724/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">电脑或服务器IP地址配置</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>