<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>前端导出表格之XLSX使用 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="前端导出表格之XLSX使用" />
<meta property="og:description" content="导入xlsx npm install xlsx
XLSX官网
引用 import XLSX from xlsx
H5 table 导出表格 在页面创建table &lt;table border=&#34;&#34; id=&#34;table&#34;&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td rowspan=&#39;2&#39;&gt;表头1&lt;/td&gt; &lt;td colspan=&#34;2&#34;&gt;表头2&lt;/td&gt; &lt;/tr&gt; &lt;tr &gt; &lt;td&gt;A1&lt;/td&gt; &lt;td&gt;B1&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;A2&lt;/td&gt; &lt;td&gt;B21&lt;/td&gt; &lt;td&gt;B22&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; 导出方法 downloadExl () { // 初始化 var workbook = XLSX.utils.book_new(); // 数据 var ws1 = XLSX.utils.table_to_sheet(document.getElementById(&#39;table&#39;)); // 这是 Sheet XLSX.utils.book_append_sheet(workbook, ws1, &#34;Sheet1&#34;); XLSX.writeFile(workbook, &#39;table.xlsx&#39;); } 3.结果
得到如下图：
跟页面显示的一模一样的数据以及样式。
多个sheet表格导出 在创建一个table2。导出方法 function downloadExlSheelt () { var workbook = XLSX." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/bcdd93b5848ed852fe414d4d1288f58b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-09T10:45:40+08:00" />
<meta property="article:modified_time" content="2020-08-09T10:45:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">前端导出表格之XLSX使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="xlsx_1"></a>导入xlsx</h2> 
<p>npm install xlsx</p> 
<p><a href="https://www.npmjs.com/package/xlsx-import" rel="nofollow">XLSX官网</a></p> 
<h2><a id="_5"></a>引用</h2> 
<p>import XLSX from xlsx</p> 
<h2><a id="H5_table__8"></a>H5 table 导出表格</h2> 
<ol><li>在页面创建table</li></ol> 
<pre><code>&lt;table border="" id="table"&gt;
    	&lt;tbody&gt;
		&lt;tr&gt;
			&lt;td rowspan='2'&gt;表头1&lt;/td&gt;
			&lt;td colspan="2"&gt;表头2&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr &gt;
		  &lt;td&gt;A1&lt;/td&gt;
		  &lt;td&gt;B1&lt;/td&gt;
		&lt;/tr&gt;
		&lt;tr&gt;
		   &lt;td&gt;A2&lt;/td&gt;
		   &lt;td&gt;B21&lt;/td&gt;
                   &lt;td&gt;B22&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/tbody&gt;
&lt;/table&gt;
</code></pre> 
<ol start="2"><li>导出方法</li></ol> 
<pre><code> downloadExl () {
                // 初始化
                var workbook = XLSX.utils.book_new();
                // 数据
                var ws1 = XLSX.utils.table_to_sheet(document.getElementById('table'));
                // 这是  Sheet
                XLSX.utils.book_append_sheet(workbook, ws1, "Sheet1");
                XLSX.writeFile(workbook, 'table.xlsx');
                
          }
</code></pre> 
<p>3.结果<br> 得到如下图：</p> 
<p><img src="https://images2.imgbox.com/47/5f/PIXUUH0h_o.png" alt="202007311639.png"></p> 
<p>跟页面显示的一模一样的数据以及样式。</p> 
<h2><a id="sheet_53"></a>多个sheet表格导出</h2> 
<ol><li>在创建一个table2。</li><li>导出方法</li></ol> 
<pre><code>  function downloadExlSheelt () {
	  var workbook = XLSX.utils.book_new();
	   
	  var ws1 = XLSX.utils.table_to_sheet(document.getElementById('table'));
	  XLSX.utils.book_append_sheet(workbook, ws1, "Sheet1");
	  var ws2 = XLSX.utils.table_to_sheet(document.getElementById('table2'));
	  XLSX.utils.book_append_sheet(workbook, ws2, "Sheet2");
	  XLSX.writeFile(workbook, filename); //导出Excel
	   
	   }
</code></pre> 
<p>3.结果得到2个Sheet不同数据。</p> 
<h5><a id="_70"></a>注</h5> 
<p>Sheet 的名称不可以一样</p> 
<h2><a id="_74"></a>数组数据导出</h2> 
<p>到数据多时，页面table就需要分页，但是用table导出表格，会出现数据丢失。因此可考虑数组导出。</p> 
<h5><a id="_77"></a>例子方法</h5> 
<pre><code>  function downloadExle () {
	var filename = "file.xlsx"; //文件名称
	        var data = [ ['表头1','表头2'],['','z','b'], [ 1,2,3],[true, false,"sheetjs"],["foo","bar",new Date("2014-02-19T14:30Z"), "0.3"], ["baz", null, "qux"]];  //数据，一定注意需要时二维数组
	        var ws_name = "Sheet1"; //Excel第一个sheet的名称
	        var wb = XLSX.utils.book_new(), 
	        var ws = XLSX.utils.aoa_to_sheet(data);
	        XLSX.utils.book_append_sheet(wb, ws, ws_name);  //将数据添加到工作薄
	        XLSX.writeFile(wb, filename); //导出Excel
	}

</code></pre> 
<p>结果如图：<br> <img src="https://images2.imgbox.com/c3/ed/tgyBgNC5_o.png" alt="202007311600.png"></p> 
<p>如果想导出都多个sheet的表格，可参考上一个方法</p> 
<h5><a id="_95"></a>注</h5> 
<p>导出数据格式为 二维数组，与导出的表格一一对应。</p> 
<h2><a id="Json__99"></a>Json 数据导出</h2> 
<p>1.下载</p> 
<pre><code>npm install -S file-saver xlsx
npm install -D script-loader

</code></pre> 
<ol start="2"><li>项目中新建一个文件夹：（vendor—名字任取）<br> 里面放置两个文件Blob.js 和 Export2Excel.js。<br> 下载地址: https://github.com/WtecHtec/WorkNotes.git</li></ol> 
<p>3.导出方法</p> 
<pre><code>export2Excel() {
　　　　　　require.ensure([], () =&gt; {
　　　　　　// 引用 步骤 2 文件夹
　　　　　　　 　const { export_json_to_excel } = require(‘../../vendor/Export2Excel’);
　　　　　　　 　//对应表格输出的title
　　　　　　　　const tHeader = [‘序号’, ‘IMSI’, ‘MSISDN’, ‘证件号码’, ‘姓名’];
// 对应表格输出的 tableData 数据, filterVal 属性字段
　　　　　　　　const filterVal = [‘ID’, ‘imsi’, ‘msisdn’, ‘address’, ‘name’];
　　　　　　　　const list = this.tableData;
　　　　　　　　const data = this.formatJson(filterVal, list);
　　　　　　　　　//对应下载文件的名字
　　　　　　　　export_json_to_excel({
                        header: tHeader,
                        data: data,
                        filename: filename,
                        sheetName: filename,
                       
                    });
　　　　　　})
　　　　},
　　　　formatJson(filterVal, jsonData) {
　　　　　　return jsonData.map(v =&gt; filterVal.map(j =&gt; v[j]))
　　　　}
</code></pre> 
<h5><a id="_139"></a>注</h5> 
<p>如果webpack报解析错误：<br> 在build—-webpack.base.conf.js中resolve的alias加入 ‘vendor’: path.resolve(__dirname, ‘…/src/vendor’),<br> 即可解决</p> 
<h2><a id="_144"></a>合并单元格</h2> 
<p>// ws 为 XLSX.utils.aoa_to_sheet|table_to_sheet 的对象</p> 
<ol><li>方式1</li></ol> 
<pre><code>var cell_address = { 
               s: {r:0 ,c:0} ,
		e : {r:1 ,c:0}
	}; 
			
	ws['!merges'].push(cell_address)
</code></pre> 
<h5><a id="_157"></a>释</h5> 
<p>s: 合并单元格起始位置<br> e: 合并单元格结束位置<br> ws[’!merges’]： 合并单元格参数</p> 
<ol start="2"><li>方式2</li></ol> 
<pre><code>var cell_address = XLSX.utils.decode_range('A1:A2') 
    ws['!merges'].push(cell_address)
</code></pre> 
<h5><a id="2_167"></a>方式2</h5> 
<p>decode_range:<br> 参数1： 合并单元格起始位置<br> 参数2： 合并单元格结束位置</p> 
<p>可查看excel表格格式。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7840a8860dcfa26ebd979ab9bf1220fe/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">CC2530定时器T1查询和T3中断</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a959ed03fb637641ad9e688e62e1997c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringBoot项目报错：java.sql.SQLSyntaxErrorException: Unknown database ‘mscode‘</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>