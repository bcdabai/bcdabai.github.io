<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>解决cv2.putText能显示中文为“？？？？”的问题 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="解决cv2.putText能显示中文为“？？？？”的问题" />
<meta property="og:description" content="import cv2 import numpy as np from PIL import Image, ImageDraw, ImageFont for i in range(5): fname = &#39;./hecheng/{}.jpg&#39;.format(i) img = cv2.imread(fname) # 画矩形框 距离靠左靠上的位置 # p1指的是框左边上边到图像左边上边距离 # p2指的是框右边下边到图像左边上边距离 # fname就写自己图片所在位置 p1 = (250, 365) # 左边，上边 #数1 ， 数2 p2 = (250 &#43; 540, 365 &#43; 105) # 右边，下边 #数1&#43;数3，数2&#43;数4 cv2.rectangle(img, p1, p2, (0, 255, 0), 2) a = &#34;营业执照&#34; # 类别名称 font = cv2.FONT_HERSHEY_SIMPLEX # 定义字体 imgzi = cv2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/652c712e1e750842bd26ecd16ba4a7fb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-06T17:49:43+08:00" />
<meta property="article:modified_time" content="2021-09-06T17:49:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">解决cv2.putText能显示中文为“？？？？”的问题</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <pre><code class="prism language-python"><span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token punctuation">,</span> ImageDraw<span class="token punctuation">,</span> ImageFont
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    fname <span class="token operator">=</span> <span class="token string">'./hecheng/{}.jpg'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>fname<span class="token punctuation">)</span>
	<span class="token comment"># 画矩形框 距离靠左靠上的位置</span>
	<span class="token comment"># p1指的是框左边上边到图像左边上边距离</span>
    <span class="token comment"># p2指的是框右边下边到图像左边上边距离</span>

    <span class="token comment"># fname就写自己图片所在位置</span>
    p1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">365</span><span class="token punctuation">)</span>  <span class="token comment"># 左边，上边   #数1 ， 数2</span>
    p2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">250</span> <span class="token operator">+</span> <span class="token number">540</span><span class="token punctuation">,</span> <span class="token number">365</span> <span class="token operator">+</span> <span class="token number">105</span><span class="token punctuation">)</span>  <span class="token comment"># 右边，下边  #数1+数3，数2+数4</span>
    cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>img<span class="token punctuation">,</span> p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

    a <span class="token operator">=</span> <span class="token string">"营业执照"</span> <span class="token comment"># 类别名称</span>
    font <span class="token operator">=</span> cv2<span class="token punctuation">.</span>FONT_HERSHEY_SIMPLEX  <span class="token comment"># 定义字体</span>
    imgzi <span class="token operator">=</span> cv2<span class="token punctuation">.</span>putText<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token string">'{}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">365</span> <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> font<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token comment"># imgzi = cv2.putText(图片, '{} {:.3f}'.format(标签名, 置信度), (字体左边开始位置, 字体上面开始位置), 字体, 字体大小, (R, G, B), 字体厚度)</span>
    <span class="token comment"># 图像，      文字内容，      坐标(右上角坐标)，字体， 大小，  颜色，    字体厚度</span>

    cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span><span class="token string">'./test/test{}.jpg'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> img<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over over"</span><span class="token punctuation">)</span>
</code></pre> 
<p>自己在图片上添加文字，但是却显示的是问号，因此在网上搜索了下解决的方法，希望能够帮到大家</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token punctuation">,</span> ImageDraw<span class="token punctuation">,</span> ImageFont
<span class="token keyword">def</span> <span class="token function">cv2ImgAddText</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> text<span class="token punctuation">,</span> left<span class="token punctuation">,</span> top<span class="token punctuation">,</span> textColor<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> textSize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 判断是否OpenCV图片类型</span>
        img <span class="token operator">=</span> Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2RGB<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># 创建一个可以在给定图像上绘图的对象</span>
    draw <span class="token operator">=</span> ImageDraw<span class="token punctuation">.</span>Draw<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
    <span class="token comment"># 字体的格式</span>
    fontStyle <span class="token operator">=</span> ImageFont<span class="token punctuation">.</span>truetype<span class="token punctuation">(</span>
        <span class="token string">"STSONG.TTF"</span><span class="token punctuation">,</span> textSize<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>
    <span class="token comment"># 绘制文本</span>
    draw<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span> top<span class="token punctuation">)</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> textColor<span class="token punctuation">,</span> font<span class="token operator">=</span>fontStyle<span class="token punctuation">)</span>
    <span class="token comment"># 转换回OpenCV格式</span>
    <span class="token keyword">return</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_RGB2BGR<span class="token punctuation">)</span>

a <span class="token operator">=</span> <span class="token string">"营业执照"</span>
<span class="token keyword">for</span> i  <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    img <span class="token operator">=</span> cv2ImgAddText<span class="token punctuation">(</span>Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./img/{}.jpg'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">365</span> <span class="token operator">-</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>  <span class="token comment">#添加</span>
        <span class="token comment"># cv2ImgAddText(图像, 文字内容, 字体左边开始位置, 字体上面开始位置, (R, G, B), 字体大小)</span>
    <span class="token comment">#添加框</span>
    p1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">365</span><span class="token punctuation">)</span>  <span class="token comment"># 左边，上边   #数1 ， 数2</span>
    p2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">250</span> <span class="token operator">+</span> <span class="token number">540</span><span class="token punctuation">,</span> <span class="token number">365</span> <span class="token operator">+</span> <span class="token number">105</span><span class="token punctuation">)</span>  <span class="token comment"># 右边，下边  #数1+数3，数2+数4</span>
    cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>img<span class="token punctuation">,</span> p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    
    cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span><span class="token string">'./test/test{}.jpg'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> img<span class="token punctuation">)</span>  <span class="token comment">#保存图片</span>
    
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over over"</span><span class="token punctuation">)</span>
</code></pre> 
<p>最终得到下面的效果<br> <img src="https://images2.imgbox.com/e6/c8/2lptYTSM_o.png" alt="请添加图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/eb0b142ef5a1339127f541c435ca9807/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VM导入windows镜像</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6e983a2c3556572783eed0503dd1511f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">@Configuration注解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>