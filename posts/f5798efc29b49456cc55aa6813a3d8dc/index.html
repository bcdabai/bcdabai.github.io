<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>IGMP基础 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="IGMP基础" />
<meta property="og:description" content="IGMP基础 2019年09月26日 IGMP简介 IGMP是Internet Group Management Protocol的简称，又被称为互联网组管理协议，是TCP/IP协议族中负责IPv4组播成员管理的协议。IGMP用来在接收者主机和与其直接相邻的组播路由器之间建立和维护组播组成员关系。IGMP通过在接收者主机和组播路由器之间交互IGMP报文实现组成员管理功能，IGMP报文封装在IP报文中。
目的： IP组播通信的特点是报文从一个源发出，被转发到一组特定的接收者。但在组播通信模型中，发送者不关注接收者的位置信息，只是将数据发送到约定的目的组播地址。要使组播报文最终能够到达接收者，需要某种机制使连接接收者网段的组播路由器能够了解到该网段存在哪些组播接收者，同时保证接收者可以加入相应的组播组中。IGMP就是用来在接收者主机和与其所在网段直接相邻的组播路由器之间建立、维护组播组成员关系的协议。
IGMPv1工作原理 ICMPv1报文： IGMPv1包括两种类型的报文：
普遍组查询报文（General Query）：查询器向共享网络上所有主机和路由器发送的查询报文，用于了解哪些组播组存在成员。成员报告报文（Report）：主机向查询器发送的报告报文，用于申请加入某个组播组或者应答查询报文。 图：IGMPv1报文格式 字段说明VersionIGMP版本，值为1。Type报文类型。该字段有以下两种取值：0x11：表示普遍组查询报文。0x12：表示成员报告报文。Unused在IGMPv1中，该字段在发送时被设为0，并在接收时被忽略。ChecksumIGMP报文的校验和。校验和是IGMP报文长度（即IP报文的整个有效负载）的16位检测，表示IGMP信息补码之和的补码。Checksum字段在进行校验计算时设为0。当发送报文时，必须计算校验和并插入到Checksum字段中去。当接收报文时，校验和必须在处理该报文之前进行检验。Group Address组播组地址。在普遍组查询报文中，该字段设为0；在成员报告报文中，该字段为成员加入的组播组地址。 IGMPv1报文抓包示例： 图：IGMPv1报文实例 IGMPv1工作机制： IGMPv1协议主要基于查询和响应机制完成组播组管理。当一个网段内有多个组播路由器时，由于它们都可以接收到主机发送的成员报告报文，因此只需要选取其中一台组播路由器发送查询报文就足够了，该组播路由器称为IGMP查询器（Querier）。在IGMPv1中，由组播路由协议PIM选举出唯一的组播信息转发者（Assert Winner或DR）作为IGMPv1的查询器，负责该网段的组成员关系查询。
IGMPv1的工作机制可以分为：普遍组查询和响应机制、新成员加入机制和组成员离开机制三个方面。
普遍组查询和响应机制： 通过普遍组查询和响应，IGMP查询器可以了解到该网段内哪些组播组存在成员。
图：IGMPv1查询和响应示意图 如上图所示，普遍组查询和响应过程如下：
IGMP查询器发送目的地址为224.0.0.1（表示同一网段内所有主机和路由器）的普遍组查询报文；收到该查询报文的组成员启动定时器。
普遍组查询报文是周期性发送的，发送周期可以通过命令配置，缺省情况下每隔60秒发送一次。HostA和HostB是组播组G1的成员，则在本地启动定时器Timer-G1。缺省情况下，定时器的范围为0～10秒之间的随机值。
图：IGMPv1普遍组查询报文 如上图，为v1的查询报文，类型为0x11,目的IP地址为224.0.0.1。源IP地址为自己接口的IP地址。在组播地址中，填充为0.0.0.0。
第一个定时器超时的组成员发送针对该组的报告报文。
假设HostA上的Timer-G1首先超时，HostA向该网段发送目的地址为G1的报告报文。也想加入组G1的HostB收到此报告报文，则停止定时器Timer-G1，不再发送针对G1的报告报文。这样报告报文被抑制，可以减少网段上的流量。
图：IGMPv1报告报文抓包示例 如上图，为主机向路由器发送的报告报文，类型值为0x12，源IP地址为自己主机的IP地址，目的IP地址为组播地址。
IGMP查询器接收到HostA的报告报文后，了解到本网段内存在组播组G1的成员，则由组播路由协议生成（*，G1）组播转发表项，“ * ”代表任意组播源。网络中一旦有组播组G1的数据到达路由器，将向该网段转发。 新组成员加入机制： 图：新组成员加入示意图 如上图所示，主机HostC加入组播组G2的过程如下：
主机HostC不等待普遍组查询报文的到来，主动发送针对G2的报告报文以声明加入。IGMP查询器接收到HostC的报告报文后，了解到本网段内出现了组播组G2的成员，则生成组播转发项（*，G2）。网络中一旦有G2的数据到达路由器，将向该网段转发。 组成员离开机制： IGMPv1没有专门定义离开组的报文。主机离开组播组后，便不会再对普遍组查询报文做出回应。
假设HostA想要退出组播组G1
HostA收到IGMP查询器发送的普遍组查询报文时，不再发送针对G1的报告报文。由于网段内还存在G1组成员HostB，HostB会向IGMP查询器发送针对G1的报告报文，因此IGMP查询器感知不到HostA的离开。
假设HostC想要退出组播组G2
HostC收到IGMP查询器发送的普遍组查询报文时，不再发送针对G2的报告报文。由于网段内不存在组G2的其他成员，IGMP查询器不会收到G2组成员的报告报文，则在一定时间（缺省值为130秒）后，删除G2所对应的组播转发表项。
IGMPv2工作原理 IGMPv2的工作机制与IGMPv1基本相同，最大的不同之处在于IGMPv2增加了离开组机制。成员主机离开组播组时，会主动发送成员离开报文通知IGMP查询器；IGMP查询器收到成员离开报文后，会连续发送特定组查询报文，询问该组播组是否还存在组成员。如果在一段时间内没有收到成员主机发送的报告报文，IGMP查询器将不再维护该组的组成员关系。IGMPv2可以使IGMP查询器及时了解到网段内哪些组播组已不存在成员，从而及时更新组成员关系，减少网络中冗余的组播流量。
IGMPv2报文： 与IGMPv1相比，IGMPv2的变化如下：
除了普遍组查询报文和成员报告报文之外，IGMPv2新增了两种报文： 成员离开报文（Leave）：成员离开组播组时主动向查询器发送的报文，用于宣告自己离开了某个组播组。特定组查询报文（Group-Specific Query）：查询器向共享网段内指定组播组发送的查询报文，用于查询该组播组是否存在成员。 IGMPv2对普遍组查询报文格式也做了改进，添加了最大响应时间（Max Response Time）字段。此字段取值可以通过命令配置，用于控制成员对于查询报文的响应速度。 图：IGMPv2报文格式 字段解释：
Type：报文类型。该字段有以下四种取值：
0x11:表示查询报文。IGMPv2的查询报文包括普遍组查询报文和特定组查询报文两类。0x12:表示IGMPv1成员报告报文。0x16:表示IGMPv2成员报告报文。0x17:表示成员离开报文。 Max Response Time：最大响应时间。
成员主机在收到IGMP查询器发送的普遍组查询报文后，需要在最大响应时间内做出回应。该字段仅在IGMP查询报文中有效。
Group Address：组播组地址。
在普遍组查询报文中，该字段设为0.0.0.0。在特定组查询报文中，该字段为要查询的组播组地址。在成员报告报文和离开报文中，该字段为成员要加入或离开的组播组地址。 IGMPv2报文抓包示例： 图：IGMPv2查询报文 IGMPv2工作机制： 在工作机制上，与IGMPv1相比，IGMPv2增加了查询器选举和离开组机制。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f5798efc29b49456cc55aa6813a3d8dc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-09-26T11:15:19+08:00" />
<meta property="article:modified_time" content="2019-09-26T11:15:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">IGMP基础</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <div class="blog-content-box"> 
 <div class="article-header-box"> 
  <div class="article-header"> 
   <div class="article-title-box"> 
    <span class="article-type type-1 float-left"></span> 
    <h2 class="title-article">IGMP基础</h2> 
   </div> 
   <div class="article-info-box"> 
    <div class="article-bar-top"> 
     <span class="time">2019年09月26日</span> 
     <a class="follow-nickName" href="https://me.csdn.net/qq_38265137" rel="noopener noopener noreferrer" target="_blank"></a> 
     <span class="read-count"></span> 
     <span class="article_info_click"></span> 
     <div class="tags-box space"> 
      <span class="label"></span> 
      <a class="tag-link" target="_blank" rel="noopener noopener noreferrer" href="https://blog.csdn.net/qq_38265137/article/category/7126126"> </a> 
     </div> 
    </div> 
    <div class="operating"> 
    </div> 
   </div> 
  </div> 
 </div> 
 <article class="baidu_pl"> 
  <div id="article_content" class="article_content clearfix"> 
   <div class="article-copyright"> 
    <span class="creativecommons"> <a rel="nofollow" href="http://creativecommons.org/licenses/by-sa/4.0/"> </a>   </span> 
    <div class="article-source-link2222"> 
     <a href="https://blog.csdn.net/qq_38265137/article/details/80475475"></a> 
    </div> 
   </div> 
   <div id="content_views" class="markdown_views prism-atom-one-light"> 
     
    <svg xmlns="http://www.w3.org/2000/svg"> 
     <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block"></path> 
    </svg> 
    <h2><a id="IGMP_1"></a>IGMP简介</h2> 
    <p>IGMP是Internet Group Management Protocol的简称，又被称为互联网组管理协议，是TCP/IP协议族中负责IPv4组播成员管理的协议。IGMP用来在接收者主机和与其直接相邻的组播路由器之间建立和维护组播组成员关系。IGMP通过在接收者主机和组播路由器之间交互IGMP报文实现组成员管理功能，IGMP报文封装在IP报文中。</p> 
    <h3><a id="_5"></a>目的：</h3> 
    <p>IP组播通信的特点是报文从一个源发出，被转发到一组特定的接收者。但在组播通信模型中，发送者不关注接收者的位置信息，只是将数据发送到约定的目的组播地址。要使组播报文最终能够到达接收者，需要某种机制使连接接收者网段的组播路由器能够了解到该网段存在哪些组播接收者，同时保证接收者可以加入相应的组播组中。IGMP就是用来在接收者主机和与其所在网段直接相邻的组播路由器之间建立、维护组播组成员关系的协议。</p> 
    <h2><a id="IGMPv1_9"></a>IGMPv1工作原理</h2> 
    <h3><a id="ICMPv1_11"></a>ICMPv1报文：</h3> 
    <p>IGMPv1包括两种类型的报文：</p> 
    <ul><li>普遍组查询报文（General Query）：查询器向共享网络上所有主机和路由器发送的查询报文，用于了解哪些组播组存在成员。</li><li>成员报告报文（Report）：主机向查询器发送的报告报文，用于申请加入某个组播组或者应答查询报文。</li></ul> 
    <p><img src="https://images2.imgbox.com/ba/3c/ow4htXCs_o.png" alt="这里写图片描述"></p> 
    <center>
      图：IGMPv1报文格式 
     <center> 
     </center> 
    </center> 
    <div class="table-box"> 
     <table><thead><tr><th>字段</th><th>说明</th></tr></thead><tbody><tr><td>Version</td><td>IGMP版本，值为1。</td></tr><tr><td>Type</td><td>报文类型。该字段有以下两种取值：0x11：表示普遍组查询报文。0x12：表示成员报告报文。</td></tr><tr><td>Unused</td><td>在IGMPv1中，该字段在发送时被设为0，并在接收时被忽略。</td></tr><tr><td>Checksum</td><td>IGMP报文的校验和。校验和是IGMP报文长度（即IP报文的整个有效负载）的16位检测，表示IGMP信息补码之和的补码。Checksum字段在进行校验计算时设为0。当发送报文时，必须计算校验和并插入到Checksum字段中去。当接收报文时，校验和必须在处理该报文之前进行检验。</td></tr><tr><td>Group Address</td><td>组播组地址。在普遍组查询报文中，该字段设为0；在成员报告报文中，该字段为成员加入的组播组地址。</td></tr></tbody></table> 
    </div> 
    <h4><a id="IGMPv1_31"></a>IGMPv1报文抓包示例：</h4> 
    <p><img src="https://images2.imgbox.com/ca/53/Jp6Wbdd0_o.png" alt="这里写图片描述"></p> 
    <center>
      图：IGMPv1报文实例 
     <center> 
     </center> 
    </center> 
    <h3><a id="IGMPv1_36"></a>IGMPv1工作机制：</h3> 
    <p>IGMPv1协议主要基于查询和响应机制完成组播组管理。当一个网段内有多个组播路由器时，由于它们都可以接收到主机发送的成员报告报文，因此只需要选取其中一台组播路由器发送查询报文就足够了，该组播路由器称为IGMP查询器（Querier）。<strong>在IGMPv1中，由组播路由协议PIM选举出唯一的组播信息转发者</strong>（Assert Winner或DR）作为IGMPv1的查询器，负责该网段的组成员关系查询。</p> 
    <p>IGMPv1的工作机制可以分为：普遍组查询和响应机制、新成员加入机制和组成员离开机制三个方面。</p> 
    <h4><a id="_42"></a>普遍组查询和响应机制：</h4> 
    <p>通过普遍组查询和响应，IGMP查询器可以了解到该网段内哪些组播组存在成员。</p> 
    <p><img src="https://images2.imgbox.com/bd/bd/uxfGRQxh_o.png" alt="这里写图片描述"></p> 
    <center>
      图：IGMPv1查询和响应示意图 
     <center> 
     </center> 
    </center> 
    <p>如上图所示，普遍组查询和响应过程如下：</p> 
    <ol><li> <p>IGMP查询器发送目的地址为224.0.0.1（表示同一网段内所有主机和路由器）的普遍组查询报文；收到该查询报文的组成员启动定时器。</p> <p>普遍组查询报文是周期性发送的，发送周期可以通过命令配置，<strong>缺省情况下每隔60秒</strong>发送一次。HostA和HostB是组播组G1的成员，则在本地启动定时器Timer-G1。缺省情况下，定时器的范围为0～10秒之间的随机值。</p> </li></ol> 
    <p><img src="https://images2.imgbox.com/c0/bf/YB1a7W75_o.png" alt="这里写图片描述"></p> 
    <center>
      图：IGMPv1普遍组查询报文 
     <center> 
     </center> 
    </center> 
    <p><strong>如上图，为v1的查询报文，类型为0x11,目的IP地址为224.0.0.1。源IP地址为自己接口的IP地址。在组播地址中，填充为0.0.0.0。</strong></p> 
    <ol start="2"><li> <p>第一个定时器超时的组成员发送针对该组的报告报文。</p> <p>假设HostA上的Timer-G1首先超时，HostA向该网段发送目的地址为G1的报告报文。也想加入组G1的HostB收到此报告报文，则停止定时器Timer-G1，不再发送针对G1的报告报文。这样报告报文被抑制，可以减少网段上的流量。</p> </li></ol> 
    <p><img src="https://images2.imgbox.com/0f/81/TM0q1VBJ_o.png" alt="这里写图片描述"></p> 
    <center>
      图：IGMPv1报告报文抓包示例 
     <center> 
     </center> 
    </center> 
    <p><strong>如上图，为主机向路由器发送的报告报文，类型值为0x12，源IP地址为自己主机的IP地址，目的IP地址为组播地址。</strong></p> 
    <ol start="3"><li>IGMP查询器接收到HostA的报告报文后，了解到本网段内存在组播组G1的成员，则由组播路由协议生成（*，G1）组播转发表项，“ * ”代表任意组播源。网络中一旦有组播组G1的数据到达路由器，将向该网段转发。</li></ol> 
    <h4><a id="_73"></a>新组成员加入机制：</h4> 
    <p><img src="https://images2.imgbox.com/a1/b2/Co1KwOl6_o.png" alt="这里写图片描述"></p> 
    <center>
      图：新组成员加入示意图 
     <center> 
     </center> 
    </center> 
    <p>如上图所示，主机HostC加入组播组G2的过程如下：</p> 
    <ol><li>主机HostC不等待普遍组查询报文的到来，主动发送针对G2的报告报文以声明加入。</li><li>IGMP查询器接收到HostC的报告报文后，了解到本网段内出现了组播组G2的成员，则生成组播转发项（*，G2）。网络中一旦有G2的数据到达路由器，将向该网段转发。</li></ol> 
    <h4><a id="_84"></a>组成员离开机制：</h4> 
    <p>IGMPv1没有专门定义离开组的报文。主机离开组播组后，便不会再对普遍组查询报文做出回应。</p> 
    <ul><li> <p>假设HostA想要退出组播组G1</p> <p>HostA收到IGMP查询器发送的普遍组查询报文时，不再发送针对G1的报告报文。由于网段内还存在G1组成员HostB，HostB会向IGMP查询器发送针对G1的报告报文，因此IGMP查询器感知不到HostA的离开。</p> </li><li> <p>假设HostC想要退出组播组G2</p> <p>HostC收到IGMP查询器发送的普遍组查询报文时，不再发送针对G2的报告报文。由于网段内不存在组G2的其他成员，IGMP查询器不会收到G2组成员的报告报文，则在一定时间（缺省值为130秒）后，删除G2所对应的组播转发表项。</p> </li></ul> 
    <h2><a id="IGMPv2_96"></a>IGMPv2工作原理</h2> 
    <p>IGMPv2的工作机制与IGMPv1基本相同，最大的不同之处在于<strong>IGMPv2增加了离开组机制</strong>。成员主机离开组播组时，会主动发送成员离开报文通知IGMP查询器；IGMP查询器收到成员离开报文后，会连续发送特定组查询报文，询问该组播组是否还存在组成员。如果在一段时间内没有收到成员主机发送的报告报文，IGMP查询器将不再维护该组的组成员关系。IGMPv2可以使IGMP查询器及时了解到网段内哪些组播组已不存在成员，从而及时更新组成员关系，减少网络中冗余的组播流量。</p> 
    <h3><a id="IGMPv2_100"></a>IGMPv2报文：</h3> 
    <p>与IGMPv1相比，IGMPv2的变化如下：</p> 
    <ul><li>除了普遍组查询报文和成员报告报文之外，IGMPv2新增了两种报文： 
      <ul><li>成员离开报文（Leave）：成员离开组播组时主动向查询器发送的报文，用于宣告自己离开了某个组播组。</li><li>特定组查询报文（Group-Specific Query）：查询器向共享网段内指定组播组发送的查询报文，用于查询该组播组是否存在成员。</li></ul> </li><li>IGMPv2对普遍组查询报文格式也做了改进，添加了最大响应时间（Max Response Time）字段。此字段取值可以通过命令配置，用于控制成员对于查询报文的响应速度。</li></ul> 
    <p><img src="https://images2.imgbox.com/85/0f/83TOupEi_o.png" alt="这里写图片描述"></p> 
    <center>
      图：IGMPv2报文格式 
     <center> 
     </center> 
    </center> 
    <p>字段解释：</p> 
    <ol><li> <p>Type：报文类型。该字段有以下四种取值：</p> 
      <ol><li>0x11:表示查询报文。IGMPv2的查询报文包括普遍组查询报文和特定组查询报文两类。</li><li>0x12:表示IGMPv1成员报告报文。</li><li>0x16:表示IGMPv2成员报告报文。</li><li>0x17:表示成员离开报文。</li></ol> </li><li> <p>Max Response Time：最大响应时间。</p> <p>成员主机在收到IGMP查询器发送的普遍组查询报文后，需要在最大响应时间内做出回应。该字段仅在IGMP查询报文中有效。</p> </li><li> <p>Group Address：组播组地址。</p> 
      <ol><li>在普遍组查询报文中，该字段设为0.0.0.0。</li><li>在特定组查询报文中，该字段为要查询的组播组地址。</li><li>在成员报告报文和离开报文中，该字段为成员要加入或离开的组播组地址。</li></ol> </li></ol> 
    <h4><a id="IGMPv2_132"></a>IGMPv2报文抓包示例：</h4> 
    <p><img src="https://images2.imgbox.com/b3/58/pNS0EG4A_o.png" alt="这里写图片描述"></p> 
    <center>
      图：IGMPv2查询报文 
     <center> 
     </center> 
    </center> 
    <h3><a id="IGMPv2_138"></a>IGMPv2工作机制：</h3> 
    <p>在工作机制上，与IGMPv1相比，IGMPv2增加了查询器选举和离开组机制。</p> 
    <h4><a id="_142"></a>查询器选举机制：</h4> 
    <p>IGMPv2使用独立的查询器选举机制，当共享网段上存在多个组播路由器时，<strong>IP地址最小的路由器成为查询器</strong>。</p> 
    <p><img src="https://images2.imgbox.com/a8/ba/29TX3oIz_o.png" alt="这里写图片描述"></p> 
    <center>
      图：查询器选举机制 
     <center> 
     </center> 
    </center> 
    <p>如上图所示，在IGMPv2中，查询器的选举过程如下：</p> 
    <ol><li> <p>最初，所有运行IGMPv2的组播路由器（RouterA和RouterB）都认为自己是查询器，向本网段内的所有主机和组播路由器发送普遍组查询报文。</p> <p>RouterA和RouterB在收到对方发送的普遍组查询报文后，将报文的源IP地址与自己的接口地址作比较。通过比较，IP地址最小的组播路由器将成为查询器，其他组播路由器成为非查询器（Non-Querier）。</p> </li></ol> 
    <p><img src="https://images2.imgbox.com/06/6f/0HwnJuB0_o.png" alt="这里写图片描述"></p> 
    <center>
      图：V2查询报文示例 
     <center> 
     </center> 
    </center> 
    <p><img src="https://images2.imgbox.com/b3/78/Tq8MXp7c_o.png" alt="这里写图片描述"></p> 
    <center>
      图：IGMPv2报告报文 
     <center> 
     </center> 
    </center> 
    <ol start="2"><li> <p>此后，将由IGMP查询器（RouterA）向本网段内的所有主机和其他组播路由器发送普遍组查询报文，而非查询器（RouterB）则不再发送普遍组查询报文。</p> <p>非查询器（RouterB）上都会启动一个定时器（即其他查询器存在时间定时器Other Querier Present Timer）。在该定时器超时前，如果收到了来自查询器的查询报文，则重置该定时器；否则，就认为原查询器失效，并发起新的查询器选举过程。</p> </li></ol> 
    <h4><a id="_168"></a>离开组机制：</h4> 
    <p><img src="https://images2.imgbox.com/9e/3f/mmkKLSES_o.png" alt="这里写图片描述"></p> 
    <center>
      图：离开组示意图 
     <center> 
     </center> 
    </center> 
    <p>如上图所示，在IGMPv2中，主机HostA离开组播组G1的过程如下：</p> 
    <ol><li> <p>HostA向本地网段内的所有组播路由器（<strong>目的地址为224.0.0.2）发送针对组G1的离开报文。</strong></p> </li><li> <p>查询器收到离开报文，会发送针对组G1的特定组查询报文。发送间隔和发送次数可以通过命令配置，缺省情况下每隔1秒发送一次，共发送两次。同时查询器启动组成员关系定时器（Timer-Membership=发送间隔x发送次数）。</p> </li><li> <p>该网段内还存在组G1的其他成员，这些成员在收到查询器发送的特定组查询报文后，会立即发送针对组G1的报告报文。查询器收到针对组G1的报告报文后将继续维护该组成员关系。</p> <p>如果该网段内不存在组G1的其他成员，查询器将不会收到针对组G1的报告报文。在Timer-Membership超时后，查询器将删除（*，G1）对应的IGMP组表项。当有组G1的组播数据到达查询器时，查询器将不会向下游转发。</p> </li></ol> 
    <h2><a id="IGMPv3_184"></a>IGMPv3工作原理：</h2> 
    <p>IGMPv3主要是为了配合SSM（Source-Specific Multicast）模型发展起来的，提供了在报文中携带组播源信息的能力，即主机可以对组播源进行选择。</p> 
    <h3><a id="IGMPv3_188"></a>IGMPv3报文：</h3> 
    <p>与IGMPv2相比，IGMPv3报文的变化如下：</p> 
    <ul><li>IGMPv3报文包含两大类：查询报文和成员报告报文。IGMPv3没有定义专门的成员离开报文，成员离开通过特定类型的报告报文来传达。</li><li>查询报文中不仅包含普遍组查询报文和特定组查询报文，还新增了特定源组查询报文（Group-and-Source-Specific Query）。该报文由查询器向共享网段内特定组播组成员发送，用于查询该组成员是否愿意接收特定源发送的数据。特定源组查询通过在报文中携带一个或多个组播源地址来达到这一目的。</li><li>成员报告报文不仅包含主机想要加入的组播组，而且包含主机想要接收来自哪些组播源的数据。IGMPv3增加了针对组播源的过滤模式（INCLUDE/EXCLUDE），将组播组与源列表之间的对应关系简单的表示为（G，INCLUDE，(S1、S2…)），表示只接收来自指定组播源S1、S2……发往组G的数据；或（G，EXCLUDE，(S1、S2…)），表示接收除了组播源S1、S2……之外的组播源发给组G的数据。当组播组与组播源列表的对应关系发生了变化，IGMPv3报告报文会将该关系变化存放于组记录（Group Record）字段，发送给IGMP查询器。</li><li>在IGMPv3中一个成员报告报文可以携带多个组播组信息，而之前的版本一个成员报告只能携带一个组播组。这样在IGMPv3中报文数量大大减少。</li></ul> 
    <h4><a id="IGMPv3_197"></a>IGMPv3查询报文格式：</h4> 
    <p><img src="https://images2.imgbox.com/bb/1b/7hTeaEFr_o.png" alt="这里写图片描述"></p> 
    <center>
      图：IGMPv3查询报文格式 
     <center> 
     </center> 
    </center> 
    <p>IGMPv3查询报文字段说明：</p> 
   </div> 
  </div> 
 </article> 
</div> 
<div class="table-box"> 
 <table><thead><tr><th>字段</th><th>说明</th></tr></thead><tbody><tr><td>Type</td><td>报文类型，取值为0x11。</td></tr><tr><td>Max Response Code</td><td>最大响应时间。成员主机在收到IGMP查询器发送的普遍组查询报文后，需要在最大响应时间内做出回应。</td></tr><tr><td>Checksum</td><td>IGMP报文的校验和。</td></tr><tr><td>Group Address</td><td>组播组地址。在普遍组查询报文中，该字段设为0；在特定组查询报文和特定源组查询报文中，该字段为要查询的组播组地址。</td></tr><tr><td>Resv</td><td>保留字段。发送报文时该字段设为0；接收报文时，对该字段不做处理。</td></tr><tr><td>S</td><td>该比特位为1时，所有收到此查询报文的其他路由器不启动定时器刷新过程，但是此查询报文并不抑制查询器选举过程和路由器的主机侧处理过程。</td></tr><tr><td>QRV</td><td>如果该字段非0，则表示查询器的健壮系数（Robustness Variable）。如果该字段为0，则表示查询器的健壮系数大于7。路由器接收到查询报文时，如果发现该字段非0，则将自己的健壮系数调整为该字段的值；如果发现该字段为0，则不做处理。</td></tr><tr><td>QQIC</td><td>IGMP查询器的查询间隔，单位为秒。非查询器收到查询报文时，如果发现该字段非0，则将自己的查询间隔参数调整为该字段的值；如果发现该字段为0，则不做处理。</td></tr><tr><td>Number of Sources</td><td>报文中包含的组播源的数量。对于普遍组查询报文和特定组查询报文，该字段为0；对于特定源组查询报文，该字段非0。此参数的大小受到所在网络MTU大小的限制。</td></tr><tr><td>Source Address</td><td>组播源地址，其数量受到Number of Sources字段值大小的限制。</td></tr></tbody></table> 
</div> 
<h4><a id="IGMPv3_218"></a>IGMPv3成员报告报文格式：</h4> 
<p><img src="https://images2.imgbox.com/39/5e/VtEB73sg_o.png" alt="这里写图片描述"></p> 
<center>
  图：IGMPv3成员报告报文格式 
 <center> 
 </center> 
</center> 
<p>字段解释信息：</p> 
<div class="table-box"> 
 <table><thead><tr><th>字段</th><th>说明</th></tr></thead><tbody><tr><td>Type</td><td>报文类型，取值为0x22。</td></tr><tr><td>Reserved</td><td>保留字段。</td></tr><tr><td>Checksum</td><td>IGMP报文的校验和。</td></tr><tr><td>Number of Group Records</td><td>报文中包含的组记录的数量。</td></tr><tr><td>Group Record</td><td>组记录。</td></tr></tbody></table> 
</div> 
<p><img src="https://images2.imgbox.com/2c/c5/TdSLEz3Q_o.png" alt="这里写图片描述"></p> 
<center>
  图：Grounp Record字段格式 
 <center> 
 </center> 
</center> 
<p><strong>字段解释：</strong></p> 
<ul><li>Record Type：组记录的类型。共分为三大类。</li><li> 
  <ul><li>当前状态报告。用于对查询报文进行响应，通告自己目前的状态，共两种：一种是MODE_IS_INCLUDE，表示接收源地址列表包含的源发往该组的组播数据。如果指定源地址列表为空，该报文无效；另一种是MODE_IS_EXCLUDE，表示不接收源地址列表包含的源发往该组的组播数据。</li><li>过滤模式改变报告。当组和源的关系在INCLUDE和EXCLUDE之间切换时，会通告过滤模式发生变化，共两种：一种是CHANGE_TO_INCLUDE_MODE，表示过滤模式由EXCLUDE转换到INCLUDE，接收源地址列表包含的新组播源发往该组播组的数据。如果指定源地址列表为空，主机将离开组播组；另一种是CHANGE_TO_EXCLUDE_MODE，表示过滤模式由INCLUDE转换到EXCLUDE，拒绝源地址列表包含的新组播源发往该组的组播数据。</li><li>源列表改变报告。当指定源发生改变时，会通告源列表发生变化，共两种：一种是ALLOW_NEW_SOURCES，表示在现有的基础上，需要接收源地址列表包含的组播源发往该组播组的组播数据。如果当前对应关系为INCLUDE，则向现有源列表中添加这些组播源；如果当前对应关系为EXCLUDE，则从现有阻塞源列表中删除这些组播源；另一种是BLOCK_OLD_SOURCES，表示在现有的基础上，不再接收源地址列表包含的组播源发往该组播组的组播数据。如果当前对应关系为INCLUDE，则从现有源列表中删除这些组播源；如果当前对应关系为EXCLUDE，则向现有源列表中添加这些组播源。</li></ul> </li><li>Aux Data Len：辅助数据长度。在IGMPv3的报告报文中，不存在辅助数据字段，该字段设为0。</li><li>Number of Sources：本记录中包含的源地址数量。</li><li>Multicast Address：组播组地址。</li><li>Sources Address：组播源地址。</li><li>Auxiliary Data：辅助数据。预留给IGMP后续扩展或后续版本。在IGMPv3的报告报文中，不存在辅助数据。</li></ul> 
<h4><a id="IGMPv3_250"></a>IGMPv3报文抓包示例:</h4> 
<p><img src="https://images2.imgbox.com/26/85/UIhENqgh_o.png" alt="这里写图片描述"></p> 
<center>
  图：IGMPv3报告报文示例 
 <center> 
 </center> 
</center> 
<p><img src="https://images2.imgbox.com/d6/cb/d2PmiaFO_o.png" alt="这里写图片描述"></p> 
<center>
  图：IGMPv3查询报文 
 <center> 
 </center> 
</center> 
<h3><a id="IGMPv3_260"></a>IGMPv3工作机制：</h3> 
<p>在工作机制上，与IGMPv2相比，IGMPv3增加了主机对组播源的选择能力。</p> 
<h4><a id="_264"></a>特定组的加入：</h4> 
<p>IGMPv3的成员报告报文的目的地址为224.0.0.22（表示同一网段所有使能IGMPv3的路由器）。通过在报告报文中携带组记录，主机在加入组播组的同时，能够明确要求接收或不接收特定组播源发出的组播数据。</p> 
<p>如果Host和组播路由器之间运行的是IGMPv1或IGMPv2，Host加入组播组G时无法对组播源进行选择，无论其是否需要，都会同时接收到来自组播源S1和S2的数据。如果采用IGMPv3，成员主机可以选择仅接收S1组播数据。</p> 
<ul><li>方法一：Host发送IGMPv3报告（G，INCLUDE，(S1)），仅接收源S1向组播组G发送的数据。</li><li>方法二：Host发送IGMPv3报告（G，EXCLUDE，(S2)），不接收指定源S2向组播组G发送的数据，从而仅有来自S1的组播数据才能传递到Host。</li></ul> 
<h4><a id="_273"></a>特定组查询：</h4> 
<p>当接收到组成员发送的改变组播组与源列表的对应关系的报告时（比如CHANGE_TO_INCLUDE_MODE、CHANGE_TO_EXCLUDE_MODE），IGMP查询器会发送特定源组查询报文。如果组成员希望接收其中任意一个源的组播数据，将反馈报告报文。IGMP查询器根据反馈的组成员报告更新该组对应的源列表。</p> 
<h2><a id="IGMP_277"></a>IGMP各版本对比</h2> 
<p>IGMPv1中定义了基本的组成员查询和报告过程，IGMPv2在此基础上添加了查询器选举和组成员离开的机制，IGMPv3中增加的主要功能是成员可以指定接收或指定不接收某些组播源的报文。三个版本在演进过程中对协议报文的处理是向前兼容的，因此尽管各个版本的协议报文格式不同，但是运行IGMP高版本的路由器可以识别低版本的IGMP报文。</p> 
<p>所有IGMP版本都支持ASM（Any-Source Multicast）模型。IGMPv3可以直接应用于SSM（Source-Specific Multicast）模型，而IGMPv1和IGMPv2则需要IGMP SSM Mapping技术的支持才可以应用于SSM模型。</p> 
<div class="table-box"> 
 <table><thead><tr><th>项目</th><th>IGMPv1</th><th>IGMPv2</th><th>IGMPv3</th></tr></thead><tbody><tr><td>查询器选举方式</td><td>依靠组播路由协议PIM选举</td><td>同网段组播路由器之间竞争选举</td><td>同网段组播路由器之间竞争选举</td></tr><tr><td>普遍组查询报文</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>成员报告报文</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>特定组查询报文</td><td>不支持</td><td>支持</td><td>支持</td></tr><tr><td>成员离开报文</td><td>不支持</td><td>支持</td><td>没有定义专门的成员离开报文，成员离开通过特定类型的报告报文来传达</td></tr><tr><td>特定源组查询报文</td><td>不支持</td><td>不支持</td><td>支持</td></tr><tr><td>指定组播源</td><td>不支持</td><td>不支持</td><td>支持</td></tr><tr><td>可识别报文协议版本</td><td>IGMPv1</td><td>IGMPv1、IGMPv2</td><td>IGMPv1、IGMPv2、IGMPv3</td></tr><tr><td>ASM模型</td><td>支持</td><td>支持</td><td>支持</td></tr><tr><td>SSM模型</td><td>需要IGMP SSM Mapping技术支持</td><td>需要IGMP SSM Mapping技术支持</td><td>支持</td></tr></tbody></table> 
</div> 
<h2><a id="IGMP_SSM_Mapping_296"></a>IGMP SSM Mapping</h2> 
<p>SSM（Source-Specific Multicast）称为指定源组播，要求路由器能了解成员主机加入组播组时所指定的组播源。如果成员主机上运行IGMPv3，可以在IGMPv3报告报文中直接指定组播源地址。但是某些情况下，成员主机只能运行IGMPv1或IGMPv2，为了使其也能够使用SSM服务，路由器上需要提供IGMP SSM Mapping功能。</p> 
<p>IGMP SSM Mapping的机制是：通过在路由器上静态配置SSM地址的映射规则，将IGMPv1和IGMPv2报告报文中的(*, G)信息转化为对应的(G, INCLUDE, (S1, S2…))信息，以提供SSM组播服务。</p> 
<ul><li>如果G在ASM（Any-Source Multicast）范围内，则只提供ASM服务。</li><li>如果G在SSM组地址范围内（缺省情况下为232.0.0.0～232.255.255.255）： 
  <ul><li>如果路由器上没有G对应的SSM Mapping规则，则无法提供SSM服务，丢弃该报文。</li><li>如果路由器上有G对应的SSM Mapping规则，则依据规则将报告报文中所包含的(*, G)信息映射为(G, INCLUDE, (S1, S2…))信息，提供SSM服务。</li></ul> </li></ul> 
<h2><a id="IGMP_Proxy_307"></a>IGMP Proxy</h2> 
<p>IGMP Proxy，也称为IGMP代理，通常被部署在接入设备（RouterA）和成员主机之间的三层设备上，IGMP Proxy设备可以收集下游成员主机的IGMP报告/离开报文，将报告/离开报文汇聚后代理下游成员主机统一上送给接入设备；另一方面，IGMP Proxy设备也可以代理IGMP查询器向下游成员主机发送查询报文，维护组成员关系，基于组成员关系进行组播转发。在接入设备RouterA看来，RouterB就是一台主机；在下游成员主机看来，RouterB就是IGMP查询器。</p> 
<ul><li>上游接口：指IGMP代理设备上配置IGMP Proxy功能的接口，该接口执行IGMP代理设备的主机行为，因此也称为主机接口（Host Interface）。</li><li>下游接口：指IGMP代理设备上配置IGMP功能的接口，该接口执行IGMP代理设备的路由器行为，因此也称为路由器接口（Router Interface）。</li></ul> 
<h3><a id="IGMP_Proxy_314"></a>IGMP Proxy工作机制:</h3> 
<p>IGMP代理设备实现的功能主要分为两种：主机行为和路由器行为。</p> 
<p><strong>主机行为</strong></p> 
<p>主机行为是指IGMP代理设备的上游接口收到查询报文时根据当前组播转发表的状态对查询报文做出响应，或者当组播转发表发生变化时上游接口主动向接入设备发送报告/离开报文。主机行为的工作机制如下：</p> 
<ul><li> <p>IGMP代理设备上游接口收到查询报文时，会根据当前组播转发表的状态对查询报文做出响应。</p> </li><li> <p>IGMP代理设备收到某组播组的报告报文后，会在组播转发表中查找该组播组：</p> 
  <ul><li>如果没有找到相应的组播组，IGMP代理设备会向接入设备发送针对该组播组的报告报文，并在组播转发表中添加该组播组；</li><li>如果找到相应的组播组，IGMP代理设备就不需要向接入设备发送报告报文。</li></ul> </li><li> <p>IGMP代理设备收到某组播组G的离开报文后，会向接收到该离开报文的接口发送一个特定组查询报文，检查该接口下是否还存在组播组G的其他成员：</p> 
  <ul><li>如果没有其他成员，IGMP代理设备会向接入设备发送针对该组播组的离开报文，并在组播转发表中将对应的接口删除；</li><li>如果有其他成员，IGMP代理设备会继续向该接口转发组播数据。</li></ul> </li></ul> 
<p><strong>路由器行为</strong></p> 
<p>路由器行为是指IGMP代理设备的下游接口通过成员主机加入/离开组播组的信息生成组播转发表项、接收接入设备下发的组播数据并根据组播转发表项的出接口信息向特定的接口转发组播数据。</p> 
<h3><a id="IGMP_Proxy_336"></a>IGMP Proxy备份机制：</h3> 
<p>为了提高链路的可靠性，IGMP代理设备的上游接口配置完IGMP Proxy功能后，可以再在IGMP代理设备上配置一个IGMP<br> Proxy备份接口，作为上游接口的备份，如下图所示。这样，当上游接口所在链路发生故障时，备份链路会自动接管IGMP代理业务，使业务能够自动恢复。</p> 
<p><img src="https://images2.imgbox.com/f4/54/QI0hWWpo_o.png" alt="这里写图片描述"></p> 
<center>
  图：IGMP Proxy备份机制 
 <center> 
 </center> 
</center> 
<p>IGMP Proxy本身并没有检测机制，如果组播链路发生了故障，无法保证及时进行主、备链路的切换，可能造成较长时间的组播业务中断。通过IGMP Proxy与NQA联动可以解决此问题。IGMP Proxy与NQA测试例联动是利用NQA测试例检测端到端的链路状态，并根据NQA测试例的检测结果，进行主、备链路的切换，从而避免通信长时间中断。</p> 
<h2><a id="IGMP_347"></a>IGMP常用命令行</h2> 
<pre class="prettyprint"><code class="prism language-c has-numbering">接口上设置其他IGMP查询器的存活时间。
display igmp explicit<span class="token operator">-</span>tracking
<span class="token comment">//查看使用Include模式加入特定源组的IGMPv3主机信息。</span>
display igmp group
<span class="token comment">//查看通过主机发送报告报文动态加入的IGMP组播组信息。</span>
display igmp group ssm<span class="token operator">-</span>mapping
<span class="token comment">//查看根据SSM Mapping规则创建的组播组信息。</span>
display igmp group <span class="token keyword">static</span>
<span class="token comment">//查看IGMP静态组播组的配置信息。</span>
display igmp routing<span class="token operator">-</span>table
<span class="token comment">//查看IGMP路由表信息。</span>
display igmp ssm<span class="token operator">-</span>mapping
<span class="token comment">//查看IGMP SSM Mapping的配置信息。</span>
igmp
<span class="token comment">//进入IGMP视图。</span>
igmp enable
<span class="token comment">//在接口上使能IGMP功能。</span>
igmp global limit
<span class="token comment">//配置整个路由器上可以创建的所有IGMP表项的最大个数。</span>
igmp group<span class="token operator">-</span>policy
<span class="token comment">//在接口上设置IGMP组播组的过滤器，限制主机能够加入的组播组范围。</span>
igmp ip<span class="token operator">-</span>source<span class="token operator">-</span>policy
<span class="token comment">//配置设备根据源地址对IGMP报告/离开报文进行过滤。</span>
igmp lastmember<span class="token operator">-</span>queryinterval interval
<span class="token comment">//在接口上配置IGMP查询器在收到主机发送的IGMP离开报文时，</span>
<span class="token comment">//发送IGMP特定组\源组查询报文的时间间隔。</span>
<span class="token comment">//缺省情况下，IGMP特定组\源组查询报文的发送时间间隔是1秒。</span>
igmp max<span class="token operator">-</span>response<span class="token operator">-</span>time <span class="token number">10</span>
<span class="token comment">//在接口上配置IGMP普遍组查询报文的最大响应时间。</span>
<span class="token comment">//缺省情况下，IGMP普遍组查询报文的最大响应时间是10秒。</span>
igmp on<span class="token operator">-</span>demand
<span class="token comment">/*
  配置IGMP On-Demand功能.
  使查询器不主动发送查询报文，而是根据成员的要求来维护
  成员关系。配置IGMP On-Demand功能后，接口上动态加
  入的组播组永不超时。
*/</span>
igmp prompt<span class="token operator">-</span>leave
<span class="token comment">//在接口上配置组播组成员快速离开功能，</span>
<span class="token comment">//即IGMP查询器在接收到成员主机发送的离开报文后不发送</span>
<span class="token comment">//特定组查询报文，立即删除该组表项。</span>
igmp proxy
<span class="token comment">//在接口上使能IGMP Proxy功能。</span>
igmp proxy backup
<span class="token comment">//配置接口成为具有IGMP Proxy功能的备份接口。</span>
igmp query ip<span class="token operator">-</span>source<span class="token operator">-</span>policy
<span class="token comment">//配置IGMP查询报文源地址过滤策略。</span>
igmp send<span class="token operator">-</span>router<span class="token operator">-</span>alert
<span class="token comment">//在接口上配置发送的IGMP报文中包含Router-Alert选项。</span>
igmp require<span class="token operator">-</span>router<span class="token operator">-</span>alert
<span class="token comment">//在接口上配置丢弃不包含Router-Alert选项的IGMP报文。</span>
igmp robust<span class="token operator">-</span>count <span class="token number">2</span>
<span class="token comment">//在接口上设置IGMP查询器的健壮系数。</span>
<span class="token comment">//缺省情况下，IGMP查询器的健壮系数是2。</span>
igmp ssm<span class="token operator">-</span>mapping enable
<span class="token comment">//在接口上使能SSM Mapping。</span>
igmp <span class="token keyword">static</span><span class="token operator">-</span>group
<span class="token comment">//在接口上配置静态组播组。</span>
igmp timer other<span class="token operator">-</span>querier<span class="token operator">-</span>present
<span class="token comment">//接口上设置其他IGMP查询器的存活时间。</span>
<span class="token comment">//缺省时，其他IGMP查询器的存活时间的值为125秒。</span>
<span class="token comment">//其他IGMP查询器的存活时间 ＝ 健壮系数 × IGMP普遍查询报文发送间隔 +（1/2）× 最大查询响应时间。</span>
igmp timer query <span class="token number">60</span>
<span class="token comment">//在接口上配置IGMP普遍组查询报文的发送间隔。</span>
igmp version
<span class="token comment">//在接口上配置运行的IGMP版本。</span>
lastmember<span class="token operator">-</span>queryinterval <span class="token number">1</span>
<span class="token comment">//配置IGMP查询器在收到主机发送的IGMP离开报文时，</span>
<span class="token comment">//发送IGMP特定组\源组查询报文的时间间隔。</span>
<span class="token comment">//缺省情况下，IGMP特定组\源组查询报文的发送时间间隔是1秒。</span>
max<span class="token operator">-</span>response<span class="token operator">-</span>time <span class="token number">10</span>
  <span class="token comment">//全局配置IGMP普遍组查询报文的最大响应时间。</span>
 proxy source<span class="token operator">-</span>lifetime <span class="token number">210</span>
<span class="token comment">//配置Proxy设备上生成（S，G）表项的超时时间。</span>
<span class="token comment">//缺省情况下，Proxy设备上生成（S，G）表项的超时时间是210秒。</span>
require<span class="token operator">-</span>router<span class="token operator">-</span>alert
<span class="token comment">//配置丢弃不包含Router-Alert选项的IGMP报文。</span>
reset igmp control<span class="token operator">-</span>message counters
<span class="token comment">//清除IGMP报文统计数。</span>
reset igmp explicit<span class="token operator">-</span>tracking
<span class="token comment">//删除接口上通过IGMP动态加入组播组的主机。</span>
robust<span class="token operator">-</span>count <span class="token number">2</span>
<span class="token comment">//设置IGMP查询器的健壮系数。</span>
send<span class="token operator">-</span>router<span class="token operator">-</span>alert
<span class="token comment">//指定设备发送的IGMP报文中包含Router-Alert选项。</span>
ssm<span class="token operator">-</span>mapping
<span class="token comment">//配置SSM Mapping的源组映射规则。</span>
timer other<span class="token operator">-</span>querier<span class="token operator">-</span>present
<span class="token comment">//设置其他IGMP查询器存活时间。</span>
timer query <span class="token number">60</span>
<span class="token comment">//全局配置IGMP普遍组查询报文的发送间隔。</span>
</code>
 
 <div class="hljs-button {2}"></div>
 
 </pre><ul class="pre-numbering"><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li><li>13</li><li>14</li><li>15</li><li>16</li><li>17</li><li>18</li><li>19</li><li>20</li><li>21</li><li>22</li><li>23</li><li>24</li><li>25</li><li>26</li><li>27</li><li>28</li><li>29</li><li>30</li><li>31</li><li>32</li><li>33</li><li>34</li><li>35</li><li>36</li><li>37</li><li>38</li><li>39</li><li>40</li><li>41</li><li>42</li><li>43</li><li>44</li><li>45</li><li>46</li><li>47</li><li>48</li><li>49</li><li>50</li><li>51</li><li>52</li><li>53</li><li>54</li><li>55</li><li>56</li><li>57</li><li>58</li><li>59</li><li>60</li><li>61</li><li>62</li><li>63</li><li>64</li><li>65</li><li>66</li><li>67</li><li>68</li><li>69</li><li>70</li><li>71</li><li>72</li><li>73</li><li>74</li><li>75</li><li>76</li><li>77</li><li>78</li><li>79</li><li>80</li><li>81</li><li>82</li><li>83</li><li>84</li><li>85</li><li>86</li><li>87</li><li>88</li><li>89</li><li>90</li><li>91</li></ul> 
<p>#IGMP学习笔记</p> 
<h3><a id="_445"></a>查询者的作用：</h3> 
<p>查询者可以转发组播流量，通过这种方式可以避免组播流量的重复。为了保证组播可靠性，非查询者的路由器也会创建并维护组播组，同时非查询者需要监听查询者的存在，如果查询者在Hold timer时间内没有发送查询报文，非查询者会认为查询者已经故障，需要重新选举查询者。查询者会转发组播流量，同时每隔interval（60s）的时间发送查询报文。</p> 
<hr> 
<blockquote> 
 <p>参考文档：华为HedEx文档</p> 
</blockquote> 
<hr> 
<pre><code>                                &lt;/div&gt;
            &lt;link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-095d4a0b23.css" rel="stylesheet"&gt;
                &lt;/div&gt;
&lt;/article&gt;
&lt;/div&gt;
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a5ab25f41673618aa21243a12628f64c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android使用高德和风天气Sdk获取定位实况天气数据（二）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4afaf2db6bbd7747675c57e1be1351b6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Qt 的第一个的错误：Could not create directory</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>