<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MySQL基础-18 视图 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MySQL基础-18 视图" />
<meta property="og:description" content="视图 含义：虚拟表，和普通表一样使用
mysql 5.0.1 版本出现的新特性，是通过表动态生成的数据，只保存了sql逻辑，不保存查询结果。
应用场景：
多个地方用到同样的查询结果该查询结果使用的sql语句较复杂 好处：
重用sql语句简化复杂的sql操作，不知道它查询的细节保护数据，提高安全性 1 创建视图 语法：
create view 视图名
as
查询语句;
案例
查询姓名中包含a字符的员工名、部门名和工种信息 CREATE VIEW myv1 AS SELECT `last_name`,`department_name`,`job_title` FROM `employees` e JOIN `departments` d ON e.`department_id`=d.`department_id` JOIN `jobs` j ON j.`job_id`=e.`job_id`; SELECT * FROM `myv1` WHERE last_name LIKE &#39;%a%&#39;; 查询各部门的平均工资级别 CREATE VIEW myv2 AS SELECT AVG(salary) ag,department_id FROM `employees` GROUP BY department_id; SELECT * FROM myv2; SELECT myv2.`ag`,g.grade_level FROM myv2 JOIN job_grade g ON myv2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e7427577b1dd24345aaaefc49d5c8013/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-16T10:30:00+08:00" />
<meta property="article:modified_time" content="2022-05-16T10:30:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MySQL基础-18 视图</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>视图</h2> 
<p>含义：虚拟表，和普通表一样使用<br> mysql 5.0.1 版本出现的新特性，是通过表<strong>动态生成的数据，只保存了sql逻辑，不保存查询结果</strong>。</p> 
<p>应用场景：</p> 
<ul><li>多个地方用到同样的查询结果</li><li>该查询结果使用的sql语句较复杂</li></ul> 
<p>好处：</p> 
<ul><li>重用sql语句</li><li>简化复杂的sql操作，不知道它查询的细节</li><li>保护数据，提高安全性</li></ul> 
<h3><a id="1__13"></a>1 创建视图</h3> 
<p>语法：<br> <strong>create view 视图名<br> as<br> 查询语句;</strong></p> 
<p><strong>案例</strong></p> 
<ol><li>查询姓名中包含a字符的员工名、部门名和工种信息</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> myv1
<span class="token keyword">AS</span> 
<span class="token keyword">SELECT</span> <span class="token identifier"><span class="token punctuation">`</span>last_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>department_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>job_title<span class="token punctuation">`</span></span>
<span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>employees<span class="token punctuation">`</span></span> e
<span class="token keyword">JOIN</span> <span class="token identifier"><span class="token punctuation">`</span>departments<span class="token punctuation">`</span></span> d <span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token operator">=</span>d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span>
<span class="token keyword">JOIN</span> <span class="token identifier"><span class="token punctuation">`</span>jobs<span class="token punctuation">`</span></span> j <span class="token keyword">ON</span> j<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span><span class="token operator">=</span>e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> 
<span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>myv1<span class="token punctuation">`</span></span>
<span class="token keyword">WHERE</span> last_name <span class="token operator">LIKE</span> <span class="token string">'%a%'</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="2"><li>查询各部门的平均工资级别</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> myv2
<span class="token keyword">AS</span> 
<span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> ag<span class="token punctuation">,</span>department_id
<span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">`</span>employees<span class="token punctuation">`</span></span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv2<span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> myv2<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>ag<span class="token punctuation">`</span></span><span class="token punctuation">,</span>g<span class="token punctuation">.</span>grade_level
<span class="token keyword">FROM</span> myv2
<span class="token keyword">JOIN</span> job_grade g
<span class="token keyword">ON</span> myv2<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>ag<span class="token punctuation">`</span></span> <span class="token operator">BETWEEN</span> g<span class="token punctuation">.</span>lowest_sal <span class="token operator">AND</span> g<span class="token punctuation">.</span>highest<span class="token punctuation">.</span>sal <span class="token punctuation">;</span>
</code></pre> 
<ol start="3"><li>查询平均工资最低的部门信息</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv2 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> ag <span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="4"><li>查询平均工资最低部门名和工资</li></ol> 
<pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> myv3
<span class="token keyword">AS</span> 
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myv2 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> ag <span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> d<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>ag
<span class="token keyword">FROM</span> myv3 m
<span class="token keyword">JOIN</span> <span class="token identifier"><span class="token punctuation">`</span>departments<span class="token punctuation">`</span></span> d
<span class="token keyword">ON</span> m<span class="token punctuation">.</span>department_id<span class="token operator">=</span>d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> 
<h2><a id="2___69"></a>2 视图的修改</h2> 
<p>方式一：<br> create or replace view 视图名<br> as<br> 查询语句;</p> 
<p>方式二：<br> alter view 视图名<br> as<br> 查询语句；</p> 
<h2><a id="3__80"></a>3 删除视图</h2> 
<p>语法<br> drop view 视图名，视图名…;</p> 
<h2><a id="4__84"></a>4 查看视图</h2> 
<p>方式一：desc 视图名；<br> 方式二：show create view 视图名;</p> 
<h2><a id="5__89"></a>5 视图的更新</h2> 
<p>在视图中插入：insert，update,delete<br> 注意：如果在视图中增删改了一条数据，原始表中也新增了一条。<br> 所以视图一般添加只读权限。<br> <strong>视图的可更新性和视图中查询的定义有关系，以下类型的视图是不能更新的：</strong></p> 
<ul><li>包含以下关键字的sql语句：分组函数、distinct、group by、having、union或union all</li><li>常量视图</li><li>select 中包含子查询</li><li>join</li><li>from一个不能更新的视图</li><li>where子句的子查询引用了from子句中的表</li></ul> 
<h2><a id="6__102"></a>6 视图和表的对比</h2> 
<table><thead><tr><th></th><th>创建语法的关键字</th><th>是否实际占用物理空间</th><th>使用</th></tr></thead><tbody><tr><td>视图</td><td>create view</td><td>没有，只是保存了sql逻辑</td><td>增删改查，一般情况下只读</td></tr><tr><td>表</td><td>create table</td><td>占用</td><td>增删改查</td></tr></tbody></table>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8cfa5d7b2a91bfcca99fa22deb7ef75c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL基础-19 存储过程和函数</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0432b8dd7e6e581ab8803961960082f0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">docker-compose快速搭建hadoop</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>