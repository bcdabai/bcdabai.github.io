<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>yolov5è¸©å‘è®°å½•ï¼šæ ‡ç­¾é”™ä½ï¼ˆPILè¯»å–å›¾ç‰‡æ–¹å‘å¼‚å¸¸ï¼‰ - ç¼–ç¨‹å¤§ç™½çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="yolov5è¸©å‘è®°å½•ï¼šæ ‡ç­¾é”™ä½ï¼ˆPILè¯»å–å›¾ç‰‡æ–¹å‘å¼‚å¸¸ï¼‰" />
<meta property="og:description" content="PILè¸©å‘è®°å½•ï¼šè¯»å–å›¾ç‰‡æ–¹å‘å¼‚å¸¸ï¼ˆyolov5æ ‡ç­¾é”™ä½ï¼‰ å¥‡æ€ªçš„ç°è±¡ ä»Šå¤©ç”¨ YOLOv5 åšé¡¹ç›®æ—¶ï¼Œå¯¹æ•°æ®é›†çš„æ ‡è®°å‡ºç°äº†å¥‡æ€ªçš„ç°è±¡ï¼Œåœ¨ä¸‹è¿°æµ‹è¯•ç”¨ä¾‹ä¸­å¯æ˜æ˜¾çœ‹åˆ°ï¼Œæ ‡è®°æ¡†åç¦»äº†ç‰©ä½“ï¼Œæ•…å‘æ–‡é˜è¿°åŸå› å’Œè§£å†³æ–¹æ³•. â€”â€”Â©ï¸ Sylvan Ding è½¬è½½éœ€æ³¨æ˜å‡ºå¤„ï¼
ä¸‹è½½äº†ä¸€ä»½æ•°æ®é›†UNIMIB2016ï¼Œä½¿ç”¨ PIL è¯»å–å…¶ä¸­ä¸€å¼ ç…§ç‰‡å¹¶æ ‡è®° bbox.
from PIL import Image img_name = &#39;20151127_120643.jpg&#39; img = Image.open(img_name) img.show() from PIL import ImageDraw from PIL import ImageFont label_name = &#39;20151127_120643.txt&#39; with open(label_name) as file: items = file.readlines() draw = ImageDraw.Draw(img) for item in items: item = item.split() # convert str to int item[1:] = list(map(int, item[1:])) # draw bbox draw.rectangle([item[1], item[2], item[5], item[6]], outline=&#34;red&#34;, width=20) # add text about order of the points for j, i in enumerate([1, 3, 5, 7]): j = j &#43; 1 draw." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/e1185a2e99a8d3b2307fb048ab907ab6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-26T14:41:13+08:00" />
<meta property="article:modified_time" content="2022-04-26T14:41:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å¤§ç™½çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å¤§ç™½çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">yolov5è¸©å‘è®°å½•ï¼šæ ‡ç­¾é”™ä½ï¼ˆPILè¯»å–å›¾ç‰‡æ–¹å‘å¼‚å¸¸ï¼‰</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="PILyolov5_0"></a>PILè¸©å‘è®°å½•ï¼šè¯»å–å›¾ç‰‡æ–¹å‘å¼‚å¸¸ï¼ˆyolov5æ ‡ç­¾é”™ä½ï¼‰</h2> 
<h3><a id="_2"></a>å¥‡æ€ªçš„ç°è±¡</h3> 
<p>ä»Šå¤©ç”¨ <strong>YOLOv5</strong> åšé¡¹ç›®æ—¶ï¼Œå¯¹æ•°æ®é›†çš„æ ‡è®°å‡ºç°äº†å¥‡æ€ªçš„ç°è±¡ï¼Œåœ¨ä¸‹è¿°æµ‹è¯•ç”¨ä¾‹ä¸­å¯æ˜æ˜¾çœ‹åˆ°ï¼Œæ ‡è®°æ¡†åç¦»äº†ç‰©ä½“ï¼Œæ•…å‘æ–‡é˜è¿°åŸå› å’Œè§£å†³æ–¹æ³•. â€”â€”Â©ï¸ <a href="https://blog.csdn.net/IYXUAN">Sylvan Ding</a> <em>è½¬è½½éœ€æ³¨æ˜å‡ºå¤„</em>ï¼</p> 
<p><img src="https://images2.imgbox.com/c4/ff/ySmOLawZ_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<blockquote> 
 <p>ä¸‹è½½äº†ä¸€ä»½æ•°æ®é›†<code>UNIMIB2016</code>ï¼Œä½¿ç”¨ PIL è¯»å–å…¶ä¸­ä¸€å¼ ç…§ç‰‡å¹¶æ ‡è®° bbox.</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image

img_name <span class="token operator">=</span> <span class="token string">'20151127_120643.jpg'</span>
img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>img_name<span class="token punctuation">)</span>
img<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/bb/e6/ISIDmKRH_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> ImageDraw
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> ImageFont

label_name <span class="token operator">=</span> <span class="token string">'20151127_120643.txt'</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>label_name<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
    items <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
draw <span class="token operator">=</span> ImageDraw<span class="token punctuation">.</span>Draw<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
<span class="token keyword">for</span> item <span class="token keyword">in</span> items<span class="token punctuation">:</span>
  
    item <span class="token operator">=</span> item<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># convert str to int</span>
    item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># draw bbox</span>
    draw<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span><span class="token punctuation">[</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> item<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> item<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       outline<span class="token operator">=</span><span class="token string">"red"</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    
    <span class="token comment"># add text about order of the points</span>
    <span class="token keyword">for</span> j<span class="token punctuation">,</span> i <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        j <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span>
        draw<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">[</span>item<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> item<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>

img<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
<span class="token comment"># items</span>
<span class="token comment"># ['pane 2008 404 2713 404 2713 915 2008 915\n',</span>
<span class="token comment">#  'pizzoccheri 1502 1104 2500 1104 2500 1984 1502 1984\n',</span>
<span class="token comment">#  'arrosto 634 602 1193 602 1193 1371 634 1371\n',</span>
<span class="token comment">#  'patate/pure 271 539 708 539 708 1408 271 1408\n']</span>

<span class="token comment"># the lash item, whose form is [cls, x1, y1, x2, y2, x3, y3, x4, y4]</span>
<span class="token comment"># ['patate/pure', 271, 539, 708, 539, 708, 1408, 271, 1408]</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/30/81/EbLfAfED_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<blockquote> 
 <p>bbox æ­£ç¡®ï¼Œä½†æ•´å¼ å›¾ç‰‡å¥½ä¼¼è¢«æ—‹è½¬äº†ä¸€æ ·ã€‚æ¥ç€ä½¿ç”¨ cv2 è¿›è¡Œç›¸åŒæ“ä½œï¼Œå¹¶è§‚å¯Ÿç»“æœã€‚</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">import</span> cv2
<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt

img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>img_name<span class="token punctuation">)</span>
img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2RGB<span class="token punctuation">)</span>

<span class="token keyword">for</span> item <span class="token keyword">in</span> items<span class="token punctuation">:</span>

    item <span class="token operator">=</span> item<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># convert str to int</span>
    item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># draw bbox</span>
    cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span> img<span class="token punctuation">,</span>
                  <span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  <span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> item<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ed/f4/vO0NTX38_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<blockquote> 
 <p>ä¸éš¾å‘ç°ï¼Œ<code>draw bbox</code> ä¸­ä½¿ç”¨çš„åæ ‡å‡ä¸º <code>[x1,y1], [x3, y3]</code>ï¼Œå³å¯¹è§’åæ ‡ï¼ˆleft-topã€right-bottomï¼‰ï¼Œä½† <code>PIL</code> å’Œ <code>cv2</code> çš„ç»“æœä¸åŒã€‚<code>cv2</code> ä¸­ bbox é”™ä½äº†ï¼Œè€Œ <code>PIL</code> ä¸­ text å‘ç”Ÿäº†æ—‹è½¬.</p> 
</blockquote> 
<p>ğŸ˜¯ ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿè¿™ç§ç°è±¡å‘¢ï¼Ÿä» EXIT è¯´èµ·ï¼š</p> 
<h3><a id="EXIF_94"></a>ä»€ä¹ˆæ˜¯EXIF?</h3> 
<p><strong>EXIF</strong>(Exchangeable Image File)æ˜¯"å¯äº¤æ¢å›¾åƒæ–‡ä»¶"çš„ç¼©å†™ï¼Œå½“ä¸­åŒ…å«äº†ä¸“é—¨ä¸ºæ•°ç ç›¸æœºçš„ç…§ç‰‡è€Œå®šåˆ¶çš„å…ƒæ•°æ®ï¼Œå¯ä»¥è®°å½•æ•°ç ç…§ç‰‡çš„æ‹æ‘„å‚æ•°ã€ç¼©ç•¥å›¾åŠå…¶ä»–å±æ€§ä¿¡æ¯ã€‚Exif æ–‡ä»¶å®é™…æ˜¯JPEGæ–‡ä»¶çš„ä¸€ç§ï¼Œéµä»JPEGæ ‡å‡†ï¼Œåªæ˜¯åœ¨æ–‡ä»¶å¤´ä¿¡æ¯ä¸­å¢åŠ äº†æœ‰å…³æ‹æ‘„ä¿¡æ¯çš„å†…å®¹å’Œç´¢å¼•å›¾ã€‚</p> 
<p>ç®€å•æ¥è¯´ï¼ŒExif ä¿¡æ¯å°±æ˜¯ç”±æ•°ç ç›¸æœºåœ¨æ‹æ‘„è¿‡ç¨‹ä¸­é‡‡é›†ä¸€ç³»åˆ—çš„ä¿¡æ¯ï¼Œç„¶åæŠŠä¿¡æ¯æ”¾ç½®åœ¨æˆ‘ä»¬ç†ŸçŸ¥çš„ JPEG/TIFF æ–‡ä»¶çš„å¤´éƒ¨ï¼Œä¹Ÿå°±æ˜¯è¯´ Exifä¿¡æ¯æ˜¯é•¶åµŒåœ¨ JPEG/TIFF å›¾åƒæ–‡ä»¶æ ¼å¼å†…çš„ä¸€ç»„æ‹æ‘„å‚æ•°ï¼Œå®ƒå°±å¥½åƒæ˜¯å‚»ç“œç›¸æœºçš„æ—¥æœŸæ‰“å°åŠŸèƒ½ä¸€æ ·ï¼Œåªä¸è¿‡ Exifä¿¡æ¯æ‰€è®°å½•çš„èµ„è®¯æ›´ä¸ºè¯¦å°½å’Œå®Œå¤‡ã€‚</p> 
<h3><a id="EXIF_Orientation_tag_100"></a>EXIF Orientation tag</h3> 
<p><strong>EXIF Orientation tag</strong>ï¼ˆEXIFæ–¹å‘å‚æ•°ï¼‰è®©ä½ éšä¾¿ç…§åƒä½†éƒ½å¯ä»¥çœ‹åˆ°æ­£ç¡®æ–¹å‘çš„ç…§ç‰‡è€Œæ— éœ€æ‰‹åŠ¨æ—‹è½¬ï¼ˆå‰æè¦å›¾ç‰‡æµè§ˆå™¨æ”¯æŒï¼ŒWindows è‡ªå¸¦çš„ä¸æ”¯æŒï¼‰.</p> 
<p><img src="https://images2.imgbox.com/41/e3/fvET1xHt_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h3><a id="__107"></a>â­ï¸ åŸå› è§£é‡Š</h3> 
<p>é€ æˆç¬¬ä¸€ç›®ä¸­â€œå¥‡æ€ªç°è±¡â€çš„åŸå› ï¼Œæˆ‘å°†å…¶å½’çº³ä¸ºï¼šåœ¨æ ‡è®°æ•°æ®é›†æ—¶ï¼Œä¸å…³æ³¨å›¾åƒçš„ EXIF Orientation tagï¼Œè€Œå›¾åƒæœ¬èº«æ˜¯å«æœ‰ EXIF Orientation tag çš„ã€‚åœ¨ <code>PIL</code> è¯»å–å›¾ç‰‡æ—¶ï¼Œåˆ›å»ºäº† <code>Image</code> å¯¹è±¡ï¼Œå…¶ä¸­å­˜æœ‰ EXIF Orientation tagï¼Œæ ¹æ®è¯¥æ ‡è®°ï¼Œä¸ä»…æ—‹è½¬äº†å›¾åƒï¼Œè¿˜æ—‹è½¬äº†å›¾åƒçš„å‚è€ƒç³»ã€‚è€Œ <code>cv2</code> è¯»å–å›¾ç‰‡æ—¶ï¼Œç›´æ¥ç”Ÿæˆ <code>numpy.ndarray</code> æ•°ç»„ï¼Œåªæ ¹æ® EXIF Orientation tag å¯¹å›¾åƒè¿›è¡Œäº†æ—‹è½¬ï¼Œä½†å¹¶<strong>æ²¡æœ‰æ—‹è½¬å›¾åƒçš„å‚è€ƒç³»</strong>ï¼</p> 
<h4><a id="PIL_111"></a>PIL</h4> 
<p><img src="https://images2.imgbox.com/61/d5/fyqkitt7_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p><img src="https://images2.imgbox.com/28/b1/TL2hpHFV_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<h4><a id="cv2_119"></a>cv2</h4> 
<p><img src="https://images2.imgbox.com/c4/a0/7p9nQTbd_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<p>åœ¨ç»˜åˆ¶çŸ©å½¢æ¡†æ—¶ï¼ŒäºŒè€…ä¾èµ–çš„å‚è€ƒç³»ä¸åŒï¼Œå¯¼è‡´æ ‡è®°çš„é”™ä½ã€‚è€Œ yolov5 ä½¿ç”¨çš„æ­£æ˜¯ cv2ï¼Œæ•…è¯»å–å« EXIF Orientation tag çš„å›¾ç‰‡æ—¶ï¼Œä¼šé€ æˆ labels å’Œ å›¾ç‰‡çš„é”™ä½ã€‚</p> 
<h3><a id="_126"></a>åŸå› è¯å®</h3> 
<blockquote> 
 <p>PIL çš„ <code>PIL.ImageOps.exif_transpose(image)</code>æ–¹æ³•ï¼Œå¯ä»¥åœ¨è¯»å–å›¾ç‰‡åï¼Œæ¸…é™¤ <code>Image</code> å¯¹è±¡å†…çš„ EXIF Orientation tagï¼Œä»è€Œè®©åæ ‡ç³»ä¸å—è¯¥ tag çš„å½±å“.</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> ImageOps

img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>img_name<span class="token punctuation">)</span>
img <span class="token operator">=</span> ImageOps<span class="token punctuation">.</span>exif_transpose<span class="token punctuation">(</span>img<span class="token punctuation">)</span>

<span class="token comment"># draw bbox</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/02/fc/BkR2cvlR_o.png" alt="1"></p> 
<p>å¯è§ï¼Œæ¸…é™¤ EXIF æ—‹è½¬ä¿¡æ¯åï¼ŒPIL æ‰€å¾—ç»“æœå’Œ cv2 ç»“æœä¸€è‡´ï¼</p> 
<h3><a id="__145"></a>â­ï¸ è§£å†³æ–¹æ³•</h3> 
<blockquote> 
 <p>â¤ï¸ å½“ç„¶ï¼Œå¦‚æœä½ æœ‰æ›´å¥½çš„æ–¹æ³•æ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€å‘Šè¯‰æˆ‘å“¦ï¼</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">from</span> os <span class="token keyword">import</span> listdir
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

img <span class="token operator">=</span> <span class="token string">'./images/'</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> img_name <span class="token keyword">in</span> listdir<span class="token punctuation">(</span>img_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>img_path <span class="token operator">+</span> img_name<span class="token punctuation">)</span>
        img_rectified <span class="token operator">=</span> Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>np<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">)</span>
        img_rectified<span class="token punctuation">.</span>save<span class="token punctuation">(</span>img_path <span class="token operator">+</span> img_name<span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>ä¸Šè¿°ä»£ç å¯¹ <code>./images/</code>æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰å›¾ç‰‡è¿›è¡Œäº†â€œä¿®æ­£â€ï¼Œæ ¸å¿ƒæ˜¯ <code>img_rectified = Image.fromarray(np.asarray(img))</code>ï¼Œ(1). å°† <code>img</code> è½¬åŒ–ä¸º <code>ndarray</code>ï¼Œ(2). å†å°†è¯¥<code>ndarray</code>è½¬åŒ–ä¸º<code>Image</code>å¹¶ä¿å­˜.</p> 
</blockquote> 
<p>(1)ã€(2) ç­‰åŒäºå»é™¤äº†å›¾ç‰‡æ‰€æœ‰çš„ EXIF ä¿¡æ¯ï¼Œè¿™æ ·å›¾ç‰‡å°±ä¸ä¼šå†å‘ç”Ÿâ€œè‡ªåŠ¨æ—‹è½¬â€çš„ç°è±¡äº†.</p> 
<p><img src="https://images2.imgbox.com/a2/07/OUJ60QWI_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<blockquote> 
 <p>è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼šÂ©ï¸ <a href="https://blog.csdn.net/IYXUAN">Sylvan Ding</a></p> 
</blockquote> 
<h3><a id="_171"></a>å‚è€ƒæ–‡çŒ®</h3> 
<ol><li><a href="https://stackoverflow.com/questions/4228530/pil-thumbnail-is-rotating-my-image" rel="nofollow">PIL thumbnail is rotating my image?</a></li><li><a href="https://zhuanlan.zhihu.com/p/366726838" rel="nofollow">å›¾ç‰‡å…ƒä¿¡æ¯Exifï¼Œç»™ä½ è¯¦ç»†è®²è®²</a></li><li><a href="https://blog.csdn.net/happy08god/article/details/11528479">EXIF æ–¹å‘å‚æ•° Orientation</a></li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/baac1b9795ff975ff8188d36940b526d/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">Pytorchå­¦ä¹ ç¬”è®°ï¼ˆ16ï¼‰â€”â€”â€”é¢„è®­ç»ƒæ¨¡å‹å¾®è°ƒ</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/aea3e20406e1361111a02ab83bdc6253/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">Trieæ ‘å®ç°å‰ç¼€è‡ªåŠ¨è¡¥å…¨ &#43; ACè‡ªåŠ¨æœºå®ç°æ•æ„Ÿè¯è¿‡æ»¤</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å¤§ç™½çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>