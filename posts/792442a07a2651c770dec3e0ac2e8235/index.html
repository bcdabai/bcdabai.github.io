<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>接口性能测试，这个还真有用啊。 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="接口性能测试，这个还真有用啊。" />
<meta property="og:description" content="一、概述 性能测试按照不同视角，可以分为以下几类：
a. 用户视角的性能
用户角度感受到的网站响应速度的快和慢。从用户在浏览器输入网址/打开应用，到整个页面呈现给用户的耗时。包含了用户端发送请求，服务端收到并执行请求，返回请求，客户端收到之后渲染的总时间。
b.开发人员视角的性能
包括系统吞吐量，并发处理能力，系统稳定性，响应延迟等。如果发现有不满足要求的地方，需要定位出问题所在，并给出解决方案。
c.运维
主要关注基础设施性能和资源利用率，如网络运营商带宽能力，服务器应急配置，数据中心网络架构，服务器和网络带宽的资源利用率等。
二、为什么要做接口压力测试 1.清楚自己所提供的接口性能是多少
2.判断出系统可能存在的问题（代码，DB，cache，系统配置,容量等），提前解决
3.为设置接口的限流/熔断做参考
三、接口压力测试的局限性 接口压力测试只注重单业务的接口性能，进行压测的时候，只关注个别接口的性能。
接口大部分时间是在线下进行，可能线上线下机器配置不一样，而且线上同时在进行着各种不同的业务。
因此在线下进行接口压力测试的结果，只能作为线上配置的一个参考值。
四、谁来做接口压力测试 对接口比较熟悉的开发人员来做，这样有以下好处：
1.对接口实现比较了解，对接口中潜在的问题有一定的预判
2.比较容易对接口进行优化（业务逻辑层面和技术层面）。
五、如何做接口压力测试 通常使用 Jmeter ，loadRunner 等进行压力测试。
六、如何设计接口压力测试方案 如何确定并发数：
可以通过尝试的方式。第一次压测的时候，可以设置自己预期接口需要达到的并发数，进行压力测试。然后通过二分法进行调整。
举例：如果期望的并发数是512 ，第一次压测并发数设置为512 ，如果系统没有压力，第二次并发就尝试设置为1024。如果系统有压力，下次就设置为256。通过逐渐尝试的方式，找出当前接口的并发阈值。
如何确定总请求次数：
有时候单纯的通过并发数并不能完全发现系统的压力状况，因为并发数只能测出系统的处理能力。
但是有时随着长时间的调用，系统可能会出现其他问题。比如：随着数据量的增多，存储磁盘满了、内存缓存用光，缓存服务使用磁盘缓存而拖慢系统等情况。
为了避免这种情况，可以尝试用现有线上业务每天产生的数量乘以一定的天数（天数的大小视业务的具体情况而定，推荐180天以上），作为接口压力测试的总请求次数。
接口压力测试数据的选取：
通常随机选择数据。但是要注意重复进行压力测试对性能的影响。
比如：
第一次压测的 Id 是从2500W 到2600W 之间选择的，下次用同样的 Id 范围做压测的时候，如果接口实现中有缓存，则会很大程度影响压力测试的结果，对压力测试的解读时候，要考虑到这个因素。
另外，使用不存在的 Id 去进行压测，结果并没有太大意义。
七、压力测试报告应该包含哪些结果 接口压力测试结果
服务器压力
每次接口压力测试时，接口所在服务的服务器 cpu/jvm 使用率历史记录，jvm堆大小，响应时长图 （借助 pinpoint 查看），cpu load 值（top 命令），gc 信息等。
八、如何解读压力测试的结果 对于接口压力测试结果：
关注 响应时间是否符合要求，响应时间（前99%） 是不是在可允许的范围内。最大值是多少，是否可以容忍。 通常来说，错误百分比应该为0。
对于服务器压力：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/792442a07a2651c770dec3e0ac2e8235/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-26T15:06:45+08:00" />
<meta property="article:modified_time" content="2024-01-26T15:06:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">接口性能测试，这个还真有用啊。</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4><strong>一、概述</strong></h4> 
<p>性能测试按照不同视角，可以分为以下几类：</p> 
<p>a. 用户视角的性能<br> 用户角度感受到的网站响应速度的快和慢。从用户在浏览器输入网址/打开应用，到整个页面呈现给用户的耗时。包含了用户端发送请求，服务端收到并执行请求，返回请求，客户端收到之后渲染的总时间。</p> 
<p><img alt="" src="https://images2.imgbox.com/81/39/ctcz8RFx_o.png"></p> 
<p>b.开发人员视角的性能</p> 
<p>包括系统吞吐量，并发处理能力，系统稳定性，响应延迟等。如果发现有不满足要求的地方，需要定位出问题所在，并给出解决方案。<br> c.运维<br> 主要关注基础设施性能和资源利用率，如网络运营商带宽能力，服务器应急配置，数据中心网络架构，服务器和网络带宽的资源利用率等。</p> 
<h4 id="%E4%BA%8C%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%81%9A%E6%8E%A5%E5%8F%A3%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95"><strong>二、为什么要做接口压力测试</strong></h4> 
<p>1.清楚自己所提供的接口性能是多少<br> 2.判断出系统可能存在的问题（代码，DB，cache，系统配置,容量等），提前解决<br> 3.为设置接口的限流/熔断做参考</p> 
<h4 id="%E4%B8%89%E3%80%81%E6%8E%A5%E5%8F%A3%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95%E7%9A%84%E5%B1%80%E9%99%90%E6%80%A7"><strong>三、接口压力测试的局限性</strong></h4> 
<p>接口压力测试只注重单业务的接口性能，进行压测的时候，只关注个别接口的性能。<br> 接口大部分时间是在线下进行，可能线上线下机器配置不一样，而且线上同时在进行着各种不同的业务。<br> 因此在线下进行接口压力测试的结果，只能作为线上配置的一个参考值。</p> 
<h4 id="%E5%9B%9B%E3%80%81%E8%B0%81%E6%9D%A5%E5%81%9A%E6%8E%A5%E5%8F%A3%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95"><strong>四、谁来做接口压力测试</strong></h4> 
<p>对接口比较熟悉的开发人员来做，这样有以下好处：<br> 1.对接口实现比较了解，对接口中潜在的问题有一定的预判<br> 2.比较容易对接口进行优化（业务逻辑层面和技术层面）。</p> 
<p> </p> 
<h4 id="%E4%BA%94%E3%80%81%E5%A6%82%E4%BD%95%E5%81%9A%E6%8E%A5%E5%8F%A3%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95"><strong>五、如何做接口压力测试</strong></h4> 
<p>通常使用 Jmeter ，loadRunner 等进行压力测试。</p> 
<h4 id="%E5%85%AD%E3%80%81%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E6%8E%A5%E5%8F%A3%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95%E6%96%B9%E6%A1%88"><strong>六、如何设计接口压力测试方案</strong></h4> 
<p>如何确定并发数：</p> 
<p>可以通过尝试的方式。第一次压测的时候，可以设置自己预期接口需要达到的并发数，进行压力测试。然后通过二分法进行调整。<br> 举例：如果期望的并发数是512 ，第一次压测并发数设置为512 ，如果系统没有压力，第二次并发就尝试设置为1024。如果系统有压力，下次就设置为256。通过逐渐尝试的方式，找出当前接口的并发阈值。</p> 
<p>如何确定总请求次数：<br> 有时候单纯的通过并发数并不能完全发现系统的压力状况，因为并发数只能测出系统的处理能力。<br> 但是有时随着长时间的调用，系统可能会出现其他问题。比如：随着数据量的增多，存储磁盘满了、内存缓存用光，缓存服务使用磁盘缓存而拖慢系统等情况。<br> 为了避免这种情况，可以尝试用现有线上业务每天产生的数量乘以一定的天数（天数的大小视业务的具体情况而定，推荐180天以上），作为接口压力测试的总请求次数。</p> 
<p>接口压力测试数据的选取：<br> 通常随机选择数据。但是要注意重复进行压力测试对性能的影响。<br> 比如：<br> 第一次压测的 Id 是从2500W 到2600W 之间选择的，下次用同样的 Id 范围做压测的时候，如果接口实现中有缓存，则会很大程度影响压力测试的结果，对压力测试的解读时候，要考虑到这个因素。<br> 另外，使用不存在的 Id 去进行压测，结果并没有太大意义。</p> 
<h4 id="%E4%B8%83%E3%80%81%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A%E5%BA%94%E8%AF%A5%E5%8C%85%E5%90%AB%E5%93%AA%E4%BA%9B%E7%BB%93%E6%9E%9C"><strong>七、压力测试报告应该包含哪些结果</strong></h4> 
<p>接口压力测试结果</p> 
<p><img alt="" src="https://images2.imgbox.com/f5/21/46IZeSbp_o.png"></p> 
<p> </p> 
<p>服务器压力</p> 
<p><em id="__mceDel">每次接口压力测试时，接口所在服务的服务器 cpu/jvm 使用率历史记录，jvm堆大小，响应时长图 （借助 pinpoint 查看），cpu load 值（top 命令），gc 信息等。</em></p> 
<p> </p> 
<h4 id="%E5%85%AB%E3%80%81%E5%A6%82%E4%BD%95%E8%A7%A3%E8%AF%BB%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95%E7%9A%84%E7%BB%93%E6%9E%9C"><em><strong>八、如何解读压力测试的结果</strong></em></h4> 
<p>对于接口压力测试结果：</p> 
<p>关注 响应时间是否符合要求，响应时间（前99%） 是不是在可允许的范围内。最大值是多少，是否可以容忍。 通常来说，错误百分比应该为0。</p> 
<p>对于服务器压力：<br> 看 cpu 使用率是否在可接受范围内，jvm 堆大小是否变化频繁，是否有 fullGC。Young GC 耗时，CPU load值是否在可接受范围内。 响应时长图是否平滑（如果有毛刺现象，需要找出原因）。</p> 
<h4 id="%E4%B9%9D%E3%80%81%E5%A6%82%E4%BD%95%E6%A0%B9%E6%8D%AE%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C%E5%AE%9A%E4%BD%8D%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98"><strong>九、如何根据测试结果定位性能问题</strong></h4> 
<p>1.响应时间不符合要求：<br> 通过 pinpoint 观察调用链，找出耗时比较长的步骤，进行优化</p> 
<p>2.并发数达不到要求，可以从以下几个方面进行考虑：<br> a 是否发生系统依赖资源争用（比如：数据库连接，业务处理线程数等）</p> 
<p>b 业务流程/代码性能是否可以优化 c 在运行的过程中是否频繁 GC</p> 
<p>3. CPU 使用率过高：<br> a 在运行的过程中是否频繁 GC</p> 
<p>b是否发生过多的线程切换 c 程序中是否有比较耗 cpu 的代码</p> 
<p>cpu 内存 磁盘 io 网络 io 服务器 top 命令 vmstat pidstat / iostat</p> 
<p>sar jvm java mission Control 工具 jmap 命令,结合eclipse mat 工具进行分析</p> 
<p>全链路：pinpoint</p> 
<h4 id="%E5%8D%81%E3%80%81%E4%BF%AE%E5%A4%8D%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98"><strong>十、修复性能问题</strong></h4> 
<p>除了只可能在极端压力测试情况下会发生的性能问题，并且修复代价过大的问题可以不进行修复（但是要在压力测试报告中体现出来此问题，以及解决方案），其他问题都必须进行修复。</p> 
<h4 id="%E5%8D%81%E4%B8%80%E3%80%81%E5%85%B6%E4%BB%96"><strong>十一、其他</strong></h4> 
<p>如果没有专门的接口压力测试环境，记得做完接口压力测试之后，将测试数据清除(缓存，数据库，消息中间件中未消费完毕的消息 等)。</p> 
<p> </p> 
<p><strong>感谢每一个认真阅读我文章的人，礼尚往来总是要有的，虽然不是什么很值钱的东西，如果你用得到的话可以直接拿走：</strong></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/11/11/yXByov4S_o.png"></p> 
<p>这些资料，对于【<a href="https://so.csdn.net/so/search?q=%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95&amp;spm=1001.2101.3001.7020" title="软件测试">软件测试</a>】的朋友来说应该是最全面最完整的备战仓库，这个仓库也陪伴上万个测试工程师们走过最艰难的路程，希望也能帮助到你!<strong>有需要的小伙伴可以点击下方小卡片领取</strong> </p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/11/f2/5eH7XeSp_o.png"> </p> 
<p style="text-align:center;"> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cba28e114e71b448ee238d270165868b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">2023年衣物清洁赛道行业数据分析（电商数据查询）：总销额同比下滑21%</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f168ac43a8d29478a8e354a68e046640/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">智能AI系统开发，专业软件硬件物联网开发公司，探索未来科技新纪元</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>