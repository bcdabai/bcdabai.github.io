<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>route命令 路由表 Linux Centos - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="route命令 路由表 Linux Centos" />
<meta property="og:description" content="route route命令在Linux中被用于显示和操纵IP路由表。然而，现在大部分Linux发行版都推荐使用ip route命令代替route，因为ip route提供更多的功能和更灵活的控制。
以下是route命令的基本用法：
查看路由表: route -n 这个命令显示当前机器的路由表。-n标志意味着数字形式的网络地址，而不是尝试解析主机名。
添加路由: route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1 dev eth0 这个命令添加一个网络路由，将192.168.1.0/24网络的数据包通过192.168.1.1的网关发送，通过eth0接口。
删除路由: route del -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1 这个命令删除上面添加的路由规则。
注意：route命令修改的路由表在重启后会丢失，如果你想永久添加或删除路由，需要将其添加到网络配置文件或者启动脚本中。
尽管route命令依然可以使用，但现代Linux系统中，大多数情况下都推荐使用ip route命令，因为它提供了更多的功能和更好的控制。
例如，你可以使用ip route show来查看路由表，使用ip route add 192.168.1.0/24 via 192.168.1.1 dev eth0来添加路由，使用ip route del 192.168.1.0/24 via 192.168.1.1来删除路由。
另外，ip route命令还支持更多的选项和参数，如源路由，策略路由等，这使得它比route命令更强大、更灵活。
# 修改路由表信息; metric是优先级; 修改的话必须能匹配到才可以修改 ip route change 172.16.193.0 via 0.0.0.0 metric 300 dev veth01 ​ # 删除路由表 ip route del 172." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/f6d1e82abb80ca19e0089a657cf50200/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-31T20:45:32+08:00" />
<meta property="article:modified_time" content="2023-07-31T20:45:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">route命令 路由表 Linux Centos</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4>route</h4> 
<blockquote> 
 <p><code>route</code>命令在Linux中被用于显示和操纵IP路由表。然而，现在大部分Linux发行版都推荐使用<code>ip route</code>命令代替<code>route</code>，因为<code>ip route</code>提供更多的功能和更灵活的控制。</p> 
 <p>以下是<code>route</code>命令的基本用法：</p> 
 <ol><li> <p><strong>查看路由表</strong>: <code>route -n</code> 这个命令显示当前机器的路由表。<code>-n</code>标志意味着数字形式的网络地址，而不是尝试解析主机名。</p> </li><li> <p><strong>添加路由</strong>: <code>route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1 dev eth0</code> 这个命令添加一个网络路由，将192.168.1.0/24网络的数据包通过192.168.1.1的网关发送，通过<code>eth0</code>接口。</p> </li><li> <p><strong>删除路由</strong>: <code>route del -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1</code> 这个命令删除上面添加的路由规则。</p> </li></ol> 
 <p>注意：<code>route</code>命令修改的路由表在重启后会丢失，如果你想永久添加或删除路由，需要将其添加到网络配置文件或者启动脚本中。</p> 
 <p>尽管<code>route</code>命令依然可以使用，但现代Linux系统中，大多数情况下都推荐使用<code>ip route</code>命令，因为它提供了更多的功能和更好的控制。</p> 
 <p>例如，你可以使用<code>ip route show</code>来查看路由表，使用<code>ip route add 192.168.1.0/24 via 192.168.1.1 dev eth0</code>来添加路由，使用<code>ip route del 192.168.1.0/24 via 192.168.1.1</code>来删除路由。</p> 
 <p>另外，<code>ip route</code>命令还支持更多的选项和参数，如源路由，策略路由等，这使得它比<code>route</code>命令更强大、更灵活。</p> 
</blockquote> 
<pre># 修改路由表信息; metric是优先级; 修改的话必须能匹配到才可以修改
ip route change 172.16.193.0 via 0.0.0.0 metric 300 dev veth01
​
# 删除路由表
ip route del 172.16.193.0 via 0.0.0.0 dev veth01
​
# 添加路由表
ip route add 172.16.193.0/24 via 0.0.0.0 dev veth01</pre> 
<p><strong>路由信息解读</strong></p> 
<p></p> 
<blockquote> 
 <p><strong>route</strong> Kernel IP routing table Destination Gateway Genmask Flags Metric Ref Use Iface default gateway 0.0.0.0 UG 100 0 0 ens33 172.16.193.0 0.0.0.0 255.255.255.0 U 100 0 0 ens33 192.168.122.0 0.0.0.0 255.255.255.0 U 0 0 0 virbr0 [root@centos133 ~]# <strong>ip route show</strong> default via 172.16.193.2 dev ens33 proto static metric 100 172.16.193.0/24 dev ens33 proto kernel scope link src 172.16.193.133 metric 100 192.168.122.0/24 dev virbr0 proto kernel scope link src 192.168.122.1</p> 
</blockquote> 
<ul><li> <p><code>default via 172.16.193.2</code> 指定了默认路由，也就是说，所有不符合下面任何一条路由规则的数据包都将发送到 172.16.193.2 这个地址。</p> </li><li> <p><code>dev ens33</code> 表示数据包将通过 ens33 网络接口发送。</p> </li><li> <p><code>proto dhcp</code> 表示这条路由是由 DHCP 协议添加的。</p> </li><li> <p><code>proto kernel</code>: 表示此条路由条目是内核添加的。</p> </li><li> <p><code>scope link</code>: 这意味着这个网络是直接相连的，我们可以直接通过相应的接口发送数据包，不需要通过其他路由器。</p> </li><li> <p><code>src 172.16.193.133</code> 表示源地址是172.16.193.133。</p> </li><li> <p>`172.16.193.0/24 dev ens33 表示所有目标地址在 172.16.193.0/24 子网中的数据包都将通过 ens33 网络接口发送。</p> </li></ul> 
<p>在分析网络问题时，你可以检查以下几点：</p> 
<ol><li> <p><strong>查看默认路由</strong>：默认路由是当数据包的目标 IP 地址不匹配任何特定路由时，数据包会发送到的地方。确保默认路由的网关是可达的并且正确配置。</p> </li><li> <p><strong>查看特定的路由条目</strong>：如果你在访问某个特定的网络或者主机时遇到问题，你应该查看路由表中相应的条目。如果没有找到相应的条目，你可能需要添加一条新的路由。</p> </li><li> <p><strong>查看网络接口</strong>：确保路由条目指定的网络接口是可用的。你可以使用 <code>ip link show</code> 命令来查看网络接口的状态。</p> </li><li> <p><strong>检查网络连接</strong>：使用 <code>ping</code> 或 <code>traceroute</code> 命令检查网络连接。如果你无法连接到路由的网关，那么你可能需要检查网络连接或者网关的配置。</p> </li><li> <p>你的目标 IP 地址（即虚拟机的 IP 地址）应在路由表的某个网络地址范围内。也就是说，应存在一条路由条目，其网络地址包含了你的目标 IP 地址。</p> </li><li> <p>检查该路由条目是否指向正确的网络接口。如果你在虚拟机上设置了 veth 网络接口，那么路由应该通过这个接口。</p> </li><li> <p>如果虚拟机在网络上使用了 NAT，那么还需要检查宿主机的路由表，看看是否有指向虚拟机 NAT 地址的路由。</p> </li></ol> 
<p></p> 
<p><strong>在 macOS 上，可以使用 <code>netstat -rn</code> 命令查看路由表。</strong></p> 
<p></p> 
<h6>路由表解读</h6> 
<p>以下是一个典型的路由表输出例子：</p> 
<pre>Internet:
Destination        Gateway            Flags        Refs      Use   Netif Expire
default            192.168.1.1        UGSc           76        1     en0
127                127.0.0.1          UCS             0        0     lo0
127.0.0.1          127.0.0.1          UH              5    41894     lo0
169.254            link#4             UCS             0        0     en0
192.168.1          link#4             UCS             3        0     en0
192.168.1.1/32     link#4             UCS             2        0     en0
192.168.1.1        0:1f:c6:4f:31:55   UHLWIir        77      443     en0   1199
192.168.1.3        127.0.0.1          UHS             0        0     lo0
192.168.1.103      127.0.0.1          UHS             0        0     lo0</pre> 
<p>每一行代表一个路由项，具体解释如下：</p> 
<ul><li> <p><strong>Destination</strong>: 数据包的目标网络或主机。</p> </li><li> <p><strong>Gateway</strong>: 数据包将要经过的下一跳路由器的 IP 地址。<code>link#4</code> 或 <code>127.0.0.1</code> 这样的值表示数据包将直接发送到目标，不通过其他路由器。</p> </li><li> <p><strong>Flags</strong>: 路由选项标志。重要的有 <code>U</code> (Up)，表示路由可用，<code>G</code> (Gateway) 表示要经过一个网关（也就是另一个路由器），<code>H</code> (Host) 表示目标是一个主机而不是一个网络，<code>S</code> (Static) 表示这是一个静态路由，手动添加的，不会随着路由协议的变化而变化。</p> </li><li> <p><strong>Refs</strong>: 该路由项被多少个 socket 引用。</p> </li><li> <p><strong>Use</strong>: 该路由项被使用的次数。</p> </li><li> <p><strong>Netif</strong>: 输出接口名称，比如 <code>en0</code> 或 <code>lo0</code>。<code>en0</code> 通常代表以太网接口，<code>lo0</code> 代表本地回环接口。</p> </li><li> <p><strong>Expire</strong>: 路由项过期的时间。这通常在动态路由中使用，表示该路由项在多少秒后过期。</p> </li><li> <p>Link#4类似的含义: <code>link#4</code>表示的是第四个网络接口。这个数字是网络接口在系统中的注册顺序，并不一定代表其名称。例如，en0，en1，en2，lo0等可能对应不同的link#编号。</p> </li><li> <p>四个0（0.0.0.0）在路由表中通常表示默认网关，它用于将所有未明确指向其他路由的流量发送到指定的网络设备。<code>0.0.0.0</code> 通常表示“任何网络地址”或“不确定的网络地址”。Gateway 是 <code>0.0.0.0</code>：这通常表示这是一个直连网络，也就是说，这个路由项是指向一个在同一网络段内的目标，不需要通过网关就可以直接达到。</p> </li><li> <p>Genmask 是 <code>255.255.255.0</code>：这是一个子网掩码，表示该网络的 IP 地址的前 24 位被用于网络地址，后 8 位被用于主机地址。这意味着该网络可以包含的 IP 地址范围是该网络的 <code>x.x.x.0</code> 到 <code>x.x.x.255</code>，其中 <code>x.x.x.0</code> 代表网络地址，<code>x.x.x.255</code> 代表广播地址，其余地址可分配给主机。例如，如果网络地址是 <code>192.168.1.0</code>，那么这个网络的主机地址可以是 <code>192.168.1.1</code> 到 <code>192.168.1.254</code>。</p> </li><li> <p>Genmask 是 <code>0.0.0.0</code>：这通常是一个默认路由，表示任何网络或主机地址都匹配这条路由。通常默认路由的目的地址也是 <code>0.0.0.0</code>，意味着当没有任何其他路由匹配目标IP时，就使用这条默认路由。</p> </li><li> <p><strong>子网掩码，比如/24，它是子网掩码的一种表示方式</strong>，也被称为CIDR（无类别域间路由）标记。/24意味着前24位（也就是前三个字节）用于网络地址，最后的8位（最后一个字节）则用于主机地址。因此，一个/24网络可以容纳256个地址，其中包括网络地址和广播地址，实际可用的主机地址为254个。</p> </li><li> <p><strong>"Bogon"</strong> 是一个网络术语，通常用来描述非法或者未分配的 IP 地址。在 Internet 世界中，有一部分 IP 地址因为特殊的原因被保留，不应该出现在公开的 Internet 路由表中，这些地址被称为 "bogon IP"。</p> <p>当在路由表中看到 gateway 是 "bogon"，这可能意味着这个路由条目的下一跳（gateway）是一个无法在公网中正常路由的 IP 地址。这种情况可能会出现在以下几种场景：</p> 
  <ol><li> <p>这是一个私有网络的环境，比如企业内部网络或者你自己的家庭网络。在这种环境下，你可能会使用到一些在公网中是无效的 IP 地址，比如 10.0.0.0/8，172.16.0.0/12，192.168.0.0/16 等地址段。</p> </li><li> <p>网络配置出现了错误，比如误将一个无效的 IP 地址设置成了 gateway。</p> </li></ol><p>如果你不希望看到 "bogon"，那么你可能需要检查一下你的网络配置，确保你的路由表中所有的 gateway 都是有效的 IP 地址。</p> 
  <ul><li> <p><code>veth10@if10</code>这样的输出表示这是一个veth设备，它的名字是veth10，<code>@if10</code>表示它与另一端的设备（即它的对端设备，pair）相连，那一端的内部接口编号是10。</p> </li><li> <p>default via 172.16.193.2 dev ens33 proto static metric 100 <code>proto static</code>表示这个路由条目是静态配置的。换句话说，这条路由并不是通过动态路由协议（如OSPF，RIP，BGP等）学习得到的，而是人工配置的。一般来说，这些路由在系统启动时就由网络配置脚本配置好，或者由网络管理员手动配置。<code>proto</code>字段表示路由条目的来源协议。<code>ip route show</code>命令可能显示的<code>proto</code>字段的值包括但不限于：</p> 
    <ul><li> <p><code>boot</code>：路由在引导期间设置。</p> </li><li> <p><code>static</code>：路由是静态配置的。</p> </li><li> <p><code>dhcp</code>：路由是通过DHCP协议动态获取的。</p> </li><li> <p><code>ra</code>：路由是通过IPv6的路由通告（Route Advertisement）消息动态获取的</p> </li></ul></li></ul></li></ul> 
<p>为了检查两个设备间的连通性，你需要查看路由表中是否存在一条能够到达目标设备的路由项。这条路由项应当通过正确的网络接口，并指向正确的网关（如果需要）。此外，需要注意路由项的标志是否正确，特别是 <code>U</code> 标志，表示路由是否可用。</p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/15763043f843df3c3501f135e5c2d3d8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">K8S群集调度</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/610f58cdc61bb658543c087e9301c8e6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java web蚁群算法，利用百度地图动态展示路径，界面漂亮</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>