<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>X银行POS终端规范解读 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="X银行POS终端规范解读" />
<meta property="og:description" content="中国X银行间联POS终端规范解读
一、标准POS报文设计思路解读 以下表格为标准POS报文结构，由TPDU&#43;HEAD(报文头)&#43;ISO8583MSG(8583报文数据)构成;其中8583报文体中包括”位元素”，代表后面的数据是哪几个域被用到，这样就最大化的缩小了发送报文的字节数。（详细见附录A）
TPDU
报文头
应用数据
ISO8583Msg
ID
目
的
地
址
源
地
址
应
用
类
别
软
件
版
本
号
终
端
状
态
处
理
要
求
保
留
使
用
交易数据
60H
N2
N2 N2
N2
N1
N1
N6
不定长度
XXX银行对此进行了改造，加入了双倍加密模式,由于3des算法对原文字节长度要求为8的倍数,所以需要加入一个“加密信息”区域了解原始报文长度,从而能在解密后得到原始报文。
二、报文结构解读 2.1X银行pos报文格式 TPDU
报文头
加密信息
应用数据
ISO8583Msg
ID
目
的
地
址
源
地
址
应
用
类
别
软
件
版" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/4dadae3e9164052a8a2dca0b44623802/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-01-26T13:32:01+08:00" />
<meta property="article:modified_time" content="2015-01-26T13:32:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">X银行POS终端规范解读</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p align="center"><strong>中国X银行间联POS终端规范解读</strong></p> 
<div> 
 <p> </p> 
</div> 
<p> </p> 
<h2>一、标准POS报文设计思路解读</h2> 
<p>以下表格为标准POS报文结构，由TPDU+HEAD(报文头)+ISO8583MSG(8583报文数据)构成;其中8583报文体中包括”位元素”，代表后面的数据是哪几个域被用到，这样就最大化的缩小了发送报文的字节数。（详细见<a target="_blank" rel="nofollow">附录A</a>）</p> 
<div align="center"> 
 <table border="1" cellspacing="0" cellpadding="0" width="65%"><tbody><tr><td width="24%" colspan="3" rowspan="2"> <p align="center">TPDU</p> </td><td width="44%" colspan="5" rowspan="2"> <p align="center">报文头</p> </td><td> <p align="center">应用数据</p> </td></tr><tr><td> <p align="center">ISO8583Msg</p> </td></tr><tr><td> <p align="center">ID</p> </td><td> <p align="center">目</p> <p align="center">的</p> <p align="center">地</p> <p align="center">址<strong></strong></p> </td><td> <p>源</p> <p>地</p> <p>址</p> </td><td> <p>应</p> <p>用</p> <p>类</p> <p>别</p> <p> </p> </td><td> <p>软</p> <p>件</p> <p>版</p> <p>本</p> <p>号</p> </td><td> <p>终</p> <p>端</p> <p>状</p> <p>态</p> </td><td> <p>处</p> <p>理</p> <p>要</p> <p>求</p> </td><td> <p>保</p> <p>留</p> <p>使</p> <p>用</p> </td><td> <p>交易数据</p> </td></tr><tr><td> <p>60H</p> </td><td> <p>N2</p> </td><td> <p>N2 </p> </td><td> <p>N2</p> </td><td> <p>N2</p> </td><td> <p>N1</p> </td><td> <p>N1</p> </td><td> <p>N6</p> </td><td> <p>不定长度</p> </td></tr></tbody></table> 
</div> 
<p> </p> 
<p>XXX银行对此进行了改造，加入了双倍加密模式,由于3des算法对原文字节长度要求为8的倍数,所以需要加入一个“加密信息”区域了解原始报文长度,从而能在解密后得到原始报文。</p> 
<h2>二、报文结构解读</h2> 
<h3>2.1X银行pos报文格式</h3> 
<table border="1" cellspacing="0" cellpadding="0" width="100%"><tbody><tr><td width="15%" colspan="3" rowspan="2"> <p align="center">TPDU</p> </td><td width="28%" colspan="5" rowspan="2"> <p align="center">报文头</p> </td><td width="35%" colspan="7" rowspan="2"> <p align="center">加密信息</p> </td><td> <p align="center">应用数据</p> </td></tr><tr><td> <p align="center">ISO8583Msg</p> </td></tr><tr><td> <p align="center">ID</p> </td><td> <p align="center">目</p> <p align="center">的</p> <p align="center">地</p> <p align="center">址<strong></strong></p> </td><td> <p>源</p> <p>地</p> <p>址</p> </td><td> <p>应</p> <p>用</p> <p>类</p> <p>别</p> <p> </p> </td><td> <p>软</p> <p>件</p> <p>版</p> <p>本</p> <p>号</p> </td><td> <p>终</p> <p>端</p> <p>状</p> <p>态</p> </td><td> <p>处</p> <p>理</p> <p>要</p> <p>求</p> </td><td> <p>保</p> <p>留</p> <p>使</p> <p>用</p> </td><td> <p>报文长度</p> </td><td> <p>算法标识</p> </td><td> <p>商户号</p> </td><td> <p>终端号</p> </td><td> <p>交易</p> <p>标识</p> </td><td> <p>响应码</p> </td><td> <p>保留</p> </td><td> <p>交易数据</p> </td></tr><tr><td> <p>60H</p> </td><td> <p>N2</p> </td><td> <p>N2 </p> </td><td> <p>N2</p> </td><td> <p>N2</p> </td><td> <p>N1</p> </td><td> <p>N1</p> </td><td> <p>N6</p> </td><td> <p>A3</p> </td><td> <p>A1</p> </td><td> <p>A15</p> </td><td> <p>A8</p> </td><td> <p>A10</p> </td><td> <p>A2</p> </td><td> <p>A2</p> </td><td> <p> </p> </td></tr></tbody></table> 
<p> </p> 
<p>文档《X银行间联POS终端规范》中对各个字段已有详细描述，简单解释如下：</p> 
<p>整个报文由TUDU+HEAD(报文头)+ISOPASS(加密信息)+ISO8583MSG(8583报文体00-64域)</p> 
<p><span style="color:red">签到</span><span style="color:red">(</span><span style="color:red">明文</span><span style="color:red">)</span><span style="color:red">格式：</span><span style="color:red"> TPDU+HEAD+00-63</span><span style="color:red">域明文</span></p> 
<p><span style="color:red">交易</span><span style="color:red">(</span><span style="color:red">明文</span><span style="color:red">)</span><span style="color:red">格式</span><span style="color:red">: TPDU+HEAD+00-63</span><span style="color:red">域明文</span><span style="color:red">+64</span><span style="color:red">域</span><span style="color:red"> (64</span><span style="color:red">域来源于对</span><span style="color:red">02-63</span><span style="color:red">域的</span><span style="color:red">ECB</span><span style="color:red">加密</span><span style="color:red">)</span>  </p> 
<p>如果想用明文方式发送报文,则需要先按照签到的明文格式进行签到，此时加密信息区域不需要传递,只需在发送交易时对02-63域进行ECB加密;</p> 
<p><span style="color:red">签到</span><span style="color:red">(</span><span style="color:red">密文</span><span style="color:red">)</span><span style="color:red">格式</span><span style="color:red">:TPDU+HEAD+ISOPASS+00-63</span><span style="color:red">域明文</span><span style="color:red">        </span></p> 
<p><span style="color:red">交易</span><span style="color:red">(</span><span style="color:red">密文</span><span style="color:red">)</span><span style="color:red">格式</span><span style="color:red">: TPDU+HEAD+ISOPASS+</span><span style="color:red">全报文加密</span><span style="color:red">(</span><span style="color:red">对</span><span style="color:red">00-64</span><span style="color:red">域进行双倍加密处理后的结果</span><span style="color:red">)</span>  </p> 
<p>如果想用密文方式发送报文,则需要先按照签到的密文格式进行签到，这时要添加加密信息区域（注意报文长度一定是3个字节长度,若报文长度小于100时则第一位补零）,</p> 
<p>全报文加密是先对02-63域进行ECB处理得到64域，然后将00-64域（如果不是8的倍数，则在后面补零）进行双倍（3DES）加密得到整个报文加密后的结果。</p> 
<h3>2.2手工解包文示例</h3> 
<p>  下面以一段预授权返回报文进行解析，由于采用socket方式进行传输消息，故将其字节流转换为16进制可见文进行解析：</p> 
<p>600000000660801001080231303332313035323930303534353130383338303030313638313430313030343232313238303046468e1ac77c445b27a7bc382059ece00931c60534c3cbd03055e980ee1f5ebcf7e344ba3a865e712bd2979ed0387c1d7bf62f8cb5b020a16b667473f5bde85ec080b6237335ee500a993acf095617aa8cb87cd1bfd58ce33b5bbc49f3dec793d1ccc2acddc73442f0aa</p> 
<p>根据8583定义格式，TPDU长度为5个字节，报文头12个字节,用BCD码压缩后为6个字节长度，加密信息41个字节，剩下的就是报文体内容，由于1个字节可用2个16进制字符表示，故而得到以下解析内容</p> 
<p>TPDU: 6000000006 (前十位)</p> 
<p>HEAD: 608010010802  （紧接着12位）</p> 
<p>ISOPASS(加密信息): 3130333231303532393030353435313038333830303031363831343031303034323231323830304646(紧接着82位)</p> 
<p>报文体: 8e1ac77c445b27a7bc382059ece00931c60534c3cbd03055e980ee1f5ebcf7e344ba3a865e712bd2979ed0387c1d7bf62f8cb5b020a16b667473f5bde85ec080b6237335ee500a993acf095617aa8cb87cd1bfd58ce33b5bbc49f3dec793d1ccc2acddc73442f0aa</p> 
<p> </p> 
<p>TPDU和HEAD一般都是固定值，就不再赘述；由于加密信息区域是ASCII值表示的，取出来的值根据ascii表转换得到原始报文内容，得到如下表格：</p> 
<div align="center"> 
 <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td> <p>加密信息列</p> </td><td> <p>类型</p> </td><td> <p>响应值</p> </td><td> <p>转换后报文明文</p> </td><td> <p>含义</p> </td></tr><tr><td> <p>报文长度</p> </td><td> <p>A3</p> </td><td> <p>313033</p> </td><td> <p>103</p> </td><td> <p>整个报文体的原始报文长度为103，即对后面的报文双倍解密后前103个字符即为报文明文；</p> </td></tr><tr><td> <p>算法标识</p> </td><td> <p>A1</p> </td><td> <p>32</p> </td><td> <p>2</p> </td><td> <p>代表加密算法为“3des”</p> </td></tr><tr><td> <p>商户号</p> </td><td> <p>A15</p> </td><td> <p>313035323930303534353130383338</p> </td><td> <p>105290054510838</p> </td><td> <p> </p> </td></tr><tr><td> <p>终端号</p> </td><td> <p>A8</p> </td><td> <p>3030303136383134</p> </td><td> <p>00016814</p> </td><td> <p> </p> </td></tr><tr><td> <p>交易标识</p> </td><td> <p>A10</p> </td><td> <p>30313030343232313238</p> </td><td> <p>0100422128</p> </td><td> <p>0100为预授权，422128为发送过去的流水号（应与11域相同）</p> </td></tr><tr><td> <p>响应码</p> </td><td> <p>A2</p> </td><td> <p>3030</p> </td><td> <p>00</p> </td><td> <p>对方解密成功</p> </td></tr><tr><td> <p>保留</p> </td><td> <p>A2</p> </td><td> <p>4646</p> </td><td> <p>FF</p> </td><td> <p> </p> </td></tr></tbody></table> 
</div> 
<p> </p> 
<p>首先对报文体进行3des解密(密钥=2afdbf46292a299e97da318f9d76e3ab)解密后结果为0110703800800ad0800316436745007172945903000000000000000142212809020901210635303231303939313830393039363030303136383134313035323930303534353130383338153031303530303030202020303030313135360000433342393531433200</p> 
<p>剩下的就是按照文档标准对各个域进行解析；</p> 
<p>消息类型：0110</p> 
<p>位元素：703800800ad08003 （64位=8个字节=16个16进制字符）</p> 
<p>转换为二进制后：1110000001110000000000010000000000010101101000010000000000000110，一共64位，第一位1代表域2有值，第二位为1代表域3有值,依次类推;</p> 
<p> </p> 
<div align="center"> 
 <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td> <p>字段名称</p> </td><td> <p align="center">属性</p> </td><td> <p align="center">格式</p> </td><td> <p align="center">类型</p> </td><td> <p>响应值</p> </td><td> <p>解析后明文</p> </td><td> <p>含义</p> </td></tr><tr><td> <p>域2</p> </td><td> <p align="center">n..19</p> </td><td> <p align="center">LLVAR</p> </td><td> <p align="center">BCD</p> </td><td> <p>164367450071729459</p> </td><td> <p>4367450071729459</p> </td><td> <p>域2为变长的字符类型,前两个字符16代表该字段的长度,故截取后16位长度字符即为该字段的值；</p> </td></tr><tr><td> <p>域3</p> </td><td> <p align="center">n6</p> </td><td> <p align="center"> </p> </td><td> <p align="center">BCD</p> </td><td> <p>030000</p> </td><td> <p>030000</p> </td><td> <p> </p> </td></tr><tr><td> <p>域4</p> </td><td> <p align="center">n12</p> </td><td> <p align="center"> </p> </td><td> <p align="center">BCD</p> </td><td> <p>000000000001</p> </td><td> <p>000000000001</p> </td><td> <p> </p> </td></tr><tr><td> <p>域11</p> </td><td> <p align="center">n6</p> </td><td> <p align="center"> </p> </td><td> <p align="center">BCD</p> </td><td> <p>422128</p> </td><td> <p>422128</p> </td><td> <p> </p> </td></tr><tr><td> <p>域12</p> </td><td> <p align="center">n6</p> </td><td> <p align="center">hhmmss</p> </td><td> <p align="center">BCD</p> </td><td> <p>90209</p> </td><td> <p>090209</p> </td><td> <p> </p> </td></tr><tr><td> <p>域13</p> </td><td> <p align="center">n4</p> </td><td> <p align="center">MMDD</p> </td><td> <p align="center">BCD</p> </td><td> <p>0121</p> </td><td> <p>0121</p> </td><td> <p> </p> </td></tr><tr><td> <p>域25</p> </td><td> <p align="center">n2</p> </td><td> <p align="center"> </p> </td><td> <p align="center">BCD</p> </td><td> <p>06</p> </td><td> <p>06</p> </td><td> <p> </p> </td></tr><tr><td> <p>域37</p> </td><td> <p align="center">an12</p> </td><td> <p align="center"> </p> </td><td> <p align="center">ASCII</p> </td><td> <p>353032313039393138303930</p> </td><td> <p>502109918090</p> </td><td> <p>定长12个字节,ASCII形式标示</p> </td></tr><tr><td> <p>域39</p> </td><td> <p align="center">an2</p> </td><td> <p align="center"> </p> </td><td> <p align="center">ASCII</p> </td><td> <p>3936</p> </td><td> <p>96</p> </td><td> <p> </p> </td></tr><tr><td> <p>域41</p> </td><td> <p align="center">ans8</p> </td><td> <p align="center"> </p> </td><td> <p align="center">ASCII</p> </td><td> <p>3030303136383134</p> </td><td> <p>00016814</p> </td><td> <p> </p> </td></tr><tr><td> <p>域42</p> </td><td> <p align="center">ans15</p> </td><td> <p align="center"> </p> </td><td> <p align="center">ASCII</p> </td><td> <p>313035323930303534353130383338</p> </td><td> <p>105290054510838</p> </td><td> <p> </p> </td></tr><tr><td> <p>域44</p> </td><td> <p align="center">ans..25</p> </td><td> <p align="center">LLVAR</p> </td><td> <p align="center">ASCII</p> </td><td> <p>15303130353030303020202030303031</p> </td><td> <p>0105000   0001</p> </td><td> <p>变长ASCII形式,前两个数字代表长度</p> </td></tr><tr><td> <p>域49</p> </td><td> <p align="center">an3</p> </td><td> <p align="center"> </p> </td><td> <p align="center">ASCII</p> </td><td> <p>313536</p> </td><td> <p>156</p> </td><td> <p> </p> </td></tr><tr><td> <p>域63</p> </td><td> <p align="center">ans…96</p> </td><td> <p align="center"> </p> </td><td> <p align="center">ASCII</p> </td><td> <p>0000</p> </td><td> <p>0</p> </td><td> <p>长度为0，63域返回值为空</p> </td></tr><tr><td> <p>域64</p> </td><td> <p align="center">b64</p> </td><td> <p align="center"> </p> </td><td> <p align="center">BINARY</p> </td><td> <p>4333423935314332</p> </td><td> <p>C3B951C2</p> </td><td> <p>Mac校验值</p> </td></tr></tbody></table> 
</div> 
<p> </p> 
<p>关于pos终端的数据类型解释，请参考<a target="_blank" rel="nofollow">附录B</a></p> 
<h2>三、名词解释</h2> 
<h3>3.1 BCD码</h3> 
<p><strong>BCD码是</strong>用4位二进制码的组合代表十进制数的0,1,2,3,4,5,6,7,8,9 十个数符。</p> 
<p>对应关系如下图表格所示:</p> 
<div align="center"> 
 <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td> <p>十进制数</p> </td><td> <p>BCD码(8421)</p> </td></tr><tr><td> <p>0</p> </td><td> <p>0000</p> </td></tr><tr><td> <p>1</p> </td><td> <p>0001</p> </td></tr><tr><td> <p>2</p> </td><td> <p>0010</p> </td></tr><tr><td> <p>3</p> </td><td> <p>0011</p> </td></tr><tr><td> <p>4</p> </td><td> <p>0100</p> </td></tr><tr><td> <p>5</p> </td><td> <p>0101</p> </td></tr><tr><td> <p>6</p> </td><td> <p>0110</p> </td></tr><tr><td> <p>7</p> </td><td> <p>0111</p> </td></tr><tr><td> <p>8</p> </td><td> <p>1000</p> </td></tr><tr><td> <p>9</p> </td><td> <p>1001</p> </td></tr></tbody></table> 
</div> 
<p>示例: 对原文“113802”进行BCD转换</p> 
<p> </p> 
<div align="center"> 
 <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td> <p align="center">原文</p> </td><td> <p align="center">1</p> </td><td> <p align="center">1</p> </td><td> <p align="center">3</p> </td><td> <p align="center">8</p> </td><td> <p align="center">0</p> </td><td> <p align="center">2</p> </td><td> <p>原文六个字节</p> </td></tr><tr><td> <p align="center">二进制</p> </td><td> <p align="center">0000 0001</p> </td><td> <p align="center">0000 0001</p> </td><td> <p align="center">0000 0011</p> </td><td> <p align="center">0000 1000</p> </td><td> <p align="center">0000 0000</p> </td><td> <p align="center">0000 0010</p> </td><td> <p> </p> </td></tr><tr><td> <p align="center">BCD码(8421)</p> </td><td> <p align="center">0001</p> </td><td> <p>0001</p> </td><td> <p align="center">          0011</p> </td><td> <p align="center">          1000</p> </td><td> <p align="center">          0000</p> </td><td> <p align="center">          0010</p> </td><td> <p align="center"> </p> </td></tr><tr><td> <p align="center">十进制</p> </td><td width="179" colspan="2"> <p>17</p> </td><td width="170" colspan="2"> <p align="center">     56</p> </td><td width="161" colspan="2"> <p align="center">2</p> </td><td> <p align="center">转换为BCD码后变成三个字节</p> </td></tr><tr><td> <p align="center">十六进制</p> </td><td width="179" colspan="2"> <p align="center">      11</p> </td><td width="170" colspan="2"> <p align="center">      38</p> </td><td width="161" colspan="2"> <p align="center">02</p> </td><td> <p align="center"> </p> </td></tr></tbody></table> 
</div> 
<p> </p> 
<p>将字符串转换为BCD字节数组方法：</p> 
<p><strong><span style="color:#7F0055">public</span> <span style="color:#7F0055"> static</span> <span style="color:#7F0055">byte</span></strong>[]toBcd(String value) {<!-- --></p> 
<p>      <strong><span style="color:#7F0055">int</span></strong> charpos =0;</p> 
<p>      <strong><span style="color:#7F0055">int</span></strong> bufpos =0;</p> 
<p>      <strong><span style="color:#7F0055">byte</span></strong>[] buf = <strong> <span style="color:#7F0055">null</span></strong>;</p> 
<p>      <strong><span style="color:#7F0055">int</span></strong> len =value.length() / 2;</p> 
<p>      <strong><span style="color:#7F0055">if</span></strong> (value.length()% 2 == 0) {<!-- --></p> 
<p>         buf = <strong><span style="color:#7F0055">new</span> <span style="color:#7F0055"> byte</span></strong>[len];</p> 
<p>      }</p> 
<p>      <strong><span style="color:#7F0055">if</span></strong>(value.length() % 2 == 1) {<!-- --></p> 
<p>         buf = <strong><span style="color:#7F0055">new</span> <span style="color:#7F0055"> byte</span></strong>[len + 1];</p> 
<p>         buf[0] = ((<strong><span style="color:#7F0055">byte</span></strong>)(value.charAt(0) -<span style="color:#2A00FF">'0'</span>));</p> 
<p>         charpos = 1;</p> 
<p>         bufpos = 1;</p> 
<p>      }</p> 
<p>      <strong><span style="color:#7F0055">while</span></strong> (charpos&lt; value.length()) {<!-- --></p> 
<p>         buf[bufpos] = ((<strong><span style="color:#7F0055">byte</span></strong>)(value.charAt(charpos) -<span style="color:#2A00FF">'0'</span> &lt;&lt; 4 | value</p> 
<p>                .charAt(charpos + 1) - <span style="color:#2A00FF">'0'</span>));</p> 
<p>         charpos += 2;</p> 
<p>         bufpos++;</p> 
<p> </p> 
<p>      }</p> 
<p>      <strong><span style="color:#7F0055">return</span></strong> buf;</p> 
<p>   }</p> 
<h3>3.2单倍长密钥算法、双倍长密钥算法和ECB算法</h3> 
<p><strong>单倍长密钥算法 和双倍长密钥算法</strong>分别对应java里的des和3des加密算法；</p> 
<p>DES加密算法</p> 
<p><strong><span style="color:#7F0055">public</span> <span style="color:#7F0055"> static</span> <span style="color:#7F0055">byte</span></strong>[] des(<strong><span style="color:#7F0055">byte</span></strong>[]reqBytes,<strong><span style="color:#7F0055">byte</span></strong>[] key)</p> 
<p>         <strong><span style="color:#7F0055">throws</span></strong>InvalidKeyException, NoSuchAlgorithmException,</p> 
<p>         NoSuchPaddingException,IllegalBlockSizeException,</p> 
<p>         BadPaddingException,UnsupportedEncodingException,</p> 
<p>         ShortBufferException {<!-- --></p> 
<p>      SecretKeySpec keySpec = <strong><span style="color:#7F0055">null</span></strong>;</p> 
<p>      DESKeySpec deskey = <strong><span style="color:#7F0055">null</span></strong>;</p> 
<p>      deskey = <strong><span style="color:#7F0055">new</span></strong>DESKeySpec(key);</p> 
<p>      keySpec = <strong><span style="color:#7F0055">new</span></strong>SecretKeySpec(deskey.getKey(),<span style="color:#2A00FF">"DES"</span>);</p> 
<p>      Cipher cipher = Cipher.<em>getInstance</em>(<span style="color:#2A00FF">"DES/ECB/NoPadding"</span>);</p> 
<p>      cipher.init(Cipher.<em><span style="color:#0000C0">ENCRYPT_MODE</span></em>,keySpec);</p> 
<p>      <strong><span style="color:#7F0055">byte</span></strong>[]cipherText = <strong> <span style="color:#7F0055">new</span> <span style="color:#7F0055">byte</span></strong>[cipher.getOutputSize(reqBytes.<span style="color:#0000C0">length</span>)];</p> 
<p>      cipherText = cipher.doFinal(reqBytes);</p> 
<p>      <strong><span style="color:#7F0055">return</span></strong>cipherText;</p> 
<p>   }</p> 
<p>DES解密算法</p> 
<p><strong><span style="color:#7F0055">public</span> <span style="color:#7F0055"> static</span> <span style="color:#7F0055">byte</span></strong>[]decryptByDes(<strong><span style="color:#7F0055">byte</span></strong>[] reqBytes,<strong><span style="color:#7F0055">byte</span></strong>[] key)</p> 
<p>         <strong><span style="color:#7F0055">throws</span></strong>InvalidKeyException, NoSuchAlgorithmException,</p> 
<p>         NoSuchPaddingException,IllegalBlockSizeException,</p> 
<p>         BadPaddingException,UnsupportedEncodingException,</p> 
<p>         ShortBufferException {<!-- --></p> 
<p>      SecretKeySpec keySpec = <strong><span style="color:#7F0055">null</span></strong>;</p> 
<p>      DESKeySpec deskey = <strong><span style="color:#7F0055">null</span></strong>;</p> 
<p>      deskey = <strong><span style="color:#7F0055">new</span></strong>DESKeySpec(key);</p> 
<p>      keySpec = <strong><span style="color:#7F0055">new</span></strong>SecretKeySpec(deskey.getKey(),<span style="color:#2A00FF">"DES"</span>);</p> 
<p> </p> 
<p>      Cipher cipher = Cipher.<em>getInstance</em>(<span style="color:#2A00FF">"DES/ECB/NoPadding"</span>);</p> 
<p>      cipher.init(Cipher.<em><span style="color:#0000C0">DECRYPT_MODE</span></em>,keySpec);</p> 
<p> </p> 
<p>      <strong><span style="color:#7F0055">byte</span></strong>[]cipherText = <strong> <span style="color:#7F0055">new</span> <span style="color:#7F0055">byte</span></strong>[cipher.getOutputSize(reqBytes.<span style="color:#0000C0">length</span>)];</p> 
<p>      cipherText = cipher.doFinal(reqBytes);</p> 
<p>      <strong><span style="color:#7F0055">return</span></strong>cipherText;</p> 
<p>   }</p> 
<p>3des加密算法：</p> 
<p><strong><span style="color:#7F0055">private</span> <span style="color:#7F0055"> static</span> <span style="color:#7F0055">final</span></strong> String <em><span style="color:#0000C0">DESede_ALG</span></em> =<span style="color:#2A00FF">"DESede/ECB/NOPADDING"</span>; <span style="color:#3F7F5F">// </span><span style="color:#3F7F5F">定义加密算法</span><span style="color:#3F7F5F">,</span><span style="color:#3F7F5F">可用</span><span style="color:#3F7F5F">DES,DESede,Blowfish</span></p> 
<p><span style="color:#3F5FBF">/**</span></p> 
<p><span style="color:#3F5FBF">    * 3DES</span><span style="color:#3F5FBF">加密</span></p> 
<p><span style="color:#3F5FBF">    * </span></p> 
<p><span style="color:#3F5FBF">    * </span><strong><span style="color:#7F9FBF">@param</span></strong><span style="color:#3F5FBF"> src</span></p> 
<p><span style="color:#3F5FBF">    * </span><strong><span style="color:#7F9FBF">@param</span></strong><span style="color:#3F5FBF"> key</span></p> 
<p><span style="color:#3F5FBF">    * </span><strong><span style="color:#7F9FBF">@return</span></strong></p> 
<p><span style="color:#3F5FBF">    */</span></p> 
<p>   <strong><span style="color:#7F0055">public</span> <span style="color:#7F0055"> static</span> <span style="color:#7F0055">byte</span></strong>[]encryptDESede(<strong><span style="color:#7F0055">byte</span></strong>[] src,<strong><span style="color:#7F0055">byte</span></strong>[] key) {<!-- --></p> 
<p>      Security.<em>addProvider</em>(<strong><span style="color:#7F0055">new</span></strong> org.bouncycastle.jce.provider.BouncyCastleProvider());</p> 
<p>      <strong><span style="color:#7F0055">try</span></strong> {<!-- --></p> 
<p>         Cipher c1 = Cipher.<em>getInstance</em>(<em><span style="color:#0000C0">DESede_ALG</span></em>,<span style="color:#2A00FF">"BC"</span>);</p> 
<p>         c1.init(Cipher.<em><span style="color:#0000C0">ENCRYPT_MODE</span></em>,<strong><span style="color:#7F0055">new</span></strong>SecretKeySpec(key, <em><span style="color:#0000C0">DESede_ALG</span></em>));</p> 
<p>         <strong><span style="color:#7F0055">return</span></strong>c1.doFinal(src);</p> 
<p>      } <strong><span style="color:#7F0055">catch</span></strong>(Exception e) {<!-- --></p> 
<p>         <em><span style="color:#0000C0">logger</span></em>.info(<span style="color:#2A00FF">"[3DES]</span><span style="color:#2A00FF">双倍加密异常！</span><span style="color:#2A00FF">Exception=["</span> +e.getMessage() +<span style="color:#2A00FF">"]"</span>);</p> 
<p>         e.printStackTrace();</p> 
<p>      }</p> 
<p>      <strong><span style="color:#7F0055">return</span> <span style="color:#7F0055"> null</span></strong>;</p> 
<p>   }</p> 
<p> </p> 
<p>3des解密算法：</p> 
<p> </p> 
<p><span style="color:#3F5FBF">/**</span></p> 
<p><span style="color:#3F5FBF">    * 3DES</span><span style="color:#3F5FBF">解密</span></p> 
<p><span style="color:#3F5FBF">    * </span></p> 
<p><span style="color:#3F5FBF">    * </span><strong><span style="color:#7F9FBF">@param</span></strong><span style="color:#3F5FBF"> src</span></p> 
<p><span style="color:#3F5FBF">    * </span><strong><span style="color:#7F9FBF">@param</span></strong><span style="color:#3F5FBF"> key</span></p> 
<p><span style="color:#3F5FBF">    * </span><strong><span style="color:#7F9FBF">@return</span></strong></p> 
<p><span style="color:#3F5FBF">    */</span></p> 
<p>   <strong><span style="color:#7F0055">public</span> <span style="color:#7F0055"> static</span> <span style="color:#7F0055">byte</span></strong>[]decryptDESede(<strong><span style="color:#7F0055">byte</span></strong>[] src,<strong><span style="color:#7F0055">byte</span></strong>[] key) {<!-- --></p> 
<p>      Security.<em>addProvider</em>(<strong><span style="color:#7F0055">new</span></strong>org.bouncycastle.jce.provider.BouncyCastleProvider());</p> 
<p>      <strong><span style="color:#7F0055">try</span></strong> {<!-- --></p> 
<p>         Cipher c1 = Cipher.<em>getInstance</em>(<em><span style="color:#0000C0">DESede_ALG</span></em>,<span style="color:#2A00FF">"BC"</span>);</p> 
<p>         c1.init(Cipher.<em><span style="color:#0000C0">DECRYPT_MODE</span></em>,<strong><span style="color:#7F0055">new</span></strong>SecretKeySpec(key, <em><span style="color:#0000C0">DESede_ALG</span></em>));</p> 
<p>         <strong><span style="color:#7F0055">return</span></strong>c1.doFinal(src);</p> 
<p>      } <strong><span style="color:#7F0055">catch</span></strong>(Exception e) {<!-- --></p> 
<p>         <em><span style="color:#0000C0">logger</span></em>.info(<span style="color:#2A00FF">"[3DES]</span><span style="color:#2A00FF">双倍解密异常！</span><span style="color:#2A00FF">Exception=["</span> +e.getMessage() +<span style="color:#2A00FF">"]"</span>);</p> 
<p>         e.printStackTrace();</p> 
<p>      }</p> 
<p>      <strong><span style="color:#7F0055">return</span> <span style="color:#7F0055"> null</span></strong>;</p> 
<p>   }</p> 
<p> </p> 
<p><strong>ECB加密算法：</strong></p> 
<p> </p> 
<p><span style="color:#3F5FBF">/**</span></p> 
<p><span style="color:#3F5FBF">    * </span><span style="color:#3F5FBF">建行</span><u><span style="color:#3F5FBF">Mac</span></u><span style="color:#3F5FBF">加密</span></p> 
<p><span style="color:#3F5FBF">    * </span><strong><span style="color:#7F9FBF">@param</span></strong><span style="color:#3F5FBF"> msg</span></p> 
<p><span style="color:#3F5FBF">    * </span><strong><span style="color:#7F9FBF">@param</span></strong><span style="color:#3F5FBF"> key</span></p> 
<p><span style="color:#3F5FBF">    * </span><strong><span style="color:#7F9FBF">@return</span></strong></p> 
<p><span style="color:#3F5FBF">    */</span> </p> 
<p>   <strong><span style="color:#7F0055">public</span> <span style="color:#7F0055"> static</span></strong> StringccbEncrypt(<strong><span style="color:#7F0055">byte</span></strong>[] macBytes,String key){    </p> 
<p>      <strong><span style="color:#7F0055">byte</span></strong>[]resultEncrypt=<strong><span style="color:#7F0055">null</span></strong>;</p> 
<p>      <span style="color:#3F7F5F">//</span><span style="color:#3F7F5F">签名字符串</span></p> 
<p>      <strong><span style="color:#7F0055">byte</span></strong>[]tmpBytes = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};</p> 
<p>      <span style="color:#3F7F5F">//macBytes</span><span style="color:#3F7F5F">为</span><span style="color:#3F7F5F"> MAC</span><span style="color:#3F7F5F">原始字符串</span></p> 
<p>      <strong><span style="color:#7F0055">int</span></strong> times =macBytes.<span style="color:#0000C0">length</span>/8;</p> 
<p>      <strong><span style="color:#7F0055">if</span></strong>(macBytes.<span style="color:#0000C0">length</span> % 8 != 0) {<!-- --></p> 
<p>         times ++;</p> 
<p>      }</p> 
<p>      <strong><span style="color:#7F0055">for</span></strong> (<strong><span style="color:#7F0055">int</span></strong> t = 0; t&lt;= times; t++) {<!-- --></p> 
<p>         <strong><span style="color:#7F0055">for</span></strong> (<strong><span style="color:#7F0055">int</span></strong> i = 0; i&lt; 8; i++) {<!-- --></p> 
<p>            <strong><span style="color:#7F0055">if</span></strong> ((t*8 +i) &lt; macBytes.<span style="color:#0000C0">length</span>) {<!-- --></p> 
<p>                tmpBytes[i] = (<strong><span style="color:#7F0055">byte</span></strong>)(tmpBytes[i]^ macBytes[t*8 + i]);</p> 
<p>            }</p> 
<p>         }</p> 
<p>      }</p> 
<p>      System.<em><span style="color:#0000C0">out</span></em>.println(<span style="color:#2A00FF">"b)MAC</span><span style="color:#2A00FF">字符串</span><span style="color:#2A00FF">=["</span> +<em>byte2hex</em>(macBytes)+ <span style="color:#2A00FF">"]</span><span style="color:#2A00FF">，异或后</span><span style="color:#2A00FF">["</span> + <em>byte2hex</em>(tmpBytes)+ <span style="color:#2A00FF">"]"</span>);</p> 
<p>      <span style="color:#3F7F5F">//</span><span style="color:#3F7F5F">前四个字节</span></p> 
<p>      <strong><span style="color:#7F0055">byte</span></strong>[] frontBytes= <strong> <span style="color:#7F0055">new</span> <span style="color:#7F0055">byte</span></strong>[4];</p> 
<p>      <span style="color:#3F7F5F">//</span><span style="color:#3F7F5F">后四个字节</span></p> 
<p>      <strong><span style="color:#7F0055">byte</span></strong>[]backBytes = <strong> <span style="color:#7F0055">new</span> <span style="color:#7F0055">byte</span></strong>[4];</p> 
<p>      System.<em>arraycopy</em>(tmpBytes, 0,frontBytes, 0, 4);</p> 
<p>      System.<em>arraycopy</em>(tmpBytes, 4,backBytes, 0, 4);</p> 
<p>      <strong><span style="color:#7F0055">try</span></strong> {<!-- --></p> 
<p>         <strong><span style="color:#7F0055">byte</span></strong>[]frontEncrypt =<em>des</em>(<em>byte2hex</em>(frontBytes).getBytes(), <em>hex2byte</em>(key));</p> 
<p>         System.<em><span style="color:#0000C0">out</span></em>.println(<span style="color:#2A00FF">"c,d)</span><span style="color:#2A00FF">前半段加密后结果</span><span style="color:#2A00FF">=["</span> +<em>byte2hex</em>(frontEncrypt)+ <span style="color:#2A00FF">"]"</span>);</p> 
<p>         <strong><span style="color:#7F0055">byte</span></strong>[] tmp = <em> byte2hex</em>(backBytes).getBytes();</p> 
<p>         <strong><span style="color:#7F0055">for</span></strong> (<strong><span style="color:#7F0055">int</span></strong> i = 0; i&lt; 8; i++) {<!-- --></p> 
<p>            tmp[i] = (<strong><span style="color:#7F0055">byte</span></strong>)(frontEncrypt[i]^ tmp[i]);</p> 
<p>         }     </p> 
<p>         System.<em><span style="color:#0000C0">out</span></em>.println(<span style="color:#2A00FF">"e)</span><span style="color:#2A00FF">异或后结果</span><span style="color:#2A00FF">=["</span> +<em>byte2hex</em>(tmp)+ <span style="color:#2A00FF">"]"</span>);</p> 
<p>         resultEncrypt = <em>des</em>(tmp, <em>hex2byte</em>(key));</p> 
<p>         System.<em><span style="color:#0000C0">out</span></em>.println(<span style="color:#2A00FF">"f)</span><span style="color:#2A00FF">加密结果</span><span style="color:#2A00FF">=["</span> +<em>byte2hex</em>(resultEncrypt)+ <span style="color:#2A00FF">"]"</span>);</p> 
<p>      } <strong><span style="color:#7F0055">catch</span></strong>(Exception e) {<!-- --></p> 
<p>         <span style="color:#3F7F5F">// </span><strong><span style="color:#7F9FBF">TODO</span></strong><span style="color:#3F7F5F">Auto-generated catch block</span></p> 
<p>         e.printStackTrace();</p> 
<p>      }</p> 
<p>      <strong><span style="color:#7F0055">byte</span></strong>[]macResult=<strong><span style="color:#7F0055">new</span><span style="color:#7F0055">byte</span></strong>[4];</p> 
<p>      System.<em>arraycopy</em>(resultEncrypt, 0,macResult, 0, 4);</p> 
<p>      System.<em><span style="color:#0000C0">out</span></em>.println(<span style="color:#2A00FF">"g,h)ECB</span><span style="color:#2A00FF">加密最终返回结果</span><span style="color:#2A00FF">=["</span> +<em>byte2hex</em>(macResult)+ <span style="color:#2A00FF">"]"</span>);</p> 
<p>      <strong><span style="color:#7F0055">return</span></strong> <em>byte2hex</em>(macResult);</p> 
<p>   }</p> 
<p> </p> 
<p> </p> 
<p><span style="color:#3F5FBF">/**</span></p> 
<p><span style="color:#3F5FBF">     * byte array to hex</span></p> 
<p><span style="color:#3F5FBF">     *</span></p> 
<p><span style="color:#3F5FBF">     * </span><strong><span style="color:#7F9FBF">@param</span></strong><span style="color:#3F5FBF"> b bytearray</span></p> 
<p><span style="color:#3F5FBF">     * </span><strong><span style="color:#7F9FBF">@return</span></strong><span style="color:#3F5FBF"> hexstring</span></p> 
<p><span style="color:#3F5FBF">     * </span><span style="color:#3F5FBF">字节数组转为</span><span style="color:#3F5FBF">16</span><span style="color:#3F5FBF">进制码</span></p> 
<p><span style="color:#3F5FBF">     */</span></p> 
<p>    <strong><span style="color:#7F0055">public</span> <span style="color:#7F0055"> static</span></strong> String <span style="background:yellow">byte2hex</span>(<strong><span style="color:#7F0055">byte</span></strong>[] b) {<!-- --></p> 
<p>        StringBuffer hs = <strong><span style="color:#7F0055">new</span></strong>StringBuffer();</p> 
<p>        String stmp;</p> 
<p>        <strong><span style="color:#7F0055">for</span></strong> (<strong><span style="color:#7F0055">int</span></strong> i = 0; i&lt; b.<span style="color:#0000C0">length</span>; i++) {<!-- --></p> 
<p>            stmp = Integer.<em>toHexString</em>(b[i]&amp; 0xFF).toUpperCase();</p> 
<p>            <strong><span style="color:#7F0055">if</span></strong> (stmp.length()== 1) {<!-- --></p> 
<p>                hs.append(<span style="color:#2A00FF">"0"</span>).append(stmp);</p> 
<p>            } <strong><span style="color:#7F0055">else</span></strong> {<!-- --></p> 
<p>                hs.append(stmp);</p> 
<p>            }</p> 
<p>        }</p> 
<p>        <strong><span style="color:#7F0055">return</span></strong>hs.toString();</p> 
<p>    }</p> 
<h2>四、附录</h2> 
<h3><a target="_blank" name="_%E9%99%84%E5%BD%95A:"></a><a target="_blank" name="_%E9%99%84%E5%BD%95B:"></a><a target="_blank" name="_%E9%99%84%E5%BD%95A:Socket%E6%8A%A5%E6%96%87%E8%AE%BE%E8%AE%A1"></a>附录A:Socket报文设计</h3> 
<p>假设甲乙双方要通过Socket发送通信,双方约定了发送和接受的报文字段数不超过64,那么怎么设计才能达到所发送的报文长度最小的目的呢？</p> 
<div align="center"> 
 <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td> <p>字段名称</p> </td><td> <p>类型</p> </td><td> <p>长度</p> </td><td> <p>备注</p> </td></tr><tr><td> <p>域1</p> </td><td> <p>变长字符</p> </td><td> <p>20</p> </td><td> <p> </p> </td></tr><tr><td> <p>域2</p> </td><td> <p>定长字符</p> </td><td> <p>20</p> </td><td> <p> </p> </td></tr><tr><td> <p>….</p> </td><td> <p>…</p> </td><td> <p> </p> </td><td> <p> </p> </td></tr><tr><td> <p>域64</p> </td><td> <p>数字</p> </td><td> <p> </p> </td><td> <p> </p> </td></tr></tbody></table> 
</div> 
<p>假设有一封报文需要发送</p> 
<div align="center"> 
 <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td> <p>字段名称</p> </td><td> <p>类型</p> </td><td> <p>长度</p> </td><td> <p>值</p> </td></tr><tr><td> <p>域1</p> </td><td> <p>变长字符</p> </td><td> <p>20</p> </td><td> <p>123456</p> </td></tr><tr><td> <p>域2</p> </td><td> <p>定长字符</p> </td><td> <p>20</p> </td><td> <p>ABCDEF</p> </td></tr><tr><td> <p>..</p> </td><td> <p>…</p> </td><td> <p> </p> </td><td> <p> </p> </td></tr><tr><td> <p>域64</p> </td><td> <p>数字</p> </td><td> <p> </p> </td><td> <p>369</p> </td></tr></tbody></table> 
</div> 
<p> </p> 
<p>方案一：不管某个字段是否有值，一律按照最大长度将其封装后发送,如果无值默认补空格或零,这样双方就能按照字段规定的长度来解析了。</p> 
<p> 发送报文的值=123456ABCDEF……369;(省略号为补足空格)</p> 
<p>方案二：如果字段需要发送才做报文封装，否则舍弃，在整个报文前端加上哪些字段被发送的标识，这样双方也能先通过解析域值封装信息来解析后面的报文。</p> 
<p> 发送报文的值=c000000000000001123456ABCDE369;(前面16个字符转成二进制之后就能看到哪几个域被用到)</p> 
<p> c000000000000001 –&gt;1100000000000000000000000000000000000000000000000000000000000001</p> 
<p>由于要发送的字段数目不会超过64,所以只需要添加固定长度为8个字节(64位)来表示报文体中哪几个域被用到,改区域被称作”位元素”;</p> 
<p> </p> 
<p>由上所述，方案一的报文长度为最大值，方案二的报文长度最简短，故方案二为最佳模式。</p> 
<h3><a target="_blank" name="_%E9%99%84%E5%BD%95B:Pos%E7%BB%88%E7%AB%AF%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"></a>附录B:Pos终端数据类型</h3> 
<div align="center"> 
 <table border="1" cellspacing="0" cellpadding="0"><tbody><tr><td> <p>类型名称</p> </td><td> <p>备注</p> </td><td> <p>实例说明</p> </td></tr><tr><td> <p>A</p> </td><td> <p>字母向左靠，右部多余部分填空格。</p> </td><td> <p> </p> </td></tr><tr><td> <p>AN</p> </td><td> <p>字母和/或数字，左靠，右部多余部分填空格。</p> <p> </p> </td><td> <p> </p> </td></tr><tr><td> <p>ANS </p> <p> </p> </td><td> <p>字母和/或特殊符号，左靠，右部多余部分填空格。</p> </td><td> <p> </p> </td></tr><tr><td> <p>B</p> </td><td> <p>二进制bit 位。</p> <p> </p> </td><td> <p> </p> </td></tr><tr><td> <p>DD </p> <p> </p> </td><td> <p>日</p> </td><td> <p> </p> </td></tr><tr><td> <p>hh</p> </td><td> <p>时</p> </td><td> <p> </p> </td></tr><tr><td> <p>LL</p> </td><td> <p>可变长域的长度值(二位数)</p> </td><td> <p>前面两位数字代表长度，按照此长度截取该字段的值；</p> </td></tr><tr><td> <p>LLL</p> </td><td> <p>可变长域的长度值(三位数)</p> </td><td> <p>前面三位数字代表长度，按照此长度截取该字段的值；</p> </td></tr><tr><td> <p>MM</p> </td><td> <p>月</p> </td><td> <p> </p> </td></tr><tr><td> <p>mm</p> </td><td> <p>分</p> </td><td> <p> </p> </td></tr><tr><td> <p>N </p> </td><td> <p>数值，右靠，首位有效数字前充零。若表示金额，则最右二位为角分</p> </td><td> <p> </p> </td></tr><tr><td> <p>S</p> </td><td> <p>特殊符号</p> </td><td> <p> </p> </td></tr><tr><td> <p>ss</p> </td><td> <p>秒</p> </td><td> <p> </p> </td></tr><tr><td> <p>VAR</p> </td><td> <p>可变长域</p> </td><td> <p> </p> </td></tr><tr><td> <p>X </p> </td><td> <p>借贷符号，在数值之前，D 表示借，C 表示贷</p> </td><td> <p> </p> </td></tr><tr><td> <p>YY</p> </td><td> <p>年</p> </td><td> <p> </p> </td></tr><tr><td> <p>Z</p> </td><td> <p>由ISO 7811 和ISO 7813 制定的磁条卡第二、三磁道的数据类型</p> </td><td> <p> </p> </td></tr><tr><td> <p>CN </p> </td><td> <p>BCD 压缩编码数值</p> </td><td> <p> </p> </td></tr><tr><td> <p> </p> </td><td> <p> </p> </td><td> <p> </p> </td></tr><tr><td> <p> </p> </td><td> <p> </p> </td><td> <p> </p> </td></tr></tbody></table> 
</div> 
<p>对可变长数据元，以下例说明：</p> 
<p>—— 变量XYZ 的数据类型为ANS...999(LLLVAR)，则表示：该变量中可含字母、数字和特殊符号，</p> 
<p>最长不超过999 个字符，长度由三位数字确定。</p> 
<p>—— 变量XYZ 的数据类型为N...999（LLLVAR），则在压缩时，其长度位用右靠的BCD 码压缩，而</p> 
<p>其后紧随的数字内容用左靠的BCD 码压缩。这是为了保证有效内容和其位数中间无缺省填充</p> 
<p>值。若不为偶数位，左靠的数字内容后补零。由于有长度位表征该域有效内容的长度，因此后</p> 
<p>补零不会改变该域的真实值。</p> 
<p>注： 本文档中声明的压缩变量属性是针对POS终端与POS中心之间的消息，POS中心与任何金融机构之间的消息将全</p> 
<p>部采用ASCII码且不压缩的格式。</p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d26d5553cdf8e9941c709b3141fe01a1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">互联网产品经理的工作职责</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d3cac546f5d8721076a8f583ab68dbde/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">提供的一个好用放大镜插件，基于juqery，非原创。</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>