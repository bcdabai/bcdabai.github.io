<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>4.SpringBoot配置及Nacos配置中心加载顺序及覆盖生效优先关系 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="4.SpringBoot配置及Nacos配置中心加载顺序及覆盖生效优先关系" />
<meta property="og:description" content="目录
一、测试环境版本
二、测试结果
1、标准的SpringBoot应用
2、含有Nacos配置中心的SpringBoot应用
一、测试环境版本 spring-boot-starter-parent 2.7.10
spring-cloud-starter-bootstrap 3.1.6
spring-cloud-starter-alibaba-nacos-config 2021.0.4.0
nacos-client 2.1.1
nacos服务端 2.2.1
二、测试结果 1、标准的SpringBoot应用 在标准的SpringBoot应用中，本地配置加载顺序如下：
bootstrap配置 加载先于 application配置不带profile的配置 加载先于 带profile的配置(不含后缀的)同文件名配置 *.yaml 加载先于 *.properties 综上，本地加载顺序为：
bootstrap.yamlbootstrap.propertiesbootstrap-{profile}.yamlbootstrap-{profile}.propertiesapplication.yamlapplication.propertiesapplication-{profile}.yamlapplication-{profile}.properties 因此，配置生效覆盖关系：
对于key名相同，后加载会覆盖掉前加载，故而最终为后加载的配置项生效！
对于key名不同，则直接生效（会加载，但不会被覆盖）；
注意：不能理解为文件级整体覆盖，而仅是同名key会被后加载的键值覆盖。
2、含有Nacos配置中心的SpringBoot应用 带Nacos配置中心的SpringBoot应用中，配置加载顺序如下：
本地bootstrap配置 加载先于 本地application配置本地配置 加载先于 nacos配置中心 nacos配置中心上共享配置(见下说明) 加载先于 nacos配置中心该服务配置（见下说明）不带profile的配置 加载先于 带profile的配置本地(不含后缀的)同文件名配置 *.yaml 加载先于 *.propertiesnacos配置中心因需要通过data ID指定（或者通过spring.cloud.nacos.config.file-extension指定后缀），所以对于Nacos配置中心上的某个Data ID而言，不会存在既加载其*.yaml又加载其*.properties的情形。 综上，本地及Nacos配置中心共同加载顺序为：
bootstrap.yamlbootstrap.propertiesbootstrap-{profile}.yamlbootstrap-{profile}.propertiesapplication.yamlapplication.propertiesapplication-{profile}.yamlapplication-{profile}.propertiesnacos配置中心共享配置（通过spring.cloud.nacos.config.shared-configs指定）Nacos配置中心该服务配置（通过spring.cloud.nacos.config.prefix和spring.cloud.nacos.config.file-extension指定）Nacos配置中心该服务-{profile}配置（通过spring.cloud.nacos.config.prefix和spring.cloud.nacos.config.file-extension、以及spring.profiles.active指定） 因此，配置生效覆盖关系：
对于key名相同，后加载会覆盖掉前加载，故而最终为后加载的配置项生效！
对于key名不同，则直接生效（会加载，但不会被覆盖）；
注意：不能理解为文件级整体覆盖，而仅是同名key会被后加载的键值覆盖。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/50320f6c4a3f71aeb2f1e727954566e1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-21T09:18:29+08:00" />
<meta property="article:modified_time" content="2023-09-21T09:18:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">4.SpringBoot配置及Nacos配置中心加载顺序及覆盖生效优先关系</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%E7%89%88%E6%9C%AC-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%E7%89%88%E6%9C%AC" rel="nofollow">一、测试环境版本</a></p> 
<p id="%E4%BA%8C%E3%80%81%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C" rel="nofollow">二、测试结果</a></p> 
<p id="1%E3%80%81%E6%A0%87%E5%87%86%E7%9A%84SpringBoot%E5%BA%94%E7%94%A8-toc" style="margin-left:80px;"><a href="#1%E3%80%81%E6%A0%87%E5%87%86%E7%9A%84SpringBoot%E5%BA%94%E7%94%A8" rel="nofollow">1、标准的SpringBoot应用</a></p> 
<p id="2%E3%80%81%E5%90%AB%E6%9C%89Nacos%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E7%9A%84SpringBoot%E5%BA%94%E7%94%A8-toc" style="margin-left:80px;"><a href="#2%E3%80%81%E5%90%AB%E6%9C%89Nacos%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E7%9A%84SpringBoot%E5%BA%94%E7%94%A8" rel="nofollow">2、含有Nacos配置中心的SpringBoot应用</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p></p> 
<h2 id="%E4%B8%80%E3%80%81%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%E7%89%88%E6%9C%AC">一、测试环境版本</h2> 
<ul><li> <p>spring-boot-starter-parent  2.7.10</p> </li><li> <p>spring-cloud-starter-bootstrap  3.1.6</p> </li><li> <p>spring-cloud-starter-alibaba-nacos-config  2021.0.4.0</p> </li><li> <p>nacos-client 2.1.1</p> </li><li> <p>nacos服务端 2.2.1</p> </li></ul> 
<p></p> 
<h2 id="%E4%BA%8C%E3%80%81%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C">二、测试结果</h2> 
<h4 id="1%E3%80%81%E6%A0%87%E5%87%86%E7%9A%84SpringBoot%E5%BA%94%E7%94%A8">1、标准的SpringBoot应用</h4> 
<p>在标准的SpringBoot应用中，本地配置加载顺序如下：</p> 
<ul><li>bootstrap配置 <strong>加载先于</strong> application配置</li><li>不带profile的配置 <strong>加载先于</strong> 带profile的配置</li><li>(不含后缀的)同文件名配置 *.yaml  <strong>加载先于</strong> *.properties</li></ul> 
<blockquote> 
 <p><strong>综上，本地加载顺序为</strong>：</p> 
 <ol><li>bootstrap.yaml</li><li>bootstrap.properties</li><li>bootstrap-{profile}.yaml</li><li>bootstrap-{profile}.properties</li><li>application.yaml</li><li>application.properties</li><li>application-{profile}.yaml</li><li>application-{profile}.properties</li></ol> 
 <p><span style="color:#fe2c24;"><strong>因此，配置生效覆盖关系：</strong></span></p> 
 <p><span style="color:#fe2c24;">    对于key名相同，后加载会覆盖掉前加载，故而最终为后加载的配置项生效！</span></p> 
 <p><span style="color:#fe2c24;">    对于key名不同，则直接生效（会加载，但不会被覆盖）；</span></p> 
 <p><span style="color:#fe2c24;"><strong>    注意：不能理解为文件级整体覆盖，而仅是同名key会被后加载的键值覆盖。</strong></span></p> 
</blockquote> 
<p></p> 
<h4 id="2%E3%80%81%E5%90%AB%E6%9C%89Nacos%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E7%9A%84SpringBoot%E5%BA%94%E7%94%A8">2、含有Nacos配置中心的SpringBoot应用</h4> 
<p>带Nacos配置中心的SpringBoot应用中，配置加载顺序如下：</p> 
<ul><li>本地bootstrap配置 <strong>加载先于</strong> 本地application配置</li><li>本地配置 <strong>加载先于</strong> <span style="color:#4da8ee;">nacos配置中心</span></li><li> <span style="color:#4da8ee;">nacos配置中心上共享配置(见下说明)</span> <strong>加载先于</strong> <span style="color:#4da8ee;">nacos配置中心该服务配置（见下说明）</span></li><li>不带profile的配置 <strong>加载先于</strong> 带profile的配置</li><li>本地(不含后缀的)同文件名配置 *.yaml  <strong>加载先于</strong> *.properties</li><li><span style="color:#4da8ee;">nacos配置中心因需要通过data ID指定（或者通过spring.cloud.nacos.config.file-extension指定后缀），所以对于Nacos配置中心上的某个Data ID而言，不会存在既加载其*.yaml又加载其*.properties的情形</span>。</li></ul> 
<blockquote> 
 <p><strong>综上，本地及Nacos配置中心共同加载顺序为</strong>：</p> 
 <ol><li>bootstrap.yaml</li><li>bootstrap.properties</li><li>bootstrap-{profile}.yaml</li><li>bootstrap-{profile}.properties</li><li>application.yaml</li><li>application.properties</li><li>application-{profile}.yaml</li><li>application-{profile}.properties</li><li><span style="color:#4da8ee;">nacos配置中心共享配置（通过spring.cloud.nacos.config.shared-configs指定）</span></li><li><span style="color:#4da8ee;">Nacos配置中心该服务配置（通过spring.cloud.nacos.config.prefix和spring.cloud.nacos.config.file-extension指定）</span></li><li><span style="color:#4da8ee;">Nacos配置中心该服务-{profile}配置（通过spring.cloud.nacos.config.prefix和spring.cloud.nacos.config.file-extension、以及spring.profiles.active指定）</span></li></ol> 
 <p><span style="color:#fe2c24;"><strong>因此，配置生效覆盖关系：</strong></span></p> 
 <p><span style="color:#fe2c24;">    对于key名相同，后加载会覆盖掉前加载，故而最终为后加载的配置项生效！</span></p> 
 <p><span style="color:#fe2c24;">    对于key名不同，则直接生效（会加载，但不会被覆盖）；</span></p> 
 <p><span style="color:#fe2c24;"><strong>    注意：不能理解为文件级整体覆盖，而仅是同名key会被后加载的键值覆盖。</strong></span></p> 
</blockquote> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/07fff9185fa7a900a2cd7057b493a714/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何把eclipse从计算机A移植到计算机B</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fde9791f56d08490e8b0898742c9995d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Guacamole远程连接与屏幕录制Docker版</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>