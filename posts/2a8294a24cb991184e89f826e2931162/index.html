<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【科普】C&#43;&#43;标准与标准委员会，你不得不知的那些事 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【科普】C&#43;&#43;标准与标准委员会，你不得不知的那些事" />
<meta property="og:description" content="文章目录 ISO标准C 委员会 与 C&#43;&#43; 委员会如何制定标准C&#43;&#43; 的实现compiler intrinsicMSVCGCCC&#43;&#43;11 标准后 参考 ISO标准 这里直接照搬百度百科：https://baike.baidu.com/item/ISO%E6%A0%87%E5%87%86/9818656?fr=aladdin
ISO标准是指由『 国际标准化组织 (International Organization for Standardization)， ISO 』制订的标准。 国际标准化组织是一个由国家标准化机构组成的世界范围的联合会，现有140个成员国。根据该组织章程，每一个国家只能有一个最有代表性的标准化团体作为其成员，中国原国家质量技术监督局以CSBTS名义国参加ISO活动。
ISO的前身是国际标准化协会（ISA），ISA成立于1926年（1926年美、英、加等七国标准化机构第三次代表联席会议决定成立国际标准化协会，并于1928年成立）。第二次世界大战的爆发，迫使ISA停止工作。战争结束后，大环境为工业恢复提供了条件，于是1946年10月，来自25个国家标准化机构的领导人在伦敦聚会，讨论成立国际标准化组织的问题，并把这个新组织称为ISO，即International Organization for Standardization的简称。会议一致通过了ISO章程和议事规则。1947年2月23日ISO开始正式运行，ISO的中央办事机构设在瑞士的日内瓦。中国既是发起国又是首批成员国。
ISO的组织机构包括：ISO全体大会、主要官员、成员团体、通信成员、捐助成员、政策发展委员会、合格评定委员会（CASCO）、消费者政策委员会（COPOLCO）、发展中国家事务委员会（DEVCO）、特别咨询小组、技术管理局、技术委员会TC、理事会、中央秘书处等。
C 委员会 与 C&#43;&#43; 委员会 https://www.open-std.org/jtc1/sc22/wg21/
https://isocpp.org/std/the-standard
上面第一个链接可以看到一堆paper，第二个链接则可以看到标准。草案不需要购买，但是标准是需要购买的。
通过这个网站：
https://www.open-std.org/jtc1/sc22/
可以看的 JTC1/SC22 的成员，有 C（WG14）、C&#43;&#43;（WG21）、Linux（WG14）
国际 C&#43;&#43; 标准委员会正式名称为 ISO/IEC JTC1/SC22/WG21，它是 C&#43;&#43; 发展的核心。
同时我们参考维基百科，可以看到：
https://en.wikipedia.org/wiki/C%2B%2B
主要受到 Simula 和 C 的影响，同时 C&#43;&#43; 影响了众多语言。
如何制定标准 传统上，ISO 标准每十年左右修订一次。例如，我们有 C89、C99 和 C11。如此长的修订周期是有问题的，如果新特性错过了特性冻结，我们就会要再等上 12 年左右才能将它加入标准。人们自然就会主张将即将通过的标准拖延一两年：“这个特性太重要了，不能等，因此得延迟一下标准的发布！”这就是为什么原本的 C&#43;&#43;0x 结果成了 C&#43;&#43;11，在 C&#43;&#43;98 后过了 13 年。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/2a8294a24cb991184e89f826e2931162/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-18T15:20:50+08:00" />
<meta property="article:modified_time" content="2022-03-18T15:20:50+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【科普】C&#43;&#43;标准与标准委员会，你不得不知的那些事</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#ISO_2" rel="nofollow">ISO标准</a></li><li><a href="#C___C__11" rel="nofollow">C 委员会 与 C++ 委员会</a></li><li><a href="#_29" rel="nofollow">如何制定标准</a></li><li><a href="#C__43" rel="nofollow">C++ 的实现</a></li><li><a href="#compiler_intrinsic_58" rel="nofollow">compiler intrinsic</a></li><li><ul><li><a href="#MSVC_61" rel="nofollow">MSVC</a></li><li><a href="#GCC_75" rel="nofollow">GCC</a></li><li><a href="#C11__89" rel="nofollow">C++11 标准后</a></li></ul> 
  </li><li><a href="#_107" rel="nofollow">参考</a></li></ul> 
</div> 
<p></p> 
<h2><a id="ISO_2"></a>ISO标准</h2> 
<p>这里直接照搬百度百科：<a href="https://baike.baidu.com/item/ISO%E6%A0%87%E5%87%86/9818656?fr=aladdin" rel="nofollow">https://baike.baidu.com/item/ISO%E6%A0%87%E5%87%86/9818656?fr=aladdin</a></p> 
<blockquote> 
 <p>ISO标准是指由『 国际标准化组织 (International Organization for Standardization)， ISO 』制订的标准。 国际标准化组织是一个由国家标准化机构组成的世界范围的联合会，现有140个成员国。根据该组织章程，每一个国家只能有一个最有代表性的标准化团体作为其成员，中国原国家质量技术监督局以CSBTS名义国参加ISO活动。</p> 
</blockquote> 
<blockquote> 
 <p>ISO的前身是国际标准化协会（ISA），ISA成立于1926年（1926年美、英、加等七国标准化机构第三次代表联席会议决定成立国际标准化协会，并于1928年成立）。第二次世界大战的爆发，迫使ISA停止工作。战争结束后，大环境为工业恢复提供了条件，于是1946年10月，来自25个国家标准化机构的领导人在伦敦聚会，讨论成立国际标准化组织的问题，并把这个新组织称为ISO，即International Organization for Standardization的简称。会议一致通过了ISO章程和议事规则。1947年2月23日ISO开始正式运行，ISO的中央办事机构设在瑞士的日内瓦。中国既是发起国又是首批成员国。</p> 
</blockquote> 
<blockquote> 
 <p>ISO的组织机构包括：ISO全体大会、主要官员、成员团体、通信成员、捐助成员、政策发展委员会、合格评定委员会（CASCO）、消费者政策委员会（COPOLCO）、发展中国家事务委员会（DEVCO）、特别咨询小组、技术管理局、技术委员会TC、理事会、中央秘书处等。</p> 
</blockquote> 
<h2><a id="C___C__11"></a>C 委员会 与 C++ 委员会</h2> 
<p><a href="https://www.open-std.org/jtc1/sc22/wg21/" rel="nofollow">https://www.open-std.org/jtc1/sc22/wg21/</a><br> <a href="https://isocpp.org/std/the-standard" rel="nofollow">https://isocpp.org/std/the-standard</a></p> 
<p>上面第一个链接可以看到一堆paper，第二个链接则可以看到标准。草案不需要购买，但是标准是需要购买的。</p> 
<p>通过这个网站：<br> <a href="https://www.open-std.org/jtc1/sc22/" rel="nofollow">https://www.open-std.org/jtc1/sc22/</a><br> <img src="https://images2.imgbox.com/26/9a/aiyMJiP1_o.png" alt="在这里插入图片描述"><br> 可以看的 JTC1/SC22 的成员，有 C（WG14）、C++（WG21）、Linux（WG14）</p> 
<p>国际 C++ 标准委员会正式名称为 ISO/IEC JTC1/SC22/WG21，它是 C++ 发展的核心。</p> 
<p>同时我们参考维基百科，可以看到：<br> <a href="https://en.wikipedia.org/wiki/C++" rel="nofollow">https://en.wikipedia.org/wiki/C%2B%2B</a><br> <img src="https://images2.imgbox.com/54/87/3FohlRh8_o.png" alt="在这里插入图片描述"><br> 主要受到 Simula 和 C 的影响，同时 C++ 影响了众多语言。</p> 
<h2><a id="_29"></a>如何制定标准</h2> 
<blockquote> 
 <p>传统上，ISO 标准每十年左右修订一次。例如，我们有 C89、C99 和 C11。如此长的修订周期是有问题的，如果新特性错过了特性冻结，我们就会要再等上 12 年左右才能将它加入标准。人们自然就会主张将即将通过的标准拖延一两年：“这个特性太重要了，不能等，因此得延迟一下标准的发布！”这就是为什么原本的 C++0x 结果成了 C++11，在 C++98 后过了 13 年。</p> 
</blockquote> 
<blockquote> 
 <p>在 C++11 之后，一些委员会成员希望缩短周期，召集人 Herb Sutter 建议我们采用列车模型。也就是说，列车在预定时间出发，任何没上车的人将不得不等待下一班。大家喜欢这个建议，也花了挺长时间讨论标准修订之间的合适间隔。我主张短点，3 年，因为再长（例如 5 年）就容易被“这个特性非常重要，等不了”这样的说法拖累，导致发布延迟。我们商定了三年的发布周期，Herb Sutter 补充建议采用交替发行大版本和小版本的英特尔“滴答”模型。这也得到了同意，因此在 C++11（§4）三年后，我们发布了 C++14（§5），它纳入了之前被延迟的特性并纠正了早期使用中发现的小问题。C++17 也按时交付，但可惜并不是一次大升级（§8）。C++20 在 2019 年 2 月通过投票，确定了完整的发布特性。最终技术性投票于 2020 年 2 月在布拉格完成。</p> 
</blockquote> 
<p>显然，如此庞大的组织和个人组成的群体代表着千差万别的兴趣和技术背景，需要一个组织结构来运作。会议是围绕工作组（WG）和研究组（SG）进行组织的。</p> 
<p>在 WG 和 SG 里，每个出席者都可以投一票。委员会全体会议的正式投票则是每个到会的组织一票（这样，大型组织就不会有多票），再加上国家标准机构的票数。“技术性投票”和国家机构投票必须一致才算达成共识。<br> <img src="https://images2.imgbox.com/3b/ee/DaWAOG40_o.png" alt="在这里插入图片描述"><br> 如上图，易知C++标准库是标准的一部分的。</p> 
<p>其实我个人是极其佩服C++之父的，他崇尚只有少数人能决定标准，来确保未来走向。但是这也导致一个特性正式被采纳标准变得非常慢。<em><strong>比如C++之父早在03年就发表了对概念（concept）的论文，在06年就进入了标准草案，但在09年被委员会放弃。</strong></em> 而对于像 Go、C# 等则是公司主导的编程语言，Python、PHP 则是个人英雄主义+社区主导的语言。</p> 
<h2><a id="C__43"></a>C++ 的实现</h2> 
<p>我们在wiki上可以看到他的主要实现：GCC, LLVM Clang, Microsoft Visual C++, Embarcadero C++Builder, Intel C++ Compiler, IBM XL C++, EDG</p> 
<p>而从前端来说主要的一般是 Clang、EDG、GCC 和 微软，而对于后端实现上则少说有十几个。</p> 
<p>这些实现都需要围绕标准规格书来进行，需要符合标准。比如多线程，在C++11之前，我们只能根据不同平台操作系统提供的接口来调用对应API，可以参考 POSIX 线程（pthread）：<br> <a href="https://baike.baidu.com/item/POSIX%E7%BA%BF%E7%A8%8B/15809676?fromtitle=Pthread&amp;fromid=4623312&amp;fr=aladdin" rel="nofollow">https://baike.baidu.com/item/POSIX%E7%BA%BF%E7%A8%8B/15809676?fromtitle=Pthread&amp;fromid=4623312&amp;fr=aladdin</a><br> 和 POSIX （可移植操作系统接口（英语：Portable Operating System Interface，缩写为POSIX））<br> <a href="https://baike.baidu.com/item/%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3/12718298?fromtitle=POSIX&amp;fromid=3792413" rel="nofollow">https://baike.baidu.com/item/%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3/12718298?fromtitle=POSIX&amp;fromid=3792413</a></p> 
<p>但是有了 11 制定的多线程标准后，所有C++的实现都会符合这个标准，因此我们只要符合标准的代码就能在各个平台上运行了！</p> 
<blockquote> 
 <p>注：<br> 接触过 OpenGL 的同学有没有觉得有点像 OpenGL？OpenGL本身只是一个规范，而真正实现那些OpenGL函数的是你的显卡厂商。有的老师误以为 OpenGL 是一个库，这是不对的。</p> 
</blockquote> 
<h2><a id="compiler_intrinsic_58"></a>compiler intrinsic</h2> 
<p>这里我们有 compiler intrinsic 的概念，即编译器特有的拓展。这里我们拿字节对齐为例：</p> 
<h3><a id="MSVC_61"></a>MSVC</h3> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">__declspec</span><span class="token punctuation">(</span><span class="token function">align</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">__alignof</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">__alignof</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这里的 __declspec 和 __alignof 便是 compiler intrinsic，但是我们在 GCC 下编译：<code>g++ test.cc -std=c++17 -W{all,extra,error,pedantic}</code><br> <img src="https://images2.imgbox.com/dc/71/6eWvQuni_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="GCC_75"></a>GCC</h3> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">aligned</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">__alignof__</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">__alignof__</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>可以看到，GCC中我们需要改为 <code>__attribute__((aligned(8)))</code> 与 <code>__alignof__</code>，这时候编译输出正确结果才是 4 8，但是显然在 MSVC 上会报错。</p> 
<h3><a id="C11__89"></a>C++11 标准后</h3> 
<p>C++11标准制定了 alignas 与 alignof，如下：</p> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">struct</span> MyStruct
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">alignas</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">int</span> x2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">alignof</span><span class="token punctuation">(</span>MyStruct<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这里 alignof 只能对类型使用，不能对某个变量使用。此时输出为 8，GCC 与 MSVC 皆可成功编译运行。</p> 
<h2><a id="_107"></a>参考</h2> 
<p><a href="https://github.com/Cpp-Club/Cxx_HOPL4_zh">https://github.com/Cpp-Club/Cxx_HOPL4_zh</a><br> 《现代C++语言核心特性解析》</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/29b82afaef75bb7a3dac2d14241cc670/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【视觉SLAM(二)】Realsense D455在Jetson Nano上的安装Realsense和ROS驱动安装</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3032330ef4cb3e48a4a975e3bc441205/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">随手记——虚拟机从ovf安装，缺少所需的磁盘映像</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>