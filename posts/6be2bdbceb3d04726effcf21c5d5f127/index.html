<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SpringBoot 操作pdf模板全套流程 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SpringBoot 操作pdf模板全套流程" />
<meta property="og:description" content="1.自定义Pdf 模板 真实开发场景中，大部分需求都是指定让你在某个地方插入的具体数据是什么，这个时候我们就需要一个PDF 的模板。
（1）新建一个word 文档，编排好你需要的格式。
（2）将编号的文档另存为pdf
(3)使用pdf编辑器,编辑表单，（例如福昕PDF阅读器、Adobe Acrobat DC），在本篇文章中使用的是Acrobat 9 Pro v9.0.0
2.Acrobat 9 Pro v9.0.0的简单使用： （1）点开软件，打开制作好的pdf 基础模板，点击表单选项，然后点击添加或编辑域。
（2）在表单-&gt;表单工具中选择你需要的控件，如果是文本内容一般就使用文本框即可
（3）将控件拖动到指定你想填充数据的地方并拖动鼠标调整大小
（4）双击控件进行一些配置
配置注意项
【1】必须给一个名字，后序在程序中就是通过这个名字找到该文本框并填入内容
【2】给文本框表单域选择隐藏，这样就不会保存之后点开能看到这个框本身
隐藏效果如下：
不隐藏效果如下：
【3】其他细节就自行配置，
（5）配置好之后保存成pdf 即可。
3.Springboot 操作模板添加数据： 1.依赖引入
&lt;!-- PDF操作,itext7全家桶 --&gt; &lt;dependency&gt; &lt;groupId&gt;com.itextpdf&lt;/groupId&gt; &lt;artifactId&gt;itext7-core&lt;/artifactId&gt; &lt;version&gt;7.1.11&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;com.itextpdf&lt;/groupId&gt; &lt;artifactId&gt;itextpdf&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt; &lt;artifactId&gt;pdfbox&lt;/artifactId&gt; &lt;version&gt;2.0.24&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.itextpdf&lt;/groupId&gt; &lt;artifactId&gt;font-asian&lt;/artifactId&gt; &lt;version&gt;7.1.11&lt;/version&gt; &lt;/dependency&gt; 2.操作模板并返回生成的Pdf 说明：这里我们直接调用接口返回的就是pdf 本身
private void createPDF(HttpServletResponse response, data1) throws IOException { private static final String DOWNLOAD_PATH = new File(System." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/6be2bdbceb3d04726effcf21c5d5f127/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-28T14:26:01+08:00" />
<meta property="article:modified_time" content="2023-11-28T14:26:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SpringBoot 操作pdf模板全套流程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>1.自定义Pdf 模板</h3> 
<p>真实开发场景中，大部分需求都是指定让你在某个地方插入的具体数据是什么，这个时候我们就需要一个PDF 的模板。</p> 
<p>（1）新建一个word 文档，编排好你需要的格式。</p> 
<p>（2）将编号的文档另存为pdf</p> 
<p>  (3)使用pdf编辑器,编辑表单，（例如福昕PDF阅读器、Adobe Acrobat DC），在本篇文章中使用的是Acrobat 9 Pro v9.0.0</p> 
<h3>2.Acrobat 9 Pro v9.0.0的简单使用：</h3> 
<p>（1）点开软件，打开制作好的pdf 基础模板，点击表单选项，然后点击添加或编辑域。</p> 
<p><img alt="" height="976" src="https://images2.imgbox.com/3e/b5/ehnTVbgZ_o.png" width="1200"></p> 
<p>（2）在表单-&gt;表单工具中选择你需要的控件，如果是文本内容一般就使用文本框即可</p> 
<p><img alt="" height="584" src="https://images2.imgbox.com/4e/56/fEVORhzA_o.png" width="1200"></p> 
<p>（3）将控件拖动到指定你想填充数据的地方并拖动鼠标调整大小</p> 
<p>（4）双击控件进行一些配置</p> 
<p>                配置注意项</p> 
<p>        【1】必须给一个名字，后序在程序中就是通过这个名字找到该文本框并填入内容</p> 
<p><img alt="" height="171" src="https://images2.imgbox.com/41/02/I3qUIlob_o.png" width="307"></p> 
<p>        【2】给文本框表单域选择隐藏，这样就不会保存之后点开能看到这个框本身</p> 
<p><img alt="" height="241" src="https://images2.imgbox.com/9b/05/Y352HR1P_o.png" width="314"></p> 
<p>隐藏效果如下：</p> 
<p><img alt="" height="149" src="https://images2.imgbox.com/9c/2b/scWqgTQO_o.png" width="364"></p> 
<p>不隐藏效果如下：</p> 
<p><img alt="" height="226" src="https://images2.imgbox.com/86/14/us8ZiKO9_o.png" width="477"></p> 
<p>        【3】其他细节就自行配置，</p> 
<p>（5）配置好之后保存成pdf 即可。</p> 
<h3>3.Springboot 操作模板添加数据：</h3> 
<p>1.依赖引入</p> 
<pre><code>        &lt;!-- PDF操作,itext7全家桶 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
            &lt;artifactId&gt;itext7-core&lt;/artifactId&gt;
            &lt;version&gt;7.1.11&lt;/version&gt;
            &lt;type&gt;pom&lt;/type&gt;
            &lt;exclusions&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
                    &lt;artifactId&gt;itextpdf&lt;/artifactId&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.pdfbox&lt;/groupId&gt;
            &lt;artifactId&gt;pdfbox&lt;/artifactId&gt;
            &lt;version&gt;2.0.24&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
            &lt;artifactId&gt;font-asian&lt;/artifactId&gt;
            &lt;version&gt;7.1.11&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre> 
<p>2.操作模板并返回生成的Pdf </p> 
<p>说明：这里我们直接调用接口返回的就是pdf 本身</p> 
<pre><code class="language-java"> private void createPDF(HttpServletResponse response, data1) throws IOException {
    private static final String DOWNLOAD_PATH = new File(System.getProperty("user.dir")).getParent() + File.separator + "download";
String filePath = DOWNLOAD_PATH + File.separator + "测试.pdf";
    PdfWriter writer = new PdfWriter(response.getOutputStream());
    //这个template 是在项目的resources 目录下新建的一个template目录，下面存放你的模板
    PdfDocument pdfDoc = new PdfDocument(new PdfReader("template/xxx.pdf"), writer);
    // 获取页面数量
    int totalPages = pdfDoc.getNumberOfPages();
    //这里可有可无，这个是自定义字体。
    ClassPathResource resource = new ClassPathResource("font/STKAITI.TTF");
    PdfFont chineseFont = PdfFontFactory.createFont(toByteArray(resource.getStream()),             
    PdfEncodings.IDENTITY_H, false);
        // 创建 Document 对象
    Document document = new Document(pdfDoc, PageSize.A4);
    //新增一个方法像模板中添加数据,这里面的数据变量就是你自己的数据
    addContentToPdfTemplate(data1, pdfDoc,  totalPages, chineseFont, document);
    //给pdf 添加水印，水印的字就是mark 变量
    addWaterMark(mark, pdfDoc, chineseFont);
    pdfDoc.close();
    writeBytes(filePath, response.getOutputStream());
}</code></pre> 
<p>3.addContentToPdfTemplate方法：</p> 
<p>说明：这里面主要是文本类型数据分行插入和图片适应我们配置文本框大小的小实现方式。</p> 
<pre><code class="language-java">    private void addContentToPdfTemplate(PdfDataVo dataObj, PdfDocument pdfDoc ,int totalPages, PdfFont chineseFont, Document document) throws IOException {
        for (int i = 1; i &lt;= totalPages; i++) {
            // 获取页面
            PdfPage page = pdfDoc.getPage(i);
            // 获取页面的内容
            PdfCanvas canvas = new PdfCanvas(page);
            List&lt;PdfAnnotation&gt; annotations = page.getAnnotations();
            // 遍历页面的注释
            for (PdfAnnotation annotation : annotations) {
                if (annotation instanceof PdfWidgetAnnotation) {
                    PdfDictionary dic = annotation.getPdfObject();
                    PdfName fieldType = dic.getAsName(PdfName.FT);

                    // 判断是否为需要处理的字段
                    if (fieldType != null &amp;&amp; fieldType.equals(PdfName.Tx)) {
                        // 获取表单字段的矩形位置信息
                        Rectangle rect = annotation.getRectangle().toRectangle();
                           //字体大小，也是在模板中可以配置的选项，我在模板中配置的是14
                        float fontSize = 14;
                        // 计算每行容纳的字符数
                        int charactersPerLine = (int) (rect.getWidth() / fontSize);
                        // 获取字段的名称
                        String fieldName = dic.getAsString(PdfName.T).toUnicodeString();
                        // 根据字段名称设置不同的值
                        String fieldValue = "";
						//从这里的if 开始（content，img等都是我们在模板中给文本框配置的名称）
                        if ("content".equals(fieldName)) {
                            String data = removeEmojis(content).replaceAll("…", "...");
                            fieldValue = data;
                            String finalValue = fieldValue.length() &gt; 200 ? fieldValue.substring(0, 200) + "..." : fieldValue;
                            float f = fieldValue.length() &gt; 100 ? 4.5f : 1.2f;
                            // 分割 content 文本为多行
                            List&lt;String&gt; lines = splitTextIntoLines(finalValue, charactersPerLine);
                            // 计算文本所需高度
                            float lineHeight = fontSize * f; // 可根据实际情况调整行高
                            float textHeight = lineHeight * lines.size();
                            // 创建段落对象
                            Paragraph paragraph = new Paragraph();
                            paragraph.setFont(chineseFont).setFontSize(fontSize).setTextAlignment(TextAlignment.LEFT).setVerticalAlignment(VerticalAlignment.MIDDLE);
                            // 添加每行文本到段落中
                            for (String line : lines) {
                                paragraph.add(line).add("\n");
                            }
                            // 设置段落的位置和宽度
                            paragraph.setFixedPosition(i, rect.getLeft(), rect.getBottom() + (rect.getHeight() - textHeight) / 2, rect.getWidth());
                            // 将段落添加到文档中
                            document.add(paragraph);
                        } else if ("img".equals(fieldName) &amp;&amp; StringUtil.isNotEmpty(dataObj.getSnapshotLink())) {
                            String imageUrl=dataObj.getSnapshotLink(); 
                            if (StringUtil.isNotBlank(imageUrl)) {
                                //float imageHeight = rect.getWidth(); // 图片的高度
                                // 加载网络图片并创建图像对象
                                ImageData imageData = ImageDataFactory.create(imageUrl);
                                // 获取容器坐标和图片大小
                                float x = rect.getX();
                                float y = rect.getY();
                                float width = imageData.getWidth();
                                float height = imageData.getHeight();
                                // 计算缩放比例
                                float scaleX = rect.getWidth() / width;
                                float scaleY = rect.getHeight() / height;
                                float scale = Math.min(scaleX, scaleY);
                                // 计算缩放后的宽度和高度
                                float scaledWidth = width * scale;
                                float scaledHeight = height * scale;
                        //这个方法的0.0F 参数是源代码中编写的，我们不需要修改就直接搬过来照写            
                       canvas.addImage(imageData,scaledWidth,0.0F,0.0F,scaledHeight,x,y);
                            }
                        }
                        
                    }
                }
            }
        }
    }</code></pre> 
<p>4.添加水印：</p> 
<pre><code class="language-java">    private void addWaterMark(String mark, PdfDocument pdfDoc, PdfFont chineseFont) {
        String watermarkText = mark;
        Color grayColor = ColorConstants.DARK_GRAY;
        float fontSize = 20f;
        float opacity = 0.3f; // 设置透明度
        for (int i = 1; i &lt;= pdfDoc.getNumberOfPages(); i++) {
            PdfPage page = pdfDoc.getPage(i);
            PdfCanvas canvas = new PdfCanvas(page);
            Rectangle pageSize = page.getPageSize();
            float x = pageSize.getWidth();
            float y = pageSize.getHeight();
            for (int j = 0; j &lt; 4; j++) {
                for (int k = 0; k &lt; 4; k++) {
                    // 创建平移变换
                    AffineTransform transform = AffineTransform.getTranslateInstance(x / 4 * j + 90, y / 4 * k + 50);
                    //对平移变换进行旋转
                    transform.rotate(Math.toRadians(50));
                    canvas.saveState();
                    PdfExtGState extGState = new PdfExtGState().setFillOpacity(opacity);
                    canvas.setExtGState(extGState);
                    canvas.setFillColor(grayColor)
                            .beginText()
                            .setFontAndSize(chineseFont, fontSize)
                            .setTextMatrix(transform)
                            .showText(watermarkText)
                            .endText();

                    canvas.restoreState();
                }
            }
            canvas.release();
        }
    }</code></pre> 
<p>如果该文章对您有点帮助的话，可以麻烦点个赞，谢谢</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d2e39b23cef469077a4d03a627867c4a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python&#43;PySide6之模型/视图/委托框架QListView案例实践</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/52bcda4e83e800ef148dd7e3fd473bfd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">分享一下快速搭建IntelliJ IDEA开发环境的完整教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>