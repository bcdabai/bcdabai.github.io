<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CNN进行猫狗识别（PyTorch） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CNN进行猫狗识别（PyTorch）" />
<meta property="og:description" content="目录 1.项目数据及源码2.任务介绍3.数据预处理4.图像可视化5.建立模型6.进行训练 1.项目数据及源码 可在github下载：
https://github.com/chenshunpeng/Cat-dog-recognition-based-on-CNN
2.任务介绍 数据结构为：
big_data ├── train │ └── cat │ └── XXX.jpg（每个文件夹含若干张图像） │ └── dog │ └── XXX.jpg（每个文件夹含若干张图像） ├── val │ └── cat │ └── XXX.jpg（每个文件夹含若干张图像） │ └── dog └── ───	└── XXX.jpg（每个文件夹含若干张图像） 需要对train数据集进行训练，达到给定val数据集中的一张猫 / 狗的图片，识别其是猫还是狗
3.数据预处理 引入头文件
import torch from torch import nn from torch.utils.data import DataLoader from torchvision import datasets from torchvision.transforms import ToTensor, Lambda, Compose import matplotlib.pyplot as plt import torchvision.transforms as transforms import numpy as np 数据读取与预处理" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/2f25744bd82f0c0bdb846238df07546f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-29T22:40:53+08:00" />
<meta property="article:modified_time" content="2022-08-29T22:40:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CNN进行猫狗识别（PyTorch）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><ul><li><a href="#1_1" rel="nofollow">1.项目数据及源码</a></li><li><a href="#2_5" rel="nofollow">2.任务介绍</a></li><li><a href="#3_21" rel="nofollow">3.数据预处理</a></li><li><a href="#4_130" rel="nofollow">4.图像可视化</a></li><li><a href="#5_175" rel="nofollow">5.建立模型</a></li><li><a href="#6_272" rel="nofollow">6.进行训练</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="1_1"></a>1.项目数据及源码</h3> 
<p>可在github下载：</p> 
<p><a href="https://github.com/chenshunpeng/Cat-dog-recognition-based-on-CNN">https://github.com/chenshunpeng/Cat-dog-recognition-based-on-CNN</a></p> 
<h3><a id="2_5"></a>2.任务介绍</h3> 
<p>数据结构为：</p> 
<pre><code class="prism language-python">big_data
    ├── train
    │   └── cat
    │   	└── XXX<span class="token punctuation">.</span>jpg（每个文件夹含若干张图像）
    │   └── dog
    │   	└── XXX<span class="token punctuation">.</span>jpg（每个文件夹含若干张图像）
    ├── val
    │   └── cat
    │   	└── XXX<span class="token punctuation">.</span>jpg（每个文件夹含若干张图像）
    │   └── dog
    └── ───	└── XXX<span class="token punctuation">.</span>jpg（每个文件夹含若干张图像）
</code></pre> 
<p>需要对train数据集进行训练，达到给定val数据集中的一张猫 / 狗的图片，识别其是猫还是狗</p> 
<h3><a id="3_21"></a>3.数据预处理</h3> 
<p>引入头文件</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> torch
<span class="token keyword">from</span> torch <span class="token keyword">import</span> nn
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataLoader
<span class="token keyword">from</span> torchvision <span class="token keyword">import</span> datasets
<span class="token keyword">from</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">import</span> ToTensor<span class="token punctuation">,</span> Lambda<span class="token punctuation">,</span> Compose
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">as</span> transforms
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
</code></pre> 
<p>数据读取与预处理</p> 
<p>在这里使用<code>torch.utils.data.DataLoader()</code>方法，把训练数据分成多个小组，此函数每次抛出一组数据，直至把所有的数据都抛出</p> 
<p>常见参数介绍如下（借鉴自：<a href="https://blog.csdn.net/qq_36044523/article/details/118914223">传送门</a>）：</p> 
<p>1、<code>dataset</code>：（数据类型 dataset）</p> 
<p>输入的数据类型，这里是原始数据的输入，PyTorch内也有这种数据结构</p> 
<p>2、<code>batch_size</code>：（数据类型 int）</p> 
<p>批训练数据量的大小，根据具体情况设置即可（默认：1）<br> PyTorch训练模型时调用数据不是一行一行进行的（这样太没效率），而是一捆一捆来的，这里就是定义每次喂给神经网络多少行数据，其每次随机读取大小为batch_size，如果dataset中的数据个数不是batch_size的整数倍，则最后一次把剩余的数据全部输出，若想把剩下的不足batch size个的数据丢弃，则将drop_last设置为True，会将多出来不足一个batch的数据丢弃</p> 
<p>3、<code>shuffle</code>：（数据类型 bool）</p> 
<p>洗牌，默认设置为False<br> 在每次迭代训练时是否将数据洗牌，将输入数据的顺序打乱，是为了使数据更有独立性，但如果数据是有序列特征的，就不要设置成True了</p> 
<p>4、<code>collate_fn</code>：（数据类型 callable）</p> 
<p>将一小段数据合并成数据列表，默认设置是False<br> 如果设置成True，系统会在返回前会将张量数据（Tensors）复制到CUDA内存中</p> 
<p>5、<code>batch_sampler</code>：（数据类型 Sampler）</p> 
<p>批量采样，默认设置为None<br> 但每次返回的是一批数据的索引（注意：不是数据），其和batch_size、shuffle 、sampler and drop_last参数是不兼容的</p> 
<p>6、<code>sampler</code>：（数据类型 Sampler）</p> 
<p>采样，默认设置为None<br> 根据定义的策略从数据集中采样输入，如果定义采样规则，则洗牌（shuffle）设置必须为False。</p> 
<p>7、<code>drop_last</code>：（数据类型 bool）</p> 
<p>丢弃最后数据，默认为False<br> 设置了 batch_size 的数目后，最后一批数据未必是设置的数目，有可能会小些，选择这你是否需要丢弃这批数据</p> 
<p>代码：</p> 
<pre><code class="prism language-python">train_datadir <span class="token operator">=</span> <span class="token string">'./big_data/train/'</span>
test_datadir  <span class="token operator">=</span> <span class="token string">'./big_data/val/'</span>

<span class="token comment"># https://pytorch-cn.readthedocs.io/zh/latest/torchvision/torchvision-transform/</span>
<span class="token comment"># https://pytorch.org/vision/stable/auto_examples/plot_transforms.html#sphx-glr-auto-examples-plot-transforms-py</span>
<span class="token comment"># https://pytorch.org/vision/stable/transforms.html</span>
train_transforms <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>
    transforms<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 将输入图片resize成统一尺寸</span>
    transforms<span class="token punctuation">.</span>RandomRotation<span class="token punctuation">(</span>degrees<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#随机旋转，-10到10度之间随机选</span>
    <span class="token comment"># transforms.RandomHorizontalFlip(p=0.5),  #随机水平翻转 选择一个概率概率</span>
    <span class="token comment"># transforms.RandomVerticalFlip(p=0.5),  #随机垂直翻转（效果可能会变差）</span>
    transforms<span class="token punctuation">.</span>RandomPerspective<span class="token punctuation">(</span>distortion_scale<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">,</span> p<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 随机视角</span>
    transforms<span class="token punctuation">.</span>GaussianBlur<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sigma<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#随机选择的高斯模糊模糊图像</span>
    transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token comment"># 将PIL Image或numpy.ndarray转换为tensor，并归一化到[0,1]之间</span>
    transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span>           <span class="token comment"># 标准化处理--&gt;转换为标准正太分布（高斯分布），使模型更容易收敛</span>
        mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
        std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 其中 mean=[0.485,0.456,0.406]与std=[0.229,0.224,0.225] 从数据集中随机抽样计算得到的</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

test_transforms <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>
    transforms<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 将输入图片resize成统一尺寸</span>
    transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token comment"># 将PIL Image或numpy.ndarray转换为tensor，并归一化到[0,1]之间</span>
    transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span>           <span class="token comment"># 标准化处理--&gt;转换为标准正太分布（高斯分布），使模型更容易收敛</span>
        mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
        std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 其中 mean=[0.485,0.456,0.406]与std=[0.229,0.224,0.225] 从数据集中随机抽样计算得到的。</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

train_data <span class="token operator">=</span> datasets<span class="token punctuation">.</span>ImageFolder<span class="token punctuation">(</span>train_datadir<span class="token punctuation">,</span>transform<span class="token operator">=</span>train_transforms<span class="token punctuation">)</span>

test_data  <span class="token operator">=</span> datasets<span class="token punctuation">.</span>ImageFolder<span class="token punctuation">(</span>test_datadir<span class="token punctuation">,</span>transform<span class="token operator">=</span>test_transforms<span class="token punctuation">)</span>

train_loader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>train_data<span class="token punctuation">,</span>
                                          batch_size<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>
                                          shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                          num_workers<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
test_loader  <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>test_data<span class="token punctuation">,</span>
                                          batch_size<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>
                                          shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                          num_workers<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p>查看每组数据的格式：</p> 
<pre><code class="prism language-python"><span class="token keyword">for</span> X<span class="token punctuation">,</span> y <span class="token keyword">in</span> test_loader<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Shape of X [N, C, H, W]: "</span><span class="token punctuation">,</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Shape of y: "</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> y<span class="token punctuation">.</span>dtype<span class="token punctuation">)</span>
    <span class="token keyword">break</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-python">Shape of X <span class="token punctuation">[</span>N<span class="token punctuation">,</span> C<span class="token punctuation">,</span> H<span class="token punctuation">,</span> W<span class="token punctuation">]</span><span class="token punctuation">:</span>  torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Shape of y<span class="token punctuation">:</span>  torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> torch<span class="token punctuation">.</span>int64
</code></pre> 
<h3><a id="4_130"></a>4.图像可视化</h3> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">im_convert</span><span class="token punctuation">(</span>tensor<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">""" 展示数据"""</span>
<span class="token comment">#     tensor.clone()  返回tensor的拷贝，返回的新tensor和原来的tensor具有同样的大小和数据类型</span>
<span class="token comment">#     tensor.detach() 从计算图中脱离出来。</span>
    image <span class="token operator">=</span> tensor<span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">"cpu"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>clone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
<span class="token comment">#     numpy.squeeze()这个函数的作用是去掉矩阵里维度为1的维度</span>
    image <span class="token operator">=</span> image<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
<span class="token comment">#     将npimg的数据格式由（channels,imagesize,imagesize）转化为（imagesize,imagesize,channels）,</span>
<span class="token comment">#     进行格式的转换后方可进行显示</span>
    image <span class="token operator">=</span> image<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
    
<span class="token comment">#     和标准差操作正好相反即可</span>
    image <span class="token operator">=</span> image <span class="token operator">*</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
<span class="token comment">#     使用image.clip(0, 1) 将数据 限制在0和1之间</span>
    image <span class="token operator">=</span> image<span class="token punctuation">.</span>clip<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> image

fig<span class="token operator">=</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
columns <span class="token operator">=</span> <span class="token number">2</span>
rows <span class="token operator">=</span> <span class="token number">2</span>

dataiter <span class="token operator">=</span> <span class="token builtin">iter</span><span class="token punctuation">(</span>train_loader<span class="token punctuation">)</span>
inputs<span class="token punctuation">,</span> classes <span class="token operator">=</span> dataiter<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> idx <span class="token keyword">in</span> <span class="token builtin">range</span> <span class="token punctuation">(</span>columns<span class="token operator">*</span>rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ax <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_subplot<span class="token punctuation">(</span>rows<span class="token punctuation">,</span> columns<span class="token punctuation">,</span> idx<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> xticks<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> yticks<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> classes<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"cat"</span><span class="token punctuation">,</span> fontsize <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"dog"</span><span class="token punctuation">,</span> fontsize <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>im_convert<span class="token punctuation">(</span>inputs<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'pic1.jpg'</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">600</span><span class="token punctuation">)</span> <span class="token comment">#指定分辨率保存</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<p><img src="https://images2.imgbox.com/58/0f/RtHrM17B_o.jpg" alt="在这里插入图片描述"></p> 
<h3><a id="5_175"></a>5.建立模型</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F

<span class="token comment"># 找到可以用于训练的 GPU</span>
device <span class="token operator">=</span> <span class="token string">"cuda"</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">"cpu"</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Using {} device"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 定义模型</span>
<span class="token keyword">class</span> <span class="token class-name">LeNet</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 一般在__init__中定义网络需要的操作算子，比如卷积、全连接算子等等</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>LeNet<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># Conv2d的第一个参数是输入的channel数量，第二个是输出的channel数量，第三个是kernel size</span>
        self<span class="token punctuation">.</span>conv1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>conv2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
        <span class="token comment"># 由于上一层有16个channel输出，每个feature map大小为53*53，所以全连接层的输入是16*53*53</span>
        self<span class="token punctuation">.</span>fc1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">16</span><span class="token operator">*</span><span class="token number">53</span><span class="token operator">*</span><span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>fc2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">)</span>
        <span class="token comment"># 最终有10类，所以最后一个全连接层输出数量是10</span>
        self<span class="token punctuation">.</span>fc3 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>pool <span class="token operator">=</span> nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token comment"># forward这个函数定义了前向传播的运算，只需要像写普通的python算数运算那样就可以了</span>
    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>pool<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv2<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>pool<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token comment"># 下面这步把二维特征图变为一维，这样全连接层才能处理</span>
        x <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token operator">*</span><span class="token number">53</span><span class="token operator">*</span><span class="token number">53</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> F<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc2<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>fc3<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> x

model <span class="token operator">=</span> LeNet<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-python">Using cuda device
LeNet<span class="token punctuation">(</span>
  <span class="token punctuation">(</span>conv1<span class="token punctuation">)</span><span class="token punctuation">:</span> Conv2d<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span>conv2<span class="token punctuation">)</span><span class="token punctuation">:</span> Conv2d<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> kernel_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span>fc1<span class="token punctuation">)</span><span class="token punctuation">:</span> Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">44944</span><span class="token punctuation">,</span> out_features<span class="token operator">=</span><span class="token number">120</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span>fc2<span class="token punctuation">)</span><span class="token punctuation">:</span> Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">120</span><span class="token punctuation">,</span> out_features<span class="token operator">=</span><span class="token number">84</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span>fc3<span class="token punctuation">)</span><span class="token punctuation">:</span> Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">84</span><span class="token punctuation">,</span> out_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">:</span> MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> dilation<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> ceil_mode<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> 
<p>损失函数与优化器：</p> 
<pre><code class="prism language-python">loss_fn <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>
optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>SGD<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">1e-3</span><span class="token punctuation">)</span>
</code></pre> 
<p>定义训练函数</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">,</span> model<span class="token punctuation">,</span> loss_fn<span class="token punctuation">,</span> optimizer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    size <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">.</span>dataset<span class="token punctuation">)</span>
    model<span class="token punctuation">.</span>train<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> batch<span class="token punctuation">,</span> <span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">)</span><span class="token punctuation">:</span>
        X<span class="token punctuation">,</span> y <span class="token operator">=</span> X<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>

        <span class="token comment"># 计算预测误差</span>
        pred <span class="token operator">=</span> model<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
        loss <span class="token operator">=</span> loss_fn<span class="token punctuation">(</span>pred<span class="token punctuation">,</span> y<span class="token punctuation">)</span>

        <span class="token comment"># 反向传播</span>
        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> batch <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            loss<span class="token punctuation">,</span> current <span class="token operator">=</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> batch <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>loss<span class="token punctuation">:</span><span class="token format-spec">&gt;7f</span><span class="token punctuation">}</span></span><span class="token string">  [</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>current<span class="token punctuation">:</span><span class="token format-spec">&gt;5d</span><span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>size<span class="token punctuation">:</span><span class="token format-spec">&gt;5d</span><span class="token punctuation">}</span></span><span class="token string">]"</span></span><span class="token punctuation">)</span>
</code></pre> 
<p>定义测试函数</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">,</span> model<span class="token punctuation">,</span> loss_fn<span class="token punctuation">)</span><span class="token punctuation">:</span>
    size <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">.</span>dataset<span class="token punctuation">)</span>
    num_batches <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>dataloader<span class="token punctuation">)</span>
    model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    test_loss<span class="token punctuation">,</span> correct <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>
    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> X<span class="token punctuation">,</span> y <span class="token keyword">in</span> dataloader<span class="token punctuation">:</span>
            X<span class="token punctuation">,</span> y <span class="token operator">=</span> X<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>
            pred <span class="token operator">=</span> model<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
            test_loss <span class="token operator">+=</span> loss_fn<span class="token punctuation">(</span>pred<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
            correct <span class="token operator">+=</span> <span class="token punctuation">(</span>pred<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> y<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
    test_loss <span class="token operator">/=</span> num_batches
    correct <span class="token operator">/=</span> size
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Test Error: \n Accuracy: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">*</span>correct<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">&gt;0.1f</span><span class="token punctuation">}</span></span><span class="token string">%, Avg loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>test_loss<span class="token punctuation">:</span><span class="token format-spec">&gt;8f</span><span class="token punctuation">}</span></span><span class="token string"> \n"</span></span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="6_272"></a>6.进行训练</h3> 
<p>在单个训练循环中，模型对训练数据集进行预测（分批提供给它），并反向传播预测误差从而调整模型的参数</p> 
<pre><code class="prism language-python">epochs <span class="token operator">=</span> <span class="token number">20</span>
<span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Epoch </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">\n-------------------------------"</span></span><span class="token punctuation">)</span>
    train<span class="token punctuation">(</span>train_loader<span class="token punctuation">,</span> model<span class="token punctuation">,</span> loss_fn<span class="token punctuation">,</span> optimizer<span class="token punctuation">)</span>
    test<span class="token punctuation">(</span>test_loader<span class="token punctuation">,</span> model<span class="token punctuation">,</span> loss_fn<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Done!"</span><span class="token punctuation">)</span>
</code></pre> 
<p>输出：</p> 
<pre><code class="prism language-python">Epoch <span class="token number">1</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.697169</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.717117</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.692842</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.663078</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.687370</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.727401</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.715081</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.640342</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">71.1</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.662693</span> 

Epoch <span class="token number">2</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.603678</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.574420</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.609898</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.756877</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.612366</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.538443</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.406403</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.762628</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">73.8</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.603772</span> 

Epoch <span class="token number">3</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.532889</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.627735</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.573161</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.369012</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.450293</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.562393</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.436040</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.464255</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">63.2</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.625167</span> 

Epoch <span class="token number">4</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.561073</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.684834</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.419241</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.829945</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.486006</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.258347</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.322795</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.767529</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">72.6</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.572731</span> 

Epoch <span class="token number">5</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.542559</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.662963</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.488824</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.542599</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.584228</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.807718</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">1.087557</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.384040</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">65.2</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.610963</span> 

Epoch <span class="token number">6</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.372240</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.391429</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.355201</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.504742</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.190237</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.808446</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.189117</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.520030</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">78.8</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.481039</span> 

Epoch <span class="token number">7</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.849491</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.462627</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.917399</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">1.132419</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.308156</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.763916</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.360583</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.164551</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">79.0</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.454252</span> 

Epoch <span class="token number">8</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.255556</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.510223</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.271078</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.164843</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.536149</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.621327</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.644994</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.227701</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">82.3</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.397003</span> 

Epoch <span class="token number">9</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">1.072562</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.368804</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.297367</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.511167</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.244405</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.233891</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.174815</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.492107</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">81.8</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.405467</span> 

Epoch <span class="token number">10</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.676339</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.423010</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.472313</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.124012</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.132490</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.374766</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.202931</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.639156</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">86.4</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.352187</span> 

Epoch <span class="token number">11</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.164241</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.402599</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.075091</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.253864</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.227414</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.188128</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.437947</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.231940</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">86.7</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.354747</span> 

Epoch <span class="token number">12</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.411373</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.596428</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.419576</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.983684</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.713979</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.491828</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.196907</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.087960</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">86.4</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.325611</span> 

Epoch <span class="token number">13</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.368461</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.276991</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.715205</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.151266</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.474812</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.868296</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.097645</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.232329</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">89.3</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.286453</span> 

Epoch <span class="token number">14</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.297342</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.082402</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.270308</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.064577</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.175540</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.373381</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.661588</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.223183</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">86.6</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.303336</span> 

Epoch <span class="token number">15</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.435931</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.115896</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.582083</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.094237</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.191783</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.229429</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.657790</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.540002</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">89.7</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.263210</span> 

Epoch <span class="token number">16</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.054571</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.298561</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.043506</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.380746</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.167052</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.391230</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.057670</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.131060</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">88.3</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.279989</span> 

Epoch <span class="token number">17</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.064786</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.745590</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.211468</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.314401</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.139008</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.461783</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.654826</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.506236</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">90.7</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.226764</span> 

Epoch <span class="token number">18</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.643280</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.049473</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.027292</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.074732</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.054178</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.484333</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.103221</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.521000</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">90.4</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.238688</span> 

Epoch <span class="token number">19</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.045256</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.360988</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.541000</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.484565</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.060333</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.108621</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.137073</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.015121</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">91.0</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.225625</span> 

Epoch <span class="token number">20</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
loss<span class="token punctuation">:</span> <span class="token number">0.140982</span>  <span class="token punctuation">[</span>    <span class="token number">0</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.092246</span>  <span class="token punctuation">[</span>  <span class="token number">400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.072535</span>  <span class="token punctuation">[</span>  <span class="token number">800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.215292</span>  <span class="token punctuation">[</span> <span class="token number">1200</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.099996</span>  <span class="token punctuation">[</span> <span class="token number">1600</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.126051</span>  <span class="token punctuation">[</span> <span class="token number">2000</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.009734</span>  <span class="token punctuation">[</span> <span class="token number">2400</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
loss<span class="token punctuation">:</span> <span class="token number">0.050575</span>  <span class="token punctuation">[</span> <span class="token number">2800</span><span class="token operator">/</span> <span class="token number">2819</span><span class="token punctuation">]</span>
Test Error<span class="token punctuation">:</span> 
 Accuracy<span class="token punctuation">:</span> <span class="token number">89.7</span><span class="token operator">%</span><span class="token punctuation">,</span> Avg loss<span class="token punctuation">:</span> <span class="token number">0.244002</span> 

Done!
</code></pre> 
<p>保存完整模型</p> 
<pre><code class="prism language-python">torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span>model<span class="token punctuation">,</span> <span class="token string">"model.pth"</span><span class="token punctuation">)</span>
<span class="token comment"># 读取</span>
<span class="token comment"># model = torch.load("model.pth")</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/87784a6f83db6313452da4c0cc725925/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Xception实现动物识别（TensorFlow）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7d48f5e3eca357a76863af8c14b47e7e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">GAN生成手写数字（TensorFlow，Mnist数据集）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>