<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python操作mongodb数据库详解 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python操作mongodb数据库详解" />
<meta property="og:description" content="数据库的分类 数据库可以简单的分为 MySQL 和 NOSQL 两类。这里的 NOSQL 不是 NO SQL 的意思，他的意思是 Not Only MySQL
MySQL与NoSQL之间的区别：
1、MySQL是一个基于表格设计的关系数据库，而NoSQL本质上是非关系型的基于文档的设计。
2、MySQL数据库，覆盖了巨大的IT市场；具有固定市场的MySQL数据库包含一个庞大的社区。而NoSQL数据库是最新的到来，与MySQL相比，社区正在慢慢发展。
3、MySQL的严格模式限制并不容易扩展，而NoSQL可以通过动态模式特性轻松扩展。
4、MySQL中创建数据库之前需要详细的数据库模型，而在NoSQL数据库类型的情况下不需要详细的建模。
5、MySQL提供了大量的报告工具，可以帮助应用程序有效，而NoSQL数据库缺少用于分析和性能测试的报告工具。
6、MySQL是一个关系数据库，其设计约束灵活性较低；而NoSQL本质上是非关系型的，与MySQL相比，它提供了更灵活的设计。
7、MySQL中使用的标准语言是SQL；而NoSQL中缺乏标准的查询语言。
mongodb是什么 mongodb是一种数据库，它可以储存键值对类型的数据（json，字典）。目前流行的数据库是 MySQL ，但它并不利于初学者入门。我之前发过 Tinydb，Sqlite3 等数据库的讲解，都比较简单，那我这次来发一下mongodb数据库。
mongodb 的数据库、集合 一个数据库下可以有多个集合，集合里存储数据。集合可以理解为 SQL 数据库中的表。
使用 Python 操作 mongodb 安装 mongodb 终端运行
pip install pymongo 连接数据库 client = pymongo.MongoClient(host, port) host是地址，port 是端口。
切换数据库 第一种方法 db_name = client[&#39;db_name&#39;] 其中 db_name 是你的数据库名。
第二种方法 db_name = client.get_database(&#39;db_name&#39;) 其中 db_name 是你的数据库名。
第三种方法 db_name = client.db_name 切换集合 db_name." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/939347887d1f6e2b1e54f3f7d82cc566/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-06T19:01:11+08:00" />
<meta property="article:modified_time" content="2023-02-06T19:01:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python操作mongodb数据库详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_1"></a>数据库的分类</h2> 
<p>数据库可以简单的分为 <code>MySQL</code> 和 <code>NOSQL</code> 两类。这里的 <code>NOSQL</code> 不是 <code>NO SQL</code> 的意思，他的意思是 <code>Not Only MySQL</code></p> 
<p><strong>MySQL与NoSQL之间的区别：</strong></p> 
<p>1、MySQL是一个基于表格设计的关系数据库，而NoSQL本质上是非关系型的基于文档的设计。</p> 
<p>2、MySQL数据库，覆盖了巨大的IT市场；具有固定市场的MySQL数据库包含一个庞大的社区。而NoSQL数据库是最新的到来，与MySQL相比，社区正在慢慢发展。</p> 
<p>3、MySQL的严格模式限制并不容易扩展，而NoSQL可以通过动态模式特性轻松扩展。</p> 
<p>4、MySQL中创建数据库之前需要详细的数据库模型，而在NoSQL数据库类型的情况下不需要详细的建模。</p> 
<p>5、MySQL提供了大量的报告工具，可以帮助应用程序有效，而NoSQL数据库缺少用于分析和性能测试的报告工具。</p> 
<p>6、MySQL是一个关系数据库，其设计约束灵活性较低；而NoSQL本质上是非关系型的，与MySQL相比，它提供了更灵活的设计。</p> 
<p>7、MySQL中使用的标准语言是SQL；而NoSQL中缺乏标准的查询语言。</p> 
<h2><a id="mongodb_21"></a>mongodb是什么</h2> 
<p>mongodb是一种数据库，它可以储存键值对类型的数据（json，字典）。目前流行的数据库是 MySQL ，但它并不利于初学者入门。我之前发过 Tinydb，Sqlite3 等数据库的讲解，都比较简单，那我这次来发一下mongodb数据库。</p> 
<h2><a id="mongodb__25"></a>mongodb 的数据库、集合</h2> 
<p>一个数据库下可以有多个集合，集合里存储数据。集合可以理解为 SQL 数据库中的表。</p> 
<h2><a id="_Python__mongodb_29"></a>使用 Python 操作 mongodb</h2> 
<h3><a id="_mongodb_31"></a>安装 mongodb</h3> 
<p>终端运行</p> 
<pre><code class="prism language-python">pip install pymongo
</code></pre> 
<h3><a id="_39"></a>连接数据库</h3> 
<pre><code class="prism language-python">client <span class="token operator">=</span> pymongo<span class="token punctuation">.</span>MongoClient<span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span>
</code></pre> 
<p><code>host</code>是地址，<code>port</code> 是端口。</p> 
<h3><a id="_47"></a>切换数据库</h3> 
<h4><a id="_49"></a>第一种方法</h4> 
<pre><code class="prism language-python">db_name <span class="token operator">=</span> client<span class="token punctuation">[</span><span class="token string">'db_name'</span><span class="token punctuation">]</span>
</code></pre> 
<p>其中 <code>db_name</code> 是你的数据库名。</p> 
<h4><a id="_57"></a>第二种方法</h4> 
<pre><code class="prism language-python">db_name <span class="token operator">=</span> client<span class="token punctuation">.</span>get_database<span class="token punctuation">(</span><span class="token string">'db_name'</span><span class="token punctuation">)</span>
</code></pre> 
<p>其中 <code>db_name</code> 是你的数据库名。</p> 
<h4><a id="_65"></a>第三种方法</h4> 
<pre><code class="prism language-python">db_name <span class="token operator">=</span> client<span class="token punctuation">.</span>db_name
</code></pre> 
<h3><a id="_71"></a>切换集合</h3> 
<pre><code class="prism language-python">db_name<span class="token punctuation">.</span>test
</code></pre> 
<p>其中 <code>test</code> 是集合名，没有这个集合会自动创建。</p> 
<h3><a id="_79"></a>添加数据</h3> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">add_data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> db_name<span class="token punctuation">.</span>test<span class="token punctuation">.</span>insert_one<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>inserted_id<span class="token punctuation">)</span>
</code></pre> 
<p>其中 <code>test</code> 是集合名。</p> 
<p>添加数据用 <code>insert_one</code> 方法。</p> 
<p>其中，data 是要插入的数据，它的类型是键值对，即 Python 中的字典。这是一条合法的 data</p> 
<pre><code class="prism language-python"><span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"XiaoMing"</span><span class="token punctuation">,</span><span class="token string">"password"</span><span class="token punctuation">:</span><span class="token number">123456</span><span class="token punctuation">}</span>
</code></pre> 
<p>特殊的，如果要插入在指定 id ，可以这样写</p> 
<pre><code class="prism language-python">result <span class="token operator">=</span> db_name<span class="token punctuation">.</span>test<span class="token punctuation">.</span>insert_one<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>_id<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"xxx"</span><span class="token punctuation">:</span><span class="token string">"xxx"</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>也可以插入多个，只需要把 data 变成</p> 
<pre><code class="prism language-python"><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"XiaoMing"</span><span class="token punctuation">,</span><span class="token string">"password"</span><span class="token punctuation">:</span><span class="token number">123456</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"XiaoHong"</span><span class="token punctuation">,</span><span class="token string">"password"</span><span class="token punctuation">:</span><span class="token number">123456</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre> 
<h3><a id="_109"></a>删除数据</h3> 
<pre><code class="prism language-python">db<span class="token punctuation">.</span>test<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>查询表达式<span class="token punctuation">,</span> isJustOne<span class="token punctuation">)</span>
</code></pre> 
<p>查询表达式有这些</p> 
<hr> 
<table><thead><tr><th>语法</th><th>操作</th><th>格式</th></tr></thead><tbody><tr><td>$eq</td><td>等于</td><td>{:}</td></tr><tr><td>$lt</td><td>小于</td><td>{:{$lt:}}</td></tr><tr><td>$lte</td><td>小于或等于</td><td>{:{$lte:}}</td></tr><tr><td>$gt</td><td>大于</td><td>{:{$gt:}}</td></tr><tr><td>$gte</td><td>大于或等于</td><td>{:{$gte:}}</td></tr><tr><td>$ne</td><td>不等于</td><td>{:{$ne:}}</td></tr><tr><td>$or</td><td>或</td><td>{$or:[{},{}]}</td></tr><tr><td>$in</td><td>在范围内</td><td>{age:{$in:[val1,val2]}}</td></tr><tr><td>$nin</td><td>不在范围内</td><td>{age:{$nin:[val1,val2]}}</td></tr></tbody></table> 
<p>例如，删除 test 集合中 name 是 XiaoMing 的所有数据</p> 
<pre><code class="prism language-python">db<span class="token punctuation">.</span>test<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span><span class="token string">"XiaoMing"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_137"></a>修改数据</h3> 
<p><code>db.collection.update(查询表达式,新值,选项)</code> 选项: {upsert : true/false, multi : ture/false}</p> 
<ul><li>upsert：默认为 false , 作用：无相应记录是否insert,与mysql中的replace同</li><li>multi：默认为 false , 作用：是否作用于多条</li></ul> 
<pre><code class="prism language-python"><span class="token comment">#替换文档，将name为zhangsan的第一个文档替换为{"name":"lisi","age":10}</span>
db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"zhangsan"</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"lisi"</span><span class="token punctuation">,</span><span class="token string">"age"</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
$<span class="token builtin">set</span>修改器，指定要更新的key，key不存在则创建，存在则更新。
<span class="token comment">#将name为zhangsan的所有文档替换为{"name":"lisi","no":'100'}</span>
db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"zhangsan"</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span>$<span class="token builtin">set</span><span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"lisi"</span><span class="token punctuation">,</span><span class="token string">"no"</span><span class="token punctuation">:</span><span class="token string">'100'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span>multi<span class="token punctuation">:</span>true<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="_152"></a>查找数据</h3> 
<pre><code class="prism language-python"><span class="token comment">#查找所有数据</span>
db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 查找到所有匹配数据</span>
db<span class="token punctuation">.</span>集合名<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>条件文档<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># 只返回匹配的第一个数据</span>
db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>age<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>$gt<span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">#查询年龄大于16的记录</span>
db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>$<span class="token keyword">or</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>age<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>$gt<span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span>name<span class="token punctuation">:</span><span class="token string">"xiaoming"</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#查询年龄大于18或者名字是xiaoming的记录</span>
<span class="token comment">#使用$where后面写一个函数，返回满足条件的数据</span>
db<span class="token punctuation">.</span>stu<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>$where<span class="token punctuation">:</span>function<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token keyword">return</span> this<span class="token punctuation">.</span>age<span class="token operator">&gt;</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">#用于读取指定数量的文档</span>
db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>limit<span class="token punctuation">(</span>NUMBER<span class="token punctuation">)</span>
<span class="token comment">#对查询结果排序（参数1升序，参数-1降序）</span>
db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>字段<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 
<span class="token comment">#统计结果中的文档数</span>
db<span class="token punctuation">.</span>集合名称<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>条件<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="_172"></a>最后</h2> 
<p>请大家持续关注，我会发表更多好文章！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/555aae7a85a3b7ee3e54c3087f6f28fa/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android 键盘监听 键盘展开/收起监听</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c7992e85fac06e9570cb97fe1993aae8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">信息学奥赛一本通 1389：亲戚</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>