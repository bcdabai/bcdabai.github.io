<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PHP 使用Laravel框架架构设计 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PHP 使用Laravel框架架构设计" />
<meta property="og:description" content=" 学习视频：https://www.youtube.com/watch?v=pzY0FBafXd0 (需翻墙)
Laravel简单架构： 简单的小项目可能会把数据库查询，业务逻辑，数据传给View几乎所有操作都放在Controller，如何项目后期需求变大，最后Controller会变得很臃肿，难懂，不易维护（同样，有些会把所有增删改查，功能类写在Model，Controller再从Model一个个的拿，导致Model很乱，Model有关联表的时候可能会引起一些不必要的数据库查询）
我自己的理解：用美宜佳卖商品给客人来理解，主要Controller是某个加盟商美宜佳门店，View是客人，Model是商品制造工厂（理解有些粗糙）
Repository（商品仓库）: 跟Eloquent/DB操作相关的，例如增删改查，直接和数据库打交道的基础操作抽出来放在Repository中，repository中文是仓库，我的理解就是我们要从Model拿数据，先放在仓库repository中，统一由仓库管理分配，发挥仓库的职责
Service (总部服务平台): 商业逻辑，不是简单的查询数据，而是特定的任务，例如判断用户是否是会员，设置用户权限等等，这些操作建议放在Service，之后Controller再调用它
个人理解：所以在Controller和Model/Eloquent中间垫两层，如果Repository理解为商品仓库的话，我的理解Service是类似总部内部的服务平台，加盟商Controller需要拿商品给客人View，不能直接去食品工厂Model拿，先通过仓库repository，然后总部服务平台Service进行打包啊，整理啊，发车啊（各种任务），最后再给到加盟商Controller手里
Presenter（充值业务）: 一些比较固定，可以单独调用的，可以用Presenter抽出来，不需要让Model去做，下次修改也单独修改Presenter就行了，
例如时间戳转成Y-m-d H:i:s格式，可以单独用Presenter处理后用@inject插入到前端模板，而不是把转化过程写在模板上面
个人理解：所以在Controller和View中间可以加一层Presenter，我的理解有点类似：美宜佳商户(Controller)可以给客人(View)充公交卡，这种小事不需要劳费工厂(Model) Transformer（快餐小吃人工筛选）: 转换器，例如在仓库repository中有一个获取所有用户信息的查询操作：$this-&gt;user-&gt;all();
但有些地方我们不需要用到那么多个字段，我只想有name和email字段，难道我要去改all()里面的参数，变成$this-&gt;user-&gt;all([&#39;name&#39;,&#39;email&#39;])?
这样另外的地方又要全部字段，这不就冲突了？这时候Transformer就有用了，其实原理是对$this-&gt;user-&gt;all()获得的数据进行筛选后再输出，加了个筛选器。
之后要修改结果字段就直接在transform修改即可，当然还可以额外添加需要的字段：array_set() 个人理解：这一块我的理解就是有些客人需要点一些快餐，例如美宜佳里面的车仔面呀，烤肠呀，在卖出商品的时候需要根据客人的需求对小吃进行筛选再卖出去，不可能客人指点要一个烤肠，你把店里全部小吃拿给他，让他自个去筛选，中间卖出去的时候需要Transformer进行筛选再给出商品 Formatter（包装）: 主要用于保持API返回格式的一致（使用方法和transform类似）：
个人理解：Formatter这一块我的理解就是商品包装，客人买东西，买小吃，你需要对商品先进行包装，当然这个包装肯定需要保持一致 " />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/c0e8794831022334b398a34439aff74f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-11-14T18:02:29+08:00" />
<meta property="article:modified_time" content="2018-11-14T18:02:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PHP 使用Laravel框架架构设计</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>学习视频：<a href="https://www.youtube.com/watch?v=pzY0FBafXd0" rel="nofollow">https://www.youtube.com/watch?v=pzY0FBafXd0</a> (需翻墙)</p> 
<p></p> 
<div></div> 
<h3>Laravel简单架构：</h3> 
<p><a href="https://image-static.segmentfault.com/354/330/3543304019-5b90f9f1b87eb_articlex" rel="nofollow" class="fluidbox fluidbox__instance-1 fluidbox--initialized fluidbox--closed fluidbox--ready"></a></p> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/e6/6d/Oh3FVCVn_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<p></p> 
<p>简单的小项目可能会把数据库查询，业务逻辑，数据传给View几乎所有操作都放在Controller，如何项目后期需求变大，最后Controller会变得很臃肿，难懂，不易维护（同样，有些会把所有增删改查，功能类写在Model，Controller再从Model一个个的拿，导致Model很乱，Model有关联表的时候可能会引起一些不必要的数据库查询）</p> 
<p>我自己的理解：用美宜佳卖商品给客人来理解，主要Controller是某个加盟商美宜佳门店，View是客人，Model是商品制造工厂（理解有些粗糙）</p> 
<div></div> 
<h3>Repository（商品仓库）:</h3> 
<p>跟Eloquent/DB操作相关的，例如增删改查，直接和数据库打交道的基础操作抽出来放在Repository中，repository中文是仓库，我的理解就是我们要从Model拿数据，先放在仓库repository中，统一由仓库管理分配，发挥仓库的职责<br><a href="https://image-static.segmentfault.com/182/683/1826836528-5b90fabebe585_articlex" rel="nofollow" class="fluidbox fluidbox__instance-2 fluidbox--initialized fluidbox--closed fluidbox--ready"></a></p> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/b6/b7/LkRvLJpp_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<br> 
<a href="https://image-static.segmentfault.com/115/199/1151993428-5b90fad839146_articlex" rel="nofollow" class="fluidbox fluidbox__instance-3 fluidbox--initialized fluidbox--closed fluidbox--ready"></a> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/ab/ad/9SxSmIId_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<p></p> 
<div></div> 
<h3>Service (总部服务平台):</h3> 
<p>商业逻辑，不是简单的查询数据，而是特定的任务，例如判断用户是否是会员，设置用户权限等等，这些操作建议放在Service，之后Controller再调用它<br><a href="https://image-static.segmentfault.com/592/143/592143024-5b90fb1ea868e_articlex" rel="nofollow" class="fluidbox fluidbox__instance-4 fluidbox--initialized fluidbox--closed fluidbox--ready"></a></p> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/70/e8/cOwnbmfE_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<br> 
<a href="https://image-static.segmentfault.com/155/739/1557397158-5b90fb285edbf_articlex" rel="nofollow" class="fluidbox fluidbox__instance-5 fluidbox--initialized fluidbox--closed fluidbox--ready"></a> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/b3/58/0SqcLhea_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<p></p> 
<p><strong>个人理解：</strong>所以在Controller和Model/Eloquent中间垫两层，如果Repository理解为商品仓库的话，我的理解Service是类似总部内部的服务平台，加盟商Controller需要拿商品给客人View，不能直接去食品工厂Model拿，先通过仓库repository，然后总部服务平台Service进行打包啊，整理啊，发车啊（各种任务），最后再给到加盟商Controller手里<br><a href="https://image-static.segmentfault.com/295/580/295580313-5b90fb0d82315_articlex" rel="nofollow" class="fluidbox fluidbox__instance-6 fluidbox--initialized fluidbox--closed fluidbox--ready"></a></p> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/20/de/rtNUV9Ut_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<p></p> 
<div></div> 
<h3>Presenter（充值业务）:</h3> 
<p>一些比较固定，可以单独调用的，可以用Presenter抽出来，不需要让Model去做，下次修改也单独修改Presenter就行了，<br> 例如时间戳转成Y-m-d H:i:s格式，可以单独用Presenter处理后用@inject插入到前端模板，而不是把转化过程写在模板上面<br><a href="https://image-static.segmentfault.com/710/831/710831743-5b90fb4eeb5ce_articlex" rel="nofollow" class="fluidbox fluidbox__instance-7 fluidbox--initialized fluidbox--closed fluidbox--ready"></a></p> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/f7/25/MK7evcYe_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<br> 
<a href="https://image-static.segmentfault.com/256/257/2562576577-5b90fb61cbad4_articlex" rel="nofollow" class="fluidbox fluidbox__instance-8 fluidbox--initialized fluidbox--closed fluidbox--ready"></a> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/f6/75/p4loAbHJ_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<br> 
<a href="https://image-static.segmentfault.com/309/292/3092928320-5b90fb6f4b6f1_articlex" rel="nofollow" class="fluidbox fluidbox__instance-9 fluidbox--initialized fluidbox--closed fluidbox--ready"></a> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/69/d8/mTYc90eg_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<br> 
<strong>个人理解：</strong>所以在Controller和View中间可以加一层Presenter，我的理解有点类似：美宜佳商户(Controller)可以给客人(View)充公交卡，这种小事不需要劳费工厂(Model) 
<br> 
<a href="https://image-static.segmentfault.com/101/500/1015005224-5b90fb84bfc97_articlex" rel="nofollow" class="fluidbox fluidbox__instance-10 fluidbox--initialized fluidbox--closed fluidbox--ready"></a> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/17/f3/oPe2CPpb_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<p></p> 
<div></div> 
<h3>Transformer（快餐小吃人工筛选）:</h3> 
<p>转换器，例如在仓库repository中有一个获取所有用户信息的查询操作：$this-&gt;user-&gt;all();<br> 但有些地方我们不需要用到那么多个字段，我只想有name和email字段，难道我要去改all()里面的参数，变成$this-&gt;user-&gt;all(['name','email'])?<br> 这样另外的地方又要全部字段，这不就冲突了？这时候Transformer就有用了，其实原理是对$this-&gt;user-&gt;all()获得的数据进行筛选后再输出，加了个筛选器。<br><a href="https://image-static.segmentfault.com/118/447/1184473386-5b90fb994f382_articlex" rel="nofollow" class="fluidbox fluidbox__instance-11 fluidbox--initialized fluidbox--closed fluidbox--ready"></a></p> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/57/ca/KqoTyYhp_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<br> 
<a href="https://image-static.segmentfault.com/337/359/3373598994-5b90fbad466dd_articlex" rel="nofollow" class="fluidbox fluidbox__instance-12 fluidbox--initialized fluidbox--closed fluidbox--ready"></a> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/5a/b3/X5u7USMx_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<br> 
<a href="https://image-static.segmentfault.com/192/588/1925884062-5b90fbc15db6e_articlex" rel="nofollow" class="fluidbox fluidbox__instance-13 fluidbox--initialized fluidbox--closed fluidbox--ready"></a> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/c4/65/ruEwN5pm_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<br> 之后要修改结果字段就直接在transform修改即可，当然还可以额外添加需要的字段：array_set() 
<br> 
<a href="https://image-static.segmentfault.com/344/587/3445871937-5b90fc29f1e19_articlex" rel="nofollow" class="fluidbox fluidbox__instance-14 fluidbox--initialized fluidbox--closed fluidbox--ready"></a> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/1c/c8/KvUzqzx9_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<br> 
<strong>个人理解：</strong>这一块我的理解就是有些客人需要点一些快餐，例如美宜佳里面的车仔面呀，烤肠呀，在卖出商品的时候需要根据客人的需求对小吃进行筛选再卖出去，不可能客人指点要一个烤肠，你把店里全部小吃拿给他，让他自个去筛选，中间卖出去的时候需要Transformer进行筛选再给出商品 
<br> 
<a href="https://image-static.segmentfault.com/640/163/640163195-5b90fc3dcd04d_articlex" rel="nofollow" class="fluidbox fluidbox__instance-15 fluidbox--initialized fluidbox--closed fluidbox--ready"></a> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/c7/c9/BgSQkSeX_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<p></p> 
<div></div> 
<h3>Formatter（包装）:</h3> 
<p>主要用于保持API返回格式的一致（使用方法和transform类似）：<br><a href="https://image-static.segmentfault.com/296/081/2960819929-5b90fc60bc1a6_articlex" rel="nofollow" class="fluidbox fluidbox__instance-16 fluidbox--initialized fluidbox--closed fluidbox--ready"></a></p> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/87/73/YzgC0GZt_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<br> 
<a href="https://image-static.segmentfault.com/115/776/1157764437-5b90fc91c2cb4_articlex" rel="nofollow" class="fluidbox fluidbox__instance-17 fluidbox--initialized fluidbox--closed fluidbox--ready"></a> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/53/d3/3HYs8W7j_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<br> 
<a href="https://image-static.segmentfault.com/310/382/3103826051-5b90fd995ba08_articlex" rel="nofollow" class="fluidbox fluidbox__instance-18 fluidbox--initialized fluidbox--closed fluidbox--ready"></a> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/0a/e5/c1HBz06D_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<br> 个人理解：Formatter这一块我的理解就是商品包装，客人买东西，买小吃，你需要对商品先进行包装，当然这个包装肯定需要保持一致 
<br> 
<a href="https://image-static.segmentfault.com/170/055/1700552165-5b90fdab2371e_articlex" rel="nofollow" class="fluidbox fluidbox__instance-19 fluidbox--initialized fluidbox--closed fluidbox--ready"></a> 
<div class="fluidbox__wrap"> 
 <img src="https://images2.imgbox.com/49/92/Uxqgerie_o.png" alt="avarar" class="fluidbox__thumb"> 
 <div class="fluidbox__ghost"></div> 
</div> 
<br> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/27e15feea999437810a8ab62e52c919d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">css实现背景backgroup渐变效果,兼容各个浏览器(直接生成)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9a7b301b5288be22951db822da7a0e73/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SpringBoot(二)：集成Mybatis</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>