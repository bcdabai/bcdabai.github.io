<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>搭建Elasticsearch 5.4 集群 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="搭建Elasticsearch 5.4 集群" />
<meta property="og:description" content="1、集群角色 es集群中的节点主要可以分为master nodes、data nodes和client node。在配置文件中使用Zen发现(Zen discovery)机制来管理不同节点。Zen发现是ES自带的默认发现机制，使用单播发现其它节点。只要启动一个新的ES节点并设置和集群相同的名称，这个节点就会被加入到集群中。
Elasticsearch集群中节点一般有三种角色:master node、data node和client node。
（1）master node。master节点主要用于元数据(metadata)的处理，比如索引的新增、删除、分片分配等。
（2）data node。data节点上保存了数据分片。它负责数据相关操作，比如分片的 CRUD，以及搜索和整合操作。这些操作都比较消耗 CPU、内存和 I/O 资源；
（3）client node。client节点起到路由请求的作用，实际上可以看做负载均衡器。( 对于没有很多请求的业务，client node可以不加，master和data足矣)。
2、多机集群配置 ELasticsearch 5.4要求JDK版本最低为1.8。现有三台服务器分别安装一个es节点，这三个节点组成一个es集群。因为是小集群，因此设置这三个节点都可作为master节点和data节点。服务器的ip分别为192.168.1.111、192.168.1.112和192.168.1.113。集群节点配置如下所示。
（1）ip为192.168.1.111的节点配置如下。
#集群名 cluster.name: my-application #节点名 node.name: node-111 #节点ip network.host: 192.168.1.111 #设置对外服务的http端口，默认为9200 http.port: 9200 #设置节点之间交互的tcp端口，默认是9300 transport.tcp.port: 9300 #是否允许跨域REST请求 http.cors.enabled: true #允许 REST 请求来自何处 http.cors.allow-origin: &#34;*&#34; #节点角色设置 node.master: true node.data: true #有成为主节点资格的节点列表 discovery.zen.ping.unicast.hosts: [&#34;192.168.1.111:9300&#34;,&#34;192.168.1.112:9300&#34;,&#34;192.168.1.113:9300&#34;] #集群中一直正常运行的，有成为master节点资格的最少节点数（默认为1） # (total number of master-eligible nodes / 2 &#43; 1) discovery.zen.minimum_master_nodes: 2 （2）ip为192." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/b180ac25866bd98d0441e1adc00e0161/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-07-06T11:27:37+08:00" />
<meta property="article:modified_time" content="2017-07-06T11:27:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">搭建Elasticsearch 5.4 集群</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="margin:.8em 0px;padding:0px;line-height:1.3em;font-family:'microsoft yahei';"></h2> 
<h2><span style="font-size:14px;color:#ff0000;font-weight:normal;">1、集群角色</span></h2> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#3F3F3F;">    es</span><span style="color:#3F3F3F;">集群中的节点主要可以分为</span><span style="color:#3F3F3F;">master nodes</span><span style="color:#3F3F3F;">、</span><span style="color:#3F3F3F;">data nodes</span><span style="color:#3F3F3F;">和</span><span style="color:#3F3F3F;">client node</span><span style="color:#3F3F3F;">。在配置文件中使用</span><span style="color:#3F3F3F;">Zen</span><span style="color:#3F3F3F;">发现</span><span style="color:#3F3F3F;">(Zen discovery)</span><span style="color:#3F3F3F;">机制来管理不同节点。</span><span style="color:#3F3F3F;">Zen</span><span style="color:#3F3F3F;">发现是</span><span style="color:#3F3F3F;">ES</span><span style="color:#3F3F3F;">自带的默认发现机制，使用单播发现其它节点。只要启动一个新的</span><span style="color:#3F3F3F;">ES</span><span style="color:#3F3F3F;">节点并设置和集群相同的名称，这个节点就会被加入到集群中。</span></span></p> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#3F3F3F;">    Elasticsearch</span><span style="color:#3F3F3F;">集群中节点一般有三种角色</span><span style="color:#3F3F3F;">:master node</span><span style="color:#3F3F3F;">、</span><span style="color:#3F3F3F;">data node</span><span style="color:#3F3F3F;">和</span><span style="color:#3F3F3F;">client node</span><span style="color:#3F3F3F;">。</span></span></p> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#3F3F3F;">    （</span><span style="color:#3F3F3F;">1</span><span style="color:#3F3F3F;">）</span><span style="color:#3F3F3F;">master node</span><span style="color:#3F3F3F;">。</span><span style="color:#3F3F3F;">master</span><span style="color:#3F3F3F;">节点主要用于元数据</span><span style="color:#3F3F3F;">(metadata)</span><span style="color:#3F3F3F;">的处理，比如索引的新增、删除、分片分配等。</span></span></p> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#3F3F3F;">    （</span><span style="color:#3F3F3F;">2</span><span style="color:#3F3F3F;">）</span><span style="color:#3F3F3F;">data node</span><span style="color:#3F3F3F;">。</span><span style="color:#3F3F3F;">data</span><span style="color:#3F3F3F;">节点上保存了数据分片。它负责数据相关操作，比如分片的</span><span style="color:#3F3F3F;"> CRUD</span><span style="color:#3F3F3F;">，以及搜索和整合操作。这些操作都比较消耗</span><span style="color:#3F3F3F;"> CPU</span><span style="color:#3F3F3F;">、内存和</span><span style="color:#3F3F3F;"> I/O </span><span style="color:#3F3F3F;">资源；</span></span></p> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#3F3F3F;">    （</span><span style="color:#3F3F3F;">3</span><span style="color:#3F3F3F;">）</span><span style="color:#3F3F3F;">client  </span>node<span style="color:#3F3F3F;">。</span><span style="color:#3F3F3F;">client</span><span style="color:#3F3F3F;">节点起到路由请求的作用，实际上可以看做负载均衡器。</span><span style="color:#3F3F3F;">( </span><span style="color:#3F3F3F;">对于没有很多请求的业务，</span><span style="color:#3F3F3F;">client node</span><span style="color:#3F3F3F;">可以不加，</span><span style="color:#3F3F3F;">master</span><span style="color:#3F3F3F;">和</span><span style="color:#3F3F3F;">data</span><span style="color:#3F3F3F;">足矣</span><span style="color:#3F3F3F;">)</span><span style="color:#3F3F3F;">。</span></span></p> 
<h2 style="font-weight:100;background:#FFFFFF;"><span style="color:#ff0000;"><span style="font-size:14px;">2、</span><span style="font-size:14px;">多机集群配置</span></span></h2> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;">    ELasticsearch 5.4要求JDK版本最低为1.8。<span style="color:#3F3F3F;">现有三台服务器分别安装一个</span><span style="color:#3F3F3F;">es</span><span style="color:#3F3F3F;">节点，这三个节点组成一个</span><span style="color:#3F3F3F;">es</span><span style="color:#3F3F3F;">集群。因为是小集群，因此设置这三个节点都可作为</span><span style="color:#3F3F3F;">master</span><span style="color:#3F3F3F;">节点和</span><span style="color:#3F3F3F;">data</span><span style="color:#3F3F3F;">节点。服务器的</span><span style="color:#3F3F3F;">ip</span><span style="color:#3F3F3F;">分别为</span><span style="color:#3F3F3F;">192.168.1.111</span><span style="color:#3F3F3F;">、</span><span style="color:#3F3F3F;">192.168.1.112</span><span style="color:#3F3F3F;">和</span><span style="color:#3F3F3F;">192.168.1.113</span><span style="color:#3F3F3F;">。集群节点配置如下所示。</span></span></p> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#3F3F3F;">    （</span><span style="color:#3F3F3F;">1</span><span style="color:#3F3F3F;">）</span><span style="color:#3F3F3F;">ip</span><span style="color:#3F3F3F;">为</span><span style="color:#3F3F3F;">192.168.1.111</span><span style="color:#3F3F3F;">的节点配置如下。</span></span></p> 
<pre><code class="language-html">#集群名
cluster.name: my-application
#节点名
node.name: node-111

#节点ip
network.host: 192.168.1.111
#设置对外服务的http端口，默认为9200
http.port: 9200
#设置节点之间交互的tcp端口，默认是9300
transport.tcp.port: 9300

#是否允许跨域REST请求
http.cors.enabled: true
#允许 REST 请求来自何处
http.cors.allow-origin: "*"

#节点角色设置
node.master: true
node.data: true

#有成为主节点资格的节点列表
discovery.zen.ping.unicast.hosts: ["192.168.1.111:9300","192.168.1.112:9300","192.168.1.113:9300"]
#集群中一直正常运行的，有成为master节点资格的最少节点数（默认为1）
# (total number of master-eligible nodes / 2 + 1)
discovery.zen.minimum_master_nodes: 2</code></pre> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#3F3F3F;">    （</span><span style="color:#3F3F3F;">2</span><span style="color:#3F3F3F;">）</span><span style="color:#3F3F3F;">ip</span><span style="color:#3F3F3F;">为</span><span style="color:#3F3F3F;">192.168.1.112</span><span style="color:#3F3F3F;">的节点配置如下。</span></span></p> 
<pre><code class="language-html">#集群名
cluster.name: my-application
#节点名
node.name: node-112

#节点ip
network.host: 192.168.1.112
#设置对外服务的http端口，默认为9200
http.port: 9200
#设置节点之间交互的tcp端口，默认是9300
transport.tcp.port: 9300

#是否允许跨域REST请求
http.cors.enabled: true
#允许 REST 请求来自何处
http.cors.allow-origin: "*"

#节点角色设置
node.master: true
node.data: true

#有成为主节点资格的节点列表
discovery.zen.ping.unicast.hosts: ["192.168.1.111:9300","192.168.1.112:9300","192.168.1.113:9300"]
#集群中一直正常运行的，有成为master节点资格的最少节点数（默认为1）
# (total number of master-eligible nodes / 2 + 1)
discovery.zen.minimum_master_nodes: 2</code></pre> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#3F3F3F;">    （</span><span style="color:#3F3F3F;">3</span><span style="color:#3F3F3F;">）</span><span style="color:#3F3F3F;">ip</span><span style="color:#3F3F3F;">为</span><span style="color:#3F3F3F;">192.168.1.113</span><span style="color:#3F3F3F;">的节点配置如下。</span></span></p> 
<pre><code class="language-html">#集群名
cluster.name: my-application
#节点名
node.name: node-113

#节点ip
network.host: 192.168.1.113
#设置对外服务的http端口，默认为9200
http.port: 9200
#设置节点之间交互的tcp端口，默认是9300
transport.tcp.port: 9300

#是否允许跨域REST请求
http.cors.enabled: true
#允许 REST 请求来自何处
http.cors.allow-origin: "*"

#节点角色设置
node.master: true
node.data: true

#有成为主节点资格的节点列表
discovery.zen.ping.unicast.hosts: ["192.168.1.111:9300","192.168.1.112:9300","192.168.1.113:9300"]
#集群中一直正常运行的，有成为master节点资格的最少节点数（默认为1）
# (total number of master-eligible nodes / 2 + 1)
discovery.zen.minimum_master_nodes: 2</code></pre> 
<h2 style="font-weight:100;background:#FFFFFF;"><span style="color:#ff0000;"><span style="font-size:14px;">3、</span><span style="font-size:14px;">单机集群配置</span></span></h2> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#3F3F3F;">    如果想要在一台机器上创建</span><span style="color:#3F3F3F;">es</span><span style="color:#3F3F3F;">集群，步骤如下：</span></span></p> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#3F3F3F;">    （</span><span style="color:#3F3F3F;">1</span><span style="color:#3F3F3F;">）复制一份</span><span style="color:#3F3F3F;">ELasticsearch</span><span style="color:#3F3F3F;">的安装包；</span></span></p> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#3F3F3F;">    </span>（2）修改es配置文件<br></span></p> 
<p><span style="font-size:14px;">        修改es对外服务的http端口，比如一个是9200，一个是9201，一个是9203；</span></p> 
<p><span style="font-size:14px;">        修改es节点之间交互的tcp端口，比如一个是9300，一个是9301，一个是9303；</span></p> 
<span style="font-size:14px;">        修改其他对应信息。<span style="color:#3F3F3F;"></span></span> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#3F3F3F;">    （</span><span style="color:#3F3F3F;">3</span><span style="color:#3F3F3F;">）删除</span><span style="color:#3F3F3F;">data</span><span style="color:#3F3F3F;">目录下的数据（如果是新解压的安装包就不必了）。</span></span></p> 
<h2 style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#FF0000;">4</span><span style="color:#FF0000;">、参考文献</span></span></h2> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#3F3F3F;">（</span><span style="color:#3F3F3F;">1</span><span style="color:#3F3F3F;">）<a href="https://blog.csdn.net/napoay/article/details/52202877">点击打开链接</a></span></span></p> 
<p align="left" style="font-weight:100;background:#FFFFFF;"><span style="font-size:14px;"><span style="color:#3F3F3F;">（</span><span style="color:#3F3F3F;">2</span><span style="color:#3F3F3F;">）<a href="http://www.elastic.co/guide/en/elasticsearch/reference/current/modules-node.html" rel="nofollow">点击打开链接</a></span></span></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e5118acdd7de1eb2c7a0ead54b9838d5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">STM32串口IAP实验中的地址问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d65b19ed474e09b9e1f9e0749bd87938/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vim 配置 clang-format</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>