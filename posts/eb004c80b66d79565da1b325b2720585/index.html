<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SpringMVC  实现简单的文件上传和下载 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SpringMVC  实现简单的文件上传和下载" />
<meta property="og:description" content="使用SpringMVC 实现文件的上传和下载 步骤一： 导包（在原有的spring mvc 包 上多加这俩个） 使用maven jar包的依赖(需要其他版本自行下载) &lt;!-- https://mvnrepository.com/artifact/commons-fileupload/commons-fileupload --&gt; &lt;dependency&gt; &lt;groupId&gt;commons-fileupload&lt;/groupId&gt; &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt; &lt;version&gt;1.3.1&lt;/version&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/commons-io/commons-io --&gt; &lt;dependency&gt; &lt;groupId&gt;commons-io&lt;/groupId&gt; &lt;artifactId&gt;commons-io&lt;/artifactId&gt; &lt;version&gt;2.4&lt;/version&gt; &lt;/dependency&gt; 步骤二：写控制器 @Controller public class UploadController { //这里是日志文件 private static final Logger log = Logger.getLogger(UploadController.class); @RequestMapping(value=&#34;/uploadTmp&#34;, method=RequestMethod.POST) public String Upload(@RequestParam(&#34;file&#34;)MultipartFile file,HttpServletRequest request) throws IOException { log.debug(&#34;上传的文件名：&#34;&#43;file.getOriginalFilename()); log.debug(&#34;文件类型&#34;&#43;file.getContentType()); log.debug(&#34;文件大小：&#34;&#43;file.getSize()); request.setAttribute(&#34;fileName&#34;,file.getOriginalFilename()); // 如果没选择文件 则发生异常 跳转至异常页面 if (file.getSize()&gt;0) { file.transferTo(new File(&#34;D:\\UpLoad&#34;,file.getOriginalFilename())); return &#34;FileUploadAndDownload&#34;; }else { return &#34;error&#34;; } } } 步骤三：编写配置文件 springmvc-xml &lt;!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/eb004c80b66d79565da1b325b2720585/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-09-08T16:49:51+08:00" />
<meta property="article:modified_time" content="2018-09-08T16:49:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SpringMVC  实现简单的文件上传和下载</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2 id="使用springmvc-实现文件的上传和下载">使用SpringMVC 实现文件的上传和下载</h2> 
<h6 id="步骤一-导包在原有的spring-mvc-包-上多加这俩个">步骤一： 导包（在原有的spring mvc 包 上多加这俩个）</h6> 
<p><img src="https://images2.imgbox.com/fd/0f/TjhinfZ5_o.png" alt="这里写图片描述" title=""></p> 
<h5 id="使用maven-jar包的依赖需要其他版本自行下载">使用maven jar包的依赖(需要其他版本自行下载)</h5> 
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/commons-fileupload/commons-fileupload --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>commons-fileupload<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>commons-fileupload<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.3.1<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>

<span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/commons-io/commons-io --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>commons-io<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>commons-io<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>2.4<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
</code></pre> 
<h5 id="步骤二写控制器">步骤二：写控制器</h5> 
<pre class="prettyprint"><code class=" hljs java"><span class="hljs-annotation">@Controller</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UploadController</span> {<!-- --></span>

    <span class="hljs-comment">//这里是日志文件</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Logger log = Logger.getLogger(UploadController.class);

    <span class="hljs-annotation">@RequestMapping</span>(value=<span class="hljs-string">"/uploadTmp"</span>, method=RequestMethod.POST)
    <span class="hljs-keyword">public</span> String <span class="hljs-title">Upload</span>(@<span class="hljs-title">RequestParam</span>("file")MultipartFile file,HttpServletRequest request) <span class="hljs-keyword">throws</span> IOException {
        log.debug(<span class="hljs-string">"上传的文件名："</span>+file.getOriginalFilename());
        log.debug(<span class="hljs-string">"文件类型"</span>+file.getContentType());
        log.debug(<span class="hljs-string">"文件大小："</span>+file.getSize());

        request.setAttribute(<span class="hljs-string">"fileName"</span>,file.getOriginalFilename());
        <span class="hljs-comment">// 如果没选择文件 则发生异常 跳转至异常页面</span>
        <span class="hljs-keyword">if</span> (file.getSize()&gt;<span class="hljs-number">0</span>) {
            file.transferTo(<span class="hljs-keyword">new</span> File(<span class="hljs-string">"D:\\UpLoad"</span>,file.getOriginalFilename()));
            <span class="hljs-keyword">return</span> <span class="hljs-string">"FileUploadAndDownload"</span>;
        }<span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"error"</span>;
        }
    }
}</code></pre> 
<h5 id="步骤三编写配置文件">步骤三：编写配置文件</h5> 
<h5 id="springmvc-xml">springmvc-xml</h5> 
<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-comment">&lt;!--开启包扫描--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">context:component-scan</span> <span class="hljs-attribute">base-package</span>=<span class="hljs-value">"com.easytop.springmvc"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">context:component-scan</span>&gt;</span>
    <span class="hljs-comment">&lt;!--开启注解--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">mvc:annotation-driven</span>/&gt;</span>


    <span class="hljs-tag">&lt;<span class="hljs-title">bean</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"viewResolver"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"prefix"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"/WEB-INF/jsp/"</span>&gt;</span>
            <span class="hljs-comment">&lt;!--访问路径的前缀--&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"suffix"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">".jsp"</span>&gt;</span>
            <span class="hljs-comment">&lt;!--访问路径的后缀--&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">bean</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 设置上传文件最大值   1M=1*1024*1024(B)=1048576 bytes--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">bean</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"multipartResolver"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"maxUploadSize"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"104857600"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"defaultEncoding"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"utf-8"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">bean</span>&gt;</span>

    <span class="hljs-comment">&lt;!--错误页面--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">bean</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"org.springframework.web.servlet.handler.SimpleMappingExceptionResolver"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"defaultErrorView"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"error"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">bean</span>&gt;</span>

    <span class="hljs-comment">&lt;!--为了能通过 upload 访问到 WEB-INF下面的jsp 实现的转发--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">mvc:view-controller</span> <span class="hljs-attribute">path</span>=<span class="hljs-value">"upload"</span> <span class="hljs-attribute">view-name</span>=<span class="hljs-value">"FileUploadAndDownload"</span>/&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">beans</span>&gt;</span></code></pre> 
<h6 id="webxml">web.xml</h6> 
<pre class="prettyprint"><code class=" hljs xml"> <span class="hljs-comment">&lt;!--前端控制器--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">servlet</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-name</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-class</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">init-param</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-title">param-name</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">param-value</span>&gt;</span>classpath:springmvc.xml<span class="hljs-tag">&lt;/<span class="hljs-title">param-value</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">init-param</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">servlet</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">servlet-mapping</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-name</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-title">url-pattern</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">servlet-mapping</span>&gt;</span></code></pre> 
<h5 id="步骤四编写jsp页面">步骤四：编写jsp页面</h5> 
<h6 id="indexjsp">index.jsp</h6> 
<pre class="prettyprint"><code class=" hljs xml"><span class="vbscript">&lt;%@ page language=<span class="hljs-string">"java"</span> contentType=<span class="hljs-string">"text/html; charset=UTF-8"</span>
    pageEncoding=<span class="hljs-string">"UTF-8"</span>%&gt;</span>
<span class="hljs-doctype">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">charset</span>=<span class="hljs-value">"UTF-8"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>Insert title here<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"upload"</span>&gt;</span>文件上传<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span></code></pre> 
<h6 id="主文件-fileuploadjsp">主文件 fileUpload.jsp</h6> 
<pre class="prettyprint"><code class=" hljs xml"><span class="vbscript">&lt;%@ page language=<span class="hljs-string">"java"</span> contentType=<span class="hljs-string">"text/html; charset=UTF-8"</span>
    pageEncoding=<span class="hljs-string">"UTF-8"</span> isELIgnored=<span class="hljs-string">"false"</span>%&gt;</span>
<span class="hljs-doctype">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">charset</span>=<span class="hljs-value">"UTF-8"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>文件的上传和下载<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">action</span>=<span class="hljs-value">"uploadTmp"</span> <span class="hljs-attribute">method</span>=<span class="hljs-value">"post"</span> <span class="hljs-attribute">enctype</span>=<span class="hljs-value">"multipart/form-data"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"file"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"file"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"submit"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"上传文件"</span>&gt;</span>  
    <span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">p</span>&gt;</span>上传的文件名为：${fileName}<span class="hljs-tag">&lt;/<span class="hljs-title">p</span>&gt;</span>
    <span class="hljs-comment">&lt;!--分割线 可不写--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">hr</span> <span class="hljs-attribute">width</span>=<span class="hljs-value">"100%"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
</code></pre> 
<h6 id="程序出现错误-错误页面-errorjsp">程序出现错误 错误页面： error.jsp</h6> 
<pre class="prettyprint"><code class=" hljs xml"><span class="vbscript">&lt;%@ page language=<span class="hljs-string">"java"</span> contentType=<span class="hljs-string">"text/html; charset=UTF-8"</span>
    pageEncoding=<span class="hljs-string">"UTF-8"</span>%&gt;</span>
<span class="hljs-doctype">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">charset</span>=<span class="hljs-value">"UTF-8"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>Insert title here<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>程序发生异常<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span></code></pre> 
<h5 id="步骤五查看结果">步骤五：查看结果</h5> 
<p><img src="https://images2.imgbox.com/6b/3e/4LHLpXKV_o.png" alt="这里写图片描述" title=""></p> 
<h6 id="日志文件打印成功">日志文件打印成功</h6> 
<p><img src="https://images2.imgbox.com/ea/82/3pdrHcl2_o.png" alt="这里写图片描述" title=""></p> 
<h6 id="磁盘里面">磁盘里面</h6> 
<p><img src="https://images2.imgbox.com/ad/82/TU7kxq0q_o.png" alt="这里写图片描述" title=""></p> 
<h2 id="上传ok成功">上传OK成功~</h2> 
<h2 id="下载">下载：</h2> 
<h5 id="步骤一">步骤一：</h5> 
<pre class="prettyprint"><code class=" hljs avrasm">package <span class="hljs-keyword">com</span><span class="hljs-preprocessor">.easytop</span><span class="hljs-preprocessor">.springmvc</span><span class="hljs-comment">;</span>

import java<span class="hljs-preprocessor">.io</span><span class="hljs-preprocessor">.File</span><span class="hljs-comment">;</span>
import java<span class="hljs-preprocessor">.io</span><span class="hljs-preprocessor">.IOException</span><span class="hljs-comment">;</span>

import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.commons</span><span class="hljs-preprocessor">.io</span><span class="hljs-preprocessor">.FileUtils</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.log</span>4j<span class="hljs-preprocessor">.Logger</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.springframework</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.HttpHeaders</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.springframework</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.HttpStatus</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.springframework</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.MediaType</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.springframework</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.ResponseEntity</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.springframework</span><span class="hljs-preprocessor">.stereotype</span><span class="hljs-preprocessor">.Controller</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.springframework</span><span class="hljs-preprocessor">.web</span><span class="hljs-preprocessor">.bind</span><span class="hljs-preprocessor">.annotation</span><span class="hljs-preprocessor">.RequestMapping</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.springframework</span><span class="hljs-preprocessor">.web</span><span class="hljs-preprocessor">.bind</span><span class="hljs-preprocessor">.annotation</span><span class="hljs-preprocessor">.RequestParam</span><span class="hljs-comment">;</span>

@Controller
public class DownLoadController {

    private static final Logger log = Logger<span class="hljs-preprocessor">.getLogger</span>(DownLoadController<span class="hljs-preprocessor">.class</span>)<span class="hljs-comment">;</span>

    @RequestMapping(value=<span class="hljs-string">"/download"</span>)
    public ResponseEntity&lt;byte[]&gt; download(@RequestParam(<span class="hljs-string">"tmpFileName"</span>)String tmpFileName) throws IOException {
        //防止输入要下载的资源文件为中文  导致乱码 找不到文件报错
        tmpFileName = new String(tmpFileName<span class="hljs-preprocessor">.getBytes</span>(<span class="hljs-string">"iso-8859-1"</span>),<span class="hljs-string">"UTF-8"</span>)<span class="hljs-comment">;</span>

        log<span class="hljs-preprocessor">.debug</span>(<span class="hljs-string">"下载的文件名为："</span>+tmpFileName)<span class="hljs-comment">;</span>

        File file = new File(tmpFileName)<span class="hljs-comment">;</span>

        byte[] readFileToByteArray = FileUtils<span class="hljs-preprocessor">.readFileToByteArray</span>(file)<span class="hljs-comment">;</span>

        HttpHeaders headers = new HttpHeaders()<span class="hljs-comment">;</span>

        headers<span class="hljs-preprocessor">.setContentType</span>(MediaType<span class="hljs-preprocessor">.APPLICATION</span>_OCTET_STREAM)<span class="hljs-comment">;</span>

        String name  = tmpFileName<span class="hljs-comment">;</span>

        if (tmpFileName<span class="hljs-preprocessor">.indexOf</span>(<span class="hljs-string">"\\"</span>)&gt;<span class="hljs-number">0</span>) {
            name=tmpFileName<span class="hljs-preprocessor">.substring</span>(tmpFileName<span class="hljs-preprocessor">.lastIndexOf</span>(<span class="hljs-string">"\\"</span>)+<span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
        }

        headers<span class="hljs-preprocessor">.setContentDispositionFormData</span>(<span class="hljs-string">"attachment"</span>, name)<span class="hljs-comment">;</span>

        return new ResponseEntity&lt;byte[]&gt;(readFileToByteArray,headers,HttpStatus<span class="hljs-preprocessor">.OK</span>)<span class="hljs-comment">;</span>

    }

}
</code></pre> 
<h5 id="步骤二编写jsp">步骤二：编写jsp</h5> 
<p><img src="https://images2.imgbox.com/50/fd/jTiNN4zP_o.png" alt="这里写图片描述" title=""></p> 
<h5 id="页面效果文件名最好不要为中文可能在下载的之后中文无法显示">页面效果|（文件名最好不要为中文，可能在下载的之后中文无法显示）</h5> 
<p><img src="https://images2.imgbox.com/10/7c/9wSVKJ6b_o.png" alt="这里写图片描述" title=""></p> 
<h2 id="ok">ok</h2>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/857b0592d040f0a69c7113bba2235788/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">rosdep init 显示&#34;Website may be down.</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1c6f0382461d543fe47d4bdf5b393592/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">.git文件过大，github仓库瘦身</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>