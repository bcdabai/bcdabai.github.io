<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>OSPFv6配置 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="OSPFv6配置" />
<meta property="og:description" content="正文共：1024 字 11 图，预估阅读时间：1 分钟
在你学习完IPv6的静态路由配置之后（IPv6静态路由配置），基本上就算是IPv6的高手了。但是我们前面也提到了，IPv6静态路由是靠管理员手工配置的，适合于一些结构比较简单的IPv6网络，不能自动适应网络拓扑结构的变化。
既然静态路由有局限性，那就换成动态路由协议好了。
首先把底层网络配置好。
配置接口IPv6地址
接口的IPv6地址配置就使用上次的配置，具体如下：
VSR1
# interface GigabitEthernet2/0 ipv6 address 1::1/64 # interface GigabitEthernet3/0 ipv6 address 2::1/64 VSR2
# ipv6 dhcp pool 3 network 3::/64 # ipv6 dhcp pool 4 network 4::/64 # interface GigabitEthernet2/0 ipv6 dhcp select server ipv6 dhcp server apply pool 3 ipv6 address 3::1/64 ipv6 nd autoconfig managed-address-flag ipv6 nd autoconfig other-flag undo ipv6 nd ra halt # interface GigabitEthernet3/0 ipv6 dhcp select server ipv6 dhcp server apply pool 4 ipv6 address 4::1/64 ipv6 nd autoconfig managed-address-flag ipv6 nd autoconfig other-flag undo ipv6 nd ra halt VSR3" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/6f07bdd83563aaf39f4004df44970b61/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-27T08:38:23+08:00" />
<meta property="article:modified_time" content="2024-01-27T08:38:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">OSPFv6配置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="js_content"> 
 <p><img src="https://images2.imgbox.com/fd/bf/YJTOBIqG_o.gif" alt="3423f0b04a19de25f261750ff5ddd066.gif"><br></p> 
 <p>正文共：1024 字 11 图，预估阅读时间：1 分钟</p> 
 <p>在你学习完IPv6的静态路由配置之后<strong>（</strong><a href="" rel="nofollow"><strong>IPv6静态路由配置</strong></a><strong>）</strong>，基本上就算是IPv6的高手了。但是我们前面也提到了，IPv6静态路由是靠管理员手工配置的，适合于一些结构比较简单的IPv6网络，不能自动适应网络拓扑结构的变化。</p> 
 <p>既然静态路由有局限性，那就换成动态路由协议好了。</p> 
 <p>首先把底层网络配置好。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/df/f0/fusIG6mk_o.png" alt="fa3b3a0d7c310b6355b38bc81ebb279e.png"></p> 
 <p><img src="https://images2.imgbox.com/99/0c/yxv7TEMJ_o.png" alt="699c68ae33da2bad259a6d444ed50cb7.png"></p> 
 <p style="text-align:center;"><strong>配置接口IPv6地址</strong></p> 
 <p><img src="https://images2.imgbox.com/b0/a4/935VFXJc_o.png" alt="4fa5658431de3dbc93080855780d9eae.png"></p> 
 <p>接口的IPv6地址配置就使用上次的配置，具体如下：</p> 
 <p><img src="https://images2.imgbox.com/74/6a/WjRT0kPv_o.png" alt="94e8305c9968fc1fdb65bda681565502.png"></p> 
 <p style="text-align:left;"><strong>VSR1</strong></p> 
 <pre class="has"><code class="language-properties">#
interface GigabitEthernet2/0
 ipv6 address 1::1/64
#
interface GigabitEthernet3/0
 ipv6 address 2::1/64</code></pre> 
 <p><img src="https://images2.imgbox.com/f6/d1/WNo5UXGn_o.png" alt="cd228fc4bd0e891fe74fa016fb08b0a6.png"></p> 
 <p style="text-align:left;"><strong>VSR2</strong></p> 
 <pre class="has"><code class="language-properties">#
ipv6 dhcp pool 3
 network 3::/64
#
ipv6 dhcp pool 4
 network 4::/64
#
interface GigabitEthernet2/0
 ipv6 dhcp select server
 ipv6 dhcp server apply pool 3
 ipv6 address 3::1/64
 ipv6 nd autoconfig managed-address-flag
 ipv6 nd autoconfig other-flag
 undo ipv6 nd ra halt
#
interface GigabitEthernet3/0
 ipv6 dhcp select server
 ipv6 dhcp server apply pool 4
 ipv6 address 4::1/64
 ipv6 nd autoconfig managed-address-flag
 ipv6 nd autoconfig other-flag
 undo ipv6 nd ra halt</code></pre> 
 <p><img src="https://images2.imgbox.com/60/39/pCArZW7M_o.png" alt="efe5f77b38686090f7786bd6c7236a8c.png"></p> 
 <p style="text-align:left;"><strong>VSR3</strong></p> 
 <pre class="has"><code class="language-properties">#
interface GigabitEthernet2/0
 ipv6 address 1::2/64
#
interface GigabitEthernet3/0
 ipv6 address dhcp-alloc</code></pre> 
 <p><img src="https://images2.imgbox.com/ef/51/raK3oXZ4_o.png" alt="63a12203b69505cb1bd75c31b3b9de32.png"></p> 
 <p style="text-align:left;"><strong>VSR4</strong></p> 
 <pre class="has"><code class="language-properties">#
interface GigabitEthernet2/0
 ipv6 address 2::2/64
#
interface GigabitEthernet3/0
 ipv6 address dhcp-alloc</code></pre> 
 <p><img src="https://images2.imgbox.com/61/03/bfHLelSg_o.png" alt="784a8bb64d8b6a6c7c95227c821ea05d.png"></p> 
 <p style="text-align:center;"><strong>配置OSPFv3</strong></p> 
 <p><img src="https://images2.imgbox.com/4b/6b/kQwoCPs4_o.png" alt="567c6c56d070362c8bb2f9f79d253f9c.png"></p> 
 <p>哈哈，题目埋了一个坑，支持IPv6协议的OSPF不叫OSPFv6，而是叫OSPFv3，OSPFv3主要就是提供了对IPv6的支持。</p> 
 <p>想必各位对OSPF，或者说是OSPFv2已经比较熟悉了，那OSPFv3有什么不同点呢？</p> 
 <p>首先<strong>OSPFv3是基于链路运行的</strong>，和IS-IS协议比较像<strong>（</strong><a href="" rel="nofollow"><strong>SR over MPLS准备工作，搞通IS-IS</strong></a><strong>）</strong>，而OSPFv2是基于网段运行的。在配置OSPFv3时，不需要考虑两端是否配置在同一网段，只要在同一链路，就可以直接建立联系。</p> 
 <p>其次是Router ID。OSPFv2是通过IPv4地址来标识邻居的，当OSPF进程启动时，会自动选取第一个运行该进程的接口的主IPv4地址作为Router ID。而OSPFv3则是通过Router ID来标识邻居，默认的Router ID是0.0.0.0，所以<strong>Router ID变成了一个必配项，否则无法建立邻居关系</strong>。</p> 
 <p>此外，<strong>OSPFv3在同一条链路上可以运行多个实例</strong>，也就是说一个接口下可以使能多个OSPFv3进程（使用不同的VPN实例）。</p> 
 <p>好了，我们不需要对OSPFv3有多么深入的了解，仅需要上面这些，我们就可以开始今天的配置任务了。</p> 
 <p><img src="https://images2.imgbox.com/1b/ca/87LYjFMJ_o.png" alt="dcb3be1d4c35935a4baa944ccc30273c.png"></p> 
 <p style="text-align:left;"><strong>VSR1</strong></p> 
 <p>以VSR1为例，先启动OSPFv3进程，并配置路由器的Router ID。</p> 
 <pre class="has"><code class="language-css">#
ospfv3 1
 router-id 1.1.1.1</code></pre> 
 <p>然后进入接口视图下，再在接口上使能OSPFv3功能就可以了。</p> 
 <pre class="has"><code class="language-properties">#
interface GigabitEthernet2/0
 ospfv3 1 area 0.0.0.0
#
interface GigabitEthernet3/0
 ospfv3 1 area 0.0.0.0</code></pre> 
 <p>以此为例，分别配置剩余3台VSR。</p> 
 <p><img src="https://images2.imgbox.com/af/88/84zTC2UE_o.png" alt="963a5cfaaee648c37aa1e0a4cb6f5cd4.png"></p> 
 <p style="text-align:left;"><strong>VSR2</strong></p> 
 <pre class="has"><code class="language-properties">#
ospfv3 1
 router-id 2.2.2.2
#
interface GigabitEthernet2/0
 ospfv3 1 area 0.0.0.0
#
interface GigabitEthernet3/0
 ospfv3 1 area 0.0.0.0</code></pre> 
 <p><img src="https://images2.imgbox.com/24/86/OBsIvSww_o.png" alt="525353eabb0b39eb00255ad24956f774.png"></p> 
 <p style="text-align:left;"><strong>VSR3</strong></p> 
 <pre class="has"><code class="language-properties">#
ospfv3 1
 router-id 3.3.3.3
#
interface GigabitEthernet2/0
 ospfv3 1 area 0.0.0.0
#
interface GigabitEthernet3/0
 ospfv3 1 area 0.0.0.0</code></pre> 
 <p><img src="https://images2.imgbox.com/ba/bd/MOxzqlYj_o.png" alt="772d1c4536b828901de37ef06b3aa8fd.png"></p> 
 <p style="text-align:left;"><strong>VSR4</strong></p> 
 <pre class="has"><code class="language-properties">#
ospfv3 1
 router-id 4.4.4.4
#
interface GigabitEthernet2/0
 ospfv3 1 area 0.0.0.0
#
interface GigabitEthernet3/0
 ospfv3 1 area 0.0.0.0</code></pre> 
 <p><img src="https://images2.imgbox.com/7c/f7/OPctB0IC_o.png" alt="f5f06797d4e63c92503e90f387325ce4.png"></p> 
 <p style="text-align:center;"><strong>验证配置</strong></p> 
 <p><img src="https://images2.imgbox.com/0f/db/ZazuVheO_o.png" alt="b1d8666fbe68f6946c739709867491a4.png"></p> 
 <p>全部配置完成之后，我们查看设备VSR1的邻居建立情况</p> 
 <p><img src="https://images2.imgbox.com/c5/b4/idxhOcaI_o.png" alt="9cd9a6feba2bf5dc26fbbf9eb5a963d0.png"></p> 
 <p>查看设备VSR2的IPv6路由信息。</p> 
 <p><img src="https://images2.imgbox.com/57/5e/Due3zJUq_o.png" alt="2cb7975c20eb3ae144ec45989f9a6089.png"></p> 
 <p>可以看到VSR2上学到了VSR1和VSR3、VSR4互联的网段路由，但是本地和VSR3、VSR4互联的直连路由竟然也显示在了OSPFv3的路由表中，而且显示的还是直连的IPv6地址。</p> 
 <p>查看设备VSR3的接口信息。</p> 
 <p><img src="https://images2.imgbox.com/67/06/v21rsHIu_o.png" alt="d93a5eccb82d24b36441f6f548895b98.png"></p> 
 <p>可以看到OSPFv3在每条链路上都有一个DR/BDR的选举，并且设备VSR3在接口GE2/0上，或者说在这条链路上是BSR角色；而在接口GE3/0上就是DR角色。</p> 
 <p>查看设备VSR3的链路状态数据库信息。</p> 
 <p><img src="https://images2.imgbox.com/47/79/OTiOnsfk_o.png" alt="4567910f4b15e35c28b30af308cf527d.png"></p> 
 <p>查看设备VSR3的路由下一跳信息。</p> 
 <p><img src="https://images2.imgbox.com/64/b0/vMVpjRXY_o.png" alt="49214f52f87ffcd41d0da1071b3d7237.png"></p> 
 <p>查看设备VSR3的OSPFv3路由表信息。</p> 
 <p><img src="https://images2.imgbox.com/94/97/hbkbo7Ty_o.png" alt="91033d5d6ad83893c63240a8f4ca1be8.png"></p> 
 <p>注意看最后两条，因为我们的拓扑中，VSR3到VSR4有两条路径，所以去往4::2/128的路由有两条，下一跳分别是VSR1和VSR2。但是VSR4上还有一个地址是2::2/128，为啥就没享受这待遇呢？</p> 
 <p>然后我们在VSR3上分别ping一下VSR4的两个接口IPv6地址，并tracert看一下路径。</p> 
 <p><img src="https://images2.imgbox.com/d0/e1/E09lmVQW_o.png" alt="0b46fd06eb43edbb5a1aed5b71b017f1.png"></p> 
 <p>发现走VSR1的链路被优选了。</p> 
 <p>再查看设备VSR3的OSPFv3拓扑信息确认一下。</p> 
 <p><img src="https://images2.imgbox.com/be/94/eCZR78XO_o.png" alt="9c80384094edf5ccc5978ac5b5b6c0d5.png"></p> 
 <p>从上图可以看到，VSR2-VSR4这条链路的目标节点VSR4被标记为了子节点。</p> 
 <p>好了，从VSR4上测试一下到全网的可达性。</p> 
 <p style="text-align:center;"><img src="https://images2.imgbox.com/e9/6f/DLmP8wmv_o.png" alt="c5d1d8c8670c6ab75e855f6842653db9.png"></p> 
 <p>可以看到VSR4访问VSR3的3::2这个地址时，跟VSR3访问VSR4的4::2地址一样，跟我们想象的有点出入。<br></p> 
 <p>最后我们让VSR4长ping设备VSR1的接口地址1::1，中途断开互联线路，查看业务中断情况。</p> 
 <p><img src="https://images2.imgbox.com/f6/f4/0KP5CWBF_o.png" alt="06ce760db42029d70d8a7b26ad28a3d1.png"></p> 
 <p>可以看到中间丢了一个包，并且从<strong>hlim（hop limit）</strong>的变化可以看出路径的变化。</p> 
 <p><img src="https://images2.imgbox.com/e3/a5/q3rkj5Ia_o.gif" alt="97d01119af6369dc46b317f9d70a757d.gif"></p> 
 <p>长按二维码<br>关注我们吧</p> 
 <p><img src="https://images2.imgbox.com/4a/9b/dmLj61wT_o.jpg" alt="48341865b503602c019e2521282c21d4.jpeg"></p> 
 <p><img src="https://images2.imgbox.com/df/ac/I7XqUYns_o.png" alt="44e6a99c54e83a2e4ca567e64bb7ca65.png"></p> 
 <a href="" rel="nofollow"></a> 
 <p><a href="" rel="nofollow">IPv6静态路由配置</a></p> 
 <a href="" rel="nofollow"></a> 
 <a href="" rel="nofollow"></a> 
 <p><a href="" rel="nofollow">IPv6地址架构一本通</a></p> 
 <a href="" rel="nofollow"></a> 
 <a href="" rel="nofollow"></a> 
 <p><a href="" rel="nofollow">IPv6从入门到精通</a></p> 
 <a href="" rel="nofollow"></a> 
 <a href="" rel="nofollow"></a> 
 <p><a href="" rel="nofollow">有状态DHCPv6配置</a></p> 
 <a href="" rel="nofollow"></a> 
 <a href="" rel="nofollow"></a> 
 <p><a href="" rel="nofollow">无状态DHCPv6配置</a></p> 
 <a href="" rel="nofollow"></a> 
 <a href="" rel="nofollow"></a> 
 <p><a href="" rel="nofollow">SRv6的网络编程实现</a></p> 
 <a href="" rel="nofollow"></a> 
 <a href="" rel="nofollow"></a> 
 <p><a href="" rel="nofollow">有状态DHCPv6快速模式配置及EUI-64介绍</a></p> 
 <a href="" rel="nofollow"></a> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f6405a3579babe2ae72f49a54cea8b4b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">2024初学编曲免费软件FL Studio21.2.2</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/633e6648a9b04c54ff448f827fac3010/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python的hashlib模块：7种加密算法深入剖析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>