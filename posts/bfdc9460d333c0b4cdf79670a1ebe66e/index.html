<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#中keybd_event 用法 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C#中keybd_event 用法" />
<meta property="og:description" content="Windows提供了一个模拟键盘API函数Keybd_event（），该函数能触发一个按键事件，也就是说会产生一个WM_KEYDOWN或WM_KEYUP消息。 [DllImport(&#34;user32.dll&#34;, EntryPoint = &#34;keybd_event&#34;)]
public static extern void keybd_event(
byte bVk, //虚拟键值
byte bScan,// 一般为0
int dwFlags, //这里是整数类型 0 为按下，2为释放
int dwExtraInfo //这里是整数类型 一般情况下设成为 0
); 使用方法：
keybd_event((byte)Keys.LWin, 0, 0, 0); //按下LWIN
keybd_event((byte)Keys.D, 0, 0, 0); //按下D
keybd_event((byte)Keys.LWin, 0, 2, 0); //释放LWIN
keybd_event((byte)Keys.D, 0, 2, 0); //释放D
补充：
1.调用API函数记得引用：using System.Runtime.InteropServices;
2.常用模拟键的键值对照表。
键盘键与虚拟键码对照表
字母和数字键　数字小键盘的键　功能键 其它键 键　键码　键　键码　键　键码 键　键码 A　65　0 96 F1 112 Backspace 8 B　66　1　97 F2 113　Tab 9 C　67 2 98 F3 114　Clear 12 D　68　3　99 F4 115　Enter 13 E　69 4 100　F5 116　Shift　16 F　70 5 101　F6 117　Control 17 G　71 6　102　F7 118 Alt 18 H　72 7 103　F8 119　Caps Lock 20 I　73 8 104　F9 120　Esc 27 J　74 9　105　F10　121　Spacebar　32 K　75 * 106　F11　122　Page Up　33 L　76 &#43; 107　F12　123　Page Down 34 M　77 Enter 108　-- --　End 35 N　78 -　109　-- -- Home　36 O　79 ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/bfdc9460d333c0b4cdf79670a1ebe66e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-04-21T16:57:23+08:00" />
<meta property="article:modified_time" content="2014-04-21T16:57:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#中keybd_event 用法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em"> Windows提供了一个模拟键盘API函数Keybd_event（），该函数能触发一个按键事件，也就是说会产生一个WM_KEYDOWN或WM_KEYUP消息。     </p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em">    [DllImp<wbr></wbr>ort("user32.dll", EntryPoint = "keybd_event")]</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em">         public static extern void keybd_event(</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em">             byte bVk,    //虚拟键值</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em">             byte bScan,// 一般为0</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em">             int dwFlags,  //这里是整数类型  0 为按下，2为释放</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em">             int dwExtraInfo  //这里是整数类型 一般情况下设成为 0</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em">         );        </p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em"> 使用方法：</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em">             keybd_event((byte)Keys.LWin, 0, 0, 0);   //按下LWIN</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em">             keybd_event((byte)Keys.D, 0, 0, 0);         //按下D</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em">             keybd_event((byte)Keys.LWin, 0, 2, 0);   //释放LWIN</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em">             keybd_event((byte)Keys.D, 0, 2, 0);        //释放D</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em"> 补充：</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em"> 1.调用API函数记得引用：using System.Runtime.InteropServices;</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px; text-indent:2em"> 2.常用模拟键的键值对照表。</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 　　　　　　　　　　　　　　　　　　　　　　键盘键与虚拟键码对照表</p> 
<p style="line-height:28px; margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px; color:rgb(61,61,61); font-family:'Hiragino Sans GB W3','Hiragino Sans GB',Arial,Helvetica,simsun,u5b8bu4f53; font-size:16px"> 　　　 　　字母和数字键　　　数字小键盘的键　　　　 　　功能键 　　　　　　　　其它键 <br> 　　　　　　键　　 键码　　　键　　 键码　　　　　　 键　　 键码 　　　　键　　　　　　键码 <br> 　　　　　　A　　　65　　　　 0 　　96 　　　　　　　F1 　　112 　　　　Backspace 　　　8 <br> 　　　　　　B　　　66　　　　1　　 97 　　　　　　　F2 　　113　　　　 Tab 　　　　　　9 <br> 　　　　　　C　　　67 　　　　2 　　98 　　　　　　　F3 　　114　　　 　Clear 　　　　　12 <br> 　　　　　　D　　　68　　　　 3　　 99 　　　　　　　F4 　　115　　　 　Enter 　　　　　13 <br> 　　　　　　E　　　69 　　　　4 　　100　　　　　　　F5 　　116　　　 　Shift　　　　　 16 <br> 　　　　　　F　　　70 　　　　5 　　101　　　　　　　F6 　　117　　　 　Control 　　　　17 <br> 　　　　　　G　　　71 　　　　6　　 102　　　　　　　F7 　　118 　　 　 Alt 　　　　　　18 <br> 　　　　　　H　　　72 　　　　7 　　103　　　　　　　F8 　　119　　　 　Caps Lock 　　　20 <br> 　　　　　　I　　　73 　　　　8 　　104　　　　　　　F9 　　120　　　 　Esc 　　　　　　27 <br> 　　　　　　J　　　74 　　　　9　　 105　　　　　　　F10　　121　　　 　Spacebar　　　　32 <br> 　　　　　　K　　　75 　　　　* 　　106　　　　　　　F11　　122　　　 　Page Up　　　　 33 <br> 　　　　　　L　　　76 　　　　+ 　　107　　　　　　　F12　　123　　　 　Page Down 　　　34 <br> 　　　　　　M　　　77 　　　　Enter 108　　　　　　　-- 　　--　　　　　End 　　　　　　35 <br> 　　　　　　N　　　78 　　　　　-　　 109　　　　　　　-- 　　-- 　　　 　Home　　　　　　36 <br> 　　　　　　O　　　79 　　　　　. 　　110　　　　　　　--　　 -- 　　 　　Left Arrow　　　37 <br> 　　　　　　P　　　80 　　　　　/ 　　111　　　　　　　--　　 -- 　　 　　Up Arrow　　　　38 <br> 　　　　　　Q　　　81 　　　　　-- 　　--　　　　　　　--　　 -- 　　 　　Right Arrow 　　39 <br> 　　　　　　R　　　82 　　　　　-- 　　--　　　　　　　--　　 -- 　　 　　Down Arrow 　　 40 <br> 　　　　　　S　　　83 　　　　　-- 　　--　　　　　　　-- 　　-- 　　 　　Insert 　　　　 45 <br> 　　　　　　T　　　84 　　　　　-- 　　--　　　　　　　--　　 -- 　　 　　Delete 　　　　 46 <br> 　　　　　　U　　　85 　　　　　-- 　　--　　　　　　　-- 　　-- 　　 　　Help 　　　　　 47 <br> 　　　　　　V　　　86 　　　　　--　　 --　　　　　　　-- 　　-- 　　 　　Num Lock 　　　 144 <br> 　　　　　　W　　　87 　　　　　　　　　<br> 　　　　　　X　　　88 　　　　　<br> 　　　　　　Y　　　89 　　　　　<br> 　　　　　　Z　　　90 　　　　　<br> 　　　　　　0　　　48 　　　　　<br> 　　　　　　1　　　49 　　　　　<br> 　　　　　　2　　　50 　　　　　　<br> 　　　　　　3　　　51 　　　　　　<br> 　　　　　　4　　　52 　　　　　　<br> 　　　　　　5　　　53 　　　　　　<br> 　　　　　　6　　　54 　　　　　　<br> 　　　　　　7　　　55 　　　　　　<br> 　　　　　　8　　　56 　　　　　　<br> 　　　　　　9　　　57 </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fb5a948fd6d6584a62502dead445455e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">LVM/RAID</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2632023db601bdc0afd4d2a2d19213e3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">繞過linux Driver Vermagic檢查</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>