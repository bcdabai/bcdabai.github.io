<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>docker配置java环境（dockerfile方式） - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="docker配置java环境（dockerfile方式）" />
<meta property="og:description" content="1、安装包准备 准备Centos镜像：
jdk和tomcat压缩包：
2、构建容器 2.1、编写构建文件 在存放安装包的目录下创建构建文件：
vi Dockerfile 在Dockerfile添加以下代码：
#依赖镜像名称和ID FROM daocloud.io/library/centos:6.8 #指定镜像创建者信息 MAINTAINER alinlx #切换工作目录 ADD jdk-8u181-linux-x64.tar.gz /opt/jdk ADD apache-tomcat-9.0.50.tar.gz /opt/tomcat #配置java环境变量 ENV JAVA_HOME /opt/jdk/jdk1.8.0_181 ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar ENV PATH $PATH:$JAVA_HOME/bin RUN chmod &#43;x /opt/tomcat/apache-tomcat-9.0.50/bin/*.sh EXPOSE 8080 ENTRYPOINT /opt/tomcat/apache-tomcat-9.0.50/bin/startup.sh &amp;&amp; /bin/bash 参数解释：
FROM daocloud.io/library/centos:6.8
以centos6.8为基础构建容器
ADD jdk-8u181-linux-x64.tar.gz /opt/jdk/
ADD apache-tomcat-9.0.50.tar.gz /opt/tomcat/
添加两个压缩包，docker会自动解压好，/opt/ 是解压的文件位置
ENV JAVA_HOME /opt/jdk
ENV CLASSPATH J A V A H O M E / l i b / d t ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/2a105909ecf519d49f083bdef906c62d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-20T11:56:52+08:00" />
<meta property="article:modified_time" content="2021-10-20T11:56:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">docker配置java环境（dockerfile方式）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="1_0"></a>1、安装包准备</h4> 
<p>准备Centos镜像：<br> <img src="https://images2.imgbox.com/30/b9/ikUAs0wS_o.png" alt="在这里插入图片描述"><br> jdk和tomcat压缩包：<br> <img src="https://images2.imgbox.com/c5/3e/MgtfXW8O_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_6"></a>2、构建容器</h4> 
<h5><a id="21_7"></a>2.1、编写构建文件</h5> 
<p>在存放安装包的目录下创建构建文件：</p> 
<pre><code class="prism language-bash"><span class="token function">vi</span> Dockerfile
</code></pre> 
<p><img src="https://images2.imgbox.com/a6/21/99E5230A_o.png" alt="在这里插入图片描述"><br> 在Dockerfile添加以下代码：</p> 
<pre><code class="prism language-bash"><span class="token comment">#依赖镜像名称和ID</span>
FROM daocloud.io/library/centos:6.8

<span class="token comment">#指定镜像创建者信息</span>
MAINTAINER alinlx

<span class="token comment">#切换工作目录</span>
ADD jdk-8u181-linux-x64.tar.gz /opt/jdk
ADD apache-tomcat-9.0.50.tar.gz /opt/tomcat
 
<span class="token comment">#配置java环境变量</span>
ENV JAVA_HOME /opt/jdk/jdk1.8.0_181
ENV CLASSPATH <span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar
ENV <span class="token environment constant">PATH</span> <span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$JAVA_HOME</span>/bin

RUN <span class="token function">chmod</span> +x /opt/tomcat/apache-tomcat-9.0.50/bin/*.sh 
EXPOSE <span class="token number">8080</span> 
ENTRYPOINT /opt/tomcat/apache-tomcat-9.0.50/bin/startup.sh <span class="token operator">&amp;&amp;</span> /bin/bash
</code></pre> 
<p><strong>参数解释：</strong><br> FROM daocloud.io/library/centos:6.8<br> 以centos6.8为基础构建容器</p> 
<p>ADD jdk-8u181-linux-x64.tar.gz /opt/jdk/<br> ADD apache-tomcat-9.0.50.tar.gz /opt/tomcat/<br> 添加两个压缩包，docker会自动解压好，/opt/ 是解压的文件位置</p> 
<p>ENV JAVA_HOME /opt/jdk<br> ENV CLASSPATH J A V A H O M E / l i b / d t . j a r : JAVA_HOME/lib/dt.jar:JAVA<br> H<br> OME/lib/dt.jar:JAVA_HOME/lib/tools.jar<br> ENV PATH P A T H : PATH:PATH:JAVA_HOME/bin<br> ENV是docker中配置环境变量的方式，这里配置了jdk的环境。</p> 
<h5><a id="22_48"></a>2.2、根据构建文件，构建镜像</h5> 
<pre><code class="prism language-bash">docker build -t alinlx/javawebfromdockerfile:0.2 <span class="token builtin class-name">.</span> -f Dockerfile
</code></pre> 
<p>创建名为alinlx/javawebfromdockerfile的镜像<br> <img src="https://images2.imgbox.com/3d/e6/UWm4tzXj_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="23_54"></a>2.3、构建完成，查看镜像</h5> 
<pre><code class="prism language-bash">docker images
</code></pre> 
<p><img src="https://images2.imgbox.com/d9/85/ihtar4dy_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="24_59"></a>2.4、创建容器</h6> 
<p>启动 Java Web 容器，根据前面环境配置，不用再进入容器的命令行，而是直接启动容器内部的 tomcat 服务。使用以下命令：</p> 
<pre><code class="prism language-bash">docker run -d -p <span class="token number">8888</span>:8080 -it alinlx/javawebfromdockerfile:0.2
</code></pre> 
<p><img src="https://images2.imgbox.com/b2/09/CcYo71ZL_o.png" alt="在这里插入图片描述"><br> <strong>参数解析：</strong><br> -d：表示以“守护模式”执行/root/run.sh脚本，tomcat 控制台不会出现在输出终端上。<br> -p：表示宿主机与容器的端口映射，此时将容器内部的 8080 端口映射为宿主机的 8888 端口，这样就向外界暴露了 8888 端口，可通过 Docker 网桥来访问容器内部的 8080 端口了。<br> –name：表示容器名称，用一个有意义的名称命名即可。<br> 启动成功，通过docker ps命令来查看当前正在运行的容器：<br> <img src="https://images2.imgbox.com/6c/ca/FWnxYi5d_o.png" alt="在这里插入图片描述"></p> 
<h6><a id="43_72"></a>4.3、测试</h6> 
<p>浏览器中，输入以下地址，即可访问 Tomcat 首页：http://127.0.0.1:8888/<br> <img src="https://images2.imgbox.com/9c/29/ZcxvIsaq_o.png" alt="在这里插入图片描述"></p> 
<p>**注意：**使用的是宿主机的 IP 地址，与对外暴露的端口号 8888，它映射容器内部的端口号 8080。</p> 
<h6><a id="431_77"></a>4.3.1、测试部署项目</h6> 
<p>容器倒是启动起来了，但是怎么把war包丢里面运行起来呢？</p> 
<pre><code class="prism language-bash">docker <span class="token function">cp</span> XXX.war 1e2b6b069253:/opt/tomcat/apache-tomcat-9.0.50/webapps
</code></pre> 
<p><img src="https://images2.imgbox.com/79/f3/mQtkgrbC_o.png" alt="在这里插入图片描述"><br> <strong>参数解释：</strong><br> XXX.war： 需要部署的项目发布程序包<br> 1e2b6b069253:/opt/tomcat/apache-tomcat-9.0.50/webapps 冒号前面为容器名称或者id， 冒号后面为tomcat的webapps全路径</p> 
<p>将程序包拷贝进去后，tomcat会自动发布的，不需要再自己去启动tomcat了，因为容器启动后tomcat就默认启动了 Dockerfile最后一行就是启动tomcat。<br> <img src="https://images2.imgbox.com/b4/ff/OpmnM3Iu_o.png" alt="在这里插入图片描述"><br> 访问系统：<br> <img src="https://images2.imgbox.com/ac/f4/pvBOZ5cx_o.png" alt="在这里插入图片描述"><br> 说明：<br> 也可以在创建容器的时候挂载本地目录到容器中，这样就不用拷贝，直接将程序包war放到本地挂载的目录就行。<br> -v：表示需要将本地哪个目录挂载到容器中，格式：-v &lt;宿主机目录&gt;:&lt;容器目录&gt;<br> 　　/bin/bash：一旦容器启动，需要执行的命令，当前使用 “/bin/bash”, 表示启动后直接进bash shell<br> 　　/usr/local/work/是宿主机器(Linux)上创建的一个文件夹;<br> 　　/mnt/software是centos的容器里面的目录文件<br> 　　这里挂载的意思就是 b36870be5ede 创建的容器访问 /mnt/software/ 目录下的文件就相当于访问 宿主机的 /usr/local/work/下的文件，且两者文件夹里内容相同。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/def933fbbe450a39069389bbd706a688/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">实现通过Xcode安装到虚拟机后安装iPhone模拟器并安装ipa软件到模拟器上</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/489c3ed8855ed33bb46f24345a3e0cfb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Precision（准确率）和Recall（召回率）介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>