<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>kettle入门(三) 之kettle连接hadoop&amp;hdfs图文详解 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="kettle入门(三) 之kettle连接hadoop&amp;hdfs图文详解" />
<meta property="og:description" content="1 引言： 项目最近要引入大数据技术，使用其处理加工日上网话单数据，需要kettle把源系统的文本数据load到hadoop环境中
2 准备工作： 1 首先 要了解支持hadoop的Kettle版本情况，由于kettle资料网上较少，所以最好去官网找,官网的url:
http://wiki.pentaho.com/display/BAD/Configuring&#43;Pentaho&#43;for&#43;your&#43;Hadoop&#43;Distro&#43;and&#43;Version
打开这个url 到页面最下面的底端，如下图：
archive 下面的from PDI 4.3 、 from PDI 4.4 、 from PDI 5.0 即表示支持hadoop的pdi 版本。pdi即pentaho data integration 又称kettle。PDI 4.3 、 PDI 4.4 、 PDI 5.0 即是kettle 4.3 、4.4、 5.0 ,这个版本号 包括比其更高的版本（即kettle 5.0.X ，5.1，5.2也支持hadoop）。
2 其次
不同的kettle版本支持的hadoop版本不一样，以5.1为例子，下面的链接是5.1的支持情况
http://wiki.pentaho.com/display/BAD/Configuring&#43;Pentaho&#43;for&#43;your&#43;Hadoop&#43;Distro&#43;and&#43;Version
下图为链接打开的页面的中间部分：
determine the proper shim for hadoop Distro and version 大概意思是 为hadoop版本选择合适的套件。表格上面的一行：apache、cloudera、hortonworks、intel、mapr指的是发行方。点击他们来选择你 想连接的hadoop的发行方 。上图 以apache hadoop为例：
Version 指版hadoop版本号 ，shim 指kettle提供给该hadoop套件的名称，Download 里面的 included in 5." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/35f7de2f2f51ff791e33624b0f169b77/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-12-11T09:53:06+08:00" />
<meta property="article:modified_time" content="2014-12-11T09:53:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">kettle入门(三) 之kettle连接hadoop&amp;hdfs图文详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2><span style="color:#006600">1 引言：</span></h2> 
<p><br> </p> 
<p>项目最近要引入大数据技术，使用其处理加工日上网话单数据，需要kettle把源系统的文本数据load到hadoop环境中</p> 
<p><br> </p> 
<h2><span style="color:#006600">2 准备工作：</span></h2> 
<p><br> </p> 
<h3>1 首先</h3> 
<p>要了解<span style="font-size:18px; color:#006600"><strong><span style="font-size:18px; color:#006600"><strong>支持</strong></span>hadoop的<span style="font-size:18px; color:#006600"><strong>Kettle</strong></span>版本情况</strong></span>，由于kettle资料网上较少，所以最好去官网找,官网的url:</p> 
<p><span style="color:#333333"><a target="_blank" href="http://wiki.pentaho.com/display/BAD/Configuring+Pentaho+for+your+Hadoop+Distro+and+Version" rel="nofollow noopener noreferrer">http://wiki.pentaho.com/display/BAD/Configuring+Pentaho+for+your+Hadoop+Distro+and+Version</a></span></p> 
<p>打开这个url 到页面最下面的底端，如下图：</p> 
<p><br> </p> 
<p><img src="https://images2.imgbox.com/78/e7/pXScyo6q_o.png" alt=""></p> 
<p><br> </p> 
<p>archive 下面的from PDI 4.3 、 from PDI 4.4 、 from PDI 5.0 即表示支持hadoop的pdi 版本。pdi即pentaho data integration 又称kettle。PDI 4.3 、  PDI 4.4 、 PDI 5.0 即是kettle 4.3 、4.4、 5.0 ,这个版本号 包括比其更高的版本（即kettle 5.0.X ，5.1，5.2也支持hadoop）。</p> 
<p><br> </p> 
<h3>2 其次<br> </h3> 
<p><span style="color:#006600"><strong><span style="font-size:18px">不同的kettle版本支持的hadoop版本不一样</span></strong></span>，以5.1为例子，下面的链接是5.1的支持情况</p> 
<p><a target="_blank" href="http://wiki.pentaho.com/display/BAD/Configuring+Pentaho+for+your+Hadoop+Distro+and+Version" rel="nofollow noopener noreferrer">http://wiki.pentaho.com/display/BAD/Configuring+Pentaho+for+your+Hadoop+Distro+and+Version<br> </a></p> 
<p> 下图为链接打开的页面的中间部分：</p> 
<p><img src="https://images2.imgbox.com/4a/ed/4EgPVGe5_o.png" alt="" height="404" width="769" style="width:905px; height:404px"></p> 
<p> </p> 
<p>determine the proper shim for hadoop Distro and version 大概意思是 为hadoop版本选择合适的套件。表格上面的一行：apache、cloudera、hortonworks、intel、mapr指的是发行方。点击他们来选择你 想连接的hadoop的发行方 。上图 以apache hadoop为例：</p> 
<p>Version 指版hadoop版本号 ，shim 指kettle提供给该hadoop套件的名称，Download 里面的 included in 5.0,5.1 指kettle的5.0、5.1版本安装包里面已经有内置的插件，一句话来讲 就是kettle5.1及5.0版本已有插件提供支持apache hadoop版本0.20.x  。不需要额外下载。NS 是不支持的意思 图片下面也有解释。</p> 
<p><br> </p> 
<p><img src="https://images2.imgbox.com/28/b0/c2Q9pYLu_o.png" alt="" height="601" width="808"></p> 
<p>上图说明的是对 cloudera的 hadoop支持的情况 ，Download 里面 download的蓝色字体超链接的说明 是要除了下kettle的安装包外另外下载的 ，带 included in 5.0,5.1 说明 kettle 5.0,5.1版本的本身就支持（内置有插件）。</p> 
<p><strong><br> </strong></p> 
<p><strong>由上面两图得到的结论是 kettle 5.1 支持 apache hadoop 0.20.x版本 及cloudera hadoop CDH4.0 到CDH5。</strong></p> 
<p><br> </p> 
<p><br> </p> 
<h2><span style="color:#006600">3  试验运行：</span><br> </h2> 
<p><br> </p> 
<h3>1 首先配置工作<br> </h3> 
<p>当前我用的hadoop 版本是hadoop-2.2.0-cdh5.0 所以用kettle 5.1 且其内置有hadoop插件。去kettle官网下载： <img src="https://images2.imgbox.com/be/ec/88uKTyaH_o.jpg" alt=""><br> </p> 
<p><br> </p> 
<p>解压之后 就是：</p> 
<p><img src="https://images2.imgbox.com/83/2b/SQi2BIbB_o.jpg" alt=""></p> 
<p><br> </p> 
<p><br> </p> 
<p>下载好之后，现在就需要做配置的工作了，配置的工作在kettle安装文件里面做：</p> 
<p>配置办法参考：<span style="color:red"><a target="_blank" href="http://wiki.pentaho.com/display/BAD/Hadoop" rel="nofollow noopener noreferrer">http://wiki.pentaho.com/display/BAD/Hadoop</a></span></p> 
<p><br> </p> 
<p><img src="https://images2.imgbox.com/f4/ce/clpFPCP6_o.jpg" alt=""><br> </p> 
<p><br> </p> 
<p>进页面之后 先点击collapse 收缩所有的菜单树 如上图。  <span class="plugin_pagetree_children_span" id="childrenspan25037972-0"> <a target="_blank" href="http://wiki.pentaho.com/display/BAD/Configuring+Pentaho+for+your+Hadoop+Distro+and+Version" rel="nofollow noopener noreferrer">Configuring Pentaho for your Hadoop Distro and Version</a></span> 意思是为hadoop 版本做配置 点击进去：页面的上面 就是上面说过的kettle对hadoop的支持情况。</p> 
<p>我们到页面的中间部分去，如下图：</p> 
<p><img src="https://images2.imgbox.com/39/ad/KDrfOtB9_o.jpg" alt=""><br> </p> 
<p><br> </p> 
<p>1 意思是 你想要连接的hadoop发行版 已经被kettle支持了，但是没有内置插件，需要下载，这种情况最好 看下：<a target="_blank" href="http://wiki.pentaho.com/display/BAD/Install+Hadoop+Distribution+Shim" rel="nofollow noopener noreferrer" title="Install Hadoop Distribution Shim">Install Hadoop Distribution Shim</a></p> 
<p>2 意思是你想连接的hadoop发行版 还有没有被kettle支持，可以自己填写相应的信息 要求pentaho 开发一个。</p> 
<p>还有1种情况 就是上面说的hadoop发行版 已经被kettle支持了 且有内置的插件。</p> 
<p>3 就是配置了。</p> 
<p> 3.1 stop application 就是如果kettle在运行 先停掉他。</p> 
<p> 3.2 打开安装文件夹 我们这边是kettle 所以就是spoon那个的文件路径：</p> 
<p> <img src="https://images2.imgbox.com/82/4a/47W0uXoj_o.jpg" alt=""></p> 
<p> 3.3 编辑 plugin.properties文件</p> 
<p> 3.4 改一个配置值 下图画圈的地方<br> </p> 
<p> <img src="https://images2.imgbox.com/db/1d/0HspWYeT_o.jpg" alt=""></p> 
<p> 改成 对应你hadoop的shim值 （上图的表格里面的shim） 我这边是cdh50:</p> 
<p> <img src="https://images2.imgbox.com/5f/d7/zQsmk2pv_o.jpg" alt=""></p> 
<p> 改之后保存：</p> 
<p> <img src="https://images2.imgbox.com/ce/00/AkT2Luqw_o.jpg" alt=""></p> 
<p><strong>至此 配置工作做完。</strong></p> 
<p><br> </p> 
<p><br> </p> 
<h3>2 然后开发脚本工作</h3> 
<p><br> </p> 
<p>下面开始开发脚本 官方参考：<a target="_blank" href="http://wiki.pentaho.com/display/BAD/Loading+Data+into+HDFS" rel="nofollow noopener noreferrer">http://wiki.pentaho.com/display/BAD/Loading+Data+into+HDFS</a><br> </p> 
<p>打开 kettle 运行spoon.bat <br> </p> 
<p>:<img src="https://images2.imgbox.com/81/70/aD7wWR5H_o.jpg" alt=""></p> 
<p><br> </p> 
<p>新建一个kjb文件 拖一个开始图元<br> </p> 
<p><img src="https://images2.imgbox.com/fb/69/LUB2SgA7_o.jpg" alt=""><br> </p> 
<p><br> </p> 
<p>再拖一个<img src="https://images2.imgbox.com/28/0a/agYh26sA_o.jpg" alt=""></p> 
<p>hadoop copy files即是 load数据到 hdfs里面。</p> 
<p>copy files里面的配置：<br> </p> 
<p><img src="https://images2.imgbox.com/13/a8/0dU83Wwn_o.jpg" alt=""><br> </p> 
<p><br> </p> 
<p><img src="https://images2.imgbox.com/cf/2f/dUD4zdxB_o.jpg" alt=""> 意思是当前kjb脚本所在路径 在我这边文件夹是：</p> 
<p><br> </p> 
<p><img src="https://images2.imgbox.com/5b/ae/WL01iVkW_o.jpg" alt=""></p> 
<p>目标文件 是 hdfs://ip:hdfs端口/路径</p> 
<p><br> </p> 
<p><br> </p> 
<p>填之前可以点击<img src="https://images2.imgbox.com/02/40/z9g7F5Kl_o.jpg" alt="">browse 按钮 测试</p> 
<p>如下图 ：填好server 和port后  点击connect 如果没有报错 出现红框里面的hdfs://......... 就说明连接成功了（如下图）。</p> 
<p><br> </p> 
<p><img src="https://images2.imgbox.com/49/cf/etfWGEJD_o.jpg" alt=""></p> 
<p><br> </p> 
<p><span style="color:#CC0000"><strong>注意只要连接成功，说明kettle对hadoop的配置就没有问题。</strong></span><br> </p> 
<p><br> </p> 
<p>可以运行脚本试试了：</p> 
<p><img src="https://images2.imgbox.com/1a/53/cQwcee3h_o.jpg" alt=""><br> </p> 
<p>如上图，脚本运行成功。</p> 
<p><br> </p> 
<p>在hadoop home bin下面查看:</p> 
<p><img src="https://images2.imgbox.com/11/72/iAronzyv_o.jpg" alt="">文件成功load.</p> 
<p><br> </p> 
<p>至此，kettle load文本数据到hdfs成功！</p> 
<p><br> </p> 
<h2><span style="color:#006600">4 备注：</span><br> </h2> 
<p>所有的步骤都可以参考官网：</p> 
<p>http://wiki.pentaho.com/display/BAD/Hadoop</p> 
<p><img src="https://images2.imgbox.com/c8/ef/o0v3pUmm_o.jpg" alt=""><br> </p> 
<p><br> </p> 
<p>上图 1 是配置 2 是加载数据到hadoop 集群 3 是加载数据到hdfs 还有其他到 hive 到hbase等。<br> </p> 
<p><br> </p> 
<p>ps：写一段长的博客真累，感觉比干活还累<br> </p> 
<p><br> </p> 
<p><br> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e49801b3a0897fc5ddf0d98ee1454340/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">c&#43;&#43; 实现 http 上传和下载</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/af04d824154e8b78bf2c3869372a816f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">IPSEC 中的AH,ESP,SPI用途</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>