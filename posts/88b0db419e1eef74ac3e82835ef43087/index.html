<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Tomcat的maxParameterCount&amp;maxPostSize参数 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Tomcat的maxParameterCount&amp;maxPostSize参数" />
<meta property="og:description" content="Tomcat的maxParameterCount&amp;maxPostSize参数 Tomcat的maxParameterCount&amp;maxPostSize参数1.问题1.1问题现象1.2 参数总结1.3 问题总结 2 Tomcat官网的解释2.1 到`https://tomcat.apache.org/`找到文档入口2.2 找到文档的`Reference`2.3 查看配置文件的参数 3 文档看不明白，自己做实验吧。3.1 `maxParameterCount` 参数个数3.2 `maxPostSize`POST请求参数大小 4.实验配置 Tomcat的maxParameterCount&amp;maxPostSize参数 参考文章：
嵌入式Tomcat容器的参数(maxParameterCount&amp;maxPostSize)设定，参数过多解决方案
1.问题 1.1问题现象 周五同事说，请求的参数拿不到了。但是同一个接口请求参数太大就没有参数了，参数少的话服务端是有参数的。
打开浏览器的控制台，发现POST的请求参数中的有一个参数很大，所有的参数加起来有2.8M了。网上查了一下Tomcat的配置，
原来配置文件中有一个masPostSize的参数。因此这个博客来看看tomcat的maxParameterCount&amp;maxPostSize参数，看看是不是这个问题导致的。
这里截图看到线上是Content-Type: application/x-www-form-urlencoded;charset=UTF-8的POST请求类型，Content-Length:有问题的是2.8M，并不是这个截图所示的234B。
1.2 参数总结 maxParameterCount控制请求参数的个数，对于application/x-www-form-urlencoded or multipart/form-data的POST请求来说是请求参数和请求体参数总个数。超出的参数获取不到maxPostSize控制POST请求参数大小的限制。 application/x-www-form-urlencoded大小超过的参数获取不到。 multipart/form-data 大小超过异常报错。 1.3 问题总结 tomcat的maxPostSize没有设置，默认的是2M，请求是application/x-www-form-urlencoded 类型的，所以也不会报错。参数字节数小的可以获取到，参数字节数大的就获取不到了。
2 Tomcat官网的解释 2.1 到https://tomcat.apache.org/找到文档入口 2.2 找到文档的Reference 2.3 查看配置文件的参数 maxParameterCount The maximum total number of request parameters (including uploaded files) obtained from the query string and, for POST requests, the request body if the content type is application/x-www-form-urlencoded or multipart/form-data." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/88b0db419e1eef74ac3e82835ef43087/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-21T14:48:01+08:00" />
<meta property="article:modified_time" content="2024-01-21T14:48:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Tomcat的maxParameterCount&amp;maxPostSize参数</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Tomcat的maxParameterCount&amp;maxPostSize参数</h4> 
 <ul><li><a href="#TomcatmaxParameterCountmaxPostSize_1" rel="nofollow">Tomcat的maxParameterCount&amp;maxPostSize参数</a></li><li><ul><li><a href="#1_4" rel="nofollow">1.问题</a></li><li><ul><li><a href="#11_5" rel="nofollow">1.1问题现象</a></li><li><a href="#12__13" rel="nofollow">1.2 参数总结</a></li><li><a href="#13__20" rel="nofollow">1.3 问题总结</a></li></ul> 
   </li><li><a href="#2_Tomcat_23" rel="nofollow">2 Tomcat官网的解释</a></li><li><ul><li><a href="#21_httpstomcatapacheorg_24" rel="nofollow">2.1 到`https://tomcat.apache.org/`找到文档入口</a></li><li><a href="#22_Reference_26" rel="nofollow">2.2 找到文档的`Reference`</a></li><li><a href="#23__28" rel="nofollow">2.3 查看配置文件的参数</a></li></ul> 
   </li><li><a href="#3__219" rel="nofollow">3 文档看不明白，自己做实验吧。</a></li><li><ul><li><a href="#31_maxParameterCount__230" rel="nofollow">3.1 `maxParameterCount` 参数个数</a></li><li><a href="#32_maxPostSizePOST_306" rel="nofollow">3.2 `maxPostSize`POST请求参数大小</a></li></ul> 
   </li><li><a href="#4_371" rel="nofollow">4.实验配置</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="TomcatmaxParameterCountmaxPostSize_1"></a>Tomcat的maxParameterCount&amp;maxPostSize参数</h2> 
<p>参考文章：<br> <a href="https://blog.csdn.net/ryuenkyo/article/details/101026537">嵌入式Tomcat容器的参数(maxParameterCount&amp;maxPostSize)设定，参数过多解决方案</a></p> 
<h3><a id="1_4"></a>1.问题</h3> 
<h4><a id="11_5"></a>1.1问题现象</h4> 
<p>周五同事说，请求的参数拿不到了。但是同一个接口请求参数太大就没有参数了，参数少的话服务端是有参数的。</p> 
<blockquote> 
 <p>打开浏览器的控制台，发现<code>POST</code>的请求参数中的有一个参数很大，所有的参数加起来有<code>2.8M</code>了。网上查了一下<code>Tomcat</code>的配置，<br> 原来配置文件中有一个<code>masPostSize</code>的参数。因此这个博客来看看<code>tomcat</code>的<code>maxParameterCount&amp;maxPostSize</code>参数，看看是不是这个问题导致的。</p> 
</blockquote> 
<p>这里截图看到线上是<code>Content-Type: application/x-www-form-urlencoded;charset=UTF-8</code>的POST请求类型，<code>Content-Length:</code>有问题的是2.8M，并不是这个截图所示的234B。<br> <img src="https://images2.imgbox.com/ee/ce/aoFTbDmk_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="12__13"></a>1.2 参数总结</h4> 
<ul><li><code>maxParameterCount</code>控制请求参数的个数，对于<code>application/x-www-form-urlencoded or multipart/form-data</code>的POST请求来说是请求参数和请求体参数总个数。超出的参数获取不到</li><li><code>maxPostSize</code>控制POST请求参数大小的限制。 
  <ul><li><code>application/x-www-form-urlencoded</code>大小超过的参数获取不到。</li><li><code> multipart/form-data</code> 大小超过异常报错。</li></ul> </li></ul> 
<h4><a id="13__20"></a>1.3 问题总结</h4> 
<p>tomcat的maxPostSize没有设置，默认的是2M，请求是<code>application/x-www-form-urlencoded </code>类型的，所以也不会报错。参数字节数小的可以获取到，参数字节数大的就获取不到了。</p> 
<h3><a id="2_Tomcat_23"></a>2 Tomcat官网的解释</h3> 
<h4><a id="21_httpstomcatapacheorg_24"></a>2.1 到<code>https://tomcat.apache.org/</code>找到文档入口</h4> 
<p><img src="https://images2.imgbox.com/10/3c/a1dMNgDN_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="22_Reference_26"></a>2.2 找到文档的<code>Reference</code></h4> 
<p><img src="https://images2.imgbox.com/85/d4/eWu8O12f_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/cd/06/keWXnLcq_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="23__28"></a>2.3 查看配置文件的参数</h4> 
<ul><li><strong>maxParameterCount</strong> 
  <ul><li><code>The maximum total number of request parameters (including uploaded files) obtained from the query string and, for POST requests, the request body if the content type is application/x-www-form-urlencoded or multipart/form-data. Request parameters beyond this limit will be ignored. A value of less than 0 means no limit. If not specified, a default of 10000 is used. Note that FailedRequestFilter filter can be used to reject requests that exceed the limit.</code></li><li>参数个数，超出的部分会被忽略，默认是1w个参数</li></ul> </li><li><strong>maxPostSize</strong> 
  <ul><li><code>The maximum size in bytes of the POST which will be handled by the container FORM URL parameter parsing. The limit can be disabled by setting this attribute to a value less than zero. If not specified, this attribute is set to 2097152 (2 MiB). Note that the FailedRequestFilter can be used to reject requests that exceed this limit.</code></li><li>POST请求体参数的大小，字节单位，这里没说超过了会怎么样。<br> <img src="https://images2.imgbox.com/ed/a1/l6FOJkYA_o.png" alt="在这里插入图片描述"></li></ul> </li></ul> 
<pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token comment">&lt;!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--&gt;</span>
<span class="token comment">&lt;!-- Note:  A "Server" is not itself a "Container", so you may not
     define subcomponents such as "Valves" at this level.
     Documentation at /docs/config/server.html
 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Server</span> <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>8005<span class="token punctuation">"</span></span> <span class="token attr-name">shutdown</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>SHUTDOWN<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Listener</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.apache.catalina.startup.VersionLoggerListener<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token comment">&lt;!-- Security listener. Documentation at /docs/config/listeners.html
  &lt;Listener className="org.apache.catalina.security.SecurityListener" /&gt;
  --&gt;</span>
  <span class="token comment">&lt;!-- APR library loader. Documentation at /docs/apr.html --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Listener</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.apache.catalina.core.AprLifecycleListener<span class="token punctuation">"</span></span> <span class="token attr-name">SSLEngine</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>on<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token comment">&lt;!-- Prevent memory leaks due to use of particular java/javax APIs--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Listener</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.apache.catalina.core.JreMemoryLeakPreventionListener<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Listener</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.apache.catalina.mbeans.GlobalResourcesLifecycleListener<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Listener</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.apache.catalina.core.ThreadLocalLeakPreventionListener<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>

  <span class="token comment">&lt;!-- Global JNDI resources
       Documentation at /docs/jndi-resources-howto.html
  --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>GlobalNamingResources</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Editable user database that can also be used by
         UserDatabaseRealm to authenticate users
    --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Resource</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UserDatabase<span class="token punctuation">"</span></span> <span class="token attr-name">auth</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Container<span class="token punctuation">"</span></span>
              <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.apache.catalina.UserDatabase<span class="token punctuation">"</span></span>
              <span class="token attr-name">description</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>User database that can be updated and saved<span class="token punctuation">"</span></span>
              <span class="token attr-name">factory</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.apache.catalina.users.MemoryUserDatabaseFactory<span class="token punctuation">"</span></span>
              <span class="token attr-name">pathname</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>conf/tomcat-users.xml<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>GlobalNamingResources</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- A "Service" is a collection of one or more "Connectors" that share
       a single "Container" Note:  A "Service" is not itself a "Container",
       so you may not define subcomponents such as "Valves" at this level.
       Documentation at /docs/config/service.html
   --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Service</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Catalina<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!--The connectors can use a shared executor, you can define one or more named thread pools--&gt;</span>
    <span class="token comment">&lt;!--
    &lt;Executor name="tomcatThreadPool" namePrefix="catalina-exec-"
        maxThreads="150" minSpareThreads="4"/&gt;
    --&gt;</span>


    <span class="token comment">&lt;!-- A "Connector" represents an endpoint by which requests are received
         and responses are returned. Documentation at :
         Java HTTP Connector: /docs/config/http.html
         Java AJP  Connector: /docs/config/ajp.html
         APR (HTTP/AJP) Connector: /docs/apr.html
         Define a non-SSL/TLS HTTP/1.1 Connector on port 8080
    --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Connector</span> <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>8080<span class="token punctuation">"</span></span> <span class="token attr-name">protocol</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>HTTP/1.1<span class="token punctuation">"</span></span>
               <span class="token attr-name">connectionTimeout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>20000<span class="token punctuation">"</span></span>
               <span class="token attr-name">redirectPort</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>8443<span class="token punctuation">"</span></span>
               <span class="token attr-name">maxPostSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>7<span class="token punctuation">"</span></span>
               <span class="token attr-name">maxParameterCount</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span>
               <span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- A "Connector" using the shared thread pool--&gt;</span>
    <span class="token comment">&lt;!--
    &lt;Connector executor="tomcatThreadPool"
               port="8080" protocol="HTTP/1.1"
               connectionTimeout="20000"
               redirectPort="8443"
               maxParameterCount="1000"
               /&gt;
    --&gt;</span>
    <span class="token comment">&lt;!-- Define an SSL/TLS HTTP/1.1 Connector on port 8443
         This connector uses the NIO implementation. The default
         SSLImplementation will depend on the presence of the APR/native
         library and the useOpenSSL attribute of the AprLifecycleListener.
         Either JSSE or OpenSSL style configuration may be used regardless of
         the SSLImplementation selected. JSSE style configuration is used below.
    --&gt;</span>
    <span class="token comment">&lt;!--
    &lt;Connector port="8443" protocol="org.apache.coyote.http11.Http11NioProtocol"
               maxThreads="150" SSLEnabled="true"
               maxParameterCount="1000"
               &gt;
        &lt;SSLHostConfig&gt;
            &lt;Certificate certificateKeystoreFile="conf/localhost-rsa.jks"
                         type="RSA" /&gt;
        &lt;/SSLHostConfig&gt;
    &lt;/Connector&gt;
    --&gt;</span>
    <span class="token comment">&lt;!-- Define an SSL/TLS HTTP/1.1 Connector on port 8443 with HTTP/2
         This connector uses the APR/native implementation which always uses
         OpenSSL for TLS.
         Either JSSE or OpenSSL style configuration may be used. OpenSSL style
         configuration is used below.
    --&gt;</span>
    <span class="token comment">&lt;!--
    &lt;Connector port="8443" protocol="org.apache.coyote.http11.Http11AprProtocol"
               maxThreads="150" SSLEnabled="true"
               maxParameterCount="1000"
               &gt;
        &lt;UpgradeProtocol className="org.apache.coyote.http2.Http2Protocol" /&gt;
        &lt;SSLHostConfig&gt;
            &lt;Certificate certificateKeyFile="conf/localhost-rsa-key.pem"
                         certificateFile="conf/localhost-rsa-cert.pem"
                         certificateChainFile="conf/localhost-rsa-chain.pem"
                         type="RSA" /&gt;
        &lt;/SSLHostConfig&gt;
    &lt;/Connector&gt;
    --&gt;</span>

    <span class="token comment">&lt;!-- Define an AJP 1.3 Connector on port 8009 --&gt;</span>
    <span class="token comment">&lt;!--
    &lt;Connector protocol="AJP/1.3"
               address="::1"
               port="8009"
               redirectPort="8443"
               maxParameterCount="1000"
               /&gt;
    --&gt;</span>

    <span class="token comment">&lt;!-- An Engine represents the entry point (within Catalina) that processes
         every request.  The Engine implementation for Tomcat stand alone
         analyzes the HTTP headers included with the request, and passes them
         on to the appropriate Host (virtual host).
         Documentation at /docs/config/engine.html --&gt;</span>

    <span class="token comment">&lt;!-- You should set jvmRoute to support load-balancing via AJP ie :
    &lt;Engine name="Catalina" defaultHost="localhost" jvmRoute="jvm1"&gt;
    --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Engine</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Catalina<span class="token punctuation">"</span></span> <span class="token attr-name">defaultHost</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!--For clustering, please take a look at documentation at:
          /docs/cluster-howto.html  (simple how to)
          /docs/config/cluster.html (reference documentation) --&gt;</span>
      <span class="token comment">&lt;!--
      &lt;Cluster className="org.apache.catalina.ha.tcp.SimpleTcpCluster"/&gt;
      --&gt;</span>

      <span class="token comment">&lt;!-- Use the LockOutRealm to prevent attempts to guess user passwords
           via a brute-force attack --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Realm</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.apache.catalina.realm.LockOutRealm<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- This Realm uses the UserDatabase configured in the global JNDI
             resources under the key "UserDatabase".  Any edits
             that are performed against this UserDatabase are immediately
             available for use by the Realm.  --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Realm</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.apache.catalina.realm.UserDatabaseRealm<span class="token punctuation">"</span></span>
               <span class="token attr-name">resourceName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UserDatabase<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Realm</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Host</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost<span class="token punctuation">"</span></span>  <span class="token attr-name">appBase</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>webapps<span class="token punctuation">"</span></span>
            <span class="token attr-name">unpackWARs</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">autoDeploy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">&lt;!-- SingleSignOn valve, share authentication between web applications
             Documentation at: /docs/config/valve.html --&gt;</span>
        <span class="token comment">&lt;!--
        &lt;Valve className="org.apache.catalina.authenticator.SingleSignOn" /&gt;
        --&gt;</span>

        <span class="token comment">&lt;!-- Access log processes all example.
             Documentation at: /docs/config/valve.html
             Note: The pattern used is equivalent to using pattern="common" --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Valve</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.apache.catalina.valves.AccessLogValve<span class="token punctuation">"</span></span> <span class="token attr-name">directory</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>logs<span class="token punctuation">"</span></span>
               <span class="token attr-name">prefix</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost_access_log<span class="token punctuation">"</span></span> <span class="token attr-name">suffix</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>.txt<span class="token punctuation">"</span></span>
               <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>%h %l %u %t <span class="token entity named-entity" title='"'>&amp;quot;</span>%r<span class="token entity named-entity" title='"'>&amp;quot;</span> %s %b<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Host</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Engine</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Service</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Server</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3><a id="3__219"></a>3 文档看不明白，自己做实验吧。</h3> 
<pre><code class="prism language-xml">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Connector</span> <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>8080<span class="token punctuation">"</span></span> <span class="token attr-name">protocol</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>HTTP/1.1<span class="token punctuation">"</span></span>
               <span class="token attr-name">connectionTimeout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>20000<span class="token punctuation">"</span></span>
               <span class="token attr-name">redirectPort</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>8443<span class="token punctuation">"</span></span>
               <span class="token attr-name">maxPostSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>7<span class="token punctuation">"</span></span>
               <span class="token attr-name">maxParameterCount</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span>
               <span class="token punctuation">/&gt;</span></span>
</code></pre> 
<ul><li>参数个数最大2个</li><li>POST请求大小最大7个</li></ul> 
<h4><a id="31_maxParameterCount__230"></a>3.1 <code>maxParameterCount</code> 参数个数</h4> 
<ul><li>GET请求参数的个数超过之后，多出来的就取不到了。</li></ul> 
<pre><code class="prism language-shell"> ~/data/ 
 ~/data/ <span class="token function">curl</span> <span class="token parameter variable">-s</span>  <span class="token parameter variable">--location</span> <span class="token string">'http://localhost:8080/?m=m&amp;m1=m1&amp;m2=m2'</span> <span class="token operator">|</span> jq <span class="token builtin class-name">.</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token string">"m"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token string">"m"</span>
  <span class="token punctuation">]</span>,
  <span class="token string">"m1"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token string">"m1"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
 ~/data/ 
 ~/data/ <span class="token function">curl</span> <span class="token parameter variable">-s</span>  <span class="token parameter variable">--location</span> <span class="token string">'http://localhost:8080/?m=m&amp;m1=m1'</span> <span class="token operator">|</span> jq <span class="token builtin class-name">.</span>      
<span class="token punctuation">{<!-- --></span>
  <span class="token string">"m"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token string">"m"</span>
  <span class="token punctuation">]</span>,
  <span class="token string">"m1"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token string">"m1"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
 ~/data/ 
</code></pre> 
<ul><li>POST的请求参数个数超过过之后，多出来的就取不到了。</li></ul> 
<pre><code> ~/data/ 
 ~/data/ curl -s  --location --request POST 'http://localhost:8080/test?m=m&amp;m1=m1&amp;m2=m2' | jq .
{
  "m": [
    "m"
  ],
  "m1": [
    "m1"
  ]
}
 ~/data/ 
 ~/data/ 
 ~/data/ curl -s  --location --request POST 'http://localhost:8080/test?m=m&amp;m1=m1' | jq .      
{
  "m": [
    "m"
  ],
  "m1": [
    "m1"
  ]
}
 ~/data/ 
 ~/data/ curl --location 'http://localhost:8080/test?m=m&amp;m1=m1&amp;m2=m2' \
--header 'Content-Type: application/x-www-form-urlencoded' -s \
--data-urlencode 'm3=m3' | jq .
{
  "m": [
    "m"
  ],
  "m1": [
    "m1"
  ]
}
 ~/data/ 
 ~/data/ curl --location 'http://localhost:8080/test?m=m' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--data-urlencode 'm3=m3' -s | jq .
{
  "m": [
    "m"
  ],
  "m3": [
    "m3"
  ]
}
 ~/data/ 
 ~/data/ 
</code></pre> 
<h4><a id="32_maxPostSizePOST_306"></a>3.2 <code>maxPostSize</code>POST请求参数大小</h4> 
<ul><li><code>Content-Type: application/x-www-form-urlencoded</code>大小没有超过都可以获取到，超过大小都获取不到</li></ul> 
<pre><code class="prism language-shell"> ~/data/ 
 ~/data/ <span class="token function">curl</span> <span class="token parameter variable">--location</span> <span class="token string">'http://localhost:8080/test'</span> <span class="token parameter variable">-s</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--header</span> <span class="token string">'Content-Type: application/x-www-form-urlencoded'</span> <span class="token punctuation">\</span>
--data-urlencode <span class="token string">'j=12345'</span> <span class="token operator">|</span> jq <span class="token builtin class-name">.</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token string">"j"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token string">"12345"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
 ~/data/ 
 ~/data/ 
 ~/data/ 
 ~/data/ <span class="token function">curl</span> <span class="token parameter variable">--location</span> <span class="token string">'http://localhost:8080/test'</span> <span class="token parameter variable">-s</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--header</span> <span class="token string">'Content-Type: application/x-www-form-urlencoded'</span> <span class="token punctuation">\</span>
--data-urlencode <span class="token string">'j=123456'</span> <span class="token operator">|</span> jq <span class="token builtin class-name">.</span>
<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
 ~/data/ 
 ~/data/ <span class="token function">curl</span> <span class="token parameter variable">--location</span> <span class="token string">'http://localhost:8080/test'</span> <span class="token parameter variable">-s</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--header</span> <span class="token string">'Content-Type: application/x-www-form-urlencoded'</span> <span class="token punctuation">\</span>
--data-urlencode <span class="token string">'j=1'</span> <span class="token punctuation">\</span>
--data-urlencode <span class="token string">'i=2'</span> <span class="token operator">|</span> jq <span class="token builtin class-name">.</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token string">"j"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token string">"1"</span>
  <span class="token punctuation">]</span>,
  <span class="token string">"i"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token string">"2"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
 ~/data/ 
 ~/data/ 
 ~/data/ <span class="token function">curl</span> <span class="token parameter variable">--location</span> <span class="token string">'http://localhost:8080/test'</span> <span class="token parameter variable">-s</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--header</span> <span class="token string">'Content-Type: application/x-www-form-urlencoded'</span> <span class="token punctuation">\</span>
--data-urlencode <span class="token string">'j=1'</span> <span class="token punctuation">\</span>
--data-urlencode <span class="token string">'i=23'</span> <span class="token operator">|</span> jq <span class="token builtin class-name">.</span>
<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
 ~/data/ 
 ~/data/ 
</code></pre> 
<ul><li><code>multipart/form-data; boundary=&lt;calculated when request is sent&gt;</code> 大小没有超过都可以获取到，超过大小报错</li></ul> 
<pre><code class="prism language-shell"> ~/data/ 
 ~/data/ <span class="token function">curl</span> <span class="token parameter variable">--location</span> <span class="token string">'http://localhost:8080/test'</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--form</span> <span class="token string">'j="1234"'</span> <span class="token parameter variable">-s</span> <span class="token operator">|</span> jq <span class="token builtin class-name">.</span> 
<span class="token punctuation">{<!-- --></span>
  <span class="token string">"j"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token string">"1234"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
 ~/data/ <span class="token function">curl</span> <span class="token parameter variable">--location</span> <span class="token string">'http://localhost:8080/test'</span> <span class="token parameter variable">-s</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--form</span> <span class="token string">'j="12345"'</span><span class="token operator">|</span>jq <span class="token builtin class-name">.</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token string">"timestamp"</span><span class="token builtin class-name">:</span> <span class="token number">1705816422926</span>,
  <span class="token string">"status"</span><span class="token builtin class-name">:</span> <span class="token number">500</span>,
  <span class="token string">"error"</span><span class="token builtin class-name">:</span> <span class="token string">"Internal Server Error"</span>,
  <span class="token string">"exception"</span><span class="token builtin class-name">:</span> <span class="token string">"org.springframework.web.multipart.MultipartException"</span>,
  <span class="token string">"message"</span><span class="token builtin class-name">:</span> <span class="token string">"Could not parse multipart servlet request; nested exception is java.lang.IllegalStateException: The multi-part request contained parameter data (excluding uploaded files) that exceeded the limit for maxPostSize set on the associated connector"</span>,
  <span class="token string">"path"</span><span class="token builtin class-name">:</span> <span class="token string">"/test"</span>
<span class="token punctuation">}</span>
 ~/data/ 
</code></pre> 
<h3><a id="4_371"></a>4.实验配置</h3> 
<pre><code class="prism language-shell"> ~/data/  <span class="token function">docker</span> pull tomcat:8.5.98
 ~/data/  <span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">8080</span>:8080 <span class="token parameter variable">-v</span> /Users/admin/data/tomcat/webapps:/usr/local/tomcat/webapps tomcat:8.5.98
90f2cfa859c67e3886f67d8b862005c196944cbc037efc64e2e1417b450ae174
 ~/data/ server.xml的配置见上文
 ~/data/ <span class="token function">docker</span> <span class="token function">cp</span> ./server.xml 90f2cfa859c6:/usr/local/tomcat/conf/server.xml
 ~/data/ <span class="token function">java</span> 代码：https://github.com/xiaolixi/spring/tree/main/springboot-resttemplate
</code></pre> 
<p><code>https://tomcat.apache.org/tomcat-8.5-doc/servletapi/javax/servlet/ServletRequest.html#getParameterMap()</code><br> <img src="https://images2.imgbox.com/0f/f2/vmyaZWgW_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b83258c4db2a1b35e9c01d8d56a1d3ba/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">从0开始学C&#43;&#43; 第十七课：运算符重载</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/15b30c759bbe8ac426925aec3dd80158/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">linux中报错Caused by: java.nio.file.NoSuchFileException: storage/03k3uv7k1lijsd5r1bo0.jpg</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>