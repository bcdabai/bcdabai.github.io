<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>luvcview分析--3.用SDL显示camera的图像 - 编程大白的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="luvcview分析--3.用SDL显示camera的图像" />
<meta property="og:description" content="一. 用SDL显示camera图像 1. SDL 虽然把图像写到文件中去己经很好很强大了,但进一步实时的显示图片是不是更好？ 这就需要用到SDL了 2. 源码 2.1 display.c cong@msi:/work/test/uvcview/3display$ cat display.c #include &#34;utils.h&#34; #include &lt;sys/types.h&gt; #include &lt;sys/stat.h&gt; #include &lt;fcntl.h&gt; #include &lt;linux/videodev2.h&gt; #include &lt;sys/mman.h&gt; #include &lt;SDL/SDL.h&gt; #define VIDEO_DEVICE &#34;/dev/video0&#34; #define NB_BUFFER 4 int fd; int ret = 0; struct v4l2_capability cap; struct v4l2_format fmt; struct v4l2_requestbuffers rb; struct v4l2_buffer vbuf; void* vmem[NB_BUFFER]; unsigned char* tempbuffer; unsigned char* framebuffer; int type; int framesize; int width = 640; //1280; //640; int height= 480; // 720; // 480; float fps = 30." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bcdabai.github.io/posts/0ad1f1dcd15fce5340f94e18929aaa38/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-09-01T14:08:38+08:00" />
<meta property="article:modified_time" content="2016-09-01T14:08:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程大白的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程大白的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">luvcview分析--3.用SDL显示camera的图像</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <span style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"><span style="word-wrap:break-word; font-size:24px">一. 用SDL显示camera图像</span></span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">1. SDL</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">虽然把图像写到文件中去己经很好很强大了,但进一步实时的显示图片是不是更好？</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">这就需要用到SDL了</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">2. 源码</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">2.1 display.c</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<div id="codeText" class="codeText" style="word-wrap:break-word; border:1px solid rgb(221,221,221); width:1564.53px; overflow:auto; margin:0px 0px 1.1em; padding:0px; word-break:break-all; letter-spacing:0.1px; font-family:Consolas,monospace; color:rgb(102,102,102)"> 
 <ol start="1" class="dp-css none_number" style="word-wrap:break-word; margin:0px 1px 0px 0px; padding:5px 0pt; list-style:none outside none; color:rgb(92,92,92); line-height:1.3"><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,0)">cong@msi<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>work<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>test<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>uvcview<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>3display$ cat display<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>c <br style="word-wrap:break-word"> </span></li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #include <span style="word-wrap:break-word; color:rgb(255,0,255)">"utils.h"</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #include <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>sys<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>types<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>h<span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #include <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>sys<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>stat<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>h<span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #include <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>fcntl<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>h<span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #include <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>linux<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>videodev2<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>h<span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #include <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>sys<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>mman<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>h<span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #include <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>SDL<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>SDL<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>h<span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #define VIDEO_DEVICE <span style="word-wrap:break-word; color:rgb(255,0,255)">"/dev/video0"</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #define NB_BUFFER 4<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> fd<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> ret <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> struct v4l2_capability cap<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> struct v4l2_format fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> struct v4l2_requestbuffers rb<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> struct v4l2_buffer vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> void<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> vmem<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span>NB_BUFFER<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> unsigned char<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> tempbuffer<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> unsigned char<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> framebuffer<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> type<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> framesize<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> width <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> 640<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>1280<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>640<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> height<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> 480<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span> 720<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span> 480<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> float fps <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> 30<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> format <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_PIX_FMT_YUYV<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> init_camera<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_open<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>VIDEO_DEVICE<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span>O_RDWR<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span><span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>1<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>check format <span style="word-wrap:break-word; color:rgb(0,0,255)">is</span> valid<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(255,0,0)">fix</span> me <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,255)">set</span> format <span style="word-wrap:break-word; color:rgb(0,0,255)">and</span> frame size<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     memset<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> sizeof<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>struct v4l2_fmtdesc<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>type <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_BUF_TYPE_VIDEO_CAPTURE<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>pix<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>width <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> width<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>pix<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>height <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> height<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>pix<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>field <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_FIELD_ANY<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_S_FMT<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>mmap buffer<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span> reqbufs<span style="word-wrap:break-word; color:rgb(0,0,204)">-</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span> querybuf <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span> mmap <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span> QBUF<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     memset<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>rb<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> sizeof<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>struct v4l2_requestbuffers<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     rb<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>count <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> NB_BUFFER<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     rb<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>type <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_BUF_TYPE_VIDEO_CAPTURE<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     rb<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>memory <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_MEMORY_MMAP<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_REQBUFS<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>rb<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0 <span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">for</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>i<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>NB_BUFFER<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">+</span><span style="word-wrap:break-word; color:rgb(0,0,204)">+</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         memset<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> sizeof<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>struct v4l2_buffer<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>index <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>type <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_BUF_TYPE_VIDEO_CAPTURE<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>memory <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_MEMORY_MMAP<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_QUERYBUF<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"len=%d, offset=%d"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>length<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>m<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>offset<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>vmem<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span>i<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_mmap<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>length<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> PROT_READ<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> MAP_SHARED<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>m<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>offset<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span><span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> MAP_FAILED<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>vmem<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span>i<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> mmap<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>length<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> PROT_READ<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> MAP_SHARED<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>m<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>offset<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span><span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> MAP_FAILED<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span>    <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"Buffer mapped at address %p"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vmem<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span>i<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">for</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>i<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>NB_BUFFER<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">+</span><span style="word-wrap:break-word; color:rgb(0,0,204)">+</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         memset<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> sizeof<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>struct v4l2_buffer<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>index <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>type <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_BUF_TYPE_VIDEO_CAPTURE<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>memory <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_MEMORY_MMAP<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_QBUF<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>alloc framebuffer<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     framesize <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>width<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span>height<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>1<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">!</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>tempbuffer <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> malloc<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>framesize<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">!</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>framebuffer <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> malloc<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>width<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span>height<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span>8<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     type <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_BUF_TYPE_VIDEO_CAPTURE<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_STREAMON<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>type<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> main <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> argc<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> char <span style="word-wrap:break-word; color:rgb(0,0,204)">*</span>argv<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span><span style="word-wrap:break-word; color:rgb(0,0,204)">]</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     SDL_Surface<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> psscreen<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     SDL_Overlay<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> overlay<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     SDL_Rect drect<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     unsigned char<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> p<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     SDL_Init<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>SDL_INIT_EVERYTHING<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     psscreen <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> SDL_SetVideoMode<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>width<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> height<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> SDL_SWSURFACE<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     SDL_WM_SetCaption<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(255,0,255)">"YUV Window"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,255)">NULL</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> Create a YUV overlay <span style="word-wrap:break-word; color:rgb(0,0,204)">*</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     overlay <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> SDL_CreateYUVOverlay<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>width<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> height<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> SDL_YUY2_OVERLAY<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> psscreen<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     p <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>unsigned char<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> overlay<span style="word-wrap:break-word; color:rgb(0,0,204)">-</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span>pixels<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     drect<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>x <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     drect<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>y <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     drect<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>w <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> width<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     drect<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>h <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> height<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     init_camera<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">while</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>1<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         memset<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> sizeof<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>struct v4l2_buffer<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>type <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_BUF_TYPE_VIDEO_CAPTURE<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>memory <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_MEMORY_MMAP<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_DQBUF<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>bytesused <span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span> framesize<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             memcpy<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>framebuffer<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vmem<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>index<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>size_t<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span>framesize<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><span style="word-wrap:break-word; color:rgb(0,0,255)">else</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             memcpy<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>framebuffer<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vmem<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>index<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>size_t<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>bytesused<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span>v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_QBUF<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">                 dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">                 return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         SDL_LockYUVOverlay<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>overlay<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         memcpy<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>p<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> framebuffer<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> width<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span>height<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span>2<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         SDL_UnlockYUVOverlay<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>overlay<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         SDL_DisplayYUVOverlay<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>overlay<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>drect<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         SDL_Delay<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>10<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     return EXIT_SUCCESS<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span></li></ol> 
</div> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">2.2 Makefile</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<div id="codeText" class="codeText" style="word-wrap:break-word; border:1px solid rgb(221,221,221); width:1564.53px; overflow:auto; margin:0px 0px 1.1em; padding:0px; word-break:break-all; letter-spacing:0.1px; font-family:Consolas,monospace; color:rgb(102,102,102)"> 
 <ol start="1" class="dp-css none_number" style="word-wrap:break-word; margin:0px 1px 0px 0px; padding:5px 0pt; list-style:none outside none; color:rgb(92,92,92); line-height:1.3"><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,0)">cong@msi<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>work<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>test<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>uvcview<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>3display$ cat Makefile <br style="word-wrap:break-word"> </span></li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> EXE<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span>display<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> CC<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span>gcc<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> SRC<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>wildcard <span style="word-wrap:break-word; color:rgb(0,0,204)">*</span><span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>c<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #OBJ<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>SRC<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span><span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>c<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span><span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>o<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> OBJ<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>patsubst <span style="word-wrap:break-word; color:rgb(0,0,204)">%</span><span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>c<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span><span style="word-wrap:break-word; color:rgb(0,0,204)">%</span><span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>o<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>SRC<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> DEP<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>patsubst <span style="word-wrap:break-word; color:rgb(0,0,204)">%</span><span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>c<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span><span style="word-wrap:break-word; color:rgb(0,0,204)">.</span><span style="word-wrap:break-word; color:rgb(0,0,204)">%</span><span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>d<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>SRC<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> CFLAGS<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span><span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>g <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>O0 <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>I<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>work<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>test<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>uvcview<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>libv4l2<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>libv4l<span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>6<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>1<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>include <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>DUSE_SDL <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>O2 <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>DLINUX <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>DVERSION<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span><span style="word-wrap:break-word; color:rgb(0,0,204)">\</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"0.2.6\"</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>D_GNU_SOURCE<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span>1 <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>D_REENTRANT<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #V4L2LIBS <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> $<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>shell pkg<span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>config <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span><span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>libs libv4l2<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>lSDL<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> V4L2LIBS <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>L<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>work<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>test<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>uvcview<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>libv4l2<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>libv4l<span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>6<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>1<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>libv4l2 <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>lv4l2 <span style="word-wrap:break-word; color:rgb(0,0,204)">\</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">          <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>L<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>work<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>test<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>uvcview<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>libv4l2<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>libv4l<span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>6<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>1<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>libv4lconvert<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>lv4lconvert <span style="word-wrap:break-word; color:rgb(0,0,204)">\</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>lrt <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>lm <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>lSDL                       <span style="word-wrap:break-word"><span style="word-wrap:break-word; color:rgb(229,51,51)">--&gt;链接库中加入了SDL</span></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> $<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>EXE<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">:</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>OBJ<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     $<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>CC<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> $<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>CFLAGS<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> $^ <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>o $@ $<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>V4L2LIBS<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> $<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>DEP<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">:</span><span style="word-wrap:break-word; color:rgb(0,0,204)">.</span><span style="word-wrap:break-word; color:rgb(0,0,204)">%</span><span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>d<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span><span style="word-wrap:break-word; color:rgb(0,0,204)">%</span><span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>c<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     @<span style="word-wrap:break-word; color:rgb(0,0,255)">set</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>e<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> rm <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>f $@<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">\</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     $<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>CC<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>MM $<span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span> $@<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">\</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     sed <span style="word-wrap:break-word; color:rgb(0,0,204)">'</span>s<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">*</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>o<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">:</span><span style="word-wrap:break-word; color:rgb(0,0,204)">]</span><span style="word-wrap:break-word; color:rgb(0,0,204)">*</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>1<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>o $@ <span style="word-wrap:break-word; color:rgb(0,0,204)">:</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">,</span>g<span style="word-wrap:break-word; color:rgb(0,0,204)">'</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> $@<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span> $@<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">\</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     rm <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>f $@<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><span style="word-wrap:break-word; color:rgb(0,0,204)">$</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>include $<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>DEP<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> clean<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     @rm $<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>EXE<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> $<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>OBJ<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> $<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>DEP<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>f<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> cong@msi<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>work<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>test<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>uvcview<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>3display$</li></ol> 
</div> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">3.源码打包</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<a target="_blank" href="http://blog.chinaunix.net/blog/downLoad/fileid/11639.html" rel="nofollow noopener noreferrer" style="word-wrap:break-word; text-decoration:none; color:rgb(86,86,86); font-family:宋体,Arial; font-size:16px; line-height:26px"><img src="https://images2.imgbox.com/20/4f/hYQ0OOeR_o.png" align="middle" alt="" style="word-wrap:break-word; border:0px">3display.rar</a> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> (下载后改名为3display.tar.gz)</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<hr style="word-wrap:break-word; margin:0px; padding:0px; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"><span style="word-wrap:break-word; font-size:24px">二. 改进</span></span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">1. 有图像显示出来了,但是还有几个问题</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">a. 程序结束不了,只能用kill强制杀死,</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">    这样做后,下次必需插拔usb摄像头才能正常使用</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">b. 关于v4l2_mmap这一直有个疑问</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">    为什么在luvcview的源码中没有问题,而我这儿一用就segment fault呢?</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">2.1 代码</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<div id="codeText" class="codeText" style="word-wrap:break-word; border:1px solid rgb(221,221,221); width:1564.53px; overflow:auto; margin:0px 0px 1.1em; padding:0px; word-break:break-all; letter-spacing:0.1px; font-family:Consolas,monospace; color:rgb(102,102,102)"> 
 <ol start="1" class="dp-css none_number" style="word-wrap:break-word; margin:0px 1px 0px 0px; padding:5px 0pt; list-style:none outside none; color:rgb(92,92,92); line-height:1.3"><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,0)">cong@msi<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>work<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>test<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>uvcview<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>3display_1$ cat display<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>c <br style="word-wrap:break-word"> </span></li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #include <span style="word-wrap:break-word; color:rgb(255,0,255)">"utils.h"</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #include <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>sys<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>types<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>h<span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #include <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>sys<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>stat<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>h<span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #include <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>fcntl<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>h<span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #include <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>linux<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>videodev2<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>h<span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #include <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>sys<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>mman<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>h<span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #include <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>SDL<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>SDL<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>h<span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word"><span style="word-wrap:break-word; color:rgb(229,51,51)">#include </span></span><span style="word-wrap:break-word; color:rgb(229,51,51)"><span style="word-wrap:break-word">&lt;</span></span><span style="word-wrap:break-word"><span style="word-wrap:break-word; color:rgb(229,51,51)">libv4l2</span></span><span style="word-wrap:break-word; color:rgb(229,51,51)"><span style="word-wrap:break-word">.</span></span><span style="word-wrap:break-word"><span style="word-wrap:break-word; color:rgb(229,51,51)">h</span></span><span style="word-wrap:break-word; color:rgb(229,51,51)"><span style="word-wrap:break-word">&gt;                      //少了一个头文件,带来的问题看下面</span></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #define VIDEO_DEVICE <span style="word-wrap:break-word; color:rgb(255,0,255)">"/dev/video0"</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> #define NB_BUFFER 4<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> fd<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> ret <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> struct v4l2_capability cap<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> struct v4l2_format fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> struct v4l2_requestbuffers rb<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> struct v4l2_buffer vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> void<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> vmem<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span>NB_BUFFER<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> unsigned char<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> tempbuffer<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> unsigned char<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> framebuffer<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> type<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> framesize<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> width <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> 640<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>1280<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>640<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> height<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> 480<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span> 720<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span> 480<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> float fps <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> 30<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> format <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_PIX_FMT_MJPEG<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> format <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_PIX_FMT_YUYV<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> SDL_mutex <span style="word-wrap:break-word; color:rgb(0,0,204)">*</span>affmutex<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> SDL_Event sdlevent<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> signal_quit <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> 1<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> static <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> eventThread<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>void<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> data<span style="word-wrap:break-word; color:rgb(0,0,204)">)               <span style="word-wrap:break-word"><span style="word-wrap:break-word; color:rgb(229,51,51)">//b.SDL的线程,用来检测事件</span></span></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,204)">{                                                <span style="word-wrap:break-word"><span style="word-wrap:break-word; color:rgb(229,51,51)">//b.当有退出事件时,把signal_quit置空</span></span> </span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">while</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>signal_quit<span style="word-wrap:break-word; color:rgb(0,0,204)">)                           <span style="word-wrap:break-word"><span style="word-wrap:break-word; color:rgb(229,51,51)">//b.这时主线程</span><span style="word-wrap:break-word; color:rgb(229,51,51)">监测到</span></span><span style="word-wrap:break-word; color:rgb(229,51,51)"><span style="word-wrap:break-word">signal_quit</span></span><span style="word-wrap:break-word"><span style="word-wrap:break-word; color:rgb(229,51,51)">为空就退出主线程</span><span style="word-wrap:break-word; color:rgb(229,51,51)"></span></span></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         SDL_LockMutex<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>affmutex<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,255)">while</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>SDL_PollEvent<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>sdlevent<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             switch<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>sdlevent<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>type<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">                 <span style="word-wrap:break-word; color:rgb(0,0,255)">case</span> SDL_QUIT<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">                     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">                         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"recv quit"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">                         signal_quit <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">                     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">                     break<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">                 default<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">                     dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"sdl event"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">                     break<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         SDL_UnlockMutex<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>affmutex<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> init_camera<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_open<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>VIDEO_DEVICE<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span>O_RDWR<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span><span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>1<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>check format <span style="word-wrap:break-word; color:rgb(0,0,255)">is</span> valid<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(255,0,0)">fix</span> me <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,255)">set</span> format <span style="word-wrap:break-word; color:rgb(0,0,255)">and</span> frame size<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     memset<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> sizeof<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>struct v4l2_fmtdesc<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>type <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_BUF_TYPE_VIDEO_CAPTURE<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>pix<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>width <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> width<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>pix<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>height <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> height<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>pix<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>field <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_FIELD_ANY<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_S_FMT<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>fmt<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>mmap buffer<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span> reqbufs<span style="word-wrap:break-word; color:rgb(0,0,204)">-</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span> querybuf <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span> mmap <span style="word-wrap:break-word; color:rgb(0,0,204)">-</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span> QBUF<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     memset<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>rb<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> sizeof<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>struct v4l2_requestbuffers<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     rb<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>count <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> NB_BUFFER<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     rb<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>type <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_BUF_TYPE_VIDEO_CAPTURE<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     rb<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>memory <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_MEMORY_MMAP<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_REQBUFS<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>rb<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0 <span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">for</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>i<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>NB_BUFFER<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">+</span><span style="word-wrap:break-word; color:rgb(0,0,204)">+</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         memset<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> sizeof<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>struct v4l2_buffer<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>index <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>type <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_BUF_TYPE_VIDEO_CAPTURE<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>memory <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_MEMORY_MMAP<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_QUERYBUF<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"len=%d, offset=%d"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>length<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>m<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>offset<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>vmem<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span>i<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_mmap<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>length<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> PROT_READ<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> MAP_SHARED<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>m<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>offset<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span><span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> MAP_FAILED<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"Buffer mapped at address %p"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vmem<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span>i<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">for</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>i<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>NB_BUFFER<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">+</span><span style="word-wrap:break-word; color:rgb(0,0,204)">+</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         memset<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> sizeof<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>struct v4l2_buffer<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>index <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>type <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_BUF_TYPE_VIDEO_CAPTURE<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>memory <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_MEMORY_MMAP<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_QBUF<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>alloc framebuffer<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     framesize <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>width<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span>height<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span>1<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">!</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>tempbuffer <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> malloc<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>framesize<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">!</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>framebuffer <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> malloc<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>width<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span>height<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span>8<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     type <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_BUF_TYPE_VIDEO_CAPTURE<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_STREAMON<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>type<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> main <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> argc<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> char <span style="word-wrap:break-word; color:rgb(0,0,204)">*</span>argv<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span><span style="word-wrap:break-word; color:rgb(0,0,204)">]</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(255,0,0)">int</span> i<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     SDL_Surface<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> psscreen<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     SDL_Overlay<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> overlay<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     SDL_Rect drect<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     SDL_Thread<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> sdl_thread<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     unsigned char<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> p<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     SDL_Init<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>SDL_INIT_EVERYTHING<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     psscreen <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> SDL_SetVideoMode<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>width<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> height<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> SDL_SWSURFACE<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     SDL_WM_SetCaption<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(255,0,255)">"YUV Window"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,255)">NULL</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">*</span> Create a YUV overlay <span style="word-wrap:break-word; color:rgb(0,0,204)">*</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     overlay <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> SDL_CreateYUVOverlay<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>width<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> height<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> SDL_YUY2_OVERLAY<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> psscreen<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     p <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>unsigned char<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> overlay<span style="word-wrap:break-word; color:rgb(0,0,204)">-</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span>pixels<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     drect<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>x <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     drect<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>y <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     drect<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>w <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> width<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     drect<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>h <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> height<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     init_camera<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>sdl <span style="word-wrap:break-word; color:rgb(0,0,255)">get</span> signal quit<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     affmutex <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> SDL_CreateMutex<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     sdl_thread <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> SDL_CreateThread<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>eventThread<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,255)">NULL</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;            <span style="word-wrap:break-word"><span style="word-wrap:break-word; color:rgb(229,51,51)">//a.SDL创建线程</span></span></span> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">while</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>signal_quit<span style="word-wrap:break-word; color:rgb(0,0,204)">)                                           <span style="word-wrap:break-word"><span style="word-wrap:break-word; color:rgb(229,51,51)">//c.当主线程监测到signal_quit为空时,就退出主线程</span></span></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         memset<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> sizeof<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>struct v4l2_buffer<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>type <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_BUF_TYPE_VIDEO_CAPTURE<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>memory <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_MEMORY_MMAP<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_DQBUF<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>bytesused <span style="word-wrap:break-word; color:rgb(0,0,204)">&gt;</span> framesize<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             memcpy<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>framebuffer<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vmem<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>index<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>size_t<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span>framesize<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><span style="word-wrap:break-word; color:rgb(0,0,255)">else</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             memcpy<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>framebuffer<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vmem<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>index<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>size_t<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>bytesused<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span>v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_QBUF<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">                 dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">                 return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">             <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         SDL_LockYUVOverlay<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>overlay<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         memcpy<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>p<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> framebuffer<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> width<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span>height<span style="word-wrap:break-word; color:rgb(0,0,204)">*</span>2<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         SDL_UnlockYUVOverlay<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>overlay<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         SDL_DisplayYUVOverlay<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>overlay<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>drect<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         SDL_Delay<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>10<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     SDL_WaitThread<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>sdl_thread<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>ret<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;                          <span style="word-wrap:break-word"><span style="word-wrap:break-word; color:rgb(229,51,51)">//d.当线程退出时干清理的事</span></span></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     SDL_DestroyMutex<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>affmutex<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">/</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>close_v4l2<br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     type <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> V4L2_BUF_TYPE_VIDEO_CAPTURE<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>ret<span style="word-wrap:break-word; color:rgb(0,0,204)">=</span>v4l2_ioctl<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> VIDIOC_STREAMOFF<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&amp;</span>type<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">&lt;</span> 0<span style="word-wrap:break-word; color:rgb(0,0,204)">)     <span style="word-wrap:break-word"><span style="word-wrap:break-word; color:rgb(229,51,51)">//d.将STREAM关闭,这样下次还可以打开</span></span></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">{<!-- --></span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         dbmsg<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(255,0,255)">"error: %s"</span><span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> strerror<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>errno<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         return 0<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span><span style="word-wrap:break-word; color:rgb(0,0,255)">NULL</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">!</span><span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> framebuffer<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">         free<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>framebuffer<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     framebuffer <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> <span style="word-wrap:break-word; color:rgb(0,0,255)">NULL</span><span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">     return EXIT_SUCCESS<span style="word-wrap:break-word; color:rgb(0,0,204)">;</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,204)">}</span><br style="word-wrap:break-word"> </li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> cong@msi<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span><span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>work<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>test<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>uvcview<span style="word-wrap:break-word; color:rgb(0,0,204)">/</span>3display_1$</li></ol> 
</div> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">3. 代码打包</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<a target="_blank" href="http://blog.chinaunix.net/blog/downLoad/fileid/11640.html" rel="nofollow noopener noreferrer" style="word-wrap:break-word; text-decoration:none; color:rgb(86,86,86); font-family:宋体,Arial; font-size:16px; line-height:26px"><img src="https://images2.imgbox.com/1c/a2/XjnSxQNz_o.png" align="middle" alt="" style="word-wrap:break-word; border:0px">3display_1.rar</a> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> (下载后改名为3display_1.tar.gz)</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">4. 说明</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">a. 为了让程序退出,这儿加入了SDL线程来监听退出事件,有退出事件触发时就通知主while退出</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">b. 在主while退出时需要把camera的视频关闭,这样下次才可以打开</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">c.关于为什么老是会出现下面的warning?</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<div id="codeText" class="codeText" style="word-wrap:break-word; border:1px solid rgb(221,221,221); width:1564.53px; overflow:auto; margin:0px 0px 1.1em; padding:0px; word-break:break-all; letter-spacing:0.1px; font-family:Consolas,monospace; color:rgb(102,102,102)"> 
 <ol start="1" class="dp-css none_number" style="word-wrap:break-word; margin:0px 1px 0px 0px; padding:5px 0pt; list-style:none outside none; color:rgb(92,92,92); line-height:1.3"><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none"> <span style="word-wrap:break-word; color:rgb(0,0,0)">display<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>c<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span>102<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span>19<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span> warning<span style="word-wrap:break-word; color:rgb(0,0,204)">:</span> cast <span style="word-wrap:break-word; color:rgb(0,0,255)">to</span> pointer from integer of different size <span style="word-wrap:break-word; color:rgb(0,0,204)">[</span><span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>Wint<span style="word-wrap:break-word; color:rgb(0,0,204)">-</span><span style="word-wrap:break-word; color:rgb(0,0,255)">to</span><span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>pointer<span style="word-wrap:break-word; color:rgb(0,0,204)">-</span>cast<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span><br style="word-wrap:break-word"> </span></li><li style="word-wrap:break-word; margin:0px; padding:0px 0px 0px 10px; list-style:none outside none">          <span style="word-wrap:break-word; color:rgb(0,0,255)">if</span><span style="word-wrap:break-word; color:rgb(0,0,204)">(</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>vmem<span style="word-wrap:break-word; color:rgb(0,0,204)">[</span>i<span style="word-wrap:break-word; color:rgb(0,0,204)">]</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> v4l2_mmap<span style="word-wrap:break-word; color:rgb(0,0,204)">(</span>0<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>length<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> PROT_READ<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> MAP_SHARED<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> fd<span style="word-wrap:break-word; color:rgb(0,0,204)">,</span> vbuf<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>m<span style="word-wrap:break-word; color:rgb(0,0,204)">.</span>offset<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span><span style="word-wrap:break-word; color:rgb(0,0,204)">)</span> <span style="word-wrap:break-word; color:rgb(0,0,204)">=</span><span style="word-wrap:break-word; color:rgb(0,0,204)">=</span> MAP_FAILED<span style="word-wrap:break-word; color:rgb(0,0,204)">)</span></li></ol> 
</div> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">最后发现原来是#include </span> 
<span style="word-wrap:break-word; font-family:宋体,Arial; font-size:16px; line-height:26px; color:rgb(0,0,204)">&lt;</span> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">libv4l2</span> 
<span style="word-wrap:break-word; font-family:宋体,Arial; font-size:16px; line-height:26px; color:rgb(0,0,204)">.</span> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">h</span> 
<span style="word-wrap:break-word; font-family:宋体,Arial; font-size:16px; line-height:26px; color:rgb(0,0,204)">&gt;</span> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">没有加入头文件,我说这个warning怎么提示v4l2_mmap返回的是integer呢?</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px"> 
<span style="color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">看来有些warning也是需要重视的.</span> 
<br style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:16px; line-height:26px">
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e155bc29830ba878b14c87185075c1cb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">luvcview分析--1.环境搭建</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d257c9f4909fb9fca5deb1372e2cb6fd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">oracle snapshot too old异常</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程大白的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>